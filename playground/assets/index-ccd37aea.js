var ele=Object.defineProperty;var tle=(n,e,t)=>e in n?ele(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Rn=(n,e,t)=>(tle(n,typeof e!="symbol"?e+"":e,t),t),IA=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var nt=(n,e,t)=>(IA(n,e,"read from private field"),t?t.call(n):e.get(n)),Kt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Qo=(n,e,t,i)=>(IA(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var E9=(n,e,t,i)=>({set _(s){Qo(n,e,s,t)},get _(){return nt(n,e,i)}}),Pt=(n,e,t)=>(IA(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const L2=globalThis,BO=L2.ShadowRoot&&(L2.ShadyCSS===void 0||L2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,nK=Symbol(),T9=new WeakMap;let ile=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==nK)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(BO&&e===void 0){const i=t!==void 0&&t.length===1;i&&(e=T9.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&T9.set(t,e))}return e}toString(){return this.cssText}};const nle=n=>new ile(typeof n=="string"?n:n+"",void 0,nK),sle=(n,e)=>{if(BO)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),s=L2.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=t.cssText,n.appendChild(i)}},A9=BO?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return nle(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:rle,defineProperty:ole,getOwnPropertyDescriptor:ale,getOwnPropertyNames:lle,getOwnPropertySymbols:cle,getPrototypeOf:ule}=Object,vd=globalThis,I9=vd.trustedTypes,hle=I9?I9.emptyScript:"",NA=vd.reactiveElementPolyfillSupport,yv=(n,e)=>n,eM={toAttribute(n,e){switch(e){case Boolean:n=n?hle:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},sK=(n,e)=>!rle(n,e),N9={attribute:!0,type:String,converter:eM,reflect:!1,hasChanged:sK};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),vd.litPropertyMetadata??(vd.litPropertyMetadata=new WeakMap);class Km extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=N9){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,t);s!==void 0&&ole(this.prototype,e,s)}}static getPropertyDescriptor(e,t,i){const{get:s,set:r}=ale(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get(){return s==null?void 0:s.call(this)},set(o){const a=s==null?void 0:s.call(this);r.call(this,o),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??N9}static _$Ei(){if(this.hasOwnProperty(yv("elementProperties")))return;const e=ule(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(yv("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(yv("properties"))){const t=this.properties,i=[...lle(t),...cle(t)];for(const s of i)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,s]of t)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const s=this._$Eu(t,i);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)t.unshift(A9(s))}else e!==void 0&&t.push(A9(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$Eg=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$ES??(this._$ES=[])).push(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$ES)==null||t.splice(this._$ES.indexOf(e)>>>0,1)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return sle(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)==null||e.forEach(t=>{var i;return(i=t.hostConnected)==null?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)==null||e.forEach(t=>{var i;return(i=t.hostDisconnected)==null?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EO(e,t){var r;const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const o=(((r=i.converter)==null?void 0:r.toAttribute)!==void 0?i.converter:eM).toAttribute(t,i.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,t){var r;const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const o=i.getPropertyOptions(s),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((r=o.converter)==null?void 0:r.fromAttribute)!==void 0?o.converter:eM;this._$Em=s,this[s]=a.fromAttribute(t,o.type),this._$Em=null}}requestUpdate(e,t,i,s=!1,r){if(e!==void 0){if(i??(i=this.constructor.getPropertyOptions(e)),!(i.hasChanged??sK)(s?r:this[e],t))return;this.C(e,t,i)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,i){this._$AL.has(e)||this._$AL.set(e,t),i.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this._$Ep){for(const[r,o]of this._$Ep)this[r]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[r,o]of s)o.wrapped!==!0||this._$AL.has(r)||this[r]===void 0||this.C(r,this[r],o)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(i=this._$ES)==null||i.forEach(s=>{var r;return(r=s.hostUpdate)==null?void 0:r.call(s)}),this.update(t)):this._$ET()}catch(s){throw e=!1,this._$ET(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$ES)==null||t.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EO(t,this[t]))),this._$ET()}updated(e){}firstUpdated(e){}}Km.elementStyles=[],Km.shadowRootOptions={mode:"open"},Km[yv("elementProperties")]=new Map,Km[yv("finalized")]=new Map,NA==null||NA({ReactiveElement:Km}),(vd.reactiveElementVersions??(vd.reactiveElementVersions=[])).push("2.0.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Cv=globalThis,kk=Cv.trustedTypes,R9=kk?kk.createPolicy("lit-html",{createHTML:n=>n}):void 0,rK="$lit$",zh=`lit$${(Math.random()+"").slice(9)}$`,oK="?"+zh,dle=`<${oK}>`,tp=document,Lk=()=>tp.createComment(""),fw=n=>n===null||typeof n!="object"&&typeof n!="function",aK=Array.isArray,fle=n=>aK(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",RA=`[ 	
\f\r]`,o1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,M9=/-->/g,F9=/>/g,Rf=RegExp(`>|${RA}(?:([^\\s"'>=/]+)(${RA}*=${RA}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),P9=/'/g,O9=/"/g,lK=/^(?:script|style|textarea|title)$/i,gw=Symbol.for("lit-noChange"),Zn=Symbol.for("lit-nothing"),B9=new WeakMap,hg=tp.createTreeWalker(tp,129);function cK(n,e){if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return R9!==void 0?R9.createHTML(e):e}const gle=(n,e)=>{const t=n.length-1,i=[];let s,r=e===2?"<svg>":"",o=o1;for(let a=0;a<t;a++){const l=n[a];let c,u,h=-1,d=0;for(;d<l.length&&(o.lastIndex=d,u=o.exec(l),u!==null);)d=o.lastIndex,o===o1?u[1]==="!--"?o=M9:u[1]!==void 0?o=F9:u[2]!==void 0?(lK.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Rf):u[3]!==void 0&&(o=Rf):o===Rf?u[0]===">"?(o=s??o1,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?Rf:u[3]==='"'?O9:P9):o===O9||o===P9?o=Rf:o===M9||o===F9?o=o1:(o=Rf,s=void 0);const f=o===Rf&&n[a+1].startsWith("/>")?" ":"";r+=o===o1?l+dle:h>=0?(i.push(c),l.slice(0,h)+rK+l.slice(h)+zh+f):l+zh+(h===-2?a:f)}return[cK(n,r+(n[t]||"<?>")+(e===2?"</svg>":"")),i]};let tM=class uK{constructor({strings:e,_$litType$:t},i){let s;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[c,u]=gle(e,t);if(this.el=uK.createElement(c,i),hg.currentNode=this.el.content,t===2){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=hg.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(rK)){const d=u[o++],f=s.getAttribute(h).split(zh),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:r,name:g[2],strings:f,ctor:g[1]==="."?mle:g[1]==="?"?_le:g[1]==="@"?ble:oE}),s.removeAttribute(h)}else h.startsWith(zh)&&(l.push({type:6,index:r}),s.removeAttribute(h));if(lK.test(s.tagName)){const h=s.textContent.split(zh),d=h.length-1;if(d>0){s.textContent=kk?kk.emptyScript:"";for(let f=0;f<d;f++)s.append(h[f],Lk()),hg.nextNode(),l.push({type:2,index:++r});s.append(h[d],Lk())}}}else if(s.nodeType===8)if(s.data===oK)l.push({type:2,index:r});else{let h=-1;for(;(h=s.data.indexOf(zh,h+1))!==-1;)l.push({type:7,index:r}),h+=zh.length-1}r++}}static createElement(e,t){const i=tp.createElement("template");return i.innerHTML=e,i}};function S_(n,e,t=n,i){var o,a;if(e===gw)return e;let s=i!==void 0?(o=t._$Co)==null?void 0:o[i]:t._$Cl;const r=fw(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==r&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),r===void 0?s=void 0:(s=new r(n),s._$AT(n,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=s:t._$Cl=s),s!==void 0&&(e=S_(n,s._$AS(n,e.values),s,i)),e}let ple=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,s=((e==null?void 0:e.creationScope)??tp).importNode(t,!0);hg.currentNode=s;let r=hg.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new hK(r,r.nextSibling,this,e):l.type===1?c=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(c=new vle(r,this,e)),this._$AV.push(c),l=i[++a]}o!==(l==null?void 0:l.index)&&(r=hg.nextNode(),o++)}return hg.currentNode=tp,s}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}},hK=class dK{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,s){this.type=2,this._$AH=Zn,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=S_(this,e,t),fw(e)?e===Zn||e==null||e===""?(this._$AH!==Zn&&this._$AR(),this._$AH=Zn):e!==this._$AH&&e!==gw&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):fle(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==Zn&&fw(this._$AH)?this._$AA.nextSibling.data=e:this.$(tp.createTextNode(e)),this._$AH=e}g(e){var r;const{values:t,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=tM.createElement(cK(i.h,i.h[0]),this.options)),i);if(((r=this._$AH)==null?void 0:r._$AD)===s)this._$AH.p(t);else{const o=new ple(s,this),a=o.u(this.options);o.p(t),this.$(a),this._$AH=o}}_$AC(e){let t=B9.get(e.strings);return t===void 0&&B9.set(e.strings,t=new tM(e)),t}T(e){aK(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,s=0;for(const r of e)s===t.length?t.push(i=new dK(this.k(Lk()),this.k(Lk()),this,this.options)):i=t[s],i._$AI(r),s++;s<t.length&&(this._$AR(i&&i._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}},oE=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,s,r){this.type=1,this._$AH=Zn,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=r,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Zn}_$AI(e,t=this,i,s){const r=this.strings;let o=!1;if(r===void 0)e=S_(this,e,t,0),o=!fw(e)||e!==this._$AH&&e!==gw,o&&(this._$AH=e);else{const a=e;let l,c;for(e=r[0],l=0;l<r.length-1;l++)c=S_(this,a[i+l],t,l),c===gw&&(c=this._$AH[l]),o||(o=!fw(c)||c!==this._$AH[l]),c===Zn?e=Zn:e!==Zn&&(e+=(c??"")+r[l+1]),this._$AH[l]=c}o&&!s&&this.O(e)}O(e){e===Zn?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},mle=class extends oE{constructor(){super(...arguments),this.type=3}O(e){this.element[this.name]=e===Zn?void 0:e}},_le=class extends oE{constructor(){super(...arguments),this.type=4}O(e){this.element.toggleAttribute(this.name,!!e&&e!==Zn)}},ble=class extends oE{constructor(e,t,i,s,r){super(e,t,i,s,r),this.type=5}_$AI(e,t=this){if((e=S_(this,e,t,0)??Zn)===gw)return;const i=this._$AH,s=e===Zn&&i!==Zn||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==Zn&&(i===Zn||s);s&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}},vle=class{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){S_(this,e)}};const MA=Cv.litHtmlPolyfillSupport;MA==null||MA(tM,hK),(Cv.litHtmlVersions??(Cv.litHtmlVersions=[])).push("3.0.2");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Sv=globalThis,Dk=Sv.trustedTypes,W9=Dk?Dk.createPolicy("lit-html",{createHTML:n=>n}):void 0,fK="$lit$",Hh=`lit$${(Math.random()+"").slice(9)}$`,gK="?"+Hh,wle=`<${gK}>`,ip=document,pw=()=>ip.createComment(""),mw=n=>n===null||typeof n!="object"&&typeof n!="function",pK=Array.isArray,yle=n=>pK(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",FA=`[ 	
\f\r]`,a1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,V9=/-->/g,$9=/>/g,Mf=RegExp(`>|${FA}(?:([^\\s"'>=/]+)(${FA}*=${FA}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),z9=/'/g,H9=/"/g,mK=/^(?:script|style|textarea|title)$/i,Cle=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),Dr=Cle(1),x_=Symbol.for("lit-noChange"),Yn=Symbol.for("lit-nothing"),U9=new WeakMap,dg=ip.createTreeWalker(ip,129);function _K(n,e){if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return W9!==void 0?W9.createHTML(e):e}const Sle=(n,e)=>{const t=n.length-1,i=[];let s,r=e===2?"<svg>":"",o=a1;for(let a=0;a<t;a++){const l=n[a];let c,u,h=-1,d=0;for(;d<l.length&&(o.lastIndex=d,u=o.exec(l),u!==null);)d=o.lastIndex,o===a1?u[1]==="!--"?o=V9:u[1]!==void 0?o=$9:u[2]!==void 0?(mK.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Mf):u[3]!==void 0&&(o=Mf):o===Mf?u[0]===">"?(o=s??a1,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?Mf:u[3]==='"'?H9:z9):o===H9||o===z9?o=Mf:o===V9||o===$9?o=a1:(o=Mf,s=void 0);const f=o===Mf&&n[a+1].startsWith("/>")?" ":"";r+=o===a1?l+wle:h>=0?(i.push(c),l.slice(0,h)+fK+l.slice(h)+Hh+f):l+Hh+(h===-2?a:f)}return[_K(n,r+(n[t]||"<?>")+(e===2?"</svg>":"")),i]};let iM=class bK{constructor({strings:e,_$litType$:t},i){let s;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[c,u]=Sle(e,t);if(this.el=bK.createElement(c,i),dg.currentNode=this.el.content,t===2){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=dg.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(fK)){const d=u[o++],f=s.getAttribute(h).split(Hh),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:r,name:g[2],strings:f,ctor:g[1]==="."?kle:g[1]==="?"?Lle:g[1]==="@"?Dle:aE}),s.removeAttribute(h)}else h.startsWith(Hh)&&(l.push({type:6,index:r}),s.removeAttribute(h));if(mK.test(s.tagName)){const h=s.textContent.split(Hh),d=h.length-1;if(d>0){s.textContent=Dk?Dk.emptyScript:"";for(let f=0;f<d;f++)s.append(h[f],pw()),dg.nextNode(),l.push({type:2,index:++r});s.append(h[d],pw())}}}else if(s.nodeType===8)if(s.data===gK)l.push({type:2,index:r});else{let h=-1;for(;(h=s.data.indexOf(Hh,h+1))!==-1;)l.push({type:7,index:r}),h+=Hh.length-1}r++}}static createElement(e,t){const i=ip.createElement("template");return i.innerHTML=e,i}};function k_(n,e,t=n,i){var o,a;if(e===x_)return e;let s=i!==void 0?(o=t._$Co)==null?void 0:o[i]:t._$Cl;const r=mw(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==r&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),r===void 0?s=void 0:(s=new r(n),s._$AT(n,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=s:t._$Cl=s),s!==void 0&&(e=k_(n,s._$AS(n,e.values),s,i)),e}let xle=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,s=((e==null?void 0:e.creationScope)??ip).importNode(t,!0);dg.currentNode=s;let r=dg.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new WO(r,r.nextSibling,this,e):l.type===1?c=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(c=new Ele(r,this,e)),this._$AV.push(c),l=i[++a]}o!==(l==null?void 0:l.index)&&(r=dg.nextNode(),o++)}return dg.currentNode=ip,s}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}},WO=class vK{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,s){this.type=2,this._$AH=Yn,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=k_(this,e,t),mw(e)?e===Yn||e==null||e===""?(this._$AH!==Yn&&this._$AR(),this._$AH=Yn):e!==this._$AH&&e!==x_&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):yle(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==Yn&&mw(this._$AH)?this._$AA.nextSibling.data=e:this.$(ip.createTextNode(e)),this._$AH=e}g(e){var r;const{values:t,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=iM.createElement(_K(i.h,i.h[0]),this.options)),i);if(((r=this._$AH)==null?void 0:r._$AD)===s)this._$AH.p(t);else{const o=new xle(s,this),a=o.u(this.options);o.p(t),this.$(a),this._$AH=o}}_$AC(e){let t=U9.get(e.strings);return t===void 0&&U9.set(e.strings,t=new iM(e)),t}T(e){pK(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,s=0;for(const r of e)s===t.length?t.push(i=new vK(this.k(pw()),this.k(pw()),this,this.options)):i=t[s],i._$AI(r),s++;s<t.length&&(this._$AR(i&&i._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}},aE=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,s,r){this.type=1,this._$AH=Yn,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=r,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Yn}_$AI(e,t=this,i,s){const r=this.strings;let o=!1;if(r===void 0)e=k_(this,e,t,0),o=!mw(e)||e!==this._$AH&&e!==x_,o&&(this._$AH=e);else{const a=e;let l,c;for(e=r[0],l=0;l<r.length-1;l++)c=k_(this,a[i+l],t,l),c===x_&&(c=this._$AH[l]),o||(o=!mw(c)||c!==this._$AH[l]),c===Yn?e=Yn:e!==Yn&&(e+=(c??"")+r[l+1]),this._$AH[l]=c}o&&!s&&this.O(e)}O(e){e===Yn?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},kle=class extends aE{constructor(){super(...arguments),this.type=3}O(e){this.element[this.name]=e===Yn?void 0:e}},Lle=class extends aE{constructor(){super(...arguments),this.type=4}O(e){this.element.toggleAttribute(this.name,!!e&&e!==Yn)}},Dle=class extends aE{constructor(e,t,i,s,r){super(e,t,i,s,r),this.type=5}_$AI(e,t=this){if((e=k_(this,e,t,0)??Yn)===x_)return;const i=this._$AH,s=e===Yn&&i!==Yn||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==Yn&&(i===Yn||s);s&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}},Ele=class{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){k_(this,e)}};const PA=Sv.litHtmlPolyfillSupport;PA==null||PA(iM,WO),(Sv.litHtmlVersions??(Sv.litHtmlVersions=[])).push("3.0.2");const wK=(n,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let s=i._$litPart$;if(s===void 0){const r=(t==null?void 0:t.renderBefore)??null;i._$litPart$=s=new WO(e.insertBefore(pw(),r),r,void 0,t??{})}return s._$AI(n),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let R0=class extends Km{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=wK(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return x_}};var tK;R0._$litElement$=!0,R0.finalized=!0,(tK=globalThis.litElementHydrateSupport)==null||tK.call(globalThis,{LitElement:R0});const OA=globalThis.litElementPolyfillSupport;OA==null||OA({LitElement:R0});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.1");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Tle=n=>n.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ale={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Ile=n=>(...e)=>({_$litDirective$:n,values:e});let Nle=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,i){this._$Ct=e,this._$AM=t,this._$Ci=i}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const xv=(n,e)=>{var i;const t=n._$AN;if(t===void 0)return!1;for(const s of t)(i=s._$AO)==null||i.call(s,e,!1),xv(s,e);return!0},Ek=n=>{let e,t;do{if((e=n._$AM)===void 0)break;t=e._$AN,t.delete(n),n=e}while((t==null?void 0:t.size)===0)},yK=n=>{for(let e;e=n._$AM;n=e){let t=e._$AN;if(t===void 0)e._$AN=t=new Set;else if(t.has(n))break;t.add(n),Fle(e)}};function Rle(n){this._$AN!==void 0?(Ek(this),this._$AM=n,yK(this)):this._$AM=n}function Mle(n,e=!1,t=0){const i=this._$AH,s=this._$AN;if(s!==void 0&&s.size!==0)if(e)if(Array.isArray(i))for(let r=t;r<i.length;r++)xv(i[r],!1),Ek(i[r]);else i!=null&&(xv(i,!1),Ek(i));else xv(this,n)}const Fle=n=>{n.type==Ale.CHILD&&(n._$AP??(n._$AP=Mle),n._$AQ??(n._$AQ=Rle))};let Ple=class extends Nle{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),yK(this),this.isConnected=e._$AU}_$AO(e,t=!0){var i,s;e!==this.isConnected&&(this.isConnected=e,e?(i=this.reconnected)==null||i.call(this):(s=this.disconnected)==null||s.call(this)),t&&(xv(this,e),Ek(this))}setValue(e){if(Tle(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const CK=()=>new Ole;let Ole=class{};const BA=new WeakMap,j9=Ile(class extends Ple{render(n){return Zn}update(n,[e]){var i;const t=e!==this.G;return t&&this.G!==void 0&&this.ot(void 0),(t||this.rt!==this.lt)&&(this.G=e,this.ct=(i=n.options)==null?void 0:i.host,this.ot(this.lt=n.element)),Zn}ot(n){if(typeof this.G=="function"){const e=this.ct??globalThis;let t=BA.get(e);t===void 0&&(t=new WeakMap,BA.set(e,t)),t.get(this.G)!==void 0&&this.G.call(this.ct,void 0),t.set(this.G,n),n!==void 0&&this.G.call(this.ct,n)}else this.G.value=n}get rt(){var n,e;return typeof this.G=="function"?(n=BA.get(this.ct??globalThis))==null?void 0:n.get(this.G):(e=this.G)==null?void 0:e.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */function q9(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Qe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?q9(Object(t),!0).forEach(function(i){Vle(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):q9(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Tk(n){"@babel/helpers - typeof";return Tk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tk(n)}function Ble(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function G9(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Wle(n,e,t){return e&&G9(n.prototype,e),t&&G9(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Vle(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function VO(n,e){return zle(n)||Ule(n,e)||SK(n,e)||qle()}function lE(n){return $le(n)||Hle(n)||SK(n)||jle()}function $le(n){if(Array.isArray(n))return nM(n)}function zle(n){if(Array.isArray(n))return n}function Hle(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ule(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],s=!0,r=!1,o,a;try{for(t=t.call(n);!(s=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));s=!0);}catch(l){r=!0,a=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(r)throw a}}return i}}function SK(n,e){if(n){if(typeof n=="string")return nM(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nM(n,e)}}function nM(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function jle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var K9=function(){},$O={},xK={},kK=null,LK={mark:K9,measure:K9};try{typeof window<"u"&&($O=window),typeof document<"u"&&(xK=document),typeof MutationObserver<"u"&&(kK=MutationObserver),typeof performance<"u"&&(LK=performance)}catch{}var Gle=$O.navigator||{},Z9=Gle.userAgent,Y9=Z9===void 0?"":Z9,Vd=$O,on=xK,X9=kK,zS=LK;Vd.document;var nh=!!on.documentElement&&!!on.head&&typeof on.addEventListener=="function"&&typeof on.createElement=="function",DK=~Y9.indexOf("MSIE")||~Y9.indexOf("Trident/"),Xu="___FONT_AWESOME___",sM=16,EK="fa",TK="svg-inline--fa",np="data-fa-i2svg",rM="data-fa-pseudo-element",Kle="data-fa-pseudo-element-pending",zO="data-prefix",HO="data-icon",Q9="fontawesome-i2svg",Zle="async",Yle=["HTML","HEAD","STYLE","SCRIPT"],AK=function(){try{return!0}catch{return!1}}(),UO={fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit",fa:"solid"},Ak={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"},IK={fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},Xle={"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},Qle=/fa[srltdbk\-\ ]/,NK="fa-layers-text",Jle=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Kit)?.*/i,ece={900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},RK=[1,2,3,4,5,6,7,8,9,10],tce=RK.concat([11,12,13,14,15,16,17,18,19,20]),ice=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],fg={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},nce=[].concat(lE(Object.keys(Ak)),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",fg.GROUP,fg.SWAP_OPACITY,fg.PRIMARY,fg.SECONDARY]).concat(RK.map(function(n){return"".concat(n,"x")})).concat(tce.map(function(n){return"w-".concat(n)})),MK=Vd.FontAwesomeConfig||{};function sce(n){var e=on.querySelector("script["+n+"]");if(e)return e.getAttribute(n)}function rce(n){return n===""?!0:n==="false"?!1:n==="true"?!0:n}if(on&&typeof on.querySelector=="function"){var oce=[["data-family-prefix","familyPrefix"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];oce.forEach(function(n){var e=VO(n,2),t=e[0],i=e[1],s=rce(sce(t));s!=null&&(MK[i]=s)})}var ace={familyPrefix:EK,styleDefault:"solid",replacementClass:TK,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},kv=Qe(Qe({},ace),MK);kv.autoReplaceSvg||(kv.observeMutations=!1);var vt={};Object.keys(kv).forEach(function(n){Object.defineProperty(vt,n,{enumerable:!0,set:function(t){kv[n]=t,D2.forEach(function(i){return i(vt)})},get:function(){return kv[n]}})});Vd.FontAwesomeConfig=vt;var D2=[];function lce(n){return D2.push(n),function(){D2.splice(D2.indexOf(n),1)}}var vh=sM,dc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function cce(n){if(!(!n||!nh)){var e=on.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=n;for(var t=on.head.childNodes,i=null,s=t.length-1;s>-1;s--){var r=t[s],o=(r.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=r)}return on.head.insertBefore(e,i),n}}var uce="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function _w(){for(var n=12,e="";n-- >0;)e+=uce[Math.random()*62|0];return e}function kb(n){for(var e=[],t=(n||[]).length>>>0;t--;)e[t]=n[t];return e}function jO(n){return n.classList?kb(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(e){return e})}function FK(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hce(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(FK(n[t]),'" ')},"").trim()}function cE(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(n[t].trim(),";")},"")}function qO(n){return n.size!==dc.size||n.x!==dc.x||n.y!==dc.y||n.rotate!==dc.rotate||n.flipX||n.flipY}function dce(n){var e=n.transform,t=n.containerWidth,i=n.iconWidth,s={transform:"translate(".concat(t/2," 256)")},r="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(r," ").concat(o," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:s,inner:l,path:c}}function fce(n){var e=n.transform,t=n.width,i=t===void 0?sM:t,s=n.height,r=s===void 0?sM:s,o=n.startCentered,a=o===void 0?!1:o,l="";return a&&DK?l+="translate(".concat(e.x/vh-i/2,"em, ").concat(e.y/vh-r/2,"em) "):a?l+="translate(calc(-50% + ".concat(e.x/vh,"em), calc(-50% + ").concat(e.y/vh,"em)) "):l+="translate(".concat(e.x/vh,"em, ").concat(e.y/vh,"em) "),l+="scale(".concat(e.size/vh*(e.flipX?-1:1),", ").concat(e.size/vh*(e.flipY?-1:1),") "),l+="rotate(".concat(e.rotate,"deg) "),l}var gce=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function PK(){var n=EK,e=TK,t=vt.familyPrefix,i=vt.replacementClass,s=gce;if(t!==n||i!==e){var r=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");s=s.replace(r,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(i))}return s}var J9=!1;function WA(){vt.autoAddCss&&!J9&&(cce(PK()),J9=!0)}var pce={mixout:function(){return{dom:{css:PK,insertCss:WA}}},hooks:function(){return{beforeDOMElementCreation:function(){WA()},beforeI2svg:function(){WA()}}}},Qu=Vd||{};Qu[Xu]||(Qu[Xu]={});Qu[Xu].styles||(Qu[Xu].styles={});Qu[Xu].hooks||(Qu[Xu].hooks={});Qu[Xu].shims||(Qu[Xu].shims=[]);var hl=Qu[Xu],OK=[],mce=function n(){on.removeEventListener("DOMContentLoaded",n),Ik=1,OK.map(function(e){return e()})},Ik=!1;nh&&(Ik=(on.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(on.readyState),Ik||on.addEventListener("DOMContentLoaded",mce));function _ce(n){nh&&(Ik?setTimeout(n,0):OK.push(n))}function kC(n){var e=n.tag,t=n.attributes,i=t===void 0?{}:t,s=n.children,r=s===void 0?[]:s;return typeof n=="string"?FK(n):"<".concat(e," ").concat(hce(i),">").concat(r.map(kC).join(""),"</").concat(e,">")}function eB(n,e,t){if(n&&n[e]&&n[e][t])return{prefix:e,iconName:t,icon:n[e][t]}}var bce=function(e,t){return function(i,s,r,o){return e.call(t,i,s,r,o)}},VA=function(e,t,i,s){var r=Object.keys(e),o=r.length,a=s!==void 0?bce(t,s):t,l,c,u;for(i===void 0?(l=1,u=e[r[0]]):(l=0,u=i);l<o;l++)c=r[l],u=a(u,e[c],c,e);return u};function vce(n){for(var e=[],t=0,i=n.length;t<i;){var s=n.charCodeAt(t++);if(s>=55296&&s<=56319&&t<i){var r=n.charCodeAt(t++);(r&64512)==56320?e.push(((s&1023)<<10)+(r&1023)+65536):(e.push(s),t--)}else e.push(s)}return e}function oM(n){var e=vce(n);return e.length===1?e[0].toString(16):null}function wce(n,e){var t=n.length,i=n.charCodeAt(e),s;return i>=55296&&i<=56319&&t>e+1&&(s=n.charCodeAt(e+1),s>=56320&&s<=57343)?(i-55296)*1024+s-56320+65536:i}function tB(n){return Object.keys(n).reduce(function(e,t){var i=n[t],s=!!i.icon;return s?e[i.iconName]=i.icon:e[t]=i,e},{})}function aM(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.skipHooks,s=i===void 0?!1:i,r=tB(e);typeof hl.hooks.addPack=="function"&&!s?hl.hooks.addPack(n,tB(e)):hl.styles[n]=Qe(Qe({},hl.styles[n]||{}),r),n==="fas"&&aM("fa",e)}var Lv=hl.styles,yce=hl.shims,Cce=Object.values(IK),GO=null,BK={},WK={},VK={},$K={},zK={},Sce=Object.keys(UO);function xce(n){return~nce.indexOf(n)}function kce(n,e){var t=e.split("-"),i=t[0],s=t.slice(1).join("-");return i===n&&s!==""&&!xce(s)?s:null}var HK=function(){var e=function(r){return VA(Lv,function(o,a,l){return o[l]=VA(a,r,{}),o},{})};BK=e(function(s,r,o){if(r[3]&&(s[r[3]]=o),r[2]){var a=r[2].filter(function(l){return typeof l=="number"});a.forEach(function(l){s[l.toString(16)]=o})}return s}),WK=e(function(s,r,o){if(s[o]=o,r[2]){var a=r[2].filter(function(l){return typeof l=="string"});a.forEach(function(l){s[l]=o})}return s}),zK=e(function(s,r,o){var a=r[2];return s[o]=o,a.forEach(function(l){s[l]=o}),s});var t="far"in Lv||vt.autoFetchSvg,i=VA(yce,function(s,r){var o=r[0],a=r[1],l=r[2];return a==="far"&&!t&&(a="fas"),typeof o=="string"&&(s.names[o]={prefix:a,iconName:l}),typeof o=="number"&&(s.unicodes[o.toString(16)]={prefix:a,iconName:l}),s},{names:{},unicodes:{}});VK=i.names,$K=i.unicodes,GO=uE(vt.styleDefault)};lce(function(n){GO=uE(n.styleDefault)});HK();function KO(n,e){return(BK[n]||{})[e]}function Lce(n,e){return(WK[n]||{})[e]}function t0(n,e){return(zK[n]||{})[e]}function UK(n){return VK[n]||{prefix:null,iconName:null}}function Dce(n){var e=$K[n],t=KO("fas",n);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}function $d(){return GO}var ZO=function(){return{prefix:null,iconName:null,rest:[]}};function uE(n){var e=UO[n],t=Ak[n]||Ak[e],i=n in hl.styles?n:null;return t||i||null}function hE(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.skipLookups,i=t===void 0?!1:t,s=null,r=n.reduce(function(o,a){var l=kce(vt.familyPrefix,a);if(Lv[a]?(a=Cce.includes(a)?Xle[a]:a,s=a,o.prefix=a):Sce.indexOf(a)>-1?(s=a,o.prefix=uE(a)):l?o.iconName=l:a!==vt.replacementClass&&o.rest.push(a),!i&&o.prefix&&o.iconName){var c=s==="fa"?UK(o.iconName):{},u=t0(o.prefix,o.iconName);c.prefix&&(s=null),o.iconName=c.iconName||u||o.iconName,o.prefix=c.prefix||o.prefix,o.prefix==="far"&&!Lv.far&&Lv.fas&&!vt.autoFetchSvg&&(o.prefix="fas")}return o},ZO());return(r.prefix==="fa"||s==="fa")&&(r.prefix=$d()||"fas"),r}var Ece=function(){function n(){Ble(this,n),this.definitions={}}return Wle(n,[{key:"add",value:function(){for(var t=this,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=Qe(Qe({},t.definitions[a]||{}),o[a]),aM(a,o[a]);var l=IK[a];l&&aM(l,o[a]),HK()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,i){var s=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(s).map(function(r){var o=s[r],a=o.prefix,l=o.iconName,c=o.icon,u=c[2];t[a]||(t[a]={}),u.length>0&&u.forEach(function(h){typeof h=="string"&&(t[a][h]=c)}),t[a][l]=c}),t}}]),n}(),iB=[],i0={},M0={},Tce=Object.keys(M0);function Ace(n,e){var t=e.mixoutsTo;return iB=n,i0={},Object.keys(M0).forEach(function(i){Tce.indexOf(i)===-1&&delete M0[i]}),iB.forEach(function(i){var s=i.mixout?i.mixout():{};if(Object.keys(s).forEach(function(o){typeof s[o]=="function"&&(t[o]=s[o]),Tk(s[o])==="object"&&Object.keys(s[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=s[o][a]})}),i.hooks){var r=i.hooks();Object.keys(r).forEach(function(o){i0[o]||(i0[o]=[]),i0[o].push(r[o])})}i.provides&&i.provides(M0)}),t}function lM(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),s=2;s<t;s++)i[s-2]=arguments[s];var r=i0[n]||[];return r.forEach(function(o){e=o.apply(null,[e].concat(i))}),e}function sp(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];var s=i0[n]||[];s.forEach(function(r){r.apply(null,t)})}function Ju(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);return M0[n]?M0[n].apply(null,e):void 0}function cM(n){n.prefix==="fa"&&(n.prefix="fas");var e=n.iconName,t=n.prefix||$d();if(e)return e=t0(t,e)||e,eB(jK.definitions,t,e)||eB(hl.styles,t,e)}var jK=new Ece,Ice=function(){vt.autoReplaceSvg=!1,vt.observeMutations=!1,sp("noAuto")},Nce={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nh?(sp("beforeI2svg",e),Ju("pseudoElements2svg",e),Ju("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot;vt.autoReplaceSvg===!1&&(vt.autoReplaceSvg=!0),vt.observeMutations=!0,_ce(function(){Mce({autoReplaceSvgRoot:t}),sp("watch",e)})}},Rce={icon:function(e){if(e===null)return null;if(Tk(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:t0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var t=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=uE(e[0]);return{prefix:i,iconName:t0(i,t)||t}}if(typeof e=="string"&&(e.indexOf("".concat(vt.familyPrefix,"-"))>-1||e.match(Qle))){var s=hE(e.split(" "),{skipLookups:!0});return{prefix:s.prefix||$d(),iconName:t0(s.prefix,s.iconName)||s.iconName}}if(typeof e=="string"){var r=$d();return{prefix:r,iconName:t0(r,e)||e}}}},Uo={noAuto:Ice,config:vt,dom:Nce,parse:Rce,library:jK,findIconDefinition:cM,toHtml:kC},Mce=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot,i=t===void 0?on:t;(Object.keys(hl.styles).length>0||vt.autoFetchSvg)&&nh&&vt.autoReplaceSvg&&Uo.dom.i2svg({node:i})};function dE(n,e){return Object.defineProperty(n,"abstract",{get:e}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(i){return kC(i)})}}),Object.defineProperty(n,"node",{get:function(){if(nh){var i=on.createElement("div");return i.innerHTML=n.html,i.children}}}),n}function Fce(n){var e=n.children,t=n.main,i=n.mask,s=n.attributes,r=n.styles,o=n.transform;if(qO(o)&&t.found&&!i.found){var a=t.width,l=t.height,c={x:a/l/2,y:.5};s.style=cE(Qe(Qe({},r),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:e}]}function Pce(n){var e=n.prefix,t=n.iconName,i=n.children,s=n.attributes,r=n.symbol,o=r===!0?"".concat(e,"-").concat(vt.familyPrefix,"-").concat(t):r;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Qe(Qe({},s),{},{id:o}),children:i}]}]}function YO(n){var e=n.icons,t=e.main,i=e.mask,s=n.prefix,r=n.iconName,o=n.transform,a=n.symbol,l=n.title,c=n.maskId,u=n.titleId,h=n.extra,d=n.watchable,f=d===void 0?!1:d,g=i.found?i:t,p=g.width,m=g.height,b=s==="fak",v=[vt.replacementClass,r?"".concat(vt.familyPrefix,"-").concat(r):""].filter(function(k){return h.classes.indexOf(k)===-1}).filter(function(k){return k!==""||!!k}).concat(h.classes).join(" "),w={children:[],attributes:Qe(Qe({},h.attributes),{},{"data-prefix":s,"data-icon":r,class:v,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(m)})},y=b&&!~h.classes.indexOf("fa-fw")?{width:"".concat(p/m*16*.0625,"em")}:{};f&&(w.attributes[np]=""),l&&(w.children.push({tag:"title",attributes:{id:w.attributes["aria-labelledby"]||"title-".concat(u||_w())},children:[l]}),delete w.attributes.title);var x=Qe(Qe({},w),{},{prefix:s,iconName:r,main:t,mask:i,maskId:c,transform:o,symbol:a,styles:Qe(Qe({},y),h.styles)}),D=i.found&&t.found?Ju("generateAbstractMask",x)||{children:[],attributes:{}}:Ju("generateAbstractIcon",x)||{children:[],attributes:{}},S=D.children,T=D.attributes;return x.children=S,x.attributes=T,a?Pce(x):Fce(x)}function nB(n){var e=n.content,t=n.width,i=n.height,s=n.transform,r=n.title,o=n.extra,a=n.watchable,l=a===void 0?!1:a,c=Qe(Qe(Qe({},o.attributes),r?{title:r}:{}),{},{class:o.classes.join(" ")});l&&(c[np]="");var u=Qe({},o.styles);qO(s)&&(u.transform=fce({transform:s,startCentered:!0,width:t,height:i}),u["-webkit-transform"]=u.transform);var h=cE(u);h.length>0&&(c.style=h);var d=[];return d.push({tag:"span",attributes:c,children:[e]}),r&&d.push({tag:"span",attributes:{class:"sr-only"},children:[r]}),d}function Oce(n){var e=n.content,t=n.title,i=n.extra,s=Qe(Qe(Qe({},i.attributes),t?{title:t}:{}),{},{class:i.classes.join(" ")}),r=cE(i.styles);r.length>0&&(s.style=r);var o=[];return o.push({tag:"span",attributes:s,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}var $A=hl.styles;function uM(n){var e=n[0],t=n[1],i=n.slice(4),s=VO(i,1),r=s[0],o=null;return Array.isArray(r)?o={tag:"g",attributes:{class:"".concat(vt.familyPrefix,"-").concat(fg.GROUP)},children:[{tag:"path",attributes:{class:"".concat(vt.familyPrefix,"-").concat(fg.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(vt.familyPrefix,"-").concat(fg.PRIMARY),fill:"currentColor",d:r[1]}}]}:o={tag:"path",attributes:{fill:"currentColor",d:r}},{found:!0,width:e,height:t,icon:o}}var Bce={found:!1,width:512,height:512};function Wce(n,e){!AK&&!vt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(e,'" is missing.'))}function hM(n,e){var t=e;return e==="fa"&&vt.styleDefault!==null&&(e=$d()),new Promise(function(i,s){if(Ju("missingIconAbstract"),t==="fa"){var r=UK(n)||{};n=r.iconName||n,e=r.prefix||e}if(n&&e&&$A[e]&&$A[e][n]){var o=$A[e][n];return i(uM(o))}Wce(n,e),i(Qe(Qe({},Bce),{},{icon:vt.showMissingIcons&&n?Ju("missingIconAbstract")||{}:{}}))})}var sB=function(){},dM=vt.measurePerformance&&zS&&zS.mark&&zS.measure?zS:{mark:sB,measure:sB},q1='FA "6.1.1"',Vce=function(e){return dM.mark("".concat(q1," ").concat(e," begins")),function(){return qK(e)}},qK=function(e){dM.mark("".concat(q1," ").concat(e," ends")),dM.measure("".concat(q1," ").concat(e),"".concat(q1," ").concat(e," begins"),"".concat(q1," ").concat(e," ends"))},XO={begin:Vce,end:qK},E2=function(){};function rB(n){var e=n.getAttribute?n.getAttribute(np):null;return typeof e=="string"}function $ce(n){var e=n.getAttribute?n.getAttribute(zO):null,t=n.getAttribute?n.getAttribute(HO):null;return e&&t}function zce(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(vt.replacementClass)}function Hce(){if(vt.autoReplaceSvg===!0)return T2.replace;var n=T2[vt.autoReplaceSvg];return n||T2.replace}function Uce(n){return on.createElementNS("http://www.w3.org/2000/svg",n)}function jce(n){return on.createElement(n)}function GK(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.ceFn,i=t===void 0?n.tag==="svg"?Uce:jce:t;if(typeof n=="string")return on.createTextNode(n);var s=i(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var r=n.children||[];return r.forEach(function(o){s.appendChild(GK(o,{ceFn:i}))}),s}function qce(n){var e=" ".concat(n.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var T2={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(s){t.parentNode.insertBefore(GK(s),t)}),t.getAttribute(np)===null&&vt.keepOriginalSource){var i=on.createComment(qce(t));t.parentNode.replaceChild(i,t)}else t.remove()},nest:function(e){var t=e[0],i=e[1];if(~jO(t).indexOf(vt.replacementClass))return T2.replace(e);var s=new RegExp("".concat(vt.familyPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var r=i[0].attributes.class.split(" ").reduce(function(a,l){return l===vt.replacementClass||l.match(s)?a.toSvg.push(l):a.toNode.push(l),a},{toNode:[],toSvg:[]});i[0].attributes.class=r.toSvg.join(" "),r.toNode.length===0?t.removeAttribute("class"):t.setAttribute("class",r.toNode.join(" "))}var o=i.map(function(a){return kC(a)}).join(`
`);t.setAttribute(np,""),t.innerHTML=o}};function oB(n){n()}function KK(n,e){var t=typeof e=="function"?e:E2;if(n.length===0)t();else{var i=oB;vt.mutateApproach===Zle&&(i=Vd.requestAnimationFrame||oB),i(function(){var s=Hce(),r=XO.begin("mutate");n.map(s),r(),t()})}}var QO=!1;function ZK(){QO=!0}function fM(){QO=!1}var Nk=null;function aB(n){if(X9&&vt.observeMutations){var e=n.treeCallback,t=e===void 0?E2:e,i=n.nodeCallback,s=i===void 0?E2:i,r=n.pseudoElementsCallback,o=r===void 0?E2:r,a=n.observeMutationsRoot,l=a===void 0?on:a;Nk=new X9(function(c){if(!QO){var u=$d();kb(c).forEach(function(h){if(h.type==="childList"&&h.addedNodes.length>0&&!rB(h.addedNodes[0])&&(vt.searchPseudoElements&&o(h.target),t(h.target)),h.type==="attributes"&&h.target.parentNode&&vt.searchPseudoElements&&o(h.target.parentNode),h.type==="attributes"&&rB(h.target)&&~ice.indexOf(h.attributeName))if(h.attributeName==="class"&&$ce(h.target)){var d=hE(jO(h.target)),f=d.prefix,g=d.iconName;h.target.setAttribute(zO,f||u),g&&h.target.setAttribute(HO,g)}else zce(h.target)&&s(h.target)})}}),nh&&Nk.observe(l,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Gce(){Nk&&Nk.disconnect()}function Kce(n){var e=n.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(i,s){var r=s.split(":"),o=r[0],a=r.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),t}function Zce(n){var e=n.getAttribute("data-prefix"),t=n.getAttribute("data-icon"),i=n.innerText!==void 0?n.innerText.trim():"",s=hE(jO(n));return s.prefix||(s.prefix=$d()),e&&t&&(s.prefix=e,s.iconName=t),s.iconName&&s.prefix||s.prefix&&i.length>0&&(s.iconName=Lce(s.prefix,n.innerText)||KO(s.prefix,oM(n.innerText))),s}function Yce(n){var e=kb(n.attributes).reduce(function(s,r){return s.name!=="class"&&s.name!=="style"&&(s[r.name]=r.value),s},{}),t=n.getAttribute("title"),i=n.getAttribute("data-fa-title-id");return vt.autoA11y&&(t?e["aria-labelledby"]="".concat(vt.replacementClass,"-title-").concat(i||_w()):(e["aria-hidden"]="true",e.focusable="false")),e}function Xce(){return{iconName:null,title:null,titleId:null,prefix:null,transform:dc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function lB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},t=Zce(n),i=t.iconName,s=t.prefix,r=t.rest,o=Yce(n),a=lM("parseNodeAttributes",{},n),l=e.styleParser?Kce(n):[];return Qe({iconName:i,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:dc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:r,styles:l,attributes:o}},a)}var Qce=hl.styles;function YK(n){var e=vt.autoReplaceSvg==="nest"?lB(n,{styleParser:!1}):lB(n);return~e.extra.classes.indexOf(NK)?Ju("generateLayersText",n,e):Ju("generateSvgReplacementMutation",n,e)}function cB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!nh)return Promise.resolve();var t=on.documentElement.classList,i=function(h){return t.add("".concat(Q9,"-").concat(h))},s=function(h){return t.remove("".concat(Q9,"-").concat(h))},r=vt.autoFetchSvg?Object.keys(UO):Object.keys(Qce),o=[".".concat(NK,":not([").concat(np,"])")].concat(r.map(function(u){return".".concat(u,":not([").concat(np,"])")})).join(", ");if(o.length===0)return Promise.resolve();var a=[];try{a=kb(n.querySelectorAll(o))}catch{}if(a.length>0)i("pending"),s("complete");else return Promise.resolve();var l=XO.begin("onTree"),c=a.reduce(function(u,h){try{var d=YK(h);d&&u.push(d)}catch(f){AK||f.name==="MissingIcon"&&console.error(f)}return u},[]);return new Promise(function(u,h){Promise.all(c).then(function(d){KK(d,function(){i("active"),i("complete"),s("pending"),typeof e=="function"&&e(),l(),u()})}).catch(function(d){l(),h(d)})})}function Jce(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;YK(n).then(function(t){t&&KK([t],e)})}function eue(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:cM(e||{}),s=t.mask;return s&&(s=(s||{}).icon?s:cM(s||{})),n(i,Qe(Qe({},t),{},{mask:s}))}}var tue=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transform,s=i===void 0?dc:i,r=t.symbol,o=r===void 0?!1:r,a=t.mask,l=a===void 0?null:a,c=t.maskId,u=c===void 0?null:c,h=t.title,d=h===void 0?null:h,f=t.titleId,g=f===void 0?null:f,p=t.classes,m=p===void 0?[]:p,b=t.attributes,v=b===void 0?{}:b,w=t.styles,y=w===void 0?{}:w;if(e){var x=e.prefix,D=e.iconName,S=e.icon;return dE(Qe({type:"icon"},e),function(){return sp("beforeDOMElementCreation",{iconDefinition:e,params:t}),vt.autoA11y&&(d?v["aria-labelledby"]="".concat(vt.replacementClass,"-title-").concat(g||_w()):(v["aria-hidden"]="true",v.focusable="false")),YO({icons:{main:uM(S),mask:l?uM(l.icon):{found:!1,width:null,height:null,icon:{}}},prefix:x,iconName:D,transform:Qe(Qe({},dc),s),symbol:o,title:d,maskId:u,titleId:g,extra:{attributes:v,styles:y,classes:m}})})}},iue={mixout:function(){return{icon:eue(tue)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=cB,t.nodeCallback=Jce,t}}},provides:function(e){e.i2svg=function(t){var i=t.node,s=i===void 0?on:i,r=t.callback,o=r===void 0?function(){}:r;return cB(s,o)},e.generateSvgReplacementMutation=function(t,i){var s=i.iconName,r=i.title,o=i.titleId,a=i.prefix,l=i.transform,c=i.symbol,u=i.mask,h=i.maskId,d=i.extra;return new Promise(function(f,g){Promise.all([hM(s,a),u.iconName?hM(u.iconName,u.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(p){var m=VO(p,2),b=m[0],v=m[1];f([t,YO({icons:{main:b,mask:v},prefix:a,iconName:s,transform:l,symbol:c,maskId:h,title:r,titleId:o,extra:d,watchable:!0})])}).catch(g)})},e.generateAbstractIcon=function(t){var i=t.children,s=t.attributes,r=t.main,o=t.transform,a=t.styles,l=cE(a);l.length>0&&(s.style=l);var c;return qO(o)&&(c=Ju("generateAbstractTransformGrouping",{main:r,transform:o,containerWidth:r.width,iconWidth:r.width})),i.push(c||r.icon),{children:i,attributes:s}}}},nue={mixout:function(){return{layer:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.classes,r=s===void 0?[]:s;return dE({type:"layer"},function(){sp("beforeDOMElementCreation",{assembler:t,params:i});var o=[];return t(function(a){Array.isArray(a)?a.map(function(l){o=o.concat(l.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(vt.familyPrefix,"-layers")].concat(lE(r)).join(" ")},children:o}]})}}}},sue={mixout:function(){return{counter:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.title,r=s===void 0?null:s,o=i.classes,a=o===void 0?[]:o,l=i.attributes,c=l===void 0?{}:l,u=i.styles,h=u===void 0?{}:u;return dE({type:"counter",content:t},function(){return sp("beforeDOMElementCreation",{content:t,params:i}),Oce({content:t.toString(),title:r,extra:{attributes:c,styles:h,classes:["".concat(vt.familyPrefix,"-layers-counter")].concat(lE(a))}})})}}}},rue={mixout:function(){return{text:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.transform,r=s===void 0?dc:s,o=i.title,a=o===void 0?null:o,l=i.classes,c=l===void 0?[]:l,u=i.attributes,h=u===void 0?{}:u,d=i.styles,f=d===void 0?{}:d;return dE({type:"text",content:t},function(){return sp("beforeDOMElementCreation",{content:t,params:i}),nB({content:t,transform:Qe(Qe({},dc),r),title:a,extra:{attributes:h,styles:f,classes:["".concat(vt.familyPrefix,"-layers-text")].concat(lE(c))}})})}}},provides:function(e){e.generateLayersText=function(t,i){var s=i.title,r=i.transform,o=i.extra,a=null,l=null;if(DK){var c=parseInt(getComputedStyle(t).fontSize,10),u=t.getBoundingClientRect();a=u.width/c,l=u.height/c}return vt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,nB({content:t.innerHTML,width:a,height:l,transform:r,title:s,extra:o,watchable:!0})])}}},oue=new RegExp('"',"ug"),uB=[1105920,1112319];function aue(n){var e=n.replace(oue,""),t=wce(e,0),i=t>=uB[0]&&t<=uB[1],s=e.length===2?e[0]===e[1]:!1;return{value:oM(s?e[0]:e),isSecondary:i||s}}function hB(n,e){var t="".concat(Kle).concat(e.replace(":","-"));return new Promise(function(i,s){if(n.getAttribute(t)!==null)return i();var r=kb(n.children),o=r.filter(function(D){return D.getAttribute(rM)===e})[0],a=Vd.getComputedStyle(n,e),l=a.getPropertyValue("font-family").match(Jle),c=a.getPropertyValue("font-weight"),u=a.getPropertyValue("content");if(o&&!l)return n.removeChild(o),i();if(l&&u!=="none"&&u!==""){var h=a.getPropertyValue("content"),d=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(l[2])?Ak[l[2].toLowerCase()]:ece[c],f=aue(h),g=f.value,p=f.isSecondary,m=l[0].startsWith("FontAwesome"),b=KO(d,g),v=b;if(m){var w=Dce(g);w.iconName&&w.prefix&&(b=w.iconName,d=w.prefix)}if(b&&!p&&(!o||o.getAttribute(zO)!==d||o.getAttribute(HO)!==v)){n.setAttribute(t,v),o&&n.removeChild(o);var y=Xce(),x=y.extra;x.attributes[rM]=e,hM(b,d).then(function(D){var S=YO(Qe(Qe({},y),{},{icons:{main:D,mask:ZO()},prefix:d,iconName:v,extra:x,watchable:!0})),T=on.createElement("svg");e==="::before"?n.insertBefore(T,n.firstChild):n.appendChild(T),T.outerHTML=S.map(function(k){return kC(k)}).join(`
`),n.removeAttribute(t),i()}).catch(s)}else i()}else i()})}function lue(n){return Promise.all([hB(n,"::before"),hB(n,"::after")])}function cue(n){return n.parentNode!==document.head&&!~Yle.indexOf(n.tagName.toUpperCase())&&!n.getAttribute(rM)&&(!n.parentNode||n.parentNode.tagName!=="svg")}function dB(n){if(nh)return new Promise(function(e,t){var i=kb(n.querySelectorAll("*")).filter(cue).map(lue),s=XO.begin("searchPseudoElements");ZK(),Promise.all(i).then(function(){s(),fM(),e()}).catch(function(){s(),fM(),t()})})}var uue={hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=dB,t}}},provides:function(e){e.pseudoElements2svg=function(t){var i=t.node,s=i===void 0?on:i;vt.searchPseudoElements&&dB(s)}}},fB=!1,hue={mixout:function(){return{dom:{unwatch:function(){ZK(),fB=!0}}}},hooks:function(){return{bootstrap:function(){aB(lM("mutationObserverCallbacks",{}))},noAuto:function(){Gce()},watch:function(t){var i=t.observeMutationsRoot;fB?fM():aB(lM("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},gB=function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,s){var r=s.toLowerCase().split("-"),o=r[0],a=r.slice(1).join("-");if(o&&a==="h")return i.flipX=!0,i;if(o&&a==="v")return i.flipY=!0,i;if(a=parseFloat(a),isNaN(a))return i;switch(o){case"grow":i.size=i.size+a;break;case"shrink":i.size=i.size-a;break;case"left":i.x=i.x-a;break;case"right":i.x=i.x+a;break;case"up":i.y=i.y-a;break;case"down":i.y=i.y+a;break;case"rotate":i.rotate=i.rotate+a;break}return i},t)},due={mixout:function(){return{parse:{transform:function(t){return gB(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-transform");return s&&(t.transform=gB(s)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var i=t.main,s=t.transform,r=t.containerWidth,o=t.iconWidth,a={transform:"translate(".concat(r/2," 256)")},l="translate(".concat(s.x*32,", ").concat(s.y*32,") "),c="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),u="rotate(".concat(s.rotate," 0 0)"),h={transform:"".concat(l," ").concat(c," ").concat(u)},d={transform:"translate(".concat(o/2*-1," -256)")},f={outer:a,inner:h,path:d};return{tag:"g",attributes:Qe({},f.outer),children:[{tag:"g",attributes:Qe({},f.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:Qe(Qe({},i.icon.attributes),f.path)}]}]}}}},zA={x:0,y:0,width:"100%",height:"100%"};function pB(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.attributes&&(n.attributes.fill||e)&&(n.attributes.fill="black"),n}function fue(n){return n.tag==="g"?n.children:[n]}var gue={hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-mask"),r=s?hE(s.split(" ").map(function(o){return o.trim()})):ZO();return r.prefix||(r.prefix=$d()),t.mask=r,t.maskId=i.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var i=t.children,s=t.attributes,r=t.main,o=t.mask,a=t.maskId,l=t.transform,c=r.width,u=r.icon,h=o.width,d=o.icon,f=dce({transform:l,containerWidth:h,iconWidth:c}),g={tag:"rect",attributes:Qe(Qe({},zA),{},{fill:"white"})},p=u.children?{children:u.children.map(pB)}:{},m={tag:"g",attributes:Qe({},f.inner),children:[pB(Qe({tag:u.tag,attributes:Qe(Qe({},u.attributes),f.path)},p))]},b={tag:"g",attributes:Qe({},f.outer),children:[m]},v="mask-".concat(a||_w()),w="clip-".concat(a||_w()),y={tag:"mask",attributes:Qe(Qe({},zA),{},{id:v,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,b]},x={tag:"defs",children:[{tag:"clipPath",attributes:{id:w},children:fue(d)},y]};return i.push(x,{tag:"rect",attributes:Qe({fill:"currentColor","clip-path":"url(#".concat(w,")"),mask:"url(#".concat(v,")")},zA)}),{children:i,attributes:s}}}},pue={provides:function(e){var t=!1;Vd.matchMedia&&(t=Vd.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],s={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:Qe(Qe({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Qe(Qe({},r),{},{attributeName:"opacity"}),a={tag:"circle",attributes:Qe(Qe({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:Qe(Qe({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Qe(Qe({},o),{},{values:"1;0;1;1;0;1;"})}),i.push(a),i.push({tag:"path",attributes:Qe(Qe({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:Qe(Qe({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||i.push({tag:"path",attributes:Qe(Qe({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Qe(Qe({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},mue={hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-symbol"),r=s===null?!1:s===""?!0:s;return t.symbol=r,t}}}},_ue=[pce,iue,nue,sue,rue,uue,hue,due,gue,pue,mue];Ace(_ue,{mixoutsTo:Uo});Uo.noAuto;Uo.config;Uo.library;Uo.dom;Uo.parse;Uo.findIconDefinition;Uo.toHtml;var mB=Uo.icon;Uo.layer;Uo.text;Uo.counter;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var bue={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 400c-18 0-32-14-32-32s13.1-32 32-32c17.1 0 32 14 32 32S273.1 400 256 400zM325.1 258L280 286V288c0 13-11 24-24 24S232 301 232 288V272c0-8 4-16 12-21l57-34C308 213 312 206 312 198C312 186 301.1 176 289.1 176h-51.1C225.1 176 216 186 216 198c0 13-11 24-24 24s-24-11-24-24C168 159 199 128 237.1 128h51.1C329 128 360 159 360 198C360 222 347 245 325.1 258z"]},vue=bue,wue={prefix:"fas",iconName:"table-columns",icon:[512,512,["columns"],"f0db","M0 96C0 60.65 28.65 32 64 32H448C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96zM64 416H224V160H64V416zM448 160H288V416H448V160z"]},yue=wue;function uf(n,e,t){return n.fields=e||[],n.fname=t,n}function Cue(n){return n==null?null:n.fname}function XK(n){return n==null?null:n.fields}function Sue(n){return n.length===1?xue(n[0]):kue(n)}const xue=n=>function(e){return e[n]},kue=n=>{const e=n.length;return function(t){for(let i=0;i<e;++i)t=t[n[i]];return t}};function bn(n){throw Error(n)}function Lue(n){const e=[],t=n.length;let i=null,s=0,r="",o,a,l;n=n+"";function c(){e.push(r+n.substring(o,a)),r="",o=a+1}for(o=a=0;a<t;++a)if(l=n[a],l==="\\")r+=n.substring(o,a),r+=n.substring(++a,++a),o=a;else if(l===i)c(),i=null,s=-1;else{if(i)continue;o===s&&l==='"'||o===s&&l==="'"?(o=a+1,i=l):l==="."&&!s?a>o?c():o=a+1:l==="["?(a>o&&c(),s=o=a+1):l==="]"&&(s||bn("Access path missing open bracket: "+n),s>0&&c(),s=0,o=a+1)}return s&&bn("Access path missing closing bracket: "+n),i&&bn("Access path missing closing quote: "+n),a>o&&(a++,c()),e}function fE(n,e,t){const i=Lue(n);return n=i.length===1?i[0]:n,uf((t&&t.get||Sue)(i),[n],e||n)}fE("id");const gE=uf(n=>n,[],"identity");uf(()=>0,[],"zero");uf(()=>1,[],"one");uf(()=>!0,[],"true");uf(()=>!1,[],"false");var jo=Array.isArray;function Ll(n){return n===Object(n)}function _l(n){return n[n.length-1]}function bw(n){return n==null||n===""?null:+n}const QK=n=>e=>n*Math.exp(e),JK=n=>e=>Math.log(n*e),Due=n=>e=>Math.sign(e)*Math.log1p(Math.abs(e/n)),Eue=n=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*n,Rk=n=>e=>e<0?-Math.pow(-e,n):Math.pow(e,n);function JO(n,e,t,i){const s=t(n[0]),r=t(_l(n)),o=(r-s)*e;return[i(s-o),i(r-o)]}function Tue(n,e){return JO(n,e,bw,gE)}function Aue(n,e){var t=Math.sign(n[0]);return JO(n,e,JK(t),QK(t))}function Iue(n,e,t){return JO(n,e,Rk(t),Rk(1/t))}function pE(n,e,t,i,s){const r=i(n[0]),o=i(_l(n)),a=e!=null?i(e):(r+o)/2;return[s(a+(r-a)*t),s(a+(o-a)*t)]}function eZ(n,e,t){return pE(n,e,t,bw,gE)}function tZ(n,e,t){const i=Math.sign(n[0]);return pE(n,e,t,JK(i),QK(i))}function gM(n,e,t,i){return pE(n,e,t,Rk(i),Rk(1/i))}function Nue(n,e,t,i){return pE(n,e,t,Due(i),Eue(i))}function pM(n){return n!=null?jo(n)?n:[n]:[]}function Rue(n,e,t){let i=n[0],s=n[1],r;return s<i&&(r=s,s=i,i=r),r=s-i,r>=t-e?[e,t]:[i=Math.min(Math.max(i,e),t-r),i+r]}function go(n){return typeof n=="function"}const Mue="descending";function iZ(n,e,t){t=t||{},e=pM(e)||[];const i=[],s=[],r={},o=t.comparator||Fue;return pM(n).forEach((a,l)=>{a!=null&&(i.push(e[l]===Mue?-1:1),s.push(a=go(a)?a:fE(a,null,t)),(XK(a)||[]).forEach(c=>r[c]=1))}),s.length===0?null:uf(o(s,i),Object.keys(r))}const nZ=(n,e)=>(n<e||n==null)&&e!=null?-1:(n>e||e==null)&&n!=null?1:(e=e instanceof Date?+e:e,(n=n instanceof Date?+n:n)!==n&&e===e?-1:e!==e&&n===n?1:0),Fue=(n,e)=>n.length===1?Pue(n[0],e[0]):Oue(n,e,n.length),Pue=(n,e)=>function(t,i){return nZ(n(t),n(i))*e},Oue=(n,e,t)=>(e.push(0),function(i,s){let r,o=0,a=-1;for(;o===0&&++a<t;)r=n[a],o=nZ(r(i),r(s));return o*e[a]});function Bue(n){return go(n)?n:()=>n}function e5(n){for(let e,t,i=1,s=arguments.length;i<s;++i){e=arguments[i];for(t in e)n[t]=e[t]}return n}const Wue=Object.prototype.hasOwnProperty;function gg(n,e){return Wue.call(n,e)}function mE(n){return typeof n=="boolean"}function Vue(n){return Object.prototype.toString.call(n)==="[object Date]"}function $ue(n){return n&&go(n[Symbol.iterator])}function bo(n){return typeof n=="number"}function wn(n){return typeof n=="string"}function zue(n,e){const t=n[0],i=_l(n),s=+e;return s?s===1?i:t+s*(i-t):t}function Mk(n){return n&&_l(n)-n[0]||0}function _E(n){return jo(n)?"["+n.map(_E)+"]":Ll(n)||wn(n)?JSON.stringify(n).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):n}function Hue(n){return n==null||n===""?null:!n||n==="false"||n==="0"?!1:!!n}const Uue=n=>bo(n)||Vue(n)?n:Date.parse(n);function jue(n,e){return e=e||Uue,n==null||n===""?null:e(n)}function que(n){return n==null||n===""?null:n+""}function Fk(n){const e={},t=n.length;for(let i=0;i<t;++i)e[n[i]]=!0;return e}var _B={},HA={},UA=34,l1=10,jA=13;function sZ(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Gue(n,e){var t=sZ(n);return function(i,s){return e(t(i),s,n)}}function bB(n){var e=Object.create(null),t=[];return n.forEach(function(i){for(var s in i)s in e||t.push(e[s]=s)}),t}function Yr(n,e){var t=n+"",i=t.length;return i<e?new Array(e-i+1).join(0)+t:t}function Kue(n){return n<0?"-"+Yr(-n,6):n>9999?"+"+Yr(n,6):Yr(n,4)}function Zue(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),i=n.getUTCSeconds(),s=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Kue(n.getUTCFullYear())+"-"+Yr(n.getUTCMonth()+1,2)+"-"+Yr(n.getUTCDate(),2)+(s?"T"+Yr(e,2)+":"+Yr(t,2)+":"+Yr(i,2)+"."+Yr(s,3)+"Z":i?"T"+Yr(e,2)+":"+Yr(t,2)+":"+Yr(i,2)+"Z":t||e?"T"+Yr(e,2)+":"+Yr(t,2)+"Z":"")}function rZ(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function i(h,d){var f,g,p=s(h,function(m,b){if(f)return f(m,b-1);g=m,f=d?Gue(m,d):sZ(m)});return p.columns=g||[],p}function s(h,d){var f=[],g=h.length,p=0,m=0,b,v=g<=0,w=!1;h.charCodeAt(g-1)===l1&&--g,h.charCodeAt(g-1)===jA&&--g;function y(){if(v)return HA;if(w)return w=!1,_B;var D,S=p,T;if(h.charCodeAt(S)===UA){for(;p++<g&&h.charCodeAt(p)!==UA||h.charCodeAt(++p)===UA;);return(D=p)>=g?v=!0:(T=h.charCodeAt(p++))===l1?w=!0:T===jA&&(w=!0,h.charCodeAt(p)===l1&&++p),h.slice(S+1,D-1).replace(/""/g,'"')}for(;p<g;){if((T=h.charCodeAt(D=p++))===l1)w=!0;else if(T===jA)w=!0,h.charCodeAt(p)===l1&&++p;else if(T!==t)continue;return h.slice(S,D)}return v=!0,h.slice(S,g)}for(;(b=y())!==HA;){for(var x=[];b!==_B&&b!==HA;)x.push(b),b=y();d&&(x=d(x,m++))==null||f.push(x)}return f}function r(h,d){return h.map(function(f){return d.map(function(g){return u(f[g])}).join(n)})}function o(h,d){return d==null&&(d=bB(h)),[d.map(u).join(n)].concat(r(h,d)).join(`
`)}function a(h,d){return d==null&&(d=bB(h)),r(h,d).join(`
`)}function l(h){return h.map(c).join(`
`)}function c(h){return h.map(u).join(n)}function u(h){return h==null?"":h instanceof Date?Zue(h):e.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:i,parseRows:s,format:o,formatBody:a,formatRows:l,formatRow:c,formatValue:u}}var Yue=rZ("	"),Xue=Yue.parseRows;function Que(n){return n}function Jue(n){if(n==null)return Que;var e,t,i=n.scale[0],s=n.scale[1],r=n.translate[0],o=n.translate[1];return function(a,l){l||(e=t=0);var c=2,u=a.length,h=new Array(u);for(h[0]=(e+=a[0])*i+r,h[1]=(t+=a[1])*s+o;c<u;)h[c]=a[c],++c;return h}}function ehe(n,e){for(var t,i=n.length,s=i-e;s<--i;)t=n[s],n[s++]=n[i],n[i]=t}function the(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(t){return vB(n,t)})}:vB(n,e)}function vB(n,e){var t=e.id,i=e.bbox,s=e.properties==null?{}:e.properties,r=oZ(n,e);return t==null&&i==null?{type:"Feature",properties:s,geometry:r}:i==null?{type:"Feature",id:t,properties:s,geometry:r}:{type:"Feature",id:t,bbox:i,properties:s,geometry:r}}function oZ(n,e){var t=Jue(n.transform),i=n.arcs;function s(u,h){h.length&&h.pop();for(var d=i[u<0?~u:u],f=0,g=d.length;f<g;++f)h.push(t(d[f],f));u<0&&ehe(h,g)}function r(u){return t(u)}function o(u){for(var h=[],d=0,f=u.length;d<f;++d)s(u[d],h);return h.length<2&&h.push(h[0]),h}function a(u){for(var h=o(u);h.length<4;)h.push(h[0]);return h}function l(u){return u.map(a)}function c(u){var h=u.type,d;switch(h){case"GeometryCollection":return{type:h,geometries:u.geometries.map(c)};case"Point":d=r(u.coordinates);break;case"MultiPoint":d=u.coordinates.map(r);break;case"LineString":d=o(u.arcs);break;case"MultiLineString":d=u.arcs.map(o);break;case"Polygon":d=l(u.arcs);break;case"MultiPolygon":d=u.arcs.map(l);break;default:return null}return{type:h,coordinates:d}}return c(e)}function ihe(n,e){var t={},i={},s={},r=[],o=-1;e.forEach(function(c,u){var h=n.arcs[c<0?~c:c],d;h.length<3&&!h[1][0]&&!h[1][1]&&(d=e[++o],e[o]=c,e[u]=d)}),e.forEach(function(c){var u=a(c),h=u[0],d=u[1],f,g;if(f=s[h])if(delete s[f.end],f.push(c),f.end=d,g=i[d]){delete i[g.start];var p=g===f?f:f.concat(g);i[p.start=f.start]=s[p.end=g.end]=p}else i[f.start]=s[f.end]=f;else if(f=i[d])if(delete i[f.start],f.unshift(c),f.start=h,g=s[h]){delete s[g.end];var m=g===f?f:g.concat(f);i[m.start=g.start]=s[m.end=f.end]=m}else i[f.start]=s[f.end]=f;else f=[c],i[f.start=h]=s[f.end=d]=f});function a(c){var u=n.arcs[c<0?~c:c],h=u[0],d;return n.transform?(d=[0,0],u.forEach(function(f){d[0]+=f[0],d[1]+=f[1]})):d=u[u.length-1],c<0?[d,h]:[h,d]}function l(c,u){for(var h in c){var d=c[h];delete u[d.start],delete d.start,delete d.end,d.forEach(function(f){t[f<0?~f:f]=1}),r.push(d)}}return l(s,i),l(i,s),e.forEach(function(c){t[c<0?~c:c]||r.push([c])}),r}function nhe(n){return oZ(n,she.apply(this,arguments))}function she(n,e,t){var i,s,r;if(arguments.length>1)i=rhe(n,e,t);else for(s=0,i=new Array(r=n.arcs.length);s<r;++s)i[s]=s;return{type:"MultiLineString",arcs:ihe(n,i)}}function rhe(n,e,t){var i=[],s=[],r;function o(h){var d=h<0?~h:h;(s[d]||(s[d]=[])).push({i:h,g:r})}function a(h){h.forEach(o)}function l(h){h.forEach(a)}function c(h){h.forEach(l)}function u(h){switch(r=h,h.type){case"GeometryCollection":h.geometries.forEach(u);break;case"LineString":a(h.arcs);break;case"MultiLineString":case"Polygon":l(h.arcs);break;case"MultiPolygon":c(h.arcs);break}}return u(e),s.forEach(t==null?function(h){i.push(h[0].i)}:function(h){t(h[0].g,h[h.length-1].g)&&i.push(h[0].i)}),i}function Dv(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function ohe(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function bE(n){let e,t,i;n.length!==2?(e=Dv,t=(a,l)=>Dv(n(a),l),i=(a,l)=>n(a)-l):(e=n===Dv||n===ohe?n:ahe,t=n,i=n);function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;t(a[h],l)<0?c=h+1:u=h}while(c<u)}return c}function r(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;t(a[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function o(a,l,c=0,u=a.length){const h=s(a,l,c,u-1);return h>c&&i(a[h-1],l)>-i(a[h],l)?h-1:h}return{left:s,center:o,right:r}}function ahe(){return 0}function aZ(n){return n===null?NaN:+n}const lZ=bE(Dv),mM=lZ.right;lZ.left;bE(aZ).center;const Lb=mM;function lhe(n,e){let t,i;if(e===void 0)for(const s of n)s!=null&&(t===void 0?s>=s&&(t=i=s):(t>s&&(t=s),i<s&&(i=s)));else{let s=-1;for(let r of n)(r=e(r,++s,n))!=null&&(t===void 0?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)))}return[t,i]}class rp extends Map{constructor(e,t=hhe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[i,s]of e)this.set(i,s)}get(e){return super.get(wB(this,e))}has(e){return super.has(wB(this,e))}set(e,t){return super.set(che(this,e),t)}delete(e){return super.delete(uhe(this,e))}}function wB({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):t}function che({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function uhe({_intern:n,_key:e},t){const i=e(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function hhe(n){return n!==null&&typeof n=="object"?n.valueOf():n}function _M(n){return n}function vE(n,...e){return cZ(n,_M,_M,e)}function dhe(n,...e){return cZ(n,Array.from,_M,e)}function cZ(n,e,t,i){return function s(r,o){if(o>=i.length)return t(r);const a=new rp,l=i[o++];let c=-1;for(const u of r){const h=l(u,++c,r),d=a.get(h);d?d.push(u):a.set(h,[u])}for(const[u,h]of a)a.set(u,s(h,o));return e(a)}(n,0)}var bM=Math.sqrt(50),vM=Math.sqrt(10),wM=Math.sqrt(2);function Pk(n,e,t){var i,s=-1,r,o,a;if(e=+e,n=+n,t=+t,n===e&&t>0)return[n];if((i=e<n)&&(r=n,n=e,e=r),(a=uZ(n,e,t))===0||!isFinite(a))return[];if(a>0){let l=Math.round(n/a),c=Math.round(e/a);for(l*a<n&&++l,c*a>e&&--c,o=new Array(r=c-l+1);++s<r;)o[s]=(l+s)*a}else{a=-a;let l=Math.round(n*a),c=Math.round(e*a);for(l/a<n&&++l,c/a>e&&--c,o=new Array(r=c-l+1);++s<r;)o[s]=(l+s)/a}return i&&o.reverse(),o}function uZ(n,e,t){var i=(e-n)/Math.max(0,t),s=Math.floor(Math.log(i)/Math.LN10),r=i/Math.pow(10,s);return s>=0?(r>=bM?10:r>=vM?5:r>=wM?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(r>=bM?10:r>=vM?5:r>=wM?2:1)}function op(n,e,t){var i=Math.abs(e-n)/Math.max(0,t),s=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/s;return r>=bM?s*=10:r>=vM?s*=5:r>=wM&&(s*=2),e<n?-s:s}function hZ(n,e,t=aZ){if(i=n.length){if((e=+e)<=0||i<2)return+t(n[0],0,n);if(e>=1)return+t(n[i-1],i-1,n);var i,s=(i-1)*e,r=Math.floor(s),o=+t(n[r],r,n),a=+t(n[r+1],r+1,n);return o+(a-o)*(s-r)}}function vw(n,e,t){n=+n,e=+e,t=(s=arguments.length)<2?(e=n,n=0,1):s<3?1:+t;for(var i=-1,s=Math.max(0,Math.ceil((e-n)/t))|0,r=new Array(s);++i<s;)r[i]=n+i*t;return r}function HS(n,e){let t=0;if(e===void 0)for(let i of n)(i=+i)&&(t+=i);else{let i=-1;for(let s of n)(s=+e(s,++i,n))&&(t+=s)}return t}function fhe(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Ok(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function L_(n){return n=Ok(Math.abs(n)),n?n[1]:NaN}function ghe(n,e){return function(t,i){for(var s=t.length,r=[],o=0,a=n[0],l=0;s>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),r.push(t.substring(s-=a,s+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return r.reverse().join(e)}}function phe(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var mhe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zd(n){if(!(e=mhe.exec(n)))throw new Error("invalid format: "+n);var e;return new t5({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}zd.prototype=t5.prototype;function t5(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}t5.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _he(n){e:for(var e=n.length,t=1,i=-1,s;t<e;++t)switch(n[t]){case".":i=s=t;break;case"0":i===0&&(i=t),s=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(s+1):n}var dZ;function bhe(n,e){var t=Ok(n,e);if(!t)return n+"";var i=t[0],s=t[1],r=s-(dZ=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+Ok(n,Math.max(0,e+r-1))[0]}function yB(n,e){var t=Ok(n,e);if(!t)return n+"";var i=t[0],s=t[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}const CB={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:fhe,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>yB(n*100,e),r:yB,s:bhe,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function SB(n){return n}var xB=Array.prototype.map,kB=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function vhe(n){var e=n.grouping===void 0||n.thousands===void 0?SB:ghe(xB.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",r=n.numerals===void 0?SB:phe(xB.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"−":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function c(h){h=zd(h);var d=h.fill,f=h.align,g=h.sign,p=h.symbol,m=h.zero,b=h.width,v=h.comma,w=h.precision,y=h.trim,x=h.type;x==="n"?(v=!0,x="g"):CB[x]||(w===void 0&&(w=12),y=!0,x="g"),(m||d==="0"&&f==="=")&&(m=!0,d="0",f="=");var D=p==="$"?t:p==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",S=p==="$"?i:/[%p]/.test(x)?o:"",T=CB[x],k=/[defgprs%]/.test(x);w=w===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function I(N){var z=D,$=S,q,ne,de;if(x==="c")$=T(N)+$,N="";else{N=+N;var me=N<0||1/N<0;if(N=isNaN(N)?l:T(Math.abs(N),w),y&&(N=_he(N)),me&&+N==0&&g!=="+"&&(me=!1),z=(me?g==="("?g:a:g==="-"||g==="("?"":g)+z,$=(x==="s"?kB[8+dZ/3]:"")+$+(me&&g==="("?")":""),k){for(q=-1,ne=N.length;++q<ne;)if(de=N.charCodeAt(q),48>de||de>57){$=(de===46?s+N.slice(q+1):N.slice(q))+$,N=N.slice(0,q);break}}}v&&!m&&(N=e(N,1/0));var De=z.length+N.length+$.length,ve=De<b?new Array(b-De+1).join(d):"";switch(v&&m&&(N=e(ve+N,ve.length?b-$.length:1/0),ve=""),f){case"<":N=z+N+$+ve;break;case"=":N=z+ve+N+$;break;case"^":N=ve.slice(0,De=ve.length>>1)+z+N+$+ve.slice(De);break;default:N=ve+z+N+$;break}return r(N)}return I.toString=function(){return h+""},I}function u(h,d){var f=c((h=zd(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(L_(d)/3)))*3,p=Math.pow(10,-g),m=kB[8+g/3];return function(b){return f(p*b)+m}}return{format:c,formatPrefix:u}}var US,js,i5;whe({thousands:",",grouping:[3],currency:["$",""]});function whe(n){return US=vhe(n),js=US.format,i5=US.formatPrefix,US}function fZ(n){return Math.max(0,-L_(Math.abs(n)))}function gZ(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(L_(e)/3)))*3-L_(Math.abs(n)))}function pZ(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,L_(e)-L_(n))+1}var qA=new Date,GA=new Date;function As(n,e,t,i){function s(r){return n(r=arguments.length===0?new Date:new Date(+r)),r}return s.floor=function(r){return n(r=new Date(+r)),r},s.ceil=function(r){return n(r=new Date(r-1)),e(r,1),n(r),r},s.round=function(r){var o=s(r),a=s.ceil(r);return r-o<a-r?o:a},s.offset=function(r,o){return e(r=new Date(+r),o==null?1:Math.floor(o)),r},s.range=function(r,o,a){var l=[],c;if(r=s.ceil(r),a=a==null?1:Math.floor(a),!(r<o)||!(a>0))return l;do l.push(c=new Date(+r)),e(r,a),n(r);while(c<r&&r<o);return l},s.filter=function(r){return As(function(o){if(o>=o)for(;n(o),!r(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!r(o););else for(;--a>=0;)for(;e(o,1),!r(o););})},t&&(s.count=function(r,o){return qA.setTime(+r),GA.setTime(+o),n(qA),n(GA),Math.floor(t(qA,GA))},s.every=function(r){return r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?s.filter(i?function(o){return i(o)%r===0}:function(o){return s.count(0,o)%r===0}):s}),s}var Bk=As(function(){},function(n,e){n.setTime(+n+e)},function(n,e){return e-n});Bk.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?As(function(e){e.setTime(Math.floor(e/n)*n)},function(e,t){e.setTime(+e+t*n)},function(e,t){return(t-e)/n}):Bk};const n5=Bk;Bk.range;const Mu=1e3,oa=Mu*60,Fu=oa*60,ap=Fu*24,s5=ap*7,LB=ap*30,KA=ap*365;var mZ=As(function(n){n.setTime(n-n.getMilliseconds())},function(n,e){n.setTime(+n+e*Mu)},function(n,e){return(e-n)/Mu},function(n){return n.getUTCSeconds()});const Jh=mZ;mZ.range;var _Z=As(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*Mu)},function(n,e){n.setTime(+n+e*oa)},function(n,e){return(e-n)/oa},function(n){return n.getMinutes()});const r5=_Z;_Z.range;var bZ=As(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*Mu-n.getMinutes()*oa)},function(n,e){n.setTime(+n+e*Fu)},function(n,e){return(e-n)/Fu},function(n){return n.getHours()});const o5=bZ;bZ.range;var vZ=As(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*oa)/ap,n=>n.getDate()-1);const Pg=vZ;vZ.range;function Wp(n){return As(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*oa)/s5})}var LC=Wp(0),Wk=Wp(1),yhe=Wp(2),Che=Wp(3),D_=Wp(4),She=Wp(5),xhe=Wp(6);LC.range;Wk.range;yhe.range;Che.range;D_.range;She.range;xhe.range;var wZ=As(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,e){n.setMonth(n.getMonth()+e)},function(n,e){return e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()});const Vk=wZ;wZ.range;var a5=As(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});a5.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:As(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};const Hd=a5;a5.range;var yZ=As(function(n){n.setUTCSeconds(0,0)},function(n,e){n.setTime(+n+e*oa)},function(n,e){return(e-n)/oa},function(n){return n.getUTCMinutes()});const l5=yZ;yZ.range;var CZ=As(function(n){n.setUTCMinutes(0,0,0)},function(n,e){n.setTime(+n+e*Fu)},function(n,e){return(e-n)/Fu},function(n){return n.getUTCHours()});const c5=CZ;CZ.range;var SZ=As(function(n){n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e-n)/ap},function(n){return n.getUTCDate()-1});const Og=SZ;SZ.range;function Vp(n){return As(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/s5})}var DC=Vp(0),$k=Vp(1),khe=Vp(2),Lhe=Vp(3),E_=Vp(4),Dhe=Vp(5),Ehe=Vp(6);DC.range;$k.range;khe.range;Lhe.range;E_.range;Dhe.range;Ehe.range;var xZ=As(function(n){n.setUTCDate(1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCMonth(n.getUTCMonth()+e)},function(n,e){return e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12},function(n){return n.getUTCMonth()});const zk=xZ;xZ.range;var u5=As(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});u5.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:As(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};const Ud=u5;u5.range;function kZ(n,e,t,i,s,r){const o=[[Jh,1,Mu],[Jh,5,5*Mu],[Jh,15,15*Mu],[Jh,30,30*Mu],[r,1,oa],[r,5,5*oa],[r,15,15*oa],[r,30,30*oa],[s,1,Fu],[s,3,3*Fu],[s,6,6*Fu],[s,12,12*Fu],[i,1,ap],[i,2,2*ap],[t,1,s5],[e,1,LB],[e,3,3*LB],[n,1,KA]];function a(c,u,h){const d=u<c;d&&([c,u]=[u,c]);const f=h&&typeof h.range=="function"?h:l(c,u,h),g=f?f.range(c,+u+1):[];return d?g.reverse():g}function l(c,u,h){const d=Math.abs(u-c)/h,f=bE(([,,m])=>m).right(o,d);if(f===o.length)return n.every(op(c/KA,u/KA,h));if(f===0)return n5.every(Math.max(op(c,u,h),1));const[g,p]=o[d/o[f-1][2]<o[f][2]/d?f-1:f];return g.every(p)}return[a,l]}const[The,Ahe]=kZ(Ud,zk,DC,Og,c5,l5),[Ihe,Nhe]=kZ(Hd,Vk,LC,Pg,o5,r5),ww="year",yw="quarter",Cw="month",Sw="week",xw="date",wE="day",h5="dayofyear",kw="hours",Lw="minutes",Dw="seconds",yE="milliseconds",Rhe=[ww,yw,Cw,Sw,xw,wE,h5,kw,Lw,Dw,yE];Rhe.reduce((n,e,t)=>(n[e]=1+t,n),{});const Mhe={[ww]:Hd,[yw]:Vk.every(3),[Cw]:Vk,[Sw]:LC,[xw]:Pg,[wE]:Pg,[h5]:Pg,[kw]:o5,[Lw]:r5,[Dw]:Jh,[yE]:n5},Fhe={[ww]:Ud,[yw]:zk.every(3),[Cw]:zk,[Sw]:DC,[xw]:Og,[wE]:Og,[h5]:Og,[kw]:c5,[Lw]:l5,[Dw]:Jh,[yE]:n5};function Phe(n){return Mhe[n]}function Ohe(n){return Fhe[n]}function ZA(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function YA(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function c1(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function LZ(n){var e=n.dateTime,t=n.date,i=n.time,s=n.periods,r=n.days,o=n.shortDays,a=n.months,l=n.shortMonths,c=u1(s),u=h1(s),h=u1(r),d=h1(r),f=u1(o),g=h1(o),p=u1(a),m=h1(a),b=u1(l),v=h1(l),w={a:me,A:De,b:ve,B:$e,c:null,d:NB,e:NB,f:ode,g:mde,G:bde,H:nde,I:sde,j:rde,L:DZ,m:ade,M:lde,p:Ne,q:xe,Q:FB,s:PB,S:cde,u:ude,U:hde,V:dde,w:fde,W:gde,x:null,X:null,y:pde,Y:_de,Z:vde,"%":MB},y={a:fe,A:jt,b:mi,B:re,c:null,d:RB,e:RB,f:Sde,g:Rde,G:Fde,H:wde,I:yde,j:Cde,L:TZ,m:xde,M:kde,p:te,q:ye,Q:FB,s:PB,S:Lde,u:Dde,U:Ede,V:Tde,w:Ade,W:Ide,x:null,X:null,y:Nde,Y:Mde,Z:Pde,"%":MB},x={a:I,A:N,b:z,B:$,c:q,d:AB,e:AB,f:Jhe,g:TB,G:EB,H:IB,I:IB,j:Zhe,L:Qhe,m:Khe,M:Yhe,p:k,q:Ghe,Q:tde,s:ide,S:Xhe,u:zhe,U:Hhe,V:Uhe,w:$he,W:jhe,x:ne,X:de,y:TB,Y:EB,Z:qhe,"%":ede};w.x=D(t,w),w.X=D(i,w),w.c=D(e,w),y.x=D(t,y),y.X=D(i,y),y.c=D(e,y);function D(_e,Ie){return function(F){var M=[],pe=-1,ke=0,et=_e.length,Xe,Nt,is;for(F instanceof Date||(F=new Date(+F));++pe<et;)_e.charCodeAt(pe)===37&&(M.push(_e.slice(ke,pe)),(Nt=DB[Xe=_e.charAt(++pe)])!=null?Xe=_e.charAt(++pe):Nt=Xe==="e"?" ":"0",(is=Ie[Xe])&&(Xe=is(F,Nt)),M.push(Xe),ke=pe+1);return M.push(_e.slice(ke,pe)),M.join("")}}function S(_e,Ie){return function(F){var M=c1(1900,void 0,1),pe=T(M,_e,F+="",0),ke,et;if(pe!=F.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(Ie&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(ke=YA(c1(M.y,0,1)),et=ke.getUTCDay(),ke=et>4||et===0?$k.ceil(ke):$k(ke),ke=Og.offset(ke,(M.V-1)*7),M.y=ke.getUTCFullYear(),M.m=ke.getUTCMonth(),M.d=ke.getUTCDate()+(M.w+6)%7):(ke=ZA(c1(M.y,0,1)),et=ke.getDay(),ke=et>4||et===0?Wk.ceil(ke):Wk(ke),ke=Pg.offset(ke,(M.V-1)*7),M.y=ke.getFullYear(),M.m=ke.getMonth(),M.d=ke.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),et="Z"in M?YA(c1(M.y,0,1)).getUTCDay():ZA(c1(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(et+5)%7:M.w+M.U*7-(et+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,YA(M)):ZA(M)}}function T(_e,Ie,F,M){for(var pe=0,ke=Ie.length,et=F.length,Xe,Nt;pe<ke;){if(M>=et)return-1;if(Xe=Ie.charCodeAt(pe++),Xe===37){if(Xe=Ie.charAt(pe++),Nt=x[Xe in DB?Ie.charAt(pe++):Xe],!Nt||(M=Nt(_e,F,M))<0)return-1}else if(Xe!=F.charCodeAt(M++))return-1}return M}function k(_e,Ie,F){var M=c.exec(Ie.slice(F));return M?(_e.p=u.get(M[0].toLowerCase()),F+M[0].length):-1}function I(_e,Ie,F){var M=f.exec(Ie.slice(F));return M?(_e.w=g.get(M[0].toLowerCase()),F+M[0].length):-1}function N(_e,Ie,F){var M=h.exec(Ie.slice(F));return M?(_e.w=d.get(M[0].toLowerCase()),F+M[0].length):-1}function z(_e,Ie,F){var M=b.exec(Ie.slice(F));return M?(_e.m=v.get(M[0].toLowerCase()),F+M[0].length):-1}function $(_e,Ie,F){var M=p.exec(Ie.slice(F));return M?(_e.m=m.get(M[0].toLowerCase()),F+M[0].length):-1}function q(_e,Ie,F){return T(_e,e,Ie,F)}function ne(_e,Ie,F){return T(_e,t,Ie,F)}function de(_e,Ie,F){return T(_e,i,Ie,F)}function me(_e){return o[_e.getDay()]}function De(_e){return r[_e.getDay()]}function ve(_e){return l[_e.getMonth()]}function $e(_e){return a[_e.getMonth()]}function Ne(_e){return s[+(_e.getHours()>=12)]}function xe(_e){return 1+~~(_e.getMonth()/3)}function fe(_e){return o[_e.getUTCDay()]}function jt(_e){return r[_e.getUTCDay()]}function mi(_e){return l[_e.getUTCMonth()]}function re(_e){return a[_e.getUTCMonth()]}function te(_e){return s[+(_e.getUTCHours()>=12)]}function ye(_e){return 1+~~(_e.getUTCMonth()/3)}return{format:function(_e){var Ie=D(_e+="",w);return Ie.toString=function(){return _e},Ie},parse:function(_e){var Ie=S(_e+="",!1);return Ie.toString=function(){return _e},Ie},utcFormat:function(_e){var Ie=D(_e+="",y);return Ie.toString=function(){return _e},Ie},utcParse:function(_e){var Ie=S(_e+="",!0);return Ie.toString=function(){return _e},Ie}}}var DB={"-":"",_:" ",0:"0"},Is=/^\s*\d+/,Bhe=/^%/,Whe=/[\\^$*+?|[\]().{}]/g;function gi(n,e,t){var i=n<0?"-":"",s=(i?-n:n)+"",r=s.length;return i+(r<t?new Array(t-r+1).join(e)+s:s)}function Vhe(n){return n.replace(Whe,"\\$&")}function u1(n){return new RegExp("^(?:"+n.map(Vhe).join("|")+")","i")}function h1(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function $he(n,e,t){var i=Is.exec(e.slice(t,t+1));return i?(n.w=+i[0],t+i[0].length):-1}function zhe(n,e,t){var i=Is.exec(e.slice(t,t+1));return i?(n.u=+i[0],t+i[0].length):-1}function Hhe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.U=+i[0],t+i[0].length):-1}function Uhe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.V=+i[0],t+i[0].length):-1}function jhe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.W=+i[0],t+i[0].length):-1}function EB(n,e,t){var i=Is.exec(e.slice(t,t+4));return i?(n.y=+i[0],t+i[0].length):-1}function TB(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function qhe(n,e,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return i?(n.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function Ghe(n,e,t){var i=Is.exec(e.slice(t,t+1));return i?(n.q=i[0]*3-3,t+i[0].length):-1}function Khe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.m=i[0]-1,t+i[0].length):-1}function AB(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.d=+i[0],t+i[0].length):-1}function Zhe(n,e,t){var i=Is.exec(e.slice(t,t+3));return i?(n.m=0,n.d=+i[0],t+i[0].length):-1}function IB(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.H=+i[0],t+i[0].length):-1}function Yhe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.M=+i[0],t+i[0].length):-1}function Xhe(n,e,t){var i=Is.exec(e.slice(t,t+2));return i?(n.S=+i[0],t+i[0].length):-1}function Qhe(n,e,t){var i=Is.exec(e.slice(t,t+3));return i?(n.L=+i[0],t+i[0].length):-1}function Jhe(n,e,t){var i=Is.exec(e.slice(t,t+6));return i?(n.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function ede(n,e,t){var i=Bhe.exec(e.slice(t,t+1));return i?t+i[0].length:-1}function tde(n,e,t){var i=Is.exec(e.slice(t));return i?(n.Q=+i[0],t+i[0].length):-1}function ide(n,e,t){var i=Is.exec(e.slice(t));return i?(n.s=+i[0],t+i[0].length):-1}function NB(n,e){return gi(n.getDate(),e,2)}function nde(n,e){return gi(n.getHours(),e,2)}function sde(n,e){return gi(n.getHours()%12||12,e,2)}function rde(n,e){return gi(1+Pg.count(Hd(n),n),e,3)}function DZ(n,e){return gi(n.getMilliseconds(),e,3)}function ode(n,e){return DZ(n,e)+"000"}function ade(n,e){return gi(n.getMonth()+1,e,2)}function lde(n,e){return gi(n.getMinutes(),e,2)}function cde(n,e){return gi(n.getSeconds(),e,2)}function ude(n){var e=n.getDay();return e===0?7:e}function hde(n,e){return gi(LC.count(Hd(n)-1,n),e,2)}function EZ(n){var e=n.getDay();return e>=4||e===0?D_(n):D_.ceil(n)}function dde(n,e){return n=EZ(n),gi(D_.count(Hd(n),n)+(Hd(n).getDay()===4),e,2)}function fde(n){return n.getDay()}function gde(n,e){return gi(Wk.count(Hd(n)-1,n),e,2)}function pde(n,e){return gi(n.getFullYear()%100,e,2)}function mde(n,e){return n=EZ(n),gi(n.getFullYear()%100,e,2)}function _de(n,e){return gi(n.getFullYear()%1e4,e,4)}function bde(n,e){var t=n.getDay();return n=t>=4||t===0?D_(n):D_.ceil(n),gi(n.getFullYear()%1e4,e,4)}function vde(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+gi(e/60|0,"0",2)+gi(e%60,"0",2)}function RB(n,e){return gi(n.getUTCDate(),e,2)}function wde(n,e){return gi(n.getUTCHours(),e,2)}function yde(n,e){return gi(n.getUTCHours()%12||12,e,2)}function Cde(n,e){return gi(1+Og.count(Ud(n),n),e,3)}function TZ(n,e){return gi(n.getUTCMilliseconds(),e,3)}function Sde(n,e){return TZ(n,e)+"000"}function xde(n,e){return gi(n.getUTCMonth()+1,e,2)}function kde(n,e){return gi(n.getUTCMinutes(),e,2)}function Lde(n,e){return gi(n.getUTCSeconds(),e,2)}function Dde(n){var e=n.getUTCDay();return e===0?7:e}function Ede(n,e){return gi(DC.count(Ud(n)-1,n),e,2)}function AZ(n){var e=n.getUTCDay();return e>=4||e===0?E_(n):E_.ceil(n)}function Tde(n,e){return n=AZ(n),gi(E_.count(Ud(n),n)+(Ud(n).getUTCDay()===4),e,2)}function Ade(n){return n.getUTCDay()}function Ide(n,e){return gi($k.count(Ud(n)-1,n),e,2)}function Nde(n,e){return gi(n.getUTCFullYear()%100,e,2)}function Rde(n,e){return n=AZ(n),gi(n.getUTCFullYear()%100,e,2)}function Mde(n,e){return gi(n.getUTCFullYear()%1e4,e,4)}function Fde(n,e){var t=n.getUTCDay();return n=t>=4||t===0?E_(n):E_.ceil(n),gi(n.getUTCFullYear()%1e4,e,4)}function Pde(){return"+0000"}function MB(){return"%"}function FB(n){return+n}function PB(n){return Math.floor(+n/1e3)}var Cm,d5,IZ,f5,NZ;Ode({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ode(n){return Cm=LZ(n),d5=Cm.format,IZ=Cm.parse,f5=Cm.utcFormat,NZ=Cm.utcParse,Cm}function G1(n){const e={};return t=>e[t]||(e[t]=n(t))}function Bde(n,e){return t=>{const i=n(t),s=i.indexOf(e);if(s<0)return i;let r=Wde(i,s);const o=r<i.length?i.slice(r):"";for(;--r>s;)if(i[r]!=="0"){++r;break}return i.slice(0,r)+o}}function Wde(n,e){let t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}function Vde(n){const e=G1(n.format),t=n.formatPrefix;return{format:e,formatPrefix:t,formatFloat(i){const s=zd(i||",");if(s.precision==null){switch(s.precision=12,s.type){case"%":s.precision-=2;break;case"e":s.precision-=1;break}return Bde(e(s),e(".1f")(1)[1])}else return e(s)},formatSpan(i,s,r,o){o=zd(o??",f");const a=op(i,s,r),l=Math.max(Math.abs(i),Math.abs(s));let c;if(o.precision==null)switch(o.type){case"s":return isNaN(c=gZ(a,l))||(o.precision=c),t(o,l);case"":case"e":case"g":case"p":case"r":{isNaN(c=pZ(a,l))||(o.precision=c-(o.type==="e"));break}case"f":case"%":{isNaN(c=fZ(a))||(o.precision=c-(o.type==="%")*2);break}}return e(o)}}}$de();function $de(){return Vde({format:js,formatPrefix:i5})}function OB(n,e,t){t=t||{},Ll(t)||bn("Invalid time multi-format specifier: ".concat(t));const i=e(Dw),s=e(Lw),r=e(kw),o=e(xw),a=e(Sw),l=e(Cw),c=e(yw),u=e(ww),h=n(t[yE]||".%L"),d=n(t[Dw]||":%S"),f=n(t[Lw]||"%I:%M"),g=n(t[kw]||"%I %p"),p=n(t[xw]||t[wE]||"%a %d"),m=n(t[Sw]||"%b %d"),b=n(t[Cw]||"%B"),v=n(t[yw]||"%B"),w=n(t[ww]||"%Y");return y=>(i(y)<y?h:s(y)<y?d:r(y)<y?f:o(y)<y?g:l(y)<y?a(y)<y?p:m:u(y)<y?c(y)<y?b:v:w)(y)}function RZ(n){const e=G1(n.format),t=G1(n.utcFormat);return{timeFormat:i=>wn(i)?e(i):OB(e,Phe,i),utcFormat:i=>wn(i)?t(i):OB(t,Ohe,i),timeParse:G1(n.parse),utcParse:G1(n.utcParse)}}let yM;zde();function zde(){return yM=RZ({format:d5,parse:IZ,utcFormat:f5,utcParse:NZ})}function Hde(n){return RZ(LZ(n))}function Ude(n){return arguments.length?yM=Hde(n):yM}const jde=/^(data:|([A-Za-z]+:)?\/\/)/,qde=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Gde=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,BB="file://";function Kde(n,e){return t=>({options:t||{},sanitize:Yde,load:Zde,fileAccess:!!e,file:Xde(e),http:Jde(n)})}async function Zde(n,e){const t=await this.sanitize(n,e),i=t.href;return t.localFile?this.file(i):this.http(i,e)}async function Yde(n,e){e=e5({},this.options,e);const t=this.fileAccess,i={href:null};let s,r,o;const a=qde.test(n.replace(Gde,""));(n==null||typeof n!="string"||!a)&&bn("Sanitize failure, invalid URI: "+_E(n));const l=jde.test(n);return(o=e.baseURL)&&!l&&(!n.startsWith("/")&&!o.endsWith("/")&&(n="/"+n),n=o+n),r=(s=n.startsWith(BB))||e.mode==="file"||e.mode!=="http"&&!l&&t,s?n=n.slice(BB.length):n.startsWith("//")&&(e.defaultProtocol==="file"?(n=n.slice(2),r=!0):n=(e.defaultProtocol||"http")+":"+n),Object.defineProperty(i,"localFile",{value:!!r}),i.href=n,e.target&&(i.target=e.target+""),e.rel&&(i.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(i.crossOrigin=e.crossOrigin+""),i}function Xde(n){return n?e=>new Promise((t,i)=>{n.readFile(e,(s,r)=>{s?i(s):t(r)})}):Qde}async function Qde(){bn("No file system access.")}function Jde(n){return n?async function(e,t){const i=e5({},this.options.http,t),s=t&&t.response,r=await n(e,i);return r.ok?go(r[s])?r[s]():r.text():bn(r.status+""+r.statusText)}:efe}async function efe(){bn("No HTTP fetch method available.")}const tfe=n=>n!=null&&n===n,ife=n=>n==="true"||n==="false"||n===!0||n===!1,nfe=n=>!Number.isNaN(Date.parse(n)),MZ=n=>!Number.isNaN(+n)&&!(n instanceof Date),sfe=n=>MZ(n)&&Number.isInteger(+n),WB={boolean:Hue,integer:bw,number:bw,date:jue,string:que,unknown:gE},jS=[ife,sfe,MZ,nfe],rfe=["boolean","integer","number","date"];function ofe(n,e){if(!n||!n.length)return"unknown";const t=n.length,i=jS.length,s=jS.map((r,o)=>o+1);for(let r=0,o=0,a,l;r<t;++r)for(l=e?n[r][e]:n[r],a=0;a<i;++a)if(s[a]&&tfe(l)&&!jS[a](l)&&(s[a]=0,++o,o===jS.length))return"string";return rfe[s.reduce((r,o)=>r===0?o:r,0)-1]}function afe(n,e){return e.reduce((t,i)=>(t[i]=ofe(n,i),t),{})}function VB(n){const e=function(t,i){const s={delimiter:n};return g5(t,i?e5(i,s):s)};return e.responseType="text",e}function g5(n,e){return e.header&&(n=e.header.map(_E).join(e.delimiter)+`
`+n),rZ(e.delimiter).parse(n+"")}g5.responseType="text";function lfe(n){return typeof Buffer=="function"&&go(Buffer.isBuffer)?Buffer.isBuffer(n):!1}function p5(n,e){const t=e&&e.property?fE(e.property):gE;return Ll(n)&&!lfe(n)?cfe(t(n),e):t(JSON.parse(n))}p5.responseType="json";function cfe(n,e){return!jo(n)&&$ue(n)&&(n=[...n]),e&&e.copy?JSON.parse(JSON.stringify(n)):n}const ufe={interior:(n,e)=>n!==e,exterior:(n,e)=>n===e};function FZ(n,e){let t,i,s,r;return n=p5(n,e),e&&e.feature?(t=the,s=e.feature):e&&e.mesh?(t=nhe,s=e.mesh,r=ufe[e.filter]):bn("Missing TopoJSON feature or mesh parameter."),i=(i=n.objects[s])?t(n,i,r):bn("Invalid TopoJSON object: "+s),i&&i.features||[i]}FZ.responseType="json";const XA={dsv:g5,csv:VB(","),tsv:VB("	"),json:p5,topojson:FZ};function PZ(n,e){return arguments.length>1?(XA[n]=e,this):gg(XA,n)?XA[n]:null}function m5(n,e,t,i){e=e||{};const s=PZ(e.type||"json");return s||bn("Unknown data format type: "+e.type),n=s(n,e),e.parse&&hfe(n,e.parse,t,i),gg(n,"columns")&&delete n.columns,n}function hfe(n,e,t,i){if(!n.length)return;const s=Ude();t=t||s.timeParse,i=i||s.utcParse;let r=n.columns||Object.keys(n[0]),o,a,l,c,u,h;e==="auto"&&(e=afe(n,r)),r=Object.keys(e);const d=r.map(f=>{const g=e[f];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:t)(m);if(!WB[g])throw Error("Illegal format pattern: "+f+":"+g);return WB[g]});for(l=0,u=n.length,h=r.length;l<u;++l)for(o=n[l],c=0;c<h;++c)a=r[c],o[a]=d[c](o[a])}const CE=Kde(typeof fetch<"u"&&fetch,null);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ev=globalThis,Hk=Ev.trustedTypes,$B=Hk?Hk.createPolicy("lit-html",{createHTML:n=>n}):void 0,OZ="$lit$",Uh=`lit$${(Math.random()+"").slice(9)}$`,BZ="?"+Uh,dfe=`<${BZ}>`,lp=document,Ew=()=>lp.createComment(""),Tw=n=>n===null||typeof n!="object"&&typeof n!="function",WZ=Array.isArray,ffe=n=>WZ(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",QA=`[ 	
\f\r]`,d1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,zB=/-->/g,HB=/>/g,Ff=RegExp(`>|${QA}(?:([^\\s"'>=/]+)(${QA}*=${QA}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),UB=/'/g,jB=/"/g,VZ=/^(?:script|style|textarea|title)$/i,gfe=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),Lu=gfe(1),Aw=Symbol.for("lit-noChange"),as=Symbol.for("lit-nothing"),qB=new WeakMap,pg=lp.createTreeWalker(lp,129);function $Z(n,e){if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return $B!==void 0?$B.createHTML(e):e}const pfe=(n,e)=>{const t=n.length-1,i=[];let s,r=e===2?"<svg>":"",o=d1;for(let a=0;a<t;a++){const l=n[a];let c,u,h=-1,d=0;for(;d<l.length&&(o.lastIndex=d,u=o.exec(l),u!==null);)d=o.lastIndex,o===d1?u[1]==="!--"?o=zB:u[1]!==void 0?o=HB:u[2]!==void 0?(VZ.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Ff):u[3]!==void 0&&(o=Ff):o===Ff?u[0]===">"?(o=s??d1,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?Ff:u[3]==='"'?jB:UB):o===jB||o===UB?o=Ff:o===zB||o===HB?o=d1:(o=Ff,s=void 0);const f=o===Ff&&n[a+1].startsWith("/>")?" ":"";r+=o===d1?l+dfe:h>=0?(i.push(c),l.slice(0,h)+OZ+l.slice(h)+Uh+f):l+Uh+(h===-2?a:f)}return[$Z(n,r+(n[t]||"<?>")+(e===2?"</svg>":"")),i]};class Iw{constructor({strings:e,_$litType$:t},i){let s;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[c,u]=pfe(e,t);if(this.el=Iw.createElement(c,i),pg.currentNode=this.el.content,t===2){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=pg.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(OZ)){const d=u[o++],f=s.getAttribute(h).split(Uh),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:r,name:g[2],strings:f,ctor:g[1]==="."?_fe:g[1]==="?"?bfe:g[1]==="@"?vfe:SE}),s.removeAttribute(h)}else h.startsWith(Uh)&&(l.push({type:6,index:r}),s.removeAttribute(h));if(VZ.test(s.tagName)){const h=s.textContent.split(Uh),d=h.length-1;if(d>0){s.textContent=Hk?Hk.emptyScript:"";for(let f=0;f<d;f++)s.append(h[f],Ew()),pg.nextNode(),l.push({type:2,index:++r});s.append(h[d],Ew())}}}else if(s.nodeType===8)if(s.data===BZ)l.push({type:2,index:r});else{let h=-1;for(;(h=s.data.indexOf(Uh,h+1))!==-1;)l.push({type:7,index:r}),h+=Uh.length-1}r++}}static createElement(e,t){const i=lp.createElement("template");return i.innerHTML=e,i}}function T_(n,e,t=n,i){var o,a;if(e===Aw)return e;let s=i!==void 0?(o=t._$Co)==null?void 0:o[i]:t._$Cl;const r=Tw(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==r&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),r===void 0?s=void 0:(s=new r(n),s._$AT(n,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=s:t._$Cl=s),s!==void 0&&(e=T_(n,s._$AS(n,e.values),s,i)),e}class mfe{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,s=((e==null?void 0:e.creationScope)??lp).importNode(t,!0);pg.currentNode=s;let r=pg.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new EC(r,r.nextSibling,this,e):l.type===1?c=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(c=new wfe(r,this,e)),this._$AV.push(c),l=i[++a]}o!==(l==null?void 0:l.index)&&(r=pg.nextNode(),o++)}return pg.currentNode=lp,s}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class EC{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,s){this.type=2,this._$AH=as,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=T_(this,e,t),Tw(e)?e===as||e==null||e===""?(this._$AH!==as&&this._$AR(),this._$AH=as):e!==this._$AH&&e!==Aw&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):ffe(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==as&&Tw(this._$AH)?this._$AA.nextSibling.data=e:this.$(lp.createTextNode(e)),this._$AH=e}g(e){var r;const{values:t,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=Iw.createElement($Z(i.h,i.h[0]),this.options)),i);if(((r=this._$AH)==null?void 0:r._$AD)===s)this._$AH.p(t);else{const o=new mfe(s,this),a=o.u(this.options);o.p(t),this.$(a),this._$AH=o}}_$AC(e){let t=qB.get(e.strings);return t===void 0&&qB.set(e.strings,t=new Iw(e)),t}T(e){WZ(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,s=0;for(const r of e)s===t.length?t.push(i=new EC(this.k(Ew()),this.k(Ew()),this,this.options)):i=t[s],i._$AI(r),s++;s<t.length&&(this._$AR(i&&i._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}let SE=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,s,r){this.type=1,this._$AH=as,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=r,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=as}_$AI(e,t=this,i,s){const r=this.strings;let o=!1;if(r===void 0)e=T_(this,e,t,0),o=!Tw(e)||e!==this._$AH&&e!==Aw,o&&(this._$AH=e);else{const a=e;let l,c;for(e=r[0],l=0;l<r.length-1;l++)c=T_(this,a[i+l],t,l),c===Aw&&(c=this._$AH[l]),o||(o=!Tw(c)||c!==this._$AH[l]),c===as?e=as:e!==as&&(e+=(c??"")+r[l+1]),this._$AH[l]=c}o&&!s&&this.O(e)}O(e){e===as?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}};class _fe extends SE{constructor(){super(...arguments),this.type=3}O(e){this.element[this.name]=e===as?void 0:e}}class bfe extends SE{constructor(){super(...arguments),this.type=4}O(e){this.element.toggleAttribute(this.name,!!e&&e!==as)}}class vfe extends SE{constructor(e,t,i,s,r){super(e,t,i,s,r),this.type=5}_$AI(e,t=this){if((e=T_(this,e,t,0)??as)===Aw)return;const i=this._$AH,s=e===as&&i!==as||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==as&&(i===as||s);s&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class wfe{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){T_(this,e)}}const JA=Ev.litHtmlPolyfillSupport;JA==null||JA(Iw,EC),(Ev.litHtmlVersions??(Ev.litHtmlVersions=[])).push("3.0.2");const GB=(n,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let s=i._$litPart$;if(s===void 0){const r=(t==null?void 0:t.renderBefore)??null;i._$litPart$=s=new EC(e.insertBefore(Ew(),r),r,void 0,t??{})}return s._$AI(n),s},yfe=`.genome-spy {
  font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  position: relative;
}
.genome-spy canvas {
  transform: scale(1, 1);
  opacity: 1;
  transition: transform 0.6s, opacity 0.6s;
}
.genome-spy .loading-message {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}
.genome-spy .loading-message .message {
  color: #666;
  opacity: 0;
  transition: opacity 0.7s;
}
.genome-spy.loading canvas {
  transform: scale(0.95, 0.95);
  opacity: 0;
}
.genome-spy.loading .loading-message .message {
  opacity: 1;
}
.genome-spy.loading .ellipsis {
  animation: blinker 1s linear infinite;
}
@keyframes blinker {
  50% {
    opacity: 0;
  }
}
.genome-spy .tooltip {
  position: absolute;
  max-width: 450px;
  overflow: hidden;
  background: #f6f6f6;
  padding: 10px;
  font-size: 13px;
  box-shadow: 0px 3px 15px 0px rgba(0, 0, 0, 0.21);
  pointer-events: none;
  z-index: 100;
}
.genome-spy .tooltip > :last-child {
  margin-bottom: 0;
}
.genome-spy .tooltip > .title {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px dashed #b6b6b6;
}
.genome-spy .tooltip .summary {
  font-size: 12px;
}
.genome-spy .tooltip table {
  border-collapse: collapse;
}
.genome-spy .tooltip table:first-child {
  margin-top: 0;
}
.genome-spy .tooltip table th,
.genome-spy .tooltip table td {
  padding: 2px 0.4em;
  vertical-align: top;
}
.genome-spy .tooltip table th:first-child,
.genome-spy .tooltip table td:first-child {
  padding-left: 0;
}
.genome-spy .tooltip table th {
  text-align: left;
  font-weight: bold;
}
.genome-spy .tooltip .color-legend {
  display: inline-block;
  width: 0.8em;
  height: 0.8em;
  margin-left: 0.4em;
  box-shadow: 0px 0px 3px 1px white;
}
.genome-spy .tooltip .attributes .hovered {
  background-color: #e0e0e0;
}
.genome-spy .tooltip .na {
  color: #aaa;
  font-style: italic;
  font-size: 80%;
}
.genome-spy .gene-track-tooltip .summary {
  font-size: 90%;
}
.genome-spy .message-box {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
}
.genome-spy .message-box > div {
  border: 1px solid red;
  padding: 10px;
  background: #fff0f0;
}`;function Cfe(n,e){var t=n.getBoundingClientRect();return[e.clientX-t.left-n.clientLeft,e.clientY-t.top-n.clientTop]}function Uk(n,e){return n.length==e.length&&n.every((t,i)=>n[i]===e[i])}function po(n){return Array.isArray(n)?n:typeof n<"u"?[n]:[]}function TC(n){return n[n.length-1]}class Sfe{constructor(e){this.container=e,this.element=document.createElement("div"),this.element.className="tooltip",this._visible=!0,this.container.appendChild(this.element),this._previousTooltipDatum=void 0,this.enabledStack=[!0],this._penaltyUntil=0,this._lastCoords=void 0,this._previousMove=0,this.clear()}set visible(e){e!=this._visible&&(this.element.style.display=e?null:"none",this._visible=e)}get visible(){return this._visible}get enabled(){return TC(this.enabledStack)??!0}pushEnabledState(e){this.enabledStack.push(e),e||(this.visible=!1)}popEnabledState(){this.enabledStack.pop()}handleMouseMove(e){this.mouseCoords=Cfe(this.container,e);const t=performance.now();!this.visible&&!this._isPenalty()&&t-this._previousMove>500&&(this._penaltyUntil=t+70),this._lastCoords&&xfe(this.mouseCoords,this._lastCoords)>20&&(this._penaltyUntil=t+400),this._lastCoords=this.mouseCoords,this.visible&&this.updatePlacement(),this._previousMove=t}updatePlacement(){const[t,i]=this.mouseCoords;let s=t+20;s>this.container.clientWidth-this.element.offsetWidth&&(s=t-20-this.element.offsetWidth),this.element.style.left=s+"px",this.element.style.top=Math.min(i+20,this.container.clientHeight-this.element.offsetHeight)+"px"}setContent(e){if(!e||!this.enabled||this._isPenalty()){this.visible&&(GB("",this.element),this.visible=!1),this._previousTooltipDatum=void 0;return}GB(e,this.element),this.visible=!0,this.updatePlacement()}clear(){this._previousTooltipDatum=void 0,this.setContent(void 0)}updateWithDatum(e,t){e!==this._previousTooltipDatum&&(this._previousTooltipDatum=e,t||(t=i=>Promise.resolve(Lu` ${JSON.stringify(i)} `)),t(e).then(i=>this.setContent(i)).catch(i=>{if(i!=="debounced")throw i}))}_isPenalty(){return this._penaltyUntil&&this._penaltyUntil>performance.now()}}function xfe(n,e){let t=0;for(let i=0;i<n.length;i++)t+=(n[i]-e[i])**2;return Math.sqrt(t)}const kfe="RawCode",Lfe="Literal",Dfe="Property",Efe="Identifier",Tfe="ArrayExpression",Afe="BinaryExpression",Ife="CallExpression",Nfe="ConditionalExpression",Rfe="LogicalExpression",Mfe="MemberExpression",Ffe="ObjectExpression",Pfe="UnaryExpression";function Dl(n){this.type=n}Dl.prototype.visit=function(n){let e,t,i;if(n(this))return 1;for(e=Ofe(this),t=0,i=e.length;t<i;++t)if(e[t].visit(n))return 1};function Ofe(n){switch(n.type){case Tfe:return n.elements;case Afe:case Rfe:return[n.left,n.right];case Ife:return[n.callee].concat(n.arguments);case Nfe:return[n.test,n.consequent,n.alternate];case Mfe:return[n.object,n.property];case Ffe:return n.properties;case Dfe:return[n.key,n.value];case Pfe:return[n.argument];case Efe:case Lfe:case kfe:default:return[]}}var Wc,tt,be,pr,Ai,xE=1,AC=2,cp=3,hf=4,kE=5,$p=6,Qr=7,IC=8,Bfe=9;Wc={};Wc[xE]="Boolean";Wc[AC]="<end>";Wc[cp]="Identifier";Wc[hf]="Keyword";Wc[kE]="Null";Wc[$p]="Numeric";Wc[Qr]="Punctuator";Wc[IC]="String";Wc[Bfe]="RegularExpression";var Wfe="ArrayExpression",Vfe="BinaryExpression",$fe="CallExpression",zfe="ConditionalExpression",zZ="Identifier",Hfe="Literal",Ufe="LogicalExpression",jfe="MemberExpression",qfe="ObjectExpression",Gfe="Property",Kfe="UnaryExpression",Ls="Unexpected token %0",Zfe="Unexpected number",Yfe="Unexpected string",Xfe="Unexpected identifier",Qfe="Unexpected reserved word",Jfe="Unexpected end of input",CM="Invalid regular expression",eI="Invalid regular expression: missing /",HZ="Octal literals are not allowed in strict mode.",ege="Duplicate data property in object literal not allowed in strict mode",$s="ILLEGAL",Nw="Disabled.",tge=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),ige=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function LE(n,e){if(!n)throw new Error("ASSERT: "+e)}function gu(n){return n>=48&&n<=57}function _5(n){return"0123456789abcdefABCDEF".indexOf(n)>=0}function Tv(n){return"01234567".indexOf(n)>=0}function nge(n){return n===32||n===9||n===11||n===12||n===160||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(n)>=0}function Rw(n){return n===10||n===13||n===8232||n===8233}function NC(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n===92||n>=128&&tge.test(String.fromCharCode(n))}function jk(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57||n===92||n>=128&&ige.test(String.fromCharCode(n))}const sge={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function UZ(){for(;be<pr;){const n=tt.charCodeAt(be);if(nge(n)||Rw(n))++be;else break}}function SM(n){var e,t,i,s=0;for(t=n==="u"?4:2,e=0;e<t;++e)be<pr&&_5(tt[be])?(i=tt[be++],s=s*16+"0123456789abcdef".indexOf(i.toLowerCase())):di({},Ls,$s);return String.fromCharCode(s)}function rge(){var n,e,t,i;for(n=tt[be],e=0,n==="}"&&di({},Ls,$s);be<pr&&(n=tt[be++],!!_5(n));)e=e*16+"0123456789abcdef".indexOf(n.toLowerCase());return(e>1114111||n!=="}")&&di({},Ls,$s),e<=65535?String.fromCharCode(e):(t=(e-65536>>10)+55296,i=(e-65536&1023)+56320,String.fromCharCode(t,i))}function jZ(){var n,e;for(n=tt.charCodeAt(be++),e=String.fromCharCode(n),n===92&&(tt.charCodeAt(be)!==117&&di({},Ls,$s),++be,n=SM("u"),(!n||n==="\\"||!NC(n.charCodeAt(0)))&&di({},Ls,$s),e=n);be<pr&&(n=tt.charCodeAt(be),!!jk(n));)++be,e+=String.fromCharCode(n),n===92&&(e=e.substr(0,e.length-1),tt.charCodeAt(be)!==117&&di({},Ls,$s),++be,n=SM("u"),(!n||n==="\\"||!jk(n.charCodeAt(0)))&&di({},Ls,$s),e+=n);return e}function oge(){var n,e;for(n=be++;be<pr;){if(e=tt.charCodeAt(be),e===92)return be=n,jZ();if(jk(e))++be;else break}return tt.slice(n,be)}function age(){var n,e,t;return n=be,e=tt.charCodeAt(be)===92?jZ():oge(),e.length===1?t=cp:sge.hasOwnProperty(e)?t=hf:e==="null"?t=kE:e==="true"||e==="false"?t=xE:t=cp,{type:t,value:e,start:n,end:be}}function tI(){var n=be,e=tt.charCodeAt(be),t,i=tt[be],s,r,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++be,{type:Qr,value:String.fromCharCode(e),start:n,end:be};default:if(t=tt.charCodeAt(be+1),t===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return be+=2,{type:Qr,value:String.fromCharCode(e)+String.fromCharCode(t),start:n,end:be};case 33:case 61:return be+=2,tt.charCodeAt(be)===61&&++be,{type:Qr,value:tt.slice(n,be),start:n,end:be}}}if(o=tt.substr(be,4),o===">>>=")return be+=4,{type:Qr,value:o,start:n,end:be};if(r=o.substr(0,3),r===">>>"||r==="<<="||r===">>=")return be+=3,{type:Qr,value:r,start:n,end:be};if(s=r.substr(0,2),i===s[1]&&"+-<>&|".indexOf(i)>=0||s==="=>")return be+=2,{type:Qr,value:s,start:n,end:be};if(s==="//"&&di({},Ls,$s),"<>=!+-*%&|^/".indexOf(i)>=0)return++be,{type:Qr,value:i,start:n,end:be};di({},Ls,$s)}function lge(n){let e="";for(;be<pr&&_5(tt[be]);)e+=tt[be++];return e.length===0&&di({},Ls,$s),NC(tt.charCodeAt(be))&&di({},Ls,$s),{type:$p,value:parseInt("0x"+e,16),start:n,end:be}}function cge(n){let e="0"+tt[be++];for(;be<pr&&Tv(tt[be]);)e+=tt[be++];return(NC(tt.charCodeAt(be))||gu(tt.charCodeAt(be)))&&di({},Ls,$s),{type:$p,value:parseInt(e,8),octal:!0,start:n,end:be}}function KB(){var n,e,t;if(t=tt[be],LE(gu(t.charCodeAt(0))||t===".","Numeric literal must start with a decimal digit or a decimal point"),e=be,n="",t!=="."){if(n=tt[be++],t=tt[be],n==="0"){if(t==="x"||t==="X")return++be,lge(e);if(Tv(t))return cge(e);t&&gu(t.charCodeAt(0))&&di({},Ls,$s)}for(;gu(tt.charCodeAt(be));)n+=tt[be++];t=tt[be]}if(t==="."){for(n+=tt[be++];gu(tt.charCodeAt(be));)n+=tt[be++];t=tt[be]}if(t==="e"||t==="E")if(n+=tt[be++],t=tt[be],(t==="+"||t==="-")&&(n+=tt[be++]),gu(tt.charCodeAt(be)))for(;gu(tt.charCodeAt(be));)n+=tt[be++];else di({},Ls,$s);return NC(tt.charCodeAt(be))&&di({},Ls,$s),{type:$p,value:parseFloat(n),start:e,end:be}}function uge(){var n="",e,t,i,s,r=!1;for(e=tt[be],LE(e==="'"||e==='"',"String literal must starts with a quote"),t=be,++be;be<pr;)if(i=tt[be++],i===e){e="";break}else if(i==="\\")if(i=tt[be++],!i||!Rw(i.charCodeAt(0)))switch(i){case"u":case"x":tt[be]==="{"?(++be,n+=rge()):n+=SM(i);break;case"n":n+=`
`;break;case"r":n+="\r";break;case"t":n+="	";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v";break;default:Tv(i)?(s="01234567".indexOf(i),s!==0&&(r=!0),be<pr&&Tv(tt[be])&&(r=!0,s=s*8+"01234567".indexOf(tt[be++]),"0123".indexOf(i)>=0&&be<pr&&Tv(tt[be])&&(s=s*8+"01234567".indexOf(tt[be++]))),n+=String.fromCharCode(s)):n+=i;break}else i==="\r"&&tt[be]===`
`&&++be;else{if(Rw(i.charCodeAt(0)))break;n+=i}return e!==""&&di({},Ls,$s),{type:IC,value:n,octal:r,start:t,end:be}}function hge(n,e){let t=n;e.indexOf("u")>=0&&(t=t.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,s)=>{if(parseInt(s,16)<=1114111)return"x";di({},CM)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(t)}catch{di({},CM)}try{return new RegExp(n,e)}catch{return null}}function dge(){var n,e,t,i,s;for(n=tt[be],LE(n==="/","Regular expression literal must start with a slash"),e=tt[be++],t=!1,i=!1;be<pr;)if(n=tt[be++],e+=n,n==="\\")n=tt[be++],Rw(n.charCodeAt(0))&&di({},eI),e+=n;else if(Rw(n.charCodeAt(0)))di({},eI);else if(t)n==="]"&&(t=!1);else if(n==="/"){i=!0;break}else n==="["&&(t=!0);return i||di({},eI),s=e.substr(1,e.length-2),{value:s,literal:e}}function fge(){var n,e,t;for(e="",t="";be<pr&&(n=tt[be],!!jk(n.charCodeAt(0)));)++be,n==="\\"&&be<pr?di({},Ls,$s):(t+=n,e+=n);return t.search(/[^gimuy]/g)>=0&&di({},CM,t),{value:t,literal:e}}function gge(){var n,e,t,i;return Ai=null,UZ(),n=be,e=dge(),t=fge(),i=hge(e.value,t.value),{literal:e.literal+t.literal,value:i,regex:{pattern:e.value,flags:t.value},start:n,end:be}}function pge(n){return n.type===cp||n.type===hf||n.type===xE||n.type===kE}function qZ(){if(UZ(),be>=pr)return{type:AC,start:be,end:be};const n=tt.charCodeAt(be);return NC(n)?age():n===40||n===41||n===59?tI():n===39||n===34?uge():n===46?gu(tt.charCodeAt(be+1))?KB():tI():gu(n)?KB():tI()}function eo(){const n=Ai;return be=n.end,Ai=qZ(),be=n.end,n}function GZ(){const n=be;Ai=qZ(),be=n}function mge(n){const e=new Dl(Wfe);return e.elements=n,e}function ZB(n,e,t){const i=new Dl(n==="||"||n==="&&"?Ufe:Vfe);return i.operator=n,i.left=e,i.right=t,i}function _ge(n,e){const t=new Dl($fe);return t.callee=n,t.arguments=e,t}function bge(n,e,t){const i=new Dl(zfe);return i.test=n,i.consequent=e,i.alternate=t,i}function b5(n){const e=new Dl(zZ);return e.name=n,e}function K1(n){const e=new Dl(Hfe);return e.value=n.value,e.raw=tt.slice(n.start,n.end),n.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=n.regex),e}function YB(n,e,t){const i=new Dl(jfe);return i.computed=n==="[",i.object=e,i.property=t,i.computed||(t.member=!0),i}function vge(n){const e=new Dl(qfe);return e.properties=n,e}function XB(n,e,t){const i=new Dl(Gfe);return i.key=e,i.value=t,i.kind=n,i}function wge(n,e){const t=new Dl(Kfe);return t.operator=n,t.argument=e,t.prefix=!0,t}function di(n,e){var t,i=Array.prototype.slice.call(arguments,2),s=e.replace(/%(\d)/g,(r,o)=>(LE(o<i.length,"Message reference must be in range"),i[o]));throw t=new Error(s),t.index=be,t.description=s,t}function DE(n){n.type===AC&&di(n,Jfe),n.type===$p&&di(n,Zfe),n.type===IC&&di(n,Yfe),n.type===cp&&di(n,Xfe),n.type===hf&&di(n,Qfe),di(n,Ls,n.value)}function mr(n){const e=eo();(e.type!==Qr||e.value!==n)&&DE(e)}function sn(n){return Ai.type===Qr&&Ai.value===n}function iI(n){return Ai.type===hf&&Ai.value===n}function yge(){const n=[];for(be=Ai.start,mr("[");!sn("]");)sn(",")?(eo(),n.push(null)):(n.push(up()),sn("]")||mr(","));return eo(),mge(n)}function QB(){be=Ai.start;const n=eo();return n.type===IC||n.type===$p?(n.octal&&di(n,HZ),K1(n)):b5(n.value)}function Cge(){var n,e,t,i;if(be=Ai.start,n=Ai,n.type===cp)return t=QB(),mr(":"),i=up(),XB("init",t,i);if(n.type===AC||n.type===Qr)DE(n);else return e=QB(),mr(":"),i=up(),XB("init",e,i)}function Sge(){var n=[],e,t,i,s={},r=String;for(be=Ai.start,mr("{");!sn("}");)e=Cge(),e.key.type===zZ?t=e.key.name:t=r(e.key.value),i="$"+t,Object.prototype.hasOwnProperty.call(s,i)?di({},ege):s[i]=!0,n.push(e),sn("}")||mr(",");return mr("}"),vge(n)}function xge(){mr("(");const n=v5();return mr(")"),n}const kge={if:1};function Lge(){var n,e,t;if(sn("("))return xge();if(sn("["))return yge();if(sn("{"))return Sge();if(n=Ai.type,be=Ai.start,n===cp||kge[Ai.value])t=b5(eo().value);else if(n===IC||n===$p)Ai.octal&&di(Ai,HZ),t=K1(eo());else{if(n===hf)throw new Error(Nw);n===xE?(e=eo(),e.value=e.value==="true",t=K1(e)):n===kE?(e=eo(),e.value=null,t=K1(e)):sn("/")||sn("/=")?(t=K1(gge()),GZ()):DE(eo())}return t}function Dge(){const n=[];if(mr("("),!sn(")"))for(;be<pr&&(n.push(up()),!sn(")"));)mr(",");return mr(")"),n}function Ege(){be=Ai.start;const n=eo();return pge(n)||DE(n),b5(n.value)}function Tge(){return mr("."),Ege()}function Age(){mr("[");const n=v5();return mr("]"),n}function Ige(){var n,e,t;for(n=Lge();;)if(sn("."))t=Tge(),n=YB(".",n,t);else if(sn("("))e=Dge(),n=_ge(n,e);else if(sn("["))t=Age(),n=YB("[",n,t);else break;return n}function JB(){const n=Ige();if(Ai.type===Qr&&(sn("++")||sn("--")))throw new Error(Nw);return n}function A2(){var n,e;if(Ai.type!==Qr&&Ai.type!==hf)e=JB();else{if(sn("++")||sn("--"))throw new Error(Nw);if(sn("+")||sn("-")||sn("~")||sn("!"))n=eo(),e=A2(),e=wge(n.value,e);else{if(iI("delete")||iI("void")||iI("typeof"))throw new Error(Nw);e=JB()}}return e}function eW(n){let e=0;if(n.type!==Qr&&n.type!==hf)return 0;switch(n.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function Nge(){var n,e,t,i,s,r,o,a,l,c;if(n=Ai,l=A2(),i=Ai,s=eW(i),s===0)return l;for(i.prec=s,eo(),e=[n,Ai],o=A2(),r=[l,i,o];(s=eW(Ai))>0;){for(;r.length>2&&s<=r[r.length-2].prec;)o=r.pop(),a=r.pop().value,l=r.pop(),e.pop(),t=ZB(a,l,o),r.push(t);i=eo(),i.prec=s,r.push(i),e.push(Ai),t=A2(),r.push(t)}for(c=r.length-1,t=r[c],e.pop();c>1;)e.pop(),t=ZB(r[c-1].value,r[c-2],t),c-=2;return t}function up(){var n,e,t;return n=Nge(),sn("?")&&(eo(),e=up(),mr(":"),t=up(),n=bge(n,e,t)),n}function v5(){const n=up();if(sn(","))throw new Error(Nw);return n}function Rge(n){tt=n,be=0,pr=tt.length,Ai=null,GZ();const e=v5();if(Ai.type!==AC)throw new Error("Unexpect token after expression.");return e}var Mge={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Fge(n){function e(o,a,l,c){let u=n(a[0]);return l&&(u=l+"("+u+")",l.lastIndexOf("new ",0)===0&&(u="("+u+")")),u+"."+o+(c<0?"":c===0?"()":"("+a.slice(1).map(n).join(",")+")")}function t(o,a,l){return c=>e(o,c,a,l)}const i="new Date",s="String",r="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&bn("Missing arguments to clamp function."),o.length>3&&bn("Too many arguments to clamp function.");const a=o.map(n);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:t("getDate",i,0),day:t("getDay",i,0),year:t("getFullYear",i,0),month:t("getMonth",i,0),hours:t("getHours",i,0),minutes:t("getMinutes",i,0),seconds:t("getSeconds",i,0),milliseconds:t("getMilliseconds",i,0),time:t("getTime",i,0),timezoneoffset:t("getTimezoneOffset",i,0),utcdate:t("getUTCDate",i,0),utcday:t("getUTCDay",i,0),utcyear:t("getUTCFullYear",i,0),utcmonth:t("getUTCMonth",i,0),utchours:t("getUTCHours",i,0),utcminutes:t("getUTCMinutes",i,0),utcseconds:t("getUTCSeconds",i,0),utcmilliseconds:t("getUTCMilliseconds",i,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",s,0),lower:t("toLowerCase",s,0),substring:t("substring",s),split:t("split",s),trim:t("trim",s,0),regexp:r,test:t("test",r),if:function(o){o.length<3&&bn("Missing arguments to if function."),o.length>3&&bn("Too many arguments to if function.");const a=o.map(n);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Pge(n){const e=n&&n.length-1;return e&&(n[0]==='"'&&n[e]==='"'||n[0]==="'"&&n[e]==="'")?n.slice(1,-1):n}function Oge(n){n=n||{};const e=n.allowed?Fk(n.allowed):{},t=n.forbidden?Fk(n.forbidden):{},i=n.constants||Mge,s=(n.functions||Fge)(h),r=n.globalvar,o=n.fieldvar,a=go(r)?r:g=>`${r}["${g}"]`;let l={},c={},u=0;function h(g){if(wn(g))return g;const p=d[g.type];return p==null&&bn("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return u>0?p:gg(t,p)?bn("Illegal identifier: "+p):gg(i,p)?i[p]:gg(e,p)?p:(l[p]=1,a(p))},MemberExpression:g=>{const p=!g.computed,m=h(g.object);p&&(u+=1);const b=h(g.property);return m===o&&(c[Pge(b)]=1),p&&(u-=1),m+(p?"."+b:"["+b+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&bn("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,b=gg(s,p)&&s[p];return b||bn("Unrecognized function: "+p),go(b)?b(m):b+"("+m.map(h).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(h).join(",")+"]",BinaryExpression:g=>"("+h(g.left)+" "+g.operator+" "+h(g.right)+")",UnaryExpression:g=>"("+g.operator+h(g.argument)+")",ConditionalExpression:g=>"("+h(g.test)+"?"+h(g.consequent)+":"+h(g.alternate)+")",LogicalExpression:g=>"("+h(g.left)+g.operator+h(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(h).join(",")+"}",Property:g=>{u+=1;const p=h(g.key);return u-=1,p+":"+h(g.value)}};function f(g){const p={code:h(g),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},p}return f.functions=s,f.constants=i,f}function w5(n,e={}){const t=Oge({forbidden:[],allowed:["datum"],globalvar:"globalObject",fieldvar:"datum"});try{const i=Rge(n),s=t(i),r=Function("datum","globalObject",`"use strict"; return (${s.code});`),o=a=>r(a,e);return o.fields=s.fields,o}catch(i){throw new Error(`Invalid expression: ${n}, ${i.message}`)}}function Vc(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function df(n,e){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const xM=Symbol("implicit");function y5(){var n=new rp,e=[],t=[],i=xM;function s(r){let o=n.get(r);if(o===void 0){if(i!==xM)return i;n.set(r,o=e.push(r)-1)}return t[o%t.length]}return s.domain=function(r){if(!arguments.length)return e.slice();e=[],n=new rp;for(const o of r)n.has(o)||n.set(o,e.push(o)-1);return s},s.range=function(r){return arguments.length?(t=Array.from(r),s):t.slice()},s.unknown=function(r){return arguments.length?(i=r,s):i},s.copy=function(){return y5(e,t).unknown(i)},Vc.apply(s,arguments),s}function Db(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function RC(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function ff(){}var hp=.7,A_=1/hp,F0="\\s*([+-]?\\d+)\\s*",Mw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bge=/^#([0-9a-f]{3,8})$/,Wge=new RegExp(`^rgb\\(${F0},${F0},${F0}\\)$`),Vge=new RegExp(`^rgb\\(${yc},${yc},${yc}\\)$`),$ge=new RegExp(`^rgba\\(${F0},${F0},${F0},${Mw}\\)$`),zge=new RegExp(`^rgba\\(${yc},${yc},${yc},${Mw}\\)$`),Hge=new RegExp(`^hsl\\(${Mw},${yc},${yc}\\)$`),Uge=new RegExp(`^hsla\\(${Mw},${yc},${yc},${Mw}\\)$`),tW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Db(ff,jd,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:iW,formatHex:iW,formatHex8:jge,formatHsl:qge,formatRgb:nW,toString:nW});function iW(){return this.rgb().formatHex()}function jge(){return this.rgb().formatHex8()}function qge(){return KZ(this).formatHsl()}function nW(){return this.rgb().formatRgb()}function jd(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=Bge.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?sW(e):t===3?new Ds(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?qS(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?qS(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Wge.exec(n))?new Ds(e[1],e[2],e[3],1):(e=Vge.exec(n))?new Ds(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=$ge.exec(n))?qS(e[1],e[2],e[3],e[4]):(e=zge.exec(n))?qS(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Hge.exec(n))?aW(e[1],e[2]/100,e[3]/100,1):(e=Uge.exec(n))?aW(e[1],e[2]/100,e[3]/100,e[4]):tW.hasOwnProperty(n)?sW(tW[n]):n==="transparent"?new Ds(NaN,NaN,NaN,0):null}function sW(n){return new Ds(n>>16&255,n>>8&255,n&255,1)}function qS(n,e,t,i){return i<=0&&(n=e=t=NaN),new Ds(n,e,t,i)}function C5(n){return n instanceof ff||(n=jd(n)),n?(n=n.rgb(),new Ds(n.r,n.g,n.b,n.opacity)):new Ds}function qk(n,e,t,i){return arguments.length===1?C5(n):new Ds(n,e,t,i??1)}function Ds(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}Db(Ds,qk,RC(ff,{brighter(n){return n=n==null?A_:Math.pow(A_,n),new Ds(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?hp:Math.pow(hp,n),new Ds(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Ds(Bg(this.r),Bg(this.g),Bg(this.b),Gk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rW,formatHex:rW,formatHex8:Gge,formatRgb:oW,toString:oW}));function rW(){return`#${mg(this.r)}${mg(this.g)}${mg(this.b)}`}function Gge(){return`#${mg(this.r)}${mg(this.g)}${mg(this.b)}${mg((isNaN(this.opacity)?1:this.opacity)*255)}`}function oW(){const n=Gk(this.opacity);return`${n===1?"rgb(":"rgba("}${Bg(this.r)}, ${Bg(this.g)}, ${Bg(this.b)}${n===1?")":`, ${n})`}`}function Gk(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Bg(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function mg(n){return n=Bg(n),(n<16?"0":"")+n.toString(16)}function aW(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new ll(n,e,t,i)}function KZ(n){if(n instanceof ll)return new ll(n.h,n.s,n.l,n.opacity);if(n instanceof ff||(n=jd(n)),!n)return new ll;if(n instanceof ll)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,s=Math.min(e,t,i),r=Math.max(e,t,i),o=NaN,a=r-s,l=(r+s)/2;return a?(e===r?o=(t-i)/a+(t<i)*6:t===r?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?r+s:2-r-s,o*=60):a=l>0&&l<1?0:o,new ll(o,a,l,n.opacity)}function kM(n,e,t,i){return arguments.length===1?KZ(n):new ll(n,e,t,i??1)}function ll(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}Db(ll,kM,RC(ff,{brighter(n){return n=n==null?A_:Math.pow(A_,n),new ll(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?hp:Math.pow(hp,n),new ll(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,s=2*t-i;return new Ds(nI(n>=240?n-240:n+120,s,i),nI(n,s,i),nI(n<120?n+240:n-120,s,i),this.opacity)},clamp(){return new ll(lW(this.h),GS(this.s),GS(this.l),Gk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Gk(this.opacity);return`${n===1?"hsl(":"hsla("}${lW(this.h)}, ${GS(this.s)*100}%, ${GS(this.l)*100}%${n===1?")":`, ${n})`}`}}));function lW(n){return n=(n||0)%360,n<0?n+360:n}function GS(n){return Math.max(0,Math.min(1,n||0))}function nI(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const ZZ=Math.PI/180,YZ=180/Math.PI,Kk=18,XZ=.96422,QZ=1,JZ=.82521,eY=4/29,P0=6/29,tY=3*P0*P0,Kge=P0*P0*P0;function iY(n){if(n instanceof Cc)return new Cc(n.l,n.a,n.b,n.opacity);if(n instanceof Pu)return nY(n);n instanceof Ds||(n=C5(n));var e=aI(n.r),t=aI(n.g),i=aI(n.b),s=sI((.2225045*e+.7168786*t+.0606169*i)/QZ),r,o;return e===t&&t===i?r=o=s:(r=sI((.4360747*e+.3850649*t+.1430804*i)/XZ),o=sI((.0139322*e+.0971045*t+.7141733*i)/JZ)),new Cc(116*s-16,500*(r-s),200*(s-o),n.opacity)}function LM(n,e,t,i){return arguments.length===1?iY(n):new Cc(n,e,t,i??1)}function Cc(n,e,t,i){this.l=+n,this.a=+e,this.b=+t,this.opacity=+i}Db(Cc,LM,RC(ff,{brighter(n){return new Cc(this.l+Kk*(n??1),this.a,this.b,this.opacity)},darker(n){return new Cc(this.l-Kk*(n??1),this.a,this.b,this.opacity)},rgb(){var n=(this.l+16)/116,e=isNaN(this.a)?n:n+this.a/500,t=isNaN(this.b)?n:n-this.b/200;return e=XZ*rI(e),n=QZ*rI(n),t=JZ*rI(t),new Ds(oI(3.1338561*e-1.6168667*n-.4906146*t),oI(-.9787684*e+1.9161415*n+.033454*t),oI(.0719453*e-.2289914*n+1.4052427*t),this.opacity)}}));function sI(n){return n>Kge?Math.pow(n,1/3):n/tY+eY}function rI(n){return n>P0?n*n*n:tY*(n-eY)}function oI(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function aI(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Zge(n){if(n instanceof Pu)return new Pu(n.h,n.c,n.l,n.opacity);if(n instanceof Cc||(n=iY(n)),n.a===0&&n.b===0)return new Pu(NaN,0<n.l&&n.l<100?0:NaN,n.l,n.opacity);var e=Math.atan2(n.b,n.a)*YZ;return new Pu(e<0?e+360:e,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity)}function DM(n,e,t,i){return arguments.length===1?Zge(n):new Pu(n,e,t,i??1)}function Pu(n,e,t,i){this.h=+n,this.c=+e,this.l=+t,this.opacity=+i}function nY(n){if(isNaN(n.h))return new Cc(n.l,0,0,n.opacity);var e=n.h*ZZ;return new Cc(n.l,Math.cos(e)*n.c,Math.sin(e)*n.c,n.opacity)}Db(Pu,DM,RC(ff,{brighter(n){return new Pu(this.h,this.c,this.l+Kk*(n??1),this.opacity)},darker(n){return new Pu(this.h,this.c,this.l-Kk*(n??1),this.opacity)},rgb(){return nY(this).rgb()}}));var sY=-.14861,S5=1.78277,x5=-.29227,EE=-.90649,Fw=1.97294,cW=Fw*EE,uW=Fw*S5,hW=S5*x5-EE*sY;function Yge(n){if(n instanceof Wg)return new Wg(n.h,n.s,n.l,n.opacity);n instanceof Ds||(n=C5(n));var e=n.r/255,t=n.g/255,i=n.b/255,s=(hW*i+cW*e-uW*t)/(hW+cW-uW),r=i-s,o=(Fw*(t-s)-x5*r)/EE,a=Math.sqrt(o*o+r*r)/(Fw*s*(1-s)),l=a?Math.atan2(o,r)*YZ-120:NaN;return new Wg(l<0?l+360:l,a,s,n.opacity)}function EM(n,e,t,i){return arguments.length===1?Yge(n):new Wg(n,e,t,i??1)}function Wg(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}Db(Wg,EM,RC(ff,{brighter(n){return n=n==null?A_:Math.pow(A_,n),new Wg(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?hp:Math.pow(hp,n),new Wg(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=isNaN(this.h)?0:(this.h+120)*ZZ,e=+this.l,t=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(n),s=Math.sin(n);return new Ds(255*(e+t*(sY*i+S5*s)),255*(e+t*(x5*i+EE*s)),255*(e+t*(Fw*i)),this.opacity)}}));function rY(n,e,t,i,s){var r=n*n,o=r*n;return((1-3*n+3*r-o)*e+(4-6*r+3*o)*t+(1+3*n+3*r-3*o)*i+o*s)/6}function oY(n){var e=n.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),s=n[i],r=n[i+1],o=i>0?n[i-1]:2*s-r,a=i<e-1?n[i+2]:2*r-s;return rY((t-i/e)*e,o,s,r,a)}}function aY(n){var e=n.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*e),s=n[(i+e-1)%e],r=n[i%e],o=n[(i+1)%e],a=n[(i+2)%e];return rY((t-i/e)*e,s,r,o,a)}}const TE=n=>()=>n;function lY(n,e){return function(t){return n+t*e}}function Xge(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function AE(n,e){var t=e-n;return t?lY(n,t>180||t<-180?t-360*Math.round(t/360):t):TE(isNaN(n)?e:n)}function Qge(n){return(n=+n)==1?Es:function(e,t){return t-e?Xge(e,t,n):TE(isNaN(e)?t:e)}}function Es(n,e){var t=e-n;return t?lY(n,t):TE(isNaN(n)?e:n)}const TM=function n(e){var t=Qge(e);function i(s,r){var o=t((s=qk(s)).r,(r=qk(r)).r),a=t(s.g,r.g),l=t(s.b,r.b),c=Es(s.opacity,r.opacity);return function(u){return s.r=o(u),s.g=a(u),s.b=l(u),s.opacity=c(u),s+""}}return i.gamma=n,i}(1);function cY(n){return function(e){var t=e.length,i=new Array(t),s=new Array(t),r=new Array(t),o,a;for(o=0;o<t;++o)a=qk(e[o]),i[o]=a.r||0,s[o]=a.g||0,r[o]=a.b||0;return i=n(i),s=n(s),r=n(r),a.opacity=1,function(l){return a.r=i(l),a.g=s(l),a.b=r(l),a+""}}}var Jge=cY(oY),epe=cY(aY);function k5(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),s;return function(r){for(s=0;s<t;++s)i[s]=n[s]*(1-r)+e[s]*r;return i}}function uY(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function tpe(n,e){return(uY(e)?k5:hY)(n,e)}function hY(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,s=new Array(i),r=new Array(t),o;for(o=0;o<i;++o)s[o]=gf(n[o],e[o]);for(;o<t;++o)r[o]=e[o];return function(a){for(o=0;o<i;++o)r[o]=s[o](a);return r}}function dY(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function rl(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function fY(n,e){var t={},i={},s;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in n?t[s]=gf(n[s],e[s]):i[s]=e[s];return function(r){for(s in t)i[s]=t[s](r);return i}}var AM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lI=new RegExp(AM.source,"g");function ipe(n){return function(){return n}}function npe(n){return function(e){return n(e)+""}}function gY(n,e){var t=AM.lastIndex=lI.lastIndex=0,i,s,r,o=-1,a=[],l=[];for(n=n+"",e=e+"";(i=AM.exec(n))&&(s=lI.exec(e));)(r=s.index)>t&&(r=e.slice(t,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,l.push({i:o,x:rl(i,s)})),t=lI.lastIndex;return t<e.length&&(r=e.slice(t),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?npe(l[0].x):ipe(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}function gf(n,e){var t=typeof e,i;return e==null||t==="boolean"?TE(e):(t==="number"?rl:t==="string"?(i=jd(e))?(e=i,TM):gY:e instanceof jd?TM:e instanceof Date?dY:uY(e)?k5:Array.isArray(e)?hY:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?fY:rl)(n,e)}function spe(n){var e=n.length;return function(t){return n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}}function rpe(n,e){var t=AE(+n,+e);return function(i){var s=t(i);return s-360*Math.floor(s/360)}}function MC(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var dW=180/Math.PI,IM={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pY(n,e,t,i,s,r){var o,a,l;return(o=Math.sqrt(n*n+e*e))&&(n/=o,e/=o),(l=n*t+e*i)&&(t-=n*l,i-=e*l),(a=Math.sqrt(t*t+i*i))&&(t/=a,i/=a,l/=a),n*i<e*t&&(n=-n,e=-e,l=-l,o=-o),{translateX:s,translateY:r,rotate:Math.atan2(e,n)*dW,skewX:Math.atan(l)*dW,scaleX:o,scaleY:a}}var KS;function ope(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?IM:pY(e.a,e.b,e.c,e.d,e.e,e.f)}function ape(n){return n==null||(KS||(KS=document.createElementNS("http://www.w3.org/2000/svg","g")),KS.setAttribute("transform",n),!(n=KS.transform.baseVal.consolidate()))?IM:(n=n.matrix,pY(n.a,n.b,n.c,n.d,n.e,n.f))}function mY(n,e,t,i){function s(c){return c.length?c.pop()+" ":""}function r(c,u,h,d,f,g){if(c!==h||u!==d){var p=f.push("translate(",null,e,null,t);g.push({i:p-4,x:rl(c,h)},{i:p-2,x:rl(u,d)})}else(h||d)&&f.push("translate("+h+e+d+t)}function o(c,u,h,d){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),d.push({i:h.push(s(h)+"rotate(",null,i)-2,x:rl(c,u)})):u&&h.push(s(h)+"rotate("+u+i)}function a(c,u,h,d){c!==u?d.push({i:h.push(s(h)+"skewX(",null,i)-2,x:rl(c,u)}):u&&h.push(s(h)+"skewX("+u+i)}function l(c,u,h,d,f,g){if(c!==h||u!==d){var p=f.push(s(f)+"scale(",null,",",null,")");g.push({i:p-4,x:rl(c,h)},{i:p-2,x:rl(u,d)})}else(h!==1||d!==1)&&f.push(s(f)+"scale("+h+","+d+")")}return function(c,u){var h=[],d=[];return c=n(c),u=n(u),r(c.translateX,c.translateY,u.translateX,u.translateY,h,d),o(c.rotate,u.rotate,h,d),a(c.skewX,u.skewX,h,d),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,d),c=u=null,function(f){for(var g=-1,p=d.length,m;++g<p;)h[(m=d[g]).i]=m.x(f);return h.join("")}}}var lpe=mY(ope,"px, ","px)","deg)"),cpe=mY(ape,", ",")",")"),upe=1e-12;function fW(n){return((n=Math.exp(n))+1/n)/2}function hpe(n){return((n=Math.exp(n))-1/n)/2}function dpe(n){return((n=Math.exp(2*n))-1)/(n+1)}const fpe=function n(e,t,i){function s(r,o){var a=r[0],l=r[1],c=r[2],u=o[0],h=o[1],d=o[2],f=u-a,g=h-l,p=f*f+g*g,m,b;if(p<upe)b=Math.log(d/c)/e,m=function(S){return[a+S*f,l+S*g,c*Math.exp(e*S*b)]};else{var v=Math.sqrt(p),w=(d*d-c*c+i*p)/(2*c*t*v),y=(d*d-c*c-i*p)/(2*d*t*v),x=Math.log(Math.sqrt(w*w+1)-w),D=Math.log(Math.sqrt(y*y+1)-y);b=(D-x)/e,m=function(S){var T=S*b,k=fW(x),I=c/(t*v)*(k*dpe(e*T+x)-hpe(x));return[a+I*f,l+I*g,c*k/fW(e*T+x)]}}return m.duration=b*1e3*e/Math.SQRT2,m}return s.rho=function(r){var o=Math.max(.001,+r),a=o*o,l=a*a;return n(o,a,l)},s}(Math.SQRT2,2,4);function _Y(n){return function(e,t){var i=n((e=kM(e)).h,(t=kM(t)).h),s=Es(e.s,t.s),r=Es(e.l,t.l),o=Es(e.opacity,t.opacity);return function(a){return e.h=i(a),e.s=s(a),e.l=r(a),e.opacity=o(a),e+""}}}const gpe=_Y(AE);var ppe=_Y(Es);function mpe(n,e){var t=Es((n=LM(n)).l,(e=LM(e)).l),i=Es(n.a,e.a),s=Es(n.b,e.b),r=Es(n.opacity,e.opacity);return function(o){return n.l=t(o),n.a=i(o),n.b=s(o),n.opacity=r(o),n+""}}function bY(n){return function(e,t){var i=n((e=DM(e)).h,(t=DM(t)).h),s=Es(e.c,t.c),r=Es(e.l,t.l),o=Es(e.opacity,t.opacity);return function(a){return e.h=i(a),e.c=s(a),e.l=r(a),e.opacity=o(a),e+""}}}const _pe=bY(AE);var bpe=bY(Es);function vY(n){return function e(t){t=+t;function i(s,r){var o=n((s=EM(s)).h,(r=EM(r)).h),a=Es(s.s,r.s),l=Es(s.l,r.l),c=Es(s.opacity,r.opacity);return function(u){return s.h=o(u),s.s=a(u),s.l=l(Math.pow(u,t)),s.opacity=c(u),s+""}}return i.gamma=e,i}(1)}const vpe=vY(AE);var wpe=vY(Es);function L5(n,e){e===void 0&&(e=n,n=gf);for(var t=0,i=e.length-1,s=e[0],r=new Array(i<0?0:i);t<i;)r[t]=n(s,s=e[++t]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return r[a](o-a)}}function ype(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n(i/(e-1));return t}const Cpe=Object.freeze(Object.defineProperty({__proto__:null,interpolate:gf,interpolateArray:tpe,interpolateBasis:oY,interpolateBasisClosed:aY,interpolateCubehelix:vpe,interpolateCubehelixLong:wpe,interpolateDate:dY,interpolateDiscrete:spe,interpolateHcl:_pe,interpolateHclLong:bpe,interpolateHsl:gpe,interpolateHslLong:ppe,interpolateHue:rpe,interpolateLab:mpe,interpolateNumber:rl,interpolateNumberArray:k5,interpolateObject:fY,interpolateRgb:TM,interpolateRgbBasis:Jge,interpolateRgbBasisClosed:epe,interpolateRound:MC,interpolateString:gY,interpolateTransformCss:lpe,interpolateTransformSvg:cpe,interpolateZoom:fpe,piecewise:L5,quantize:ype},Symbol.toStringTag,{value:"Module"}));function Spe(n){return function(){return n}}function NM(n){return+n}var gW=[0,1];function no(n){return n}function RM(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:Spe(isNaN(e)?NaN:.5)}function xpe(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function kpe(n,e,t){var i=n[0],s=n[1],r=e[0],o=e[1];return s<i?(i=RM(s,i),r=t(o,r)):(i=RM(i,s),r=t(r,o)),function(a){return r(i(a))}}function Lpe(n,e,t){var i=Math.min(n.length,e.length)-1,s=new Array(i),r=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)s[o]=RM(n[o],n[o+1]),r[o]=t(e[o],e[o+1]);return function(a){var l=Lb(n,a,1,i)-1;return r[l](s[l](a))}}function FC(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function IE(){var n=gW,e=gW,t=gf,i,s,r,o=no,a,l,c;function u(){var d=Math.min(n.length,e.length);return o!==no&&(o=xpe(n[0],n[d-1])),a=d>2?Lpe:kpe,l=c=null,h}function h(d){return d==null||isNaN(d=+d)?r:(l||(l=a(n.map(i),e,t)))(i(o(d)))}return h.invert=function(d){return o(s((c||(c=a(e,n.map(i),rl)))(d)))},h.domain=function(d){return arguments.length?(n=Array.from(d,NM),u()):n.slice()},h.range=function(d){return arguments.length?(e=Array.from(d),u()):e.slice()},h.rangeRound=function(d){return e=Array.from(d),t=MC,u()},h.clamp=function(d){return arguments.length?(o=d?!0:no,u()):o!==no},h.interpolate=function(d){return arguments.length?(t=d,u()):t},h.unknown=function(d){return arguments.length?(r=d,h):r},function(d,f){return i=d,s=f,u()}}function wY(){return IE()(no,no)}function yY(n,e,t,i){var s=op(n,e,t),r;switch(i=zd(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(r=gZ(s,o))&&(i.precision=r),i5(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(r=pZ(s,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=r-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(r=fZ(s))&&(i.precision=r-(i.type==="%")*2);break}}return js(i)}function zp(n){var e=n.domain;return n.ticks=function(t){var i=e();return Pk(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var s=e();return yY(s[0],s[s.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),s=0,r=i.length-1,o=i[s],a=i[r],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=s,s=r,r=c);u-- >0;){if(c=uZ(o,a,t),c===l)return i[s]=o,i[r]=a,e(i);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return n},n}function CY(){var n=wY();return n.copy=function(){return FC(n,CY())},Vc.apply(n,arguments),zp(n)}function SY(n){var e;function t(i){return i==null||isNaN(i=+i)?e:i}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=Array.from(i,NM),t):n.slice()},t.unknown=function(i){return arguments.length?(e=i,t):e},t.copy=function(){return SY(n).unknown(e)},n=arguments.length?Array.from(n,NM):[0,1],zp(t)}function xY(n,e){n=n.slice();var t=0,i=n.length-1,s=n[t],r=n[i],o;return r<s&&(o=t,t=i,i=o,o=s,s=r,r=o),n[t]=e.floor(s),n[i]=e.ceil(r),n}function pW(n){return Math.log(n)}function mW(n){return Math.exp(n)}function Dpe(n){return-Math.log(-n)}function Epe(n){return-Math.exp(-n)}function Tpe(n){return isFinite(n)?+("1e"+n):n<0?0:n}function Ape(n){return n===10?Tpe:n===Math.E?Math.exp:e=>Math.pow(n,e)}function Ipe(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function _W(n){return(e,t)=>-n(-e,t)}function D5(n){const e=n(pW,mW),t=e.domain;let i=10,s,r;function o(){return s=Ipe(i),r=Ape(i),t()[0]<0?(s=_W(s),r=_W(r),n(Dpe,Epe)):n(pW,mW),e}return e.base=function(a){return arguments.length?(i=+a,o()):i},e.domain=function(a){return arguments.length?(t(a),o()):t()},e.ticks=a=>{const l=t();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let d=s(c),f=s(u),g,p;const m=a==null?10:+a;let b=[];if(!(i%1)&&f-d<m){if(d=Math.floor(d),f=Math.ceil(f),c>0){for(;d<=f;++d)for(g=1;g<i;++g)if(p=d<0?g/r(-d):g*r(d),!(p<c)){if(p>u)break;b.push(p)}}else for(;d<=f;++d)for(g=i-1;g>=1;--g)if(p=d>0?g/r(-d):g*r(d),!(p<c)){if(p>u)break;b.push(p)}b.length*2<m&&(b=Pk(c,u,m))}else b=Pk(d,f,Math.min(f-d,m)).map(r);return h?b.reverse():b},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=zd(l)).precision==null&&(l.trim=!0),l=js(l)),a===1/0)return l;const c=Math.max(1,i*a/e.ticks().length);return u=>{let h=u/r(Math.round(s(u)));return h*i<i-.5&&(h*=i),h<=c?l(u):""}},e.nice=()=>t(xY(t(),{floor:a=>r(Math.floor(s(a))),ceil:a=>r(Math.ceil(s(a)))})),e}function E5(){const n=D5(IE()).domain([1,10]);return n.copy=()=>FC(n,E5()).base(n.base()),Vc.apply(n,arguments),n}function bW(n){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/n))}}function vW(n){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*n}}function T5(n){var e=1,t=n(bW(e),vW(e));return t.constant=function(i){return arguments.length?n(bW(e=+i),vW(e)):e},zp(t)}function kY(){var n=T5(IE());return n.copy=function(){return FC(n,kY()).constant(n.constant())},Vc.apply(n,arguments)}function wW(n){return function(e){return e<0?-Math.pow(-e,n):Math.pow(e,n)}}function Npe(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function Rpe(n){return n<0?-n*n:n*n}function A5(n){var e=n(no,no),t=1;function i(){return t===1?n(no,no):t===.5?n(Npe,Rpe):n(wW(t),wW(1/t))}return e.exponent=function(s){return arguments.length?(t=+s,i()):t},zp(e)}function I5(){var n=A5(IE());return n.copy=function(){return FC(n,I5()).exponent(n.exponent())},Vc.apply(n,arguments),n}function Mpe(){return I5.apply(null,arguments).exponent(.5)}function LY(){var n=[],e=[],t=[],i;function s(){var o=0,a=Math.max(1,e.length);for(t=new Array(a-1);++o<a;)t[o-1]=hZ(n,o/a);return r}function r(o){return o==null||isNaN(o=+o)?i:e[Lb(t,o)]}return r.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?t[a-1]:n[0],a<t.length?t[a]:n[n.length-1]]},r.domain=function(o){if(!arguments.length)return n.slice();n=[];for(let a of o)a!=null&&!isNaN(a=+a)&&n.push(a);return n.sort(Dv),s()},r.range=function(o){return arguments.length?(e=Array.from(o),s()):e.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.quantiles=function(){return t.slice()},r.copy=function(){return LY().domain(n).range(e).unknown(i)},Vc.apply(r,arguments)}function DY(){var n=0,e=1,t=1,i=[.5],s=[0,1],r;function o(l){return l!=null&&l<=l?s[Lb(i,l,0,t)]:r}function a(){var l=-1;for(i=new Array(t);++l<t;)i[l]=((l+1)*e-(l-t)*n)/(t+1);return o}return o.domain=function(l){return arguments.length?([n,e]=l,n=+n,e=+e,a()):[n,e]},o.range=function(l){return arguments.length?(t=(s=Array.from(l)).length-1,a()):s.slice()},o.invertExtent=function(l){var c=s.indexOf(l);return c<0?[NaN,NaN]:c<1?[n,i[0]]:c>=t?[i[t-1],e]:[i[c-1],i[c]]},o.unknown=function(l){return arguments.length&&(r=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return DY().domain([n,e]).range(s).unknown(r)},Vc.apply(zp(o),arguments)}function EY(){var n=[.5],e=[0,1],t,i=1;function s(r){return r!=null&&r<=r?e[Lb(n,r,0,i)]:t}return s.domain=function(r){return arguments.length?(n=Array.from(r),i=Math.min(n.length,e.length-1),s):n.slice()},s.range=function(r){return arguments.length?(e=Array.from(r),i=Math.min(n.length,e.length-1),s):e.slice()},s.invertExtent=function(r){var o=e.indexOf(r);return[n[o-1],n[o]]},s.unknown=function(r){return arguments.length?(t=r,s):t},s.copy=function(){return EY().domain(n).range(e).unknown(t)},Vc.apply(s,arguments)}function Fpe(n){return new Date(n)}function Ppe(n){return n instanceof Date?+n:+new Date(+n)}function N5(n,e,t,i,s,r,o,a,l,c){var u=wY(),h=u.invert,d=u.domain,f=c(".%L"),g=c(":%S"),p=c("%I:%M"),m=c("%I %p"),b=c("%a %d"),v=c("%b %d"),w=c("%B"),y=c("%Y");function x(D){return(l(D)<D?f:a(D)<D?g:o(D)<D?p:r(D)<D?m:i(D)<D?s(D)<D?b:v:t(D)<D?w:y)(D)}return u.invert=function(D){return new Date(h(D))},u.domain=function(D){return arguments.length?d(Array.from(D,Ppe)):d().map(Fpe)},u.ticks=function(D){var S=d();return n(S[0],S[S.length-1],D??10)},u.tickFormat=function(D,S){return S==null?x:c(S)},u.nice=function(D){var S=d();return(!D||typeof D.range!="function")&&(D=e(S[0],S[S.length-1],D??10)),D?d(xY(S,D)):u},u.copy=function(){return FC(u,N5(n,e,t,i,s,r,o,a,l,c))},u}function Ope(){return Vc.apply(N5(Ihe,Nhe,Hd,Vk,LC,Pg,o5,r5,Jh,d5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Bpe(){return Vc.apply(N5(The,Ahe,Ud,zk,DC,Og,c5,l5,Jh,f5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function NE(){var n=0,e=1,t,i,s,r,o=no,a=!1,l;function c(h){return h==null||isNaN(h=+h)?l:o(s===0?.5:(h=(r(h)-t)*s,a?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([n,e]=h,t=r(n=+n),i=r(e=+e),s=t===i?0:1/(i-t),c):[n,e]},c.clamp=function(h){return arguments.length?(a=!!h,c):a},c.interpolator=function(h){return arguments.length?(o=h,c):o};function u(h){return function(d){var f,g;return arguments.length?([f,g]=d,o=h(f,g),c):[o(0),o(1)]}}return c.range=u(gf),c.rangeRound=u(MC),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return r=h,t=h(n),i=h(e),s=t===i?0:1/(i-t),c}}function pf(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function R5(){var n=zp(NE()(no));return n.copy=function(){return pf(n,R5())},df.apply(n,arguments)}function TY(){var n=D5(NE()).domain([1,10]);return n.copy=function(){return pf(n,TY()).base(n.base())},df.apply(n,arguments)}function AY(){var n=T5(NE());return n.copy=function(){return pf(n,AY()).constant(n.constant())},df.apply(n,arguments)}function M5(){var n=A5(NE());return n.copy=function(){return pf(n,M5()).exponent(n.exponent())},df.apply(n,arguments)}function Wpe(){return M5.apply(null,arguments).exponent(.5)}function RE(){var n=0,e=.5,t=1,i=1,s,r,o,a,l,c=no,u,h=!1,d;function f(p){return isNaN(p=+p)?d:(p=.5+((p=+u(p))-r)*(i*p<i*r?a:l),c(h?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([n,e,t]=p,s=u(n=+n),r=u(e=+e),o=u(t=+t),a=s===r?0:.5/(r-s),l=r===o?0:.5/(o-r),i=r<s?-1:1,f):[n,e,t]},f.clamp=function(p){return arguments.length?(h=!!p,f):h},f.interpolator=function(p){return arguments.length?(c=p,f):c};function g(p){return function(m){var b,v,w;return arguments.length?([b,v,w]=m,c=L5(p,[b,v,w]),f):[c(0),c(.5),c(1)]}}return f.range=g(gf),f.rangeRound=g(MC),f.unknown=function(p){return arguments.length?(d=p,f):d},function(p){return u=p,s=p(n),r=p(e),o=p(t),a=s===r?0:.5/(r-s),l=r===o?0:.5/(o-r),i=r<s?-1:1,f}}function IY(){var n=zp(RE()(no));return n.copy=function(){return pf(n,IY())},df.apply(n,arguments)}function NY(){var n=D5(RE()).domain([.1,1,10]);return n.copy=function(){return pf(n,NY()).base(n.base())},df.apply(n,arguments)}function RY(){var n=T5(RE());return n.copy=function(){return pf(n,RY()).constant(n.constant())},df.apply(n,arguments)}function F5(){var n=A5(RE());return n.copy=function(){return pf(n,F5()).exponent(n.exponent())},df.apply(n,arguments)}function Vpe(){return F5.apply(null,arguments).exponent(.5)}function P5(n,e,t){const i=n-e+t*2;return n?i>0?i:1:0}const $pe="identity",I_="linear",qd="log",PC="pow",OC="sqrt",ME="symlog",MY="time",FY="utc",Sc="sequential",Eb="diverging",MM="quantile",PY="quantize",OY="threshold",O5="ordinal",FM="point",BY="band",B5="bin-ordinal",bs="continuous",BC="discrete",WC="discretizing",Oa="interpolating",WY="temporal";function zpe(n){return function(e){let t=e[0],i=e[1],s;return i<t&&(s=t,t=i,i=s),[n.invert(t),n.invert(i)]}}function Hpe(n){return function(e){const t=n.range();let i=e[0],s=e[1],r=-1,o,a,l,c;for(s<i&&(a=i,i=s,s=a),l=0,c=t.length;l<c;++l)t[l]>=i&&t[l]<=s&&(r<0&&(r=l),o=l);if(!(r<0))return i=n.invertExtent(t[r]),s=n.invertExtent(t[o]),[i[0]===void 0?i[1]:i[0],s[1]===void 0?s[0]:s[1]]}}function W5(){const n=y5().unknown(void 0),e=n.domain,t=n.range;let i=[0,1],s,r,o=!1,a=0,l=0,c=.5;delete n.unknown;function u(){const h=e().length,d=i[1]<i[0],f=i[1-d],g=P5(h,a,l);let p=i[d-0];s=(f-p)/(g||1),o&&(s=Math.floor(s)),p+=(f-p-s*(h-a))*c,r=s*(1-a),o&&(p=Math.round(p),r=Math.round(r));const m=vw(h).map(b=>p+s*b);return t(d?m.reverse():m)}return n.domain=function(h){return arguments.length?(e(h),u()):e()},n.range=function(h){return arguments.length?(i=[+h[0],+h[1]],u()):i.slice()},n.rangeRound=function(h){return i=[+h[0],+h[1]],o=!0,u()},n.bandwidth=function(){return r},n.step=function(){return s},n.round=function(h){return arguments.length?(o=!!h,u()):o},n.padding=function(h){return arguments.length?(l=Math.max(0,Math.min(1,h)),a=l,u()):a},n.paddingInner=function(h){return arguments.length?(a=Math.max(0,Math.min(1,h)),u()):a},n.paddingOuter=function(h){return arguments.length?(l=Math.max(0,Math.min(1,h)),u()):l},n.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),u()):c},n.invertRange=function(h){if(h[0]==null||h[1]==null)return;const d=i[1]<i[0],f=d?t().reverse():t(),g=f.length-1;let p=+h[0],m=+h[1],b,v,w;if(!(p!==p||m!==m)&&(m<p&&(w=p,p=m,m=w),!(m<f[0]||p>i[1-d])))return b=Math.max(0,mM(f,p)-1),v=p===m?b:mM(f,m)-1,p-f[b]>r+1e-10&&++b,d&&(w=b,b=g-v,v=g-w),b>v?void 0:e().slice(b,v+1)},n.invert=function(h){const d=n.invertRange([h,h]);return d&&d[0]},n.copy=function(){return W5().domain(e()).range(i).round(o).paddingInner(a).paddingOuter(l).align(c)},u()}function VY(n){const e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,n.copy=function(){return VY(e())},n}function Upe(){return VY(W5().paddingInner(1))}var jpe=Array.prototype.map;function qpe(n){return jpe.call(n,bw)}const Gpe=Array.prototype.slice;function $Y(){let n=[],e=[];function t(i){return i==null||i!==i?void 0:e[(Lb(n,i)-1)%e.length]}return t.domain=function(i){return arguments.length?(n=qpe(i),t):n.slice()},t.range=function(i){return arguments.length?(e=Gpe.call(i),t):e.slice()},t.tickFormat=function(i,s){return yY(n[0],_l(n),i??10,s)},t.copy=function(){return $Y().domain(t.domain()).range(t.range())},t}const Zk={};function Kpe(n,e,t){const i=function(){const r=e();return r.invertRange||(r.invertRange=r.invert?zpe(r):r.invertExtent?Hpe(r):void 0),r.type=n,r};return i.metadata=Fk(pM(t)),i}function Si(n,e,t){return arguments.length>1?(Zk[n]=Kpe(n,e,t),this):Zpe(n)?Zk[n]:void 0}Si($pe,SY);Si(I_,CY,bs);Si(qd,E5,[bs,qd]);Si(PC,I5,bs);Si(OC,Mpe,bs);Si(ME,kY,bs);Si(MY,Ope,[bs,WY]);Si(FY,Bpe,[bs,WY]);Si(Sc,R5,[bs,Oa]);Si("".concat(Sc,"-").concat(I_),R5,[bs,Oa]);Si("".concat(Sc,"-").concat(qd),TY,[bs,Oa,qd]);Si("".concat(Sc,"-").concat(PC),M5,[bs,Oa]);Si("".concat(Sc,"-").concat(OC),Wpe,[bs,Oa]);Si("".concat(Sc,"-").concat(ME),AY,[bs,Oa]);Si("".concat(Eb,"-").concat(I_),IY,[bs,Oa]);Si("".concat(Eb,"-").concat(qd),NY,[bs,Oa,qd]);Si("".concat(Eb,"-").concat(PC),F5,[bs,Oa]);Si("".concat(Eb,"-").concat(OC),Vpe,[bs,Oa]);Si("".concat(Eb,"-").concat(ME),RY,[bs,Oa]);Si(MM,LY,[WC,MM]);Si(PY,DY,WC);Si(OY,EY,WC);Si(B5,$Y,[BC,WC]);Si(O5,y5,BC);Si(BY,W5,BC);Si(FM,Upe,BC);function Zpe(n){return gg(Zk,n)}function VC(n,e){const t=Zk[n];return t&&t.metadata[e]}function lr(n){return VC(n,bs)}function Gd(n){return VC(n,BC)}function Zm(n){return VC(n,WC)}function zY(n){return VC(n,qd)}function FE(n){return VC(n,Oa)}function Ype(n,e){const t=e[0],i=_l(e)-t;return function(s){return n(t+s*i)}}function PE(n,e,t){return L5(HY(e||"rgb",t),n)}function Xpe(n,e){const t=new Array(e),i=e+1;for(let s=0;s<e;)t[s]=n(++s/i);return t}function HY(n,e){const t=Cpe[Qpe(n)];return e!=null&&t&&t.gamma?t.gamma(e):t}function Qpe(n){return"interpolate"+n.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")}const Jpe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},eme={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function UY(n){const e=n.length/6|0,t=new Array(e);for(let i=0;i<e;)t[i]="#"+n.slice(i*6,++i*6);return t}function jY(n,e){for(const t in n)V5(t,e(n[t]))}const yW={};jY(eme,UY);jY(Jpe,n=>PE(UY(n)));function V5(n,e){return n=n&&n.toLowerCase(),arguments.length>1?(yW[n]=e,this):yW[n]}function tme(){let n=0;const e=new Map,t=i=>{let s=e.get(i);return s===void 0&&(s=n++,e.set(i,s)),s};return t.addAll=i=>{for(const s of i)t(s)},t.invert=i=>{for(const s of e.entries())if(s[1]==i)return s[0]},t.domain=()=>[...e.keys()],t}function OE(){const n=e=>e;return n.invert=e=>e,n.copy=OE,n.invertRange=()=>{},n.type="null",n}function ime(n,e){const t={};e||(e=n.encoding);for(const[i,s]of Object.entries(e)){if(!s)continue;const r=((aa(s)&&s.resolutionChannel)??($g(i)&&i))||void 0,o=n.unitView.getScaleResolution(r);t[i]=nme(e[i],o==null?void 0:o.getScale(),n.unitView.getAccessor(i),i)}return t}function nme(n,e,t,i){let s;if(bl(n)){const r=n.value;s=o=>r,s.constant=!0,s.constantValue=!0,s.accessor=void 0}else if(t)if(i=="text")s=r=>{},s.accessor=t,s.constant=t.constant;else{if(!e)if(!$g(i))e=OE();else throw new Error(`Missing scale! "${i}": ${JSON.stringify(n)}`);if(s=r=>e(t(r)),Gd(e.type)){const r=tme();r.addAll(e.domain()),s.indexer=r}s.constant=t.constant,s.accessor=t,s.scale=e}else throw new Error(`Missing value or accessor (field, expr, datum) on channel "${i}": ${JSON.stringify(n)}`);return s.invert=e?r=>e.invert(r):r=>{throw new Error("No scale available, cannot invert: "+JSON.stringify(n))},s.channelDef=n,s.applyMetadata=r=>{for(const o in s)o in s&&(r[o]=s[o]);return r},s}function bl(n){return n&&"value"in n}function $C(n){return n&&"field"in n}function zC(n){return n&&"datum"in n}function aa(n){return $C(n)||zC(n)||$5(n)||qY(n)}function PM(n,e){const t=n.mark.encoding[e];if(aa(t))return t;throw new Error("Not a channel def with scale!")}function qY(n){return n&&"chrom"in n}function $5(n){return n&&"expr"in n}const Tb=["x","y"],sme=["x2","y2"],rme=[...Tb,...sme];function GY(n){return Tb.includes(n)}function Pw(n){return rme.includes(n)}const z5={x:"x2",y:"y2"},KY=Object.fromEntries(Object.entries(z5).map(n=>[n[1],n[0]]));function Av(n){return n in KY}function ome(n){const e=z5[n];if(e)return e;throw new Error(`${n} has no secondary channel!`)}function dp(n){return KY[n]??n}function Vg(n){return["color","fill","stroke"].includes(dp(n))}function BE(n){return["shape","squeeze"].includes(n)}function $g(n){return["x","y","x2","y2","color","fill","stroke","opacity","fillOpacity","strokeOpacity","strokeWidth","size","shape","angle","dx","dy","sample"].includes(n)}function ZY(n){switch(n){case"shape":return["circle","square","triangle-up","cross","diamond","triangle-down","triangle-right","triangle-left"]}}function YY(n){if(!BE(n))throw new Error("Not a discrete channel: "+n);const e=new Map(ZY(n).map((t,i)=>[t,i]));return t=>{const i=e.get(t);if(i!==void 0)return i;throw new Error(`Invalid value for "${n}" channel: ${t}`)}}function Hi(n,e=n){if(/^[A-Za-z0-9_]+$/.test(n)){const t=new Function("datum",`return datum[${JSON.stringify(n)}]`);return uf(t,[n],e)}else return fE(n)}class ame{constructor(){this.accessorCreators=[],this.register(e=>{if($C(e))try{const t=Hi(e.field);return t.constant=!1,t.fields=XK(t),t}catch(t){throw new Error(`Invalid field definition: ${t.message}`)}}),this.register(e=>$5(e)?lme(e.expr):void 0),this.register(e=>{if(zC(e)){const i=Bue(e.datum);return i.constant=!0,i.fields=[],i}})}register(e){this.accessorCreators.push(e)}createAccessor(e){for(const t of this.accessorCreators){const i=t(e);if(i)return i}}}function lme(n){const e=w5(n);return e.constant=e.fields.length==0,e}/* @license twgl.js 4.22.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const H5=5120,Ow=5121,U5=5122,j5=5123,q5=5124,G5=5125,K5=5126,cme=32819,ume=32820,hme=33635,dme=5131,fme=33640,gme=35899,pme=35902,mme=36269,_me=34042,XY={};{const n=XY;n[H5]=Int8Array,n[Ow]=Uint8Array,n[U5]=Int16Array,n[j5]=Uint16Array,n[q5]=Int32Array,n[G5]=Uint32Array,n[K5]=Float32Array,n[cme]=Uint16Array,n[ume]=Uint16Array,n[hme]=Uint16Array,n[dme]=Uint16Array,n[fme]=Uint32Array,n[gme]=Uint32Array,n[pme]=Uint32Array,n[mme]=Uint32Array,n[_me]=Uint32Array}function Z5(n){if(n instanceof Int8Array)return H5;if(n instanceof Uint8Array||n instanceof Uint8ClampedArray)return Ow;if(n instanceof Int16Array)return U5;if(n instanceof Uint16Array)return j5;if(n instanceof Int32Array)return q5;if(n instanceof Uint32Array)return G5;if(n instanceof Float32Array)return K5;throw new Error("unsupported typed array type")}function bme(n){if(n===Int8Array)return H5;if(n===Uint8Array||n===Uint8ClampedArray)return Ow;if(n===Int16Array)return U5;if(n===Uint16Array)return j5;if(n===Int32Array)return q5;if(n===Uint32Array)return G5;if(n===Float32Array)return K5;throw new Error("unsupported typed array type")}function vme(n){const e=XY[n];if(!e)throw new Error("unknown gl type");return e}const Yk=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function wme(...n){console.error(...n)}function QY(...n){console.warn(...n)}function yme(n,e){return typeof WebGLBuffer<"u"&&e instanceof WebGLBuffer}function JY(n,e){return typeof WebGLRenderbuffer<"u"&&e instanceof WebGLRenderbuffer}function WE(n,e){return typeof WebGLTexture<"u"&&e instanceof WebGLTexture}function Cme(n,e){return typeof WebGLSampler<"u"&&e instanceof WebGLSampler}const eX=35044,xc=34962,Sme=34963,xme=34660,kme=5120,Lme=5121,Dme=5122,Eme=5123,Tme=5124,Ame=5125,Ime=5126,tX={attribPrefix:""};function iX(n,e,t,i,s){n.bindBuffer(e,t),n.bufferData(e,i,s||eX)}function nX(n,e,t,i){if(yme(n,e))return e;t=t||xc;const s=n.createBuffer();return iX(n,t,s,e,i),s}function sX(n){return n==="indices"}function Nme(n){return n instanceof Int8Array||n instanceof Uint8Array}function Rme(n){return n===Int8Array||n===Uint8Array}function Mme(n){return n.length?n:n.data}const Fme=/coord|texture/i,Pme=/color|colour/i;function rX(n,e){let t;if(Fme.test(n)?t=2:Pme.test(n)?t=4:t=3,e%t>0)throw new Error(`Can not guess numComponents for attribute '${n}'. Tried ${t} but ${e} values is not evenly divisible by ${t}. You should specify it.`);return t}function Ome(n,e){return n.numComponents||n.size||rX(e,Mme(n).length)}function Y5(n,e){if(Yk(n))return n;if(Yk(n.data))return n.data;Array.isArray(n)&&(n={data:n});let t=n.type;return t||(sX(e)?t=Uint16Array:t=Float32Array),new t(n.data)}function Bme(n,e){const t={};return Object.keys(e).forEach(function(i){if(!sX(i)){const s=e[i],r=s.attrib||s.name||s.attribName||tX.attribPrefix+i;if(s.value){if(!Array.isArray(s.value)&&!Yk(s.value))throw new Error("array.value is not array or typedarray");t[r]={value:s.value}}else{let o,a,l,c;if(s.buffer&&s.buffer instanceof WebGLBuffer)o=s.buffer,c=s.numComponents||s.size,a=s.type,l=s.normalize;else if(typeof s=="number"||typeof s.data=="number"){const u=s.data||s,h=s.type||Float32Array,d=u*h.BYTES_PER_ELEMENT;a=bme(h),l=s.normalize!==void 0?s.normalize:Rme(h),c=s.numComponents||s.size||rX(i,u),o=n.createBuffer(),n.bindBuffer(xc,o),n.bufferData(xc,d,s.drawType||eX)}else{const u=Y5(s,i);o=nX(n,u,void 0,s.drawType),a=Z5(u),l=s.normalize!==void 0?s.normalize:Nme(u),c=Ome(s,i)}t[r]={buffer:o,numComponents:c,type:a,normalize:l,stride:s.stride||0,offset:s.offset||0,divisor:s.divisor===void 0?void 0:s.divisor,drawType:s.drawType}}}}),n.bindBuffer(xc,null),t}function Wme(n,e,t,i){t=Y5(t),i!==void 0?(n.bindBuffer(xc,e.buffer),n.bufferSubData(xc,i,t)):iX(n,xc,e.buffer,t,e.drawType)}function Vme(n,e){return e===kme||e===Lme?1:e===Dme||e===Eme?2:e===Tme||e===Ame||e===Ime?4:0}const cI=["position","positions","a_position"];function $me(n,e){let t,i;for(i=0;i<cI.length&&(t=cI[i],!(t in e||(t=tX.attribPrefix+t,t in e)));++i);i===cI.length&&(t=Object.keys(e)[0]);const s=e[t];n.bindBuffer(xc,s.buffer);const r=n.getBufferParameter(xc,xme);n.bindBuffer(xc,null);const o=Vme(n,s.type),a=r/o,l=s.numComponents||s.size,c=a/l;if(c%1!==0)throw new Error(`numComponents ${l} not correct for length ${length}`);return c}function zme(n,e,t){const i=Bme(n,e),s=Object.assign({},t||{});s.attribs=Object.assign({},t?t.attribs:{},i);const r=e.indices;if(r){const o=Y5(r,"indices");s.indices=nX(n,o,Sme),s.numElements=o.length,s.elementType=Z5(o)}else s.numElements||(s.numElements=$me(n,s.attribs));return s}function Ab(n){return!!n.texStorage2D}const OM=function(){const n={},e={};function t(i){const s=i.constructor.name;if(!n[s]){for(const r in i)if(typeof i[r]=="number"){const o=e[i[r]];e[i[r]]=o?`${o} | ${r}`:r}n[s]=!0}}return function(s,r){return t(s),e[r]||(typeof r=="number"?`0x${r.toString(16)}`:r)}}(),mf={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},N_=Yk,oX=function(){let n;return function(){return n=n||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),n}}(),CW=6406,Bl=6407,fn=6408,SW=6409,xW=6410,f1=6402,kW=34041,Xk=33071,Hme=9728,Ume=9729,sh=3553,eh=34067,Kd=32879,Zd=35866,VE=34069,jme=34070,qme=34071,Gme=34072,Kme=34073,Zme=34074,BM=10241,WM=10240,Qk=10242,Jk=10243,LW=32882,Yme=33082,Xme=33083,Qme=33084,Jme=33085,X5=3317,aX=3314,lX=32878,cX=3316,uX=3315,hX=32877,e0e=37443,t0e=37441,i0e=37440,n0e=33321,s0e=36756,r0e=33325,o0e=33326,a0e=33330,l0e=33329,c0e=33338,u0e=33337,h0e=33340,d0e=33339,f0e=33323,g0e=36757,p0e=33327,m0e=33328,_0e=33336,b0e=33335,v0e=33332,w0e=33331,y0e=33334,C0e=33333,S0e=32849,x0e=35905,k0e=36194,L0e=36758,D0e=35898,E0e=35901,T0e=34843,A0e=34837,I0e=36221,N0e=36239,R0e=36215,M0e=36233,F0e=36209,P0e=36227,O0e=32856,B0e=35907,W0e=36759,V0e=32855,$0e=32854,z0e=32857,H0e=34842,U0e=34836,j0e=36220,q0e=36238,G0e=36975,K0e=36214,Z0e=36232,Y0e=36226,X0e=36208,Q0e=33189,J0e=33190,e_e=36012,t_e=36013,i_e=35056,wh=5120,dn=5121,ZS=5122,Sm=5123,YS=5124,Pf=5125,er=5126,DW=32819,EW=32820,TW=33635,Ua=5131,g1=36193,uI=33640,n_e=35899,s_e=35902,r_e=36269,o_e=34042,XS=33319,xm=33320,QS=6403,km=36244,Lm=36248,Of=36249;let hI;function $E(n){if(!hI){const e={};e[CW]={textureFormat:CW,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[dn,Ua,g1,er]},e[SW]={textureFormat:SW,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[dn,Ua,g1,er]},e[xW]={textureFormat:xW,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[dn,Ua,g1,er]},e[Bl]={textureFormat:Bl,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[dn,Ua,g1,er,TW]},e[fn]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[dn,Ua,g1,er,DW,EW]},e[f1]={textureFormat:f1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Pf,Sm]},e[n0e]={textureFormat:QS,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[dn]},e[s0e]={textureFormat:QS,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[wh]},e[r0e]={textureFormat:QS,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[er,Ua]},e[o0e]={textureFormat:QS,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[er]},e[a0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[dn]},e[l0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[wh]},e[v0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Sm]},e[w0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ZS]},e[y0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Pf]},e[C0e]={textureFormat:km,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[YS]},e[f0e]={textureFormat:XS,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[dn]},e[g0e]={textureFormat:XS,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[wh]},e[p0e]={textureFormat:XS,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[er,Ua]},e[m0e]={textureFormat:XS,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[er]},e[_0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[dn]},e[b0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[wh]},e[c0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Sm]},e[u0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ZS]},e[h0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Pf]},e[d0e]={textureFormat:xm,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[YS]},e[S0e]={textureFormat:Bl,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[dn]},e[x0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[dn]},e[k0e]={textureFormat:Bl,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[dn,TW]},e[L0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[wh]},e[D0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[er,Ua,n_e]},e[E0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[er,Ua,s_e]},e[T0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[er,Ua]},e[A0e]={textureFormat:Bl,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[er]},e[I0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[dn]},e[N0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[wh]},e[R0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Sm]},e[M0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[ZS]},e[F0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Pf]},e[P0e]={textureFormat:Lm,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[YS]},e[O0e]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[dn]},e[B0e]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[dn]},e[W0e]={textureFormat:fn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[wh]},e[V0e]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[dn,EW,uI]},e[$0e]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[dn,DW]},e[z0e]={textureFormat:fn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[uI]},e[H0e]={textureFormat:fn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[er,Ua]},e[U0e]={textureFormat:fn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[er]},e[j0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[dn]},e[q0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[wh]},e[G0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[uI]},e[K0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Sm]},e[Z0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ZS]},e[Y0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[YS]},e[X0e]={textureFormat:Of,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Pf]},e[Q0e]={textureFormat:f1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Sm,Pf]},e[J0e]={textureFormat:f1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Pf]},e[e_e]={textureFormat:f1,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[er]},e[i_e]={textureFormat:kW,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[o_e]},e[t_e]={textureFormat:kW,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[r_e]},Object.keys(e).forEach(function(t){const i=e[t];i.bytesPerElementMap={},i.bytesPerElement.forEach(function(s,r){const o=i.type[r];i.bytesPerElementMap[o]=s})}),hI=e}return hI[n]}function a_e(n,e){const t=$E(n);if(!t)throw"unknown internal format";const i=t.bytesPerElementMap[e];if(i===void 0)throw"unknown internal format";return i}function Ib(n){const e=$E(n);if(!e)throw"unknown internal format";return{format:e.textureFormat,type:e.type[0]}}function AW(n){return(n&n-1)===0}function l_e(n,e,t,i){if(!Ab(n))return AW(e)&&AW(t);const s=$E(i);if(!s)throw"unknown internal format";return s.colorRenderable&&s.textureFilterable}function c_e(n){const e=$E(n);if(!e)throw"unknown internal format";return e.textureFilterable}function dX(n,e,t){return N_(e)?Z5(e):t||dn}function JS(n,e,t,i,s){if(s%1!==0)throw"can't guess dimensions";if(!t&&!i){const r=Math.sqrt(s/(e===eh?6:1));r%1===0?(t=r,i=r):(t=s,i=1)}else if(i){if(!t&&(t=s/i,t%1))throw"can't guess dimensions"}else if(i=s/t,i%1)throw"can't guess dimensions";return{width:t,height:i}}function R_(n,e){e.colorspaceConversion!==void 0&&n.pixelStorei(e0e,e.colorspaceConversion),e.premultiplyAlpha!==void 0&&n.pixelStorei(t0e,e.premultiplyAlpha),e.flipY!==void 0&&n.pixelStorei(i0e,e.flipY)}function fX(n){n.pixelStorei(X5,4),Ab(n)&&(n.pixelStorei(aX,0),n.pixelStorei(lX,0),n.pixelStorei(cX,0),n.pixelStorei(uX,0),n.pixelStorei(hX,0))}function u_e(n,e,t,i){i.minMag&&(t.call(n,e,BM,i.minMag),t.call(n,e,WM,i.minMag)),i.min&&t.call(n,e,BM,i.min),i.mag&&t.call(n,e,WM,i.mag),i.wrap&&(t.call(n,e,Qk,i.wrap),t.call(n,e,Jk,i.wrap),(e===Kd||Cme(n,e))&&t.call(n,e,LW,i.wrap)),i.wrapR&&t.call(n,e,LW,i.wrapR),i.wrapS&&t.call(n,e,Qk,i.wrapS),i.wrapT&&t.call(n,e,Jk,i.wrapT),i.minLod&&t.call(n,e,Yme,i.minLod),i.maxLod&&t.call(n,e,Xme,i.maxLod),i.baseLevel&&t.call(n,e,Qme,i.baseLevel),i.maxLevel&&t.call(n,e,Jme,i.maxLevel)}function gX(n,e,t){const i=t.target||sh;n.bindTexture(i,e),u_e(n,i,n.texParameteri,t)}function h_e(n){return n=n||mf.textureColor,N_(n)?n:new Uint8Array([n[0]*255,n[1]*255,n[2]*255,n[3]*255])}function VM(n,e,t,i,s,r){t=t||mf.textureOptions,r=r||fn;const o=t.target||sh;if(i=i||t.width,s=s||t.height,n.bindTexture(o,e),l_e(n,i,s,r))n.generateMipmap(o);else{const a=c_e(r)?Ume:Hme;n.texParameteri(o,BM,a),n.texParameteri(o,WM,a),n.texParameteri(o,Qk,Xk),n.texParameteri(o,Jk,Xk)}}function Bw(n){return n.auto===!0||n.auto===void 0&&n.level===void 0}function $M(n,e){return e=e||{},e.cubeFaceOrder||[VE,jme,qme,Gme,Kme,Zme]}function zM(n,e){const i=$M(n,e).map(function(s,r){return{face:s,ndx:r}});return i.sort(function(s,r){return s.face-r.face}),i}function pX(n,e,t,i){i=i||mf.textureOptions;const s=i.target||sh,r=i.level||0;let o=t.width,a=t.height;const l=i.internalFormat||i.format||fn,c=Ib(l),u=i.format||c.format,h=i.type||c.type;if(R_(n,i),n.bindTexture(s,e),s===eh){const d=t.width,f=t.height;let g,p;if(d/6===f)g=f,p=[0,0,1,0,2,0,3,0,4,0,5,0];else if(f/6===d)g=d,p=[0,0,0,1,0,2,0,3,0,4,0,5];else if(d/3===f/2)g=d/3,p=[0,0,1,0,2,0,0,1,1,1,2,1];else if(d/2===f/3)g=d/2,p=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);const m=oX();m?(m.canvas.width=g,m.canvas.height=g,o=g,a=g,zM(n,i).forEach(function(b){const v=p[b.ndx*2+0]*g,w=p[b.ndx*2+1]*g;m.drawImage(t,v,w,g,g,0,0,g,g),n.texImage2D(b.face,r,l,u,h,m.canvas)}),m.canvas.width=1,m.canvas.height=1):typeof createImageBitmap<"u"&&(o=g,a=g,zM(n,i).forEach(function(b){const v=p[b.ndx*2+0]*g,w=p[b.ndx*2+1]*g;n.texImage2D(b.face,r,l,g,g,0,u,h,null),createImageBitmap(t,v,w,g,g,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(y){R_(n,i),n.bindTexture(s,e),n.texImage2D(b.face,r,l,u,h,y),Bw(i)&&VM(n,e,i,o,a,l)})}))}else if(s===Kd||s===Zd){const d=Math.min(t.width,t.height),f=Math.max(t.width,t.height),g=f/d;if(g%1!==0)throw"can not compute 3D dimensions of element";const p=t.width===f?1:0,m=t.height===f?1:0;n.pixelStorei(X5,1),n.pixelStorei(aX,t.width),n.pixelStorei(lX,0),n.pixelStorei(hX,0),n.texImage3D(s,r,l,d,d,d,0,u,h,null);for(let b=0;b<g;++b){const v=b*d*p,w=b*d*m;n.pixelStorei(cX,v),n.pixelStorei(uX,w),n.texSubImage3D(s,r,0,0,b,d,d,1,u,h,t)}fX(n)}else n.texImage2D(s,r,l,u,h,t);Bw(i)&&VM(n,e,i,o,a,l),gX(n,e,i)}function HC(){}function d_e(n){if(typeof document<"u"){const e=document.createElement("a");return e.href=n,e.hostname===location.hostname&&e.port===location.port&&e.protocol===location.protocol}else{const e=new URL(location.href).origin;return new URL(n,location.href).origin===e}}function f_e(n,e){return e===void 0&&!d_e(n)?"anonymous":e}function g_e(n,e,t){t=t||HC;let i;if(e=e!==void 0?e:mf.crossOrigin,e=f_e(n,e),typeof Image<"u"){i=new Image,e!==void 0&&(i.crossOrigin=e);const s=function(){i.removeEventListener("error",r),i.removeEventListener("load",o),i=null},r=function(){const l="couldn't load image: "+n;wme(l),t(l,i),s()},o=function(){t(null,i),s()};return i.addEventListener("error",r),i.addEventListener("load",o),i.src=n,i}else if(typeof ImageBitmap<"u"){let s,r;const o=function(){t(s,r)},a={};e&&(a.mode="cors"),fetch(n,a).then(function(l){if(!l.ok)throw l;return l.blob()}).then(function(l){return createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(l){r=l,setTimeout(o)}).catch(function(l){s=l,setTimeout(o)}),i=null}return i}function mX(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof ImageData<"u"&&n instanceof ImageData||typeof HTMLElement<"u"&&n instanceof HTMLElement}function Q5(n,e,t){return mX(n)?(setTimeout(function(){t(null,n)}),n):g_e(n,e,t)}function J5(n,e,t){t=t||mf.textureOptions;const i=t.target||sh;if(n.bindTexture(i,e),t.color===!1)return;const s=h_e(t.color);if(i===eh)for(let r=0;r<6;++r)n.texImage2D(VE+r,0,fn,1,1,0,fn,dn,s);else i===Kd||i===Zd?n.texImage3D(i,0,fn,1,1,1,0,fn,dn,s):n.texImage2D(i,0,fn,1,1,0,fn,dn,s)}function p_e(n,e,t,i){return i=i||HC,t=t||mf.textureOptions,J5(n,e,t),t=Object.assign({},t),Q5(t.src,t.crossOrigin,function(r,o){r?i(r,e,o):(pX(n,e,o,t),i(null,e,o))})}function m_e(n,e,t,i){i=i||HC;const s=t.src;if(s.length!==6)throw"there must be 6 urls for a cubemap";const r=t.level||0,o=t.internalFormat||t.format||fn,a=Ib(o),l=t.format||a.format,c=t.type||dn,u=t.target||sh;if(u!==eh)throw"target must be TEXTURE_CUBE_MAP";J5(n,e,t),t=Object.assign({},t);let h=6;const d=[],f=$M(n,t);let g;function p(m){return function(b,v){--h,b?d.push(b):v.width!==v.height?d.push("cubemap face img is not a square: "+v.src):(R_(n,t),n.bindTexture(u,e),h===5?$M().forEach(function(w){n.texImage2D(w,r,o,l,c,v)}):n.texImage2D(m,r,o,l,c,v),Bw(t)&&n.generateMipmap(u)),h===0&&i(d.length?d:void 0,e,g)}}g=s.map(function(m,b){return Q5(m,t.crossOrigin,p(f[b]))})}function __e(n,e,t,i){i=i||HC;const s=t.src,r=t.internalFormat||t.format||fn,o=Ib(r),a=t.format||o.format,l=t.type||dn,c=t.target||Zd;if(c!==Kd&&c!==Zd)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";J5(n,e,t),t=Object.assign({},t);let u=s.length;const h=[];let d;const f=t.level||0;let g=t.width,p=t.height;const m=s.length;let b=!0;function v(w){return function(y,x){if(--u,y)h.push(y);else{if(R_(n,t),n.bindTexture(c,e),b){b=!1,g=t.width||x.width,p=t.height||x.height,n.texImage3D(c,f,r,g,p,m,0,a,l,null);for(let D=0;D<m;++D)n.texSubImage3D(c,f,0,0,D,g,p,1,a,l,x)}else{let D=x,S;(x.width!==g||x.height!==p)&&(S=oX(),D=S.canvas,S.canvas.width=g,S.canvas.height=p,S.drawImage(x,0,0,g,p)),n.texSubImage3D(c,f,0,0,w,g,p,1,a,l,D),S&&D===S.canvas&&(S.canvas.width=0,S.canvas.height=0)}Bw(t)&&n.generateMipmap(c)}u===0&&i(h.length?h:void 0,e,d)}}d=s.map(function(w,y){return Q5(w,t.crossOrigin,v(y))})}function _X(n,e,t,i){i=i||mf.textureOptions;const s=i.target||sh;n.bindTexture(s,e);let r=i.width,o=i.height,a=i.depth;const l=i.level||0,c=i.internalFormat||i.format||fn,u=Ib(c),h=i.format||u.format,d=i.type||dX(n,t,u.type);if(N_(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{const m=vme(d);t=new m(t)}const f=a_e(c,d),g=t.byteLength/f;if(g%1)throw"length wrong size for format: "+OM(n,h);let p;if(s===Kd||s===Zd)if(!r&&!o&&!a){const m=Math.cbrt(g);if(m%1!==0)throw"can't guess cube size of array of numElements: "+g;r=m,o=m,a=m}else r&&(!o||!a)?(p=JS(n,s,o,a,g/r),o=p.width,a=p.height):o&&(!r||!a)?(p=JS(n,s,r,a,g/o),r=p.width,a=p.height):(p=JS(n,s,r,o,g/a),r=p.width,o=p.height);else p=JS(n,s,r,o,g),r=p.width,o=p.height;if(fX(n),n.pixelStorei(X5,i.unpackAlignment||1),R_(n,i),s===eh){const m=f/t.BYTES_PER_ELEMENT,b=g/6*m;zM(n,i).forEach(v=>{const w=b*v.ndx,y=t.subarray(w,w+b);n.texImage2D(v.face,l,c,r,o,0,h,d,y)})}else s===Kd||s===Zd?n.texImage3D(s,l,c,r,o,a,0,h,d,t):n.texImage2D(s,l,c,r,o,0,h,d,t);return{width:r,height:o,depth:a,type:d}}function b_e(n,e,t){const i=t.target||sh;n.bindTexture(i,e);const s=t.level||0,r=t.internalFormat||t.format||fn,o=Ib(r),a=t.format||o.format,l=t.type||o.type;if(R_(n,t),i===eh)for(let c=0;c<6;++c)n.texImage2D(VE+c,s,r,t.width,t.height,0,a,l,null);else i===Kd||i===Zd?n.texImage3D(i,s,r,t.width,t.height,t.depth,0,a,l,null):n.texImage2D(i,s,r,t.width,t.height,0,a,l,null)}function Ww(n,e,t){t=t||HC,e=e||mf.textureOptions;const i=n.createTexture(),s=e.target||sh;let r=e.width||1,o=e.height||1;const a=e.internalFormat||fn;n.bindTexture(s,i),s===eh&&(n.texParameteri(s,Qk,Xk),n.texParameteri(s,Jk,Xk));let l=e.src;if(l)if(typeof l=="function"&&(l=l(n,e)),typeof l=="string")p_e(n,i,e,t);else if(N_(l)||Array.isArray(l)&&(typeof l[0]=="number"||Array.isArray(l[0])||N_(l[0]))){const c=_X(n,i,l,e);r=c.width,o=c.height}else Array.isArray(l)&&(typeof l[0]=="string"||mX(l[0]))?s===eh?m_e(n,i,e,t):__e(n,i,e,t):(pX(n,i,l,e),r=l.width,o=l.height);else b_e(n,i,e);return Bw(e)&&VM(n,i,e,r,o,a),gX(n,i,e),i}function v_e(n,e,t,i,s,r){i=i||t.width,s=s||t.height,r=r||t.depth;const o=t.target||sh;n.bindTexture(o,e);const a=t.level||0,l=t.internalFormat||t.format||fn,c=Ib(l),u=t.format||c.format;let h;const d=t.src;if(d&&(N_(d)||Array.isArray(d)&&typeof d[0]=="number")?h=t.type||dX(n,d,c.type):h=t.type||c.type,o===eh)for(let f=0;f<6;++f)n.texImage2D(VE+f,a,l,i,s,0,u,h,null);else o===Kd||o===Zd?n.texImage3D(o,a,l,i,s,r,0,u,h,null):n.texImage2D(o,a,l,i,s,0,u,h,null)}const w_e=QY,eL=33984,y_e=35048,zE=34962,C_e=34963,e6=35345,bX=35718,S_e=35721,x_e=35971,k_e=35382,L_e=35396,D_e=35398,E_e=35392,T_e=35395,HE=5126,vX=35664,wX=35665,yX=35666,t6=5124,CX=35667,SX=35668,xX=35669,kX=35670,LX=35671,DX=35672,EX=35673,TX=35674,AX=35675,IX=35676,A_e=35678,I_e=35680,N_e=35679,R_e=35682,M_e=35685,F_e=35686,P_e=35687,O_e=35688,B_e=35689,W_e=35690,V_e=36289,$_e=36292,z_e=36293,i6=5125,NX=36294,RX=36295,MX=36296,H_e=36298,U_e=36299,j_e=36300,q_e=36303,G_e=36306,K_e=36307,Z_e=36308,Y_e=36311,UE=3553,jE=34067,n6=32879,qE=35866,Vt={};function FX(n,e){return Vt[e].bindPoint}function X_e(n,e){return function(t){n.uniform1f(e,t)}}function Q_e(n,e){return function(t){n.uniform1fv(e,t)}}function J_e(n,e){return function(t){n.uniform2fv(e,t)}}function ebe(n,e){return function(t){n.uniform3fv(e,t)}}function tbe(n,e){return function(t){n.uniform4fv(e,t)}}function PX(n,e){return function(t){n.uniform1i(e,t)}}function OX(n,e){return function(t){n.uniform1iv(e,t)}}function BX(n,e){return function(t){n.uniform2iv(e,t)}}function WX(n,e){return function(t){n.uniform3iv(e,t)}}function VX(n,e){return function(t){n.uniform4iv(e,t)}}function ibe(n,e){return function(t){n.uniform1ui(e,t)}}function nbe(n,e){return function(t){n.uniform1uiv(e,t)}}function sbe(n,e){return function(t){n.uniform2uiv(e,t)}}function rbe(n,e){return function(t){n.uniform3uiv(e,t)}}function obe(n,e){return function(t){n.uniform4uiv(e,t)}}function abe(n,e){return function(t){n.uniformMatrix2fv(e,!1,t)}}function lbe(n,e){return function(t){n.uniformMatrix3fv(e,!1,t)}}function cbe(n,e){return function(t){n.uniformMatrix4fv(e,!1,t)}}function ube(n,e){return function(t){n.uniformMatrix2x3fv(e,!1,t)}}function hbe(n,e){return function(t){n.uniformMatrix3x2fv(e,!1,t)}}function dbe(n,e){return function(t){n.uniformMatrix2x4fv(e,!1,t)}}function fbe(n,e){return function(t){n.uniformMatrix4x2fv(e,!1,t)}}function gbe(n,e){return function(t){n.uniformMatrix3x4fv(e,!1,t)}}function pbe(n,e){return function(t){n.uniformMatrix4x3fv(e,!1,t)}}function zr(n,e,t,i){const s=FX(n,e);return Ab(n)?function(r){let o,a;WE(n,r)?(o=r,a=null):(o=r.texture,a=r.sampler),n.uniform1i(i,t),n.activeTexture(eL+t),n.bindTexture(s,o),n.bindSampler(t,a)}:function(r){n.uniform1i(i,t),n.activeTexture(eL+t),n.bindTexture(s,r)}}function Hr(n,e,t,i,s){const r=FX(n,e),o=new Int32Array(s);for(let a=0;a<s;++a)o[a]=t+a;return Ab(n)?function(a){n.uniform1iv(i,o),a.forEach(function(l,c){n.activeTexture(eL+o[c]);let u,h;WE(n,l)?(u=l,h=null):(u=l.texture,h=l.sampler),n.bindSampler(t,h),n.bindTexture(r,u)})}:function(a){n.uniform1iv(i,o),a.forEach(function(l,c){n.activeTexture(eL+o[c]),n.bindTexture(r,l)})}}Vt[HE]={Type:Float32Array,size:4,setter:X_e,arraySetter:Q_e};Vt[vX]={Type:Float32Array,size:8,setter:J_e,cols:2};Vt[wX]={Type:Float32Array,size:12,setter:ebe,cols:3};Vt[yX]={Type:Float32Array,size:16,setter:tbe,cols:4};Vt[t6]={Type:Int32Array,size:4,setter:PX,arraySetter:OX};Vt[CX]={Type:Int32Array,size:8,setter:BX,cols:2};Vt[SX]={Type:Int32Array,size:12,setter:WX,cols:3};Vt[xX]={Type:Int32Array,size:16,setter:VX,cols:4};Vt[i6]={Type:Uint32Array,size:4,setter:ibe,arraySetter:nbe};Vt[NX]={Type:Uint32Array,size:8,setter:sbe,cols:2};Vt[RX]={Type:Uint32Array,size:12,setter:rbe,cols:3};Vt[MX]={Type:Uint32Array,size:16,setter:obe,cols:4};Vt[kX]={Type:Uint32Array,size:4,setter:PX,arraySetter:OX};Vt[LX]={Type:Uint32Array,size:8,setter:BX,cols:2};Vt[DX]={Type:Uint32Array,size:12,setter:WX,cols:3};Vt[EX]={Type:Uint32Array,size:16,setter:VX,cols:4};Vt[TX]={Type:Float32Array,size:32,setter:abe,rows:2,cols:2};Vt[AX]={Type:Float32Array,size:48,setter:lbe,rows:3,cols:3};Vt[IX]={Type:Float32Array,size:64,setter:cbe,rows:4,cols:4};Vt[M_e]={Type:Float32Array,size:32,setter:ube,rows:2,cols:3};Vt[F_e]={Type:Float32Array,size:32,setter:dbe,rows:2,cols:4};Vt[P_e]={Type:Float32Array,size:48,setter:hbe,rows:3,cols:2};Vt[O_e]={Type:Float32Array,size:48,setter:gbe,rows:3,cols:4};Vt[B_e]={Type:Float32Array,size:64,setter:fbe,rows:4,cols:2};Vt[W_e]={Type:Float32Array,size:64,setter:pbe,rows:4,cols:3};Vt[A_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:UE};Vt[I_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:jE};Vt[N_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:n6};Vt[R_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:UE};Vt[V_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:qE};Vt[$_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:qE};Vt[z_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:jE};Vt[H_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:UE};Vt[U_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:n6};Vt[j_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:jE};Vt[q_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:qE};Vt[G_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:UE};Vt[K_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:n6};Vt[Z_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:jE};Vt[Y_e]={Type:null,size:0,setter:zr,arraySetter:Hr,bindPoint:qE};function GE(n,e){return function(t){if(t.value)switch(n.disableVertexAttribArray(e),t.value.length){case 4:n.vertexAttrib4fv(e,t.value);break;case 3:n.vertexAttrib3fv(e,t.value);break;case 2:n.vertexAttrib2fv(e,t.value);break;case 1:n.vertexAttrib1fv(e,t.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else n.bindBuffer(zE,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribPointer(e,t.numComponents||t.size,t.type||HE,t.normalize||!1,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function _f(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4iv(e,t.value);else throw new Error("The length of an integer constant value must be 4!");else n.bindBuffer(zE,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||t6,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function KE(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4uiv(e,t.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else n.bindBuffer(zE,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||i6,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function s6(n,e,t){const i=t.size,s=t.count;return function(r){n.bindBuffer(zE,r.buffer);const o=r.size||r.numComponents||i,a=o/s,l=r.type||HE,u=Vt[l].size*o,h=r.normalize||!1,d=r.offset||0,f=u/s;for(let g=0;g<s;++g)n.enableVertexAttribArray(e+g),n.vertexAttribPointer(e+g,a,l,h,u,d+f*g),r.divisor!==void 0&&n.vertexAttribDivisor(e+g,r.divisor)}}const es={};es[HE]={size:4,setter:GE};es[vX]={size:8,setter:GE};es[wX]={size:12,setter:GE};es[yX]={size:16,setter:GE};es[t6]={size:4,setter:_f};es[CX]={size:8,setter:_f};es[SX]={size:12,setter:_f};es[xX]={size:16,setter:_f};es[i6]={size:4,setter:KE};es[NX]={size:8,setter:KE};es[RX]={size:12,setter:KE};es[MX]={size:16,setter:KE};es[kX]={size:4,setter:_f};es[LX]={size:8,setter:_f};es[DX]={size:12,setter:_f};es[EX]={size:16,setter:_f};es[TX]={size:4,setter:s6,count:2};es[AX]={size:9,setter:s6,count:3};es[IX]={size:16,setter:s6,count:4};function $X(n){const e=n.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const mbe=/(\.|\[|]|\w+)/g,_be=n=>n>="0"&&n<="9";function zX(n,e,t,i){const s=n.split(mbe).filter(a=>a!=="");let r=0,o="";for(;;){const a=s[r++];o+=a;const l=_be(a[0]),c=l?parseInt(a):a;if(l&&(o+=s[r++]),r===s.length){t[c]=e;break}else{const h=s[r++],d=h==="[",f=t[c]||(d?[]:{});t[c]=f,t=f,i[o]=i[o]||function(g){return function(p){HX(g,p)}}(f),o+=h}}}function bbe(n,e){let t=0;function i(a,l,c){const u=l.name.endsWith("[0]"),h=l.type,d=Vt[h];if(!d)throw new Error(`unknown type: 0x${h.toString(16)}`);let f;if(d.bindPoint){const g=t;t+=l.size,u?f=d.arraySetter(n,h,g,c,l.size):f=d.setter(n,h,g,c,l.size)}else d.arraySetter&&u?f=d.arraySetter(n,c):f=d.setter(n,c);return f.location=c,f}const s={},r={},o=n.getProgramParameter(e,bX);for(let a=0;a<o;++a){const l=n.getActiveUniform(e,a);if($X(l))continue;let c=l.name;c.endsWith("[0]")&&(c=c.substr(0,c.length-3));const u=n.getUniformLocation(e,l.name);if(u){const h=i(e,l,u);s[c]=h,zX(c,h,r,s)}}return s}function vbe(n,e){const t={},i=n.getProgramParameter(e,x_e);for(let s=0;s<i;++s){const r=n.getTransformFeedbackVarying(e,s);t[r.name]={index:s,type:r.type,size:r.size}}return t}function wbe(n,e){const t=n.getProgramParameter(e,bX),i=[],s=[];for(let a=0;a<t;++a){s.push(a),i.push({});const l=n.getActiveUniform(e,a);i[a].name=l.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){const l=a[0],c=a[1];n.getActiveUniforms(e,s,n[l]).forEach(function(u,h){i[h][c]=u})});const r={},o=n.getProgramParameter(e,k_e);for(let a=0;a<o;++a){const l=n.getActiveUniformBlockName(e,a),c={index:n.getUniformBlockIndex(e,l),usedByVertexShader:n.getActiveUniformBlockParameter(e,a,L_e),usedByFragmentShader:n.getActiveUniformBlockParameter(e,a,D_e),size:n.getActiveUniformBlockParameter(e,a,E_e),uniformIndices:n.getActiveUniformBlockParameter(e,a,T_e)};c.used=c.usedByVertexShader||c.usedByFragmentShader,r[l]=c}return{blockSpecs:r,uniformData:i}}const IW=/\[\d+\]\.$/,ybe=(n,e)=>((n+(e-1))/e|0)*e;function Cbe(n,e,t,i){if(e||t){i=i||1;const r=n.length/4;return function(o){let a=0,l=0;for(let c=0;c<r;++c){for(let u=0;u<i;++u)n[a++]=o[l++];a+=4-i}}}else return function(s){s.length?n.set(s):n[0]=s}}function Sbe(n,e,t,i){const s=t.blockSpecs,r=t.uniformData,o=s[i];if(!o)return w_e("no uniform block object named:",i),{name:i,uniforms:{}};const a=new ArrayBuffer(o.size),l=n.createBuffer(),c=o.index;n.bindBuffer(e6,l),n.uniformBlockBinding(e,o.index,c);let u=i+".";IW.test(u)&&(u=u.replace(IW,"."));const h={},d={},f={};return o.uniformIndices.forEach(function(g){const p=r[g];let m=p.name;m.startsWith(u)&&(m=m.substr(u.length));const b=m.endsWith("[0]");b&&(m=m.substr(0,m.length-3));const v=Vt[p.type],w=v.Type,y=b?ybe(v.size,16)*p.size:v.size*p.size,x=new w(a,p.offset,y/w.BYTES_PER_ELEMENT);h[m]=x;const D=Cbe(x,b,v.rows,v.cols);d[m]=D,zX(m,D,f,d)}),{name:i,array:a,asFloat:new Float32Array(a),buffer:l,uniforms:h,setters:d}}function NW(n,e,t){return Sbe(n,e.program,e.uniformBlockSpec,t)}function xbe(n,e,t){const s=(e.uniformBlockSpec||e).blockSpecs[t.name];if(s){const r=s.index;return n.bindBufferRange(e6,r,t.buffer,t.offset||0,t.array.byteLength),!0}return!1}function RW(n,e,t){xbe(n,e,t)&&n.bufferData(e6,t.array,y_e)}function MW(n,e){const t=n.setters;for(const i in e){const s=t[i];if(s){const r=e[i];s(r)}}}function HX(n,e){for(const t in e){const i=n[t];typeof i=="function"?i(e[t]):HX(n[t],e[t])}}function Io(n,...e){const t=n.uniformSetters||n,i=e.length;for(let s=0;s<i;++s){const r=e[s];if(Array.isArray(r)){const o=r.length;for(let a=0;a<o;++a)Io(t,r[a])}else for(const o in r){const a=t[o];a&&a(r[o])}}}function kbe(n,e){const t={},i=n.getProgramParameter(e,S_e);for(let s=0;s<i;++s){const r=n.getActiveAttrib(e,s);if($X(r))continue;const o=n.getAttribLocation(e,r.name),a=es[r.type],l=a.setter(n,o,a);l.location=o,t[r.name]=l}return t}function Lbe(n,e){for(const t in e){const i=n[t];i&&i(e[t])}}function Nb(n,e,t){t.vertexArrayObject?n.bindVertexArray(t.vertexArrayObject):(Lbe(e.attribSetters||e,t.attribs),t.indices&&n.bindBuffer(C_e,t.indices))}function Dbe(n,e){const t=bbe(n,e),i=kbe(n,e),s={program:e,uniformSetters:t,attribSetters:i};return Ab(n)&&(s.uniformBlockSpec=wbe(n,e),s.transformFeedbackInfo=vbe(n,e)),s}const Ebe=4,FW=5123;function UC(n,e,t,i,s,r){t=t===void 0?Ebe:t;const o=e.indices,a=e.elementType,l=i===void 0?e.numElements:i;s=s===void 0?0:s,a||o?r!==void 0?n.drawElementsInstanced(t,l,a===void 0?FW:e.elementType,s,r):n.drawElements(t,l,a===void 0?FW:e.elementType,s):r!==void 0?n.drawArraysInstanced(t,s,l,r):n.drawArrays(t,s,l)}const Tbe=36160,_g=36161,Abe=3553,Ibe=5121,Nbe=6402,Rbe=6408,Mbe=33190,Fbe=36012,Pbe=35056,Obe=36013,Bbe=32854,Wbe=32855,Vbe=36194,UX=33189,jX=6401,qX=36168,r6=34041,$be=36064,ZE=36096,GX=36128,o6=33306,HM=33071,UM=9729,KX=[{format:Rbe,type:Ibe,min:UM,wrap:HM},{format:r6}],vl={};vl[r6]=o6;vl[jX]=GX;vl[qX]=GX;vl[Nbe]=ZE;vl[UX]=ZE;vl[Mbe]=ZE;vl[Fbe]=ZE;vl[Pbe]=o6;vl[Obe]=o6;function zbe(n,e){return vl[n]||vl[e]}const bf={};bf[Bbe]=!0;bf[Wbe]=!0;bf[Vbe]=!0;bf[r6]=!0;bf[UX]=!0;bf[jX]=!0;bf[qX]=!0;function Hbe(n){return bf[n]}function Ube(n,e,t,i){const s=Tbe,r=n.createFramebuffer();n.bindFramebuffer(s,r),t=t||n.drawingBufferWidth,i=i||n.drawingBufferHeight,e=e||KX;let o=0;const a={framebuffer:r,attachments:[],width:t,height:i};return e.forEach(function(l){let c=l.attachment;const u=l.samples,h=l.format;let d=l.attachmentPoint||zbe(h,l.internalFormat);if(d||(d=$be+o++),!c)if(u!==void 0||Hbe(h))c=n.createRenderbuffer(),n.bindRenderbuffer(_g,c),u>1?n.renderbufferStorageMultisample(_g,u,h,t,i):n.renderbufferStorage(_g,h,t,i);else{const f=Object.assign({},l);f.width=t,f.height=i,f.auto===void 0&&(f.auto=!1,f.min=f.min||f.minMag||UM,f.mag=f.mag||f.minMag||UM,f.wrapS=f.wrapS||f.wrap||HM,f.wrapT=f.wrapT||f.wrap||HM),c=Ww(n,f)}if(JY(n,c))n.framebufferRenderbuffer(s,d,_g,c);else if(WE(n,c))l.layer!==void 0?n.framebufferTextureLayer(s,d,c,l.level||0,l.layer):n.framebufferTexture2D(s,d,l.target||Abe,c,l.level||0);else throw new Error("unknown attachment type");a.attachments.push(c)}),a}function jbe(n,e,t,i,s){i=i||n.drawingBufferWidth,s=s||n.drawingBufferHeight,e.width=i,e.height=s,t=t||KX,t.forEach(function(r,o){const a=e.attachments[o],l=r.format,c=r.samples;if(c!==void 0||JY(n,a))n.bindRenderbuffer(_g,a),c>1?n.renderbufferStorageMultisample(_g,c,l,i,s):n.renderbufferStorage(_g,l,i,s);else if(WE(n,a))v_e(n,a,r,i,s);else throw new Error("unknown attachment type")})}function qbe(n,e,t){const i=n.createVertexArray();return n.bindVertexArray(i),e.length||(e=[e]),e.forEach(function(s){Nb(n,s,t)}),n.bindVertexArray(null),{numElements:t.numElements,elementType:t.elementType,vertexArrayObject:i}}const Gbe=/^(.*?)_/;function Kbe(n,e){OM(n,0);const t=n.getExtension(e);if(t){const i={},s=Gbe.exec(e)[1],r="_"+s;for(const o in t){const a=t[o],l=typeof a=="function",c=l?s:r;let u=o;o.endsWith(c)&&(u=o.substring(0,o.length-c.length)),n[u]!==void 0?!l&&n[u]!==a&&QY(u,n[u],a,o):l?n[u]=function(h){return function(){return h.apply(t,arguments)}}(a):(n[u]=a,i[u]=a)}i.constructor={name:t.constructor.name},OM(i,0)}return t}const PW=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ZX(n){for(let e=0;e<PW.length;++e)Kbe(n,PW[e])}function Zbe(n,e){const t=["webgl2","webgl","experimental-webgl"];let i=null;for(let s=0;s<t.length;++s)if(i=n.getContext(t[s],e),i){ZX(i);break}return i}function Ybe(n,e){return Zbe(n,e)}const Xbe=`/**
 * The vertex position wrt the rectangle specified by (x, x2, y, y2).
 * [0, 0] = [x, y], [1, 1] = [x2, y2]. 
 * The x or y component may contain fractional values if the rectangle 
 * have been tessellated.
 */
in vec2 frac;

/** Minimum size (width, height) of the displayed rectangle in pixels */
uniform vec2 uMinSize;

/** Minimum opacity for the size size clamping */
uniform float uMinOpacity;

/** top-right, bottom-right, top-left, bottom-left */
uniform vec4 uCornerRadii;

out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out float vHalfStrokeWidth;
out vec4 vCornerRadii;


#if defined(ROUNDED_CORNERS) || defined(STROKED)
/** Position for SDF-strokes */
out vec2 vPosInPixels;
#endif

/** Size of the rect in pixels */
out vec2 vHalfSizeInPixels;

/**
 * Clamps the minimumSize and returns an opacity that reflects the amount of clamping.
 */
float clampMinSize(inout float pos, float frac, float size, float minSize) {
    if (minSize > 0.0 && abs(size) < minSize) {
        pos += (frac - 0.5) * (minSize * sign(size) - size);
        return abs(size) / minSize;
    }

    return 1.0;
}

void sort(inout float a, inout float b) {
    if (a > b) {
        float tmp = b;
        b = a;
        a = tmp;
    }
}

void main(void) {
    vec2 normalizedMinSize = uMinSize / uViewportSize;

    float x = getScaled_x();
    float x2 = getScaled_x2();
    float y = getScaled_y();
    float y2 = getScaled_y2();

    sort(x, x2);
    sort(y, y2);

    // Clamp x to prevent precision artifacts when the scale is zoomed very close.
	// TODO: clamp y as well
	float clampMargin = 1.0;
    vec2 pos1 = vec2(clamp(x, 0.0 - clampMargin, 1.0 + clampMargin), y);
    vec2 pos2 = vec2(clamp(x2, 0.0 - clampMargin, 1.0 + clampMargin), y2);

    vec2 size = pos2 - pos1;

    if (size.x <= 0.0 || size.y <= 0.0) {
        // Early exit. May increase performance or not...
        gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
        return;
    }

    vec2 pos = pos1 + frac * size;

    size.y *= getSampleFacetHeight(pos);

    // Clamp to minimum size, optionally compensate with opacity
    float opaFactor = uViewOpacity * max(uMinOpacity,
        clampMinSize(pos.x, frac.x, size.x, normalizedMinSize.x) *
        clampMinSize(pos.y, frac.y, size.y, normalizedMinSize.y));

    pos = applySampleFacet(pos);

#if defined(ROUNDED_CORNERS) || defined(STROKED)
    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = 1.0 / uDevicePixelRatio;
    float strokeWidth = getScaled_strokeWidth();
    float strokeOpacity = getScaled_strokeOpacity() * opaFactor;

    vec2 centeredFrac = frac - 0.5;
    vec2 expand = centeredFrac * (strokeWidth + aaPadding) / uViewportSize;
    pos += expand;

    vec2 sizeInPixels = size * uViewportSize;
    vPosInPixels = (centeredFrac + expand / size) * sizeInPixels;

    vHalfSizeInPixels = sizeInPixels / 2.0;

    vCornerRadii = min(uCornerRadii, min(vHalfSizeInPixels.x, vHalfSizeInPixels.y));
    vHalfStrokeWidth = strokeWidth / 2.0;
    vStrokeColor = vec4(getScaled_stroke() * strokeOpacity, strokeOpacity);
#endif

    gl_Position = unitToNdc(pos);

    float fillOpacity = getScaled_fillOpacity() * opaFactor;
    vFillColor = vec4(getScaled_fill() * fillOpacity, fillOpacity);

    setupPicking();
}
`,Qbe=`#if defined(ROUNDED_CORNERS) || defined(STROKED)
in vec2 vPosInPixels;
#endif

in vec2 vHalfSizeInPixels;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in float vHalfStrokeWidth;
in vec4 vCornerRadii;

out lowp vec4 fragColor;

// Source: https://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
float sdRoundedBox(vec2 p, vec2 b, vec4 r) {
    r.xy = p.x > 0.0 ? r.xy : r.zw;
    r.x  = p.y > 0.0 ? r.x  : r.y;
    vec2 q = abs(p) - b + r.x;
    return min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - r.x;
}

// Not a true SDF. Makes the corners of strokes sharp and is faster.
float sdSharpBox(vec2 p, vec2 b) {
    vec2 q = abs(p) - b;
    return max(q.x, q.y);
}

void main(void) {

#if defined(ROUNDED_CORNERS) || defined(STROKED)
#ifdef ROUNDED_CORNERS
    // Distance from rectangle's edge in pixels. Negative inside the rectangle.
    float d = sdRoundedBox(vPosInPixels, vHalfSizeInPixels, vCornerRadii);
#else
    float d = sdSharpBox(vPosInPixels, vHalfSizeInPixels);
#endif

    fragColor = distanceToColor(d, vFillColor, vStrokeColor, vHalfStrokeWidth);

    if (fragColor.a == 0.0) {
        discard;
    }
#else
    // The trivial, non-decorated case
    fragColor = vFillColor;
#endif

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,a6="attr_",YX="uDomain_",Jbe="range_",OW="scale_",XX="getScaled_",jM="uRangeTexture_",BW=3402823466e29;function e1e(n){const e=n.match(/^(?:(\w+)-)?(\w+)$/);if(!e)throw new Error("Not a scale type: "+n);return{family:e[1]||"continuous",transform:e[2]}}function t1e(n,e){let t;if(BE(n))t=bg(YY(n)(e));else if(wn(e))if(Vg(n))t=n1e(e);else throw new Error(`String values are not supported on the "${n}" channel: ${e}`);else if(mE(e))t=bg(e?1:0);else if(e===null)if(Vg(n))t=bg([0,0,0]);else throw new Error(`null value is not supported on the "${n}" chanel.`);else t=bg(e);return`
#define ${n}_DEFINED
${t.type} ${XX}${n}() {
    // Constant value
    return ${t};
}`}function i1e(n,e,t){if(bl(t))throw new Error(`Cannot create scale for "value": ${JSON.stringify(t)}`);if(!e)throw new Error("Scale is undefined");const i=dp(n),s=a6+n,r=YX+i,o=Jbe+i,a=tL(e.type),l=a?"vec2":"float",c=e.domain?e.domain().length:void 0;let u;const h=[];h.push(""),h.push("/".repeat(70)),h.push(`// Channel: ${n}`),h.push(""),h.push(`#define ${n}_DEFINED`);const{transform:d}=e1e(e.type),f=(S,...T)=>s1e.apply(null,[S,"value",...T]);let g;switch(d){case"linear":g=f("scaleLinear","domain",o);break;case"log":g=f("scaleLog","domain",o,e.base());break;case"symlog":g=f("scaleSymlog","domain",o,e.constant());break;case"pow":case"sqrt":g=f("scalePow","domain",o,e.exponent());break;case"index":case"locus":g=f("scaleBandHp","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"point":case"band":g=f("scaleBand","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"ordinal":case"null":case"identity":g=f("scaleIdentity");break;case"threshold":break;default:throw new Error(`Unsupported scale type: ${e.type}! ${n}: ${JSON.stringify(t)}`)}const p=FE(e.type)||lr(e.type)&&Vg(n)?[0,1]:e.range?e.range():void 0;if(p&&n==i&&p.length&&p.every(bo)){const S=WW(p);h.push(`const ${S.type} ${o} = ${S};`)}const m=Vg(n)?"vec3":"float";let b;if(Vg(n)){const S=jM+i;if(n==i&&h.push(`uniform sampler2D ${S};`),lr(e.type))b=`getInterpolatedColor(${S}, transformed)`;else if(Gd(e.type)||Zm(e.type))b=`getDiscreteColor(${S}, int(transformed))`;else throw new Error("Problem with color scale!")}else if(e.type==="ordinal"||Zm(e.type)){const S=jM+i;n==i&&h.push(`uniform sampler2D ${S};`),b=`getDiscreteColor(${S}, int(transformed)).r`}zC(t)?h.push(`uniform highp ${l} ${s};`):h.push(`in highp ${l} ${s};`);const v=[],w=lr(e.type)&&c>2,y=Zm(e.type)||w;if(v.push("int slot = 0;"),y){const S=r;v.push(w?`while (slot < ${S}.length() - 2 && value >= ${S}[slot + 1]) { slot++; }`:`while (slot < ${S}.length() && value >= ${S}[slot]) { slot++; }`)}const x=lr(e.type)||Zm(e.type)||["band","point"].includes(e.type);if(g){const S=r;x&&(a?v.push(`vec3 domain = ${S};`):v.push(`vec2 domain = vec2(${S}[slot], ${S}[slot + 1]);`)),v.push(`float transformed = ${g};`),w&&v.push(`transformed = (float(slot) + transformed) / (float(${S}.length() - 1));`)}else v.push("float transformed = float(slot);");"clamp"in e&&e.clamp()&&v.push(`transformed = clampToRange(transformed, ${WW(p)});`),v.push(`return ${b??"transformed"};`),h.push(`
${m} ${OW}${n}(${l} value) {
${v.map(S=>`    ${S}
`).join("")}
}`),h.push(`
${m} ${XX}${n}() {
    return ${OW}${n}(${s});
}`);const D=h.join(`
`);if(x&&n==i){const S=lr(e.type)||Zm(e.type)?c:2;u=a?`highp vec3 ${r};`:`mediump float ${r}[${S}];`}return{glsl:D,domainUniform:u}}function qM(n){if(!bo(n))throw new Error(`Not a number: ${n}`);if(n==1/0)return""+BW;if(n==-1/0)return""+-BW;{let e=`${n}`;return/^(-)?\d+$/.test(e)&&(e+=".0"),e}}function bg(n){typeof n=="number"&&(n=[n]);const e=n.length;if(e<1||e>4)throw new Error("Invalid number of components: "+e);let t,i;return e>1?(t=`vec${e}`,i=`${t}(${n.map(qM).join(", ")})`):(t="float",i=qM(n[0])),Object.assign(i,{type:t,numComponents:e})}function n1e(n){const e=jd(n).rgb();return bg([e.r,e.g,e.b].map(t=>t/255))}function WW(n){return bg([n[0],TC(n)])}function s1e(n,...e){const t=[];for(const i of e)bo(i)?t.push(qM(i)):jo(i)?t.push(bg(i)):t.push(i);return`${n}(${t.join(", ")})`}function tL(n){return n=="index"||n=="locus"}const QX=2**11,r1e=QX-1;function JX(n,e=[]){const t=n&r1e,i=n-t;return e[0]=i,e[1]=t,e}function o1e(n){const e=n%QX;return[n-e,e]}function a1e(n){return[...o1e(n[0]),n[1]-n[0]]}class l1e{constructor(e){this.size=e,this.arrays={},this.pushers=[],this.dataUpdaters=[],this.vertexCount=0}addConverter(e,t){const i=this.createUpdater(a6+e,t.numComponents||1,t.arrayReference),s=t.f;this.dataUpdaters.push(t.arrayReference?r=>i(s(r)):r=>i(s(r)))}createUpdater(e,t,i){if(!bo(this.size))throw new Error("The number of vertices must be defined!");let s,r,o=0;const a=new Float32Array(this.size*t);if(this.arrays[e]={data:a,numComponents:t},t==1){let l=0;const c=u=>{l=+u};s=()=>{a[o++]=l},r=c}else{let l=i??[0];const c=i?u=>{}:u=>{l=u};switch(t){case 1:break;case 2:s=()=>{a[o++]=l[0],a[o++]=l[1]},r=c;break;case 3:s=()=>{a[o++]=l[0],a[o++]=l[1],a[o++]=l[2]},r=c;break;case 4:s=()=>{a[o++]=l[0],a[o++]=l[1],a[o++]=l[2],a[o++]=l[3]},r=c;break;default:throw new Error("Invalid numComponents: "+t)}}return this.pushers.push(s),r}_unrollPushAll(){let e="",t="";for(let s=0;s<this.pushers.length;s++)e+=`const p${s} = that.pushers[${s}];
`,t+=`p${s}();
`;const i=new Function("that",`${e}

            return function unrolledPushAll() {
                ${t}
                that.vertexCount++;
            };
        `);this.pushAll=i(this)}pushAll(){this.size>1e5?this._unrollPushAll():this.pushAll=()=>{for(let t=0;t<this.pushers.length;t++)this.pushers[t]();this.vertexCount++},this.pushAll()}updateFromDatum(e){for(let t=0;t<this.dataUpdaters.length;t++)this.dataUpdaters[t](e)}pushFromDatum(e){this.updateFromDatum(e),this.pushAll()}}const n0=5,dI=127;function GM(n){const e=[];for(let g=0;g<=dI;g++)e.push(void 0);const t=new Map;for(const g of n.chars)g.id<=dI?e[g.id]=g:t.set(g.id,g);const i=8722;t.has(i)||t.set(i,e["-".charCodeAt(0)]);function s(g){return(g<=dI?e[g]:t.get(g))||e[63]}function r(g){return s(g.charCodeAt(0))}const o=n.common.base,a=r("x"),l=r("X"),c=r("q"),u=a.height-n0*2,h=l.height-n0*2,d=c.height-a.height+c.yoffset-a.yoffset;function f(g,p=1){let m=0;for(let b=0;b<g.length;b++)m+=s(g.charCodeAt(b)).xadvance;return m/o*p}return{measureWidth:f,getCharByCode:s,getChar:r,xHeight:u,capHeight:h,descent:d,common:n.common}}function c1e(n,e=0,t=1){return Math.max(e,Math.min(t,n))}const VW=2**31-1,u1e=-(2**31);function h1e(n,e,t,i=t){const s=new Int32Array(n);s.fill(VW);let r=u1e,o=!1;const a=new Int32Array(n),l=e[0],u=(e[1]-e[0])/n,h=(m,b)=>{const v=(m-l)/u,w=Math.floor(v);return c1e(b&&w==v?w-1:w,0,n-1)};function d(m,b,v){b>r?r=b:o||(o=!0,console.debug("Items are not ordered properly. Disabling binned index."));const w=t(m),y=h(w,!1);s[y]>b&&(s[y]=b),a[y]<v&&(a[y]=v)}function f(m,b,v){b>r?r=b:o||(o=!0,console.debug("Items are not ordered properly. Disabling binned index."));const w=t(m),y=i(m),x=h(w,!1),D=h(y,!0);for(let S=x;S<=D;S++)s[S]>b&&(s[S]=b),a[S]<v&&(a[S]=v)}const g=(m,b,v=[0,0])=>{const w=h(m,!1),y=h(b,!0),x=s[w],D=Math.max(a[y],x);return v[0]=x,v[1]=D,v},p=()=>{for(let b=1;b<a.length;b++)a[b]<a[b-1]&&(a[b]=a[b-1]);let m=!0;for(let b=s.length-1;b>0;b--)m&&s[b]==VW?(s[b]=a[b],m=!1):s[b-1]>s[b]&&(s[b-1]=s[b]);return g};if(d.getIndex=p,f.getIndex=p,!o)return t==i?d:f}class jC{constructor({encoders:e,numVertices:t=void 0,attributes:i=[]}){this.encoders=e,this.variableEncoders=Object.fromEntries(Object.entries(e).filter(([s,r])=>i.includes(s)&&r&&r.scale&&!r.constant)),this.allocatedVertices=t,this.variableBuilder=new l1e(t);for(const[s,r]of Object.entries(this.variableEncoders)){const o=r.accessor,a=[0,0],l=tL(r.scale.type),c=r.indexer,u=c?h=>c(o(h)):l?h=>JX(o(h),a):o;this.variableBuilder.addConverter(s,{f:u,numComponents:l?2:1,arrayReference:l?a:void 0})}this.lastOffset=0,this.rangeMap=new rp([],JSON.stringify)}registerBatch(e){var r;const t=this.lastOffset,i=this.variableBuilder.vertexCount,s=i-t;s&&this.rangeMap.set(e,{offset:t,count:s,xIndex:(r=this.xIndexer)==null?void 0:r.getIndex()}),this.lastOffset=i}addBatches(e){for(const[t,i]of e)this.addBatch(t,i)}addBatch(e,t,i=0,s=t.length){this.prepareXIndexer(t,i,s);for(let r=i;r<s;r++){const o=t[r];this.variableBuilder.pushFromDatum(o),this.addToXIndex(o)}this.registerBatch(e)}prepareXIndexer(e,t=0,i=t+e.length){const s=()=>{this.addToXIndex=l=>{},this.xIndexer=void 0};if(!e.length||i-t<0){s();return}const r=l=>{var c;return l&&lr((c=l.scale)==null?void 0:c.type)&&l},o=r(this.variableEncoders.x),a=r(this.variableEncoders.x2);if(o){const l=o.accessor,c=a?a.accessor:l,u=[l(e[t]),c(e[i-1])];if(u[1]>u[0]){this.xIndexer=h1e(50,u,l,c);let h=this.variableBuilder.vertexCount;this.addToXIndex=d=>{let f=this.variableBuilder.vertexCount;this.xIndexer(d,h,f),h=f}}else s()}else s()}addToXIndex(e){}toArrays(){return{arrays:this.variableBuilder.arrays,vertexCount:this.variableBuilder.vertexCount,allocatedVertices:this.allocatedVertices,rangeMap:this.rangeMap}}}class d1e extends jC{constructor({encoders:e,attributes:t,tessellationThreshold:i=1/0,visibleRange:s=[-1/0,1/0],numItems:r}){super({encoders:e,attributes:t,numVertices:i==1/0?r*6:void 0}),this.visibleRange=s,this.tessellationThreshold=i||1/0,this.updateFrac=this.variableBuilder.createUpdater("frac",2)}addBatch(e,t,i=0,s=t.length){if(s<=i)return;const r=this.encoders,[o,a]=this.visibleRange,l=d=>d.accessor||(f=>0),c=l(r.x),u=l(r.x2);this.prepareXIndexer(t,i,s);const h=[0,0];this.updateFrac(h);for(let d=i;d<s;d++){const f=t[d];let g=c(f),p=u(f);if(g>p&&([g,p]=[p,g]),p<o||g>a)continue;g<o&&(g=o),p>a&&(p=a),this.variableBuilder.updateFromDatum(f),h[0]=0,h[1]=0;const m=1;this.variableBuilder.pushAll();for(let b=0;b<=m;b++)h[0]=b/m,h[1]=0,this.variableBuilder.pushAll(),h[1]=1,this.variableBuilder.pushAll();this.variableBuilder.pushAll(),this.addToXIndex(f)}this.registerBatch(e)}}class f1e extends jC{constructor({encoders:e,attributes:t,tessellationThreshold:i=1/0,visibleRange:s=[-1/0,1/0],numItems:r}){super({encoders:e,attributes:t,numVertices:i==1/0?r*6:void 0}),this.visibleRange=s,this.tessellationThreshold=i||1/0,this.updateSide=this.variableBuilder.createUpdater("side",1),this.updatePos=this.variableBuilder.createUpdater("pos",1)}addBatch(e,t,i=0,s=t.length){this.prepareXIndexer(t,i,s);for(let r=i;r<s;r++){const o=t[r];this.variableBuilder.updateFromDatum(o),this.updateSide(-.5),this.updatePos(0),this.variableBuilder.pushAll();const a=1;for(let l=0;l<=a;l++)this.updatePos(l/a),this.updateSide(-.5),this.variableBuilder.pushAll(),this.updateSide(.5),this.variableBuilder.pushAll();this.variableBuilder.pushAll(),this.addToXIndex(o)}this.registerBatch(e)}}class g1e extends jC{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i})}}class p1e extends jC{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i})}toArrays(){const e=this.variableBuilder.arrays;for(let t of Object.values(e))t.divisor=1;return super.toArrays()}}class m1e extends jC{constructor({encoders:e,attributes:t,fontMetrics:i,properties:s,numCharacters:r=void 0}){super({encoders:e,attributes:t,numVertices:r*6}),this.metadata=i,this.metrics=i,this.properties=s;const a=e.text.channelDef;this.numberFormat=!bl(a)&&"format"in a&&a.format?js(a.format):l=>l,this.updateVertexCoord=this.variableBuilder.createUpdater("vertexCoord",2),this.updateTextureCoord=this.variableBuilder.createUpdater("textureCoord",2),this.updateWidth=this.variableBuilder.createUpdater("width",1)}addBatch(e,t,i=0,s=t.length){const r=this.properties.align||"left",o=this.properties.logoLetters??!1,a=this.metadata.common.base,l=this.metadata.common.scaleH;let c=-n0;switch(this.properties.baseline){case"top":c+=this.metrics.capHeight;break;case"middle":c+=this.metrics.capHeight/2;break;case"bottom":c-=this.metrics.descent;break}const u=this.encoders.text.accessor||this.encoders.text,h=[0,0];this.updateVertexCoord(h);const d=[0,0];this.updateTextureCoord(d),this.prepareXIndexer(t,i,s);for(let f=i;f<s;f++){const g=t[f],p=this.numberFormat(u(g)),m=wn(p)?p:p===null?"":""+p;if(m.length==0)continue;this.variableBuilder.updateFromDatum(g);const b=o?m.length:this.metrics.measureWidth(m);this.updateWidth(b);let v=r=="right"?-b:r=="center"?-b/2:0;if(!o){const D=this.metrics.getCharByCode(m.charCodeAt(0));v-=(D.width-D.xadvance)/a/2}let w=-.5,y=1,x=1;for(let D=0;D<m.length;D++){const S=this.metrics.getCharByCode(m.charCodeAt(D)),T=o?1:S.xadvance/a;if(S.id==32){v+=T;continue}o?(x=(S.width+n0*2)/S.width,v=-x/2,y=(S.height+n0*2)/S.height,w=-.5-n0/S.height):(y=S.height/a,w=-(S.height+S.yoffset+c)/a,x=S.width/a);const k=S.x,I=S.y;h[0]=v,h[1]=w+y,d[0]=k/l,d[1]=I/l,this.variableBuilder.pushAll(),h[0]=v+x,h[1]=w+y,d[0]=(k+S.width)/l,d[1]=I/l,this.variableBuilder.pushAll(),h[0]=v,h[1]=w,d[0]=k/l,d[1]=(I+S.height)/l,this.variableBuilder.pushAll(),h[0]=v+x,h[1]=w+y,d[0]=(k+S.width)/l,d[1]=I/l,this.variableBuilder.pushAll(),h[0]=v,h[1]=w,d[0]=k/l,d[1]=(I+S.height)/l,this.variableBuilder.pushAll(),h[0]=v+x,h[1]=w,d[0]=(k+S.width)/l,d[1]=(I+S.height)/l,this.variableBuilder.pushAll(),v+=T}this.addToXIndex(g)}this.registerBatch(e)}}const $W=`#define PI 3.141593

uniform View {
    /** Offset in "unit" units */
    mediump vec2 uViewOffset;
    mediump vec2 uViewScale;
    /** Size of the logical viewport in pixels, i.e., the view */
    mediump vec2 uViewportSize;
    lowp float uDevicePixelRatio;
    // TODO: Views with opacity less than 1.0 should be rendered into a texture
    // that is rendered with the specified opacity.
    lowp float uViewOpacity;
    bool uPickingEnabled;
};


/**
 * Maps a coordinate on the unit scale to a normalized device coordinate.
 * (0, 0) is at the bottom left corner.
 */
vec4 unitToNdc(vec2 coord) {
    return vec4((coord * uViewScale + uViewOffset) * 2.0 - 1.0, 0.0, 1.0);
}

vec4 unitToNdc(float x, float y) {
    return unitToNdc(vec2(x, y));
}

vec4 pixelsToNdc(vec2 coord) {
    return unitToNdc(coord / uViewportSize);
}

vec4 pixelsToNdc(float x, float y) {
    return pixelsToNdc(vec2(x, y));
}

float linearstep(float edge0, float edge1, float x) {
    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
}

// Fragment shader stuff ////////////////////////////////////////////////////////

// TODO: include the following only in fragment shaders

/**
 * Specialized linearstep for doing antialiasing
 */
float distanceToRatio(float d) {
	return clamp(d * uDevicePixelRatio + 0.5, 0.0, 1.0);
}

vec4 distanceToColor(float d, vec4 fill, vec4 stroke, float halfStrokeWidth) {
    if (halfStrokeWidth > 0.0) {
        // Distance to stroke's edge. Negative inside the stroke.
        float sd = abs(d) - halfStrokeWidth;
        return mix(
            stroke,
            d <= 0.0 ? fill : vec4(0.0),
            distanceToRatio(sd));
    } else {
        return fill * distanceToRatio(-d);
    }
}
`,_1e=`const float inf = 1.0 / 0.0;

// Utils ------------

vec3 getDiscreteColor(sampler2D s, int index) {
    return texelFetch(s, ivec2(index % textureSize(s, 0).x, 0), 0).rgb;
}

vec3 getInterpolatedColor(sampler2D s, float unitValue) {
    return texture(s, vec2(unitValue, 0.0)).rgb;
}

float clampToRange(float value, vec2 range) {
    return clamp(value, min(range[0], range[1]), max(range[0], range[1]));
}

// Scales ------------
// Based on d3 scales: https://github.com/d3/d3-scale

float scaleIdentity(float value) {
    return value;
}

float scaleLinear(float value, vec2 domain, vec2 range) {
    float domainSpan = domain[1] - domain[0];
    float rangeSpan = range[1] - range[0];
    return (value - domain[0]) / domainSpan * rangeSpan + range[0];
}

float scaleLog(float value, vec2 domain, vec2 range, float base) {
    // y = m log(x) + b 
    // TODO: Perf optimization: precalculate log domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(log(value) / log(base), log(domain) / log(base), range);
}

float symlog(float value, float constant) {
    // WARNING: emulating log1p with log(x + 1). Small numbers are likely to
    // have significant precision problems.
    return sign(value) * log(abs(value / constant) + 1.0);
}

float scaleSymlog(float value, vec2 domain, vec2 range, float constant) {
    return scaleLinear(
        symlog(value, constant),
        vec2(symlog(domain[0], constant), symlog(domain[1], constant)),
        range
    );
}

float scalePow(float value, vec2 domain, vec2 range, float exponent) {
    // y = mx^k + b
    // TODO: Perf optimization: precalculate pow domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(
        pow(abs(value), exponent) * sign(value),
        pow(abs(domain), vec2(exponent)) * sign(domain),
        range
    );
}

// TODO: scaleThreshold
// TODO: scaleQuantile (special case of threshold scale)

float scaleBand(float value, vec2 domainExtent, vec2 range,
                float paddingInner, float paddingOuter,
                float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    float n = domainExtent[1] - domainExtent[0];

    // This fix departs from Vega and d3: https://github.com/vega/vega/issues/3357#issuecomment-1063253596
    paddingInner = int(n) > 1 ? paddingInner : 0.0;

    // Adapted from: https://github.com/d3/d3-scale/blob/master/src/band.js
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    return start + (value - domainExtent[0]) * step + bandwidth * band;
}

// High precision variant of scaleBand for index/locus scales
float scaleBandHp(vec2 value, vec3 domainExtent, vec2 range,
                 float paddingInner, float paddingOuter,
                 float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    vec2 domainStart = domainExtent.xy;
    float n = domainExtent[2];

    // The following computation is identical for every vertex. Could be done on the JS side.
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    // Using max to prevent the shader compiler from wrecking the precision.
    // Othwewise the compiler could optimize the sum of the four terms into
    // some equivalent form that does premature rounding.
    float hi = max(value[0] - domainStart[0], -inf);
    float lo = max(value[1] - domainStart[1], -inf);

    return dot(vec4(start, hi, lo, bandwidth), vec4(1.0, step, step, band));
}
`,b1e=`
/**
 * Describes where a sample facet should be shown. Interpolating between the
 * current and target positions/heights allows for transitioning between facet
 * configurations.
 */
struct SampleFacetPosition {
    float pos;
    float height;
    float targetPos;
    float targetHeight;
};

/**
 * Trasition fraction [0, 1] between the current and target configurations.
 */
uniform float uTransitionOffset;


// ----------------------------------------------------------------------------

#if !defined(SAMPLE_FACET_UNIFORM) && !defined(SAMPLE_FACET_TEXTURE)

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

#elif defined(SAMPLE_FACET_UNIFORM)

/**
 * Location and height of the band on the Y axis on a normalized [0, 1] scale.
 * Elements: curr pos, curr height, target pos, target height
 */
uniform vec4 uSampleFacet;

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(
        1.0 - uSampleFacet.x - uSampleFacet.y,
        uSampleFacet.y,
        1.0 - uSampleFacet.z - uSampleFacet.w,
        uSampleFacet.w
    );
}

#elif defined(SAMPLE_FACET_TEXTURE)

uniform sampler2D uSampleFacetTexture;

SampleFacetPosition getSampleFacetPos() {
    vec4 texel = texelFetch(uSampleFacetTexture, ivec2(int(attr_facetIndex), 0), 0);
    return SampleFacetPosition(
        1.0 - texel.r - texel.g,
        texel.g,
        1.0 - texel.r - texel.g,
        texel.g);
}

#endif

// ----------------------------------------------------------------------------

bool isFacetedSamples(SampleFacetPosition facetPos) {
    return facetPos != SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

bool isFacetedSamples() {
    return isFacetedSamples(getSampleFacetPos());
}

bool isInTransit() {
    return uTransitionOffset > 0.0;
}

float getTransitionFraction(float xPos) {
    return smoothstep(0.0, 0.7 + uTransitionOffset, (xPos - uTransitionOffset) * 2.0);
}

vec2 applySampleFacet(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return pos;
    } else if (isInTransit()) {
        vec2 interpolated = mix(
            vec2(facetPos.pos, facetPos.height),
            vec2(facetPos.targetPos, facetPos.targetHeight),
            getTransitionFraction(pos.x));
        return vec2(pos.x, interpolated[0] + pos.y * interpolated[1]);
    } else {
        return vec2(pos.x, facetPos.pos + pos.y * facetPos.height);
    }
}

float getSampleFacetHeight(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return 1.0;
    } else if (isInTransit()) {
        return mix(
            facetPos.height,
            facetPos.targetHeight,
            getTransitionFraction(pos.x));
    } else {
        return facetPos.height;
    }
}
`,v1e=`/*
 * Based on concepts presented at:
 * https://webglfundamentals.org/webgl/lessons/webgl-picking.html
 * https://deck.gl/docs/developer-guide/custom-layers/picking
 */

out highp vec4 vPickingColor;

/**
 * Passes the unique id to the fragment shader as a color if picking is enabled.
 * Returns true if picking is enabled.
 */
bool setupPicking() {
    if (uPickingEnabled) {
#ifdef uniqueId_DEFINED
        int id = int(getScaled_uniqueId());
        // TODO: Take the sign bit into account
        vPickingColor = vec4(
            ivec4(id >> 0, id >> 8, id >> 16, 0xFF) & 0xFF
        ) / float(0xFF);
#else
        vPickingColor = vec4(1.0);
#endif
        return true;
    }
    return false;
}
`,w1e=`in highp vec4 vPickingColor;
`,I2=Symbol("cacheMap");function M_(n,e,t){let i=Vw(n).get(e);return i===void 0&&(i=t(e),Vw(n).set(e,i)),i}function eQ(n,e){Vw(n).delete(e)}function N2(n,e){const t=Vw(n);for(const i of t.keys())i.startsWith(e)&&t.delete(i);Vw(n).delete(e)}function tQ(n){n[I2]=new Map}function Vw(n){return n[I2]||tQ(n),n[I2]}function y1e(n,e,t,i){const s=wn(n)?n:n.name,r=!wn(n)&&n.extent||[0,1];if(t===void 0&&!wn(n)&&(t=n.count),s){const o=V5(s);if(go(o)){const a=iQ(o,{extent:r,count:t});return YE(e,{minMag:e.LINEAR,format:e.RGB,height:1,wrap:e.CLAMP_TO_EDGE},a,i)}else{if(jo(o))return KM(o,e);throw new Error("Unknown scheme: "+s)}}}function C1e(n,e="rgb",t,i){const s=PE(n,wn(e)?e:e.type,wn(e)?void 0:e.gamma),r=iQ(s);return YE(t,{minMag:t.LINEAR,format:t.RGB,height:1,wrap:t.CLAMP_TO_EDGE},r,i)}function S1e(n,e,t,i){const s=Math.max(n.length,t||0),r=new Float32Array(s);for(let o=0;o<s;o++)r[o]=n[o%n.length];return YE(e,{minMag:e.NEAREST,format:e.RED,internalFormat:e.R32F,height:1},r,i)}function KM(n,e,t,i){const s=nQ(n,t);return YE(e,{minMag:e.NEAREST,format:e.RGB,height:1},s,i)}function iQ(n,{extent:e=[0,1],reverse:t=!1,count:i=256}={}){const s=e[0],r=TC(e)-s,o=vw(i).map(a=>a/(i-1)).map(a=>s+a/r).map(n);return t&&o.reverse(),nQ(o)}function nQ(n,e){const t=Math.max(n.length,e||0),i=new Uint8Array(t*3);for(let s=0;s<t;s++){const r=jd(n[s%n.length]).rgb();i[s*3+0]=r.r,i[s*3+1]=r.g,i[s*3+2]=r.b}return i}class x1e{constructor(e,t,i){this._container=e,this._sizeSource=t,this._shaderCache=new Map,this._listeners=[],this.rangeTextures=new WeakMap;const s=document.createElement("canvas");e.appendChild(s);const r=Ybe(s,{antialias:!0,depth:!1,premultipliedAlpha:!0});if(!r)throw new Error("Unable to initialize WebGL. Your browser or machine may not support it.");if(!Ab(r))throw new Error("Your web browser does not support WebGL 2.0. Chrome, Firefox, and Safari Tech Preview should work.");if(ZX(r),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),this.canvas=s,this.gl=r,this._pickingAttachmentOptions=[{format:r.RGBA,type:r.UNSIGNED_BYTE,minMag:r.LINEAR,wrap:r.CLAMP_TO_EDGE}],this._pickingBufferInfo=Ube(r,this._pickingAttachmentOptions),r.bindFramebuffer(r.FRAMEBUFFER,null),this.adjustGl(),this._resizeObserver=new ResizeObserver(o=>{this.invalidateSize(),this._emit("resize")}),this._resizeObserver.observe(this._container),this._updateDpr(),this._clearColor=[0,0,0,0],i){const o=jd(i).rgb();this._clearColor=[o.r/255,o.g/255,o.b/255,o.opacity]}}invalidateSize(){this._logicalCanvasSize=void 0,this._updateDpr(),this.adjustGl()}_updateDpr(){this.dpr=window.devicePixelRatio}compileShader(e,t){const i="#version 300 es",s="precision mediump float;";jo(t)&&(t=t.join(`

`));const r=this.gl,o=t.replaceAll(/ {2,}|^\s*\/\/.*$/gm,"");let a=this._shaderCache.get(o);if(!a){const l=[i,s,t].join(`

`);a=r.createShader(e),r.shaderSource(a,l),r.compileShader(a),this._shaderCache.set(o,a)}return a}adjustGl(){const e=this.getLogicalCanvasSize();this.canvas.style.width=`${e.width}px`,this.canvas.style.height=`${e.height}px`;const t=this.getPhysicalCanvasSize(e);this.canvas.width=t.width,this.canvas.height=t.height,jbe(this.gl,this._pickingBufferInfo,this._pickingAttachmentOptions)}finalize(){this._resizeObserver.unobserve(this._container),this.canvas.remove()}getPhysicalCanvasSize(e){return e=e||this.getLogicalCanvasSize(),{width:e.width*this.dpr,height:e.height*this.dpr}}getLogicalCanvasSize(){var r;if(this._logicalCanvasSize)return this._logicalCanvasSize;const e=((r=this._sizeSource)==null?void 0:r.call(this))??{width:void 0,height:void 0},t=window.getComputedStyle(this._container,null),i=e.width??this._container.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),s=e.height??this._container.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);return this._logicalCanvasSize={width:i,height:s},this._logicalCanvasSize}addEventListener(e,t){this._listeners.push({type:e,listener:t})}_emit(e){for(const t of this._listeners)t.type===e&&t.listener()}readPickingPixel(e,t){const i=this.gl;e*=this.dpr,t*=this.dpr;const s=this.getPhysicalCanvasSize().height,r=new Uint8Array(4);return i.bindFramebuffer(i.FRAMEBUFFER,this._pickingBufferInfo.framebuffer),i.readPixels(e,s-t-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),i.bindFramebuffer(i.FRAMEBUFFER,null),r}clearAll(){const e=this.gl,{width:t,height:i}=this.getPhysicalCanvasSize();e.viewport(0,0,t,i),e.disable(e.SCISSOR_TEST),e.clearColor(...this._clearColor),e.clear(e.COLOR_BUFFER_BIT)}createRangeTexture(e,t=!1){const i=this.rangeTextures.get(e);if(!t&&i)return;function s(o,a){return Gd(a.type)?a.domain().length:a.type=="threshold"?a.domain().length+1:a.type=="quantize"||a.type=="quantile"?o??4:o}const r=e.channel;if(Vg(r)){const o=e.getScaleProps(),a=e.getScale(),l=a.range();let c;if(o.scheme)if(a.type=="threshold"&&l)c=KM(l,this.gl,a.domain().length,i);else{let u=wn(o.scheme)?void 0:o.scheme.count;u=s(u,a),c=y1e(o.scheme,this.gl,u,i)}else FE(a.type)||lr(a.type)&&l.length>2?c=C1e(l,o.interpolate,this.gl,i):c=KM(l,this.gl,a.domain().length,i);this.rangeTextures.set(e,c)}else{const o=e.getScale();if(o.type==="ordinal"||Zm(o.type)){const a=BE(r)?YY(r):c=>c,l=e.getScale().range();this.rangeTextures.set(e,S1e(l.map(a),this.gl,o.domain().length,i))}}}}function k1e(n,e="",t=0){const i=/ERROR:\s*\d+:(\d+)/gi,s=[...e.matchAll(i)],r=new Map(s.map((o,a)=>{const l=parseInt(o[1]),c=s[a+1],u=c?c.index:e.length,h=e.substring(o.index,u);return[l-1,h]}));return n.split(`
`).map((o,a)=>{const l=r.get(a);return`${a+1+t}: ${o}${l?`

^^^ ${l}`:""}`}).join(`
`)}function L1e(n,e,t){const i=n.createProgram();n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i);function s(){let r,o;if(!n.getProgramParameter(i,n.LINK_STATUS)){r=n.getProgramInfoLog(i);for(const l of[e,t])n.getShaderParameter(l,n.COMPILE_STATUS)||(r=n.getShaderInfoLog(l),o=k1e(n.getShaderSource(l),r,0)+`
Error compiling: ${r}`,n.deleteShader(l));n.deleteProgram(i)}if(r)return{message:r,detail:o}}return{program:i,getProgramErrors:s}}function YE(n,e,t,i){return i?_X(n,i,t,e):i=Ww(n,{...e,src:t}),i}function D1e(...n){const e={get(t,i,s){for(const r of n){const a=r()[i];if(a!==void 0)return a}},has(t,i,s){for(const r of n){const o=r();if(i in o)return!0}return!1}};return new Proxy({},e)}function E1e(n){return wn(n)||bo(n)||mE(n)}const T1e="SAMPLE_FACET_UNIFORM",zW="SAMPLE_FACET_TEXTURE";class qC{constructor(e){this.unitView=e,this.encoders=void 0,this.bufferInfo=void 0,this.programInfo=void 0,this.vertexArrayInfo=void 0,this.domainUniformInfo=void 0,this.viewUniformInfo=void 0,this.rangeMap=new A1e,this.defaultProperties={get clip(){return["x","y"].map(t=>e.getScaleResolution(t)).some(t=>(t==null?void 0:t.isZoomable())??!1)},xOffset:0,yOffset:0,minBufferSize:0},this.properties=D1e(typeof this.unitView.spec.mark=="object"?()=>this.unitView.spec.mark:()=>({}),()=>this.defaultProperties)}get opaque(){return!1}getAttributes(){throw new Error("Not implemented!")}getSupportedChannels(){return["sample","facetIndex","x","y","color","opacity","search","uniqueId"]}getDefaultEncoding(){const e={sample:void 0,uniqueId:void 0};return this.isPickingParticipant()&&(e.uniqueId={field:"_uniqueId"}),e}fixEncoding(e){return e}get encoding(){return M_(this,"encoding",()=>{const e=this.getDefaultEncoding(),t=this.unitView.getEncoding(),i=o=>{const a=this.properties[o];return E1e(a)&&{value:a}},s=Object.fromEntries(this.getSupportedChannels().map(o=>[o,i(o)]).filter(o=>o[1].value!==void 0)),r=this.fixEncoding({...e,...s,...t});for(const o of Object.keys(r))this.getSupportedChannels().includes(o)||delete r[o];return r})}getContext(){return this.unitView.context}getType(){return this.unitView.getMarkType()}initializeData(){}initializeEncoders(){this.encoders=ime(this)}async initializeGraphics(){}updateGraphicsData(){}getSampleFacetMode(){if(this.encoders.facetIndex)return zW;if(this.unitView.getLayoutAncestors().find(e=>"samples"in e.spec))return T1e}createAndLinkShaders(e,t,i=[]){const s=this.getAttributes();i.push("// view: "+this.unitView.getPathString()),this.domainUniforms=[];let r=[];const o=this.getSampleFacetMode();o&&i.push(`#define ${o}`);for(const d of s){let f;if(d in this.encoding)f=d;else continue;const g=this.encoding[f];if(g)if(bl(g))r.push(t1e(f,g.value));else{const p=aa(g)&&g.resolutionChannel||f,m=$g(p)?this.unitView.getScaleResolution(p).getScale():OE(),b=i1e(f,m,g);r.push(b.glsl),b.domainUniform&&this.domainUniforms.push(b.domainUniform)}}const a=this.domainUniforms.length?`layout(std140) uniform Domains {
`+this.domainUniforms.map(d=>`    ${d}
`).join("")+`};

`:"",c=[`precision highp float;
`,...i,$W,_1e,a,...r,b1e,v1e,e],u=[...i,$W,w1e,t],h=this.gl;this.programStatus=L1e(h,this.glHelper.compileShader(h.VERTEX_SHADER,c),this.glHelper.compileShader(h.FRAGMENT_SHADER,u))}finalizeGraphicsInitialization(){const e=this.programStatus.getProgramErrors();if(e){e.detail&&console.warn(e.detail);const t=new Error("Cannot create shader program: "+e.message);throw t.view=this.unitView,t}this.programInfo=Dbe(this.gl,this.programStatus.program),delete this.programStatus,this.domainUniforms.length&&(this.domainUniformInfo=NW(this.gl,this.programInfo,"Domains")),this.viewUniformInfo=NW(this.gl,this.programInfo,"View"),this.gl.useProgram(this.programInfo.program),this._setDatums(),Io(this.programInfo,{uSampleFacet:[0,1,0,1],uTransitionOffset:0})}_setDatums(){for(const[e,t]of Object.entries(this.encoding))if(zC(t)){const i=this.encoders[e],s=i.indexer?i.indexer(t.datum):tL(i.scale.type)?JX(+t.datum):+t.datum;Io(this.programInfo,{[a6+e]:s})}}deleteGraphicsData(){if(this.bufferInfo){const e=this.gl;for(let t=0;t<8;t++)e.disableVertexAttribArray(t);Object.values(this.bufferInfo.attribs).forEach(t=>this.gl.deleteBuffer(t.buffer)),this.bufferInfo.indices&&this.gl.deleteBuffer(this.bufferInfo.indices),this.bufferInfo=void 0}}updateBufferInfo(e){if(this.gl.bindVertexArray(null),this.bufferInfo&&e.vertexCount<=this.bufferInfo.allocatedVertices)for(const[t,i]of Object.entries(e.arrays))i.data&&Wme(this.gl,this.bufferInfo.attribs[t],i.data,0);else this.deleteGraphicsData(),this.bufferInfo=zme(this.gl,e.arrays,{numElements:e.vertexCount}),this.bufferInfo.allocatedVertices=e.allocatedVertices,this.vertexArrayInfo=void 0}get glHelper(){return this.getContext().glHelper}get gl(){return this.glHelper.gl}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}isReady(){return this.bufferInfo&&this.programInfo}isPickingParticipant(){if(this.properties.tooltip===null)return!1;for(const e of this.unitView.getLayoutAncestors())if(!e.isPickingSupported())return!1;return!0}prepareRender(e){const t=this.glHelper,i=this.gl,s=[];if(s.push(()=>{this.vertexArrayInfo||(this.vertexArrayInfo=qbe(this.gl,this.programInfo,this.bufferInfo)),i.useProgram(this.programInfo.program)}),this.domainUniformInfo){for(const[o,a]of Object.entries(this.domainUniformInfo.setters)){const l=o.substring(YX.length),c=this.encoding[l],u=aa(c)&&c.resolutionChannel||l;if($g(u)){const h=this.unitView.getScaleResolution(u).getScale();s.push(()=>{const d=Gd(h.type)?[0,h.domain().length]:h.domain();a(tL(h.type)?a1e(d):d)})}}s.push(()=>RW(i,this.programInfo,this.domainUniformInfo))}for(const[o,a]of Object.entries(this.encoding))if(aa(a)){const l=aa(a)&&a.resolutionChannel||o;if($g(l)){const c=this.unitView.getScaleResolution(l),u=t.rangeTextures.get(c);u&&s.push(()=>Io(this.programInfo,{[jM+o]:u}))}}this.getSampleFacetMode()==zW&&s.push(()=>{let o;for(const a of this.unitView.getLayoutAncestors())if(o=a.getSampleFacetTexture(),o)break;if(!o)throw new Error("No facet texture available. This is bug.");Io(this.programInfo,{uSampleFacetTexture:o})});const r=(e.picking??!1)&&this.isPickingParticipant();return s.push(()=>MW(this.viewUniformInfo,{uViewOpacity:this.unitView.getEffectiveOpacity(),uPickingEnabled:r})),this.opaque||e.picking?s.push(()=>i.disable(i.BLEND)):s.push(()=>i.enable(i.BLEND)),s}prepareSampleFacetRendering(e){const t=e.sampleFacetRenderingOptions,i=this.programInfo.uniformSetters.uSampleFacet;if(t&&i){const s=t.locSize?t.locSize.location:0,r=t.locSize?t.locSize.size:1;if(s>1||s+r<0)return!1;const o=t.targetLocSize?t.targetLocSize.location:s,a=t.targetLocSize?t.targetLocSize.size:r;this.gl.uniform4f(i.location,s,r,o,a)}return!0}render(e){}createRenderCallback(e,t){var h;if(!this.bufferInfo){const d=new Error(`${this.getType()} mark has no data. This is bug.`);throw d.view=this.unitView,d}const i=this;let s;const r=(h=this.unitView.getScaleResolution("x"))==null?void 0:h.getScale(),o=r&&lr(r.type),a=["index","locus"].includes(r==null?void 0:r.type)?-1:0,l=[0,0];s=d=>{if(o&&d.xIndex){const f=r.domain(),g=d.xIndex(f[0]+a,f[1],l),p=g[0],m=g[1]-p;m>0&&e(p,m)}else e(d.offset,d.count)};const c=this.rangeMap.get(void 0).count==0?t.facetId:void 0,u=this.rangeMap.get(c);return t.sampleFacetRenderingOptions?function(){u.count&&i.prepareSampleFacetRendering(t)&&s(u)}:function(){u.count&&s(u)}}setViewport(e,t){e=e.flatten();const i=this.unitView.context.devicePixelRatio,s=this.gl,r=this.properties,o=this.glHelper.getLogicalCanvasSize(),a=.5,l=(r.xOffset??0)+a,c=(r.yOffset??0)+a;let u,h=e;if(r.clip!=="never"&&(r.clip||t)){let d=0,f=0,g;if(t){if(h=e.intersect(t).flatten(),!h.isDefined())return!1;g=[e.width/h.width,e.height/h.height],f=Math.max(0,e.y2-t.y2),d=Math.max(0,e.x2-t.x2)}else g=[1,1];const p=[h.x,o.height-h.y2,h.width,h.height].map(w=>w*i),m=p.map(w=>Math.round(w)),[b,v]=p.map((w,y)=>w-m[y]);s.viewport(...m),s.scissor(...m),s.enable(s.SCISSOR_TEST),u={uViewOffset:[(l+d+b/i)/h.width,-(c+f-v/i)/h.height],uViewScale:g}}else{if(!e.isDefined())return!1;s.viewport(0,0,o.width*i,o.height*i),s.disable(s.SCISSOR_TEST),u={uViewOffset:[(e.x+l)/o.width,(o.height-e.y-c-e.height)/o.height],uViewScale:[e.width/o.width,e.height/o.height]}}return MW(this.viewUniformInfo,{...u,uViewportSize:[e.width,e.height],uDevicePixelRatio:i}),RW(this.gl,this.programInfo,this.viewUniformInfo),!0}findDatumAt(e,t){}}let A1e=class extends rp{constructor(){super([],JSON.stringify)}get(e){let t=super.get(e);return t===void 0&&(t={offset:0,count:0,xIndex:void 0},super.set(e,t)),t}migrateEntries(e){for(const[t,i]of e.entries())Object.assign(this.get(t),i)}};function ZM(n,e){const t=ome(e);let i=n[e]&&{...n[e]},s=n[t]&&{...n[t]};if(!(bl(i)||bl(s))){if(i){if(!aa(n[e]))return;if(s){if(i.type!="quantitative"){const r=(1-(i.band||1))/2;i.band=r,s.band=-r}}else if(i.type=="quantitative")s={datum:0};else{s={...i};const r=(1-(i.band??1))/2;i.band=0+r,s.band=1-r}}else i={value:0},s={value:1};n[e]=i,n[t]=s}}function sQ(n,e){n.stroke||(e?n.stroke={value:null}:n.stroke={resolutionChannel:"color",...n.color}),bl(n.stroke)&&n.stroke.value===null&&(n.strokeWidth={value:0}),n.strokeOpacity||(n.strokeOpacity={resolutionChannel:"opacity",...n.opacity})}function rQ(n,e){bl(n.fill)&&n.fill.value===null?n.fillOpacity={value:0}:n.fill||(n.fill={resolutionChannel:"color",...n.color},!e&&!n.fillOpacity&&(n.fillOpacity={value:0})),n.fillOpacity||(e?n.fillOpacity={resolutionChannel:"opacity",...n.opacity}:n.fillOpacity={value:0})}class I1e extends qC{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x2:void 0,y2:void 0,filled:!0,color:"#4c78a8",opacity:1,strokeWidth:3,cornerRadius:0,minWidth:.5,minHeight:.5,minOpacity:1,tessellationZoomThreshold:10,tessellationTiles:35}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}get opaque(){return M_(this,"opaque",()=>!this._isRoundedCorners()&&!this._isStroked()&&bl(this.encoding.fillOpacity)&&this.encoding.fillOpacity.value==1&&this.properties.minOpacity==1)&&this.unitView.getEffectiveOpacity()==1}fixEncoding(e){return ZM(e,"x"),ZM(e,"y"),sQ(e,this.properties.filled),rQ(e,this.properties.filled),delete e.color,delete e.opacity,e}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}_isRoundedCorners(){const e=this.properties;return e.cornerRadius||e.cornerRadiusBottomLeft||e.cornerRadiusBottomRight||e.cornerRadiusTopLeft||e.cornerRadiusTopRight}_isStroked(){const e=this.encoding.strokeWidth;return!(bl(e)&&!e.value)}async initializeGraphics(){await super.initializeGraphics();const e=[];this._isRoundedCorners()&&e.push("ROUNDED_CORNERS"),this._isStroked()&&e.push("STROKED"),this.createAndLinkShaders(Xbe,Qbe,e.map(t=>"#define "+t))}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;Io(this.programInfo,{uMinSize:[e.minWidth,e.minHeight],uMinOpacity:e.minOpacity,uCornerRadii:[e.cornerRadiusTopRight??e.cornerRadius,e.cornerRadiusBottomRight??e.cornerRadius,e.cornerRadiusTopLeft??e.cornerRadius,e.cornerRadiusBottomLeft??e.cornerRadius]})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new d1e({encoders:this.encoders,attributes:this.getAttributes(),numItems:t});i.addBatches(e.facetBatches);const s=i.toArrays();this.rangeMap.migrateEntries(s.rangeMap),this.updateBufferInfo(s)}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>Nb(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>{UC(t,this.vertexArrayInfo,t.TRIANGLE_STRIP,s,i)},e)}findDatumAt(e,t){e=po(e);const i=this.unitView.getCollector().facetBatches.get(e);if(!i)return;const s=this.encoders,r=s.x.scale.type;if(Gd(r)){const o=s.x.accessor;return i.find(a=>t==o(a))}else{const o=s.x.accessor,a=s.x2.accessor;return i.find(l=>t>=o(l)&&t<a(l))}}}const N1e=`/**
 * The stroke should only grow inwards, e.g, the diameter/outline is not affected by the stroke width.
 * Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with
 * geometric zoom, etc.
 */
uniform bool uInwardStroke;

/** Maximum size of the largest point as the fraction of the height of the (faceted) view */
uniform lowp float uMaxRelativePointDiameter;

/** Scale factor for geometric zoom */
uniform float uScaleFactor;

/** The size of the largest point in the data */
uniform float uMaxPointSize;

uniform float uZoomLevel;
uniform float uSemanticThreshold;

out float vRadius;
out float vRadiusWithPadding;
out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out lowp float vShape;
out lowp float vHalfStrokeWidth;
out mat2 vRotationMatrix;


float computeSemanticThresholdFactor() {
    // TODO: add smooth transition
    return getScaled_semanticScore() >= uSemanticThreshold ? 1.0 : 0.0;
}

/**
 * Computes a scaling factor for the points in a sample-faceted view.
 */
float getDownscaleFactor(vec2 pos) {
    if (!isFacetedSamples()) {
        return 1.0;
    }

    float sampleFacetHeight = getSampleFacetHeight(pos);
    float maxPointDiameter = sqrt(uMaxPointSize);

    float factor = sampleFacetHeight *
        uViewportSize.y *
        uMaxRelativePointDiameter;

    return clamp(0.0, maxPointDiameter, factor) / maxPointDiameter;
}

// TODO: Move this into common.glsl or something
vec2 getDxDy() {
#if defined(dx_DEFINED) || defined(dy_DEFINED)
    return vec2(getScaled_dx(), getScaled_dy()) / uViewportSize;
#else
    return vec2(0.0, 0.0);
#endif
}

void main(void) {

    float semanticThresholdFactor = computeSemanticThresholdFactor();
    if (semanticThresholdFactor <= 0.0) {
        gl_PointSize = 0.0;
        // Place the vertex outside the viewport. The default (0, 0) makes this super-slow
        // on Apple Silicon. Probably related to the tile-based GPU architecture.
        gl_Position = vec4(100.0, 0.0, 0.0, 0.0);
        // Exit early. MAY prevent some unnecessary calculations.
        return;
    }

    float size = getScaled_size();
    vec2 pos = vec2(getScaled_x(), getScaled_y()) + getDxDy();

    gl_Position = unitToNdc(applySampleFacet(pos));

    float strokeWidth = getScaled_strokeWidth();

    float diameter = sqrt(size) *
        uScaleFactor *
        semanticThresholdFactor *
        getDownscaleFactor(pos);

    // Clamp minimum size and adjust opacity instead. Yields more pleasing result,
    // no flickering etc.
    float opacity = uViewOpacity;
	if (strokeWidth <= 0.0 || uInwardStroke) {
		float minDiameter = 1.0 / uDevicePixelRatio;
		if (diameter < minDiameter) {
			// We do some "cheap" gamma correction here. It breaks on dark background, though.
			// First we take a square of the size and then apply "gamma" of 1.5.
			opacity *= pow(diameter / minDiameter, 2.5);
			diameter = minDiameter;
		}
	}

	float fillOpa = getScaled_fillOpacity() * opacity;
	float strokeOpa = getScaled_strokeOpacity() * opacity;

    vShape = getScaled_shape();

	// Circle doesn't have sharp corners. Do some special optimizations to minimize the point size.
	bool circle = vShape == 0.0;

	float angleInDegrees = getScaled_angle();
	float angle = -angleInDegrees * PI / 180.0;
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    vRotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
	float roomForRotation = circle ? 1.0 : sin(mod(angle, PI / 2.0) + PI / 4.0) / sin(PI / 4.0);

	float aaPadding = 1.0 / uDevicePixelRatio;
	float rotationPadding = (diameter * roomForRotation) - diameter;
	// sqrt(3.0) ensures that the angles of equilateral triangles have enough room
	float strokePadding = uInwardStroke ? 0.0 : strokeWidth * (circle ? 1.0 : sqrt(3.0));
	float padding = rotationPadding + strokePadding + aaPadding;
    gl_PointSize = (diameter + padding) * uDevicePixelRatio;

	vRadius = diameter / 2.0;
	vRadiusWithPadding = vRadius + padding / 2.0;

    vHalfStrokeWidth = strokeWidth / 2.0;

    vFillColor = vec4(getScaled_fill() * fillOpa, fillOpa);
    vStrokeColor = vec4(getScaled_stroke() * strokeOpa, strokeOpa);

    setupPicking();
}
`,R1e=`const lowp vec4 white = vec4(1.0);
const lowp vec4 black = vec4(0.0, 0.0, 0.0, 1.0);

uniform bool uInwardStroke;
uniform float uGradientStrength;

in float vRadius;
in float vRadiusWithPadding;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in lowp float vShape;
in lowp float vHalfStrokeWidth;

in mat2 vRotationMatrix;

out lowp vec4 fragColor;

const float CIRCLE = 0.0;
const float SQUARE = 1.0;
const float TRIANGLE_UP = 2.0;
const float CROSS = 3.0;
const float DIAMOND = 4.0;
const float TRIANGLE_DOWN = 5.0;
const float TRIANGLE_RIGHT = 6.0;
const float TRIANGLE_LEFT = 7.0;


// The distance functions are inspired by:
// http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
// However, these are not true distance functions, because the corners need to be sharp.

float circle(vec2 p, float r) {
    return length(p) - r;
}

float square(vec2 p, float r) {
    p = abs(p);
    return max(p.x, p.y) - r;
}

float equilateralTriangle(vec2 p, float r, bool flip, bool swap) {
    if (swap) {
        p.xy = p.yx;
    }
    if (flip) {
        p.y = -p.y;
    }

    float k = sqrt(3.0);
    float kr = k * r;
    //p.y -= kr * 2.0 / 3.0;
    p.y -= kr / 2.0;
    return max((abs(p.x) * k + p.y) / 2.0, -p.y - kr);
}

float crossShape(vec2 p, float r) {
    p = abs(p);

	vec2 b = vec2(0.4, 1.0) * r;
    vec2 v = abs(p) - b.xy;
    vec2 h = abs(p) - b.yx;
    return min(max(v.x, v.y), max(h.x, h.y));
}

float diamond(vec2 p, float r) {
    p = abs(p);
    return (max(abs(p.x - p.y), abs(p.x + p.y)) - r) / sqrt(2.0);
}

void main() {
    float d;

	/** Normalized point coord */
    vec2 p = vRotationMatrix * (2.0 * gl_PointCoord - 1.0) * vRadiusWithPadding;
	float r = vRadius;

    // We could also use textures here. Could even be faster, because we have plenty of branching here.
    if (vShape == CIRCLE) {
        d = circle(p, r);

    } else if (vShape == SQUARE) {
        d = square(p, r);

    } else if (vShape == TRIANGLE_UP) {
        d = equilateralTriangle(p, r, true, false);

    } else if (vShape == CROSS) {
        d = crossShape(p, r);

    } else if (vShape == DIAMOND) {
        d = diamond(p, r);

    } else if (vShape == TRIANGLE_DOWN) {
        d = equilateralTriangle(p, r, false, false);

    } else if (vShape == TRIANGLE_RIGHT) {
        d = equilateralTriangle(p, r, false, true);

    } else if (vShape == TRIANGLE_LEFT) {
        d = equilateralTriangle(p, r, true, true);

    } else {
        d = 0.0;
    }

	if (!uPickingEnabled) {
		lowp vec4 fillColor = mix(vFillColor, white, -d * uGradientStrength / vRadius);

		fragColor = distanceToColor(
			d + (uInwardStroke ? vHalfStrokeWidth : 0.0),
			fillColor,
			vStrokeColor,
			vHalfStrokeWidth);

	} else if (d - vHalfStrokeWidth <= 0.0) {
        fragColor = vPickingColor;

	} else {
		discard;
    }
}

`,$c=1,vf=2,l6=4,M1e={};class Hn{get behavior(){return 0}constructor(){this.children=[],this.parent=void 0,this.completed=!1}reset(){this.completed=!1;for(const e of this.children)e.reset()}initialize(){}_updatePropagator(){this._propagate=Function("children",vw(this.children.length).map(e=>`const child${e} = children[${e}];`).join(`
`)+`return function propagate(datum) {${vw(this.children.length).map(e=>`child${e}.handle(datum);`).join(`
`)}}`)(this.children)}setParent(e){this.parent=e}addChild(e){if(e.parent)throw new Error("Cannot add the child! It already has a parent.");return this.children.push(e),e.setParent(this),this._updatePropagator(),this}adopt(e){e.parent&&e.parent.removeChild(e),this.addChild(e)}adoptChildrenOf(e){for(const t of e.children)this.adopt(t)}insertAsParent(e){if(this.isRoot())throw new Error("Cannot insert a new parent for a root node!");e.parent=this.parent,this.parent.children[this.parent.children.indexOf(this)]=e,this.parent._updatePropagator(),this.parent=void 0,e.addChild(this)}removeChild(e){const t=this.children.indexOf(e);if(t>-1)this.children.splice(t,1),e.parent=void 0,this._updatePropagator();else throw new Error("Trying to remove an unknown child node!")}excise(){if(this.isRoot())throw new Error("Cannot excise root node!");if(this.isTerminal())this.parent.removeChild(this);else if(this.children.length==1){const e=this.children[0];e.setParent(this.parent),this.parent.children[this.parent.children.indexOf(this)]=e,this.parent._updatePropagator(),this.setParent(void 0),this.children.length=0}else throw new Error("Cannot excise a node that has multiple children!")}isRoot(){return!this.parent}isBranching(){return this.children.length>1}isTerminal(){return this.children.length==0}visit(e){e(this);for(const t of this.children)t.visit(e);e.afterChildren&&e.afterChildren(this)}subtreeToString(e=0){const t=this.children.map(i=>i.subtreeToString(e+1)).join("");return`${" ".repeat(e*2)}* ${this.constructor.name}${("identifier"in this&&this.identifier?": "+this.identifier:"")??""} 
${t}`}getGlobalObject(){return this.parent?this.parent.getGlobalObject():M1e}handle(e){this._propagate(e)}complete(){this.completed=!0;for(const e of this.children)e.complete()}beginBatch(e){for(const t of this.children)t.beginBatch(e)}_propagate(e){}}function oQ(n){return n.type=="file"}function F1e(n){return n.type=="facet"}class aQ extends Hn{constructor(e){super(),this.k=e.size||500,this.reset()}reset(){super.reset(),this.reservoir=[],this.W=void 0,this.ingester=this._initialIngester}_initialIngester(e){this.reservoir.push(e),this.reservoir.length==this.k&&(this.W=Math.exp(Math.log(Math.random())/this.k),this.i=this.k,this.next=this.i,this.ingester=this._finalIngester,this._setNextStop())}_finalIngester(e){++this.i==this.next&&(this.reservoir[Math.floor(Math.random()*this.k)]=e,this.W*=Math.exp(Math.log(Math.random())/this.k),this._setNextStop())}_setNextStop(){this.next+=Math.floor(Math.log(Math.random())/Math.log(1-this.W))+1}handle(e){this.ingester(e)}complete(){for(const e of this.reservoir)this._propagate(e);super.complete()}}function P1e(n,e,t){const i=new aQ({type:"sample",size:n});for(const s of e)i.handle(t(s));return i.complete(),i.reservoir}const O1e={};class B1e extends qC{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:.5,y:.5,color:"#4c78a8",filled:!0,opacity:1,size:100,semanticScore:0,shape:"circle",strokeWidth:2,fillGradientStrength:0,dx:0,dy:0,angle:0,sampleFacetPadding:.1,semanticZoomFraction:.02}))}getAttributes(){return["inwardStroke","uniqueId","facetIndex","x","y","size","semanticScore","shape","strokeWidth","gradientStrength","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"size","semanticScore","shape","strokeWidth","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getDefaultEncoding(){return{...super.getDefaultEncoding(),...O1e}}fixEncoding(e){return sQ(e,this.properties.filled),rQ(e,this.properties.filled),delete e.color,delete e.opacity,e}initializeData(){super.initializeData();const e=this.unitView.getAccessor("semanticScore");e&&(this.sampledSemanticScores=Float32Array.from(P1e(1e4,this.unitView.getCollector().getData(),e)),this.sampledSemanticScores.sort((t,i)=>t-i))}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(N1e,R1e)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;Io(this.programInfo,{uInwardStroke:e.inwardStroke,uGradientStrength:e.fillGradientStrength,uMaxRelativePointDiameter:1-2*e.sampleFacetPadding})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new g1e({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(t,this.properties.minBufferSize||0)});i.addBatches(e.facetBatches);const s=i.toArrays();this.rangeMap.migrateEntries(s.rangeMap),this.updateBufferInfo(s)}_getGeometricScaleFactor(){const e=Math.pow(2,this.properties.geometricZoomBound||0);return Math.pow(Math.min(1,this.unitView.getZoomLevel()/e),1/3)}_getMaxPointSize(){const e=this.encoders.size;return e.constant?e(null):e.scale.range().reduce((t,i)=>Math.max(t,i))}getSemanticThreshold(){if(this.sampledSemanticScores){const e=Math.max(0,1-this.properties.semanticZoomFraction*this.unitView.getZoomLevel());if(e<=0)return-1/0;if(e>=1)return 1/0;{const t=this.sampledSemanticScores;return hZ(t,e)}}else return-1}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>Io(this.programInfo,{uMaxPointSize:this._getMaxPointSize(),uScaleFactor:this._getGeometricScaleFactor(),uSemanticThreshold:this.getSemanticThreshold()})),t.push(()=>Nb(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>{s&&UC(t,this.vertexArrayInfo,t.POINTS,s,i)},e)}}const W1e=`// Line caps
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

/** Position along the rule */
in float pos;

/** Which side of the stroke: -0.5 or 0.5 */
in float side;

/** Minimum rule length in pixels */
uniform float uMinLength;

uniform mediump float uDashTextureSize;
uniform lowp int uStrokeCap;

out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

/** Distances from the line endings. Used for rendering the round caps and dashes */
out highp vec2 vPosInPixels;


void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;

    // Stroke width in pixels
    float size = getScaled_size();
    float opacity = getScaled_opacity() * uViewOpacity;

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (size < pixelSize) {
        opacity *= size / pixelSize;
        size = pixelSize;
    }

    vec2 a = applySampleFacet(vec2(getScaled_x(), getScaled_y()));
    vec2 b = applySampleFacet(vec2(getScaled_x2(), getScaled_y2()));

    vec2 tangent = b - a;

    float offset = 0.0;
    float relativeDiff = 0.0;
    if (uMinLength > 0.0 || uStrokeCap != BUTT) {
        float len = length(tangent * uViewportSize);

        // Elongate to reach the minimum length.
        // The length difference in pixels
        float diff = max(0.0, uMinLength - len);

        // Add line caps
        if (uStrokeCap != BUTT) {
            diff += size;
        }

        relativeDiff = diff / len;
        offset = relativeDiff * (pos - 0.5);
    }

    // Apply caps and minimum length by spreading the vertices along the tangent
    vec2 p = pos < 1.0
        ? a + tangent * (pos + offset)
        : b + tangent * offset;

    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = pixelSize;

    // Extrude
    vec2 normal = normalize(vec2(-tangent.y, tangent.x) / uViewportSize);
    p += normal * side * (size + aaPadding) / uViewportSize;

    gl_Position = unitToNdc(p);

    vColor = vec4(getScaled_color() * opacity, opacity);
    vSize = size;
    vNormalLengthInPixels = side * (size + aaPadding);

    // TODO: Here's a precision problem that breaks round caps when zoomed in enough
    vPosInPixels = vec2(pos, (1.0 - pos)) * (1.0 + relativeDiff) * length(tangent * uViewportSize) -
        vec2(uStrokeCap != BUTT ? size / 2.0 : 0.0);
    
    setupPicking();
}
`,V1e=`// Line ending
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

uniform sampler2D uDashTexture;
uniform float uDashTextureSize;
uniform float uStrokeDashOffset;
uniform lowp int uStrokeCap;

in vec4 vColor;
in float vSize;

/** Position on the rule along its length in pixels */
in vec2 vPosInPixels;
in float vNormalLengthInPixels;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distanceFromEnd = -min(vPosInPixels[0], vPosInPixels[1]);
    float distance; // from the rule centerline or end
    if (distanceFromEnd > 0.0 && uStrokeCap == ROUND) {
        // round cap
        distance = length(vec2(distanceFromEnd, vNormalLengthInPixels));
    } else {
        distance = abs(vNormalLengthInPixels);
    }

    // Use a signed distance field to implement edge antialiasing
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), -0.5, 0.5) + 0.5;

    if (uDashTextureSize > 0.0) {
        float pos = (vPosInPixels[0] + uStrokeDashOffset) * dpr;
        float floored = floor(pos);
        vec2 texelPositions = (floored + vec2(0.5, 1.5)) / dpr / uDashTextureSize;
      
        // Do antialiasing
        opacity *= mix(
            texture(uDashTexture, vec2(texelPositions[0], 0)).r,
            texture(uDashTexture, vec2(texelPositions[1], 0)).r,
            clamp((pos - floored), 0.0, 1.0));
    }

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`;class $1e extends qC{constructor(e){super(e),this.dashTextureSize=0,Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x2:void 0,y2:void 0,size:1,color:"black",opacity:1,minLength:0,strokeDash:null,strokeDashOffset:0,strokeCap:"butt"}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){if(!(e.x&&e.y&&e.x2&&e.y2))if(e.x&&e.x2&&!e.y)e.y={value:.5},e.y2=e.y;else if(e.y&&e.y2&&!e.x)e.x={value:.5},e.x2=e.x;else if(e.x&&!e.y)e.y={value:0},e.y2={value:1},e.x2=e.x;else if(e.y&&!e.x)e.x={value:0},e.x2={value:1},e.y2=e.y;else if(e.x&&e.y&&e.y2)e.x2=e.x;else if(e.y&&e.x&&e.x2)e.y2=e.y;else if(e.y&&e.x)if(!e.x2&&aa(e.y)&&e.y.type=="quantitative")e.x2=e.x,e.y2={datum:0};else if(!e.y2&&aa(e.x)&&e.x.type=="quantitative")e.y2=e.y,e.x2={datum:0};else throw new Error("A bug!");else throw new Error("Invalid x and y encodings for rule mark: "+JSON.stringify(e));return e}async initializeGraphics(){if(await super.initializeGraphics(),this.properties.strokeDash){const e=this.gl,t=z1e(this.properties.strokeDash);this.dashTexture=Ww(e,{mag:e.NEAREST,min:e.NEAREST,internalFormat:e.R8,format:e.RED,src:t,height:1}),this.dashTextureSize=t.length}this.createAndLinkShaders(W1e,V1e)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;Io(this.programInfo,{uMinLength:e.minLength,uDashTextureSize:this.dashTextureSize,uStrokeCap:["butt","square","round"].indexOf(e.strokeCap)})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new f1e({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(t,this.properties.minBufferSize||0)});i.addBatches(e.facetBatches);const s=i.toArrays();this.rangeMap.migrateEntries(s.rangeMap),this.updateBufferInfo(s)}prepareRender(e){const t=super.prepareRender(e);return this.dashTexture&&t.push(()=>Io(this.programInfo,{uDashTexture:this.dashTexture,uStrokeDashOffset:this.properties.strokeDashOffset})),t.push(()=>Nb(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>UC(t,this.vertexArrayInfo,t.TRIANGLE_STRIP,s,i),e)}}function z1e(n){if(n.length==0||n.length%2||n.findIndex(r=>Math.round(r)!=r||r<1||r>1e3)>=0)throw new Error("Invalid stroke dash pattern: "+JSON.stringify(n));const e=n.reduce((r,o)=>r+o),t=new Uint8Array(e);let i=!0,s=0;for(let r of n){for(;r;)t[s++]=i&&255||0,r--;i=!i}return t}const H1e=`uniform float uSagittaScaleFactor;

/** Make very small arcs visible */
uniform float uMinSagittaLength;

in vec2 strip;

out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;
    float opacity = getScaled_opacity() * uViewOpacity;

    vec2 a = vec2(getScaled_x(), getScaled_y()) * uViewportSize;
    vec2 b = vec2(getScaled_x2(), getScaled_y2()) * uViewportSize;
    
    vec2 chordVector = b - a;
    vec2 unitChordVector = normalize(chordVector);
    vec2 chordNormal = vec2(-unitChordVector.y, unitChordVector.x);

    float sagitta = max(
        length(chordVector) / 2.0 * uSagittaScaleFactor,
        uMinSagittaLength
    );

    bool compress = false;
    if (compress) {
        // Work in progres...
        float maxSagittaLen = length(chordNormal * uViewportSize);
        float maxChordLen = length(unitChordVector * uViewportSize);

        float threshold = maxSagittaLen * 0.5;
        if (sagitta > threshold) {
            float m = (maxSagittaLen - threshold) / (maxChordLen - threshold);
            sagitta = (sagitta - threshold) * m + threshold;
        }
    }

    vec2 controlOffset = chordNormal * sagitta / 0.75;

    vec2 p1 = a;
    vec2 p2 = a + controlOffset;
    vec2 p3 = b + controlOffset;
    vec2 p4 = b;

    // Make segments shorter near the endpoints to make the tightly bent attachment points smoother
    float t = smoothstep(0.0, 1.0, strip.x);

    // https://stackoverflow.com/a/31317254/1547896
    vec2 C1 = p4 - 3.0 * p3 + 3.0 * p2 - p1;
    vec2 C2 = 3.0 * p3 - 6.0 * p2 + 3.0 * p1;
    vec2 C3 = 3.0 * p2 - 3.0 * p1;
    vec2 C4 = p1;

    vec2 p;
    // Skip computation at endpoints to maintain precision
    if (t == 0.0) {
        p = p1;
    } else if (t == 1.0) {
        p = p4;
    } else {
        p = C1*t*t*t + C2*t*t + C3*t + C4;
    }

    vec2 tangent = normalize(3.0*C1*t*t + 2.0*C2*t + C3);
    vec2 normal = vec2(-tangent.y, tangent.x);

    //p = applySampleFacet(p);

#ifdef size2_DEFINED
    float mixedSize = mix(getScaled_size(), getScaled_size2(), t);
#else
    float mixedSize = getScaled_size();
#endif

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (mixedSize < pixelSize) {
        opacity *= mixedSize / pixelSize;
        mixedSize = pixelSize;
    }

    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float paddedSize = mixedSize + pixelSize;

    vNormalLengthInPixels = strip.y * paddedSize;
    
    // Extrude
    p += normal * vNormalLengthInPixels;

    gl_Position = pixelsToNdc(p);

#ifdef color2_DEFINED
    // Yuck, RGB interpolation in gamma space!
    // TODO: linear space: https://unlimited3d.wordpress.com/2020/01/08/srgb-color-space-in-opengl/
    vec3 color = mix(getScaled_color(), getScaled_color2(), t);
#else 
    vec3 color = getScaled_color();
#endif

    vColor = vec4(color * opacity, opacity);

    vSize = paddedSize;

    setupPicking();
}
`,U1e=`in lowp vec4 vColor;
in float vSize;
in float vNormalLengthInPixels;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distance = abs(vNormalLengthInPixels);
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), 0.0, 1.0);

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`;class j1e extends qC{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:0,x2:void 0,y:0,y2:void 0,size:1,color:"black",opacity:1,segments:101,sagittaScaleFactor:1,minSagittaLength:1.5}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","height","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){return e.x||(e.x2=e.x),e.y2||(e.y2=e.y),e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(H1e,U1e)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;Io(this.programInfo,{uSagittaScaleFactor:e.sagittaScaleFactor,uMinSagittaLength:e.minSagittaLength})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new p1e({encoders:this.encoders,attributes:this.getAttributes(),numItems:t});i.addBatches(e.facetBatches);const s=i.toArrays();s.arrays.strip={data:q1e(this.properties.segments),numComponents:2},this.rangeMap.migrateEntries(s.rangeMap),this.arrays=Object.fromEntries(Object.entries(s.arrays).map(([r,o])=>[r,{...o,data:void 0}])),this.updateBufferInfo(s)}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>{this.gl.bindVertexArray(this.vertexArrayInfo.vertexArrayObject);for(const r of Object.entries(this.bufferInfo.attribs)){const[o,a]=r;a.buffer&&a.numComponents&&a.divisor&&(a.offset=i*this.arrays[o].numComponents*4)}Nb(t,this.programInfo,this.bufferInfo),UC(t,this.bufferInfo,t.TRIANGLE_STRIP,(this.properties.segments+1)*2,0,s)},e)}}function q1e(n){let e=0;const t=[];for(;e<=n;e++)t.push(e/n,.5),t.push(e/n,-.5);return t}const G1e=`uniform float uSdfNumerator;

uniform vec2 uD; // dx & dy

in mediump vec2 vertexCoord;
in lowp vec2 textureCoord;

uniform vec4 uViewportEdgeFadeWidth;
uniform vec4 uViewportEdgeFadeDistance;
    
uniform bool uSqueeze;
uniform bool uLogoLetter;

// Width of the text (all letters)
in float width;

// x: -1, 0, 1 = left, center, right
// y: -1, 0, 1 = top, middle, bottom 
uniform ivec2 uAlign;

#ifdef x2_DEFINED
uniform float uPaddingX;
uniform bool uFlushX;
#endif

#ifdef y2_DEFINED
uniform float uPaddingY;
uniform bool uFlushY;
#endif

out vec2 vTexCoord;
out vec4 vColor;
out float vSlope;
out float vEdgeFadeOpacity;

struct RangeResult {
    float pos;
    float scale;
};

float minValue(vec4 v) {
    return min(min(v.x, v.y), min(v.z, v.w));
}

float maxValue(vec4 v) {
    return max(max(v.x, v.y), max(v.z, v.w));
}

/**
 * All measures are in [0, 1]
 */
RangeResult positionInsideRange(float a, float b, float width, float padding,
                                int align, bool flush) {
    float span = b - a;
    float paddedWidth = width + 2.0 * padding;

    // Is the text clearly outside the viewport
    if (a > 1.0 || b < 0.0) {
        return RangeResult(0.0, 0.0);
    }

    // How much extra space we have for adjusting the position so that the
    // text stays inside the range.
    float extra = max(0.0, span - paddedWidth);

    float pos;

    // Align the text and try to keep it inside the range and the viewport
    if (align == 0) {
        float centre = a + b;

        if (flush) {
            float leftOver = max(0.0, paddedWidth - centre);
            centre += min(leftOver, extra);

            float rightOver = max(0.0, paddedWidth + centre - 2.0);
            centre -= min(rightOver, extra);
        }

        pos = centre / 2.0;

    } else if (align < 0) {
        float edge = a;

        if (flush) {
            float over = max(0.0, -edge);
            edge += min(over, extra);
        }

        pos = edge + padding;

    } else {
        float edge = b;

        if (flush) {
            float over = max(0.0, edge - 1.0);
            edge -= min(over, extra);
        }

		// TODO: If the text spans the whole viewport, try to keep it centered if possible.

        pos = edge - padding;
    }

    // How the text should be scaled to make it fit inside the range (if it didn't fit).
    float scale = clamp((span - padding) / paddedWidth, 0.0, 1.0);

    // TODO: Fix padding in scale factor. Padding should stay constant
    return RangeResult(pos, scale);
}

vec2 calculateRotatedDimensions(float width, mat2 rotationMatrix) {
    vec2 a = abs(rotationMatrix * vec2(width / 2.0, 0.5));
    vec2 b = abs(rotationMatrix * vec2(width / 2.0, -0.5));
    return vec2(max(a.x, b.x), max(a.y, b.y)) * 2.0;
}

/** Needed when using ranged text */
ivec2 fixAlignForAngle(ivec2 align, float angleInDegrees) {
    float a = mod(angleInDegrees + 45.0, 360.0);
    int x = align.x;
    int y = -align.y;

    // TODO: Optimize by avoiding branching
    if (a < 90.0) {
        return ivec2(x, y);
    } else if (a < 180.0) {
        return ivec2(y, -x);
    } else if (a < 270.0) {
        return ivec2(-x, y);
    } else {
        return ivec2(-y, x);
    }
}

void main(void) {
    float opacity = getScaled_opacity() * uViewOpacity;
    vec2 size = vec2(getScaled_size());
    float x = getScaled_x();
    float y = getScaled_y();

    float scale = 1.0;

	float angleInDegrees = getScaled_angle();
	float angle = -angleInDegrees * PI / 180.0;
	
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    mat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);

    vec2 flushSize = calculateRotatedDimensions(width, rotationMatrix);

#if defined(x2_DEFINED) || defined(y2_DEFINED)
    ivec2 align = fixAlignForAngle(uAlign, angleInDegrees);
#else
    ivec2 align = uAlign;
#endif

#ifdef x2_DEFINED
    float x2 = getScaled_x2();

    if (uLogoLetter) {
        size.x = (x2 - x) * uViewportSize.x;
        x += (x2 - x) / 2.0;

    } else {
        float x2 = getScaled_x2();
        RangeResult result = positionInsideRange(
            min(x, x2), max(x, x2),
            size.x * scale * flushSize.x / uViewportSize.x, uPaddingX / uViewportSize.x,
            align.x, uFlushX);
        
        x = result.pos;
        scale *= result.scale;
    }
#endif

    // Position of the text origo 
    vec2 pos = applySampleFacet(vec2(x, y));

#ifdef y2_DEFINED
    float y2 = getScaled_y2();
    vec2 pos2 = applySampleFacet(vec2(x, y2));

    if (uLogoLetter) {
        size.y = (pos2.y - pos.y) * uViewportSize.y;
        pos.y += (pos2.y - pos.y) / 2.0;

    } else {
        RangeResult result = positionInsideRange(
            min(pos.y, pos2.y), max(pos.y, pos2.y),
            size.y * scale * flushSize.y / uViewportSize.y, uPaddingY / uViewportSize.y,
            align.y, uFlushY);
        
        pos.y = result.pos;
        scale *= result.scale;
    }
#endif

    if (scale < 1.0) {
        if (uSqueeze) {
            vec2 scaleFadeExtent = vec2(3.0, 6.0) / size;

            if (scale  < scaleFadeExtent[0]) {
                gl_Position = vec4(0.0);
                return;
            }

            size *= scale;
            opacity *= linearstep(scaleFadeExtent[0], scaleFadeExtent[1], scale);

        } else if (scale < 1.0) {
            // Eliminate the text
            gl_Position = vec4(0.0);
            return;
        }
    }

    // Position of the character vertex in relation to the text origo
    vec2 charPos = rotationMatrix * (vertexCoord * size + uD);

    // Position of the character vertex inside the unit viewport
    vec2 unitPos = pos + charPos / uViewportSize;

    gl_Position = unitToNdc(unitPos);

    // Controls antialiasing of the SDF
    vSlope = max(1.0, min(size.x, size.y) / uSdfNumerator);

    vColor = vec4(getScaled_color() * opacity, opacity);

    vTexCoord = textureCoord;

    // Edge fading. The implementation is simplistic and fails with primitives that
    // span the whole viewport. However, it works just fine with reasonable font sizes.
    // x: top, y: right, z: bottom, w: left
    if (maxValue(uViewportEdgeFadeDistance) > -pow(10.0, 10.0)) { // -Infinity would be nice
        vEdgeFadeOpacity = minValue(
            ((vec4(1.0, 1.0, 0.0, 0.0) + vec4(-1.0, -1.0, 1.0, 1.0) * unitPos.yxyx) *
                uViewportSize.yxyx - uViewportEdgeFadeDistance) / uViewportEdgeFadeWidth);
    } else {
        vEdgeFadeOpacity = 1.0;
    }

    setupPicking();
}
`,K1e=`uniform sampler2D uTexture;
uniform bool uLogoLetter;

in vec2 vTexCoord;
in float vEdgeFadeOpacity;
in vec4 vColor;
in float vSlope;

out lowp vec4 fragColor;

float median(float r, float g, float b) {
    return max(min(r, g), min(max(r, g), b));
}

void main() {
    // TODO: Really small text should fall back to normal (non-SDF) texture that can be mip-mapped.
    // Currently small text has severe aliasing artifacts.

    vec3 c = texture(uTexture, vTexCoord).rgb;

    float sigDist = 1.0 - median(c.r, c.g, c.b);

    // Using screen-space derivatives for logo letters because skewed aspect ratios
    // result in blurry edges otherwise. However, use of screen-space derivatives
    // results in crappy looking text with regular letters text.
    float slope = uLogoLetter
        ? 0.7 / length(vec2(dFdy(sigDist), dFdx(sigDist)))
        : vSlope;

    float opa = clamp((sigDist - 0.5) * slope + 0.5, 0.0, 1.0);

    // Raise to the power of 2.2 to do some cheap gamma correction
    opa *= pow(clamp(vEdgeFadeOpacity, 0.0, 1.0), 2.2);

    fragColor = vColor * opa;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,Z1e={left:-1,center:0,right:1},Y1e={top:-1,middle:0,bottom:1,alphabetic:1};class X1e extends qC{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:.5,y:.5,x2:void 0,y2:void 0,text:"",size:11,color:"black",opacity:1,font:void 0,fontStyle:void 0,fontWeight:void 0,align:"center",baseline:"middle",dx:0,dy:0,angle:0,fitToBand:!1,squeeze:!0,paddingX:0,paddingY:0,flushX:!0,flushY:!0,logoLetters:!1,viewportEdgeFadeWidthTop:0,viewportEdgeFadeWidthRight:0,viewportEdgeFadeWidthBottom:0,viewportEdgeFadeWidthLeft:0,viewportEdgeFadeDistanceTop:-1/0,viewportEdgeFadeDistanceRight:-1/0,viewportEdgeFadeDistanceBottom:-1/0,viewportEdgeFadeDistanceLeft:-1/0})),this.font=this.properties.font?e.context.fontManager.getFont(this.properties.font,this.properties.fontStyle,this.properties.fontWeight):e.context.fontManager.getDefaultFont()}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","color","size","opacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size","text","angle"]}fixEncoding(e){for(const t of Tb)this.properties.fitToBand&&ZM(e,t);return e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(G1e,K1e)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;Io(this.programInfo,{uPaddingX:e.paddingX,uPaddingY:e.paddingY,uFlushX:!!e.flushX,uFlushY:!!e.flushY,uAlign:[Z1e[e.align],Y1e[e.baseline]],uD:[e.dx,-e.dy],uLogoLetter:!!e.logoLetters,uSqueeze:!!e.squeeze,uViewportEdgeFadeWidth:[e.viewportEdgeFadeWidthTop,e.viewportEdgeFadeWidthRight,e.viewportEdgeFadeWidthBottom,e.viewportEdgeFadeWidthLeft],uViewportEdgeFadeDistance:[e.viewportEdgeFadeDistanceTop,e.viewportEdgeFadeDistanceRight,e.viewportEdgeFadeDistanceBottom,e.viewportEdgeFadeDistanceLeft]})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getData(),i=this.encoding,s=this.encoders.text.accessor||this.encoders.text;let r=0;const o="format"in i.text?js(i.text.format):c=>c;for(const c of t){const u=o(s(c)),h=wn(u)?u:u===null?"":""+u;r+=h&&h.length||0}const a=new m1e({encoders:this.encoders,attributes:this.getAttributes(),properties:this.properties,fontMetrics:this.font.metrics,numCharacters:Math.max(r,this.properties.minBufferSize||0)});a.addBatches(e.facetBatches);const l=a.toArrays();this.rangeMap.migrateEntries(l.rangeMap),this.updateBufferInfo(l)}prepareRender(e){const t=super.prepareRender(e);let i=.35;this.properties.logoLetters&&(i/=2);const s=this.font.metrics.common.base/(this.unitView.context.devicePixelRatio/i);return t.push(()=>Io(this.programInfo,{uTexture:this.font.texture,uSdfNumerator:s})),t.push(()=>Nb(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>UC(t,this.vertexArrayInfo,t.TRIANGLES,s,i),e)}}function HW(n,e,{spacing:t,devicePixelRatio:i,offset:s,reverse:r}={}){t=t||0,s=s||0;let o=0,a=0;for(const g of n)o+=ex(g.px)+(fI(g)?0:t),a+=ex(g.grow);o-=t;const l=Math.max(0,e-o),c=i!==void 0?g=>Math.round(g*i)/i:g=>g,u=[],h=[],d=g=>{const p=u.length;if(!p)return;const m=(g?t:0)*(r?-1:1);f-=m;for(let b=0;b<p;b++)h.push({location:f+(b+1)/(p+1)*m,size:0});f+=m,u.length=0};let f=r?Math.max(e,o):0+s;if(n.length==1&&fI(n[0]))return[{location:f,size:0}];for(let g=0;g<n.length;g++){const p=n[g];if(fI(p))u.push(p);else{d(h.length>0);const m=ex(p.px)+(a?ex(p.grow)/a*l:0);r&&(f-=m),h.push({location:c(f),size:c(m)}),r?f-=t:f+=m+t}}return f+=r?t:-t,d(!1),h}function Q1e(n){let e=0,t=0;for(const i of n)e=Math.max(e,i.px??0),t=Math.max(t,i.grow??0);return{px:e,grow:t}}var pC,YM;const k9=class k9{constructor(e,t){Kt(this,pC);this.width=e,this.height=t}addPadding(e){return Pt(this,pC,YM).call(this,e.width,e.height)}subtractPadding(e){return Pt(this,pC,YM).call(this,-e.width,-e.height)}};pC=new WeakSet,YM=function(e,t){return new k9({px:(this.width.px??0)+e,grow:this.width.grow},{px:(this.height.px??0)+t,grow:this.height.grow})};let fp=k9;const Iv=Object.freeze({px:0,grow:0}),J1e=new fp(Iv,Iv);function fI(n){return!n.px&&!n.grow}function ex(n){return n||0}function eve(n){return n&&(bo(n.px)||bo(n.grow))}function lQ(n){if(dQ(n))throw new Error("parseSizeDef does not accept step-based sizes.");if(eve(n))return n;if(bo(n))return{px:n,grow:0};if(n==="container")return{px:0,grow:1};if(!n)return{px:0,grow:1};throw new Error(`Invalid sizeDef: ${n}`)}class rr{constructor(e,t,i,s){this.top=e||0,this.right=t||0,this.bottom=i||0,this.left=s||0}get width(){return this.left+this.right}get height(){return this.top+this.bottom}expand(e){return e<=0?this:new rr(this.top+e,this.right+e,this.bottom+e,this.left+e)}add(e){return new rr(this.top+e.top,this.right+e.right,this.bottom+e.bottom,this.left+e.left)}subtract(e){return new rr(this.top-e.top,this.right-e.right,this.bottom-e.bottom,this.left-e.left)}union(e){return new rr(Math.max(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom),Math.max(this.left,e.left))}getHorizontal(){return new rr(0,this.right,0,this.left)}getVertical(){return new rr(this.top,0,this.bottom,0)}get horizontalTotal(){return this.left+this.right}get verticalTotal(){return this.top+this.bottom}static createFromConfig(e){return typeof e=="number"?this.createUniformPadding(e):e?this.createFromRecord(e):XM}static createFromRecord(e){return new rr(e.top,e.right,e.bottom,e.left)}static zero(){return XM}static createUniformPadding(e){return new rr(e,e,e,e)}}const XM=rr.createUniformPadding(0);Object.freeze(XM);const tve=/^([A-Za-z]+:)?\/\//;function ive(n,e){if(e&&tve.test(e))return e;const t=n();return t&&e?t.endsWith("/")?t+e:t+"/"+e:t??e}const cQ="VISIT_SKIP",Nv="VISIT_STOP",UW=n=>n;var m_,mC,_C,JD,hQ,bC,QM,iK;let uQ=(iK=class{constructor(e,t,i,s,r){Kt(this,JD);Kt(this,bC);Kt(this,m_,{});Kt(this,mC,{});Kt(this,_C,{});Rn(this,"opacityFunction",UW);if(!e)throw new Error("View spec must be defined!");this.context=t,this.layoutParent=i,this.dataParent=s,this.name=e.name||r,this.spec=e,this.resolutions={scale:{},axis:{}},tQ(this),this.blockEncodingInheritance=!1,this.contributesToScaleDomain=!0,this.needsAxes={x:!1,y:!1}}getPadding(){return this._cache("size/padding",()=>rr.createFromConfig(this.spec.padding))}getOverhang(){return rr.zero()}getSize(){return this._cache("size/size",()=>this.isConfiguredVisible()?Pt(this,JD,hQ).call(this):J1e)}isConfiguredVisible(){return this.context.isViewConfiguredVisible(this)}isVisibleInSpec(){return this.spec.visible??!0}isVisible(){return this.getLayoutAncestors().every(e=>e.isConfiguredVisible())}getEffectiveOpacity(){var e;return this.opacityFunction(((e=this.layoutParent)==null?void 0:e.getEffectiveOpacity())??1)}getPathString(){return this.getLayoutAncestors().map(e=>e.name).reverse().join("/")}getLayoutAncestors(){return Pt(this,bC,QM).call(this,"layoutParent")}getDataAncestors(){return Pt(this,bC,QM).call(this,"dataParent")}handleBroadcast(e){for(const t of nt(this,m_)[e.type]||[])t(e)}_addBroadcastHandler(e,t){let i=nt(this,m_)[e];i||(i=[],nt(this,m_)[e]=i),i.push(t)}handleInteractionEvent(e,t,i){const s=i?nt(this,mC):nt(this,_C);for(const r of s[t.type]||[])r(e,t)}addInteractionEventListener(e,t,i){const s=i?nt(this,mC):nt(this,_C);let r=s[e];r||(r=[],s[e]=r),r.push(t)}visit(e){try{const t=e(this);if(e.postOrder&&e.postOrder(this),t!==Nv)return t}catch(t){throw t.view=this,t}}getDescendants(){const e=[];return this.visit(t=>{e.push(t)}),e}onScalesResolved(){(!this.opacityFunction||this.opacityFunction===UW)&&(this.opacityFunction=sve(this))}onBeforeRender(){}render(e,t,i={}){}getEncoding(){const e=this.dataParent&&!this.blockEncodingInheritance?this.dataParent.getEncoding():{},t=this.spec.encoding||{},i={...e,...t};for(const[s,r]of Object.entries(i))r===null&&delete i[s];return i}getFacetAccessor(e){if(this.layoutParent)return this.layoutParent.getFacetAccessor(this)}getFacetFields(e){var i;const t=this.getEncoding().sample;return $C(t)?[t.field]:(i=this.layoutParent)==null?void 0:i.getFacetFields(this)}getSampleFacetTexture(){}getScaleResolution(e){const t=dp(e);return this.getDataAncestors().map(i=>i.resolutions.scale[t]).find(i=>i)}getAxisResolution(e){const t=dp(e);return this.getDataAncestors().map(i=>i.resolutions.axis[t]).find(i=>i)}getConfiguredResolution(e,t){var i,s;return(s=(i=this.spec.resolve)==null?void 0:i[t])==null?void 0:s[e]}getConfiguredOrDefaultResolution(e,t){return this.getConfiguredResolution(e,t)??this.getConfiguredResolution("default",t)??this.getDefaultResolution(e,t)}getDefaultResolution(e,t){return"independent"}getBaseUrl(){return ive(()=>{var e;return(e=this.dataParent)==null?void 0:e.getBaseUrl()},this.spec.baseUrl)}isPickingSupported(){return!0}getTitleText(){const e=this.spec.title;if(e)return wn(e)?e:e.text}_cache(e,t){return M_(this,e,t)}_invalidateCacheByPrefix(e,t="self"){switch(t){case"self":N2(this,e);break;case"ancestors":for(const i of this.getLayoutAncestors())N2(i,e);break;case"progeny":this.visit(i=>N2(i,e));break}}invalidateSizeCache(){this._invalidateCacheByPrefix("size/","ancestors")}propagateInteractionEvent(e){}},m_=new WeakMap,mC=new WeakMap,_C=new WeakMap,JD=new WeakSet,hQ=function(){const e=t=>{var s;let i=this.spec[t];if(dQ(i)){const r=i.step,o=(s=this.getScaleResolution(t=="width"?"x":"y"))==null?void 0:s.getScale();if(o){let a=0;if(Gd(o.type))a=o.domain().length;else if(["locus","index"].includes(o.type)){const c=o.domain();a=TC(c)-c[0]}else throw new Error(`Cannot use step-based size with "${o.type}" scale!`);const l=o;return a=P5(a,l.paddingInner(),l.paddingOuter()),{px:a*r,grow:0}}else throw new Error("Cannot use 'step' size with missing scale!")}else return(i&&lQ(i))??{px:0,grow:1}};return this._cache("size/sizeFromSpec",()=>new fp(e("width"),e("height")))},bC=new WeakSet,QM=function(e){const t=[];let i=this;do t.push(i),i=i[e];while(i);return t},iK);function nve(n){return"unitsPerPixel"in n}function sve(n){const e=n.spec.opacity;if(e!==void 0){if(bo(e))return t=>t*e;if(nve(e)){const t=r=>{var a;const o=(a=n.getScaleResolution(r))==null?void 0:a.getScale();if(["linear","index","locus"].includes(o==null?void 0:o.type))return o},i=e.channel?t(e.channel):t("x")||t("y");if(!i)throw new Error("Cannot find a resolved quantitative scale for dynamic opacity!");const s=E5().domain(e.unitsPerPixel).range(e.values).clamp(!0);return r=>{const a=Mk(i.domain())/1e3;return s(a)*r}}}return t=>t}const dQ=n=>!!(n!=null&&n.step);class F_ extends uQ{constructor(e,t,i,s,r){super(e,t,i,s,r),this.spec=e}*[Symbol.iterator](){}replaceChild(e,t){throw new Error("Not implemented")}visit(e){let t;try{t=e(this)}catch(i){throw i.view=this,i}if(t===Nv)return t;if(t!==cQ){e.beforeChildren&&e.beforeChildren(this);for(const i of this){const s=i.visit(e);if(s===Nv)return s}e.afterChildren&&e.afterChildren(this),e.postOrder&&e.postOrder(this)}}findDescendantByPath(e){for(const t of this)if(t.name===e[0]){if(e.length==1)return t;if(t instanceof F_)return t.findDescendantByPath(e.slice(1))}}findChildByName(e){for(const t of this)if(t.name===e)return t}findDescendantByName(e){let t;return this.visit(i=>{if(i.name==e)return t=i,Nv}),t}getDefaultResolution(e,t){return"shared"}}const jW=1;function c6(){let n=[0,1],e=[0,1],t=1,i=1,s=0,r=0,o=.5,a=0;const c=u=>(u+o-n[0])/t*i+e[0];return c.invert=u=>(u-e[0])/i*t+n[0]-o,c.domain=function(u){if(arguments.length){n=lhe(u),t=n[1]-n[0];const h=n[0]===0&&n[0]===0;if(t<jW&&!h){t=jW;const d=(n[0]+n[1])/2;n[0]=d-t/2,n[1]=d+t/2}return c}else return n.slice()},c.range=function(u){return arguments.length?(e=[...u],i=e[1]-e[0],c):e},c.numberingOffset=function(u){return arguments.length?(a=u,c):a},c.padding=function(u){return arguments.length?(r=u,s=Math.min(1,u),c):s},c.paddingInner=function(u){return arguments.length?(s=Math.min(1,u),c):s},c.paddingOuter=function(u){return arguments.length?(r=u,c):r},c.align=function(u){return arguments.length?(o=Math.max(0,Math.min(1,u)),c):o},c.step=()=>i/t,c.bandwidth=()=>c.step(),c.ticks=u=>{const h=c.align(),d=c.numberingOffset();return Pk(n[0]-h+d,n[1]-h+d,Math.min(u,Math.ceil(t))).filter(Number.isInteger).map(f=>f-a)},c.tickFormat=(u,h)=>{if(h)throw new Error("Index scale's tickFormat does not support a specifier!");const f=op(n[0],n[1],Math.min(u,Math.ceil(t)))<1e5?js(","):js(".3s");return g=>f(g+a)},c.copy=()=>c6().domain(n).range(e).paddingInner(s).paddingOuter(r).numberingOffset(a),c}function rve(){const n=c6().numberingOffset(1);let e;n.genome=function(i){return arguments.length?(e=i,n):e},n.ticks=i=>{if(!e)return[];const s=n.domain(),r=n.numberingOffset(),[o,a]=[Math.max(s[0],0),Math.min(s[1],e.totalSize-1)].map(u=>e.toChromosome(u)),l=Math.max(1,op(s[0],s[1],i)),c=[];for(let u=o.index;u<=a.index;u++){const h=e.chromosomes[u],d=Math.max(h.continuousStart+l,s[0]-(s[0]-h.continuousStart)%l),f=Math.min(h.continuousEnd-l/4,s[1]+1);for(let g=d;g<=f;g+=l){const p=g-r;p>=s[0]&&p<s[1]&&c.push(p)}}return c},n.tickFormat=(i,s)=>{if(!e)return;if(s)throw new Error("Locus scale's tickFormat does not support a specifier!");const r=n.domain(),o=r[1]-r[0],a=n.numberingOffset(),c=op(r[0],r[1],Math.min(i,Math.ceil(o)))<1e6?js(","):js(".3s"),u=h=>h-e.toChromosome(h).continuousStart;return h=>c(u(h)+a)};const t=n.copy;return n.copy=()=>t().genome(e),n}function ove(n){return n.type=="locus"}function iL(n,e,t){if(t=t||[],n.some(o=>o===null)){if(n.every(o=>o===null))return null;throw console.warn(n),new Error("Cannot merge objects with nulls!")}const i={},s=(o,a)=>o===a||Dm(o)&&Dm(a)||Dm(o)&&a===!0||o===!0&&Ll(a),r=o=>{for(let a in o){const l=o[a];if(!t.includes(a)&&l!==void 0)if(i[a]!==void 0&&!s(i[a],l))console.warn(`Conflicting property ${a} of ${e}: (${JSON.stringify(i[a])} and ${JSON.stringify(o[a])}). Using ${JSON.stringify(i[a])}.`);else{const c=i[a];if(Dm(c))Dm(l)&&(i[a]=iL([c,l],a));else if(Dm(l)){if(!(c===!0||c===void 0))throw new Error("Bug in merge! Target is: "+c);i[a]=iL([{},l],a)}else i[a]=l}}};for(const o of n)r(o);return i}function Dm(n){return Ll(n)&&!Array.isArray(n)}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/ticks.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */function fQ(n,e,t){return bo(e)&&t!=null&&(e=Math.min(e,~~(Mk(n.domain())/t)||1)),Ll(e)&&(e.step,e=e.interval),e}function gQ(n,e,t){var i=n.range(),s=Math.floor(i[0]),r=Math.ceil(_l(i));if(s>r&&(i=r,r=s,s=i),e=e.filter(function(a){return a=n(a),s<=a&&a<=r}),t>0&&e.length>1){for(var o=[e[0],_l(e)];e.length>t&&e.length>=3;)e=e.filter(function(a,l){return!(l%2)});e.length<3&&(e=o)}return e}function ave(n,e){return n.bins?gQ(n,lve(n.bins,e)):n.ticks?n.ticks(e):n.domain()}function lve(n,e){var t=n.length,i=~~(t/(e||t));return i<2?n.slice():n.filter(function(s,r){return!(r%i)})}function cve(n,e,t){var i=n.tickFormat?n.tickFormat(e,t):t?js(t):String;if(zY(n.type)){var s=hve(t);i=n.bins?s:uve(i,s)}return i}function uve(n,e){return function(t){return n(t)?e(t):""}}function hve(n){var e=zd(n||",");if(e.precision==null){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1;break}return dve(js(e),js(".1f")(1)[1])}else return js(e)}function dve(n,e){return function(t){var i=n(t),s=i.indexOf(e),r,o;if(s<0)return i;for(r=fve(i,s),o=r<i.length?i.slice(r):"";--r>s;)if(i[r]!=="0"){++r;break}return i.slice(0,r)+o}}function fve(n,e){var t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/Scale.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */const gve="locus",pve="index";var mve=5;function _ve(n){const e=n.type;return!n.bins&&(e===I_||e===PC||e===OC)}function pQ(n){return lr(n)&&![Sc,pve,gve].includes(n)}function mQ(n){return n||{warn:(e,...t)=>console.warn(e,...t)}}var bve=Fk(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma","zoom","fp64","name"]);function _Q(n,e,t){t=mQ(t);for(const i in n)if(!bve[i]){if(i==="padding"&&pQ(e.type))continue;go(e[i])?e[i](n[i]):t.warn("Unsupported scale property: "+i)}Lve(e,n,kve(e,n,Cve(e,n,t)))}function vve(n,e){const t=wve(n),i=Si(t);if(!i)throw new Error("Unknown scale type: "+t);const s=i();return!n.domain&&lr(s.type)&&(n.domain=[0,0]),_Q(n,s,e),s}function wve(n){var e=n.type,t="",i;return e===Sc?Sc+"-"+I_:(yve(n)&&(i=n.rawDomain?n.rawDomain.length:n.domain?n.domain.length+ +(n.domainMid!=null):0,t=i===2?Sc+"-":i===3?Eb+"-":""),(t+e||I_).toLowerCase())}function yve(n){const e=n.type;return lr(e)&&e!==MY&&e!==FY&&(n.scheme||n.range&&n.range.length&&n.range.every(wn))}function Cve(n,e,t){if(!n.domain)return 0;t=mQ(t);var i=Sve(n,e.domainRaw,t);if(i>-1)return i;var s=e.domain,r=n.type,o=e.zero||e.zero===void 0&&_ve(n),a,l;return s?(pQ(r)&&e.padding&&s[0]!==_l(s)&&(s=xve(r,s,e.range,e.padding,e.exponent,e.constant)),(o||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null)&&(a=(s=s.slice()).length-1||1,o&&(s[0]>0&&(s[0]=0),s[a]<0&&(s[a]=0)),e.domainMin!=null&&(s[0]=e.domainMin),e.domainMax!=null&&(s[a]=e.domainMax),e.domainMid!=null&&(l=e.domainMid,(l<s[0]||l>s[a])&&t.warn("Scale domainMid exceeds domain min or max.",l),s.splice(a,0,l))),n.domain(bQ(r,s,t)),r===O5&&n.unknown(e.domainImplicit?xM:void 0),e.nice&&n.nice&&n.nice(e.nice!==!0&&fQ(n,e.nice)||null),s.length):0}function Sve(n,e,t){return e?(n.domain(bQ(n.type,e,t)),e.length):-1}function xve(n,e,t,i,s,r){var o=Math.abs(_l(t)-t[0]),a=o/(o-2*i),l=n===qd?tZ(e,null,a):n===OC?gM(e,null,a,.5):n===PC?gM(e,null,a,s||1):n===ME?Nue(e,null,a,r||1):eZ(e,null,a);return e=e.slice(),e[0]=l[0],e[e.length-1]=l[1],e}function bQ(n,e,t){if(zY(n)){var i=Math.abs(e.reduce(function(s,r){return s+(r<0?-1:r>0?1:0)},0));i!==e.length&&t.warn("Log scale domain includes zero: "+_E(e))}return e}function kve(n,e,t){let i=e.bins;if(i&&!jo(i)){const s=(i.start==null||i.stop==null)&&n.domain(),r=i.start==null?s[0]:i.start,o=i.stop==null?_l(s):i.stop,a=i.step;a||bn("Scale bins parameter missing step property."),i=vw(r,o+a,a)}return i?n.bins=i:n.bins&&delete n.bins,n.type===B5&&(i?!e.domain&&!e.domainRaw&&(n.domain(i),t=i.length):n.bins=n.domain()),t}function Lve(n,e,t){var i=n.type,s=e.round||!1,r=e.range;if(e.rangeStep!=null)r=Dve(i,e,t);else if(e.scheme&&(r=Eve(i,e,t),go(r))){if(n.interpolator)return n.interpolator(r);bn(`Scale type ${i} does not support interpolating color schemes.`)}if(r&&FE(i))return n.interpolator(PE(JM(r,e.reverse),e.interpolate,e.interpolateGamma));r&&e.interpolate&&n.interpolate?n.interpolate(HY(e.interpolate,e.interpolateGamma)):go(n.round)?n.round(s):go(n.rangeRound)&&n.interpolate(s?MC:gf),r&&n.range(JM(r,e.reverse))}function Dve(n,e,t){n!==BY&&n!==FM&&bn("Only band and point scales support rangeStep.");var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,s=n===FM?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*P5(t,s,i)]}function Eve(n,e,t){var i=e.schemeExtent,s,r;return jo(e.scheme)?r=PE(e.scheme,e.interpolate,e.interpolateGamma):(s=e.scheme.toLowerCase(),r=V5(s),r||bn(`Unrecognized scheme name: ${e.scheme}`)),t=n===OY?t+1:n===B5?t-1:n===MM||n===PY?+e.schemeCount||mve:t,FE(n)?qW(r,i,e.reverse):go(r)?Xpe(qW(r,i),t):n===O5?r:r.slice(0,t)}function qW(n,e,t){return go(n)&&(e||t)?Ype(n,JM(e||[0,1],t)):n}function JM(n,e){return e?n.slice().reverse():n}const GW=js(",d");function Tve(n,e){return n.chrom+":"+GW(Math.floor(n.pos+1))+"-"+(n.chrom!=e.chrom?e.chrom+":":"")+GW(Math.ceil(e.pos))}const Ave="https://genomespy.app/data/genomes/";class Ive{constructor(e){if(this.config=e,!this.config.contigs&&typeof this.config.name!="string")throw new Error("No name has been defined for the genome assembly!");this.chromosomes=[],this.cumulativeChromPositions=new Map,this.chromosomesByName=new Map,this.startByIndex=[],this.totalSize=0,this.config.contigs&&this.setChromSizes(this.config.contigs)}get name(){return this.config.name}async load(e){if(!this.config.contigs){this.config.baseUrl?this.baseUrl=/^http(s)?/.test(this.config.baseUrl)?this.config.baseUrl:e+"/"+this.config.baseUrl:this.baseUrl=Ave;try{this.setChromSizes(Nve(await CE({baseURL:this.baseUrl}).load(`${this.config.name}/${this.name}.chrom.sizes`)))}catch(t){throw new Error(`Could not load chrom sizes: ${t.message}`)}}}hasChrPrefix(){return this.chromosomes.some(e=>e.name.startsWith("chr"))}setChromSizes(e){let t=0;this.startByIndex=[0];for(let i=0;i<e.length;i++){this.startByIndex.push(t);const s=e[i].size,r={...e[i],continuousStart:t,continuousEnd:t+s,continuousInterval:[t,t+s],index:i,number:i+1,odd:!(i&1)};this.chromosomes.push(r);const o=r.name.replace(/^chr/i,"");for(const a of["chr"+o,"CHR"+o,"Chr"+o,r.number,""+r.number,o,r.name])this.cumulativeChromPositions.set(a,t),this.chromosomesByName.set(a,r);t+=r.size}this.totalSize=t}getExtent(){return[0,this.totalSize]}toContinuous(e,t){let i=this.cumulativeChromPositions.get(e);if(i===void 0)throw new Error("Unknown chromosome/contig: "+e);return i+ +t}toChromosome(e){if(e>this.totalSize)return;e=Math.floor(e);const t=Lb(this.startByIndex,e)-1;if(t>0&&t<=this.chromosomes.length)return this.chromosomes[t-1]}toChromosomal(e){const t=this.toChromosome(e);if(t)return{chrom:t.name,pos:Math.floor(e)-t.continuousStart}}getChromosome(e){return this.chromosomesByName.get(e)}formatInterval(e){return Tve(...this.toChromosomalInterval(e))}toChromosomalInterval(e){const t=this.toChromosomal(e[0]+.5),i=this.toChromosomal(e[1]-.5);return i.pos+=1,[t,i]}toContinuousInterval(e){var s;let[t,i]=e;return i||(i=t),[this.toContinuous(t.chrom,t.pos??0),this.toContinuous(i.chrom,i.pos??((s=this.chromosomesByName.get(i.chrom))==null?void 0:s.size))]}toDiscreteChromosomeIntervals(e){const t=e[0],i=e[1],s=[];if(t.chrom===i.chrom)s.push({chrom:t.chrom,startPos:t.pos,endPos:i.pos});else{const r=this.chromosomes.findIndex(a=>a.name===t.chrom),o=this.chromosomes.findIndex(a=>a.name===i.chrom);s.push({chrom:t.chrom,startPos:t.pos,endPos:this.chromosomes[r].size});for(let a=r+1;a<o;a++)s.push({chrom:this.chromosomes[a].name,startPos:0,endPos:this.chromosomes[a].size});s.push({chrom:i.chrom,startPos:0,endPos:i.pos})}return s}continuousToDiscreteChromosomeIntervals(e){return this.toDiscreteChromosomeIntervals([this.toChromosomal(e[0]),this.toChromosomal(e[1])])}parseInterval(e){const t=e.match(/^(chr[0-9A-Z]+)(?::([0-9,]+)(?:-(?:(chr[0-9A-Z]+):)?([0-9,]+))?)?$/);if(t){const i=t[1];if(t.slice(2).every(a=>a===void 0)){const a=this.getChromosome(i);return a?[a.continuousStart,a.continuousEnd]:void 0}const s=t[3]||i,r=parseInt(t[2].replace(/,/g,"")),o=t[4]!==void 0?parseInt(t[4].replace(/,/g,"")):r;return[this.toContinuous(i,r-1),this.toContinuous(s,o)]}}}function Nve(n){return Xue(n).filter(e=>/^chr[0-9A-Z]+$/.test(e[0])).map(([e,t])=>({name:e,size:parseInt(t)}))}function vQ(n){return Ll(n)&&"chrom"in n}function Rve(n){return n.every(vQ)}class GC extends Array{constructor(){super(),this.type=void 0}extend(e){return this}extendAll(e){if(e instanceof GC&&e.type!=this.type)throw new Error(`Cannot combine different types of domains: ${this.type} and ${e.type}`);for(const t of e)this.extend(t);return this}extendAllWithAccessor(e,t){for(const i of e)this.extend(t(i));return this}}class gI extends GC{constructor(){super(),this.type="quantitative"}extend(e){return e==null||Number.isNaN(e)?this:(e=+e,this.length?e<this[0]?this[0]=e:e>this[1]&&(this[1]=e):(this.push(e),this.push(e)),this)}}class wQ extends GC{constructor(){super(),this.type="ordinal",this.uniqueValues=new Set}extend(e){return e==null||Number.isNaN(e)?this:(this.uniqueValues.has(e)||(this.uniqueValues.add(e),this.push(e)),this)}}class yQ extends wQ{constructor(){super(),this.type="nominal"}}class Mve extends GC{constructor(e){super();let t=0;for(let i=1;i<e.length;i++)t+=Math.sign(e[i]-e[i-1]);if(Math.abs(t)!=e.length-1)throw new Error("Piecewise domain must be strictly increasing or decreasing: "+JSON.stringify(e));e.forEach(i=>this.push(i))}extend(e){if(this.includes(e))return this;throw new Error("Piecewise domains are immutable and cannot be unioned!")}}const KW={quantitative:gI,index:gI,locus:gI,nominal:yQ,ordinal:wQ};function ZW(n,e){if(n=="quantitative"&&Fve(e)){const t=new Mve(e);return t.type=n,t}else if(KW[n]){const t=new KW[n];return t.type=n,e&&t.extendAll(e),t}throw new Error("Unknown type: "+n)}function Fve(n){return n&&n.length>0&&n.length!=2&&n.every(e=>typeof e=="number")}function Pve(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}function Ove(n,e,t){return n*Math.pow(e/n,t)}Si("index",c6,["continuous"]);Si("locus",rve,["continuous"]);Si("null",OE,[]);const YW="quantitative",CQ="ordinal",SQ="nominal",xQ="locus",Bve="index";var Cu,__,Ms,Xl,Dh,eE,kQ,b_,R2,Su,jf,vC,e4,tE,LQ,OO,Vve,wC,t4;class Wve{constructor(e){Kt(this,Xl);Kt(this,eE);Kt(this,b_);Kt(this,Su);Kt(this,vC);Kt(this,tE);Kt(this,OO);Kt(this,wC);Kt(this,Cu,void 0);Kt(this,__,new Set);Kt(this,Ms,void 0);this.channel=e,this.members=[],this.type=null,this.name=void 0}addEventListener(e,t){if(e!="domain")throw new Error("Unsupported event type: "+e);nt(this,__).add(t)}removeEventListener(e,t){if(e!="domain")throw new Error("Unsupported event type: "+e);nt(this,__).delete(t)}pushUnitView(e,t){var o;const i=PM(e,t),s=i.type,r=(o=i==null?void 0:i.scale)==null?void 0:o.name;if(r){if(this.name!==void 0&&r!=this.name)throw new Error(`Shared scales have conflicting names: "${r}" vs. "${this.name}"!`);this.name=r}if(!this.type)this.type=s;else if(s!==this.type&&!Av(t))throw new Error(`Can not use shared scale for different data types: ${this.type} vs. ${s}. Use "resolve: independent" for channel ${this.channel}`);this.members.push({view:e,channel:t})}isExplicitDomain(){return!!this.getConfiguredDomain()}isDomainInitialized(){const e=nt(this,Ms);if(!e)return!1;const t=e.domain();return lr(e.type)?t.length>2||t.length==2&&(t[0]!==0||t[1]!==0):t.length>0}getScaleProps(){return M_(this,"scaleProps",()=>{const e=Pt(this,eE,kQ).call(this);if(e===null||e.type=="null")return{type:"null"};const t={...Pt(this,tE,LQ).call(this,this.type),...e};t.type||(t.type=$ve(this.channel,this.type));const i=Pt(this,b_,R2).call(this);return i&&i.length>0?t.domain=i:Gd(t.type)&&(t.domain=new yQ),!t.domain&&t.domainMid!==void 0&&(t.domain=[t.domainMin??0,t.domainMax??1]),this.channel=="y"&&Gd(t.type)&&t.reverse==null&&(t.reverse=!0),t.range&&t.scheme&&delete t.scheme,!("zoom"in t)&&["index","locus"].includes(t.type)&&(t.zoom=!0),zve(t,this.channel),t})}getConfiguredDomain(){return Pt(this,wC,t4).call(this,e=>Av(e.channel)?void 0:e.view.getConfiguredDomain(e.channel))}getDataDomain(){return Pt(this,wC,t4).call(this,e=>Av(e.channel)?void 0:e.view.extractDataDomain(e.channel))}reconfigure(){if(nt(this,Ms)&&nt(this,Ms).type!="null"){const e=this.isDomainInitialized(),t=nt(this,Ms).domain();eQ(this,"scaleProps");const i=this.getScaleProps();if(_Q(i,nt(this,Ms)),lr(nt(this,Ms).type)&&Qo(this,Cu,Pt(this,vC,e4).call(this)),!e){Pt(this,Xl,Dh).call(this);return}const s=nt(this,Ms).domain();Uk(s,t)||(this.isZoomable()?nt(this,Ms).domain(t):Pt(this,Su,jf).call(this)?(nt(this,Ms).domain(t),this.zoomTo(s,500)):Pt(this,Xl,Dh).call(this))}}getScale(){if(nt(this,Ms))return nt(this,Ms);const e=this.getScaleProps(),t=vve(e);return Qo(this,Ms,t),ove(t)&&t.genome(this.getGenome()),lr(t.type)&&Qo(this,Cu,Pt(this,vC,e4).call(this)),t}getDomain(){return this.getScale().domain()}getComplexDomain(){var e;return((e=this.getGenome())==null?void 0:e.toChromosomalInterval(this.getDomain()))??this.getDomain()}isZoomed(){return Pt(this,Su,jf).call(this)&&Uk(Pt(this,b_,R2).call(this),this.getDomain())}isZoomable(){return Pt(this,Su,jf).call(this)&&!!this.getScaleProps().zoom}zoom(e,t,i){if(!Pt(this,Su,jf).call(this))return!1;const s=this.getScale(),r=s.domain();let o=[...r],a=s.invert(t);switch(this.getScaleProps().reverse&&(i=-i),"align"in s&&(a+=s.align()),s.type){case"linear":case"index":case"locus":o=Tue(o,i||0),o=eZ(o,a,e);break;case"log":o=Aue(o,i||0),o=tZ(o,a,e);break;case"pow":case"sqrt":{const l=s;o=Iue(o,i||0,l.exponent()),o=gM(o,a,e,l.exponent());break}default:throw new Error("Zooming is not implemented for: "+s.type)}return nt(this,Cu)&&(o=Rue(o,nt(this,Cu)[0],nt(this,Cu)[1])),[0,1].some(l=>o[l]!=r[l])?(s.domain(o),Pt(this,Xl,Dh).call(this),!0):!1}async zoomTo(e,t=!1){var a;if(mE(t)&&(t=t?700:0),!Pt(this,Su,jf).call(this))throw new Error("Not a zoomable scale!");const i=this.fromComplexInterval(e),s=(a=this.members[0])==null?void 0:a.view.context.animator,r=this.getScale(),o=r.domain();if(t>0&&o.length==2){const l=o[1]-o[0],c=o[0]+l/2,u=i[1]-i[0],h=i[0]+u/2;await s.transition({duration:t,easingFunction:Pve,onUpdate:d=>{const f=Ove(l,u,d),g=(l-f)/(l-u),p=g*h+(1-g)*c;r.domain([p-f/2,p+f/2]),Pt(this,Xl,Dh).call(this)}}),r.domain(i),Pt(this,Xl,Dh).call(this)}else r.domain(i),s==null||s.requestRender(),Pt(this,Xl,Dh).call(this)}resetZoom(){if(!Pt(this,Su,jf).call(this))throw new Error("Not a zoomable scale!");const e=this.getDomain(),t=Pt(this,b_,R2).call(this);return[0,1].some(i=>t[i]!=e[i])?(nt(this,Ms).domain(t),Pt(this,Xl,Dh).call(this),!0):!1}getZoomLevel(){return this.isZoomable()?Mk(nt(this,Cu))/Mk(this.getScale().domain()):1}getGenome(){var t;if(this.type!=="locus")return;const e=(t=this.members[0].view.context.genomeStore)==null?void 0:t.getGenome();if(!e)throw new Error("No genome has been defined!");return e}invertToComplex(e){const t=this.getScale();if("invert"in t){const i=t.invert(e);return this.toComplex(i)}else throw new Error("The scale does not support inverting!")}toComplex(e){const t=this.getGenome();return t?t.toChromosomal(e):e}fromComplex(e){return vQ(e)?this.getGenome().toContinuous(e.chrom,e.pos):e}fromComplexInterval(e){return this.type==="locus"&&Rve(e)?this.getGenome().toContinuousInterval(e):e}}Cu=new WeakMap,__=new WeakMap,Ms=new WeakMap,Xl=new WeakSet,Dh=function(){for(const e of nt(this,__).values())e({type:"domain",scaleResolution:this})},eE=new WeakSet,kQ=function(){return M_(this,"mergedScaleProps",()=>{const e=this.members.map(t=>PM(t.view,t.channel).scale).filter(t=>t!==void 0);return iL(e,"scale",["domain"])})},b_=new WeakSet,R2=function(){return this.getConfiguredDomain()??(this.type==xQ?this.getGenome().getExtent():this.getDataDomain())},Su=new WeakSet,jf=function(){const e=this.getScale().type;return lr(e)},vC=new WeakSet,e4=function(){const e=this.getScaleProps(),t=e.zoom;if(Hve(t)&&jo(t.extent))return this.fromComplexInterval(t.extent);if(t)return e.type=="locus"?this.getGenome().getExtent():nt(this,Ms).domain()},tE=new WeakSet,LQ=function(e){const t=this.channel,i={};return this.isExplicitDomain()&&(i.zero=!1),Pw(t)?i.nice=!this.isExplicitDomain():Vg(t)?i.scheme=e==SQ?"tableau10":e==CQ?"blues":"viridis":BE(t)?i.range=ZY(t):t=="size"?i.range=[0,400]:t=="angle"&&(i.range=[0,360]),i},OO=new WeakSet,Vve=function(){return this.members.map(e=>e.view.getPathString()).join(", ")},wC=new WeakSet,t4=function(e){const t=this.members.filter(i=>!i.view.getLayoutAncestors().some(s=>!s.contributesToScaleDomain)).map(e).filter(i=>!!i);if(t.length)return t.reduce((i,s)=>i.extendAll(s))};function $ve(n,e){if(e==Bve||e==xQ){if(GY(n))return e;throw new Error(`${n} does not support ${e} data type. Only positional channels do.`)}const t={x:["band","band","linear"],y:["band","band","linear"],size:[void 0,"point","linear"],opacity:[void 0,"point","linear"],fillOpacity:[void 0,"point","linear"],strokeOpacity:[void 0,"point","linear"],color:["ordinal","ordinal","linear"],fill:["ordinal","ordinal","linear"],stroke:["ordinal","ordinal","linear"],strokeWidth:[void 0,void 0,"linear"],shape:["ordinal","ordinal",void 0],dx:[void 0,void 0,"null"],dy:[void 0,void 0,"null"],angle:[void 0,void 0,"linear"]},s=["sample"].includes(n)?"null":t[n]?t[n][[SQ,CQ,YW].indexOf(e)]:e==YW?"linear":"ordinal";if(s===void 0)throw new Error(`Channel "${n}" is not compatible with "${e}" data type. Use of a proper scale may be needed.`);return s}function zve(n,e){Pw(e)&&n.type!=="ordinal"&&(n.range=[0,1]),e=="opacity"&&lr(n.type)&&(n.clamp=!0)}function Hve(n){return Ll(n)}function i4(n){const e=new Set;function t(i){for(const s of Object.values(i.resolutions.scale))e.add(s)}for(const i of po(n)){i.visit(t);for(const s of i.getDataAncestors()){if(!s.contributesToScaleDomain)break;t(s)}}e.forEach(i=>i.reconfigure())}function pI(...n){for(const e of n)if(e!==void 0)return e}class Uve{constructor(e){this.channel=e,this.members=[]}get scaleResolution(){var e;return(e=TC(this.members))==null?void 0:e.view.getScaleResolution(this.channel)}pushUnitView(e,t){const i=e.getScaleResolution(this.channel);if(!i)throw new Error("Cannot find a scale resolution!");if(this.scaleResolution&&i!==this.scaleResolution)throw new Error("Shared axes must have a shared scale!");this.members.push({view:e,channel:t})}getAxisProps(){return M_(this,"axisProps",()=>{const e=this.members.map(t=>{const i=t.view.mark.encoding[t.channel];return"axis"in i&&i.axis});return e.length>0&&e.some(t=>t===null)?null:iL(e.filter(t=>t!==void 0),"axis",["title"])})}getTitle(){const e=r=>{var a;const o=PM(r.view,r.channel);if(!bl(o))return{member:r,explicitTitle:pI("axis"in o?(a=o.axis)==null?void 0:a.title:void 0,o.title),implicitTitle:pI($C(o)?o.field:void 0,$5(o)?o.expr:void 0)}},t=this.members.map(e),i=t.filter(r=>{var o;if(Av(r.member.channel)&&!r.explicitTitle){const a=dp(r.member.channel);return((o=t.find(l=>l.member.view==r.member.view&&l.member.channel==a))==null?void 0:o.explicitTitle)===void 0}return!0}),s=new Set(i.map(r=>pI(r.explicitTitle,r.implicitTitle)).filter(wn));return s.size?[...s].join(", "):null}}const jve={point:B1e,rect:I1e,rule:$1e,link:j1e,text:X1e};class Nr extends F_{constructor(e,t,i,s,r){super(e,t,i,s,r),this.spec=e;const o=jve[this.getMarkType()];if(o)this.mark=new o(this);else throw new Error(`No such mark: ${this.getMarkType()}`);this.coords=void 0,this.needsAxes={x:!0,y:!0}}render(e,t,i={}){this.isConfiguredVisible()&&(this.coords=t,e.pushView(this,t),e.renderMark(this.mark,i),e.popView(this))}getMarkType(){return typeof this.spec.mark=="object"?this.spec.mark.type:this.spec.mark}resolve(e){const t=this.mark.encoding;for(const[i,s]of Object.entries(t)){if(!aa(s))continue;const r=dp(s.resolutionChannel??i);if(!$g(r)||e=="axis"&&!Pw(r))continue;let o=this;for(;(o.getConfiguredOrDefaultResolution(r,e)=="forced"||o.dataParent instanceof F_&&["shared","excluded","forced"].includes(o.dataParent.getConfiguredOrDefaultResolution(r,e)))&&o.getConfiguredOrDefaultResolution(r,e)!="excluded";)o=o.dataParent;e=="axis"&&Pw(i)&&GY(r)?(o.resolutions[e][r]||(o.resolutions[e][r]=new Uve(r)),o.resolutions[e][r].pushUnitView(this,i)):e=="scale"&&$g(i)&&(o.resolutions[e][r]||(o.resolutions[e][r]=new Wve(r)),o.resolutions[e][r].pushUnitView(this,i))}}getAccessor(e){return this._cache("accessor/"+e,()=>{const t=this.mark.encoding;if(t&&t[e])return this.context.accessorFactory.createAccessor(t[e])})}getFacetAccessor(e){const t=this.getAccessor("sample");return t||super.getFacetAccessor(this)}getCollector(){return this.context.dataFlow.findCollectorByKey(this)}_validateDomainQuery(e){if(Av(e))throw new Error(`getDomain(${e}), must only be called for primary channels!`);const t=this.mark.encoding[e];if(!aa(t))throw new Error("The channel has no scale, cannot get domain!");return t}getConfiguredDomain(e){const t=this._validateDomainQuery(e),i=t&&t.scale&&t.scale.domain;if(i){const s=this.getScaleResolution(t.resolutionChannel??e);return ZW(t.type??"nominal",s.fromComplexInterval(i))}}extractDataDomain(e){const i=this._validateDomainQuery(e).type??"nominal",s=a=>{let l;const c=this.mark.encoding[a];if(c){const u=this.context.accessorFactory.createAccessor(c);if(u)if(l=ZW(i),u.constant)l.extend(u({}));else{const h=this.getCollector();h!=null&&h.completed&&h.visitData(d=>l.extend(u(d)))}}return l};let r=s(e);const o=z5[e];if(o){const a=s(o);a&&r.extendAll(a)}return r}getZoomLevel(){const e=t=>{var i;return((i=this.getScaleResolution(t))==null?void 0:i.getZoomLevel())??1};return Tb.map(e).reduce((t,i)=>t*i,1)}propagateInteractionEvent(e){this.handleInteractionEvent(void 0,e,!0),e.target=this,!e.stopped&&this.handleInteractionEvent(void 0,e,!1)}getDefaultResolution(e,t){return e=="x"?"shared":"independent"}}class DQ extends uQ{constructor(e,t,i,s,r){super(e,t,i,s,r),this.spec=e}}function*u6(n,e=[]){for(const[t,i]of n.entries())if(i instanceof Map)for(const s of u6(i,[...e,t]))yield s;else yield[[...e,t],i]}class EQ extends Hn{get behavior(){return l6}constructor(e){super(),this.params=e??{type:"collect"},this.observers=[],this.facetBatches=void 0,this._init()}_init(){this._data=[],this.facetBatches=new rp([],JSON.stringify),this.facetBatches.set(void 0,this._data)}reset(){super.reset(),this._init()}handle(e){this._data.push(e)}beginBatch(e){F1e(e)&&(this._data=[],this.facetBatches.set(po(e.facetId),this._data))}complete(){var s,r;const e=(s=this.params)==null?void 0:s.sort,t=e?iZ(e.field,e.order):void 0,i=o=>{t&&o.sort(t)};if((r=this.params.groupby)!=null&&r.length){if(this.facetBatches.size>1)throw new Error("TODO: Support faceted data!");const o=this.params.groupby.map(l=>Hi(l)),a=vE(this._data,...o);this.facetBatches.clear();for(const[l,c]of u6(a))this.facetBatches.set(l,c)}for(const o of this.facetBatches.values())i(o);if(this.children.length)for(const[o,a]of this.facetBatches.entries()){if(o){const l={type:"facet",facetId:o};for(const c of this.children)c.beginBatch(l)}for(const l of a)this._propagate(l)}super.complete();for(const o of this.observers)o(this)}getData(){switch(this._checkStatus(),this.facetBatches.size){case 0:return[];case 1:return[...this.facetBatches.values()][0];default:{const e=this.facetBatches;return{[Symbol.iterator]:function*(){for(const i of e.values())for(let s=0;s<i.length;s++)yield i[s]}}}}}visitData(e){this._checkStatus();for(const t of this.facetBatches.values())for(let i=0;i<t.length;i++)e(t[i])}getItemCount(){let e=0;for(const t of this.facetBatches.values())e+=t.length;return e}_checkStatus(){if(!this.completed)throw new Error("Data propagation is not completed! No data are available.")}}class nL{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let i=this.length++;for(;i>0;){const s=i-1>>1,r=this.values[s];if(t>=r)break;this.ids[i]=this.ids[s],this.values[i]=r,i=s}this.ids[i]=e,this.values[i]=t}pop(){if(this.length===0)return;const e=this.ids[0];if(this.length--,this.length>0){const t=this.ids[0]=this.ids[this.length],i=this.values[0]=this.values[this.length],s=this.length>>1;let r=0;for(;r<s;){let o=(r<<1)+1;const a=o+1;let l=this.ids[o],c=this.values[o];const u=this.values[a];if(a<this.length&&u<c&&(o=a,l=this.ids[a],c=u),c>=i)break;this.ids[r]=l,this.values[r]=c,r=o}this.ids[r]=t,this.values[r]=i}return e}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}class qve extends Hn{get behavior(){return $c}constructor(e){super(),this.params=e,this.startAccessor=Hi(e.start),this.endAccessor=Hi(e.end),this.chromAccessor=e.chrom?Hi(e.chrom):t=>{},this.weightAccessor=e.weight?Hi(e.weight):t=>1,this.as={coverage:e.as||"coverage",start:e.asStart||e.start,end:e.asEnd||e.end,chrom:e.asChrom||e.chrom},this.createSegment=new Function("start","end","coverage","chrom","return {"+Object.entries(this.as).filter(([t,i])=>i).map(([t,i])=>`${JSON.stringify(i)}: ${t}`).join(", ")+"};"),this.ends=new nL}reset(){super.reset(),this.initialize()}initialize(){const e=this.as.coverage,t=this.as.end,i=this.as.chrom,s=this.startAccessor,r=this.endAccessor,o=this.chromAccessor,a=this.weightAccessor;let l,c,u,h=0,d;const f=this.ends;f.clear();const g=(m,b,v)=>{if(m==b)return;let w=!1;l&&(l[e]===v?(l[t]=b,w=!0):l[e]!=0&&this._propagate(l)),w||(l=this.createSegment(m,b,v,u))},p=()=>{let m;for(;(m=f.peekValue())!==void 0;)g(d,m,h),d=m,h-=f.pop();d=void 0,l&&(this._propagate(l),l=void 0)};this.handle=m=>{const b=s(m);let v;for(;(v=f.peekValue())!==void 0&&v<b;)g(d,v,h),d=v,h-=f.pop();if(i){let y=o(m);y!==c&&(p(),u=y,c=u)}d!==void 0&&g(d,b,h),d=b;const w=a(m);h+=w,f.push(w,r(m))},this.complete=()=>{p(),super.complete()}}}function Gve(n,e,t=0,i=n.length){const s=new nL,r=i-t;let o;for(o=0;o<e&&o<r;o++)s.push(o,n[t+o]);for(;o<r;o++){const c=n[t+o];c>=s.peekValue()&&(s.push(o,c),s.pop())}const a=[];let l;for(;(l=s.pop())!==void 0;)a.push(t+l);return a.reverse()}class Kve{constructor(e,t=-1/0,i=1/0){this.maxSize=e,this.lowerLimit=t,this.upperLimit=i;const s=this.maxSize*2+1;this.lowerLimits=new Float64Array(s),this.upperLimits=new Float64Array(s),this.lowerChildren=new Int32Array(s),this.upperChildren=new Int32Array(s),this.reset()}reset(){this.lowerLimits.fill(0),this.upperLimits.fill(0),this.lowerChildren.fill(0),this.upperChildren.fill(0),this.n=1,this.lowerLimits[0]=this.lowerLimit,this.upperLimits[0]=this.upperLimit}_findSlot(e,t,i=0){if(e>=this.lowerLimits[i]&&t<=this.upperLimits[i]){const s=this.lowerChildren[i];if(s){const r=this._findSlot(e,t,s);return r>=0?r:this._findSlot(e,t,this.upperChildren[i])}else return i}else return-1}reserve(e,t){if(t-e<=0)throw new Error("Cannot reserve an empty or negative-size slot!");if(this.n+1>this.lowerLimits.length)return!1;const i=this._findSlot(e,t);if(i<0)return!1;const s=this.n++,r=this.n++;return this.lowerLimits[s]=this.lowerLimits[i],this.upperLimits[s]=e,this.lowerLimits[r]=t,this.upperLimits[r]=this.upperLimits[i],this.lowerChildren[i]=s,this.upperChildren[i]=r,!0}}class Zve extends Hn{get behavior(){return l6}constructor(e,t){if(super(),this.params=e,this._data=[],this.channel=e.channel??"x",!["x","y"].includes(this.channel))throw new Error("Invalid channel: "+this.channel);this.posAccessor=Hi(this.params.pos),this.posBisector=bE(this.posAccessor),this.scoreAccessor=Hi(this.params.score),this.widthAccessor=Hi(this.params.width),this.laneAccessor=this.params.lane?Hi(this.params.lane):s=>0,this.padding=this.params.padding??0,this.reservationMaps=new Map,this.resolution=t.getScaleResolution(this.channel);const i=()=>this._filterAndPropagate();this.schedule=()=>t.context.animator.requestTransition(i),this.resolution.addEventListener("domain",s=>this.schedule()),t._addBroadcastHandler("layoutComputed",()=>this.schedule())}complete(){const e=this.posAccessor;this._data.sort((t,i)=>e(t)-e(i)),this._scores=this._data.map(this.scoreAccessor);for(const t of new Set(this._data.map(this.laneAccessor)))this.reservationMaps.set(t,new Kve(200));this.schedule(),super.complete()}_filterAndPropagate(){var o;super.reset();const e=this.resolution.getScale(),t=(o=this.resolution.members[0].view.coords)==null?void 0:o[this.channel=="x"?"width":"height"];if(!t)return;for(const a of this.reservationMaps.values())a.reset();const i=e.domain(),s=70,r=Gve(this._scores,s,this.posBisector.left(this._data,i[0]),this.posBisector.right(this._data,i[1]));for(const a of r){const l=this._data[a],c=e(this.posAccessor(l))*t,u=this.widthAccessor(l)/2+this.padding;this.reservationMaps.get(this.laneAccessor(l)).reserve(c-u,c+u)&&this._propagate(l)}super.complete()}reset(){super.reset(),this._data=[],this.groups=new Map}handle(e){this._data.push(e)}}class Yve extends Hn{constructor(e){super(),this.params=e,this.predicate=void 0}initialize(){this.predicate=w5(this.params.expr,this.getGlobalObject())}handle(e){this.predicate(e)&&this._propagate(e)}}class Xve extends Hn{get behavior(){return $c}constructor(e){super();const t=e.index;if(e.fields){const i=po(e.fields).map(r=>Hi(r)),s=po(e.as||e.fields);if(i.length!==s.length)throw new Error(`Lengths of "fields" (${i.length}), and "as" (${s.length}) do not match!`);this.handle=r=>{const o=i.map((l,c)=>l(r)??[]),a=o[0].length;for(let l=0;l<a;l++){const c=Object.assign({},r);for(let u=0;u<i.length;u++)c[s[u]]=l<o[u].length?o[u][l]:null;t&&(c[t]=l),this._propagate(c)}}}else this.handle=i=>{for(let s=0;s<i.length;s++){const r=Object.assign({},i[s]);t&&(r[t]=s),this._propagate(r)}}}}const Qve="0".charCodeAt(0);function*Jve(n,e=","){const t=e.charCodeAt(0);let i=0;for(let s=0;s<n.length;s++){const r=n.charCodeAt(s);r==t?(yield i,i=0):i=i*10+r-Qve}yield i}class ewe extends Hn{get behavior(){return $c}constructor(e){super();const t=Hi(e.exons??"exons"),i=Hi(e.start??"start"),[s,r]=e.as||["exonStart","exonEnd"];this.handle=o=>{let a=i(o),l=a,c=!0;const u=t(o);for(const h of Jve(u)){if(c)l=a+h;else{a=l+h;const d=Object.assign({},o);d[s]=l,d[r]=a,this._propagate(d)}c=!c}}}}class twe extends Hn{get behavior(){return $c}constructor(e){super();const t=po(e.field).map(r=>Hi(r)),i=po(e.separator),s=po(e.as||e.field);if(t.length!==i.length||t.length!==s.length)throw new Error(`Lengths of "separator" (${i.length}), "fields" (${t.length}), and "as" (${s.length}) do not match!`);this.handle=r=>{if(t.some(l=>!l(r)))return;const o=t.map((l,c)=>l(r).split(i[c]));iwe(o,r);const a=o[0].length;for(let l=0;l<a;l++){const c=Object.assign({},r);for(let u=0;u<t.length;u++)c[s[u]]=o[u][l];this._propagate(c)}}}}function iwe(n,e){const t=n.map(i=>i.length);if(!t.every(i=>i==t[0]))throw new Error("Mismatching number of elements in the fields to be split: "+JSON.stringify(e))}class nwe extends Hn{get behavior(){return vf}constructor(e){super(),this.params=e,this.as=e.as,this.fn=void 0}initialize(){this.fn=w5(this.params.expr,this.getGlobalObject())}handle(e){e[this.as]=this.fn(e),this._propagate(e)}}class TQ extends Hn{get behavior(){return vf}constructor(e,t){super();const i=e.channel??"x";if(!["x","y"].includes(i))throw new Error("Invalid channel: "+i);const s=t.getScaleResolution(i).getGenome();if(!s)throw new Error("LinearizeGenomicCoordinate transform requires a locus scale!");const r=Hi(e.chrom),o=po(e.pos).map(g=>Hi(g)),a=po(e.as);if(o.length!=a.length)throw new Error('The number of "pos" and "as" elements must be equal!');const l=po(e.offset);let c;if(l.length==0)c=new Array(o.length).fill(0);else if(l.length==1)c=new Array(o.length).fill(l[0]);else if(l.length==o.length)c=l;else throw new Error(`Invalid "offset" parameter: ${JSON.stringify(e.offset)}!`);const u=new Function("datum","chromOffset","posAccessors",a.map((g,p)=>`datum[${JSON.stringify(g)}] = chromOffset + +posAccessors[${p}](datum) - ${c[p]};`).join(`
`));let h,d=0;const f=g=>{if(g!==h){if(d=s.cumulativeChromPositions.get(g),d===void 0)throw new Error("Unknown chromosome/contig: "+g);h=g}return d};this.handle=g=>{u(g,f(r(g)),o),this._propagate(g)}}}const swe=["Lato-Regular.png"],rwe=[{id:87,width:53,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:43.491,chnl:15,x:0,y:0,page:0},{id:124,width:17,height:50,xoffset:0,yoffset:-32.193000000000005,xadvance:10.521,chnl:15,x:0,y:42,page:0},{id:40,width:20,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:94,page:0},{id:41,width:19,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:145,page:0},{id:36,width:32,height:49,xoffset:0,yoffset:-34.419000000000004,xadvance:24.360000000000003,chnl:15,x:0,y:196,page:0},{id:125,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:247,page:0},{id:91,width:22,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:297,page:0},{id:93,width:19,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:347,page:0},{id:123,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:397,page:0},{id:106,width:19,height:48,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:0,y:447,page:0},{id:81,width:43,height:47,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:21,y:447,page:0},{id:77,width:45,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:38.997,chnl:15,x:66,y:447,page:0},{id:64,width:43,height:44,xoffset:0,yoffset:-28.539,xadvance:35.133,chnl:15,x:23,y:397,page:0},{id:92,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:68,y:397,page:0},{id:47,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:98,y:397,page:0},{id:109,width:42,height:32,xoffset:0,yoffset:-21.609,xadvance:34.545,chnl:15,x:113,y:447,page:0},{id:119,width:42,height:31,xoffset:0,yoffset:-21.315,xadvance:32.991,chnl:15,x:157,y:447,page:0},{id:42,width:25,height:42,xoffset:0,yoffset:-31.626,xadvance:17.85,chnl:15,x:128,y:397,page:0},{id:37,width:42,height:41,xoffset:0,yoffset:-30.387,xadvance:33.663000000000004,chnl:15,x:155,y:397,page:0},{id:79,width:42,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:199,y:397,page:0},{id:102,width:24,height:41,xoffset:0,yoffset:-30.534000000000002,xadvance:14.721,chnl:15,x:243,y:397,page:0},{id:100,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:269,y:397,page:0},{id:98,width:32,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:302,y:397,page:0},{id:56,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:336,y:397,page:0},{id:38,width:40,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:29.904000000000003,chnl:15,x:370,y:397,page:0},{id:108,width:17,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:9.912,chnl:15,x:412,y:397,page:0},{id:107,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:21.336000000000002,chnl:15,x:431,y:397,page:0},{id:48,width:33,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:464,y:397,page:0},{id:71,width:38,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:30.681,chnl:15,x:21,y:347,page:0},{id:83,width:31,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:22.785,chnl:15,x:61,y:347,page:0},{id:63,width:27,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:18.795,chnl:15,x:94,y:347,page:0},{id:105,width:18,height:41,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:123,y:347,page:0},{id:51,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:143,y:347,page:0},{id:104,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.436,chnl:15,x:177,y:347,page:0},{id:67,width:37,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:28.056,chnl:15,x:210,y:347,page:0},{id:88,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.258000000000003,chnl:15,x:249,y:347,page:0},{id:68,width:40,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:31.941000000000003,chnl:15,x:288,y:347,page:0},{id:70,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:23.751,chnl:15,x:330,y:347,page:0},{id:34,width:23,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:15.561000000000002,chnl:15,x:364,y:347,page:0},{id:72,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:389,y:347,page:0},{id:73,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.760000000000002,chnl:15,x:429,y:347,page:0},{id:74,width:24,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:17.745,chnl:15,x:449,y:347,page:0},{id:75,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.825000000000003,chnl:15,x:24,y:297,page:0},{id:76,width:31,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:21.567,chnl:15,x:475,y:347,page:0},{id:66,width:35,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.153000000000002,chnl:15,x:64,y:297,page:0},{id:78,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:101,y:297,page:0},{id:33,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.298,chnl:15,x:141,y:297,page:0},{id:80,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.221,chnl:15,x:161,y:297,page:0},{id:65,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:197,y:297,page:0},{id:82,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.313000000000002,chnl:15,x:237,y:297,page:0},{id:35,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:275,y:297,page:0},{id:84,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.801000000000002,chnl:15,x:310,y:297,page:0},{id:85,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:30.891000000000002,chnl:15,x:346,y:297,page:0},{id:86,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:385,y:297,page:0},{id:39,width:16,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:8.568000000000001,chnl:15,x:425,y:297,page:0},{id:69,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.255000000000003,chnl:15,x:443,y:297,page:0},{id:89,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.208000000000002,chnl:15,x:23,y:247,page:0},{id:90,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.284000000000002,chnl:15,x:477,y:297,page:0},{id:49,width:31,height:40,xoffset:0,yoffset:-30.156000000000002,xadvance:24.360000000000003,chnl:15,x:61,y:247,page:0},{id:50,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:94,y:247,page:0},{id:57,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:128,y:247,page:0},{id:94,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:162,y:247,page:0},{id:96,width:21,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:16.8,chnl:15,x:196,y:247,page:0},{id:55,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:219,y:247,page:0},{id:54,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:254,y:247,page:0},{id:53,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:289,y:247,page:0},{id:52,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:323,y:247,page:0},{id:103,width:31,height:39,xoffset:0,yoffset:-21.630000000000003,xadvance:21.84,chnl:15,x:358,y:247,page:0},{id:112,width:32,height:39,xoffset:0,yoffset:-21.651,xadvance:23.541,chnl:15,x:391,y:247,page:0},{id:113,width:31,height:39,xoffset:0,yoffset:-21.651,xadvance:23.520000000000003,chnl:15,x:425,y:247,page:0},{id:116,width:25,height:39,xoffset:0,yoffset:-28.182000000000002,xadvance:15.057,chnl:15,x:458,y:247,page:0},{id:121,width:31,height:38,xoffset:0,yoffset:-21.273,xadvance:21.651,chnl:15,x:34,y:196,page:0},{id:59,width:18,height:36,xoffset:0,yoffset:-20.706,xadvance:10.983,chnl:15,x:485,y:247,page:0},{id:43,width:32,height:34,xoffset:0,yoffset:-24.486,xadvance:24.360000000000003,chnl:15,x:67,y:196,page:0},{id:60,width:30,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:101,y:196,page:0},{id:62,width:31,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:133,y:196,page:0},{id:117,width:30,height:32,xoffset:0,yoffset:-21.273,xadvance:23.415000000000003,chnl:15,x:166,y:196,page:0},{id:99,width:29,height:32,xoffset:0,yoffset:-21.609,xadvance:20.055,chnl:15,x:198,y:196,page:0},{id:110,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:23.436,chnl:15,x:229,y:196,page:0},{id:111,width:32,height:32,xoffset:0,yoffset:-21.609,xadvance:23.814,chnl:15,x:262,y:196,page:0},{id:126,width:32,height:26,xoffset:0,yoffset:-16.128,xadvance:24.360000000000003,chnl:15,x:201,y:447,page:0},{id:101,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:22.176000000000002,chnl:15,x:296,y:196,page:0},{id:114,width:25,height:32,xoffset:0,yoffset:-21.651,xadvance:15.288,chnl:15,x:329,y:196,page:0},{id:115,width:27,height:32,xoffset:0,yoffset:-21.609,xadvance:18.186,chnl:15,x:356,y:196,page:0},{id:97,width:28,height:32,xoffset:0,yoffset:-21.651,xadvance:20.874000000000002,chnl:15,x:385,y:196,page:0},{id:118,width:31,height:31,xoffset:0,yoffset:-21.273,xadvance:21.672,chnl:15,x:415,y:196,page:0},{id:61,width:31,height:29,xoffset:0,yoffset:-19.089000000000002,xadvance:24.360000000000003,chnl:15,x:448,y:196,page:0},{id:120,width:30,height:31,xoffset:0,yoffset:-21.273,xadvance:20.916,chnl:15,x:21,y:145,page:0},{id:58,width:18,height:31,xoffset:0,yoffset:-20.706,xadvance:10.5,chnl:15,x:53,y:145,page:0},{id:122,width:28,height:31,xoffset:0,yoffset:-21.273,xadvance:18.984,chnl:15,x:73,y:145,page:0},{id:95,width:28,height:16,xoffset:0,yoffset:0,xadvance:19.278000000000002,chnl:15,x:235,y:447,page:0},{id:45,width:23,height:24,xoffset:0,yoffset:-14.175,xadvance:15.603000000000002,chnl:15,x:481,y:196,page:0},{id:44,width:17,height:21,xoffset:0,yoffset:-4.956,xadvance:9.534,chnl:15,x:103,y:145,page:0},{id:46,width:18,height:15,xoffset:0,yoffset:-4.956,xadvance:9.912,chnl:15,x:0,y:497,page:0},{id:32,width:0,height:0,xoffset:0,yoffset:0,xadvance:10.752,chnl:15,x:20,y:497,page:0}],owe={face:"Lato Regular",size:42,bold:0,italic:0,charset:[" ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"],unicode:1,stretchH:100,smooth:1,aa:1,padding:[0,0,0,0],spacing:[2,2]},awe={lineHeight:50.400000000000006,base:41.454,scaleW:512,scaleH:512,pages:1,packed:0,alphaChnl:0,redChnl:0,greenChnl:0,blueChnl:0},lwe=[],AQ={pages:swe,chars:rwe,info:owe,common:awe,kernings:lwe};class cwe extends Hn{get behavior(){return vf}constructor(e){super();const t=GM(AQ),i=Hi(e.field),s=e.as,r=e.fontSize;this.handle=o=>{const a=i(o);a!==void 0?o[s]=t.measureWidth(a,r):o[s]=0,this._propagate(o)}}}const uwe=65536;class hwe extends Hn{get behavior(){return vf}constructor(e){super(),this.params=e}reset(){super.reset(),this.initialize()}initialize(){const e=this.params,t=e.as||"lane",i=bo(e.spacing)?e.spacing:1,s=Hi(e.start),r=Hi(e.end);if(!e.preference!=!e.preferredOrder)throw new Error('Must specify both "preference" and "preferredOrder"');if(e.preference){const o=new Float64Array(uwe),a=Hi(e.preference),l=e.preferredOrder;let c=1/0;this.handle=u=>{const h=s(u);h<c&&o.fill(-1/0),c=h;const d=l.indexOf(a(u));let f=-1;if(d>=0&&o[d]<h)f=d;else{const g=s(u);for(f=0;f<o.length&&!(o[f]<g);f++);if(f>=o.length)throw new Error("Out of lanes!")}o[f]=r(u)+i,u[t]=f,this._propagate(u)}}else{const o=new nL,a=new nL;let l=-1/0,c=0;this.handle=u=>{const h=s(u);for(;o.length&&(o.peekValue()<=h||h<l);){const f=o.pop();a.push(f,f)}l=h;let d=a.pop();d===void 0&&(d=c++),u[t]=d,this._propagate(u),o.push(d,r(u)+i)}}}}class dwe extends Hn{get behavior(){return $c}constructor(e){if(super(),e.as&&e.as.length!=e.fields.length)throw new Error('"fields" and "as" have unequal lengths!');const t=e.fields.map(s=>Hi(s)),i=e.as?e.as:t.map(Cue);this.handle=s=>{const r={};for(let o=0;o<t.length;o++)r[i[o]]=t[o](s);this._propagate(r)}}}class fwe extends Hn{get behavior(){return vf}constructor(e){super();const t=new RegExp(e.regex),i=typeof e.as=="string"?[e.as]:e.as,s=Hi(e.field);this.handle=r=>{const o=s(r);if(wn(o)){const a=o.match(t);if(a){if(a.length-1!=i.length)throw new Error('The number of RegEx groups and the length of "as" do not match!');for(let l=0;l<i.length;l++)r[i[l]]=a[l+1]}else if(e.skipInvalidInput)for(let l=0;l<i.length;l++)r[i[l]]=void 0;else throw new Error(`"${o}" does not match the given regex: ${t.toString()}`)}else if(!e.skipInvalidInput)throw new Error(`Trying to match a non-string field. Encountered type: ${typeof o}, field content: "${o}".`);this._propagate(r)}}}class gwe extends Hn{get behavior(){return $c}constructor(e){super();const t=po(e.columnRegex).map(d=>new RegExp(d)),i=po(e.asValue);if(t.length!=i.length)throw new Error('Lengths of "columnRegex" and "as" are not equal!');const s=e.skipRegex?new RegExp(e.skipRegex):void 0,r=e.asKey||"sample";let o,a,l;const c=d=>{var m;const f=Object.keys(d),g=new Map;for(const[b,v]of t.entries())for(const w of f){const y=(m=v.exec(w))==null?void 0:m[1];if(y!==void 0){let x=g.get(y);x||(x=[],g.set(y,x)),x[b]=w}}o=[...g.entries()],a=f.filter(b=>!t.some(v=>v.test(b))&&!(s&&s.test(b)));const p=[...a.map(b=>JSON.stringify(b)+": datum["+JSON.stringify(b)+"]"),JSON.stringify(r)+": sampleId",...i.map(b=>JSON.stringify(b)+": null")];l=new Function("datum","sampleId",`return {
`+p.join(`,
`)+`
};`)},u=d=>{o||c(d);for(const[f,g]of o){const p=l(d,f);for(let m=0;m<g.length;m++)p[i[m]]=d[g[m]];this._propagate(p)}},h=d=>{c(d),u(d),this.handle=u};this.handle=h,this.beginBatch=d=>{oQ(d)&&(this.handle=h),super.beginBatch(d)}}}class pwe extends Hn{get behavior(){return vf}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const e=this.params,t=e.as||["y0","y1"],i=e.sort?iZ(e.sort.field,e.sort.order):void 0,s=e.field?Hi(e.field):()=>1,r=e.groupby.map(u=>Hi(u)),o=dhe(this.buffer,u=>r.map(h=>h(u)).join()).map(u=>u[1]);let a=u=>!0;if(e.baseField){const u=Hi(e.baseField);a=h=>u(h)!==null}let l,c;switch(e.offset){case"normalize":l=(u,h)=>u/h,c=(u,h)=>HS(u,h);break;case"center":l=(u,h)=>u-h/2,c=(u,h)=>HS(u,h);break;case"information":{const u=Math.log2(e.cardinality??4);l=(h,d)=>h/d,c=(h,d)=>{const g=HS(h,v=>+!a(v)),p=HS(h,d),m=p-g;let b=0;for(let v=0;v<h.length;v++){const w=h[v];if(a(w)){const y=d(w)/m;b-=y*Math.log2(y)}}return m/(u-(b+0))*(m/p)}}break;default:l=(u,h)=>u,c=(u,h)=>1}for(const u of o){i&&u.sort(i);const h=c(u,s);let d=0;for(const f of u){const g=d+s(f);a(f)&&(f[t[0]]=l(d,h),f[t[1]]=l(g,h),this._propagate(f),d=g)}}super.complete()}}class mwe extends Hn{get behavior(){return $c}constructor(e){super();const t=Hi(e.field??"sequence"),[i,s]=e.as??["pos","sequence"];this.handle=r=>{const o=Object.assign({},r,{[s]:"",[i]:0}),a=t(r);for(let l=0;l<a.length;l++){const c=Object.assign({},o);c[i]=l,c[s]=a.charAt(l),this._propagate(c)}}}}class _we extends Hn{get behavior(){return $c}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const t=this.params.groupby,i=t.map(r=>Hi(r)),s=vE(this.buffer,...i);for(const[r,o]of u6(s)){const a={count:o.length};for(let l=0;l<t.length;l++)a[t[l]]=r[l];this._propagate(a)}super.complete()}}const bwe="_uniqueId",XW=1e4,QW=[null];class IQ extends Hn{get behavior(){return vf}constructor(e){super(),this.params=e,this.as=e.as??bwe,this._blocks=[],this._usedBlocks=0,this._id=-1}initialize(){}reset(){super.reset(),this._usedBlocks=0,this._id=-1}handle(e){e[this.as]=this._nextId(),this._propagate(e)}_nextId(){return++this._id%XW==0&&(this._id=this._getBlock()*XW),this._id}_getBlock(){return this._usedBlocks<this._blocks.length?this._blocks[this._usedBlocks++]:this._reserveBlock()}_reserveBlock(){const e=QW.length;return QW[e]=this,this._blocks.push(e),this._usedBlocks++,e}}const vwe={aggregate:_we,collect:EQ,coverage:qve,filterScoredLabels:Zve,filter:Yve,flatten:Xve,flattenCompressedExons:ewe,flattenDelimited:twe,flattenSequence:mwe,formula:nwe,identifier:IQ,linearizeGenomicCoordinate:TQ,measureText:cwe,pileup:hwe,project:dwe,regexExtract:fwe,regexFold:gwe,sample:aQ,stack:pwe};function wwe(n,e){const t=vwe[n.type];if(t)return new t(n,e);throw new Error("Unknown transform: "+n.type)}function NQ(n){if(!MQ(n)&&!JW(n))return;const e={...n.format};if(e.type??(e.type=JW(n)&&ywe(n.url)),e.parse??(e.parse="auto"),!e.type)throw new Error("Format for the data source was not defined and it could not be inferred: "+JSON.stringify(n));return e}function ywe(n){var e;if(Array.isArray(n)&&(n=n[0]),n)return(e=n.match(/\.(csv|tsv|json)/))==null?void 0:e[1]}const RQ=n=>typeof n!="object"?Cwe:Swe,Cwe=n=>({data:n}),Swe=n=>n;function JW(n){return"url"in n}let KC=class extends Hn{get identifier(){}handle(e){throw new Error("Source does not handle incoming data!")}async load(){}};function MQ(n){return"values"in n}class xwe extends KC{constructor(e,t){var i;if(super(),this.params=e,typeof e.values=="string"&&!((i=e==null?void 0:e.format)!=null&&i.type))throw new Error("Data format type (csv, dsv, ...) must be specified if a string is provided!")}loadSynchronously(){const e=this.params.values;let t=[],i=s=>s;if(Array.isArray(e))e.length>0&&(t=e,i=RQ(e[0]));else if(typeof e=="object")t=[e];else if(typeof e=="string")t=m5(e,NQ(this.params));else throw new Error('"values" in data configuration is not an array, object, or a string!');this.reset(),this.beginBatch({type:"file"});for(const s of t)this._propagate(i(s));this.complete()}async load(){this.loadSynchronously()}}function kwe(n){return"url"in n}class Lwe extends KC{constructor(e,t){super(),this.params=e,this.baseUrl=t==null?void 0:t.getBaseUrl()}get identifier(){return JSON.stringify({params:this.params,baseUrl:this.baseUrl})}async load(){const e=this.params.url,t=Array.isArray(e)?e:[e],i=async r=>CE({baseURL:this.baseUrl}).load(r).catch(o=>{throw new Error(`Cannot fetch: ${this.baseUrl}${r}: ${o.message}`)}),s=(r,o)=>{try{const a=m5(r,NQ(this.params));this.beginBatch({type:"file",url:o});for(const l of a)this._propagate(l)}catch(a){throw new Error(`Cannot parse: ${o}: ${a.message}`)}};this.reset(),await Promise.all(t.map(r=>i(r).then(s))),this.complete()}}function Dwe(n){return"sequence"in n}class Ewe extends KC{constructor(e,t){if(super(),this.sequence=e.sequence,!("start"in this.sequence))throw new Error("'start' is missing from sequence parameters!");if(!("stop"in this.sequence))throw new Error("'stop' is missing from sequence parameters!")}loadSynchronously(){const e=this.sequence.as||"data",t=this.sequence.step||1,i=this.sequence.stop;this.reset(),this.beginBatch({type:"file"});for(let s=this.sequence.start;s<i;s+=t)this._propagate({[e]:s});this.complete()}async load(){this.loadSynchronously()}}function Twe(n,e,t){return t=(t-n)/(e-n),t=Math.max(0,Math.min(1,t)),t*t*(3-2*t)}class Hp extends KC{constructor(e,t){if(super(),this.view=e,t){if(t!=="x"&&t!=="y")throw new Error(`Invalid channel specified for the dynamic data source: ${t}. Must be either "x" or "y"`)}else throw new Error('No channel has been specified for the dynamic data source. Must be either "x" or "y".');if(this.channel=t,this.scaleResolution=this.view.getScaleResolution(t),!this.scaleResolution){const s=[`The dynamic data source cannot find a resolved scale for channel "${t}".`];throw this.view instanceof Nr||s.push('Make sure the view has a "shared" scale resolution as it is not a unit view.'),new Error(s.join(" "))}const i=()=>{this.view.isVisible()&&this.onDomainChanged(this.scaleResolution.getDomain(),this.scaleResolution.getComplexDomain())};this.scaleResolution.addEventListener("domain",i),this.view.context.addBroadcastListener("layoutComputed",i)}getAxisLength(){const e=this.scaleResolution.members.map(t=>{var i;return(i=t.view.coords)==null?void 0:i[this.channel==="x"?"width":"height"]}).filter(t=>t>0);return e.length?e.reduce((t,i)=>Math.min(t,i),1e4):0}get genome(){return this.scaleResolution.getGenome()}async onDomainChanged(e,t){}requestRender(){this.view.context.animator.requestRender()}async load(){this.reset(),this.complete()}publishData(e){this.reset(),this.beginBatch({type:"file"});for(const t of e)this._propagate(t);this.complete(),i4(this.view),this.requestRender()}}class Awe extends Hp{constructor(t,i){const s={axis:{},...t};super(i,s.channel);Rn(this,"ticks",[]);this.params=t}async onDomainChanged(){const t=this.scaleResolution.getScale(),i=this.params.axis,s=this.getAxisLength(),r=c=>25+60*Twe(100,700,c),o=bo(i.tickCount)?i.tickCount:Math.round(s/r(s)),a=fQ(t,o,i.tickMinStep),l=i.values?gQ(t,i.values,a):ave(t,a);if(!Uk(l,this.ticks)){this.ticks=l;const c=cve(t,o,i.format);this.publishData(l.map(u=>({value:u,label:c(u)})))}}}class Iwe extends Hp{constructor(e,t){super(t,e.channel)}async load(){this.publishData(this.genome.chromosomes)}}var $w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function Up(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Nwe(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var s=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:function(){return n[i]}})}),t}var zs={},XE={};XE.byteLength=Fwe;XE.toByteArray=Owe;XE.fromByteArray=Vwe;var ec=[],na=[],Rwe=typeof Uint8Array<"u"?Uint8Array:Array,mI="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Em=0,Mwe=mI.length;Em<Mwe;++Em)ec[Em]=mI[Em],na[mI.charCodeAt(Em)]=Em;na["-".charCodeAt(0)]=62;na["_".charCodeAt(0)]=63;function FQ(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function Fwe(n){var e=FQ(n),t=e[0],i=e[1];return(t+i)*3/4-i}function Pwe(n,e,t){return(e+t)*3/4-t}function Owe(n){var e,t=FQ(n),i=t[0],s=t[1],r=new Rwe(Pwe(n,i,s)),o=0,a=s>0?i-4:i,l;for(l=0;l<a;l+=4)e=na[n.charCodeAt(l)]<<18|na[n.charCodeAt(l+1)]<<12|na[n.charCodeAt(l+2)]<<6|na[n.charCodeAt(l+3)],r[o++]=e>>16&255,r[o++]=e>>8&255,r[o++]=e&255;return s===2&&(e=na[n.charCodeAt(l)]<<2|na[n.charCodeAt(l+1)]>>4,r[o++]=e&255),s===1&&(e=na[n.charCodeAt(l)]<<10|na[n.charCodeAt(l+1)]<<4|na[n.charCodeAt(l+2)]>>2,r[o++]=e>>8&255,r[o++]=e&255),r}function Bwe(n){return ec[n>>18&63]+ec[n>>12&63]+ec[n>>6&63]+ec[n&63]}function Wwe(n,e,t){for(var i,s=[],r=e;r<t;r+=3)i=(n[r]<<16&16711680)+(n[r+1]<<8&65280)+(n[r+2]&255),s.push(Bwe(i));return s.join("")}function Vwe(n){for(var e,t=n.length,i=t%3,s=[],r=16383,o=0,a=t-i;o<a;o+=r)s.push(Wwe(n,o,o+r>a?a:o+r));return i===1?(e=n[t-1],s.push(ec[e>>2]+ec[e<<4&63]+"==")):i===2&&(e=(n[t-2]<<8)+n[t-1],s.push(ec[e>>10]+ec[e>>4&63]+ec[e<<2&63]+"=")),s.join("")}var h6={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */h6.read=function(n,e,t,i,s){var r,o,a=s*8-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=t?s-1:0,d=t?-1:1,f=n[e+h];for(h+=d,r=f&(1<<-u)-1,f>>=-u,u+=a;u>0;r=r*256+n[e+h],h+=d,u-=8);for(o=r&(1<<-u)-1,r>>=-u,u+=i;u>0;o=o*256+n[e+h],h+=d,u-=8);if(r===0)r=1-c;else{if(r===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,i),r=r-c}return(f?-1:1)*o*Math.pow(2,r-i)};h6.write=function(n,e,t,i,s,r){var o,a,l,c=r*8-s-1,u=(1<<c)-1,h=u>>1,d=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:r-1,g=i?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=d/l:e+=d*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*l-1)*Math.pow(2,s),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;n[t+f]=a&255,f+=g,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;n[t+f]=o&255,f+=g,o/=256,c-=8);n[t+f-g]|=p*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=XE,t=h6,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50;const s=2147483647;n.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=r(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function r(){try{const A=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(A,C),A.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(A){if(A>s)throw new RangeError('The value "'+A+'" is invalid for option "size"');const C=new Uint8Array(A);return Object.setPrototypeOf(C,a.prototype),C}function a(A,C,L){if(typeof A=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(A)}return l(A,C,L)}a.poolSize=8192;function l(A,C,L){if(typeof A=="string")return d(A,C);if(ArrayBuffer.isView(A))return g(A);if(A==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A);if(Q(A,ArrayBuffer)||A&&Q(A.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Q(A,SharedArrayBuffer)||A&&Q(A.buffer,SharedArrayBuffer)))return p(A,C,L);if(typeof A=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const O=A.valueOf&&A.valueOf();if(O!=null&&O!==A)return a.from(O,C,L);const j=m(A);if(j)return j;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof A[Symbol.toPrimitive]=="function")return a.from(A[Symbol.toPrimitive]("string"),C,L);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A)}a.from=function(A,C,L){return l(A,C,L)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(A){if(typeof A!="number")throw new TypeError('"size" argument must be of type number');if(A<0)throw new RangeError('The value "'+A+'" is invalid for option "size"')}function u(A,C,L){return c(A),A<=0?o(A):C!==void 0?typeof L=="string"?o(A).fill(C,L):o(A).fill(C):o(A)}a.alloc=function(A,C,L){return u(A,C,L)};function h(A){return c(A),o(A<0?0:b(A)|0)}a.allocUnsafe=function(A){return h(A)},a.allocUnsafeSlow=function(A){return h(A)};function d(A,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);const L=w(A,C)|0;let O=o(L);const j=O.write(A,C);return j!==L&&(O=O.slice(0,j)),O}function f(A){const C=A.length<0?0:b(A.length)|0,L=o(C);for(let O=0;O<C;O+=1)L[O]=A[O]&255;return L}function g(A){if(Q(A,Uint8Array)){const C=new Uint8Array(A);return p(C.buffer,C.byteOffset,C.byteLength)}return f(A)}function p(A,C,L){if(C<0||A.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(A.byteLength<C+(L||0))throw new RangeError('"length" is outside of buffer bounds');let O;return C===void 0&&L===void 0?O=new Uint8Array(A):L===void 0?O=new Uint8Array(A,C):O=new Uint8Array(A,C,L),Object.setPrototypeOf(O,a.prototype),O}function m(A){if(a.isBuffer(A)){const C=b(A.length)|0,L=o(C);return L.length===0||A.copy(L,0,0,C),L}if(A.length!==void 0)return typeof A.length!="number"||R(A.length)?o(0):f(A);if(A.type==="Buffer"&&Array.isArray(A.data))return f(A.data)}function b(A){if(A>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return A|0}function v(A){return+A!=A&&(A=0),a.alloc(+A)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,L){if(Q(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),Q(L,Uint8Array)&&(L=a.from(L,L.offset,L.byteLength)),!a.isBuffer(C)||!a.isBuffer(L))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===L)return 0;let O=C.length,j=L.length;for(let Z=0,ce=Math.min(O,j);Z<ce;++Z)if(C[Z]!==L[Z]){O=C[Z],j=L[Z];break}return O<j?-1:j<O?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,L){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);let O;if(L===void 0)for(L=0,O=0;O<C.length;++O)L+=C[O].length;const j=a.allocUnsafe(L);let Z=0;for(O=0;O<C.length;++O){let ce=C[O];if(Q(ce,Uint8Array))Z+ce.length>j.length?(a.isBuffer(ce)||(ce=a.from(ce)),ce.copy(j,Z)):Uint8Array.prototype.set.call(j,ce,Z);else if(a.isBuffer(ce))ce.copy(j,Z);else throw new TypeError('"list" argument must be an Array of Buffers');Z+=ce.length}return j};function w(A,C){if(a.isBuffer(A))return A.length;if(ArrayBuffer.isView(A)||Q(A,ArrayBuffer))return A.byteLength;if(typeof A!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof A);const L=A.length,O=arguments.length>2&&arguments[2]===!0;if(!O&&L===0)return 0;let j=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return L;case"utf8":case"utf-8":return Nt(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L*2;case"hex":return L>>>1;case"base64":return le(A).length;default:if(j)return O?-1:Nt(A).length;C=(""+C).toLowerCase(),j=!0}}a.byteLength=w;function y(A,C,L){let O=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((L===void 0||L>this.length)&&(L=this.length),L<=0)||(L>>>=0,C>>>=0,L<=C))return"";for(A||(A="utf8");;)switch(A){case"hex":return ve(this,C,L);case"utf8":case"utf-8":return q(this,C,L);case"ascii":return me(this,C,L);case"latin1":case"binary":return De(this,C,L);case"base64":return $(this,C,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,C,L);default:if(O)throw new TypeError("Unknown encoding: "+A);A=(A+"").toLowerCase(),O=!0}}a.prototype._isBuffer=!0;function x(A,C,L){const O=A[C];A[C]=A[L],A[L]=O}a.prototype.swap16=function(){const C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let L=0;L<C;L+=2)x(this,L,L+1);return this},a.prototype.swap32=function(){const C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let L=0;L<C;L+=4)x(this,L,L+3),x(this,L+1,L+2);return this},a.prototype.swap64=function(){const C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let L=0;L<C;L+=8)x(this,L,L+7),x(this,L+1,L+6),x(this,L+2,L+5),x(this,L+3,L+4);return this},a.prototype.toString=function(){const C=this.length;return C===0?"":arguments.length===0?q(this,0,C):y.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){let C="";const L=n.INSPECT_MAX_BYTES;return C=this.toString("hex",0,L).replace(/(.{2})/g,"$1 ").trim(),this.length>L&&(C+=" ... "),"<Buffer "+C+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(C,L,O,j,Z){if(Q(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(L===void 0&&(L=0),O===void 0&&(O=C?C.length:0),j===void 0&&(j=0),Z===void 0&&(Z=this.length),L<0||O>C.length||j<0||Z>this.length)throw new RangeError("out of range index");if(j>=Z&&L>=O)return 0;if(j>=Z)return-1;if(L>=O)return 1;if(L>>>=0,O>>>=0,j>>>=0,Z>>>=0,this===C)return 0;let ce=Z-j,Ue=O-L;const Re=Math.min(ce,Ue),lt=this.slice(j,Z),ft=C.slice(L,O);for(let $t=0;$t<Re;++$t)if(lt[$t]!==ft[$t]){ce=lt[$t],Ue=ft[$t];break}return ce<Ue?-1:Ue<ce?1:0};function D(A,C,L,O,j){if(A.length===0)return-1;if(typeof L=="string"?(O=L,L=0):L>2147483647?L=2147483647:L<-2147483648&&(L=-2147483648),L=+L,R(L)&&(L=j?0:A.length-1),L<0&&(L=A.length+L),L>=A.length){if(j)return-1;L=A.length-1}else if(L<0)if(j)L=0;else return-1;if(typeof C=="string"&&(C=a.from(C,O)),a.isBuffer(C))return C.length===0?-1:S(A,C,L,O,j);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?j?Uint8Array.prototype.indexOf.call(A,C,L):Uint8Array.prototype.lastIndexOf.call(A,C,L):S(A,[C],L,O,j);throw new TypeError("val must be string, number or Buffer")}function S(A,C,L,O,j){let Z=1,ce=A.length,Ue=C.length;if(O!==void 0&&(O=String(O).toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(A.length<2||C.length<2)return-1;Z=2,ce/=2,Ue/=2,L/=2}function Re(ft,$t){return Z===1?ft[$t]:ft.readUInt16BE($t*Z)}let lt;if(j){let ft=-1;for(lt=L;lt<ce;lt++)if(Re(A,lt)===Re(C,ft===-1?0:lt-ft)){if(ft===-1&&(ft=lt),lt-ft+1===Ue)return ft*Z}else ft!==-1&&(lt-=lt-ft),ft=-1}else for(L+Ue>ce&&(L=ce-Ue),lt=L;lt>=0;lt--){let ft=!0;for(let $t=0;$t<Ue;$t++)if(Re(A,lt+$t)!==Re(C,$t)){ft=!1;break}if(ft)return lt}return-1}a.prototype.includes=function(C,L,O){return this.indexOf(C,L,O)!==-1},a.prototype.indexOf=function(C,L,O){return D(this,C,L,O,!0)},a.prototype.lastIndexOf=function(C,L,O){return D(this,C,L,O,!1)};function T(A,C,L,O){L=Number(L)||0;const j=A.length-L;O?(O=Number(O),O>j&&(O=j)):O=j;const Z=C.length;O>Z/2&&(O=Z/2);let ce;for(ce=0;ce<O;++ce){const Ue=parseInt(C.substr(ce*2,2),16);if(R(Ue))return ce;A[L+ce]=Ue}return ce}function k(A,C,L,O){return ie(Nt(C,A.length-L),A,L,O)}function I(A,C,L,O){return ie(is(C),A,L,O)}function N(A,C,L,O){return ie(le(C),A,L,O)}function z(A,C,L,O){return ie(Zo(C,A.length-L),A,L,O)}a.prototype.write=function(C,L,O,j){if(L===void 0)j="utf8",O=this.length,L=0;else if(O===void 0&&typeof L=="string")j=L,O=this.length,L=0;else if(isFinite(L))L=L>>>0,isFinite(O)?(O=O>>>0,j===void 0&&(j="utf8")):(j=O,O=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Z=this.length-L;if((O===void 0||O>Z)&&(O=Z),C.length>0&&(O<0||L<0)||L>this.length)throw new RangeError("Attempt to write outside buffer bounds");j||(j="utf8");let ce=!1;for(;;)switch(j){case"hex":return T(this,C,L,O);case"utf8":case"utf-8":return k(this,C,L,O);case"ascii":case"latin1":case"binary":return I(this,C,L,O);case"base64":return N(this,C,L,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,C,L,O);default:if(ce)throw new TypeError("Unknown encoding: "+j);j=(""+j).toLowerCase(),ce=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function $(A,C,L){return C===0&&L===A.length?e.fromByteArray(A):e.fromByteArray(A.slice(C,L))}function q(A,C,L){L=Math.min(A.length,L);const O=[];let j=C;for(;j<L;){const Z=A[j];let ce=null,Ue=Z>239?4:Z>223?3:Z>191?2:1;if(j+Ue<=L){let Re,lt,ft,$t;switch(Ue){case 1:Z<128&&(ce=Z);break;case 2:Re=A[j+1],(Re&192)===128&&($t=(Z&31)<<6|Re&63,$t>127&&(ce=$t));break;case 3:Re=A[j+1],lt=A[j+2],(Re&192)===128&&(lt&192)===128&&($t=(Z&15)<<12|(Re&63)<<6|lt&63,$t>2047&&($t<55296||$t>57343)&&(ce=$t));break;case 4:Re=A[j+1],lt=A[j+2],ft=A[j+3],(Re&192)===128&&(lt&192)===128&&(ft&192)===128&&($t=(Z&15)<<18|(Re&63)<<12|(lt&63)<<6|ft&63,$t>65535&&$t<1114112&&(ce=$t))}}ce===null?(ce=65533,Ue=1):ce>65535&&(ce-=65536,O.push(ce>>>10&1023|55296),ce=56320|ce&1023),O.push(ce),j+=Ue}return de(O)}const ne=4096;function de(A){const C=A.length;if(C<=ne)return String.fromCharCode.apply(String,A);let L="",O=0;for(;O<C;)L+=String.fromCharCode.apply(String,A.slice(O,O+=ne));return L}function me(A,C,L){let O="";L=Math.min(A.length,L);for(let j=C;j<L;++j)O+=String.fromCharCode(A[j]&127);return O}function De(A,C,L){let O="";L=Math.min(A.length,L);for(let j=C;j<L;++j)O+=String.fromCharCode(A[j]);return O}function ve(A,C,L){const O=A.length;(!C||C<0)&&(C=0),(!L||L<0||L>O)&&(L=O);let j="";for(let Z=C;Z<L;++Z)j+=W[A[Z]];return j}function $e(A,C,L){const O=A.slice(C,L);let j="";for(let Z=0;Z<O.length-1;Z+=2)j+=String.fromCharCode(O[Z]+O[Z+1]*256);return j}a.prototype.slice=function(C,L){const O=this.length;C=~~C,L=L===void 0?O:~~L,C<0?(C+=O,C<0&&(C=0)):C>O&&(C=O),L<0?(L+=O,L<0&&(L=0)):L>O&&(L=O),L<C&&(L=C);const j=this.subarray(C,L);return Object.setPrototypeOf(j,a.prototype),j};function Ne(A,C,L){if(A%1!==0||A<0)throw new RangeError("offset is not uint");if(A+C>L)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,L,O){C=C>>>0,L=L>>>0,O||Ne(C,L,this.length);let j=this[C],Z=1,ce=0;for(;++ce<L&&(Z*=256);)j+=this[C+ce]*Z;return j},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,L,O){C=C>>>0,L=L>>>0,O||Ne(C,L,this.length);let j=this[C+--L],Z=1;for(;L>0&&(Z*=256);)j+=this[C+--L]*Z;return j},a.prototype.readUint8=a.prototype.readUInt8=function(C,L){return C=C>>>0,L||Ne(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,L){return C=C>>>0,L||Ne(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,L){return C=C>>>0,L||Ne(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readBigUInt64LE=K(function(C){C=C>>>0,pe(C,"offset");const L=this[C],O=this[C+7];(L===void 0||O===void 0)&&ke(C,this.length-8);const j=L+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24,Z=this[++C]+this[++C]*2**8+this[++C]*2**16+O*2**24;return BigInt(j)+(BigInt(Z)<<BigInt(32))}),a.prototype.readBigUInt64BE=K(function(C){C=C>>>0,pe(C,"offset");const L=this[C],O=this[C+7];(L===void 0||O===void 0)&&ke(C,this.length-8);const j=L*2**24+this[++C]*2**16+this[++C]*2**8+this[++C],Z=this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+O;return(BigInt(j)<<BigInt(32))+BigInt(Z)}),a.prototype.readIntLE=function(C,L,O){C=C>>>0,L=L>>>0,O||Ne(C,L,this.length);let j=this[C],Z=1,ce=0;for(;++ce<L&&(Z*=256);)j+=this[C+ce]*Z;return Z*=128,j>=Z&&(j-=Math.pow(2,8*L)),j},a.prototype.readIntBE=function(C,L,O){C=C>>>0,L=L>>>0,O||Ne(C,L,this.length);let j=L,Z=1,ce=this[C+--j];for(;j>0&&(Z*=256);)ce+=this[C+--j]*Z;return Z*=128,ce>=Z&&(ce-=Math.pow(2,8*L)),ce},a.prototype.readInt8=function(C,L){return C=C>>>0,L||Ne(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,L){C=C>>>0,L||Ne(C,2,this.length);const O=this[C]|this[C+1]<<8;return O&32768?O|4294901760:O},a.prototype.readInt16BE=function(C,L){C=C>>>0,L||Ne(C,2,this.length);const O=this[C+1]|this[C]<<8;return O&32768?O|4294901760:O},a.prototype.readInt32LE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readBigInt64LE=K(function(C){C=C>>>0,pe(C,"offset");const L=this[C],O=this[C+7];(L===void 0||O===void 0)&&ke(C,this.length-8);const j=this[C+4]+this[C+5]*2**8+this[C+6]*2**16+(O<<24);return(BigInt(j)<<BigInt(32))+BigInt(L+this[++C]*2**8+this[++C]*2**16+this[++C]*2**24)}),a.prototype.readBigInt64BE=K(function(C){C=C>>>0,pe(C,"offset");const L=this[C],O=this[C+7];(L===void 0||O===void 0)&&ke(C,this.length-8);const j=(L<<24)+this[++C]*2**16+this[++C]*2**8+this[++C];return(BigInt(j)<<BigInt(32))+BigInt(this[++C]*2**24+this[++C]*2**16+this[++C]*2**8+O)}),a.prototype.readFloatLE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),t.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,L){return C=C>>>0,L||Ne(C,4,this.length),t.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,L){return C=C>>>0,L||Ne(C,8,this.length),t.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,L){return C=C>>>0,L||Ne(C,8,this.length),t.read(this,C,!1,52,8)};function xe(A,C,L,O,j,Z){if(!a.isBuffer(A))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>j||C<Z)throw new RangeError('"value" argument is out of bounds');if(L+O>A.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,L,O,j){if(C=+C,L=L>>>0,O=O>>>0,!j){const Ue=Math.pow(2,8*O)-1;xe(this,C,L,O,Ue,0)}let Z=1,ce=0;for(this[L]=C&255;++ce<O&&(Z*=256);)this[L+ce]=C/Z&255;return L+O},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,L,O,j){if(C=+C,L=L>>>0,O=O>>>0,!j){const Ue=Math.pow(2,8*O)-1;xe(this,C,L,O,Ue,0)}let Z=O-1,ce=1;for(this[L+Z]=C&255;--Z>=0&&(ce*=256);)this[L+Z]=C/ce&255;return L+O},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,1,255,0),this[L]=C&255,L+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,2,65535,0),this[L]=C&255,this[L+1]=C>>>8,L+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,2,65535,0),this[L]=C>>>8,this[L+1]=C&255,L+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,4,4294967295,0),this[L+3]=C>>>24,this[L+2]=C>>>16,this[L+1]=C>>>8,this[L]=C&255,L+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,4,4294967295,0),this[L]=C>>>24,this[L+1]=C>>>16,this[L+2]=C>>>8,this[L+3]=C&255,L+4};function fe(A,C,L,O,j){M(C,O,j,A,L,7);let Z=Number(C&BigInt(4294967295));A[L++]=Z,Z=Z>>8,A[L++]=Z,Z=Z>>8,A[L++]=Z,Z=Z>>8,A[L++]=Z;let ce=Number(C>>BigInt(32)&BigInt(4294967295));return A[L++]=ce,ce=ce>>8,A[L++]=ce,ce=ce>>8,A[L++]=ce,ce=ce>>8,A[L++]=ce,L}function jt(A,C,L,O,j){M(C,O,j,A,L,7);let Z=Number(C&BigInt(4294967295));A[L+7]=Z,Z=Z>>8,A[L+6]=Z,Z=Z>>8,A[L+5]=Z,Z=Z>>8,A[L+4]=Z;let ce=Number(C>>BigInt(32)&BigInt(4294967295));return A[L+3]=ce,ce=ce>>8,A[L+2]=ce,ce=ce>>8,A[L+1]=ce,ce=ce>>8,A[L]=ce,L+8}a.prototype.writeBigUInt64LE=K(function(C,L=0){return fe(this,C,L,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=K(function(C,L=0){return jt(this,C,L,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(C,L,O,j){if(C=+C,L=L>>>0,!j){const Re=Math.pow(2,8*O-1);xe(this,C,L,O,Re-1,-Re)}let Z=0,ce=1,Ue=0;for(this[L]=C&255;++Z<O&&(ce*=256);)C<0&&Ue===0&&this[L+Z-1]!==0&&(Ue=1),this[L+Z]=(C/ce>>0)-Ue&255;return L+O},a.prototype.writeIntBE=function(C,L,O,j){if(C=+C,L=L>>>0,!j){const Re=Math.pow(2,8*O-1);xe(this,C,L,O,Re-1,-Re)}let Z=O-1,ce=1,Ue=0;for(this[L+Z]=C&255;--Z>=0&&(ce*=256);)C<0&&Ue===0&&this[L+Z+1]!==0&&(Ue=1),this[L+Z]=(C/ce>>0)-Ue&255;return L+O},a.prototype.writeInt8=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,1,127,-128),C<0&&(C=255+C+1),this[L]=C&255,L+1},a.prototype.writeInt16LE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,2,32767,-32768),this[L]=C&255,this[L+1]=C>>>8,L+2},a.prototype.writeInt16BE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,2,32767,-32768),this[L]=C>>>8,this[L+1]=C&255,L+2},a.prototype.writeInt32LE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,4,2147483647,-2147483648),this[L]=C&255,this[L+1]=C>>>8,this[L+2]=C>>>16,this[L+3]=C>>>24,L+4},a.prototype.writeInt32BE=function(C,L,O){return C=+C,L=L>>>0,O||xe(this,C,L,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[L]=C>>>24,this[L+1]=C>>>16,this[L+2]=C>>>8,this[L+3]=C&255,L+4},a.prototype.writeBigInt64LE=K(function(C,L=0){return fe(this,C,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=K(function(C,L=0){return jt(this,C,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mi(A,C,L,O,j,Z){if(L+O>A.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("Index out of range")}function re(A,C,L,O,j){return C=+C,L=L>>>0,j||mi(A,C,L,4),t.write(A,C,L,O,23,4),L+4}a.prototype.writeFloatLE=function(C,L,O){return re(this,C,L,!0,O)},a.prototype.writeFloatBE=function(C,L,O){return re(this,C,L,!1,O)};function te(A,C,L,O,j){return C=+C,L=L>>>0,j||mi(A,C,L,8),t.write(A,C,L,O,52,8),L+8}a.prototype.writeDoubleLE=function(C,L,O){return te(this,C,L,!0,O)},a.prototype.writeDoubleBE=function(C,L,O){return te(this,C,L,!1,O)},a.prototype.copy=function(C,L,O,j){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(O||(O=0),!j&&j!==0&&(j=this.length),L>=C.length&&(L=C.length),L||(L=0),j>0&&j<O&&(j=O),j===O||C.length===0||this.length===0)return 0;if(L<0)throw new RangeError("targetStart out of bounds");if(O<0||O>=this.length)throw new RangeError("Index out of range");if(j<0)throw new RangeError("sourceEnd out of bounds");j>this.length&&(j=this.length),C.length-L<j-O&&(j=C.length-L+O);const Z=j-O;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(L,O,j):Uint8Array.prototype.set.call(C,this.subarray(O,j),L),Z},a.prototype.fill=function(C,L,O,j){if(typeof C=="string"){if(typeof L=="string"?(j=L,L=0,O=this.length):typeof O=="string"&&(j=O,O=this.length),j!==void 0&&typeof j!="string")throw new TypeError("encoding must be a string");if(typeof j=="string"&&!a.isEncoding(j))throw new TypeError("Unknown encoding: "+j);if(C.length===1){const ce=C.charCodeAt(0);(j==="utf8"&&ce<128||j==="latin1")&&(C=ce)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(L<0||this.length<L||this.length<O)throw new RangeError("Out of range index");if(O<=L)return this;L=L>>>0,O=O===void 0?this.length:O>>>0,C||(C=0);let Z;if(typeof C=="number")for(Z=L;Z<O;++Z)this[Z]=C;else{const ce=a.isBuffer(C)?C:a.from(C,j),Ue=ce.length;if(Ue===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(Z=0;Z<O-L;++Z)this[Z+L]=ce[Z%Ue]}return this};const ye={};function _e(A,C,L){ye[A]=class extends L{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${A}]`,this.stack,delete this.name}get code(){return A}set code(j){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:j,writable:!0})}toString(){return`${this.name} [${A}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(A){return A?`${A} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_e("ERR_INVALID_ARG_TYPE",function(A,C){return`The "${A}" argument must be of type number. Received type ${typeof C}`},TypeError),_e("ERR_OUT_OF_RANGE",function(A,C,L){let O=`The value of "${A}" is out of range.`,j=L;return Number.isInteger(L)&&Math.abs(L)>2**32?j=Ie(String(L)):typeof L=="bigint"&&(j=String(L),(L>BigInt(2)**BigInt(32)||L<-(BigInt(2)**BigInt(32)))&&(j=Ie(j)),j+="n"),O+=` It must be ${C}. Received ${j}`,O},RangeError);function Ie(A){let C="",L=A.length;const O=A[0]==="-"?1:0;for(;L>=O+4;L-=3)C=`_${A.slice(L-3,L)}${C}`;return`${A.slice(0,L)}${C}`}function F(A,C,L){pe(C,"offset"),(A[C]===void 0||A[C+L]===void 0)&&ke(C,A.length-(L+1))}function M(A,C,L,O,j,Z){if(A>L||A<C){const ce=typeof C=="bigint"?"n":"";let Ue;throw Z>3?C===0||C===BigInt(0)?Ue=`>= 0${ce} and < 2${ce} ** ${(Z+1)*8}${ce}`:Ue=`>= -(2${ce} ** ${(Z+1)*8-1}${ce}) and < 2 ** ${(Z+1)*8-1}${ce}`:Ue=`>= ${C}${ce} and <= ${L}${ce}`,new ye.ERR_OUT_OF_RANGE("value",Ue,A)}F(O,j,Z)}function pe(A,C){if(typeof A!="number")throw new ye.ERR_INVALID_ARG_TYPE(C,"number",A)}function ke(A,C,L){throw Math.floor(A)!==A?(pe(A,L),new ye.ERR_OUT_OF_RANGE(L||"offset","an integer",A)):C<0?new ye.ERR_BUFFER_OUT_OF_BOUNDS:new ye.ERR_OUT_OF_RANGE(L||"offset",`>= ${L?1:0} and <= ${C}`,A)}const et=/[^+/0-9A-Za-z-_]/g;function Xe(A){if(A=A.split("=")[0],A=A.trim().replace(et,""),A.length<2)return"";for(;A.length%4!==0;)A=A+"=";return A}function Nt(A,C){C=C||1/0;let L;const O=A.length;let j=null;const Z=[];for(let ce=0;ce<O;++ce){if(L=A.charCodeAt(ce),L>55295&&L<57344){if(!j){if(L>56319){(C-=3)>-1&&Z.push(239,191,189);continue}else if(ce+1===O){(C-=3)>-1&&Z.push(239,191,189);continue}j=L;continue}if(L<56320){(C-=3)>-1&&Z.push(239,191,189),j=L;continue}L=(j-55296<<10|L-56320)+65536}else j&&(C-=3)>-1&&Z.push(239,191,189);if(j=null,L<128){if((C-=1)<0)break;Z.push(L)}else if(L<2048){if((C-=2)<0)break;Z.push(L>>6|192,L&63|128)}else if(L<65536){if((C-=3)<0)break;Z.push(L>>12|224,L>>6&63|128,L&63|128)}else if(L<1114112){if((C-=4)<0)break;Z.push(L>>18|240,L>>12&63|128,L>>6&63|128,L&63|128)}else throw new Error("Invalid code point")}return Z}function is(A){const C=[];for(let L=0;L<A.length;++L)C.push(A.charCodeAt(L)&255);return C}function Zo(A,C){let L,O,j;const Z=[];for(let ce=0;ce<A.length&&!((C-=2)<0);++ce)L=A.charCodeAt(ce),O=L>>8,j=L%256,Z.push(j),Z.push(O);return Z}function le(A){return e.toByteArray(Xe(A))}function ie(A,C,L,O){let j;for(j=0;j<O&&!(j+L>=C.length||j>=A.length);++j)C[j+L]=A[j];return j}function Q(A,C){return A instanceof C||A!=null&&A.constructor!=null&&A.constructor.name!=null&&A.constructor.name===C.name}function R(A){return A!==A}const W=function(){const A="0123456789abcdef",C=new Array(256);for(let L=0;L<16;++L){const O=L*16;for(let j=0;j<16;++j)C[O+j]=A[L]+A[j]}return C}();function K(A){return typeof BigInt>"u"?U:A}function U(){throw new Error("BigInt not supported")}})(zs);const No={},$we=Object.freeze(Object.defineProperty({__proto__:null,default:No},Symbol.toStringTag,{value:"Module"})),_I=typeof window<"u"?window:typeof self<"u"?self:{fetch:void 0};class fc{async getBufferFromResponse(e){if(typeof e.buffer=="function")return e.buffer();if(typeof e.arrayBuffer=="function"){const t=await e.arrayBuffer();return zs.Buffer.from(t)}else throw new TypeError("invalid HTTP response object, has no buffer method, and no arrayBuffer method")}constructor(e,t={}){this.baseOverrides={},this.url=e;const i=t.fetch||_I.fetch&&_I.fetch.bind(_I);if(!i)throw new TypeError("no fetch function supplied, and none found in globalThis environment");t.overrides&&(this.baseOverrides=t.overrides),this.fetchImplementation=i}async fetch(e,t){let i;try{i=await this.fetchImplementation(e,t)}catch(s){if(`${s}`.includes("Failed to fetch"))console.warn(`generic-filehandle: refetching ${e} to attempt to work around chrome CORS header caching bug`),i=await this.fetchImplementation(e,{...t,cache:"reload"});else throw s}return i}async read(e,t=0,i,s=0,r={}){const{headers:o={},signal:a,overrides:l={}}=r;i<1/0?o.range=`bytes=${s}-${s+i}`:i===1/0&&s!==0&&(o.range=`bytes=${s}-`);const c={...this.baseOverrides,...l,headers:{...o,...l.headers,...this.baseOverrides.headers},method:"GET",redirect:"follow",mode:"cors",signal:a},u=await this.fetch(this.url,c);if(!u.ok)throw new Error(`HTTP ${u.status} ${u.statusText} ${this.url}`);if(u.status===200&&s===0||u.status===206){const h=await this.getBufferFromResponse(u),d=h.copy(e,t,0,Math.min(i,h.length)),f=u.headers.get("content-range"),g=/\/(\d+)$/.exec(f||"");return g&&g[1]&&(this._stat={size:parseInt(g[1],10)}),{bytesRead:d,buffer:e}}throw u.status===200?new Error("${this.url} fetch returned status 200, expected 206"):new Error(`HTTP ${u.status} fetching ${this.url}`)}async readFile(e={}){let t,i;typeof e=="string"?(t=e,i={}):(t=e.encoding,i=e,delete i.encoding);const{headers:s={},signal:r,overrides:o={}}=i,a={headers:s,method:"GET",redirect:"follow",mode:"cors",signal:r,...this.baseOverrides,...o},l=await this.fetch(this.url,a);if(!l)throw new Error("generic-filehandle failed to fetch");if(l.status!==200)throw Object.assign(new Error(`HTTP ${l.status} fetching ${this.url}`),{status:l.status});if(t==="utf8")return l.text();if(t)throw new Error(`unsupported encoding: ${t}`);return this.getBufferFromResponse(l)}async stat(){if(!this._stat){const e=zs.Buffer.allocUnsafe(10);if(await this.read(e,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}async close(){}}var rh={};(function(n){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function t(r,o){return Object.prototype.hasOwnProperty.call(r,o)}n.assign=function(r){for(var o=Array.prototype.slice.call(arguments,1);o.length;){var a=o.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(var l in a)t(a,l)&&(r[l]=a[l])}}return r},n.shrinkBuf=function(r,o){return r.length===o?r:r.subarray?r.subarray(0,o):(r.length=o,r)};var i={arraySet:function(r,o,a,l,c){if(o.subarray&&r.subarray){r.set(o.subarray(a,a+l),c);return}for(var u=0;u<l;u++)r[c+u]=o[a+u]},flattenChunks:function(r){var o,a,l,c,u,h;for(l=0,o=0,a=r.length;o<a;o++)l+=r[o].length;for(h=new Uint8Array(l),c=0,o=0,a=r.length;o<a;o++)u=r[o],h.set(u,c),c+=u.length;return h}},s={arraySet:function(r,o,a,l,c){for(var u=0;u<l;u++)r[c+u]=o[a+u]},flattenChunks:function(r){return[].concat.apply([],r)}};n.setTyped=function(r){r?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(e)})(rh);var ZC={},zc={},Rb={},zwe=rh,Hwe=4,eV=0,tV=1,Uwe=2;function Mb(n){for(var e=n.length;--e>=0;)n[e]=0}var jwe=0,PQ=1,qwe=2,Gwe=3,Kwe=258,d6=29,YC=256,zw=YC+1+d6,O0=30,f6=19,OQ=2*zw+1,vg=15,bI=16,Zwe=7,g6=256,BQ=16,WQ=17,VQ=18,n4=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M2=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ywe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],$Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Xwe=512,pu=new Array((zw+2)*2);Mb(pu);var Rv=new Array(O0*2);Mb(Rv);var Hw=new Array(Xwe);Mb(Hw);var Uw=new Array(Kwe-Gwe+1);Mb(Uw);var p6=new Array(d6);Mb(p6);var sL=new Array(O0);Mb(sL);function vI(n,e,t,i,s){this.static_tree=n,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=s,this.has_stree=n&&n.length}var zQ,HQ,UQ;function wI(n,e){this.dyn_tree=n,this.max_code=0,this.stat_desc=e}function jQ(n){return n<256?Hw[n]:Hw[256+(n>>>7)]}function jw(n,e){n.pending_buf[n.pending++]=e&255,n.pending_buf[n.pending++]=e>>>8&255}function so(n,e,t){n.bi_valid>bI-t?(n.bi_buf|=e<<n.bi_valid&65535,jw(n,n.bi_buf),n.bi_buf=e>>bI-n.bi_valid,n.bi_valid+=t-bI):(n.bi_buf|=e<<n.bi_valid&65535,n.bi_valid+=t)}function tc(n,e,t){so(n,t[e*2],t[e*2+1])}function qQ(n,e){var t=0;do t|=n&1,n>>>=1,t<<=1;while(--e>0);return t>>>1}function Qwe(n){n.bi_valid===16?(jw(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)}function Jwe(n,e){var t=e.dyn_tree,i=e.max_code,s=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,u,h,d,f,g,p=0;for(d=0;d<=vg;d++)n.bl_count[d]=0;for(t[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<OQ;c++)u=n.heap[c],d=t[t[u*2+1]*2+1]+1,d>l&&(d=l,p++),t[u*2+1]=d,!(u>i)&&(n.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),g=t[u*2],n.opt_len+=g*(d+f),r&&(n.static_len+=g*(s[u*2+1]+f)));if(p!==0){do{for(d=l-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[l]--,p-=2}while(p>0);for(d=l;d!==0;d--)for(u=n.bl_count[d];u!==0;)h=n.heap[--c],!(h>i)&&(t[h*2+1]!==d&&(n.opt_len+=(d-t[h*2+1])*t[h*2],t[h*2+1]=d),u--)}}function GQ(n,e,t){var i=new Array(vg+1),s=0,r,o;for(r=1;r<=vg;r++)i[r]=s=s+t[r-1]<<1;for(o=0;o<=e;o++){var a=n[o*2+1];a!==0&&(n[o*2]=qQ(i[a]++,a))}}function eye(){var n,e,t,i,s,r=new Array(vg+1);for(t=0,i=0;i<d6-1;i++)for(p6[i]=t,n=0;n<1<<n4[i];n++)Uw[t++]=i;for(Uw[t-1]=i,s=0,i=0;i<16;i++)for(sL[i]=s,n=0;n<1<<M2[i];n++)Hw[s++]=i;for(s>>=7;i<O0;i++)for(sL[i]=s<<7,n=0;n<1<<M2[i]-7;n++)Hw[256+s++]=i;for(e=0;e<=vg;e++)r[e]=0;for(n=0;n<=143;)pu[n*2+1]=8,n++,r[8]++;for(;n<=255;)pu[n*2+1]=9,n++,r[9]++;for(;n<=279;)pu[n*2+1]=7,n++,r[7]++;for(;n<=287;)pu[n*2+1]=8,n++,r[8]++;for(GQ(pu,zw+1,r),n=0;n<O0;n++)Rv[n*2+1]=5,Rv[n*2]=qQ(n,5);zQ=new vI(pu,n4,YC+1,zw,vg),HQ=new vI(Rv,M2,0,O0,vg),UQ=new vI(new Array(0),Ywe,0,f6,Zwe)}function KQ(n){var e;for(e=0;e<zw;e++)n.dyn_ltree[e*2]=0;for(e=0;e<O0;e++)n.dyn_dtree[e*2]=0;for(e=0;e<f6;e++)n.bl_tree[e*2]=0;n.dyn_ltree[g6*2]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0}function ZQ(n){n.bi_valid>8?jw(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0}function tye(n,e,t,i){ZQ(n),i&&(jw(n,t),jw(n,~t)),zwe.arraySet(n.pending_buf,n.window,e,t,n.pending),n.pending+=t}function iV(n,e,t,i){var s=e*2,r=t*2;return n[s]<n[r]||n[s]===n[r]&&i[e]<=i[t]}function yI(n,e,t){for(var i=n.heap[t],s=t<<1;s<=n.heap_len&&(s<n.heap_len&&iV(e,n.heap[s+1],n.heap[s],n.depth)&&s++,!iV(e,i,n.heap[s],n.depth));)n.heap[t]=n.heap[s],t=s,s<<=1;n.heap[t]=i}function nV(n,e,t){var i,s,r=0,o,a;if(n.last_lit!==0)do i=n.pending_buf[n.d_buf+r*2]<<8|n.pending_buf[n.d_buf+r*2+1],s=n.pending_buf[n.l_buf+r],r++,i===0?tc(n,s,e):(o=Uw[s],tc(n,o+YC+1,e),a=n4[o],a!==0&&(s-=p6[o],so(n,s,a)),i--,o=jQ(i),tc(n,o,t),a=M2[o],a!==0&&(i-=sL[o],so(n,i,a)));while(r<n.last_lit);tc(n,g6,e)}function s4(n,e){var t=e.dyn_tree,i=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.elems,o,a,l=-1,c;for(n.heap_len=0,n.heap_max=OQ,o=0;o<r;o++)t[o*2]!==0?(n.heap[++n.heap_len]=l=o,n.depth[o]=0):t[o*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,t[c*2]=1,n.depth[c]=0,n.opt_len--,s&&(n.static_len-=i[c*2+1]);for(e.max_code=l,o=n.heap_len>>1;o>=1;o--)yI(n,t,o);c=r;do o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],yI(n,t,1),a=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=a,t[c*2]=t[o*2]+t[a*2],n.depth[c]=(n.depth[o]>=n.depth[a]?n.depth[o]:n.depth[a])+1,t[o*2+1]=t[a*2+1]=c,n.heap[1]=c++,yI(n,t,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],Jwe(n,e),GQ(t,l,n.bl_count)}function sV(n,e,t){var i,s=-1,r,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)r=o,o=e[(i+1)*2+1],!(++a<l&&r===o)&&(a<c?n.bl_tree[r*2]+=a:r!==0?(r!==s&&n.bl_tree[r*2]++,n.bl_tree[BQ*2]++):a<=10?n.bl_tree[WQ*2]++:n.bl_tree[VQ*2]++,a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))}function rV(n,e,t){var i,s=-1,r,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=t;i++)if(r=o,o=e[(i+1)*2+1],!(++a<l&&r===o)){if(a<c)do tc(n,r,n.bl_tree);while(--a!==0);else r!==0?(r!==s&&(tc(n,r,n.bl_tree),a--),tc(n,BQ,n.bl_tree),so(n,a-3,2)):a<=10?(tc(n,WQ,n.bl_tree),so(n,a-3,3)):(tc(n,VQ,n.bl_tree),so(n,a-11,7));a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}}function iye(n){var e;for(sV(n,n.dyn_ltree,n.l_desc.max_code),sV(n,n.dyn_dtree,n.d_desc.max_code),s4(n,n.bl_desc),e=f6-1;e>=3&&n.bl_tree[$Q[e]*2+1]===0;e--);return n.opt_len+=3*(e+1)+5+5+4,e}function nye(n,e,t,i){var s;for(so(n,e-257,5),so(n,t-1,5),so(n,i-4,4),s=0;s<i;s++)so(n,n.bl_tree[$Q[s]*2+1],3);rV(n,n.dyn_ltree,e-1),rV(n,n.dyn_dtree,t-1)}function sye(n){var e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&n.dyn_ltree[t*2]!==0)return eV;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return tV;for(t=32;t<YC;t++)if(n.dyn_ltree[t*2]!==0)return tV;return eV}var oV=!1;function rye(n){oV||(eye(),oV=!0),n.l_desc=new wI(n.dyn_ltree,zQ),n.d_desc=new wI(n.dyn_dtree,HQ),n.bl_desc=new wI(n.bl_tree,UQ),n.bi_buf=0,n.bi_valid=0,KQ(n)}function YQ(n,e,t,i){so(n,(jwe<<1)+(i?1:0),3),tye(n,e,t,!0)}function oye(n){so(n,PQ<<1,3),tc(n,g6,pu),Qwe(n)}function aye(n,e,t,i){var s,r,o=0;n.level>0?(n.strm.data_type===Uwe&&(n.strm.data_type=sye(n)),s4(n,n.l_desc),s4(n,n.d_desc),o=iye(n),s=n.opt_len+3+7>>>3,r=n.static_len+3+7>>>3,r<=s&&(s=r)):s=r=t+5,t+4<=s&&e!==-1?YQ(n,e,t,i):n.strategy===Hwe||r===s?(so(n,(PQ<<1)+(i?1:0),3),nV(n,pu,Rv)):(so(n,(qwe<<1)+(i?1:0),3),nye(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),nV(n,n.dyn_ltree,n.dyn_dtree)),KQ(n),i&&ZQ(n)}function lye(n,e,t){return n.pending_buf[n.d_buf+n.last_lit*2]=e>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=e&255,n.pending_buf[n.l_buf+n.last_lit]=t&255,n.last_lit++,e===0?n.dyn_ltree[t*2]++:(n.matches++,e--,n.dyn_ltree[(Uw[t]+YC+1)*2]++,n.dyn_dtree[jQ(e)*2]++),n.last_lit===n.lit_bufsize-1}Rb._tr_init=rye;Rb._tr_stored_block=YQ;Rb._tr_flush_block=aye;Rb._tr_tally=lye;Rb._tr_align=oye;function cye(n,e,t,i){for(var s=n&65535|0,r=n>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do s=s+e[i++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0}var XQ=cye;function uye(){for(var n,e=[],t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e}var hye=uye();function dye(n,e,t,i){var s=hye,r=i+t;n^=-1;for(var o=i;o<r;o++)n=n>>>8^s[(n^e[o])&255];return n^-1}var QQ=dye,m6={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ar=rh,ya=Rb,JQ=XQ,Eh=QQ,fye=m6,jp=0,gye=1,pye=3,wd=4,aV=5,ic=0,lV=1,Ca=-2,mye=-3,CI=-5,_ye=-1,bye=1,tx=2,vye=3,wye=4,yye=0,Cye=2,QE=8,Sye=9,xye=15,kye=8,Lye=29,Dye=256,r4=Dye+1+Lye,Eye=30,Tye=19,Aye=2*r4+1,Iye=15,Yt=3,ed=258,gl=ed+Yt+1,Nye=32,JE=42,o4=69,F2=73,P2=91,O2=103,wg=113,Z1=666,cs=1,XC=2,gp=3,Fb=4,Rye=3;function td(n,e){return n.msg=fye[e],e}function cV(n){return(n<<1)-(n>4?9:0)}function jh(n){for(var e=n.length;--e>=0;)n[e]=0}function Th(n){var e=n.state,t=e.pending;t>n.avail_out&&(t=n.avail_out),t!==0&&(Ar.arraySet(n.output,e.pending_buf,e.pending_out,t,n.next_out),n.next_out+=t,e.pending_out+=t,n.total_out+=t,n.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function Hs(n,e){ya._tr_flush_block(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,e),n.block_start=n.strstart,Th(n.strm)}function hi(n,e){n.pending_buf[n.pending++]=e}function p1(n,e){n.pending_buf[n.pending++]=e>>>8&255,n.pending_buf[n.pending++]=e&255}function Mye(n,e,t,i){var s=n.avail_in;return s>i&&(s=i),s===0?0:(n.avail_in-=s,Ar.arraySet(e,n.input,n.next_in,s,t),n.state.wrap===1?n.adler=JQ(n.adler,e,s,t):n.state.wrap===2&&(n.adler=Eh(n.adler,e,s,t)),n.next_in+=s,n.total_in+=s,s)}function eJ(n,e){var t=n.max_chain_length,i=n.strstart,s,r,o=n.prev_length,a=n.nice_match,l=n.strstart>n.w_size-gl?n.strstart-(n.w_size-gl):0,c=n.window,u=n.w_mask,h=n.prev,d=n.strstart+ed,f=c[i+o-1],g=c[i+o];n.prev_length>=n.good_match&&(t>>=2),a>n.lookahead&&(a=n.lookahead);do if(s=e,!(c[s+o]!==g||c[s+o-1]!==f||c[s]!==c[i]||c[++s]!==c[i+1])){i+=2,s++;do;while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<d);if(r=ed-(d-i),i=d-ed,r>o){if(n.match_start=e,o=r,r>=a)break;f=c[i+o-1],g=c[i+o]}}while((e=h[e&u])>l&&--t!==0);return o<=n.lookahead?o:n.lookahead}function pp(n){var e=n.w_size,t,i,s,r,o;do{if(r=n.window_size-n.lookahead-n.strstart,n.strstart>=e+(e-gl)){Ar.arraySet(n.window,n.window,e,e,0),n.match_start-=e,n.strstart-=e,n.block_start-=e,i=n.hash_size,t=i;do s=n.head[--t],n.head[t]=s>=e?s-e:0;while(--i);i=e,t=i;do s=n.prev[--t],n.prev[t]=s>=e?s-e:0;while(--i);r+=e}if(n.strm.avail_in===0)break;if(i=Mye(n.strm,n.window,n.strstart+n.lookahead,r),n.lookahead+=i,n.lookahead+n.insert>=Yt)for(o=n.strstart-n.insert,n.ins_h=n.window[o],n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+Yt-1])&n.hash_mask,n.prev[o&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=o,o++,n.insert--,!(n.lookahead+n.insert<Yt)););}while(n.lookahead<gl&&n.strm.avail_in!==0)}function Fye(n,e){var t=65535;for(t>n.pending_buf_size-5&&(t=n.pending_buf_size-5);;){if(n.lookahead<=1){if(pp(n),n.lookahead===0&&e===jp)return cs;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var i=n.block_start+t;if((n.strstart===0||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,Hs(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-gl&&(Hs(n,!1),n.strm.avail_out===0))return cs}return n.insert=0,e===wd?(Hs(n,!0),n.strm.avail_out===0?gp:Fb):(n.strstart>n.block_start&&(Hs(n,!1),n.strm.avail_out===0),cs)}function SI(n,e){for(var t,i;;){if(n.lookahead<gl){if(pp(n),n.lookahead<gl&&e===jp)return cs;if(n.lookahead===0)break}if(t=0,n.lookahead>=Yt&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Yt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),t!==0&&n.strstart-t<=n.w_size-gl&&(n.match_length=eJ(n,t)),n.match_length>=Yt)if(i=ya._tr_tally(n,n.strstart-n.match_start,n.match_length-Yt),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Yt){n.match_length--;do n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Yt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else i=ya._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(Hs(n,!1),n.strm.avail_out===0))return cs}return n.insert=n.strstart<Yt-1?n.strstart:Yt-1,e===wd?(Hs(n,!0),n.strm.avail_out===0?gp:Fb):n.last_lit&&(Hs(n,!1),n.strm.avail_out===0)?cs:XC}function Tm(n,e){for(var t,i,s;;){if(n.lookahead<gl){if(pp(n),n.lookahead<gl&&e===jp)return cs;if(n.lookahead===0)break}if(t=0,n.lookahead>=Yt&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Yt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Yt-1,t!==0&&n.prev_length<n.max_lazy_match&&n.strstart-t<=n.w_size-gl&&(n.match_length=eJ(n,t),n.match_length<=5&&(n.strategy===bye||n.match_length===Yt&&n.strstart-n.match_start>4096)&&(n.match_length=Yt-1)),n.prev_length>=Yt&&n.match_length<=n.prev_length){s=n.strstart+n.lookahead-Yt,i=ya._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-Yt),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=s&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Yt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=Yt-1,n.strstart++,i&&(Hs(n,!1),n.strm.avail_out===0))return cs}else if(n.match_available){if(i=ya._tr_tally(n,0,n.window[n.strstart-1]),i&&Hs(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return cs}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=ya._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Yt-1?n.strstart:Yt-1,e===wd?(Hs(n,!0),n.strm.avail_out===0?gp:Fb):n.last_lit&&(Hs(n,!1),n.strm.avail_out===0)?cs:XC}function Pye(n,e){for(var t,i,s,r,o=n.window;;){if(n.lookahead<=ed){if(pp(n),n.lookahead<=ed&&e===jp)return cs;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=Yt&&n.strstart>0&&(s=n.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){r=n.strstart+ed;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<r);n.match_length=ed-(r-s),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=Yt?(t=ya._tr_tally(n,1,n.match_length-Yt),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(t=ya._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),t&&(Hs(n,!1),n.strm.avail_out===0))return cs}return n.insert=0,e===wd?(Hs(n,!0),n.strm.avail_out===0?gp:Fb):n.last_lit&&(Hs(n,!1),n.strm.avail_out===0)?cs:XC}function Oye(n,e){for(var t;;){if(n.lookahead===0&&(pp(n),n.lookahead===0)){if(e===jp)return cs;break}if(n.match_length=0,t=ya._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,t&&(Hs(n,!1),n.strm.avail_out===0))return cs}return n.insert=0,e===wd?(Hs(n,!0),n.strm.avail_out===0?gp:Fb):n.last_lit&&(Hs(n,!1),n.strm.avail_out===0)?cs:XC}function Wl(n,e,t,i,s){this.good_length=n,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=s}var s0;s0=[new Wl(0,0,0,0,Fye),new Wl(4,4,8,4,SI),new Wl(4,5,16,8,SI),new Wl(4,6,32,32,SI),new Wl(4,4,16,16,Tm),new Wl(8,16,32,32,Tm),new Wl(8,16,128,128,Tm),new Wl(8,32,128,256,Tm),new Wl(32,128,258,1024,Tm),new Wl(32,258,258,4096,Tm)];function Bye(n){n.window_size=2*n.w_size,jh(n.head),n.max_lazy_match=s0[n.level].max_lazy,n.good_match=s0[n.level].good_length,n.nice_match=s0[n.level].nice_length,n.max_chain_length=s0[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=Yt-1,n.match_available=0,n.ins_h=0}function Wye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=QE,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ar.Buf16(Aye*2),this.dyn_dtree=new Ar.Buf16((2*Eye+1)*2),this.bl_tree=new Ar.Buf16((2*Tye+1)*2),jh(this.dyn_ltree),jh(this.dyn_dtree),jh(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ar.Buf16(Iye+1),this.heap=new Ar.Buf16(2*r4+1),jh(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ar.Buf16(2*r4+1),jh(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tJ(n){var e;return!n||!n.state?td(n,Ca):(n.total_in=n.total_out=0,n.data_type=Cye,e=n.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?JE:wg,n.adler=e.wrap===2?0:1,e.last_flush=jp,ya._tr_init(e),ic)}function iJ(n){var e=tJ(n);return e===ic&&Bye(n.state),e}function Vye(n,e){return!n||!n.state||n.state.wrap!==2?Ca:(n.state.gzhead=e,ic)}function nJ(n,e,t,i,s,r){if(!n)return Ca;var o=1;if(e===_ye&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>Sye||t!==QE||i<8||i>15||e<0||e>9||r<0||r>wye)return td(n,Ca);i===8&&(i=9);var a=new Wye;return n.state=a,a.strm=n,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Yt-1)/Yt),a.window=new Ar.Buf8(a.w_size*2),a.head=new Ar.Buf16(a.hash_size),a.prev=new Ar.Buf16(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Ar.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=r,a.method=t,iJ(n)}function $ye(n,e){return nJ(n,e,QE,xye,kye,yye)}function zye(n,e){var t,i,s,r;if(!n||!n.state||e>aV||e<0)return n?td(n,Ca):Ca;if(i=n.state,!n.output||!n.input&&n.avail_in!==0||i.status===Z1&&e!==wd)return td(n,n.avail_out===0?CI:Ca);if(i.strm=n,t=i.last_flush,i.last_flush=e,i.status===JE)if(i.wrap===2)n.adler=0,hi(i,31),hi(i,139),hi(i,8),i.gzhead?(hi(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),hi(i,i.gzhead.time&255),hi(i,i.gzhead.time>>8&255),hi(i,i.gzhead.time>>16&255),hi(i,i.gzhead.time>>24&255),hi(i,i.level===9?2:i.strategy>=tx||i.level<2?4:0),hi(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(hi(i,i.gzhead.extra.length&255),hi(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=Eh(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=o4):(hi(i,0),hi(i,0),hi(i,0),hi(i,0),hi(i,0),hi(i,i.level===9?2:i.strategy>=tx||i.level<2?4:0),hi(i,Rye),i.status=wg);else{var o=QE+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=tx||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=Nye),o+=31-o%31,i.status=wg,p1(i,o),i.strstart!==0&&(p1(i,n.adler>>>16),p1(i,n.adler&65535)),n.adler=1}if(i.status===o4)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),Th(n),s=i.pending,i.pending===i.pending_buf_size));)hi(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=F2)}else i.status=F2;if(i.status===F2)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),Th(n),s=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.name.length?r=i.gzhead.name.charCodeAt(i.gzindex++)&255:r=0,hi(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),r===0&&(i.gzindex=0,i.status=P2)}else i.status=P2;if(i.status===P2)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),Th(n),s=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.comment.length?r=i.gzhead.comment.charCodeAt(i.gzindex++)&255:r=0,hi(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>s&&(n.adler=Eh(n.adler,i.pending_buf,i.pending-s,s)),r===0&&(i.status=O2)}else i.status=O2;if(i.status===O2&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Th(n),i.pending+2<=i.pending_buf_size&&(hi(i,n.adler&255),hi(i,n.adler>>8&255),n.adler=0,i.status=wg)):i.status=wg),i.pending!==0){if(Th(n),n.avail_out===0)return i.last_flush=-1,ic}else if(n.avail_in===0&&cV(e)<=cV(t)&&e!==wd)return td(n,CI);if(i.status===Z1&&n.avail_in!==0)return td(n,CI);if(n.avail_in!==0||i.lookahead!==0||e!==jp&&i.status!==Z1){var l=i.strategy===tx?Oye(i,e):i.strategy===vye?Pye(i,e):s0[i.level].func(i,e);if((l===gp||l===Fb)&&(i.status=Z1),l===cs||l===gp)return n.avail_out===0&&(i.last_flush=-1),ic;if(l===XC&&(e===gye?ya._tr_align(i):e!==aV&&(ya._tr_stored_block(i,0,0,!1),e===pye&&(jh(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Th(n),n.avail_out===0))return i.last_flush=-1,ic}return e!==wd?ic:i.wrap<=0?lV:(i.wrap===2?(hi(i,n.adler&255),hi(i,n.adler>>8&255),hi(i,n.adler>>16&255),hi(i,n.adler>>24&255),hi(i,n.total_in&255),hi(i,n.total_in>>8&255),hi(i,n.total_in>>16&255),hi(i,n.total_in>>24&255)):(p1(i,n.adler>>>16),p1(i,n.adler&65535)),Th(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ic:lV)}function Hye(n){var e;return!n||!n.state?Ca:(e=n.state.status,e!==JE&&e!==o4&&e!==F2&&e!==P2&&e!==O2&&e!==wg&&e!==Z1?td(n,Ca):(n.state=null,e===wg?td(n,mye):ic))}function Uye(n,e){var t=e.length,i,s,r,o,a,l,c,u;if(!n||!n.state||(i=n.state,o=i.wrap,o===2||o===1&&i.status!==JE||i.lookahead))return Ca;for(o===1&&(n.adler=JQ(n.adler,e,t,0)),i.wrap=0,t>=i.w_size&&(o===0&&(jh(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new Ar.Buf8(i.w_size),Ar.arraySet(u,e,t-i.w_size,i.w_size,0),e=u,t=i.w_size),a=n.avail_in,l=n.next_in,c=n.input,n.avail_in=t,n.next_in=0,n.input=e,pp(i);i.lookahead>=Yt;){s=i.strstart,r=i.lookahead-(Yt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+Yt-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++;while(--r);i.strstart=s,i.lookahead=Yt-1,pp(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Yt-1,i.match_available=0,n.next_in=l,n.input=c,n.avail_in=a,i.wrap=o,ic}zc.deflateInit=$ye;zc.deflateInit2=nJ;zc.deflateReset=iJ;zc.deflateResetKeep=tJ;zc.deflateSetHeader=Vye;zc.deflate=zye;zc.deflateEnd=Hye;zc.deflateSetDictionary=Uye;zc.deflateInfo="pako deflate (from Nodeca project)";var qp={},eT=rh,sJ=!0,rJ=!0;try{String.fromCharCode.apply(null,[0])}catch{sJ=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rJ=!1}var qw=new eT.Buf8(256);for(var yh=0;yh<256;yh++)qw[yh]=yh>=252?6:yh>=248?5:yh>=240?4:yh>=224?3:yh>=192?2:1;qw[254]=qw[254]=1;qp.string2buf=function(n){var e,t,i,s,r,o=n.length,a=0;for(s=0;s<o;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<o&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new eT.Buf8(a),r=0,s=0;r<a;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<o&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),t<128?e[r++]=t:t<2048?(e[r++]=192|t>>>6,e[r++]=128|t&63):t<65536?(e[r++]=224|t>>>12,e[r++]=128|t>>>6&63,e[r++]=128|t&63):(e[r++]=240|t>>>18,e[r++]=128|t>>>12&63,e[r++]=128|t>>>6&63,e[r++]=128|t&63);return e};function oJ(n,e){if(e<65534&&(n.subarray&&rJ||!n.subarray&&sJ))return String.fromCharCode.apply(null,eT.shrinkBuf(n,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t}qp.buf2binstring=function(n){return oJ(n,n.length)};qp.binstring2buf=function(n){for(var e=new eT.Buf8(n.length),t=0,i=e.length;t<i;t++)e[t]=n.charCodeAt(t);return e};qp.buf2string=function(n,e){var t,i,s,r,o=e||n.length,a=new Array(o*2);for(i=0,t=0;t<o;){if(s=n[t++],s<128){a[i++]=s;continue}if(r=qw[s],r>4){a[i++]=65533,t+=r-1;continue}for(s&=r===2?31:r===3?15:7;r>1&&t<o;)s=s<<6|n[t++]&63,r--;if(r>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return oJ(a,i)};qp.utf8border=function(n,e){var t;for(e=e||n.length,e>n.length&&(e=n.length),t=e-1;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+qw[n[t]]>e?t:e};function jye(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var aJ=jye,Mv=zc,Fv=rh,a4=qp,l4=m6,qye=aJ,lJ=Object.prototype.toString,Gye=0,xI=4,B0=0,uV=1,hV=2,Kye=-1,Zye=0,Yye=8;function mp(n){if(!(this instanceof mp))return new mp(n);this.options=Fv.assign({level:Kye,method:Yye,chunkSize:16384,windowBits:15,memLevel:8,strategy:Zye,to:""},n||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qye,this.strm.avail_out=0;var t=Mv.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==B0)throw new Error(l4[t]);if(e.header&&Mv.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=a4.string2buf(e.dictionary):lJ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=Mv.deflateSetDictionary(this.strm,i),t!==B0)throw new Error(l4[t]);this._dict_set=!0}}mp.prototype.push=function(n,e){var t=this.strm,i=this.options.chunkSize,s,r;if(this.ended)return!1;r=e===~~e?e:e===!0?xI:Gye,typeof n=="string"?t.input=a4.string2buf(n):lJ.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Fv.Buf8(i),t.next_out=0,t.avail_out=i),s=Mv.deflate(t,r),s!==uV&&s!==B0)return this.onEnd(s),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(r===xI||r===hV))&&(this.options.to==="string"?this.onData(a4.buf2binstring(Fv.shrinkBuf(t.output,t.next_out))):this.onData(Fv.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&s!==uV);return r===xI?(s=Mv.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===B0):(r===hV&&(this.onEnd(B0),t.avail_out=0),!0)};mp.prototype.onData=function(n){this.chunks.push(n)};mp.prototype.onEnd=function(n){n===B0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Fv.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function _6(n,e){var t=new mp(e);if(t.push(n,!0),t.err)throw t.msg||l4[t.err];return t.result}function Xye(n,e){return e=e||{},e.raw=!0,_6(n,e)}function Qye(n,e){return e=e||{},e.gzip=!0,_6(n,e)}ZC.Deflate=mp;ZC.deflate=_6;ZC.deflateRaw=Xye;ZC.gzip=Qye;var QC={},El={},ix=30,Jye=12,eCe=function(e,t){var i,s,r,o,a,l,c,u,h,d,f,g,p,m,b,v,w,y,x,D,S,T,k,I,N;i=e.state,s=e.next_in,I=e.input,r=s+(e.avail_in-5),o=e.next_out,N=e.output,a=o-(t-e.avail_out),l=o+(e.avail_out-257),c=i.dmax,u=i.wsize,h=i.whave,d=i.wnext,f=i.window,g=i.hold,p=i.bits,m=i.lencode,b=i.distcode,v=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;e:do{p<15&&(g+=I[s++]<<p,p+=8,g+=I[s++]<<p,p+=8),y=m[g&v];t:for(;;){if(x=y>>>24,g>>>=x,p-=x,x=y>>>16&255,x===0)N[o++]=y&65535;else if(x&16){D=y&65535,x&=15,x&&(p<x&&(g+=I[s++]<<p,p+=8),D+=g&(1<<x)-1,g>>>=x,p-=x),p<15&&(g+=I[s++]<<p,p+=8,g+=I[s++]<<p,p+=8),y=b[g&w];i:for(;;){if(x=y>>>24,g>>>=x,p-=x,x=y>>>16&255,x&16){if(S=y&65535,x&=15,p<x&&(g+=I[s++]<<p,p+=8,p<x&&(g+=I[s++]<<p,p+=8)),S+=g&(1<<x)-1,S>c){e.msg="invalid distance too far back",i.mode=ix;break e}if(g>>>=x,p-=x,x=o-a,S>x){if(x=S-x,x>h&&i.sane){e.msg="invalid distance too far back",i.mode=ix;break e}if(T=0,k=f,d===0){if(T+=u-x,x<D){D-=x;do N[o++]=f[T++];while(--x);T=o-S,k=N}}else if(d<x){if(T+=u+d-x,x-=d,x<D){D-=x;do N[o++]=f[T++];while(--x);if(T=0,d<D){x=d,D-=x;do N[o++]=f[T++];while(--x);T=o-S,k=N}}}else if(T+=d-x,x<D){D-=x;do N[o++]=f[T++];while(--x);T=o-S,k=N}for(;D>2;)N[o++]=k[T++],N[o++]=k[T++],N[o++]=k[T++],D-=3;D&&(N[o++]=k[T++],D>1&&(N[o++]=k[T++]))}else{T=o-S;do N[o++]=N[T++],N[o++]=N[T++],N[o++]=N[T++],D-=3;while(D>2);D&&(N[o++]=N[T++],D>1&&(N[o++]=N[T++]))}}else if(x&64){e.msg="invalid distance code",i.mode=ix;break e}else{y=b[(y&65535)+(g&(1<<x)-1)];continue i}break}}else if(x&64)if(x&32){i.mode=Jye;break e}else{e.msg="invalid literal/length code",i.mode=ix;break e}else{y=m[(y&65535)+(g&(1<<x)-1)];continue t}break}}while(s<r&&o<l);D=p>>3,s-=D,p-=D<<3,g&=(1<<p)-1,e.next_in=s,e.next_out=o,e.avail_in=s<r?5+(r-s):5-(s-r),e.avail_out=o<l?257+(l-o):257-(o-l),i.hold=g,i.bits=p},dV=rh,Am=15,fV=852,gV=592,pV=0,kI=1,mV=2,tCe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],iCe=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],nCe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],sCe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],rCe=function(e,t,i,s,r,o,a,l){var c=l.bits,u=0,h=0,d=0,f=0,g=0,p=0,m=0,b=0,v=0,w=0,y,x,D,S,T,k=null,I=0,N,z=new dV.Buf16(Am+1),$=new dV.Buf16(Am+1),q=null,ne=0,de,me,De;for(u=0;u<=Am;u++)z[u]=0;for(h=0;h<s;h++)z[t[i+h]]++;for(g=c,f=Am;f>=1&&z[f]===0;f--);if(g>f&&(g=f),f===0)return r[o++]=1<<24|64<<16|0,r[o++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&z[d]===0;d++);for(g<d&&(g=d),b=1,u=1;u<=Am;u++)if(b<<=1,b-=z[u],b<0)return-1;if(b>0&&(e===pV||f!==1))return-1;for($[1]=0,u=1;u<Am;u++)$[u+1]=$[u]+z[u];for(h=0;h<s;h++)t[i+h]!==0&&(a[$[t[i+h]]++]=h);if(e===pV?(k=q=a,N=19):e===kI?(k=tCe,I-=257,q=iCe,ne-=257,N=256):(k=nCe,q=sCe,N=-1),w=0,h=0,u=d,T=o,p=g,m=0,D=-1,v=1<<g,S=v-1,e===kI&&v>fV||e===mV&&v>gV)return 1;for(;;){de=u-m,a[h]<N?(me=0,De=a[h]):a[h]>N?(me=q[ne+a[h]],De=k[I+a[h]]):(me=32+64,De=0),y=1<<u-m,x=1<<p,d=x;do x-=y,r[T+(w>>m)+x]=de<<24|me<<16|De|0;while(x!==0);for(y=1<<u-1;w&y;)y>>=1;if(y!==0?(w&=y-1,w+=y):w=0,h++,--z[u]===0){if(u===f)break;u=t[i+a[h]]}if(u>g&&(w&S)!==D){for(m===0&&(m=g),T+=d,p=u-m,b=1<<p;p+m<f&&(b-=z[p+m],!(b<=0));)p++,b<<=1;if(v+=1<<p,e===kI&&v>fV||e===mV&&v>gV)return 1;D=w&S,r[D]=g<<24|p<<16|T-o|0}}return w!==0&&(r[T+w]=u-m<<24|64<<16|0),l.bits=g,0},Ro=rh,c4=XQ,Vl=QQ,oCe=eCe,Pv=rCe,aCe=0,cJ=1,uJ=2,_V=4,lCe=5,nx=6,_p=0,cCe=1,uCe=2,Ta=-2,hJ=-3,dJ=-4,hCe=-5,bV=8,fJ=1,vV=2,wV=3,yV=4,CV=5,SV=6,xV=7,kV=8,LV=9,DV=10,rL=11,Qc=12,LI=13,EV=14,DI=15,TV=16,AV=17,IV=18,NV=19,sx=20,rx=21,RV=22,MV=23,FV=24,PV=25,OV=26,EI=27,BV=28,WV=29,un=30,gJ=31,dCe=32,fCe=852,gCe=592,pCe=15,mCe=pCe;function VV(n){return(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24)}function _Ce(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Ro.Buf16(320),this.work=new Ro.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function pJ(n){var e;return!n||!n.state?Ta:(e=n.state,n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=fJ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Ro.Buf32(fCe),e.distcode=e.distdyn=new Ro.Buf32(gCe),e.sane=1,e.back=-1,_p)}function mJ(n){var e;return!n||!n.state?Ta:(e=n.state,e.wsize=0,e.whave=0,e.wnext=0,pJ(n))}function _J(n,e){var t,i;return!n||!n.state||(i=n.state,e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?Ta:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,mJ(n))}function bJ(n,e){var t,i;return n?(i=new _Ce,n.state=i,i.window=null,t=_J(n,e),t!==_p&&(n.state=null),t):Ta}function bCe(n){return bJ(n,mCe)}var $V=!0,TI,AI;function vCe(n){if($V){var e;for(TI=new Ro.Buf32(512),AI=new Ro.Buf32(32),e=0;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Pv(cJ,n.lens,0,288,TI,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Pv(uJ,n.lens,0,32,AI,0,n.work,{bits:5}),$V=!1}n.lencode=TI,n.lenbits=9,n.distcode=AI,n.distbits=5}function vJ(n,e,t,i){var s,r=n.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Ro.Buf8(r.wsize)),i>=r.wsize?(Ro.arraySet(r.window,e,t-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>i&&(s=i),Ro.arraySet(r.window,e,t-i,s,r.wnext),i-=s,i?(Ro.arraySet(r.window,e,t-i,i,0),r.wnext=i,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0}function wCe(n,e){var t,i,s,r,o,a,l,c,u,h,d,f,g,p,m=0,b,v,w,y,x,D,S,T,k=new Ro.Buf8(4),I,N,z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return Ta;t=n.state,t.mode===Qc&&(t.mode=LI),o=n.next_out,s=n.output,l=n.avail_out,r=n.next_in,i=n.input,a=n.avail_in,c=t.hold,u=t.bits,h=a,d=l,T=_p;e:for(;;)switch(t.mode){case fJ:if(t.wrap===0){t.mode=LI;break}for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.wrap&2&&c===35615){t.check=0,k[0]=c&255,k[1]=c>>>8&255,t.check=Vl(t.check,k,2,0),c=0,u=0,t.mode=vV;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=un;break}if((c&15)!==bV){n.msg="unknown compression method",t.mode=un;break}if(c>>>=4,u-=4,S=(c&15)+8,t.wbits===0)t.wbits=S;else if(S>t.wbits){n.msg="invalid window size",t.mode=un;break}t.dmax=1<<S,n.adler=t.check=1,t.mode=c&512?DV:Qc,c=0,u=0;break;case vV:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.flags=c,(t.flags&255)!==bV){n.msg="unknown compression method",t.mode=un;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=un;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Vl(t.check,k,2,0)),c=0,u=0,t.mode=wV;case wV:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.head&&(t.head.time=c),t.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,t.check=Vl(t.check,k,4,0)),c=0,u=0,t.mode=yV;case yV:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Vl(t.check,k,2,0)),c=0,u=0,t.mode=CV;case CV:if(t.flags&1024){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Vl(t.check,k,2,0)),c=0,u=0}else t.head&&(t.head.extra=null);t.mode=SV;case SV:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(S=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Ro.arraySet(t.head.extra,i,r,f,S)),t.flags&512&&(t.check=Vl(t.check,i,f,r)),a-=f,r+=f,t.length-=f),t.length))break e;t.length=0,t.mode=xV;case xV:if(t.flags&2048){if(a===0)break e;f=0;do S=i[r+f++],t.head&&S&&t.length<65536&&(t.head.name+=String.fromCharCode(S));while(S&&f<a);if(t.flags&512&&(t.check=Vl(t.check,i,f,r)),a-=f,r+=f,S)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=kV;case kV:if(t.flags&4096){if(a===0)break e;f=0;do S=i[r+f++],t.head&&S&&t.length<65536&&(t.head.comment+=String.fromCharCode(S));while(S&&f<a);if(t.flags&512&&(t.check=Vl(t.check,i,f,r)),a-=f,r+=f,S)break e}else t.head&&(t.head.comment=null);t.mode=LV;case LV:if(t.flags&512){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=un;break}c=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Qc;break;case DV:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.adler=t.check=VV(c),c=0,u=0,t.mode=rL;case rL:if(t.havedict===0)return n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,uCe;n.adler=t.check=1,t.mode=Qc;case Qc:if(e===lCe||e===nx)break e;case LI:if(t.last){c>>>=u&7,u-=u&7,t.mode=EI;break}for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}switch(t.last=c&1,c>>>=1,u-=1,c&3){case 0:t.mode=EV;break;case 1:if(vCe(t),t.mode=sx,e===nx){c>>>=2,u-=2;break e}break;case 2:t.mode=AV;break;case 3:n.msg="invalid block type",t.mode=un}c>>>=2,u-=2;break;case EV:for(c>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=un;break}if(t.length=c&65535,c=0,u=0,t.mode=DI,e===nx)break e;case DI:t.mode=TV;case TV:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;Ro.arraySet(s,i,r,f,o),a-=f,r+=f,l-=f,o+=f,t.length-=f;break}t.mode=Qc;break;case AV:for(;u<14;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.nlen=(c&31)+257,c>>>=5,u-=5,t.ndist=(c&31)+1,c>>>=5,u-=5,t.ncode=(c&15)+4,c>>>=4,u-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=un;break}t.have=0,t.mode=IV;case IV:for(;t.have<t.ncode;){for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.lens[z[t.have++]]=c&7,c>>>=3,u-=3}for(;t.have<19;)t.lens[z[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},T=Pv(aCe,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,T){n.msg="invalid code lengths set",t.mode=un;break}t.have=0,t.mode=NV;case NV:for(;t.have<t.nlen+t.ndist;){for(;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(w<16)c>>>=b,u-=b,t.lens[t.have++]=w;else{if(w===16){for(N=b+2;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c>>>=b,u-=b,t.have===0){n.msg="invalid bit length repeat",t.mode=un;break}S=t.lens[t.have-1],f=3+(c&3),c>>>=2,u-=2}else if(w===17){for(N=b+3;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,S=0,f=3+(c&7),c>>>=3,u-=3}else{for(N=b+7;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,S=0,f=11+(c&127),c>>>=7,u-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=un;break}for(;f--;)t.lens[t.have++]=S}}if(t.mode===un)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=un;break}if(t.lenbits=9,I={bits:t.lenbits},T=Pv(cJ,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,T){n.msg="invalid literal/lengths set",t.mode=un;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},T=Pv(uJ,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,T){n.msg="invalid distances set",t.mode=un;break}if(t.mode=sx,e===nx)break e;case sx:t.mode=rx;case rx:if(a>=6&&l>=258){n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,oCe(n,d),o=n.next_out,s=n.output,l=n.avail_out,r=n.next_in,i=n.input,a=n.avail_in,c=t.hold,u=t.bits,t.mode===Qc&&(t.back=-1);break}for(t.back=0;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(v&&!(v&240)){for(y=b,x=v,D=w;m=t.lencode[D+((c&(1<<y+x)-1)>>y)],b=m>>>24,v=m>>>16&255,w=m&65535,!(y+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=y,u-=y,t.back+=y}if(c>>>=b,u-=b,t.back+=b,t.length=w,v===0){t.mode=OV;break}if(v&32){t.back=-1,t.mode=Qc;break}if(v&64){n.msg="invalid literal/length code",t.mode=un;break}t.extra=v&15,t.mode=RV;case RV:if(t.extra){for(N=t.extra;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=MV;case MV:for(;m=t.distcode[c&(1<<t.distbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(!(v&240)){for(y=b,x=v,D=w;m=t.distcode[D+((c&(1<<y+x)-1)>>y)],b=m>>>24,v=m>>>16&255,w=m&65535,!(y+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=y,u-=y,t.back+=y}if(c>>>=b,u-=b,t.back+=b,v&64){n.msg="invalid distance code",t.mode=un;break}t.offset=w,t.extra=v&15,t.mode=FV;case FV:if(t.extra){for(N=t.extra;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=un;break}t.mode=PV;case PV:if(l===0)break e;if(f=d-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=un;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),p=t.window}else p=s,g=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do s[o++]=p[g++];while(--f);t.length===0&&(t.mode=rx);break;case OV:if(l===0)break e;s[o++]=t.length,l--,t.mode=rx;break;case EI:if(t.wrap){for(;u<32;){if(a===0)break e;a--,c|=i[r++]<<u,u+=8}if(d-=l,n.total_out+=d,t.total+=d,d&&(n.adler=t.check=t.flags?Vl(t.check,s,d,o-d):c4(t.check,s,d,o-d)),d=l,(t.flags?c:VV(c))!==t.check){n.msg="incorrect data check",t.mode=un;break}c=0,u=0}t.mode=BV;case BV:if(t.wrap&&t.flags){for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=un;break}c=0,u=0}t.mode=WV;case WV:T=cCe;break e;case un:T=hJ;break e;case gJ:return dJ;case dCe:default:return Ta}return n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,(t.wsize||d!==n.avail_out&&t.mode<un&&(t.mode<EI||e!==_V))&&vJ(n,n.output,n.next_out,d-n.avail_out),h-=n.avail_in,d-=n.avail_out,n.total_in+=h,n.total_out+=d,t.total+=d,t.wrap&&d&&(n.adler=t.check=t.flags?Vl(t.check,s,d,n.next_out-d):c4(t.check,s,d,n.next_out-d)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Qc?128:0)+(t.mode===sx||t.mode===DI?256:0),(h===0&&d===0||e===_V)&&T===_p&&(T=hCe),T}function yCe(n){if(!n||!n.state)return Ta;var e=n.state;return e.window&&(e.window=null),n.state=null,_p}function CCe(n,e){var t;return!n||!n.state||(t=n.state,!(t.wrap&2))?Ta:(t.head=e,e.done=!1,_p)}function SCe(n,e){var t=e.length,i,s,r;return!n||!n.state||(i=n.state,i.wrap!==0&&i.mode!==rL)?Ta:i.mode===rL&&(s=1,s=c4(s,e,t,0),s!==i.check)?hJ:(r=vJ(n,e,t,t),r?(i.mode=gJ,dJ):(i.havedict=1,_p))}El.inflateReset=mJ;El.inflateReset2=_J;El.inflateResetKeep=pJ;El.inflateInit=bCe;El.inflateInit2=bJ;El.inflate=wCe;El.inflateEnd=yCe;El.inflateGetHeader=CCe;El.inflateSetDictionary=SCe;El.inflateInfo="pako inflate (from Nodeca project)";var wJ={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function xCe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var kCe=xCe,W0=El,Ov=rh,B2=qp,Fn=wJ,u4=m6,LCe=aJ,DCe=kCe,yJ=Object.prototype.toString;function bp(n){if(!(this instanceof bp))return new bp(n);this.options=Ov.assign({chunkSize:16384,windowBits:0,to:""},n||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new LCe,this.strm.avail_out=0;var t=W0.inflateInit2(this.strm,e.windowBits);if(t!==Fn.Z_OK)throw new Error(u4[t]);if(this.header=new DCe,W0.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=B2.string2buf(e.dictionary):yJ.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=W0.inflateSetDictionary(this.strm,e.dictionary),t!==Fn.Z_OK)))throw new Error(u4[t])}bp.prototype.push=function(n,e){var t=this.strm,i=this.options.chunkSize,s=this.options.dictionary,r,o,a,l,c,u=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?Fn.Z_FINISH:Fn.Z_NO_FLUSH,typeof n=="string"?t.input=B2.binstring2buf(n):yJ.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Ov.Buf8(i),t.next_out=0,t.avail_out=i),r=W0.inflate(t,Fn.Z_NO_FLUSH),r===Fn.Z_NEED_DICT&&s&&(r=W0.inflateSetDictionary(this.strm,s)),r===Fn.Z_BUF_ERROR&&u===!0&&(r=Fn.Z_OK,u=!1),r!==Fn.Z_STREAM_END&&r!==Fn.Z_OK)return this.onEnd(r),this.ended=!0,!1;t.next_out&&(t.avail_out===0||r===Fn.Z_STREAM_END||t.avail_in===0&&(o===Fn.Z_FINISH||o===Fn.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=B2.utf8border(t.output,t.next_out),l=t.next_out-a,c=B2.buf2string(t.output,a),t.next_out=l,t.avail_out=i-l,l&&Ov.arraySet(t.output,t.output,a,l,0),this.onData(c)):this.onData(Ov.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(u=!0)}while((t.avail_in>0||t.avail_out===0)&&r!==Fn.Z_STREAM_END);return r===Fn.Z_STREAM_END&&(o=Fn.Z_FINISH),o===Fn.Z_FINISH?(r=W0.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Fn.Z_OK):(o===Fn.Z_SYNC_FLUSH&&(this.onEnd(Fn.Z_OK),t.avail_out=0),!0)};bp.prototype.onData=function(n){this.chunks.push(n)};bp.prototype.onEnd=function(n){n===Fn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ov.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function b6(n,e){var t=new bp(e);if(t.push(n,!0),t.err)throw t.msg||u4[t.err];return t.result}function ECe(n,e){return e=e||{},e.raw=!0,b6(n,e)}QC.Inflate=bp;QC.inflate=b6;QC.inflateRaw=ECe;QC.ungzip=b6;var TCe=rh.assign,ACe=ZC,ICe=QC,NCe=wJ,CJ={};TCe(CJ,ACe,ICe,NCe);var oL=CJ;async function P_(n){try{let e,t=0,i=0;const s=[];let r=0,o;do{const l=n.subarray(t);if(o=new oL.Inflate,{strm:e}=o,o.push(l,oL.Z_SYNC_FLUSH),o.err)throw new Error(o.msg);t+=e.next_in,s[i]=o.result,r+=s[i].length,i+=1}while(e.avail_in);const a=new Uint8Array(r);for(let l=0,c=0;l<s.length;l++)a.set(s[l],c),c+=s[l].length;return Buffer.from(a)}catch(e){throw`${e}`.match(/incorrect header check/)?new Error("problem decompressing block: incorrect gzip header check"):e}}async function SJ(n,e){try{let t;const{minv:i,maxv:s}=e;let r=i.blockPosition,o=i.dataPosition;const a=[],l=[],c=[];let u=0,h=0;do{const g=n.subarray(r-i.blockPosition),p=new oL.Inflate;if({strm:t}=p,p.push(g,oL.Z_SYNC_FLUSH),p.err)throw new Error(p.msg);const m=p.result;a.push(m);let b=m.length;l.push(r),c.push(o),a.length===1&&i.dataPosition&&(a[0]=a[0].subarray(i.dataPosition),b=a[0].length);const v=r;if(r+=t.next_in,o+=b,v>=s.blockPosition){a[h]=a[h].subarray(0,s.blockPosition===i.blockPosition?s.dataPosition-i.dataPosition+1:s.dataPosition+1),l.push(r),c.push(o),u+=a[h].length;break}u+=a[h].length,h++}while(t.avail_in);const d=new Uint8Array(u);for(let g=0,p=0;g<a.length;g++)d.set(a[g],p),p+=a[g].length;return{buffer:Buffer.from(d),cpositions:l,dpositions:c}}catch(t){throw`${t}`.match(/incorrect header check/)?new Error("problem decompressing block: incorrect gzip header check"):t}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var la=null;try{la=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ln(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}ln.prototype.__isLong__;Object.defineProperty(ln.prototype,"__isLong__",{value:!0});function yr(n){return(n&&n.__isLong__)===!0}function zV(n){var e=Math.clz32(n&-n);return n?31-e:e}ln.isLong=yr;var HV={},UV={};function Gp(n,e){var t,i,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(i=UV[n],i)?i:(t=fi(n,0,!0),s&&(UV[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(i=HV[n],i)?i:(t=fi(n,n<0?-1:0,!1),s&&(HV[n]=t),t))}ln.fromInt=Gp;function ca(n,e){if(isNaN(n))return e?Ou:dl;if(e){if(n<0)return Ou;if(n>=xJ)return DJ}else{if(n<=-qV)return ro;if(n+1>=qV)return LJ}return n<0?ca(-n,e).neg():fi(n%O_|0,n/O_|0,e)}ln.fromNumber=ca;function fi(n,e,t){return new ln(n,e,t)}ln.fromBits=fi;var aL=Math.pow;function v6(n,e,t){if(n.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return e?Ou:dl;if(t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return v6(n.substring(1),e,t).neg();for(var s=ca(aL(t,8)),r=dl,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=ca(aL(t,a));r=r.mul(c).add(ca(l))}else r=r.mul(s),r=r.add(ca(l))}return r.unsigned=e,r}ln.fromString=v6;function Tl(n,e){return typeof n=="number"?ca(n,e):typeof n=="string"?v6(n,e):fi(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}ln.fromValue=Tl;var jV=65536,RCe=1<<24,O_=jV*jV,xJ=O_*O_,qV=xJ/2,GV=Gp(RCe),dl=Gp(0);ln.ZERO=dl;var Ou=Gp(0,!0);ln.UZERO=Ou;var r0=Gp(1);ln.ONE=r0;var kJ=Gp(1,!0);ln.UONE=kJ;var h4=Gp(-1);ln.NEG_ONE=h4;var LJ=fi(-1,2147483647,!1);ln.MAX_VALUE=LJ;var DJ=fi(-1,-1,!0);ln.MAX_UNSIGNED_VALUE=DJ;var ro=fi(0,-2147483648,!1);ln.MIN_VALUE=ro;var Pe=ln.prototype;Pe.toInt=function(){return this.unsigned?this.low>>>0:this.low};Pe.toNumber=function(){return this.unsigned?(this.high>>>0)*O_+(this.low>>>0):this.high*O_+(this.low>>>0)};Pe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ro)){var t=ca(e),i=this.div(t),s=i.mul(t).sub(this);return i.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=ca(aL(e,6),this.unsigned),o=this,a="";;){var l=o.div(r),c=o.sub(l.mul(r)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Pe.getHighBits=function(){return this.high};Pe.getHighBitsUnsigned=function(){return this.high>>>0};Pe.getLowBits=function(){return this.low};Pe.getLowBitsUnsigned=function(){return this.low>>>0};Pe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ro)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};Pe.isZero=function(){return this.high===0&&this.low===0};Pe.eqz=Pe.isZero;Pe.isNegative=function(){return!this.unsigned&&this.high<0};Pe.isPositive=function(){return this.unsigned||this.high>=0};Pe.isOdd=function(){return(this.low&1)===1};Pe.isEven=function(){return(this.low&1)===0};Pe.equals=function(e){return yr(e)||(e=Tl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Pe.eq=Pe.equals;Pe.notEquals=function(e){return!this.eq(e)};Pe.neq=Pe.notEquals;Pe.ne=Pe.notEquals;Pe.lessThan=function(e){return this.comp(e)<0};Pe.lt=Pe.lessThan;Pe.lessThanOrEqual=function(e){return this.comp(e)<=0};Pe.lte=Pe.lessThanOrEqual;Pe.le=Pe.lessThanOrEqual;Pe.greaterThan=function(e){return this.comp(e)>0};Pe.gt=Pe.greaterThan;Pe.greaterThanOrEqual=function(e){return this.comp(e)>=0};Pe.gte=Pe.greaterThanOrEqual;Pe.ge=Pe.greaterThanOrEqual;Pe.compare=function(e){if(yr(e)||(e=Tl(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Pe.comp=Pe.compare;Pe.negate=function(){return!this.unsigned&&this.eq(ro)?ro:this.not().add(r0)};Pe.neg=Pe.negate;Pe.add=function(e){yr(e)||(e=Tl(e));var t=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=r+c,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=i+a,u+=h>>>16,h&=65535,u+=t+o,u&=65535,fi(d<<16|f,u<<16|h,this.unsigned)};Pe.subtract=function(e){return yr(e)||(e=Tl(e)),this.add(e.neg())};Pe.sub=Pe.subtract;Pe.multiply=function(e){if(this.isZero())return this;if(yr(e)||(e=Tl(e)),la){var t=la.mul(this.low,this.high,e.low,e.high);return fi(t,la.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Ou:dl;if(this.eq(ro))return e.isOdd()?ro:dl;if(e.eq(ro))return this.isOdd()?ro:dl;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(GV)&&e.lt(GV))return ca(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,g=0;return g+=o*u,f+=g>>>16,g&=65535,f+=r*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=r*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=i*u+s*c+r*l+o*a,h&=65535,fi(f<<16|g,h<<16|d,this.unsigned)};Pe.mul=Pe.multiply;Pe.divide=function(e){if(yr(e)||(e=Tl(e)),e.isZero())throw Error("division by zero");if(la){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?la.div_u:la.div_s)(this.low,this.high,e.low,e.high);return fi(t,la.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ou:dl;var i,s,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ou;if(e.gt(this.shru(1)))return kJ;r=Ou}else{if(this.eq(ro)){if(e.eq(r0)||e.eq(h4))return ro;if(e.eq(ro))return r0;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(dl)?e.isNegative()?r0:h4:(s=this.sub(e.mul(i)),r=i.add(s.div(e)),r)}else if(e.eq(ro))return this.unsigned?Ou:dl;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=dl}for(s=this;s.gte(e);){i=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:aL(2,a-48),c=ca(i),u=c.mul(e);u.isNegative()||u.gt(s);)i-=l,c=ca(i,this.unsigned),u=c.mul(e);c.isZero()&&(c=r0),r=r.add(c),s=s.sub(u)}return r};Pe.div=Pe.divide;Pe.modulo=function(e){if(yr(e)||(e=Tl(e)),la){var t=(this.unsigned?la.rem_u:la.rem_s)(this.low,this.high,e.low,e.high);return fi(t,la.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Pe.mod=Pe.modulo;Pe.rem=Pe.modulo;Pe.not=function(){return fi(~this.low,~this.high,this.unsigned)};Pe.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};Pe.clz=Pe.countLeadingZeros;Pe.countTrailingZeros=function(){return this.low?zV(this.low):zV(this.high)+32};Pe.ctz=Pe.countTrailingZeros;Pe.and=function(e){return yr(e)||(e=Tl(e)),fi(this.low&e.low,this.high&e.high,this.unsigned)};Pe.or=function(e){return yr(e)||(e=Tl(e)),fi(this.low|e.low,this.high|e.high,this.unsigned)};Pe.xor=function(e){return yr(e)||(e=Tl(e)),fi(this.low^e.low,this.high^e.high,this.unsigned)};Pe.shiftLeft=function(e){return yr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fi(0,this.low<<e-32,this.unsigned)};Pe.shl=Pe.shiftLeft;Pe.shiftRight=function(e){return yr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Pe.shr=Pe.shiftRight;Pe.shiftRightUnsigned=function(e){return yr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fi(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?fi(this.high,0,this.unsigned):fi(this.high>>>e-32,0,this.unsigned)};Pe.shru=Pe.shiftRightUnsigned;Pe.shr_u=Pe.shiftRightUnsigned;Pe.rotateLeft=function(e){var t;return yr(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fi(this.high,this.low,this.unsigned):e<32?(t=32-e,fi(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,fi(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};Pe.rotl=Pe.rotateLeft;Pe.rotateRight=function(e){var t;return yr(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fi(this.high,this.low,this.unsigned):e<32?(t=32-e,fi(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,fi(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};Pe.rotr=Pe.rotateRight;Pe.toSigned=function(){return this.unsigned?fi(this.low,this.high,!1):this};Pe.toUnsigned=function(){return this.unsigned?this:fi(this.low,this.high,!0)};Pe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Pe.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Pe.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};ln.fromBytes=function(e,t,i){return i?ln.fromBytesLE(e,t):ln.fromBytesBE(e,t)};ln.fromBytesLE=function(e,t){return new ln(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};ln.fromBytesBE=function(e,t){return new ln(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};function KV(n,e){return n.offset+n.lineBytes*Math.floor(e/n.lineLength)+e%n.lineLength}async function MCe(n,e){const t=await n.readFile(e);if(!(t&&t.length))throw new Error("No data read from FASTA index (FAI) file");let i=0,s;const r=t.toString("utf8").split(/\r?\n/).filter(o=>/\S/.test(o)).map(o=>o.split("	")).filter(o=>o[0]!=="").map(o=>((!s||s.name!==o[0])&&(s={name:o[0],id:i},i+=1),{id:s.id,name:o[0],length:+o[1],start:0,end:+o[1],offset:+o[2],lineLength:+o[3],lineBytes:+o[4]}));return{name:Object.fromEntries(r.map(o=>[o.name,o])),id:Object.fromEntries(r.map(o=>[o.id,o]))}}class FCe{constructor({fasta:e,fai:t,path:i,faiPath:s,chunkSizeLimit:r=1e6}){if(e)this.fasta=e;else if(i)this.fasta=new No(i);else throw new Error("Need to pass filehandle for fasta or path to localfile");if(t)this.fai=t;else if(s)this.fai=new No(s);else if(i)this.fai=new No(`${i}.fai`);else throw new Error("Need to pass filehandle for  or path to localfile");this.chunkSizeLimit=r}async _getIndexes(e){return this.indexes||(this.indexes=MCe(this.fai,e)),this.indexes}async getSequenceNames(e){return Object.keys((await this._getIndexes(e)).name)}async getSequenceSizes(e){const t={},i=await this._getIndexes(e),s=Object.values(i.id);for(let r=0;r<s.length;r+=1)t[s[r].name]=s[r].length;return t}async getSequenceSize(e,t){var i;return(i=(await this._getIndexes(t)).name[e])===null||i===void 0?void 0:i.length}async hasReferenceSequence(e,t){return!!(await this._getIndexes(t)).name[e]}async getResiduesById(e,t,i,s){const r=(await this._getIndexes(s)).id[e];if(r)return this._fetchFromIndexEntry(r,t,i,s)}async getResiduesByName(e,t,i,s){const r=(await this._getIndexes(s)).name[e];if(r)return this._fetchFromIndexEntry(r,t,i,s)}async getSequence(e,t,i,s){return this.getResiduesByName(e,t,i,s)}async _fetchFromIndexEntry(e,t=0,i,s){let r=i;if(t<0)throw new TypeError("regionStart cannot be less than 0");if((r===void 0||r>e.length)&&(r=e.length),t>=r)return"";const o=KV(e,t),a=KV(e,r)-o;if(a>this.chunkSizeLimit)throw new Error(`data size of ${a.toLocaleString()} bytes exceeded chunk size limit of ${this.chunkSizeLimit.toLocaleString()} bytes`);const l=Buffer.allocUnsafe(a);return await this.fasta.read(l,0,a,o,s),l.toString("utf8").replace(/\s+/g,"")}}function JC(n){return class extends n{constructor(){super(...arguments);Rn(this,"lastQuantizedInterval",[0,0])}quantizeInterval(i,s){return[Math.max(Math.floor(i[0]/s-1)*s,0),Math.min(Math.ceil(i[1]/s+1)*s,this.genome.totalSize)]}checkAndUpdateLastInterval(i){return Uk(this.lastQuantizedInterval,i)?!1:(this.lastQuantizedInterval=i,!0)}}}function eS(n,e){return!e||/^(data:|([A-Za-z]+:)?\/\/)/.test(n)||n.startsWith("/")?n:(e.endsWith("/")||(e+="/"),e+n)}typeof window<"u"&&(window.Buffer=zs.Buffer);class PCe extends JC(Hp){constructor(e,t){const i={channel:"x",windowSize:7e3,...e};if(super(t,i.channel),this.params=i,!this.params.url)throw new Error("No URL provided for IndexedFastaSource");const s=r=>new fc(eS(r,this.view.getBaseUrl()));this.fasta=new FCe({fasta:s(this.params.url),fai:s(this.params.indexUrl??this.params.url+".fai")})}async onDomainChanged(e){const t=this.params.windowSize;if(e[1]-e[0]>t)return;const i=this.quantizeInterval(e,t);if(this.checkAndUpdateLastInterval(i)){const s=this.genome.continuousToDiscreteChromosomeIntervals(i),r=await Promise.all(s.map(o=>this.fasta.getSequence(o.chrom,o.startPos,o.endPos).then(a=>({chrom:o.chrom,start:o.startPos,sequence:a}))));this.publishData(r)}}}const tT=BigInt(32);function OCe(n,e,t){const i=+!!t,s=+!t;return BigInt(n.getInt32(e,t)*s+n.getInt32(e+4,t)*i)<<tT|BigInt(n.getUint32(e,t)*i+n.getUint32(e+4,t)*s)}function BCe(n,e,t){const i=n.getUint32(e,t),s=n.getUint32(e+4,t),r=+!!t,o=+!t;return BigInt(i*o+s*r)<<tT|BigInt(i*r+s*o)}function WCe(n,e,t,i){const s=Number(t>>tT),r=Number(t&BigInt(4294967295));i?(n.setInt32(e+4,s,i),n.setUint32(e,r,i)):(n.setInt32(e,s,i),n.setUint32(e+4,r,i))}function VCe(n,e,t,i){const s=Number(t>>tT),r=Number(t&BigInt(4294967295));i?(n.setUint32(e+4,s,i),n.setUint32(e,r,i)):(n.setUint32(e,s,i),n.setUint32(e+4,r,i))}"getBigInt64"in DataView||(DataView.prototype.getBigInt64=function(n,e){return OCe(this,n,e)});"getBigUint64"in DataView||(DataView.prototype.getBigUint64=function(n,e){return BCe(this,n,e)});"setBigInt64"in DataView||(DataView.prototype.setBigInt64=function(n,e,t){WCe(this,n,e,t)});"setBigUint64"in DataView||(DataView.prototype.setBigUint64=function(n,e,t){VCe(this,n,e,t)});let $Ce=class{constructor(e,t){this.code="",this.scopes=[["vars"]],this.bitFields=[],this.tmpVariableCount=0,this.references=new Map,this.imports=[],this.reverseImports=new Map,this.useContextVariables=!1,this.importPath=e,this.useContextVariables=t}generateVariable(e){const t=[...this.scopes[this.scopes.length-1]];return e&&t.push(e),t.join(".")}generateOption(e){switch(typeof e){case"number":return e.toString();case"string":return this.generateVariable(e);case"function":return`${this.addImport(e)}.call(${this.generateVariable()}, vars)`}}generateError(e){this.pushCode(`throw new Error(${e});`)}generateTmpVariable(){return"$tmp"+this.tmpVariableCount++}pushCode(e){this.code+=e+`
`}pushPath(e){e&&this.scopes[this.scopes.length-1].push(e)}popPath(e){e&&this.scopes[this.scopes.length-1].pop()}pushScope(e){this.scopes.push([e])}popScope(){this.scopes.pop()}addImport(e){if(!this.importPath)return`(${e})`;let t=this.reverseImports.get(e);return t||(t=this.imports.push(e)-1,this.reverseImports.set(e,t)),`${this.importPath}[${t}]`}addReference(e){this.references.has(e)||this.references.set(e,{resolved:!1,requested:!1})}markResolved(e){const t=this.references.get(e);t&&(t.resolved=!0)}markRequested(e){e.forEach(t=>{const i=this.references.get(t);i&&(i.requested=!0)})}getUnresolvedReferences(){return Array.from(this.references).filter(([e,t])=>!t.resolved&&!t.requested).map(([e,t])=>e)}};const ja=new Map,Bf="___parser_",qa={uint8:1,uint16le:2,uint16be:2,uint32le:4,uint32be:4,int8:1,int16le:2,int16be:2,int32le:4,int32be:4,int64be:8,int64le:8,uint64be:8,uint64le:8,floatle:4,floatbe:4,doublele:8,doublebe:8},ox={uint8:"Uint8",uint16le:"Uint16",uint16be:"Uint16",uint32le:"Uint32",uint32be:"Uint32",int8:"Int8",int16le:"Int16",int16be:"Int16",int32le:"Int32",int32be:"Int32",int64be:"BigInt64",int64le:"BigInt64",uint64be:"BigUint64",uint64le:"BigUint64",floatle:"Float32",floatbe:"Float32",doublele:"Float64",doublebe:"Float64"},ax={uint8:!1,uint16le:!0,uint16be:!1,uint32le:!0,uint32be:!1,int8:!1,int16le:!0,int16be:!1,int32le:!0,int32be:!1,int64be:!1,int64le:!0,uint64be:!1,uint64le:!0,floatle:!0,floatbe:!1,doublele:!0,doublebe:!1};let Ei=class Ya{constructor(){this.varName="",this.type="",this.options={},this.endian="be",this.useContextVariables=!1}static start(){return new Ya}primitiveGenerateN(e,t){const i=ox[e],s=ax[e];t.pushCode(`${t.generateVariable(this.varName)} = dataView.get${i}(offset, ${s});`),t.pushCode(`offset += ${qa[e]};`)}primitiveN(e,t,i){return this.setNextParser(e,t,i)}useThisEndian(e){return e+this.endian.toLowerCase()}uint8(e,t={}){return this.primitiveN("uint8",e,t)}uint16(e,t={}){return this.primitiveN(this.useThisEndian("uint16"),e,t)}uint16le(e,t={}){return this.primitiveN("uint16le",e,t)}uint16be(e,t={}){return this.primitiveN("uint16be",e,t)}uint32(e,t={}){return this.primitiveN(this.useThisEndian("uint32"),e,t)}uint32le(e,t={}){return this.primitiveN("uint32le",e,t)}uint32be(e,t={}){return this.primitiveN("uint32be",e,t)}int8(e,t={}){return this.primitiveN("int8",e,t)}int16(e,t={}){return this.primitiveN(this.useThisEndian("int16"),e,t)}int16le(e,t={}){return this.primitiveN("int16le",e,t)}int16be(e,t={}){return this.primitiveN("int16be",e,t)}int32(e,t={}){return this.primitiveN(this.useThisEndian("int32"),e,t)}int32le(e,t={}){return this.primitiveN("int32le",e,t)}int32be(e,t={}){return this.primitiveN("int32be",e,t)}bigIntVersionCheck(){if(!DataView.prototype.getBigInt64)throw new Error("BigInt64 is unsupported on this runtime")}int64(e,t={}){return this.bigIntVersionCheck(),this.primitiveN(this.useThisEndian("int64"),e,t)}int64be(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("int64be",e,t)}int64le(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("int64le",e,t)}uint64(e,t={}){return this.bigIntVersionCheck(),this.primitiveN(this.useThisEndian("uint64"),e,t)}uint64be(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("uint64be",e,t)}uint64le(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("uint64le",e,t)}floatle(e,t={}){return this.primitiveN("floatle",e,t)}floatbe(e,t={}){return this.primitiveN("floatbe",e,t)}doublele(e,t={}){return this.primitiveN("doublele",e,t)}doublebe(e,t={}){return this.primitiveN("doublebe",e,t)}bitN(e,t,i){return i.length=e,this.setNextParser("bit",t,i)}bit1(e,t={}){return this.bitN(1,e,t)}bit2(e,t={}){return this.bitN(2,e,t)}bit3(e,t={}){return this.bitN(3,e,t)}bit4(e,t={}){return this.bitN(4,e,t)}bit5(e,t={}){return this.bitN(5,e,t)}bit6(e,t={}){return this.bitN(6,e,t)}bit7(e,t={}){return this.bitN(7,e,t)}bit8(e,t={}){return this.bitN(8,e,t)}bit9(e,t={}){return this.bitN(9,e,t)}bit10(e,t={}){return this.bitN(10,e,t)}bit11(e,t={}){return this.bitN(11,e,t)}bit12(e,t={}){return this.bitN(12,e,t)}bit13(e,t={}){return this.bitN(13,e,t)}bit14(e,t={}){return this.bitN(14,e,t)}bit15(e,t={}){return this.bitN(15,e,t)}bit16(e,t={}){return this.bitN(16,e,t)}bit17(e,t={}){return this.bitN(17,e,t)}bit18(e,t={}){return this.bitN(18,e,t)}bit19(e,t={}){return this.bitN(19,e,t)}bit20(e,t={}){return this.bitN(20,e,t)}bit21(e,t={}){return this.bitN(21,e,t)}bit22(e,t={}){return this.bitN(22,e,t)}bit23(e,t={}){return this.bitN(23,e,t)}bit24(e,t={}){return this.bitN(24,e,t)}bit25(e,t={}){return this.bitN(25,e,t)}bit26(e,t={}){return this.bitN(26,e,t)}bit27(e,t={}){return this.bitN(27,e,t)}bit28(e,t={}){return this.bitN(28,e,t)}bit29(e,t={}){return this.bitN(29,e,t)}bit30(e,t={}){return this.bitN(30,e,t)}bit31(e,t={}){return this.bitN(31,e,t)}bit32(e,t={}){return this.bitN(32,e,t)}namely(e){return ja.set(e,this),this.alias=e,this}skip(e,t={}){return this.seek(e,t)}seek(e,t={}){if(t.assert)throw new Error("assert option on seek is not allowed.");return this.setNextParser("seek","",{length:e})}string(e,t){if(!t.zeroTerminated&&!t.length&&!t.greedy)throw new Error("One of length, zeroTerminated, or greedy must be defined for string.");if((t.zeroTerminated||t.length)&&t.greedy)throw new Error("greedy is mutually exclusive with length and zeroTerminated for string.");if(t.stripNull&&!(t.length||t.greedy))throw new Error("length or greedy must be defined if stripNull is enabled.");return t.encoding=t.encoding||"utf8",this.setNextParser("string",e,t)}buffer(e,t){if(!t.length&&!t.readUntil)throw new Error("length or readUntil must be defined for buffer.");return this.setNextParser("buffer",e,t)}wrapped(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t||!t.wrapper||!t.type)throw new Error("Both wrapper and type must be defined for wrapped.");if(!t.length&&!t.readUntil)throw new Error("length or readUntil must be defined for wrapped.");return this.setNextParser("wrapper",e,t)}array(e,t){if(!t.readUntil&&!t.length&&!t.lengthInBytes)throw new Error("One of readUntil, length and lengthInBytes must be defined for array.");if(!t.type)throw new Error("type is required for array.");if(typeof t.type=="string"&&!ja.has(t.type)&&!(t.type in qa))throw new Error(`Array element type "${t.type}" is unkown.`);return this.setNextParser("array",e,t)}choice(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t)throw new Error("tag and choices are are required for choice.");if(!t.tag)throw new Error("tag is requird for choice.");if(!t.choices)throw new Error("choices is required for choice.");for(const i in t.choices){const s=parseInt(i,10),r=t.choices[s];if(isNaN(s))throw new Error(`Choice key "${i}" is not a number.`);if(typeof r=="string"&&!ja.has(r)&&!(r in qa))throw new Error(`Choice type "${r}" is unkown.`)}return this.setNextParser("choice",e,t)}nest(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t||!t.type)throw new Error("type is required for nest.");if(!(t.type instanceof Ya)&&!ja.has(t.type))throw new Error("type must be a known parser name or a Parser object.");if(!(t.type instanceof Ya)&&!e)throw new Error("type must be a Parser object if the variable name is omitted.");return this.setNextParser("nest",e,t)}pointer(e,t){if(!t.offset)throw new Error("offset is required for pointer.");if(!t.type)throw new Error("type is required for pointer.");if(typeof t.type=="string"&&!(t.type in qa)&&!ja.has(t.type))throw new Error(`Pointer type "${t.type}" is unkown.`);return this.setNextParser("pointer",e,t)}saveOffset(e,t={}){return this.setNextParser("saveOffset",e,t)}endianness(e){switch(e.toLowerCase()){case"little":this.endian="le";break;case"big":this.endian="be";break;default:throw new Error('endianness must be one of "little" or "big"')}return this}endianess(e){return this.endianness(e)}useContextVars(e=!0){return this.useContextVariables=e,this}create(e){if(!(e instanceof Function))throw new Error("Constructor must be a Function object.");return this.constructorFn=e,this}getContext(e){const t=new $Ce(e,this.useContextVariables);return t.pushCode("var dataView = new DataView(buffer.buffer, buffer.byteOffset, buffer.length);"),this.alias?(this.addAliasedCode(t),t.pushCode(`return ${Bf+this.alias}(0).result;`)):this.addRawCode(t),t}getCode(){const e="imports";return this.getContext(e).code}addRawCode(e){e.pushCode("var offset = 0;"),e.pushCode(`var vars = ${this.constructorFn?"new constructorFn()":"{}"};`),e.pushCode("vars.$parent = null;"),e.pushCode("vars.$root = vars;"),this.generate(e),this.resolveReferences(e),e.pushCode("delete vars.$parent;"),e.pushCode("delete vars.$root;"),e.pushCode("return vars;")}addAliasedCode(e){return e.pushCode(`function ${Bf+this.alias}(offset, context) {`),e.pushCode(`var vars = ${this.constructorFn?"new constructorFn()":"{}"};`),e.pushCode("var ctx = Object.assign({$parent: null, $root: vars}, context || {});"),e.pushCode("vars = Object.assign(vars, ctx);"),this.generate(e),e.markResolved(this.alias),this.resolveReferences(e),e.pushCode("Object.keys(ctx).forEach(function (item) { delete vars[item]; });"),e.pushCode("return { offset: offset, result: vars };"),e.pushCode("}"),e}resolveReferences(e){const t=e.getUnresolvedReferences();e.markRequested(t),t.forEach(i=>{var s;(s=ja.get(i))===null||s===void 0||s.addAliasedCode(e)})}compile(){const e="imports",t=this.getContext(e);this.compiled=new Function(e,"TextDecoder",`return function (buffer, constructorFn) { ${t.code} };`)(t.imports,TextDecoder)}sizeOf(){let e=NaN;if(Object.keys(qa).indexOf(this.type)>=0)e=qa[this.type];else if(this.type==="string"&&typeof this.options.length=="number")e=this.options.length;else if(this.type==="buffer"&&typeof this.options.length=="number")e=this.options.length;else if(this.type==="array"&&typeof this.options.length=="number"){let t=NaN;typeof this.options.type=="string"?t=qa[this.options.type]:this.options.type instanceof Ya&&(t=this.options.type.sizeOf()),e=this.options.length*t}else this.type==="seek"?e=this.options.length:this.type==="nest"?e=this.options.type.sizeOf():this.type||(e=0);return this.next&&(e+=this.next.sizeOf()),e}parse(e){return this.compiled||this.compile(),this.compiled(e,this.constructorFn)}setNextParser(e,t,i){const s=new Ya;return s.type=e,s.varName=t,s.options=i,s.endian=this.endian,this.head?this.head.next=s:this.next=s,this.head=s,this}generate(e){if(this.type){switch(this.type){case"uint8":case"uint16le":case"uint16be":case"uint32le":case"uint32be":case"int8":case"int16le":case"int16be":case"int32le":case"int32be":case"int64be":case"int64le":case"uint64be":case"uint64le":case"floatle":case"floatbe":case"doublele":case"doublebe":this.primitiveGenerateN(this.type,e);break;case"bit":this.generateBit(e);break;case"string":this.generateString(e);break;case"buffer":this.generateBuffer(e);break;case"seek":this.generateSeek(e);break;case"nest":this.generateNest(e);break;case"array":this.generateArray(e);break;case"choice":this.generateChoice(e);break;case"pointer":this.generatePointer(e);break;case"saveOffset":this.generateSaveOffset(e);break;case"wrapper":this.generateWrapper(e);break}this.type!=="bit"&&this.generateAssert(e)}const t=e.generateVariable(this.varName);return this.options.formatter&&this.type!=="bit"&&this.generateFormatter(e,t,this.options.formatter),this.generateNext(e)}generateAssert(e){if(!this.options.assert)return;const t=e.generateVariable(this.varName);switch(typeof this.options.assert){case"function":{const i=e.addImport(this.options.assert);e.pushCode(`if (!${i}.call(vars, ${t})) {`)}break;case"number":e.pushCode(`if (${this.options.assert} !== ${t}) {`);break;case"string":e.pushCode(`if (${JSON.stringify(this.options.assert)} !== ${t}) {`);break;default:throw new Error("assert option must be a string, number or a function.")}e.generateError(`"Assertion error: ${t} is " + ${JSON.stringify(this.options.assert.toString())}`),e.pushCode("}")}generateNext(e){return this.next&&(e=this.next.generate(e)),e}generateBit(e){const t=JSON.parse(JSON.stringify(this));if(t.options=this.options,t.generateAssert=this.generateAssert.bind(this),t.generateFormatter=this.generateFormatter.bind(this),t.varName=e.generateVariable(t.varName),e.bitFields.push(t),!this.next||this.next&&["bit","nest"].indexOf(this.next.type)<0){const i=e.generateTmpVariable();e.pushCode(`var ${i} = 0;`);const s=(u=0)=>{let h=0;for(let d=u;d<e.bitFields.length;d++){const f=e.bitFields[d].options.length;if(h+f>32)break;h+=f}return h},r=u=>(u<=8?(e.pushCode(`${i} = dataView.getUint8(offset);`),u=8):u<=16?(e.pushCode(`${i} = dataView.getUint16(offset);`),u=16):u<=24?(e.pushCode(`${i} = (dataView.getUint16(offset) << 8) | dataView.getUint8(offset + 2);`),u=24):(e.pushCode(`${i} = dataView.getUint32(offset);`),u=32),e.pushCode(`offset += ${u/8};`),u);let o=0;const a=this.endian==="be";let l=0,c=0;e.bitFields.forEach((u,h)=>{let d=u.options.length;if(d>c){if(c){const p=-1>>>32-c;e.pushCode(`${u.varName} = (${i} & 0x${p.toString(16)}) << ${d-c};`),d-=c}o=0,c=l=r(s(h)-c)}const f=a?l-o-d:o,g=-1>>>32-d;e.pushCode(`${u.varName} ${d<u.options.length?"|=":"="} ${i} >> ${f} & 0x${g.toString(16)};`),u.options.length===32&&e.pushCode(`${u.varName} >>>= 0`),u.options.assert&&u.generateAssert(e),u.options.formatter&&u.generateFormatter(e,u.varName,u.options.formatter),o+=d,c-=d}),e.bitFields=[]}}generateSeek(e){const t=e.generateOption(this.options.length);e.pushCode(`offset += ${t};`)}generateString(e){const t=e.generateVariable(this.varName),i=e.generateTmpVariable(),s=this.options.encoding,r=s.toLowerCase()==="hex",o='b => b.toString(16).padStart(2, "0")';if(this.options.length&&this.options.zeroTerminated){const a=this.options.length;e.pushCode(`var ${i} = offset;`),e.pushCode(`while(dataView.getUint8(offset++) !== 0 && offset - ${i} < ${a});`);const l=`offset - ${i} < ${a} ? offset - 1 : offset`;e.pushCode(r?`${t} = Array.from(buffer.subarray(${i}, ${l}), ${o}).join('');`:`${t} = new TextDecoder('${s}').decode(buffer.subarray(${i}, ${l}));`)}else if(this.options.length){const a=e.generateOption(this.options.length);e.pushCode(r?`${t} = Array.from(buffer.subarray(offset, offset + ${a}), ${o}).join('');`:`${t} = new TextDecoder('${s}').decode(buffer.subarray(offset, offset + ${a}));`),e.pushCode(`offset += ${a};`)}else this.options.zeroTerminated?(e.pushCode(`var ${i} = offset;`),e.pushCode("while(dataView.getUint8(offset++) !== 0);"),e.pushCode(r?`${t} = Array.from(buffer.subarray(${i}, offset - 1), ${o}).join('');`:`${t} = new TextDecoder('${s}').decode(buffer.subarray(${i}, offset - 1));`)):this.options.greedy&&(e.pushCode(`var ${i} = offset;`),e.pushCode("while(buffer.length > offset++);"),e.pushCode(r?`${t} = Array.from(buffer.subarray(${i}, offset), ${o}).join('');`:`${t} = new TextDecoder('${s}').decode(buffer.subarray(${i}, offset));`));this.options.stripNull&&e.pushCode(`${t} = ${t}.replace(/\\x00+$/g, '')`)}generateBuffer(e){const t=e.generateVariable(this.varName);if(typeof this.options.readUntil=="function"){const i=this.options.readUntil,s=e.generateTmpVariable(),r=e.generateTmpVariable();e.pushCode(`var ${s} = offset;`),e.pushCode(`var ${r} = 0;`),e.pushCode("while (offset < buffer.length) {"),e.pushCode(`${r} = dataView.getUint8(offset);`);const o=e.addImport(i);e.pushCode(`if (${o}.call(${e.generateVariable()}, ${r}, buffer.subarray(offset))) break;`),e.pushCode("offset += 1;"),e.pushCode("}"),e.pushCode(`${t} = buffer.subarray(${s}, offset);`)}else if(this.options.readUntil==="eof")e.pushCode(`${t} = buffer.subarray(offset);`);else{const i=e.generateOption(this.options.length);e.pushCode(`${t} = buffer.subarray(offset, offset + ${i});`),e.pushCode(`offset += ${i};`)}this.options.clone&&e.pushCode(`${t} = buffer.constructor.from(${t});`)}generateArray(e){const t=e.generateOption(this.options.length),i=e.generateOption(this.options.lengthInBytes),s=this.options.type,r=e.generateTmpVariable(),o=e.generateVariable(this.varName),a=e.generateTmpVariable(),l=this.options.key,c=typeof l=="string";if(c?e.pushCode(`${o} = {};`):e.pushCode(`${o} = [];`),typeof this.options.readUntil=="function"?e.pushCode("do {"):this.options.readUntil==="eof"?e.pushCode(`for (var ${r} = 0; offset < buffer.length; ${r}++) {`):i!==void 0?e.pushCode(`for (var ${r} = offset + ${i}; offset < ${r}; ) {`):e.pushCode(`for (var ${r} = ${t}; ${r} > 0; ${r}--) {`),typeof s=="string")if(ja.get(s)){const u=e.generateTmpVariable();if(e.pushCode(`var ${u} = ${Bf+s}(offset, {`),e.useContextVariables){const h=e.generateVariable();e.pushCode(`$parent: ${h},`),e.pushCode(`$root: ${h}.$root,`),!this.options.readUntil&&i===void 0&&e.pushCode(`$index: ${t} - ${r},`)}e.pushCode("});"),e.pushCode(`var ${a} = ${u}.result; offset = ${u}.offset;`),s!==this.alias&&e.addReference(s)}else{const u=ox[s],h=ax[s];e.pushCode(`var ${a} = dataView.get${u}(offset, ${h});`),e.pushCode(`offset += ${qa[s]};`)}else if(s instanceof Ya){e.pushCode(`var ${a} = {};`);const u=e.generateVariable();e.pushScope(a),e.useContextVariables&&(e.pushCode(`${a}.$parent = ${u};`),e.pushCode(`${a}.$root = ${u}.$root;`),!this.options.readUntil&&i===void 0&&e.pushCode(`${a}.$index = ${t} - ${r};`)),s.generate(e),e.useContextVariables&&(e.pushCode(`delete ${a}.$parent;`),e.pushCode(`delete ${a}.$root;`),e.pushCode(`delete ${a}.$index;`)),e.popScope()}if(c?e.pushCode(`${o}[${a}.${l}] = ${a};`):e.pushCode(`${o}.push(${a});`),e.pushCode("}"),typeof this.options.readUntil=="function"){const u=this.options.readUntil,h=e.addImport(u);e.pushCode(`while (!${h}.call(${e.generateVariable()}, ${a}, buffer.subarray(offset)));`)}}generateChoiceCase(e,t,i){if(typeof i=="string"){const s=e.generateVariable(this.varName);if(ja.has(i)){const r=e.generateTmpVariable();e.pushCode(`var ${r} = ${Bf+i}(offset, {`),e.useContextVariables&&(e.pushCode(`$parent: ${s}.$parent,`),e.pushCode(`$root: ${s}.$root,`)),e.pushCode("});"),e.pushCode(`${s} = ${r}.result; offset = ${r}.offset;`),i!==this.alias&&e.addReference(i)}else{const r=ox[i],o=ax[i];e.pushCode(`${s} = dataView.get${r}(offset, ${o});`),e.pushCode(`offset += ${qa[i]}`)}}else i instanceof Ya&&(e.pushPath(t),i.generate(e),e.popPath(t))}generateChoice(e){const t=e.generateOption(this.options.tag),i=e.generateVariable(this.varName);if(this.varName&&(e.pushCode(`${i} = {};`),e.useContextVariables)){const s=e.generateVariable();e.pushCode(`${i}.$parent = ${s};`),e.pushCode(`${i}.$root = ${s}.$root;`)}e.pushCode(`switch(${t}) {`);for(const s in this.options.choices){const r=parseInt(s,10),o=this.options.choices[r];e.pushCode(`case ${r}:`),this.generateChoiceCase(e,this.varName,o),e.pushCode("break;")}e.pushCode("default:"),this.options.defaultChoice?this.generateChoiceCase(e,this.varName,this.options.defaultChoice):e.generateError(`"Met undefined tag value " + ${t} + " at choice"`),e.pushCode("}"),this.varName&&e.useContextVariables&&(e.pushCode(`delete ${i}.$parent;`),e.pushCode(`delete ${i}.$root;`))}generateNest(e){const t=e.generateVariable(this.varName);if(this.options.type instanceof Ya){if(this.varName&&(e.pushCode(`${t} = {};`),e.useContextVariables)){const i=e.generateVariable();e.pushCode(`${t}.$parent = ${i};`),e.pushCode(`${t}.$root = ${i}.$root;`)}e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName),this.varName&&e.useContextVariables&&e.useContextVariables&&(e.pushCode(`delete ${t}.$parent;`),e.pushCode(`delete ${t}.$root;`))}else if(ja.has(this.options.type)){const i=e.generateTmpVariable();if(e.pushCode(`var ${i} = ${Bf+this.options.type}(offset, {`),e.useContextVariables){const s=e.generateVariable();e.pushCode(`$parent: ${s},`),e.pushCode(`$root: ${s}.$root,`)}e.pushCode("});"),e.pushCode(`${t} = ${i}.result; offset = ${i}.offset;`),this.options.type!==this.alias&&e.addReference(this.options.type)}}generateWrapper(e){const t=e.generateVariable(this.varName),i=e.generateTmpVariable();if(typeof this.options.readUntil=="function"){const l=this.options.readUntil,c=e.generateTmpVariable(),u=e.generateTmpVariable();e.pushCode(`var ${c} = offset;`),e.pushCode(`var ${u} = 0;`),e.pushCode("while (offset < buffer.length) {"),e.pushCode(`${u} = dataView.getUint8(offset);`);const h=e.addImport(l);e.pushCode(`if (${h}.call(${e.generateVariable()}, ${u}, buffer.subarray(offset))) break;`),e.pushCode("offset += 1;"),e.pushCode("}"),e.pushCode(`${i} = buffer.subarray(${c}, offset);`)}else if(this.options.readUntil==="eof")e.pushCode(`${i} = buffer.subarray(offset);`);else{const l=e.generateOption(this.options.length);e.pushCode(`${i} = buffer.subarray(offset, offset + ${l});`),e.pushCode(`offset += ${l};`)}this.options.clone&&e.pushCode(`${i} = buffer.constructor.from(${i});`);const s=e.generateTmpVariable(),r=e.generateTmpVariable(),o=e.generateTmpVariable(),a=e.addImport(this.options.wrapper);if(e.pushCode(`${i} = ${a}.call(this, ${i}).subarray(0);`),e.pushCode(`var ${s} = buffer;`),e.pushCode(`var ${r} = offset;`),e.pushCode(`var ${o} = dataView;`),e.pushCode(`buffer = ${i};`),e.pushCode("offset = 0;"),e.pushCode("dataView = new DataView(buffer.buffer, buffer.byteOffset, buffer.length);"),this.options.type instanceof Ya)this.varName&&e.pushCode(`${t} = {};`),e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName);else if(ja.has(this.options.type)){const l=e.generateTmpVariable();e.pushCode(`var ${l} = ${Bf+this.options.type}(0);`),e.pushCode(`${t} = ${l}.result;`),this.options.type!==this.alias&&e.addReference(this.options.type)}e.pushCode(`buffer = ${s};`),e.pushCode(`dataView = ${o};`),e.pushCode(`offset = ${r};`)}generateFormatter(e,t,i){if(typeof i=="function"){const s=e.addImport(i);e.pushCode(`${t} = ${s}.call(${e.generateVariable()}, ${t});`)}}generatePointer(e){const t=this.options.type,i=e.generateOption(this.options.offset),s=e.generateTmpVariable(),r=e.generateVariable(this.varName);if(e.pushCode(`var ${s} = offset;`),e.pushCode(`offset = ${i};`),this.options.type instanceof Ya){if(e.pushCode(`${r} = {};`),e.useContextVariables){const o=e.generateVariable();e.pushCode(`${r}.$parent = ${o};`),e.pushCode(`${r}.$root = ${o}.$root;`)}e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName),e.useContextVariables&&(e.pushCode(`delete ${r}.$parent;`),e.pushCode(`delete ${r}.$root;`))}else if(ja.has(this.options.type)){const o=e.generateTmpVariable();if(e.pushCode(`var ${o} = ${Bf+this.options.type}(offset, {`),e.useContextVariables){const a=e.generateVariable();e.pushCode(`$parent: ${a},`),e.pushCode(`$root: ${a}.$root,`)}e.pushCode("});"),e.pushCode(`${r} = ${o}.result; offset = ${o}.offset;`),this.options.type!==this.alias&&e.addReference(this.options.type)}else if(Object.keys(qa).indexOf(this.options.type)>=0){const o=ox[t],a=ax[t];e.pushCode(`${r} = dataView.get${o}(offset, ${a});`),e.pushCode(`offset += ${qa[t]};`)}e.pushCode(`offset = ${s};`)}generateSaveOffset(e){const t=e.generateVariable(this.varName);e.pushCode(`${t} = offset`)}};var EJ={},w6={},vp={},tS={};Object.defineProperty(tS,"__esModule",{value:!0});function y6(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function ZV(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function C6(n,e,t){return e&&ZV(n.prototype,e),t&&ZV(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function zCe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&d4(n,e)}function B_(n){return B_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B_(n)}function d4(n,e){return d4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},d4(n,e)}function HCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Y1(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function UCe(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y1(n)}function jCe(n){var e=HCe();return function(){var i=B_(n),s;if(e){var r=B_(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return UCe(this,s)}}function qCe(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&(n=B_(n),n!==null););return n}function W2(){return typeof Reflect<"u"&&Reflect.get?W2=Reflect.get.bind():W2=function(e,t,i){var s=qCe(e,t);if(s){var r=Object.getOwnPropertyDescriptor(s,t);return r.get?r.get.call(arguments.length<3?e:i):r.value}},W2.apply(this,arguments)}var YV=function(){function n(){y6(this,n),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return C6(n,[{key:"addEventListener",value:function(t,i,s){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push({callback:i,options:s})}},{key:"removeEventListener",value:function(t,i){if(t in this.listeners){for(var s=this.listeners[t],r=0,o=s.length;r<o;r++)if(s[r].callback===i){s.splice(r,1);return}}}},{key:"dispatchEvent",value:function(t){if(t.type in this.listeners){for(var i=this.listeners[t.type],s=i.slice(),r=0,o=s.length;r<o;r++){var a=s[r];try{a.callback.call(this,t)}catch(l){Promise.resolve().then(function(){throw l})}a.options&&a.options.once&&this.removeEventListener(t.type,a.callback)}return!t.defaultPrevented}}}]),n}(),S6=function(n){zCe(t,n);var e=jCe(t);function t(){var i;return y6(this,t),i=e.call(this),i.listeners||YV.call(Y1(i)),Object.defineProperty(Y1(i),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(Y1(i),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(Y1(i),"reason",{value:void 0,writable:!0,configurable:!0}),i}return C6(t,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(s){s.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,s)),W2(B_(t.prototype),"dispatchEvent",this).call(this,s)}}]),t}(YV),TJ=function(){function n(){y6(this,n),Object.defineProperty(this,"signal",{value:new S6,writable:!0,configurable:!0})}return C6(n,[{key:"abort",value:function(t){var i;try{i=new Event("abort")}catch{typeof document<"u"?document.createEvent?(i=document.createEvent("Event"),i.initEvent("abort",!1,!1)):(i=document.createEventObject(),i.type="abort"):i={type:"abort",bubbles:!1,cancelable:!1}}var s=t;if(s===void 0)if(typeof document>"u")s=new Error("This operation was aborted"),s.name="AbortError";else try{s=new DOMException("signal is aborted without reason")}catch{s=new Error("This operation was aborted"),s.name="AbortError"}this.signal.reason=s,this.signal.dispatchEvent(i)}},{key:"toString",value:function(){return"[object AbortController]"}}]),n}();typeof Symbol<"u"&&Symbol.toStringTag&&(TJ.prototype[Symbol.toStringTag]="AbortController",S6.prototype[Symbol.toStringTag]="AbortSignal");function GCe(n){return n.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof n.Request=="function"&&!n.Request.prototype.hasOwnProperty("signal")||!n.AbortController}function KCe(n){typeof n=="function"&&(n={fetch:n});var e=n,t=e.fetch,i=e.Request,s=i===void 0?t.Request:i,r=e.AbortController,o=e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=o===void 0?!1:o;if(!GCe({fetch:t,Request:s,AbortController:r,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return{fetch:t,Request:l};var l=s;(l&&!l.prototype.hasOwnProperty("signal")||a)&&(l=function(d,f){var g;f&&f.signal&&(g=f.signal,delete f.signal);var p=new s(d,f);return g&&Object.defineProperty(p,"signal",{writable:!1,enumerable:!1,configurable:!0,value:g}),p},l.prototype=s.prototype);var c=t,u=function(d,f){var g=l&&l.prototype.isPrototypeOf(d)?d.signal:f?f.signal:void 0;if(g){var p;try{p=new DOMException("Aborted","AbortError")}catch{p=new Error("Aborted"),p.name="AbortError"}if(g.aborted)return Promise.reject(p);var m=new Promise(function(b,v){g.addEventListener("abort",function(){return v(p)},{once:!0})});return f&&f.signal&&delete f.signal,Promise.race([m,c(d,f)])}return c(d,f)};return{fetch:u,Request:l}}tS.AbortController=TJ;tS.AbortSignal=S6;tS.abortableFetch=KCe;Object.defineProperty(vp,"__esModule",{value:!0});vp.AbortSignal=vp.AbortController=void 0;const AJ=tS;var lL=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate globalThis object")};let ZCe=typeof lL().AbortController>"u"?AJ.AbortController:lL().AbortController;vp.AbortController=ZCe;let YCe=typeof lL().AbortController>"u"?AJ.AbortSignal:lL().AbortSignal;vp.AbortSignal=YCe;var x6={};Object.defineProperty(x6,"__esModule",{value:!0});const XCe=vp;class QCe{}class JCe{constructor(){this.signals=new Set,this.abortController=new XCe.AbortController}addSignal(e=new QCe){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):typeof e.addEventListener=="function"&&e.addEventListener("abort",()=>{this.handleAborted(e)})}handleAborted(e){this.signals.delete(e),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}x6.default=JCe;var k6={};Object.defineProperty(k6,"__esModule",{value:!0});class eSe{constructor(){this.callbacks=new Set}addCallback(e=()=>{}){this.callbacks.add(e),e(this.currentMessage)}callback(e){this.currentMessage=e,this.callbacks.forEach(t=>{t(e)})}}k6.default=eSe;var IJ=$w&&$w.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(w6,"__esModule",{value:!0});const tSe=vp,iSe=IJ(x6),nSe=IJ(k6);class cL{constructor({fill:e,cache:t}){if(typeof e!="function")throw new TypeError("must pass a fill function");if(typeof t!="object")throw new TypeError("must pass a cache object");if(typeof t.get!="function"||typeof t.set!="function"||typeof t.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=t,this.fillCallback=e}static isAbortException(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}evict(e,t){this.cache.get(e)===t&&this.cache.delete(e)}fill(e,t,i,s){const r=new iSe.default,o=new nSe.default;o.addCallback(s);const a={aborter:r,promise:this.fillCallback(t,r.signal,l=>{o.callback(l)}),settled:!1,statusReporter:o,get aborted(){return this.aborter.signal.aborted}};a.aborter.addSignal(i),a.aborter.signal.addEventListener("abort",()=>{a.settled||this.evict(e,a)}),a.promise.then(()=>{a.settled=!0},()=>{a.settled=!0,this.evict(e,a)}).catch(l=>{throw console.error(l),l}),this.cache.set(e,a)}static checkSinglePromise(e,t){function i(){if(t&&t.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then(s=>(i(),s),s=>{throw i(),s})}has(e){return this.cache.has(e)}get(e,t,i,s){if(!i&&t instanceof tSe.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const r=this.cache.get(e);return r?r.aborted&&!r.settled?(this.evict(e,r),this.get(e,t,i,s)):r.settled?r.promise:(r.aborter.addSignal(i),r.statusReporter.addCallback(s),cL.checkSinglePromise(r.promise,i)):(this.fill(e,t,i,s),cL.checkSinglePromise(this.cache.get(e).promise,i))}delete(e){const t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}clear(){const e=this.cache.keys();let t=0;for(let i=e.next();!i.done;i=e.next())this.delete(i.value),t+=1;return t}}w6.default=cL;var sSe=$w&&$w.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(EJ,"__esModule",{value:!0});const rSe=sSe(w6);var iT=EJ.default=rSe.default;let oSe=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return this._size+e}};var aSe=oSe;const L6=Up(aSe);let XV=class Ym{constructor(e,t){this.ranges=arguments.length===2?[{min:e,max:t}]:0 in e?Object.assign({},e):[e]}min(){return this.ranges[0].min}max(){return this.ranges[this.ranges.length-1].max}contains(e){for(let t=0;t<this.ranges.length;t+=1){const i=this.ranges[t];if(i.min<=e&&i.max>=e)return!0}return!1}isContiguous(){return this.ranges.length>1}getRanges(){return this.ranges.map(e=>new Ym(e.min,e.max))}toString(){return this.ranges.map(e=>`[${e.min}-${e.max}]`).join(",")}union(e){const t=this.getRanges().concat(e.getRanges()).sort(this.rangeOrder),i=[];let s=t[0];for(let r=1;r<t.length;r+=1){const o=t[r];o.min()>s.max()+1?(i.push(s),s=o):o.max()>s.max()&&(s=new Ym(s.min(),o.max()))}return i.push(s),i.length===1?i[0]:new Ym(i)}intersection(e){let t=this,i=e;const s=this.ranges(),r=i.ranges(),o=s.length,a=r.length;let l=0,c=0;const u=[];for(;l<o&&c<a;){t=s[l],i=r[c];const h=Math.max(t.min(),i.min()),d=Math.min(t.max(),i.max());d>=h&&u.push(new Ym(h,d)),t.max()>i.max()?c+=1:l+=1}if(u.length===0)throw new Error("found range of length 0");return u.length===1?u[0]:new Ym(u)}coverage(){let e=0;const t=this.ranges();for(const i of t)e+=i.max()-i.min()+1;return e}rangeOrder(e,t){let i=e,s=t;return arguments.length<2&&(s=i,i=this),i.min()<s.min()?-1:i.min()>s.min()?1:i.max()<s.max()?-1:s.max()>i.max()?1:0}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const lSe=4,QV=0,JV=1,cSe=2;function Pb(n){let e=n.length;for(;--e>=0;)n[e]=0}const uSe=0,NJ=1,hSe=2,dSe=3,fSe=258,D6=29,iS=256,Gw=iS+1+D6,V0=30,E6=19,RJ=2*Gw+1,yg=15,II=16,gSe=7,T6=256,MJ=16,FJ=17,PJ=18,f4=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),V2=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),pSe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),OJ=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mSe=512,mu=new Array((Gw+2)*2);Pb(mu);const Bv=new Array(V0*2);Pb(Bv);const Kw=new Array(mSe);Pb(Kw);const Zw=new Array(fSe-dSe+1);Pb(Zw);const A6=new Array(D6);Pb(A6);const uL=new Array(V0);Pb(uL);function NI(n,e,t,i,s){this.static_tree=n,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=s,this.has_stree=n&&n.length}let BJ,WJ,VJ;function RI(n,e){this.dyn_tree=n,this.max_code=0,this.stat_desc=e}const $J=n=>n<256?Kw[n]:Kw[256+(n>>>7)],Yw=(n,e)=>{n.pending_buf[n.pending++]=e&255,n.pending_buf[n.pending++]=e>>>8&255},oo=(n,e,t)=>{n.bi_valid>II-t?(n.bi_buf|=e<<n.bi_valid&65535,Yw(n,n.bi_buf),n.bi_buf=e>>II-n.bi_valid,n.bi_valid+=t-II):(n.bi_buf|=e<<n.bi_valid&65535,n.bi_valid+=t)},nc=(n,e,t)=>{oo(n,t[e*2],t[e*2+1])},zJ=(n,e)=>{let t=0;do t|=n&1,n>>>=1,t<<=1;while(--e>0);return t>>>1},_Se=n=>{n.bi_valid===16?(Yw(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},bSe=(n,e)=>{const t=e.dyn_tree,i=e.max_code,s=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let c,u,h,d,f,g,p=0;for(d=0;d<=yg;d++)n.bl_count[d]=0;for(t[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<RJ;c++)u=n.heap[c],d=t[t[u*2+1]*2+1]+1,d>l&&(d=l,p++),t[u*2+1]=d,!(u>i)&&(n.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),g=t[u*2],n.opt_len+=g*(d+f),r&&(n.static_len+=g*(s[u*2+1]+f)));if(p!==0){do{for(d=l-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[l]--,p-=2}while(p>0);for(d=l;d!==0;d--)for(u=n.bl_count[d];u!==0;)h=n.heap[--c],!(h>i)&&(t[h*2+1]!==d&&(n.opt_len+=(d-t[h*2+1])*t[h*2],t[h*2+1]=d),u--)}},HJ=(n,e,t)=>{const i=new Array(yg+1);let s=0,r,o;for(r=1;r<=yg;r++)s=s+t[r-1]<<1,i[r]=s;for(o=0;o<=e;o++){let a=n[o*2+1];a!==0&&(n[o*2]=zJ(i[a]++,a))}},vSe=()=>{let n,e,t,i,s;const r=new Array(yg+1);for(t=0,i=0;i<D6-1;i++)for(A6[i]=t,n=0;n<1<<f4[i];n++)Zw[t++]=i;for(Zw[t-1]=i,s=0,i=0;i<16;i++)for(uL[i]=s,n=0;n<1<<V2[i];n++)Kw[s++]=i;for(s>>=7;i<V0;i++)for(uL[i]=s<<7,n=0;n<1<<V2[i]-7;n++)Kw[256+s++]=i;for(e=0;e<=yg;e++)r[e]=0;for(n=0;n<=143;)mu[n*2+1]=8,n++,r[8]++;for(;n<=255;)mu[n*2+1]=9,n++,r[9]++;for(;n<=279;)mu[n*2+1]=7,n++,r[7]++;for(;n<=287;)mu[n*2+1]=8,n++,r[8]++;for(HJ(mu,Gw+1,r),n=0;n<V0;n++)Bv[n*2+1]=5,Bv[n*2]=zJ(n,5);BJ=new NI(mu,f4,iS+1,Gw,yg),WJ=new NI(Bv,V2,0,V0,yg),VJ=new NI(new Array(0),pSe,0,E6,gSe)},UJ=n=>{let e;for(e=0;e<Gw;e++)n.dyn_ltree[e*2]=0;for(e=0;e<V0;e++)n.dyn_dtree[e*2]=0;for(e=0;e<E6;e++)n.bl_tree[e*2]=0;n.dyn_ltree[T6*2]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},jJ=n=>{n.bi_valid>8?Yw(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},e$=(n,e,t,i)=>{const s=e*2,r=t*2;return n[s]<n[r]||n[s]===n[r]&&i[e]<=i[t]},MI=(n,e,t)=>{const i=n.heap[t];let s=t<<1;for(;s<=n.heap_len&&(s<n.heap_len&&e$(e,n.heap[s+1],n.heap[s],n.depth)&&s++,!e$(e,i,n.heap[s],n.depth));)n.heap[t]=n.heap[s],t=s,s<<=1;n.heap[t]=i},t$=(n,e,t)=>{let i,s,r=0,o,a;if(n.sym_next!==0)do i=n.pending_buf[n.sym_buf+r++]&255,i+=(n.pending_buf[n.sym_buf+r++]&255)<<8,s=n.pending_buf[n.sym_buf+r++],i===0?nc(n,s,e):(o=Zw[s],nc(n,o+iS+1,e),a=f4[o],a!==0&&(s-=A6[o],oo(n,s,a)),i--,o=$J(i),nc(n,o,t),a=V2[o],a!==0&&(i-=uL[o],oo(n,i,a)));while(r<n.sym_next);nc(n,T6,e)},g4=(n,e)=>{const t=e.dyn_tree,i=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,a,l=-1,c;for(n.heap_len=0,n.heap_max=RJ,o=0;o<r;o++)t[o*2]!==0?(n.heap[++n.heap_len]=l=o,n.depth[o]=0):t[o*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,t[c*2]=1,n.depth[c]=0,n.opt_len--,s&&(n.static_len-=i[c*2+1]);for(e.max_code=l,o=n.heap_len>>1;o>=1;o--)MI(n,t,o);c=r;do o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],MI(n,t,1),a=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=a,t[c*2]=t[o*2]+t[a*2],n.depth[c]=(n.depth[o]>=n.depth[a]?n.depth[o]:n.depth[a])+1,t[o*2+1]=t[a*2+1]=c,n.heap[1]=c++,MI(n,t,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],bSe(n,e),HJ(t,l,n.bl_count)},i$=(n,e,t)=>{let i,s=-1,r,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)r=o,o=e[(i+1)*2+1],!(++a<l&&r===o)&&(a<c?n.bl_tree[r*2]+=a:r!==0?(r!==s&&n.bl_tree[r*2]++,n.bl_tree[MJ*2]++):a<=10?n.bl_tree[FJ*2]++:n.bl_tree[PJ*2]++,a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},n$=(n,e,t)=>{let i,s=-1,r,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=t;i++)if(r=o,o=e[(i+1)*2+1],!(++a<l&&r===o)){if(a<c)do nc(n,r,n.bl_tree);while(--a!==0);else r!==0?(r!==s&&(nc(n,r,n.bl_tree),a--),nc(n,MJ,n.bl_tree),oo(n,a-3,2)):a<=10?(nc(n,FJ,n.bl_tree),oo(n,a-3,3)):(nc(n,PJ,n.bl_tree),oo(n,a-11,7));a=0,s=r,o===0?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}},wSe=n=>{let e;for(i$(n,n.dyn_ltree,n.l_desc.max_code),i$(n,n.dyn_dtree,n.d_desc.max_code),g4(n,n.bl_desc),e=E6-1;e>=3&&n.bl_tree[OJ[e]*2+1]===0;e--);return n.opt_len+=3*(e+1)+5+5+4,e},ySe=(n,e,t,i)=>{let s;for(oo(n,e-257,5),oo(n,t-1,5),oo(n,i-4,4),s=0;s<i;s++)oo(n,n.bl_tree[OJ[s]*2+1],3);n$(n,n.dyn_ltree,e-1),n$(n,n.dyn_dtree,t-1)},CSe=n=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&n.dyn_ltree[t*2]!==0)return QV;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return JV;for(t=32;t<iS;t++)if(n.dyn_ltree[t*2]!==0)return JV;return QV};let s$=!1;const SSe=n=>{s$||(vSe(),s$=!0),n.l_desc=new RI(n.dyn_ltree,BJ),n.d_desc=new RI(n.dyn_dtree,WJ),n.bl_desc=new RI(n.bl_tree,VJ),n.bi_buf=0,n.bi_valid=0,UJ(n)},qJ=(n,e,t,i)=>{oo(n,(uSe<<1)+(i?1:0),3),jJ(n),Yw(n,t),Yw(n,~t),t&&n.pending_buf.set(n.window.subarray(e,e+t),n.pending),n.pending+=t},xSe=n=>{oo(n,NJ<<1,3),nc(n,T6,mu),_Se(n)},kSe=(n,e,t,i)=>{let s,r,o=0;n.level>0?(n.strm.data_type===cSe&&(n.strm.data_type=CSe(n)),g4(n,n.l_desc),g4(n,n.d_desc),o=wSe(n),s=n.opt_len+3+7>>>3,r=n.static_len+3+7>>>3,r<=s&&(s=r)):s=r=t+5,t+4<=s&&e!==-1?qJ(n,e,t,i):n.strategy===lSe||r===s?(oo(n,(NJ<<1)+(i?1:0),3),t$(n,mu,Bv)):(oo(n,(hSe<<1)+(i?1:0),3),ySe(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),t$(n,n.dyn_ltree,n.dyn_dtree)),UJ(n),i&&jJ(n)},LSe=(n,e,t)=>(n.pending_buf[n.sym_buf+n.sym_next++]=e,n.pending_buf[n.sym_buf+n.sym_next++]=e>>8,n.pending_buf[n.sym_buf+n.sym_next++]=t,e===0?n.dyn_ltree[t*2]++:(n.matches++,e--,n.dyn_ltree[(Zw[t]+iS+1)*2]++,n.dyn_dtree[$J(e)*2]++),n.sym_next===n.sym_end);var DSe=SSe,ESe=qJ,TSe=kSe,ASe=LSe,ISe=xSe,NSe={_tr_init:DSe,_tr_stored_block:ESe,_tr_flush_block:TSe,_tr_tally:ASe,_tr_align:ISe};const RSe=(n,e,t,i)=>{let s=n&65535|0,r=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do s=s+e[i++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0};var Xw=RSe;const MSe=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},FSe=new Uint32Array(MSe()),PSe=(n,e,t,i)=>{const s=FSe,r=i+t;n^=-1;for(let o=i;o<r;o++)n=n>>>8^s[(n^e[o])&255];return n^-1};var Ss=PSe,W_={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},nS={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:OSe,_tr_stored_block:p4,_tr_flush_block:BSe,_tr_tally:yd,_tr_align:WSe}=NSe,{Z_NO_FLUSH:Cd,Z_PARTIAL_FLUSH:VSe,Z_FULL_FLUSH:$Se,Z_FINISH:ra,Z_BLOCK:r$,Z_OK:Fs,Z_STREAM_END:o$,Z_STREAM_ERROR:kc,Z_DATA_ERROR:zSe,Z_BUF_ERROR:FI,Z_DEFAULT_COMPRESSION:HSe,Z_FILTERED:USe,Z_HUFFMAN_ONLY:lx,Z_RLE:jSe,Z_FIXED:qSe,Z_DEFAULT_STRATEGY:GSe,Z_UNKNOWN:KSe,Z_DEFLATED:nT}=nS,ZSe=9,YSe=15,XSe=8,QSe=29,JSe=256,m4=JSe+1+QSe,exe=30,txe=19,ixe=2*m4+1,nxe=15,Xt=3,id=258,Lc=id+Xt+1,sxe=32,V_=42,I6=57,_4=69,b4=73,v4=91,w4=103,Cg=113,X1=666,Rr=1,Ob=2,wp=3,Bb=4,rxe=3,Sg=(n,e)=>(n.msg=W_[e],e),a$=n=>n*2-(n>4?9:0),qh=n=>{let e=n.length;for(;--e>=0;)n[e]=0},oxe=n=>{let e,t,i,s=n.w_size;e=n.hash_size,i=e;do t=n.head[--i],n.head[i]=t>=s?t-s:0;while(--e);e=s,i=e;do t=n.prev[--i],n.prev[i]=t>=s?t-s:0;while(--e)};let axe=(n,e,t)=>(e<<n.hash_shift^t)&n.hash_mask,Sd=axe;const ko=n=>{const e=n.state;let t=e.pending;t>n.avail_out&&(t=n.avail_out),t!==0&&(n.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),n.next_out),n.next_out+=t,e.pending_out+=t,n.total_out+=t,n.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},Mo=(n,e)=>{BSe(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,e),n.block_start=n.strstart,ko(n.strm)},bi=(n,e)=>{n.pending_buf[n.pending++]=e},m1=(n,e)=>{n.pending_buf[n.pending++]=e>>>8&255,n.pending_buf[n.pending++]=e&255},y4=(n,e,t,i)=>{let s=n.avail_in;return s>i&&(s=i),s===0?0:(n.avail_in-=s,e.set(n.input.subarray(n.next_in,n.next_in+s),t),n.state.wrap===1?n.adler=Xw(n.adler,e,s,t):n.state.wrap===2&&(n.adler=Ss(n.adler,e,s,t)),n.next_in+=s,n.total_in+=s,s)},GJ=(n,e)=>{let t=n.max_chain_length,i=n.strstart,s,r,o=n.prev_length,a=n.nice_match;const l=n.strstart>n.w_size-Lc?n.strstart-(n.w_size-Lc):0,c=n.window,u=n.w_mask,h=n.prev,d=n.strstart+id;let f=c[i+o-1],g=c[i+o];n.prev_length>=n.good_match&&(t>>=2),a>n.lookahead&&(a=n.lookahead);do if(s=e,!(c[s+o]!==g||c[s+o-1]!==f||c[s]!==c[i]||c[++s]!==c[i+1])){i+=2,s++;do;while(c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&c[++i]===c[++s]&&i<d);if(r=id-(d-i),i=d-id,r>o){if(n.match_start=e,o=r,r>=a)break;f=c[i+o-1],g=c[i+o]}}while((e=h[e&u])>l&&--t!==0);return o<=n.lookahead?o:n.lookahead},$_=n=>{const e=n.w_size;let t,i,s;do{if(i=n.window_size-n.lookahead-n.strstart,n.strstart>=e+(e-Lc)&&(n.window.set(n.window.subarray(e,e+e-i),0),n.match_start-=e,n.strstart-=e,n.block_start-=e,n.insert>n.strstart&&(n.insert=n.strstart),oxe(n),i+=e),n.strm.avail_in===0)break;if(t=y4(n.strm,n.window,n.strstart+n.lookahead,i),n.lookahead+=t,n.lookahead+n.insert>=Xt)for(s=n.strstart-n.insert,n.ins_h=n.window[s],n.ins_h=Sd(n,n.ins_h,n.window[s+1]);n.insert&&(n.ins_h=Sd(n,n.ins_h,n.window[s+Xt-1]),n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++,n.insert--,!(n.lookahead+n.insert<Xt)););}while(n.lookahead<Lc&&n.strm.avail_in!==0)},KJ=(n,e)=>{let t=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,i,s,r,o=0,a=n.strm.avail_in;do{if(i=65535,r=n.bi_valid+42>>3,n.strm.avail_out<r||(r=n.strm.avail_out-r,s=n.strstart-n.block_start,i>s+n.strm.avail_in&&(i=s+n.strm.avail_in),i>r&&(i=r),i<t&&(i===0&&e!==ra||e===Cd||i!==s+n.strm.avail_in)))break;o=e===ra&&i===s+n.strm.avail_in?1:0,p4(n,0,0,o),n.pending_buf[n.pending-4]=i,n.pending_buf[n.pending-3]=i>>8,n.pending_buf[n.pending-2]=~i,n.pending_buf[n.pending-1]=~i>>8,ko(n.strm),s&&(s>i&&(s=i),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+s),n.strm.next_out),n.strm.next_out+=s,n.strm.avail_out-=s,n.strm.total_out+=s,n.block_start+=s,i-=s),i&&(y4(n.strm,n.strm.output,n.strm.next_out,i),n.strm.next_out+=i,n.strm.avail_out-=i,n.strm.total_out+=i)}while(o===0);return a-=n.strm.avail_in,a&&(a>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=a&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-a,n.strm.next_in),n.strstart),n.strstart+=a,n.insert+=a>n.w_size-n.insert?n.w_size-n.insert:a),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),o?Bb:e!==Cd&&e!==ra&&n.strm.avail_in===0&&n.strstart===n.block_start?Ob:(r=n.window_size-n.strstart,n.strm.avail_in>r&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,r+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),r>n.strm.avail_in&&(r=n.strm.avail_in),r&&(y4(n.strm,n.window,n.strstart,r),n.strstart+=r,n.insert+=r>n.w_size-n.insert?n.w_size-n.insert:r),n.high_water<n.strstart&&(n.high_water=n.strstart),r=n.bi_valid+42>>3,r=n.pending_buf_size-r>65535?65535:n.pending_buf_size-r,t=r>n.w_size?n.w_size:r,s=n.strstart-n.block_start,(s>=t||(s||e===ra)&&e!==Cd&&n.strm.avail_in===0&&s<=r)&&(i=s>r?r:s,o=e===ra&&n.strm.avail_in===0&&i===s?1:0,p4(n,n.block_start,i,o),n.block_start+=i,ko(n.strm)),o?wp:Rr)},PI=(n,e)=>{let t,i;for(;;){if(n.lookahead<Lc){if($_(n),n.lookahead<Lc&&e===Cd)return Rr;if(n.lookahead===0)break}if(t=0,n.lookahead>=Xt&&(n.ins_h=Sd(n,n.ins_h,n.window[n.strstart+Xt-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),t!==0&&n.strstart-t<=n.w_size-Lc&&(n.match_length=GJ(n,t)),n.match_length>=Xt)if(i=yd(n,n.strstart-n.match_start,n.match_length-Xt),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Xt){n.match_length--;do n.strstart++,n.ins_h=Sd(n,n.ins_h,n.window[n.strstart+Xt-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=Sd(n,n.ins_h,n.window[n.strstart+1]);else i=yd(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(Mo(n,!1),n.strm.avail_out===0))return Rr}return n.insert=n.strstart<Xt-1?n.strstart:Xt-1,e===ra?(Mo(n,!0),n.strm.avail_out===0?wp:Bb):n.sym_next&&(Mo(n,!1),n.strm.avail_out===0)?Rr:Ob},Im=(n,e)=>{let t,i,s;for(;;){if(n.lookahead<Lc){if($_(n),n.lookahead<Lc&&e===Cd)return Rr;if(n.lookahead===0)break}if(t=0,n.lookahead>=Xt&&(n.ins_h=Sd(n,n.ins_h,n.window[n.strstart+Xt-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Xt-1,t!==0&&n.prev_length<n.max_lazy_match&&n.strstart-t<=n.w_size-Lc&&(n.match_length=GJ(n,t),n.match_length<=5&&(n.strategy===USe||n.match_length===Xt&&n.strstart-n.match_start>4096)&&(n.match_length=Xt-1)),n.prev_length>=Xt&&n.match_length<=n.prev_length){s=n.strstart+n.lookahead-Xt,i=yd(n,n.strstart-1-n.prev_match,n.prev_length-Xt),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=s&&(n.ins_h=Sd(n,n.ins_h,n.window[n.strstart+Xt-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=Xt-1,n.strstart++,i&&(Mo(n,!1),n.strm.avail_out===0))return Rr}else if(n.match_available){if(i=yd(n,0,n.window[n.strstart-1]),i&&Mo(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return Rr}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=yd(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Xt-1?n.strstart:Xt-1,e===ra?(Mo(n,!0),n.strm.avail_out===0?wp:Bb):n.sym_next&&(Mo(n,!1),n.strm.avail_out===0)?Rr:Ob},lxe=(n,e)=>{let t,i,s,r;const o=n.window;for(;;){if(n.lookahead<=id){if($_(n),n.lookahead<=id&&e===Cd)return Rr;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=Xt&&n.strstart>0&&(s=n.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){r=n.strstart+id;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<r);n.match_length=id-(r-s),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=Xt?(t=yd(n,1,n.match_length-Xt),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(t=yd(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),t&&(Mo(n,!1),n.strm.avail_out===0))return Rr}return n.insert=0,e===ra?(Mo(n,!0),n.strm.avail_out===0?wp:Bb):n.sym_next&&(Mo(n,!1),n.strm.avail_out===0)?Rr:Ob},cxe=(n,e)=>{let t;for(;;){if(n.lookahead===0&&($_(n),n.lookahead===0)){if(e===Cd)return Rr;break}if(n.match_length=0,t=yd(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,t&&(Mo(n,!1),n.strm.avail_out===0))return Rr}return n.insert=0,e===ra?(Mo(n,!0),n.strm.avail_out===0?wp:Bb):n.sym_next&&(Mo(n,!1),n.strm.avail_out===0)?Rr:Ob};function $l(n,e,t,i,s){this.good_length=n,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=s}const Q1=[new $l(0,0,0,0,KJ),new $l(4,4,8,4,PI),new $l(4,5,16,8,PI),new $l(4,6,32,32,PI),new $l(4,4,16,16,Im),new $l(8,16,32,32,Im),new $l(8,16,128,128,Im),new $l(8,32,128,256,Im),new $l(32,128,258,1024,Im),new $l(32,258,258,4096,Im)],uxe=n=>{n.window_size=2*n.w_size,qh(n.head),n.max_lazy_match=Q1[n.level].max_lazy,n.good_match=Q1[n.level].good_length,n.nice_match=Q1[n.level].nice_length,n.max_chain_length=Q1[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=Xt-1,n.match_available=0,n.ins_h=0};function hxe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=nT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ixe*2),this.dyn_dtree=new Uint16Array((2*exe+1)*2),this.bl_tree=new Uint16Array((2*txe+1)*2),qh(this.dyn_ltree),qh(this.dyn_dtree),qh(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(nxe+1),this.heap=new Uint16Array(2*m4+1),qh(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*m4+1),qh(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const sS=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.status!==V_&&e.status!==I6&&e.status!==_4&&e.status!==b4&&e.status!==v4&&e.status!==w4&&e.status!==Cg&&e.status!==X1?1:0},ZJ=n=>{if(sS(n))return Sg(n,kc);n.total_in=n.total_out=0,n.data_type=KSe;const e=n.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?I6:e.wrap?V_:Cg,n.adler=e.wrap===2?0:1,e.last_flush=-2,OSe(e),Fs},YJ=n=>{const e=ZJ(n);return e===Fs&&uxe(n.state),e},dxe=(n,e)=>sS(n)||n.state.wrap!==2?kc:(n.state.gzhead=e,Fs),XJ=(n,e,t,i,s,r)=>{if(!n)return kc;let o=1;if(e===HSe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>ZSe||t!==nT||i<8||i>15||e<0||e>9||r<0||r>qSe||i===8&&o!==1)return Sg(n,kc);i===8&&(i=9);const a=new hxe;return n.state=a,a.strm=n,a.status=V_,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Xt-1)/Xt),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=e,a.strategy=r,a.method=t,YJ(n)},fxe=(n,e)=>XJ(n,e,nT,YSe,XSe,GSe),gxe=(n,e)=>{if(sS(n)||e>r$||e<0)return n?Sg(n,kc):kc;const t=n.state;if(!n.output||n.avail_in!==0&&!n.input||t.status===X1&&e!==ra)return Sg(n,n.avail_out===0?FI:kc);const i=t.last_flush;if(t.last_flush=e,t.pending!==0){if(ko(n),n.avail_out===0)return t.last_flush=-1,Fs}else if(n.avail_in===0&&a$(e)<=a$(i)&&e!==ra)return Sg(n,FI);if(t.status===X1&&n.avail_in!==0)return Sg(n,FI);if(t.status===V_&&t.wrap===0&&(t.status=Cg),t.status===V_){let s=nT+(t.w_bits-8<<4)<<8,r=-1;if(t.strategy>=lx||t.level<2?r=0:t.level<6?r=1:t.level===6?r=2:r=3,s|=r<<6,t.strstart!==0&&(s|=sxe),s+=31-s%31,m1(t,s),t.strstart!==0&&(m1(t,n.adler>>>16),m1(t,n.adler&65535)),n.adler=1,t.status=Cg,ko(n),t.pending!==0)return t.last_flush=-1,Fs}if(t.status===I6){if(n.adler=0,bi(t,31),bi(t,139),bi(t,8),t.gzhead)bi(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),bi(t,t.gzhead.time&255),bi(t,t.gzhead.time>>8&255),bi(t,t.gzhead.time>>16&255),bi(t,t.gzhead.time>>24&255),bi(t,t.level===9?2:t.strategy>=lx||t.level<2?4:0),bi(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(bi(t,t.gzhead.extra.length&255),bi(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(n.adler=Ss(n.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=_4;else if(bi(t,0),bi(t,0),bi(t,0),bi(t,0),bi(t,0),bi(t,t.level===9?2:t.strategy>=lx||t.level<2?4:0),bi(t,rxe),t.status=Cg,ko(n),t.pending!==0)return t.last_flush=-1,Fs}if(t.status===_4){if(t.gzhead.extra){let s=t.pending,r=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+r>t.pending_buf_size;){let a=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+a),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s)),t.gzindex+=a,ko(n),t.pending!==0)return t.last_flush=-1,Fs;s=0,r-=a}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+r),t.pending),t.pending+=r,t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=b4}if(t.status===b4){if(t.gzhead.name){let s=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s)),ko(n),t.pending!==0)return t.last_flush=-1,Fs;s=0}t.gzindex<t.gzhead.name.length?r=t.gzhead.name.charCodeAt(t.gzindex++)&255:r=0,bi(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=v4}if(t.status===v4){if(t.gzhead.comment){let s=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s)),ko(n),t.pending!==0)return t.last_flush=-1,Fs;s=0}t.gzindex<t.gzhead.comment.length?r=t.gzhead.comment.charCodeAt(t.gzindex++)&255:r=0,bi(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>s&&(n.adler=Ss(n.adler,t.pending_buf,t.pending-s,s))}t.status=w4}if(t.status===w4){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(ko(n),t.pending!==0))return t.last_flush=-1,Fs;bi(t,n.adler&255),bi(t,n.adler>>8&255),n.adler=0}if(t.status=Cg,ko(n),t.pending!==0)return t.last_flush=-1,Fs}if(n.avail_in!==0||t.lookahead!==0||e!==Cd&&t.status!==X1){let s=t.level===0?KJ(t,e):t.strategy===lx?cxe(t,e):t.strategy===jSe?lxe(t,e):Q1[t.level].func(t,e);if((s===wp||s===Bb)&&(t.status=X1),s===Rr||s===wp)return n.avail_out===0&&(t.last_flush=-1),Fs;if(s===Ob&&(e===VSe?WSe(t):e!==r$&&(p4(t,0,0,!1),e===$Se&&(qh(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),ko(n),n.avail_out===0))return t.last_flush=-1,Fs}return e!==ra?Fs:t.wrap<=0?o$:(t.wrap===2?(bi(t,n.adler&255),bi(t,n.adler>>8&255),bi(t,n.adler>>16&255),bi(t,n.adler>>24&255),bi(t,n.total_in&255),bi(t,n.total_in>>8&255),bi(t,n.total_in>>16&255),bi(t,n.total_in>>24&255)):(m1(t,n.adler>>>16),m1(t,n.adler&65535)),ko(n),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?Fs:o$)},pxe=n=>{if(sS(n))return kc;const e=n.state.status;return n.state=null,e===Cg?Sg(n,zSe):Fs},mxe=(n,e)=>{let t=e.length;if(sS(n))return kc;const i=n.state,s=i.wrap;if(s===2||s===1&&i.status!==V_||i.lookahead)return kc;if(s===1&&(n.adler=Xw(n.adler,e,t,0)),i.wrap=0,t>=i.w_size){s===0&&(qh(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(e.subarray(t-i.w_size,t),0),e=l,t=i.w_size}const r=n.avail_in,o=n.next_in,a=n.input;for(n.avail_in=t,n.next_in=0,n.input=e,$_(i);i.lookahead>=Xt;){let l=i.strstart,c=i.lookahead-(Xt-1);do i.ins_h=Sd(i,i.ins_h,i.window[l+Xt-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=Xt-1,$_(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Xt-1,i.match_available=0,n.next_in=o,n.input=a,n.avail_in=r,i.wrap=s,Fs};var _xe=fxe,bxe=XJ,vxe=YJ,wxe=ZJ,yxe=dxe,Cxe=gxe,Sxe=pxe,xxe=mxe,kxe="pako deflate (from Nodeca project)",Wv={deflateInit:_xe,deflateInit2:bxe,deflateReset:vxe,deflateResetKeep:wxe,deflateSetHeader:yxe,deflate:Cxe,deflateEnd:Sxe,deflateSetDictionary:xxe,deflateInfo:kxe};const Lxe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Dxe=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)Lxe(t,i)&&(n[i]=t[i])}}return n},Exe=n=>{let e=0;for(let i=0,s=n.length;i<s;i++)e+=n[i].length;const t=new Uint8Array(e);for(let i=0,s=0,r=n.length;i<r;i++){let o=n[i];t.set(o,s),s+=o.length}return t},sT={assign:Dxe,flattenChunks:Exe};let QJ=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{QJ=!1}const Qw=new Uint8Array(256);for(let n=0;n<256;n++)Qw[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Qw[254]=Qw[254]=1;var Txe=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,i,s,r,o=n.length,a=0;for(s=0;s<o;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<o&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),r=0,s=0;r<a;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<o&&(i=n.charCodeAt(s+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),s++)),t<128?e[r++]=t:t<2048?(e[r++]=192|t>>>6,e[r++]=128|t&63):t<65536?(e[r++]=224|t>>>12,e[r++]=128|t>>>6&63,e[r++]=128|t&63):(e[r++]=240|t>>>18,e[r++]=128|t>>>12&63,e[r++]=128|t>>>6&63,e[r++]=128|t&63);return e};const Axe=(n,e)=>{if(e<65534&&n.subarray&&QJ)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t};var Ixe=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let i,s;const r=new Array(t*2);for(s=0,i=0;i<t;){let o=n[i++];if(o<128){r[s++]=o;continue}let a=Qw[o];if(a>4){r[s++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|n[i++]&63,a--;if(a>1){r[s++]=65533;continue}o<65536?r[s++]=o:(o-=65536,r[s++]=55296|o>>10&1023,r[s++]=56320|o&1023)}return Axe(r,s)},Nxe=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Qw[n[t]]>e?t:e},Jw={string2buf:Txe,buf2string:Ixe,utf8border:Nxe};function Rxe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var JJ=Rxe;const eee=Object.prototype.toString,{Z_NO_FLUSH:Mxe,Z_SYNC_FLUSH:Fxe,Z_FULL_FLUSH:Pxe,Z_FINISH:Oxe,Z_OK:hL,Z_STREAM_END:Bxe,Z_DEFAULT_COMPRESSION:Wxe,Z_DEFAULT_STRATEGY:Vxe,Z_DEFLATED:$xe}=nS;function N6(n){this.options=sT.assign({level:Wxe,method:$xe,chunkSize:16384,windowBits:15,memLevel:8,strategy:Vxe},n||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JJ,this.strm.avail_out=0;let t=Wv.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==hL)throw new Error(W_[t]);if(e.header&&Wv.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=Jw.string2buf(e.dictionary):eee.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=Wv.deflateSetDictionary(this.strm,i),t!==hL)throw new Error(W_[t]);this._dict_set=!0}}N6.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize;let s,r;if(this.ended)return!1;for(e===~~e?r=e:r=e===!0?Oxe:Mxe,typeof n=="string"?t.input=Jw.string2buf(n):eee.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(r===Fxe||r===Pxe)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(s=Wv.deflate(t,r),s===Bxe)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),s=Wv.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===hL;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};N6.prototype.onData=function(n){this.chunks.push(n)};N6.prototype.onEnd=function(n){n===hL&&(this.result=sT.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};const cx=16209,zxe=16191;var Hxe=function(e,t){let i,s,r,o,a,l,c,u,h,d,f,g,p,m,b,v,w,y,x,D,S,T,k,I;const N=e.state;i=e.next_in,k=e.input,s=i+(e.avail_in-5),r=e.next_out,I=e.output,o=r-(t-e.avail_out),a=r+(e.avail_out-257),l=N.dmax,c=N.wsize,u=N.whave,h=N.wnext,d=N.window,f=N.hold,g=N.bits,p=N.lencode,m=N.distcode,b=(1<<N.lenbits)-1,v=(1<<N.distbits)-1;e:do{g<15&&(f+=k[i++]<<g,g+=8,f+=k[i++]<<g,g+=8),w=p[f&b];t:for(;;){if(y=w>>>24,f>>>=y,g-=y,y=w>>>16&255,y===0)I[r++]=w&65535;else if(y&16){x=w&65535,y&=15,y&&(g<y&&(f+=k[i++]<<g,g+=8),x+=f&(1<<y)-1,f>>>=y,g-=y),g<15&&(f+=k[i++]<<g,g+=8,f+=k[i++]<<g,g+=8),w=m[f&v];i:for(;;){if(y=w>>>24,f>>>=y,g-=y,y=w>>>16&255,y&16){if(D=w&65535,y&=15,g<y&&(f+=k[i++]<<g,g+=8,g<y&&(f+=k[i++]<<g,g+=8)),D+=f&(1<<y)-1,D>l){e.msg="invalid distance too far back",N.mode=cx;break e}if(f>>>=y,g-=y,y=r-o,D>y){if(y=D-y,y>u&&N.sane){e.msg="invalid distance too far back",N.mode=cx;break e}if(S=0,T=d,h===0){if(S+=c-y,y<x){x-=y;do I[r++]=d[S++];while(--y);S=r-D,T=I}}else if(h<y){if(S+=c+h-y,y-=h,y<x){x-=y;do I[r++]=d[S++];while(--y);if(S=0,h<x){y=h,x-=y;do I[r++]=d[S++];while(--y);S=r-D,T=I}}}else if(S+=h-y,y<x){x-=y;do I[r++]=d[S++];while(--y);S=r-D,T=I}for(;x>2;)I[r++]=T[S++],I[r++]=T[S++],I[r++]=T[S++],x-=3;x&&(I[r++]=T[S++],x>1&&(I[r++]=T[S++]))}else{S=r-D;do I[r++]=I[S++],I[r++]=I[S++],I[r++]=I[S++],x-=3;while(x>2);x&&(I[r++]=I[S++],x>1&&(I[r++]=I[S++]))}}else if(y&64){e.msg="invalid distance code",N.mode=cx;break e}else{w=m[(w&65535)+(f&(1<<y)-1)];continue i}break}}else if(y&64)if(y&32){N.mode=zxe;break e}else{e.msg="invalid literal/length code",N.mode=cx;break e}else{w=p[(w&65535)+(f&(1<<y)-1)];continue t}break}}while(i<s&&r<a);x=g>>3,i-=x,g-=x<<3,f&=(1<<g)-1,e.next_in=i,e.next_out=r,e.avail_in=i<s?5+(s-i):5-(i-s),e.avail_out=r<a?257+(a-r):257-(r-a),N.hold=f,N.bits=g};const Nm=15,l$=852,c$=592,u$=0,OI=1,h$=2,Uxe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),jxe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),qxe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Gxe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Kxe=(n,e,t,i,s,r,o,a)=>{const l=a.bits;let c=0,u=0,h=0,d=0,f=0,g=0,p=0,m=0,b=0,v=0,w,y,x,D,S,T=null,k;const I=new Uint16Array(Nm+1),N=new Uint16Array(Nm+1);let z=null,$,q,ne;for(c=0;c<=Nm;c++)I[c]=0;for(u=0;u<i;u++)I[e[t+u]]++;for(f=l,d=Nm;d>=1&&I[d]===0;d--);if(f>d&&(f=d),d===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,a.bits=1,0;for(h=1;h<d&&I[h]===0;h++);for(f<h&&(f=h),m=1,c=1;c<=Nm;c++)if(m<<=1,m-=I[c],m<0)return-1;if(m>0&&(n===u$||d!==1))return-1;for(N[1]=0,c=1;c<Nm;c++)N[c+1]=N[c]+I[c];for(u=0;u<i;u++)e[t+u]!==0&&(o[N[e[t+u]]++]=u);if(n===u$?(T=z=o,k=20):n===OI?(T=Uxe,z=jxe,k=257):(T=qxe,z=Gxe,k=0),v=0,u=0,c=h,S=r,g=f,p=0,x=-1,b=1<<f,D=b-1,n===OI&&b>l$||n===h$&&b>c$)return 1;for(;;){$=c-p,o[u]+1<k?(q=0,ne=o[u]):o[u]>=k?(q=z[o[u]-k],ne=T[o[u]-k]):(q=32+64,ne=0),w=1<<c-p,y=1<<g,h=y;do y-=w,s[S+(v>>p)+y]=$<<24|q<<16|ne|0;while(y!==0);for(w=1<<c-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,u++,--I[c]===0){if(c===d)break;c=e[t+o[u]]}if(c>f&&(v&D)!==x){for(p===0&&(p=f),S+=h,g=c-p,m=1<<g;g+p<d&&(m-=I[g+p],!(m<=0));)g++,m<<=1;if(b+=1<<g,n===OI&&b>l$||n===h$&&b>c$)return 1;x=v&D,s[x]=f<<24|g<<16|S-r|0}}return v!==0&&(s[S+v]=c-p<<24|64<<16|0),a.bits=f,0};var Vv=Kxe;const Zxe=0,tee=1,iee=2,{Z_FINISH:d$,Z_BLOCK:Yxe,Z_TREES:ux,Z_OK:yp,Z_STREAM_END:Xxe,Z_NEED_DICT:Qxe,Z_STREAM_ERROR:Aa,Z_DATA_ERROR:nee,Z_MEM_ERROR:see,Z_BUF_ERROR:Jxe,Z_DEFLATED:f$}=nS,rT=16180,g$=16181,p$=16182,m$=16183,_$=16184,b$=16185,v$=16186,w$=16187,y$=16188,C$=16189,dL=16190,Jc=16191,BI=16192,S$=16193,WI=16194,x$=16195,k$=16196,L$=16197,D$=16198,hx=16199,dx=16200,E$=16201,T$=16202,A$=16203,I$=16204,N$=16205,VI=16206,R$=16207,M$=16208,hn=16209,ree=16210,oee=16211,e2e=852,t2e=592,i2e=15,n2e=i2e,F$=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function s2e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Kp=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<rT||e.mode>oee?1:0},aee=n=>{if(Kp(n))return Aa;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=rT,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(e2e),e.distcode=e.distdyn=new Int32Array(t2e),e.sane=1,e.back=-1,yp},lee=n=>{if(Kp(n))return Aa;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,aee(n)},cee=(n,e)=>{let t;if(Kp(n))return Aa;const i=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Aa:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,lee(n))},uee=(n,e)=>{if(!n)return Aa;const t=new s2e;n.state=t,t.strm=n,t.window=null,t.mode=rT;const i=cee(n,e);return i!==yp&&(n.state=null),i},r2e=n=>uee(n,n2e);let P$=!0,$I,zI;const o2e=n=>{if(P$){$I=new Int32Array(512),zI=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Vv(tee,n.lens,0,288,$I,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Vv(iee,n.lens,0,32,zI,0,n.work,{bits:5}),P$=!1}n.lencode=$I,n.lenbits=9,n.distcode=zI,n.distbits=5},hee=(n,e,t,i)=>{let s;const r=n.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(e.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>i&&(s=i),r.window.set(e.subarray(t-i,t-i+s),r.wnext),i-=s,i?(r.window.set(e.subarray(t-i,t),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},a2e=(n,e)=>{let t,i,s,r,o,a,l,c,u,h,d,f,g,p,m=0,b,v,w,y,x,D,S,T;const k=new Uint8Array(4);let I,N;const z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Kp(n)||!n.output||!n.input&&n.avail_in!==0)return Aa;t=n.state,t.mode===Jc&&(t.mode=BI),o=n.next_out,s=n.output,l=n.avail_out,r=n.next_in,i=n.input,a=n.avail_in,c=t.hold,u=t.bits,h=a,d=l,T=yp;e:for(;;)switch(t.mode){case rT:if(t.wrap===0){t.mode=BI;break}for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,k[0]=c&255,k[1]=c>>>8&255,t.check=Ss(t.check,k,2,0),c=0,u=0,t.mode=g$;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=hn;break}if((c&15)!==f$){n.msg="unknown compression method",t.mode=hn;break}if(c>>>=4,u-=4,S=(c&15)+8,t.wbits===0&&(t.wbits=S),S>15||S>t.wbits){n.msg="invalid window size",t.mode=hn;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=c&512?C$:Jc,c=0,u=0;break;case g$:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.flags=c,(t.flags&255)!==f$){n.msg="unknown compression method",t.mode=hn;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=hn;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Ss(t.check,k,2,0)),c=0,u=0,t.mode=p$;case p$:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,t.check=Ss(t.check,k,4,0)),c=0,u=0,t.mode=m$;case m$:for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Ss(t.check,k,2,0)),c=0,u=0,t.mode=_$;case _$:if(t.flags&1024){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,t.check=Ss(t.check,k,2,0)),c=0,u=0}else t.head&&(t.head.extra=null);t.mode=b$;case b$:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(S=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(r,r+f),S)),t.flags&512&&t.wrap&4&&(t.check=Ss(t.check,i,f,r)),a-=f,r+=f,t.length-=f),t.length))break e;t.length=0,t.mode=v$;case v$:if(t.flags&2048){if(a===0)break e;f=0;do S=i[r+f++],t.head&&S&&t.length<65536&&(t.head.name+=String.fromCharCode(S));while(S&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=Ss(t.check,i,f,r)),a-=f,r+=f,S)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=w$;case w$:if(t.flags&4096){if(a===0)break e;f=0;do S=i[r+f++],t.head&&S&&t.length<65536&&(t.head.comment+=String.fromCharCode(S));while(S&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=Ss(t.check,i,f,r)),a-=f,r+=f,S)break e}else t.head&&(t.head.comment=null);t.mode=y$;case y$:if(t.flags&512){for(;u<16;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.wrap&4&&c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=hn;break}c=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Jc;break;case C$:for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}n.adler=t.check=F$(c),c=0,u=0,t.mode=dL;case dL:if(t.havedict===0)return n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,Qxe;n.adler=t.check=1,t.mode=Jc;case Jc:if(e===Yxe||e===ux)break e;case BI:if(t.last){c>>>=u&7,u-=u&7,t.mode=VI;break}for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}switch(t.last=c&1,c>>>=1,u-=1,c&3){case 0:t.mode=S$;break;case 1:if(o2e(t),t.mode=hx,e===ux){c>>>=2,u-=2;break e}break;case 2:t.mode=k$;break;case 3:n.msg="invalid block type",t.mode=hn}c>>>=2,u-=2;break;case S$:for(c>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=hn;break}if(t.length=c&65535,c=0,u=0,t.mode=WI,e===ux)break e;case WI:t.mode=x$;case x$:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;s.set(i.subarray(r,r+f),o),a-=f,r+=f,l-=f,o+=f,t.length-=f;break}t.mode=Jc;break;case k$:for(;u<14;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.nlen=(c&31)+257,c>>>=5,u-=5,t.ndist=(c&31)+1,c>>>=5,u-=5,t.ncode=(c&15)+4,c>>>=4,u-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=hn;break}t.have=0,t.mode=L$;case L$:for(;t.have<t.ncode;){for(;u<3;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.lens[z[t.have++]]=c&7,c>>>=3,u-=3}for(;t.have<19;)t.lens[z[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},T=Vv(Zxe,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,T){n.msg="invalid code lengths set",t.mode=hn;break}t.have=0,t.mode=D$;case D$:for(;t.have<t.nlen+t.ndist;){for(;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(w<16)c>>>=b,u-=b,t.lens[t.have++]=w;else{if(w===16){for(N=b+2;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(c>>>=b,u-=b,t.have===0){n.msg="invalid bit length repeat",t.mode=hn;break}S=t.lens[t.have-1],f=3+(c&3),c>>>=2,u-=2}else if(w===17){for(N=b+3;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,S=0,f=3+(c&7),c>>>=3,u-=3}else{for(N=b+7;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,S=0,f=11+(c&127),c>>>=7,u-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=hn;break}for(;f--;)t.lens[t.have++]=S}}if(t.mode===hn)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=hn;break}if(t.lenbits=9,I={bits:t.lenbits},T=Vv(tee,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,T){n.msg="invalid literal/lengths set",t.mode=hn;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},T=Vv(iee,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,T){n.msg="invalid distances set",t.mode=hn;break}if(t.mode=hx,e===ux)break e;case hx:t.mode=dx;case dx:if(a>=6&&l>=258){n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,Hxe(n,d),o=n.next_out,s=n.output,l=n.avail_out,r=n.next_in,i=n.input,a=n.avail_in,c=t.hold,u=t.bits,t.mode===Jc&&(t.back=-1);break}for(t.back=0;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(v&&!(v&240)){for(y=b,x=v,D=w;m=t.lencode[D+((c&(1<<y+x)-1)>>y)],b=m>>>24,v=m>>>16&255,w=m&65535,!(y+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=y,u-=y,t.back+=y}if(c>>>=b,u-=b,t.back+=b,t.length=w,v===0){t.mode=N$;break}if(v&32){t.back=-1,t.mode=Jc;break}if(v&64){n.msg="invalid literal/length code",t.mode=hn;break}t.extra=v&15,t.mode=E$;case E$:if(t.extra){for(N=t.extra;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=T$;case T$:for(;m=t.distcode[c&(1<<t.distbits)-1],b=m>>>24,v=m>>>16&255,w=m&65535,!(b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(!(v&240)){for(y=b,x=v,D=w;m=t.distcode[D+((c&(1<<y+x)-1)>>y)],b=m>>>24,v=m>>>16&255,w=m&65535,!(y+b<=u);){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}c>>>=y,u-=y,t.back+=y}if(c>>>=b,u-=b,t.back+=b,v&64){n.msg="invalid distance code",t.mode=hn;break}t.offset=w,t.extra=v&15,t.mode=A$;case A$:if(t.extra){for(N=t.extra;u<N;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=hn;break}t.mode=I$;case I$:if(l===0)break e;if(f=d-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=hn;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),p=t.window}else p=s,g=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do s[o++]=p[g++];while(--f);t.length===0&&(t.mode=dx);break;case N$:if(l===0)break e;s[o++]=t.length,l--,t.mode=dx;break;case VI:if(t.wrap){for(;u<32;){if(a===0)break e;a--,c|=i[r++]<<u,u+=8}if(d-=l,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?Ss(t.check,s,d,o-d):Xw(t.check,s,d,o-d)),d=l,t.wrap&4&&(t.flags?c:F$(c))!==t.check){n.msg="incorrect data check",t.mode=hn;break}c=0,u=0}t.mode=R$;case R$:if(t.wrap&&t.flags){for(;u<32;){if(a===0)break e;a--,c+=i[r++]<<u,u+=8}if(t.wrap&4&&c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=hn;break}c=0,u=0}t.mode=M$;case M$:T=Xxe;break e;case hn:T=nee;break e;case ree:return see;case oee:default:return Aa}return n.next_out=o,n.avail_out=l,n.next_in=r,n.avail_in=a,t.hold=c,t.bits=u,(t.wsize||d!==n.avail_out&&t.mode<hn&&(t.mode<VI||e!==d$))&&hee(n,n.output,n.next_out,d-n.avail_out),h-=n.avail_in,d-=n.avail_out,n.total_in+=h,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?Ss(t.check,s,d,n.next_out-d):Xw(t.check,s,d,n.next_out-d)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Jc?128:0)+(t.mode===hx||t.mode===WI?256:0),(h===0&&d===0||e===d$)&&T===yp&&(T=Jxe),T},l2e=n=>{if(Kp(n))return Aa;let e=n.state;return e.window&&(e.window=null),n.state=null,yp},c2e=(n,e)=>{if(Kp(n))return Aa;const t=n.state;return t.wrap&2?(t.head=e,e.done=!1,yp):Aa},u2e=(n,e)=>{const t=e.length;let i,s,r;return Kp(n)||(i=n.state,i.wrap!==0&&i.mode!==dL)?Aa:i.mode===dL&&(s=1,s=Xw(s,e,t,0),s!==i.check)?nee:(r=hee(n,e,t,t),r?(i.mode=ree,see):(i.havedict=1,yp))};var h2e=lee,d2e=cee,f2e=aee,g2e=r2e,p2e=uee,m2e=a2e,_2e=l2e,b2e=c2e,v2e=u2e,w2e="pako inflate (from Nodeca project)",_u={inflateReset:h2e,inflateReset2:d2e,inflateResetKeep:f2e,inflateInit:g2e,inflateInit2:p2e,inflate:m2e,inflateEnd:_2e,inflateGetHeader:b2e,inflateSetDictionary:v2e,inflateInfo:w2e};function y2e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var C2e=y2e;const dee=Object.prototype.toString,{Z_NO_FLUSH:S2e,Z_FINISH:x2e,Z_OK:ey,Z_STREAM_END:HI,Z_NEED_DICT:UI,Z_STREAM_ERROR:k2e,Z_DATA_ERROR:O$,Z_MEM_ERROR:L2e}=nS;function rS(n){this.options=sT.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new JJ,this.strm.avail_out=0;let t=_u.inflateInit2(this.strm,e.windowBits);if(t!==ey)throw new Error(W_[t]);if(this.header=new C2e,_u.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Jw.string2buf(e.dictionary):dee.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=_u.inflateSetDictionary(this.strm,e.dictionary),t!==ey)))throw new Error(W_[t])}rS.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?x2e:S2e,dee.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),r=_u.inflate(t,o),r===UI&&s&&(r=_u.inflateSetDictionary(t,s),r===ey?r=_u.inflate(t,o):r===O$&&(r=UI));t.avail_in>0&&r===HI&&t.state.wrap>0&&n[t.next_in]!==0;)_u.inflateReset(t),r=_u.inflate(t,o);switch(r){case k2e:case O$:case UI:case L2e:return this.onEnd(r),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||r===HI))if(this.options.to==="string"){let l=Jw.utf8border(t.output,t.next_out),c=t.next_out-l,u=Jw.buf2string(t.output,l);t.next_out=c,t.avail_out=i-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(u)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===ey&&a===0)){if(r===HI)return r=_u.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};rS.prototype.onData=function(n){this.chunks.push(n)};rS.prototype.onEnd=function(n){n===ey&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=sT.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function R6(n,e){const t=new rS(e);if(t.push(n),t.err)throw t.msg||W_[t.err];return t.result}function D2e(n,e){return e=e||{},e.raw=!0,R6(n,e)}var E2e=rS,T2e=R6,A2e=D2e,I2e=R6,N2e=nS,R2e={Inflate:E2e,inflate:T2e,inflateRaw:A2e,ungzip:I2e,constants:N2e};const{Inflate:MZe,inflate:FZe,inflateRaw:M2e,ungzip:PZe}=R2e;var F2e=M2e;function P2e(n){return F2e(n.subarray(2))}let O2e=class extends Error{constructor(e){super(e),this.code="ERR_ABORTED"}};function B2e(n){n.sort((s,r)=>Number(s.offset)-Number(r.offset));const e=[];let t,i;for(const s of n)t&&i&&Number(s.offset)-i<=2e3?(t.length=BigInt(Number(t.length)+Number(s.length)-i+Number(s.offset)),t.blocks.push(s)):e.push(t={blocks:[s],length:s.length,offset:s.offset}),i=Number(t.offset)+Number(t.length);return e}function fx(n){if(n&&n.aborted)if(typeof DOMException>"u"){const e=new O2e("aborted");throw e.code="ERR_ABORTED",e}else throw new DOMException("aborted","AbortError")}const W2e=1,V2e=2,$2e=3;function jI(n,e,t,i){return n<i&&e>=t}function z2e(n){const e=n?"big":"little",t=new Ei().endianess(e).uint32("chromId").uint32("start").uint32("end").uint32("validCnt").floatle("minScore").floatle("maxScore").floatle("sumData").floatle("sumSqData").saveOffset("offset"),i=new Ei().endianess(e).uint8("isLeaf").skip(1).uint16("cnt").choice({tag:"isLeaf",choices:{1:new Ei().endianess(e).array("blocksToFetch",{length:"cnt",type:new Ei().endianess(e).uint32("startChrom").uint32("startBase").uint32("endChrom").uint32("endBase").uint64("blockOffset").uint64("blockSize").saveOffset("offset")}),0:new Ei().array("recurOffsets",{length:"cnt",type:new Ei().endianess(e).uint32("startChrom").uint32("startBase").uint32("endChrom").uint32("endBase").uint64("blockOffset").saveOffset("offset")})}}),s=new Ei().endianess(e).uint32("chromId").int32("start").int32("end").string("rest",{zeroTerminated:!0}).saveOffset("offset");return{bigWigParser:new Ei().endianess(e).skip(4).int32("blockStart").skip(4).uint32("itemStep").uint32("itemSpan").uint8("blockType").skip(1).uint16("itemCount").choice({tag:"blockType",choices:{[$2e]:new Ei().array("items",{length:"itemCount",type:new Ei().floatle("score")}),[V2e]:new Ei().array("items",{length:"itemCount",type:new Ei().endianess(e).int32("start").floatle("score")}),[W2e]:new Ei().array("items",{length:"itemCount",type:new Ei().endianess(e).int32("start").int32("end").floatle("score")})}}),bigBedParser:s,summaryParser:t,leafParser:i}}class fee{constructor(e,t,i,s,r,o){if(this.bbi=e,this.refsByName=t,this.cirTreeOffset=i,this.isBigEndian=s,this.isCompressed=r,this.blockType=o,this.featureCache=new iT({cache:new L6({maxSize:1e3}),fill:async(l,c)=>{const u=Number(l.length),h=Number(l.offset),{buffer:d}=await this.bbi.read(zs.Buffer.alloc(u),0,u,h,{signal:c});return d}}),!(i>=0))throw new Error("invalid cirTreeOffset!");const a=z2e(s);this.leafParser=a.leafParser,this.bigBedParser=a.bigBedParser}async readWigData(e,t,i,s,r){try{const{refsByName:o,bbi:a,cirTreeOffset:l,isBigEndian:c}=this,u=o[e];u===void 0&&s.complete();const h={chrId:u,start:t,end:i};this.cirTreePromise||(this.cirTreePromise=a.read(zs.Buffer.alloc(48),0,48,Number(l),r));const{buffer:d}=await this.cirTreePromise,f=c?d.readUInt32BE(4):d.readUInt32LE(4);let g=[],p=0;const m=(y,x,D)=>{try{const S=y.subarray(x),T=this.leafParser.parse(S);if(T.blocksToFetch&&(g=g.concat(T.blocksToFetch.filter(k=>b(k)).map(k=>({offset:k.blockOffset,length:k.blockSize})))),T.recurOffsets){const k=T.recurOffsets.filter(I=>b(I)).map(I=>Number(I.blockOffset));k.length>0&&w(k,D+1)}}catch(S){s.error(S)}},b=y=>{const{startChrom:x,startBase:D,endChrom:S,endBase:T}=y;return(x<u||x===u&&D<=i)&&(S>u||S===u&&T>=t)},v=async(y,x,D)=>{try{const S=x.max()-x.min(),T=x.min(),k=await this.featureCache.get(`${S}_${T}`,{length:S,offset:T},r==null?void 0:r.signal);for(const I of y)x.contains(I)&&(m(k,I-T,D),p-=1,p===0&&this.readFeatures(s,g,{...r,request:h}))}catch(S){s.error(S)}},w=(y,x)=>{try{p+=y.length;const D=4+Number(f)*32;let S=new XV(y[0],y[0]+D);for(let T=1;T<y.length;T+=1){const k=new XV(y[T],y[T]+D);S=S.union(k)}S.getRanges().map(T=>v(y,T,x))}catch(D){s.error(D)}};return w([Number(l)+48],1)}catch(o){s.error(o)}}parseSummaryBlock(e,t,i){const s=[];let r=t;const o=new DataView(e.buffer,e.byteOffset,e.length);for(;r<e.byteLength;){const a=o.getUint32(r,!0);r+=4;const l=o.getUint32(r,!0);r+=4;const c=o.getUint32(r,!0);r+=4;const u=o.getUint32(r,!0);r+=4;const h=o.getFloat32(r,!0);r+=4;const d=o.getFloat32(r,!0);r+=4;const f=o.getFloat32(r,!0);r+=4,r+=4,(!i||a===i.chrId&&jI(l,c,i.start,i.end))&&s.push({start:l,end:c,maxScore:d,minScore:h,summary:!0,score:f/(u||1)})}return s}parseBigBedBlock(e,t,i,s){const r=[];let o=t;for(;o<e.byteLength;){const a=this.bigBedParser.parse(e.subarray(o));r.push({...a,uniqueId:`bb-${i+o}`}),o+=a.offset}return s?r.filter(a=>jI(a.start,a.end,s.start,s.end)):r}parseBigWigBlock(e,t,i){const s=e.subarray(t),r=new DataView(s.buffer,s.byteOffset,s.length);let o=0;o+=4;const a=r.getInt32(o,!0);o+=8;const l=r.getUint32(o,!0);o+=4;const c=r.getUint32(o,!0);o+=4;const u=r.getUint8(o);o+=2;const h=r.getUint16(o,!0);o+=2;const d=new Array(h);switch(u){case 1:{for(let f=0;f<h;f++){const g=r.getInt32(o,!0);o+=4;const p=r.getInt32(o,!0);o+=4;const m=r.getFloat32(o,!0);o+=4,d[f]={start:g,end:p,score:m}}break}case 2:{for(let f=0;f<h;f++){const g=r.getInt32(o,!0);o+=4;const p=r.getFloat32(o,!0);o+=4,d[f]={score:p,start:g,end:g+c}}break}case 3:{for(let f=0;f<h;f++){const g=r.getFloat32(o,!0);o+=4;const p=a+f*l;d[f]={score:g,start:p,end:p+c}}break}}return i?d.filter(f=>jI(f.start,f.end,i.start,i.end)):d}async readFeatures(e,t,i={}){try{const{blockType:s,isCompressed:r}=this,{signal:o,request:a}=i,l=B2e(t);fx(o),await Promise.all(l.map(async c=>{fx(o);const{length:u,offset:h}=c,d=await this.featureCache.get(`${u}_${h}`,c,o);for(const f of c.blocks){fx(o);let g=Number(f.offset)-Number(c.offset),p=d;switch(r&&(p=P2e(d.subarray(g)),g=0),fx(o),s){case"summary":{e.next(this.parseSummaryBlock(p,g,a));break}case"bigwig":{e.next(this.parseBigWigBlock(p,g,a));break}case"bigbed":{e.next(this.parseBigBedBlock(p,g,Number(f.offset)*256,a));break}default:console.warn(`Don't know what to do with ${s}`)}}})),e.complete()}catch(s){e.error(s)}}}var C4=function(n,e){return C4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])},C4(n,e)};function M6(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");C4(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function H2e(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function gee(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,s,r,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,s&&(r=c[0]&2?s.return:c[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,c[1])).done)return r;switch(s=0,r&&(c=[c[0]&2,r.value]),c[0]){case 0:case 1:r=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!r||c[1]>r[0]&&c[1]<r[3])){t.label=c[1];break}if(c[0]===6&&t.label<r[1]){t.label=r[1],r=c;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(c);break}r[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],s=0}finally{i=r=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ty(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fL(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),s,r=[],o;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)r.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return r}function gL(n,e,t){if(t||arguments.length===2)for(var i=0,s=e.length,r;i<s;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))}function $0(n){return this instanceof $0?(this.v=n,this):new $0(n)}function U2e(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,r=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){i[d]&&(s[d]=function(f){return new Promise(function(g,p){r.push([d,f,g,p])>1||a(d,f)})})}function a(d,f){try{l(i[d](f))}catch(g){h(r[0][3],g)}}function l(d){d.value instanceof $0?Promise.resolve(d.value.v).then(c,u):h(r[0][2],d)}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),r.shift(),r.length&&a(r[0][0],r[0][1])}}function j2e(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ty=="function"?ty(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(c){r({value:c,done:a})},o)}}function ds(n){return typeof n=="function"}function pee(n){var e=function(i){Error.call(i),i.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var qI=pee(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,s){return s+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function B$(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var F6=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,i,s,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=ty(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(ds(u))try{u()}catch(p){r=p instanceof qI?p.errors:[p]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=ty(h),f=d.next();!f.done;f=d.next()){var g=f.value;try{W$(g)}catch(p){r=r??[],p instanceof qI?r=gL(gL([],fL(r)),fL(p.errors)):r.push(p)}}}catch(p){i={error:p}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}}if(r)throw new qI(r)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)W$(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&B$(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&B$(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}();F6.EMPTY;function mee(n){return n instanceof F6||n&&"closed"in n&&ds(n.remove)&&ds(n.add)&&ds(n.unsubscribe)}function W$(n){ds(n)?n():n.unsubscribe()}var _ee={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},S4={setTimeout:function(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var s=S4.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,gL([n,e],fL(t))):setTimeout.apply(void 0,gL([n,e],fL(t)))},clearTimeout:function(n){var e=S4.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function bee(n){S4.setTimeout(function(){throw n})}function V$(){}function q2e(n){n()}var P6=function(n){M6(e,n);function e(t){var i=n.call(this)||this;return i.isStopped=!1,t?(i.destination=t,mee(t)&&t.add(i)):i.destination=Y2e,i}return e.create=function(t,i,s){return new pL(t,i,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(F6),G2e=Function.prototype.bind;function GI(n,e){return G2e.call(n,e)}var K2e=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(i){gx(i)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(i){gx(i)}else gx(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){gx(t)}},n}(),pL=function(n){M6(e,n);function e(t,i,s){var r=n.call(this)||this,o;if(ds(t)||!t)o={next:t??void 0,error:i??void 0,complete:s??void 0};else{var a;r&&_ee.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return r.unsubscribe()},o={next:t.next&&GI(t.next,a),error:t.error&&GI(t.error,a),complete:t.complete&&GI(t.complete,a)}):o=t}return r.destination=new K2e(o),r}return e}(P6);function gx(n){bee(n)}function Z2e(n){throw n}var Y2e={closed:!0,next:V$,error:Z2e,complete:V$},O6=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function vee(n){return n}function X2e(n){return n.length===0?vee:n.length===1?n[0]:function(t){return n.reduce(function(i,s){return s(i)},t)}}var Ba=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,i){var s=this,r=J2e(e)?e:new pL(e,t,i);return q2e(function(){var o=s,a=o.operator,l=o.source;r.add(a?a.call(r,l):l?s._subscribe(r):s._trySubscribe(r))}),r},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var i=this;return t=$$(t),new t(function(s,r){var o=new pL({next:function(a){try{e(a)}catch(l){r(l),o.unsubscribe()}},error:r,complete:s});i.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[O6]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return X2e(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=$$(e),new e(function(i,s){var r;t.subscribe(function(o){return r=o},function(o){return s(o)},function(){return i(r)})})},n.create=function(e){return new n(e)},n}();function $$(n){var e;return(e=n??_ee.Promise)!==null&&e!==void 0?e:Promise}function Q2e(n){return n&&ds(n.next)&&ds(n.error)&&ds(n.complete)}function J2e(n){return n&&n instanceof P6||Q2e(n)&&mee(n)}function eke(n){return ds(n==null?void 0:n.lift)}function Wb(n){return function(e){if(eke(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function iy(n,e,t,i,s){return new tke(n,e,t,i,s)}var tke=function(n){M6(e,n);function e(t,i,s,r,o,a){var l=n.call(this,t)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=i?function(c){try{i(c)}catch(u){t.error(u)}}:n.prototype._next,l._error=r?function(c){try{r(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=s?function(){try{s()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;n.prototype.unsubscribe.call(this),!i&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(P6),ike=new Ba(function(n){return n.complete()});function nke(n){return n&&ds(n.schedule)}function wee(n){return n[n.length-1]}function ske(n){return nke(wee(n))?n.pop():void 0}function rke(n,e){return typeof wee(n)=="number"?n.pop():e}var yee=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function Cee(n){return ds(n==null?void 0:n.then)}function See(n){return ds(n[O6])}function xee(n){return Symbol.asyncIterator&&ds(n==null?void 0:n[Symbol.asyncIterator])}function kee(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function oke(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Lee=oke();function Dee(n){return ds(n==null?void 0:n[Lee])}function Eee(n){return U2e(this,arguments,function(){var t,i,s,r;return gee(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,$0(t.read())];case 3:return i=o.sent(),s=i.value,r=i.done,r?[4,$0(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,$0(s)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Tee(n){return ds(n==null?void 0:n.getReader)}function Vb(n){if(n instanceof Ba)return n;if(n!=null){if(See(n))return ake(n);if(yee(n))return lke(n);if(Cee(n))return cke(n);if(xee(n))return Aee(n);if(Dee(n))return uke(n);if(Tee(n))return hke(n)}throw kee(n)}function ake(n){return new Ba(function(e){var t=n[O6]();if(ds(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function lke(n){return new Ba(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function cke(n){return new Ba(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,bee)})}function uke(n){return new Ba(function(e){var t,i;try{for(var s=ty(n),r=s.next();!r.done;r=s.next()){var o=r.value;if(e.next(o),e.closed)return}}catch(a){t={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}e.complete()})}function Aee(n){return new Ba(function(e){dke(n,e).catch(function(t){return e.error(t)})})}function hke(n){return Aee(Eee(n))}function dke(n,e){var t,i,s,r;return H2e(this,void 0,void 0,function(){var o,a;return gee(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=j2e(n),l.label=1;case 1:return[4,t.next()];case 2:if(i=l.sent(),!!i.done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),s={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(r=t.return)?[4,r.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function xd(n,e,t,i,s){i===void 0&&(i=0),s===void 0&&(s=!1);var r=e.schedule(function(){t(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(r),!s)return r}function Iee(n,e){return e===void 0&&(e=0),Wb(function(t,i){t.subscribe(iy(i,function(s){return xd(i,n,function(){return i.next(s)},e)},function(){return xd(i,n,function(){return i.complete()},e)},function(s){return xd(i,n,function(){return i.error(s)},e)}))})}function Nee(n,e){return e===void 0&&(e=0),Wb(function(t,i){i.add(n.schedule(function(){return t.subscribe(i)},e))})}function fke(n,e){return Vb(n).pipe(Nee(e),Iee(e))}function gke(n,e){return Vb(n).pipe(Nee(e),Iee(e))}function pke(n,e){return new Ba(function(t){var i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function mke(n,e){return new Ba(function(t){var i;return xd(t,e,function(){i=n[Lee](),xd(t,e,function(){var s,r,o;try{s=i.next(),r=s.value,o=s.done}catch(a){t.error(a);return}o?t.complete():t.next(r)},0,!0)}),function(){return ds(i==null?void 0:i.return)&&i.return()}})}function Ree(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ba(function(t){xd(t,e,function(){var i=n[Symbol.asyncIterator]();xd(t,e,function(){i.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function _ke(n,e){return Ree(Eee(n),e)}function bke(n,e){if(n!=null){if(See(n))return fke(n,e);if(yee(n))return pke(n,e);if(Cee(n))return gke(n,e);if(xee(n))return Ree(n,e);if(Dee(n))return mke(n,e);if(Tee(n))return _ke(n,e)}throw kee(n)}function vke(n,e){return e?bke(n,e):Vb(n)}var wke=pee(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function Mee(n,e){var t=typeof e=="object";return new Promise(function(i,s){var r=new pL({next:function(o){i(o),r.unsubscribe()},error:s,complete:function(){t?i(e.defaultValue):s(new wke)}});n.subscribe(r)})}function Fee(n,e){return Wb(function(t,i){var s=0;t.subscribe(iy(i,function(r){i.next(n.call(e,r,s++))}))})}function yke(n,e,t,i,s,r,o,a){var l=[],c=0,u=0,h=!1,d=function(){h&&!l.length&&!c&&e.complete()},f=function(p){return c<i?g(p):l.push(p)},g=function(p){r&&e.next(p),c++;var m=!1;Vb(t(p,u++)).subscribe(iy(e,function(b){s==null||s(b),r?f(b):e.next(b)},function(){m=!0},void 0,function(){if(m)try{c--;for(var b=function(){var v=l.shift();o?xd(e,o,function(){return g(v)}):g(v)};l.length&&c<i;)b();d()}catch(v){e.error(v)}}))};return n.subscribe(iy(e,f,function(){h=!0,d()})),function(){a==null||a()}}function Pee(n,e,t){return t===void 0&&(t=1/0),ds(e)?Pee(function(i,s){return Fee(function(r,o){return e(i,r,s,o)})(Vb(n(i,s)))},t):(typeof e=="number"&&(t=e),Wb(function(i,s){return yke(i,s,n,t)}))}function Cke(n){return n===void 0&&(n=1/0),Pee(vee,n)}function Ske(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ske(n),i=rke(n,1/0),s=n;return s.length?s.length===1?Vb(s[0]):Cke(i)(vke(s,t)):ike}function xke(n,e,t,i,s){return function(r,o){var a=t,l=e,c=0;r.subscribe(iy(o,function(u){var h=c++;l=a?n(l,u,h):(a=!0,u),i&&o.next(l)},s&&function(){a&&o.next(l),o.complete()}))}}function Oee(n,e){return Wb(xke(n,e,arguments.length>=2,!1,!0))}var kke=function(n,e){return n.push(e),n};function Lke(){return Wb(function(n,e){Oee(kke,[])(n).subscribe(e)})}const z$=-2003829722,KI=-2021002517;function Dke(n){return new TextDecoder().decode(n)}function H$(n){const e=n?"big":"little",t=new Ei().endianess(e).int32("magic").uint16("version").uint16("numZoomLevels").uint64("chromTreeOffset").uint64("unzoomedDataOffset").uint64("unzoomedIndexOffset").uint16("fieldCount").uint16("definedFieldCount").uint64("asOffset").uint64("totalSummaryOffset").uint32("uncompressBufSize").uint64("extHeaderOffset").array("zoomLevels",{length:"numZoomLevels",type:new Ei().endianess(e).uint32("reductionLevel").uint32("reserved").uint64("dataOffset").uint64("indexOffset")}),i=new Ei().endianess(e).uint64("basesCovered").doublele("scoreMin").doublele("scoreMax").doublele("scoreSum").doublele("scoreSumSquares"),s=new Ei().endianess(e).uint32("magic").uint32("blockSize").uint32("keySize").uint32("valSize").uint64("itemCount"),r=new Ei().endianess(e).uint8("isLeafNode").skip(1).uint16("cnt").saveOffset("offset");return{chromTreeParser:s,totalSummaryParser:i,headerParser:t,isLeafNode:r}}class Bee{getHeader(e){return this.headerP||(this.headerP=this._getHeader(e).catch(t=>{throw this.headerP=void 0,t})),this.headerP}constructor(e){const{filehandle:t,renameRefSeqs:i=o=>o,path:s,url:r}=e;if(this.renameRefSeqs=i,t)this.bbi=t;else if(r)this.bbi=new fc(r);else if(s)this.bbi=new No(s);else throw new Error("no file given")}async _getHeader(e){const t=await this._getMainHeader(e),i=await this._readChromTree(t,e);return{...t,...i}}async _getMainHeader(e,t=2e3){const{buffer:i}=await this.bbi.read(zs.Buffer.alloc(t),0,t,0,e),s=this._isBigEndian(i),r=H$(s),o=r.headerParser.parse(i),{magic:a,asOffset:l,totalSummaryOffset:c}=o;if(o.fileType=a===KI?"bigbed":"bigwig",l>t||c>t)return this._getMainHeader(e,t*2);if(l){const u=Number(o.asOffset);o.autoSql=Dke(i.subarray(u,i.indexOf(0,u)))}if(o.totalSummaryOffset>t)return this._getMainHeader(e,t*2);if(o.totalSummaryOffset){const u=i.subarray(Number(o.totalSummaryOffset)),h=r.totalSummaryParser.parse(u);o.totalSummary={...h,basesCovered:Number(h.basesCovered)}}return{...o,isBigEndian:s}}_isBigEndian(e){let t=e.readInt32LE(0);if(t===z$||t===KI)return!1;if(t=e.readInt32BE(0),t===z$||t===KI)return!0;throw new Error("not a BigWig/BigBed file")}async _readChromTree(e,t){const i=e.isBigEndian,s=i?"big":"little",r=[],o={};let a=Number(e.unzoomedDataOffset);const l=Number(e.chromTreeOffset);for(;a%4!==0;)a+=1;const c=a-l,{buffer:u}=await this.bbi.read(zs.Buffer.alloc(c),0,c,Number(l),t),h=H$(i),{keySize:d}=h.chromTreeParser.parse(u),f=new Ei().endianess(s).string("key",{stripNull:!0,length:d}).uint32("refId").uint32("refSize").saveOffset("offset"),g=new Ei().endianess(s).skip(d).uint64("childOffset").saveOffset("offset"),p=32,m=async b=>{let v=b;if(v>=u.length)throw new Error("reading beyond end of buffer");const w=h.isLeafNode.parse(u.subarray(v)),{isLeafNode:y,cnt:x}=w;if(v+=w.offset,y)for(let D=0;D<x;D+=1){const S=f.parse(u.subarray(v));v+=S.offset;const{key:T,refId:k,refSize:I}=S,N={name:T,id:k,length:I};o[this.renameRefSeqs(T)]=k,r[k]=N}else{const D=[];for(let S=0;S<x;S+=1){const T=g.parse(u.subarray(v)),{childOffset:k}=T;v+=T.offset,D.push(m(Number(k)-Number(l)))}await Promise.all(D)}};return await m(p),{refsByName:o,refsByNumber:r}}async getUnzoomedView(e){const{unzoomedIndexOffset:t,refsByName:i,uncompressBufSize:s,isBigEndian:r,fileType:o}=await this.getHeader(e);return new fee(this.bbi,i,t,r,s>0,o)}async getFeatureStream(e,t,i,s){await this.getHeader(s);const r=this.renameRefSeqs(e);let o;const{basesPerSpan:a,scale:l}=s||{};return a?o=await this.getView(1/a,s):l?o=await this.getView(l,s):o=await this.getView(1,s),new Ba(c=>{o.readWigData(r,t,i,c,s)})}async getFeatures(e,t,i,s){const r=await this.getFeatureStream(e,t,i,s);return(await Mee(r.pipe(Lke()))).flat()}}class Eke extends Bee{async getView(e,t){const{zoomLevels:i,refsByName:s,fileSize:r,isBigEndian:o,uncompressBufSize:a}=await this.getHeader(t),l=1/e;let c=i.length;r||(c-=1);for(let u=c;u>=0;u-=1){const h=i[u];if(h&&h.reductionLevel<=2*l){const d=Number(h.indexOffset);return new fee(this.bbi,s,d,o,a>0,"summary")}}return this.getUnzoomedView(t)}}function Tke(n){return n.filter(e=>!!e)}class Ake extends Bee{constructor(){super(...arguments),this.readIndicesCache=new iT({cache:new L6({maxSize:1}),fill:(e,t)=>this._readIndices({...e,signal:t})})}readIndices(e={}){const{signal:t,...i}=e;return this.readIndicesCache.get(JSON.stringify(i),e,t)}async getView(e,t){return this.getUnzoomedView(t)}async _readIndices(e){const{extHeaderOffset:t,isBigEndian:i}=await this.getHeader(e),{buffer:s}=await this.bbi.read(zs.Buffer.alloc(64),0,64,Number(t)),r=i?"big":"little",o=new Ei().endianess(r).uint16("size").uint16("count").uint64("offset").parse(s),{count:a,offset:l}=o;if(a===0)return[];const c=20,u=c*a,{buffer:h}=await this.bbi.read(zs.Buffer.alloc(u),0,u,Number(l)),d=new Ei().endianess(r).int16("type").int16("fieldcount").uint64("offset").skip(4).int16("field"),f=[];for(let g=0;g<a;g+=1)f.push(d.parse(h.subarray(g*c)));return f}async searchExtraIndexBlocks(e,t={}){const{isBigEndian:i}=await this.getHeader(t),s=await this.readIndices(t);if(s.length===0)return[];const r=s.map(async o=>{const{offset:a,field:l}=o,{buffer:c}=await this.bbi.read(zs.Buffer.alloc(32),0,32,Number(a),t),u=i?"big":"little",h=new Ei().endianess(u).int32("magic").int32("blockSize").int32("keySize").int32("valSize").uint64("itemCount"),{blockSize:d,keySize:f,valSize:g}=h.parse(c),p=new Ei().endianess(u).int8("nodeType").skip(1).int16("cnt").choice({tag:"nodeType",choices:{0:new Ei().array("leafkeys",{length:"cnt",type:new Ei().endianess(u).string("key",{length:f,stripNull:!0}).uint64("offset")}),1:new Ei().array("keys",{length:"cnt",type:new Ei().endianess(u).string("key",{length:f,stripNull:!0}).uint64("offset").uint32("length").uint32("reserved")})}}),m=async v=>{const w=Number(v),y=4+d*(f+g),{buffer:x}=await this.bbi.read(zs.Buffer.alloc(y),0,y,w,t),D=p.parse(x);if(D.leafkeys){let S;for(let T=0;T<D.leafkeys.length;T+=1){const{key:k}=D.leafkeys[T];if(e.localeCompare(k)<0&&S)return m(S);S=D.leafkeys[T].offset}return m(S)}for(let S=0;S<D.keys.length;S+=1)if(D.keys[S].key===e)return{...D.keys[S],field:l}},b=32;return m(Number(a)+b)});return Tke(await Promise.all(r))}async searchExtraIndex(e,t={}){const i=await this.searchExtraIndexBlocks(e,t);if(i.length===0)return[];const s=await this.getUnzoomedView(t),r=i.map(a=>new Ba(l=>{s.readFeatures(l,[a],t)}).pipe(Oee((l,c)=>l.concat(c)),Fee(l=>{for(const c of l)c.field=a.field;return l})));return(await Mee(Ske(...r))).filter(a=>{var l;return((l=a.rest)===null||l===void 0?void 0:l.split("	")[(a.field||0)-3])===e})}}function oS(n,e,t=!0){let i,s=o=>{};return function(...a){return new Promise((l,c)=>{const u=()=>{clearTimeout(i),s=h=>{},l(n(...a))};t&&s("debounced"),clearTimeout(i),s=c,i=window.setTimeout(u,e)})}}class Ike extends JC(Hp){constructor(t,i){const s={pixelsPerBin:2,channel:"x",...t};super(i,s.channel);Rn(this,"reductionLevels",[]);Rn(this,"lastRequestId",0);if(this.params=s,!this.params.url)throw new Error("No URL provided for BigWigSource");this.bbi=new Eke({filehandle:new fc(eS(this.params.url,this.view.getBaseUrl()))}),this.doDebouncedRequest=oS(this.doRequest.bind(this),200,!1),this.headerPromise=this.bbi.getHeader(),this.headerPromise.then(r=>{this.reductionLevels=r.zoomLevels.map(o=>o.reductionLevel).reverse(),this.reductionLevels.push(1)})}async onDomainChanged(t){await this.headerPromise;const i=this.getAxisLength()||700,s=Nke(t,i,this.reductionLevels),r=Math.max(s*i,5e3),o=this.quantizeInterval(t,r);this.checkAndUpdateLastInterval(o)&&this.doDebouncedRequest(o,s)}async doRequest(t,i){const s=await this.getFeatures(t,.5/i/this.params.pixelsPerBin);s.requestId<this.lastRequestId||this.publishData(s.features)}async getFeatures(t,i){let s=++this.lastRequestId;const r=new AbortController,o=this.genome.continuousToDiscreteChromosomeIntervals(t),a=await Promise.all(o.map(l=>this.bbi.getFeatures(l.chrom,l.startPos,l.endPos,{scale:i,signal:r.signal}).then(c=>c.map(u=>({chrom:l.chrom,start:u.start,end:u.end,score:u.score})))));return{requestId:s,abort:()=>r.abort(),features:a.flat()}}}function Nke(n,e,t){const i=(n[1]-n[0])/e;return t.find(s=>s<i)??t.at(-1)}function Rke(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function z_(n,e,t,i){this.message=n,this.expected=e,this.found=t,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,z_)}Rke(z_,Error);z_.buildMessage=function(n,e){var t={literal:function(c){return'"'+s(c.text)+'"'},class:function(c){var u="",h;for(h=0;h<c.parts.length;h++)u+=c.parts[h]instanceof Array?r(c.parts[h][0])+"-"+r(c.parts[h][1]):r(c.parts[h]);return"["+(c.inverted?"^":"")+u+"]"},any:function(c){return"any character"},end:function(c){return"end of input"},other:function(c){return c.description}};function i(c){return c.charCodeAt(0).toString(16).toUpperCase()}function s(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function r(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+i(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+i(u)})}function o(c){return t[c.type](c)}function a(c){var u=new Array(c.length),h,d;for(h=0;h<c.length;h++)u[h]=o(c[h]);if(u.sort(),u.length>0){for(h=1,d=1;h<u.length;h++)u[h-1]!==u[h]&&(u[d]=u[h],d++);u.length=d}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+s(c)+'"':"end of input"}return"Expected "+a(n)+" but "+l(e)+" found."};function Mke(n,e){e=e!==void 0?e:{};var t={},i={declaration:Me},s=Me,r="(",o=qt("(",!1),a=")",l=qt(")",!1),c=function(V,ge,je,Ze){return{type:V,name:ge,comment:je,fields:Ze}},u="simple",h=qt("simple",!1),d="object",f=qt("object",!1),g="table",p=qt("table",!1),m="auto",b=qt("auto",!1),v="primary",w=qt("primary",!1),y="index",x=qt("index",!1),D="unique",S=qt("unique",!1),T=function(V,ge){return ge},k=function(V,ge){return V.name&&ge.unshift(V),ge},I="#",N=qt("#",!1),z=";",$=qt(";",!1),q=function(V,ge,je){return{type:V,name:ge,comment:je}},ne="[",de=qt("[",!1),me="]",De=qt("]",!1),ve=function(V,ge,je,Ze){return{type:V,size:ge,name:je,comment:Ze}},$e=function(V,ge,je,Ze){return{type:V,vals:ge,name:je,comment:Ze}},Ne=",",xe=qt(",",!1),fe=function(V,ge){return ge.unshift(V),ge},jt="int",mi=qt("int",!1),re="uint",te=qt("uint",!1),ye="short",_e=qt("short",!1),Ie="ushort",F=qt("ushort",!1),M="byte",pe=qt("byte",!1),ke="ubyte",et=qt("ubyte",!1),Xe="float",Nt=qt("float",!1),is="char",Zo=qt("char",!1),le="string",ie=qt("string",!1),Q="lstring",R=qt("lstring",!1),W="enum",K=qt("enum",!1),U="double",A=qt("double",!1),C="bigint",L=qt("bigint",!1),O="set",j=qt("set",!1),Z=function(V,ge){return V+" "+ge},ce=/^[a-zA-Z_]/,Ue=ph([["a","z"],["A","Z"],"_"],!1,!1),Re=/^[a-zA-Z0-9_]/,lt=ph([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ft=function(V){return Nf()},$t=/^[^\n\r]/,Rt=ph([`
`,"\r"],!0,!1),qi=function(V){return V.join("").replace(/^"/,"").replace(/"$/,"")},jc=n1("integer"),Fl=/^[0-9]/,Gr=ph([["0","9"]],!1,!1),Pl=function(){return parseInt(Nf(),10)},qc=n1("whitespace"),Ol=/^[ \t\n\r]/,Gc=ph([" ","	",`
`,"\r"],!1,!1),Y=0,ns=0,Sr=[{line:1,column:1}],Js=0,Kc=[],ht=0,wm;if("startRule"in e){if(!(e.startRule in i))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');s=i[e.startRule]}function Nf(){return n.substring(ns,Y)}function qt(V,ge){return{type:"literal",text:V,ignoreCase:ge}}function ph(V,ge,je){return{type:"class",parts:V,inverted:ge,ignoreCase:je}}function VS(){return{type:"end"}}function n1(V){return{type:"other",description:V}}function s1(V){var ge=Sr[V],je;if(ge)return ge;for(je=V-1;!Sr[je];)je--;for(ge=Sr[je],ge={line:ge.line,column:ge.column};je<V;)n.charCodeAt(je)===10?(ge.line++,ge.column=1):ge.column++,je++;return Sr[V]=ge,ge}function $S(V,ge){var je=s1(V),Ze=s1(ge);return{start:{offset:V,line:je.line,column:je.column},end:{offset:ge,line:Ze.line,column:Ze.column}}}function Te(V){Y<Js||(Y>Js&&(Js=Y,Kc=[]),Kc.push(V))}function se(V,ge,je){return new z_(z_.buildMessage(V,ge),V,ge,je)}function Me(){var V,ge,je,Ze,yt,Gi,cn,Xo,mh,Zc,_h,Yc,bh,Xc;return V=Y,ge=ai(),ge!==t?(je=Ke(),je!==t?(Ze=ai(),Ze!==t?(yt=_i(),yt!==t?(Gi=ai(),Gi!==t?(cn=Rs(),cn!==t?(Xo=ai(),Xo!==t?(n.charCodeAt(Y)===40?(mh=r,Y++):(mh=t,ht===0&&Te(o)),mh!==t?(Zc=ai(),Zc!==t?(_h=en(),_h!==t?(Yc=ai(),Yc!==t?(n.charCodeAt(Y)===41?(bh=a,Y++):(bh=t,ht===0&&Te(l)),bh!==t?(Xc=ai(),Xc!==t?(ns=V,ge=c(je,yt,cn,_h),V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t),V}function Ke(){var V;return n.substr(Y,6)===u?(V=u,Y+=6):(V=t,ht===0&&Te(h)),V===t&&(n.substr(Y,6)===d?(V=d,Y+=6):(V=t,ht===0&&Te(f)),V===t&&(n.substr(Y,5)===g?(V=g,Y+=5):(V=t,ht===0&&Te(p)))),V}function _i(){var V,ge,je,Ze;return V=Ha(),V===t&&(V=Y,ge=Ha(),ge!==t?(je=Nn(),je!==t?(ge=[ge,je],V=ge):(Y=V,V=t)):(Y=V,V=t),V===t&&(V=Y,ge=Ha(),ge!==t?(n.substr(Y,4)===m?(je=m,Y+=4):(je=t,ht===0&&Te(b)),je!==t?(ge=[ge,je],V=ge):(Y=V,V=t)):(Y=V,V=t),V===t&&(V=Y,ge=Ha(),ge!==t?(je=Nn(),je!==t?(n.substr(Y,4)===m?(Ze=m,Y+=4):(Ze=t,ht===0&&Te(b)),Ze!==t?(ge=[ge,je,Ze],V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)))),V}function Nn(){var V;return n.substr(Y,7)===v?(V=v,Y+=7):(V=t,ht===0&&Te(w)),V===t&&(n.substr(Y,5)===y?(V=y,Y+=5):(V=t,ht===0&&Te(x)),V===t&&(n.substr(Y,6)===D?(V=D,Y+=6):(V=t,ht===0&&Te(S)))),V}function Rs(){var V;return V=D9(),V===t&&(V=ai()),V}function en(){var V,ge,je,Ze,yt,Gi,cn;if(V=Y,ge=ym(),ge!==t)if(je=ai(),je!==t){for(Ze=[],yt=Y,Gi=ai(),Gi!==t?(cn=ym(),cn!==t?(ns=yt,Gi=T(ge,cn),yt=Gi):(Y=yt,yt=t)):(Y=yt,yt=t);yt!==t;)Ze.push(yt),yt=Y,Gi=ai(),Gi!==t?(cn=ym(),cn!==t?(ns=yt,Gi=T(ge,cn),yt=Gi):(Y=yt,yt=t)):(Y=yt,yt=t);Ze!==t?(yt=ai(),yt!==t?(ns=V,ge=k(ge,Ze),V=ge):(Y=V,V=t)):(Y=V,V=t)}else Y=V,V=t;else Y=V,V=t;return V}function Yo(){var V;return n.charCodeAt(Y)===35?(V=I,Y++):(V=t,ht===0&&Te(N)),V}function r1(){var V,ge,je,Ze,yt;return V=Y,ge=ai(),ge!==t?(je=Yo(),je!==t?(Ze=D9(),Ze!==t?(yt=ai(),yt!==t?(ge=[ge,je,Ze,yt],V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t),V}function ym(){var V,ge,je,Ze,yt,Gi,cn,Xo,mh,Zc,_h,Yc,bh,Xc;return V=Y,ge=AA(),ge!==t?(je=ai(),je!==t?(Ze=Ha(),Ze!==t?(yt=ai(),yt!==t?(n.charCodeAt(Y)===59?(Gi=z,Y++):(Gi=t,ht===0&&Te($)),Gi!==t?(cn=ai(),cn!==t?(Xo=Rs(),Xo!==t?(ns=V,ge=q(ge,Ze,Xo),V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t),V===t&&(V=Y,ge=AA(),ge!==t?(je=ai(),je!==t?(n.charCodeAt(Y)===91?(Ze=ne,Y++):(Ze=t,ht===0&&Te(de)),Ze!==t?(yt=ai(),yt!==t?(Gi=Qae(),Gi!==t?(cn=ai(),cn!==t?(n.charCodeAt(Y)===93?(Xo=me,Y++):(Xo=t,ht===0&&Te(De)),Xo!==t?(mh=ai(),mh!==t?(Zc=Ha(),Zc!==t?(_h=ai(),_h!==t?(n.charCodeAt(Y)===59?(Yc=z,Y++):(Yc=t,ht===0&&Te($)),Yc!==t?(bh=ai(),bh!==t?(Xc=Rs(),Xc!==t?(ns=V,ge=ve(ge,Gi,Zc,Xc),V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t),V===t&&(V=Y,ge=AA(),ge!==t?(je=ai(),je!==t?(n.charCodeAt(Y)===40?(Ze=r,Y++):(Ze=t,ht===0&&Te(o)),Ze!==t?(yt=ai(),yt!==t?(Gi=L9(),Gi!==t?(cn=ai(),cn!==t?(n.charCodeAt(Y)===41?(Xo=a,Y++):(Xo=t,ht===0&&Te(l)),Xo!==t?(mh=ai(),mh!==t?(Zc=Ha(),Zc!==t?(_h=ai(),_h!==t?(n.charCodeAt(Y)===59?(Yc=z,Y++):(Yc=t,ht===0&&Te($)),Yc!==t?(bh=ai(),bh!==t?(Xc=Rs(),Xc!==t?(ns=V,ge=$e(ge,Gi,Zc,Xc),V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t),V===t&&(V=r1()))),V}function L9(){var V,ge,je,Ze,yt,Gi,cn;if(V=Y,ge=Ha(),ge!==t){for(je=[],Ze=Y,n.charCodeAt(Y)===44?(yt=Ne,Y++):(yt=t,ht===0&&Te(xe)),yt!==t?(Gi=ai(),Gi!==t?(cn=Ha(),cn!==t?(ns=Ze,yt=T(ge,cn),Ze=yt):(Y=Ze,Ze=t)):(Y=Ze,Ze=t)):(Y=Ze,Ze=t);Ze!==t;)je.push(Ze),Ze=Y,n.charCodeAt(Y)===44?(yt=Ne,Y++):(yt=t,ht===0&&Te(xe)),yt!==t?(Gi=ai(),Gi!==t?(cn=Ha(),cn!==t?(ns=Ze,yt=T(ge,cn),Ze=yt):(Y=Ze,Ze=t)):(Y=Ze,Ze=t)):(Y=Ze,Ze=t);je!==t?(ns=V,ge=fe(ge,je),V=ge):(Y=V,V=t)}else Y=V,V=t;return V}function AA(){var V,ge,je,Ze;return n.substr(Y,3)===jt?(V=jt,Y+=3):(V=t,ht===0&&Te(mi)),V===t&&(n.substr(Y,4)===re?(V=re,Y+=4):(V=t,ht===0&&Te(te)),V===t&&(n.substr(Y,5)===ye?(V=ye,Y+=5):(V=t,ht===0&&Te(_e)),V===t&&(n.substr(Y,6)===Ie?(V=Ie,Y+=6):(V=t,ht===0&&Te(F)),V===t&&(n.substr(Y,4)===M?(V=M,Y+=4):(V=t,ht===0&&Te(pe)),V===t&&(n.substr(Y,5)===ke?(V=ke,Y+=5):(V=t,ht===0&&Te(et)),V===t&&(n.substr(Y,5)===Xe?(V=Xe,Y+=5):(V=t,ht===0&&Te(Nt)),V===t&&(n.substr(Y,4)===is?(V=is,Y+=4):(V=t,ht===0&&Te(Zo)),V===t&&(n.substr(Y,6)===le?(V=le,Y+=6):(V=t,ht===0&&Te(ie)),V===t&&(n.substr(Y,7)===Q?(V=Q,Y+=7):(V=t,ht===0&&Te(R)),V===t&&(n.substr(Y,4)===W?(V=W,Y+=4):(V=t,ht===0&&Te(K)),V===t&&(n.substr(Y,6)===U?(V=U,Y+=6):(V=t,ht===0&&Te(A)),V===t&&(n.substr(Y,6)===C?(V=C,Y+=6):(V=t,ht===0&&Te(L)),V===t&&(n.substr(Y,3)===O?(V=O,Y+=3):(V=t,ht===0&&Te(j)),V===t&&(V=Y,ge=Ke(),ge!==t?(je=ai(),je!==t?(Ze=_i(),Ze!==t?(ns=V,ge=Z(ge,Ze),V=ge):(Y=V,V=t)):(Y=V,V=t)):(Y=V,V=t))))))))))))))),V}function Qae(){var V;return V=Jae(),V===t&&(V=Ha()),V}function Ha(){var V,ge,je,Ze,yt;if(V=Y,ge=Y,ce.test(n.charAt(Y))?(je=n.charAt(Y),Y++):(je=t,ht===0&&Te(Ue)),je!==t){for(Ze=[],Re.test(n.charAt(Y))?(yt=n.charAt(Y),Y++):(yt=t,ht===0&&Te(lt));yt!==t;)Ze.push(yt),Re.test(n.charAt(Y))?(yt=n.charAt(Y),Y++):(yt=t,ht===0&&Te(lt));Ze!==t?(je=[je,Ze],ge=je):(Y=ge,ge=t)}else Y=ge,ge=t;return ge!==t&&(ns=V,ge=ft()),V=ge,V}function D9(){var V,ge,je;for(V=Y,ge=[],$t.test(n.charAt(Y))?(je=n.charAt(Y),Y++):(je=t,ht===0&&Te(Rt));je!==t;)ge.push(je),$t.test(n.charAt(Y))?(je=n.charAt(Y),Y++):(je=t,ht===0&&Te(Rt));return ge!==t&&(ns=V,ge=qi(ge)),V=ge,V}function Jae(){var V,ge,je,Ze;if(ht++,V=Y,ge=ai(),ge!==t){if(je=[],Fl.test(n.charAt(Y))?(Ze=n.charAt(Y),Y++):(Ze=t,ht===0&&Te(Gr)),Ze!==t)for(;Ze!==t;)je.push(Ze),Fl.test(n.charAt(Y))?(Ze=n.charAt(Y),Y++):(Ze=t,ht===0&&Te(Gr));else je=t;je!==t?(ns=V,ge=Pl(),V=ge):(Y=V,V=t)}else Y=V,V=t;return ht--,V===t&&(ge=t,ht===0&&Te(jc)),V}function ai(){var V,ge;for(ht++,V=[],Ol.test(n.charAt(Y))?(ge=n.charAt(Y),Y++):(ge=t,ht===0&&Te(Gc));ge!==t;)V.push(ge),Ol.test(n.charAt(Y))?(ge=n.charAt(Y),Y++):(ge=t,ht===0&&Te(Gc));return ht--,V===t&&(ge=t,ht===0&&Te(qc)),V}if(wm=s(),wm!==t&&Y===n.length)return wm;throw wm!==t&&Y<n.length&&Te(VS()),se(Kc,Js<n.length?n.charAt(Js):null,Js<n.length?$S(Js,Js+1):$S(Js,Js))}var Wee={SyntaxError:z_,parse:Mke};const Fke=Up(Wee),Pke=`table bigChain
"bigChain pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - for strand"
    uint tSize;         "size of target sequence"
    string qName;       "name of query sequence"
    uint qSize;         "size of query sequence"
    uint qStart;        "start of alignment on query sequence"
    uint qEnd;          "end of alignment on query sequence"
    uint chainScore;    "score from chain"
    )`,Oke=`table bigGenePred
"bigGenePred gene models"
   (
   string chrom;       "Reference sequence chromosome or scaffold"
   uint   chromStart;  "Start position in chromosome"
   uint   chromEnd;    "End position in chromosome"
   string name;        "Name or ID of item, ideally both human readable and unique"
   uint score;         "Score (0-1000)"
   char[1] strand;     "+ or - for strand"
   uint thickStart;    "Start of where display should be thick (start codon)"
   uint thickEnd;      "End of where display should be thick (stop codon)"
   uint reserved;       "RGB value (use R,G,B string in input file)"
   int blockCount;     "Number of blocks"
   int[blockCount] blockSizes; "Comma separated list of block sizes"
   int[blockCount] chromStarts; "Start positions relative to chromStart"
   string name2;       "Alternative/human readable name"
   string cdsStartStat; "Status of CDS start annotation (none, unknown, incomplete, or complete)"
   string cdsEndStat;   "Status of CDS end annotation (none, unknown, incomplete, or complete)"
   int[blockCount] exonFrames; "Exon frame {0,1,2}, or -1 if no frame for exon"
   string type;        "Transcript type"
   string geneName;    "Primary identifier for gene"
   string geneName2;   "Alternative/human readable gene name"
   string geneType;    "Gene type"
   )`,Bke=`table interact
"interaction between two regions"
    (
    string chrom;        "Chromosome (or contig, scaffold, etc.). For interchromosomal, use 2 records"
    uint chromStart;     "Start position of lower region. For interchromosomal, set to chromStart of this region"
    uint chromEnd;       "End position of upper region. For interchromosomal, set to chromEnd of this region"
    string name;         "Name of item, for display.  Usually 'sourceName/targetName/exp' or empty"
    uint score;          "Score (0-1000)"
    double value;        "Strength of interaction or other data value. Typically basis for score"
    string exp;          "Experiment name (metadata for filtering). Use . if not applicable"
    string color;        "Item color.  Specified as r,g,b or hexadecimal #RRGGBB or html color name, as in //www.w3.org/TR/css3-color/#html4. Use 0 and spectrum setting to shade by score"
    string sourceChrom;  "Chromosome of source region (directional) or lower region. For non-directional interchromosomal, chrom of this region."
    uint sourceStart;    "Start position in chromosome of source/lower/this region"
    uint sourceEnd;      "End position in chromosome of source/lower/this region"
    string sourceName;   "Identifier of source/lower/this region"
    string sourceStrand; "Orientation of source/lower/this region: + or -.  Use . if not applicable"
    string targetChrom;  "Chromosome of target region (directional) or upper region. For non-directional interchromosomal, chrom of other region"
    uint targetStart;    "Start position in chromosome of target/upper/this region"
    uint targetEnd;      "End position in chromosome of target/upper/this region"
    string targetName;   "Identifier of target/upper/this region"
    string targetStrand; "Orientation of target/upper/this region: + or -.  Use . if not applicable"

    )`,Wke=`table bigLink
"bigLink pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint qStart;        "start of alignment on query sequence"
    )`,Vke=`table bedMaf
"Bed3 with MAF block"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    lstring mafBlock;   "MAF block"
    )`,$ke=`table bigNarrowPeak
"BED6+4 Peaks of signal enrichment based on pooled, normalized (interpreted) data."
(
    string chrom;        "Reference sequence chromosome or scaffold"
    uint   chromStart;   "Start position in chromosome"
    uint   chromEnd;     "End position in chromosome"
    string name;	 "Name given to a region (preferably unique). Use . if no name is assigned"
    uint   score;        "Indicates how dark the peak will be displayed in the browser (0-1000) "
    char[1]  strand;     "+ or - or . for unknown"
    float  signalValue;  "Measurement of average enrichment for the region"
    float  pValue;       "Statistical significance of signal value (-log10). Set to -1 if not used."
    float  qValue;       "Statistical significance with multiple-test correction applied (FDR -log10). Set to -1 if not used."
    int   peak;         "Point-source called for this peak; 0-based offset from chromStart. Set to -1 if no point-source called."
)`,zke=`table bigPsl
"bigPsl pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - indicates whether the query aligns to the + or - strand on the reference"
    uint thickStart;    "Start of where display should be thick (start codon)"
    uint thickEnd;      "End of where display should be thick (stop codon)"
    uint reserved;       "RGB value (use R,G,B string in input file)"
    int blockCount;     "Number of blocks"
    int[blockCount] blockSizes; "Comma separated list of block sizes"
    int[blockCount] chromStarts; "Start positions relative to chromStart"

    uint    oChromStart;"Start position in other chromosome"
    uint    oChromEnd;  "End position in other chromosome"
    char[1] oStrand;    "+ or -, - means that psl was reversed into BED-compatible coordinates"
    uint    oChromSize; "Size of other chromosome."
    int[blockCount] oChromStarts; "Start positions relative to oChromStart or from oChromStart+oChromSize depending on strand"

    lstring  oSequence;  "Sequence on other chrom (or empty)"
    string   oCDS;       "CDS in NCBI format"

    uint    chromSize;"Size of target chromosome"

    uint match;        "Number of bases matched."
    uint misMatch; " Number of bases that don't match "
    uint repMatch; " Number of bases that match but are part of repeats "
    uint nCount;   " Number of 'N' bases "
    uint seqType;    "0=empty, 1=nucleotide, 2=amino_acid"
    )`,Hke=`table defaultBedSchema
"BED12"
    (
    string chrom;      "The name of the chromosome (e.g. chr3, chrY, chr2_random) or scaffold (e.g. scaffold10671)."
    uint   chromStart; "The starting position of the feature in the chromosome or scaffold. The first base in a chromosome is numbered 0."
    uint   chromEnd;   "The ending position of the feature in the chromosome or scaffold. The chromEnd base is not included in the display of the feature. For example, the first 100 bases of a chromosome are defined as chromStart=0, chromEnd=100, and span the bases numbered 0-99."
    string   name;   "Defines the name of the BED line."
    float   score;   "Feature score, doesn't care about the 0-1000 limit as in bed"
    char   strand;   "Defines the strand. Either '.' (=no strand) or '+' or '-'"
    uint thickStart; "The starting position at which the feature is drawn thickly (for example, the start codon in gene displays). When there is no thick part, thickStart and thickEnd are usually set to the chromStart position."
    uint thickEnd; "The ending position at which the feature is drawn thickly (for example the stop codon in gene displays)."
    string itemRgb; "An RGB value of the form R,G,B (e.g. 255,0,0). "
    uint blockCount; " The number of blocks (exons) in the BED line."
    uint[blockCount] blockSizes; " A comma-separated list of the block sizes. The number of items in this list should correspond to blockCount."
    uint[blockCount] blockStarts; "A comma-separated list of block starts. All of the blockStart positions should be calculated relative to chromStart. The number of items in this list should correspond to blockCount."
    )`,Uke=`table mafFrames
"codon frame assignment for MAF components"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start range in chromosome"
    uint   chromEnd;   "End range in chromosome"
    string src;        "Name of sequence source in MAF"
    ubyte frame;       "frame (0,1,2) for first base(+) or last bast(-)"
    char[1] strand;    "+ or -"
    string name;       "Name of gene used to define frame"
    int    prevFramePos;  "target position of the previous base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    int    nextFramePos;  "target position of the next base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    ubyte  isExonStart;  "does this start the CDS portion of an exon?"
    ubyte  isExonEnd;    "does this end the CDS portion of an exon?"
    )`,jke=`table mafSummary
"Positions and scores for alignment blocks"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    string src;        "Sequence name or database of alignment"
    float  score;      "Floating point score."
    char[1] leftStatus;  "Gap/break annotation for preceding block"
    char[1] rightStatus; "Gap/break annotation for following block"
    )`,qke=Object.freeze(Object.defineProperty({__proto__:null,bigChain:Pke,bigGenePred:Oke,bigInteract:Bke,bigLink:Wke,bigMaf:Vke,bigNarrowPeak:$ke,bigPsl:zke,defaultBedSchema:Hke,mafFrames:Uke,mafSummary:jke},Symbol.toStringTag,{value:"Module"})),ZI=Object.fromEntries(Object.entries(qke).map(([n,e])=>[n,Wee.parse(e.trim())]));function YI(n){const e=["uint","int","float","long"];return{...n,fields:n.fields.map(t=>({...t,isArray:t.size&&t.type!=="char",arrayIsNumeric:t.size&&e.includes(t.type),isNumeric:!t.size&&e.includes(t.type)}))}}const Gke={".":0,"-":-1,"+":1};function Kke(n){var e;return n.length>=12&&!Number.isNaN(parseInt(n[9],10))&&((e=n[10])===null||e===void 0?void 0:e.split(",").filter(t=>!!t).length)===parseInt(n[9],10)}class Zke{constructor(e={}){if(e.autoSql)this.autoSql=YI(Fke.parse(e.autoSql));else if(e.type){if(!ZI[e.type])throw new Error("Type not found");this.autoSql=YI(ZI[e.type])}else this.autoSql=YI(ZI.defaultBedSchema),this.attemptDefaultBed=!0}parseLine(e,t={}){const{autoSql:i}=this,{uniqueId:s}=t,r=Array.isArray(e)?e:e.split("	");let o={};if(!this.attemptDefaultBed||this.attemptDefaultBed&&Kke(r))for(let a=0;a<i.fields.length;a++){const l=i.fields[a];let c=r[a];const{isNumeric:u,isArray:h,arrayIsNumeric:d,name:f}=l;if(c==null)break;if(c!=="."){if(u){const g=Number(c);c=Number.isNaN(g)?c:g}else h&&(c=c.split(","),c[c.length-1]===""&&c.pop(),d&&(c=c.map(g=>Number(g))));o[f]=c}}else{const a=["chrom","chromStart","chromEnd","name"];o=Object.fromEntries(r.map((l,c)=>[a[c]||"field"+c,l])),o.chromStart=+o.chromStart,o.chromEnd=+o.chromEnd,Number.isNaN(Number.parseFloat(o.field4))||(o.score=+o.field4,delete o.field4),(o.field5==="+"||o.field5==="-")&&(o.strand=o.field5,delete o.field5)}return s&&(o.uniqueId=s),o.strand=Gke[o.strand]||0,o.chrom=decodeURIComponent(o.chrom),o}}class Yke extends JC(Hp){constructor(t,i){const s={channel:"x",windowSize:1e6,...t};super(i,s.channel);Rn(this,"lastRequestId",0);Rn(this,"parser");if(this.params=s,!this.params.url)throw new Error("No URL provided for BigBedSource");this.bbi=new Ake({filehandle:new fc(eS(this.params.url,this.view.getBaseUrl()))}),this.doDebouncedRequest=oS(this.doRequest.bind(this),200,!1),this.headerPromise=this.bbi.getHeader(),this.headerPromise.then(r=>{this.parser=new Zke({autoSql:r.autoSql})})}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;const s=this.quantizeInterval(t,i);this.checkAndUpdateLastInterval(s)&&this.doDebouncedRequest(s)}async doRequest(t){const i=await this.getFeatures(t);i.requestId<this.lastRequestId||this.publishData(i.features)}async getFeatures(t){let i=++this.lastRequestId;const s=new AbortController,r=this.genome.continuousToDiscreteChromosomeIntervals(t),o=await Promise.all(r.map(a=>this.bbi.getFeatures(a.chrom,a.startPos,a.endPos,{signal:s.signal}).then(l=>l.map(c=>this.parser.parseLine(`${a.chrom}	${c.start}	${c.end}	${c.rest}`,{uniqueId:c.uniqueId})))));return{requestId:i,abort:()=>s.abort(),features:o.flat()}}}var Xke=Zi,ua=null;try{ua=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Zi(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Zi.prototype.__isLong__;Object.defineProperty(Zi.prototype,"__isLong__",{value:!0});function yo(n){return(n&&n.__isLong__)===!0}Zi.isLong=yo;var U$={},j$={};function Zp(n,e){var t,i,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(i=j$[n],i)?i:(t=Yi(n,(n|0)<0?-1:0,!0),s&&(j$[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(i=U$[n],i)?i:(t=Yi(n,n<0?-1:0,!1),s&&(U$[n]=t),t))}Zi.fromInt=Zp;function ha(n,e){if(isNaN(n))return e?xg:da;if(e){if(n<0)return xg;if(n>=Vee)return Hee}else{if(n<=-G$)return ao;if(n+1>=G$)return zee}return n<0?ha(-n,e).neg():Yi(n%H_|0,n/H_|0,e)}Zi.fromNumber=ha;function Yi(n,e,t){return new Zi(n,e,t)}Zi.fromBits=Yi;var mL=Math.pow;function B6(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return da;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return B6(n.substring(1),e,t).neg();for(var s=ha(mL(t,8)),r=da,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=ha(mL(t,a));r=r.mul(c).add(ha(l))}else r=r.mul(s),r=r.add(ha(l))}return r.unsigned=e,r}Zi.fromString=B6;function Al(n,e){return typeof n=="number"?ha(n,e):typeof n=="string"?B6(n,e):Yi(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Zi.fromValue=Al;var q$=65536,Qke=1<<24,H_=q$*q$,Vee=H_*H_,G$=Vee/2,K$=Zp(Qke),da=Zp(0);Zi.ZERO=da;var xg=Zp(0,!0);Zi.UZERO=xg;var o0=Zp(1);Zi.ONE=o0;var $ee=Zp(1,!0);Zi.UONE=$ee;var x4=Zp(-1);Zi.NEG_ONE=x4;var zee=Yi(-1,2147483647,!1);Zi.MAX_VALUE=zee;var Hee=Yi(-1,-1,!0);Zi.MAX_UNSIGNED_VALUE=Hee;var ao=Yi(0,-2147483648,!1);Zi.MIN_VALUE=ao;var ze=Zi.prototype;ze.toInt=function(){return this.unsigned?this.low>>>0:this.low};ze.toNumber=function(){return this.unsigned?(this.high>>>0)*H_+(this.low>>>0):this.high*H_+(this.low>>>0)};ze.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ao)){var t=ha(e),i=this.div(t),s=i.mul(t).sub(this);return i.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=ha(mL(e,6),this.unsigned),o=this,a="";;){var l=o.div(r),c=o.sub(l.mul(r)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ze.getHighBits=function(){return this.high};ze.getHighBitsUnsigned=function(){return this.high>>>0};ze.getLowBits=function(){return this.low};ze.getLowBitsUnsigned=function(){return this.low>>>0};ze.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ao)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};ze.isZero=function(){return this.high===0&&this.low===0};ze.eqz=ze.isZero;ze.isNegative=function(){return!this.unsigned&&this.high<0};ze.isPositive=function(){return this.unsigned||this.high>=0};ze.isOdd=function(){return(this.low&1)===1};ze.isEven=function(){return(this.low&1)===0};ze.equals=function(e){return yo(e)||(e=Al(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ze.eq=ze.equals;ze.notEquals=function(e){return!this.eq(e)};ze.neq=ze.notEquals;ze.ne=ze.notEquals;ze.lessThan=function(e){return this.comp(e)<0};ze.lt=ze.lessThan;ze.lessThanOrEqual=function(e){return this.comp(e)<=0};ze.lte=ze.lessThanOrEqual;ze.le=ze.lessThanOrEqual;ze.greaterThan=function(e){return this.comp(e)>0};ze.gt=ze.greaterThan;ze.greaterThanOrEqual=function(e){return this.comp(e)>=0};ze.gte=ze.greaterThanOrEqual;ze.ge=ze.greaterThanOrEqual;ze.compare=function(e){if(yo(e)||(e=Al(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ze.comp=ze.compare;ze.negate=function(){return!this.unsigned&&this.eq(ao)?ao:this.not().add(o0)};ze.neg=ze.negate;ze.add=function(e){yo(e)||(e=Al(e));var t=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=r+c,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=i+a,u+=h>>>16,h&=65535,u+=t+o,u&=65535,Yi(d<<16|f,u<<16|h,this.unsigned)};ze.subtract=function(e){return yo(e)||(e=Al(e)),this.add(e.neg())};ze.sub=ze.subtract;ze.multiply=function(e){if(this.isZero())return da;if(yo(e)||(e=Al(e)),ua){var t=ua.mul(this.low,this.high,e.low,e.high);return Yi(t,ua.get_high(),this.unsigned)}if(e.isZero())return da;if(this.eq(ao))return e.isOdd()?ao:da;if(e.eq(ao))return this.isOdd()?ao:da;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(K$)&&e.lt(K$))return ha(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,g=0;return g+=o*u,f+=g>>>16,g&=65535,f+=r*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=r*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=i*u+s*c+r*l+o*a,h&=65535,Yi(f<<16|g,h<<16|d,this.unsigned)};ze.mul=ze.multiply;ze.divide=function(e){if(yo(e)||(e=Al(e)),e.isZero())throw Error("division by zero");if(ua){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?ua.div_u:ua.div_s)(this.low,this.high,e.low,e.high);return Yi(t,ua.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?xg:da;var i,s,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return xg;if(e.gt(this.shru(1)))return $ee;r=xg}else{if(this.eq(ao)){if(e.eq(o0)||e.eq(x4))return ao;if(e.eq(ao))return o0;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(da)?e.isNegative()?o0:x4:(s=this.sub(e.mul(i)),r=i.add(s.div(e)),r)}else if(e.eq(ao))return this.unsigned?xg:da;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=da}for(s=this;s.gte(e);){i=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:mL(2,a-48),c=ha(i),u=c.mul(e);u.isNegative()||u.gt(s);)i-=l,c=ha(i,this.unsigned),u=c.mul(e);c.isZero()&&(c=o0),r=r.add(c),s=s.sub(u)}return r};ze.div=ze.divide;ze.modulo=function(e){if(yo(e)||(e=Al(e)),ua){var t=(this.unsigned?ua.rem_u:ua.rem_s)(this.low,this.high,e.low,e.high);return Yi(t,ua.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ze.mod=ze.modulo;ze.rem=ze.modulo;ze.not=function(){return Yi(~this.low,~this.high,this.unsigned)};ze.and=function(e){return yo(e)||(e=Al(e)),Yi(this.low&e.low,this.high&e.high,this.unsigned)};ze.or=function(e){return yo(e)||(e=Al(e)),Yi(this.low|e.low,this.high|e.high,this.unsigned)};ze.xor=function(e){return yo(e)||(e=Al(e)),Yi(this.low^e.low,this.high^e.high,this.unsigned)};ze.shiftLeft=function(e){return yo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Yi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Yi(0,this.low<<e-32,this.unsigned)};ze.shl=ze.shiftLeft;ze.shiftRight=function(e){return yo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Yi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Yi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ze.shr=ze.shiftRight;ze.shiftRightUnsigned=function(e){if(yo(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return Yi(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Yi(t,0,this.unsigned):Yi(t>>>e-32,0,this.unsigned)};ze.shru=ze.shiftRightUnsigned;ze.shr_u=ze.shiftRightUnsigned;ze.toSigned=function(){return this.unsigned?Yi(this.low,this.high,!1):this};ze.toUnsigned=function(){return this.unsigned?this:Yi(this.low,this.high,!0)};ze.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ze.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ze.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Zi.fromBytes=function(e,t,i){return i?Zi.fromBytesLE(e,t):Zi.fromBytesBE(e,t)};Zi.fromBytesLE=function(e,t){return new Zi(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Zi.fromBytesBE=function(e,t){return new Zi(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const Uee=Up(Xke);let jee=class{constructor(e,t){this.blockPosition=e,this.dataPosition=t}toString(){return`${this.blockPosition}:${this.dataPosition}`}compareTo(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}static min(...e){let t,i=0;for(;!t;i+=1)t=e[i];for(;i<e.length;i+=1)t.compareTo(e[i])>0&&(t=e[i]);return t}};function z0(n,e=0,t=!1){if(t)throw new Error("big-endian virtual file offsets not implemented");return new jee(n[e+7]*1099511627776+n[e+6]*4294967296+n[e+5]*16777216+n[e+4]*65536+n[e+3]*256+n[e+2],n[e+1]<<8|n[e])}let _L=class{constructor(e,t,i,s=void 0){this.minv=e,this.maxv=t,this.bin=i,this._fetchedSize=s}toUniqueString(){return`${this.minv}..${this.maxv} (bin ${this.bin}, fetchedSize ${this.fetchedSize()})`}toString(){return this.toUniqueString()}compareTo(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}fetchedSize(){return this._fetchedSize!==void 0?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}},qee=class{constructor({filehandle:e,renameRefSeq:t=i=>i}){this.filehandle=e,this.renameRefSeq=t}_findFirstData(e,t){const i=e.firstDataLine;i?e.firstDataLine=i.compareTo(t)>0?t:i:e.firstDataLine=t}async parse(e={}){return this.setupP||(this.setupP=this._parse(e).catch(t=>{throw this.setupP=void 0,t})),this.setupP}async hasRefSeq(e,t={}){return!!((await this.parse(t)).indices[e]||{}).binIndex}};function Jke(n){return new Promise(e=>setTimeout(e,n))}function Gee(n){if(n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return n.toNumber()}function Kee(n){if(n&&n.aborted){if(typeof DOMException<"u")throw new DOMException("aborted","AbortError");{const e=new Error("aborted");throw e.code="ERR_ABORTED",e}}}async function Zee(n){await Promise.resolve(),Kee(n)}function eLe(n,e){return e.minv.blockPosition-n.maxv.blockPosition<65e3&&e.maxv.blockPosition-n.minv.blockPosition<5e6}function tLe(n={}){return"aborted"in n?{signal:n}:n}function Yee(n,e){const t=[];let i=null;return n.length===0?n:(n.sort((s,r)=>{const o=s.minv.blockPosition-r.minv.blockPosition;return o!==0?o:s.minv.dataPosition-r.minv.dataPosition}),n.forEach(s=>{(!e||s.maxv.compareTo(e)>0)&&(i===null?(t.push(s),i=s):eLe(i,s)?s.maxv.compareTo(i.maxv)>0&&(i.maxv=s.maxv):(t.push(s),i=s))}),t)}const iLe=21578050;function nLe(n,e){return n-n%e}function sLe(n,e){return n-n%e+e}class _1 extends qee{parsePseudoBin(e,t){return{lineCount:Gee(Uee.fromBytesLE(Array.prototype.slice.call(e,t+16,t+24),!0))}}async lineCount(e,t={}){const s=(await this.parse(t)).indices[e];if(!s)return-1;const r=s.stats||{};return r.lineCount===void 0?-1:r.lineCount}fetchBai(e={}){return this.baiP||(this.baiP=this.filehandle.readFile(e).catch(t=>{throw this.baiP=void 0,t})),this.baiP}async _parse(){const e={bai:!0,maxBlockSize:65536},t=await this.fetchBai();if(t.readUInt32LE(0)!==iLe)throw new Error("Not a BAI file");e.refCount=t.readInt32LE(4);const s=((1<<(5+1)*3)-1)/7;e.indices=new Array(e.refCount);let r=8;for(let o=0;o<e.refCount;o+=1){const a=t.readInt32LE(r);let l;r+=4;const c={};for(let d=0;d<a;d+=1){const f=t.readUInt32LE(r);if(r+=4,f===s+1)r+=4,l=this.parsePseudoBin(t,r),r+=32;else{if(f>s+1)throw new Error("bai index contains too many bins, please use CSI");{const g=t.readInt32LE(r);r+=4;const p=new Array(g);for(let m=0;m<g;m+=1){const b=z0(t,r),v=z0(t,r+8);r+=16,this._findFirstData(e,b),p[m]=new _L(b,v,f)}c[f]=p}}}const u=t.readInt32LE(r);r+=4;const h=new Array(u);for(let d=0;d<u;d+=1)h[d]=z0(t,r),r+=8,this._findFirstData(e,h[d]);e.indices[o]={binIndex:c,linearIndex:h,stats:l}}return e}async indexCov(e,t,i,s={}){const o=t!==void 0,l=(await this.parse(s)).indices[e];if(!l)return[];const{linearIndex:c=[],stats:u}=l;if(!c.length)return[];const h=i!==void 0?sLe(i,16384):(c.length-1)*16384,d=t!==void 0?nLe(t,16384):0;let f;o?f=new Array((h-d)/16384):f=new Array(c.length-1);const g=c[c.length-1].blockPosition;if(h>(c.length-1)*16384)throw new Error("query outside of range of linear index");let p=c[d/16384].blockPosition;for(let m=d/16384,b=0;m<h/16384;m++,b++)f[b]={score:c[m+1].blockPosition-p,start:m*16384,end:m*16384+16384},p=c[m+1].blockPosition;return f.map(m=>({...m,score:m.score*u.lineCount/g}))}reg2bins(e,t){return t-=1,[[0,0],[1+(e>>26),1+(t>>26)],[9+(e>>23),9+(t>>23)],[73+(e>>20),73+(t>>20)],[585+(e>>17),585+(t>>17)],[4681+(e>>14),4681+(t>>14)]]}async blocksForRange(e,t,i,s={}){t<0&&(t=0);const r=await this.parse(s);if(!r)return[];const o=r.indices[e];if(!o)return[];const a=this.reg2bins(t,i),l=[];for(const[f,g]of a)for(let p=f;p<=g;p++)if(o.binIndex[p]){const m=o.binIndex[p];for(let b=0;b<m.length;++b)l.push(new _L(m[b].minv,m[b].maxv,p))}const c=o.linearIndex.length;let u=null;const h=Math.min(t>>14,c-1),d=Math.min(i>>14,c-1);for(let f=h;f<=d;++f){const g=o.linearIndex[f];g&&(!u||g.compareTo(u)<0)&&(u=g)}return Yee(l,u)}}const rLe=21582659,oLe=38359875;function aLe(n,e){return n*2**e}function Z$(n,e){return Math.floor(n/2**e)}let XI=class extends qee{constructor(e){super(e),this.maxBinNumber=0,this.depth=0,this.minShift=0}async lineCount(e){const t=await this.parse();if(!t||!t.indices[e])return-1;const{stats:s}=t.indices[e];return s?s.lineCount:-1}async indexCov(){return[]}parseAuxData(e,t,i){if(i<30)return{};const s={};if(s.formatFlags=e.readInt32LE(t),s.coordinateType=s.formatFlags&65536?"zero-based-half-open":"1-based-closed",s.format={0:"generic",1:"SAM",2:"VCF"}[s.formatFlags&15],!s.format)throw new Error(`invalid Tabix preset format flags ${s.formatFlags}`);s.columnNumbers={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},s.metaValue=e.readInt32LE(t+16),s.metaChar=s.metaValue?String.fromCharCode(s.metaValue):"",s.skipLines=e.readInt32LE(t+20);const r=e.readInt32LE(t+24);return Object.assign(s,this._parseNameBytes(e.subarray(t+28,t+28+r))),s}_parseNameBytes(e){let t=0,i=0;const s=[],r={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),s[t]=a,r[a]=t}i=o+1,t+=1}return{refNameToId:r,refIdToName:s}}async _parse(e){const t={csi:!0,maxBlockSize:65536},i=await this.filehandle.readFile(e),s=await P_(i);if(s.readUInt32LE(0)===rLe)t.csiVersion=1;else if(s.readUInt32LE(0)===oLe)t.csiVersion=2;else throw new Error("Not a CSI file");this.minShift=s.readInt32LE(4),this.depth=s.readInt32LE(8),this.maxBinNumber=((1<<(this.depth+1)*3)-1)/7;const r=s.readInt32LE(12);r&&Object.assign(t,this.parseAuxData(s,16,r)),t.refCount=s.readInt32LE(16+r),t.indices=new Array(t.refCount);let o=16+r+4;for(let a=0;a<t.refCount;a+=1){await Zee(e.signal);const l=s.readInt32LE(o);o+=4;const c={};let u;for(let h=0;h<l;h+=1){const d=s.readUInt32LE(o);if(d>this.maxBinNumber)u=this.parsePseudoBin(s,o+4),o+=4+8+4+16+16;else{const f=z0(s,o+4);this._findFirstData(t,f);const g=s.readInt32LE(o+12);o+=16;const p=new Array(g);for(let m=0;m<g;m+=1){const b=z0(s,o),v=z0(s,o+8);o+=16,p[m]=new _L(b,v,d)}c[d]=p}}t.indices[a]={binIndex:c,stats:u}}return t}parsePseudoBin(e,t){return{lineCount:Gee(Uee.fromBytesLE(Array.prototype.slice.call(e,t+28,t+36),!0))}}async blocksForRange(e,t,i,s={}){t<0&&(t=0);const r=await this.parse(s),o=r==null?void 0:r.indices[e];if(!o)return[];const a=this.reg2bins(t,i),l=[];for(const[c,u]of a)for(let h=c;h<=u;h++)if(o.binIndex[h]){const d=o.binIndex[h];for(let f=0;f<d.length;++f)l.push(new _L(d[f].minv,d[f].maxv,h))}return Yee(l,new jee(0,0))}reg2bins(e,t){e-=1,e<1&&(e=1),t>2**50&&(t=2**34),t-=1;let i=0,s=0,r=this.minShift+this.depth*3;const o=[];for(;i<=this.depth;r-=3,s+=aLe(1,i*3),i+=1){const a=s+Z$(e,r),l=s+Z$(t,r);if(l-a+o.length>this.maxBinNumber)throw new Error(`query ${e}-${t} is too large for current binning scheme (shift ${this.minShift}, depth ${this.depth}), try a smaller query or a coarser index binning scheme`);o.push([a,l])}return o}};var Ah=zs.Buffer,k4=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(k4=new Int32Array(k4));function Xee(n){if(Ah.isBuffer(n))return n;var e=typeof Ah.alloc=="function"&&typeof Ah.from=="function";if(typeof n=="number")return e?Ah.alloc(n):new Ah(n);if(typeof n=="string")return e?Ah.from(n):new Ah(n);throw new Error("input must be buffer, number, or string, received "+typeof n)}function lLe(n){var e=Xee(4);return e.writeInt32BE(n,0),e}function W6(n,e){n=Xee(n),Ah.isBuffer(e)&&(e=e.readUInt32BE(0));for(var t=~~e^-1,i=0;i<n.length;i++)t=k4[(t^n[i])&255]^t>>>8;return t^-1}function V6(){return lLe(W6.apply(null,arguments))}V6.signed=function(){return W6.apply(null,arguments)};V6.unsigned=function(){return W6.apply(null,arguments)>>>0};var cLe=V6;const uLe=Up(cLe);var QI,Y$;function hLe(){if(Y$)return QI;Y$=1;var n=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},e=function(i,s){return Object.prototype.propertyIsEnumerable.call(i,s)};function t(i){if(i==null)throw new TypeError("Cannot convert undefined or null to object");var s=[];for(var r in i)n(i,r)&&e(i,r)&&s.push([r,i[r]]);return s}return QI=t,QI}var dLe=typeof Object.entries=="function"?Object.entries:hLe();const fLe=Up(dLe);class gLe{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return this._size+e}}var pLe=gLe;const mLe=Up(pLe),Jo={BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048},X$="=ACMGRSVTWYHKDBN".split(""),b1="MIDNSHP=X???????".split("");class _Le{constructor(e){this.data={},this._tagList=[],this._allTagsParsed=!1;const{bytes:t,fileOffset:i}=e,{byteArray:s,start:r}=t;this.data={},this.bytes=t,this._id=i,this._refID=s.readInt32LE(r+4),this.data.start=s.readInt32LE(r+8),this.flags=(s.readInt32LE(r+16)&4294901760)>>16}get(e){return this[e]?this.data[e]?this.data[e]:(this.data[e]=this[e](),this.data[e]):this._get(e.toLowerCase())}end(){return this.get("start")+this.get("length_on_ref")}seq_id(){return this._refID}_get(e){return e in this.data?this.data[e]:(this.data[e]=this._parseTag(e),this.data[e])}_tags(){this._parseAllTags();let e=["seq"];this.isSegmentUnmapped()||e.push("start","end","strand","score","qual","MQ","CIGAR","length_on_ref","template_length"),this.isPaired()&&e.push("next_segment_position","pair_orientation"),e=e.concat(this._tagList||[]),Object.keys(this.data).forEach(i=>{i[0]!=="_"&&i!=="next_seq_id"&&e.push(i)});const t={};return e.filter(i=>{if(i in this.data&&this.data[i]===void 0||i==="CG"||i==="cg")return!1;const s=i.toLowerCase(),r=t[s];return t[s]=!0,!r})}parent(){}children(){return this.get("subfeatures")}id(){return this._id}mq(){const e=(this.get("_bin_mq_nl")&65280)>>8;return e===255?void 0:e}score(){return this.get("mq")}qual(){var e;return(e=this.qualRaw())===null||e===void 0?void 0:e.join(" ")}qualRaw(){if(this.isSegmentUnmapped())return;const{start:e,byteArray:t}=this.bytes,i=e+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4+this.get("_seq_bytes"),s=this.get("seq_length");return t.subarray(i,i+s)}strand(){return this.isReverseComplemented()?-1:1}multi_segment_next_segment_strand(){if(!this.isMateUnmapped())return this.isMateReverseComplemented()?-1:1}name(){return this.get("_read_name")}_read_name(){const e=this.get("_l_read_name"),{byteArray:t,start:i}=this.bytes;return t.toString("ascii",i+36,i+36+e-1)}_parseTag(e){if(this._allTagsParsed)return;const{byteArray:t,start:i}=this.bytes;let s=this._tagOffset||i+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4+this.get("_seq_bytes")+this.get("seq_length");const r=this.bytes.end;let o;for(;s<r&&o!==e;){const a=String.fromCharCode(t[s],t[s+1]);o=a.toLowerCase();const l=String.fromCharCode(t[s+2]);s+=3;let c;switch(l){case"A":c=String.fromCharCode(t[s]),s+=1;break;case"i":c=t.readInt32LE(s),s+=4;break;case"I":c=t.readUInt32LE(s),s+=4;break;case"c":c=t.readInt8(s),s+=1;break;case"C":c=t.readUInt8(s),s+=1;break;case"s":c=t.readInt16LE(s),s+=2;break;case"S":c=t.readUInt16LE(s),s+=2;break;case"f":c=t.readFloatLE(s),s+=4;break;case"Z":case"H":for(c="";s<=r;){const u=t[s++];if(u===0)break;c+=String.fromCharCode(u)}break;case"B":{c="";const u=t[s++],h=String.fromCharCode(u),d=t.readInt32LE(s);if(s+=4,h==="i")if(a==="CG")for(let f=0;f<d;f++){const g=t.readInt32LE(s),p=g>>4,m=b1[g&15];c+=p+m,s+=4}else for(let f=0;f<d;f++)c+=t.readInt32LE(s),f+1<d&&(c+=","),s+=4;if(h==="I")if(a==="CG")for(let f=0;f<d;f++){const g=t.readUInt32LE(s),p=g>>4,m=b1[g&15];c+=p+m,s+=4}else for(let f=0;f<d;f++)c+=t.readUInt32LE(s),f+1<d&&(c+=","),s+=4;if(h==="s")for(let f=0;f<d;f++)c+=t.readInt16LE(s),f+1<d&&(c+=","),s+=2;if(h==="S")for(let f=0;f<d;f++)c+=t.readUInt16LE(s),f+1<d&&(c+=","),s+=2;if(h==="c")for(let f=0;f<d;f++)c+=t.readInt8(s),f+1<d&&(c+=","),s+=1;if(h==="C")for(let f=0;f<d;f++)c+=t.readUInt8(s),f+1<d&&(c+=","),s+=1;if(h==="f")for(let f=0;f<d;f++)c+=t.readFloatLE(s),f+1<d&&(c+=","),s+=4;break}default:console.warn(`Unknown BAM tag type '${l}', tags may be incomplete`),c=void 0,s=r}if(this._tagOffset=s,this._tagList.push(a),o===e)return c;this.data[o]=c}this._allTagsParsed=!0}_parseAllTags(){this._parseTag("")}_parseCigar(e){return e.match(/\d+\D/g).map(t=>[t.match(/\D/)[0].toUpperCase(),parseInt(t,10)])}isPaired(){return!!(this.flags&Jo.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&Jo.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&Jo.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&Jo.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&Jo.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&Jo.BAM_FMREVERSE)}isRead1(){return!!(this.flags&Jo.BAM_FREAD1)}isRead2(){return!!(this.flags&Jo.BAM_FREAD2)}isSecondary(){return!!(this.flags&Jo.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&Jo.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&Jo.BAM_FDUP)}isSupplementary(){return!!(this.flags&Jo.BAM_FSUPPLEMENTARY)}cigar(){if(this.isSegmentUnmapped())return;const{byteArray:e,start:t}=this.bytes,i=this.get("_n_cigar_op");let s=t+36+this.get("_l_read_name");const r=this.get("seq_length");let o="",a=0,l=e.readInt32LE(s),c=l>>4,u=b1[l&15];if(u==="S"&&c===r)return s+=4,l=e.readInt32LE(s),c=l>>4,u=b1[l&15],u!=="N"&&console.warn("CG tag with no N tag"),this.data.length_on_ref=c,this.get("CG");for(let h=0;h<i;++h)l=e.readInt32LE(s),c=l>>4,u=b1[l&15],o+=c+u,u!=="H"&&u!=="S"&&u!=="I"&&(a+=c),s+=4;return this.data.length_on_ref=a,o}_flags(){}length_on_ref(){return this.data.length_on_ref?this.data.length_on_ref:(this.get("cigar"),this.data.length_on_ref)}_n_cigar_op(){return this.get("_flag_nc")&65535}_l_read_name(){return this.get("_bin_mq_nl")&255}_seq_bytes(){return this.get("seq_length")+1>>1}getReadBases(){return this.seq()}seq(){const{byteArray:e,start:t}=this.bytes,i=t+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4,s=this.get("_seq_bytes"),r=this.get("seq_length");let o="",a=0;for(let l=0;l<s;++l){const c=e[i+l];o+=X$[(c&240)>>4],a++,a<r&&(o+=X$[c&15],a++)}return o}getPairOrientation(){if(!this.isSegmentUnmapped()&&!this.isMateUnmapped()&&this._refID===this._next_refid()){const e=this.isReverseComplemented()?"R":"F",t=this.isMateReverseComplemented()?"R":"F";let i=" ",s=" ";this.isRead1()?(i="1",s="2"):this.isRead2()&&(i="2",s="1");const r=[];return this.template_length()>0?(r[0]=e,r[1]=i,r[2]=t,r[3]=s):(r[2]=e,r[3]=i,r[0]=t,r[1]=s),r.join("")}return null}_bin_mq_nl(){return this.bytes.byteArray.readInt32LE(this.bytes.start+12)}_flag_nc(){return this.bytes.byteArray.readInt32LE(this.bytes.start+16)}seq_length(){return this.bytes.byteArray.readInt32LE(this.bytes.start+20)}_next_refid(){return this.bytes.byteArray.readInt32LE(this.bytes.start+24)}_next_pos(){return this.bytes.byteArray.readInt32LE(this.bytes.start+28)}template_length(){return this.bytes.byteArray.readInt32LE(this.bytes.start+32)}toJSON(){const e={};return Object.keys(this).forEach(t=>{t.charAt(0)==="_"||t==="bytes"||(e[t]=this[t])}),e}}function bLe(n){const e=n.split(/\r?\n/),t=[];return e.forEach(i=>{const[s,...r]=i.split(/\t/),o=r.map(a=>{const[l,c]=a.split(":",2);return{tag:l,value:c}});s&&t.push({tag:s.substr(1),data:o})}),t}const vLe=21840194,JI=65536;function eN(n){return[].concat(...n)}async function wLe(n){const e=[];for await(const t of n)e.push(t);return e}class yLe{constructor({bamFilehandle:e,bamPath:t,bamUrl:i,baiPath:s,baiFilehandle:r,baiUrl:o,csiPath:a,csiFilehandle:l,csiUrl:c,fetchSizeLimit:u,chunkSizeLimit:h,yieldThreadTime:d=100,renameRefSeqs:f=g=>g}){if(this.featureCache=new iT({cache:new mLe({maxSize:50}),fill:async({chunk:g,opts:p},m)=>{const{data:b,cpositions:v,dpositions:w}=await this._readChunk({chunk:g,opts:{...p,signal:m}});return await this.readBamFeatures(b,v,w,g)}}),this.renameRefSeq=f,e)this.bam=e;else if(t)this.bam=new No(t);else if(i)this.bam=new fc(i);else throw new Error("unable to initialize bam");if(l)this.index=new XI({filehandle:l});else if(a)this.index=new XI({filehandle:new No(a)});else if(c)this.index=new XI({filehandle:new fc(c)});else if(r)this.index=new _1({filehandle:r});else if(s)this.index=new _1({filehandle:new No(s)});else if(o)this.index=new _1({filehandle:new fc(o)});else if(t)this.index=new _1({filehandle:new No(`${t}.bai`)});else if(i)this.index=new _1({filehandle:new fc(`${i}.bai`)});else throw new Error("unable to infer index format");this.fetchSizeLimit=u||5e8,this.chunkSizeLimit=h||3e8,this.yieldThreadTime=d}async getHeader(e={}){const t=tLe(e),i=await this.index.parse(t),s=i.firstDataLine?i.firstDataLine.blockPosition+65535:void 0;let r;if(s){const u=await this.bam.read(Buffer.alloc(s+JI),0,s+JI,0,t),{bytesRead:h}=u;if({buffer:r}=u,!h)throw new Error("Error reading header");h<s?r=r.subarray(0,h):r=r.subarray(0,s)}else r=await this.bam.readFile(t);const o=await P_(r);if(o.readInt32LE(0)!==vLe)throw new Error("Not a BAM file");const a=o.readInt32LE(4);this.header=o.toString("utf8",8,8+a);const{chrToIndex:l,indexToChr:c}=await this._readRefSeqs(a+8,65535,t);return this.chrToIndex=l,this.indexToChr=c,bLe(this.header)}async getHeaderText(e={}){return await this.getHeader(e),this.header}async _readRefSeqs(e,t,i={}){if(e>t)return this._readRefSeqs(e,t*2,i);const s=t+JI,{bytesRead:r,buffer:o}=await this.bam.read(Buffer.alloc(s),0,t,0,i);if(!r)throw new Error("Error reading refseqs from header");const a=await P_(o.subarray(0,Math.min(r,t))),l=a.readInt32LE(e);let c=e+4;const u={},h=[];for(let d=0;d<l;d+=1){const f=a.readInt32LE(c),g=this.renameRefSeq(a.toString("utf8",c+4,c+4+f-1)),p=a.readInt32LE(c+f+4);if(u[g]=d,h.push({refName:g,length:p}),c=c+8+f,c>a.length)return console.warn(`BAM header is very big.  Re-fetching ${t} bytes.`),this._readRefSeqs(e,t*2,i)}return{chrToIndex:u,indexToChr:h}}async getRecordsForRange(e,t,i,s={viewAsPairs:!1,pairAcrossChr:!1,maxInsertSize:2e5}){return eN(await wLe(this.streamRecordsForRange(e,t,i,s)))}async*streamRecordsForRange(e,t,i,s={}){const{signal:r}=s,o=this.chrToIndex&&this.chrToIndex[e];let a;if(!(o>=0))a=[];else if(a=await this.index.blocksForRange(o,t-1,i,s),!a)throw new Error("Error in index fetch");for(let c=0;c<a.length;c+=1){await Zee(r);const u=a[c].fetchedSize();if(u>this.chunkSizeLimit)throw new Error(`Too many BAM features. BAM chunk size ${u} bytes exceeds chunkSizeLimit of ${this.chunkSizeLimit}`)}const l=a.map(c=>c.fetchedSize()).reduce((c,u)=>c+u,0);if(l>this.fetchSizeLimit)throw new Error(`data size of ${l.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);yield*this._fetchChunkFeatures(a,o,t,i,s)}async*_fetchChunkFeatures(e,t,i,s,r){const{viewAsPairs:o=!1}=r,a=[];let l=!1;for(let c=0;c<e.length;c++){const u=e[c],h=await this.featureCache.get(u.toString(),{chunk:u,opts:r},r.signal),d=[];for(let f=0;f<h.length;f+=1){const g=h[f];if(g.seq_id()===t)if(g.get("start")>=s){l=!0;break}else g.get("end")>=i&&d.push(g)}if(a.push(d),yield d,l)break}Kee(r.signal),o&&(yield this.fetchPairs(t,a,r))}async fetchPairs(e,t,i){const{pairAcrossChr:s=!1,maxInsertSize:r=2e5}=i,o={},a={};t.map(d=>{const f={};for(let g=0;g<d.length;g++){const p=d[g].name(),m=d[g].id();f[p]||(f[p]=0),f[p]++,a[m]=1}fLe(f).forEach(([g,p])=>{p===1&&(o[g]=!0)})});const l=[];t.map(d=>{for(let f=0;f<d.length;f++){const g=d[f],p=g.name(),m=g.get("start"),b=g._next_pos(),v=g._next_refid();o[p]&&(s||v===e&&Math.abs(m-b)<r)&&l.push(this.index.blocksForRange(v,b,b+1,i))}});const c=eN(await Promise.all(l)).sort().filter((d,f,g)=>!f||d.toString()!==g[f-1].toString()),u=c.map(d=>d.fetchedSize()).reduce((d,f)=>d+f,0);if(u>this.fetchSizeLimit)throw new Error(`data size of ${u.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);const h=c.map(async d=>{const{data:f,cpositions:g,dpositions:p,chunk:m}=await this._readChunk({chunk:d,opts:i}),b=await this.readBamFeatures(f,g,p,m),v=[];for(let w=0;w<b.length;w+=1){const y=b[w];o[y.get("name")]&&!a[y.id()]&&v.push(y)}return v});return eN(await Promise.all(h))}async _readChunk({chunk:e,opts:t}){const i=e.fetchedSize(),{buffer:s,bytesRead:r}=await this.bam.read(Buffer.alloc(i),0,i,e.minv.blockPosition,t),{buffer:o,cpositions:a,dpositions:l}=await SJ(s.subarray(0,Math.min(r,i)),e);return{data:o,cpositions:a,dpositions:l,chunk:e}}async readBamFeatures(e,t,i,s){let r=0;const o=[];let a=0,l=+Date.now();for(;r+4<e.length;){const c=e.readInt32LE(r),u=r+4+c-1;if(i){for(;r+s.minv.dataPosition>=i[a++];);a--}if(u<e.length){const h=new _Le({bytes:{byteArray:e,start:r,end:u},fileOffset:t?t[a]*256+(r-i[a])+s.minv.dataPosition+1:uLe.signed(e.slice(r,u))});o.push(h),this.yieldThreadTime&&+Date.now()-l>this.yieldThreadTime&&(await Jke(1),l=+Date.now())}r=u+1}return o}async hasRefSeq(e){const t=this.chrToIndex&&this.chrToIndex[e];return this.index.hasRefSeq(t)}async lineCount(e){const t=this.chrToIndex&&this.chrToIndex[e];return this.index.lineCount(t)}async indexCov(e,t,i){await this.index.parse();const s=this.chrToIndex&&this.chrToIndex[e];return this.index.indexCov(s,t,i)}async blocksForRange(e,t,i,s){await this.index.parse();const r=this.chrToIndex&&this.chrToIndex[e];return this.index.blocksForRange(r,t,i,s)}}(function(){(function(n){(function(e){var t={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function i(k){return k&&DataView.prototype.isPrototypeOf(k)}if(t.arrayBuffer)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(k){return k&&s.indexOf(Object.prototype.toString.call(k))>-1};function o(k){if(typeof k!="string"&&(k=String(k)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(k))throw new TypeError("Invalid character in header field name");return k.toLowerCase()}function a(k){return typeof k!="string"&&(k=String(k)),k}function l(k){var I={next:function(){var N=k.shift();return{done:N===void 0,value:N}}};return t.iterable&&(I[Symbol.iterator]=function(){return I}),I}function c(k){this.map={},k instanceof c?k.forEach(function(I,N){this.append(N,I)},this):Array.isArray(k)?k.forEach(function(I){this.append(I[0],I[1])},this):k&&Object.getOwnPropertyNames(k).forEach(function(I){this.append(I,k[I])},this)}c.prototype.append=function(k,I){k=o(k),I=a(I);var N=this.map[k];this.map[k]=N?N+", "+I:I},c.prototype.delete=function(k){delete this.map[o(k)]},c.prototype.get=function(k){return k=o(k),this.has(k)?this.map[k]:null},c.prototype.has=function(k){return this.map.hasOwnProperty(o(k))},c.prototype.set=function(k,I){this.map[o(k)]=a(I)},c.prototype.forEach=function(k,I){for(var N in this.map)this.map.hasOwnProperty(N)&&k.call(I,this.map[N],N,this)},c.prototype.keys=function(){var k=[];return this.forEach(function(I,N){k.push(N)}),l(k)},c.prototype.values=function(){var k=[];return this.forEach(function(I){k.push(I)}),l(k)},c.prototype.entries=function(){var k=[];return this.forEach(function(I,N){k.push([N,I])}),l(k)},t.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function u(k){if(k.bodyUsed)return Promise.reject(new TypeError("Already read"));k.bodyUsed=!0}function h(k){return new Promise(function(I,N){k.onload=function(){I(k.result)},k.onerror=function(){N(k.error)}})}function d(k){var I=new FileReader,N=h(I);return I.readAsArrayBuffer(k),N}function f(k){var I=new FileReader,N=h(I);return I.readAsText(k),N}function g(k){for(var I=new Uint8Array(k),N=new Array(I.length),z=0;z<I.length;z++)N[z]=String.fromCharCode(I[z]);return N.join("")}function p(k){if(k.slice)return k.slice(0);var I=new Uint8Array(k.byteLength);return I.set(new Uint8Array(k)),I.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(k){this._bodyInit=k,k?typeof k=="string"?this._bodyText=k:t.blob&&Blob.prototype.isPrototypeOf(k)?this._bodyBlob=k:t.formData&&FormData.prototype.isPrototypeOf(k)?this._bodyFormData=k:t.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)?this._bodyText=k.toString():t.arrayBuffer&&t.blob&&i(k)?(this._bodyArrayBuffer=p(k.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):t.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(k)||r(k))?this._bodyArrayBuffer=p(k):this._bodyText=k=Object.prototype.toString.call(k):this._bodyText="",this.headers.get("content-type")||(typeof k=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var k=u(this);if(k)return k;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var k=u(this);if(k)return k;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(k){var I=k.toUpperCase();return b.indexOf(I)>-1?I:k}function w(k,I){I=I||{};var N=I.body;if(k instanceof w){if(k.bodyUsed)throw new TypeError("Already read");this.url=k.url,this.credentials=k.credentials,I.headers||(this.headers=new c(k.headers)),this.method=k.method,this.mode=k.mode,this.signal=k.signal,!N&&k._bodyInit!=null&&(N=k._bodyInit,k.bodyUsed=!0)}else this.url=String(k);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new c(I.headers)),this.method=v(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(N)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function y(k){var I=new FormData;return k.trim().split("&").forEach(function(N){if(N){var z=N.split("="),$=z.shift().replace(/\+/g," "),q=z.join("=").replace(/\+/g," ");I.append(decodeURIComponent($),decodeURIComponent(q))}}),I}function x(k){var I=new c,N=k.replace(/\r?\n[\t ]+/g," ");return N.split(/\r?\n/).forEach(function(z){var $=z.split(":"),q=$.shift().trim();if(q){var ne=$.join(":").trim();I.append(q,ne)}}),I}m.call(w.prototype);function D(k,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new c(I.headers),this.url=I.url||"",this._initBody(k)}m.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},D.error=function(){var k=new D(null,{status:0,statusText:""});return k.type="error",k};var S=[301,302,303,307,308];D.redirect=function(k,I){if(S.indexOf(I)===-1)throw new RangeError("Invalid status code");return new D(null,{status:I,headers:{location:k}})},e.DOMException=n.DOMException;try{new e.DOMException}catch{e.DOMException=function(I,N){this.message=I,this.name=N;var z=Error(I);this.stack=z.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function T(k,I){return new Promise(function(N,z){var $=new w(k,I);if($.signal&&$.signal.aborted)return z(new e.DOMException("Aborted","AbortError"));var q=new XMLHttpRequest;function ne(){q.abort()}q.onload=function(){var de={status:q.status,statusText:q.statusText,headers:x(q.getAllResponseHeaders()||"")};de.url="responseURL"in q?q.responseURL:de.headers.get("X-Request-URL");var me="response"in q?q.response:q.responseText;N(new D(me,de))},q.onerror=function(){z(new TypeError("Network request failed"))},q.ontimeout=function(){z(new TypeError("Network request failed"))},q.onabort=function(){z(new e.DOMException("Aborted","AbortError"))},q.open($.method,$.url,!0),$.credentials==="include"?q.withCredentials=!0:$.credentials==="omit"&&(q.withCredentials=!1),"responseType"in q&&t.blob&&(q.responseType="blob"),$.headers.forEach(function(de,me){q.setRequestHeader(me,de)}),$.signal&&($.signal.addEventListener("abort",ne),q.onreadystatechange=function(){q.readyState===4&&$.signal.removeEventListener("abort",ne)}),q.send(typeof $._bodyInit>"u"?null:$._bodyInit)})}return T.polyfill=!0,n.fetch||(n.fetch=T,n.Headers=c,n.Request=w,n.Response=D),e.Headers=c,e.Request=w,e.Response=D,e.fetch=T,Object.defineProperty(e,"__esModule",{value:!0}),e})({})})(typeof self<"u"?self:$w)})();class CLe extends JC(Hp){constructor(t,i){const s={channel:"x",windowSize:2e4,...t};super(i,s.channel);Rn(this,"lastRequestId",0);Rn(this,"chrPrefixFixer",t=>t);if(this.params=s,!this.params.url)throw new Error("No URL provided for BamSource");const r=o=>new fc(eS(o,this.view.getBaseUrl()));this.bam=new yLe({bamFilehandle:r(this.params.url),baiFilehandle:r(this.params.indexUrl??this.params.url+".bai")}),this.headerPromise=this.bam.getHeader(),this.headerPromise.then(o=>{var c,u;const a=this.genome.hasChrPrefix(),l=(u=(c=this.bam.indexToChr)==null?void 0:c[0])==null?void 0:u.refName.startsWith("chr");a&&!l?this.chrPrefixFixer=h=>h.replace("chr",""):!a&&l&&(this.chrPrefixFixer=h=>"chr"+h)})}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;await this.headerPromise;const s=this.quantizeInterval(t,i);if(this.checkAndUpdateLastInterval(s)){const r=this.genome.continuousToDiscreteChromosomeIntervals(s),o=await Promise.all(r.map(a=>this.bam.getRecordsForRange(this.chrPrefixFixer(a.chrom),a.startPos,a.endPos).then(l=>l.map(c=>({chrom:a.chrom,start:c.get("start"),end:c.get("end"),name:c.get("name"),MD:c.get("MD"),cigar:c.get("cigar"),mapq:c.get("mq"),strand:c.get("strand")===1?"+":"-"})))));this.publishData(o.flat())}}}var $6={exports:{}},H0=typeof Reflect=="object"?Reflect:null,Q$=H0&&typeof H0.apply=="function"?H0.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},$2;H0&&typeof H0.ownKeys=="function"?$2=H0.ownKeys:Object.getOwnPropertySymbols?$2=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:$2=function(e){return Object.getOwnPropertyNames(e)};function SLe(n){console&&console.warn&&console.warn(n)}var Qee=Number.isNaN||function(e){return e!==e};function Pi(){Pi.init.call(this)}$6.exports=Pi;$6.exports.once=DLe;Pi.EventEmitter=Pi;Pi.prototype._events=void 0;Pi.prototype._eventsCount=0;Pi.prototype._maxListeners=void 0;var J$=10;function oT(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Pi,"defaultMaxListeners",{enumerable:!0,get:function(){return J$},set:function(n){if(typeof n!="number"||n<0||Qee(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");J$=n}});Pi.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Pi.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Qee(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Jee(n){return n._maxListeners===void 0?Pi.defaultMaxListeners:n._maxListeners}Pi.prototype.getMaxListeners=function(){return Jee(this)};Pi.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var s=e==="error",r=this._events;if(r!==void 0)s=s&&r.error===void 0;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=r[e];if(l===void 0)return!1;if(typeof l=="function")Q$(l,this,t);else for(var c=l.length,u=ste(l,c),i=0;i<c;++i)Q$(u[i],this,t);return!0};function ete(n,e,t,i){var s,r,o;if(oT(t),r=n._events,r===void 0?(r=n._events=Object.create(null),n._eventsCount=0):(r.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),r=n._events),o=r[e]),o===void 0)o=r[e]=t,++n._eventsCount;else if(typeof o=="function"?o=r[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),s=Jee(n),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,SLe(a)}return n}Pi.prototype.addListener=function(e,t){return ete(this,e,t,!1)};Pi.prototype.on=Pi.prototype.addListener;Pi.prototype.prependListener=function(e,t){return ete(this,e,t,!0)};function xLe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function tte(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},s=xLe.bind(i);return s.listener=t,i.wrapFn=s,s}Pi.prototype.once=function(e,t){return oT(t),this.on(e,tte(this,e,t)),this};Pi.prototype.prependOnceListener=function(e,t){return oT(t),this.prependListener(e,tte(this,e,t)),this};Pi.prototype.removeListener=function(e,t){var i,s,r,o,a;if(oT(t),s=this._events,s===void 0)return this;if(i=s[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,r=o;break}if(r<0)return this;r===0?i.shift():kLe(i,r),i.length===1&&(s[e]=i[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Pi.prototype.off=Pi.prototype.removeListener;Pi.prototype.removeAllListeners=function(e){var t,i,s;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var r=Object.keys(i),o;for(s=0;s<r.length;++s)o=r[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function ite(n,e,t){var i=n._events;if(i===void 0)return[];var s=i[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?LLe(s):ste(s,s.length)}Pi.prototype.listeners=function(e){return ite(this,e,!0)};Pi.prototype.rawListeners=function(e){return ite(this,e,!1)};Pi.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):nte.call(n,e)};Pi.prototype.listenerCount=nte;function nte(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Pi.prototype.eventNames=function(){return this._eventsCount>0?$2(this._events):[]};function ste(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function kLe(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function LLe(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function DLe(n,e){return new Promise(function(t,i){function s(o){n.removeListener(e,r),i(o)}function r(){typeof n.removeListener=="function"&&n.removeListener("error",s),t([].slice.call(arguments))}rte(n,e,r,{once:!0}),e!=="error"&&ELe(n,s,{once:!0})})}function ELe(n,e,t){typeof n.on=="function"&&rte(n,"error",e,t)}function rte(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function s(r){i.once&&n.removeEventListener(e,s),t(r)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var z6=$6.exports,L4={exports:{}};typeof Object.create=="function"?L4.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:L4.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var $b=L4.exports,tN,ez;function ote(){return ez||(ez=1,tN=z6.EventEmitter),tN}const ate=Nwe($we);var iN,tz;function TLe(){if(tz)return iN;tz=1;function n(d,f){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(d);f&&(p=p.filter(function(m){return Object.getOwnPropertyDescriptor(d,m).enumerable})),g.push.apply(g,p)}return g}function e(d){for(var f=1;f<arguments.length;f++){var g=arguments[f]!=null?arguments[f]:{};f%2?n(Object(g),!0).forEach(function(p){t(d,p,g[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):n(Object(g)).forEach(function(p){Object.defineProperty(d,p,Object.getOwnPropertyDescriptor(g,p))})}return d}function t(d,f,g){return f in d?Object.defineProperty(d,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):d[f]=g,d}function i(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function s(d,f){for(var g=0;g<f.length;g++){var p=f[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}function r(d,f,g){return f&&s(d.prototype,f),g&&s(d,g),d}var o=zs,a=o.Buffer,l=ate,c=l.inspect,u=c&&c.custom||"inspect";function h(d,f,g){a.prototype.copy.call(d,f,g)}return iN=function(){function d(){i(this,d),this.head=null,this.tail=null,this.length=0}return r(d,[{key:"push",value:function(g){var p={data:g,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length}},{key:"unshift",value:function(g){var p={data:g,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var p=this.head,m=""+p.data;p=p.next;)m+=g+p.data;return m}},{key:"concat",value:function(g){if(this.length===0)return a.alloc(0);for(var p=a.allocUnsafe(g>>>0),m=this.head,b=0;m;)h(m.data,p,b),b+=m.data.length,m=m.next;return p}},{key:"consume",value:function(g,p){var m;return g<this.head.data.length?(m=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):g===this.head.data.length?m=this.shift():m=p?this._getString(g):this._getBuffer(g),m}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var p=this.head,m=1,b=p.data;for(g-=b.length;p=p.next;){var v=p.data,w=g>v.length?v.length:g;if(w===v.length?b+=v:b+=v.slice(0,g),g-=w,g===0){w===v.length?(++m,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p,p.data=v.slice(w));break}++m}return this.length-=m,b}},{key:"_getBuffer",value:function(g){var p=a.allocUnsafe(g),m=this.head,b=1;for(m.data.copy(p),g-=m.data.length;m=m.next;){var v=m.data,w=g>v.length?v.length:g;if(v.copy(p,p.length-g,0,w),g-=w,g===0){w===v.length?(++b,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=v.slice(w));break}++b}return this.length-=b,p}},{key:u,value:function(g,p){return c(this,e({},p,{depth:0,customInspect:!1}))}}]),d}(),iN}var nN,iz;function lte(){if(iz)return nN;iz=1;function n(o,a){var l=this,c=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return c||u?(a?a(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(s,this,o)):process.nextTick(s,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(h){!a&&h?l._writableState?l._writableState.errorEmitted?process.nextTick(t,l):(l._writableState.errorEmitted=!0,process.nextTick(e,l,h)):process.nextTick(e,l,h):a?(process.nextTick(t,l),a(h)):process.nextTick(t,l)}),this)}function e(o,a){s(o,a),t(o)}function t(o){o._writableState&&!o._writableState.emitClose||o._readableState&&!o._readableState.emitClose||o.emit("close")}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(o,a){o.emit("error",a)}function r(o,a){var l=o._readableState,c=o._writableState;l&&l.autoDestroy||c&&c.autoDestroy?o.destroy(a):o.emit("error",a)}return nN={destroy:n,undestroy:i,errorOrDestroy:r},nN}var sN={},nz;function zb(){if(nz)return sN;nz=1;function n(a,l){a.prototype=Object.create(l.prototype),a.prototype.constructor=a,a.__proto__=l}var e={};function t(a,l,c){c||(c=Error);function u(d,f,g){return typeof l=="string"?l:l(d,f,g)}var h=function(d){n(f,d);function f(g,p,m){return d.call(this,u(g,p,m))||this}return f}(c);h.prototype.name=c.name,h.prototype.code=a,e[a]=h}function i(a,l){if(Array.isArray(a)){var c=a.length;return a=a.map(function(u){return String(u)}),c>2?"one of ".concat(l," ").concat(a.slice(0,c-1).join(", "),", or ")+a[c-1]:c===2?"one of ".concat(l," ").concat(a[0]," or ").concat(a[1]):"of ".concat(l," ").concat(a[0])}else return"of ".concat(l," ").concat(String(a))}function s(a,l,c){return a.substr(!c||c<0?0:+c,l.length)===l}function r(a,l,c){return(c===void 0||c>a.length)&&(c=a.length),a.substring(c-l.length,c)===l}function o(a,l,c){return typeof c!="number"&&(c=0),c+l.length>a.length?!1:a.indexOf(l,c)!==-1}return t("ERR_INVALID_OPT_VALUE",function(a,l){return'The value "'+l+'" is invalid for option "'+a+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(a,l,c){var u;typeof l=="string"&&s(l,"not ")?(u="must not be",l=l.replace(/^not /,"")):u="must be";var h;if(r(a," argument"))h="The ".concat(a," ").concat(u," ").concat(i(l,"type"));else{var d=o(a,".")?"property":"argument";h='The "'.concat(a,'" ').concat(d," ").concat(u," ").concat(i(l,"type"))}return h+=". Received type ".concat(typeof c),h},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),sN.codes=e,sN}var rN,sz;function cte(){if(sz)return rN;sz=1;var n=zb().codes.ERR_INVALID_OPT_VALUE;function e(i,s,r){return i.highWaterMark!=null?i.highWaterMark:s?i[r]:null}function t(i,s,r,o){var a=e(s,o,r);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var l=o?r:"highWaterMark";throw new n(l,a)}return Math.floor(a)}return i.objectMode?16:16*1024}return rN={getHighWaterMark:t},rN}var oN,rz;function ALe(){if(rz)return oN;rz=1,oN=n;function n(t,i){if(e("noDeprecation"))return t;var s=!1;function r(){if(!s){if(e("throwDeprecation"))throw new Error(i);e("traceDeprecation")?console.trace(i):console.warn(i),s=!0}return t.apply(this,arguments)}return r}function e(t){try{if(!globalThis.localStorage)return!1}catch{return!1}var i=globalThis.localStorage[t];return i==null?!1:String(i).toLowerCase()==="true"}return oN}var aN,oz;function ute(){if(oz)return aN;oz=1,aN=T;function n(re){var te=this;this.next=null,this.entry=null,this.finish=function(){mi(te,re)}}var e;T.WritableState=D;var t={deprecate:ALe()},i=ote(),s=zs.Buffer,r=globalThis.Uint8Array||function(){};function o(re){return s.from(re)}function a(re){return s.isBuffer(re)||re instanceof r}var l=lte(),c=cte(),u=c.getHighWaterMark,h=zb().codes,d=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,p=h.ERR_STREAM_CANNOT_PIPE,m=h.ERR_STREAM_DESTROYED,b=h.ERR_STREAM_NULL_VALUES,v=h.ERR_STREAM_WRITE_AFTER_END,w=h.ERR_UNKNOWN_ENCODING,y=l.errorOrDestroy;$b(T,i);function x(){}function D(re,te,ye){e=e||U_(),re=re||{},typeof ye!="boolean"&&(ye=te instanceof e),this.objectMode=!!re.objectMode,ye&&(this.objectMode=this.objectMode||!!re.writableObjectMode),this.highWaterMark=u(this,re,"writableHighWaterMark",ye),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var _e=re.decodeStrings===!1;this.decodeStrings=!_e,this.defaultEncoding=re.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Ie){de(te,Ie)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=re.emitClose!==!1,this.autoDestroy=!!re.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}D.prototype.getBuffer=function(){for(var te=this.bufferedRequest,ye=[];te;)ye.push(te),te=te.next;return ye},function(){try{Object.defineProperty(D.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var S;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(S=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(te){return S.call(this,te)?!0:this!==T?!1:te&&te._writableState instanceof D}})):S=function(te){return te instanceof this};function T(re){e=e||U_();var te=this instanceof e;if(!te&&!S.call(T,this))return new T(re);this._writableState=new D(re,this,te),this.writable=!0,re&&(typeof re.write=="function"&&(this._write=re.write),typeof re.writev=="function"&&(this._writev=re.writev),typeof re.destroy=="function"&&(this._destroy=re.destroy),typeof re.final=="function"&&(this._final=re.final)),i.call(this)}T.prototype.pipe=function(){y(this,new p)};function k(re,te){var ye=new v;y(re,ye),process.nextTick(te,ye)}function I(re,te,ye,_e){var Ie;return ye===null?Ie=new b:typeof ye!="string"&&!te.objectMode&&(Ie=new d("chunk",["string","Buffer"],ye)),Ie?(y(re,Ie),process.nextTick(_e,Ie),!1):!0}T.prototype.write=function(re,te,ye){var _e=this._writableState,Ie=!1,F=!_e.objectMode&&a(re);return F&&!s.isBuffer(re)&&(re=o(re)),typeof te=="function"&&(ye=te,te=null),F?te="buffer":te||(te=_e.defaultEncoding),typeof ye!="function"&&(ye=x),_e.ending?k(this,ye):(F||I(this,_e,re,ye))&&(_e.pendingcb++,Ie=z(this,_e,F,re,te,ye)),Ie},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var re=this._writableState;re.corked&&(re.corked--,!re.writing&&!re.corked&&!re.bufferProcessing&&re.bufferedRequest&&ve(this,re))},T.prototype.setDefaultEncoding=function(te){if(typeof te=="string"&&(te=te.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((te+"").toLowerCase())>-1))throw new w(te);return this._writableState.defaultEncoding=te,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function N(re,te,ye){return!re.objectMode&&re.decodeStrings!==!1&&typeof te=="string"&&(te=s.from(te,ye)),te}Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function z(re,te,ye,_e,Ie,F){if(!ye){var M=N(te,_e,Ie);_e!==M&&(ye=!0,Ie="buffer",_e=M)}var pe=te.objectMode?1:_e.length;te.length+=pe;var ke=te.length<te.highWaterMark;if(ke||(te.needDrain=!0),te.writing||te.corked){var et=te.lastBufferedRequest;te.lastBufferedRequest={chunk:_e,encoding:Ie,isBuf:ye,callback:F,next:null},et?et.next=te.lastBufferedRequest:te.bufferedRequest=te.lastBufferedRequest,te.bufferedRequestCount+=1}else $(re,te,!1,pe,_e,Ie,F);return ke}function $(re,te,ye,_e,Ie,F,M){te.writelen=_e,te.writecb=M,te.writing=!0,te.sync=!0,te.destroyed?te.onwrite(new m("write")):ye?re._writev(Ie,te.onwrite):re._write(Ie,F,te.onwrite),te.sync=!1}function q(re,te,ye,_e,Ie){--te.pendingcb,ye?(process.nextTick(Ie,_e),process.nextTick(fe,re,te),re._writableState.errorEmitted=!0,y(re,_e)):(Ie(_e),re._writableState.errorEmitted=!0,y(re,_e),fe(re,te))}function ne(re){re.writing=!1,re.writecb=null,re.length-=re.writelen,re.writelen=0}function de(re,te){var ye=re._writableState,_e=ye.sync,Ie=ye.writecb;if(typeof Ie!="function")throw new g;if(ne(ye),te)q(re,ye,_e,te,Ie);else{var F=$e(ye)||re.destroyed;!F&&!ye.corked&&!ye.bufferProcessing&&ye.bufferedRequest&&ve(re,ye),_e?process.nextTick(me,re,ye,F,Ie):me(re,ye,F,Ie)}}function me(re,te,ye,_e){ye||De(re,te),te.pendingcb--,_e(),fe(re,te)}function De(re,te){te.length===0&&te.needDrain&&(te.needDrain=!1,re.emit("drain"))}function ve(re,te){te.bufferProcessing=!0;var ye=te.bufferedRequest;if(re._writev&&ye&&ye.next){var _e=te.bufferedRequestCount,Ie=new Array(_e),F=te.corkedRequestsFree;F.entry=ye;for(var M=0,pe=!0;ye;)Ie[M]=ye,ye.isBuf||(pe=!1),ye=ye.next,M+=1;Ie.allBuffers=pe,$(re,te,!0,te.length,Ie,"",F.finish),te.pendingcb++,te.lastBufferedRequest=null,F.next?(te.corkedRequestsFree=F.next,F.next=null):te.corkedRequestsFree=new n(te),te.bufferedRequestCount=0}else{for(;ye;){var ke=ye.chunk,et=ye.encoding,Xe=ye.callback,Nt=te.objectMode?1:ke.length;if($(re,te,!1,Nt,ke,et,Xe),ye=ye.next,te.bufferedRequestCount--,te.writing)break}ye===null&&(te.lastBufferedRequest=null)}te.bufferedRequest=ye,te.bufferProcessing=!1}T.prototype._write=function(re,te,ye){ye(new f("_write()"))},T.prototype._writev=null,T.prototype.end=function(re,te,ye){var _e=this._writableState;return typeof re=="function"?(ye=re,re=null,te=null):typeof te=="function"&&(ye=te,te=null),re!=null&&this.write(re,te),_e.corked&&(_e.corked=1,this.uncork()),_e.ending||jt(this,_e,ye),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function $e(re){return re.ending&&re.length===0&&re.bufferedRequest===null&&!re.finished&&!re.writing}function Ne(re,te){re._final(function(ye){te.pendingcb--,ye&&y(re,ye),te.prefinished=!0,re.emit("prefinish"),fe(re,te)})}function xe(re,te){!te.prefinished&&!te.finalCalled&&(typeof re._final=="function"&&!te.destroyed?(te.pendingcb++,te.finalCalled=!0,process.nextTick(Ne,re,te)):(te.prefinished=!0,re.emit("prefinish")))}function fe(re,te){var ye=$e(te);if(ye&&(xe(re,te),te.pendingcb===0&&(te.finished=!0,re.emit("finish"),te.autoDestroy))){var _e=re._readableState;(!_e||_e.autoDestroy&&_e.endEmitted)&&re.destroy()}return ye}function jt(re,te,ye){te.ending=!0,fe(re,te),ye&&(te.finished?process.nextTick(ye):re.once("finish",ye)),te.ended=!0,re.writable=!1}function mi(re,te,ye){var _e=re.entry;for(re.entry=null;_e;){var Ie=_e.callback;te.pendingcb--,Ie(ye),_e=_e.next}te.corkedRequestsFree.next=re}return Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(te){this._writableState&&(this._writableState.destroyed=te)}}),T.prototype.destroy=l.destroy,T.prototype._undestroy=l.undestroy,T.prototype._destroy=function(re,te){te(re)},aN}var lN,az;function U_(){if(az)return lN;az=1;var n=Object.keys||function(c){var u=[];for(var h in c)u.push(h);return u};lN=o;var e=hte(),t=ute();$b(o,e);for(var i=n(t.prototype),s=0;s<i.length;s++){var r=i[s];o.prototype[r]||(o.prototype[r]=t.prototype[r])}function o(c){if(!(this instanceof o))return new o(c);e.call(this,c),t.call(this,c),this.allowHalfOpen=!0,c&&(c.readable===!1&&(this.readable=!1),c.writable===!1&&(this.writable=!1),c.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||process.nextTick(l,this)}function l(c){c.end()}return Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),lN}var D4={},E4={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=zs,i=t.Buffer;function s(o,a){for(var l in o)a[l]=o[l]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=t:(s(t,e),e.Buffer=r);function r(o,a,l){return i(o,a,l)}r.prototype=Object.create(i.prototype),s(i,r),r.from=function(o,a,l){if(typeof o=="number")throw new TypeError("Argument must not be a number");return i(o,a,l)},r.alloc=function(o,a,l){if(typeof o!="number")throw new TypeError("Argument must be a number");var c=i(o);return a!==void 0?typeof l=="string"?c.fill(a,l):c.fill(a):c.fill(0),c},r.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return i(o)},r.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}})(E4,E4.exports);var ILe=E4.exports,H6=ILe.Buffer,lz=H6.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function NLe(n){if(!n)return"utf8";for(var e;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(e)return;n=(""+n).toLowerCase(),e=!0}}function RLe(n){var e=NLe(n);if(typeof e!="string"&&(H6.isEncoding===lz||!lz(n)))throw new Error("Unknown encoding: "+n);return e||n}var MLe=D4.StringDecoder=aS;function aS(n){this.encoding=RLe(n);var e;switch(this.encoding){case"utf16le":this.text=VLe,this.end=$Le,e=4;break;case"utf8":this.fillLast=OLe,e=4;break;case"base64":this.text=zLe,this.end=HLe,e=3;break;default:this.write=ULe,this.end=jLe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=H6.allocUnsafe(e)}aS.prototype.write=function(n){if(n.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(n),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<n.length?e?e+this.text(n,t):this.text(n,t):e||""};aS.prototype.end=WLe;aS.prototype.text=BLe;aS.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function cN(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function FLe(n,e,t){var i=e.length-1;if(i<t)return 0;var s=cN(e[i]);return s>=0?(s>0&&(n.lastNeed=s-1),s):--i<t||s===-2?0:(s=cN(e[i]),s>=0?(s>0&&(n.lastNeed=s-2),s):--i<t||s===-2?0:(s=cN(e[i]),s>=0?(s>0&&(s===2?s=0:n.lastNeed=s-3),s):0))}function PLe(n,e,t){if((e[0]&192)!==128)return n.lastNeed=0,"�";if(n.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return n.lastNeed=1,"�";if(n.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return n.lastNeed=2,"�"}}function OLe(n){var e=this.lastTotal-this.lastNeed,t=PLe(this,n);if(t!==void 0)return t;if(this.lastNeed<=n.length)return n.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,e,0,n.length),this.lastNeed-=n.length}function BLe(n,e){var t=FLe(this,n,e);if(!this.lastNeed)return n.toString("utf8",e);this.lastTotal=t;var i=n.length-(t-this.lastNeed);return n.copy(this.lastChar,0,i),n.toString("utf8",e,i)}function WLe(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"�":e}function VLe(n,e){if((n.length-e)%2===0){var t=n.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",e,n.length-1)}function $Le(n){var e=n&&n.length?this.write(n):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function zLe(n,e){var t=(n.length-e)%3;return t===0?n.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",e,n.length-t))}function HLe(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function ULe(n){return n.toString(this.encoding)}function jLe(n){return n&&n.length?this.write(n):""}var uN,cz;function U6(){if(cz)return uN;cz=1;var n=zb().codes.ERR_STREAM_PREMATURE_CLOSE;function e(r){var o=!1;return function(){if(!o){o=!0;for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];r.apply(this,l)}}}function t(){}function i(r){return r.setHeader&&typeof r.abort=="function"}function s(r,o,a){if(typeof o=="function")return s(r,null,o);o||(o={}),a=e(a||t);var l=o.readable||o.readable!==!1&&r.readable,c=o.writable||o.writable!==!1&&r.writable,u=function(){r.writable||d()},h=r._writableState&&r._writableState.finished,d=function(){c=!1,h=!0,l||a.call(r)},f=r._readableState&&r._readableState.endEmitted,g=function(){l=!1,f=!0,c||a.call(r)},p=function(w){a.call(r,w)},m=function(){var w;if(l&&!f)return(!r._readableState||!r._readableState.ended)&&(w=new n),a.call(r,w);if(c&&!h)return(!r._writableState||!r._writableState.ended)&&(w=new n),a.call(r,w)},b=function(){r.req.on("finish",d)};return i(r)?(r.on("complete",d),r.on("abort",m),r.req?b():r.on("request",b)):c&&!r._writableState&&(r.on("end",u),r.on("close",u)),r.on("end",g),r.on("finish",d),o.error!==!1&&r.on("error",p),r.on("close",m),function(){r.removeListener("complete",d),r.removeListener("abort",m),r.removeListener("request",b),r.req&&r.req.removeListener("finish",d),r.removeListener("end",u),r.removeListener("close",u),r.removeListener("finish",d),r.removeListener("end",g),r.removeListener("error",p),r.removeListener("close",m)}}return uN=s,uN}var hN,uz;function qLe(){if(uz)return hN;uz=1;var n;function e(b,v,w){return v in b?Object.defineProperty(b,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[v]=w,b}var t=U6(),i=Symbol("lastResolve"),s=Symbol("lastReject"),r=Symbol("error"),o=Symbol("ended"),a=Symbol("lastPromise"),l=Symbol("handlePromise"),c=Symbol("stream");function u(b,v){return{value:b,done:v}}function h(b){var v=b[i];if(v!==null){var w=b[c].read();w!==null&&(b[a]=null,b[i]=null,b[s]=null,v(u(w,!1)))}}function d(b){process.nextTick(h,b)}function f(b,v){return function(w,y){b.then(function(){if(v[o]){w(u(void 0,!0));return}v[l](w,y)},y)}}var g=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((n={get stream(){return this[c]},next:function(){var v=this,w=this[r];if(w!==null)return Promise.reject(w);if(this[o])return Promise.resolve(u(void 0,!0));if(this[c].destroyed)return new Promise(function(S,T){process.nextTick(function(){v[r]?T(v[r]):S(u(void 0,!0))})});var y=this[a],x;if(y)x=new Promise(f(y,this));else{var D=this[c].read();if(D!==null)return Promise.resolve(u(D,!1));x=new Promise(this[l])}return this[a]=x,x}},e(n,Symbol.asyncIterator,function(){return this}),e(n,"return",function(){var v=this;return new Promise(function(w,y){v[c].destroy(null,function(x){if(x){y(x);return}w(u(void 0,!0))})})}),n),g),m=function(v){var w,y=Object.create(p,(w={},e(w,c,{value:v,writable:!0}),e(w,i,{value:null,writable:!0}),e(w,s,{value:null,writable:!0}),e(w,r,{value:null,writable:!0}),e(w,o,{value:v._readableState.endEmitted,writable:!0}),e(w,l,{value:function(D,S){var T=y[c].read();T?(y[a]=null,y[i]=null,y[s]=null,D(u(T,!1))):(y[i]=D,y[s]=S)},writable:!0}),w));return y[a]=null,t(v,function(x){if(x&&x.code!=="ERR_STREAM_PREMATURE_CLOSE"){var D=y[s];D!==null&&(y[a]=null,y[i]=null,y[s]=null,D(x)),y[r]=x;return}var S=y[i];S!==null&&(y[a]=null,y[i]=null,y[s]=null,S(u(void 0,!0))),y[o]=!0}),v.on("readable",d.bind(null,y)),y};return hN=m,hN}var dN,hz;function GLe(){return hz||(hz=1,dN=function(){throw new Error("Readable.from is not available in the browser")}),dN}var fN,dz;function hte(){if(dz)return fN;dz=1,fN=k;var n;k.ReadableState=T,z6.EventEmitter;var e=function(M,pe){return M.listeners(pe).length},t=ote(),i=zs.Buffer,s=globalThis.Uint8Array||function(){};function r(F){return i.from(F)}function o(F){return i.isBuffer(F)||F instanceof s}var a=ate,l;a&&a.debuglog?l=a.debuglog("stream"):l=function(){};var c=TLe(),u=lte(),h=cte(),d=h.getHighWaterMark,f=zb().codes,g=f.ERR_INVALID_ARG_TYPE,p=f.ERR_STREAM_PUSH_AFTER_EOF,m=f.ERR_METHOD_NOT_IMPLEMENTED,b=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,v,w,y;$b(k,t);var x=u.errorOrDestroy,D=["error","close","destroy","pause","resume"];function S(F,M,pe){if(typeof F.prependListener=="function")return F.prependListener(M,pe);!F._events||!F._events[M]?F.on(M,pe):Array.isArray(F._events[M])?F._events[M].unshift(pe):F._events[M]=[pe,F._events[M]]}function T(F,M,pe){n=n||U_(),F=F||{},typeof pe!="boolean"&&(pe=M instanceof n),this.objectMode=!!F.objectMode,pe&&(this.objectMode=this.objectMode||!!F.readableObjectMode),this.highWaterMark=d(this,F,"readableHighWaterMark",pe),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=F.emitClose!==!1,this.autoDestroy=!!F.autoDestroy,this.destroyed=!1,this.defaultEncoding=F.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,F.encoding&&(v||(v=D4.StringDecoder),this.decoder=new v(F.encoding),this.encoding=F.encoding)}function k(F){if(n=n||U_(),!(this instanceof k))return new k(F);var M=this instanceof n;this._readableState=new T(F,this,M),this.readable=!0,F&&(typeof F.read=="function"&&(this._read=F.read),typeof F.destroy=="function"&&(this._destroy=F.destroy)),t.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(M){this._readableState&&(this._readableState.destroyed=M)}}),k.prototype.destroy=u.destroy,k.prototype._undestroy=u.undestroy,k.prototype._destroy=function(F,M){M(F)},k.prototype.push=function(F,M){var pe=this._readableState,ke;return pe.objectMode?ke=!0:typeof F=="string"&&(M=M||pe.defaultEncoding,M!==pe.encoding&&(F=i.from(F,M),M=""),ke=!0),I(this,F,M,!1,ke)},k.prototype.unshift=function(F){return I(this,F,null,!0,!1)};function I(F,M,pe,ke,et){l("readableAddChunk",M);var Xe=F._readableState;if(M===null)Xe.reading=!1,de(F,Xe);else{var Nt;if(et||(Nt=z(Xe,M)),Nt)x(F,Nt);else if(Xe.objectMode||M&&M.length>0)if(typeof M!="string"&&!Xe.objectMode&&Object.getPrototypeOf(M)!==i.prototype&&(M=r(M)),ke)Xe.endEmitted?x(F,new b):N(F,Xe,M,!0);else if(Xe.ended)x(F,new p);else{if(Xe.destroyed)return!1;Xe.reading=!1,Xe.decoder&&!pe?(M=Xe.decoder.write(M),Xe.objectMode||M.length!==0?N(F,Xe,M,!1):ve(F,Xe)):N(F,Xe,M,!1)}else ke||(Xe.reading=!1,ve(F,Xe))}return!Xe.ended&&(Xe.length<Xe.highWaterMark||Xe.length===0)}function N(F,M,pe,ke){M.flowing&&M.length===0&&!M.sync?(M.awaitDrain=0,F.emit("data",pe)):(M.length+=M.objectMode?1:pe.length,ke?M.buffer.unshift(pe):M.buffer.push(pe),M.needReadable&&me(F)),ve(F,M)}function z(F,M){var pe;return!o(M)&&typeof M!="string"&&M!==void 0&&!F.objectMode&&(pe=new g("chunk",["string","Buffer","Uint8Array"],M)),pe}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(F){v||(v=D4.StringDecoder);var M=new v(F);this._readableState.decoder=M,this._readableState.encoding=this._readableState.decoder.encoding;for(var pe=this._readableState.buffer.head,ke="";pe!==null;)ke+=M.write(pe.data),pe=pe.next;return this._readableState.buffer.clear(),ke!==""&&this._readableState.buffer.push(ke),this._readableState.length=ke.length,this};var $=1073741824;function q(F){return F>=$?F=$:(F--,F|=F>>>1,F|=F>>>2,F|=F>>>4,F|=F>>>8,F|=F>>>16,F++),F}function ne(F,M){return F<=0||M.length===0&&M.ended?0:M.objectMode?1:F!==F?M.flowing&&M.length?M.buffer.head.data.length:M.length:(F>M.highWaterMark&&(M.highWaterMark=q(F)),F<=M.length?F:M.ended?M.length:(M.needReadable=!0,0))}k.prototype.read=function(F){l("read",F),F=parseInt(F,10);var M=this._readableState,pe=F;if(F!==0&&(M.emittedReadable=!1),F===0&&M.needReadable&&((M.highWaterMark!==0?M.length>=M.highWaterMark:M.length>0)||M.ended))return l("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?ye(this):me(this),null;if(F=ne(F,M),F===0&&M.ended)return M.length===0&&ye(this),null;var ke=M.needReadable;l("need readable",ke),(M.length===0||M.length-F<M.highWaterMark)&&(ke=!0,l("length less than watermark",ke)),M.ended||M.reading?(ke=!1,l("reading or ended",ke)):ke&&(l("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(F=ne(pe,M)));var et;return F>0?et=te(F,M):et=null,et===null?(M.needReadable=M.length<=M.highWaterMark,F=0):(M.length-=F,M.awaitDrain=0),M.length===0&&(M.ended||(M.needReadable=!0),pe!==F&&M.ended&&ye(this)),et!==null&&this.emit("data",et),et};function de(F,M){if(l("onEofChunk"),!M.ended){if(M.decoder){var pe=M.decoder.end();pe&&pe.length&&(M.buffer.push(pe),M.length+=M.objectMode?1:pe.length)}M.ended=!0,M.sync?me(F):(M.needReadable=!1,M.emittedReadable||(M.emittedReadable=!0,De(F)))}}function me(F){var M=F._readableState;l("emitReadable",M.needReadable,M.emittedReadable),M.needReadable=!1,M.emittedReadable||(l("emitReadable",M.flowing),M.emittedReadable=!0,process.nextTick(De,F))}function De(F){var M=F._readableState;l("emitReadable_",M.destroyed,M.length,M.ended),!M.destroyed&&(M.length||M.ended)&&(F.emit("readable"),M.emittedReadable=!1),M.needReadable=!M.flowing&&!M.ended&&M.length<=M.highWaterMark,re(F)}function ve(F,M){M.readingMore||(M.readingMore=!0,process.nextTick($e,F,M))}function $e(F,M){for(;!M.reading&&!M.ended&&(M.length<M.highWaterMark||M.flowing&&M.length===0);){var pe=M.length;if(l("maybeReadMore read 0"),F.read(0),pe===M.length)break}M.readingMore=!1}k.prototype._read=function(F){x(this,new m("_read()"))},k.prototype.pipe=function(F,M){var pe=this,ke=this._readableState;switch(ke.pipesCount){case 0:ke.pipes=F;break;case 1:ke.pipes=[ke.pipes,F];break;default:ke.pipes.push(F);break}ke.pipesCount+=1,l("pipe count=%d opts=%j",ke.pipesCount,M);var et=(!M||M.end!==!1)&&F!==process.stdout&&F!==process.stderr,Xe=et?is:U;ke.endEmitted?process.nextTick(Xe):pe.once("end",Xe),F.on("unpipe",Nt);function Nt(A,C){l("onunpipe"),A===pe&&C&&C.hasUnpiped===!1&&(C.hasUnpiped=!0,ie())}function is(){l("onend"),F.end()}var Zo=Ne(pe);F.on("drain",Zo);var le=!1;function ie(){l("cleanup"),F.removeListener("close",W),F.removeListener("finish",K),F.removeListener("drain",Zo),F.removeListener("error",R),F.removeListener("unpipe",Nt),pe.removeListener("end",is),pe.removeListener("end",U),pe.removeListener("data",Q),le=!0,ke.awaitDrain&&(!F._writableState||F._writableState.needDrain)&&Zo()}pe.on("data",Q);function Q(A){l("ondata");var C=F.write(A);l("dest.write",C),C===!1&&((ke.pipesCount===1&&ke.pipes===F||ke.pipesCount>1&&Ie(ke.pipes,F)!==-1)&&!le&&(l("false write response, pause",ke.awaitDrain),ke.awaitDrain++),pe.pause())}function R(A){l("onerror",A),U(),F.removeListener("error",R),e(F,"error")===0&&x(F,A)}S(F,"error",R);function W(){F.removeListener("finish",K),U()}F.once("close",W);function K(){l("onfinish"),F.removeListener("close",W),U()}F.once("finish",K);function U(){l("unpipe"),pe.unpipe(F)}return F.emit("pipe",pe),ke.flowing||(l("pipe resume"),pe.resume()),F};function Ne(F){return function(){var pe=F._readableState;l("pipeOnDrain",pe.awaitDrain),pe.awaitDrain&&pe.awaitDrain--,pe.awaitDrain===0&&e(F,"data")&&(pe.flowing=!0,re(F))}}k.prototype.unpipe=function(F){var M=this._readableState,pe={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return F&&F!==M.pipes?this:(F||(F=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,F&&F.emit("unpipe",this,pe),this);if(!F){var ke=M.pipes,et=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var Xe=0;Xe<et;Xe++)ke[Xe].emit("unpipe",this,{hasUnpiped:!1});return this}var Nt=Ie(M.pipes,F);return Nt===-1?this:(M.pipes.splice(Nt,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),F.emit("unpipe",this,pe),this)},k.prototype.on=function(F,M){var pe=t.prototype.on.call(this,F,M),ke=this._readableState;return F==="data"?(ke.readableListening=this.listenerCount("readable")>0,ke.flowing!==!1&&this.resume()):F==="readable"&&!ke.endEmitted&&!ke.readableListening&&(ke.readableListening=ke.needReadable=!0,ke.flowing=!1,ke.emittedReadable=!1,l("on readable",ke.length,ke.reading),ke.length?me(this):ke.reading||process.nextTick(fe,this)),pe},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(F,M){var pe=t.prototype.removeListener.call(this,F,M);return F==="readable"&&process.nextTick(xe,this),pe},k.prototype.removeAllListeners=function(F){var M=t.prototype.removeAllListeners.apply(this,arguments);return(F==="readable"||F===void 0)&&process.nextTick(xe,this),M};function xe(F){var M=F._readableState;M.readableListening=F.listenerCount("readable")>0,M.resumeScheduled&&!M.paused?M.flowing=!0:F.listenerCount("data")>0&&F.resume()}function fe(F){l("readable nexttick read 0"),F.read(0)}k.prototype.resume=function(){var F=this._readableState;return F.flowing||(l("resume"),F.flowing=!F.readableListening,jt(this,F)),F.paused=!1,this};function jt(F,M){M.resumeScheduled||(M.resumeScheduled=!0,process.nextTick(mi,F,M))}function mi(F,M){l("resume",M.reading),M.reading||F.read(0),M.resumeScheduled=!1,F.emit("resume"),re(F),M.flowing&&!M.reading&&F.read(0)}k.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function re(F){var M=F._readableState;for(l("flow",M.flowing);M.flowing&&F.read()!==null;);}k.prototype.wrap=function(F){var M=this,pe=this._readableState,ke=!1;F.on("end",function(){if(l("wrapped end"),pe.decoder&&!pe.ended){var Nt=pe.decoder.end();Nt&&Nt.length&&M.push(Nt)}M.push(null)}),F.on("data",function(Nt){if(l("wrapped data"),pe.decoder&&(Nt=pe.decoder.write(Nt)),!(pe.objectMode&&Nt==null)&&!(!pe.objectMode&&(!Nt||!Nt.length))){var is=M.push(Nt);is||(ke=!0,F.pause())}});for(var et in F)this[et]===void 0&&typeof F[et]=="function"&&(this[et]=function(is){return function(){return F[is].apply(F,arguments)}}(et));for(var Xe=0;Xe<D.length;Xe++)F.on(D[Xe],this.emit.bind(this,D[Xe]));return this._read=function(Nt){l("wrapped _read",Nt),ke&&(ke=!1,F.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return w===void 0&&(w=qLe()),w(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(M){this._readableState&&(this._readableState.flowing=M)}}),k._fromList=te,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function te(F,M){if(M.length===0)return null;var pe;return M.objectMode?pe=M.buffer.shift():!F||F>=M.length?(M.decoder?pe=M.buffer.join(""):M.buffer.length===1?pe=M.buffer.first():pe=M.buffer.concat(M.length),M.buffer.clear()):pe=M.buffer.consume(F,M.decoder),pe}function ye(F){var M=F._readableState;l("endReadable",M.endEmitted),M.endEmitted||(M.ended=!0,process.nextTick(_e,M,F))}function _e(F,M){if(l("endReadableNT",F.endEmitted,F.length),!F.endEmitted&&F.length===0&&(F.endEmitted=!0,M.readable=!1,M.emit("end"),F.autoDestroy)){var pe=M._writableState;(!pe||pe.autoDestroy&&pe.finished)&&M.destroy()}}typeof Symbol=="function"&&(k.from=function(F,M){return y===void 0&&(y=GLe()),y(k,F,M)});function Ie(F,M){for(var pe=0,ke=F.length;pe<ke;pe++)if(F[pe]===M)return pe;return-1}return fN}var gN,fz;function dte(){if(fz)return gN;fz=1,gN=a;var n=zb().codes,e=n.ERR_METHOD_NOT_IMPLEMENTED,t=n.ERR_MULTIPLE_CALLBACK,i=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,r=U_();$b(a,r);function o(u,h){var d=this._transformState;d.transforming=!1;var f=d.writecb;if(f===null)return this.emit("error",new t);d.writechunk=null,d.writecb=null,h!=null&&this.push(h),f(u);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function a(u){if(!(this instanceof a))return new a(u);r.call(this,u),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.on("prefinish",l)}function l(){var u=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(h,d){c(u,h,d)}):c(this,null,null)}a.prototype.push=function(u,h){return this._transformState.needTransform=!1,r.prototype.push.call(this,u,h)},a.prototype._transform=function(u,h,d){d(new e("_transform()"))},a.prototype._write=function(u,h,d){var f=this._transformState;if(f.writecb=d,f.writechunk=u,f.writeencoding=h,!f.transforming){var g=this._readableState;(f.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},a.prototype._read=function(u){var h=this._transformState;h.writechunk!==null&&!h.transforming?(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform)):h.needTransform=!0},a.prototype._destroy=function(u,h){r.prototype._destroy.call(this,u,function(d){h(d)})};function c(u,h,d){if(h)return u.emit("error",h);if(d!=null&&u.push(d),u._writableState.length)throw new s;if(u._transformState.transforming)throw new i;return u.push(null)}return gN}var pN,gz;function KLe(){if(gz)return pN;gz=1,pN=e;var n=dte();$b(e,n);function e(t){if(!(this instanceof e))return new e(t);n.call(this,t)}return e.prototype._transform=function(t,i,s){s(null,t)},pN}var mN,pz;function ZLe(){if(pz)return mN;pz=1;var n;function e(d){var f=!1;return function(){f||(f=!0,d.apply(void 0,arguments))}}var t=zb().codes,i=t.ERR_MISSING_ARGS,s=t.ERR_STREAM_DESTROYED;function r(d){if(d)throw d}function o(d){return d.setHeader&&typeof d.abort=="function"}function a(d,f,g,p){p=e(p);var m=!1;d.on("close",function(){m=!0}),n===void 0&&(n=U6()),n(d,{readable:f,writable:g},function(v){if(v)return p(v);m=!0,p()});var b=!1;return function(v){if(!m&&!b){if(b=!0,o(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();p(v||new s("pipe"))}}}function l(d){d()}function c(d,f){return d.pipe(f)}function u(d){return!d.length||typeof d[d.length-1]!="function"?r:d.pop()}function h(){for(var d=arguments.length,f=new Array(d),g=0;g<d;g++)f[g]=arguments[g];var p=u(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new i("streams");var m,b=f.map(function(v,w){var y=w<f.length-1,x=w>0;return a(v,y,x,function(D){m||(m=D),D&&b.forEach(l),!y&&(b.forEach(l),p(m))})});return f.reduce(c)}return mN=h,mN}var fte=Ia,j6=z6.EventEmitter,YLe=$b;YLe(Ia,j6);Ia.Readable=hte();Ia.Writable=ute();Ia.Duplex=U_();Ia.Transform=dte();Ia.PassThrough=KLe();Ia.finished=U6();Ia.pipeline=ZLe();Ia.Stream=Ia;function Ia(){j6.call(this)}Ia.prototype.pipe=function(n,e){var t=this;function i(u){n.writable&&n.write(u)===!1&&t.pause&&t.pause()}t.on("data",i);function s(){t.readable&&t.resume&&t.resume()}n.on("drain",s),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",o),t.on("close",a));var r=!1;function o(){r||(r=!0,n.end())}function a(){r||(r=!0,typeof n.destroy=="function"&&n.destroy())}function l(u){if(c(),j6.listenerCount(this,"error")===0)throw u}t.on("error",l),n.on("error",l);function c(){t.removeListener("data",i),n.removeListener("drain",s),t.removeListener("end",o),t.removeListener("close",a),t.removeListener("error",l),n.removeListener("error",l),t.removeListener("end",c),t.removeListener("close",c),n.removeListener("close",c)}return t.on("end",c),t.on("close",c),n.on("close",c),n.emit("pipe",t),n};function $v(n){return n.replace(/%([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}function gte(n,e){return String(e).replace(n,t=>`%${t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}`)}function J1(n){return gte(/[\n;\r\t=%&,\x00-\x1f\x7f-\xff]/g,n)}function cu(n){return gte(/[\n\r\t%\x00-\x1f\x7f-\xff]/g,n)}function pte(n){if(!(n&&n.length)||n===".")return{};const e={};return n.replace(/\r?\n$/,"").split(";").forEach(t=>{const i=t.split("=",2);if(!(i[1]&&i[1].length))return;i[0]=i[0].trim();let s=e[i[0].trim()];s||(s=[],e[i[0]]=s),s.push(...i[1].split(",").map(r=>r.trim()).map($v))}),e}function mte(n){const e=n.split("	").map(i=>i==="."||i===""?null:i);return{seq_id:e[0]&&$v(e[0]),source:e[1]&&$v(e[1]),type:e[2]&&$v(e[2]),start:e[3]===null?null:parseInt(e[3],10),end:e[4]===null?null:parseInt(e[4],10),score:e[5]===null?null:parseFloat(e[5]),strand:e[6],phase:e[7],attributes:e[8]===null?null:pte(e[8])}}function _te(n){const e=/^\s*##\s*(\S+)\s*(.*)/.exec(n);if(!e)return null;const[,t]=e;let[,,i]=e;const s={directive:t};if(i.length&&(i=i.replace(/\r?\n$/,""),s.value=i),t==="sequence-region"){const r=i.split(/\s+/,3);return{...s,seq_id:r[0],start:r[1]&&r[1].replace(/\D/g,""),end:r[2]&&r[2].replace(/\D/g,"")}}else if(t==="genome-build"){const[r,o]=i.split(/\s+/,2);return{...s,source:r,buildName:o}}return s}function bte(n){const e=[];return Object.entries(n).forEach(([t,i])=>{if(!i)return;let s;i.hasOwnProperty("toString")?s=J1(i.toString()):Array.isArray(i)?s=i.map(J1).join(","):s=J1(i),e.push(`${J1(t)}=${s}`)}),e.length?e.join(";"):"."}function XLe(n,e){const t=n.attributes===null||n.attributes===void 0?".":bte(n.attributes),s=`${[n.seq_id===null?".":cu(n.seq_id),n.source===null?".":cu(n.source),n.type===null?".":cu(n.type),n.start===null?".":cu(n.start),n.end===null?".":cu(n.end),n.score===null?".":cu(n.score),n.strand===null?".":cu(n.strand),n.phase===null?".":cu(n.phase),t].join("	")}
`;return e[s]?"":(e[s]=!0,s)}function z2(n,e){if(Array.isArray(n))return n.map(i=>z2(i,e)).join("");const t=[XLe(n,e)];return QLe(n)&&t.push(...n.child_features.map(i=>z2(i,e)),...n.derived_features.map(i=>z2(i,e))),t.join("")}function vte(n){return z2(n,{})}function wte(n){let e=`##${n.directive}`;return n.value&&(e+=` ${n.value}`),e+=`
`,e}function yte(n){return`# ${n.comment}
`}function q6(n){return`>${n.id}${n.description?` ${n.description}`:""}
${n.sequence}
`}function bL(n){function e(t){return"attributes"in t?vte(t):"directive"in t?wte(t):"sequence"in t?q6(t):"comment"in t?yte(t):`# (invalid item found during format)
`}return Array.isArray(n)?n.map(e):e(n)}function QLe(n){return n.child_features!==void 0&&n.derived_features!==void 0}const JLe=Object.freeze(Object.defineProperty({__proto__:null,escape:J1,escapeColumn:cu,formatAttributes:bte,formatComment:yte,formatDirective:wte,formatFeature:vte,formatItem:bL,formatSequence:q6,parseAttributes:pte,parseDirective:_te,parseFeature:mte,unescape:$v},Symbol.toStringTag,{value:"Module"})),mz={Parent:"child_features",Derives_from:"derived_features"};class _z{constructor(e){this.seqCallback=e,this.currentSequence=void 0}addLine(e){const t=/^>\s*(\S+)\s*(.*)/.exec(e);t?(this._flush(),this.currentSequence={id:t[1],sequence:""},t[2]&&(this.currentSequence.description=t[2].trim())):this.currentSequence&&/\S/.test(e)&&(this.currentSequence.sequence+=e.replace(/\s/g,""))}_flush(){this.currentSequence&&this.seqCallback(this.currentSequence)}finish(){this._flush()}}let Cte=class{constructor(e){this.fastaParser=void 0,this.eof=!1,this.lineNumber=0,this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},this._underConstructionOrphans={};const t=()=>{};this.featureCallback=e.featureCallback||t,this.endCallback=e.endCallback||t,this.commentCallback=e.commentCallback||t,this.errorCallback=e.errorCallback||t,this.directiveCallback=e.directiveCallback||t,this.sequenceCallback=e.sequenceCallback||t,this.disableDerivesFromReferences=e.disableDerivesFromReferences||!1,this.bufferSize=e.bufferSize===void 0?1e3:e.bufferSize}addLine(e){if(this.fastaParser){this.fastaParser.addLine(e);return}if(this.eof)return;if(this.lineNumber+=1,/^\s*[^#\s>]/.test(e)){this._bufferLine(e);return}const t=/^\s*(#+)(.*)/.exec(e);if(t){const[,i]=t;let[,,s]=t;if(i.length===3)this._emitAllUnderConstructionFeatures();else if(i.length===2){const r=_te(e);r&&(r.directive==="FASTA"?(this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new _z(this.sequenceCallback)):this._emitItem(r))}else s=s.replace(/\s*/,""),this._emitItem({comment:s})}else if(!/^\s*$/.test(e))if(/^\s*>/.test(e))this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new _z(this.sequenceCallback),this.fastaParser.addLine(e);else{const i=e.replace(/\r?\n?$/g,"");throw new Error(`GFF3 parse error.  Cannot parse '${i}'.`)}}finish(){this._emitAllUnderConstructionFeatures(),this.fastaParser&&this.fastaParser.finish(),this.endCallback()}_emitItem(e){Array.isArray(e)?this.featureCallback(e):"directive"in e?this.directiveCallback(e):"comment"in e&&this.commentCallback(e)}_enforceBufferSizeLimit(e=0){const t=i=>{i&&Array.isArray(i)&&i[0].attributes&&i[0].attributes.ID&&i[0].attributes.ID[0]&&(i[0].attributes.ID.forEach(r=>{delete this._underConstructionById[r],delete this._completedReferences[r]}),i.forEach(r=>{r.child_features&&r.child_features.forEach(o=>t(o)),r.derived_features&&r.derived_features.forEach(o=>t(o))}))};for(;this._underConstructionTopLevel.length+e>this.bufferSize;){const i=this._underConstructionTopLevel.shift();i&&(this._emitItem(i),t(i))}}_emitAllUnderConstructionFeatures(){if(this._underConstructionTopLevel.forEach(this._emitItem.bind(this)),this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},Array.from(Object.values(this._underConstructionOrphans)).length)throw new Error(`some features reference other features that do not exist in the file (or in the same '###' scope). ${Object.keys(this._underConstructionOrphans)}`)}_bufferLine(e){var t,i,s;const o={...mte(e),child_features:[],derived_features:[]},a=((t=o.attributes)===null||t===void 0?void 0:t.ID)||[],l=((i=o.attributes)===null||i===void 0?void 0:i.Parent)||[],c=this.disableDerivesFromReferences?[]:((s=o.attributes)===null||s===void 0?void 0:s.Derives_from)||[];if(!a.length&&!l.length&&!c.length){this._emitItem([o]);return}let u;a.forEach(h=>{const d=this._underConstructionById[h];d?(d[d.length-1].type!==o.type&&this._parseError(`multi-line feature "${h}" has inconsistent types: "${o.type}", "${d[d.length-1].type}"`),d.push(o),u=d):(u=[o],this._enforceBufferSizeLimit(1),!l.length&&!c.length&&this._underConstructionTopLevel.push(u),this._underConstructionById[h]=u,this._resolveReferencesTo(u,h))}),this._resolveReferencesFrom(u||[o],{Parent:l,Derives_from:c},a)}_resolveReferencesTo(e,t){const i=this._underConstructionOrphans[t];i&&(e.forEach(s=>{s.child_features.push(...i.Parent)}),e.forEach(s=>{s.derived_features.push(...i.Derives_from)}),delete this._underConstructionOrphans[t])}_parseError(e){this.eof=!0,this.errorCallback(`${this.lineNumber}: ${e}`)}_resolveReferencesFrom(e,t,i){function s(r,o,a){let l=r[o];l||(l={},r[o]=l);const c=l[a]||!1;return l[a]=!0,c}t.Parent.forEach(r=>{const o=this._underConstructionById[r];if(o){const a=mz.Parent;i.filter(l=>s(this._completedReferences,l,`Parent,${r}`)).length||o.forEach(l=>{l[a].push(e)})}else{let a=this._underConstructionOrphans[r];a||(a={Parent:[],Derives_from:[]},this._underConstructionOrphans[r]=a),a.Parent.push(e)}}),t.Derives_from.forEach(r=>{const o=this._underConstructionById[r];if(o){const a=mz.Derives_from;i.filter(l=>s(this._completedReferences,l,`Derives_from,${r}`)).length||o.forEach(l=>{l[a].push(e)})}else{let a=this._underConstructionOrphans[r];a||(a={Parent:[],Derives_from:[]},this._underConstructionOrphans[r]=a),a.Derives_from.push(e)}})}};function T4(n){process&&process.nextTick?process.nextTick(n):n()}function Ste(n){const e={encoding:"utf8",parseFeatures:!0,parseDirectives:!1,parseSequences:!0,parseComments:!1,bufferSize:1e3,disableDerivesFromReferences:!1,...n};return n.parseAll&&(e.parseFeatures=!0,e.parseDirectives=!0,e.parseComments=!0,e.parseSequences=!0),e}class eDe extends fte.Transform{constructor(e={}){super({objectMode:!0}),this.textBuffer="";const t=Ste(e);this.encoding=e.encoding||"utf8",this.decoder=new MLe;const i=this.push.bind(this);this.parser=new Cte({featureCallback:t.parseFeatures?i:void 0,directiveCallback:t.parseDirectives?i:void 0,commentCallback:t.parseComments?i:void 0,sequenceCallback:t.parseSequences?i:void 0,errorCallback:s=>this.emit("error",s),bufferSize:t.bufferSize,disableDerivesFromReferences:t.disableDerivesFromReferences})}_addLine(e){e&&this.parser.addLine(e)}_nextText(e){const t=(this.textBuffer+e).split(/\r?\n/);this.textBuffer=t.pop()||"",t.forEach(i=>this._addLine(i))}_transform(e,t,i){this._nextText(this.decoder.write(e)),T4(i)}_flush(e){this.decoder.end&&this._nextText(this.decoder.end()),this.textBuffer!=null&&this._addLine(this.textBuffer),this.parser.finish(),T4(e)}}function tDe(n={}){return new eDe(n)}function iDe(n,e={}){if(!n)return[];const t=Ste(e),i=[],s=i.push.bind(i),r=new Cte({featureCallback:t.parseFeatures?s:void 0,directiveCallback:t.parseDirectives?s:void 0,commentCallback:t.parseComments?s:void 0,sequenceCallback:t.parseSequences?s:void 0,disableDerivesFromReferences:t.disableDerivesFromReferences||!1,bufferSize:1/0,errorCallback:o=>{throw o}});return n.split(/\r?\n/).forEach(r.addLine.bind(r)),r.finish(),i}function nDe(n){const e=[],t=[];n.forEach(s=>{"sequence"in s?t.push(s):e.push(s)});let i=e.map(bL).join("");return t.length&&(i+=`##FASTA
`,i+=t.map(q6).join("")),i}class xte extends fte.Transform{constructor(e={}){super(Object.assign(e,{objectMode:!0})),this.linesSinceLastSyncMark=0,this.haveWeEmittedData=!1,this.fastaMode=!1,this.minLinesBetweenSyncMarks=e.minSyncLines||100,this.insertVersionDirective=e.insertVersionDirective||!1}_transform(e,t,i){let s;if(!this.haveWeEmittedData&&this.insertVersionDirective){const r=Array.isArray(e)?e[0]:e;"directive"in r&&r.directive!=="gff-version"&&this.push(`##gff-version 3
`)}if("sequence"in e&&!this.fastaMode&&(this.push(`##FASTA
`),this.fastaMode=!0),Array.isArray(e)?s=e.map(bL).join(""):s=bL(e),this.push(s),this.linesSinceLastSyncMark>=this.minLinesBetweenSyncMarks)this.push(`###
`),this.linesSinceLastSyncMark=0;else{let r=0;for(let o=0;o<s.length;o+=1)s[o]===`
`&&(r+=1);this.linesSinceLastSyncMark+=r}this.haveWeEmittedData=!0,T4(i)}}function sDe(n={}){return new xte(n)}function rDe(n,e,t={}){const i={insertVersionDirective:!0,...t};return new Promise((s,r)=>{n.pipe(new xte(i)).on("end",()=>s(null)).on("error",r).pipe(e)})}const oDe={parseStream:tDe,parseStringSync:iDe,formatSync:nDe,formatStream:sDe,formatFile:rDe,util:JLe};function kte(n){if(n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return n.toNumber()}class aDe extends Error{}function qf(n){if(n&&n.aborted){if(typeof DOMException<"u")throw new DOMException("aborted","AbortError");{const e=new aDe("aborted");throw e.code="ERR_ABORTED",e}}}function lDe(n,e){return e.minv.blockPosition-n.maxv.blockPosition<65e3&&e.maxv.blockPosition-n.minv.blockPosition<5e6}function Lte(n,e){const t=[];let i=null;return n.length===0?n:(n.sort(function(s,r){const o=s.minv.blockPosition-r.minv.blockPosition;return o!==0?o:s.minv.dataPosition-r.minv.dataPosition}),n.forEach(s=>{(!e||s.maxv.compareTo(e)>0)&&(i===null?(t.push(s),i=s):lDe(i,s)?s.maxv.compareTo(i.maxv)>0&&(i.maxv=s.maxv):(t.push(s),i=s))}),t)}var cDe=Xi,fa=null;try{fa=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Xi(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Xi.prototype.__isLong__;Object.defineProperty(Xi.prototype,"__isLong__",{value:!0});function Co(n){return(n&&n.__isLong__)===!0}Xi.isLong=Co;var bz={},vz={};function Yp(n,e){var t,i,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(i=vz[n],i)?i:(t=Qi(n,(n|0)<0?-1:0,!0),s&&(vz[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(i=bz[n],i)?i:(t=Qi(n,n<0?-1:0,!1),s&&(bz[n]=t),t))}Xi.fromInt=Yp;function ga(n,e){if(isNaN(n))return e?kg:pa;if(e){if(n<0)return kg;if(n>=Dte)return Ate}else{if(n<=-yz)return lo;if(n+1>=yz)return Tte}return n<0?ga(-n,e).neg():Qi(n%j_|0,n/j_|0,e)}Xi.fromNumber=ga;function Qi(n,e,t){return new Xi(n,e,t)}Xi.fromBits=Qi;var vL=Math.pow;function G6(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return pa;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return G6(n.substring(1),e,t).neg();for(var s=ga(vL(t,8)),r=pa,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=ga(vL(t,a));r=r.mul(c).add(ga(l))}else r=r.mul(s),r=r.add(ga(l))}return r.unsigned=e,r}Xi.fromString=G6;function Il(n,e){return typeof n=="number"?ga(n,e):typeof n=="string"?G6(n,e):Qi(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Xi.fromValue=Il;var wz=65536,uDe=1<<24,j_=wz*wz,Dte=j_*j_,yz=Dte/2,Cz=Yp(uDe),pa=Yp(0);Xi.ZERO=pa;var kg=Yp(0,!0);Xi.UZERO=kg;var a0=Yp(1);Xi.ONE=a0;var Ete=Yp(1,!0);Xi.UONE=Ete;var A4=Yp(-1);Xi.NEG_ONE=A4;var Tte=Qi(-1,2147483647,!1);Xi.MAX_VALUE=Tte;var Ate=Qi(-1,-1,!0);Xi.MAX_UNSIGNED_VALUE=Ate;var lo=Qi(0,-2147483648,!1);Xi.MIN_VALUE=lo;var He=Xi.prototype;He.toInt=function(){return this.unsigned?this.low>>>0:this.low};He.toNumber=function(){return this.unsigned?(this.high>>>0)*j_+(this.low>>>0):this.high*j_+(this.low>>>0)};He.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(lo)){var t=ga(e),i=this.div(t),s=i.mul(t).sub(this);return i.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=ga(vL(e,6),this.unsigned),o=this,a="";;){var l=o.div(r),c=o.sub(l.mul(r)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};He.getHighBits=function(){return this.high};He.getHighBitsUnsigned=function(){return this.high>>>0};He.getLowBits=function(){return this.low};He.getLowBitsUnsigned=function(){return this.low>>>0};He.getNumBitsAbs=function(){if(this.isNegative())return this.eq(lo)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};He.isZero=function(){return this.high===0&&this.low===0};He.eqz=He.isZero;He.isNegative=function(){return!this.unsigned&&this.high<0};He.isPositive=function(){return this.unsigned||this.high>=0};He.isOdd=function(){return(this.low&1)===1};He.isEven=function(){return(this.low&1)===0};He.equals=function(e){return Co(e)||(e=Il(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};He.eq=He.equals;He.notEquals=function(e){return!this.eq(e)};He.neq=He.notEquals;He.ne=He.notEquals;He.lessThan=function(e){return this.comp(e)<0};He.lt=He.lessThan;He.lessThanOrEqual=function(e){return this.comp(e)<=0};He.lte=He.lessThanOrEqual;He.le=He.lessThanOrEqual;He.greaterThan=function(e){return this.comp(e)>0};He.gt=He.greaterThan;He.greaterThanOrEqual=function(e){return this.comp(e)>=0};He.gte=He.greaterThanOrEqual;He.ge=He.greaterThanOrEqual;He.compare=function(e){if(Co(e)||(e=Il(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};He.comp=He.compare;He.negate=function(){return!this.unsigned&&this.eq(lo)?lo:this.not().add(a0)};He.neg=He.negate;He.add=function(e){Co(e)||(e=Il(e));var t=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=r+c,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=i+a,u+=h>>>16,h&=65535,u+=t+o,u&=65535,Qi(d<<16|f,u<<16|h,this.unsigned)};He.subtract=function(e){return Co(e)||(e=Il(e)),this.add(e.neg())};He.sub=He.subtract;He.multiply=function(e){if(this.isZero())return pa;if(Co(e)||(e=Il(e)),fa){var t=fa.mul(this.low,this.high,e.low,e.high);return Qi(t,fa.get_high(),this.unsigned)}if(e.isZero())return pa;if(this.eq(lo))return e.isOdd()?lo:pa;if(e.eq(lo))return this.isOdd()?lo:pa;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Cz)&&e.lt(Cz))return ga(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,g=0;return g+=o*u,f+=g>>>16,g&=65535,f+=r*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=r*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=i*u+s*c+r*l+o*a,h&=65535,Qi(f<<16|g,h<<16|d,this.unsigned)};He.mul=He.multiply;He.divide=function(e){if(Co(e)||(e=Il(e)),e.isZero())throw Error("division by zero");if(fa){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?fa.div_u:fa.div_s)(this.low,this.high,e.low,e.high);return Qi(t,fa.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?kg:pa;var i,s,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return kg;if(e.gt(this.shru(1)))return Ete;r=kg}else{if(this.eq(lo)){if(e.eq(a0)||e.eq(A4))return lo;if(e.eq(lo))return a0;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(pa)?e.isNegative()?a0:A4:(s=this.sub(e.mul(i)),r=i.add(s.div(e)),r)}else if(e.eq(lo))return this.unsigned?kg:pa;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=pa}for(s=this;s.gte(e);){i=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:vL(2,a-48),c=ga(i),u=c.mul(e);u.isNegative()||u.gt(s);)i-=l,c=ga(i,this.unsigned),u=c.mul(e);c.isZero()&&(c=a0),r=r.add(c),s=s.sub(u)}return r};He.div=He.divide;He.modulo=function(e){if(Co(e)||(e=Il(e)),fa){var t=(this.unsigned?fa.rem_u:fa.rem_s)(this.low,this.high,e.low,e.high);return Qi(t,fa.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};He.mod=He.modulo;He.rem=He.modulo;He.not=function(){return Qi(~this.low,~this.high,this.unsigned)};He.and=function(e){return Co(e)||(e=Il(e)),Qi(this.low&e.low,this.high&e.high,this.unsigned)};He.or=function(e){return Co(e)||(e=Il(e)),Qi(this.low|e.low,this.high|e.high,this.unsigned)};He.xor=function(e){return Co(e)||(e=Il(e)),Qi(this.low^e.low,this.high^e.high,this.unsigned)};He.shiftLeft=function(e){return Co(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Qi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Qi(0,this.low<<e-32,this.unsigned)};He.shl=He.shiftLeft;He.shiftRight=function(e){return Co(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Qi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Qi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};He.shr=He.shiftRight;He.shiftRightUnsigned=function(e){if(Co(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return Qi(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Qi(t,0,this.unsigned):Qi(t>>>e-32,0,this.unsigned)};He.shru=He.shiftRightUnsigned;He.shr_u=He.shiftRightUnsigned;He.toSigned=function(){return this.unsigned?Qi(this.low,this.high,!1):this};He.toUnsigned=function(){return this.unsigned?this:Qi(this.low,this.high,!0)};He.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};He.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};He.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Xi.fromBytes=function(e,t,i){return i?Xi.fromBytesLE(e,t):Xi.fromBytesBE(e,t)};Xi.fromBytesLE=function(e,t){return new Xi(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Xi.fromBytesBE=function(e,t){return new Xi(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const Ite=Up(cDe);class K6{constructor(e,t){this.blockPosition=e,this.dataPosition=t}toString(){return`${this.blockPosition}:${this.dataPosition}`}compareTo(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}static min(...e){let t,i=0;for(;!t;i+=1)t=e[i];for(;i<e.length;i+=1)t.compareTo(e[i])>0&&(t=e[i]);return t}}function U0(n,e=0,t=!1){if(t)throw new Error("big-endian virtual file offsets not implemented");return new K6(n[e+7]*1099511627776+n[e+6]*4294967296+n[e+5]*16777216+n[e+4]*65536+n[e+3]*256+n[e+2],n[e+1]<<8|n[e])}class wL{constructor(e,t,i,s=void 0){this.minv=e,this.maxv=t,this.bin=i,this._fetchedSize=s}toUniqueString(){return`${this.minv}..${this.maxv} (bin ${this.bin}, fetchedSize ${this.fetchedSize()})`}toString(){return this.toUniqueString()}compareTo(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}fetchedSize(){return this._fetchedSize!==void 0?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}}class Nte{constructor({filehandle:e,renameRefSeqs:t=i=>i}){this.filehandle=e,this.renameRefSeq=t}async getMetadata(e={}){const{indices:t,...i}=await this.parse(e);return i}_findFirstData(e,t){return e?e.compareTo(t)>0?t:e:t}async parse(e={}){return this.parseP||(this.parseP=this._parse(e).catch(t=>{throw this.parseP=void 0,t})),this.parseP}async hasRefSeq(e,t={}){return!!((await this.parse(t)).indices[e]||{}).binIndex}}const hDe=21578324,Sz=14;function dDe(n,e){return n+=1,e-=1,[[0,0],[1+(n>>26),1+(e>>26)],[9+(n>>23),9+(e>>23)],[73+(n>>20),73+(e>>20)],[585+(n>>17),585+(e>>17)],[4681+(n>>14),4681+(e>>14)]]}class _N extends Nte{async lineCount(e,t={}){const i=await this.parse(t);if(!i)return-1;const s=i.refNameToId[e];if(!i.indices[s])return-1;const{stats:o}=i.indices[s];return o?o.lineCount:-1}async _parse(e={}){const t=await this.filehandle.readFile(e),i=await P_(t);if(qf(e.signal),i.readUInt32LE(0)!==hDe)throw new Error("Not a TBI file");const s=i.readInt32LE(4),r=i.readInt32LE(8),o=r&65536?"zero-based-half-open":"1-based-closed",l={0:"generic",1:"SAM",2:"VCF"}[r&15];if(!l)throw new Error(`invalid Tabix preset format flags ${r}`);const c={ref:i.readInt32LE(12),start:i.readInt32LE(16),end:i.readInt32LE(20)},u=i.readInt32LE(24),h=5,d=((1<<(h+1)*3)-1)/7,f=2**(14+h*3),g=u?String.fromCharCode(u):null,p=i.readInt32LE(28),m=i.readInt32LE(32),{refNameToId:b,refIdToName:v}=this._parseNameBytes(i.slice(36,36+m));let w=36+m,y;return{indices:new Array(s).fill(0).map(()=>{const D=i.readInt32LE(w);w+=4;const S={};let T;for(let N=0;N<D;N+=1){const z=i.readUInt32LE(w);if(w+=4,z>d+1)throw new Error("tabix index contains too many bins, please use a CSI index");if(z===d+1){const $=i.readInt32LE(w);w+=4,$===2&&(T=this.parsePseudoBin(i,w)),w+=16*$}else{const $=i.readInt32LE(w);w+=4;const q=new Array($);for(let ne=0;ne<$;ne+=1){const de=U0(i,w),me=U0(i,w+8);w+=16,y=this._findFirstData(y,de),q[ne]=new wL(de,me,z)}S[z]=q}}const k=i.readInt32LE(w);w+=4;const I=new Array(k);for(let N=0;N<k;N+=1)I[N]=U0(i,w),w+=8,y=this._findFirstData(y,I[N]);return{binIndex:S,linearIndex:I,stats:T}}),metaChar:g,maxBinNumber:d,maxRefLength:f,skipLines:p,firstDataLine:y,columnNumbers:c,coordinateType:o,format:l,refIdToName:v,refNameToId:b,maxBlockSize:65536}}parsePseudoBin(e,t){return{lineCount:kte(Ite.fromBytesLE(e.slice(t+16,t+24),!0))}}_parseNameBytes(e){let t=0,i=0;const s=[],r={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),s[t]=a,r[a]=t}i=o+1,t+=1}return{refNameToId:r,refIdToName:s}}async blocksForRange(e,t,i,s={}){t<0&&(t=0);const r=await this.parse(s);if(!r)return[];const o=r.refNameToId[e],a=r.indices[o];if(!a)return[];(a.linearIndex.length?a.linearIndex[t>>Sz>=a.linearIndex.length?a.linearIndex.length-1:t>>Sz]:new K6(0,0))||console.warn("querying outside of possible tabix range");const c=dDe(t,i),u=[];for(const[p,m]of c)for(let b=p;b<=m;b++)if(a.binIndex[b]){const v=a.binIndex[b];for(let w=0;w<v.length;++w)u.push(new wL(v[w].minv,v[w].maxv,b))}const h=a.linearIndex.length;let d=null;const f=Math.min(t>>14,h-1),g=Math.min(i>>14,h-1);for(let p=f;p<=g;++p){const m=a.linearIndex[p];m&&(!d||m.compareTo(d)<0)&&(d=m)}return Lte(u,d)}}const fDe=21582659,gDe=38359875;function pDe(n,e){return n*2**e}function xz(n,e){return Math.floor(n/2**e)}class kz extends Nte{constructor(e){super(e),this.maxBinNumber=0,this.depth=0,this.minShift=0}async lineCount(e,t={}){const i=await this.parse(t);if(!i)return-1;const s=i.refNameToId[e];if(!i.indices[s])return-1;const{stats:o}=i.indices[s];return o?o.lineCount:-1}async indexCov(){throw new Error("CSI indexes do not support indexcov")}parseAuxData(e,t){const i=e.readInt32LE(t),s=i&65536?"zero-based-half-open":"1-based-closed",r={0:"generic",1:"SAM",2:"VCF"}[i&15];if(!r)throw new Error(`invalid Tabix preset format flags ${i}`);const o={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},a=e.readInt32LE(t+16),l=a?String.fromCharCode(a):null,c=e.readInt32LE(t+20),u=e.readInt32LE(t+24),{refIdToName:h,refNameToId:d}=this._parseNameBytes(e.slice(t+28,t+28+u));return{refIdToName:h,refNameToId:d,skipLines:c,metaChar:l,columnNumbers:o,format:r,coordinateType:s}}_parseNameBytes(e){let t=0,i=0;const s=[],r={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),s[t]=a,r[a]=t}i=o+1,t+=1}return{refNameToId:r,refIdToName:s}}async _parse(e={}){const t=await P_(await this.filehandle.readFile(e));let i;if(t.readUInt32LE(0)===fDe)i=1;else if(t.readUInt32LE(0)===gDe)i=2;else throw new Error("Not a CSI file");this.minShift=t.readInt32LE(4),this.depth=t.readInt32LE(8),this.maxBinNumber=((1<<(this.depth+1)*3)-1)/7;const s=2**(this.minShift+this.depth*3),r=t.readInt32LE(12),o=r&&r>=30?this.parseAuxData(t,16):{refIdToName:[],refNameToId:{},metaChar:null,columnNumbers:{ref:0,start:1,end:2},coordinateType:"zero-based-half-open",format:"generic"},a=t.readInt32LE(16+r);let l,c=16+r+4;const u=new Array(a).fill(0).map(()=>{const h=t.readInt32LE(c);c+=4;const d={};let f;for(let g=0;g<h;g+=1){const p=t.readUInt32LE(c);if(p>this.maxBinNumber)f=this.parsePseudoBin(t,c+4),c+=4+8+4+16+16;else{const m=U0(t,c+4);l=this._findFirstData(l,m);const b=t.readInt32LE(c+12);c+=16;const v=new Array(b);for(let w=0;w<b;w+=1){const y=U0(t,c),x=U0(t,c+8);c+=16,v[w]=new wL(y,x,p)}d[p]=v}}return{binIndex:d,stats:f}});return{...o,csi:!0,refCount:a,maxBlockSize:65536,firstDataLine:l,csiVersion:i,indices:u,depth:this.depth,maxBinNumber:this.maxBinNumber,maxRefLength:s}}parsePseudoBin(e,t){return{lineCount:kte(Ite.fromBytesLE(e.slice(t+28,t+36),!0))}}async blocksForRange(e,t,i,s={}){t<0&&(t=0);const r=await this.parse(s);if(!r)return[];const o=r.refNameToId[e],a=r.indices[o];if(!a)return[];const l=this.reg2bins(t,i),c=[];for(const[u,h]of l)for(let d=u;d<=h;d++)if(a.binIndex[d]){const f=a.binIndex[d];for(let g=0;g<f.length;++g)c.push(new wL(f[g].minv,f[g].maxv,d))}return Lte(c,new K6(0,0))}reg2bins(e,t){e-=1,e<1&&(e=1),t>2**50&&(t=2**34),t-=1;let i=0,s=0,r=this.minShift+this.depth*3;const o=[];for(;i<=this.depth;r-=3,s+=pDe(1,i*3),i+=1){const a=s+xz(e,r),l=s+xz(t,r);if(l-a+o.length>this.maxBinNumber)throw new Error(`query ${e}-${t} is too large for current binning scheme (shift ${this.minShift}, depth ${this.depth}), try a smaller query or a coarser index binning scheme`);o.push([a,l])}return o}}const bN=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function mDe(n){return new Promise(e=>setTimeout(e,n))}class _De{constructor({path:e,filehandle:t,tbiPath:i,tbiFilehandle:s,csiPath:r,csiFilehandle:o,yieldTime:a=500,chunkSizeLimit:l=5e7,renameRefSeqs:c=h=>h,chunkCacheSize:u=5*2**20}){if(t)this.filehandle=t;else if(e)this.filehandle=new No(e);else throw new TypeError("must provide either filehandle or path");if(s)this.index=new _N({filehandle:s,renameRefSeqs:c});else if(o)this.index=new kz({filehandle:o,renameRefSeqs:c});else if(i)this.index=new _N({filehandle:new No(i),renameRefSeqs:c});else if(r)this.index=new kz({filehandle:new No(r),renameRefSeqs:c});else if(e)this.index=new _N({filehandle:new No(`${e}.tbi`),renameRefSeqs:c});else throw new TypeError("must provide one of tbiFilehandle, tbiPath, csiFilehandle, or csiPath");this.chunkSizeLimit=l,this.renameRefSeq=c,this.yieldTime=a,this.chunkCache=new iT({cache:new L6({maxSize:Math.floor(u/65536)}),fill:(h,d)=>this.readChunk(h,{signal:d})})}async getLines(e,t,i,s){let r,o={},a;if(typeof s>"u")throw new TypeError("line callback must be provided");if(typeof s=="function"?a=s:(o=s,a=s.lineCallback),e===void 0)throw new TypeError("must provide a reference sequence name");if(!a)throw new TypeError("line callback must be provided");const l=await this.index.getMetadata(o);if(qf(r),t||(t=0),i||(i=l.maxRefLength),!(t<=i))throw new TypeError("invalid start and end coordinates. start must be less than or equal to end");if(t===i)return;const c=await this.index.blocksForRange(e,t,i,o);qf(r);for(let h=0;h<c.length;h+=1){const d=c[h].fetchedSize();if(d>this.chunkSizeLimit)throw new Error(`Too much data. Chunk size ${d.toLocaleString()} bytes exceeds chunkSizeLimit of ${this.chunkSizeLimit.toLocaleString()}.`)}let u=Date.now();for(let h=0;h<c.length;h+=1){let d;const f=c[h],{buffer:g,cpositions:p,dpositions:m}=await this.chunkCache.get(f.toString(),f);qf(r);let b=0,v=0;for(;b<g.length;){const w=g.indexOf(`
`,b);if(w===-1)break;const y=g.slice(b,w),x=(bN==null?void 0:bN.decode(y))||y.toString();if(m){for(;b+f.minv.dataPosition>=m[v++];);v--}const{startCoordinate:D,overlaps:S}=this.checkLine(l,e,t,i,x);if(d!==void 0&&D!==void 0&&d>D)throw new Error(`Lines not sorted by start coordinate (${d} > ${D}), this file is not usable with Tabix.`);if(d=D,S)a(x.trim(),p[v]*256+(b-m[v])+f.minv.dataPosition+1);else if(D!==void 0&&D>=i)return;this.yieldTime&&u-Date.now()>this.yieldTime&&(u=Date.now(),qf(r),await mDe(1)),b=w+1}}}async getMetadata(e={}){return this.index.getMetadata(e)}async getHeaderBuffer(e={}){const{firstDataLine:t,metaChar:i,maxBlockSize:s}=await this.getMetadata(e);qf(e.signal);const r=((t==null?void 0:t.blockPosition)||0)+s;let o=await this._readRegion(0,r,e);qf(e.signal);try{o=await P_(o)}catch(a){throw console.error(a),new Error(`error decompressing block ${a.code} at 0 (length ${r}) ${a}`)}if(i){let a=-1;const l=`
`.charCodeAt(0),c=i.charCodeAt(0);for(let u=0;u<o.length&&!(u===a+1&&o[u]!==c);u+=1)o[u]===l&&(a=u);o=o.slice(0,a+1)}return o}async getHeader(e={}){return(await this.getHeaderBuffer(e)).toString("utf8")}async getReferenceSequenceNames(e={}){return(await this.getMetadata(e)).refIdToName}checkLine(e,t,i,s,r){const{columnNumbers:o,metaChar:a,coordinateType:l,format:c}=e;if(r.charAt(0)===a)return{overlaps:!1};let{ref:u,start:h,end:d}=o;u||(u=0),h||(h=0),d||(d=0),c==="VCF"&&(d=8);const f=Math.max(u,h,d);let g=1,p=0,m="",b=-1/0;for(let v=0;v<r.length+1;v+=1)if(r[v]==="	"||v===r.length){if(g===u){if(this.renameRefSeq(r.slice(p,v))!==t)return{overlaps:!1}}else if(g===h){if(b=parseInt(r.slice(p,v),10),l==="1-based-closed"&&(b-=1),b>=s)return{startCoordinate:b,overlaps:!1};if((d===0||d===h)&&b+1<=i)return{startCoordinate:b,overlaps:!1}}else if(c==="VCF"&&g===4)m=r.slice(p,v);else if(g===d){let w;if(c==="VCF"?w=this._getVcfEnd(b,m,r.slice(p,v)):w=parseInt(r.slice(p,v),10),w<=i)return{overlaps:!1}}if(p=v+1,g+=1,g>f)break}return{startCoordinate:b,overlaps:!0}}_getVcfEnd(e,t,i){let s=e+t.length;const r=i.indexOf("SVTYPE=TRA")!==-1;if(i[0]!=="."&&!r){let o=";";for(let a=0;a<i.length;a+=1){if(o===";"&&i.slice(a,a+4)==="END="){let l=i.indexOf(";",a);l===-1&&(l=i.length),s=parseInt(i.slice(a+4,l),10);break}o=i[a]}}else if(r)return e+1;return s}async lineCount(e,t={}){return this.index.lineCount(e,t)}async _readRegion(e,t,i={}){const s=Buffer.alloc(t),{bytesRead:r,buffer:o}=await this.filehandle.read(s,0,t,e,i);return o.slice(0,r)}async readChunk(e,t={}){const i=await this._readRegion(e.minv.blockPosition,e.fetchedSize(),t);try{return SJ(i,e)}catch(s){throw new Error(`error decompressing c ${e.toString()} ${s}`)}}}class bDe extends JC(Hp){constructor(t,i){const s={channel:"x",windowSize:3e6,debounceDomainChange:200,...t};super(i,s.channel);Rn(this,"lastRequestId",0);Rn(this,"tbiIndex");if(this.params=s,!this.params.url)throw new Error("No URL provided for TabixSource");const r=o=>new fc(eS(o,this.view.getBaseUrl()));this.tbiIndex=new _De({filehandle:r(this.params.url),tbiFilehandle:r(this.params.indexUrl??this.params.url+".tbi")}),this.params.debounceDomainChange>0&&(this.onDomainChanged=oS(this.onDomainChanged.bind(this),this.params.debounceDomainChange,!1))}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;const s=this.quantizeInterval(t,i);this.checkAndUpdateLastInterval(s)&&this.doRequest(s)}async doRequest(t){const i=await this.getFeatures(t);i.requestId<this.lastRequestId||this.publishData(i.features)}async getFeatures(t){let i=++this.lastRequestId;const s=new AbortController,r=this.genome.continuousToDiscreteChromosomeIntervals(t),o=await Promise.all(r.map(async a=>{const l=[];return await this.tbiIndex.getLines(a.chrom,a.startPos,a.endPos,{lineCallback:c=>{l.push(c)},signal:s.signal}),this._parseFeatures(l)}));return{requestId:i,abort:()=>s.abort(),features:o.flat()}}_parseFeatures(t){return[]}}class vDe extends bDe{_parseFeatures(e){return oDe.parseStringSync(e.join(`
`),{parseSequences:!1})}}function wDe(n,e){if(MQ(n))return new xwe(n,e);if(kwe(n))return new Lwe(n,e);if(Dwe(n))return new Ewe(n,e);if(yDe(n))return TDe(n.lazy,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function yDe(n){return"lazy"in n}function CDe(n){return(n==null?void 0:n.type)=="axisTicks"}function SDe(n){return(n==null?void 0:n.type)=="axisGenome"}function xDe(n){return(n==null?void 0:n.type)=="indexedFasta"}function kDe(n){return(n==null?void 0:n.type)=="bigwig"}function LDe(n){return(n==null?void 0:n.type)=="bigbed"}function DDe(n){return(n==null?void 0:n.type)=="bam"}function EDe(n){return(n==null?void 0:n.type)=="gff3"}function TDe(n,e){if(CDe(n))return new Awe(n,e);if(SDe(n))return new Iwe(n,e);if(xDe(n))return new PCe(n,e);if(kDe(n))return new Ike(n,e);if(LDe(n))return new Yke(n,e);if(DDe(n))return new CLe(n,e);if(EDe(n))return new vDe(n,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function ADe(n){const e=Object.keys(n).filter(i=>typeof i=="string"),t=new Function("source","return { "+e.map(i=>JSON.stringify(i)).map(i=>`${i}: source[${i}]`).join(`,
`)+" };");return t.properties=e,t}class yL extends Hn{get behavior(){return $c}constructor(){super();const e=t=>{const i=ADe(t);this.handle=s=>this._propagate(i(s)),this.handle(t)};this.handle=e,this.beginBatch=t=>{oQ(t)&&(this.handle=e),super.beginBatch(t)}}}function IDe(n){return"name"in n}var yC;class Rte extends KC{constructor(t,i,s){super();Kt(this,yC,void 0);this.provider=s,this.params=t}get identifier(){return this.params.name}updateDynamicData(t){Qo(this,yC,t),this.loadSynchronously()}loadSynchronously(){const t=nt(this,yC)??this.provider(this.params.name)??[];let i=s=>s;if(Array.isArray(t))t.length>0&&(i=RQ(t[0]));else throw new Error(`Named data "${this.params.name}" is not an array!`);this.reset(),this.beginBatch({type:"file"});for(const s of t)this._propagate(i(s));this.complete()}async load(){this.loadSynchronously()}}yC=new WeakMap;class Mte{constructor(){this._dataSourcesByHost=new Map,this._collectorsByHost=new Map,this._observers=new Map}get dataSources(){return[...new Set(this._dataSourcesByHost.values()).values()]}get collectors(){return[...this._collectorsByHost.values()]}addObserver(e,t){let i=this._observers.get(t);i||(i=[],this._observers.set(t,i)),i.push(e)}_relayObserverCallback(e,t){const i=this._observers.get(t);if(i)for(const s of i)s(e)}addDataSource(e,t){this._dataSourcesByHost.set(t,e)}findDataSourceByKey(e){return this._dataSourcesByHost.get(e)}findNamedDataSource(e){let t,i=[];for(const[s,r]of this._dataSourcesByHost.entries())if(r instanceof Rte&&e==r.identifier){if(t&&t!==r)throw new Error(`Found multiple instances of named data: ${e}. Data flow optimization is broken (it's a bug).`);t=r,i.push(s)}if(t)return{dataSource:t,hosts:i}}addCollector(e,t){this._collectorsByHost.set(t,e),e.observers.push(i=>this._relayObserverCallback(i,t))}findCollectorByKey(e){return this._collectorsByHost.get(e)}initialize(){for(const e of this.dataSources)e.visit(t=>t.initialize())}}function NDe(n,e){const t=new Map,i=[];for(const s of n)t.set(s,{ref:s,children:[]});for(const s of t.values()){const r=t.get(e(s.ref));r?r.children.push(s):i.push(s)}return i}function Fte(n,e,t){var s,r;const i=(s=e.preOrder)==null?void 0:s.call(e,n);if(i)return i;for(const o of t(n)){const a=Fte(o,e,t);if(a==="stop")return a}return(r=e.postOrder)==null?void 0:r.call(e,n)}function RDe(n,e){return Fte(n,e,t=>t.children)}function MDe(n,e){const t=[];let i;const s=e??new Mte,r=[];function o(h,d=()=>{}){if(!i)throw d()||new Error("Cannot append data flow node, no parent exist!");return i.addChild(h),i=h,h}function a(h,d){return o(h,()=>new Error(`Cannot append a transform because no (inherited) data are available! ${d?JSON.stringify(d):""}`))}function l(h,d){for(const f of h){let g;try{g=wwe(f,d)}catch(p){throw console.warn(p),new Error(`Cannot initialize "${f.type}" transform: ${p}`)}g.behavior&vf&&a(new yL),a(g)}}const c=h=>{if(t.push(i),h.spec.data){const d=IDe(h.spec.data)?new Rte(h.spec.data,h,h.context.getNamedDataFromProvider):wDe(h.spec.data,h);i=d,s.addDataSource(d,h)}if(h.spec.transform&&l(h.spec.transform,h),h instanceof Nr){if(!i)throw new Error(`A unit view (${h.getPathString()}) has no (inherited) data source`);const d=FDe(h);if(d){r.push(d.rewrite);for(const g of d.transforms)a(g)}h.mark.isPickingParticipant()&&(a(new yL),a(new IQ({type:"identifier"})));const f=new EQ({type:"collect",groupby:h.getFacetFields(),sort:PDe(h,d==null?void 0:d.rewrittenEncoding)});o(f),s.addCollector(f,h)}},u=NDe(n.getDescendants(),h=>h.dataParent);for(const h of u)RDe(h,{preOrder:d=>c(d.ref),postOrder:()=>{i=t.pop()}});return r.forEach(h=>h()),s}function FDe(n){var r;const e=[],t={},i=[];for(const[o,a]of Object.entries(n.getEncoding())){const l=o;Pw(l)&&qY(a)&&i.push({channel:l,chromPosDef:a})}const s=vE(i,o=>dp(o.channel),o=>o.chromPosDef.chrom);for(const[o,a]of s.entries())for(const[l,c]of a.entries()){const u=[],h=[],d=[];for(const{channel:f,chromPosDef:g}of c){const p=v=>v.replace(/[^A-Za-z0-9_]/g,""),m=["_linearized_",p(g.chrom),"_",p(g.pos)].join(""),b={...((r=n.spec.encoding)==null?void 0:r[f])??n.getEncoding()[f]??{},field:m};delete b.chrom,delete b.pos,!b.type&&g.type&&(b.type=g.type),t[f]=b,u.push(g.pos),d.push(g.offset??0),h.push(m)}e.push(new yL),e.push(new TQ({type:"linearizeGenomicCoordinate",channel:o,chrom:l,pos:u,offset:d,as:h},n))}return e.length?{transforms:e,rewrittenEncoding:t,rewrite:()=>{n.spec.encoding={...n.spec.encoding,...t},eQ(n.mark,"encoding")}}:void 0}function PDe(n,e){var i;const t={...n.getEncoding(),...e}.x;if(aa(t)&&(i=n.getScaleResolution("x"))!=null&&i.isZoomable()){if($C(t))return{field:t.field};if(!zC(t))throw new Error("A zoomable x channel must be mapped to a field.")}}function Pte(n,e=void 0){if(n.parent!==e)return!1;for(const t of n.children)if(!Pte(t,n))return!1;return!0}function I4(n,e=!1){if(n.behavior&l6&&(e=!0),n instanceof yL)if(e)e=!1;else{const t=n.children[0];n.excise(),t&&I4(t,e);return}n.behavior&$c&&(e=!1);for(let t=0,i=n.children.length;t<i;t++)I4(n.children[t],e||i>1)}function ODe(n){const e=[...n._dataSourcesByHost.entries()],t=new Map;for(const i of e){const s=i[1];s.identifier&&!t.has(s.identifier)&&t.set(s.identifier,s)}n._dataSourcesByHost.clear();for(let[i,s]of e){const r=t.get(s.identifier);r&&(r.adoptChildrenOf(s),s=r),n.addDataSource(s,i)}}function BDe(n){if(I4(n),!Pte(n))throw new Error("Encountered a bug! There's a problem in the data flow structure.")}function WDe(n){for(const e of n.dataSources)BDe(e);ODe(n)}function VDe(n){n.visit(t=>{t instanceof Nr&&t.resolve("scale")});const e=new Set;n.visit(t=>{for(const i of Object.values(t.resolutions.scale)){const s=i.name;if(s&&e.has(s))throw new Error(`The same scale name "${s}" occurs in multiple scale resolutions!`);e.add(s)}}),n.visit(t=>{t instanceof Nr&&t.resolve("axis")}),n.visit(t=>t.onScalesResolved())}function $De(n){for(const e of Tb){const t=n.getScaleResolution(e);t&&!t.name&&t.isZoomable()&&(t.name=`${e}_at_root`)}}async function zDe(n,e,t){var o;if(!n.import.url)throw new Error("Cannot import, not an import spec: "+JSON.stringify(n));const i=CE({baseURL:e}),s=n.import.url,r=JSON.parse(await i.load(s).catch(a=>{throw new Error(`Could not load imported view spec: ${s} 
Reason: ${a.message}`)}));if(t.isViewSpec(r))return r.baseUrl=(o=s.match(/^[^?#]*\//))==null?void 0:o[0],r;throw new Error(`The imported spec "${s}" is not a view spec: ${JSON.stringify(n)}`)}async function Ote(n){const e=[];n.visit(t=>{if(t instanceof DQ)return e.push(t),cQ});for(const t of e){const i=t.context,s=await zDe(t.spec,t.getBaseUrl(),i),r=i.createView(s,t.layoutParent,t.dataParent,t.name);t.layoutParent.replaceChild(t,r),await Ote(r)}}function HDe(n){const e=n.getSize().addPadding(n.getOverhang()),t=i=>i.grow>0?void 0:i.px;return{width:t(e.width),height:t(e.height)}}function eu(n){return()=>n}const Kl=class Kl{static create(e,t,i,s){return new Kl(eu(e),eu(t),eu(i),eu(s))}_offset(e,t){const i=this["_"+e];if(t===0)return i;switch(typeof t){case"number":return()=>i()+t;case"function":return()=>i()+t();default:throw new Error("Not a number of function")}}_passThrough(e){return this._offset(e,0)}constructor(e,t,i,s){this._x=e,this._y=t,this._width=i,this._height=s}get x(){return this._x()}get y(){return this._y()}get width(){return this._width()}get height(){return this._height()}get x2(){return this._x()+this._width()}get y2(){return this._y()+this._height()}equals(e){return e?this===e||this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height:!1}modify(e){if(!Object.keys(e).length)return this;const t=i=>{const s=e[i];return typeof s=="number"?eu(s):typeof s=="function"?s:this._passThrough(i)};return new Kl(t("x"),t("y"),t("width"),t("height"))}translate(e,t){return e===0&&t===0?this:new Kl(this._offset("x",e),this._offset("y",t),this._passThrough("width"),this._passThrough("height"))}translateBy(e){return this.translate(e.x,e.y)}expand(e,t=1){return e.left==0&&e.top==0&&e.right==0&&e.bottom==0?this:new Kl(e.left?this._offset("x",-e.left*t):this._passThrough("x"),e.top?this._offset("y",-e.top*t):this._passThrough("y"),e.width?this._offset("width",e.width*t):this._passThrough("width"),e.height?this._offset("height",e.height*t):this._passThrough("height"))}shrink(e){return this.expand(e,-1)}intersect(e){return this===e?this:new Kl(()=>Math.max(this.x,e.x),()=>Math.max(this.y,e.y),()=>Math.min(this.x2,e.x2)-Math.max(this.x,e.x),()=>Math.min(this.y2,e.y2)-Math.max(this.y,e.y))}isDefined(){return this.width>=0&&this.height>=0}flatten(){return new Kl(eu(this.x),eu(this.y),eu(this.width),eu(this.height))}containsPoint(e,t){return e>=this.x&&e<this.x2&&t>=this.y&&t<this.y2}normalizePoint(e,t){return{x:(e-this.x)/this.width,y:(t-this.y)/this.height}}toString(){return`Rectangle: x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height}`}toRoundedString(){return`Rectangle: x: ${Math.round(this.x)}, y: ${Math.round(this.y)}, width: ${Math.round(this.width)}, height: ${Math.round(this.height)}`}};Rn(Kl,"ZERO",Kl.create(0,0,0,0));let ny=Kl;class Bte{constructor(e){this.globalOptions=e}pushView(e,t){}popView(e){}renderMark(e,t){}}class Lz extends Bte{constructor(e,t){super(e),this.webGLHelper=t,this.buffer=[],this.coords=void 0,this.views=new Set}pushView(e,t){this.views.add(e),this.coords=t}renderMark(e,t){if(this.globalOptions.picking&&!e.isPickingParticipant())return;const i=e.render(t);i&&this.buffer.push({mark:e,callback:i,coords:this.coords,clipRect:t.clipRect})}render(){if(this.batch||this._buildBatch(),this.batch.length==0)return;const e=this.webGLHelper.gl,t=this.globalOptions.picking;e.bindFramebuffer(e.FRAMEBUFFER,t?this.webGLHelper._pickingBufferInfo.framebuffer:null),this.webGLHelper.clearAll();for(const i of this.views)i.onBeforeRender();for(const i of this.batch)i();t&&e.bindFramebuffer(e.FRAMEBUFFER,null)}_buildBatch(){this.batch=[];let e=!0,t=!0;const i=o=>()=>{e&&o()},s=o=>()=>{e&&t&&o()},r=vE(this.buffer.reverse(),o=>o.mark);for(const[o,a]of[...r.entries()].reverse()){if(!o.isReady())continue;this.batch.push(()=>{e=o.unitView.getEffectiveOpacity()>0}),this.batch.push(...o.prepareRender(this.globalOptions).map(c=>i(c)));let l;for(const c of a){const u=c.coords;u.equals(l)||this.batch.push(i(()=>{t=o.setViewport(u,c.clipRect)})),this.batch.push(s(c.callback)),l=c.coords}}}}class UDe extends Bte{constructor(...e){super({}),this.contexts=e}pushView(e,t){for(const i of this.contexts)i.pushView(e,t)}popView(e){for(const t of this.contexts)t.popView(e)}renderMark(e,t){for(const i of this.contexts)i.renderMark(e,t)}}class jDe{constructor(e,t){this.point=e,this.uiEvent=t,this.stopped=!1,this.target=void 0}stopPropagation(){this.stopped=!0}get type(){return this.uiEvent.type}}class qDe{constructor(e,t){this.x=e,this.y=t}equals(e){return e?e===this||e.x===this.x&&e.y===this.y:!1}}const GDe=n=>new Promise(e=>setTimeout(e,n));function KDe(n){const e=n.requestAnimationFrame||window.requestAnimationFrame,t=n.signal,i=()=>new Promise((s,r)=>{if(t!=null&&t.aborted)return r("aborted");const o=performance.now(),a=o+(n.duration||1e3),l=typeof n.from=="number"?n.from:0,c=typeof n.to=="number"?n.to:1,u=n.easingFunction||(p=>p),h=p=>(p-o)/(a-o),d=p=>p*(c-l)+l,f=p=>Math.max(0,Math.min(1,p)),g=p=>{t!=null&&t.aborted?r("aborted"):(n.onUpdate(d(u(f(h(p))))),p<a?e(g):(n.onUpdate(d(u(1))),s()))};e(g)});return n.delay?t!=null&&t.aborted?Promise.reject("aborted"):GDe(n.delay).then(i):i()}class ZDe{constructor(e){this._renderCallback=e,this._renderRequested=!1,this._warn=!1,this.transitions=[]}requestTransition(e){this.cancelTransition(e),this.transitions.push(e),this.requestRender()}cancelTransition(e){const t=this.transitions.indexOf(e);t>=0&&this.transitions.splice(t,1)}requestRender(){this._renderRequested?this._warn&&console.warn("Render already requested!"):(this._renderRequested=!0,window.requestAnimationFrame(e=>{this._renderRequested=!1;const t=this.transitions;this.transitions=[];let i;for(;i=t.shift();)i(e);this._renderCallback(e)}))}transition(e){return KDe({requestAnimationFrame:t=>this.requestTransition(t),...e})}}class YDe{constructor(e){this.genomes=new Map,this.baseUrl=e}async initialize(e){const t=new Ive(e);return this.genomes.set(t.name,t),Promise.all([...this.genomes.values()].map(i=>i.load(this.baseUrl)))}getGenome(e){if(!this.genomes.size)throw new Error("No genomes have been configured!");if(e){const t=this.genomes.get(e);if(!t)throw new Error(`No genome with the name ${e} has been configured!`);return t}else{if(this.genomes.size>1)throw new Error("Cannot pick a default genome! More than one have been configured!");return this.genomes.values().next().value}}}const XDe=""+new URL("Lato-Regular-e459d1f9.png",import.meta.url).href,QDe={thin:100,light:300,regular:400,normal:400,medium:500,bold:700,black:900};class JDe{constructor(e){this._webGLHelper=e,this.fontRepository="https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/",this._fonts=new rp([],JSON.stringify),this._metadataPromises=new Map,this._fontPromises=new Map,this._promises=[],this._defaultFontEntry={metrics:GM(AQ),texture:e?this._createTextureNow(XDe):void 0}}async waitUntilReady(){await Promise.all(this._promises)}getFont(e,t="normal",i="regular"){if(wn(i)&&(i=QDe[i.toLowerCase()],!i))throw new Error("Unknown font weight: "+i);const s={family:e,style:t,weight:i};let r=this._fonts.get(s);return r||(r={metrics:void 0,texture:void 0},this._fonts.set(s,r),this._promises.push(this._loadFontEntry(r,s))),r}async _loadFontEntry(e,t){try{const i=await this._loadMetadata(t.family),s=tEe(i,t),r=this.fontRepository+Dz(t.family)+"/"+s.replace(/\.\w+/,""),o=this._createTexture(r+".png"),a=this._loadFont(r+".json");e.texture=await o,e.metrics=await a}catch(i){console.log("Cannot load font. Using default.",i),e.metrics=this._defaultFontEntry.metrics,e.texture=this._defaultFontEntry.texture}}_loadFont(e){let t=this._fontPromises.get(e);return t||(t=fetch(e).then(i=>{if(!i.ok)throw new Error("Could not load font: "+i.status);return i}).then(i=>i.json()).then(i=>GM(i)),this._fontPromises.set(e,t)),t}_loadMetadata(e){const t=Dz(e);let i=this._metadataPromises.get(t);return i||(i=fetch(this.fontRepository+t+"/METADATA.pb").then(s=>{if(!s.ok)throw new Error("Could not load font metadata: "+s.status);return s}).then(s=>s.text()).then(s=>eEe(s)).catch(s=>{console.warn(s)}),this._metadataPromises.set(t,i)),i}getDefaultFont(){return this._defaultFontEntry}_createTexture(e){const t=this._webGLHelper.gl;return new Promise((i,s)=>{Ww(t,{src:e,min:t.LINEAR},(r,o,a)=>{r?s(r):i(o)})})}_createTextureNow(e){const t=this._webGLHelper.gl;let i;const s=new Promise((r,o)=>{i=Ww(t,{src:e,min:t.LINEAR},(a,l,c)=>{a?o(a):r(l)})});return this._promises.push(s),i}}function Dz(n){return n.toLowerCase().replaceAll(/[^\w]/g,"")}function eEe(n){const e=n.split(`
`),t=[];let i;for(const s of e)if(s.startsWith("fonts {")&&(i={name:void 0,style:void 0,weight:void 0,filename:void 0,post_script_name:void 0,full_name:void 0,copyright:void 0}),s.startsWith("}")&&(t.push(i),i=void 0),i){let r=s.match(/^\s*([A-Za-z_]+):[ ]?"(.*)"$/);if(r){const o=r[1];i[o]=r[2]}if(r=s.match(/^\s*([A-Za-z_]+):[ ]?(\d+)$/),r){const o=r[1];i[o]=+r[2]}}return t}function tEe(n,e){let t,i=Number.POSITIVE_INFINITY;for(const s of n)if(e.family.localeCompare(s.name,void 0,{sensitivity:"accent"})==0&&e.style==s.style){const r=Math.abs(e.weight-s.weight);r<i&&(i=r,t=s)}return t==null?void 0:t.filename}function iEe(n,e){const t=[];let i;for(const s of n.split(`
`))if(s.startsWith(">"))i={identifier:s.match(/>(\S+)/)[1],sequence:""},t.push(i);else if(i)i.sequence+=s.trim();else throw new Error("Invalid fasta file!");return t}class nEe{constructor(e,t){this.animator=e,this.disabled=!!t,this.damping=.015,this.acceleration=.3,this.accelerationThreshold=100,this.lowerLimit=.5,this.loop=!1,this.momentum=0,this.timestamp=0,this.callback=null,this._transitionCallback=this.animate.bind(this),this.clear()}clear(){this.momentum=0,this.timestamp=null,this.loop=null,this.callback=null}cancel(){this.loop&&(this.animator.cancelTransition(this._transitionCallback),this.clear())}setMomentum(e,t){if(this.disabled){t(e);return}e*this.momentum<0?this.momentum=0:Math.abs(e)>this.accelerationThreshold?this.momentum=zue([this.momentum,e],this.acceleration):this.momentum=e,this.callback=t,this.loop||this.animate()}animate(e){this.callback(this.momentum);const t=e-this.timestamp||0;this.timestamp=e;const i=Math.abs(this.momentum);this.momentum=Math.sign(this.momentum)*Math.max(0,i-((i*this.damping)**1.5+.04)*t),Math.abs(this.momentum)>this.lowerLimit?(this.loop=!0,this.animator.requestTransition(this._transitionCallback)):this.clear()}}function sEe(n){const e={},t=["string","number","boolean"],i=["wheelDelta","wheelDeltaX","wheelDeltaY"];for(const s in n){const r=s;!i.includes(s)&&t.includes(typeof n[r])&&(e[r]=n[r])}return e}const Ez=new Map;async function rEe(n,e,t){const i=n.symbol;let s=Ez.get(i)??await lEe(n.symbol);return s?(Ez.set(i,s),Lu`
            <div class="title">
                <strong>${s.name}</strong>
                ${s.description}
            </div>
            <p class="summary">${s.summary}</p>
            <p class="source">Source: NCBI RefSeq Gene</p>
        `):null}async function oEe(n){console.log("Searching: "+n);const e={mode:"cors"},i=(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=gene&term=${n}[GENE]&sort=relevance&retmode=json`,e).then(s=>s.json())).esearchresult.idlist[0];return i?(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&id=${i}&retmode=json`,e).then(o=>o.json())).result[i]:null}const aEe=oS(oEe,500);function lEe(n){return aEe(n)}const cEe=js(".4~r"),uEe=js(".4~e");function Wte(n){return n==null?Lu` <span class="na">NA</span> `:wn(n)?n.substring(0,30):Number.isInteger(n)?""+n:bo(n)?Math.abs(n)>Math.pow(10,8)||Math.abs(n)<Math.pow(10,-8)?uEe(n):cEe(n):mE(n)?n?"True":"False":jo(n)?Lu`${n.map((e,t)=>[Wte(e),t<n.length-1?", ":as])}`:"?"+typeof n+" "+n}async function hEe(n,e,t){const i=(l,c)=>{var u;for(const[h,d]of Object.entries(e.encoders))if((u=d==null?void 0:d.accessor)!=null&&u.fields.includes(l))switch(h){case"color":case"fill":case"stroke":return Lu`
                            <span
                                class="color-legend"
                                style=${`background-color: ${d(c)}`}
                            ></span>
                        `}return""},s=Object.entries(n).filter(([l,c])=>!l.startsWith("_"));if(s.length===0)return;const r=Lu`
        <table class="attributes">
            ${s.map(([l,c])=>Lu`
                    <tr>
                        <th>${l}</th>
                        <td>${Wte(c)} ${i(l,n)}</td>
                    </tr>
                `)}
        </table>
    `,o=e.unitView.getTitleText(),a=o?Lu`
              <div class="title">
                  <strong>${o}</strong>
              </div>
          `:"";return Lu`${a}${r}`}class lS extends F_{constructor(e,t,i,s,r){super(e,t,i,s,r),this.spec=e,this.children=(e.layer||[]).map((o,a)=>{if(Yte(o)||Zte(o))return t.createView(o,this,this,"layer"+a);throw new Error("LayerView accepts only unit or layer specs as children!")}),this.needsAxes={x:!0,y:!0}}*[Symbol.iterator](){for(const e of this.children)yield e}render(e,t,i={}){if(this.isConfiguredVisible()){e.pushView(this,t);for(const s of this.children)s.render(e,t,i);e.popView(this)}}propagateInteractionEvent(e){this.handleInteractionEvent(void 0,e,!0);for(let t=this.children.length-1;t>=0;t--)if(this.children[t].propagateInteractionEvent(e),e.stopped)return;this.handleInteractionEvent(void 0,e,!1)}}class Tz{constructor(e,t){this.n=e,this.maxCols=t??1/0}get nRows(){return this.maxCols==1/0?1:Math.ceil(this.n/this.maxCols)}get nCols(){return Math.min(this.n,this.maxCols)}get rowIndices(){const e=[],t=this.nCols,i=this.nRows;for(let s=0;s<i;s++){const r=[];e.push(r);for(let o=0;o<t;o++){const a=s*t+o;a<this.n&&r.push(a)}}return e}get colIndices(){const e=[],t=this.nCols,i=this.nRows;for(let s=0;s<t;s++){const r=[];e.push(r);for(let o=0;o<i;o++){const a=o*t+s;a<this.n&&r.push(a)}}return e}getCellIndex(e,t){let i=0;if(this.maxCols==1/0)i=t==0?e:void 0;else{if(e>=this.maxCols)return;i=t*this.nCols+e}return i<this.n?i:void 0}getCellCoords(e){if(!(e<0||e>=this.n))return[e%this.nCols,Math.floor(e/this.nCols)]}}const dEe="chromosome_ticks_and_labels",fEe={x:"width",y:"height"};function N4(n){return n=="x"?"y":"x"}const CL={x:["bottom","top"],y:["left","right"]},Z6=Object.fromEntries(Object.entries(CL).map(([n,e])=>e.map(t=>[t,n])).flat(1));function Yd(n){return Z6[n]}class Vte extends lS{constructor(e,t,i,s,r){const o=t=="locus",a={...o?pEe:$te,...gEe(t,e),...e};super(o?mEe(a,t):zte(a,t),i,s,r,`axis_${e.orient}`),this.axisProps=a,this.blockEncodingInheritance=!0,this.contributesToScaleDomain=!1}getSize(){const e={px:this.getPerpendicularSize()},t={grow:1};return Z6[this.axisProps.orient]=="x"?new fp(t,e):new fp(e,t)}getPerpendicularSize(){return Y6(this.axisProps)}isPickingSupported(){return!1}}function Y6(n){const e=Yd(n.orient);let t=n.ticks&&n.tickSize||0;return n.labels&&(t+=n.labelPadding,e=="x"?t+=n.labelFontSize:t+=30),n.title&&(t+=n.titlePadding+n.titleFontSize),t=Math.min(n.maxExtent||1/0,Math.max(n.minExtent||0,t)),t}const $te={values:null,minExtent:20,maxExtent:1/0,offset:0,domain:!0,domainWidth:1,domainColor:"gray",domainDash:null,domainDashOffset:0,domainCap:"square",ticks:!0,tickSize:5,tickWidth:1,tickColor:"gray",tickDash:null,tickDashOffset:0,tickCap:"square",tickCount:null,tickMinStep:null,labels:!0,labelAlign:"center",labelBaseline:"middle",labelPadding:4,labelFontSize:10,labelLimit:180,labelColor:"black",format:null,titleColor:"black",titleFont:"sans-serif",titleFontSize:10,titlePadding:3};function gEe(n,e){const t=e.orient,i=n=="nominal"||n=="ordinal";let s="center",r="middle",o=e.labelAngle??((t=="top"||t=="bottom")&&i?-90:0);switch(t){case"left":s="right";break;case"right":s="left";break;case"top":case"bottom":Math.abs(o)>30?(s=o>0==(t=="bottom")?"left":"right",r="middle"):r=t=="top"?"alphabetic":"top";break}return{labelAlign:s,labelAngle:o,labelBaseline:r}}function zte(n,e){const t={...n,extent:Y6(n)},i=Yd(t.orient),s=N4(i),r=t.orient=="bottom"||t.orient=="right"?1:-1,o=t.orient=="bottom"||t.orient=="left"?1:0,a=()=>({name:"domain",data:{values:[0]},mark:{type:"rule",clip:!1,strokeDash:t.domainDash,strokeCap:t.domainCap,color:t.domainColor,[s]:o,size:t.domainWidth}}),l=()=>({name:"labels",mark:{type:"text",clip:!1,align:t.labelAlign,angle:t.labelAngle,baseline:t.labelBaseline,[s+"Offset"]:(t.tickSize+t.labelPadding)*r,[s]:o,size:t.labelFontSize,color:t.labelColor,minBufferSize:1500},encoding:{[i]:{field:"value",type:e},text:{field:"label"}}}),c=()=>({name:"ticks",mark:{type:"rule",clip:!1,strokeDash:t.tickDash,strokeCap:t.tickCap,color:t.tickColor,size:t.tickWidth,minBufferSize:300},encoding:{[s]:{value:o},[s+"2"]:{value:o-t.tickSize/t.extent*(o?1:-1)}}}),u=()=>({name:"title",data:{values:[0]},mark:{type:"text",clip:!1,align:"center",baseline:t.orient=="bottom"?"bottom":"top",angle:[0,90,0,-90][["top","right","bottom","left"].indexOf(t.orient)],text:t.title,color:t.titleColor,[i]:.5,[s]:1-o}}),h=()=>{const f={name:"ticks_and_labels",encoding:{[i]:{field:"value",type:e}},layer:[]};return t.ticks&&f.layer.push(c()),t.labels&&f.layer.push(l()),f},d={resolve:{scale:{[i]:"forced"}},[fEe[N4(i)]]:t.extent,data:{lazy:{type:"axisTicks",channel:i,axis:n}},layer:[]};return t.domain&&d.layer.push(a()),(t.ticks||t.labels)&&d.layer.push(h()),t.title&&d.layer.push(u()),d}const pEe={...$te,chromTicks:!0,chromTickSize:18,chromTickWidth:1,chromTickColor:"#989898",chromTickDash:[4,2],chromTickDashOffset:1,chromLabels:!0,chromLabelFontSize:13,chromLabelFontWeight:"normal",chromLabelFontStyle:"normal",chromLabelColor:"black",chromLabelAlign:"left",chromLabelPadding:7};function mEe(n,e){const t={...n,extent:Y6(n)},i=Yd(t.orient),s=N4(i),r=t.orient=="bottom"||t.orient=="left"?1:0,o=()=>({name:"chromosome_ticks",mark:{type:"rule",strokeDash:n.chromTickDash,strokeDashOffset:n.chromTickDashOffset,[s]:r,[s+"2"]:r-t.chromTickSize/t.extent*(r?1:-1),color:n.chromTickColor,size:t.chromTickWidth}}),a=()=>{let u;switch(t.orient){case"top":u={y:0,angle:0,paddingX:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"bottom":u={y:1,angle:0,paddingX:4,dy:t.chromLabelPadding+t.chromLabelFontSize*.73,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"left":u={x:1,angle:-90,paddingY:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthBottom:20,viewportEdgeFadeWidthTop:20,viewportEdgeFadeDistanceBottom:-20,viewportEdgeFadeDistanceTop:-10};break;case"right":u={x:0,angle:90,align:"right",paddingY:4,dy:-t.chromLabelPadding};break;default:u={}}return{name:"chromosome_labels",mark:{type:"text",size:t.chromLabelFontSize,font:t.chromLabelFont,fontWeight:t.chromLabelFontWeight,fontStyle:t.chromLabelFontStyle,color:t.chromLabelColor,align:n.chromLabelAlign,baseline:"alphabetic",clip:!1,...u},encoding:{[i+"2"]:{field:"continuousEnd",type:e},text:{field:"name"}}}};let l;switch(t.orient){case"bottom":case"top":l={};break;case"left":l={labelAngle:-90,labelAlign:"center",labelPadding:6};break;case"right":l={labelAngle:90,labelAlign:"center",labelPadding:6};break;default:l={}}const c=zte({...n,...l},e);if(n.chromTicks||n.chromLabels){const u={name:dEe,data:{lazy:{type:"axisGenome",channel:Yd(t.orient)}},encoding:{[i]:{field:"continuousStart",type:e,band:0}},layer:[]};if(n.chromTicks&&u.layer.push(o()),n.chromLabels){u.layer.push(a());let h;c.layer.filter(d=>d.name=="ticks_and_labels").forEach(d=>d.layer.filter(f=>f.name=="labels").forEach(f=>{h=f.mark})),h&&(t.orient=="top"||t.orient=="bottom"?(h.viewportEdgeFadeWidthLeft=30,h.viewportEdgeFadeDistanceLeft=40):(h.viewportEdgeFadeWidthBottom=30,h.viewportEdgeFadeDistanceBottom=40))}c.layer.push(u)}return c}class _Ee extends lS{constructor(e,t,i,s,r){const a={...t=="locus"?bEe:Hte,...e};super(CEe(a,t),i,s,r,`axisGrid_${e.orient}`),this.axisProps=a,this.blockEncodingInheritance=!0,this.contributesToScaleDomain=!1}getOrient(){return this.axisProps.orient}isPickingSupported(){return!1}}const Hte={values:null,grid:!1,gridCap:"butt",gridColor:"lightgray",gridDash:null,gridOpacity:1,gridWidth:1,tickCount:null,tickMinStep:null},bEe={...Hte,chromGrid:!1,chromGridCap:"butt",chromGridColor:"gray",chromGridDash:[1,5],chromGridOpacity:1,chromGridWidth:1};function vEe(n,e){const t=n,i=Yd(t.orient);return{name:"grid_lines",data:{lazy:{type:"axisTicks",channel:i,axis:n}},mark:{type:"rule",strokeDash:t.gridDash,strokeCap:t.gridCap,color:t.gridColor,size:t.gridWidth,opacity:t.gridOpacity,minBufferSize:300},encoding:{[i]:{field:"value",type:e}}}}function wEe(n,e){const t=n,i=Yd(t.orient);return{name:"chromosome_lines",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rule",strokeDash:t.chromGridDash,strokeCap:t.chromGridCap,color:t.chromGridColor,size:t.chromGridWidth,opacity:t.chromGridOpacity},encoding:{[i]:{field:"continuousStart",type:e,band:0}}}}function yEe(n,e){const t=n,i=Yd(t.orient);return{name:"chromosome_fill",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rect"},encoding:{[i]:{field:"continuousStart",type:e,band:0},[i+"2"]:{field:"continuousEnd",band:0},fill:{field:"odd",type:"nominal",scale:{domain:[!1,!0],range:[t.chromGridFillEven??"white",t.chromGridFillOdd??"white"]}},opacity:{field:"odd",type:"nominal",scale:{type:"ordinal",domain:[!1,!0],range:[t.chromGridFillEven?1:0,t.chromGridFillOdd?1:0]}}}}}function CEe(n,e){const t={...n},i=[];return t.chromGrid&&(t.chromGridFillOdd||t.chromGridFillEven)&&i.push(yEe(t,e)),t.chromGrid&&t.chromGridOpacity>0&&i.push(wEe(t,e)),t.grid&&t.gridOpacity>0&&i.push(vEe(t,e)),{name:"grid_layers",configurableVisibility:!1,resolve:{scale:{[Yd(n.orient)]:"forced",fill:"independent",opacity:"independent"}},layer:i}}const Az={anchor:"middle",frame:"group",offset:10,orient:"top",align:void 0,angle:0,baseline:"alphabetic",dx:0,dy:0,color:void 0,font:void 0,fontSize:12,fontStyle:"normal",fontWeight:"normal"},SEe={orient:"left",anchor:"middle",align:"right",baseline:"middle",angle:0,fontSize:12},xEe={orient:"top",anchor:"start",align:"left",baseline:"top",offset:-10,dx:10,fontSize:12},kEe={start:0,middle:.5,end:1},LEe={start:"left",middle:"center",end:"right"};function DEe(n){if(!n)return;const e=wn(n)?{text:n}:n;if(!e.text||e.orient=="none")return;const t={"track-title":SEe,overlay:xEe}[e.style]??{},i={...Az,...t,...e};let s={},r={x:0,y:0};const o=kEe[i.anchor??"middle"];switch(i.orient){case"top":r={x:o,y:1},s={baseline:"alphabetic",angle:0};break;case"right":r={x:1,y:1-o},s={baseline:"alphabetic",angle:90};break;case"bottom":r={x:o,y:0},s={baseline:"top",angle:0};break;case"left":r={x:0,y:o},s={baseline:"alphabetic",angle:-90};break}const a={...Az,...s,...t,...e},l={xOffset:0,yOffset:0};switch(i.orient){case"top":l.yOffset=-a.offset;break;case"right":l.xOffset=a.offset;break;case"bottom":l.yOffset=a.offset;break;case"left":l.xOffset=-a.offset;break}return{configurableVisibility:!1,data:{values:[{}]},mark:{type:"text",tooltip:null,clip:!1,...r,...l,text:a.text,align:a.align??LEe[a.anchor],angle:a.angle,baseline:a.baseline,dx:a.dx,dy:a.dy,color:a.color,font:a.font,size:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight}}}function EEe(n,e,t,i){if(n.type=="wheel"){n.uiEvent.preventDefault();const s=n.uiEvent,r=s.deltaMode?120:1;let{x:o,y:a}=n.point;if(i){const l=i.mark.encoders;l.x&&!l.x2&&!l.x.constantValue&&(o=+l.x(i.datum)*e.width+e.x),l.y&&!l.y2&&!l.y.constantValue&&(a=(1-+l.y(i.datum))*e.height+e.y)}Math.abs(s.deltaX)<Math.abs(s.deltaY)?t({x:o,y:a,xDelta:0,yDelta:0,zDelta:s.deltaY*r/300}):t({x:o,y:a,xDelta:-s.deltaX*r,yDelta:0,zDelta:0})}else if(n.type=="mousedown"&&n.uiEvent.button===0){const s=n.uiEvent;s.preventDefault();let r=s;const o=l=>{t({x:r.clientX,y:r.clientY,xDelta:l.clientX-r.clientX,yDelta:l.clientY-r.clientY,zDelta:0}),r=l},a=l=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a)};document.addEventListener("mouseup",a,!1),document.addEventListener("mousemove",o,!1)}}var v_,w_,Do,Mg,y_,xu,Gf,iE,jte,nE,qte,Fg,ev,CC,R4,SC,M4,xC,F4,sE,Gte,C_,H2,rE,Kte;class Ute extends F_{constructor(t,i,s,r,o,a){super(t,i,s,r,o);Kt(this,xu);Kt(this,iE);Kt(this,nE);Kt(this,Fg);Kt(this,CC);Kt(this,SC);Kt(this,xC);Kt(this,sE);Kt(this,C_);Kt(this,rE);Kt(this,v_,1/0);Kt(this,w_,10);Kt(this,Do,[]);Kt(this,Mg,{});Kt(this,y_,0);this.spec=t,Qo(this,w_,t.spacing??10),Qo(this,v_,a),Qo(this,Do,[]),this.wrappingFacet=!1,this._createChildren()}_createChildren(){}appendChild(t){t.layoutParent??(t.layoutParent=this),nt(this,Do).push(new Nz(t,this,nt(this,y_))),E9(this,y_)._++}setChildren(t){Qo(this,Do,[]);for(const i of t)this.appendChild(i)}replaceChild(t,i){const s=nt(this,Do).findIndex(r=>r.view==t);if(s>=0)nt(this,Do)[s]=new Nz(i,this,nt(this,y_));else throw new Error("Not my child view!")}get children(){return nt(this,Do).map(t=>t.view)}get childCount(){return nt(this,Do).length}onScalesResolved(){super.onScalesResolved(),Pt(this,nE,qte).call(this)}*[Symbol.iterator](){for(const t of nt(this,Do))yield*t.getChildren();for(const t of Object.values(nt(this,Mg)))yield t}getOverhang(){return Pt(this,sE,Gte).call(this).union(Pt(this,C_,H2).call(this))}getSize(){return this._cache("size",()=>new fp(Pt(this,SC,M4).call(this,"column"),Pt(this,SC,M4).call(this,"row")).addPadding(Pt(this,C_,H2).call(this)))}render(t,i,s={}){if(!this.isConfiguredVisible())return;this.layoutParent||(i=i.shrink(this.getPadding())),i=i.shrink(Pt(this,C_,H2).call(this)),t.pushView(this,i);const r={devicePixelRatio:this.context.devicePixelRatio},o=HW(Pt(this,CC,R4).call(this,"column"),i.width,r),a=HW(Pt(this,CC,R4).call(this,"row"),i.height,r),l=new Tz(nt(this,xu,Gf).length,nt(this,v_)??1/0);for(const[c,u]of nt(this,xu,Gf).entries()){const{view:h,axes:d,gridLines:f,background:g,backgroundStroke:p,title:m}=u,[b,v]=l.getCellCoords(c),w=o[Pt(this,xC,F4).call(this,"column",b)],y=a[Pt(this,xC,F4).call(this,"row",v)],x=h.getSize(),D=h.getOverhang(),S=w.location-D.left,T=y.location-D.top,k=(x.width.grow?w.size:x.width.px)+D.width,I=(x.height.grow?y.size:x.height.px)+D.height,N=new ny(()=>i.x+S,()=>i.y+T,()=>k,()=>I);u.coords=N;const z=s.clipRect?N.intersect(s.clipRect):N;g==null||g.render(t,z,{...s,clipRect:void 0});for(const q of Object.values(f))q.render(t,N,s);const $=NEe(h);$&&h.render(t,N,s),p==null||p.render(t,z,{...s,clipRect:void 0});for(const[q,ne]of Object.entries(d))ne.render(t,Iz(N,q,ne),s);for(const q of Object.values(nt(this,Mg))){const de=q.axisProps.orient;(de=="left"&&b==0||de=="right"&&b==l.nCols-1||de=="top"&&v==0||de=="bottom"&&v==l.nRows-1)&&q.render(t,Iz(N.shrink(u.view.getOverhang()),de,q),s)}$||h.render(t,N,s),m==null||m.render(t,N,s)}t.popView(this)}propagateInteractionEvent(t){if(this.handleInteractionEvent(void 0,t,!0),t.stopped)return;const i=nt(this,xu,Gf).find(r=>r.coords.containsPoint(t.point.x,t.point.y)),s=i==null?void 0:i.view;s&&(s.propagateInteractionEvent(t),(s instanceof Nr||s instanceof lS)&&EEe(t,i.coords,r=>Pt(this,rE,Kte).call(this,i.coords,i.view,r),this.context.getCurrentHover())),!t.stopped&&this.handleInteractionEvent(void 0,t,!1)}getDefaultResolution(t,i){return"independent"}}v_=new WeakMap,w_=new WeakMap,Do=new WeakMap,Mg=new WeakMap,y_=new WeakMap,xu=new WeakSet,Gf=function(){return nt(this,Do).filter(t=>t.view.isConfiguredVisible())},iE=new WeakSet,jte=function(){return new Tz(nt(this,xu,Gf).length,nt(this,v_)??1/0)},nE=new WeakSet,qte=function(){for(const t of Tb){const i=this.resolutions.axis[t];if(i){const s=i.getAxisProps();if(s){const r={title:i.getTitle(),orient:CL[t][0],...s},o=new Vte(r,i.scaleResolution.type,this.context,this,this);nt(this,Mg)[t]=o,o.visit(a=>{a instanceof Nr&&a.resolve("scale")})}}}for(const t of nt(this,Do))t.createAxes()},Fg=new WeakSet,ev=function(t){const i=t=="column"?"width":"height",s=(r,o)=>r.map(a=>{const c=nt(this,xu,Gf)[a].getOverhangAndPadding();return t=="column"?o?c.right:c.left:o?c.bottom:c.top}).reduce((a,l)=>Math.max(a,l),0);return this._cache(`size/directionSizes/${t}`,()=>nt(this,iE,jte)[t=="column"?"colIndices":"rowIndices"].map(r=>({axisBefore:s(r,0),axisAfter:s(r,1),view:Q1e(r.map(o=>nt(this,xu,Gf)[o].view.getSize()[i]))})))},CC=new WeakSet,R4=function(t){const i=Pt(this,Fg,ev).call(this,t),s=[];s.push(Iv);for(const[r,o]of i.entries())r>0&&s.push({px:nt(this,w_),grow:0}),(r==0||this.wrappingFacet)&&s.push(Iv),s.push({px:o.axisBefore,grow:0}),s.push(o.view),s.push({px:o.axisAfter,grow:0}),(r==i.length-1||this.wrappingFacet)&&s.push(Iv);return s},SC=new WeakSet,M4=function(t){let i=0,s=0;const r=(t=="row"&&this.spec.height)??(t=="column"&&this.spec.width);if(r||r===0)return lQ(r);const o=Pt(this,Fg,ev).call(this,t);for(const[a,l]of o.entries())a>0&&(s+=nt(this,w_)),(a==0||this.wrappingFacet)&&(s+=0),s+=l.axisBefore,s+=l.view.px??0,i+=l.view.grow??0,s+=l.axisAfter,(a==o.length-1||this.wrappingFacet)&&(s+=0);return{px:s,grow:i}},xC=new WeakSet,F4=function(t,i){return t=="row"&&this.wrappingFacet?1+6*i+2:2+4*i+1},sE=new WeakSet,Gte=function(){const t=Pt(this,Fg,ev).call(this,"column"),i=Pt(this,Fg,ev).call(this,"row");return!t.length||!i.length?rr.zero():new rr(i.at(0).axisBefore,t.at(-1).axisAfter,i.at(-1).axisAfter,t.at(0).axisBefore)},C_=new WeakSet,H2=function(){const t=i=>{const s=Z6[i],r=nt(this,Mg)[s];return(r==null?void 0:r.axisProps.orient)!==i?0:Math.max(r.getPerpendicularSize()+r.axisProps.offset,0)};return new rr(t("top"),t("right"),t("bottom"),t("left"))},rE=new WeakSet,Kte=function(t,i,s){for(const[r,o]of Object.entries(IEe(i))){if(o.size<=0)continue;const a=t.normalizePoint(s.x,s.y),l=t.normalizePoint(s.x+s.xDelta,s.y+s.yDelta),c={x:l.x-a.x,y:l.y-a.y};for(const u of o)u.zoom(2**s.zDelta,r=="y"?1-a[r]:a[r],r=="x"?c.x:-c.y)}this.context.animator.requestRender()};function TEe(n){if(!(!n||!n.fill||n.fillOpacity===0))return{configurableVisibility:!1,data:{values:[{}]},mark:{color:n.fill,opacity:n.fillOpacity??1,type:"rect",clip:!1,tooltip:null,minHeight:1,minOpacity:0}}}function AEe(n){if(!(!n||!n.stroke||n.strokeWidth===0||n.strokeOpacity===0))return{configurableVisibility:!1,resolve:{scale:{x:"excluded",y:"excluded"},axis:{x:"excluded",y:"excluded"}},data:{values:[{x:0,y:0,x2:1,y2:0},{x:1,y:0,x2:1,y2:1},{x:1,y:1,x2:0,y2:1},{x:0,y:1,x2:0,y2:0}]},mark:{size:n.strokeWidth??1,color:n.stroke??"lightgray",strokeCap:"square",strokeOpacity:n.strokeOpacity??1,type:"rule",clip:!1,tooltip:null},encoding:{x:{field:"x",type:"quantitative",scale:null},y:{field:"y",type:"quantitative",scale:null},x2:{field:"x2"},y2:{field:"y2"}}}}function IEe(n){const e={x:new Set,y:new Set};return n.visit(t=>{for(const[i,s]of Object.entries(e)){const r=t.getScaleResolution(i);r&&r.isZoomable()&&s.add(r)}}),e}function NEe(n){let e=!0;return n.visit(t=>{t instanceof Nr&&e&&(e=t.mark.properties.clip===!0)}),e}function Iz(n,e,t){const i=t.axisProps,s=t.getPerpendicularSize();if(e=="bottom")return n.translate(0,n.height+i.offset).modify({height:s});if(e=="top")return n.translate(0,-s-i.offset).modify({height:s});if(e=="left")return n.translate(-s-i.offset,0).modify({width:s});if(e=="right")return n.translate(n.width+i.offset,0).modify({width:s})}class Nz{constructor(e,t,i){if(this.layoutParent=t,this.view=e,this.serial=i,this.background=void 0,this.backgroundStroke=void 0,this.axes={},this.gridLines={},this.title=void 0,this.coords=ny.ZERO,e.needsAxes.x||e.needsAxes.y){const s=e.spec,r="view"in s?s==null?void 0:s.view:void 0,o=TEe(r);o&&(this.background=new Nr(o,t.context,t,e,"background"+i),this.background.blockEncodingInheritance=!0);const a=AEe(r);a&&(this.backgroundStroke=new Nr(a,t.context,t,e,"backgroundStroke"+i),this.backgroundStroke.blockEncodingInheritance=!0);const l=DEe(e.spec.title);if(l){const c=new Nr(l,t.context,t,e,"title"+i);c.blockEncodingInheritance=!0,this.title=c}}}*getChildren(){this.background&&(yield this.background),this.backgroundStroke&&(yield this.backgroundStroke),this.title&&(yield this.title),yield*Object.values(this.axes),yield*Object.values(this.gridLines),yield this.view}createAxes(){const{view:e,axes:t,gridLines:i}=this,s=(a,l)=>{const c=a.getAxisProps();if(c===null)return;const u=c?{...c}:{};if(!u.orient){for(const h of CL[l])if(!t[h]){u.orient=h;break}if(!u.orient)throw new Error("No slots available for an axis! Perhaps a LayerView has more than two children?")}if(u.title??(u.title=a.getTitle()),!CL[l].includes(u.orient))throw new Error(`Invalid axis orientation "${u.orient}" on channel "${l}"!`);return u},r=(a,l,c)=>{const u=s(a,l);if(u){if(t[u.orient])throw new Error(`An axis with the orient "${u.orient}" already exists!`);t[u.orient]=new Vte(u,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c)}},o=(a,l,c)=>{const u=s(a,l);u&&(u.grid||u.chromGrid)&&(i[u.orient]=new _Ee(u,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c))};for(const a of["x","y"])if(e.needsAxes[a]){const l=e.resolutions.axis[a];if(!l)continue;r(l,a,e)}for(const a of["x","y"])if(e.needsAxes[a]){const l=e.getAxisResolution(a);if(!l)continue;o(l,a,e)}if(e instanceof lS){for(const a of e.children)for(const[l,c]of Object.entries(a.resolutions.axis)){const u=c.getAxisProps();u&&u.orient&&r(c,l,a)}for(const a of e.children)for(const[l,c]of Object.entries(a.resolutions.axis)){const u=c.getAxisProps();u&&!u.orient&&r(c,l,a)}}[...Object.values(t),...Object.values(i)].forEach(a=>a.visit(l=>{l instanceof Nr&&l.resolve("scale")}))}getOverhang(){const e=t=>{const i=this.axes[t];return i?Math.max(i.getPerpendicularSize()+i.axisProps.offset,0):0};return new rr(e("top"),e("right"),e("bottom"),e("left")).add(this.view.getOverhang())}getOverhangAndPadding(){return this.getOverhang().add(this.view.getPadding())}}class vN extends Ute{constructor(e,t,i,s,r){super(e,t,i,s,r,P4(e)?e.columns:U2(e)?1:1/0),this.spec=e}_createChildren(){const e=this.spec,t=P4(e)?e.concat:U2(e)?e.vconcat:e.hconcat;this.setChildren(t.map((i,s)=>this.context.createView(i,this,this,"grid"+s)))}getDefaultResolution(e,t){if(t=="axis")return"independent";if(U2(this.spec)&&e==="x"||Xte(this.spec)&&e==="y"){const i=new Set(this.children.map(s=>s.getEncoding()[e]).filter(s=>s).map(s=>"type"in s&&s.type).filter(s=>s));return i.size===1&&(i.has("index")||i.has("locus"))?"shared":"independent"}else return"independent"}}class REe{constructor(){this.types=[];const e=t=>(i,s,r,o,a)=>new t(i,s,r,o,i.name??a);this.addViewType(MEe,e(DQ)),this.addViewType(Yte,e(lS)),this.addViewType(Zte,e(Nr)),this.addViewType(U2,e(vN)),this.addViewType(Xte,e(vN)),this.addViewType(P4,e(vN))}addViewType(e,t){this.types.push({specGuard:e,factory:t})}createView(e,t,i,s,r){const o=this.types.find(a=>a.specGuard(e));if(o)return o.factory(e,t,i,s,r??"unnamed");throw new Error("Invalid spec, cannot figure out the view type from the properties: "+JSON.stringify([...Object.keys(e)]))}isViewSpec(e){const t=this.types.filter(i=>i.specGuard(e));if(t.length>1)throw new Error("Ambiguous spec. Cannot create a view!");return t.length==1}}function Zte(n){return"mark"in n&&(wn(n.mark)||Ll(n.mark))}function Yte(n){return"layer"in n&&Ll(n.layer)}function MEe(n){return"import"in n}function U2(n){return"vconcat"in n&&jo(n.vconcat)}function Xte(n){return"hconcat"in n&&jo(n.hconcat)}function P4(n){return"concat"in n&&jo(n.concat)}class FEe extends Ute{constructor(e,t){super({vconcat:[]},e,void 0,void 0,"implicitRoot",1),t.layoutParent=this,t.dataParent=this,this.appendChild(t)}}PZ("fasta",iEe);class PEe{constructor(e,t,i={}){this.container=e;const s=document.createElement("style");s.innerHTML=yfe,e.appendChild(s),this.spec=t,this.accessorFactory=new ame,this.viewFactory=new REe,this.namedDataProviders=[],this.animator=new ZDe(()=>this.renderAll()),this.genomeStore=void 0,this.viewVisibilityPredicate=r=>r.isVisibleInSpec(),this._renderingContext=void 0,this._pickingContext=void 0,this._dirtyPickingBuffer=!1,this._currentHover=void 0,this._wheelInertia=new nEe(this.animator),this._keyboardListeners=new Map,this._eventListeners=new Map,this._extraBroadcastListeners=new Map,this.tooltipHandlers={default:hEe,refseqgene:rEe,...i.tooltipHandlers??{}},this.viewRoot=void 0}registerNamedDataProvider(e){this.namedDataProviders.unshift(e)}getNamedDataFromProvider(e){for(const t of this.namedDataProviders){const i=t(e);if(i)return i}}updateNamedData(e,t){const i=this.viewRoot.context.dataFlow.findNamedDataSource(e);if(!i)throw new Error("No such named data source: "+e);i.dataSource.updateDynamicData(t),i4(i.hosts),this.animator.requestRender()}broadcast(e,t){var s;const i={type:e,payload:t};this.viewRoot.visit(r=>r.handleBroadcast(i)),(s=this._extraBroadcastListeners.get(e))==null||s.forEach(r=>r(i))}_prepareContainer(){this.container.classList.add("genome-spy"),this.container.classList.add("loading"),this._glHelper=new x1e(this.container,()=>this.viewRoot?HDe(this.viewRoot):{width:void 0,height:void 0},this.spec.background),this.loadingMessageElement=document.createElement("div"),this.loadingMessageElement.className="loading-message",this.loadingMessageElement.innerHTML='<div class="message">Loading<span class="ellipsis">...</span></div>',this.container.appendChild(this.loadingMessageElement),this.tooltip=new Sfe(this.container),this.loadingMessageElement.querySelector(".message").addEventListener("transitionend",()=>{this.loadingMessageElement.style.display="none"})}destroy(){this.container.classList.remove("genome-spy"),this.container.classList.remove("loading");for(const[e,t]of this._keyboardListeners)for(const i of t)document.removeEventListener(e,i);for(this._glHelper.finalize();this.container.firstChild;)this.container.firstChild.remove()}async _prepareViewsAndData(){this.spec.genome&&(this.genomeStore=new YDe(this.spec.baseUrl),await this.genomeStore.initialize(this.spec.genome));const e=this,t={dataFlow:new Mte,accessorFactory:this.accessorFactory,glHelper:this._glHelper,animator:this.animator,genomeStore:this.genomeStore,fontManager:new JDe(this._glHelper),get devicePixelRatio(){return e._glHelper.dpr},requestLayoutReflow:()=>{},updateTooltip:this.updateTooltip.bind(this),getNamedDataFromProvider:this.getNamedDataFromProvider.bind(this),getCurrentHover:()=>this._currentHover,addKeyboardListener:(a,l)=>{document.addEventListener(a,l);let c=this._keyboardListeners.get(a);c||(c=[],this._keyboardListeners.set(a,c)),c.push(l)},addBroadcastListener(a,l){const c=e._extraBroadcastListeners;let u=c.get(a);u||(u=new Set,c.set(a,u)),u.add(l)},removeBroadcastListener(a,l){var u;(u=e._extraBroadcastListeners.get(a))==null||u.delete(l)},isViewConfiguredVisible:e.viewVisibilityPredicate,isViewSpec:a=>e.viewFactory.isViewSpec(a),createView:function(a,l,c,u){return e.viewFactory.createView(a,t,l,c,u)}},i=this.spec;i.datasets&&this.registerNamedDataProvider(a=>i.datasets[a]),this.viewRoot=t.createView(i,null,null,"viewRoot"),await Ote(this.viewRoot),(this.viewRoot.needsAxes.x||this.viewRoot.needsAxes.y)&&(this.viewRoot=new FEe(t,this.viewRoot)),VDe(this.viewRoot),$De(this.viewRoot),this._glHelper.invalidateSize();const s=[];this.viewRoot.visit(a=>{a instanceof Nr&&s.push(a)});const r=MDe(this.viewRoot,t.dataFlow);WDe(r),this.broadcast("dataFlowBuilt",r),s.forEach(a=>a.mark.initializeEncoders());const o=Promise.all(s.map(a=>a.mark.initializeGraphics()));for(const a of s)r.addObserver(l=>{a.mark.initializeData(),a.mark.updateGraphicsData()},a);await t.fontManager.waitUntilReady(),r.initialize(),await Promise.all(r.dataSources.map(a=>a.load())),i4(this.viewRoot),this.broadcast("dataLoaded"),await o,this.viewRoot.visit(a=>{for(const l of Object.values(a.resolutions.scale))this._glHelper.createRangeTexture(l)});for(const a of s)a.mark.finalizeGraphicsInitialization();t.requestLayoutReflow=this.computeLayout.bind(this),this.viewRoot.visit(a=>N2(a,"size")),this._glHelper.invalidateSize()}async launch(){try{return this._prepareContainer(),await this._prepareViewsAndData(),this.registerMouseEvents(),this.computeLayout(),this.animator.requestRender(),this._glHelper.addEventListener("resize",()=>{this.computeLayout(),this.renderAll()}),!0}catch(e){const t=`${e.view?`At "${e.view.getPathString()}": `:""}${e.toString()}`;return console.error(e.stack),OEe(this.container,t),!1}finally{this.container.classList.remove("loading"),window.setTimeout(()=>{this.loadingMessageElement.style.display="none"},2e3)}}registerMouseEvents(){const e=this._glHelper.canvas,t=i=>{var s;if(i instanceof MouseEvent){i.type=="mousemove"&&(this.tooltip.handleMouseMove(i),this._tooltipUpdateRequested=!1,i.buttons==0&&this.renderPickingFramebuffer());const r=e.getBoundingClientRect(),o=new qDe(i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop),a=l=>{this.viewRoot.propagateInteractionEvent(new jDe(o,l)),this._tooltipUpdateRequested||this.tooltip.clear()};if(i.type!="wheel"&&this._wheelInertia.cancel(),i.type=="mousemove")this._handlePicking(o.x,o.y);else if(i.type=="mousedown"||i.type=="mouseup")this.renderPickingFramebuffer();else if(i.type=="wheel"){this._tooltipUpdateRequested=!1;const l=i;if(Math.abs(l.deltaX)>Math.abs(l.deltaY))this._currentHover=null,this._wheelInertia.cancel();else{const c=sEe(l);this._wheelInertia.setMomentum(l.deltaY*(l.deltaMode?80:1),u=>{const h=new WheelEvent("wheel",{...c,deltaMode:0,deltaX:0,deltaY:u});a(h)}),l.preventDefault();return}}if(i.type=="click"){const l=this._currentHover?{type:i.type,viewPath:this._currentHover.mark.unitView.getLayoutAncestors().map(c=>c.name).reverse(),datum:this._currentHover.datum}:{type:i.type,viewPath:null,datum:null};(s=this._eventListeners.get("click"))==null||s.forEach(c=>c(l))}a(i)}};["mousedown","mouseup","wheel","click","mousemove","gesturechange","contextmenu"].forEach(i=>e.addEventListener(i,t)),e.addEventListener("mousedown",()=>{document.addEventListener("mouseup",()=>this.tooltip.popEnabledState(),{once:!0}),this.tooltip.pushEnabledState(!1)}),e.addEventListener("dragstart",i=>i.stopPropagation())}_handlePicking(e,t){var r;const i=this._glHelper.readPickingPixel(e,t),s=i[0]|i[1]<<8|i[2]<<16;if(s==0){this._currentHover=null;return}if(s!==((r=this._currentHover)==null?void 0:r.uniqueId)&&(this._currentHover=null),this._currentHover||this.viewRoot.visit(o=>{if(o instanceof Nr){if(o.mark.isPickingParticipant()){const a=o.mark.encoders.uniqueId.accessor;o.getCollector().visitData(l=>{a(l)==s&&(this._currentHover={mark:o.mark,datum:l,uniqueId:s})})}if(this._currentHover)return Nv}}),this._currentHover){const o=this._currentHover.mark;this.updateTooltip(this._currentHover.datum,async a=>{if(!o.isPickingParticipant())return;const l=o.properties.tooltip;if(l!==null){const c=(l==null?void 0:l.handler)??"default",u=this.tooltipHandlers[c];if(!u)throw new Error("No such tooltip handler: "+c);return u(a,o,l==null?void 0:l.params)}})}}updateTooltip(e,t){if(!this._tooltipUpdateRequested||!e)this.tooltip.updateWithDatum(e,t),this._tooltipUpdateRequested=!0;else throw new Error("Tooltip has already been updated! Duplicate event handler?")}computeLayout(){const e=this.viewRoot;if(!e)return;this.broadcast("layout");const t=this._glHelper.getLogicalCanvasSize();if(isNaN(t.width)||isNaN(t.height)){console.log(`NaN in canvas size: ${t.width}x${t.height}. Skipping computeLayout().`);return}this._renderingContext=new Lz({picking:!1},this._glHelper),this._pickingContext=new Lz({picking:!0},this._glHelper),e.render(new UDe(this._renderingContext,this._pickingContext),ny.create(0,0,t.width,t.height)),this.broadcast("layoutComputed")}renderAll(){var e;(e=this._renderingContext)==null||e.render(),this._dirtyPickingBuffer=!0}renderPickingFramebuffer(){this._dirtyPickingBuffer&&(this._pickingContext.render(),this._dirtyPickingBuffer=!1)}getSearchableViews(){const e=[];return this.viewRoot.visit(t=>{t instanceof Nr&&t.getAccessor("search")&&e.push(t)}),e}getNamedScaleResolutions(){const e=new Map;return this.viewRoot.visit(t=>{for(const i of Object.values(t.resolutions.scale))i.name&&e.set(i.name,i)}),e}}function OEe(n,e){const t=document.createElement("div");t.className="message-box";const i=document.createElement("div");i.textContent=e,t.appendChild(i),n.appendChild(t)}const BEe=""+new URL("bowtie-663e9fd6.svg",import.meta.url).href;async function WEe(n,e,t={}){let i;if(wn(n)){if(i=document.querySelector(n),!i)throw new Error(`No such element: ${n}`)}else if(n instanceof HTMLElement)i=n;else throw new Error(`Invalid element: ${n}`);let s;try{const r=Ll(e)?e:await $Ee(e);if(r.baseUrl??(r.baseUrl=""),r.width??(r.width="container"),r.padding??(r.padding=10),i==document.body){const o=document.createElement("div");o.style.position="fixed",o.style.inset="0",o.style.overflow="hidden",i.appendChild(o),i=o}s=new PEe(i,r,t),VEe(s,t),await s.launch()}catch(r){i.innerText=r.toString(),console.error(r)}return{finalize(){for(s.destroy();i.firstChild;)i.firstChild.remove()},addEventListener(r,o){const a=s._eventListeners;let l=a.get(r);l||(l=new Set,a.set(r,l)),l.add(o)},removeEventListener(r,o){var l;(l=s._eventListeners.get(r))==null||l.delete(o)},getScaleResolutionByName(r){return s.getNamedScaleResolutions().get(r)},updateNamedData:s.updateNamedData.bind(s)}}function VEe(n,e){e.namedDataProvider&&n.registerNamedDataProvider(e.namedDataProvider)}async function $Ee(n){let e;try{e=JSON.parse(await CE().load(n))}catch(t){throw new Error(`Could not load or parse configuration: ${n}, reason: ${t.message}`)}if(!e.baseUrl){const t=n.match(/^[^?#]*\//);e.baseUrl=t&&t[0]||"./"}return e}const zEe=`{
  "data": {
    "sequence": { "start": 0, "stop": 60, "as": "x" }
  },
  "transform": [
    {
      "type": "formula",
      "expr": "sin((datum.x - 30) / 4) + (datum.x - 30) / 30",
      "as": "y"
    }
  ],
  "mark": "rect",
  "encoding": {
    "x": { "field": "x", "type": "index", "scale": { "padding": 0.1 } },
    "y": { "field": "y", "type": "quantitative" },
    "y2": { "datum": 0 },
    "color": {
      "field": "y",
      "type": "quantitative",
      "scale": {
        "type": "threshold",
        "domain": [0],
        "range": ["#ed553b", "#20639b"]
      }
    }
  }
}
`;function So(n,e=0){return n[n.length-(1+e)]}function HEe(n){if(n.length===0)throw new Error("Invalid tail call");return[n.slice(0,n.length-1),n[n.length-1]]}function yn(n,e,t=(i,s)=>i===s){if(n===e)return!0;if(!n||!e||n.length!==e.length)return!1;for(let i=0,s=n.length;i<s;i++)if(!t(n[i],e[i]))return!1;return!0}function UEe(n,e){const t=n.length-1;e<t&&(n[e]=n[t]),n.pop()}function Qte(n,e,t){return jEe(n.length,i=>t(n[i],e))}function jEe(n,e){let t=0,i=n-1;for(;t<=i;){const s=(t+i)/2|0,r=e(s);if(r<0)t=s+1;else if(r>0)i=s-1;else return s}return-(t+1)}function*Jte(n,e){let t,i;for(const s of n)i!==void 0&&e(i,s)?t.push(s):(t&&(yield t),t=[s]),i=s;t&&(yield t)}function eie(n,e){for(let t=0;t<=n.length;t++)e(t===0?void 0:n[t-1],t===n.length?void 0:n[t])}function qEe(n,e){for(let t=0;t<n.length;t++)e(t===0?void 0:n[t-1],n[t],t+1===n.length?void 0:n[t+1])}function aT(n){return n.filter(e=>!!e)}function Rz(n){let e=0;for(let t=0;t<n.length;t++)n[t]&&(n[e]=n[t],e+=1);n.length=e}function GEe(n){return!Array.isArray(n)||n.length===0}function Uu(n){return Array.isArray(n)&&n.length>0}function Cp(n,e=t=>t){const t=new Set;return n.filter(i=>{const s=e(i);return t.has(s)?!1:(t.add(s),!0)})}function tie(n,e){return n.length>0?n[0]:e}function Ps(n,e){let t=typeof e=="number"?n:0;typeof e=="number"?t=n:(t=0,e=n);const i=[];if(t<=e)for(let s=t;s<e;s++)i.push(s);else for(let s=t;s>e;s--)i.push(s);return i}function lT(n,e,t){const i=n.slice(0,e),s=n.slice(e);return i.concat(t,s)}function wN(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.unshift(e))}function px(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.push(e))}function O4(n,e){for(const t of e)n.push(t)}function iie(n){return Array.isArray(n)?n:[n]}function KEe(n,e,t){const i=nie(n,e),s=n.length,r=t.length;n.length=s+r;for(let o=s-1;o>=i;o--)n[o+r]=n[o];for(let o=0;o<r;o++)n[o+i]=t[o]}function Mz(n,e,t,i){const s=nie(n,e);let r=n.splice(s,t);return r===void 0&&(r=[]),KEe(n,s,i),r}function nie(n,e){return e<0?Math.max(e+n.length,0):Math.min(e,n.length)}var sy;(function(n){function e(r){return r<0}n.isLessThan=e;function t(r){return r<=0}n.isLessThanOrEqual=t;function i(r){return r>0}n.isGreaterThan=i;function s(r){return r===0}n.isNeitherLessOrGreaterThan=s,n.greaterThan=1,n.lessThan=-1,n.neitherLessOrGreaterThan=0})(sy||(sy={}));function Sa(n,e){return(t,i)=>e(n(t),n(i))}function ZEe(...n){return(e,t)=>{for(const i of n){const s=i(e,t);if(!sy.isNeitherLessOrGreaterThan(s))return s}return sy.neitherLessOrGreaterThan}}const kd=(n,e)=>n-e,YEe=(n,e)=>kd(n?1:0,e?1:0);function sie(n){return(e,t)=>-n(e,t)}class th{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}class Dc{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new Dc(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new Dc(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(s=>((i||sy.isGreaterThan(e(s,t)))&&(i=!1,t=s),!0)),t}}Dc.empty=new Dc(n=>{});function _r(n){return typeof n=="string"}function ur(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function XEe(n){const e=Object.getPrototypeOf(Uint8Array);return typeof n=="object"&&n instanceof e}function Xd(n){return typeof n=="number"&&!isNaN(n)}function Fz(n){return!!n&&typeof n[Symbol.iterator]=="function"}function rie(n){return n===!0||n===!1}function Mr(n){return typeof n>"u"}function SL(n){return!to(n)}function to(n){return Mr(n)||n===null}function cr(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function B4(n){if(to(n))throw new Error("Assertion Failed: argument is undefined or null");return n}function xL(n){return typeof n=="function"}function QEe(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)JEe(n[i],e[i])}function JEe(n,e){if(_r(e)){if(typeof n!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(xL(e)){try{if(n instanceof e)return}catch{}if(!to(n)&&n.constructor===e||e.length===1&&e.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function bu(n){if(!n||typeof n!="object"||n instanceof RegExp)return n;const e=Array.isArray(n)?[]:{};return Object.entries(n).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?bu(i):i}),e}function eTe(n){if(!n||typeof n!="object")return n;const e=[n];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(oie.call(t,i)){const s=t[i];typeof s=="object"&&!Object.isFrozen(s)&&!XEe(s)&&e.push(s)}}return n}const oie=Object.prototype.hasOwnProperty;function aie(n,e){return W4(n,e,new Set)}function W4(n,e,t){if(to(n))return n;const i=e(n);if(typeof i<"u")return i;if(Array.isArray(n)){const s=[];for(const r of n)s.push(W4(r,e,t));return s}if(ur(n)){if(t.has(n))throw new Error("Cannot clone recursive data-structure");t.add(n);const s={};for(const r in n)oie.call(n,r)&&(s[r]=W4(n[r],e,t));return t.delete(n),s}return n}function cT(n,e,t=!0){return ur(n)?(ur(e)&&Object.keys(e).forEach(i=>{i in n?t&&(ur(n[i])&&ur(e[i])?cT(n[i],e[i],t):n[i]=e[i]):n[i]=e[i]}),n):e}function mo(n,e){if(n===e)return!0;if(n==null||e===null||e===void 0||typeof n!=typeof e||typeof n!="object"||Array.isArray(n)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(n)){if(n.length!==e.length)return!1;for(t=0;t<n.length;t++)if(!mo(n[t],e[t]))return!1}else{const s=[];for(i in n)s.push(i);s.sort();const r=[];for(i in e)r.push(i);if(r.sort(),!mo(s,r))return!1;for(t=0;t<s.length;t++)if(!mo(n[s[t]],e[s[t]]))return!1}return!0}function tTe(n){let e=[];for(;Object.prototype!==n;)e=e.concat(Object.getOwnPropertyNames(n)),n=Object.getPrototypeOf(n);return e}function X6(n){const e=[];for(const t of tTe(n))typeof n[t]=="function"&&e.push(t);return e}function iTe(n,e){const t=s=>function(){const r=Array.prototype.slice.call(arguments,0);return e(s,r)},i={};for(const s of n)i[s]=t(s);return i}globalThis&&globalThis.__awaiter;let nTe=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function sTe(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,(i,s)=>{const r=s[0],o=e[r];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),nTe&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}function _(n,e,...t){return sTe(e,t)}var yN;const l0="en";let kL=!1,LL=!1,j2=!1,lie=!1,Q6=!1,J6=!1,cie=!1,mx,CN=l0,Pz=l0,rTe,Xa;const xa=typeof self=="object"?self:typeof globalThis=="object"?globalThis:{};let Os;typeof xa.vscode<"u"&&typeof xa.vscode.process<"u"?Os=xa.vscode.process:typeof process<"u"&&(Os=process);const oTe=typeof((yN=Os==null?void 0:Os.versions)===null||yN===void 0?void 0:yN.electron)=="string",aTe=oTe&&(Os==null?void 0:Os.type)==="renderer";if(typeof navigator=="object"&&!aTe)Xa=navigator.userAgent,kL=Xa.indexOf("Windows")>=0,LL=Xa.indexOf("Macintosh")>=0,J6=(Xa.indexOf("Macintosh")>=0||Xa.indexOf("iPad")>=0||Xa.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,j2=Xa.indexOf("Linux")>=0,cie=(Xa==null?void 0:Xa.indexOf("Mobi"))>=0,Q6=!0,_({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"),mx=l0,CN=mx,Pz=navigator.language;else if(typeof Os=="object"){kL=Os.platform==="win32",LL=Os.platform==="darwin",j2=Os.platform==="linux",j2&&Os.env.SNAP&&Os.env.SNAP_REVISION,Os.env.CI||Os.env.BUILD_ARTIFACTSTAGINGDIRECTORY,mx=l0,CN=l0;const n=Os.env.VSCODE_NLS_CONFIG;if(n)try{const e=JSON.parse(n),t=e.availableLanguages["*"];mx=e.locale,Pz=e.osLocale,CN=t||l0,rTe=e._translationsConfigFile}catch{}lie=!0}else console.error("Unable to resolve platform.");const br=kL,Mt=LL,Ts=j2,j0=lie,Hb=Q6,lTe=Q6&&typeof xa.importScripts=="function",Qd=J6,cTe=cie,Tc=Xa,uTe=typeof xa.postMessage=="function"&&!xa.importScripts,uie=(()=>{if(uTe){const n=[];xa.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,s=n.length;i<s;i++){const r=n[i];if(r.id===t.data.vscodeScheduleAsyncWork){n.splice(i,1),r.callback();return}}});let e=0;return t=>{const i=++e;n.push({id:i,callback:t}),xa.postMessage({vscodeScheduleAsyncWork:i},"*")}}return n=>setTimeout(n)})(),co=LL||J6?2:kL?1:3;let Oz=!0,Bz=!1;function hTe(){if(!Bz){Bz=!0;const n=new Uint8Array(2);n[0]=1,n[1]=2,Oz=new Uint16Array(n.buffer)[0]===512+1}return Oz}const hie=!!(Tc&&Tc.indexOf("Chrome")>=0),dTe=!!(Tc&&Tc.indexOf("Firefox")>=0),fTe=!!(!hie&&Tc&&Tc.indexOf("Safari")>=0),gTe=!!(Tc&&Tc.indexOf("Edg/")>=0);Tc&&Tc.indexOf("Android")>=0;const ls={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var Et;(function(n){function e(v){return v&&typeof v=="object"&&typeof v[Symbol.iterator]=="function"}n.is=e;const t=Object.freeze([]);function i(){return t}n.empty=i;function*s(v){yield v}n.single=s;function r(v){return e(v)?v:s(v)}n.wrap=r;function o(v){return v||t}n.from=o;function*a(v){for(let w=v.length-1;w>=0;w--)yield v[w]}n.reverse=a;function l(v){return!v||v[Symbol.iterator]().next().done===!0}n.isEmpty=l;function c(v){return v[Symbol.iterator]().next().value}n.first=c;function u(v,w){for(const y of v)if(w(y))return!0;return!1}n.some=u;function h(v,w){for(const y of v)if(w(y))return y}n.find=h;function*d(v,w){for(const y of v)w(y)&&(yield y)}n.filter=d;function*f(v,w){let y=0;for(const x of v)yield w(x,y++)}n.map=f;function*g(...v){for(const w of v)for(const y of w)yield y}n.concat=g;function p(v,w,y){let x=y;for(const D of v)x=w(x,D);return x}n.reduce=p;function*m(v,w,y=v.length){for(w<0&&(w+=v.length),y<0?y+=v.length:y>v.length&&(y=v.length);w<y;w++)yield v[w]}n.slice=m;function b(v,w=Number.POSITIVE_INFINITY){const y=[];if(w===0)return[y,v];const x=v[Symbol.iterator]();for(let D=0;D<w;D++){const S=x.next();if(S.done)return[y,n.empty()];y.push(S.value)}return[y,{[Symbol.iterator](){return x}}]}n.consume=b})(Et||(Et={}));let tn=class V4{constructor(e){this.element=e,this.next=V4.Undefined,this.prev=V4.Undefined}};tn.Undefined=new tn(void 0);class hr{constructor(){this._first=tn.Undefined,this._last=tn.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===tn.Undefined}clear(){let e=this._first;for(;e!==tn.Undefined;){const t=e.next;e.prev=tn.Undefined,e.next=tn.Undefined,e=t}this._first=tn.Undefined,this._last=tn.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new tn(e);if(this._first===tn.Undefined)this._first=i,this._last=i;else if(t){const r=this._last;this._last=i,i.prev=r,r.next=i}else{const r=this._first;this._first=i,i.next=r,r.prev=i}this._size+=1;let s=!1;return()=>{s||(s=!0,this._remove(i))}}shift(){if(this._first!==tn.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==tn.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==tn.Undefined&&e.next!==tn.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===tn.Undefined&&e.next===tn.Undefined?(this._first=tn.Undefined,this._last=tn.Undefined):e.next===tn.Undefined?(this._last=this._last.prev,this._last.next=tn.Undefined):e.prev===tn.Undefined&&(this._first=this._first.next,this._first.prev=tn.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==tn.Undefined;)yield e.element,e=e.next}}const die="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function pTe(n=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of die)n.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const e8=pTe();function fie(n){let e=e8;if(n&&n instanceof RegExp)if(n.global)e=n;else{let t="g";n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.unicode&&(t+="u"),e=new RegExp(n.source,t)}return e.lastIndex=0,e}const gie=new hr;gie.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function ry(n,e,t,i,s){if(s||(s=Et.first(gie)),t.length>s.maxLen){let c=n-s.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,n+s.maxLen/2),ry(n,e,t,i,s)}const r=Date.now(),o=n-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-r>=s.timeBudget);c++){const u=o-s.windowSize*c;e.lastIndex=Math.max(0,u);const h=mTe(e,t,o,a);if(!h&&l||(l=h,u<=0))break;a=u}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function mTe(n,e,t,i){let s;for(;s=n.exec(e);){const r=s.index||0;if(r<=t&&n.lastIndex>=t)return s;if(i>0&&r>i)return null}return null}const Ih=8;class pie{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class mie{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class vi{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return uT(e,t)}compute(e,t,i){return i}}class zv{constructor(e,t){this.newValue=e,this.didChange=t}}function uT(n,e){if(typeof n!="object"||typeof e!="object"||!n||!e)return new zv(e,n!==e);if(Array.isArray(n)||Array.isArray(e)){const i=Array.isArray(n)&&Array.isArray(e)&&yn(n,e);return new zv(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const s=uT(n[i],e[i]);s.didChange&&(n[i]=s.newValue,t=!0)}return new zv(n,t)}class cS{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return uT(e,t)}validate(e){return this.defaultValue}}class Ub{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return uT(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Oe(n,e){return typeof n>"u"?e:n==="false"?!1:!!n}class Ct extends Ub{constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="boolean",s.default=i),super(e,t,i,s)}validate(e){return Oe(e,this.defaultValue)}}function Kf(n,e,t,i){if(typeof n>"u")return e;let s=parseInt(n,10);return isNaN(s)?e:(s=Math.max(t,s),s=Math.min(i,s),s|0)}class Gt extends Ub{static clampedInt(e,t,i,s){return Kf(e,t,i,s)}constructor(e,t,i,s,r,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=s,o.maximum=r),super(e,t,i,o),this.minimum=s,this.maximum=r}validate(e){return Gt.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function _Te(n,e,t,i){if(typeof n>"u")return e;const s=ma.float(n,e);return ma.clamp(s,t,i)}class ma extends Ub{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,s,r){typeof r<"u"&&(r.type="number",r.default=i),super(e,t,i,r),this.validationFn=s}validate(e){return this.validationFn(ma.float(e,this.defaultValue))}}class Er extends Ub{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="string",s.default=i),super(e,t,i,s)}validate(e){return Er.string(e,this.defaultValue)}}function zi(n,e,t,i){return typeof n!="string"?e:i&&n in i?i[n]:t.indexOf(n)===-1?e:n}class ki extends Ub{constructor(e,t,i,s,r=void 0){typeof r<"u"&&(r.type="string",r.enum=s,r.default=i),super(e,t,i,r),this._allowedValues=s}validate(e){return zi(e,this.defaultValue,this._allowedValues)}}class _x extends vi{constructor(e,t,i,s,r,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=r,a.default=s),super(e,t,i,a),this._allowedValues=r,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function bTe(n){switch(n){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class vTe extends vi{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[_("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached"),_("accessibilitySupport.on","Optimize for usage with a Screen Reader"),_("accessibilitySupport.off","Assume a screen reader is not attached")],default:"auto",tags:["accessibility"],description:_("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class wTe extends vi{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:_("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:_("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Oe(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Oe(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function yTe(n){switch(n){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var $n;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})($n||($n={}));function CTe(n){switch(n){case"line":return $n.Line;case"block":return $n.Block;case"underline":return $n.Underline;case"line-thin":return $n.LineThin;case"block-outline":return $n.BlockOutline;case"underline-thin":return $n.UnderlineThin}}class STe extends cS{constructor(){super(140)}compute(e,t,i){const s=["monaco-editor"];return t.get(39)&&s.push(t.get(39)),e.extraEditorClassName&&s.push(e.extraEditorClassName),t.get(73)==="default"?s.push("mouse-default"):t.get(73)==="copy"&&s.push("mouse-copy"),t.get(110)&&s.push("showUnused"),t.get(138)&&s.push("showDeprecated"),s.join(" ")}}class xTe extends Ct{constructor(){super(37,"emptySelectionClipboard",!0,{description:_("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class kTe extends vi{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:_("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[_("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),_("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),_("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:_("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[_("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),_("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),_("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:_("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:_("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Mt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:_("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:_("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Oe(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":zi(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":zi(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Oe(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Oe(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Oe(t.loop,this.defaultValue.loop)}}}class Eo extends vi{constructor(){super(51,"fontLigatures",Eo.OFF,{anyOf:[{type:"boolean",description:_("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:_("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:_("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Eo.OFF:e==="true"?Eo.ON:e:e?Eo.ON:Eo.OFF}}Eo.OFF='"liga" off, "calt" off';Eo.ON='"liga" on, "calt" on';class cl extends vi{constructor(){super(54,"fontVariations",cl.OFF,{anyOf:[{type:"boolean",description:_("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:_("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:_("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?cl.OFF:e==="true"?cl.TRANSLATE:e:e?cl.TRANSLATE:cl.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}}cl.OFF="normal";cl.TRANSLATE="translate";class LTe extends cS{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class DTe extends Ub{constructor(){super(52,"fontSize",Oo.fontSize,{type:"number",minimum:6,maximum:100,default:Oo.fontSize,description:_("fontSize","Controls the font size in pixels.")})}validate(e){const t=ma.float(e,this.defaultValue);return t===0?Oo.fontSize:ma.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class sc extends vi{constructor(){super(53,"fontWeight",Oo.fontWeight,{anyOf:[{type:"number",minimum:sc.MINIMUM_VALUE,maximum:sc.MAXIMUM_VALUE,errorMessage:_("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:sc.SUGGESTION_VALUES}],default:Oo.fontWeight,description:_("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Gt.clampedInt(e,Oo.fontWeight,sc.MINIMUM_VALUE,sc.MAXIMUM_VALUE))}}sc.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];sc.MINIMUM_VALUE=1;sc.MAXIMUM_VALUE=1e3;class ETe extends vi{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[_("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),_("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),_("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:_("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:_("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:_("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleDeclarations":Object.assign({description:_("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleImplementations":Object.assign({description:_("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleReferences":Object.assign({description:_("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist.")},t),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:_("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:_("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:_("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:_("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:_("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){var t,i,s,r,o;if(!e||typeof e!="object")return this.defaultValue;const a=e;return{multiple:zi(a.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:(t=a.multipleDefinitions)!==null&&t!==void 0?t:zi(a.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:(i=a.multipleTypeDefinitions)!==null&&i!==void 0?i:zi(a.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:(s=a.multipleDeclarations)!==null&&s!==void 0?s:zi(a.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:(r=a.multipleImplementations)!==null&&r!==void 0?r:zi(a.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:(o=a.multipleReferences)!==null&&o!==void 0?o:zi(a.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Er.string(a.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Er.string(a.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Er.string(a.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Er.string(a.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Er.string(a.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class TTe extends vi{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:_("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:_("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:_("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:_("hover.hidingDelay","Controls the delay in milliseconds after thich the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:_("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),delay:Gt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Oe(t.sticky,this.defaultValue.sticky),hidingDelay:Gt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:Oe(t.above,this.defaultValue.above)}}}class q0 extends cS{constructor(){super(143)}compute(e,t,i){return q0.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let s=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(s=Math.max(s,t-1));const r=(i+e.viewLineCount+s)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:s,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,s=e.outerHeight,r=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,h=e.minimap.renderCharacters;let d=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const f=e.minimap.maxColumn,g=e.minimap.size,p=e.minimap.side,m=e.verticalScrollbarWidth,b=e.viewLineCount,v=e.remainingWidth,w=e.isViewportWrapping,y=h?2:3;let x=Math.floor(r*s);const D=x/r;let S=!1,T=!1,k=y*d,I=d/r,N=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:De,extraLinesBeforeFirstLine:ve,extraLinesBeyondLastLine:$e,desiredRatio:Ne,minimapLineCount:xe}=q0.computeContainedMinimapLineCount({viewLineCount:b,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:s,lineHeight:l,pixelRatio:r});if(b/xe>1)S=!0,T=!0,d=1,k=1,I=d/r;else{let jt=!1,mi=d+1;if(g==="fit"){const re=Math.ceil((ve+b+$e)*k);w&&a&&v<=t.stableFitRemainingWidth?(jt=!0,mi=t.stableFitMaxMinimapScale):jt=re>x}if(g==="fill"||jt){S=!0;const re=d;k=Math.min(l*r,Math.max(1,Math.floor(1/Ne))),w&&a&&v<=t.stableFitRemainingWidth&&(mi=t.stableFitMaxMinimapScale),d=Math.min(mi,Math.max(1,Math.floor(k/y))),d>re&&(N=Math.min(2,d/re)),I=d/r/N,x=Math.ceil(Math.max(De,ve+b+$e)*k),w?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=v,t.stableFitMaxMinimapScale=d):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const z=Math.floor(f*I),$=Math.min(z,Math.max(0,Math.floor((v-m-2)*I/(c+I)))+Ih);let q=Math.floor(r*$);const ne=q/r;q=Math.floor(q*N);const de=h?1:2,me=p==="left"?0:i-$-m;return{renderMinimap:de,minimapLeft:me,minimapWidth:$,minimapHeightIsEditorHeight:S,minimapIsSampling:T,minimapScale:d,minimapLineHeight:k,minimapCanvasInnerWidth:q,minimapCanvasInnerHeight:x,minimapCanvasOuterWidth:ne,minimapCanvasOuterHeight:D}}static computeLayout(e,t){const i=t.outerWidth|0,s=t.outerHeight|0,r=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,u=t.viewLineCount,h=e.get(135),d=h==="inherit"?e.get(134):h,f=d==="inherit"?e.get(130):d,g=e.get(133),p=t.isDominatedByLongLines,m=e.get(57),b=e.get(67).renderType!==0,v=e.get(68),w=e.get(104),y=e.get(83),x=e.get(72),D=e.get(102),S=D.verticalScrollbarSize,T=D.verticalHasArrows,k=D.arrowSize,I=D.horizontalScrollbarSize,N=e.get(43),z=e.get(109)!=="never";let $=e.get(65);N&&z&&($+=16);let q=0;if(b){const ye=Math.max(o,v);q=Math.round(ye*l)}let ne=0;m&&(ne=r*t.glyphMarginDecorationLaneCount);let de=0,me=de+ne,De=me+q,ve=De+$;const $e=i-ne-q-$;let Ne=!1,xe=!1,fe=-1;d==="inherit"&&p?(Ne=!0,xe=!0):f==="on"||f==="bounded"?xe=!0:f==="wordWrapColumn"&&(fe=g);const jt=q0._computeMinimapLayout({outerWidth:i,outerHeight:s,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:w,paddingTop:y.top,paddingBottom:y.bottom,minimap:x,verticalScrollbarWidth:S,viewLineCount:u,remainingWidth:$e,isViewportWrapping:xe},t.memory||new mie);jt.renderMinimap!==0&&jt.minimapLeft===0&&(de+=jt.minimapWidth,me+=jt.minimapWidth,De+=jt.minimapWidth,ve+=jt.minimapWidth);const mi=$e-jt.minimapWidth,re=Math.max(1,Math.floor((mi-S-2)/a)),te=T?k:0;return xe&&(fe=Math.max(1,re),f==="bounded"&&(fe=Math.min(fe,g))),{width:i,height:s,glyphMarginLeft:de,glyphMarginWidth:ne,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:me,lineNumbersWidth:q,decorationsLeft:De,decorationsWidth:$,contentLeft:ve,contentWidth:mi,minimap:jt,viewportColumn:re,isWordWrapMinified:Ne,isViewportWrapping:xe,wrappingColumn:fe,verticalScrollbarWidth:S,horizontalScrollbarHeight:I,overviewRuler:{top:te,width:S,height:s-2*te,right:0}}}}class ATe extends vi{constructor(){super(137,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[_("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),_("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:_("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return zi(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}class ITe extends vi{constructor(){const e={enabled:!0};super(64,"lightbulb",e,{"editor.lightbulb.enabled":{type:"boolean",default:e.enabled,description:_("codeActions","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Oe(e.enabled,this.defaultValue.enabled)}}}class NTe extends vi{constructor(){const e={enabled:!1,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(114,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:_("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:10,description:_("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:_("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:_("editor.stickyScroll.scrollWithEditor","Enable scrolling of the sticky scroll widget with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),maxLineCount:Gt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,10),defaultModel:zi(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:Oe(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class RTe extends vi{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(139,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:_("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[_("editor.inlayHints.on","Inlay hints are enabled"),_("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Mt?"Ctrl+Option":"Ctrl+Alt"),_("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Mt?"Ctrl+Option":"Ctrl+Alt"),_("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:_("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:_("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:_("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:zi(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Gt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Er.string(t.fontFamily,this.defaultValue.fontFamily),padding:Oe(t.padding,this.defaultValue.padding)}}}class MTe extends vi{constructor(){super(65,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Gt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Gt.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class FTe extends ma{constructor(){super(66,"lineHeight",Oo.lineHeight,e=>ma.clamp(e,0,150),{markdownDescription:_("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class PTe extends vi{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1};super(72,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:_("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:_("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[_("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),_("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),_("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:_("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:_("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:_("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:_("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:_("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:_("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),autohide:Oe(t.autohide,this.defaultValue.autohide),size:zi(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:zi(t.side,this.defaultValue.side,["right","left"]),showSlider:zi(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Oe(t.renderCharacters,this.defaultValue.renderCharacters),scale:Gt.clampedInt(t.scale,1,1,3),maxColumn:Gt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function OTe(n){return n==="ctrlCmd"?Mt?"metaKey":"ctrlKey":"altKey"}class BTe extends vi{constructor(){super(83,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:_("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:_("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Gt.clampedInt(t.top,0,0,1e3),bottom:Gt.clampedInt(t.bottom,0,0,1e3)}}}class WTe extends vi{constructor(){const e={enabled:!0,cycle:!0};super(85,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:_("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:_("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),cycle:Oe(t.cycle,this.defaultValue.cycle)}}}class VTe extends cS{constructor(){super(141)}compute(e,t,i){return e.pixelRatio}}class $Te extends vi{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[_("on","Quick suggestions show inside the suggest widget"),_("inline","Quick suggestions show as ghost text"),_("off","Quick suggestions are disabled")]}];super(88,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:_("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:_("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:_("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:_("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:s}=e,r=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=zi(t,this.defaultValue.other,r),typeof i=="boolean"?a=i?"on":"off":a=zi(i,this.defaultValue.comments,r),typeof s=="boolean"?l=s?"on":"off":l=zi(s,this.defaultValue.strings,r),{other:o,comments:a,strings:l}}}class zTe extends vi{constructor(){super(67,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[_("lineNumbers.off","Line numbers are not rendered."),_("lineNumbers.on","Line numbers are rendered as absolute number."),_("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),_("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:_("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function DL(n){const e=n.get(97);return e==="editable"?n.get(90):e!=="on"}class HTe extends vi{constructor(){const e=[],t={type:"number",description:_("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(101,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:_("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:_("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Gt.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const s=i;t.push({column:Gt.clampedInt(s.column,0,0,1e4),color:s.color})}return t.sort((i,s)=>i.column-s.column),t}return this.defaultValue}}class UTe extends vi{constructor(){super(91,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function Wz(n,e){if(typeof n!="string")return e;switch(n){case"hidden":return 2;case"visible":return 3;default:return 1}}let jTe=class extends vi{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(102,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[_("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),_("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),_("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:_("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[_("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),_("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),_("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:_("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:_("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:_("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:_("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Gt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),s=Gt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Gt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:Wz(t.vertical,this.defaultValue.vertical),horizontal:Wz(t.horizontal,this.defaultValue.horizontal),useShadows:Oe(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Oe(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Oe(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Oe(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Oe(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Gt.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Gt.clampedInt(t.verticalSliderSize,s,0,1e3),scrollByPage:Oe(t.scrollByPage,this.defaultValue.scrollByPage)}}};const Ga="inUntrustedWorkspace",Wf={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class qTe extends vi{constructor(){const e={nonBasicASCII:Ga,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Ga,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(124,"unicodeHighlight",e,{[Wf.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.nonBasicASCII,description:_("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Wf.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:_("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Wf.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:_("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Wf.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.includeComments,description:_("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Wf.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ga],default:e.includeStrings,description:_("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Wf.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:_("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Wf.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:_("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(mo(e.allowedCharacters,t.allowedCharacters)||(e=Object.assign(Object.assign({},e),{allowedCharacters:t.allowedCharacters}),i=!0)),t.allowedLocales&&e&&(mo(e.allowedLocales,t.allowedLocales)||(e=Object.assign(Object.assign({},e),{allowedLocales:t.allowedLocales}),i=!0));const s=super.applyUpdate(e,t);return i?new zv(s.newValue,!0):s}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:G0(t.nonBasicASCII,Ga,[!0,!1,Ga]),invisibleCharacters:Oe(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:Oe(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:G0(t.includeComments,Ga,[!0,!1,Ga]),includeStrings:G0(t.includeStrings,Ga,[!0,!1,Ga]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[s,r]of Object.entries(e))r===!0&&(i[s]=!0);return i}}class GTe extends vi{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:_("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover"],enumDescriptions:[_("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),_("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion.")],description:_("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:_("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),mode:zi(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:zi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover"]),suppressSuggestions:Oe(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:Oe(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class KTe extends vi{constructor(){const e={enabled:ls.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:ls.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:_("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:_("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:Oe(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class ZTe extends vi{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[_("editor.guides.bracketPairs.true","Enables bracket pair guides."),_("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),_("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:_("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[_("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),_("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),_("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:_("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:_("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:_("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[_("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),_("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),_("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:_("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:G0(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:G0(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Oe(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Oe(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:G0(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function G0(n,e,t){const i=t.indexOf(n);return i===-1?e:t[i]}class YTe extends vi{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(117,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[_("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),_("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:_("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:_("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:_("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:_("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[_("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),_("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),_("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),_("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:_("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:_("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:_("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:_("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:_("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:_("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:_("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:_("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:_("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:zi(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Oe(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Oe(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Oe(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Oe(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:zi(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:Oe(t.showIcons,this.defaultValue.showIcons),showStatusBar:Oe(t.showStatusBar,this.defaultValue.showStatusBar),preview:Oe(t.preview,this.defaultValue.preview),previewMode:zi(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Oe(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Oe(t.showMethods,this.defaultValue.showMethods),showFunctions:Oe(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Oe(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Oe(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:Oe(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:Oe(t.showFields,this.defaultValue.showFields),showVariables:Oe(t.showVariables,this.defaultValue.showVariables),showClasses:Oe(t.showClasses,this.defaultValue.showClasses),showStructs:Oe(t.showStructs,this.defaultValue.showStructs),showInterfaces:Oe(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Oe(t.showModules,this.defaultValue.showModules),showProperties:Oe(t.showProperties,this.defaultValue.showProperties),showEvents:Oe(t.showEvents,this.defaultValue.showEvents),showOperators:Oe(t.showOperators,this.defaultValue.showOperators),showUnits:Oe(t.showUnits,this.defaultValue.showUnits),showValues:Oe(t.showValues,this.defaultValue.showValues),showConstants:Oe(t.showConstants,this.defaultValue.showConstants),showEnums:Oe(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Oe(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Oe(t.showKeywords,this.defaultValue.showKeywords),showWords:Oe(t.showWords,this.defaultValue.showWords),showColors:Oe(t.showColors,this.defaultValue.showColors),showFiles:Oe(t.showFiles,this.defaultValue.showFiles),showReferences:Oe(t.showReferences,this.defaultValue.showReferences),showFolders:Oe(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Oe(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Oe(t.showSnippets,this.defaultValue.showSnippets),showUsers:Oe(t.showUsers,this.defaultValue.showUsers),showIssues:Oe(t.showIssues,this.defaultValue.showIssues)}}}class XTe extends vi{constructor(){super(112,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:_("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:_("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Oe(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:Oe(e.selectSubwords,this.defaultValue.selectSubwords)}}}class QTe extends vi{constructor(){super(136,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[_("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),_("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),_("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),_("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:_("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class JTe extends cS{constructor(){super(144)}compute(e,t,i){const s=t.get(143);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}}class eAe extends vi{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:_("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down `shift` (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:_("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[_("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),_("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),showDropSelector:zi(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class tAe extends vi{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(84,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:_("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:_("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[_("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),_("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Oe(t.enabled,this.defaultValue.enabled),showPasteSelector:zi(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const iAe="Consolas, 'Courier New', monospace",nAe="Menlo, Monaco, 'Courier New', monospace",sAe="'Droid Sans Mono', 'monospace', monospace",Oo={fontFamily:Mt?nAe:Ts?sAe:iAe,fontWeight:"normal",fontSize:Mt?12:14,lineHeight:0,letterSpacing:0},c0=[];function ue(n){return c0[n.id]=n,n}const Xp={acceptSuggestionOnCommitCharacter:ue(new Ct(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:_("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:ue(new ki(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",_("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:_("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:ue(new vTe),accessibilityPageSize:ue(new Gt(3,"accessibilityPageSize",10,1,1073741824,{description:_("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:ue(new Er(4,"ariaLabel",_("editorViewAccessibleLabel","Editor content"))),ariaRequired:ue(new Ct(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:ue(new Ct(8,"screenReaderAnnounceInlineSuggestion",!0,{description:_("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:ue(new ki(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),_("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:_("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:ue(new ki(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),_("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:_("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:ue(new ki(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",_("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:_("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:ue(new ki(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",_("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:_("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:ue(new ki(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",_("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),_("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:_("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:ue(new _x(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],bTe,{enumDescriptions:[_("editor.autoIndent.none","The editor will not insert indentation automatically."),_("editor.autoIndent.keep","The editor will keep the current line's indentation."),_("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),_("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),_("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:_("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:ue(new Ct(13,"automaticLayout",!1)),autoSurround:ue(new ki(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[_("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),_("editor.autoSurround.quotes","Surround with quotes but not brackets."),_("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:_("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:ue(new KTe),bracketPairGuides:ue(new ZTe),stickyTabStops:ue(new Ct(115,"stickyTabStops",!1,{description:_("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:ue(new Ct(17,"codeLens",!0,{description:_("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:ue(new Er(18,"codeLensFontFamily","",{description:_("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:ue(new Gt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:_("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:ue(new Ct(20,"colorDecorators",!0,{description:_("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:ue(new ki(146,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[_("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),_("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),_("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:_("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:ue(new Gt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:_("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:ue(new Ct(22,"columnSelection",!1,{description:_("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:ue(new wTe),contextmenu:ue(new Ct(24,"contextmenu",!0)),copyWithSyntaxHighlighting:ue(new Ct(25,"copyWithSyntaxHighlighting",!0,{description:_("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:ue(new _x(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],yTe,{description:_("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:ue(new ki(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[_("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),_("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),_("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:_("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:ue(new _x(28,"cursorStyle",$n.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],CTe,{description:_("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:ue(new Gt(29,"cursorSurroundingLines",0,0,1073741824,{description:_("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:ue(new ki(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[_("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),_("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:_("cursorSurroundingLinesStyle","Controls when `#cursorSurroundingLines#` should be enforced.")})),cursorWidth:ue(new Gt(31,"cursorWidth",0,0,1073741824,{markdownDescription:_("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:ue(new Ct(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:ue(new Ct(33,"disableMonospaceOptimizations",!1)),domReadOnly:ue(new Ct(34,"domReadOnly",!1)),dragAndDrop:ue(new Ct(35,"dragAndDrop",!0,{description:_("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:ue(new xTe),dropIntoEditor:ue(new eAe),stickyScroll:ue(new NTe),experimentalWhitespaceRendering:ue(new ki(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[_("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),_("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),_("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:_("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:ue(new Er(39,"extraEditorClassName","")),fastScrollSensitivity:ue(new ma(40,"fastScrollSensitivity",5,n=>n<=0?5:n,{markdownDescription:_("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:ue(new kTe),fixedOverflowWidgets:ue(new Ct(42,"fixedOverflowWidgets",!1)),folding:ue(new Ct(43,"folding",!0,{description:_("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:ue(new ki(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[_("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),_("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:_("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:ue(new Ct(45,"foldingHighlight",!0,{description:_("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:ue(new Ct(46,"foldingImportsByDefault",!1,{description:_("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:ue(new Gt(47,"foldingMaximumRegions",5e3,10,65e3,{description:_("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:ue(new Ct(48,"unfoldOnClickAfterEndOfLine",!1,{description:_("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:ue(new Er(49,"fontFamily",Oo.fontFamily,{description:_("fontFamily","Controls the font family.")})),fontInfo:ue(new LTe),fontLigatures2:ue(new Eo),fontSize:ue(new DTe),fontWeight:ue(new sc),fontVariations:ue(new cl),formatOnPaste:ue(new Ct(55,"formatOnPaste",!1,{description:_("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:ue(new Ct(56,"formatOnType",!1,{description:_("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:ue(new Ct(57,"glyphMargin",!0,{description:_("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:ue(new ETe),hideCursorInOverviewRuler:ue(new Ct(59,"hideCursorInOverviewRuler",!1,{description:_("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:ue(new TTe),inDiffEditor:ue(new Ct(61,"inDiffEditor",!1)),letterSpacing:ue(new ma(63,"letterSpacing",Oo.letterSpacing,n=>ma.clamp(n,-5,20),{description:_("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:ue(new ITe),lineDecorationsWidth:ue(new MTe),lineHeight:ue(new FTe),lineNumbers:ue(new zTe),lineNumbersMinChars:ue(new Gt(68,"lineNumbersMinChars",5,1,300)),linkedEditing:ue(new Ct(69,"linkedEditing",!1,{description:_("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:ue(new Ct(70,"links",!0,{description:_("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:ue(new ki(71,"matchBrackets","always",["always","near","never"],{description:_("matchBrackets","Highlight matching brackets.")})),minimap:ue(new PTe),mouseStyle:ue(new ki(73,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:ue(new ma(74,"mouseWheelScrollSensitivity",1,n=>n===0?1:n,{markdownDescription:_("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:ue(new Ct(75,"mouseWheelZoom",!1,{markdownDescription:_("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:ue(new Ct(76,"multiCursorMergeOverlapping",!0,{description:_("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:ue(new _x(77,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],OTe,{markdownEnumDescriptions:[_("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),_("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:_({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:ue(new ki(78,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[_("multiCursorPaste.spread","Each cursor pastes a single line of the text."),_("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:_("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:ue(new Gt(79,"multiCursorLimit",1e4,1,1e5,{markdownDescription:_("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:ue(new Ct(80,"occurrencesHighlight",!0,{description:_("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:ue(new Ct(81,"overviewRulerBorder",!0,{description:_("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:ue(new Gt(82,"overviewRulerLanes",3,0,3)),padding:ue(new BTe),pasteAs:ue(new tAe),parameterHints:ue(new WTe),peekWidgetDefaultFocus:ue(new ki(86,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[_("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),_("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:_("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:ue(new Ct(87,"definitionLinkOpensInPeek",!1,{description:_("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:ue(new $Te),quickSuggestionsDelay:ue(new Gt(89,"quickSuggestionsDelay",10,0,1073741824,{description:_("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:ue(new Ct(90,"readOnly",!1)),readOnlyMessage:ue(new UTe),renameOnType:ue(new Ct(92,"renameOnType",!1,{description:_("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:_("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:ue(new Ct(93,"renderControlCharacters",!0,{description:_("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:ue(new ki(94,"renderFinalNewline",Ts?"dimmed":"on",["off","on","dimmed"],{description:_("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:ue(new ki(95,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",_("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:_("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:ue(new Ct(96,"renderLineHighlightOnlyWhenFocus",!1,{description:_("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:ue(new ki(97,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:ue(new ki(98,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",_("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),_("renderWhitespace.selection","Render whitespace characters only on selected text."),_("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:_("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:ue(new Gt(99,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:ue(new Ct(100,"roundedSelection",!0,{description:_("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:ue(new HTe),scrollbar:ue(new jTe),scrollBeyondLastColumn:ue(new Gt(103,"scrollBeyondLastColumn",4,0,1073741824,{description:_("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:ue(new Ct(104,"scrollBeyondLastLine",!0,{description:_("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:ue(new Ct(105,"scrollPredominantAxis",!0,{description:_("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:ue(new Ct(106,"selectionClipboard",!0,{description:_("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Ts})),selectionHighlight:ue(new Ct(107,"selectionHighlight",!0,{description:_("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:ue(new Ct(108,"selectOnLineNumbers",!0)),showFoldingControls:ue(new ki(109,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[_("showFoldingControls.always","Always show the folding controls."),_("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),_("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:_("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:ue(new Ct(110,"showUnused",!0,{description:_("showUnused","Controls fading out of unused code.")})),showDeprecated:ue(new Ct(138,"showDeprecated",!0,{description:_("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:ue(new RTe),snippetSuggestions:ue(new ki(111,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[_("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),_("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),_("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),_("snippetSuggestions.none","Do not show snippet suggestions.")],description:_("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:ue(new XTe),smoothScrolling:ue(new Ct(113,"smoothScrolling",!1,{description:_("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:ue(new Gt(116,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:ue(new YTe),inlineSuggest:ue(new GTe),inlineCompletionsAccessibilityVerbose:ue(new Ct(147,"inlineCompletionsAccessibilityVerbose",!1,{description:_("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:ue(new Gt(118,"suggestFontSize",0,0,1e3,{markdownDescription:_("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:ue(new Gt(119,"suggestLineHeight",0,0,1e3,{markdownDescription:_("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:ue(new Ct(120,"suggestOnTriggerCharacters",!0,{description:_("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:ue(new ki(121,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[_("suggestSelection.first","Always select the first suggestion."),_("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),_("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:_("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:ue(new ki(122,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[_("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),_("tabCompletion.off","Disable tab completions."),_("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:_("tabCompletion","Enables tab completions.")})),tabIndex:ue(new Gt(123,"tabIndex",0,-1,1073741824)),unicodeHighlight:ue(new qTe),unusualLineTerminators:ue(new ki(125,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[_("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),_("unusualLineTerminators.off","Unusual line terminators are ignored."),_("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:_("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:ue(new Ct(126,"useShadowDOM",!0)),useTabStops:ue(new Ct(127,"useTabStops",!0,{description:_("useTabStops","Inserting and deleting whitespace follows tab stops.")})),wordBreak:ue(new ki(128,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[_("wordBreak.normal","Use the default line break rule."),_("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:_("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSeparators:ue(new Er(129,"wordSeparators",die,{description:_("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:ue(new ki(130,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[_("wordWrap.off","Lines will never wrap."),_("wordWrap.on","Lines will wrap at the viewport width."),_({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),_({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:_({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:ue(new Er(131,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:ue(new Er(132,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:ue(new Gt(133,"wordWrapColumn",80,1,1073741824,{markdownDescription:_({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:ue(new ki(134,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:ue(new ki(135,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:ue(new STe),defaultColorDecorators:ue(new Ct(145,"defaultColorDecorators",!1,{markdownDescription:_("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:ue(new VTe),tabFocusMode:ue(new Ct(142,"tabFocusMode",!1,{markdownDescription:_("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:ue(new q0),wrappingInfo:ue(new JTe),wrappingIndent:ue(new QTe),wrappingStrategy:ue(new ATe)};class rAe{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?q_.isErrorNoTelemetry(e)?new q_(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const _ie=new rAe;function Ft(n){Qp(n)||_ie.onUnexpectedError(n)}function oh(n){Qp(n)||_ie.onUnexpectedExternalError(n)}function Vz(n){if(n instanceof Error){const{name:e,message:t}=n,i=n.stacktrace||n.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:q_.isErrorNoTelemetry(n)}}return n}const EL="Canceled";function Qp(n){return n instanceof jb?!0:n instanceof Error&&n.name===EL&&n.message===EL}class jb extends Error{constructor(){super(EL),this.name=this.message}}function oAe(){const n=new Error(EL);return n.name=n.message,n}function ju(n){return n?new Error(`Illegal argument: ${n}`):new Error("Illegal argument")}function t8(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}class aAe extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class q_ extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof q_)return e;const t=new q_;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class mn extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,mn.prototype)}}function G_(n){const e=this;let t=!1,i;return function(){return t||(t=!0,i=n.apply(e,arguments)),i}}function lAe(n){return typeof n.dispose=="function"&&n.dispose.length===0}function ti(n){if(Et.is(n)){const e=[];for(const t of n)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function ka(...n){return ut(()=>ti(n))}function ut(n){return{dispose:G_(()=>{n()})}}class Ae{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{ti(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Ae.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}}Ae.DISABLE_DISPOSED_WARNING=!1;class ae{constructor(){this._store=new Ae,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}ae.None=Object.freeze({dispose(){}});class wl{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)===null||t===void 0||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)===null||e===void 0||e.dispose(),this._value=void 0}}class cAe{constructor(e){this.object=e}dispose(){}}class i8{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{ti(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var s;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(s=this._store.get(e))===null||s===void 0||s.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))===null||t===void 0||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const uAe=globalThis.performance&&typeof globalThis.performance.now=="function";class wf{static create(e){return new wf(e)}constructor(e){this._now=uAe&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Ee;(function(n){n.None=()=>ae.None;function e(z,$){return h(z,()=>{},0,void 0,!0,void 0,$)}n.defer=e;function t(z){return($,q=null,ne)=>{let de=!1,me;return me=z(De=>{if(!de)return me?me.dispose():de=!0,$.call(q,De)},null,ne),de&&me.dispose(),me}}n.once=t;function i(z,$,q){return c((ne,de=null,me)=>z(De=>ne.call(de,$(De)),null,me),q)}n.map=i;function s(z,$,q){return c((ne,de=null,me)=>z(De=>{$(De),ne.call(de,De)},null,me),q)}n.forEach=s;function r(z,$,q){return c((ne,de=null,me)=>z(De=>$(De)&&ne.call(de,De),null,me),q)}n.filter=r;function o(z){return z}n.signal=o;function a(...z){return($,q=null,ne)=>{const de=ka(...z.map(me=>me(De=>$.call(q,De))));return u(de,ne)}}n.any=a;function l(z,$,q,ne){let de=q;return i(z,me=>(de=$(de,me),de),ne)}n.reduce=l;function c(z,$){let q;const ne={onWillAddFirstListener(){q=z(de.fire,de)},onDidRemoveLastListener(){q==null||q.dispose()}},de=new G(ne);return $==null||$.add(de),de.event}function u(z,$){return $ instanceof Array?$.push(z):$&&$.add(z),z}function h(z,$,q=100,ne=!1,de=!1,me,De){let ve,$e,Ne,xe=0,fe;const jt={leakWarningThreshold:me,onWillAddFirstListener(){ve=z(re=>{xe++,$e=$($e,re),ne&&!Ne&&(mi.fire($e),$e=void 0),fe=()=>{const te=$e;$e=void 0,Ne=void 0,(!ne||xe>1)&&mi.fire(te),xe=0},typeof q=="number"?(clearTimeout(Ne),Ne=setTimeout(fe,q)):Ne===void 0&&(Ne=0,queueMicrotask(fe))})},onWillRemoveListener(){de&&xe>0&&(fe==null||fe())},onDidRemoveLastListener(){fe=void 0,ve.dispose()}},mi=new G(jt);return De==null||De.add(mi),mi.event}n.debounce=h;function d(z,$=0,q){return n.debounce(z,(ne,de)=>ne?(ne.push(de),ne):[de],$,void 0,!0,void 0,q)}n.accumulate=d;function f(z,$=(ne,de)=>ne===de,q){let ne=!0,de;return r(z,me=>{const De=ne||!$(me,de);return ne=!1,de=me,De},q)}n.latch=f;function g(z,$,q){return[n.filter(z,$,q),n.filter(z,ne=>!$(ne),q)]}n.split=g;function p(z,$=!1,q=[],ne){let de=q.slice(),me=z($e=>{de?de.push($e):ve.fire($e)});ne&&ne.add(me);const De=()=>{de==null||de.forEach($e=>ve.fire($e)),de=null},ve=new G({onWillAddFirstListener(){me||(me=z($e=>ve.fire($e)),ne&&ne.add(me))},onDidAddFirstListener(){de&&($?setTimeout(De):De())},onDidRemoveLastListener(){me&&me.dispose(),me=null}});return ne&&ne.add(ve),ve.event}n.buffer=p;function m(z,$){return(ne,de,me)=>{const De=$(new v);return z(function(ve){const $e=De.evaluate(ve);$e!==b&&ne.call(de,$e)},void 0,me)}}n.chain=m;const b=Symbol("HaltChainable");class v{constructor(){this.steps=[]}map($){return this.steps.push($),this}forEach($){return this.steps.push(q=>($(q),q)),this}filter($){return this.steps.push(q=>$(q)?q:b),this}reduce($,q){let ne=q;return this.steps.push(de=>(ne=$(ne,de),ne)),this}latch($=(q,ne)=>q===ne){let q=!0,ne;return this.steps.push(de=>{const me=q||!$(de,ne);return q=!1,ne=de,me?de:b}),this}evaluate($){for(const q of this.steps)if($=q($),$===b)break;return $}}function w(z,$,q=ne=>ne){const ne=(...ve)=>De.fire(q(...ve)),de=()=>z.on($,ne),me=()=>z.removeListener($,ne),De=new G({onWillAddFirstListener:de,onDidRemoveLastListener:me});return De.event}n.fromNodeEventEmitter=w;function y(z,$,q=ne=>ne){const ne=(...ve)=>De.fire(q(...ve)),de=()=>z.addEventListener($,ne),me=()=>z.removeEventListener($,ne),De=new G({onWillAddFirstListener:de,onDidRemoveLastListener:me});return De.event}n.fromDOMEventEmitter=y;function x(z){return new Promise($=>t(z)($))}n.toPromise=x;function D(z){const $=new G;return z.then(q=>{$.fire(q)},()=>{$.fire(void 0)}).finally(()=>{$.dispose()}),$.event}n.fromPromise=D;function S(z,$){return $(void 0),z(q=>$(q))}n.runAndSubscribe=S;function T(z,$){let q=null;function ne(me){q==null||q.dispose(),q=new Ae,$(me,q)}ne(void 0);const de=z(me=>ne(me));return ut(()=>{de.dispose(),q==null||q.dispose()})}n.runAndSubscribeWithStore=T;class k{constructor($,q){this._observable=$,this._counter=0,this._hasChanged=!1;const ne={onWillAddFirstListener:()=>{$.addObserver(this)},onDidRemoveLastListener:()=>{$.removeObserver(this)}};this.emitter=new G(ne),q&&q.add(this.emitter)}beginUpdate($){this._counter++}handlePossibleChange($){}handleChange($,q){this._hasChanged=!0}endUpdate($){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function I(z,$){return new k(z,$).emitter.event}n.fromObservable=I;function N(z){return $=>{let q=0,ne=!1;const de={beginUpdate(){q++},endUpdate(){q--,q===0&&(z.reportChanges(),ne&&(ne=!1,$()))},handlePossibleChange(){},handleChange(){ne=!0}};return z.addObserver(de),z.reportChanges(),{dispose(){z.removeObserver(de)}}}}n.fromObservableLight=N})(Ee||(Ee={}));class K_{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${K_._idPool++}`,K_.all.add(this)}start(e){this._stopWatch=new wf,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}}K_.all=new Set;K_._idPool=0;let hAe=-1;class dAe{constructor(e,t=Math.random().toString(18).slice(2,5)){this.threshold=e,this.name=t,this._warnCountdown=0}dispose(){var e;(e=this._stacks)===null||e===void 0||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const s=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,s+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let r,o=0;for(const[a,l]of this._stacks)(!r||o<l)&&(r=a,o=l);console.warn(`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`),console.warn(r)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}}class n8{static create(){var e;return new n8((e=new Error().stack)!==null&&e!==void 0?e:"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class SN{constructor(e){this.value=e}}const fAe=2;let G=class{constructor(e){var t,i,s,r,o;this._size=0,this._options=e,this._leakageMon=!((t=this._options)===null||t===void 0)&&t.leakWarningThreshold?new dAe((s=(i=this._options)===null||i===void 0?void 0:i.leakWarningThreshold)!==null&&s!==void 0?s:hAe):void 0,this._perfMon=!((r=this._options)===null||r===void 0)&&r._profName?new K_(this._options._profName):void 0,this._deliveryQueue=(o=this._options)===null||o===void 0?void 0:o.deliveryQueue}dispose(){var e,t,i,s;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)===null||e===void 0?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)===null||t===void 0?void 0:t.onDidRemoveLastListener)===null||i===void 0||i.call(t),(s=this._leakageMon)===null||s===void 0||s.dispose())}get event(){var e;return(e=this._event)!==null&&e!==void 0||(this._event=(t,i,s)=>{var r,o,a,l,c;if(this._leakageMon&&this._size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),ae.None;if(this._disposed)return ae.None;i&&(t=t.bind(i));const u=new SN(t);let h;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(u.stack=n8.create(),h=this._leakageMon.check(u.stack,this._size+1)),this._listeners?this._listeners instanceof SN?((c=this._deliveryQueue)!==null&&c!==void 0||(this._deliveryQueue=new bie),this._listeners=[this._listeners,u]):this._listeners.push(u):((o=(r=this._options)===null||r===void 0?void 0:r.onWillAddFirstListener)===null||o===void 0||o.call(r,this),this._listeners=u,(l=(a=this._options)===null||a===void 0?void 0:a.onDidAddFirstListener)===null||l===void 0||l.call(a,this)),this._size++;const d=ut(()=>{h==null||h(),this._removeListener(u)});return s instanceof Ae?s.add(d):Array.isArray(s)&&s.push(d),d}),this._event}_removeListener(e){var t,i,s,r;if((i=(t=this._options)===null||t===void 0?void 0:t.onWillRemoveListener)===null||i===void 0||i.call(t,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(r=(s=this._options)===null||s===void 0?void 0:s.onDidRemoveLastListener)===null||r===void 0||r.call(s,this),this._size=0;return}const o=this._listeners,a=o.indexOf(e);if(a===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,o[a]=void 0;const l=this._deliveryQueue.current===this;if(this._size*fAe<=o.length){let c=0;for(let u=0;u<o.length;u++)o[u]?o[c++]=o[u]:l&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);o.length=c}}_deliver(e,t){var i;if(!e)return;const s=((i=this._options)===null||i===void 0?void 0:i.onListenerError)||Ft;if(!s){e.value(t);return}try{e.value(t)}catch(r){s(r)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,s,r;if(!((t=this._deliveryQueue)===null||t===void 0)&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)===null||i===void 0||i.stop()),(s=this._perfMon)===null||s===void 0||s.start(this._size),this._listeners)if(this._listeners instanceof SN)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(r=this._perfMon)===null||r===void 0||r.stop()}hasListeners(){return this._size>0}};const gAe=()=>new bie;class bie{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class oy extends G{constructor(e){super(e),this._isPaused=0,this._eventQueue=new hr,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class vie extends oy{constructor(e){var t;super(e),this._delay=(t=e.delay)!==null&&t!==void 0?t:100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class pAe extends G{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class mAe{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new G({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),ut(G_(()=>{this.hasListeners&&this.unhook(t);const s=this.events.indexOf(t);this.events.splice(s,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener&&e.listener.dispose(),e.listener=null}dispose(){this.emitter.dispose()}}class s8{constructor(){this.buffers=[]}wrapEvent(e){return(t,i,s)=>e(r=>{const o=this.buffers[this.buffers.length-1];o?o.push(()=>t.call(i,r)):t.call(i,r)},void 0,s)}bufferEvents(e){const t=[];this.buffers.push(t);const i=e();return this.buffers.pop(),t.forEach(s=>s()),i}}class $z{constructor(){this.listening=!1,this.inputEvent=Ee.None,this.inputEventListener=ae.None,this.emitter=new G({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const wie=Object.freeze(function(n,e){const t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}});var In;(function(n){function e(t){return t===n.None||t===n.Cancelled||t instanceof q2?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}n.isCancellationToken=e,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ee.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:wie})})(In||(In={}));class q2{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?wie:(this._emitter||(this._emitter=new G),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let Wa=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new q2),this._token}cancel(){this._token?this._token instanceof q2&&this._token.cancel():this._token=In.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)===null||t===void 0||t.dispose(),this._token?this._token instanceof q2&&this._token.dispose():this._token=In.None}};class r8{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const G2=new r8,$4=new r8,z4=new r8,yie=new Array(230),_Ae=Object.create(null),bAe=Object.create(null),o8=[];for(let n=0;n<=193;n++)o8[n]=-1;(function(){const n="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",n,n],[1,1,"Hyper",0,n,0,n,n,n],[1,2,"Super",0,n,0,n,n,n],[1,3,"Fn",0,n,0,n,n,n],[1,4,"FnLock",0,n,0,n,n,n],[1,5,"Suspend",0,n,0,n,n,n],[1,6,"Resume",0,n,0,n,n,n],[1,7,"Turbo",0,n,0,n,n,n],[1,8,"Sleep",0,n,0,"VK_SLEEP",n,n],[1,9,"WakeUp",0,n,0,n,n,n],[0,10,"KeyA",31,"A",65,"VK_A",n,n],[0,11,"KeyB",32,"B",66,"VK_B",n,n],[0,12,"KeyC",33,"C",67,"VK_C",n,n],[0,13,"KeyD",34,"D",68,"VK_D",n,n],[0,14,"KeyE",35,"E",69,"VK_E",n,n],[0,15,"KeyF",36,"F",70,"VK_F",n,n],[0,16,"KeyG",37,"G",71,"VK_G",n,n],[0,17,"KeyH",38,"H",72,"VK_H",n,n],[0,18,"KeyI",39,"I",73,"VK_I",n,n],[0,19,"KeyJ",40,"J",74,"VK_J",n,n],[0,20,"KeyK",41,"K",75,"VK_K",n,n],[0,21,"KeyL",42,"L",76,"VK_L",n,n],[0,22,"KeyM",43,"M",77,"VK_M",n,n],[0,23,"KeyN",44,"N",78,"VK_N",n,n],[0,24,"KeyO",45,"O",79,"VK_O",n,n],[0,25,"KeyP",46,"P",80,"VK_P",n,n],[0,26,"KeyQ",47,"Q",81,"VK_Q",n,n],[0,27,"KeyR",48,"R",82,"VK_R",n,n],[0,28,"KeyS",49,"S",83,"VK_S",n,n],[0,29,"KeyT",50,"T",84,"VK_T",n,n],[0,30,"KeyU",51,"U",85,"VK_U",n,n],[0,31,"KeyV",52,"V",86,"VK_V",n,n],[0,32,"KeyW",53,"W",87,"VK_W",n,n],[0,33,"KeyX",54,"X",88,"VK_X",n,n],[0,34,"KeyY",55,"Y",89,"VK_Y",n,n],[0,35,"KeyZ",56,"Z",90,"VK_Z",n,n],[0,36,"Digit1",22,"1",49,"VK_1",n,n],[0,37,"Digit2",23,"2",50,"VK_2",n,n],[0,38,"Digit3",24,"3",51,"VK_3",n,n],[0,39,"Digit4",25,"4",52,"VK_4",n,n],[0,40,"Digit5",26,"5",53,"VK_5",n,n],[0,41,"Digit6",27,"6",54,"VK_6",n,n],[0,42,"Digit7",28,"7",55,"VK_7",n,n],[0,43,"Digit8",29,"8",56,"VK_8",n,n],[0,44,"Digit9",30,"9",57,"VK_9",n,n],[0,45,"Digit0",21,"0",48,"VK_0",n,n],[1,46,"Enter",3,"Enter",13,"VK_RETURN",n,n],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",n,n],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",n,n],[1,49,"Tab",2,"Tab",9,"VK_TAB",n,n],[1,50,"Space",10,"Space",32,"VK_SPACE",n,n],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,n,0,n,n,n],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",n,n],[1,64,"F1",59,"F1",112,"VK_F1",n,n],[1,65,"F2",60,"F2",113,"VK_F2",n,n],[1,66,"F3",61,"F3",114,"VK_F3",n,n],[1,67,"F4",62,"F4",115,"VK_F4",n,n],[1,68,"F5",63,"F5",116,"VK_F5",n,n],[1,69,"F6",64,"F6",117,"VK_F6",n,n],[1,70,"F7",65,"F7",118,"VK_F7",n,n],[1,71,"F8",66,"F8",119,"VK_F8",n,n],[1,72,"F9",67,"F9",120,"VK_F9",n,n],[1,73,"F10",68,"F10",121,"VK_F10",n,n],[1,74,"F11",69,"F11",122,"VK_F11",n,n],[1,75,"F12",70,"F12",123,"VK_F12",n,n],[1,76,"PrintScreen",0,n,0,n,n,n],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",n,n],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",n,n],[1,79,"Insert",19,"Insert",45,"VK_INSERT",n,n],[1,80,"Home",14,"Home",36,"VK_HOME",n,n],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",n,n],[1,82,"Delete",20,"Delete",46,"VK_DELETE",n,n],[1,83,"End",13,"End",35,"VK_END",n,n],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",n,n],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",n],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",n],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",n],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",n],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",n,n],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",n,n],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",n,n],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",n,n],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",n,n],[1,94,"NumpadEnter",3,n,0,n,n,n],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",n,n],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",n,n],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",n,n],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",n,n],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",n,n],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",n,n],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",n,n],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",n,n],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",n,n],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",n,n],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",n,n],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",n,n],[1,107,"ContextMenu",58,"ContextMenu",93,n,n,n],[1,108,"Power",0,n,0,n,n,n],[1,109,"NumpadEqual",0,n,0,n,n,n],[1,110,"F13",71,"F13",124,"VK_F13",n,n],[1,111,"F14",72,"F14",125,"VK_F14",n,n],[1,112,"F15",73,"F15",126,"VK_F15",n,n],[1,113,"F16",74,"F16",127,"VK_F16",n,n],[1,114,"F17",75,"F17",128,"VK_F17",n,n],[1,115,"F18",76,"F18",129,"VK_F18",n,n],[1,116,"F19",77,"F19",130,"VK_F19",n,n],[1,117,"F20",78,"F20",131,"VK_F20",n,n],[1,118,"F21",79,"F21",132,"VK_F21",n,n],[1,119,"F22",80,"F22",133,"VK_F22",n,n],[1,120,"F23",81,"F23",134,"VK_F23",n,n],[1,121,"F24",82,"F24",135,"VK_F24",n,n],[1,122,"Open",0,n,0,n,n,n],[1,123,"Help",0,n,0,n,n,n],[1,124,"Select",0,n,0,n,n,n],[1,125,"Again",0,n,0,n,n,n],[1,126,"Undo",0,n,0,n,n,n],[1,127,"Cut",0,n,0,n,n,n],[1,128,"Copy",0,n,0,n,n,n],[1,129,"Paste",0,n,0,n,n,n],[1,130,"Find",0,n,0,n,n,n],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",n,n],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",n,n],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",n,n],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",n,n],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",n,n],[1,136,"KanaMode",0,n,0,n,n,n],[0,137,"IntlYen",0,n,0,n,n,n],[1,138,"Convert",0,n,0,n,n,n],[1,139,"NonConvert",0,n,0,n,n,n],[1,140,"Lang1",0,n,0,n,n,n],[1,141,"Lang2",0,n,0,n,n,n],[1,142,"Lang3",0,n,0,n,n,n],[1,143,"Lang4",0,n,0,n,n,n],[1,144,"Lang5",0,n,0,n,n,n],[1,145,"Abort",0,n,0,n,n,n],[1,146,"Props",0,n,0,n,n,n],[1,147,"NumpadParenLeft",0,n,0,n,n,n],[1,148,"NumpadParenRight",0,n,0,n,n,n],[1,149,"NumpadBackspace",0,n,0,n,n,n],[1,150,"NumpadMemoryStore",0,n,0,n,n,n],[1,151,"NumpadMemoryRecall",0,n,0,n,n,n],[1,152,"NumpadMemoryClear",0,n,0,n,n,n],[1,153,"NumpadMemoryAdd",0,n,0,n,n,n],[1,154,"NumpadMemorySubtract",0,n,0,n,n,n],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",n,n],[1,156,"NumpadClearEntry",0,n,0,n,n,n],[1,0,n,5,"Ctrl",17,"VK_CONTROL",n,n],[1,0,n,4,"Shift",16,"VK_SHIFT",n,n],[1,0,n,6,"Alt",18,"VK_MENU",n,n],[1,0,n,57,"Meta",91,"VK_COMMAND",n,n],[1,157,"ControlLeft",5,n,0,"VK_LCONTROL",n,n],[1,158,"ShiftLeft",4,n,0,"VK_LSHIFT",n,n],[1,159,"AltLeft",6,n,0,"VK_LMENU",n,n],[1,160,"MetaLeft",57,n,0,"VK_LWIN",n,n],[1,161,"ControlRight",5,n,0,"VK_RCONTROL",n,n],[1,162,"ShiftRight",4,n,0,"VK_RSHIFT",n,n],[1,163,"AltRight",6,n,0,"VK_RMENU",n,n],[1,164,"MetaRight",57,n,0,"VK_RWIN",n,n],[1,165,"BrightnessUp",0,n,0,n,n,n],[1,166,"BrightnessDown",0,n,0,n,n,n],[1,167,"MediaPlay",0,n,0,n,n,n],[1,168,"MediaRecord",0,n,0,n,n,n],[1,169,"MediaFastForward",0,n,0,n,n,n],[1,170,"MediaRewind",0,n,0,n,n,n],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",n,n],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",n,n],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",n,n],[1,174,"Eject",0,n,0,n,n,n],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",n,n],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",n,n],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",n,n],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",n,n],[1,179,"LaunchApp1",0,n,0,"VK_MEDIA_LAUNCH_APP1",n,n],[1,180,"SelectTask",0,n,0,n,n,n],[1,181,"LaunchScreenSaver",0,n,0,n,n,n],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",n,n],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",n,n],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",n,n],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",n,n],[1,186,"BrowserStop",0,n,0,"VK_BROWSER_STOP",n,n],[1,187,"BrowserRefresh",0,n,0,"VK_BROWSER_REFRESH",n,n],[1,188,"BrowserFavorites",0,n,0,"VK_BROWSER_FAVORITES",n,n],[1,189,"ZoomToggle",0,n,0,n,n,n],[1,190,"MailReply",0,n,0,n,n,n],[1,191,"MailForward",0,n,0,n,n,n],[1,192,"MailSend",0,n,0,n,n,n],[1,0,n,114,"KeyInComposition",229,n,n,n],[1,0,n,116,"ABNT_C2",194,"VK_ABNT_C2",n,n],[1,0,n,96,"OEM_8",223,"VK_OEM_8",n,n],[1,0,n,0,n,0,"VK_KANA",n,n],[1,0,n,0,n,0,"VK_HANGUL",n,n],[1,0,n,0,n,0,"VK_JUNJA",n,n],[1,0,n,0,n,0,"VK_FINAL",n,n],[1,0,n,0,n,0,"VK_HANJA",n,n],[1,0,n,0,n,0,"VK_KANJI",n,n],[1,0,n,0,n,0,"VK_CONVERT",n,n],[1,0,n,0,n,0,"VK_NONCONVERT",n,n],[1,0,n,0,n,0,"VK_ACCEPT",n,n],[1,0,n,0,n,0,"VK_MODECHANGE",n,n],[1,0,n,0,n,0,"VK_SELECT",n,n],[1,0,n,0,n,0,"VK_PRINT",n,n],[1,0,n,0,n,0,"VK_EXECUTE",n,n],[1,0,n,0,n,0,"VK_SNAPSHOT",n,n],[1,0,n,0,n,0,"VK_HELP",n,n],[1,0,n,0,n,0,"VK_APPS",n,n],[1,0,n,0,n,0,"VK_PROCESSKEY",n,n],[1,0,n,0,n,0,"VK_PACKET",n,n],[1,0,n,0,n,0,"VK_DBE_SBCSCHAR",n,n],[1,0,n,0,n,0,"VK_DBE_DBCSCHAR",n,n],[1,0,n,0,n,0,"VK_ATTN",n,n],[1,0,n,0,n,0,"VK_CRSEL",n,n],[1,0,n,0,n,0,"VK_EXSEL",n,n],[1,0,n,0,n,0,"VK_EREOF",n,n],[1,0,n,0,n,0,"VK_PLAY",n,n],[1,0,n,0,n,0,"VK_ZOOM",n,n],[1,0,n,0,n,0,"VK_NONAME",n,n],[1,0,n,0,n,0,"VK_PA1",n,n],[1,0,n,0,n,0,"VK_OEM_CLEAR",n,n]],t=[],i=[];for(const s of e){const[r,o,a,l,c,u,h,d,f]=s;if(i[o]||(i[o]=!0,_Ae[a]=o,bAe[a.toLowerCase()]=o,r&&(o8[o]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);G2.define(l,c),$4.define(l,d||c),z4.define(l,f||d||c)}u&&(yie[u]=l)}})();var Du;(function(n){function e(a){return G2.keyCodeToStr(a)}n.toString=e;function t(a){return G2.strToKeyCode(a)}n.fromString=t;function i(a){return $4.keyCodeToStr(a)}n.toUserSettingsUS=i;function s(a){return z4.keyCodeToStr(a)}n.toUserSettingsGeneral=s;function r(a){return $4.strToKeyCode(a)||z4.strToKeyCode(a)}n.fromUserSettings=r;function o(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return G2.keyCodeToStr(a)}n.toElectronAccelerator=o})(Du||(Du={}));function ms(n,e){const t=(e&65535)<<16>>>0;return(n|t)>>>0}let K0;if(typeof xa.vscode<"u"&&typeof xa.vscode.process<"u"){const n=xa.vscode.process;K0={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"?K0={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:K0={get platform(){return br?"win32":Mt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const TL=K0.cwd,Cie=K0.env,vAe=K0.platform,wAe=65,yAe=97,CAe=90,SAe=122,Ld=46,Cs=47,Zr=92,Ch=58,xAe=63;class Sie extends Error{constructor(e,t,i){let s;typeof t=="string"&&t.indexOf("not ")===0?(s="must not be",t=t.replace(/^not /,"")):s="must be";const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${s} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function kAe(n,e){if(n===null||typeof n!="object")throw new Sie(e,"Object",n)}function kn(n,e){if(typeof n!="string")throw new Sie(e,"string",n)}const yf=vAe==="win32";function zt(n){return n===Cs||n===Zr}function H4(n){return n===Cs}function Sh(n){return n>=wAe&&n<=CAe||n>=yAe&&n<=SAe}function AL(n,e,t,i){let s="",r=0,o=-1,a=0,l=0;for(let c=0;c<=n.length;++c){if(c<n.length)l=n.charCodeAt(c);else{if(i(l))break;l=Cs}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==Ld||s.charCodeAt(s.length-2)!==Ld){if(s.length>2){const u=s.lastIndexOf(t);u===-1?(s="",r=0):(s=s.slice(0,u),r=s.length-1-s.lastIndexOf(t)),o=c,a=0;continue}else if(s.length!==0){s="",r=0,o=c,a=0;continue}}e&&(s+=s.length>0?`${t}..`:"..",r=2)}else s.length>0?s+=`${t}${n.slice(o+1,c)}`:s=n.slice(o+1,c),r=c-o-1;o=c,a=0}else l===Ld&&a!==-1?++a:a=-1}return s}function xie(n,e){kAe(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${n}${i}`:i}const Fr={resolve(...n){let e="",t="",i=!1;for(let s=n.length-1;s>=-1;s--){let r;if(s>=0){if(r=n[s],kn(r,"path"),r.length===0)continue}else e.length===0?r=TL():(r=Cie[`=${e}`]||TL(),(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===Zr)&&(r=`${e}\\`));const o=r.length;let a=0,l="",c=!1;const u=r.charCodeAt(0);if(o===1)zt(u)&&(a=1,c=!0);else if(zt(u))if(c=!0,zt(r.charCodeAt(1))){let h=2,d=h;for(;h<o&&!zt(r.charCodeAt(h));)h++;if(h<o&&h!==d){const f=r.slice(d,h);for(d=h;h<o&&zt(r.charCodeAt(h));)h++;if(h<o&&h!==d){for(d=h;h<o&&!zt(r.charCodeAt(h));)h++;(h===o||h!==d)&&(l=`\\\\${f}\\${r.slice(d,h)}`,a=h)}}}else a=1;else Sh(u)&&r.charCodeAt(1)===Ch&&(l=r.slice(0,2),a=2,o>2&&zt(r.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${r.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=AL(t,!i,"\\",zt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){kn(n,"path");const e=n.length;if(e===0)return".";let t=0,i,s=!1;const r=n.charCodeAt(0);if(e===1)return H4(r)?"\\":n;if(zt(r))if(s=!0,zt(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!zt(n.charCodeAt(a));)a++;if(a<e&&a!==l){const c=n.slice(l,a);for(l=a;a<e&&zt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!zt(n.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${n.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${n.slice(l,a)}`,t=a)}}}else t=1;else Sh(r)&&n.charCodeAt(1)===Ch&&(i=n.slice(0,2),t=2,e>2&&zt(n.charCodeAt(2))&&(s=!0,t=3));let o=t<e?AL(n.slice(t),!s,"\\",zt):"";return o.length===0&&!s&&(o="."),o.length>0&&zt(n.charCodeAt(e-1))&&(o+="\\"),i===void 0?s?`\\${o}`:o:s?`${i}\\${o}`:`${i}${o}`},isAbsolute(n){kn(n,"path");const e=n.length;if(e===0)return!1;const t=n.charCodeAt(0);return zt(t)||e>2&&Sh(t)&&n.charCodeAt(1)===Ch&&zt(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let r=0;r<n.length;++r){const o=n[r];kn(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,s=0;if(typeof t=="string"&&zt(t.charCodeAt(0))){++s;const r=t.length;r>1&&zt(t.charCodeAt(1))&&(++s,r>2&&(zt(t.charCodeAt(2))?++s:i=!1))}if(i){for(;s<e.length&&zt(e.charCodeAt(s));)s++;s>=2&&(e=`\\${e.slice(s)}`)}return Fr.normalize(e)},relative(n,e){if(kn(n,"from"),kn(e,"to"),n===e)return"";const t=Fr.resolve(n),i=Fr.resolve(e);if(t===i||(n=t.toLowerCase(),e=i.toLowerCase(),n===e))return"";let s=0;for(;s<n.length&&n.charCodeAt(s)===Zr;)s++;let r=n.length;for(;r-1>s&&n.charCodeAt(r-1)===Zr;)r--;const o=r-s;let a=0;for(;a<e.length&&e.charCodeAt(a)===Zr;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Zr;)l--;const c=l-a,u=o<c?o:c;let h=-1,d=0;for(;d<u;d++){const g=n.charCodeAt(s+d);if(g!==e.charCodeAt(a+d))break;g===Zr&&(h=d)}if(d!==u){if(h===-1)return i}else{if(c>u){if(e.charCodeAt(a+d)===Zr)return i.slice(a+d+1);if(d===2)return i.slice(a+d)}o>u&&(n.charCodeAt(s+d)===Zr?h=d:d===2&&(h=3)),h===-1&&(h=0)}let f="";for(d=s+h+1;d<=r;++d)(d===r||n.charCodeAt(d)===Zr)&&(f+=f.length===0?"..":"\\..");return a+=h,f.length>0?`${f}${i.slice(a,l)}`:(i.charCodeAt(a)===Zr&&++a,i.slice(a,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;const e=Fr.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===Zr){if(e.charCodeAt(1)===Zr){const t=e.charCodeAt(2);if(t!==xAe&&t!==Ld)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Sh(e.charCodeAt(0))&&e.charCodeAt(1)===Ch&&e.charCodeAt(2)===Zr)return`\\\\?\\${e}`;return n},dirname(n){kn(n,"path");const e=n.length;if(e===0)return".";let t=-1,i=0;const s=n.charCodeAt(0);if(e===1)return zt(s)?n:".";if(zt(s)){if(t=i=1,zt(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!zt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&zt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!zt(n.charCodeAt(a));)a++;if(a===e)return n;a!==l&&(t=i=a+1)}}}}else Sh(s)&&n.charCodeAt(1)===Ch&&(t=e>2&&zt(n.charCodeAt(2))?3:2,i=t);let r=-1,o=!0;for(let a=e-1;a>=i;--a)if(zt(n.charCodeAt(a))){if(!o){r=a;break}}else o=!1;if(r===-1){if(t===-1)return".";r=t}return n.slice(0,r)},basename(n,e){e!==void 0&&kn(e,"ext"),kn(n,"path");let t=0,i=-1,s=!0,r;if(n.length>=2&&Sh(n.charCodeAt(0))&&n.charCodeAt(1)===Ch&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(r=n.length-1;r>=t;--r){const l=n.charCodeAt(r);if(zt(l)){if(!s){t=r+1;break}}else a===-1&&(s=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(r=n.length-1;r>=t;--r)if(zt(n.charCodeAt(r))){if(!s){t=r+1;break}}else i===-1&&(s=!1,i=r+1);return i===-1?"":n.slice(t,i)},extname(n){kn(n,"path");let e=0,t=-1,i=0,s=-1,r=!0,o=0;n.length>=2&&n.charCodeAt(1)===Ch&&Sh(n.charCodeAt(0))&&(e=i=2);for(let a=n.length-1;a>=e;--a){const l=n.charCodeAt(a);if(zt(l)){if(!r){i=a+1;break}continue}s===-1&&(r=!1,s=a+1),l===Ld?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||s===-1||o===0||o===1&&t===s-1&&t===i+1?"":n.slice(t,s)},format:xie.bind(null,"\\"),parse(n){kn(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.length;let i=0,s=n.charCodeAt(0);if(t===1)return zt(s)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(zt(s)){if(i=1,zt(n.charCodeAt(1))){let h=2,d=h;for(;h<t&&!zt(n.charCodeAt(h));)h++;if(h<t&&h!==d){for(d=h;h<t&&zt(n.charCodeAt(h));)h++;if(h<t&&h!==d){for(d=h;h<t&&!zt(n.charCodeAt(h));)h++;h===t?i=h:h!==d&&(i=h+1)}}}}else if(Sh(s)&&n.charCodeAt(1)===Ch){if(t<=2)return e.root=e.dir=n,e;if(i=2,zt(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;i=3}}i>0&&(e.root=n.slice(0,i));let r=-1,o=i,a=-1,l=!0,c=n.length-1,u=0;for(;c>=i;--c){if(s=n.charCodeAt(c),zt(s)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),s===Ld?r===-1?r=c:u!==1&&(u=1):r!==-1&&(u=-1)}return a!==-1&&(r===-1||u===0||u===1&&r===a-1&&r===o+1?e.base=e.name=n.slice(o,a):(e.name=n.slice(o,r),e.base=n.slice(o,a),e.ext=n.slice(r,a))),o>0&&o!==i?e.dir=n.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},LAe=(()=>{if(yf){const n=/\\/g;return()=>{const e=TL().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>TL()})(),rn={resolve(...n){let e="",t=!1;for(let i=n.length-1;i>=-1&&!t;i--){const s=i>=0?n[i]:LAe();kn(s,"path"),s.length!==0&&(e=`${s}/${e}`,t=s.charCodeAt(0)===Cs)}return e=AL(e,!t,"/",H4),t?`/${e}`:e.length>0?e:"."},normalize(n){if(kn(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===Cs,t=n.charCodeAt(n.length-1)===Cs;return n=AL(n,!e,"/",H4),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return kn(n,"path"),n.length>0&&n.charCodeAt(0)===Cs},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];kn(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":rn.normalize(e)},relative(n,e){if(kn(n,"from"),kn(e,"to"),n===e||(n=rn.resolve(n),e=rn.resolve(e),n===e))return"";const t=1,i=n.length,s=i-t,r=1,o=e.length-r,a=s<o?s:o;let l=-1,c=0;for(;c<a;c++){const h=n.charCodeAt(t+c);if(h!==e.charCodeAt(r+c))break;h===Cs&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(r+c)===Cs)return e.slice(r+c+1);if(c===0)return e.slice(r+c)}else s>a&&(n.charCodeAt(t+c)===Cs?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=i;++c)(c===i||n.charCodeAt(c)===Cs)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(r+l)}`},toNamespacedPath(n){return n},dirname(n){if(kn(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===Cs;let t=-1,i=!0;for(let s=n.length-1;s>=1;--s)if(n.charCodeAt(s)===Cs){if(!i){t=s;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&kn(e,"ext"),kn(n,"path");let t=0,i=-1,s=!0,r;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(r=n.length-1;r>=0;--r){const l=n.charCodeAt(r);if(l===Cs){if(!s){t=r+1;break}}else a===-1&&(s=!1,a=r+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=r):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(r=n.length-1;r>=0;--r)if(n.charCodeAt(r)===Cs){if(!s){t=r+1;break}}else i===-1&&(s=!1,i=r+1);return i===-1?"":n.slice(t,i)},extname(n){kn(n,"path");let e=-1,t=0,i=-1,s=!0,r=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===Cs){if(!s){t=o+1;break}continue}i===-1&&(s=!1,i=o+1),a===Ld?e===-1?e=o:r!==1&&(r=1):e!==-1&&(r=-1)}return e===-1||i===-1||r===0||r===1&&e===i-1&&e===t+1?"":n.slice(e,i)},format:xie.bind(null,"/"),parse(n){kn(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.charCodeAt(0)===Cs;let i;t?(e.root="/",i=1):i=0;let s=-1,r=0,o=-1,a=!0,l=n.length-1,c=0;for(;l>=i;--l){const u=n.charCodeAt(l);if(u===Cs){if(!a){r=l+1;break}continue}o===-1&&(a=!1,o=l+1),u===Ld?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(o!==-1){const u=r===0&&t?1:r;s===-1||c===0||c===1&&s===o-1&&s===r+1?e.base=e.name=n.slice(u,o):(e.name=n.slice(u,s),e.base=n.slice(u,o),e.ext=n.slice(s,o))}return r>0?e.dir=n.slice(0,r-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};rn.win32=Fr.win32=Fr;rn.posix=Fr.posix=rn;const kie=yf?Fr.normalize:rn.normalize,DAe=yf?Fr.resolve:rn.resolve,EAe=yf?Fr.relative:rn.relative,TAe=yf?Fr.dirname:rn.dirname,Lie=yf?Fr.basename:rn.basename,AAe=yf?Fr.extname:rn.extname,Dd=yf?Fr.sep:rn.sep,IAe=/^\w[\w\d+.-]*$/,NAe=/^\//,RAe=/^\/\//;function MAe(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!IAe.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!NAe.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(RAe.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function FAe(n,e){return!n&&!e?"file":n}function PAe(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==ol&&(e=ol+e):e=ol;break}return e}const Bi="",ol="/",OAe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class ot{static isUri(e){return e instanceof ot?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,s,r,o=!1){typeof e=="object"?(this.scheme=e.scheme||Bi,this.authority=e.authority||Bi,this.path=e.path||Bi,this.query=e.query||Bi,this.fragment=e.fragment||Bi):(this.scheme=FAe(e,o),this.authority=t||Bi,this.path=PAe(this.scheme,i||Bi),this.query=s||Bi,this.fragment=r||Bi,MAe(this,o))}get fsPath(){return IL(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:s,query:r,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=Bi),i===void 0?i=this.authority:i===null&&(i=Bi),s===void 0?s=this.path:s===null&&(s=Bi),r===void 0?r=this.query:r===null&&(r=Bi),o===void 0?o=this.fragment:o===null&&(o=Bi),t===this.scheme&&i===this.authority&&s===this.path&&r===this.query&&o===this.fragment?this:new Rm(t,i,s,r,o)}static parse(e,t=!1){const i=OAe.exec(e);return i?new Rm(i[2]||Bi,bx(i[4]||Bi),bx(i[5]||Bi),bx(i[7]||Bi),bx(i[9]||Bi),t):new Rm(Bi,Bi,Bi,Bi,Bi)}static file(e){let t=Bi;if(br&&(e=e.replace(/\\/g,ol)),e[0]===ol&&e[1]===ol){const i=e.indexOf(ol,2);i===-1?(t=e.substring(2),e=ol):(t=e.substring(2,i),e=e.substring(i)||ol)}return new Rm("file",t,e,Bi,Bi)}static from(e,t){return new Rm(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return br&&e.scheme==="file"?i=ot.file(Fr.join(IL(e,!0),...t)).path:i=rn.join(e.path,...t),e.with({path:i})}toString(e=!1){return U4(this,e)}toJSON(){return this}static revive(e){var t,i;if(e){if(e instanceof ot)return e;{const s=new Rm(e);return s._formatted=(t=e.external)!==null&&t!==void 0?t:null,s._fsPath=e._sep===Die&&(i=e.fsPath)!==null&&i!==void 0?i:null,s}}else return e}}const Die=br?1:void 0;let Rm=class extends ot{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=IL(this,!1)),this._fsPath}toString(e=!1){return e?U4(this,!0):(this._formatted||(this._formatted=U4(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Die),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const Eie={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function zz(n,e,t){let i,s=-1;for(let r=0;r<n.length;r++){const o=n.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58)s!==-1&&(i+=encodeURIComponent(n.substring(s,r)),s=-1),i!==void 0&&(i+=n.charAt(r));else{i===void 0&&(i=n.substr(0,r));const a=Eie[o];a!==void 0?(s!==-1&&(i+=encodeURIComponent(n.substring(s,r)),s=-1),i+=a):s===-1&&(s=r)}}return s!==-1&&(i+=encodeURIComponent(n.substring(s))),i!==void 0?i:n}function BAe(n){let e;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i===35||i===63?(e===void 0&&(e=n.substr(0,t)),e+=Eie[i]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function IL(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,br&&(t=t.replace(/\//g,"\\")),t}function U4(n,e){const t=e?BAe:zz;let i="",{scheme:s,authority:r,path:o,query:a,fragment:l}=n;if(s&&(i+=s,i+=":"),(r||s==="file")&&(i+=ol,i+=ol),r){let c=r.indexOf("@");if(c!==-1){const u=r.substr(0,c);r=r.substr(c+1),c=u.lastIndexOf(":"),c===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,c),!1,!1),i+=":",i+=t(u.substr(c+1),!1,!0)),i+="@"}r=r.toLowerCase(),c=r.lastIndexOf(":"),c===-1?i+=t(r,!1,!0):(i+=t(r.substr(0,c),!1,!0),i+=r.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:zz(l,!1,!1)),i}function Tie(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+Tie(n.substr(3)):n}}const Hz=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function bx(n){return n.match(Hz)?n.replace(Hz,e=>Tie(e)):n}let X=class Zf{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Zf(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Zf.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Zf.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return Zf.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,s=t.lineNumber|0;if(i===s){const r=e.column|0,o=t.column|0;return r-o}return i-s}clone(){return new Zf(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Zf(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}},H=class Mn{constructor(e,t,i,s){e>i||e===i&&t>s?(this.startLineNumber=i,this.startColumn=s,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=s)}isEmpty(){return Mn.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Mn.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return Mn.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return Mn.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return Mn.plusRange(this,e)}static plusRange(e,t){let i,s,r,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,s=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,s=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,s=e.startColumn),t.endLineNumber>e.endLineNumber?(r=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(r=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(r=e.endLineNumber,o=e.endColumn),new Mn(i,s,r,o)}intersectRanges(e){return Mn.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,s=e.startColumn,r=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,u=t.endColumn;return i<a?(i=a,s=l):i===a&&(s=Math.max(s,l)),r>c?(r=c,o=u):r===c&&(o=Math.min(o,u)),i>r||i===r&&s>o?null:new Mn(i,s,r,o)}equalsRange(e){return Mn.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Mn.getEndPosition(this)}static getEndPosition(e){return new X(e.endLineNumber,e.endColumn)}getStartPosition(){return Mn.getStartPosition(this)}static getStartPosition(e){return new X(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Mn(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Mn(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Mn.collapseToStart(this)}static collapseToStart(e){return new Mn(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return Mn.collapseToEnd(this)}static collapseToEnd(e){return new Mn(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new Mn(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new Mn(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Mn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const r=e.startLineNumber|0,o=t.startLineNumber|0;if(r===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,u=t.endLineNumber|0;if(c===u){const h=e.endColumn|0,d=t.endColumn|0;return h-d}return c-u}return a-l}return r-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},Lt=class ta extends H{constructor(e,t,i,s){super(e,t,i,s),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return ta.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new ta(this.startLineNumber,this.startColumn,e,t):new ta(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new X(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new X(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new ta(e,t,this.endLineNumber,this.endColumn):new ta(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new ta(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new ta(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new ta(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new ta(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,s=e.length;i<s;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,s,r){return r===0?new ta(e,t,i,s):new ta(i,s,e,t)}};const j4=Object.create(null);function E(n,e){if(_r(e)){const t=j4[e];if(t===void 0)throw new Error(`${n} references an unknown codicon: ${e}`);e=t}return j4[n]=e,{id:n}}function Aie(){return j4}const we={add:E("add",6e4),plus:E("plus",6e4),gistNew:E("gist-new",6e4),repoCreate:E("repo-create",6e4),lightbulb:E("lightbulb",60001),lightBulb:E("light-bulb",60001),repo:E("repo",60002),repoDelete:E("repo-delete",60002),gistFork:E("gist-fork",60003),repoForked:E("repo-forked",60003),gitPullRequest:E("git-pull-request",60004),gitPullRequestAbandoned:E("git-pull-request-abandoned",60004),recordKeys:E("record-keys",60005),keyboard:E("keyboard",60005),tag:E("tag",60006),tagAdd:E("tag-add",60006),tagRemove:E("tag-remove",60006),gitPullRequestLabel:E("git-pull-request-label",60006),person:E("person",60007),personFollow:E("person-follow",60007),personOutline:E("person-outline",60007),personFilled:E("person-filled",60007),gitBranch:E("git-branch",60008),gitBranchCreate:E("git-branch-create",60008),gitBranchDelete:E("git-branch-delete",60008),sourceControl:E("source-control",60008),mirror:E("mirror",60009),mirrorPublic:E("mirror-public",60009),star:E("star",60010),starAdd:E("star-add",60010),starDelete:E("star-delete",60010),starEmpty:E("star-empty",60010),comment:E("comment",60011),commentAdd:E("comment-add",60011),alert:E("alert",60012),warning:E("warning",60012),search:E("search",60013),searchSave:E("search-save",60013),logOut:E("log-out",60014),signOut:E("sign-out",60014),logIn:E("log-in",60015),signIn:E("sign-in",60015),eye:E("eye",60016),eyeUnwatch:E("eye-unwatch",60016),eyeWatch:E("eye-watch",60016),circleFilled:E("circle-filled",60017),primitiveDot:E("primitive-dot",60017),closeDirty:E("close-dirty",60017),debugBreakpoint:E("debug-breakpoint",60017),debugBreakpointDisabled:E("debug-breakpoint-disabled",60017),debugHint:E("debug-hint",60017),primitiveSquare:E("primitive-square",60018),edit:E("edit",60019),pencil:E("pencil",60019),info:E("info",60020),issueOpened:E("issue-opened",60020),gistPrivate:E("gist-private",60021),gitForkPrivate:E("git-fork-private",60021),lock:E("lock",60021),mirrorPrivate:E("mirror-private",60021),close:E("close",60022),removeClose:E("remove-close",60022),x:E("x",60022),repoSync:E("repo-sync",60023),sync:E("sync",60023),clone:E("clone",60024),desktopDownload:E("desktop-download",60024),beaker:E("beaker",60025),microscope:E("microscope",60025),vm:E("vm",60026),deviceDesktop:E("device-desktop",60026),file:E("file",60027),fileText:E("file-text",60027),more:E("more",60028),ellipsis:E("ellipsis",60028),kebabHorizontal:E("kebab-horizontal",60028),mailReply:E("mail-reply",60029),reply:E("reply",60029),organization:E("organization",60030),organizationFilled:E("organization-filled",60030),organizationOutline:E("organization-outline",60030),newFile:E("new-file",60031),fileAdd:E("file-add",60031),newFolder:E("new-folder",60032),fileDirectoryCreate:E("file-directory-create",60032),trash:E("trash",60033),trashcan:E("trashcan",60033),history:E("history",60034),clock:E("clock",60034),folder:E("folder",60035),fileDirectory:E("file-directory",60035),symbolFolder:E("symbol-folder",60035),logoGithub:E("logo-github",60036),markGithub:E("mark-github",60036),github:E("github",60036),terminal:E("terminal",60037),console:E("console",60037),repl:E("repl",60037),zap:E("zap",60038),symbolEvent:E("symbol-event",60038),error:E("error",60039),stop:E("stop",60039),variable:E("variable",60040),symbolVariable:E("symbol-variable",60040),array:E("array",60042),symbolArray:E("symbol-array",60042),symbolModule:E("symbol-module",60043),symbolPackage:E("symbol-package",60043),symbolNamespace:E("symbol-namespace",60043),symbolObject:E("symbol-object",60043),symbolMethod:E("symbol-method",60044),symbolFunction:E("symbol-function",60044),symbolConstructor:E("symbol-constructor",60044),symbolBoolean:E("symbol-boolean",60047),symbolNull:E("symbol-null",60047),symbolNumeric:E("symbol-numeric",60048),symbolNumber:E("symbol-number",60048),symbolStructure:E("symbol-structure",60049),symbolStruct:E("symbol-struct",60049),symbolParameter:E("symbol-parameter",60050),symbolTypeParameter:E("symbol-type-parameter",60050),symbolKey:E("symbol-key",60051),symbolText:E("symbol-text",60051),symbolReference:E("symbol-reference",60052),goToFile:E("go-to-file",60052),symbolEnum:E("symbol-enum",60053),symbolValue:E("symbol-value",60053),symbolRuler:E("symbol-ruler",60054),symbolUnit:E("symbol-unit",60054),activateBreakpoints:E("activate-breakpoints",60055),archive:E("archive",60056),arrowBoth:E("arrow-both",60057),arrowDown:E("arrow-down",60058),arrowLeft:E("arrow-left",60059),arrowRight:E("arrow-right",60060),arrowSmallDown:E("arrow-small-down",60061),arrowSmallLeft:E("arrow-small-left",60062),arrowSmallRight:E("arrow-small-right",60063),arrowSmallUp:E("arrow-small-up",60064),arrowUp:E("arrow-up",60065),bell:E("bell",60066),bold:E("bold",60067),book:E("book",60068),bookmark:E("bookmark",60069),debugBreakpointConditionalUnverified:E("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:E("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:E("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:E("debug-breakpoint-data-unverified",60072),debugBreakpointData:E("debug-breakpoint-data",60073),debugBreakpointDataDisabled:E("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:E("debug-breakpoint-log-unverified",60074),debugBreakpointLog:E("debug-breakpoint-log",60075),debugBreakpointLogDisabled:E("debug-breakpoint-log-disabled",60075),briefcase:E("briefcase",60076),broadcast:E("broadcast",60077),browser:E("browser",60078),bug:E("bug",60079),calendar:E("calendar",60080),caseSensitive:E("case-sensitive",60081),check:E("check",60082),checklist:E("checklist",60083),chevronDown:E("chevron-down",60084),dropDownButton:E("drop-down-button",60084),chevronLeft:E("chevron-left",60085),chevronRight:E("chevron-right",60086),chevronUp:E("chevron-up",60087),chromeClose:E("chrome-close",60088),chromeMaximize:E("chrome-maximize",60089),chromeMinimize:E("chrome-minimize",60090),chromeRestore:E("chrome-restore",60091),circle:E("circle",60092),circleOutline:E("circle-outline",60092),debugBreakpointUnverified:E("debug-breakpoint-unverified",60092),circleSlash:E("circle-slash",60093),circuitBoard:E("circuit-board",60094),clearAll:E("clear-all",60095),clippy:E("clippy",60096),closeAll:E("close-all",60097),cloudDownload:E("cloud-download",60098),cloudUpload:E("cloud-upload",60099),code:E("code",60100),collapseAll:E("collapse-all",60101),colorMode:E("color-mode",60102),commentDiscussion:E("comment-discussion",60103),compareChanges:E("compare-changes",60157),creditCard:E("credit-card",60105),dash:E("dash",60108),dashboard:E("dashboard",60109),database:E("database",60110),debugContinue:E("debug-continue",60111),debugDisconnect:E("debug-disconnect",60112),debugPause:E("debug-pause",60113),debugRestart:E("debug-restart",60114),debugStart:E("debug-start",60115),debugStepInto:E("debug-step-into",60116),debugStepOut:E("debug-step-out",60117),debugStepOver:E("debug-step-over",60118),debugStop:E("debug-stop",60119),debug:E("debug",60120),deviceCameraVideo:E("device-camera-video",60121),deviceCamera:E("device-camera",60122),deviceMobile:E("device-mobile",60123),diffAdded:E("diff-added",60124),diffIgnored:E("diff-ignored",60125),diffModified:E("diff-modified",60126),diffRemoved:E("diff-removed",60127),diffRenamed:E("diff-renamed",60128),diff:E("diff",60129),discard:E("discard",60130),editorLayout:E("editor-layout",60131),emptyWindow:E("empty-window",60132),exclude:E("exclude",60133),extensions:E("extensions",60134),eyeClosed:E("eye-closed",60135),fileBinary:E("file-binary",60136),fileCode:E("file-code",60137),fileMedia:E("file-media",60138),filePdf:E("file-pdf",60139),fileSubmodule:E("file-submodule",60140),fileSymlinkDirectory:E("file-symlink-directory",60141),fileSymlinkFile:E("file-symlink-file",60142),fileZip:E("file-zip",60143),files:E("files",60144),filter:E("filter",60145),flame:E("flame",60146),foldDown:E("fold-down",60147),foldUp:E("fold-up",60148),fold:E("fold",60149),folderActive:E("folder-active",60150),folderOpened:E("folder-opened",60151),gear:E("gear",60152),gift:E("gift",60153),gistSecret:E("gist-secret",60154),gist:E("gist",60155),gitCommit:E("git-commit",60156),gitCompare:E("git-compare",60157),gitMerge:E("git-merge",60158),githubAction:E("github-action",60159),githubAlt:E("github-alt",60160),globe:E("globe",60161),grabber:E("grabber",60162),graph:E("graph",60163),gripper:E("gripper",60164),heart:E("heart",60165),home:E("home",60166),horizontalRule:E("horizontal-rule",60167),hubot:E("hubot",60168),inbox:E("inbox",60169),issueClosed:E("issue-closed",60324),issueReopened:E("issue-reopened",60171),issues:E("issues",60172),italic:E("italic",60173),jersey:E("jersey",60174),json:E("json",60175),bracket:E("bracket",60175),kebabVertical:E("kebab-vertical",60176),key:E("key",60177),law:E("law",60178),lightbulbAutofix:E("lightbulb-autofix",60179),linkExternal:E("link-external",60180),link:E("link",60181),listOrdered:E("list-ordered",60182),listUnordered:E("list-unordered",60183),liveShare:E("live-share",60184),loading:E("loading",60185),location:E("location",60186),mailRead:E("mail-read",60187),mail:E("mail",60188),markdown:E("markdown",60189),megaphone:E("megaphone",60190),mention:E("mention",60191),milestone:E("milestone",60192),gitPullRequestMilestone:E("git-pull-request-milestone",60192),mortarBoard:E("mortar-board",60193),move:E("move",60194),multipleWindows:E("multiple-windows",60195),mute:E("mute",60196),noNewline:E("no-newline",60197),note:E("note",60198),octoface:E("octoface",60199),openPreview:E("open-preview",60200),package:E("package",60201),paintcan:E("paintcan",60202),pin:E("pin",60203),play:E("play",60204),run:E("run",60204),plug:E("plug",60205),preserveCase:E("preserve-case",60206),preview:E("preview",60207),project:E("project",60208),pulse:E("pulse",60209),question:E("question",60210),quote:E("quote",60211),radioTower:E("radio-tower",60212),reactions:E("reactions",60213),references:E("references",60214),refresh:E("refresh",60215),regex:E("regex",60216),remoteExplorer:E("remote-explorer",60217),remote:E("remote",60218),remove:E("remove",60219),replaceAll:E("replace-all",60220),replace:E("replace",60221),repoClone:E("repo-clone",60222),repoForcePush:E("repo-force-push",60223),repoPull:E("repo-pull",60224),repoPush:E("repo-push",60225),report:E("report",60226),requestChanges:E("request-changes",60227),rocket:E("rocket",60228),rootFolderOpened:E("root-folder-opened",60229),rootFolder:E("root-folder",60230),rss:E("rss",60231),ruby:E("ruby",60232),saveAll:E("save-all",60233),saveAs:E("save-as",60234),save:E("save",60235),screenFull:E("screen-full",60236),screenNormal:E("screen-normal",60237),searchStop:E("search-stop",60238),server:E("server",60240),settingsGear:E("settings-gear",60241),settings:E("settings",60242),shield:E("shield",60243),smiley:E("smiley",60244),sortPrecedence:E("sort-precedence",60245),splitHorizontal:E("split-horizontal",60246),splitVertical:E("split-vertical",60247),squirrel:E("squirrel",60248),starFull:E("star-full",60249),starHalf:E("star-half",60250),symbolClass:E("symbol-class",60251),symbolColor:E("symbol-color",60252),symbolCustomColor:E("symbol-customcolor",60252),symbolConstant:E("symbol-constant",60253),symbolEnumMember:E("symbol-enum-member",60254),symbolField:E("symbol-field",60255),symbolFile:E("symbol-file",60256),symbolInterface:E("symbol-interface",60257),symbolKeyword:E("symbol-keyword",60258),symbolMisc:E("symbol-misc",60259),symbolOperator:E("symbol-operator",60260),symbolProperty:E("symbol-property",60261),wrench:E("wrench",60261),wrenchSubaction:E("wrench-subaction",60261),symbolSnippet:E("symbol-snippet",60262),tasklist:E("tasklist",60263),telescope:E("telescope",60264),textSize:E("text-size",60265),threeBars:E("three-bars",60266),thumbsdown:E("thumbsdown",60267),thumbsup:E("thumbsup",60268),tools:E("tools",60269),triangleDown:E("triangle-down",60270),triangleLeft:E("triangle-left",60271),triangleRight:E("triangle-right",60272),triangleUp:E("triangle-up",60273),twitter:E("twitter",60274),unfold:E("unfold",60275),unlock:E("unlock",60276),unmute:E("unmute",60277),unverified:E("unverified",60278),verified:E("verified",60279),versions:E("versions",60280),vmActive:E("vm-active",60281),vmOutline:E("vm-outline",60282),vmRunning:E("vm-running",60283),watch:E("watch",60284),whitespace:E("whitespace",60285),wholeWord:E("whole-word",60286),window:E("window",60287),wordWrap:E("word-wrap",60288),zoomIn:E("zoom-in",60289),zoomOut:E("zoom-out",60290),listFilter:E("list-filter",60291),listFlat:E("list-flat",60292),listSelection:E("list-selection",60293),selection:E("selection",60293),listTree:E("list-tree",60294),debugBreakpointFunctionUnverified:E("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:E("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:E("debug-breakpoint-function-disabled",60296),debugStackframeActive:E("debug-stackframe-active",60297),circleSmallFilled:E("circle-small-filled",60298),debugStackframeDot:E("debug-stackframe-dot",60298),debugStackframe:E("debug-stackframe",60299),debugStackframeFocused:E("debug-stackframe-focused",60299),debugBreakpointUnsupported:E("debug-breakpoint-unsupported",60300),symbolString:E("symbol-string",60301),debugReverseContinue:E("debug-reverse-continue",60302),debugStepBack:E("debug-step-back",60303),debugRestartFrame:E("debug-restart-frame",60304),callIncoming:E("call-incoming",60306),callOutgoing:E("call-outgoing",60307),menu:E("menu",60308),expandAll:E("expand-all",60309),feedback:E("feedback",60310),gitPullRequestReviewer:E("git-pull-request-reviewer",60310),groupByRefType:E("group-by-ref-type",60311),ungroupByRefType:E("ungroup-by-ref-type",60312),account:E("account",60313),gitPullRequestAssignee:E("git-pull-request-assignee",60313),bellDot:E("bell-dot",60314),debugConsole:E("debug-console",60315),library:E("library",60316),output:E("output",60317),runAll:E("run-all",60318),syncIgnored:E("sync-ignored",60319),pinned:E("pinned",60320),githubInverted:E("github-inverted",60321),debugAlt:E("debug-alt",60305),serverProcess:E("server-process",60322),serverEnvironment:E("server-environment",60323),pass:E("pass",60324),stopCircle:E("stop-circle",60325),playCircle:E("play-circle",60326),record:E("record",60327),debugAltSmall:E("debug-alt-small",60328),vmConnect:E("vm-connect",60329),cloud:E("cloud",60330),merge:E("merge",60331),exportIcon:E("export",60332),graphLeft:E("graph-left",60333),magnet:E("magnet",60334),notebook:E("notebook",60335),redo:E("redo",60336),checkAll:E("check-all",60337),pinnedDirty:E("pinned-dirty",60338),passFilled:E("pass-filled",60339),circleLargeFilled:E("circle-large-filled",60340),circleLarge:E("circle-large",60341),circleLargeOutline:E("circle-large-outline",60341),combine:E("combine",60342),gather:E("gather",60342),table:E("table",60343),variableGroup:E("variable-group",60344),typeHierarchy:E("type-hierarchy",60345),typeHierarchySub:E("type-hierarchy-sub",60346),typeHierarchySuper:E("type-hierarchy-super",60347),gitPullRequestCreate:E("git-pull-request-create",60348),runAbove:E("run-above",60349),runBelow:E("run-below",60350),notebookTemplate:E("notebook-template",60351),debugRerun:E("debug-rerun",60352),workspaceTrusted:E("workspace-trusted",60353),workspaceUntrusted:E("workspace-untrusted",60354),workspaceUnspecified:E("workspace-unspecified",60355),terminalCmd:E("terminal-cmd",60356),terminalDebian:E("terminal-debian",60357),terminalLinux:E("terminal-linux",60358),terminalPowershell:E("terminal-powershell",60359),terminalTmux:E("terminal-tmux",60360),terminalUbuntu:E("terminal-ubuntu",60361),terminalBash:E("terminal-bash",60362),arrowSwap:E("arrow-swap",60363),copy:E("copy",60364),personAdd:E("person-add",60365),filterFilled:E("filter-filled",60366),wand:E("wand",60367),debugLineByLine:E("debug-line-by-line",60368),inspect:E("inspect",60369),layers:E("layers",60370),layersDot:E("layers-dot",60371),layersActive:E("layers-active",60372),compass:E("compass",60373),compassDot:E("compass-dot",60374),compassActive:E("compass-active",60375),azure:E("azure",60376),issueDraft:E("issue-draft",60377),gitPullRequestClosed:E("git-pull-request-closed",60378),gitPullRequestDraft:E("git-pull-request-draft",60379),debugAll:E("debug-all",60380),debugCoverage:E("debug-coverage",60381),runErrors:E("run-errors",60382),folderLibrary:E("folder-library",60383),debugContinueSmall:E("debug-continue-small",60384),beakerStop:E("beaker-stop",60385),graphLine:E("graph-line",60386),graphScatter:E("graph-scatter",60387),pieChart:E("pie-chart",60388),bracketDot:E("bracket-dot",60389),bracketError:E("bracket-error",60390),lockSmall:E("lock-small",60391),azureDevops:E("azure-devops",60392),verifiedFilled:E("verified-filled",60393),newLine:E("newline",60394),layout:E("layout",60395),layoutActivitybarLeft:E("layout-activitybar-left",60396),layoutActivitybarRight:E("layout-activitybar-right",60397),layoutPanelLeft:E("layout-panel-left",60398),layoutPanelCenter:E("layout-panel-center",60399),layoutPanelJustify:E("layout-panel-justify",60400),layoutPanelRight:E("layout-panel-right",60401),layoutPanel:E("layout-panel",60402),layoutSidebarLeft:E("layout-sidebar-left",60403),layoutSidebarRight:E("layout-sidebar-right",60404),layoutStatusbar:E("layout-statusbar",60405),layoutMenubar:E("layout-menubar",60406),layoutCentered:E("layout-centered",60407),layoutSidebarRightOff:E("layout-sidebar-right-off",60416),layoutPanelOff:E("layout-panel-off",60417),layoutSidebarLeftOff:E("layout-sidebar-left-off",60418),target:E("target",60408),indent:E("indent",60409),recordSmall:E("record-small",60410),errorSmall:E("error-small",60411),arrowCircleDown:E("arrow-circle-down",60412),arrowCircleLeft:E("arrow-circle-left",60413),arrowCircleRight:E("arrow-circle-right",60414),arrowCircleUp:E("arrow-circle-up",60415),heartFilled:E("heart-filled",60420),map:E("map",60421),mapFilled:E("map-filled",60422),circleSmall:E("circle-small",60423),bellSlash:E("bell-slash",60424),bellSlashDot:E("bell-slash-dot",60425),commentUnresolved:E("comment-unresolved",60426),gitPullRequestGoToChanges:E("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:E("git-pull-request-new-changes",60428),searchFuzzy:E("search-fuzzy",60429),commentDraft:E("comment-draft",60430),send:E("send",60431),sparkle:E("sparkle",60432),insert:E("insert",60433),mic:E("mic",60434),dialogError:E("dialog-error","error"),dialogWarning:E("dialog-warning","warning"),dialogInfo:E("dialog-info","info"),dialogClose:E("dialog-close","close"),treeItemExpanded:E("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:E("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:E("tree-filter-on-type-off","list-selection"),treeFilterClear:E("tree-filter-clear","close"),treeItemLoading:E("tree-item-loading","loading"),menuSelection:E("menu-selection","check"),menuSubmenu:E("menu-submenu","chevron-right"),menuBarMore:E("menubar-more","more"),scrollbarButtonLeft:E("scrollbar-button-left","triangle-left"),scrollbarButtonRight:E("scrollbar-button-right","triangle-right"),scrollbarButtonUp:E("scrollbar-button-up","triangle-up"),scrollbarButtonDown:E("scrollbar-button-down","triangle-down"),toolBarMore:E("toolbar-more","more"),quickInputBack:E("quick-input-back","arrow-left")};var q4=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let WAe=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ut(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var i;(i=this._factories.get(e))===null||i===void 0||i.dispose();const s=new VAe(this,e,t);return this._factories.set(e,s),ut(()=>{const r=this._factories.get(e);!r||r!==s||(this._factories.delete(e),r.dispose())})}getOrCreate(e){return q4(this,void 0,void 0,function*(){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(yield i.resolve(),this.get(e))})}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class VAe extends ae{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}resolve(){return q4(this,void 0,void 0,function*(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise})}_create(){return q4(this,void 0,void 0,function*(){const e=yield this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))})}}let ay=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class a8{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class hT{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var Uz;(function(n){const e=new Map;e.set(0,we.symbolMethod),e.set(1,we.symbolFunction),e.set(2,we.symbolConstructor),e.set(3,we.symbolField),e.set(4,we.symbolVariable),e.set(5,we.symbolClass),e.set(6,we.symbolStruct),e.set(7,we.symbolInterface),e.set(8,we.symbolModule),e.set(9,we.symbolProperty),e.set(10,we.symbolEvent),e.set(11,we.symbolOperator),e.set(12,we.symbolUnit),e.set(13,we.symbolValue),e.set(15,we.symbolEnum),e.set(14,we.symbolConstant),e.set(15,we.symbolEnum),e.set(16,we.symbolEnumMember),e.set(17,we.symbolKeyword),e.set(27,we.symbolSnippet),e.set(18,we.symbolText),e.set(19,we.symbolColor),e.set(20,we.symbolFile),e.set(21,we.symbolReference),e.set(22,we.symbolCustomColor),e.set(23,we.symbolFolder),e.set(24,we.symbolTypeParameter),e.set(25,we.account),e.set(26,we.issues);function t(r){let o=e.get(r);return o||(console.info("No codicon found for CompletionItemKind "+r),o=we.symbolProperty),o}n.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function s(r,o){let a=i.get(r);return typeof a>"u"&&!o&&(a=9),a}n.fromString=s})(Uz||(Uz={}));var G4;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(G4||(G4={}));class $Ae{constructor(e,t,i,s){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=s}equals(e){return H.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var jz;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(jz||(jz={}));var qz;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(qz||(qz={}));function zAe(n){return n&&ot.isUri(n.uri)&&H.isIRange(n.range)&&(H.isIRange(n.originSelectionRange)||H.isIRange(n.targetSelectionRange))}_("Array","array"),_("Boolean","boolean"),_("Class","class"),_("Constant","constant"),_("Constructor","constructor"),_("Enum","enumeration"),_("EnumMember","enumeration member"),_("Event","event"),_("Field","field"),_("File","file"),_("Function","function"),_("Interface","interface"),_("Key","key"),_("Method","method"),_("Module","module"),_("Namespace","namespace"),_("Null","null"),_("Number","number"),_("Object","object"),_("Operator","operator"),_("Package","package"),_("Property","property"),_("String","string"),_("Struct","struct"),_("TypeParameter","type parameter"),_("Variable","variable");var K4;(function(n){const e=new Map;e.set(0,we.symbolFile),e.set(1,we.symbolModule),e.set(2,we.symbolNamespace),e.set(3,we.symbolPackage),e.set(4,we.symbolClass),e.set(5,we.symbolMethod),e.set(6,we.symbolProperty),e.set(7,we.symbolField),e.set(8,we.symbolConstructor),e.set(9,we.symbolEnum),e.set(10,we.symbolInterface),e.set(11,we.symbolFunction),e.set(12,we.symbolVariable),e.set(13,we.symbolConstant),e.set(14,we.symbolString),e.set(15,we.symbolNumber),e.set(16,we.symbolBoolean),e.set(17,we.symbolArray),e.set(18,we.symbolObject),e.set(19,we.symbolKey),e.set(20,we.symbolNull),e.set(21,we.symbolEnumMember),e.set(22,we.symbolStruct),e.set(23,we.symbolEvent),e.set(24,we.symbolOperator),e.set(25,we.symbolTypeParameter);function t(i){let s=e.get(i);return s||(console.info("No codicon found for SymbolKind "+i),s=we.symbolProperty),s}n.toIcon=t})(K4||(K4={}));class Us{static fromValue(e){switch(e){case"comment":return Us.Comment;case"imports":return Us.Imports;case"region":return Us.Region}return new Us(e)}constructor(e){this.value=e}}Us.Comment=new Us("comment");Us.Imports=new Us("imports");Us.Region=new Us("region");var Gz;(function(n){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}n.is=e})(Gz||(Gz={}));var Kz;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(Kz||(Kz={}));class HAe{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const $i=new WAe;var Z4;(function(n){n[n.Unknown=0]="Unknown",n[n.Disabled=1]="Disabled",n[n.Enabled=2]="Enabled"})(Z4||(Z4={}));var Y4;(function(n){n[n.Invoke=1]="Invoke",n[n.Auto=2]="Auto"})(Y4||(Y4={}));var X4;(function(n){n[n.None=0]="None",n[n.KeepWhitespace=1]="KeepWhitespace",n[n.InsertAsSnippet=4]="InsertAsSnippet"})(X4||(X4={}));var Q4;(function(n){n[n.Method=0]="Method",n[n.Function=1]="Function",n[n.Constructor=2]="Constructor",n[n.Field=3]="Field",n[n.Variable=4]="Variable",n[n.Class=5]="Class",n[n.Struct=6]="Struct",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Event=10]="Event",n[n.Operator=11]="Operator",n[n.Unit=12]="Unit",n[n.Value=13]="Value",n[n.Constant=14]="Constant",n[n.Enum=15]="Enum",n[n.EnumMember=16]="EnumMember",n[n.Keyword=17]="Keyword",n[n.Text=18]="Text",n[n.Color=19]="Color",n[n.File=20]="File",n[n.Reference=21]="Reference",n[n.Customcolor=22]="Customcolor",n[n.Folder=23]="Folder",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue",n[n.Snippet=27]="Snippet"})(Q4||(Q4={}));var J4;(function(n){n[n.Deprecated=1]="Deprecated"})(J4||(J4={}));var e3;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(e3||(e3={}));var t3;(function(n){n[n.EXACT=0]="EXACT",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(t3||(t3={}));var i3;(function(n){n[n.NotSet=0]="NotSet",n[n.ContentFlush=1]="ContentFlush",n[n.RecoverFromMarkers=2]="RecoverFromMarkers",n[n.Explicit=3]="Explicit",n[n.Paste=4]="Paste",n[n.Undo=5]="Undo",n[n.Redo=6]="Redo"})(i3||(i3={}));var n3;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(n3||(n3={}));var s3;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(s3||(s3={}));var r3;(function(n){n[n.None=0]="None",n[n.Keep=1]="Keep",n[n.Brackets=2]="Brackets",n[n.Advanced=3]="Advanced",n[n.Full=4]="Full"})(r3||(r3={}));var o3;(function(n){n[n.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",n[n.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",n[n.accessibilitySupport=2]="accessibilitySupport",n[n.accessibilityPageSize=3]="accessibilityPageSize",n[n.ariaLabel=4]="ariaLabel",n[n.ariaRequired=5]="ariaRequired",n[n.autoClosingBrackets=6]="autoClosingBrackets",n[n.autoClosingComments=7]="autoClosingComments",n[n.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",n[n.autoClosingDelete=9]="autoClosingDelete",n[n.autoClosingOvertype=10]="autoClosingOvertype",n[n.autoClosingQuotes=11]="autoClosingQuotes",n[n.autoIndent=12]="autoIndent",n[n.automaticLayout=13]="automaticLayout",n[n.autoSurround=14]="autoSurround",n[n.bracketPairColorization=15]="bracketPairColorization",n[n.guides=16]="guides",n[n.codeLens=17]="codeLens",n[n.codeLensFontFamily=18]="codeLensFontFamily",n[n.codeLensFontSize=19]="codeLensFontSize",n[n.colorDecorators=20]="colorDecorators",n[n.colorDecoratorsLimit=21]="colorDecoratorsLimit",n[n.columnSelection=22]="columnSelection",n[n.comments=23]="comments",n[n.contextmenu=24]="contextmenu",n[n.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",n[n.cursorBlinking=26]="cursorBlinking",n[n.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",n[n.cursorStyle=28]="cursorStyle",n[n.cursorSurroundingLines=29]="cursorSurroundingLines",n[n.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",n[n.cursorWidth=31]="cursorWidth",n[n.disableLayerHinting=32]="disableLayerHinting",n[n.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",n[n.domReadOnly=34]="domReadOnly",n[n.dragAndDrop=35]="dragAndDrop",n[n.dropIntoEditor=36]="dropIntoEditor",n[n.emptySelectionClipboard=37]="emptySelectionClipboard",n[n.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",n[n.extraEditorClassName=39]="extraEditorClassName",n[n.fastScrollSensitivity=40]="fastScrollSensitivity",n[n.find=41]="find",n[n.fixedOverflowWidgets=42]="fixedOverflowWidgets",n[n.folding=43]="folding",n[n.foldingStrategy=44]="foldingStrategy",n[n.foldingHighlight=45]="foldingHighlight",n[n.foldingImportsByDefault=46]="foldingImportsByDefault",n[n.foldingMaximumRegions=47]="foldingMaximumRegions",n[n.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",n[n.fontFamily=49]="fontFamily",n[n.fontInfo=50]="fontInfo",n[n.fontLigatures=51]="fontLigatures",n[n.fontSize=52]="fontSize",n[n.fontWeight=53]="fontWeight",n[n.fontVariations=54]="fontVariations",n[n.formatOnPaste=55]="formatOnPaste",n[n.formatOnType=56]="formatOnType",n[n.glyphMargin=57]="glyphMargin",n[n.gotoLocation=58]="gotoLocation",n[n.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",n[n.hover=60]="hover",n[n.inDiffEditor=61]="inDiffEditor",n[n.inlineSuggest=62]="inlineSuggest",n[n.letterSpacing=63]="letterSpacing",n[n.lightbulb=64]="lightbulb",n[n.lineDecorationsWidth=65]="lineDecorationsWidth",n[n.lineHeight=66]="lineHeight",n[n.lineNumbers=67]="lineNumbers",n[n.lineNumbersMinChars=68]="lineNumbersMinChars",n[n.linkedEditing=69]="linkedEditing",n[n.links=70]="links",n[n.matchBrackets=71]="matchBrackets",n[n.minimap=72]="minimap",n[n.mouseStyle=73]="mouseStyle",n[n.mouseWheelScrollSensitivity=74]="mouseWheelScrollSensitivity",n[n.mouseWheelZoom=75]="mouseWheelZoom",n[n.multiCursorMergeOverlapping=76]="multiCursorMergeOverlapping",n[n.multiCursorModifier=77]="multiCursorModifier",n[n.multiCursorPaste=78]="multiCursorPaste",n[n.multiCursorLimit=79]="multiCursorLimit",n[n.occurrencesHighlight=80]="occurrencesHighlight",n[n.overviewRulerBorder=81]="overviewRulerBorder",n[n.overviewRulerLanes=82]="overviewRulerLanes",n[n.padding=83]="padding",n[n.pasteAs=84]="pasteAs",n[n.parameterHints=85]="parameterHints",n[n.peekWidgetDefaultFocus=86]="peekWidgetDefaultFocus",n[n.definitionLinkOpensInPeek=87]="definitionLinkOpensInPeek",n[n.quickSuggestions=88]="quickSuggestions",n[n.quickSuggestionsDelay=89]="quickSuggestionsDelay",n[n.readOnly=90]="readOnly",n[n.readOnlyMessage=91]="readOnlyMessage",n[n.renameOnType=92]="renameOnType",n[n.renderControlCharacters=93]="renderControlCharacters",n[n.renderFinalNewline=94]="renderFinalNewline",n[n.renderLineHighlight=95]="renderLineHighlight",n[n.renderLineHighlightOnlyWhenFocus=96]="renderLineHighlightOnlyWhenFocus",n[n.renderValidationDecorations=97]="renderValidationDecorations",n[n.renderWhitespace=98]="renderWhitespace",n[n.revealHorizontalRightPadding=99]="revealHorizontalRightPadding",n[n.roundedSelection=100]="roundedSelection",n[n.rulers=101]="rulers",n[n.scrollbar=102]="scrollbar",n[n.scrollBeyondLastColumn=103]="scrollBeyondLastColumn",n[n.scrollBeyondLastLine=104]="scrollBeyondLastLine",n[n.scrollPredominantAxis=105]="scrollPredominantAxis",n[n.selectionClipboard=106]="selectionClipboard",n[n.selectionHighlight=107]="selectionHighlight",n[n.selectOnLineNumbers=108]="selectOnLineNumbers",n[n.showFoldingControls=109]="showFoldingControls",n[n.showUnused=110]="showUnused",n[n.snippetSuggestions=111]="snippetSuggestions",n[n.smartSelect=112]="smartSelect",n[n.smoothScrolling=113]="smoothScrolling",n[n.stickyScroll=114]="stickyScroll",n[n.stickyTabStops=115]="stickyTabStops",n[n.stopRenderingLineAfter=116]="stopRenderingLineAfter",n[n.suggest=117]="suggest",n[n.suggestFontSize=118]="suggestFontSize",n[n.suggestLineHeight=119]="suggestLineHeight",n[n.suggestOnTriggerCharacters=120]="suggestOnTriggerCharacters",n[n.suggestSelection=121]="suggestSelection",n[n.tabCompletion=122]="tabCompletion",n[n.tabIndex=123]="tabIndex",n[n.unicodeHighlighting=124]="unicodeHighlighting",n[n.unusualLineTerminators=125]="unusualLineTerminators",n[n.useShadowDOM=126]="useShadowDOM",n[n.useTabStops=127]="useTabStops",n[n.wordBreak=128]="wordBreak",n[n.wordSeparators=129]="wordSeparators",n[n.wordWrap=130]="wordWrap",n[n.wordWrapBreakAfterCharacters=131]="wordWrapBreakAfterCharacters",n[n.wordWrapBreakBeforeCharacters=132]="wordWrapBreakBeforeCharacters",n[n.wordWrapColumn=133]="wordWrapColumn",n[n.wordWrapOverride1=134]="wordWrapOverride1",n[n.wordWrapOverride2=135]="wordWrapOverride2",n[n.wrappingIndent=136]="wrappingIndent",n[n.wrappingStrategy=137]="wrappingStrategy",n[n.showDeprecated=138]="showDeprecated",n[n.inlayHints=139]="inlayHints",n[n.editorClassName=140]="editorClassName",n[n.pixelRatio=141]="pixelRatio",n[n.tabFocusMode=142]="tabFocusMode",n[n.layoutInfo=143]="layoutInfo",n[n.wrappingInfo=144]="wrappingInfo",n[n.defaultColorDecorators=145]="defaultColorDecorators",n[n.colorDecoratorsActivatedOn=146]="colorDecoratorsActivatedOn",n[n.inlineCompletionsAccessibilityVerbose=147]="inlineCompletionsAccessibilityVerbose"})(o3||(o3={}));var a3;(function(n){n[n.TextDefined=0]="TextDefined",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(a3||(a3={}));var l3;(function(n){n[n.LF=0]="LF",n[n.CRLF=1]="CRLF"})(l3||(l3={}));var c3;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(c3||(c3={}));var u3;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(u3||(u3={}));var h3;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(h3||(h3={}));var d3;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(d3||(d3={}));var f3;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(f3||(f3={}));var g3;(function(n){n[n.DependsOnKbLayout=-1]="DependsOnKbLayout",n[n.Unknown=0]="Unknown",n[n.Backspace=1]="Backspace",n[n.Tab=2]="Tab",n[n.Enter=3]="Enter",n[n.Shift=4]="Shift",n[n.Ctrl=5]="Ctrl",n[n.Alt=6]="Alt",n[n.PauseBreak=7]="PauseBreak",n[n.CapsLock=8]="CapsLock",n[n.Escape=9]="Escape",n[n.Space=10]="Space",n[n.PageUp=11]="PageUp",n[n.PageDown=12]="PageDown",n[n.End=13]="End",n[n.Home=14]="Home",n[n.LeftArrow=15]="LeftArrow",n[n.UpArrow=16]="UpArrow",n[n.RightArrow=17]="RightArrow",n[n.DownArrow=18]="DownArrow",n[n.Insert=19]="Insert",n[n.Delete=20]="Delete",n[n.Digit0=21]="Digit0",n[n.Digit1=22]="Digit1",n[n.Digit2=23]="Digit2",n[n.Digit3=24]="Digit3",n[n.Digit4=25]="Digit4",n[n.Digit5=26]="Digit5",n[n.Digit6=27]="Digit6",n[n.Digit7=28]="Digit7",n[n.Digit8=29]="Digit8",n[n.Digit9=30]="Digit9",n[n.KeyA=31]="KeyA",n[n.KeyB=32]="KeyB",n[n.KeyC=33]="KeyC",n[n.KeyD=34]="KeyD",n[n.KeyE=35]="KeyE",n[n.KeyF=36]="KeyF",n[n.KeyG=37]="KeyG",n[n.KeyH=38]="KeyH",n[n.KeyI=39]="KeyI",n[n.KeyJ=40]="KeyJ",n[n.KeyK=41]="KeyK",n[n.KeyL=42]="KeyL",n[n.KeyM=43]="KeyM",n[n.KeyN=44]="KeyN",n[n.KeyO=45]="KeyO",n[n.KeyP=46]="KeyP",n[n.KeyQ=47]="KeyQ",n[n.KeyR=48]="KeyR",n[n.KeyS=49]="KeyS",n[n.KeyT=50]="KeyT",n[n.KeyU=51]="KeyU",n[n.KeyV=52]="KeyV",n[n.KeyW=53]="KeyW",n[n.KeyX=54]="KeyX",n[n.KeyY=55]="KeyY",n[n.KeyZ=56]="KeyZ",n[n.Meta=57]="Meta",n[n.ContextMenu=58]="ContextMenu",n[n.F1=59]="F1",n[n.F2=60]="F2",n[n.F3=61]="F3",n[n.F4=62]="F4",n[n.F5=63]="F5",n[n.F6=64]="F6",n[n.F7=65]="F7",n[n.F8=66]="F8",n[n.F9=67]="F9",n[n.F10=68]="F10",n[n.F11=69]="F11",n[n.F12=70]="F12",n[n.F13=71]="F13",n[n.F14=72]="F14",n[n.F15=73]="F15",n[n.F16=74]="F16",n[n.F17=75]="F17",n[n.F18=76]="F18",n[n.F19=77]="F19",n[n.F20=78]="F20",n[n.F21=79]="F21",n[n.F22=80]="F22",n[n.F23=81]="F23",n[n.F24=82]="F24",n[n.NumLock=83]="NumLock",n[n.ScrollLock=84]="ScrollLock",n[n.Semicolon=85]="Semicolon",n[n.Equal=86]="Equal",n[n.Comma=87]="Comma",n[n.Minus=88]="Minus",n[n.Period=89]="Period",n[n.Slash=90]="Slash",n[n.Backquote=91]="Backquote",n[n.BracketLeft=92]="BracketLeft",n[n.Backslash=93]="Backslash",n[n.BracketRight=94]="BracketRight",n[n.Quote=95]="Quote",n[n.OEM_8=96]="OEM_8",n[n.IntlBackslash=97]="IntlBackslash",n[n.Numpad0=98]="Numpad0",n[n.Numpad1=99]="Numpad1",n[n.Numpad2=100]="Numpad2",n[n.Numpad3=101]="Numpad3",n[n.Numpad4=102]="Numpad4",n[n.Numpad5=103]="Numpad5",n[n.Numpad6=104]="Numpad6",n[n.Numpad7=105]="Numpad7",n[n.Numpad8=106]="Numpad8",n[n.Numpad9=107]="Numpad9",n[n.NumpadMultiply=108]="NumpadMultiply",n[n.NumpadAdd=109]="NumpadAdd",n[n.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",n[n.NumpadSubtract=111]="NumpadSubtract",n[n.NumpadDecimal=112]="NumpadDecimal",n[n.NumpadDivide=113]="NumpadDivide",n[n.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",n[n.ABNT_C1=115]="ABNT_C1",n[n.ABNT_C2=116]="ABNT_C2",n[n.AudioVolumeMute=117]="AudioVolumeMute",n[n.AudioVolumeUp=118]="AudioVolumeUp",n[n.AudioVolumeDown=119]="AudioVolumeDown",n[n.BrowserSearch=120]="BrowserSearch",n[n.BrowserHome=121]="BrowserHome",n[n.BrowserBack=122]="BrowserBack",n[n.BrowserForward=123]="BrowserForward",n[n.MediaTrackNext=124]="MediaTrackNext",n[n.MediaTrackPrevious=125]="MediaTrackPrevious",n[n.MediaStop=126]="MediaStop",n[n.MediaPlayPause=127]="MediaPlayPause",n[n.LaunchMediaPlayer=128]="LaunchMediaPlayer",n[n.LaunchMail=129]="LaunchMail",n[n.LaunchApp2=130]="LaunchApp2",n[n.Clear=131]="Clear",n[n.MAX_VALUE=132]="MAX_VALUE"})(g3||(g3={}));var p3;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(p3||(p3={}));var m3;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(m3||(m3={}));var _3;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(_3||(_3={}));var b3;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.TEXTAREA=1]="TEXTAREA",n[n.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",n[n.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",n[n.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",n[n.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",n[n.CONTENT_TEXT=6]="CONTENT_TEXT",n[n.CONTENT_EMPTY=7]="CONTENT_EMPTY",n[n.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",n[n.CONTENT_WIDGET=9]="CONTENT_WIDGET",n[n.OVERVIEW_RULER=10]="OVERVIEW_RULER",n[n.SCROLLBAR=11]="SCROLLBAR",n[n.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",n[n.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(b3||(b3={}));var v3;(function(n){n[n.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",n[n.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",n[n.TOP_CENTER=2]="TOP_CENTER"})(v3||(v3={}));var w3;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(w3||(w3={}));var y3;(function(n){n[n.Left=0]="Left",n[n.Right=1]="Right",n[n.None=2]="None",n[n.LeftOfInjectedText=3]="LeftOfInjectedText",n[n.RightOfInjectedText=4]="RightOfInjectedText"})(y3||(y3={}));var C3;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval",n[n.Custom=4]="Custom"})(C3||(C3={}));var S3;(function(n){n[n.None=0]="None",n[n.Text=1]="Text",n[n.Blocks=2]="Blocks"})(S3||(S3={}));var x3;(function(n){n[n.Smooth=0]="Smooth",n[n.Immediate=1]="Immediate"})(x3||(x3={}));var k3;(function(n){n[n.Auto=1]="Auto",n[n.Hidden=2]="Hidden",n[n.Visible=3]="Visible"})(k3||(k3={}));var L3;(function(n){n[n.LTR=0]="LTR",n[n.RTL=1]="RTL"})(L3||(L3={}));var D3;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(D3||(D3={}));var E3;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(E3||(E3={}));var T3;(function(n){n[n.Deprecated=1]="Deprecated"})(T3||(T3={}));var A3;(function(n){n[n.Hidden=0]="Hidden",n[n.Blink=1]="Blink",n[n.Smooth=2]="Smooth",n[n.Phase=3]="Phase",n[n.Expand=4]="Expand",n[n.Solid=5]="Solid"})(A3||(A3={}));var I3;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(I3||(I3={}));var N3;(function(n){n[n.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",n[n.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",n[n.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",n[n.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(N3||(N3={}));var R3;(function(n){n[n.None=0]="None",n[n.Same=1]="Same",n[n.Indent=2]="Indent",n[n.DeepIndent=3]="DeepIndent"})(R3||(R3={}));let uS=class{static chord(e,t){return ms(e,t)}};uS.CtrlCmd=2048;uS.Shift=1024;uS.Alt=512;uS.WinCtrl=256;function Iie(){return{editor:void 0,languages:void 0,CancellationTokenSource:Wa,Emitter:G,KeyCode:g3,KeyMod:uS,Position:X,Range:H,Selection:Lt,SelectionDirection:L3,MarkerSeverity:p3,MarkerTag:m3,Uri:ot,Token:ay}}class UAe{constructor(e){this.fn=e,this.lastCache=void 0,this.lastArgKey=void 0}get(e){const t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.fn(e)),this.lastCache}}class Zz{get cachedValues(){return this._map}constructor(e){this.fn=e,this._map=new Map}get(e){if(this._map.has(e))return this._map.get(e);const t=this.fn(e);return this._map.set(e,t),t}}class Jp{constructor(e){this.executor=e,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var Z_;function jAe(n){return!n||typeof n!="string"?!0:n.trim().length===0}const qAe=/{(\d+)}/g;function ly(n,...e){return e.length===0?n:n.replace(qAe,function(t,i){const s=parseInt(i,10);return isNaN(s)||s<0||s>=e.length?t:e[s]})}function NL(n){return n.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Na(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function dT(n,e){if(!n||!e)return n;const t=e.length;if(t===0||n.length===0)return n;let i=0;for(;n.indexOf(e,i)===i;)i=i+t;return n.substring(i)}function GAe(n,e){if(!n||!e)return n;const t=e.length,i=n.length;if(t===0||i===0)return n;let s=i,r=-1;for(;r=n.lastIndexOf(e,s-1),!(r===-1||r+t!==s);){if(r===0)return"";s=r}return n.substring(0,s)}function KAe(n){return n.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function Nie(n,e,t={}){if(!n)throw new Error("Cannot create regex from empty string");e||(n=Na(n)),t.wholeWord&&(/\B/.test(n.charAt(0))||(n="\\b"+n),/\B/.test(n.charAt(n.length-1))||(n=n+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(n,i)}function ZAe(n){return n.source==="^"||n.source==="^$"||n.source==="$"||n.source==="^\\s*$"?!1:!!(n.exec("")&&n.lastIndex===0)}function em(n){return n.split(/\r\n|\r|\n/)}function Pr(n){for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Lr(n,e=0,t=n.length){for(let i=e;i<t;i++){const s=n.charCodeAt(i);if(s!==32&&s!==9)return n.substring(e,i)}return n.substring(e,t)}function tm(n,e=n.length-1){for(let t=e;t>=0;t--){const i=n.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function cy(n,e){return n<e?-1:n>e?1:0}function l8(n,e,t=0,i=n.length,s=0,r=e.length){for(;t<i&&s<r;t++,s++){const l=n.charCodeAt(t),c=e.charCodeAt(s);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=r-s;return o<a?-1:o>a?1:0}function Yz(n,e){return hS(n,e,0,n.length,0,e.length)}function hS(n,e,t=0,i=n.length,s=0,r=e.length){for(;t<i&&s<r;t++,s++){let l=n.charCodeAt(t),c=e.charCodeAt(s);if(l===c)continue;if(l>=128||c>=128)return l8(n.toLowerCase(),e.toLowerCase(),t,i,s,r);u0(l)&&(l-=32),u0(c)&&(c-=32);const u=l-c;if(u!==0)return u}const o=i-t,a=r-s;return o<a?-1:o>a?1:0}function vx(n){return n>=48&&n<=57}function u0(n){return n>=97&&n<=122}function Bh(n){return n>=65&&n<=90}function h0(n,e){return n.length===e.length&&hS(n,e)===0}function c8(n,e){const t=e.length;return e.length>n.length?!1:hS(n,e,0,t)===0}function RL(n,e){const t=Math.min(n.length,e.length);let i;for(i=0;i<t;i++)if(n.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function M3(n,e){const t=Math.min(n.length,e.length);let i;const s=n.length-1,r=e.length-1;for(i=0;i<t;i++)if(n.charCodeAt(s-i)!==e.charCodeAt(r-i))return i;return t}function Dn(n){return 55296<=n&&n<=56319}function Y_(n){return 56320<=n&&n<=57343}function u8(n,e){return(n-55296<<10)+(e-56320)+65536}function ML(n,e,t){const i=n.charCodeAt(t);if(Dn(i)&&t+1<e){const s=n.charCodeAt(t+1);if(Y_(s))return u8(i,s)}return i}function YAe(n,e){const t=n.charCodeAt(e-1);if(Y_(t)&&e>1){const i=n.charCodeAt(e-2);if(Dn(i))return u8(i,t)}return t}class h8{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=YAe(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=ML(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class FL{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new h8(e,t)}nextGraphemeLength(){const e=nd.getInstance(),t=this._iterator,i=t.offset;let s=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(Xz(s,o)){t.setOffset(r);break}s=o}return t.offset-i}prevGraphemeLength(){const e=nd.getInstance(),t=this._iterator,i=t.offset;let s=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(Xz(o,s)){t.setOffset(r);break}s=o}return i-t.offset}eol(){return this._iterator.eol()}}function d8(n,e){return new FL(n,e).nextGraphemeLength()}function Rie(n,e){return new FL(n,e).prevGraphemeLength()}function XAe(n,e){e>0&&Y_(n.charCodeAt(e))&&e--;const t=e+d8(n,e);return[t-Rie(n,t),t]}let xN;function QAe(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function uy(n){return xN||(xN=QAe()),xN.test(n)}const JAe=/^[\t\n\r\x20-\x7E]*$/;function f8(n){return JAe.test(n)}const Mie=/[\u2028\u2029]/;function Fie(n){return Mie.test(n)}function Jd(n){return n>=11904&&n<=55215||n>=63744&&n<=64255||n>=65281&&n<=65374}function g8(n){return n>=127462&&n<=127487||n===8986||n===8987||n===9200||n===9203||n>=9728&&n<=10175||n===11088||n===11093||n>=127744&&n<=128591||n>=128640&&n<=128764||n>=128992&&n<=129008||n>=129280&&n<=129535||n>=129648&&n<=129782}const eIe=String.fromCharCode(65279);function p8(n){return!!(n&&n.length>0&&n.charCodeAt(0)===65279)}function tIe(n,e=!1){return n?(e&&(n=n.replace(/\\./g,"")),n.toLowerCase()!==n):!1}function Pie(n){return n=n%(2*26),n<26?String.fromCharCode(97+n):String.fromCharCode(65+n-26)}function Xz(n,e){return n===0?e!==5&&e!==7:n===2&&e===3?!1:n===4||n===2||n===3||e===4||e===2||e===3?!0:!(n===8&&(e===8||e===9||e===11||e===12)||(n===11||n===9)&&(e===9||e===10)||(n===12||n===10)&&e===10||e===5||e===13||e===7||n===1||n===13&&e===14||n===6&&e===6)}class nd{static getInstance(){return nd._INSTANCE||(nd._INSTANCE=new nd),nd._INSTANCE}constructor(){this._data=iIe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let s=1;for(;s<=i;)if(e<t[3*s])s=2*s;else if(e>t[3*s+1])s=2*s+1;else return t[3*s+2];return 0}}nd._INSTANCE=null;function iIe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function nIe(n,e){if(n===0)return 0;const t=sIe(n,e);if(t!==void 0)return t;const i=new h8(e,n);return i.prevCodePoint(),i.offset}function sIe(n,e){const t=new h8(e,n);let i=t.prevCodePoint();for(;rIe(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!g8(i))return;let s=t.offset;return s>0&&t.prevCodePoint()===8205&&(s=t.offset),s}function rIe(n){return 127995<=n&&n<=127999}class Sp{static getInstance(e){return Z_.cache.get(Array.from(e))}static getLocales(){return Z_._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}Z_=Sp;Sp.ambiguousCharacterData=new Jp(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));Sp.cache=new UAe(n=>{function e(c){const u=new Map;for(let h=0;h<c.length;h+=2)u.set(c[h],c[h+1]);return u}function t(c,u){const h=new Map(c);for(const[d,f]of u)h.set(d,f);return h}function i(c,u){if(!c)return u;const h=new Map;for(const[d,f]of c)u.has(d)&&h.set(d,f);return h}const s=Z_.ambiguousCharacterData.value;let r=n.filter(c=>!c.startsWith("_")&&c in s);r.length===0&&(r=["_default"]);let o;for(const c of r){const u=e(s[c]);o=i(o,u)}const a=e(s._common),l=t(a,o);return new Z_(l)});Sp._locales=new Jp(()=>Object.keys(Z_.ambiguousCharacterData.value).filter(n=>!n.startsWith("_")));class Ed{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Ed.getRawData())),this._data}static isInvisibleCharacter(e){return Ed.getData().has(e)}static get codePoints(){return Ed.getData()}}Ed._data=void 0;class F3{constructor(){this._zoomFactor=1}getZoomFactor(){return this._zoomFactor}}F3.INSTANCE=new F3;class oIe extends ae{constructor(){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(e){var t;(t=this._mediaQueryList)===null||t===void 0||t.removeEventListener("change",this._listener),this._mediaQueryList=window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),e&&this._onDidChange.fire()}}class aIe extends ae{get value(){return this._value}constructor(){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const e=this._register(new oIe);this._register(e.onDidChange(()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)}))}_getPixelRatio(){const e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}}class lIe{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=new aIe),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}}function Oie(n,e){typeof n=="string"&&(n=window.matchMedia(n)),n.addEventListener("change",e)}const PL=new lIe;function cIe(){return F3.INSTANCE.getZoomFactor()}const qb=navigator.userAgent,Ra=qb.indexOf("Firefox")>=0,zg=qb.indexOf("AppleWebKit")>=0,m8=qb.indexOf("Chrome")>=0,ih=!m8&&qb.indexOf("Safari")>=0,Bie=!m8&&!ih&&zg;qb.indexOf("Electron/")>=0;const Qz=qb.indexOf("Android")>=0;let K2=!1;if(window.matchMedia){const n=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=window.matchMedia("(display-mode: fullscreen)");K2=n.matches,Oie(n,({matches:t})=>{K2&&e.matches||(K2=t)})}function uIe(){return K2}class Wie{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){const t=Ka(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Ka(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Ka(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Ka(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Ka(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Ka(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Ka(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Ka(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Ka(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Ka(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Ka(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Ka(n){return typeof n=="number"?`${n}px`:n}function Bt(n){return new Wie(n)}function fs(n,e){n instanceof Wie?(n.setFontFamily(e.getMassagedFontFamily()),n.setFontWeight(e.fontWeight),n.setFontSize(e.fontSize),n.setFontFeatureSettings(e.fontFeatureSettings),n.setFontVariationSettings(e.fontVariationSettings),n.setLineHeight(e.lineHeight),n.setLetterSpacing(e.letterSpacing)):(n.style.fontFamily=e.getMassagedFontFamily(),n.style.fontWeight=e.fontWeight,n.style.fontSize=e.fontSize+"px",n.style.fontFeatureSettings=e.fontFeatureSettings,n.style.fontVariationSettings=e.fontVariationSettings,n.style.lineHeight=e.lineHeight+"px",n.style.letterSpacing=e.letterSpacing+"px")}class hIe{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class _8{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");fs(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");fs(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const s=document.createElement("div");fs(s,this._bareFontInfo),s.style.fontStyle="italic",e.appendChild(s);const r=[];for(const o of this._requests){let a;o.type===0&&(a=t),o.type===2&&(a=i),o.type===1&&(a=s),a.appendChild(document.createElement("br"));const l=document.createElement("span");_8._render(l,o),a.appendChild(l),r.push(l)}this._container=e,this._testElements=r}static _render(e,t){if(t.chr===" "){let i=" ";for(let s=0;s<8;s++)i+=i;e.innerText=i}else{let i=t.chr;for(let s=0;s<8;s++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],s=this._testElements[e];i.fulfill(s.offsetWidth/256)}}}function dIe(n,e){new _8(n,e).read()}const Gh=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new G,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(n){n=Math.min(Math.max(-5,n),20),this._zoomLevel!==n&&(this._zoomLevel=n,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},fIe=Mt?1.5:1.35,kN=8;class Hg{static createFromValidatedSettings(e,t,i){const s=e.get(49),r=e.get(53),o=e.get(52),a=e.get(51),l=e.get(54),c=e.get(66),u=e.get(63);return Hg._create(s,r,o,a,l,c,u,t,i)}static _create(e,t,i,s,r,o,a,l,c){o===0?o=fIe*i:o<kN&&(o=o*i),o=Math.round(o),o<kN&&(o=kN);const u=1+(c?0:Gh.getZoomLevel()*.1);return i*=u,o*=u,r===cl.TRANSLATE&&(t==="normal"||t==="bold"?r=cl.OFF:(r=`'wght' ${parseInt(t,10)}`,t="normal")),new Hg({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:s,fontVariationSettings:r,lineHeight:o,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=Oo.fontFamily,t=Hg._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const gIe=2;class P3 extends Hg{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=gIe,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class pIe extends ae{constructor(){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._cache=new Jz,this._evictUntrustedReadingsTimeout=-1}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(window.clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache=new Jz,this._onDidChange.fire()}_writeToCache(e,t){this._cache.put(e,t),!t.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=window.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()},5e3))}_evictUntrustedReadings(){const e=this._cache.getValues();let t=!1;for(const i of e)i.isTrusted||(t=!0,this._cache.remove(i));t&&this._onDidChange.fire()}readFontInfo(e){if(!this._cache.has(e)){let t=this._actualReadFontInfo(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new P3({pixelRatio:PL.value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:t.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(t.spaceWidth,5),middotWidth:Math.max(t.middotWidth,5),wsmiddotWidth:Math.max(t.wsmiddotWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}_createRequest(e,t,i,s){const r=new hIe(e,t);return i.push(r),s==null||s.push(r),r}_actualReadFontInfo(e){const t=[],i=[],s=this._createRequest("n",0,t,i),r=this._createRequest("ｍ",0,t,null),o=this._createRequest(" ",0,t,i),a=this._createRequest("0",0,t,i),l=this._createRequest("1",0,t,i),c=this._createRequest("2",0,t,i),u=this._createRequest("3",0,t,i),h=this._createRequest("4",0,t,i),d=this._createRequest("5",0,t,i),f=this._createRequest("6",0,t,i),g=this._createRequest("7",0,t,i),p=this._createRequest("8",0,t,i),m=this._createRequest("9",0,t,i),b=this._createRequest("→",0,t,i),v=this._createRequest("￫",0,t,null),w=this._createRequest("·",0,t,i),y=this._createRequest(String.fromCharCode(11825),0,t,null),x="|/-_ilm%";for(let I=0,N=x.length;I<N;I++)this._createRequest(x.charAt(I),0,t,i),this._createRequest(x.charAt(I),1,t,i),this._createRequest(x.charAt(I),2,t,i);dIe(e,t);const D=Math.max(a.width,l.width,c.width,u.width,h.width,d.width,f.width,g.width,p.width,m.width);let S=e.fontFeatureSettings===Eo.OFF;const T=i[0].width;for(let I=1,N=i.length;S&&I<N;I++){const z=T-i[I].width;if(z<-.001||z>.001){S=!1;break}}let k=!0;return S&&v.width!==T&&(k=!1),v.width>b.width&&(k=!1),new P3({pixelRatio:PL.value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,fontVariationSettings:e.fontVariationSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:S,typicalHalfwidthCharacterWidth:s.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:k,spaceWidth:o.width,middotWidth:w.width,wsmiddotWidth:y.width,maxDigitWidth:D},!0)}}class Jz{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const O3=new pIe;var fl;(function(n){n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=e})(fl||(fl={}));const Wt=kt("instantiationService");function mIe(n,e,t){e[fl.DI_TARGET]===e?e[fl.DI_DEPENDENCIES].push({id:n,index:t}):(e[fl.DI_DEPENDENCIES]=[{id:n,index:t}],e[fl.DI_TARGET]=e)}function kt(n){if(fl.serviceIds.has(n))return fl.serviceIds.get(n);const e=function(t,i,s){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");mIe(e,t,s)};return e.toString=()=>n,fl.serviceIds.set(n,e),e}const ci=kt("codeEditorService"),Zs=kt("modelService"),Cf=kt("textModelService");var X_=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class _o extends ae{constructor(e,t="",i="",s=!0,r){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=s,this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}run(e,t){return X_(this,void 0,void 0,function*(){this._actionCallback&&(yield this._actionCallback(e))})}}class Q_ extends ae{constructor(){super(...arguments),this._onWillRun=this._register(new G),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new G),this.onDidRun=this._onDidRun.event}run(e,t){return X_(this,void 0,void 0,function*(){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{yield this.runAction(e,t)}catch(s){i=s}this._onDidRun.fire({action:e,error:i})})}runAction(e,t){return X_(this,void 0,void 0,function*(){yield e.run(t)})}}class gs{constructor(){this.id=gs.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new gs,...i]:t=i);return t}run(){return X_(this,void 0,void 0,function*(){})}}gs.ID="vs.actions.separator";class fT{get actions(){return this._actions}constructor(e,t,i,s){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=s,this._actions=i}run(){return X_(this,void 0,void 0,function*(){})}}class gT extends _o{constructor(){super(gT.ID,_("submenu.empty","(empty)"),void 0,!1)}}gT.ID="vs.actions.empty";function Hv(n){var e,t;return{id:n.id,label:n.label,class:void 0,enabled:(e=n.enabled)!==null&&e!==void 0?e:!0,checked:(t=n.checked)!==null&&t!==void 0?t:!1,run:(...i)=>X_(this,void 0,void 0,function*(){return n.run(...i)}),tooltip:n.label}}var B3;(function(n){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}n.isThemeColor=e})(B3||(B3={}));var Ye;(function(n){n.iconNameSegment="[A-Za-z0-9]+",n.iconNameExpression="[A-Za-z0-9-]+",n.iconModifierExpression="~[A-Za-z]+",n.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${n.iconNameExpression})(${n.iconModifierExpression})?$`);function t(d){const f=e.exec(d.id);if(!f)return t(we.error);const[,g,p]=f,m=["codicon","codicon-"+g];return p&&m.push("codicon-modifier-"+p.substring(1)),m}n.asClassNameArray=t;function i(d){return t(d).join(" ")}n.asClassName=i;function s(d){return"."+t(d).join(".")}n.asCSSSelector=s;function r(d){return d&&typeof d=="object"&&typeof d.id=="string"&&(typeof d.color>"u"||B3.isThemeColor(d.color))}n.isThemeIcon=r;const o=new RegExp(`^\\$\\((${n.iconNameExpression}(?:${n.iconModifierExpression})?)\\)$`);function a(d){const f=o.exec(d);if(!f)return;const[,g]=f;return{id:g}}n.fromString=a;function l(d){return{id:d}}n.fromId=l;function c(d,f){let g=d.id;const p=g.lastIndexOf("~");return p!==-1&&(g=g.substring(0,p)),f&&(g=`${g}~${f}`),{id:g}}n.modify=c;function u(d){const f=d.id.lastIndexOf("~");if(f!==-1)return d.id.substring(f+1)}n.getModifier=u;function h(d,f){var g,p;return d.id===f.id&&((g=d.color)===null||g===void 0?void 0:g.id)===((p=f.color)===null||p===void 0?void 0:p.id)}n.isEqual=h})(Ye||(Ye={}));const Ys=kt("commandService"),pi=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new G,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(n,e){if(!n)throw new Error("invalid command");if(typeof n=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:n,handler:e})}if(n.description){const o=[];for(const l of n.description.args)o.push(l.constraint);const a=n.handler;n.handler=function(l,...c){return QEe(c,o),a(l,...c)}}const{id:t}=n;let i=this._commands.get(t);i||(i=new hr,this._commands.set(t,i));const s=i.unshift(n),r=ut(()=>{s();const o=this._commands.get(t);o!=null&&o.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),r}registerCommandAlias(n,e){return pi.registerCommand(n,(t,...i)=>t.get(Ys).executeCommand(e,...i))}getCommand(n){const e=this._commands.get(n);if(!(!e||e.isEmpty()))return Et.first(e)}getCommands(){const n=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&n.set(e,t)}return n}};pi.registerCommand("noop",()=>{});function LN(...n){switch(n.length){case 1:return _("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",n[0]);case 2:return _("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",n[0],n[1]);case 3:return _("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",n[0],n[1],n[2]);default:return}}const _Ie=_("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),bIe=_("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class rc{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw t8(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(LN("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(LN("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(LN("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),s={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(s)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=rc._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(_Ie);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(bIe);return}const r=this._input.charCodeAt(e);if(t)t=!1;else if(r===47&&!i){e++;break}else r===91?i=!0:r===92?t=!0:r===93&&(i=!1);e++}for(;e<this._input.length&&rc._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const s=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:s,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}rc._regexFlags=new Set(["i","g","s","m","y","u"].map(n=>n.charCodeAt(0)));rc._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);const _s=new Map;_s.set("false",!1);_s.set("true",!0);_s.set("isMac",Mt);_s.set("isLinux",Ts);_s.set("isWindows",br);_s.set("isWeb",Hb);_s.set("isMacNative",Mt&&!Hb);_s.set("isEdge",gTe);_s.set("isFirefox",dTe);_s.set("isChrome",hie);_s.set("isSafari",fTe);const vIe=Object.prototype.hasOwnProperty,wIe={regexParsingWithErrorRecovery:!0},yIe=_("contextkey.parser.error.emptyString","Empty context key expression"),CIe=_("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),SIe=_("contextkey.parser.error.noInAfterNot","'in' after 'not'."),eH=_("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),xIe=_("contextkey.parser.error.unexpectedToken","Unexpected token"),kIe=_("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),LIe=_("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),DIe=_("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let Vie=class tv{constructor(e=wIe){this._config=e,this._scanner=new rc,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:yIe,offset:0,lexeme:"",additionalInfo:CIe});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),s=i.type===17?kIe:void 0;throw this._parsingErrors.push({message:xIe,offset:i.offset,lexeme:rc.getLexeme(i),additionalInfo:s}),tv._parseError}return t}catch(t){if(t!==tv._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:Ve.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:Ve.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),Gs.INSTANCE;case 12:return this._advance(),vr.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,eH),t==null?void 0:t.negate()}case 17:return this._advance(),nm.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),Ve.true();case 12:return this._advance(),Ve.false();case 0:{this._advance();const t=this._expr();return this._consume(1,eH),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const s=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),s.type!==10)throw this._errExpectedButGot("REGEX",s);const r=s.lexeme,o=r.lastIndexOf("/"),a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",s)}return hy.create(t,l)}switch(s.type){case 10:case 19:{const r=[s.lexeme];this._advance();let o=this._peek(),a=0;for(let d=0;d<s.lexeme.length;d++)s.lexeme.charCodeAt(d)===40?a++:s.lexeme.charCodeAt(d)===41&&a--;for(;!this._isAtEnd()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let d=0;d<o.lexeme.length;d++)o.lexeme.charCodeAt(d)===40?a++:s.lexeme.charCodeAt(d)===41&&a--}if(a<0)break;r.push(rc.getLexeme(o)),this._advance(),o=this._peek()}const l=r.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let h;try{h=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",s)}return Ve.regex(t,h)}case 18:{const r=s.lexeme;this._advance();let o=null;if(!jAe(r)){const a=r.indexOf("/"),l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l),u=r[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",s)}}}if(o===null)throw this._errExpectedButGot("REGEX",s);return hy.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,SIe);const s=this._value();return Ve.notIn(t,s)}switch(this._peek().type){case 3:{this._advance();const s=this._value();if(this._previous().type===18)return Ve.equals(t,s);switch(s){case"true":return Ve.has(t);case"false":return Ve.not(t);default:return Ve.equals(t,s)}}case 4:{this._advance();const s=this._value();if(this._previous().type===18)return Ve.notEquals(t,s);switch(s){case"true":return Ve.not(t);case"false":return Ve.has(t);default:return Ve.notEquals(t,s)}}case 5:return this._advance(),yT.create(t,this._value());case 6:return this._advance(),CT.create(t,this._value());case 7:return this._advance(),vT.create(t,this._value());case 8:return this._advance(),wT.create(t,this._value());case 13:return this._advance(),Ve.in(t,this._value());default:return Ve.has(t)}}case 20:throw this._parsingErrors.push({message:LIe,offset:e.offset,lexeme:"",additionalInfo:DIe}),tv._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const s=_("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,rc.getLexeme(t)),r=t.offset,o=rc.getLexeme(t);return this._parsingErrors.push({message:s,offset:r,lexeme:o,additionalInfo:i}),tv._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};Vie._parseError=new Error;class Ve{static false(){return Gs.INSTANCE}static true(){return vr.INSTANCE}static has(e){return im.create(e)}static equals(e,t){return dS.create(e,t)}static notEquals(e,t){return _T.create(e,t)}static regex(e,t){return hy.create(e,t)}static in(e,t){return pT.create(e,t)}static notIn(e,t){return mT.create(e,t)}static not(e){return nm.create(e)}static and(...e){return Lg.create(e,null,!0)}static or(...e){return Eu.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}}Ve._parser=new Vie({regexParsingWithErrorRecovery:!1});function EIe(n,e){const t=n?n.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function Uv(n,e){return n.cmp(e)}class Gs{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return vr.INSTANCE}}Gs.INSTANCE=new Gs;class vr{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return Gs.INSTANCE}}vr.INSTANCE=new vr;class im{static create(e,t=null){const i=_s.get(e);return typeof i=="boolean"?i?vr.INSTANCE:Gs.INSTANCE:new im(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:zie(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=_s.get(this.key);return typeof e=="boolean"?e?vr.INSTANCE:Gs.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=nm.create(this.key,this)),this.negated}}class dS{static create(e,t,i=null){if(typeof t=="boolean")return t?im.create(e,i):nm.create(e,i);const s=_s.get(e);return typeof s=="boolean"?t===(s?"true":"false")?vr.INSTANCE:Gs.INSTANCE:new dS(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=_s.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?vr.INSTANCE:Gs.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=_T.create(this.key,this.value,this)),this.negated}}class pT{static create(e,t){return new pT(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?vIe.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=mT.create(this.key,this.valueKey)),this.negated}}class mT{static create(e,t){return new mT(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=pT.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class _T{static create(e,t,i=null){if(typeof t=="boolean")return t?nm.create(e,i):im.create(e,i);const s=_s.get(e);return typeof s=="boolean"?t===(s?"true":"false")?Gs.INSTANCE:vr.INSTANCE:new _T(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=_s.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Gs.INSTANCE:vr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=dS.create(this.key,this.value,this)),this.negated}}class nm{static create(e,t=null){const i=_s.get(e);return typeof i=="boolean"?i?Gs.INSTANCE:vr.INSTANCE:new nm(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:zie(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=_s.get(this.key);return typeof e=="boolean"?e?Gs.INSTANCE:vr.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=im.create(this.key,this)),this.negated}}function bT(n,e){if(typeof n=="string"){const t=parseFloat(n);isNaN(t)||(n=t)}return typeof n=="string"||typeof n=="number"?e(n):Gs.INSTANCE}class vT{static create(e,t,i=null){return bT(t,s=>new vT(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=CT.create(this.key,this.value,this)),this.negated}}class wT{static create(e,t,i=null){return bT(t,s=>new wT(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=yT.create(this.key,this.value,this)),this.negated}}class yT{static create(e,t,i=null){return bT(t,s=>new yT(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=wT.create(this.key,this.value,this)),this.negated}}class CT{static create(e,t,i=null){return bT(t,s=>new CT(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:sm(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=vT.create(this.key,this.value,this)),this.negated}}class hy{static create(e,t){return new hy(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=b8.create(this)),this.negated}}class b8{static create(e){return new b8(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function $ie(n){let e=null;for(let t=0,i=n.length;t<i;t++){const s=n[t].substituteConstants();if(n[t]!==s&&e===null){e=[];for(let r=0;r<t;r++)e[r]=n[r]}e!==null&&(e[t]=s)}return e===null?n:e}class Lg{static create(e,t,i){return Lg._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const s=Uv(this.expr[t],e.expr[t]);if(s!==0)return s}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=$ie(this.expr);return e===this.expr?this:Lg.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const s=[];let r=!1;for(const o of e)if(o){if(o.type===1){r=!0;continue}if(o.type===0)return Gs.INSTANCE;if(o.type===6){s.push(...o.expr);continue}s.push(o)}if(s.length===0&&r)return vr.INSTANCE;if(s.length!==0){if(s.length===1)return s[0];s.sort(Uv);for(let o=1;o<s.length;o++)s[o-1].equals(s[o])&&(s.splice(o,1),o--);if(s.length===1)return s[0];for(;s.length>1;){const o=s[s.length-1];if(o.type!==9)break;s.pop();const a=s.pop(),l=s.length===0,c=Eu.create(o.expr.map(u=>Lg.create([u,a],null,i)),null,l);c&&(s.push(c),s.sort(Uv))}if(s.length===1)return s[0];if(i){for(let o=0;o<s.length;o++)for(let a=o+1;a<s.length;a++)if(s[o].negate().equals(s[a]))return Gs.INSTANCE;if(s.length===1)return s[0]}return new Lg(s,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Eu.create(e,this,!0)}return this.negated}}class Eu{static create(e,t,i){return Eu._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const s=Uv(this.expr[t],e.expr[t]);if(s!==0)return s}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=$ie(this.expr);return e===this.expr?this:Eu.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let s=[],r=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===0){r=!0;continue}if(l.type===1)return vr.INSTANCE;if(l.type===9){s=s.concat(l.expr);continue}s.push(l)}}if(s.length===0&&r)return Gs.INSTANCE;s.sort(Uv)}if(s.length!==0){if(s.length===1)return s[0];for(let o=1;o<s.length;o++)s[o-1].equals(s[o])&&(s.splice(o,1),o--);if(s.length===1)return s[0];if(i){for(let o=0;o<s.length;o++)for(let a=o+1;a<s.length;a++)if(s[o].negate().equals(s[a]))return vr.INSTANCE;if(s.length===1)return s[0]}return new Eu(s,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),s=[];for(const r of iH(t))for(const o of iH(i))s.push(Lg.create([r,o],null,!1));e.unshift(Eu.create(s,null,!1))}this.negated=Eu.create(e,this,!0)}return this.negated}}class Fe extends im{static all(){return Fe._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?Fe._info.push(Object.assign(Object.assign({},i),{key:e})):i!==!0&&Fe._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return dS.create(this.key,e)}}Fe._info=[];const _t=kt("contextKeyService");function zie(n,e){return n<e?-1:n>e?1:0}function sm(n,e,t,i){return n<t?-1:n>t?1:e<i?-1:e>i?1:0}function W3(n,e){if(n.type===0||e.type===1)return!0;if(n.type===9)return e.type===9?tH(n.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(W3(n,t))return!0;return!1}if(n.type===6){if(e.type===6)return tH(e.expr,n.expr);for(const t of n.expr)if(W3(t,e))return!0;return!1}return n.equals(e)}function tH(n,e){let t=0,i=0;for(;t<n.length&&i<e.length;){const s=n[t].cmp(e[i]);if(s<0)return!1;s===0&&t++,i++}return t===n.length}function iH(n){return n.type===9?n.expr:[n]}function V3(n,e){if(typeof n=="number"){if(n===0)return null;const t=(n&65535)>>>0,i=(n&4294901760)>>>16;return i!==0?new DN([wx(t,e),wx(i,e)]):new DN([wx(t,e)])}else{const t=[];for(let i=0;i<n.length;i++)t.push(wx(n[i],e));return new DN(t)}}function wx(n,e){const t=!!(n&2048),i=!!(n&256),s=e===2?i:t,r=!!(n&1024),o=!!(n&512),a=e===2?t:i,l=n&255;return new xp(s,r,o,a,l)}class xp{constructor(e,t,i,s,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=s,this.keyCode=r}equals(e){return e instanceof xp&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class DN{constructor(e){if(e.length===0)throw ju("chords");this.chords=e}}class TIe{constructor(e,t,i,s,r,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=s,this.keyLabel=r,this.keyAriaLabel=o}}class AIe{}function EN(n,e){if(!n)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function v8(n,e="Unreachable"){throw new Error(e)}function dy(n){if(!n()){debugger;n(),Ft(new mn("Assertion Failed"))}}function Hie(n,e){let t=0;for(;t<n.length-1;){const i=n[t],s=n[t+1];if(!e(i,s))return!1;t++}return!0}class IIe{constructor(){this.data=new Map}add(e,t){EN(_r(e)),EN(ur(t)),EN(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const Un=new IIe;class w8{constructor(){this._coreKeybindings=new hr,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(co===1){if(e&&e.win)return e.win}else if(co===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=w8.bindToCurrentPlatform(e),i=new Ae;if(t&&t.primary){const s=V3(t.primary,co);s&&i.add(this._registerDefaultKeybinding(s,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let s=0,r=t.secondary.length;s<r;s++){const o=t.secondary[s],a=V3(o,co);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-s-1,e.when))}return i}registerCommandAndKeybindingRule(e){return ka(this.registerKeybindingRule(e),pi.registerCommand(e))}_registerDefaultKeybinding(e,t,i,s,r,o){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:o,weight1:s,weight2:r,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ut(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(RIe)),this._cachedMergedKeybindings.slice(0)}}const wr=new w8,NIe={EditorModes:"platform.keybindingsRegistry"};Un.add(NIe.EditorModes,wr);function RIe(n,e){if(n.weight1!==e.weight1)return n.weight1-e.weight1;if(n.command&&e.command){if(n.command<e.command)return-1;if(n.command>e.command)return 1}return n.weight2-e.weight2}var MIe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},nH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},FIe=globalThis&&globalThis.__rest||function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t},Z2;function iv(n){return n.command!==void 0}function PIe(n){return n.submenu!==void 0}class B{constructor(e){if(B._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);B._instances.set(e,this),this.id=e}}B._instances=new Map;B.CommandPalette=new B("CommandPalette");B.DebugBreakpointsContext=new B("DebugBreakpointsContext");B.DebugCallStackContext=new B("DebugCallStackContext");B.DebugConsoleContext=new B("DebugConsoleContext");B.DebugVariablesContext=new B("DebugVariablesContext");B.DebugWatchContext=new B("DebugWatchContext");B.DebugToolBar=new B("DebugToolBar");B.DebugToolBarStop=new B("DebugToolBarStop");B.EditorContext=new B("EditorContext");B.SimpleEditorContext=new B("SimpleEditorContext");B.EditorContent=new B("EditorContent");B.EditorLineNumberContext=new B("EditorLineNumberContext");B.EditorContextCopy=new B("EditorContextCopy");B.EditorContextPeek=new B("EditorContextPeek");B.EditorContextShare=new B("EditorContextShare");B.EditorTitle=new B("EditorTitle");B.EditorTitleRun=new B("EditorTitleRun");B.EditorTitleContext=new B("EditorTitleContext");B.EditorTitleContextShare=new B("EditorTitleContextShare");B.EmptyEditorGroup=new B("EmptyEditorGroup");B.EmptyEditorGroupContext=new B("EmptyEditorGroupContext");B.EditorTabsBarContext=new B("EditorTabsBarContext");B.ExplorerContext=new B("ExplorerContext");B.ExplorerContextShare=new B("ExplorerContextShare");B.ExtensionContext=new B("ExtensionContext");B.GlobalActivity=new B("GlobalActivity");B.CommandCenter=new B("CommandCenter");B.CommandCenterCenter=new B("CommandCenterCenter");B.LayoutControlMenuSubmenu=new B("LayoutControlMenuSubmenu");B.LayoutControlMenu=new B("LayoutControlMenu");B.MenubarMainMenu=new B("MenubarMainMenu");B.MenubarAppearanceMenu=new B("MenubarAppearanceMenu");B.MenubarDebugMenu=new B("MenubarDebugMenu");B.MenubarEditMenu=new B("MenubarEditMenu");B.MenubarCopy=new B("MenubarCopy");B.MenubarFileMenu=new B("MenubarFileMenu");B.MenubarGoMenu=new B("MenubarGoMenu");B.MenubarHelpMenu=new B("MenubarHelpMenu");B.MenubarLayoutMenu=new B("MenubarLayoutMenu");B.MenubarNewBreakpointMenu=new B("MenubarNewBreakpointMenu");B.PanelAlignmentMenu=new B("PanelAlignmentMenu");B.PanelPositionMenu=new B("PanelPositionMenu");B.MenubarPreferencesMenu=new B("MenubarPreferencesMenu");B.MenubarRecentMenu=new B("MenubarRecentMenu");B.MenubarSelectionMenu=new B("MenubarSelectionMenu");B.MenubarShare=new B("MenubarShare");B.MenubarSwitchEditorMenu=new B("MenubarSwitchEditorMenu");B.MenubarSwitchGroupMenu=new B("MenubarSwitchGroupMenu");B.MenubarTerminalMenu=new B("MenubarTerminalMenu");B.MenubarViewMenu=new B("MenubarViewMenu");B.MenubarHomeMenu=new B("MenubarHomeMenu");B.OpenEditorsContext=new B("OpenEditorsContext");B.OpenEditorsContextShare=new B("OpenEditorsContextShare");B.ProblemsPanelContext=new B("ProblemsPanelContext");B.SCMChangeContext=new B("SCMChangeContext");B.SCMResourceContext=new B("SCMResourceContext");B.SCMResourceContextShare=new B("SCMResourceContextShare");B.SCMResourceFolderContext=new B("SCMResourceFolderContext");B.SCMResourceGroupContext=new B("SCMResourceGroupContext");B.SCMSourceControl=new B("SCMSourceControl");B.SCMTitle=new B("SCMTitle");B.SearchContext=new B("SearchContext");B.SearchActionMenu=new B("SearchActionContext");B.StatusBarWindowIndicatorMenu=new B("StatusBarWindowIndicatorMenu");B.StatusBarRemoteIndicatorMenu=new B("StatusBarRemoteIndicatorMenu");B.StickyScrollContext=new B("StickyScrollContext");B.TestItem=new B("TestItem");B.TestItemGutter=new B("TestItemGutter");B.TestMessageContext=new B("TestMessageContext");B.TestMessageContent=new B("TestMessageContent");B.TestPeekElement=new B("TestPeekElement");B.TestPeekTitle=new B("TestPeekTitle");B.TouchBarContext=new B("TouchBarContext");B.TitleBarContext=new B("TitleBarContext");B.TitleBarTitleContext=new B("TitleBarTitleContext");B.TunnelContext=new B("TunnelContext");B.TunnelPrivacy=new B("TunnelPrivacy");B.TunnelProtocol=new B("TunnelProtocol");B.TunnelPortInline=new B("TunnelInline");B.TunnelTitle=new B("TunnelTitle");B.TunnelLocalAddressInline=new B("TunnelLocalAddressInline");B.TunnelOriginInline=new B("TunnelOriginInline");B.ViewItemContext=new B("ViewItemContext");B.ViewContainerTitle=new B("ViewContainerTitle");B.ViewContainerTitleContext=new B("ViewContainerTitleContext");B.ViewTitle=new B("ViewTitle");B.ViewTitleContext=new B("ViewTitleContext");B.CommentEditorActions=new B("CommentEditorActions");B.CommentThreadTitle=new B("CommentThreadTitle");B.CommentThreadActions=new B("CommentThreadActions");B.CommentThreadAdditionalActions=new B("CommentThreadAdditionalActions");B.CommentThreadTitleContext=new B("CommentThreadTitleContext");B.CommentThreadCommentContext=new B("CommentThreadCommentContext");B.CommentTitle=new B("CommentTitle");B.CommentActions=new B("CommentActions");B.InteractiveToolbar=new B("InteractiveToolbar");B.InteractiveCellTitle=new B("InteractiveCellTitle");B.InteractiveCellDelete=new B("InteractiveCellDelete");B.InteractiveCellExecute=new B("InteractiveCellExecute");B.InteractiveInputExecute=new B("InteractiveInputExecute");B.NotebookToolbar=new B("NotebookToolbar");B.NotebookStickyScrollContext=new B("NotebookStickyScrollContext");B.NotebookCellTitle=new B("NotebookCellTitle");B.NotebookCellDelete=new B("NotebookCellDelete");B.NotebookCellInsert=new B("NotebookCellInsert");B.NotebookCellBetween=new B("NotebookCellBetween");B.NotebookCellListTop=new B("NotebookCellTop");B.NotebookCellExecute=new B("NotebookCellExecute");B.NotebookCellExecutePrimary=new B("NotebookCellExecutePrimary");B.NotebookDiffCellInputTitle=new B("NotebookDiffCellInputTitle");B.NotebookDiffCellMetadataTitle=new B("NotebookDiffCellMetadataTitle");B.NotebookDiffCellOutputsTitle=new B("NotebookDiffCellOutputsTitle");B.NotebookOutputToolbar=new B("NotebookOutputToolbar");B.NotebookEditorLayoutConfigure=new B("NotebookEditorLayoutConfigure");B.NotebookKernelSource=new B("NotebookKernelSource");B.BulkEditTitle=new B("BulkEditTitle");B.BulkEditContext=new B("BulkEditContext");B.TimelineItemContext=new B("TimelineItemContext");B.TimelineTitle=new B("TimelineTitle");B.TimelineTitleContext=new B("TimelineTitleContext");B.TimelineFilterSubMenu=new B("TimelineFilterSubMenu");B.AccountsContext=new B("AccountsContext");B.PanelTitle=new B("PanelTitle");B.AuxiliaryBarTitle=new B("AuxiliaryBarTitle");B.TerminalInstanceContext=new B("TerminalInstanceContext");B.TerminalEditorInstanceContext=new B("TerminalEditorInstanceContext");B.TerminalNewDropdownContext=new B("TerminalNewDropdownContext");B.TerminalTabContext=new B("TerminalTabContext");B.TerminalTabEmptyAreaContext=new B("TerminalTabEmptyAreaContext");B.WebviewContext=new B("WebviewContext");B.InlineCompletionsActions=new B("InlineCompletionsActions");B.NewFile=new B("NewFile");B.MergeInput1Toolbar=new B("MergeToolbar1Toolbar");B.MergeInput2Toolbar=new B("MergeToolbar2Toolbar");B.MergeBaseToolbar=new B("MergeBaseToolbar");B.MergeInputResultToolbar=new B("MergeToolbarResultToolbar");B.InlineSuggestionToolbar=new B("InlineSuggestionToolbar");B.ChatContext=new B("ChatContext");B.ChatCodeBlock=new B("ChatCodeblock");B.ChatMessageTitle=new B("ChatMessageTitle");B.ChatExecute=new B("ChatExecute");B.ChatInputSide=new B("ChatInputSide");B.AccessibleView=new B("AccessibleView");const Sf=kt("menuService");class Tu{static for(e){let t=this._all.get(e);return t||(t=new Tu(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof Tu&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}}Tu._all=new Map;const _a=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new pAe({merge:Tu.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(n){return this._commands.set(n.id,n),this._onDidChangeMenu.fire(Tu.for(B.CommandPalette)),ut(()=>{this._commands.delete(n.id)&&this._onDidChangeMenu.fire(Tu.for(B.CommandPalette))})}getCommand(n){return this._commands.get(n)}getCommands(){const n=new Map;return this._commands.forEach((e,t)=>n.set(t,e)),n}appendMenuItem(n,e){let t=this._menuItems.get(n);t||(t=new hr,this._menuItems.set(n,t));const i=t.push(e);return this._onDidChangeMenu.fire(Tu.for(n)),ut(()=>{i(),this._onDidChangeMenu.fire(Tu.for(n))})}appendMenuItems(n){const e=new Ae;for(const{id:t,item:i}of n)e.add(this.appendMenuItem(t,i));return e}getMenuItems(n){let e;return this._menuItems.has(n)?e=[...this._menuItems.get(n)]:e=[],n===B.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(n){const e=new Set;for(const t of n)iv(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||n.push({command:t})})}};class OL extends fT{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let Ac=Z2=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,s,r,o){var a,l;this.hideActions=s,this._commandService=o,this.id=e.id,this.label=Z2.label(e,i),this.tooltip=(l=typeof e.tooltip=="string"?e.tooltip:(a=e.tooltip)===null||a===void 0?void 0:a.value)!==null&&l!==void 0?l:"",this.enabled=!e.precondition||r.contextMatchesRules(e.precondition),this.checked=void 0;let c;if(e.toggled){const u=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=r.contextMatchesRules(u.condition),this.checked&&u.tooltip&&(this.tooltip=typeof u.tooltip=="string"?u.tooltip:u.tooltip.value),this.checked&&Ye.isThemeIcon(u.icon)&&(c=u.icon),this.checked&&u.title&&(this.label=typeof u.title=="string"?u.title:u.title.value)}c||(c=Ye.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new Z2(t,void 0,i,s,r,o):void 0,this._options=i,this.class=c&&Ye.asClassName(c)}run(...e){var t,i;let s=[];return!((t=this._options)===null||t===void 0)&&t.arg&&(s=[...s,this._options.arg]),!((i=this._options)===null||i===void 0)&&i.shouldForwardArgs&&(s=[...s,...e]),this._commandService.executeCommand(this.id,...s)}};Ac=Z2=MIe([nH(4,_t),nH(5,Ys)],Ac);class Gb{constructor(e){this.desc=e}}function Cr(n){const e=new Ae,t=new n,i=t.desc,{f1:s,menu:r,keybinding:o,description:a}=i,l=FIe(i,["f1","menu","keybinding","description"]);if(e.add(pi.registerCommand({id:l.id,handler:(c,...u)=>t.run(c,...u),description:a})),Array.isArray(r))for(const c of r)e.add(_a.appendMenuItem(c.id,Object.assign({command:Object.assign(Object.assign({},l),{precondition:c.precondition===null?void 0:l.precondition})},c)));else r&&e.add(_a.appendMenuItem(r.id,Object.assign({command:Object.assign(Object.assign({},l),{precondition:r.precondition===null?void 0:l.precondition})},r)));if(s&&(e.add(_a.appendMenuItem(B.CommandPalette,{command:l,when:l.precondition})),e.add(_a.addCommand(l))),Array.isArray(o))for(const c of o)e.add(wr.registerKeybindingRule(Object.assign(Object.assign({},c),{id:l.id,when:l.precondition?Ve.and(l.precondition,c.when):c.when})));else o&&e.add(wr.registerKeybindingRule(Object.assign(Object.assign({},o),{id:l.id,when:l.precondition?Ve.and(l.precondition,o.when):o.when})));return e}const ah=kt("telemetryService"),lh=kt("logService");var Xn;(function(n){n[n.Off=0]="Off",n[n.Trace=1]="Trace",n[n.Debug=2]="Debug",n[n.Info=3]="Info",n[n.Warning=4]="Warning",n[n.Error=5]="Error"})(Xn||(Xn={}));const Uie=Xn.Info;class jie extends ae{constructor(){super(...arguments),this.level=Uie,this._onDidChangeLogLevel=this._register(new G),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Xn.Off&&this.level<=e}}class OIe extends jie{constructor(e=Uie,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.checkLogLevel(Xn.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.checkLogLevel(Xn.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.checkLogLevel(Xn.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.checkLogLevel(Xn.Warning)&&(this.useColors?console.log("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.checkLogLevel(Xn.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...t):console.error(e,...t))}dispose(){}}class BIe extends jie{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose()}}function WIe(n){switch(n){case Xn.Trace:return"trace";case Xn.Debug:return"debug";case Xn.Info:return"info";case Xn.Warning:return"warn";case Xn.Error:return"error";case Xn.Off:return"off"}}new Fe("logLevel",WIe(Xn.Info));const y8={clipboard:{writeText:j0||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:j0||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:(()=>j0||uIe()?0:navigator.keyboard||ih?1:2)(),touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)};function VIe(n){if(n.charCode){const t=String.fromCharCode(n.charCode).toUpperCase();return Du.fromString(t)}const e=n.keyCode;if(e===3)return 7;if(Ra)switch(e){case 59:return 85;case 60:if(Ts)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Mt)return 57;break}else if(zg){if(Mt&&e===93)return 57;if(!Mt&&e===92)return 57}return yie[e]||0}const $Ie=Mt?256:2048,zIe=512,HIe=1024,UIe=Mt?2048:256;class ri{constructor(e){this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState("AltGraph"),this.keyCode=VIe(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=$Ie),this.altKey&&(t|=zIe),this.shiftKey&&(t|=HIe),this.metaKey&&(t|=UIe),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new xp(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let sH=!1,v1=null;function jIe(n){if(!n.parent||n.parent===n)return null;try{const e=n.location,t=n.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return sH=!0,null}catch{return sH=!0,null}return n.parent}class qIe{static getSameOriginWindowChain(){if(!v1){v1=[];let e=window,t;do t=jIe(e),t?v1.push({window:e,iframeElement:e.frameElement||null}):v1.push({window:e,iframeElement:null}),e=t;while(e)}return v1.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,s=0;const r=this.getSameOriginWindowChain();for(const o of r){if(i+=o.window.scrollY,s+=o.window.scrollX,o.window===t||!o.iframeElement)break;const a=o.iframeElement.getBoundingClientRect();i+=a.top,s+=a.left}return{top:i,left:s}}}class ba{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=e.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const t=qIe.getPositionOfChildWindowRelativeToAncestorWindow(window,e.view);this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class kp{constructor(e,t=0,i=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t,e){const s=e,r=e;if(typeof s.wheelDeltaY<"u")this.deltaY=s.wheelDeltaY/120;else if(typeof r.VERTICAL_AXIS<"u"&&r.axis===r.VERTICAL_AXIS)this.deltaY=-r.detail/3;else if(e.type==="wheel"){const o=e;o.deltaMode===o.DOM_DELTA_LINE?Ra&&!Mt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof s.wheelDeltaX<"u")ih&&br?this.deltaX=-(s.wheelDeltaX/120):this.deltaX=s.wheelDeltaX/120;else if(typeof r.HORIZONTAL_AXIS<"u"&&r.axis===r.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const o=e;o.deltaMode===o.DOM_DELTA_LINE?Ra&&!Mt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)===null||e===void 0||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)===null||e===void 0||e.stopPropagation()}}/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:qie,setPrototypeOf:rH,isFrozen:GIe,getPrototypeOf:KIe,getOwnPropertyDescriptor:ZIe}=Object;let{freeze:Wr,seal:yl,create:YIe}=Object,{apply:$3,construct:z3}=typeof Reflect<"u"&&Reflect;$3||($3=function(e,t,i){return e.apply(t,i)});Wr||(Wr=function(e){return e});yl||(yl=function(e){return e});z3||(z3=function(e,t){return new e(...t)});const XIe=Ma(Array.prototype.forEach),oH=Ma(Array.prototype.pop),w1=Ma(Array.prototype.push),Y2=Ma(String.prototype.toLowerCase),TN=Ma(String.prototype.toString),QIe=Ma(String.prototype.match),Za=Ma(String.prototype.replace),JIe=Ma(String.prototype.indexOf),eNe=Ma(String.prototype.trim),xo=Ma(RegExp.prototype.test),y1=tNe(TypeError);function Ma(n){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return $3(n,e,i)}}function tNe(n){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return z3(n,t)}}function Ht(n,e,t){var i;t=(i=t)!==null&&i!==void 0?i:Y2,rH&&rH(n,null);let s=e.length;for(;s--;){let r=e[s];if(typeof r=="string"){const o=t(r);o!==r&&(GIe(e)||(e[s]=o),r=o)}n[r]=!0}return n}function Mm(n){const e=YIe(null);for(const[t,i]of qie(n))e[t]=i;return e}function yx(n,e){for(;n!==null;){const i=ZIe(n,e);if(i){if(i.get)return Ma(i.get);if(typeof i.value=="function")return Ma(i.value)}n=KIe(n)}function t(i){return console.warn("fallback value for",i),null}return t}const aH=Wr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),AN=Wr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),IN=Wr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),iNe=Wr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),NN=Wr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),nNe=Wr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lH=Wr(["#text"]),cH=Wr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),RN=Wr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),uH=Wr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Cx=Wr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),sNe=yl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rNe=yl(/<%[\w\W]*|[\w\W]*%>/gm),oNe=yl(/\${[\w\W]*}/gm),aNe=yl(/^data-[\-\w.\u00B7-\uFFFF]/),lNe=yl(/^aria-[\-\w]+$/),Gie=yl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cNe=yl(/^(?:\w+script|data):/i),uNe=yl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Kie=yl(/^html$/i);var hH=Object.freeze({__proto__:null,MUSTACHE_EXPR:sNe,ERB_EXPR:rNe,TMPLIT_EXPR:oNe,DATA_ATTR:aNe,ARIA_ATTR:lNe,IS_ALLOWED_URI:Gie,IS_SCRIPT_OR_DATA:cNe,ATTR_WHITESPACE:uNe,DOCTYPE_NAME:Kie});const hNe=()=>typeof window>"u"?null:window,dNe=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(i=t.getAttribute(s));const r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function Zie(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hNe();const e=Te=>Zie(Te);if(e.version="3.0.5",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;const t=n.document,i=t.currentScript;let{document:s}=n;const{DocumentFragment:r,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=n,g=l.prototype,p=yx(g,"cloneNode"),m=yx(g,"nextSibling"),b=yx(g,"childNodes"),v=yx(g,"parentNode");if(typeof o=="function"){const Te=s.createElement("template");Te.content&&Te.content.ownerDocument&&(s=Te.content.ownerDocument)}let w,y="";const{implementation:x,createNodeIterator:D,createDocumentFragment:S,getElementsByTagName:T}=s,{importNode:k}=t;let I={};e.isSupported=typeof qie=="function"&&typeof v=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:N,ERB_EXPR:z,TMPLIT_EXPR:$,DATA_ATTR:q,ARIA_ATTR:ne,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:me}=hH;let{IS_ALLOWED_URI:De}=hH,ve=null;const $e=Ht({},[...aH,...AN,...IN,...NN,...lH]);let Ne=null;const xe=Ht({},[...cH,...RN,...uH,...Cx]);let fe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),jt=null,mi=null,re=!0,te=!0,ye=!1,_e=!0,Ie=!1,F=!1,M=!1,pe=!1,ke=!1,et=!1,Xe=!1,Nt=!0,is=!1;const Zo="user-content-";let le=!0,ie=!1,Q={},R=null;const W=Ht({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let K=null;const U=Ht({},["audio","video","img","source","image","track"]);let A=null;const C=Ht({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),L="http://www.w3.org/1998/Math/MathML",O="http://www.w3.org/2000/svg",j="http://www.w3.org/1999/xhtml";let Z=j,ce=!1,Ue=null;const Re=Ht({},[L,O,j],TN);let lt;const ft=["application/xhtml+xml","text/html"],$t="text/html";let Rt,qi=null;const jc=s.createElement("form"),Fl=function(se){return se instanceof RegExp||se instanceof Function},Gr=function(se){if(!(qi&&qi===se)){if((!se||typeof se!="object")&&(se={}),se=Mm(se),lt=ft.indexOf(se.PARSER_MEDIA_TYPE)===-1?lt=$t:lt=se.PARSER_MEDIA_TYPE,Rt=lt==="application/xhtml+xml"?TN:Y2,ve="ALLOWED_TAGS"in se?Ht({},se.ALLOWED_TAGS,Rt):$e,Ne="ALLOWED_ATTR"in se?Ht({},se.ALLOWED_ATTR,Rt):xe,Ue="ALLOWED_NAMESPACES"in se?Ht({},se.ALLOWED_NAMESPACES,TN):Re,A="ADD_URI_SAFE_ATTR"in se?Ht(Mm(C),se.ADD_URI_SAFE_ATTR,Rt):C,K="ADD_DATA_URI_TAGS"in se?Ht(Mm(U),se.ADD_DATA_URI_TAGS,Rt):U,R="FORBID_CONTENTS"in se?Ht({},se.FORBID_CONTENTS,Rt):W,jt="FORBID_TAGS"in se?Ht({},se.FORBID_TAGS,Rt):{},mi="FORBID_ATTR"in se?Ht({},se.FORBID_ATTR,Rt):{},Q="USE_PROFILES"in se?se.USE_PROFILES:!1,re=se.ALLOW_ARIA_ATTR!==!1,te=se.ALLOW_DATA_ATTR!==!1,ye=se.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ie=se.SAFE_FOR_TEMPLATES||!1,F=se.WHOLE_DOCUMENT||!1,ke=se.RETURN_DOM||!1,et=se.RETURN_DOM_FRAGMENT||!1,Xe=se.RETURN_TRUSTED_TYPE||!1,pe=se.FORCE_BODY||!1,Nt=se.SANITIZE_DOM!==!1,is=se.SANITIZE_NAMED_PROPS||!1,le=se.KEEP_CONTENT!==!1,ie=se.IN_PLACE||!1,De=se.ALLOWED_URI_REGEXP||Gie,Z=se.NAMESPACE||j,fe=se.CUSTOM_ELEMENT_HANDLING||{},se.CUSTOM_ELEMENT_HANDLING&&Fl(se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(fe.tagNameCheck=se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),se.CUSTOM_ELEMENT_HANDLING&&Fl(se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(fe.attributeNameCheck=se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),se.CUSTOM_ELEMENT_HANDLING&&typeof se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(fe.allowCustomizedBuiltInElements=se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ie&&(te=!1),et&&(ke=!0),Q&&(ve=Ht({},[...lH]),Ne=[],Q.html===!0&&(Ht(ve,aH),Ht(Ne,cH)),Q.svg===!0&&(Ht(ve,AN),Ht(Ne,RN),Ht(Ne,Cx)),Q.svgFilters===!0&&(Ht(ve,IN),Ht(Ne,RN),Ht(Ne,Cx)),Q.mathMl===!0&&(Ht(ve,NN),Ht(Ne,uH),Ht(Ne,Cx))),se.ADD_TAGS&&(ve===$e&&(ve=Mm(ve)),Ht(ve,se.ADD_TAGS,Rt)),se.ADD_ATTR&&(Ne===xe&&(Ne=Mm(Ne)),Ht(Ne,se.ADD_ATTR,Rt)),se.ADD_URI_SAFE_ATTR&&Ht(A,se.ADD_URI_SAFE_ATTR,Rt),se.FORBID_CONTENTS&&(R===W&&(R=Mm(R)),Ht(R,se.FORBID_CONTENTS,Rt)),le&&(ve["#text"]=!0),F&&Ht(ve,["html","head","body"]),ve.table&&(Ht(ve,["tbody"]),delete jt.tbody),se.TRUSTED_TYPES_POLICY){if(typeof se.TRUSTED_TYPES_POLICY.createHTML!="function")throw y1('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof se.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw y1('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=se.TRUSTED_TYPES_POLICY,y=w.createHTML("")}else w===void 0&&(w=dNe(f,i)),w!==null&&typeof y=="string"&&(y=w.createHTML(""));Wr&&Wr(se),qi=se}},Pl=Ht({},["mi","mo","mn","ms","mtext"]),qc=Ht({},["foreignobject","desc","title","annotation-xml"]),Ol=Ht({},["title","style","font","a","script"]),Gc=Ht({},AN);Ht(Gc,IN),Ht(Gc,iNe);const Y=Ht({},NN);Ht(Y,nNe);const ns=function(se){let Me=v(se);(!Me||!Me.tagName)&&(Me={namespaceURI:Z,tagName:"template"});const Ke=Y2(se.tagName),_i=Y2(Me.tagName);return Ue[se.namespaceURI]?se.namespaceURI===O?Me.namespaceURI===j?Ke==="svg":Me.namespaceURI===L?Ke==="svg"&&(_i==="annotation-xml"||Pl[_i]):!!Gc[Ke]:se.namespaceURI===L?Me.namespaceURI===j?Ke==="math":Me.namespaceURI===O?Ke==="math"&&qc[_i]:!!Y[Ke]:se.namespaceURI===j?Me.namespaceURI===O&&!qc[_i]||Me.namespaceURI===L&&!Pl[_i]?!1:!Y[Ke]&&(Ol[Ke]||!Gc[Ke]):!!(lt==="application/xhtml+xml"&&Ue[se.namespaceURI]):!1},Sr=function(se){w1(e.removed,{element:se});try{se.parentNode.removeChild(se)}catch{se.remove()}},Js=function(se,Me){try{w1(e.removed,{attribute:Me.getAttributeNode(se),from:Me})}catch{w1(e.removed,{attribute:null,from:Me})}if(Me.removeAttribute(se),se==="is"&&!Ne[se])if(ke||et)try{Sr(Me)}catch{}else try{Me.setAttribute(se,"")}catch{}},Kc=function(se){let Me,Ke;if(pe)se="<remove></remove>"+se;else{const Rs=QIe(se,/^[\r\n\t ]+/);Ke=Rs&&Rs[0]}lt==="application/xhtml+xml"&&Z===j&&(se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+se+"</body></html>");const _i=w?w.createHTML(se):se;if(Z===j)try{Me=new d().parseFromString(_i,lt)}catch{}if(!Me||!Me.documentElement){Me=x.createDocument(Z,"template",null);try{Me.documentElement.innerHTML=ce?y:_i}catch{}}const Nn=Me.body||Me.documentElement;return se&&Ke&&Nn.insertBefore(s.createTextNode(Ke),Nn.childNodes[0]||null),Z===j?T.call(Me,F?"html":"body")[0]:F?Me.documentElement:Nn},ht=function(se){return D.call(se.ownerDocument||se,se,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},wm=function(se){return se instanceof h&&(typeof se.nodeName!="string"||typeof se.textContent!="string"||typeof se.removeChild!="function"||!(se.attributes instanceof u)||typeof se.removeAttribute!="function"||typeof se.setAttribute!="function"||typeof se.namespaceURI!="string"||typeof se.insertBefore!="function"||typeof se.hasChildNodes!="function")},Nf=function(se){return typeof a=="object"?se instanceof a:se&&typeof se=="object"&&typeof se.nodeType=="number"&&typeof se.nodeName=="string"},qt=function(se,Me,Ke){I[se]&&XIe(I[se],_i=>{_i.call(e,Me,Ke,qi)})},ph=function(se){let Me;if(qt("beforeSanitizeElements",se,null),wm(se))return Sr(se),!0;const Ke=Rt(se.nodeName);if(qt("uponSanitizeElement",se,{tagName:Ke,allowedTags:ve}),se.hasChildNodes()&&!Nf(se.firstElementChild)&&(!Nf(se.content)||!Nf(se.content.firstElementChild))&&xo(/<[/\w]/g,se.innerHTML)&&xo(/<[/\w]/g,se.textContent))return Sr(se),!0;if(!ve[Ke]||jt[Ke]){if(!jt[Ke]&&n1(Ke)&&(fe.tagNameCheck instanceof RegExp&&xo(fe.tagNameCheck,Ke)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(Ke)))return!1;if(le&&!R[Ke]){const _i=v(se)||se.parentNode,Nn=b(se)||se.childNodes;if(Nn&&_i){const Rs=Nn.length;for(let en=Rs-1;en>=0;--en)_i.insertBefore(p(Nn[en],!0),m(se))}}return Sr(se),!0}return se instanceof l&&!ns(se)||(Ke==="noscript"||Ke==="noembed"||Ke==="noframes")&&xo(/<\/no(script|embed|frames)/i,se.innerHTML)?(Sr(se),!0):(Ie&&se.nodeType===3&&(Me=se.textContent,Me=Za(Me,N," "),Me=Za(Me,z," "),Me=Za(Me,$," "),se.textContent!==Me&&(w1(e.removed,{element:se.cloneNode()}),se.textContent=Me)),qt("afterSanitizeElements",se,null),!1)},VS=function(se,Me,Ke){if(Nt&&(Me==="id"||Me==="name")&&(Ke in s||Ke in jc))return!1;if(!(te&&!mi[Me]&&xo(q,Me))){if(!(re&&xo(ne,Me))){if(!Ne[Me]||mi[Me]){if(!(n1(se)&&(fe.tagNameCheck instanceof RegExp&&xo(fe.tagNameCheck,se)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(se))&&(fe.attributeNameCheck instanceof RegExp&&xo(fe.attributeNameCheck,Me)||fe.attributeNameCheck instanceof Function&&fe.attributeNameCheck(Me))||Me==="is"&&fe.allowCustomizedBuiltInElements&&(fe.tagNameCheck instanceof RegExp&&xo(fe.tagNameCheck,Ke)||fe.tagNameCheck instanceof Function&&fe.tagNameCheck(Ke))))return!1}else if(!A[Me]){if(!xo(De,Za(Ke,me,""))){if(!((Me==="src"||Me==="xlink:href"||Me==="href")&&se!=="script"&&JIe(Ke,"data:")===0&&K[se])){if(!(ye&&!xo(de,Za(Ke,me,"")))){if(Ke)return!1}}}}}}return!0},n1=function(se){return se.indexOf("-")>0},s1=function(se){let Me,Ke,_i,Nn;qt("beforeSanitizeAttributes",se,null);const{attributes:Rs}=se;if(!Rs)return;const en={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ne};for(Nn=Rs.length;Nn--;){Me=Rs[Nn];const{name:Yo,namespaceURI:r1}=Me;if(Ke=Yo==="value"?Me.value:eNe(Me.value),_i=Rt(Yo),en.attrName=_i,en.attrValue=Ke,en.keepAttr=!0,en.forceKeepAttr=void 0,qt("uponSanitizeAttribute",se,en),Ke=en.attrValue,en.forceKeepAttr||(Js(Yo,se),!en.keepAttr))continue;if(!_e&&xo(/\/>/i,Ke)){Js(Yo,se);continue}Ie&&(Ke=Za(Ke,N," "),Ke=Za(Ke,z," "),Ke=Za(Ke,$," "));const ym=Rt(se.nodeName);if(VS(ym,_i,Ke)){if(is&&(_i==="id"||_i==="name")&&(Js(Yo,se),Ke=Zo+Ke),w&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!r1)switch(f.getAttributeType(ym,_i)){case"TrustedHTML":{Ke=w.createHTML(Ke);break}case"TrustedScriptURL":{Ke=w.createScriptURL(Ke);break}}try{r1?se.setAttributeNS(r1,Yo,Ke):se.setAttribute(Yo,Ke),oH(e.removed)}catch{}}}qt("afterSanitizeAttributes",se,null)},$S=function Te(se){let Me;const Ke=ht(se);for(qt("beforeSanitizeShadowDOM",se,null);Me=Ke.nextNode();)qt("uponSanitizeShadowNode",Me,null),!ph(Me)&&(Me.content instanceof r&&Te(Me.content),s1(Me));qt("afterSanitizeShadowDOM",se,null)};return e.sanitize=function(Te){let se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me,Ke,_i,Nn;if(ce=!Te,ce&&(Te="<!-->"),typeof Te!="string"&&!Nf(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw y1("dirty is not a string, aborting")}else throw y1("toString is not a function");if(!e.isSupported)return Te;if(M||Gr(se),e.removed=[],typeof Te=="string"&&(ie=!1),ie){if(Te.nodeName){const Yo=Rt(Te.nodeName);if(!ve[Yo]||jt[Yo])throw y1("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof a)Me=Kc("<!---->"),Ke=Me.ownerDocument.importNode(Te,!0),Ke.nodeType===1&&Ke.nodeName==="BODY"||Ke.nodeName==="HTML"?Me=Ke:Me.appendChild(Ke);else{if(!ke&&!Ie&&!F&&Te.indexOf("<")===-1)return w&&Xe?w.createHTML(Te):Te;if(Me=Kc(Te),!Me)return ke?null:Xe?y:""}Me&&pe&&Sr(Me.firstChild);const Rs=ht(ie?Te:Me);for(;_i=Rs.nextNode();)ph(_i)||(_i.content instanceof r&&$S(_i.content),s1(_i));if(ie)return Te;if(ke){if(et)for(Nn=S.call(Me.ownerDocument);Me.firstChild;)Nn.appendChild(Me.firstChild);else Nn=Me;return(Ne.shadowroot||Ne.shadowrootmode)&&(Nn=k.call(t,Nn,!0)),Nn}let en=F?Me.outerHTML:Me.innerHTML;return F&&ve["!doctype"]&&Me.ownerDocument&&Me.ownerDocument.doctype&&Me.ownerDocument.doctype.name&&xo(Kie,Me.ownerDocument.doctype.name)&&(en="<!DOCTYPE "+Me.ownerDocument.doctype.name+`>
`+en),Ie&&(en=Za(en,N," "),en=Za(en,z," "),en=Za(en,$," ")),w&&Xe?w.createHTML(en):en},e.setConfig=function(Te){Gr(Te),M=!0},e.clearConfig=function(){qi=null,M=!1},e.isValidAttribute=function(Te,se,Me){qi||Gr({});const Ke=Rt(Te),_i=Rt(se);return VS(Ke,_i,Me)},e.addHook=function(Te,se){typeof se=="function"&&(I[Te]=I[Te]||[],w1(I[Te],se))},e.removeHook=function(Te){if(I[Te])return oH(I[Te])},e.removeHooks=function(Te){I[Te]&&(I[Te]=[])},e.removeAllHooks=function(){I={}},e}var Hc=Zie();Hc.version;Hc.isSupported;const Yie=Hc.sanitize;Hc.setConfig;Hc.clearConfig;Hc.isValidAttribute;const Xie=Hc.addHook,Qie=Hc.removeHook;Hc.removeHooks;Hc.removeAllHooks;var bt;(function(n){n.inMemory="inmemory",n.vscode="vscode",n.internal="private",n.walkThrough="walkThrough",n.walkThroughSnippet="walkThroughSnippet",n.http="http",n.https="https",n.file="file",n.mailto="mailto",n.untitled="untitled",n.data="data",n.command="command",n.vscodeRemote="vscode-remote",n.vscodeRemoteResource="vscode-remote-resource",n.vscodeManagedRemoteResource="vscode-managed-remote-resource",n.vscodeUserData="vscode-userdata",n.vscodeCustomEditor="vscode-custom-editor",n.vscodeNotebookCell="vscode-notebook-cell",n.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",n.vscodeNotebookCellOutput="vscode-notebook-cell-output",n.vscodeInteractiveInput="vscode-interactive-input",n.vscodeSettings="vscode-settings",n.vscodeWorkspaceTrust="vscode-workspace-trust",n.vscodeTerminal="vscode-terminal",n.vscodeChatSesssion="vscode-chat-editor",n.webviewPanel="webview-panel",n.vscodeWebview="vscode-webview",n.extension="extension",n.vscodeFileResource="vscode-file",n.tmp="tmp",n.vsls="vsls",n.vscodeSourceControl="vscode-scm"})(bt||(bt={}));const fNe="tkn";class gNe{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${bt.vscodeRemoteResource}`}setPreferredWebSchema(e){this._preferredWebSchema=e}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Ft(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const s=this._ports[t],r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(o+=`&${fNe}=${encodeURIComponent(r)}`),ot.from({scheme:Hb?this._preferredWebSchema:bt.vscodeRemoteResource,authority:`${i}:${s}`,path:this._remoteResourcesPath,query:o})}}const Jie=new gNe;class fy{uriToBrowserUri(e){return e.scheme===bt.vscodeRemote?Jie.rewrite(e):e.scheme===bt.file&&(j0||lTe&&xa.origin===`${bt.vscodeFileResource}://${fy.FALLBACK_AUTHORITY}`)?e.with({scheme:bt.vscodeFileResource,authority:e.authority||fy.FALLBACK_AUTHORITY,query:null,fragment:null}):e}}fy.FALLBACK_AUTHORITY="vscode-app";const ene=new fy;var dH;(function(n){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);n.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(r){let o;typeof r=="string"?o=new URL(r).searchParams:r instanceof URL?o=r.searchParams:ot.isUri(r)&&(o=new URL(r.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}n.getHeadersFromQuery=i;function s(r,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";r instanceof URLSearchParams?r.set(t,l):r[t]=l}n.addSearchParam=s})(dH||(dH={}));const{registerWindow:XZe,getWindows:pNe,onDidCreateWindow:QZe}=function(){const n=[],e=new G;return{onDidCreateWindow:e.event,registerWindow(t){n.push(t);const i=new Ae;return i.add(ut(()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)})),e.fire({window:t,disposableStore:i}),i},getWindows(){return n}}}();function vo(n){for(;n.firstChild;)n.firstChild.remove()}function C8(n){var e;return(e=n==null?void 0:n.isConnected)!==null&&e!==void 0?e:!1}class mNe{constructor(e,t,i,s){this._node=e,this._type=t,this._handler=i,this._options=s||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function oe(n,e,t,i){return new mNe(n,e,t,i)}function tne(n){return function(e){return n(new ba(e))}}function _Ne(n){return function(e){return n(new ri(e))}}const pn=function(e,t,i,s){let r=i;return t==="click"||t==="mousedown"?r=tne(i):(t==="keydown"||t==="keypress"||t==="keyup")&&(r=_Ne(i)),oe(e,t,r,s)},bNe=function(e,t,i){const s=tne(t);return vNe(e,s,i)};function vNe(n,e,t){return oe(n,Qd&&y8.pointerEvents?Le.POINTER_DOWN:Le.MOUSE_DOWN,e,t)}let ine,$o;class MN{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ft(e)}}static sort(e,t){return t.priority-e.priority}}(function(){let n=[],e=null,t=!1,i=!1;const s=()=>{for(t=!1,e=n,n=[],i=!0;e.length>0;)e.sort(MN.sort),e.shift().execute();i=!1};$o=(r,o=0)=>{const a=new MN(r,o);return n.push(a),t||(t=!0,requestAnimationFrame(s)),a},ine=(r,o)=>{if(i){const a=new MN(r,o);return e.push(a),a}else return $o(r,o)}})();function ST(n){return n.ownerDocument.defaultView.getComputedStyle(n,null)}function xT(n){var e;const t=n.ownerDocument,i=(e=t.defaultView)===null||e===void 0?void 0:e.window;if(n!==t.body)return new yi(n.clientWidth,n.clientHeight);if(Qd&&(i!=null&&i.visualViewport))return new yi(i.visualViewport.width,i.visualViewport.height);if(i!=null&&i.innerWidth&&i.innerHeight)return new yi(i.innerWidth,i.innerHeight);if(t.body&&t.body.clientWidth&&t.body.clientHeight)return new yi(t.body.clientWidth,t.body.clientHeight);if(t.documentElement&&t.documentElement.clientWidth&&t.documentElement.clientHeight)return new yi(t.documentElement.clientWidth,t.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class Mi{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){const s=ST(e),r=s?s.getPropertyValue(t):"0";return Mi.convertToPixels(e,r)}static getBorderLeftWidth(e){return Mi.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return Mi.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return Mi.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return Mi.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return Mi.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return Mi.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return Mi.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return Mi.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return Mi.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return Mi.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return Mi.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return Mi.getDimension(e,"margin-bottom","marginBottom")}}class yi{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new yi(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof yi?e:new yi(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}}yi.None=new yi(0,0);function nne(n){let e=n.offsetParent,t=n.offsetTop,i=n.offsetLeft;for(;(n=n.parentNode)!==null&&n!==n.ownerDocument.body&&n!==n.ownerDocument.documentElement;){t-=n.scrollTop;const s=sne(n)?null:ST(n);s&&(i-=s.direction!=="rtl"?n.scrollLeft:-n.scrollLeft),n===e&&(i+=Mi.getBorderLeftWidth(n),t+=Mi.getBorderTopWidth(n),t+=n.offsetTop,i+=n.offsetLeft,e=n.offsetParent)}return{left:i,top:t}}function hs(n){var e,t,i,s;const r=n.getBoundingClientRect();return{left:r.left+((t=(e=n.ownerDocument.defaultView)===null||e===void 0?void 0:e.scrollX)!==null&&t!==void 0?t:0),top:r.top+((s=(i=n.ownerDocument.defaultView)===null||i===void 0?void 0:i.scrollY)!==null&&s!==void 0?s:0),width:r.width,height:r.height}}function wNe(n){let e=n,t=1;do{const i=ST(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function sr(n){const e=Mi.getMarginLeft(n)+Mi.getMarginRight(n);return n.offsetWidth+e}function FN(n){const e=Mi.getBorderLeftWidth(n)+Mi.getBorderRightWidth(n),t=Mi.getPaddingLeft(n)+Mi.getPaddingRight(n);return n.offsetWidth-e-t}function yNe(n){const e=Mi.getBorderTopWidth(n)+Mi.getBorderBottomWidth(n),t=Mi.getPaddingTop(n)+Mi.getPaddingBottom(n);return n.offsetHeight-e-t}function Dg(n){const e=Mi.getMarginTop(n)+Mi.getMarginBottom(n);return n.offsetHeight+e}function Qn(n,e){for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function CNe(n,e,t){for(;n&&n.nodeType===n.ELEMENT_NODE;){if(n.classList.contains(e))return n;if(t){if(typeof t=="string"){if(n.classList.contains(t))return null}else if(n===t)return null}n=n.parentNode}return null}function PN(n,e,t){return!!CNe(n,e,t)}function sne(n){return n&&!!n.host&&!!n.mode}function H3(n){return!!J_(n)}function J_(n){for(var e;n.parentNode;){if(n===((e=n.ownerDocument)===null||e===void 0?void 0:e.body))return null;n=n.parentNode}return sne(n)?n:null}function pl(){let n=SNe().activeElement;for(;n!=null&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function SNe(){var n;return(n=[document,...pNe().map(t=>t.document)].find(t=>t.hasFocus()))!==null&&n!==void 0?n:document}function Fa(n=document.getElementsByTagName("head")[0],e){const t=document.createElement("style");return t.type="text/css",t.media="screen",e==null||e(t),n.appendChild(t),t}let ON=null;function rne(){return ON||(ON=Fa()),ON}function xNe(n){var e,t;return!((e=n==null?void 0:n.sheet)===null||e===void 0)&&e.rules?n.sheet.rules:!((t=n==null?void 0:n.sheet)===null||t===void 0)&&t.cssRules?n.sheet.cssRules:[]}function U3(n,e,t=rne()){!t||!e||t.sheet.insertRule(n+"{"+e+"}",0)}function fH(n,e=rne()){if(!e)return;const t=xNe(e),i=[];for(let s=0;s<t.length;s++)t[s].selectorText.indexOf(n)!==-1&&i.push(s);for(let s=i.length-1;s>=0;s--)e.sheet.deleteRule(i[s])}function S8(n){return typeof HTMLElement=="object"?n instanceof HTMLElement:n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}const Le={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:zg?"webkitAnimationStart":"animationstart",ANIMATION_END:zg?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:zg?"webkitAnimationIteration":"animationiteration"};function kNe(n){const e=n;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const rt={stop:(n,e)=>(n.preventDefault(),e&&n.stopPropagation(),n)};function LNe(n){const e=[];for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)e[t]=n.scrollTop,n=n.parentNode;return e}function DNe(n,e){for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)n.scrollTop!==e[t]&&(n.scrollTop=e[t]),n=n.parentNode}class BL extends ae{static hasFocusWithin(e){if(S8(e)){const t=J_(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Qn(i,e)}else return Qn(window.document.activeElement,window.document)}constructor(e){super(),this._onDidFocus=this._register(new G),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new G),this.onDidBlur=this._onDidBlur.event;let t=BL.hasFocusWithin(e),i=!1;const s=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},r=()=>{t&&(i=!0,window.setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{BL.hasFocusWithin(e)!==t&&(t?r():s())},this._register(oe(e,Le.FOCUS,s,!0)),this._register(oe(e,Le.BLUR,r,!0)),e instanceof HTMLElement&&(this._register(oe(e,Le.FOCUS_IN,()=>this._refreshStateHandler())),this._register(oe(e,Le.FOCUS_OUT,()=>this._refreshStateHandler())))}}function ef(n){return new BL(n)}function Se(n,...e){if(n.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function one(n,e){return n.insertBefore(e,n.firstChild),e}function qs(n,...e){n.innerText="",Se(n,...e)}const ENe=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var gy;(function(n){n.HTML="http://www.w3.org/1999/xhtml",n.SVG="http://www.w3.org/2000/svg"})(gy||(gy={}));function ane(n,e,t,...i){const s=ENe.exec(e);if(!s)throw new Error("Bad use of emmet");const r=s[1]||"div";let o;return n!==gy.HTML?o=document.createElementNS(n,r):o=document.createElement(r),s[3]&&(o.id=s[3]),s[4]&&(o.className=s[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function Be(n,e,...t){return ane(gy.HTML,n,e,...t)}Be.SVG=function(n,e,...t){return ane(gy.SVG,n,e,...t)};function TNe(n,...e){n?Ug(...e):sd(...e)}function Ug(...n){for(const e of n)e.style.display="",e.removeAttribute("aria-hidden")}function sd(...n){for(const e of n)e.style.display="none",e.setAttribute("aria-hidden","true")}function gH(n){const e=window.devicePixelRatio*n;return Math.max(1,Math.floor(e))/window.devicePixelRatio}function lne(n){window.open(n,"_blank","noopener")}function ANe(n){const e=()=>{n(),t=$o(e)};let t=$o(e);return ut(()=>t.dispose())}Jie.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");function tf(n){return n?`url('${ene.uriToBrowserUri(n).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function pH(n){return`'${n.replace(/'/g,"%27")}'`}function jg(n,e){if(n!==void 0){const t=n.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=jg(i[1].trim(),e)),`var(${i[0]}, ${e})`}return n}return e}function INe(n,e=!1){const t=document.createElement("a");return Xie("afterSanitizeAttributes",i=>{for(const s of["href","src"])if(i.hasAttribute(s)){const r=i.getAttribute(s);if(s==="href"&&r.startsWith("#"))continue;if(t.href=r,!n.includes(t.protocol.replace(/:$/,""))){if(e&&s==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(s)}}}),ut(()=>{Qie("afterSanitizeAttributes")})}const NNe=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class rd extends G{constructor(){super(),this._subscriptions=new Ae,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(oe(window,"keydown",e=>{if(e.defaultPrevented)return;const t=new ri(e);if(!(t.keyCode===6&&e.repeat)){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(t.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}},!0)),this._subscriptions.add(oe(window,"keyup",e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))},!0)),this._subscriptions.add(oe(document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(oe(document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(oe(document.body,"mousemove",e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),this._subscriptions.add(oe(window,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return rd.instance||(rd.instance=new rd),rd.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class RNe extends ae{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this._register(oe(this.element,Le.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter(e)})),this._register(oe(this.element,Le.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)===null||i===void 0||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(oe(this.element,Le.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave(e))})),this._register(oe(this.element,Le.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd(e)})),this._register(oe(this.element,Le.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop(e)}))}}const MNe=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Bn(n,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const s=MNe.exec(n);if(!s||!s.groups)throw new Error("Bad use of h");const r=s.groups.tag||"div",o=document.createElement(r);s.groups.id&&(o.id=s.groups.id);const a=[];if(s.groups.class)for(const c of s.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(o.className=a.join(" "));const l={};if(s.groups.name&&(l[s.groups.name]=o),i)for(const c of i)c instanceof HTMLElement?o.appendChild(c):typeof c=="string"?o.append(c):"root"in c&&(Object.assign(l,c),o.appendChild(c.root));for(const[c,u]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,d]of Object.entries(u))o.style.setProperty(mH(h),typeof d=="number"?d+"px":""+d);else c==="tabIndex"?o.tabIndex=u:o.setAttribute(mH(c),u.toString());return l.root=o,l}function mH(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class kT{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this._description=e.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=Ve.and(i,this.precondition):i=this.precondition);const s={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};wr.registerKeybindingRule(s)}}pi.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),description:this._description})}_registerMenuItem(e){_a.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class x8 extends kT{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,s){return this._implementations.push({priority:e,name:t,implementation:i,when:s}),this._implementations.sort((r,o)=>o.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===i){this._implementations.splice(r,1);return}}}}runCommand(e,t){const i=e.get(lh),s=e.get(_t);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const r of this._implementations){if(r.when){const a=s.getContext(pl());if(!r.when.evaluate(a))continue}const o=r.implementation(e,t);if(o)return i.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof o=="boolean"?void 0:o}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class cne extends kT{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class Pa extends kT{static bindToContribution(e){return class extends Pa{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,s,r){const o=e(s);o&&this._callback(o,r)}}}static runEditorCommand(e,t,i,s){const r=e.get(ci),o=r.getFocusedCodeEditor()||r.getActiveCodeEditor();if(o)return o.invokeWithinContext(a=>{if(a.get(_t).contextMatchesRules(i??void 0))return s(a,o,t)})}runCommand(e,t){return Pa.runEditorCommand(e,t,this.precondition,(i,s,r)=>this.runEditorCommand(i,s,r))}}class wi extends Pa{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(s){return s.menuId||(s.menuId=B.EditorContext),s.title||(s.title=e.label),s.when=Ve.and(e.precondition,s.when),s}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(wi.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(ah).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class une extends wi{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,s)=>s[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const s of this._implementations){const r=s[1](e,t,i);if(r)return typeof r=="boolean"?void 0:r}}}class FNe extends Gb{run(e,...t){const i=e.get(ci),s=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(s)return s.invokeWithinContext(r=>{var o,a;const l=r.get(_t),c=r.get(lh);if(!l.contextMatchesRules((o=this.desc.precondition)!==null&&o!==void 0?o:void 0)){c.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,(a=this.desc.precondition)===null||a===void 0?void 0:a.serialize());return}return this.runEditorCommand(r,s,...t)})}}function Kb(n,e){pi.registerCommand(n,function(t,...i){const s=t.get(Wt),[r,o]=i;cr(ot.isUri(r)),cr(X.isIPosition(o));const a=t.get(Zs).getModel(r);if(a){const l=X.lift(o);return s.invokeFunction(e,a,l,...i.slice(2))}return t.get(Cf).createModelReference(r).then(l=>new Promise((c,u)=>{try{const h=s.invokeFunction(e,l.object.textEditorModel,X.lift(o),i.slice(2));c(h)}catch(h){u(h)}}).finally(()=>{l.dispose()}))})}function qe(n){return To.INSTANCE.registerEditorCommand(n),n}function dt(n){const e=new n;return To.INSTANCE.registerEditorAction(e),e}function hne(n){return To.INSTANCE.registerEditorAction(n),n}function PNe(n){To.INSTANCE.registerEditorAction(n)}function Va(n,e,t){To.INSTANCE.registerEditorContribution(n,e,t)}var Z0;(function(n){function e(o){return To.INSTANCE.getEditorCommand(o)}n.getEditorCommand=e;function t(){return To.INSTANCE.getEditorActions()}n.getEditorActions=t;function i(){return To.INSTANCE.getEditorContributions()}n.getEditorContributions=i;function s(o){return To.INSTANCE.getEditorContributions().filter(a=>o.indexOf(a.id)>=0)}n.getSomeEditorContributions=s;function r(){return To.INSTANCE.getDiffEditorContributions()}n.getDiffEditorContributions=r})(Z0||(Z0={}));const ONe={EditorCommonContributions:"editor.contributions"};class To{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}To.INSTANCE=new To;Un.add(ONe.EditorCommonContributions,To.INSTANCE);function fS(n){return n.register(),n}const dne=fS(new x8({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:B.MenubarEditMenu,group:"1_do",title:_({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:B.CommandPalette,group:"",title:_("undo","Undo"),order:1}]}));fS(new cne(dne,{id:"default:undo",precondition:void 0}));const fne=fS(new x8({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:B.MenubarEditMenu,group:"1_do",title:_({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:B.CommandPalette,group:"",title:_("redo","Redo"),order:1}]}));fS(new cne(fne,{id:"default:redo",precondition:void 0}));const BNe=fS(new x8({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:B.MenubarSelectionMenu,group:"1_basic",title:_({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:B.CommandPalette,group:"",title:_("selectAll","Select All"),order:1}]})),gne=Symbol("MicrotaskDelay");var Lo=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},nv=globalThis&&globalThis.__asyncValues||function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(c){r({value:c,done:a})},o)}};function j3(n){return!!n&&typeof n.then=="function"}function ch(n){const e=new Wa,t=n(e.token),i=new Promise((s,r)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),e.dispose(),r(new jb)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),s(a)},a=>{o.dispose(),e.dispose(),r(a)})});return new class{cancel(){e.cancel()}then(s,r){return i.then(s,r)}catch(s){return this.then(void 0,s)}finally(s){return i.finally(s)}}}function WNe(n,e,t){return new Promise((i,s)=>{const r=e.onCancellationRequested(()=>{r.dispose(),i(t)});n.then(i,s).finally(()=>r.dispose())})}class VNe{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(s=>{this.activePromise=null,t(s)},s=>{this.activePromise=null,i(s)})})}dispose(){this.isDisposed=!0}}const $Ne=(n,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},n);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},zNe=n=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,n())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class xf{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((s,r)=>{this.doResolve=s,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const s=this.task;return this.task=null,s()}}));const i=()=>{var s;this.deferred=null,(s=this.doResolve)===null||s===void 0||s.call(this,null)};return this.deferred=t===gne?zNe(i):$Ne(t,i),this.completionPromise}isTriggered(){var e;return!!(!((e=this.deferred)===null||e===void 0)&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)===null||e===void 0||e.call(this,new jb),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)===null||e===void 0||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class pne{constructor(e){this.delayer=new xf(e),this.throttler=new VNe}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function py(n,e){return e?new Promise((t,i)=>{const s=setTimeout(()=>{r.dispose(),t()},n),r=e.onCancellationRequested(()=>{clearTimeout(s),r.dispose(),i(new jb)})}):ch(t=>py(n,t))}function WL(n,e=0,t){const i=setTimeout(()=>{n(),t&&s.dispose()},e),s=ut(()=>{clearTimeout(i),t==null||t.deleteAndLeak(s)});return t==null||t.add(s),s}class uh{constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class gS{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval(()=>{e()},t)}}class Ui{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)===null||e===void 0||e.call(this)}}let od;(function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?od=n=>{uie(()=>{if(e)return;const t=Date.now()+15;n(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,t-Date.now())}}))});let e=!1;return{dispose(){e||(e=!0)}}}:od=(n,e)=>{const t=requestIdleCallback(n,typeof e=="number"?{timeout:e}:void 0);let i=!1;return{dispose(){i||(i=!0,cancelIdleCallback(t))}}}})();class HNe{constructor(e){this._didRun=!1,this._executor=()=>{try{this._value=e()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=od(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class mne{get isRejected(){var e;return((e=this.outcome)===null||e===void 0?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new jb)}}var q3;(function(n){function e(i){return Lo(this,void 0,void 0,function*(){let s;const r=yield Promise.all(i.map(o=>o.then(a=>a,a=>{s||(s=a)})));if(typeof s<"u")throw s;return r})}n.settled=e;function t(i){return new Promise((s,r)=>Lo(this,void 0,void 0,function*(){try{yield i(s,r)}catch(o){r(o)}}))}n.withAsyncBody=t})(q3||(q3={}));class Pn{static fromArray(e){return new Pn(t=>{t.emitMany(e)})}static fromPromise(e){return new Pn(t=>Lo(this,void 0,void 0,function*(){t.emitMany(yield e)}))}static fromPromises(e){return new Pn(t=>Lo(this,void 0,void 0,function*(){yield Promise.all(e.map(i=>Lo(this,void 0,void 0,function*(){return t.emitOne(yield i)})))}))}static merge(e){return new Pn(t=>Lo(this,void 0,void 0,function*(){yield Promise.all(e.map(i=>{var s,r,o;return Lo(this,void 0,void 0,function*(){var a,l,c,u;try{for(s=!0,r=nv(i);o=yield r.next(),a=o.done,!a;s=!0){u=o.value,s=!1;const h=u;t.emitOne(h)}}catch(h){l={error:h}}finally{try{!s&&!a&&(c=r.return)&&(yield c.call(r))}finally{if(l)throw l.error}}})}))}))}constructor(e){this._state=0,this._results=[],this._error=null,this._onStateChanged=new G,queueMicrotask(()=>Lo(this,void 0,void 0,function*(){const t={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{yield Promise.resolve(e(t)),this.resolve()}catch(i){this.reject(i)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}}))}[Symbol.asyncIterator](){let e=0;return{next:()=>Lo(this,void 0,void 0,function*(){do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};yield Ee.toPromise(this._onStateChanged.event)}while(!0)})}}static map(e,t){return new Pn(i=>Lo(this,void 0,void 0,function*(){var s,r,o,a;try{for(var l=!0,c=nv(e),u;u=yield c.next(),s=u.done,!s;l=!0){a=u.value,l=!1;const h=a;i.emitOne(t(h))}}catch(h){r={error:h}}finally{try{!l&&!s&&(o=c.return)&&(yield o.call(c))}finally{if(r)throw r.error}}}))}map(e){return Pn.map(this,e)}static filter(e,t){return new Pn(i=>Lo(this,void 0,void 0,function*(){var s,r,o,a;try{for(var l=!0,c=nv(e),u;u=yield c.next(),s=u.done,!s;l=!0){a=u.value,l=!1;const h=a;t(h)&&i.emitOne(h)}}catch(h){r={error:h}}finally{try{!l&&!s&&(o=c.return)&&(yield o.call(c))}finally{if(r)throw r.error}}}))}filter(e){return Pn.filter(this,e)}static coalesce(e){return Pn.filter(e,t=>!!t)}coalesce(){return Pn.coalesce(this)}static toPromise(e){var t,i,s,r,o,a,l;return Lo(this,void 0,void 0,function*(){const c=[];try{for(t=!0,i=nv(e);s=yield i.next(),r=s.done,!r;t=!0){l=s.value,t=!1;const u=l;c.push(u)}}catch(u){o={error:u}}finally{try{!t&&!r&&(a=i.return)&&(yield a.call(i))}finally{if(o)throw o.error}}return c})}toPromise(){return Pn.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}}Pn.EMPTY=Pn.fromArray([]);class UNe extends Pn{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function jNe(n){const e=new Wa,t=n(e.token);return new UNe(e,i=>Lo(this,void 0,void 0,function*(){var s,r,o,a;const l=e.token.onCancellationRequested(()=>{l.dispose(),e.dispose(),i.reject(new jb)});try{try{for(var c=!0,u=nv(t),h;h=yield u.next(),s=h.done,!s;c=!0){a=h.value,c=!1;const d=a;if(e.token.isCancellationRequested)return;i.emitOne(d)}}catch(d){r={error:d}}finally{try{!c&&!s&&(o=u.return)&&(yield o.call(u))}finally{if(r)throw r.error}}l.dispose(),e.dispose()}catch(d){l.dispose(),e.dispose(),i.reject(d)}}))}const qNe="$initialize";let _H=!1;function G3(n){Hb&&(_H||(_H=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(n.message))}class GNe{constructor(e,t,i,s){this.vsWorker=e,this.req=t,this.method=i,this.args=s,this.type=0}}class bH{constructor(e,t,i,s){this.vsWorker=e,this.seq=t,this.res=i,this.err=s,this.type=1}}class KNe{constructor(e,t,i,s){this.vsWorker=e,this.req=t,this.eventName=i,this.arg=s,this.type=2}}class ZNe{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class YNe{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class XNe{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const i=String(++this._lastSentReq);return new Promise((s,r)=>{this._pendingReplies[i]={resolve:s,reject:r},this._send(new GNe(this._workerId,i,e,t))})}listen(e,t){let i=null;const s=new G({onWillAddFirstListener:()=>{i=String(++this._lastSentReq),this._pendingEmitters.set(i,s),this._send(new KNe(this._workerId,i,e,t))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(i),this._send(new YNe(this._workerId,i)),i=null}});return s.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.method,e.args).then(s=>{this._send(new bH(this._workerId,t,s,void 0))},s=>{s.detail instanceof Error&&(s.detail=Vz(s.detail)),this._send(new bH(this._workerId,t,void 0,Vz(s)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.eventName,e.arg)(s=>{this._send(new ZNe(this._workerId,t,s))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class QNe extends ae{constructor(e,t,i){super();let s=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",u=>{this._protocol.handleMessage(u)},u=>{s==null||s(u)})),this._protocol=new XNe({sendMessage:(u,h)=>{this._worker.postMessage(u,h)},handleMessage:(u,h)=>{if(typeof i[u]!="function")return Promise.reject(new Error("Missing method "+u+" on main thread host."));try{return Promise.resolve(i[u].apply(i,h))}catch(d){return Promise.reject(d)}},handleEvent:(u,h)=>{if(bne(u)){const d=i[u].call(i,h);if(typeof d!="function")throw new Error(`Missing dynamic event ${u} on main thread host.`);return d}if(_ne(u)){const d=i[u];if(typeof d!="function")throw new Error(`Missing event ${u} on main thread host.`);return d}throw new Error(`Malformed event name ${u}`)}}),this._protocol.setWorkerId(this._worker.getId());let r=null;const o=globalThis.require;typeof o<"u"&&typeof o.getConfig=="function"?r=o.getConfig():typeof globalThis.requirejs<"u"&&(r=globalThis.requirejs.s.contexts._.config);const a=X6(i);this._onModuleLoaded=this._protocol.sendMessage(qNe,[this._worker.getId(),JSON.parse(JSON.stringify(r)),t,a]);const l=(u,h)=>this._request(u,h),c=(u,h)=>this._protocol.listen(u,h);this._lazyProxy=new Promise((u,h)=>{s=h,this._onModuleLoaded.then(d=>{u(JNe(d,l,c))},d=>{h(d),this._onError("Worker failed to load "+t,d)})})}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise((i,s)=>{this._onModuleLoaded.then(()=>{this._protocol.sendMessage(e,t).then(i,s)},s)})}_onError(e,t){console.error(e),console.info(t)}}function _ne(n){return n[0]==="o"&&n[1]==="n"&&Bh(n.charCodeAt(2))}function bne(n){return/^onDynamic/.test(n)&&Bh(n.charCodeAt(9))}function JNe(n,e,t){const i=o=>function(){const a=Array.prototype.slice.call(arguments,0);return e(o,a)},s=o=>function(a){return t(o,a)},r={};for(const o of n){if(bne(o)){r[o]=s(o);continue}if(_ne(o)){r[o]=t(o,void 0);continue}r[o]=i(o)}return r}function rm(n,e){var t;const i=globalThis.MonacoEnvironment;if(i!=null&&i.createTrustedTypesPolicy)try{return i.createTrustedTypesPolicy(n,e)}catch(s){Ft(s);return}try{return(t=window.trustedTypes)===null||t===void 0?void 0:t.createPolicy(n,e)}catch(s){Ft(s);return}}const vH=rm("defaultWorkerFactory",{createScriptURL:n=>n});function eRe(n){const e=globalThis.MonacoEnvironment;if(e){if(typeof e.getWorker=="function")return e.getWorker("workerMain.js",n);if(typeof e.getWorkerUrl=="function"){const t=e.getWorkerUrl("workerMain.js",n);return new Worker(vH?vH.createScriptURL(t):t,{name:n})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function tRe(n){return typeof n.then=="function"}class iRe{constructor(e,t,i,s,r){this.id=t,this.label=i;const o=eRe(i);tRe(o)?this.worker=o:this.worker=Promise.resolve(o),this.postMessage(e,[]),this.worker.then(a=>{a.onmessage=function(l){s(l.data)},a.onmessageerror=r,typeof a.addEventListener=="function"&&a.addEventListener("error",r)})}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)===null||i===void 0||i.then(s=>{try{s.postMessage(e,t)}catch(r){Ft(r),Ft(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:r}))}})}dispose(){var e;(e=this.worker)===null||e===void 0||e.then(t=>t.terminate()),this.worker=null}}class LT{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){const s=++LT.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new iRe(e,s,this._label||"anonymous"+s,t,r=>{G3(r),this._webWorkerFailedBeforeError=r,i(r)})}}LT.LAST_WORKER_ID=0;var Ws;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(Ws||(Ws={}));class BN{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),s=e.getStandardTokenType(i);return this.isOK(s)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const s=String.fromCharCode(i);if(!this.open.includes(s)&&!this.close.includes(s))return s}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class nRe{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)C1(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),C1(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),C1(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),C1(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&C1(this.autoClosingPairsCloseSingleChar,t.close,t)}}function C1(n,e,t){n.has(e)?n.get(e).push(t):n.set(e,[t])}function DT(n,e){const t=n.getCount(),i=n.findTokenIndexAtOffset(e),s=n.getLanguageId(i);let r=i;for(;r+1<t&&n.getLanguageId(r+1)===s;)r++;let o=i;for(;o>0&&n.getLanguageId(o-1)===s;)o--;return new sRe(n,s,o,r+1,n.getStartOffset(o),n.getEndOffset(r))}class sRe{constructor(e,t,i,s,r,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=s,this.firstCharOffset=r,this._lastCharOffset=o}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function Ul(n){return(n&3)!==0}class eb{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new BN(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new BN({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new BN({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:eb.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:eb.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}eb.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;eb.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;const wH=typeof Buffer<"u";let WN;class k8{static wrap(e){return wH&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new k8(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return wH?this.buffer.toString():(WN||(WN=new TextDecoder),WN.decode(this.buffer))}}function rRe(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0}function oRe(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255}function tl(n,e){return n[e]*Math.pow(2,24)+n[e+1]*Math.pow(2,16)+n[e+2]*Math.pow(2,8)+n[e+3]}function il(n,e,t){n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e}function yH(n,e){return n[e]}function CH(n,e,t){n[t]=e}let VN;function vne(){return VN||(VN=new TextDecoder("UTF-16LE")),VN}let $N;function aRe(){return $N||($N=new TextDecoder("UTF-16BE")),$N}let zN;function wne(){return zN||(zN=hTe()?vne():aRe()),zN}function lRe(n,e,t){const i=new Uint16Array(n.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?cRe(n,e,t):vne().decode(i)}function cRe(n,e,t){const i=[];let s=0;for(let r=0;r<t;r++){const o=rRe(n,e);e+=2,i[s++]=String.fromCharCode(o)}return i.join("")}class ET{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return wne().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||Dn(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class VL{constructor(e,t,i,s,r,o){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=s,this.forwardRegex=r,this.reversedRegex=o,this._openSet=VL._toSet(this.open),this._closeSet=VL._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function uRe(n){const e=n.length;n=n.map(o=>[o[0].toLowerCase(),o[1].toLowerCase()]);const t=[];for(let o=0;o<e;o++)t[o]=o;const i=(o,a)=>{const[l,c]=o,[u,h]=a;return l===u||l===h||c===u||c===h},s=(o,a)=>{const l=Math.min(o,a),c=Math.max(o,a);for(let u=0;u<e;u++)t[u]===c&&(t[u]=l)};for(let o=0;o<e;o++){const a=n[o];for(let l=o+1;l<e;l++){const c=n[l];i(a,c)&&s(t[o],t[l])}}const r=[];for(let o=0;o<e;o++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===o){const[u,h]=n[c];a.push(u),l.push(h)}a.length>0&&r.push({open:a,close:l})}return r}class hRe{constructor(e,t){this._richEditBracketsBrand=void 0;const i=uRe(t);this.brackets=i.map((s,r)=>new VL(e,r,s.open,s.close,dRe(s.open,s.close,i,r),fRe(s.open,s.close,i,r))),this.forwardRegex=gRe(this.brackets),this.reversedRegex=pRe(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const s of this.brackets){for(const r of s.open)this.textIsBracket[r]=s,this.textIsOpenBracket[r]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,r.length);for(const r of s.close)this.textIsBracket[r]=s,this.textIsOpenBracket[r]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,r.length)}}}function yne(n,e,t,i){for(let s=0,r=e.length;s<r;s++){if(s===t)continue;const o=e[s];for(const a of o.open)a.indexOf(n)>=0&&i.push(a);for(const a of o.close)a.indexOf(n)>=0&&i.push(a)}}function Cne(n,e){return n.length-e.length}function TT(n){if(n.length<=1)return n;const e=[],t=new Set;for(const i of n)t.has(i)||(e.push(i),t.add(i));return e}function dRe(n,e,t,i){let s=[];s=s.concat(n),s=s.concat(e);for(let r=0,o=s.length;r<o;r++)yne(s[r],t,i,s);return s=TT(s),s.sort(Cne),s.reverse(),AT(s)}function fRe(n,e,t,i){let s=[];s=s.concat(n),s=s.concat(e);for(let r=0,o=s.length;r<o;r++)yne(s[r],t,i,s);return s=TT(s),s.sort(Cne),s.reverse(),AT(s.map(L8))}function gRe(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=TT(e),AT(e)}function pRe(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=TT(e),AT(e.map(L8))}function mRe(n){const e=/^[\w ]+$/.test(n);return n=Na(n),e?`\\b${n}\\b`:n}function AT(n){const e=`(${n.map(mRe).join(")|(")})`;return Nie(e,!0)}const L8=function(){function n(i){const s=new Uint16Array(i.length);let r=0;for(let o=i.length-1;o>=0;o--)s[r++]=i.charCodeAt(o);return wne().decode(s)}let e=null,t=null;return function(s){return e!==s&&(e=s,t=n(e)),t}}();class ia{static _findPrevBracketInText(e,t,i,s){const r=i.match(e);if(!r)return null;const o=i.length-(r.index||0),a=r[0].length,l=s+o;return new H(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,s,r){const a=L8(i).substring(i.length-r,i.length-s);return this._findPrevBracketInText(e,t,a,s)}static findNextBracketInText(e,t,i,s){const r=i.match(e);if(!r)return null;const o=r.index||0,a=r[0].length;if(a===0)return null;const l=s+o;return new H(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,s,r){const o=i.substring(s,r);return this.findNextBracketInText(e,t,o,s)}}class _Re{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const s=i.charAt(i.length-1);e.push(s)}return Cp(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const s=t.findTokenIndexAtOffset(i-1);if(Ul(t.getStandardTokenType(s)))return null;const r=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,i-1)+e,a=ia.findPrevBracketInRange(r,1,o,0,o.length);if(!a)return null;const l=o.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const u=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(u)?{matchOpenBracket:l}:null}}function Sx(n){return n.global&&(n.lastIndex=0),!0}class bRe{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&Sx(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&Sx(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&Sx(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&Sx(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class d0{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=d0._createOpenBracketRegExp(t[0]),s=d0._createCloseBracketRegExp(t[1]);i&&s&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:s})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,s){if(e>=3)for(let r=0,o=this._regExpRules.length;r<o;r++){const a=this._regExpRules[r];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:s},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&s.length>0)for(let r=0,o=this._brackets.length;r<o;r++){const a=this._brackets[r];if(a.openRegExp.test(i)&&a.closeRegExp.test(s))return{indentAction:Ws.IndentOutdent}}if(e>=2&&i.length>0){for(let r=0,o=this._brackets.length;r<o;r++)if(this._brackets[r].openRegExp.test(i))return{indentAction:Ws.Indent}}return null}static _createOpenBracketRegExp(e){let t=Na(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",d0._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Na(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,d0._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Ft(t),null}}}const xi=kt("configurationService");function K3(n,e){const t=Object.create(null);for(const i in n)Sne(t,i,n[i],e);return t}function Sne(n,e,t,i){const s=e.split("."),r=s.pop();let o=n;for(let a=0;a<s.length;a++){const l=s[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":break;default:i(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[r]=t}catch{i(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}function vRe(n,e){const t=e.split(".");xne(n,t)}function xne(n,e){const t=e.shift();if(e.length===0){delete n[t];return}if(Object.keys(n).indexOf(t)!==-1){const i=n[t];typeof i=="object"&&!Array.isArray(i)&&(xne(i,e),Object.keys(i).length===0&&delete n[t])}}function SH(n,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const s=e.split("."),r=i(n,s);return typeof r>"u"?t:r}function wRe(n){return n.replace(/[\[\]]/g,"")}const Ji=kt("languageService");class Ql{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const kne=[];function At(n,e,t){e instanceof Ql||(e=new Ql(e,[],!!t)),kne.push([n,e])}function xH(){return kne}const Au=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),IT={JSONContribution:"base.contributions.json"};function yRe(n){return n.length>0&&n.charAt(n.length-1)==="#"?n.substring(0,n.length-1):n}class CRe{constructor(){this._onDidChangeSchema=new G,this.schemasById={}}registerSchema(e,t){this.schemasById[yRe(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const SRe=new CRe;Un.add(IT.JSONContribution,SRe);const om={Configuration:"base.contributions.configuration"},S1="vscode://schemas/settings/resourceLanguage",kH=Un.as(IT.JSONContribution);class xRe{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new G,this._onDidUpdateConfiguration=new G,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:_("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},kH.registerSchema(S1,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),kH.registerSchema(S1,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){var i;const s=[];for(const{overrides:r,source:o}of e)for(const a in r)if(t.add(a),nf.test(a)){const l=this.configurationDefaultsOverrides.get(a),c=(i=l==null?void 0:l.valuesSources)!==null&&i!==void 0?i:new Map;if(o)for(const f of Object.keys(r[a]))c.set(f,o);const u=Object.assign(Object.assign({},(l==null?void 0:l.value)||{}),r[a]);this.configurationDefaultsOverrides.set(a,{source:o,value:u,valuesSources:c});const h=wRe(a),d={type:"object",default:u,description:_("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",h),$ref:S1,defaultDefaultValue:u,source:_r(o)?void 0:o,defaultValueSource:o};s.push(...$L(a)),this.configurationProperties[a]=d,this.defaultLanguageConfigurationOverridesNode.properties[a]=d}else{this.configurationDefaultsOverrides.set(a,{value:r[a],source:o});const l=this.configurationProperties[a];l&&(this.updatePropertyDefaultValue(a,l),this.updateSchema(a,l))}this.doRegisterOverrideIdentifiers(s)}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(s=>{this.validateAndRegisterProperties(s,t,s.extensionInfo,s.restrictedProperties,void 0,i),this.configurationContributors.push(s),this.registerJSONConfiguration(s)})}validateAndRegisterProperties(e,t=!0,i,s,r=3,o){var a;r=to(e.scope)?r:e.scope;const l=e.properties;if(l)for(const u in l){const h=l[u];if(t&&DRe(u,h)){delete l[u];continue}if(h.source=i,h.defaultDefaultValue=l[u].default,this.updatePropertyDefaultValue(u,h),nf.test(u)?h.scope=void 0:(h.scope=to(h.scope)?r:h.scope,h.restricted=to(h.restricted)?!!(s!=null&&s.includes(u)):h.restricted),l[u].hasOwnProperty("included")&&!l[u].included){this.excludedConfigurationProperties[u]=l[u],delete l[u];continue}else this.configurationProperties[u]=l[u],!((a=l[u].policy)===null||a===void 0)&&a.name&&this.policyConfigurations.set(l[u].policy.name,u);!l[u].deprecationMessage&&l[u].markdownDeprecationMessage&&(l[u].deprecationMessage=l[u].markdownDeprecationMessage),o.add(u)}const c=e.allOf;if(c)for(const u of c)this.validateAndRegisterProperties(u,t,i,s,r,o)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(e){const t=i=>{const s=i.properties;if(s)for(const o in s)this.updateSchema(o,s[o]);const r=i.allOf;r==null||r.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:_("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:_("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:S1};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){_("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),_("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let s=i==null?void 0:i.value,r=i==null?void 0:i.source;Mr(s)&&(s=t.defaultDefaultValue,r=void 0),Mr(s)&&(s=LRe(t.type)),t.default=s,t.defaultValueSource=r}}const Lne="\\[([^\\]]+)\\]",LH=new RegExp(Lne,"g"),kRe=`^(${Lne})+$`,nf=new RegExp(kRe);function $L(n){const e=[];if(nf.test(n)){let t=LH.exec(n);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=LH.exec(n)}}return Cp(e)}function LRe(n){switch(Array.isArray(n)?n[0]:n){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const X2=new xRe;Un.add(om.Configuration,X2);function DRe(n,e){var t,i,s,r;return n.trim()?nf.test(n)?_("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",n):X2.getConfigurationProperties()[n]!==void 0?_("config.property.duplicate","Cannot register '{0}'. This property is already registered.",n):!((t=e.policy)===null||t===void 0)&&t.name&&X2.getPolicyConfigurations().get((i=e.policy)===null||i===void 0?void 0:i.name)!==void 0?_("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",n,(s=e.policy)===null||s===void 0?void 0:s.name,X2.getPolicyConfigurations().get((r=e.policy)===null||r===void 0?void 0:r.name)):null:_("config.property.empty","Cannot register an empty property")}const ERe={ModesRegistry:"editor.modesRegistry"};class TRe{constructor(){this._onDidChangeLanguages=new G,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const tb=new TRe;Un.add(ERe.ModesRegistry,tb);const Bo="plaintext",ARe=".txt";tb.registerLanguage({id:Bo,extensions:[ARe],aliases:[_("plainText.alias","Plain Text"),"text"],mimetypes:[Au.text]});Un.as(om.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class IRe{constructor(e,t){this.languageId=e;const i=t.brackets?DH(t.brackets):[],s=new Zz(a=>{const l=new Set;return{info:new NRe(this,a,l),closing:l}}),r=new Zz(a=>{const l=new Set,c=new Set;return{info:new RRe(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=s.get(a),u=r.get(l);c.closing.add(u.info),u.opening.add(c.info)}const o=t.colorizedBracketPairs?DH(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of o){const c=s.get(a),u=r.get(l);c.closing.add(u.info),u.openingColorized.add(c.info),u.opening.add(c.info)}this._openingBrackets=new Map([...s.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...r.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}}function DH(n){return n.filter(([e,t])=>e!==""&&t!=="")}class Dne{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class NRe extends Dne{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class RRe extends Dne{constructor(e,t,i,s){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=s,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var MRe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},EH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class HN{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const Ur=kt("languageConfigurationService");let Z3=class extends ae{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new BRe),this.onDidChangeEmitter=this._register(new G),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(Y3));this._register(this.configurationService.onDidChangeConfiguration(s=>{const r=s.change.keys.some(a=>i.has(a)),o=s.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(r)this.configurations.clear(),this.onDidChangeEmitter.fire(new HN(void 0));else for(const a of o)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new HN(a)))})),this._register(this._registry.onDidChange(s=>{this.configurations.delete(s.languageId),this.onDidChangeEmitter.fire(new HN(s.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=FRe(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};Z3=MRe([EH(0,xi),EH(1,Ji)],Z3);function FRe(n,e,t,i){let s=e.getLanguageConfiguration(n);if(!s){if(!i.isRegisteredLanguageId(n))return new X0(n,{});s=new X0(n,{})}const r=PRe(s.languageId,t),o=Tne([s.underlyingConfig,r]);return new X0(s.languageId,o)}const Y3={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function PRe(n,e){const t=e.getValue(Y3.brackets,{overrideIdentifier:n}),i=e.getValue(Y3.colorizedBracketPairs,{overrideIdentifier:n});return{brackets:TH(t),colorizedBracketPairs:TH(i)}}function TH(n){if(Array.isArray(n))return n.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Ene(n,e,t){const i=n.getLineContent(e);let s=Lr(i);return s.length>t-1&&(s=s.substring(0,t-1)),s}function Y0(n,e,t){n.tokenization.forceTokenization(e);const i=n.tokenization.getLineTokens(e),s=typeof t>"u"?n.getLineMaxColumn(e)-1:t-1;return DT(i,s)}class ORe{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new AH(e,t,++this._order);return this._entries.push(i),this._resolved=null,ut(()=>{for(let s=0;s<this._entries.length;s++)if(this._entries[s]===i){this._entries.splice(s,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new X0(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(AH.cmp),Tne(this._entries.map(e=>e.configuration)))}}function Tne(n){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of n)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class AH{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class IH{constructor(e){this.languageId=e}}class BRe extends ae{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._register(this.register(Bo,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let s=this._entries.get(e);s||(s=new ORe(e),this._entries.set(e,s));const r=s.register(t,i);return this._onDidChange.fire(new IH(e)),ut(()=>{r.dispose(),this._onDidChange.fire(new IH(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class X0{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new d0(this.underlyingConfig):null,this.comments=X0._handleComments(this.underlyingConfig),this.characterPair=new eb(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||e8,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new bRe(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new IRe(e,this.underlyingConfig)}getWordDefinition(){return fie(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new hRe(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new _Re(this.brackets)),this._electricCharacter}onEnter(e,t,i,s){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,s):null}getAutoClosingPairs(){return new nRe(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[s,r]=t.blockComment;i.blockCommentStartToken=s,i.blockCommentEndToken=r}return i}}At(Ur,Z3,1);class Nh{constructor(e,t,i,s){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=s}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}function WRe(n){return NT(n,0)}function NT(n,e){switch(typeof n){case"object":return n===null?Bu(349,e):Array.isArray(n)?$Re(n,e):zRe(n,e);case"string":return D8(n,e);case"boolean":return VRe(n,e);case"number":return Bu(n,e);case"undefined":return Bu(937,e);default:return Bu(617,e)}}function Bu(n,e){return(e<<5)-e+n|0}function VRe(n,e){return Bu(n?433:863,e)}function D8(n,e){e=Bu(149417,e);for(let t=0,i=n.length;t<i;t++)e=Bu(n.charCodeAt(t),e);return e}function $Re(n,e){return e=Bu(104579,e),n.reduce((t,i)=>NT(i,t),e)}function zRe(n,e){return e=Bu(181387,e),Object.keys(n).sort().reduce((t,i)=>(t=D8(i,t),NT(n[i],t)),e)}function UN(n,e,t=32){const i=t-e,s=~((1<<i)-1);return(n<<e|(s&n)>>>i)>>>0}function NH(n,e=0,t=n.byteLength,i=0){for(let s=0;s<t;s++)n[e+s]=i}function HRe(n,e,t="0"){for(;n.length<e;)n=t+n;return n}function x1(n,e=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join(""):HRe((n>>>0).toString(16),e/4)}class RT{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let s=this._buffLen,r=this._leftoverHighSurrogate,o,a;for(r!==0?(o=r,a=-1,r=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(Dn(o))if(a+1<t){const c=e.charCodeAt(a+1);Y_(c)?(a++,l=u8(o,c)):l=65533}else{r=o;break}else Y_(o)&&(l=65533);if(s=this._push(i,s,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=s,this._leftoverHighSurrogate=r}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64+0],e[1]=e[64+1],e[2]=e[64+2]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),x1(this._h0)+x1(this._h1)+x1(this._h2)+x1(this._h3)+x1(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,NH(this._buff,this._buffLen),this._buffLen>56&&(this._step(),NH(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=RT._bigBlock32,t=this._buffDV;for(let h=0;h<64;h+=4)e.setUint32(h,t.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)e.setUint32(h,UN(e.getUint32(h-12,!1)^e.getUint32(h-32,!1)^e.getUint32(h-56,!1)^e.getUint32(h-64,!1),1),!1);let i=this._h0,s=this._h1,r=this._h2,o=this._h3,a=this._h4,l,c,u;for(let h=0;h<80;h++)h<20?(l=s&r|~s&o,c=1518500249):h<40?(l=s^r^o,c=1859775393):h<60?(l=s&r|s&o|r&o,c=2400959708):(l=s^r^o,c=3395469782),u=UN(i,5)+l+a+c+e.getUint32(h*4,!1)&4294967295,a=o,o=r,r=UN(s,30),s=i,i=u;this._h0=this._h0+i&4294967295,this._h1=this._h1+s&4294967295,this._h2=this._h2+r&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}}RT._bigBlock32=new DataView(new ArrayBuffer(320));class RH{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,s=e.length;i<s;i++)t[i]=e.charCodeAt(i);return t}}function URe(n,e,t){return new Iu(new RH(n),new RH(e)).ComputeDiff(t).changes}class Fm{static Assert(e,t){if(!e)throw new Error(t)}}class Pm{static Copy(e,t,i,s,r){for(let o=0;o<r;o++)i[s+o]=e[t+o]}static Copy2(e,t,i,s,r){for(let o=0;o<r;o++)i[s+o]=e[t+o]}}class MH{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Nh(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class Iu{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[s,r,o]=Iu._getElements(e),[a,l,c]=Iu._getElements(t);this._hasStrings=o&&c,this._originalStringElements=s,this._originalElementsOrHash=r,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(Iu._isStringArray(t)){const i=new Int32Array(t.length);for(let s=0,r=t.length;s<r;s++)i[s]=D8(t[s],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=Iu._getStrictElement(this._originalSequence,e),s=Iu._getStrictElement(this._modifiedSequence,t);return i===s}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,s,r){const o=[!1];let a=this.ComputeDiffRecursive(e,t,i,s,o);return r&&(a=this.PrettifyChanges(a)),{quitEarly:o[0],changes:a}}ComputeDiffRecursive(e,t,i,s,r){for(r[0]=!1;e<=t&&i<=s&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&s>=i&&this.ElementsAreEqual(t,s);)t--,s--;if(e>t||i>s){let h;return i<=s?(Fm.Assert(e===t+1,"originalStart should only be one more than originalEnd"),h=[new Nh(e,0,i,s-i+1)]):e<=t?(Fm.Assert(i===s+1,"modifiedStart should only be one more than modifiedEnd"),h=[new Nh(e,t-e+1,i,0)]):(Fm.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Fm.Assert(i===s+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,s,o,a,r),c=o[0],u=a[0];if(l!==null)return l;if(!r[0]){const h=this.ComputeDiffRecursive(e,c,i,u,r);let d=[];return r[0]?d=[new Nh(c+1,t-(c+1)+1,u+1,s-(u+1)+1)]:d=this.ComputeDiffRecursive(c+1,t,u+1,s,r),this.ConcatenateChanges(h,d)}return[new Nh(e,t-e+1,i,s-i+1)]}WALKTRACE(e,t,i,s,r,o,a,l,c,u,h,d,f,g,p,m,b,v){let w=null,y=null,x=new MH,D=t,S=i,T=f[0]-m[0]-s,k=-1073741824,I=this.m_forwardHistory.length-1;do{const N=T+e;N===D||N<S&&c[N-1]<c[N+1]?(h=c[N+1],g=h-T-s,h<k&&x.MarkNextChange(),k=h,x.AddModifiedElement(h+1,g),T=N+1-e):(h=c[N-1]+1,g=h-T-s,h<k&&x.MarkNextChange(),k=h-1,x.AddOriginalElement(h,g+1),T=N-1-e),I>=0&&(c=this.m_forwardHistory[I],e=c[0],D=1,S=c.length-1)}while(--I>=-1);if(w=x.getReverseChanges(),v[0]){let N=f[0]+1,z=m[0]+1;if(w!==null&&w.length>0){const $=w[w.length-1];N=Math.max(N,$.getOriginalEnd()),z=Math.max(z,$.getModifiedEnd())}y=[new Nh(N,d-N+1,z,p-z+1)]}else{x=new MH,D=o,S=a,T=f[0]-m[0]-l,k=1073741824,I=b?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const N=T+r;N===D||N<S&&u[N-1]>=u[N+1]?(h=u[N+1]-1,g=h-T-l,h>k&&x.MarkNextChange(),k=h+1,x.AddOriginalElement(h+1,g+1),T=N+1-r):(h=u[N-1],g=h-T-l,h>k&&x.MarkNextChange(),k=h,x.AddModifiedElement(h+1,g+1),T=N-1-r),I>=0&&(u=this.m_reverseHistory[I],r=u[0],D=1,S=u.length-1)}while(--I>=-1);y=x.getChanges()}return this.ConcatenateChanges(w,y)}ComputeRecursionPoint(e,t,i,s,r,o,a){let l=0,c=0,u=0,h=0,d=0,f=0;e--,i--,r[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const g=t-e+(s-i),p=g+1,m=new Int32Array(p),b=new Int32Array(p),v=s-i,w=t-e,y=e-i,x=t-s,S=(w-v)%2===0;m[v]=e,b[w]=t,a[0]=!1;for(let T=1;T<=g/2+1;T++){let k=0,I=0;u=this.ClipDiagonalBound(v-T,T,v,p),h=this.ClipDiagonalBound(v+T,T,v,p);for(let z=u;z<=h;z+=2){z===u||z<h&&m[z-1]<m[z+1]?l=m[z+1]:l=m[z-1]+1,c=l-(z-v)-y;const $=l;for(;l<t&&c<s&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(m[z]=l,l+c>k+I&&(k=l,I=c),!S&&Math.abs(z-w)<=T-1&&l>=b[z])return r[0]=l,o[0]=c,$<=b[z]&&1447>0&&T<=1447+1?this.WALKTRACE(v,u,h,y,w,d,f,x,m,b,l,t,r,c,s,o,S,a):null}const N=(k-e+(I-i)-T)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(k,N))return a[0]=!0,r[0]=k,o[0]=I,N>0&&1447>0&&T<=1447+1?this.WALKTRACE(v,u,h,y,w,d,f,x,m,b,l,t,r,c,s,o,S,a):(e++,i++,[new Nh(e,t-e+1,i,s-i+1)]);d=this.ClipDiagonalBound(w-T,T,w,p),f=this.ClipDiagonalBound(w+T,T,w,p);for(let z=d;z<=f;z+=2){z===d||z<f&&b[z-1]>=b[z+1]?l=b[z+1]-1:l=b[z-1],c=l-(z-w)-x;const $=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(b[z]=l,S&&Math.abs(z-v)<=T&&l<=m[z])return r[0]=l,o[0]=c,$>=m[z]&&1447>0&&T<=1447+1?this.WALKTRACE(v,u,h,y,w,d,f,x,m,b,l,t,r,c,s,o,S,a):null}if(T<=1447){let z=new Int32Array(h-u+2);z[0]=v-u+1,Pm.Copy2(m,u,z,1,h-u+1),this.m_forwardHistory.push(z),z=new Int32Array(f-d+2),z[0]=w-d+1,Pm.Copy2(b,d,z,1,f-d+1),this.m_reverseHistory.push(z)}}return this.WALKTRACE(v,u,h,y,w,d,f,x,m,b,l,t,r,c,s,o,S,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],s=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<s&&i.modifiedStart+i.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let s=0,r=0;if(t>0){const h=e[t-1];s=h.originalStart+h.originalLength,r=h.modifiedStart+h.modifiedLength}const o=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let h=1;;h++){const d=i.originalStart-h,f=i.modifiedStart-h;if(d<s||f<r||o&&!this.OriginalElementsAreEqual(d,d+i.originalLength)||a&&!this.ModifiedElementsAreEqual(f,f+i.modifiedLength))break;const p=(d===s&&f===r?5:0)+this._boundaryScore(d,i.originalLength,f,i.modifiedLength);p>c&&(c=p,l=h)}i.originalStart-=l,i.modifiedStart-=l;const u=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],u)){e[t-1]=u[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const s=e[t-1],r=e[t],o=r.originalStart-s.originalStart-s.originalLength,a=s.originalStart,l=r.originalStart+r.originalLength,c=l-a,u=s.modifiedStart,h=r.modifiedStart+r.modifiedLength,d=h-u;if(o<5&&c<20&&d<20){const f=this._findBetterContiguousSequence(a,c,u,d,o);if(f){const[g,p]=f;(g!==s.originalStart+s.originalLength||p!==s.modifiedStart+s.modifiedLength)&&(s.originalLength=g-s.originalStart,s.modifiedLength=p-s.modifiedStart,r.originalStart=g+o,r.modifiedStart=p+o,r.originalLength=l-r.originalStart,r.modifiedLength=h-r.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,s,r){if(t<r||s<r)return null;const o=e+t-r+1,a=i+s-r+1;let l=0,c=0,u=0;for(let h=e;h<o;h++)for(let d=i;d<a;d++){const f=this._contiguousSequenceScore(h,d,r);f>0&&f>l&&(l=f,c=h,u=d)}return l>0?[c,u]:null}_contiguousSequenceScore(e,t,i){let s=0;for(let r=0;r<i;r++){if(!this.ElementsAreEqual(e+r,t+r))return 0;s+=this._originalStringElements[e+r].length}return s}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,s){const r=this._OriginalRegionIsBoundary(e,t)?1:0,o=this._ModifiedRegionIsBoundary(i,s)?1:0;return r+o}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const s=new Array(e.length+t.length-1);return Pm.Copy(e,0,s,0,e.length-1),s[e.length-1]=i[0],Pm.Copy(t,1,s,e.length,t.length-1),s}else{const s=new Array(e.length+t.length);return Pm.Copy(e,0,s,0,e.length),Pm.Copy(t,0,s,e.length,t.length),s}}ChangesOverlap(e,t,i){if(Fm.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Fm.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const s=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(r=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new Nh(s,r,o,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,s){if(e>=0&&e<s)return e;const r=i,o=s-i-1,a=t%2===0;if(e<0){const l=r%2===0;return a===l?0:1}else{const l=o%2===0;return a===l?s-1:s-2}}}function zL(n){return n<0?0:n>255?255:n|0}function Om(n){return n<0?0:n>4294967295?4294967295:n|0}class jRe{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=Om(e);const i=this.values,s=this.prefixSum,r=t.length;return r===0?!1:(this.values=new Uint32Array(i.length+r),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+r),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Om(e),t=Om(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Om(e),t=Om(t);const i=this.values,s=this.prefixSum;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Om(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,s=0,r=0,o=0;for(;t<=i;)if(s=t+(i-t)/2|0,r=this.prefixSum[s],o=r-this.values[s],e<o)i=s-1;else if(e>=r)t=s+1;else break;return new Ane(s,e-o)}}class qRe{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new Ane(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=lT(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],s=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=s+i;for(let r=0;r<i;r++)this._indexBySum[s+r]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class Ane{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class GRe{constructor(e,t,i,s){this._uri=e,this._lines=t,this._eol=i,this._versionId=s,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new X(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let s=0;s<t;s++)i[s]=this._lines[s].length+e;this._lineStarts=new jRe(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=em(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const s=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this._lines.splice(e.lineNumber+r-1,0,i[r]),s[r-1]=i[r].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,s)}}class pS{constructor(e){const t=zL(e);this._defaultValue=t,this._asciiMap=pS._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=zL(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class KRe{constructor(e,t,i){const s=new Uint8Array(e*t);for(let r=0,o=e*t;r<o;r++)s[r]=i;this._data=s,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class ZRe{constructor(e){let t=0,i=0;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const s=new KRe(i,t,0);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];s.set(a,l,c)}this._states=s,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let jN=null;function YRe(){return jN===null&&(jN=new ZRe([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),jN}let k1=null;function XRe(){if(k1===null){k1=new pS(0);const n=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<n.length;t++)k1.set(n.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)k1.set(e.charCodeAt(t),2)}return k1}class HL{static _createLink(e,t,i,s,r){let o=r-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>s);if(s>0){const a=t.charCodeAt(s-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:s+1,endLineNumber:i,endColumn:o+2},url:t.substring(s,o+1)}}static computeLinks(e,t=YRe()){const i=XRe(),s=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r),l=a.length;let c=0,u=0,h=0,d=1,f=!1,g=!1,p=!1,m=!1;for(;c<l;){let b=!1;const v=a.charCodeAt(c);if(d===13){let w;switch(v){case 40:f=!0,w=0;break;case 41:w=f?0:1;break;case 91:p=!0,g=!0,w=0;break;case 93:p=!1,w=g?0:1;break;case 123:m=!0,w=0;break;case 125:w=m?0:1;break;case 39:case 34:case 96:h===v?w=1:h===39||h===34||h===96?w=0:w=1;break;case 42:w=h===42?1:0;break;case 124:w=h===124?1:0;break;case 32:w=p?0:1;break;default:w=i.get(v)}w===1&&(s.push(HL._createLink(i,a,r,u,c)),b=!0)}else if(d===12){let w;v===91?(g=!0,w=0):w=i.get(v),w===1?b=!0:d=13}else d=t.nextState(d,v),d===0&&(b=!0);b&&(d=1,f=!1,g=!1,m=!1,u=c+1,h=v),c++}d===13&&s.push(HL._createLink(i,a,r,u,l))}return s}}function QRe(n){return!n||typeof n.getLineCount!="function"||typeof n.getLineContent!="function"?[]:HL.computeLinks(n)}class X3{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,s,r){if(e&&t){const o=this.doNavigateValueSet(t,r);if(o)return{range:e,value:o}}if(i&&s){const o=this.doNavigateValueSet(s,r);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let s=Number(e);const r=parseFloat(e);return!isNaN(s)&&!isNaN(r)&&s===r?s===0&&!t?null:(s=Math.floor(s*i),s+=t?i:-i,String(s/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let s=null;for(let r=0,o=e.length;s===null&&r<o;r++)s=this.valueSetReplace(e[r],t,i);return s}valueSetReplace(e,t,i){let s=e.indexOf(t);return s>=0?(s+=i?1:-1,s<0?s=e.length-1:s%=e.length,e[s]):null}}X3.INSTANCE=new X3;class JRe extends pS{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function eMe(n){const e={};return t=>(e.hasOwnProperty(t)||(e[t]=n(t)),e[t])}const ib=eMe(n=>new JRe(n));var zo;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(zo||(zo={}));var Q0;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(Q0||(Q0={}));var Or;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(Or||(Or={}));var nb;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(nb||(nb={}));class Q2{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&mo(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class my{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function tMe(n){return n&&typeof n.read=="function"}class qN{constructor(e,t,i,s,r,o){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=s,this.isAutoWhitespaceEdit=r,this._isTracked=o}}class iMe{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class nMe{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function sMe(n){return!n.isTooLargeForSyncing()&&!n.isForSimpleWidget}const rMe=999;class Yf{constructor(e,t,i,s){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=s}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=oMe(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Nie(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,globalThis:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new iMe(t,this.wordSeparators?ib(this.wordSeparators):null,i?this.searchString:null)}}function oMe(n){if(!n||n.length===0)return!1;for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const s=n.charCodeAt(e);if(s===110||s===114||s===87)return!0}}return!1}function eg(n,e,t){if(!t)return new my(n,null);const i=[];for(let s=0,r=e.length;s<r;s++)i[s]=e[s];return new my(n,i)}class FH{constructor(e){const t=[];let i=0;for(let s=0,r=e.length;s<r;s++)e.charCodeAt(s)===10&&(t[i++]=s);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,s=t.length-1;if(s===-1||e<=t[0])return 0;for(;i<s;){const r=i+((s-i)/2>>0);t[r]>=e?s=r-1:t[r+1]>=e?(i=r,s=r):i=r+1}return i+1}}class xx{static findMatches(e,t,i,s,r){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,i,new f0(o.wordSeparators,o.regex),s,r):this._doFindMatchesLineByLine(e,i,o,s,r):[]}static _getMultilineMatchRange(e,t,i,s,r,o){let a,l=0;s?(l=s.findLineFeedCountBeforeOffset(r),a=t+r+l):a=t+r;let c;if(s){const f=s.findLineFeedCountBeforeOffset(r+o.length)-l;c=a+o.length+f}else c=a+o.length;const u=e.getPositionAt(a),h=e.getPositionAt(c);return new H(u.lineNumber,u.column,h.lineNumber,h.column)}static _doFindMatchesMultiline(e,t,i,s,r){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new FH(a):null,c=[];let u=0,h;for(i.reset(0);h=i.next(a);)if(c[u++]=eg(this._getMultilineMatchRange(e,o,a,l,h.index,h[0]),h,s),u>=r)return c;return c}static _doFindMatchesLineByLine(e,t,i,s,r){const o=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,o,s,r),o}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,o,s,r);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<r;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,o,s,r);if(a<r){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,o,s,r)}return o}static _findMatchesInLine(e,t,i,s,r,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const d=e.simpleSearch,f=d.length,g=t.length;let p=-f;for(;(p=t.indexOf(d,p+f))!==-1;)if((!c||E8(c,t,g,p,f))&&(o[r++]=new my(new H(i,p+1+s,i,p+1+f+s),null),r>=l))return r;return r}const u=new f0(e.wordSeparators,e.regex);let h;u.reset(0);do if(h=u.next(t),h&&(o[r++]=eg(new H(i,h.index+1+s,i,h.index+1+h[0].length+s),h,a),r>=l))return r;while(h);return r}static findNextMatch(e,t,i,s){const r=t.parseSearchRequest();if(!r)return null;const o=new f0(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindNextMatchMultiline(e,i,o,s):this._doFindNextMatchLineByLine(e,i,o,s)}static _doFindNextMatchMultiline(e,t,i,s){const r=new X(t.lineNumber,1),o=e.getOffsetAt(r),a=e.getLineCount(),l=e.getValueInRange(new H(r.lineNumber,r.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new FH(l):null;i.reset(t.column-1);const u=i.next(l);return u?eg(this._getMultilineMatchRange(e,o,l,c,u.index,u[0]),u,s):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new X(1,1),i,s):null}static _doFindNextMatchLineByLine(e,t,i,s){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o),l=this._findFirstMatchInLine(i,a,o,t.column,s);if(l)return l;for(let c=1;c<=r;c++){const u=(o+c-1)%r,h=e.getLineContent(u+1),d=this._findFirstMatchInLine(i,h,u+1,1,s);if(d)return d}return null}static _findFirstMatchInLine(e,t,i,s,r){e.reset(s-1);const o=e.next(t);return o?eg(new H(i,o.index+1,i,o.index+1+o[0].length),o,r):null}static findPreviousMatch(e,t,i,s){const r=t.parseSearchRequest();if(!r)return null;const o=new f0(r.wordSeparators,r.regex);return r.regex.multiline?this._doFindPreviousMatchMultiline(e,i,o,s):this._doFindPreviousMatchLineByLine(e,i,o,s)}static _doFindPreviousMatchMultiline(e,t,i,s){const r=this._doFindMatchesMultiline(e,new H(1,1,t.lineNumber,t.column),i,s,10*rMe);if(r.length>0)return r[r.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new X(o,e.getLineMaxColumn(o)),i,s):null}static _doFindPreviousMatchLineByLine(e,t,i,s){const r=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,o,s);if(l)return l;for(let c=1;c<=r;c++){const u=(r+o-c-1)%r,h=e.getLineContent(u+1),d=this._findLastMatchInLine(i,h,u+1,s);if(d)return d}return null}static _findLastMatchInLine(e,t,i,s){let r=null,o;for(e.reset(0);o=e.next(t);)r=eg(new H(i,o.index+1,i,o.index+1+o[0].length),o,s);return r}}function aMe(n,e,t,i,s){if(i===0)return!0;const r=e.charCodeAt(i-1);if(n.get(r)!==0||r===13||r===10)return!0;if(s>0){const o=e.charCodeAt(i);if(n.get(o)!==0)return!0}return!1}function lMe(n,e,t,i,s){if(i+s===t)return!0;const r=e.charCodeAt(i+s);if(n.get(r)!==0||r===13||r===10)return!0;if(s>0){const o=e.charCodeAt(i+s-1);if(n.get(o)!==0)return!0}return!1}function E8(n,e,t,i,s){return aMe(n,e,t,i,s)&&lMe(n,e,t,i,s)}class f0{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const s=i.index,r=i[0].length;if(s===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){ML(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=s,this._prevMatchLength=r,!this._wordSeparators||E8(this._wordSeparators,e,t,s,r))return i}while(i);return null}}class cMe{static computeUnicodeHighlights(e,t,i){const s=i?i.startLineNumber:1,r=i?i.endLineNumber:e.getLineCount(),o=new PH(t),a=o.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${uMe(Array.from(a))}`,"g");const c=new f0(null,l),u=[];let h=!1,d,f=0,g=0,p=0;e:for(let m=s,b=r;m<=b;m++){const v=e.getLineContent(m),w=v.length;c.reset(0);do if(d=c.next(v),d){let y=d.index,x=d.index+d[0].length;if(y>0){const k=v.charCodeAt(y-1);Dn(k)&&y--}if(x+1<w){const k=v.charCodeAt(x-1);Dn(k)&&x++}const D=v.substring(y,x);let S=ry(y+1,e8,v,0);S&&S.endColumn<=y+1&&(S=null);const T=o.shouldHighlightNonBasicASCII(D,S?S.word:null);if(T!==0){T===3?f++:T===2?g++:T===1?p++:v8();const k=1e3;if(u.length>=k){h=!0;break e}u.push(new H(m,y+1,m,x+1))}}while(d)}return{ranges:u,hasMore:h,ambiguousCharacterCount:f,invisibleCharacterCount:g,nonBasicAsciiCharacterCount:p}}static computeUnicodeHighlightReason(e,t){const i=new PH(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const r=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(r),a=Sp.getLocales().filter(l=>!Sp.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(r));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function uMe(n,e){return`[${Na(n.map(i=>String.fromCodePoint(i)).join(""))}]`}class PH{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=Sp.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of Ed.codePoints)OH(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let s=!1,r=!1;if(t)for(const o of t){const a=o.codePointAt(0),l=f8(o);s=s||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!Ed.isInvisibleCharacter(a)&&(r=!0)}return!s&&r?0:this.options.invisibleCharacters&&!OH(e)&&Ed.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function OH(n){return n===" "||n===`
`||n==="	"}class J2{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class Ine{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class ct{static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let s=i;for(;s<t.length&&t[s].start<=e.endExclusive;)s++;if(i===s)t.splice(i,0,e);else{const r=Math.min(e.start,t[i].start),o=Math.max(e.endExclusive,t[s-1].endExclusive);t.splice(i,s-i,new ct(r,o))}}static tryCreate(e,t){if(!(e>t))return new ct(e,t)}static ofLength(e){return new ct(0,e)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new mn(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new ct(this.start+e,this.endExclusive+e)}deltaStart(e){return new ct(this.start+e,this.endExclusive)}deltaEnd(e){return new ct(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new ct(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new ct(t,i)}slice(e){return e.slice(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new mn(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new mn(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}}class T8{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const s=Math.min(e.start,this._sortedRanges[t].start),r=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new ct(s,r))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new T8;for(const i of this._sortedRanges){const s=i.intersect(e);s&&t.addRange(s)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function Q3(n,e,t){const i=hMe(n,e);if(i!==-1)return n[i]}function hMe(n,e,t=n.length-1){for(let i=t;i>=0;i--){const s=n[i];if(e(s))return i}return-1}function _y(n,e){const t=by(n,e);return t===-1?void 0:n[t]}function by(n,e,t=0,i=n.length){let s=t,r=i;for(;s<r;){const o=Math.floor((s+r)/2);e(n[o])?s=o+1:r=o}return s-1}function dMe(n,e){const t=vy(n,e);return t===n.length?void 0:n[t]}function vy(n,e,t=0,i=n.length){let s=t,r=i;for(;s<r;){const o=Math.floor((s+r)/2);e(n[o])?r=o:s=o+1}return s}class mS{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(mS.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=by(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}}mS.assertInvariants=!1;function fMe(n,e){if(n.length===0)return;let t=n[0];for(let i=1;i<n.length;i++){const s=n[i];e(s,t)>0&&(t=s)}return t}function gMe(n,e){if(n.length===0)return;let t=n[0];for(let i=1;i<n.length;i++){const s=n[i];e(s,t)>=0&&(t=s)}return t}function pMe(n,e){return fMe(n,(t,i)=>-e(t,i))}function mMe(n,e){if(n.length===0)return-1;let t=0;for(let i=1;i<n.length;i++){const s=n[i];e(s,n[t])>0&&(t=i)}return t}let gt=class Rh{static fromRange(e){return new Rh(e.startLineNumber,e.endLineNumber)}static joinMany(e){if(e.length===0)return[];let t=new oc(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new oc(e[i].slice()));return t.ranges}static ofLength(e,t){return new Rh(e,e+t)}static deserialize(e){return new Rh(e[0],e[1])}constructor(e,t){if(e>t)throw new mn(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new Rh(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new Rh(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new Rh(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new Rh(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new H(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new H(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new ct(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class oc{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=vy(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),i=by(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const s=this._normalizedRanges[t];this._normalizedRanges[t]=s.join(e)}else{const s=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,s)}}contains(e){const t=_y(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,s=0,r=null;for(;i<this._normalizedRanges.length||s<e._normalizedRanges.length;){let o=null;if(i<this._normalizedRanges.length&&s<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[s];a.startLineNumber<l.startLineNumber?(o=a,i++):(o=l,s++)}else i<this._normalizedRanges.length?(o=this._normalizedRanges[i],i++):(o=e._normalizedRanges[s],s++);r===null?r=o:r.endLineNumberExclusive>=o.startLineNumber?r=new gt(r.startLineNumber,Math.max(r.endLineNumberExclusive,o.endLineNumberExclusive)):(t.push(r),r=o)}return r!==null&&t.push(r),new oc(t)}subtractFrom(e){const t=vy(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),i=by(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new oc([e]);const s=[];let r=e.startLineNumber;for(let o=t;o<i;o++){const a=this._normalizedRanges[o];a.startLineNumber>r&&s.push(new gt(r,a.startLineNumber)),r=a.endLineNumberExclusive}return r<e.endLineNumberExclusive&&s.push(new gt(r,e.endLineNumberExclusive)),new oc(s)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,s=0;for(;i<this._normalizedRanges.length&&s<e._normalizedRanges.length;){const r=this._normalizedRanges[i],o=e._normalizedRanges[s],a=r.intersect(o);a&&!a.isEmpty&&t.push(a),r.endLineNumberExclusive<o.endLineNumberExclusive?i++:s++}return new oc(t)}getWithDelta(e){return new oc(this._normalizedRanges.map(t=>t.delta(e)))}}class Ic{static inverse(e,t,i){const s=[];let r=1,o=1;for(const l of e){const c=new Ho(new gt(r,l.original.startLineNumber),new gt(o,l.modified.startLineNumber),void 0);c.modified.isEmpty||s.push(c),r=l.original.endLineNumberExclusive,o=l.modified.endLineNumberExclusive}const a=new Ho(new gt(r,t+1),new gt(o,i+1),void 0);return a.modified.isEmpty||s.push(a),s}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Ic(this.modified,this.original)}join(e){return new Ic(this.original.join(e.original),this.modified.join(e.modified))}}class Ho extends Ic{constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new Ho(this.modified,this.original,(e=this.innerChanges)===null||e===void 0?void 0:e.map(t=>t.flip()))}}class sf{constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new sf(this.modifiedRange,this.originalRange)}}const _Me=3;class bMe{computeDiff(e,t,i){var s;const o=new yMe(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),a=[];let l=null;for(const c of o.changes){let u;c.originalEndLineNumber===0?u=new gt(c.originalStartLineNumber+1,c.originalStartLineNumber+1):u=new gt(c.originalStartLineNumber,c.originalEndLineNumber+1);let h;c.modifiedEndLineNumber===0?h=new gt(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):h=new gt(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let d=new Ho(u,h,(s=c.charChanges)===null||s===void 0?void 0:s.map(f=>new sf(new H(f.originalStartLineNumber,f.originalStartColumn,f.originalEndLineNumber,f.originalEndColumn),new H(f.modifiedStartLineNumber,f.modifiedStartColumn,f.modifiedEndLineNumber,f.modifiedEndColumn))));l&&(l.modified.endLineNumberExclusive===d.modified.startLineNumber||l.original.endLineNumberExclusive===d.original.startLineNumber)&&(d=new Ho(l.original.join(d.original),l.modified.join(d.modified),l.innerChanges&&d.innerChanges?l.innerChanges.concat(d.innerChanges):void 0),a.pop()),a.push(d),l=d}return dy(()=>Hie(a,(c,u)=>u.original.startLineNumber-c.original.endLineNumberExclusive===u.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<u.original.startLineNumber&&c.modified.endLineNumberExclusive<u.modified.startLineNumber)),new J2(a,[],o.quitEarly)}}function Nne(n,e,t,i){return new Iu(n,e,t).ComputeDiff(i)}let BH=class{constructor(e){const t=[],i=[];for(let s=0,r=e.length;s<r;s++)t[s]=J3(e[s],1),i[s]=eF(e[s],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const s=[],r=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],u=e?this._startColumns[l]:1,h=e?this._endColumns[l]:c.length+1;for(let d=u;d<h;d++)s[a]=c.charCodeAt(d-1),r[a]=l+1,o[a]=d,a++;!e&&l<i&&(s[a]=10,r[a]=l+1,o[a]=c.length+1,a++)}return new vMe(s,r,o)}};class vMe{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class J0{constructor(e,t,i,s,r,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=s,this.modifiedStartLineNumber=r,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const s=t.getStartLineNumber(e.originalStart),r=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),u=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),h=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new J0(s,r,o,a,l,c,u,h)}}function wMe(n){if(n.length<=1)return n;const e=[n[0]];let t=e[0];for(let i=1,s=n.length;i<s;i++){const r=n[i],o=r.originalStart-(t.originalStart+t.originalLength),a=r.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<_Me?(t.originalLength=r.originalStart+r.originalLength-t.originalStart,t.modifiedLength=r.modifiedStart+r.modifiedLength-t.modifiedStart):(e.push(r),t=r)}return e}class jv{constructor(e,t,i,s,r){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=s,this.charChanges=r}static createFromDiffResult(e,t,i,s,r,o,a){let l,c,u,h,d;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(u=s.getStartLineNumber(t.modifiedStart)-1,h=0):(u=s.getStartLineNumber(t.modifiedStart),h=s.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&r()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=s.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(f.getElements().length>0&&g.getElements().length>0){let p=Nne(f,g,r,!0).changes;a&&(p=wMe(p)),d=[];for(let m=0,b=p.length;m<b;m++)d.push(J0.createFromDiffChange(p[m],f,g))}}return new jv(l,c,u,h,d)}}class yMe{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new BH(e),this.modified=new BH(t),this.continueLineDiff=WH(i.maxComputationTime),this.continueCharDiff=WH(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=Nne(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(jv.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const s=[];let r=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,u=c?c.originalStart:this.originalLines.length,h=c?c.modifiedStart:this.modifiedLines.length;for(;r<u&&o<h;){const d=this.originalLines[r],f=this.modifiedLines[o];if(d!==f){{let g=J3(d,1),p=J3(f,1);for(;g>1&&p>1;){const m=d.charCodeAt(g-2),b=f.charCodeAt(p-2);if(m!==b)break;g--,p--}(g>1||p>1)&&this._pushTrimWhitespaceCharChange(s,r+1,1,g,o+1,1,p)}{let g=eF(d,1),p=eF(f,1);const m=d.length+1,b=f.length+1;for(;g<m&&p<b;){const v=d.charCodeAt(g-1),w=d.charCodeAt(p-1);if(v!==w)break;g++,p++}(g<m||p<b)&&this._pushTrimWhitespaceCharChange(s,r+1,g,m,o+1,p,b)}}r++,o++}c&&(s.push(jv.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),r+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:s}}_pushTrimWhitespaceCharChange(e,t,i,s,r,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,s,r,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new J0(t,i,t,s,r,o,r,a)]),e.push(new jv(t,t,r,r,l))}_mergeTrimWhitespaceCharChange(e,t,i,s,r,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===r?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new J0(t,i,t,s,r,o,r,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===r?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=r,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new J0(t,i,t,s,r,o,r,a)),!0):!1}}function J3(n,e){const t=Pr(n);return t===-1?e:t+1}function eF(n,e){const t=tm(n);return t===-1?e:t+2}function WH(n){if(n===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<n}class qu{static trivial(e,t){return new qu([new Wn(ct.ofLength(e.length),ct.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new qu([new Wn(ct.ofLength(e.length),ct.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class Wn{static invert(e,t){const i=[];return eie(e,(s,r)=>{i.push(Wn.fromOffsetPairs(s?s.getEndExclusives():gc.zero,r?r.getStarts():new gc(t,(s?s.seq2Range.endExclusive-s.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new Wn(new ct(e.offset1,t.offset1),new ct(e.offset2,t.offset2))}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new Wn(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new Wn(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new Wn(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new Wn(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new Wn(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new Wn(t,i)}getStarts(){return new gc(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new gc(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}class gc{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}}gc.zero=new gc(0,0);gc.max=new gc(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);class wy{isValid(){return!0}}wy.instance=new wy;class CMe{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new mn("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class GN{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function tF(n){return n===32||n===9}class sb{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let s=0;for(let r=e.startLineNumber-1;r<e.endLineNumberExclusive-1;r++){const o=t[r];for(let l=0;l<o.length;l++){s++;const c=o[l],u=sb.getKey(c);this.histogram[u]=(this.histogram[u]||0)+1}s++;const a=sb.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=s}computeSimilarity(e){var t,i;let s=0;const r=Math.max(this.histogram.length,e.histogram.length);for(let o=0;o<r;o++)s+=Math.abs(((t=this.histogram[o])!==null&&t!==void 0?t:0)-((i=e.histogram[o])!==null&&i!==void 0?i:0));return 1-s/(this.totalCount+e.totalCount)}}sb.chrKeys=new Map;class SMe{compute(e,t,i=wy.instance,s){if(e.length===0||t.length===0)return qu.trivial(e,t);const r=new GN(e.length,t.length),o=new GN(e.length,t.length),a=new GN(e.length,t.length);for(let g=0;g<e.length;g++)for(let p=0;p<t.length;p++){if(!i.isValid())return qu.trivialTimedOut(e,t);const m=g===0?0:r.get(g-1,p),b=p===0?0:r.get(g,p-1);let v;e.getElement(g)===t.getElement(p)?(g===0||p===0?v=0:v=r.get(g-1,p-1),g>0&&p>0&&o.get(g-1,p-1)===3&&(v+=a.get(g-1,p-1)),v+=s?s(g,p):1):v=-1;const w=Math.max(m,b,v);if(w===v){const y=g>0&&p>0?a.get(g-1,p-1):0;a.set(g,p,y+1),o.set(g,p,3)}else w===m?(a.set(g,p,0),o.set(g,p,1)):w===b&&(a.set(g,p,0),o.set(g,p,2));r.set(g,p,w)}const l=[];let c=e.length,u=t.length;function h(g,p){(g+1!==c||p+1!==u)&&l.push(new Wn(new ct(g+1,c),new ct(p+1,u))),c=g,u=p}let d=e.length-1,f=t.length-1;for(;d>=0&&f>=0;)o.get(d,f)===3?(h(d,f),d--,f--):o.get(d,f)===1?d--:f--;return h(-1,-1),l.reverse(),new qu(l,!1)}}class Rne{compute(e,t,i=wy.instance){if(e.length===0||t.length===0)return qu.trivial(e,t);const s=e,r=t;function o(p,m){for(;p<s.length&&m<r.length&&s.getElement(p)===r.getElement(m);)p++,m++;return p}let a=0;const l=new xMe;l.set(0,o(0,0));const c=new kMe;c.set(0,l.get(0)===0?null:new VH(null,0,0,l.get(0)));let u=0;e:for(;;){if(a++,!i.isValid())return qu.trivialTimedOut(s,r);const p=-Math.min(a,r.length+a%2),m=Math.min(a,s.length+a%2);for(u=p;u<=m;u+=2){const b=u===m?-1:l.get(u+1),v=u===p?-1:l.get(u-1)+1,w=Math.min(Math.max(b,v),s.length),y=w-u;if(w>s.length||y>r.length)continue;const x=o(w,y);l.set(u,x);const D=w===b?c.get(u+1):c.get(u-1);if(c.set(u,x!==w?new VH(D,w,y,x-w):D),l.get(u)===s.length&&l.get(u)-u===r.length)break e}}let h=c.get(u);const d=[];let f=s.length,g=r.length;for(;;){const p=h?h.x+h.length:0,m=h?h.y+h.length:0;if((p!==f||m!==g)&&d.push(new Wn(new ct(p,f),new ct(m,g))),!h)break;f=h.x,g=h.y,h=h.prev}return d.reverse(),new qu(d,!1)}}class VH{constructor(e,t,i,s){this.prev=e,this.x=t,this.y=i,this.length=s}}class xMe{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class kMe{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}var $H,zH;class LMe{constructor(e,t){this.uri=e,this.value=t}}function DMe(n){return Array.isArray(n)}class us{constructor(e,t){if(this[$H]="ResourceMap",e instanceof us)this.map=new Map(e.map),this.toKey=t??us.defaultToKey;else if(DMe(e)){this.map=new Map,this.toKey=t??us.defaultToKey;for(const[i,s]of e)this.set(i,s)}else this.map=new Map,this.toKey=e??us.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new LMe(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))===null||t===void 0?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,s]of this.map)e(s.value,s.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[($H=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}}us.defaultToKey=n=>n.toString();class EMe{constructor(){this[zH]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)===null||e===void 0?void 0:e.value}get last(){var e;return(e=this._tail)===null||e===void 0?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let s=this._map.get(e);if(s)s.value=t,i!==0&&this.touch(s,i);else{switch(s={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(s);break;case 1:this.addItemFirst(s);break;case 2:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let s=this._head;for(;s;){if(t?e.bind(t)(s.value,s.key,this):e(s.value,s.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}values(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}entries(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}[(zH=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,s=e.previous;e===this._tail?(s.next=void 0,this._tail=s):(i.previous=s,s.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,s=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=s,s.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class A8 extends EMe{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}class TMe{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Mne{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}class UL{constructor(e,t,i){this.lines=e,this.considerWhitespaceChanges=i,this.elements=[],this.firstCharOffsetByLine=[],this.additionalOffsetByLine=[];let s=!1;t.start>0&&t.endExclusive>=e.length&&(t=new ct(t.start-1,t.endExclusive),s=!0),this.lineRange=t,this.firstCharOffsetByLine[0]=0;for(let r=this.lineRange.start;r<this.lineRange.endExclusive;r++){let o=e[r],a=0;if(s)a=o.length,o="",s=!1;else if(!i){const l=o.trimStart();a=o.length-l.length,o=l.trimEnd()}this.additionalOffsetByLine.push(a);for(let l=0;l<o.length;l++)this.elements.push(o.charCodeAt(l));r<e.length-1&&(this.elements.push(`
`.charCodeAt(0)),this.firstCharOffsetByLine[r-this.lineRange.start+1]=this.elements.length)}this.additionalOffsetByLine.push(0)}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new ct(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=UH(e>0?this.elements[e-1]:-1),i=UH(e<this.elements.length?this.elements[e]:-1);if(t===6&&i===7)return 0;let s=0;return t!==i&&(s+=10,t===0&&i===1&&(s+=1)),s+=HH(t),s+=HH(i),s}translateOffset(e){if(this.lineRange.isEmpty)return new X(this.lineRange.start+1,1);const t=by(this.firstCharOffsetByLine,i=>i<=e);return new X(this.lineRange.start+t+1,e-this.firstCharOffsetByLine[t]+this.additionalOffsetByLine[t]+1)}translateRange(e){return H.fromPositions(this.translateOffset(e.start),this.translateOffset(e.endExclusive))}findWordContaining(e){if(e<0||e>=this.elements.length||!KN(this.elements[e]))return;let t=e;for(;t>0&&KN(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&KN(this.elements[i]);)i++;return new ct(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){var t,i;const s=(t=_y(this.firstCharOffsetByLine,o=>o<=e.start))!==null&&t!==void 0?t:0,r=(i=dMe(this.firstCharOffsetByLine,o=>e.endExclusive<=o))!==null&&i!==void 0?i:this.elements.length;return new ct(s,r)}}function KN(n){return n>=97&&n<=122||n>=65&&n<=90||n>=48&&n<=57}const AMe={0:0,1:0,2:0,3:10,4:2,5:3,6:10,7:10};function HH(n){return AMe[n]}function UH(n){return n===10?7:n===13?6:tF(n)?5:n>=97&&n<=122?0:n>=65&&n<=90?1:n>=48&&n<=57?2:n===-1?3:4}function IMe(n,e,t,i,s,r){let{moves:o,excludedChanges:a}=NMe(n,e,t,r);if(!r.isValid())return[];const l=n.filter(u=>!a.has(u)),c=RMe(l,i,s,e,t,r);return O4(o,c),o=MMe(o),o=o.filter(u=>u.original.toOffsetRange().slice(e).map(d=>d.trim()).join(`
`).length>=10),o=FMe(n,o),o}function NMe(n,e,t,i){const s=[],r=n.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new sb(l.original,e,l)),o=new Set(n.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new sb(l.modified,t,l))),a=new Set;for(const l of r){let c=-1,u;for(const h of o){const d=l.computeSimilarity(h);d>c&&(c=d,u=h)}if(c>.9&&u&&(o.delete(u),s.push(new Ic(l.range,u.range)),a.add(l.source),a.add(u.source)),!i.isValid())return{moves:s,excludedChanges:a}}return{moves:s,excludedChanges:a}}function RMe(n,e,t,i,s,r){const o=[],a=new Mne;for(const d of n)for(let f=d.original.startLineNumber;f<d.original.endLineNumberExclusive-2;f++){const g=`${e[f-1]}:${e[f+1-1]}:${e[f+2-1]}`;a.add(g,{range:new gt(f,f+3)})}const l=[];n.sort(Sa(d=>d.modified.startLineNumber,kd));for(const d of n){let f=[];for(let g=d.modified.startLineNumber;g<d.modified.endLineNumberExclusive-2;g++){const p=`${t[g-1]}:${t[g+1-1]}:${t[g+2-1]}`,m=new gt(g,g+3),b=[];a.forEach(p,({range:v})=>{for(const y of f)if(y.originalLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive&&y.modifiedLineRange.endLineNumberExclusive+1===m.endLineNumberExclusive){y.originalLineRange=new gt(y.originalLineRange.startLineNumber,v.endLineNumberExclusive),y.modifiedLineRange=new gt(y.modifiedLineRange.startLineNumber,m.endLineNumberExclusive),b.push(y);return}const w={modifiedLineRange:m,originalLineRange:v};l.push(w),b.push(w)}),f=b}if(!r.isValid())return[]}l.sort(sie(Sa(d=>d.modifiedLineRange.length,kd)));const c=new oc,u=new oc;for(const d of l){const f=d.modifiedLineRange.startLineNumber-d.originalLineRange.startLineNumber,g=c.subtractFrom(d.modifiedLineRange),p=u.subtractFrom(d.originalLineRange).getWithDelta(f),m=g.getIntersection(p);for(const b of m.ranges){if(b.length<3)continue;const v=b,w=b.delta(-f);o.push(new Ic(w,v)),c.addRange(v),u.addRange(w)}}o.sort(Sa(d=>d.original.startLineNumber,kd));const h=new mS(n);for(let d=0;d<o.length;d++){const f=o[d],g=h.findLastMonotonous(D=>D.original.startLineNumber<=f.original.startLineNumber),p=_y(n,D=>D.modified.startLineNumber<=f.modified.startLineNumber),m=Math.max(f.original.startLineNumber-g.original.startLineNumber,f.modified.startLineNumber-p.modified.startLineNumber),b=h.findLastMonotonous(D=>D.original.startLineNumber<f.original.endLineNumberExclusive),v=_y(n,D=>D.modified.startLineNumber<f.modified.endLineNumberExclusive),w=Math.max(b.original.endLineNumberExclusive-f.original.endLineNumberExclusive,v.modified.endLineNumberExclusive-f.modified.endLineNumberExclusive);let y;for(y=0;y<m;y++){const D=f.original.startLineNumber-y-1,S=f.modified.startLineNumber-y-1;if(D>i.length||S>s.length||c.contains(S)||u.contains(D)||!jH(i[D-1],s[S-1],r))break}y>0&&(u.addRange(new gt(f.original.startLineNumber-y,f.original.startLineNumber)),c.addRange(new gt(f.modified.startLineNumber-y,f.modified.startLineNumber)));let x;for(x=0;x<w;x++){const D=f.original.endLineNumberExclusive+x,S=f.modified.endLineNumberExclusive+x;if(D>i.length||S>s.length||c.contains(S)||u.contains(D)||!jH(i[D-1],s[S-1],r))break}x>0&&(u.addRange(new gt(f.original.endLineNumberExclusive,f.original.endLineNumberExclusive+x)),c.addRange(new gt(f.modified.endLineNumberExclusive,f.modified.endLineNumberExclusive+x))),(y>0||x>0)&&(o[d]=new Ic(new gt(f.original.startLineNumber-y,f.original.endLineNumberExclusive+x),new gt(f.modified.startLineNumber-y,f.modified.endLineNumberExclusive+x)))}return o}function jH(n,e,t){if(n.trim()===e.trim())return!0;if(n.length>300&&e.length>300)return!1;const s=new Rne().compute(new UL([n],new ct(0,1),!1),new UL([e],new ct(0,1),!1),t);let r=0;const o=Wn.invert(s.diffs,n.length);for(const u of o)u.seq1Range.forEach(h=>{tF(n.charCodeAt(h))||r++});function a(u){let h=0;for(let d=0;d<n.length;d++)tF(u.charCodeAt(d))||h++;return h}const l=a(n.length>e.length?n:e);return r/l>.6&&l>10}function MMe(n){if(n.length===0)return n;n.sort(Sa(t=>t.original.startLineNumber,kd));const e=[n[0]];for(let t=1;t<n.length;t++){const i=e[e.length-1],s=n[t],r=s.original.startLineNumber-i.original.endLineNumberExclusive,o=s.modified.startLineNumber-i.modified.endLineNumberExclusive;if(r>=0&&o>=0&&r+o<=2){e[e.length-1]=i.join(s);continue}e.push(s)}return e}function FMe(n,e){const t=new mS(n);return e=e.filter(i=>{const s=t.findLastMonotonous(a=>a.original.endLineNumberExclusive<i.original.endLineNumberExclusive)||new Ic(new gt(1,1),new gt(1,1)),r=_y(n,a=>a.modified.endLineNumberExclusive<i.modified.endLineNumberExclusive);return s!==r}),e}function iF(n,e,t){let i=t;return i=PMe(n,e,i),i=OMe(n,e,i),i}function PMe(n,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let r=1;r<t.length;r++){const o=i[i.length-1];let a=t[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-o.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(n.getElement(a.seq1Range.start-c)!==n.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new Wn(new ct(o.seq1Range.start,a.seq1Range.endExclusive-l),new ct(o.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const s=[];for(let r=0;r<i.length-1;r++){const o=i[r+1];let a=i[r];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=o.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!n.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[r+1]=new Wn(new ct(a.seq1Range.start+l,o.seq1Range.endExclusive),new ct(a.seq2Range.start+l,o.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}s.push(a)}return i.length>0&&s.push(i[i.length-1]),s}function OMe(n,e,t){if(!n.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const s=i>0?t[i-1]:void 0,r=t[i],o=i+1<t.length?t[i+1]:void 0,a=new ct(s?s.seq1Range.start+1:0,o?o.seq1Range.endExclusive-1:n.length),l=new ct(s?s.seq2Range.start+1:0,o?o.seq2Range.endExclusive-1:e.length);r.seq1Range.isEmpty?t[i]=qH(r,n,e,a,l):r.seq2Range.isEmpty&&(t[i]=qH(r.swap(),e,n,l,a).swap())}return t}function qH(n,e,t,i,s){let o=1;for(;n.seq1Range.start-o>=i.start&&n.seq2Range.start-o>=s.start&&t.isStronglyEqual(n.seq2Range.start-o,n.seq2Range.endExclusive-o)&&o<100;)o++;o--;let a=0;for(;n.seq1Range.start+a<i.endExclusive&&n.seq2Range.endExclusive+a<s.endExclusive&&t.isStronglyEqual(n.seq2Range.start+a,n.seq2Range.endExclusive+a)&&a<100;)a++;if(o===0&&a===0)return n;let l=0,c=-1;for(let u=-o;u<=a;u++){const h=n.seq2Range.start+u,d=n.seq2Range.endExclusive+u,f=n.seq1Range.start+u,g=e.getBoundaryScore(f)+t.getBoundaryScore(h)+t.getBoundaryScore(d);g>c&&(c=g,l=u)}return n.delta(l)}function BMe(n,e,t){const i=[];for(const s of t){const r=i[i.length-1];if(!r){i.push(s);continue}s.seq1Range.start-r.seq1Range.endExclusive<=2||s.seq2Range.start-r.seq2Range.endExclusive<=2?i[i.length-1]=new Wn(r.seq1Range.join(s.seq1Range),r.seq2Range.join(s.seq2Range)):i.push(s)}return i}function WMe(n,e,t){const i=[];let s;function r(){if(!s)return;const a=s.s1Range.length-s.deleted;s.s2Range.length-s.added,Math.max(s.deleted,s.added)+(s.count-1)>a&&i.push(new Wn(s.s1Range,s.s2Range)),s=void 0}for(const a of t){let l=function(f,g){var p,m,b,v;if(!s||!s.s1Range.containsRange(f)||!s.s2Range.containsRange(g))if(s&&!(s.s1Range.endExclusive<f.start&&s.s2Range.endExclusive<g.start)){const x=ct.tryCreate(s.s1Range.endExclusive,f.start),D=ct.tryCreate(s.s2Range.endExclusive,g.start);s.deleted+=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,s.added+=(m=D==null?void 0:D.length)!==null&&m!==void 0?m:0,s.s1Range=s.s1Range.join(f),s.s2Range=s.s2Range.join(g)}else r(),s={added:0,deleted:0,count:0,s1Range:f,s2Range:g};const w=f.intersect(a.seq1Range),y=g.intersect(a.seq2Range);s.count++,s.deleted+=(b=w==null?void 0:w.length)!==null&&b!==void 0?b:0,s.added+=(v=y==null?void 0:y.length)!==null&&v!==void 0?v:0};const c=n.findWordContaining(a.seq1Range.start-1),u=e.findWordContaining(a.seq2Range.start-1),h=n.findWordContaining(a.seq1Range.endExclusive),d=e.findWordContaining(a.seq2Range.endExclusive);c&&h&&u&&d&&c.equals(h)&&u.equals(d)?l(c,u):(c&&u&&l(c,u),h&&d&&l(h,d))}return r(),VMe(t,i)}function VMe(n,e){const t=[];for(;n.length>0||e.length>0;){const i=n[0],s=e[0];let r;i&&(!s||i.seq1Range.start<s.seq1Range.start)?r=n.shift():r=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=r.seq1Range.start?t[t.length-1]=t[t.length-1].join(r):t.push(r)}return t}function $Me(n,e,t){let i=t;if(i.length===0)return i;let s=0,r;do{r=!1;const o=[i[0]];for(let a=1;a<i.length;a++){let u=function(d,f){const g=new ct(c.seq1Range.endExclusive,l.seq1Range.start);return n.getText(g).replace(/\s/g,"").length<=4&&(d.seq1Range.length+d.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};const l=i[a],c=o[o.length-1];u(c,l)?(r=!0,o[o.length-1]=o[o.length-1].join(l)):o.push(l)}i=o}while(s++<10&&r);return i}function zMe(n,e,t){let i=t;if(i.length===0)return i;let s=0,r;do{r=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let h=function(f,g){const p=new ct(u.seq1Range.endExclusive,c.seq1Range.start);if(n.countLinesIn(p)>5||p.length>500)return!1;const b=n.getText(p).trim();if(b.length>20||b.split(/\r\n|\r|\n/).length>1)return!1;const v=n.countLinesIn(f.seq1Range),w=f.seq1Range.length,y=e.countLinesIn(f.seq2Range),x=f.seq2Range.length,D=n.countLinesIn(g.seq1Range),S=g.seq1Range.length,T=e.countLinesIn(g.seq2Range),k=g.seq2Range.length,I=2*40+50;function N(z){return Math.min(z,I)}return Math.pow(Math.pow(N(v*40+w),1.5)+Math.pow(N(y*40+x),1.5),1.5)+Math.pow(Math.pow(N(D*40+S),1.5)+Math.pow(N(T*40+k),1.5),1.5)>Math.pow(Math.pow(I,1.5),1.5)*1.3};const c=i[l],u=a[a.length-1];h(u,c)?(r=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(s++<10&&r);const o=[];return qEe(i,(a,l,c)=>{let u=l;function h(b){return b.length>0&&b.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const d=n.extendToFullLines(l.seq1Range),f=n.getText(new ct(d.start,l.seq1Range.start));h(f)&&(u=u.deltaStart(-f.length));const g=n.getText(new ct(l.seq1Range.endExclusive,d.endExclusive));h(g)&&(u=u.deltaEnd(g.length));const p=Wn.fromOffsetPairs(a?a.getEndExclusives():gc.zero,c?c.getStarts():gc.max),m=u.intersect(p);o.push(m)}),o}class GH{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:KH(this.lines[e-1]),i=e===this.lines.length?0:KH(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function KH(n){let e=0;for(;e<n.length&&(n.charCodeAt(e)===32||n.charCodeAt(e)===9);)e++;return e}class Fne{constructor(){this.dynamicProgrammingDiffing=new SMe,this.myersDiffingAlgorithm=new Rne}computeDiff(e,t,i){if(e.length<=1&&yn(e,t,(x,D)=>x===D))return new J2([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new J2([new Ho(new gt(1,e.length+1),new gt(1,t.length+1),[new sf(new H(1,1,e.length,e[0].length+1),new H(1,1,t.length,t[0].length+1))])],[],!1);const s=i.maxComputationTimeMs===0?wy.instance:new CMe(i.maxComputationTimeMs),r=!i.ignoreTrimWhitespace,o=new Map;function a(x){let D=o.get(x);return D===void 0&&(D=o.size,o.set(x,D)),D}const l=e.map(x=>a(x.trim())),c=t.map(x=>a(x.trim())),u=new GH(l,e),h=new GH(c,t),d=(()=>u.length+h.length<1700?this.dynamicProgrammingDiffing.compute(u,h,s,(x,D)=>e[x]===t[D]?t[D].length===0?.1:1+Math.log(1+t[D].length):.99):this.myersDiffingAlgorithm.compute(u,h))();let f=d.diffs,g=d.hitTimeout;f=iF(u,h,f),f=$Me(u,h,f);const p=[],m=x=>{if(r)for(let D=0;D<x;D++){const S=b+D,T=v+D;if(e[S]!==t[T]){const k=this.refineDiff(e,t,new Wn(new ct(S,S+1),new ct(T,T+1)),s,r);for(const I of k.mappings)p.push(I);k.hitTimeout&&(g=!0)}}};let b=0,v=0;for(const x of f){dy(()=>x.seq1Range.start-b===x.seq2Range.start-v);const D=x.seq1Range.start-b;m(D),b=x.seq1Range.endExclusive,v=x.seq2Range.endExclusive;const S=this.refineDiff(e,t,x,s,r);S.hitTimeout&&(g=!0);for(const T of S.mappings)p.push(T)}m(e.length-b);const w=ZH(p,e,t);let y=[];return i.computeMoves&&(y=this.computeMoves(w,e,t,l,c,s,r)),dy(()=>{function x(S,T){if(S.lineNumber<1||S.lineNumber>T.length)return!1;const k=T[S.lineNumber-1];return!(S.column<1||S.column>k.length+1)}function D(S,T){return!(S.startLineNumber<1||S.startLineNumber>T.length+1||S.endLineNumberExclusive<1||S.endLineNumberExclusive>T.length+1)}for(const S of w){if(!S.innerChanges)return!1;for(const T of S.innerChanges)if(!(x(T.modifiedRange.getStartPosition(),t)&&x(T.modifiedRange.getEndPosition(),t)&&x(T.originalRange.getStartPosition(),e)&&x(T.originalRange.getEndPosition(),e)))return!1;if(!D(S.modified,t)||!D(S.original,e))return!1}return!0}),new J2(w,y,g)}computeMoves(e,t,i,s,r,o,a){return IMe(e,t,i,s,r,o).map(u=>{const h=this.refineDiff(t,i,new Wn(u.original.toOffsetRange(),u.modified.toOffsetRange()),o,a),d=ZH(h.mappings,t,i,!0);return new Ine(u,d)})}refineDiff(e,t,i,s,r){const o=new UL(e,i.seq1Range,r),a=new UL(t,i.seq2Range,r),l=o.length+a.length<500?this.dynamicProgrammingDiffing.compute(o,a,s):this.myersDiffingAlgorithm.compute(o,a,s);let c=l.diffs;return c=iF(o,a,c),c=WMe(o,a,c),c=BMe(o,a,c),c=zMe(o,a,c),{mappings:c.map(h=>new sf(o.translateRange(h.seq1Range),a.translateRange(h.seq2Range))),hitTimeout:l.hitTimeout}}}function ZH(n,e,t,i=!1){const s=[];for(const r of Jte(n.map(o=>HMe(o,e,t)),(o,a)=>o.original.overlapOrTouch(a.original)||o.modified.overlapOrTouch(a.modified))){const o=r[0],a=r[r.length-1];s.push(new Ho(o.original.join(a.original),o.modified.join(a.modified),r.map(l=>l.innerChanges[0])))}return dy(()=>!i&&s.length>0&&s[0].original.startLineNumber!==s[0].modified.startLineNumber?!1:Hie(s,(r,o)=>o.original.startLineNumber-r.original.endLineNumberExclusive===o.modified.startLineNumber-r.modified.endLineNumberExclusive&&r.original.endLineNumberExclusive<o.original.startLineNumber&&r.modified.endLineNumberExclusive<o.modified.startLineNumber)),s}function HMe(n,e,t){let i=0,s=0;n.modifiedRange.endColumn===1&&n.originalRange.endColumn===1&&n.originalRange.startLineNumber+i<=n.originalRange.endLineNumber&&n.modifiedRange.startLineNumber+i<=n.modifiedRange.endLineNumber&&(s=-1),n.modifiedRange.startColumn-1>=t[n.modifiedRange.startLineNumber-1].length&&n.originalRange.startColumn-1>=e[n.originalRange.startLineNumber-1].length&&n.originalRange.startLineNumber<=n.originalRange.endLineNumber+s&&n.modifiedRange.startLineNumber<=n.modifiedRange.endLineNumber+s&&(i=1);const r=new gt(n.originalRange.startLineNumber+i,n.originalRange.endLineNumber+1+s),o=new gt(n.modifiedRange.startLineNumber+i,n.modifiedRange.endLineNumber+1+s);return new Ho(r,o,[n])}const YH={getLegacy:()=>new bMe,getDefault:()=>new Fne};function Td(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}class Tt{constructor(e,t,i,s=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Td(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class sa{constructor(e,t,i,s){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Td(Math.max(Math.min(1,t),0),3),this.l=Td(Math.max(Math.min(1,i),0),3),this.a=Td(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,s=e.b/255,r=e.a,o=Math.max(t,i,s),a=Math.min(t,i,s);let l=0,c=0;const u=(a+o)/2,h=o-a;if(h>0){switch(c=Math.min(u<=.5?h/(2*u):h/(2-2*u),1),o){case t:l=(i-s)/h+(i<s?6:0);break;case i:l=(s-t)/h+2;break;case s:l=(t-i)/h+4;break}l*=60,l=Math.round(l)}return new sa(l,c,u,r)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:s,a:r}=e;let o,a,l;if(i===0)o=a=l=s;else{const c=s<.5?s*(1+i):s+i-s*i,u=2*s-c;o=sa._hue2rgb(u,c,t+1/3),a=sa._hue2rgb(u,c,t),l=sa._hue2rgb(u,c,t-1/3)}return new Tt(Math.round(o*255),Math.round(a*255),Math.round(l*255),r)}}class g0{constructor(e,t,i,s){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Td(Math.max(Math.min(1,t),0),3),this.v=Td(Math.max(Math.min(1,i),0),3),this.a=Td(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,s=e.b/255,r=Math.max(t,i,s),o=Math.min(t,i,s),a=r-o,l=r===0?0:a/r;let c;return a===0?c=0:r===t?c=((i-s)/a%6+6)%6:r===i?c=(s-t)/a+2:c=(t-i)/a+4,new g0(Math.round(c*60),l,r,e.a)}static toRGBA(e){const{h:t,s:i,v:s,a:r}=e,o=s*i,a=o*(1-Math.abs(t/60%2-1)),l=s-o;let[c,u,h]=[0,0,0];return t<60?(c=o,u=a):t<120?(c=a,u=o):t<180?(u=o,h=a):t<240?(u=a,h=o):t<300?(c=a,h=o):t<=360&&(c=o,h=a),c=Math.round((c+l)*255),u=Math.round((u+l)*255),h=Math.round((h+l)*255),new Tt(c,u,h,r)}}class J{static fromHex(e){return J.Format.CSS.parseHex(e)||J.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:sa.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:g0.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof Tt)this.rgba=e;else if(e instanceof sa)this._hsla=e,this.rgba=sa.toRGBA(e);else if(e instanceof g0)this._hsva=e,this.rgba=g0.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&Tt.equals(this.rgba,e.rgba)&&sa.equals(this.hsla,e.hsla)&&g0.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=J._relativeLuminanceForComponent(this.rgba.r),t=J._relativeLuminanceForComponent(this.rgba.g),i=J._relativeLuminanceForComponent(this.rgba.b),s=.2126*e+.7152*t+.0722*i;return Td(s,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new J(new sa(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new J(new sa(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:s,a:r}=this.rgba;return new J(new Tt(t,i,s,r*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new J(new Tt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:s,a:r}=this.rgba;return new J(new Tt(e.rgba.r-r*(e.rgba.r-t),e.rgba.g-r*(e.rgba.g-i),e.rgba.b-r*(e.rgba.b-s),1))}toString(){return this._toString||(this._toString=J.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const s=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(r-s)/r,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const s=e.getRelativeLuminance(),r=t.getRelativeLuminance();return i=i*(s-r)/s,e.darken(i)}}J.white=new J(new Tt(255,255,255,1));J.black=new J(new Tt(0,0,0,1));J.red=new J(new Tt(255,0,0,1));J.blue=new J(new Tt(0,0,255,1));J.green=new J(new Tt(0,255,0,1));J.cyan=new J(new Tt(0,255,255,1));J.lightgrey=new J(new Tt(211,211,211,1));J.transparent=new J(new Tt(0,0,0,0));(function(n){(function(e){(function(t){function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:n.Format.CSS.formatRGBA(f)}t.formatRGB=i;function s(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}t.formatRGBA=s;function r(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:n.Format.CSS.formatHSLA(f)}t.formatHSL=r;function o(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}t.formatHSLA=o;function a(f){const g=f.toString(16);return g.length!==2?"0"+g:g}function l(f){return`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}`}t.formatHex=l;function c(f,g=!1){return g&&f.rgba.a===1?n.Format.CSS.formatHex(f):`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}${a(Math.round(f.rgba.a*255))}`}t.formatHexA=c;function u(f){return f.isOpaque()?n.Format.CSS.formatHex(f):n.Format.CSS.formatRGBA(f)}t.format=u;function h(f){const g=f.length;if(g===0||f.charCodeAt(0)!==35)return null;if(g===7){const p=16*d(f.charCodeAt(1))+d(f.charCodeAt(2)),m=16*d(f.charCodeAt(3))+d(f.charCodeAt(4)),b=16*d(f.charCodeAt(5))+d(f.charCodeAt(6));return new n(new Tt(p,m,b,1))}if(g===9){const p=16*d(f.charCodeAt(1))+d(f.charCodeAt(2)),m=16*d(f.charCodeAt(3))+d(f.charCodeAt(4)),b=16*d(f.charCodeAt(5))+d(f.charCodeAt(6)),v=16*d(f.charCodeAt(7))+d(f.charCodeAt(8));return new n(new Tt(p,m,b,v/255))}if(g===4){const p=d(f.charCodeAt(1)),m=d(f.charCodeAt(2)),b=d(f.charCodeAt(3));return new n(new Tt(16*p+p,16*m+m,16*b+b))}if(g===5){const p=d(f.charCodeAt(1)),m=d(f.charCodeAt(2)),b=d(f.charCodeAt(3)),v=d(f.charCodeAt(4));return new n(new Tt(16*p+p,16*m+m,16*b+b,(16*v+v)/255))}return null}t.parseHex=h;function d(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(n.Format||(n.Format={}))})(J||(J={}));function Pne(n){const e=[];for(const t of n){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function I8(n,e,t,i){return{red:n/255,blue:t/255,green:e/255,alpha:i}}function L1(n,e){const t=e.index,i=e[0].length;if(!t)return;const s=n.positionAt(t);return{startLineNumber:s.lineNumber,startColumn:s.column,endLineNumber:s.lineNumber,endColumn:s.column+i}}function UMe(n,e){if(!n)return;const t=J.Format.CSS.parseHex(e);if(t)return{range:n,color:I8(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function XH(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),r=Pne(s);return{range:n,color:I8(r[0],r[1],r[2],t?r[3]:1)}}function QH(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),r=Pne(s),o=new J(new sa(r[0],r[1]/100,r[2]/100,t?r[3]:1));return{range:n,color:I8(o.rgba.r,o.rgba.g,o.rgba.b,o.rgba.a)}}function D1(n,e){return typeof n=="string"?[...n.matchAll(e)]:n.findMatches(e)}function jMe(n){const e=[],i=D1(n,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const s of i){const r=s.filter(c=>c!==void 0),o=r[1],a=r[2];if(!a)continue;let l;if(o==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=XH(L1(n,s),D1(a,c),!1)}else if(o==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=XH(L1(n,s),D1(a,c),!0)}else if(o==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=QH(L1(n,s),D1(a,c),!1)}else if(o==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=QH(L1(n,s),D1(a,c),!0)}else o==="#"&&(l=UMe(L1(n,s),o+a));l&&e.push(l)}return e}function qMe(n){return!n||typeof n.getValue!="function"||typeof n.positionAt!="function"?[]:jMe(n)}var xh=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class GMe extends GRe{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const s=this._lines[i],r=this.offsetAt(new X(i+1,1)),o=s.matchAll(e);for(const a of o)(a.index||a.index===0)&&(a.index=a.index+r),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=ry(e.column,fie(t),this._lines[e.lineNumber-1],0);return i?new H(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let s=0,r="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=r.substring(a[o].start,a[o].end);o+=1,yield l}else if(s<t.length)r=t[s],a=i(r,e),o=0,s+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],s=this._wordenize(i,t),r=[];for(const o of s)r.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return r}_wordenize(e,t){const i=[];let s;for(t.lastIndex=0;(s=t.exec(e))&&s[0].length!==0;)i.push({start:s.index,end:s.index+s[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,s=e.endLineNumber-1,r=[];r.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<s;o++)r.push(this._lines[o]);return r.push(this._lines[s].substring(0,e.endColumn-1)),r.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!X.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,s=!1;if(t<1)t=1,i=1,s=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,s=!0;else{const r=this._lines[t-1].length+1;i<1?(i=1,s=!0):i>r&&(i=r,s=!0)}return s?{lineNumber:t,column:i}:e}}class Ad{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}acceptNewModel(e){this._models[e.url]=new GMe(ot.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeUnicodeHighlights(e,t,i){return xh(this,void 0,void 0,function*(){const s=this._getModel(e);return s?cMe.computeUnicodeHighlights(s,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}})}computeDiff(e,t,i,s){return xh(this,void 0,void 0,function*(){const r=this._getModel(e),o=this._getModel(t);return!r||!o?null:Ad.computeDiff(r,o,i,s)})}static computeDiff(e,t,i,s){const r=s==="advanced"?YH.getDefault():YH.getLegacy(),o=e.getLinesContent(),a=t.getLinesContent(),l=r.computeDiff(o,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function u(h){return h.map(d=>{var f;return[d.original.startLineNumber,d.original.endLineNumberExclusive,d.modified.startLineNumber,d.modified.endLineNumberExclusive,(f=d.innerChanges)===null||f===void 0?void 0:f.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:u(l.changes),moves:l.moves.map(h=>[h.lineRangeMapping.original.startLineNumber,h.lineRangeMapping.original.endLineNumberExclusive,h.lineRangeMapping.modified.startLineNumber,h.lineRangeMapping.modified.endLineNumberExclusive,u(h.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),s=t.getLineCount();if(i!==s)return!1;for(let r=1;r<=i;r++){const o=e.getLineContent(r),a=t.getLineContent(r);if(o!==a)return!1}return!0}computeMoreMinimalEdits(e,t,i){return xh(this,void 0,void 0,function*(){const s=this._getModel(e);if(!s)return t;const r=[];let o;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return H.compareRangesUsingStarts(l.range,c.range);const u=l.range?0:1,h=c.range?0:1;return u-h});let a=0;for(let l=1;l<t.length;l++)H.getEndPosition(t[a].range).equals(H.getStartPosition(t[l].range))?(t[a].range=H.fromPositions(H.getStartPosition(t[a].range),H.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:u}of t){if(typeof u=="number"&&(o=u),H.isEmpty(l)&&!c)continue;const h=s.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,s.eol),h===c)continue;if(Math.max(c.length,h.length)>Ad._diffLimit){r.push({range:l,text:c});continue}const d=URe(h,c,i),f=s.offsetAt(H.lift(l).getStartPosition());for(const g of d){const p=s.positionAt(f+g.originalStart),m=s.positionAt(f+g.originalStart+g.originalLength),b={text:c.substr(g.modifiedStart,g.modifiedLength),range:{startLineNumber:p.lineNumber,startColumn:p.column,endLineNumber:m.lineNumber,endColumn:m.column}};s.getValueInRange(b.range)!==b.text&&r.push(b)}}return typeof o=="number"&&r.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r})}computeLinks(e){return xh(this,void 0,void 0,function*(){const t=this._getModel(e);return t?QRe(t):null})}computeDefaultDocumentColors(e){return xh(this,void 0,void 0,function*(){const t=this._getModel(e);return t?qMe(t):null})}textualSuggest(e,t,i,s){return xh(this,void 0,void 0,function*(){const r=new wf,o=new RegExp(i,s),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const u of c.words(o))if(!(u===t||!isNaN(Number(u)))&&(a.add(u),a.size>Ad._suggestionsLimit))break e}}return{words:Array.from(a),duration:r.elapsed()}})}computeWordRanges(e,t,i,s){return xh(this,void 0,void 0,function*(){const r=this._getModel(e);if(!r)return Object.create(null);const o=new RegExp(i,s),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=r.getLineWords(l,o);for(const u of c){if(!isNaN(Number(u.word)))continue;let h=a[u.word];h||(h=[],a[u.word]=h),h.push({startLineNumber:l,startColumn:u.startColumn,endLineNumber:l,endColumn:u.endColumn})}}return a})}navigateValueSet(e,t,i,s,r){return xh(this,void 0,void 0,function*(){const o=this._getModel(e);if(!o)return null;const a=new RegExp(s,r);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const u=o.getValueInRange(c);return X3.INSTANCE.navigateValueSet(t,l,c,u,i)})}loadForeignModule(e,t,i){const o={host:iTe(i,(a,l)=>this._host.fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(o,t),Promise.resolve(X6(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}Ad._diffLimit=1e5;Ad._suggestionsLimit=1e4;typeof importScripts=="function"&&(globalThis.monaco=Iie());const One=kt("textResourceConfigurationService"),Bne=kt("textResourcePropertiesService"),wt=kt("ILanguageFeaturesService");var KMe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},E1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},jL=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const JH=60*1e3,eU=5*60*1e3;function tg(n,e){const t=n.getModel(e);return!(!t||t.isTooLargeForSyncing())}let nF=class extends ae{constructor(e,t,i,s,r){super(),this._modelService=e,this._workerManager=this._register(new YMe(this._modelService,s)),this._logService=i,this._register(r.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(o,a)=>tg(this._modelService,o.uri)?this._workerManager.withWorker().then(l=>l.computeLinks(o.uri)).then(l=>l&&{links:l}):Promise.resolve({links:[]})})),this._register(r.completionProvider.register("*",new ZMe(this._workerManager,t,this._modelService,s)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return tg(this._modelService,e)}computedUnicodeHighlights(e,t,i){return this._workerManager.withWorker().then(s=>s.computedUnicodeHighlights(e,t,i))}computeDiff(e,t,i,s){return jL(this,void 0,void 0,function*(){const r=yield this._workerManager.withWorker().then(l=>l.computeDiff(e,t,i,s));if(!r)return null;return{identical:r.identical,quitEarly:r.quitEarly,changes:a(r.changes),moves:r.moves.map(l=>new Ine(new Ic(new gt(l[0],l[1]),new gt(l[2],l[3])),a(l[4])))};function a(l){return l.map(c=>{var u;return new Ho(new gt(c[0],c[1]),new gt(c[2],c[3]),(u=c[4])===null||u===void 0?void 0:u.map(h=>new sf(new H(h[0],h[1],h[2],h[3]),new H(h[4],h[5],h[6],h[7]))))})}})}computeMoreMinimalEdits(e,t,i=!1){if(Uu(t)){if(!tg(this._modelService,e))return Promise.resolve(t);const s=wf.create(),r=this._workerManager.withWorker().then(o=>o.computeMoreMinimalEdits(e,t,i));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),s.elapsed())),Promise.race([r,py(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return tg(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then(s=>s.navigateValueSet(e,t,i))}canComputeWordRanges(e){return tg(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then(i=>i.computeWordRanges(e,t))}};nF=KMe([E1(0,Zs),E1(1,One),E1(2,lh),E1(3,Ur),E1(4,wt)],nF);class ZMe{constructor(e,t,i,s){this.languageConfigurationService=s,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}provideCompletionItems(e,t){return jL(this,void 0,void 0,function*(){const i=this._configurationService.getValue(e.uri,t,"editor");if(!i.wordBasedSuggestions)return;const s=[];if(i.wordBasedSuggestionsMode==="currentDocument")tg(this._modelService,e.uri)&&s.push(e.uri);else for(const h of this._modelService.getModels())tg(this._modelService,h.uri)&&(h===e?s.unshift(h.uri):(i.wordBasedSuggestionsMode==="allDocuments"||h.getLanguageId()===e.getLanguageId())&&s.push(h.uri));if(s.length===0)return;const r=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),o=e.getWordAtPosition(t),a=o?new H(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):H.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),u=yield(yield this._workerManager.withWorker()).textualSuggest(s,o==null?void 0:o.word,r);if(u)return{duration:u.duration,suggestions:u.words.map(h=>({kind:18,label:h,insertText:h,range:{insert:l,replace:a}}))}})}}class YMe extends ae{constructor(e,t){super(),this.languageConfigurationService=t,this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new gS).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(eU/2)),this._register(this._modelService.onModelRemoved(s=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>eU&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new Wne(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class XMe extends ae{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const s=new gS;s.cancelAndSet(()=>this._checkStopModelSync(),Math.round(JH/2)),this._register(s)}}dispose(){for(const e in this._syncedModels)ti(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t){for(const i of e){const s=i.toString();this._syncedModels[s]||this._beginModelSync(i,t),this._syncedModels[s]&&(this._syncedModelsLastUsedTime[s]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>JH&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const s=e.toString();this._proxy.acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const r=new Ae;r.add(i.onDidChangeContent(o=>{this._proxy.acceptModelChanged(s.toString(),o)})),r.add(i.onWillDispose(()=>{this._stopModelSync(s)})),r.add(ut(()=>{this._proxy.acceptRemovedModel(s)})),this._syncedModels[s]=r}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],ti(t)}}class tU{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class ZN{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class Wne extends ae{constructor(e,t,i,s){super(),this.languageConfigurationService=s,this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new LT(i),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new QNe(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new ZN(this)))}catch(e){G3(e),this._worker=new tU(new Ad(new ZN(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,e=>(G3(e),this._worker=new tU(new Ad(new ZN(this),null)),this._getOrCreateWorker().getProxyObject()))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new XMe(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e,t=!1){return jL(this,void 0,void 0,function*(){return this._disposed?Promise.reject(oAe()):this._getProxy().then(i=>(this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i))})}computedUnicodeHighlights(e,t,i){return this._withSyncedResources([e]).then(s=>s.computeUnicodeHighlights(e.toString(),t,i))}computeDiff(e,t,i,s){return this._withSyncedResources([e,t],!0).then(r=>r.computeDiff(e.toString(),t.toString(),i,s))}computeMoreMinimalEdits(e,t,i){return this._withSyncedResources([e]).then(s=>s.computeMoreMinimalEdits(e.toString(),t,i))}computeLinks(e){return this._withSyncedResources([e]).then(t=>t.computeLinks(e.toString()))}computeDefaultDocumentColors(e){return this._withSyncedResources([e]).then(t=>t.computeDefaultDocumentColors(e.toString()))}textualSuggest(e,t,i){return jL(this,void 0,void 0,function*(){const s=yield this._withSyncedResources(e),r=i.source,o=i.flags;return s.textualSuggest(e.map(a=>a.toString()),t,r,o)})}computeWordRanges(e,t){return this._withSyncedResources([e]).then(i=>{const s=this._modelService.getModel(e);if(!s)return Promise.resolve(null);const r=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId()).getWordDefinition(),o=r.source,a=r.flags;return i.computeWordRanges(e.toString(),t,o,a)})}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then(s=>{const r=this._modelService.getModel(e);if(!r)return null;const o=this.languageConfigurationService.getLanguageConfiguration(r.getLanguageId()).getWordDefinition(),a=o.source,l=o.flags;return s.navigateValueSet(e.toString(),t,i,a,l)})}dispose(){super.dispose(),this._disposed=!0}}function QMe(n,e,t){return new JMe(n,e,t)}class JMe extends Wne{constructor(e,t,i){super(e,i.keepIdleModels||!1,i.label,t),this._foreignModuleId=i.moduleId,this._foreignModuleCreateData=i.createData||null,this._foreignModuleHost=i.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?X6(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const s=(a,l)=>e.fmr(a,l),r=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},o={};for(const a of i)o[a]=r(a,s);return o})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then(t=>this.getProxy())}}const MT={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},yy=new class{clone(){return this}equals(n){return this===n}};function Vne(n,e){return new a8([new ay(0,"",n)],e)}function N8(n,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(n<<0|0|0|32768|2<<24)>>>0,new hT(t,e===null?yy:e)}class Ir{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const s=this.getFontStyle(e);return s&1&&(i+=" mtki"),s&2&&(i+=" mtkb"),s&4&&(i+=" mtku"),s&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),s=this.getFontStyle(e);let r=`color: ${t[i]};`;s&1&&(r+="font-style: italic;"),s&2&&(r+="font-weight: bold;");let o="";return s&4&&(o+=" underline"),s&8&&(o+=" line-through"),o&&(r+=`text-decoration:${o};`),r}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}class An{static createEmpty(e,t){const i=An.defaultTokenMetadata,s=new Uint32Array(2);return s[0]=e.length,s[1]=i,new An(s,e,t)}constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._languageIdCodec=i}equals(e){return e instanceof An?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const s=t<<1,r=s+(i<<1);for(let o=s;o<r;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Ir.getLanguageId(t);return this._languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Ir.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Ir.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Ir.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Ir.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Ir.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return An.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new R8(this,e,t,i)}static convertToEndOffset(e,t){const s=(e.length>>>1)-1;for(let r=0;r<s;r++)e[r<<1]=e[r+1<<1];e[s<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,s=(e.length>>>1)-1;for(;i<s;){const r=i+Math.floor((s-i)/2),o=e[r<<1];if(o===t)return r+1;o<t?i=r+1:o>t&&(s=r)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,s="";const r=new Array;let o=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){s+=this._text.substring(o,a);const c=this._tokens[(t<<1)+1];r.push(s.length,c),t++,o=a}else if(l){if(l.offset>o){s+=this._text.substring(o,l.offset);const c=this._tokens[(t<<1)+1];r.push(s.length,c),o=l.offset}s+=l.text,r.push(s.length,l.tokenMetadata),i++}else break}return new An(new Uint32Array(r),s,this._languageIdCodec)}}An.defaultTokenMetadata=(32768|2<<24)>>>0;class R8{constructor(e,t,i,s){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=s,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let r=this._firstTokenIndex,o=e.getCount();r<o&&!(e.getStartOffset(r)>=i);r++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof R8?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class va{constructor(e,t,i,s){this.startColumn=e,this.endColumn=t,this.className=i,this.type=s,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,s=t.length;if(i!==s)return!1;for(let r=0;r<i;r++)if(!va._equals(e[r],t[r]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const s=t+1,r=i+1,o=i-t,a=[];let l=0;for(const c of e)c.endColumn<=s||c.startColumn>=r||(a[l++]=new va(Math.max(1,c.startColumn-s+1),Math.min(o+1,c.endColumn-s+1),c.className,c.type));return a}static filter(e,t,i,s){if(e.length===0)return[];const r=[];let o=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.range;if(u.endLineNumber<t||u.startLineNumber>t||u.isEmpty()&&(c.type===0||c.type===3))continue;const h=u.startLineNumber===t?u.startColumn:i,d=u.endLineNumber===t?u.endColumn:s;r[o++]=new va(h,d,c.inlineClassName,c.type)}return r}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=va._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class iU{constructor(e,t,i,s){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=s}}class qL{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,s=e.length;i<s;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let s=0;for(;s+1<this.count&&this.stopOffsets[s]===this.stopOffsets[s+1];)s++;i.push(new iU(t,this.stopOffsets[s],this.classNames.join(" "),qL._metadata(this.metadata))),t=this.stopOffsets[s]+1,this.stopOffsets.splice(0,s+1),this.classNames.splice(0,s+1),this.metadata.splice(0,s+1),this.count-=s+1}return this.count>0&&t<e&&(i.push(new iU(t,e-1,this.classNames.join(" "),qL._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let s=0;s<this.count;s++)if(this.stopOffsets[s]>=e){this.stopOffsets.splice(s,0,e),this.classNames.splice(s,0,t),this.metadata.splice(s,0,i);break}this.count++}}class e4e{static normalize(e,t){if(t.length===0)return[];const i=[],s=new qL;let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c=l.startColumn,u=l.endColumn;const h=l.className,d=l.type===1?2:l.type===2?4:0;if(c>1){const p=e.charCodeAt(c-2);Dn(p)&&c--}if(u>1){const p=e.charCodeAt(u-2);Dn(p)&&u--}const f=c-1,g=u-2;r=s.consumeLowerThan(f,r,i),s.count===0&&(r=f),s.insert(g,h,d)}return s.consumeLowerThan(1073741824,r,i),i}}class En{constructor(e,t,i,s){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=s,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class $ne{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class Zb{constructor(e,t,i,s,r,o,a,l,c,u,h,d,f,g,p,m,b,v,w){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=s,this.isBasicASCII=r,this.containsRTL=o,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(va.compare),this.tabSize=u,this.startVisibleColumn=h,this.spaceWidth=d,this.stopRenderingLineAfter=p,this.renderWhitespace=m==="all"?4:m==="boundary"?1:m==="selection"?2:m==="trailing"?3:0,this.renderControlCharacters=b,this.fontLigatures=v,this.selectionsOnLine=w&&w.sort((D,S)=>D.startOffset<S.startOffset?-1:1);const y=Math.abs(g-d),x=Math.abs(f-d);y<x?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=f,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&va.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class zne{constructor(e,t){this.partIndex=e,this.charIndex=t}}class Jl{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,s){const r=(t<<16|i<<0)>>>0;this._data[e-1]=r,this._horizontalOffset[e-1]=s}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=Jl.getPartIndex(t),s=Jl.getCharIndex(t);return new zne(i,s)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const s=(e<<16|i<<0)>>>0;let r=0,o=this.length-1;for(;r+1<o;){const p=r+o>>>1,m=this._data[p];if(m===s)return p;m>s?o=p:r=p}if(r===o)return r;const a=this._data[r],l=this._data[o];if(a===s)return r;if(l===s)return o;const c=Jl.getPartIndex(a),u=Jl.getCharIndex(a),h=Jl.getPartIndex(l);let d;c!==h?d=t:d=Jl.getCharIndex(l);const f=i-u,g=d-i;return f<=g?r:o}}class sF{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function M8(n,e){if(n.lineContent.length===0){if(n.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,s=0;for(const o of n.lineDecorations)(o.type===1||o.type===2)&&(e.appendString('<span class="'),e.appendString(o.className),e.appendString('"></span>'),o.type===1&&(s|=1,t++),o.type===2&&(s|=2,i++));e.appendString("</span>");const r=new Jl(1,t+i);return r.setColumnInfo(1,t,0,0),new sF(r,!1,s)}return e.appendString("<span><span></span></span>"),new sF(new Jl(0,0),!1,0)}return c4e(n4e(n),e)}class t4e{constructor(e,t,i,s){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=s}}function FT(n){const e=new ET(1e4),t=M8(n,e);return new t4e(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class i4e{constructor(e,t,i,s,r,o,a,l,c,u,h,d,f,g,p,m){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=s,this.isOverflowing=r,this.overflowingCharCount=o,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=u,this.startVisibleColumn=h,this.containsRTL=d,this.spaceWidth=f,this.renderSpaceCharCode=g,this.renderWhitespace=p,this.renderControlCharacters=m}}function n4e(n){const e=n.lineContent;let t,i,s;n.stopRenderingLineAfter!==-1&&n.stopRenderingLineAfter<e.length?(t=!0,i=e.length-n.stopRenderingLineAfter,s=n.stopRenderingLineAfter):(t=!1,i=0,s=e.length);let r=s4e(e,n.containsRTL,n.lineTokens,n.fauxIndentLength,s);n.renderControlCharacters&&!n.isBasicASCII&&(r=o4e(e,r)),(n.renderWhitespace===4||n.renderWhitespace===1||n.renderWhitespace===2&&n.selectionsOnLine||n.renderWhitespace===3&&!n.continuesWithWrappedLine)&&(r=a4e(n,e,s,r));let o=0;if(n.lineDecorations.length>0){for(let a=0,l=n.lineDecorations.length;a<l;a++){const c=n.lineDecorations[a];c.type===3||c.type===1?o|=1:c.type===2&&(o|=2)}r=l4e(e,s,r,n.lineDecorations)}return n.containsRTL||(r=r4e(e,r,!n.isBasicASCII||n.fontLigatures)),new i4e(n.useMonospaceOptimizations,n.canUseHalfwidthRightwardsArrow,e,s,t,i,r,o,n.fauxIndentLength,n.tabSize,n.startVisibleColumn,n.containsRTL,n.spaceWidth,n.renderSpaceCharCode,n.renderWhitespace,n.renderControlCharacters)}function s4e(n,e,t,i,s){const r=[];let o=0;i>0&&(r[o++]=new En(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const u=t.getEndOffset(l);if(u<=i)continue;const h=t.getClassName(l);if(u>=s){const f=e?uy(n.substring(a,s)):!1;r[o++]=new En(s,h,0,f);break}const d=e?uy(n.substring(a,u)):!1;r[o++]=new En(u,h,0,d),a=u}return r}function r4e(n,e,t){let i=0;const s=[];let r=0;if(t)for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;if(i+50<c){const u=l.type,h=l.metadata,d=l.containsRTL;let f=-1,g=i;for(let p=i;p<c;p++)n.charCodeAt(p)===32&&(f=p),f!==-1&&p-g>=50&&(s[r++]=new En(f+1,u,h,d),g=f+1,f=-1);g!==c&&(s[r++]=new En(c,u,h,d))}else s[r++]=l;i=c}else for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex,u=c-i;if(u>50){const h=l.type,d=l.metadata,f=l.containsRTL,g=Math.ceil(u/50);for(let p=1;p<g;p++){const m=i+p*50;s[r++]=new En(m,h,d,f)}s[r++]=new En(c,h,d,f)}else s[r++]=l;i=c}return s}function Hne(n){return n<32?n!==9:n===127||n>=8234&&n<=8238||n>=8294&&n<=8297||n>=8206&&n<=8207||n===1564}function o4e(n,e){const t=[];let i=new En(0,"",0,!1),s=0;for(const r of e){const o=r.endIndex;for(;s<o;s++){const a=n.charCodeAt(s);Hne(a)&&(s>i.endIndex&&(i=new En(s,r.type,r.metadata,r.containsRTL),t.push(i)),i=new En(s+1,"mtkcontrol",r.metadata,!1),t.push(i))}s>i.endIndex&&(i=new En(o,r.type,r.metadata,r.containsRTL),t.push(i))}return t}function a4e(n,e,t,i){const s=n.continuesWithWrappedLine,r=n.fauxIndentLength,o=n.tabSize,a=n.startVisibleColumn,l=n.useMonospaceOptimizations,c=n.selectionsOnLine,u=n.renderWhitespace===1,h=n.renderWhitespace===3,d=n.renderSpaceWidth!==n.spaceWidth,f=[];let g=0,p=0,m=i[p].type,b=i[p].containsRTL,v=i[p].endIndex;const w=i.length;let y=!1,x=Pr(e),D;x===-1?(y=!0,x=t,D=t):D=tm(e);let S=!1,T=0,k=c&&c[T],I=a%o;for(let z=r;z<t;z++){const $=e.charCodeAt(z);k&&z>=k.endOffset&&(T++,k=c&&c[T]);let q;if(z<x||z>D)q=!0;else if($===9)q=!0;else if($===32)if(u)if(S)q=!0;else{const ne=z+1<t?e.charCodeAt(z+1):0;q=ne===32||ne===9}else q=!0;else q=!1;if(q&&c&&(q=!!k&&k.startOffset<=z&&k.endOffset>z),q&&h&&(q=y||z>D),q&&b&&z>=x&&z<=D&&(q=!1),S){if(!q||!l&&I>=o){if(d){const ne=g>0?f[g-1].endIndex:r;for(let de=ne+1;de<=z;de++)f[g++]=new En(de,"mtkw",1,!1)}else f[g++]=new En(z,"mtkw",1,!1);I=I%o}}else(z===v||q&&z>r)&&(f[g++]=new En(z,m,0,b),I=I%o);for($===9?I=o:Jd($)?I+=2:I++,S=q;z===v&&(p++,p<w);)m=i[p].type,b=i[p].containsRTL,v=i[p].endIndex}let N=!1;if(S)if(s&&u){const z=t>0?e.charCodeAt(t-1):0,$=t>1?e.charCodeAt(t-2):0;z===32&&$!==32&&$!==9||(N=!0)}else N=!0;if(N)if(d){const z=g>0?f[g-1].endIndex:r;for(let $=z+1;$<=t;$++)f[g++]=new En($,"mtkw",1,!1)}else f[g++]=new En(t,"mtkw",1,!1);else f[g++]=new En(t,m,0,b);return f}function l4e(n,e,t,i){i.sort(va.compare);const s=e4e.normalize(n,i),r=s.length;let o=0;const a=[];let l=0,c=0;for(let h=0,d=t.length;h<d;h++){const f=t[h],g=f.endIndex,p=f.type,m=f.metadata,b=f.containsRTL;for(;o<r&&s[o].startOffset<g;){const v=s[o];if(v.startOffset>c&&(c=v.startOffset,a[l++]=new En(c,p,m,b)),v.endOffset+1<=g)c=v.endOffset+1,a[l++]=new En(c,p+" "+v.className,m|v.metadata,b),o++;else{c=g,a[l++]=new En(c,p+" "+v.className,m|v.metadata,b);break}}g>c&&(c=g,a[l++]=new En(c,p,m,b))}const u=t[t.length-1].endIndex;if(o<r&&s[o].startOffset===u)for(;o<r&&s[o].startOffset===u;){const h=s[o];a[l++]=new En(c,h.className,h.metadata,!1),o++}return a}function c4e(n,e){const t=n.fontIsMonospace,i=n.canUseHalfwidthRightwardsArrow,s=n.containsForeignElements,r=n.lineContent,o=n.len,a=n.isOverflowing,l=n.overflowingCharCount,c=n.parts,u=n.fauxIndentLength,h=n.tabSize,d=n.startVisibleColumn,f=n.containsRTL,g=n.spaceWidth,p=n.renderSpaceCharCode,m=n.renderWhitespace,b=n.renderControlCharacters,v=new Jl(o+1,c.length);let w=!1,y=0,x=d,D=0,S=0,T=0;f?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let k=0,I=c.length;k<I;k++){const N=c[k],z=N.endIndex,$=N.type,q=N.containsRTL,ne=m!==0&&N.isWhitespace(),de=ne&&!t&&($==="mtkw"||!s),me=y===z&&N.isPseudoAfter();if(D=0,e.appendString("<span "),q&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(de?"mtkz":$),e.appendASCIICharCode(34),ne){let De=0;{let ve=y,$e=x;for(;ve<z;ve++){const xe=(r.charCodeAt(ve)===9?h-$e%h:1)|0;De+=xe,ve>=u&&($e+=xe)}}for(de&&(e.appendString(' style="width:'),e.appendString(String(g*De)),e.appendString('px"')),e.appendASCIICharCode(62);y<z;y++){v.setColumnInfo(y+1,k-T,D,S),T=0;const ve=r.charCodeAt(y);let $e,Ne;if(ve===9){$e=h-x%h|0,Ne=$e,!i||Ne>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let xe=2;xe<=Ne;xe++)e.appendCharCode(160)}else $e=2,Ne=1,e.appendCharCode(p),e.appendCharCode(8204);D+=$e,S+=Ne,y>=u&&(x+=Ne)}}else for(e.appendASCIICharCode(62);y<z;y++){v.setColumnInfo(y+1,k-T,D,S),T=0;const De=r.charCodeAt(y);let ve=1,$e=1;switch(De){case 9:ve=h-x%h,$e=ve;for(let Ne=1;Ne<=ve;Ne++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:b?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Jd(De)&&$e++,b&&De<32?e.appendCharCode(9216+De):b&&De===127?e.appendCharCode(9249):b&&Hne(De)?(e.appendString("[U+"),e.appendString(u4e(De)),e.appendString("]"),ve=8,$e=ve):e.appendCharCode(De)}D+=ve,S+=$e,y>=u&&(x+=$e)}me?T++:T=0,y>=o&&!w&&N.isPseudoAfter()&&(w=!0,v.setColumnInfo(y+1,k,D,S)),e.appendString("</span>")}return w||v.setColumnInfo(o+1,c.length-1,D,S),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(_("showMore","Show more ({0})",h4e(l))),e.appendString("</span>")),e.appendString("</span>"),new sF(v,f,s)}function u4e(n){return n.toString(16).toUpperCase().padStart(4,"0")}function h4e(n){return n<1024?_("overflow.chars","{0} chars",n):n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/1024/1024).toFixed(1)} MB`}class nU{constructor(e,t,i,s){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=s|0}}class d4e{constructor(e,t){this.tabSize=e,this.data=t}}class F8{constructor(e,t,i,s,r,o,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=s,this.startVisibleColumn=r,this.tokens=o,this.inlineDecorations=a}}class wo{constructor(e,t,i,s,r,o,a,l,c,u){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=s,this.isBasicASCII=wo.isBasicASCII(i,o),this.containsRTL=wo.containsRTL(i,this.isBasicASCII,r),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=u}static isBasicASCII(e,t){return t?f8(e):!0}static containsRTL(e,t,i){return!t&&i?uy(e):!1}}class qv{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class f4e{constructor(e,t,i,s){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=s}toInlineDecoration(e){return new qv(new H(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class Une{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class Cy{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&yn(e.data,t.data)}static equalsArr(e,t){return yn(e,t,Cy.equals)}}function g4e(n){return Array.isArray(n)}function p4e(n){return!g4e(n)}function jne(n){return typeof n=="string"}function sU(n){return!jne(n)}function Xm(n){return!n}function Id(n,e){return n.ignoreCase&&e?e.toLowerCase():e}function rU(n){return n.replace(/[&<>'"_]/g,"-")}function m4e(n,e){console.log(`${n.languageId}: ${e}`)}function si(n,e){return new Error(`${n.languageId}: ${e}`)}function Kh(n,e,t,i,s){const r=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(r,function(a,l,c,u,h,d,f,g,p){return Xm(c)?Xm(u)?!Xm(h)&&h<i.length?Id(n,i[h]):!Xm(f)&&n&&typeof n[f]=="string"?n[f]:(o===null&&(o=s.split("."),o.unshift(s)),!Xm(d)&&d<o.length?Id(n,o[d]):""):Id(n,t):"$"})}function kx(n,e){let t=e;for(;t&&t.length>0;){const i=n.tokenizer[t];if(i)return i;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return null}function _4e(n,e){let t=e;for(;t&&t.length>0;){if(n.stateNames[t])return!0;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return!1}var b4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},v4e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},rF;const qne=5;class Sy{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new e_(e,t);let i=e_.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let s=this._entries[i];return s||(s=new e_(e,t),this._entries[i]=s,s)}}Sy._INSTANCE=new Sy(qne);class e_{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return e_._equals(this,e)}push(e){return Sy.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Sy.create(this.parent,e)}}class p0{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new p0(this.languageId,this.state)}}class Zh{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new Gv(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new Gv(e,t);const i=e_.getStackElementId(e);let s=this._entries[i];return s||(s=new Gv(e,null),this._entries[i]=s,s)}}Zh._INSTANCE=new Zh(qne);class Gv{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Zh.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof Gv)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class w4e{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new ay(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,s){const r=i.languageId,o=i.state,a=$i.get(r);if(!a)return this.enterLanguage(r),this.emit(s,""),o;const l=a.tokenize(e,t,o);if(s!==0)for(const c of l.tokens)this._tokens.push(new ay(c.offset+s,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new a8(this._tokens,e)}}class GL{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const s=e!==null?e.length:0,r=t.length,o=i!==null?i.length:0;if(s===0&&r===0&&o===0)return new Uint32Array(0);if(s===0&&r===0)return i;if(r===0&&o===0)return e;const a=new Uint32Array(s+r+o);e!==null&&a.set(e);for(let l=0;l<r;l++)a[s+l]=t[l];return i!==null&&a.set(i,s+r),a}nestedLanguageTokenize(e,t,i,s){const r=i.languageId,o=i.state,a=$i.get(r);if(!a)return this.enterLanguage(r),this.emit(s,""),o;const l=a.tokenizeEncoded(e,t,o);if(s!==0)for(let c=0,u=l.tokens.length;c<u;c+=2)l.tokens[c]+=s;return this._prependTokens=GL._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new hT(GL._merge(this._prependTokens,this._tokens,null),e)}}let xy=rF=class extends ae{constructor(e,t,i,s,r){super(),this._configurationService=r,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=s,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._register($i.onDidChange(a=>{if(o)return;let l=!1;for(let c=0,u=a.changedLanguages.length;c<u;c++){const h=a.changedLanguages[c];if(this._embeddedLanguages[h]){l=!0;break}}l&&(o=!0,$i.handleChange([this._languageId]),o=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=$i.get(t);if(i){if(i instanceof rF){const s=i.getLoadStatus();s.loaded===!1&&e.push(s.promise)}continue}$i.isResolved(t)||e.push($i.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Sy.create(null,this._lexer.start);return Zh.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return Vne(this._languageId,i);const s=new w4e,r=this._tokenize(e,t,i,s);return s.finalize(r)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return N8(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const s=new GL(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),r=this._tokenize(e,t,i,s);return s.finalize(r)}_tokenize(e,t,i,s){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,s):this._myTokenize(e,t,i,0,s)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=kx(this._lexer,t.stack.state),!i))throw si(this._lexer,"tokenizer state is not defined: "+t.stack.state);let s=-1,r=!1;for(const o of i){if(!sU(o.action)||o.action.nextEmbedded!=="@pop")continue;r=!0;let a=o.regex;const l=o.regex.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const u=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),u)}const c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(s===-1||c<s)&&(s=c)}if(!r)throw si(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return s}_nestedTokenize(e,t,i,s,r){const o=this._findLeavingNestedLanguageOffset(e,i);if(o===-1){const c=r.nestedLanguageTokenize(e,t,i.embeddedLanguageData,s);return Zh.create(i.stack,new p0(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,o);a.length>0&&r.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,s);const l=e.substring(o);return this._myTokenize(l,t,i,s+o,r)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,s,r){r.enterLanguage(this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,u=i.stack,h=0,d=null,f=!0;for(;f||h<l;){const g=h,p=u.depth,m=d?d.groups.length:0,b=u.state;let v=null,w=null,y=null,x=null,D=null;if(d){v=d.matches;const k=d.groups.shift();w=k.matched,y=k.action,x=d.rule,d.groups.length===0&&(d=null)}else{if(!f&&h>=l)break;f=!1;let k=this._lexer.tokenizer[b];if(!k&&(k=kx(this._lexer,b),!k))throw si(this._lexer,"tokenizer state is not defined: "+b);const I=a.substr(h);for(const N of k)if((h===0||!N.matchOnlyAtLineStart)&&(v=I.match(N.regex),v)){w=v[0],y=N.action;break}}if(v||(v=[""],w=""),y||(h<l&&(v=[a.charAt(h)],w=v[0]),y=this._lexer.defaultToken),w===null)break;for(h+=w.length;p4e(y)&&sU(y)&&y.test;)y=y.test(w,v,b,h===l);let S=null;if(typeof y=="string"||Array.isArray(y))S=y;else if(y.group)S=y.group;else if(y.token!==null&&y.token!==void 0){if(y.tokenSubst?S=Kh(this._lexer,y.token,w,v,b):S=y.token,y.nextEmbedded)if(y.nextEmbedded==="@pop"){if(!c)throw si(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw si(this._lexer,"cannot enter embedded language from within an embedded language");D=Kh(this._lexer,y.nextEmbedded,w,v,b)}if(y.goBack&&(h=Math.max(0,h-y.goBack)),y.switchTo&&typeof y.switchTo=="string"){let k=Kh(this._lexer,y.switchTo,w,v,b);if(k[0]==="@"&&(k=k.substr(1)),kx(this._lexer,k))u=u.switchTo(k);else throw si(this._lexer,"trying to switch to a state '"+k+"' that is undefined in rule: "+this._safeRuleName(x))}else{if(y.transform&&typeof y.transform=="function")throw si(this._lexer,"action.transform not supported");if(y.next)if(y.next==="@push"){if(u.depth>=this._lexer.maxStack)throw si(this._lexer,"maximum tokenizer stack size reached: ["+u.state+","+u.parent.state+",...]");u=u.push(b)}else if(y.next==="@pop"){if(u.depth<=1)throw si(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(x));u=u.pop()}else if(y.next==="@popall")u=u.popall();else{let k=Kh(this._lexer,y.next,w,v,b);if(k[0]==="@"&&(k=k.substr(1)),kx(this._lexer,k))u=u.push(k);else throw si(this._lexer,"trying to set a next state '"+k+"' that is undefined in rule: "+this._safeRuleName(x))}}y.log&&typeof y.log=="string"&&m4e(this._lexer,this._lexer.languageId+": "+Kh(this._lexer,y.log,w,v,b))}if(S===null)throw si(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(x));const T=k=>{const I=this._languageService.getLanguageIdByLanguageName(k)||this._languageService.getLanguageIdByMimeType(k)||k,N=this._getNestedEmbeddedLanguageData(I);if(h<l){const z=e.substr(h);return this._nestedTokenize(z,t,Zh.create(u,N),s+h,r)}else return Zh.create(u,N)};if(Array.isArray(S)){if(d&&d.groups.length>0)throw si(this._lexer,"groups cannot be nested: "+this._safeRuleName(x));if(v.length!==S.length+1)throw si(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(x));let k=0;for(let I=1;I<v.length;I++)k+=v[I].length;if(k!==w.length)throw si(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(x));d={rule:x,matches:v,groups:[]};for(let I=0;I<S.length;I++)d.groups[I]={action:S[I],matched:v[I+1]};h-=w.length;continue}else{if(S==="@rematch"&&(h-=w.length,w="",v=null,S="",D!==null))return T(D);if(w.length===0){if(l===0||p!==u.depth||b!==u.state||(d?d.groups.length:0)!==m)continue;throw si(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(x))}let k=null;if(jne(S)&&S.indexOf("@brackets")===0){const I=S.substr(9),N=y4e(this._lexer,w);if(!N)throw si(this._lexer,"@brackets token returned but no bracket defined as: "+w);k=rU(N.token+I)}else{const I=S===""?"":S+this._lexer.tokenPostfix;k=rU(I)}g<o&&r.emit(g+s,k)}if(D!==null)return T(D)}return Zh.create(u,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new p0(e,yy);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),$i.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=$i.get(e);return t?new p0(e,t.getInitialState()):new p0(e,yy)}};xy=rF=b4e([v4e(4,xi)],xy);function y4e(n,e){if(!e)return null;e=Id(n,e);const t=n.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}var C4e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const YN=rm("standaloneColorizer",{createHTML:n=>n});class P8{static colorizeElement(e,t,i,s){s=s||{};const r=s.theme||"vs",o=s.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(o)||o;e.setTheme(r);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+r;const c=u=>{var h;const d=(h=YN==null?void 0:YN.createHTML(u))!==null&&h!==void 0?h:u;i.innerHTML=d};return this.colorize(t,l||"",a,s).then(c,u=>console.error(u))}static colorize(e,t,i,s){return C4e(this,void 0,void 0,function*(){const r=e.languageIdCodec;let o=4;s&&typeof s.tabSize=="number"&&(o=s.tabSize),p8(t)&&(t=t.substr(1));const a=em(t);if(!e.isRegisteredLanguageId(i))return oU(a,o,r);const l=yield $i.getOrCreate(i);return l?S4e(a,o,l,r):oU(a,o,r)})}static colorizeLine(e,t,i,s,r=4){const o=wo.isBasicASCII(e,t),a=wo.containsRTL(e,o,i);return FT(new Zb(!1,!0,e,!1,o,a,0,s,[],r,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const s=e.getLineContent(t);e.tokenization.forceTokenization(t);const o=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(s,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function S4e(n,e,t,i){return new Promise((s,r)=>{const o=()=>{const a=x4e(n,e,t,i);if(t instanceof xy){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,r);return}}s(a)};o()})}function oU(n,e,t){let i=[];const r=new Uint32Array(2);r[0]=0,r[1]=33587200;for(let o=0,a=n.length;o<a;o++){const l=n[o];r[0]=l.length;const c=new An(r,l,t),u=wo.isBasicASCII(l,!0),h=wo.containsRTL(l,u,!0),d=FT(new Zb(!1,!0,l,!1,u,h,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(d.html),i.push("<br/>")}return i.join("")}function x4e(n,e,t,i){let s=[],r=t.getInitialState();for(let o=0,a=n.length;o<a;o++){const l=n[o],c=t.tokenizeEncoded(l,!0,r);An.convertToEndOffset(c.tokens,l.length);const u=new An(c.tokens,l,i),h=wo.isBasicASCII(l,!0),d=wo.containsRTL(l,h,!0),f=FT(new Zb(!1,!0,l,!1,h,d,0,u.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));s=s.concat(f.html),s.push("<br/>"),r=c.endState}return s.join("")}const aU=2e4;let ig,ek,oF,tk,aF;function k4e(n){ig=document.createElement("div"),ig.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),ig.appendChild(i),i};ek=e(),oF=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),ig.appendChild(i),i};tk=t(),aF=t(),n.appendChild(ig)}function _S(n){ig&&(ek.textContent!==n?(vo(oF),KL(ek,n)):(vo(ek),KL(oF,n)))}function ky(n){ig&&(tk.textContent!==n?(vo(aF),KL(tk,n)):(vo(tk),KL(aF,n)))}function KL(n,e){vo(n),e.length>aU&&(e=e.substr(0,aU)),n.textContent=e,n.style.visibility="hidden",n.style.visibility="visible"}const O8=kt("markerDecorationsService");var L4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},D4e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let Ly=class{constructor(e,t){}dispose(){}};Ly.ID="editor.contrib.markerDecorations";Ly=L4e([D4e(1,O8)],Ly);Va(Ly.ID,Ly,0);class Gne extends ae{constructor(e,t){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,s=!1;const r=()=>{if(i&&!s)try{i=!1,s=!0,t()}finally{requestAnimationFrame(()=>{s=!1,r()})}};this._resizeObserver=new ResizeObserver(o=>{e=o&&o[0]&&o[0].contentRect?o[0].contentRect:null,i=!0,r()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,s=0;t?(i=t.width,s=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,s=this._referenceDomElement.clientHeight),i=Math.max(5,i),s=Math.max(5,s),(this._width!==i||this._height!==s)&&(this._width=i,this._height=s,e&&this._onDidChange.fire())}}class Nd{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=Nd._read(e,this.key),i=r=>Nd._read(e,r),s=(r,o)=>Nd._write(e,r,o);this.migrate(t,i,s)}static _read(e,t){if(typeof e>"u")return;const i=t.indexOf(".");if(i>=0){const s=t.substring(0,i);return this._read(e[s],t.substring(i+1))}return e[t]}static _write(e,t,i){const s=t.indexOf(".");if(s>=0){const r=t.substring(0,s);e[r]=e[r]||{},this._write(e[r],t.substring(s+1),i);return}e[t]=i}}Nd.items=[];function kf(n,e){Nd.items.push(new Nd(n,e))}function qo(n,e){kf(n,(t,i,s)=>{if(typeof t<"u"){for(const[r,o]of e)if(t===r){s(n,o);return}}})}function E4e(n){Nd.items.forEach(e=>e.apply(n))}qo("wordWrap",[[!0,"on"],[!1,"off"]]);qo("lineNumbers",[[!0,"on"],[!1,"off"]]);qo("cursorBlinking",[["visible","solid"]]);qo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);qo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);qo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);qo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);qo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);qo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);qo("autoIndent",[[!1,"advanced"],[!0,"full"]]);qo("matchBrackets",[[!0,"always"],[!1,"never"]]);qo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);qo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);kf("autoClosingBrackets",(n,e,t)=>{n===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});kf("renderIndentGuides",(n,e,t)=>{typeof n<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!n))});kf("highlightActiveIndentGuide",(n,e,t)=>{typeof n<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!n))});const T4e={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};kf("suggest.filteredTypes",(n,e,t)=>{if(n&&typeof n=="object"){for(const i of Object.entries(T4e))n[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});kf("quickSuggestions",(n,e,t)=>{if(typeof n=="boolean"){const i=n?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});kf("experimental.stickyScroll.enabled",(n,e,t)=>{typeof n=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",n))});kf("experimental.stickyScroll.maxLineCount",(n,e,t)=>{typeof n=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",n))});class A4e{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new G,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const ZL=new A4e,Lf=kt("accessibilityService"),I4e=new Fe("accessibilityModeEnabled",!1);var N4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},R4e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let lF=class extends ae{constructor(e,t,i,s){super(),this._accessibilityService=s,this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new G),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new mie,this.isSimpleWidget=e,this._containerObserver=this._register(new Gne(i,t.dimension)),this._rawOptions=lU(t),this._validatedOptions=Yh.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Gh.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(ZL.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(O3.onDidChange(()=>this._recomputeOptions())),this._register(PL.onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Yh.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=Hg.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),s={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:ZL.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Yh.computeOptions(this._validatedOptions,s)}_readEnvConfiguration(){return{extraEditorClassName:F4e(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:zg||Ra,pixelRatio:PL.value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return O3.readFontInfo(e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=lU(e);Yh.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Yh.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=M4e(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};lF=N4e([R4e(3,Lf)],lF);function M4e(n){let e=0;for(;n;)n=Math.floor(n/10),e++;return e||1}function F4e(){let n="";return!ih&&!Bie&&(n+="no-user-select "),ih&&(n+="no-minimap-shadow ",n+="enable-user-select "),Mt&&(n+="mac "),n}class P4e{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class O4e{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Yh{static validateOptions(e){const t=new P4e;for(const i of c0){const s=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(s))}return t}static computeOptions(e,t){const i=new O4e;for(const s of c0)i._write(s.id,s.compute(t,i,e._read(s.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?yn(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Yh._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let s=!1;for(const r of c0){const o=!Yh._deepEquals(e._read(r.id),t._read(r.id));i[r.id]=o,o&&(s=!0)}return s?new pie(i):null}static applyUpdate(e,t){let i=!1;for(const s of c0)if(t.hasOwnProperty(s.name)){const r=s.applyUpdate(e[s.name],t[s.name]);e[s.name]=r.newValue,i=i||r.didChange}return i}}function lU(n){const e=bu(n);return E4e(e),e}function ji(n,e,t){let i=null,s=null;if(typeof t.value=="function"?(i="value",s=t.value,s.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",s=t.get),!s)throw new Error("not supported");const r=`$memoize$${e}`;t[i]=function(...o){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:s.apply(this,o)}),this[r]}}var B4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Jt;(function(n){n.Tap="-monaco-gesturetap",n.Change="-monaco-gesturechange",n.Start="-monaco-gesturestart",n.End="-monaco-gesturesend",n.Contextmenu="-monaco-gesturecontextmenu"})(Jt||(Jt={}));class Zt extends ae{constructor(){super(),this.dispatched=!1,this.targets=new hr,this.ignoreTargets=new hr,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(oe(document,"touchstart",e=>this.onTouchStart(e),{passive:!1})),this._register(oe(document,"touchend",e=>this.onTouchEnd(e))),this._register(oe(document,"touchmove",e=>this.onTouchMove(e),{passive:!1}))}static addTarget(e){if(!Zt.isTouchDevice())return ae.None;Zt.INSTANCE||(Zt.INSTANCE=new Zt);const t=Zt.INSTANCE.targets.push(e);return ut(t)}static ignoreTarget(e){if(!Zt.isTouchDevice())return ae.None;Zt.INSTANCE||(Zt.INSTANCE=new Zt);const t=Zt.INSTANCE.ignoreTargets.push(e);return ut(t)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,s=e.targetTouches.length;i<s;i++){const r=e.targetTouches.item(i);this.activeTouches[r.identifier]={id:r.identifier,initialTarget:r.target,initialTimeStamp:t,initialPageX:r.pageX,initialPageY:r.pageY,rollingTimestamps:[t],rollingPageX:[r.pageX],rollingPageY:[r.pageY]};const o=this.newGestureEvent(Jt.Start,r.target);o.pageX=r.pageX,o.pageY=r.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){const t=Date.now(),i=Object.keys(this.activeTouches).length;for(let s=0,r=e.changedTouches.length;s<r;s++){const o=e.changedTouches.item(s);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("move of an UNKNOWN touch",o);continue}const a=this.activeTouches[o.identifier],l=Date.now()-a.initialTimeStamp;if(l<Zt.HOLD_DELAY&&Math.abs(a.initialPageX-So(a.rollingPageX))<30&&Math.abs(a.initialPageY-So(a.rollingPageY))<30){const c=this.newGestureEvent(Jt.Tap,a.initialTarget);c.pageX=So(a.rollingPageX),c.pageY=So(a.rollingPageY),this.dispatchEvent(c)}else if(l>=Zt.HOLD_DELAY&&Math.abs(a.initialPageX-So(a.rollingPageX))<30&&Math.abs(a.initialPageY-So(a.rollingPageY))<30){const c=this.newGestureEvent(Jt.Contextmenu,a.initialTarget);c.pageX=So(a.rollingPageX),c.pageY=So(a.rollingPageY),this.dispatchEvent(c)}else if(i===1){const c=So(a.rollingPageX),u=So(a.rollingPageY),h=So(a.rollingTimestamps)-a.rollingTimestamps[0],d=c-a.rollingPageX[0],f=u-a.rollingPageY[0],g=[...this.targets].filter(p=>a.initialTarget instanceof Node&&p.contains(a.initialTarget));this.inertia(g,t,Math.abs(d)/h,d>0?1:-1,c,Math.abs(f)/h,f>0?1:-1,u)}this.dispatchEvent(this.newGestureEvent(Jt.End,a.initialTarget)),delete this.activeTouches[o.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Jt.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>Zt.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Jt.Change||e.type===Jt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const t of this.ignoreTargets)if(t.contains(e.initialTarget))return;for(const t of this.targets)t.contains(e.initialTarget)&&(t.dispatchEvent(e),this.dispatched=!0)}}inertia(e,t,i,s,r,o,a,l){this.handle=$o(()=>{const c=Date.now(),u=c-t;let h=0,d=0,f=!0;i+=Zt.SCROLL_FRICTION*u,o+=Zt.SCROLL_FRICTION*u,i>0&&(f=!1,h=s*i*u),o>0&&(f=!1,d=a*o*u);const g=this.newGestureEvent(Jt.Change);g.translationX=h,g.translationY=d,e.forEach(p=>p.dispatchEvent(g)),f||this.inertia(e,c,i,s,r+h,o,a,l+d)})}onTouchMove(e){const t=Date.now();for(let i=0,s=e.changedTouches.length;i<s;i++){const r=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("end of an UNKNOWN touch",r);continue}const o=this.activeTouches[r.identifier],a=this.newGestureEvent(Jt.Change,o.initialTarget);a.translationX=r.pageX-So(o.rollingPageX),a.translationY=r.pageY-So(o.rollingPageY),a.pageX=r.pageX,a.pageY=r.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(r.pageX),o.rollingPageY.push(r.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}Zt.SCROLL_FRICTION=-.005;Zt.HOLD_DELAY=700;Zt.CLEAR_TAP_COUNT_TIME=400;B4e([ji],Zt,"isTouchDevice",null);class PT{constructor(){this._hooks=new Ae,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,s,r){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=s,this._onStopCallback=r;let o=e;try{e.setPointerCapture(t),this._hooks.add(ut(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{o=window}this._hooks.add(oe(o,Le.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(oe(o,Le.POINTER_UP,a=>this.stopMonitoring(!0)))}}function B8(n){return`--vscode-${n.replace(/\./g,"-")}`}function Ce(n){return`var(${B8(n)})`}function W4e(n,e){return`var(${B8(n)}, ${e})`}const Kne={ColorContribution:"base.contributions.colors"};class V4e{constructor(){this._onDidChangeSchema=new G,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,s=!1,r){const o={id:e,description:i,defaults:t,needsTransparency:s,deprecationMessage:r};this.colorsById[e]=o;const a={type:"string",description:i,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return r&&(a.deprecationMessage=r),this.colorSchema.properties[e]=a,this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i&&i.defaults){const s=i.defaults[t.type];return Qa(s,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const s=t.indexOf(".")===-1?0:1,r=i.indexOf(".")===-1?0:1;return s!==r?s-r:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const OT=new V4e;Un.add(Kne.ColorContribution,OT);function P(n,e,t,i,s){return OT.registerColor(n,e,t,i,s)}const he=P("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},_("foreground","Overall foreground color. This color is only used if not overridden by a component."));P("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},_("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));const $4e=P("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},_("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));P("descriptionForeground",{light:"#717171",dark:We(he,.7),hcDark:We(he,.7),hcLight:We(he,.7)},_("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const ad=P("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},_("iconForeground","The default color for icons in the workbench.")),uo=P("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},_("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),pt=P("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},_("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),ui=P("contrastActiveBorder",{light:null,dark:null,hcDark:uo,hcLight:uo},_("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));P("selection.background",{light:null,dark:null,hcDark:null,hcLight:null},_("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));P("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:J.black,hcLight:"#292929"},_("textSeparatorForeground","Color for text separators."));const z4e=P("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},_("textLinkForeground","Foreground color for links in text."));P("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},_("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));P("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#D7BA7D",hcLight:"#292929"},_("textPreformatForeground","Foreground color for preformatted text segments."));P("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hcDark:null,hcLight:"#F2F2F2"},_("textBlockQuoteBackground","Background color for block quotes in text."));P("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:J.white,hcLight:"#292929"},_("textBlockQuoteBorder","Border color for block quotes in text."));P("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:J.black,hcLight:"#F2F2F2"},_("textCodeBlockBackground","Background color for code blocks in text."));const Wu=P("widget.shadow",{dark:We(J.black,.36),light:We(J.black,.16),hcDark:null,hcLight:null},_("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),Zne=P("widget.border",{dark:null,light:null,hcDark:pt,hcLight:pt},_("widgetBorder","Border color of widgets such as find/replace inside the editor.")),H4e=P("input.background",{dark:"#3C3C3C",light:J.white,hcDark:J.black,hcLight:J.white},_("inputBoxBackground","Input box background.")),U4e=P("input.foreground",{dark:he,light:he,hcDark:he,hcLight:he},_("inputBoxForeground","Input box foreground.")),j4e=P("input.border",{dark:null,light:null,hcDark:pt,hcLight:pt},_("inputBoxBorder","Input box border.")),W8=P("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:pt,hcLight:pt},_("inputBoxActiveOptionBorder","Border color of activated options in input fields."));P("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},_("inputOption.hoverBackground","Background color of activated options in input fields."));const Eg=P("inputOption.activeBackground",{dark:We(uo,.4),light:We(uo,.2),hcDark:J.transparent,hcLight:J.transparent},_("inputOption.activeBackground","Background hover color of options in input fields.")),V8=P("inputOption.activeForeground",{dark:J.white,light:J.black,hcDark:he,hcLight:he},_("inputOption.activeForeground","Foreground color of activated options in input fields."));P("input.placeholderForeground",{light:We(he,.5),dark:We(he,.5),hcDark:We(he,.7),hcLight:We(he,.7)},_("inputPlaceholderForeground","Input box foreground color for placeholder text."));const q4e=P("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:J.black,hcLight:J.white},_("inputValidationInfoBackground","Input validation background color for information severity.")),G4e=P("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:he},_("inputValidationInfoForeground","Input validation foreground color for information severity.")),K4e=P("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:pt,hcLight:pt},_("inputValidationInfoBorder","Input validation border color for information severity.")),Z4e=P("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:J.black,hcLight:J.white},_("inputValidationWarningBackground","Input validation background color for warning severity.")),Y4e=P("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:he},_("inputValidationWarningForeground","Input validation foreground color for warning severity.")),X4e=P("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:pt,hcLight:pt},_("inputValidationWarningBorder","Input validation border color for warning severity.")),Q4e=P("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:J.black,hcLight:J.white},_("inputValidationErrorBackground","Input validation background color for error severity.")),J4e=P("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:he},_("inputValidationErrorForeground","Input validation foreground color for error severity.")),e3e=P("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:pt,hcLight:pt},_("inputValidationErrorBorder","Input validation border color for error severity.")),pc=P("dropdown.background",{dark:"#3C3C3C",light:J.white,hcDark:J.black,hcLight:J.white},_("dropdownBackground","Dropdown background.")),t3e=P("dropdown.listBackground",{dark:null,light:null,hcDark:J.black,hcLight:J.white},_("dropdownListBackground","Dropdown list background.")),Vu=P("dropdown.foreground",{dark:"#F0F0F0",light:he,hcDark:J.white,hcLight:he},_("dropdownForeground","Dropdown foreground.")),m0=P("dropdown.border",{dark:pc,light:"#CECECE",hcDark:pt,hcLight:pt},_("dropdownBorder","Dropdown border.")),sv=P("button.foreground",{dark:J.white,light:J.white,hcDark:J.white,hcLight:J.white},_("buttonForeground","Button foreground color.")),i3e=P("button.separator",{dark:We(sv,.4),light:We(sv,.4),hcDark:We(sv,.4),hcLight:We(sv,.4)},_("buttonSeparator","Button separator color.")),rv=P("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},_("buttonBackground","Button background color.")),n3e=P("button.hoverBackground",{dark:ml(rv,.2),light:am(rv,.2),hcDark:rv,hcLight:rv},_("buttonHoverBackground","Button background color when hovering.")),s3e=P("button.border",{dark:pt,light:pt,hcDark:pt,hcLight:pt},_("buttonBorder","Button border color.")),r3e=P("button.secondaryForeground",{dark:J.white,light:J.white,hcDark:J.white,hcLight:he},_("buttonSecondaryForeground","Secondary button foreground color.")),cF=P("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:J.white},_("buttonSecondaryBackground","Secondary button background color.")),o3e=P("button.secondaryHoverBackground",{dark:ml(cF,.2),light:am(cF,.2),hcDark:null,hcLight:null},_("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),ik=P("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:J.black,hcLight:"#0F4A85"},_("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),a3e=P("badge.foreground",{dark:J.white,light:"#333",hcDark:J.white,hcLight:J.white},_("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),l3e=P("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},_("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),ov=P("scrollbarSlider.background",{dark:J.fromHex("#797979").transparent(.4),light:J.fromHex("#646464").transparent(.4),hcDark:We(pt,.6),hcLight:We(pt,.4)},_("scrollbarSliderBackground","Scrollbar slider background color.")),av=P("scrollbarSlider.hoverBackground",{dark:J.fromHex("#646464").transparent(.7),light:J.fromHex("#646464").transparent(.7),hcDark:We(pt,.8),hcLight:We(pt,.8)},_("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),lv=P("scrollbarSlider.activeBackground",{dark:J.fromHex("#BFBFBF").transparent(.4),light:J.fromHex("#000000").transparent(.6),hcDark:pt,hcLight:pt},_("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),c3e=P("progressBar.background",{dark:J.fromHex("#0E70C0"),light:J.fromHex("#0E70C0"),hcDark:pt,hcLight:pt},_("progressBarBackground","Background color of the progress bar that can show for long running operations."));P("editorError.background",{dark:null,light:null,hcDark:null,hcLight:null},_("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const mc=P("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},_("editorError.foreground","Foreground color of error squigglies in the editor.")),u3e=P("editorError.border",{dark:null,light:null,hcDark:J.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},_("errorBorder","If set, color of double underlines for errors in the editor."));P("editorWarning.background",{dark:null,light:null,hcDark:null,hcLight:null},_("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const ho=P("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},_("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),Dy=P("editorWarning.border",{dark:null,light:null,hcDark:J.fromHex("#FFCC00").transparent(.8),hcLight:J.fromHex("#FFCC00").transparent(.8)},_("warningBorder","If set, color of double underlines for warnings in the editor."));P("editorInfo.background",{dark:null,light:null,hcDark:null,hcLight:null},_("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const dr=P("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},_("editorInfo.foreground","Foreground color of info squigglies in the editor.")),Ey=P("editorInfo.border",{dark:null,light:null,hcDark:J.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},_("infoBorder","If set, color of double underlines for infos in the editor.")),h3e=P("editorHint.foreground",{dark:J.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},_("editorHint.foreground","Foreground color of hint squigglies in the editor."));P("editorHint.border",{dark:null,light:null,hcDark:J.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},_("hintBorder","If set, color of double underlines for hints in the editor."));P("sash.hoverBorder",{dark:uo,light:uo,hcDark:uo,hcLight:uo},_("sashActiveBorder","Border color of active sashes."));const vn=P("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:J.black,hcLight:J.white},_("editorBackground","Editor background color.")),Df=P("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:J.white,hcLight:he},_("editorForeground","Editor default foreground color."));P("editorStickyScroll.background",{light:vn,dark:vn,hcDark:vn,hcLight:vn},_("editorStickyScrollBackground","Sticky scroll background color for the editor"));P("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:J.fromHex("#0F4A85").transparent(.1)},_("editorStickyScrollHoverBackground","Sticky scroll on hover background color for the editor"));const gn=P("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:J.white},_("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),_c=P("editorWidget.foreground",{dark:he,light:he,hcDark:he,hcLight:he},_("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),_0=P("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:pt,hcLight:pt},_("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),d3e=P("editorWidget.resizeBorder",{light:null,dark:null,hcDark:null,hcLight:null},_("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),cU=P("quickInput.background",{dark:gn,light:gn,hcDark:gn,hcLight:gn},_("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),f3e=P("quickInput.foreground",{dark:_c,light:_c,hcDark:_c,hcLight:_c},_("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),g3e=P("quickInputTitle.background",{dark:new J(new Tt(255,255,255,.105)),light:new J(new Tt(0,0,0,.06)),hcDark:"#000000",hcLight:J.white},_("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),Yne=P("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:J.white,hcLight:"#0F4A85"},_("pickerGroupForeground","Quick picker color for grouping labels.")),p3e=P("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:J.white,hcLight:"#0F4A85"},_("pickerGroupBorder","Quick picker color for grouping borders.")),m3e=P("keybindingLabel.background",{dark:new J(new Tt(128,128,128,.17)),light:new J(new Tt(221,221,221,.4)),hcDark:J.transparent,hcLight:J.transparent},_("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),_3e=P("keybindingLabel.foreground",{dark:J.fromHex("#CCCCCC"),light:J.fromHex("#555555"),hcDark:J.white,hcLight:he},_("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),b3e=P("keybindingLabel.border",{dark:new J(new Tt(51,51,51,.6)),light:new J(new Tt(204,204,204,.4)),hcDark:new J(new Tt(111,195,223)),hcLight:pt},_("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),v3e=P("keybindingLabel.bottomBorder",{dark:new J(new Tt(68,68,68,.6)),light:new J(new Tt(187,187,187,.4)),hcDark:new J(new Tt(111,195,223)),hcLight:he},_("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),ld=P("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},_("editorSelectionBackground","Color of the editor selection.")),w3e=P("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:J.white},_("editorSelectionForeground","Color of the selected text for high contrast.")),Xne=P("editor.inactiveSelectionBackground",{light:We(ld,.5),dark:We(ld,.5),hcDark:We(ld,.7),hcLight:We(ld,.5)},_("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),$8=P("editor.selectionHighlightBackground",{light:_U(ld,vn,.3,.6),dark:_U(ld,vn,.3,.6),hcDark:null,hcLight:null},_("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);P("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:ui,hcLight:ui},_("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));const y3e=P("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},_("editorFindMatch","Color of the current search match.")),bc=P("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},_("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),C3e=P("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},_("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),S3e=P("editor.findMatchBorder",{light:null,dark:null,hcDark:ui,hcLight:ui},_("editorFindMatchBorder","Border color of the current search match.")),cd=P("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:ui,hcLight:ui},_("findMatchHighlightBorder","Border color of the other search matches.")),x3e=P("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:We(ui,.4),hcLight:We(ui,.4)},_("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);P("searchEditor.findMatchBackground",{light:We(bc,.66),dark:We(bc,.66),hcDark:bc,hcLight:bc},_("searchEditor.queryMatch","Color of the Search Editor query matches."));P("searchEditor.findMatchBorder",{light:We(cd,.66),dark:We(cd,.66),hcDark:cd,hcLight:cd},_("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));P("search.resultsInfoForeground",{light:he,dark:We(he,.65),hcDark:he,hcLight:he},_("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));P("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},_("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const uU=P("editorHoverWidget.background",{light:gn,dark:gn,hcDark:gn,hcLight:gn},_("hoverBackground","Background color of the editor hover."));P("editorHoverWidget.foreground",{light:_c,dark:_c,hcDark:_c,hcLight:_c},_("hoverForeground","Foreground color of the editor hover."));const k3e=P("editorHoverWidget.border",{light:_0,dark:_0,hcDark:_0,hcLight:_0},_("hoverBorder","Border color of the editor hover."));P("editorHoverWidget.statusBarBackground",{dark:ml(uU,.2),light:am(uU,.05),hcDark:gn,hcLight:gn},_("statusBarBackground","Background color of the editor hover status bar."));P("editorLink.activeForeground",{dark:"#4E94CE",light:J.blue,hcDark:J.cyan,hcLight:"#292929"},_("activeLinkForeground","Color of active links."));const ud=P("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:J.white,hcLight:J.black},_("editorInlayHintForeground","Foreground color of inline hints")),hd=P("editorInlayHint.background",{dark:We(ik,.1),light:We(ik,.1),hcDark:We(J.white,.1),hcLight:We(ik,.1)},_("editorInlayHintBackground","Background color of inline hints"));P("editorInlayHint.typeForeground",{dark:ud,light:ud,hcDark:ud,hcLight:ud},_("editorInlayHintForegroundTypes","Foreground color of inline hints for types"));P("editorInlayHint.typeBackground",{dark:hd,light:hd,hcDark:hd,hcLight:hd},_("editorInlayHintBackgroundTypes","Background color of inline hints for types"));P("editorInlayHint.parameterForeground",{dark:ud,light:ud,hcDark:ud,hcLight:ud},_("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters"));P("editorInlayHint.parameterBackground",{dark:hd,light:hd,hcDark:hd,hcLight:hd},_("editorInlayHintBackgroundParameter","Background color of inline hints for parameters"));P("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},_("editorLightBulbForeground","The color used for the lightbulb actions icon."));P("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));const uF=new J(new Tt(155,185,85,.2)),hF=new J(new Tt(255,0,0,.2)),L3e=P("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},_("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),D3e=P("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},_("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);P("diffEditor.insertedLineBackground",{dark:uF,light:uF,hcDark:null,hcLight:null},_("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);P("diffEditor.removedLineBackground",{dark:hF,light:hF,hcDark:null,hcLight:null},_("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);P("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));P("diffEditorGutter.removedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const E3e=P("diffEditorOverview.insertedForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),T3e=P("diffEditorOverview.removedForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));P("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},_("diffEditorInsertedOutline","Outline color for the text that got inserted."));P("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},_("diffEditorRemovedOutline","Outline color for text that got removed."));P("diffEditor.border",{dark:null,light:null,hcDark:pt,hcLight:pt},_("diffEditorBorder","Border color between the two text editors."));P("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},_("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));P("diffEditor.unchangedRegionBackground",{dark:"#3e3e3e",light:"#e4e4e4",hcDark:null,hcLight:null},_("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));P("diffEditor.unchangedRegionForeground",{dark:"#a3a2a2",light:"#4d4c4c",hcDark:null,hcLight:null},_("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));P("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},_("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const A3e=P("list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),I3e=P("list.focusForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),N3e=P("list.focusOutline",{dark:uo,light:uo,hcDark:ui,hcLight:ui},_("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),R3e=P("list.focusAndSelectionOutline",{dark:null,light:null,hcDark:null,hcLight:null},_("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),$u=P("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:J.fromHex("#0F4A85").transparent(.1)},_("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),vc=P("list.activeSelectionForeground",{dark:J.white,light:J.white,hcDark:null,hcLight:null},_("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),cv=P("list.activeSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),M3e=P("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:J.fromHex("#0F4A85").transparent(.1)},_("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),F3e=P("list.inactiveSelectionForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),P3e=P("list.inactiveSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),O3e=P("list.inactiveFocusBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),B3e=P("list.inactiveFocusOutline",{dark:null,light:null,hcDark:null,hcLight:null},_("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Qne=P("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:J.white.transparent(.1),hcLight:J.fromHex("#0F4A85").transparent(.1)},_("listHoverBackground","List/Tree background when hovering over items using the mouse.")),Jne=P("list.hoverForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),W3e=P("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},_("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),Lx=P("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:uo,hcLight:uo},_("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree."));P("list.focusHighlightForeground",{dark:Lx,light:pFe($u,Lx,"#BBE7FF"),hcDark:Lx,hcLight:Lx},_("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));P("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},_("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));P("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},_("listErrorForeground","Foreground color of list items containing errors."));P("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},_("listWarningForeground","Foreground color of list items containing warnings."));const V3e=P("listFilterWidget.background",{light:am(gn,0),dark:ml(gn,0),hcDark:gn,hcLight:gn},_("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),$3e=P("listFilterWidget.outline",{dark:J.transparent,light:J.transparent,hcDark:"#f38518",hcLight:"#007ACC"},_("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),z3e=P("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:pt,hcLight:pt},_("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),H3e=P("listFilterWidget.shadow",{dark:Wu,light:Wu,hcDark:Wu,hcLight:Wu},_("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));P("list.filterMatchBackground",{dark:bc,light:bc,hcDark:null,hcLight:null},_("listFilterMatchHighlight","Background color of the filtered match."));P("list.filterMatchBorder",{dark:cd,light:cd,hcDark:pt,hcLight:ui},_("listFilterMatchHighlightBorder","Border color of the filtered match."));const uv=P("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},_("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),U3e=P("tree.inactiveIndentGuidesStroke",{dark:We(uv,.4),light:We(uv,.4),hcDark:We(uv,.4),hcLight:We(uv,.4)},_("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),j3e=P("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},_("tableColumnsBorder","Table border color between columns.")),q3e=P("tree.tableOddRowsBackground",{dark:We(he,.04),light:We(he,.04),hcDark:null,hcLight:null},_("tableOddRowsBackgroundColor","Background color for odd table rows."));P("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},_("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized. "));const G3e=P("checkbox.background",{dark:pc,light:pc,hcDark:pc,hcLight:pc},_("checkbox.background","Background color of checkbox widget."));P("checkbox.selectBackground",{dark:gn,light:gn,hcDark:gn,hcLight:gn},_("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const K3e=P("checkbox.foreground",{dark:Vu,light:Vu,hcDark:Vu,hcLight:Vu},_("checkbox.foreground","Foreground color of checkbox widget.")),Z3e=P("checkbox.border",{dark:m0,light:m0,hcDark:m0,hcLight:m0},_("checkbox.border","Border color of checkbox widget."));P("checkbox.selectBorder",{dark:ad,light:ad,hcDark:ad,hcLight:ad},_("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const hU=P("quickInput.list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},"",void 0,_("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),dF=P("quickInputList.focusForeground",{dark:vc,light:vc,hcDark:vc,hcLight:vc},_("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),ese=P("quickInputList.focusIconForeground",{dark:cv,light:cv,hcDark:cv,hcLight:cv},_("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),fF=P("quickInputList.focusBackground",{dark:Ty(hU,$u),light:Ty(hU,$u),hcDark:null,hcLight:null},_("quickInput.listFocusBackground","Quick picker background color for the focused item.")),Y3e=P("menu.border",{dark:null,light:null,hcDark:pt,hcLight:pt},_("menuBorder","Border color of menus.")),X3e=P("menu.foreground",{dark:Vu,light:Vu,hcDark:Vu,hcLight:Vu},_("menuForeground","Foreground color of menu items.")),Q3e=P("menu.background",{dark:pc,light:pc,hcDark:pc,hcLight:pc},_("menuBackground","Background color of menu items.")),J3e=P("menu.selectionForeground",{dark:vc,light:vc,hcDark:vc,hcLight:vc},_("menuSelectionForeground","Foreground color of the selected menu item in menus.")),eFe=P("menu.selectionBackground",{dark:$u,light:$u,hcDark:$u,hcLight:$u},_("menuSelectionBackground","Background color of the selected menu item in menus.")),tFe=P("menu.selectionBorder",{dark:null,light:null,hcDark:ui,hcLight:ui},_("menuSelectionBorder","Border color of the selected menu item in menus.")),iFe=P("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:pt,hcLight:pt},_("menuSeparatorBackground","Color of a separator menu item in menus.")),gF=P("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},_("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));P("toolbar.hoverOutline",{dark:null,light:null,hcDark:ui,hcLight:ui},_("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));P("toolbar.activeBackground",{dark:ml(gF,.1),light:am(gF,.1),hcDark:null,hcLight:null},_("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));P("editor.snippetTabstopHighlightBackground",{dark:new J(new Tt(124,124,124,.3)),light:new J(new Tt(10,50,100,.2)),hcDark:new J(new Tt(124,124,124,.3)),hcLight:new J(new Tt(10,50,100,.2))},_("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));P("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hcDark:null,hcLight:null},_("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));P("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));P("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new J(new Tt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},_("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const nFe=P("breadcrumb.foreground",{light:We(he,.8),dark:We(he,.8),hcDark:We(he,.8),hcLight:We(he,.8)},_("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),sFe=P("breadcrumb.background",{light:vn,dark:vn,hcDark:vn,hcLight:vn},_("breadcrumbsBackground","Background color of breadcrumb items.")),dU=P("breadcrumb.focusForeground",{light:am(he,.2),dark:ml(he,.1),hcDark:ml(he,.1),hcLight:ml(he,.1)},_("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),rFe=P("breadcrumb.activeSelectionForeground",{light:am(he,.2),dark:ml(he,.1),hcDark:ml(he,.1),hcLight:ml(he,.1)},_("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));P("breadcrumbPicker.background",{light:gn,dark:gn,hcDark:gn,hcLight:gn},_("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const tse=.5,fU=J.fromHex("#40C8AE").transparent(tse),gU=J.fromHex("#40A6FF").transparent(tse),pU=J.fromHex("#606060").transparent(.4),wa=.4,rb=1,b0=P("merge.currentHeaderBackground",{dark:fU,light:fU,hcDark:null,hcLight:null},_("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);P("merge.currentContentBackground",{dark:We(b0,wa),light:We(b0,wa),hcDark:We(b0,wa),hcLight:We(b0,wa)},_("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const v0=P("merge.incomingHeaderBackground",{dark:gU,light:gU,hcDark:null,hcLight:null},_("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);P("merge.incomingContentBackground",{dark:We(v0,wa),light:We(v0,wa),hcDark:We(v0,wa),hcLight:We(v0,wa)},_("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const w0=P("merge.commonHeaderBackground",{dark:pU,light:pU,hcDark:null,hcLight:null},_("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);P("merge.commonContentBackground",{dark:We(w0,wa),light:We(w0,wa),hcDark:We(w0,wa),hcLight:We(w0,wa)},_("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const ob=P("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},_("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));P("editorOverviewRuler.currentContentForeground",{dark:We(b0,rb),light:We(b0,rb),hcDark:ob,hcLight:ob},_("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));P("editorOverviewRuler.incomingContentForeground",{dark:We(v0,rb),light:We(v0,rb),hcDark:ob,hcLight:ob},_("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));P("editorOverviewRuler.commonContentForeground",{dark:We(w0,rb),light:We(w0,rb),hcDark:ob,hcLight:ob},_("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const z8=P("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:""},_("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),hv=P("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},_("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),y0=P("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},_("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),BT=P("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},_("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),mU=P("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},_("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),oFe=P("minimap.infoHighlight",{dark:dr,light:dr,hcDark:Ey,hcLight:Ey},_("minimapInfo","Minimap marker color for infos.")),aFe=P("minimap.warningHighlight",{dark:ho,light:ho,hcDark:Dy,hcLight:Dy},_("overviewRuleWarning","Minimap marker color for warnings.")),lFe=P("minimap.errorHighlight",{dark:new J(new Tt(255,18,18,.7)),light:new J(new Tt(255,18,18,.7)),hcDark:new J(new Tt(255,50,50,1)),hcLight:"#B5200D"},_("minimapError","Minimap marker color for errors.")),cFe=P("minimap.background",{dark:null,light:null,hcDark:null,hcLight:null},_("minimapBackground","Minimap background color.")),uFe=P("minimap.foregroundOpacity",{dark:J.fromHex("#000f"),light:J.fromHex("#000f"),hcDark:J.fromHex("#000f"),hcLight:J.fromHex("#000f")},_("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));P("minimapSlider.background",{light:We(ov,.5),dark:We(ov,.5),hcDark:We(ov,.5),hcLight:We(ov,.5)},_("minimapSliderBackground","Minimap slider background color."));P("minimapSlider.hoverBackground",{light:We(av,.5),dark:We(av,.5),hcDark:We(av,.5),hcLight:We(av,.5)},_("minimapSliderHoverBackground","Minimap slider background color when hovering."));P("minimapSlider.activeBackground",{light:We(lv,.5),dark:We(lv,.5),hcDark:We(lv,.5),hcLight:We(lv,.5)},_("minimapSliderActiveBackground","Minimap slider background color when clicked on."));const hFe=P("problemsErrorIcon.foreground",{dark:mc,light:mc,hcDark:mc,hcLight:mc},_("problemsErrorIconForeground","The color used for the problems error icon.")),dFe=P("problemsWarningIcon.foreground",{dark:ho,light:ho,hcDark:ho,hcLight:ho},_("problemsWarningIconForeground","The color used for the problems warning icon.")),fFe=P("problemsInfoIcon.foreground",{dark:dr,light:dr,hcDark:dr,hcLight:dr},_("problemsInfoIconForeground","The color used for the problems info icon."));P("charts.foreground",{dark:he,light:he,hcDark:he,hcLight:he},_("chartsForeground","The foreground color used in charts."));P("charts.lines",{dark:We(he,.5),light:We(he,.5),hcDark:We(he,.5),hcLight:We(he,.5)},_("chartsLines","The color used for horizontal lines in charts."));P("charts.red",{dark:mc,light:mc,hcDark:mc,hcLight:mc},_("chartsRed","The red color used in chart visualizations."));P("charts.blue",{dark:dr,light:dr,hcDark:dr,hcLight:dr},_("chartsBlue","The blue color used in chart visualizations."));P("charts.yellow",{dark:ho,light:ho,hcDark:ho,hcLight:ho},_("chartsYellow","The yellow color used in chart visualizations."));P("charts.orange",{dark:y0,light:y0,hcDark:y0,hcLight:y0},_("chartsOrange","The orange color used in chart visualizations."));P("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},_("chartsGreen","The green color used in chart visualizations."));P("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_("chartsPurple","The purple color used in chart visualizations."));function gFe(n,e){var t,i,s,r;switch(n.op){case 0:return(t=Qa(n.value,e))===null||t===void 0?void 0:t.darken(n.factor);case 1:return(i=Qa(n.value,e))===null||i===void 0?void 0:i.lighten(n.factor);case 2:return(s=Qa(n.value,e))===null||s===void 0?void 0:s.transparent(n.factor);case 3:{const o=Qa(n.background,e);return o?(r=Qa(n.value,e))===null||r===void 0?void 0:r.makeOpaque(o):Qa(n.value,e)}case 4:for(const o of n.values){const a=Qa(o,e);if(a)return a}return;case 6:return Qa(e.defines(n.if)?n.then:n.else,e);case 5:{const o=Qa(n.value,e);if(!o)return;const a=Qa(n.background,e);return a?o.isDarkerThan(a)?J.getLighterColor(o,a,n.factor).transparent(n.transparency):J.getDarkerColor(o,a,n.factor).transparent(n.transparency):o.transparent(n.factor*n.transparency)}default:throw v8()}}function am(n,e){return{op:0,value:n,factor:e}}function ml(n,e){return{op:1,value:n,factor:e}}function We(n,e){return{op:2,value:n,factor:e}}function Ty(...n){return{op:4,values:n}}function pFe(n,e,t){return{op:6,if:n,then:e,else:t}}function _U(n,e,t,i){return{op:5,value:n,background:e,factor:t,transparency:i}}function Qa(n,e){if(n!==null){if(typeof n=="string")return n[0]==="#"?J.fromHex(n):e.getColor(n);if(n instanceof J)return n;if(typeof n=="object")return gFe(n,e)}}const ise="vscode://schemas/workbench-colors",nse=Un.as(IT.JSONContribution);nse.registerSchema(ise,OT.getColorSchema());const bU=new Ui(()=>nse.notifySchemaChanged(ise),200);OT.onDidChangeSchema(()=>{bU.isScheduled()||bU.schedule()});class WT{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new sse(this.x-window.scrollX,this.y-window.scrollY)}}class sse{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new WT(this.clientX+window.scrollX,this.clientY+window.scrollY)}}class mFe{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s,this._editorPagePositionBrand=void 0}}class _Fe{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function H8(n){const e=hs(n);return new mFe(e.left,e.top,e.width,e.height)}function U8(n,e,t){const i=e.width/n.offsetWidth,s=e.height/n.offsetHeight,r=(t.x-e.x)/i,o=(t.y-e.y)/s;return new _Fe(r,o)}class rf extends ba{constructor(e,t,i){super(e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new WT(this.posx,this.posy),this.editorPos=H8(i),this.relativePos=U8(i,this.editorPos,this.pos)}}class bFe{constructor(e){this._editorViewDomNode=e}_create(e){return new rf(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return oe(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return oe(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return oe(e,Le.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return oe(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return oe(e,Le.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return oe(e,"mousemove",i=>t(this._create(i)))}}class vFe{constructor(e){this._editorViewDomNode=e}_create(e){return new rf(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return oe(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return oe(e,Le.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return oe(e,Le.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return oe(e,"pointermove",i=>t(this._create(i)))}}class wFe extends ae{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new PT),this._keydownListener=null}startMonitoring(e,t,i,s,r){this._keydownListener=pn(e.ownerDocument,"keydown",o=>{o.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,o.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,o=>{s(new rf(o,!0,this._editorViewDomNode))},o=>{this._keydownListener.dispose(),r(o)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class bS extends ae{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,s=e.length;i<s;i++){const r=e[i];switch(r.type){case 0:this.onCompositionStart(r)&&(t=!0);break;case 1:this.onCompositionEnd(r)&&(t=!0);break;case 2:this.onConfigurationChanged(r)&&(t=!0);break;case 3:this.onCursorStateChanged(r)&&(t=!0);break;case 4:this.onDecorationsChanged(r)&&(t=!0);break;case 5:this.onFlushed(r)&&(t=!0);break;case 6:this.onFocusChanged(r)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(r)&&(t=!0);break;case 8:this.onLineMappingChanged(r)&&(t=!0);break;case 9:this.onLinesChanged(r)&&(t=!0);break;case 10:this.onLinesDeleted(r)&&(t=!0);break;case 11:this.onLinesInserted(r)&&(t=!0);break;case 12:this.onRevealRangeRequest(r)&&(t=!0);break;case 13:this.onScrollChanged(r)&&(t=!0);break;case 15:this.onTokensChanged(r)&&(t=!0);break;case 14:this.onThemeChanged(r)&&(t=!0);break;case 16:this.onTokensColorsChanged(r)&&(t=!0);break;case 17:this.onZonesChanged(r)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(r)}}t&&(this._shouldRender=!0)}}class jr extends bS{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Nc{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let s=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[s++]=this.read(e)),e=e.parentElement;const r=new Uint8Array(s);for(let o=0;o<s;o++)r[o]=i[s-o-1];return r}}class yFe{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class CFe extends yFe{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class SFe{constructor(e,t,i,s){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=s}}class VT{static from(e){const t=new Array(e.length);for(let i=0,s=e.length;i<s;i++){const r=e[i];t[i]=new VT(r.left,r.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class qg{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class xFe{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class vU{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class nk{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,s,r){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(i,s),o.getClientRects()}catch{return null}finally{this._detachRange(o,r)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(qg.compare);const t=[];let i=0,s=e[0];for(let r=1,o=e.length;r<o;r++){const a=e[r];s.left+s.width+.9>=a.left?s.width=Math.max(s.width,a.left+a.width-s.left):(t[i++]=s,s=a)}return t[i++]=s,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const s=[];for(let r=0,o=e.length;r<o;r++){const a=e[r];s[r]=new qg(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(s)}static readHorizontalRanges(e,t,i,s,r,o){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),s=Math.min(l,Math.max(0,s)),t===s&&i===r&&i===0&&!e.children[t].firstChild){const d=e.children[t].getClientRects();return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(d,o.clientRectDeltaLeft,o.clientRectScale)}t!==s&&s>0&&r===0&&(s--,r=1073741824);let c=e.children[t].firstChild,u=e.children[s].firstChild;if((!c||!u)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!u&&r===0&&s>0&&(u=e.children[s-1].firstChild,r=1073741824)),!c||!u)return null;i=Math.min(c.textContent.length,Math.max(0,i)),r=Math.min(u.textContent.length,Math.max(0,r));const h=this._readClientRects(c,i,u,r,o.endNode);return o.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,o.clientRectDeltaLeft,o.clientRectScale)}}var Fo;(function(n){n.DARK="dark",n.LIGHT="light",n.HIGH_CONTRAST_DARK="hcDark",n.HIGH_CONTRAST_LIGHT="hcLight"})(Fo||(Fo={}));function Gu(n){return n===Fo.HIGH_CONTRAST_DARK||n===Fo.HIGH_CONTRAST_LIGHT}function $T(n){return n===Fo.DARK||n===Fo.HIGH_CONTRAST_DARK}const kFe=function(){return j0?!0:!(Ts||Ra||ih)}();let t_=!0;class wU{constructor(e,t){this.themeType=t;const i=e.options,s=i.get(50);i.get(38)==="off"?this.renderWhitespace=i.get(98):this.renderWhitespace="none",this.renderControlCharacters=i.get(93),this.spaceWidth=s.spaceWidth,this.middotWidth=s.middotWidth,this.wsmiddotWidth=s.wsmiddotWidth,this.useMonospaceOptimizations=s.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=s.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(66),this.stopRenderingLineAfter=i.get(116),this.fontLigatures=i.get(51)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class ac{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=Bt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return Gu(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,s){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const r=i.getViewLineRenderingData(e),o=this._options,a=va.filter(r.inlineDecorations,e,r.minColumn,r.maxColumn);let l=null;if(Gu(o.themeType)||this._options.renderWhitespace==="selection"){const d=i.selections;for(const f of d){if(f.endLineNumber<e||f.startLineNumber>e)continue;const g=f.startLineNumber===e?f.startColumn:r.minColumn,p=f.endLineNumber===e?f.endColumn:r.maxColumn;g<p&&(Gu(o.themeType)&&a.push(new va(g,p,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(l||(l=[]),l.push(new $ne(g-1,p-1))))}}const c=new Zb(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,a,r.tabSize,r.startVisibleColumn,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==Eo.OFF,l);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;s.appendString('<div style="top:'),s.appendString(String(t)),s.appendString("px;height:"),s.appendString(String(this._options.lineHeight)),s.appendString('px;" class="'),s.appendString(ac.CLASS_NAME),s.appendString('">');const u=M8(c,s);s.appendString("</div>");let h=null;return t_&&kFe&&r.isBasicASCII&&o.useMonospaceOptimizations&&u.containsForeignElements===0&&(h=new Dx(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping)),h||(h=ose(this._renderedViewLine?this._renderedViewLine.domNode:null,c,u.characterMapping,u.containsRTL,u.containsForeignElements)),this._renderedViewLine=h,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof Dx:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof Dx?this._renderedViewLine.monospaceAssumptionsAreValid():t_}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof Dx&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,s){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const r=this._renderedViewLine.input.stopRenderingLineAfter;if(r!==-1&&t>r+1&&i>r+1)return new vU(!0,[new qg(this.getWidth(s),0)]);r!==-1&&t>r+1&&(t=r+1),r!==-1&&i>r+1&&(i=r+1);const o=this._renderedViewLine.getVisibleRangesForRange(e,t,i,s);return o&&o.length>0?new vU(!1,o):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}}ac.CLASS_NAME="view-line";class Dx{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const s=Math.floor(t.lineContent.length/300);if(s>0){this._keyColumnPixelOffsetCache=new Float32Array(s);for(let r=0;r<s;r++)this._keyColumnPixelOffsetCache[r]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return t_;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),t_=!1)}return t_}toSlowRenderedLine(){return ose(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,s){const r=this._getColumnPixelOffset(e,t,s),o=this._getColumnPixelOffset(e,i,s);return[new qg(r,o-r)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const s=Math.floor((t-1)/300)-1,r=(s+1)*300+1;let o=-1;if(this._keyColumnPixelOffsetCache&&(o=this._keyColumnPixelOffsetCache[s],o===-1&&(o=this._actualReadPixelOffset(e,r,i),this._keyColumnPixelOffsetCache[s]=o)),o===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(r),l=this._characterMapping.getHorizontalOffset(t);return o+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const s=this._characterMapping.getDomPosition(t),r=nk.readHorizontalRanges(this._getReadingTarget(this.domNode),s.partIndex,s.charIndex,s.partIndex,s.charIndex,i);return!r||r.length===0?-1:r[0].left}getColumnOfNodeOffset(e,t){return ase(this._characterMapping,e,t)}}class rse{constructor(e,t,i,s,r){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=r,this._cachedWidth=-1,this._pixelOffsetCache=null,!s||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let o=0,a=this._characterMapping.length;o<=a;o++)this._pixelOffsetCache[o]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,s){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const r=this._readPixelOffset(this.domNode,e,t,s);if(r===-1)return null;const o=this._readPixelOffset(this.domNode,e,i,s);return o===-1?null:[new qg(r,o-r)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,s)}_readVisibleRangesForRange(e,t,i,s,r){if(i===s){const o=this._readPixelOffset(e,t,i,r);return o===-1?null:[new qg(o,0)]}else return this._readRawVisibleRangesForRange(e,i,s,r)}_readPixelOffset(e,t,i,s){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(s);const r=this._getReadingTarget(e);return r.firstChild?(s.markDidDomLayout(),r.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const r=this._pixelOffsetCache[i];if(r!==-1)return r;const o=this._actualReadPixelOffset(e,t,i,s);return this._pixelOffsetCache[i]=o,o}return this._actualReadPixelOffset(e,t,i,s)}_actualReadPixelOffset(e,t,i,s){if(this._characterMapping.length===0){const l=nk.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,s);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(s);const r=this._characterMapping.getDomPosition(i),o=nk.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,r.partIndex,r.charIndex,s);if(!o||o.length===0)return-1;const a=o[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,s){if(t===1&&i===this._characterMapping.length)return[new qg(0,this.getWidth(s))];const r=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(i);return nk.readHorizontalRanges(this._getReadingTarget(e),r.partIndex,r.charIndex,o.partIndex,o.charIndex,s)}getColumnOfNodeOffset(e,t){return ase(this._characterMapping,e,t)}}class LFe extends rse{_readVisibleRangesForRange(e,t,i,s,r){const o=super._readVisibleRangesForRange(e,t,i,s,r);if(!o||o.length===0||i===s||i===1&&s===this._characterMapping.length)return o;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,s,r);if(a!==-1){const l=o[o.length-1];l.left<a&&(l.width=a-l.left)}}return o}}const ose=function(){return zg?DFe:EFe}();function DFe(n,e,t,i,s){return new LFe(n,e,t,i,s)}function EFe(n,e,t,i,s){return new rse(n,e,t,i,s)}function ase(n,e,t){const i=e.textContent.length;let s=-1;for(;e;)e=e.previousSibling,s++;return n.getColumn(new zne(s,t),i)}class _n{static _nextVisibleColumn(e,t,i){return e===9?_n.nextRenderTabStop(t,i):Jd(e)||g8(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const s=Math.min(t-1,e.length),r=e.substring(0,s),o=new FL(r);let a=0;for(;!o.eol();){const l=ML(r,s,o.offset);o.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const s=e.length,r=new FL(e);let o=0,a=1;for(;!r.eol();){const l=ML(e,s,r.offset);r.nextGraphemeLength();const c=this._nextVisibleColumn(l,o,i),u=r.offset+1;if(c>=t){const h=t-o;return c-t<h?u:a}o=c,a=u}return s+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}class Ay{static whitespaceVisibleColumn(e,t,i){const s=e.length;let r=0,o=-1,a=-1;for(let l=0;l<s;l++){if(l===t)return[o,a,r];switch(r%i===0&&(o=l,a=r),e.charCodeAt(l)){case 32:r+=1;break;case 9:r=_n.nextRenderTabStop(r,i);break;default:return[-1,-1,-1]}}return t===s?[o,a,r]:[-1,-1,-1]}static atomicPosition(e,t,i,s){const r=e.length,[o,a,l]=Ay.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(s){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(o===-1)return-1;let d=a;for(let f=o;f<r;++f){if(d===a+i)return o;switch(e.charCodeAt(f)){case 32:d+=1;break;case 9:d=_n.nextRenderTabStop(d,i);break;default:return-1}}return d===a+i?o:-1}const u=_n.nextRenderTabStop(l,i);let h=l;for(let d=t;d<r;d++){if(h===u)return d;switch(e.charCodeAt(d)){case 32:h+=1;break;case 9:h=_n.nextRenderTabStop(h,i);break;default:return-1}}return h===u?r:-1}}class Mh{constructor(e=null){this.hitTarget=e,this.type=0}}class lse{constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var ng;(function(n){function e(t,i,s){const r=t.getPositionFromDOMInfo(i,s);return r?new lse(r,i,null):new Mh(i)}n.createFromDOMInfo=e})(ng||(ng={}));class TFe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class ks{static _deduceRage(e,t=null){return!t&&e?new H(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,s,r,o){return{type:e,element:t,mouseColumn:i,position:s,range:r,detail:o}}static createViewZone(e,t,i,s,r){return{type:e,element:t,mouseColumn:i,position:s,range:this._deduceRage(s),detail:r}}static createContentText(e,t,i,s,r){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,s),detail:r}}static createContentEmpty(e,t,i,s){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:s}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,s){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:s}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class Kr{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===6}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===7}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===7}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===5}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===8}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}}class ab{constructor(e,t,i){this.viewModel=e.viewModel;const s=e.configuration.options;this.layoutInfo=s.get(143),this.viewDomNode=t.viewDomNode,this.lineHeight=s.get(66),this.stickyTabStops=s.get(115),this.typicalHalfwidthCharacterWidth=s.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return ab.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const s=i.verticalOffset+i.height/2,r=e.viewModel.getLineCount();let o=null,a,l=null;return i.afterLineNumber!==r&&(l=new X(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new X(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=o:o===null?a=l:t<s?a=o:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const s=this._context.viewModel.getLineCount(),r=this._context.viewModel.getLineMaxColumn(s);return{range:new H(s,r,s,r),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new H(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return ab._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class AFe{constructor(e,t,i,s){this.editorPos=t,this.pos=i,this.relativePos=s,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Gn._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class j8 extends AFe{constructor(e,t,i,s,r){super(e,t,i,s),this._ctx=e,r?(this.target=r,this.targetPath=Nc.collect(r,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?_n.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return ks.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return ks.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,s){return ks.createMargin(e,this.target,this._getMouseColumn(t),t,i,s)}fulfillViewZone(e,t,i){return ks.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return ks.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return ks.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return ks.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return ks.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return ks.createOverlayWidget(this.target,this._getMouseColumn(),e)}withTarget(e){return new j8(this._ctx,this.editorPos,this.pos,this.relativePos,e)}}const yU={isAfterLines:!0};function XN(n){return{isAfterLines:!1,horizontalDistanceToText:n}}class Gn{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=Nc.collect(t,this._viewHelper.viewDomNode);return!!(Kr.isChildOfContentWidgets(i)||Kr.isChildOfOverflowingContentWidgets(i)||Kr.isChildOfOverlayWidgets(i))}createMouseTarget(e,t,i,s,r){const o=new ab(this._context,this._viewHelper,e),a=new j8(o,t,i,s,r);try{const l=Gn._createMouseTarget(o,a,!1);if(l.type===6&&o.stickyTabStops&&l.position!==null){const c=Gn._snapToSoftTabBoundary(l.position,o.viewModel),u=H.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,u,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t,i){if(t.target===null){if(i)return t.fulfillUnknown();const o=Gn._doHitTest(e,t);return o.type===1?Gn.createMouseTargetFromHitTestPosition(e,t,o.spanNode,o.position,o.injectedText):this._createMouseTarget(e,t.withTarget(o.hitTarget),!0)}const s=t;let r=null;return!Kr.isChildOfOverflowGuard(t.targetPath)&&!Kr.isChildOfOverflowingContentWidgets(t.targetPath)&&(r=r||t.fulfillUnknown()),r=r||Gn._hitTestContentWidget(e,s),r=r||Gn._hitTestOverlayWidget(e,s),r=r||Gn._hitTestMinimap(e,s),r=r||Gn._hitTestScrollbarSlider(e,s),r=r||Gn._hitTestViewZone(e,s),r=r||Gn._hitTestMargin(e,s),r=r||Gn._hitTestViewCursor(e,s),r=r||Gn._hitTestTextArea(e,s),r=r||Gn._hitTestViewLines(e,s,i),r=r||Gn._hitTestScrollbar(e,s),r||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(Kr.isChildOfContentWidgets(t.targetPath)||Kr.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(Kr.isChildOfOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const s of i)if(t.target===s.domNode)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,s=t.mouseContentHorizontalOffset,r=t.mouseVerticalOffset;for(const o of i){if(s<o.contentLeft||s>o.contentLeft+o.width)continue;const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(a<=r&&r<=a+o.height)return t.fulfillContentText(o.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const s=t.isInContentArea?8:5;return t.fulfillViewZone(s,i.position,i)}return null}static _hitTestTextArea(e,t){return Kr.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),s=i.range.getStartPosition();let r=Math.abs(t.relativePos.x);const o={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:r};return r-=e.layoutInfo.glyphMarginLeft,r<=e.layoutInfo.glyphMarginWidth?t.fulfillMargin(2,s,i.range,o):(r-=e.layoutInfo.glyphMarginWidth,r<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,s,i.range,o):(r-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,s,i.range,o)))}return null}static _hitTestViewLines(e,t,i){if(!Kr.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new X(1,1),yU);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const r=e.viewModel.getLineCount(),o=e.viewModel.getLineMaxColumn(r);return t.fulfillContentEmpty(new X(r,o),yU)}if(i){if(Kr.isStrictChildOfViewLines(t.targetPath)){const r=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(r)===0){const a=e.getLineWidth(r),l=XN(t.mouseContentHorizontalOffset-a);return t.fulfillContentEmpty(new X(r,1),l)}const o=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>=o){const a=XN(t.mouseContentHorizontalOffset-o),l=new X(r,e.viewModel.getLineMaxColumn(r));return t.fulfillContentEmpty(l,a)}}return t.fulfillUnknown()}const s=Gn._doHitTest(e,t);return s.type===1?Gn.createMouseTargetFromHitTestPosition(e,t,s.spanNode,s.position,s.injectedText):this._createMouseTarget(e,t.withTarget(s.hitTarget),!0)}static _hitTestMinimap(e,t){if(Kr.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new X(i,s))}return null}static _hitTestScrollbarSlider(e,t){if(Kr.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const s=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.viewModel.getLineMaxColumn(s);return t.fulfillScrollbar(new X(s,r))}}return null}static _hitTestScrollbar(e,t){if(Kr.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new X(i,s))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(143),s=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Gn._getMouseColumn(s,t.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,s,r){const o=s.lineNumber,a=s.column,l=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>l){const b=XN(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(s,b)}const c=e.visibleRangeForPosition(o,a);if(!c)return t.fulfillUnknown(s);const u=c.left;if(Math.abs(t.mouseContentHorizontalOffset-u)<1)return t.fulfillContentText(s,null,{mightBeForeignElement:!!r,injectedText:r});const h=[];if(h.push({offset:c.left,column:a}),a>1){const b=e.visibleRangeForPosition(o,a-1);b&&h.push({offset:b.left,column:a-1})}const d=e.viewModel.getLineMaxColumn(o);if(a<d){const b=e.visibleRangeForPosition(o,a+1);b&&h.push({offset:b.left,column:a+1})}h.sort((b,v)=>b.offset-v.offset);const f=t.pos.toClientCoordinates(),g=i.getBoundingClientRect(),p=g.left<=f.clientX&&f.clientX<=g.right;let m=null;for(let b=1;b<h.length;b++){const v=h[b-1],w=h[b];if(v.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=w.offset){m=new H(o,v.column,o,w.column);const y=Math.abs(v.offset-t.mouseContentHorizontalOffset),x=Math.abs(w.offset-t.mouseContentHorizontalOffset);s=y<x?new X(o,v.column):new X(o,w.column);break}}return t.fulfillContentText(s,m,{mightBeForeignElement:!p||!!r,injectedText:r})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.getVerticalOffsetForLineNumber(i),r=s+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>r)){const a=Math.floor((s+r)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new WT(t.pos.x,l),u=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates());if(u.type===1)return u}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=J_(e.viewDomNode);let s;if(i?typeof i.caretRangeFromPoint>"u"?s=IFe(i,t.clientX,t.clientY):s=i.caretRangeFromPoint(t.clientX,t.clientY):s=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!s||!s.startContainer)return new Mh;const r=s.startContainer;if(r.nodeType===r.TEXT_NODE){const o=r.parentNode,a=o?o.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===ac.CLASS_NAME?ng.createFromDOMInfo(e,o,s.startOffset):new Mh(r.parentNode)}else if(r.nodeType===r.ELEMENT_NODE){const o=r.parentNode,a=o?o.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===ac.CLASS_NAME?ng.createFromDOMInfo(e,r,r.textContent.length):new Mh(r)}return new Mh}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const s=i.offsetNode.parentNode,r=s?s.parentNode:null,o=r?r.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===ac.CLASS_NAME?ng.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new Mh(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const s=i.offsetNode.parentNode,r=s&&s.nodeType===s.ELEMENT_NODE?s.className:null,o=s?s.parentNode:null,a=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(r===ac.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return ng.createFromDOMInfo(e,l,0)}else if(a===ac.CLASS_NAME)return ng.createFromDOMInfo(e,i.offsetNode,0)}return new Mh(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:s}=t.model.getOptions(),r=Ay.atomicPosition(i,e.column-1,s,2);return r!==-1?new X(e.lineNumber,r+1):e}static _doHitTest(e,t){let i=new Mh;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates())),i.type===1){const s=e.viewModel.getInjectedTextAt(i.position),r=e.viewModel.normalizePosition(i.position,2);(s||!r.equals(i.position))&&(i=new lse(r,i.spanNode,s))}return i}}function IFe(n,e,t){const i=document.createRange();let s=n.elementFromPoint(e,t);if(s!==null){for(;s&&s.firstChild&&s.firstChild.nodeType!==s.firstChild.TEXT_NODE&&s.lastChild&&s.lastChild.firstChild;)s=s.lastChild;const r=s.getBoundingClientRect(),o=window.getComputedStyle(s,null).getPropertyValue("font-style"),a=window.getComputedStyle(s,null).getPropertyValue("font-variant"),l=window.getComputedStyle(s,null).getPropertyValue("font-weight"),c=window.getComputedStyle(s,null).getPropertyValue("font-size"),u=window.getComputedStyle(s,null).getPropertyValue("line-height"),h=window.getComputedStyle(s,null).getPropertyValue("font-family"),d=`${o} ${a} ${l} ${c}/${u} ${h}`,f=s.innerText;let g=r.left,p=0,m;if(e>r.left+r.width)p=f.length;else{const b=Tg.getInstance();for(let v=0;v<f.length+1;v++){if(m=b.getCharWidth(f.charAt(v),d)/2,g+=m,e<g){p=v;break}g+=m}}i.setStart(s.firstChild,p),i.setEnd(s.firstChild,p)}return i}class Tg{static getInstance(){return Tg._INSTANCE||(Tg._INSTANCE=new Tg),Tg._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const s=this._canvas.getContext("2d");s.font=t;const o=s.measureText(e).width;return this._cache[i]=o,o}}Tg._INSTANCE=null;let Nl=class extends ae{onclick(e,t){this._register(oe(e,Le.CLICK,i=>t(new ba(i))))}onmousedown(e,t){this._register(oe(e,Le.MOUSE_DOWN,i=>t(new ba(i))))}onmouseover(e,t){this._register(oe(e,Le.MOUSE_OVER,i=>t(new ba(i))))}onmouseleave(e,t){this._register(oe(e,Le.MOUSE_LEAVE,i=>t(new ba(i))))}onkeydown(e,t){this._register(oe(e,Le.KEY_DOWN,i=>t(new ri(i))))}onkeyup(e,t){this._register(oe(e,Le.KEY_UP,i=>t(new ri(i))))}oninput(e,t){this._register(oe(e,Le.INPUT,t))}onblur(e,t){this._register(oe(e,Le.BLUR,t))}onfocus(e,t){this._register(oe(e,Le.FOCUS,t))}ignoreGesture(e){return Zt.ignoreTarget(e)}};const lb=11;class NFe extends Nl{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Ye.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=lb+"px",this.domNode.style.height=lb+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new PT),this._register(pn(this.bgDomNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(pn(this.domNode,Le.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new gS),this._pointerdownScheduleRepeatTimer=this._register(new uh)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24)};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class RFe extends ae{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new uh)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)===null||e===void 0||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)===null||t===void 0||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const MFe=140;class cse extends Nl{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new RFe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new PT),this._shouldRender=!0,this.domNode=Bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(oe(this.domNode.domNode,Le.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new NFe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,s){this.slider=Bt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof s=="number"&&this.slider.setHeight(s),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(oe(this.slider.domNode,Le.POINTER_DOWN,r=>{r.button===0&&(r.preventDefault(),this._sliderPointerDown(r))})),this.onclick(this.slider.domNode,r=>{r.leftButton&&r.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),s=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),r=this._sliderPointerPosition(e);i<=r&&r<=s?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const r=hs(this.domNode.domNode);t=e.pageX-r.left,i=e.pageY-r.top}const s=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(s):this._scrollbarState.getDesiredScrollPositionFromOffset(s)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),s=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{const o=this._sliderOrthogonalPointerPosition(r),a=Math.abs(o-i);if(br&&a>MFe){this._setDesiredScrollPositionNow(s.getScrollPosition());return}const c=this._sliderPointerPosition(r)-t;this._setDesiredScrollPositionNow(s.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const FFe=20;class cb{constructor(e,t,i,s,r,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=s,this._scrollSize=r,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new cb(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,s,r){const o=Math.max(0,i-e),a=Math.max(0,o-2*t),l=s>0&&s>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(FFe,Math.floor(i*a/s))),u=(a-c)/(s-i),h=r*u;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:u,computedSliderPosition:Math.round(h)}}_refreshComputedValues(){const e=cb._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class PFe extends cse{constructor(e,t,i){const s=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new cb(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,s.width,s.scrollWidth,r.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const o=(t.arrowSize-lb)/2,a=(t.horizontalScrollbarSize-lb)/2;this._createArrow({className:"scra",icon:we.scrollbarButtonLeft,top:a,left:o,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new kp(null,1,0))}),this._createArrow({className:"scra",icon:we.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:o,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new kp(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class OFe extends cse{constructor(e,t,i){const s=e.getScrollDimensions(),r=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new cb(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,s.height,s.scrollHeight,r.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const o=(t.arrowSize-lb)/2,a=(t.verticalScrollbarSize-lb)/2;this._createArrow({className:"scra",icon:we.scrollbarButtonUp,top:o,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new kp(null,0,1))}),this._createArrow({className:"scra",icon:we.scrollbarButtonDown,top:void 0,left:a,bottom:o,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new kp(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class YL{constructor(e,t,i,s,r,o,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,s=s|0,r=r|0,o=o|0,a=a|0),this.rawScrollLeft=s,this.rawScrollTop=a,t<0&&(t=0),s+t>i&&(s=i-t),s<0&&(s=0),r<0&&(r=0),a+r>o&&(a=o-r),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=s,this.height=r,this.scrollHeight=o,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new YL(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new YL(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,s=this.scrollWidth!==e.scrollWidth,r=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:s,scrollLeftChanged:r,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}}class vS extends ae{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new G),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new YL(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var i;const s=this._state.withScrollDimensions(e,t);this._setState(s,!!this._smoothScrolling),(i=this._smoothScrolling)===null||i===void 0||i.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let s;t?s=new Iy(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):s=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=s}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=Iy.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class CU{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function QN(n,e){const t=e-n;return function(i){return n+t*VFe(i)}}function BFe(n,e,t){return function(i){return i<t?n(i/t):e((i-t)/(1-t))}}class Iy{constructor(e,t,i,s){this.from=e,this.to=t,this.duration=s,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let r,o;return e<t?(r=e+.75*i,o=t-.75*i):(r=e-.75*i,o=t+.75*i),BFe(QN(e,r),QN(o,t),.33)}return QN(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),s=this.scrollTop(t);return new CU(i,s,!1)}return new CU(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return Iy.start(e,t,i)}static start(e,t,i){i=i+10;const s=Date.now()-10;return new Iy(e,t,s,i)}}function WFe(n){return Math.pow(n,3)}function VFe(n){return 1-WFe(1-n)}const $Fe=500,SU=50;class zFe{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class XL{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,s=this._rear;do{const r=s===this._front?e:Math.pow(2,-i);if(e-=r,t+=this._memory[s].score*r,s===this._front)break;s=(this._capacity+s-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){const t=window.devicePixelRatio/cIe();br||Ts?this.accept(Date.now(),e.deltaX/t,e.deltaY/t):this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){const s=new zFe(e,t,i);s.score=this._computeScore(s),this._front===-1&&this._rear===-1?(this._memory[0]=s,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=s)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let t=.5;return this._front===-1&&this._rear===-1||this._memory[this._rear],(!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(t+=.25),Math.min(Math.max(t,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}XL.INSTANCE=new XL;class q8 extends Nl{get options(){return this._options}constructor(e,t,i){super(),this._onScroll=this._register(new G),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new G),e.style.overflow="hidden",this._options=HFe(t),this._scrollable=i,this._register(this._scrollable.onScroll(r=>{this._onWillScroll.fire(r),this._onDidScroll(r),this._onScroll.fire(r)}));const s={onMouseWheel:r=>this._onMouseWheel(r),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new OFe(this._scrollable,this._options,s)),this._horizontalScrollbar=this._register(new PFe(this._scrollable,this._options,s)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Bt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Bt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Bt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,r=>this._onMouseOver(r)),this.onmouseleave(this._listenOnDomNode,r=>this._onMouseLeave(r)),this._hideTimeout=this._register(new uh),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=ti(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Mt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new kp(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=ti(this._mouseWheelToDispose),e)){const i=s=>{this._onMouseWheel(new kp(s))};this._mouseWheelToDispose.push(oe(this._listenOnDomNode,Le.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var t;if(!((t=e.browserEvent)===null||t===void 0)&&t.defaultPrevented)return;const i=XL.INSTANCE;i.acceptStandardWheelEvent(e);let s=!1;if(e.deltaY||e.deltaX){let o=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+o===0?a=o=0:Math.abs(o)>=Math.abs(a)?a=0:o=0),this._options.flipAxes&&([o,a]=[a,o]);const l=!Mt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=o,o=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,o=o*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let u={};if(o){const h=SU*o,d=c.scrollTop-(h<0?Math.floor(h):Math.ceil(h));this._verticalScrollbar.writeScrollPosition(u,d)}if(a){const h=SU*a,d=c.scrollLeft-(h<0?Math.floor(h):Math.ceil(h));this._horizontalScrollbar.writeScrollPosition(u,d)}u=this._scrollable.validateScrollPosition(u),(c.scrollLeft!==u.scrollLeft||c.scrollTop!==u.scrollTop)&&(this._options.mouseWheelSmoothScroll&&i.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(u):this._scrollable.setScrollPositionNow(u),s=!0)}let r=s;!r&&this._options.alwaysConsumeMouseWheel&&(r=!0),!r&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(r=!0),r&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,s=i?" left":"",r=t?" top":"",o=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${s}`),this._topShadowDomNode.setClassName(`shadow${r}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${r}${s}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),$Fe)}}class use extends q8{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new vS({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:s=>$o(s)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class G8 extends q8{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class K8 extends q8{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new vS({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:s=>$o(s)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(s=>{s.scrollTopChanged&&(this._element.scrollTop=s.scrollTop),s.scrollLeftChanged&&(this._element.scrollLeft=s.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function HFe(n){const e={lazyRender:typeof n.lazyRender<"u"?n.lazyRender:!1,className:typeof n.className<"u"?n.className:"",useShadows:typeof n.useShadows<"u"?n.useShadows:!0,handleMouseWheel:typeof n.handleMouseWheel<"u"?n.handleMouseWheel:!0,flipAxes:typeof n.flipAxes<"u"?n.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof n.consumeMouseWheelIfScrollbarIsNeeded<"u"?n.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof n.alwaysConsumeMouseWheel<"u"?n.alwaysConsumeMouseWheel:!1,scrollYToX:typeof n.scrollYToX<"u"?n.scrollYToX:!1,mouseWheelScrollSensitivity:typeof n.mouseWheelScrollSensitivity<"u"?n.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof n.fastScrollSensitivity<"u"?n.fastScrollSensitivity:5,scrollPredominantAxis:typeof n.scrollPredominantAxis<"u"?n.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof n.mouseWheelSmoothScroll<"u"?n.mouseWheelSmoothScroll:!0,arrowSize:typeof n.arrowSize<"u"?n.arrowSize:11,listenOnDomNode:typeof n.listenOnDomNode<"u"?n.listenOnDomNode:null,horizontal:typeof n.horizontal<"u"?n.horizontal:1,horizontalScrollbarSize:typeof n.horizontalScrollbarSize<"u"?n.horizontalScrollbarSize:10,horizontalSliderSize:typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:0,horizontalHasArrows:typeof n.horizontalHasArrows<"u"?n.horizontalHasArrows:!1,vertical:typeof n.vertical<"u"?n.vertical:1,verticalScrollbarSize:typeof n.verticalScrollbarSize<"u"?n.verticalScrollbarSize:10,verticalHasArrows:typeof n.verticalHasArrows<"u"?n.verticalHasArrows:!1,verticalSliderSize:typeof n.verticalSliderSize<"u"?n.verticalSliderSize:0,scrollByPage:typeof n.scrollByPage<"u"?n.scrollByPage:!1};return e.horizontalSliderSize=typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof n.verticalSliderSize<"u"?n.verticalSliderSize:e.verticalScrollbarSize,Mt&&(e.className+=" mac"),e}class Z8 extends bS{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Gn(this._context,i),this._mouseDownOperation=this._register(new UFe(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(o,a)=>this._createMouseTarget(o,a),o=>this._getMouseColumn(o))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(143).height;const s=new bFe(this.viewHelper.viewDomNode);this._register(s.onContextMenu(this.viewHelper.viewDomNode,o=>this._onContextMenu(o,!0))),this._register(s.onMouseMove(this.viewHelper.viewDomNode,o=>{this._onMouseMove(o),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=oe(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new rf(a,!1,this.viewHelper.viewDomNode))}))})),this._register(s.onMouseUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(s.onMouseLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o)));let r=0;this._register(s.onPointerDown(this.viewHelper.viewDomNode,(o,a)=>{r=a})),this._register(oe(this.viewHelper.viewDomNode,Le.POINTER_UP,o=>{this._mouseDownOperation.onPointerUp()})),this._register(s.onMouseDown(this.viewHelper.viewDomNode,o=>this._onMouseDown(o,r))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=XL.INSTANCE;let t=0,i=Gh.getZoomLevel(),s=!1,r=0;const o=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(75))return;const c=new kp(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const u=Gh.getZoomLevel(),h=c.deltaY>0?1:-1;Gh.setZoomLevel(u+h),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=Gh.getZoomLevel(),s=a(l),r=0),t=Date.now(),r+=c.deltaY,s&&(Gh.setZoomLevel(i+r/5),c.preventDefault(),c.stopPropagation())};this._register(oe(this.viewHelper.viewDomNode,Le.MOUSE_WHEEL,o,{capture:!0,passive:!1}));function a(l){return Mt?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(143)){const t=this._context.configuration.options.get(143).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const s=new sse(e,t).toPageCoordinates(),r=H8(this.viewHelper.viewDomNode);if(s.y<r.y||s.y>r.y+r.height||s.x<r.x||s.x>r.x+r.width)return null;const o=U8(this.viewHelper.viewDomNode,r,s);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),r,s,o,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const s=J_(this.viewHelper.viewDomNode);s&&(i=s.elementsFromPoint(e.posx,e.posy).find(r=>this.viewHelper.viewDomNode.contains(r)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),s=i.type===6||i.type===7,r=i.type===2||i.type===3||i.type===4,o=i.type===3,a=this._context.configuration.options.get(108),l=i.type===8||i.type===5,c=i.type===9;let u=e.leftButton||e.middleButton;Mt&&e.leftButton&&e.ctrlKey&&(u=!1);const h=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(u&&(s||o&&a))h(),this._mouseDownOperation.start(i.type,e,t);else if(r)e.preventDefault();else if(l){const d=i.detail;u&&this.viewHelper.shouldSuppressMouseDownOnViewZone(d.viewZoneId)&&(h(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(h(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class UFe extends ae{constructor(e,t,i,s,r,o){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=s,this._createMouseTarget=r,this._getMouseColumn=o,this._mouseMoveMonitor=this._register(new wFe(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new jFe(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new zT,this._currentSelection=new Lt(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13&&(t.outsidePosition==="above"||t.outsidePosition==="below")?this._topBottomDragScrolling.start(t,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const s=this._findMousePosition(t,!0);if(!s||!s.position)return;this._mouseState.trySetCount(t.detail,s.position),t.detail=this._mouseState.count;const r=this._context.configuration.options;if(!r.get(90)&&r.get(35)&&!r.get(22)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&s.type===6&&s.position&&this._currentSelection.containsPosition(s.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),o=>{const a=this._findMousePosition(this._lastMouseEvent,!1);o&&o instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(s,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,o=>this._onMouseDownThenMove(o),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,s=this._context.viewLayout,r=this._getMouseColumn(e);if(e.posy<t.y){const a=t.y-e.posy,l=Math.max(s.getCurrentScrollTop()-a,0),c=ab.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return ks.createOutsideEditor(r,h,"above",a)}const u=s.getLineNumberAtVerticalOffset(l);return ks.createOutsideEditor(r,new X(u,1),"above",a)}if(e.posy>t.y+t.height){const a=e.posy-t.y-t.height,l=s.getCurrentScrollTop()+e.relativePos.y,c=ab.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return ks.createOutsideEditor(r,h,"below",a)}const u=s.getLineNumberAtVerticalOffset(l);return ks.createOutsideEditor(r,new X(u,i.getLineMaxColumn(u)),"below",a)}const o=s.getLineNumberAtVerticalOffset(s.getCurrentScrollTop()+e.relativePos.y);if(e.posx<t.x){const a=t.x-e.posx;return ks.createOutsideEditor(r,new X(o,1),"left",a)}if(e.posx>t.x+t.width){const a=e.posx-t.x-t.width;return ks.createOutsideEditor(r,new X(o,i.getLineMaxColumn(o)),"right",a)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const s=this._createMouseTarget(e,t);if(!s.position)return null;if(s.type===8||s.type===5){const o=this._helpPositionJumpOverViewZone(s.detail);if(o)return ks.createViewZone(s.type,s.element,s.mouseColumn,o,s.detail)}return s}_helpPositionJumpOverViewZone(e){const t=new X(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,s=e.positionAfter;return i&&s?i.isBefore(t)?i:s:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}class jFe extends ae{constructor(e,t,i,s){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=s,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=new qFe(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class qFe extends ae{constructor(e,t,i,s,r,o){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=s,this._position=r,this._mouseEvent=o,this._lastTime=Date.now(),this._animationFrameDisposable=$o(()=>this._execute())}dispose(){this._animationFrameDisposable.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}_getScrollSpeed(){const e=this._context.configuration.options.get(66),t=this._context.configuration.options.get(143).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(66),t=this._getScrollSpeed(),i=this._tick(),s=t*(i/1e3)*e,r=this._position.outsidePosition==="above"?-s:s;this._context.viewModel.viewLayout.deltaScrollNow(0,r),this._viewHelper.renderNow();const o=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?o.startLineNumber:o.endLineNumber;let l;{const c=H8(this._viewHelper.viewDomNode),u=this._context.configuration.options.get(143).horizontalScrollbarHeight,h=new WT(this._mouseEvent.pos.x,c.y+c.height-u-.1),d=U8(this._viewHelper.viewDomNode,c,h);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,d,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=ks.createOutsideEditor(this._position.mouseColumn,new X(a,1),"above",this._position.outsideDistance):l=ks.createOutsideEditor(this._position.mouseColumn,new X(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=$o(()=>this._execute())}}class zT{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>zT.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}zT.CLEAR_MOUSE_DOWN_COUNT_TIME=400;class xt{get event(){return this.emitter.event}constructor(e,t,i){const s=r=>this.emitter.fire(r);this.emitter=new G({onWillAddFirstListener:()=>e.addEventListener(t,s,i),onDidRemoveLastListener:()=>e.removeEventListener(t,s,i)})}dispose(){this.emitter.dispose()}}var dd;(function(n){const e={total:0,min:Number.MAX_VALUE,max:0},t=Object.assign({},e),i=Object.assign({},e),s=Object.assign({},e);let r=0;const o={keydown:0,input:0,render:0};function a(){b(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),o.keydown=1,queueMicrotask(l)}n.onKeyDown=a;function l(){o.keydown===1&&(performance.mark("keydown/end"),o.keydown=2)}function c(){performance.mark("input/start"),o.input=1,m()}n.onBeforeInput=c;function u(){o.input===0&&c(),queueMicrotask(h)}n.onInput=u;function h(){o.input===1&&(performance.mark("input/end"),o.input=2)}function d(){b()}n.onKeyUp=d;function f(){b()}n.onSelectionChange=f;function g(){o.keydown===2&&o.input===2&&o.render===0&&(performance.mark("render/start"),o.render=1,queueMicrotask(p),m())}n.onRenderStart=g;function p(){o.render===1&&(performance.mark("render/end"),o.render=2)}function m(){setTimeout(b)}function b(){o.keydown===2&&o.input===2&&o.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),v("keydown",e),v("input",t),v("render",i),v("inputlatency",s),r++,w())}function v(S,T){const k=performance.getEntriesByName(S)[0].duration;T.total+=k,T.min=Math.min(T.min,k),T.max=Math.max(T.max,k)}function w(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),o.keydown=0,o.input=0,o.render=0}function y(){if(r===0)return;const S={keydown:x(e),input:x(t),render:x(i),total:x(s),sampleCount:r};return D(e),D(t),D(i),D(s),r=0,S}n.getAndClearMeasurements=y;function x(S){return{average:S.total/r,max:S.max,min:S.min}}function D(S){S.total=0,S.min=Number.MAX_VALUE,S.max=0}})(dd||(dd={}));class On{constructor(e,t,i,s,r){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=s,this.newlineCountBeforeSelection=r}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),s=e.getSelectionStart(),r=e.getSelectionEnd();let o;if(t){const a=i.substring(0,s),l=t.value.substring(0,t.selectionStart);a===l&&(o=t.newlineCountBeforeSelection)}return new On(i,s,r,null,o)}collapseSelection(){return this.selectionStart===this.value.length?this:new On(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var t,i,s,r,o,a,l,c;if(e<=this.selectionStart){const d=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition((i=(t=this.selection)===null||t===void 0?void 0:t.getStartPosition())!==null&&i!==void 0?i:null,d,-1)}if(e>=this.selectionEnd){const d=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition((r=(s=this.selection)===null||s===void 0?void 0:s.getEndPosition())!==null&&r!==void 0?r:null,d,1)}const u=this.value.substring(this.selectionStart,e);if(u.indexOf(String.fromCharCode(8230))===-1)return this._finishDeduceEditorPosition((a=(o=this.selection)===null||o===void 0?void 0:o.getStartPosition())!==null&&a!==void 0?a:null,u,1);const h=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition((c=(l=this.selection)===null||l===void 0?void 0:l.getEndPosition())!==null&&c!==void 0?c:null,h,-1)}_finishDeduceEditorPosition(e,t,i){let s=0,r=-1;for(;(r=t.indexOf(`
`,r+1))!==-1;)s++;return[e,i*t.length,s]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const s=Math.min(RL(e.value,t.value),e.selectionStart,t.selectionStart),r=Math.min(M3(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(s,e.value.length-r);const o=t.value.substring(s,t.value.length-r),a=e.selectionStart-s,l=e.selectionEnd-s,c=t.selectionStart-s,u=t.selectionEnd-s;if(c===u){const d=e.selectionStart-s;return{text:o,replacePrevCharCnt:d,replaceNextCharCnt:0,positionDelta:0}}const h=l-a;return{text:o,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(RL(e.value,t.value),e.selectionEnd),s=Math.min(M3(e.value,t.value),e.value.length-e.selectionEnd),r=e.value.substring(i,e.value.length-s),o=t.value.substring(i,t.value.length-s);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:o,replacePrevCharCnt:a,replaceNextCharCnt:r.length-a,positionDelta:l-o.length}}}On.EMPTY=new On("",0,0,null,void 0);class C0{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,s=i+1,r=i+t;return new H(s,1,r+1,1)}static fromEditorSelection(e,t,i,s){const o=C0._getPageOfLine(t.startLineNumber,i),a=C0._getRangeForPage(o,i),l=C0._getPageOfLine(t.endLineNumber,i),c=C0._getRangeForPage(l,i);let u=a.intersectRanges(new H(1,1,t.startLineNumber,t.startColumn));if(s&&e.getValueLengthInRange(u,1)>500){const b=e.modifyPosition(u.getEndPosition(),-500);u=H.fromPositions(b,u.getEndPosition())}const h=e.getValueInRange(u,1),d=e.getLineCount(),f=e.getLineMaxColumn(d);let g=c.intersectRanges(new H(t.endLineNumber,t.endColumn,d,f));if(s&&e.getValueLengthInRange(g,1)>500){const b=e.modifyPosition(g.getStartPosition(),500);g=H.fromPositions(g.getStartPosition(),b)}const p=e.getValueInRange(g,1);let m;if(o===l||o+1===l)m=e.getValueInRange(t,1);else{const b=a.intersectRanges(t),v=c.intersectRanges(t);m=e.getValueInRange(b,1)+String.fromCharCode(8230)+e.getValueInRange(v,1)}return s&&m.length>2*500&&(m=m.substring(0,500)+String.fromCharCode(8230)+m.substring(m.length-500,m.length)),new On(h+m+p,h.length,h.length+m.length,t,u.endLineNumber-u.startLineNumber)}}var QL;(function(n){n.Tap="-monaco-textarea-synthetic-tap"})(QL||(QL={}));class JL{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}JL.INSTANCE=new JL;class GFe{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}class KFe extends ae{get textAreaState(){return this._textAreaState}constructor(e,t,i,s){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=s,this._onFocus=this._register(new G),this.onFocus=this._onFocus.event,this._onBlur=this._register(new G),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new G),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new G),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new G),this.onCut=this._onCut.event,this._onPaste=this._register(new G),this.onPaste=this._onPaste.event,this._onType=this._register(new G),this.onType=this._onType.event,this._onCompositionStart=this._register(new G),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new G),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new G),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new G),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncTriggerCut=this._register(new Ui(()=>this._onCut.fire(),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new Ui(()=>this.writeScreenReaderContent("asyncFocusGain"),0)),this._textAreaState=On.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._currentComposition=null;let r=null;this._register(this._textArea.onKeyDown(o=>{const a=new ri(o);(a.keyCode===114||this._currentComposition&&a.keyCode===1)&&a.stopPropagation(),a.equals(9)&&a.preventDefault(),r=a,this._onKeyDown.fire(a)})),this._register(this._textArea.onKeyUp(o=>{const a=new ri(o);this._onKeyUp.fire(a)})),this._register(this._textArea.onCompositionStart(o=>{const a=new GFe;if(this._currentComposition){this._currentComposition=a;return}if(this._currentComposition=a,this._OS===2&&r&&r.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===o.data&&(r.code==="ArrowRight"||r.code==="ArrowLeft")){a.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:o.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:o.data});return}this._onCompositionStart.fire({data:o.data})})),this._register(this._textArea.onCompositionUpdate(o=>{const a=this._currentComposition;if(!a)return;if(this._browser.isAndroid){const c=On.readFromTextArea(this._textArea,this._textAreaState),u=On.deduceAndroidCompositionInput(this._textAreaState,c);this._textAreaState=c,this._onType.fire(u),this._onCompositionUpdate.fire(o);return}const l=a.handleCompositionUpdate(o.data);this._textAreaState=On.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(l),this._onCompositionUpdate.fire(o)})),this._register(this._textArea.onCompositionEnd(o=>{const a=this._currentComposition;if(!a)return;if(this._currentComposition=null,this._browser.isAndroid){const c=On.readFromTextArea(this._textArea,this._textAreaState),u=On.deduceAndroidCompositionInput(this._textAreaState,c);this._textAreaState=c,this._onType.fire(u),this._onCompositionEnd.fire();return}const l=a.handleCompositionUpdate(o.data);this._textAreaState=On.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(l),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(o=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const a=On.readFromTextArea(this._textArea,this._textAreaState),l=On.deduceInput(this._textAreaState,a,this._OS===2);l.replacePrevCharCnt===0&&l.text.length===1&&(Dn(l.text.charCodeAt(0))||l.text.charCodeAt(0)===127)||(this._textAreaState=a,(l.text!==""||l.replacePrevCharCnt!==0||l.replaceNextCharCnt!==0||l.positionDelta!==0)&&this._onType.fire(l))})),this._register(this._textArea.onCut(o=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(o),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(o=>{this._ensureClipboardGetsEditorSelection(o)})),this._register(this._textArea.onPaste(o=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),o.preventDefault(),!o.clipboardData)return;let[a,l]=xU.getTextData(o.clipboardData);a&&(l=l||JL.INSTANCE.get(a),this._onPaste.fire({text:a,metadata:l}))})),this._register(this._textArea.onFocus(()=>{const o=this._hasFocus;this._setHasFocus(!0),this._browser.isSafari&&!o&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return oe(this._textArea.ownerDocument,"selectionchange",t=>{if(dd.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),s=i-e;if(e=i,s<5)return;const r=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),r<100||!this._textAreaState.selection)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),u=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(l),d=this._host.deduceModelPosition(h[0],h[1],h[2]),f=new Lt(u.lineNumber,u.column,d.lineNumber,d.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};JL.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,i),e.preventDefault(),e.clipboardData&&xU.setTextData(e.clipboardData,t.text,t.html,i)}}const xU={getTextData(n){const e=n.getData(Au.text);let t=null;const i=n.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&n.files.length>0?[Array.prototype.slice.call(n.files,0).map(r=>r.name).join(`
`),null]:[e,t]},setTextData(n,e,t,i){n.setData(Au.text,e),typeof t=="string"&&n.setData("text/html",t),n.setData("vscode-editor-data",JSON.stringify(i))}};class ZFe extends ae{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this.onKeyDown=this._register(new xt(this._actual,"keydown")).event,this.onKeyUp=this._register(new xt(this._actual,"keyup")).event,this.onCompositionStart=this._register(new xt(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new xt(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new xt(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new xt(this._actual,"beforeinput")).event,this.onInput=this._register(new xt(this._actual,"input")).event,this.onCut=this._register(new xt(this._actual,"cut")).event,this.onCopy=this._register(new xt(this._actual,"copy")).event,this.onPaste=this._register(new xt(this._actual,"paste")).event,this.onFocus=this._register(new xt(this._actual,"focus")).event,this.onBlur=this._register(new xt(this._actual,"blur")).event,this._onSyntheticTap=this._register(new G),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>dd.onKeyDown())),this._register(this.onBeforeInput(()=>dd.onBeforeInput())),this._register(this.onInput(()=>dd.onInput())),this._register(this.onKeyUp(()=>dd.onKeyUp())),this._register(oe(this._actual,QL.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=J_(this._actual);return e?e.activeElement===this._actual:C8(this._actual)?this._actual.ownerDocument.activeElement===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const s=this._actual;let r=null;const o=J_(s);o?r=o.activeElement:r=s.ownerDocument.activeElement;const a=r===s,l=s.selectionStart,c=s.selectionEnd;if(a&&l===t&&c===i){Ra&&window.parent!==window&&s.focus();return}if(a){this.setIgnoreSelectionChangeTime("setSelectionRange"),s.setSelectionRange(t,i),Ra&&window.parent!==window&&s.focus();return}try{const u=LNe(s);this.setIgnoreSelectionChangeTime("setSelectionRange"),s.focus(),s.setSelectionRange(t,i),DNe(s,u)}catch{}}}class YFe extends Z8{constructor(e,t,i){super(e,t,i),this._register(Zt.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Tap,r=>this.onTap(r))),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Change,r=>this.onChange(r))),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Contextmenu,r=>this._onContextMenu(new rf(r,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(oe(this.viewHelper.linesContentDomNode,"pointerdown",r=>{const o=r.pointerType;if(o==="mouse"){this._lastPointerType="mouse";return}else o==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const s=new vFe(this.viewHelper.viewDomNode);this._register(s.onPointerMove(this.viewHelper.viewDomNode,r=>this._onMouseMove(r))),this._register(s.onPointerUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(s.onPointerLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r))),this._register(s.onPointerDown(this.viewHelper.viewDomNode,(r,o)=>this._onMouseDown(r,o)))}onTap(e){if(!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget))return;e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new rf(e,!1,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.dispatchMouse({position:t.position,mouseColumn:t.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:t.type===6&&t.detail.injectedText!==null})}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class XFe extends Z8{constructor(e,t,i){super(e,t,i),this._register(Zt.addTarget(this.viewHelper.linesContentDomNode)),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Tap,s=>this.onTap(s))),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Change,s=>this.onChange(s))),this._register(oe(this.viewHelper.linesContentDomNode,Jt.Contextmenu,s=>this._onContextMenu(new rf(s,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new rf(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(QL.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class QFe extends ae{constructor(e,t,i){super(),Qd&&y8.pointerEvents?this.handler=this._register(new YFe(e,t,i)):window.TouchEvent?this.handler=this._register(new XFe(e,t,i)):this.handler=this._register(new Z8(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class lm extends bS{}const qr=kt("themeService");function Tn(n){return{id:n}}function pF(n){switch(n){case Fo.DARK:return"vs-dark";case Fo.HIGH_CONTRAST_DARK:return"hc-black";case Fo.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const hse={ThemingContribution:"base.contributions.theming"};class JFe{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new G}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),ut(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const dse=new JFe;Un.add(hse.ThemingContribution,dse);function $a(n){return dse.onColorThemeChange(n)}class ePe extends ae{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}const fse=P("editor.lineHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},_("lineHighlight","Background color for the highlight of line at the cursor position.")),kU=P("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:pt},_("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));P("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},_("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);P("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:ui,hcLight:ui},_("rangeHighlightBorder","Background color of the border around highlighted ranges."),!0);P("editor.symbolHighlightBackground",{dark:bc,light:bc,hcDark:null,hcLight:null},_("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);P("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:ui,hcLight:ui},_("symbolHighlightBorder","Background color of the border around highlighted symbols."),!0);const gse=P("editorCursor.foreground",{dark:"#AEAFAD",light:J.black,hcDark:J.white,hcLight:"#0F4A85"},_("caret","Color of the editor cursor.")),tPe=P("editorCursor.background",null,_("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),zu=P("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},_("editorWhitespaces","Color of whitespace characters in the editor.")),iPe=P("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:J.white,hcLight:"#292929"},_("editorLineNumbers","Color of editor line numbers.")),Ex=P("editorIndentGuide.background",{dark:zu,light:zu,hcDark:zu,hcLight:zu},_("editorIndentGuides","Color of the editor indentation guides."),!1,_("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),Tx=P("editorIndentGuide.activeBackground",{dark:zu,light:zu,hcDark:zu,hcLight:zu},_("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,_("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),wS=P("editorIndentGuide.background1",{dark:Ex,light:Ex,hcDark:Ex,hcLight:Ex},_("editorIndentGuides1","Color of the editor indentation guides (1).")),nPe=P("editorIndentGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorIndentGuides2","Color of the editor indentation guides (2).")),sPe=P("editorIndentGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorIndentGuides3","Color of the editor indentation guides (3).")),rPe=P("editorIndentGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorIndentGuides4","Color of the editor indentation guides (4).")),oPe=P("editorIndentGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorIndentGuides5","Color of the editor indentation guides (5).")),aPe=P("editorIndentGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorIndentGuides6","Color of the editor indentation guides (6).")),yS=P("editorIndentGuide.activeBackground1",{dark:Tx,light:Tx,hcDark:Tx,hcLight:Tx},_("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),lPe=P("editorIndentGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),cPe=P("editorIndentGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),uPe=P("editorIndentGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),hPe=P("editorIndentGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),dPe=P("editorIndentGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),Ax=P("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:ui,hcLight:ui},_("editorActiveLineNumber","Color of editor active line number"),!1,_("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));P("editorLineNumber.activeForeground",{dark:Ax,light:Ax,hcDark:Ax,hcLight:Ax},_("editorActiveLineNumber","Color of editor active line number"));const fPe=P("editorLineNumber.dimmedForeground",{dark:null,light:null,hcDark:null,hcLight:null},_("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));P("editorRuler.foreground",{dark:"#5A5A5A",light:J.lightgrey,hcDark:J.white,hcLight:"#292929"},_("editorRuler","Color of the editor rulers."));P("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},_("editorCodeLensForeground","Foreground color of editor CodeLens"));P("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},_("editorBracketMatchBackground","Background color behind matching brackets"));P("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:pt,hcLight:pt},_("editorBracketMatchBorder","Color for matching brackets boxes"));const gPe=P("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},_("editorOverviewRulerBorder","Color of the overview ruler border.")),pPe=P("editorOverviewRuler.background",null,_("editorOverviewRulerBackground","Background color of the editor overview ruler."));P("editorGutter.background",{dark:vn,light:vn,hcDark:vn,hcLight:vn},_("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));P("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:J.fromHex("#fff").transparent(.8),hcLight:pt},_("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const mPe=P("editorUnnecessaryCode.opacity",{dark:J.fromHex("#000a"),light:J.fromHex("#0007"),hcDark:null,hcLight:null},_("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));P("editorGhostText.border",{dark:null,light:null,hcDark:J.fromHex("#fff").transparent(.8),hcLight:J.fromHex("#292929").transparent(.8)},_("editorGhostTextBorder","Border color of ghost text in the editor."));P("editorGhostText.foreground",{dark:J.fromHex("#ffffff56"),light:J.fromHex("#0007"),hcDark:null,hcLight:null},_("editorGhostTextForeground","Foreground color of the ghost text in the editor."));P("editorGhostText.background",{dark:null,light:null,hcDark:null,hcLight:null},_("editorGhostTextBackground","Background color of the ghost text in the editor."));const Ix=new J(new Tt(0,122,204,.6)),_Pe=P("editorOverviewRuler.rangeHighlightForeground",{dark:Ix,light:Ix,hcDark:Ix,hcLight:Ix},_("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),bPe=P("editorOverviewRuler.errorForeground",{dark:new J(new Tt(255,18,18,.7)),light:new J(new Tt(255,18,18,.7)),hcDark:new J(new Tt(255,50,50,1)),hcLight:"#B5200D"},_("overviewRuleError","Overview ruler marker color for errors.")),vPe=P("editorOverviewRuler.warningForeground",{dark:ho,light:ho,hcDark:Dy,hcLight:Dy},_("overviewRuleWarning","Overview ruler marker color for warnings.")),wPe=P("editorOverviewRuler.infoForeground",{dark:dr,light:dr,hcDark:Ey,hcLight:Ey},_("overviewRuleInfo","Overview ruler marker color for infos.")),pse=P("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},_("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),mse=P("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},_("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),_se=P("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},_("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),bse=P("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),vse=P("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),wse=P("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),yPe=P("editorBracketHighlight.unexpectedBracket.foreground",{dark:new J(new Tt(255,18,18,.8)),light:new J(new Tt(255,18,18,.8)),hcDark:new J(new Tt(255,50,50,1)),hcLight:""},_("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),CPe=P("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),SPe=P("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),xPe=P("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),kPe=P("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),LPe=P("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),DPe=P("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),EPe=P("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),TPe=P("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),APe=P("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),IPe=P("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),NPe=P("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),RPe=P("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},_("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));P("editorUnicodeHighlight.border",{dark:"#BD9B03",light:"#CEA33D",hcDark:"#ff0000",hcLight:"#CEA33D"},_("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));P("editorUnicodeHighlight.background",{dark:"#bd9b0326",light:"#cea33d14",hcDark:"#00000000",hcLight:"#cea33d14"},_("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));$a((n,e)=>{const t=n.getColor(vn),i=n.getColor(fse),s=i&&!i.isTransparent()?i:t;s&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${s}; }`)});class CS extends lm{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new X(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(66);const t=e.get(67);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(94);const i=e.get(143);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const s=Math.abs(this._lastCursorModelPosition.lineNumber-i);return s===0?'<span class="relative-current-line-number">'+i+"</span>":String(s)}return this._renderLineNumbers===3?this._lastCursorModelPosition.lineNumber===i||i%10===0?String(i):"":String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=Ts?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,r=this._context.viewModel.getLineCount(),o=[];for(let a=i;a<=s;a++){const l=a-i,c=this._getLineRenderLineNumber(a);if(!c){o[l]="";continue}let u="";if(a===r&&this._context.viewModel.getLineLength(a)===0){if(this._renderFinalNewline==="off"){o[l]="";continue}this._renderFinalNewline==="dimmed"&&(u=" dimmed-line-number")}a===this._activeLineNumber&&(u=" active-line-number"),o[l]=`<div class="${CS.CLASS_NAME}${t}${u}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${c}</div>`}this._renderResult=o}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}CS.CLASS_NAME="line-numbers";$a((n,e)=>{const t=n.getColor(iPe),i=n.getColor(fPe);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});class Lp extends jr{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=Bt(document.createElement("div")),this._domNode.setClassName(Lp.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=Bt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Lp.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}Lp.CLASS_NAME="glyph-margin";Lp.OUTER_CLASS_NAME="margin";const i_="monaco-mouse-cursor-text";class MPe{constructor(){this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const Kv=new MPe,Oi=kt("keybindingService");var FPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},PPe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class OPe{constructor(e,t,i,s,r){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=s,this.distanceToModelLineEnd=r,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new X(this.modelLineNumber,this.distanceToModelLineStart+1),i=new X(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const JN=Ra;let mF=class extends jr{constructor(e,t,i,s){super(e),this._keybindingService=s,this._primaryCursorPosition=new X(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const r=this._context.configuration.options,o=r.get(143);this._setAccessibilityOptions(r),this._contentLeft=o.contentLeft,this._contentWidth=o.contentWidth,this._contentHeight=o.height,this._fontInfo=r.get(50),this._lineHeight=r.get(66),this._emptySelectionClipboard=r.get(37),this._copyWithSyntaxHighlighting=r.get(25),this._visibleTextArea=null,this._selections=[new Lt(1,1,1,1)],this._modelSelections=[new Lt(1,1,1,1)],this._lastRenderPosition=null,this.textArea=Bt(document.createElement("textarea")),Nc.write(this.textArea,6),this.textArea.setClassName(`inputarea ${i_}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:a}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${a*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(r)),this.textArea.setAttribute("aria-required",r.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(r.get(123))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",_("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",r.get(90)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=Bt(document.createElement("div")),this.textAreaCover.setPosition("absolute");const l={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:h=>this._context.viewModel.getLineMaxColumn(h),getValueInRange:(h,d)=>this._context.viewModel.getValueInRange(h,d),getValueLengthInRange:(h,d)=>this._context.viewModel.getValueLengthInRange(h,d),modifyPosition:(h,d)=>this._context.viewModel.modifyPosition(h,d)},c={getDataToCopy:()=>{const h=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,br),d=this._context.viewModel.model.getEOL(),f=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),g=Array.isArray(h)?h:null,p=Array.isArray(h)?h.join(d):h;let m,b=null;if(this._copyWithSyntaxHighlighting&&p.length<65536){const v=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);v&&(m=v.html,b=v.mode)}return{isFromEmptySelection:f,multicursorText:g,text:p,html:m,mode:b}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const h=this._selections[0];if(Mt&&h.isEmpty()){const f=h.getStartPosition();let g=this._getWordBeforePosition(f);if(g.length===0&&(g=this._getCharacterBeforePosition(f)),g.length>0)return new On(g,g.length,g.length,H.fromPositions(f),0)}const d=500;if(Mt&&!h.isEmpty()&&l.getValueLengthInRange(h,0)<d){const f=l.getValueInRange(h,0);return new On(f,0,f.length,h,0)}if(ih&&!h.isEmpty()){const f="vscode-placeholder";return new On(f,0,f.length,null,void 0)}return On.EMPTY}if(Qz){const h=this._selections[0];if(h.isEmpty()){const d=h.getStartPosition(),[f,g]=this._getAndroidWordAtPosition(d);if(f.length>0)return new On(f,g,g,H.fromPositions(d),0)}return On.EMPTY}return C0.fromEditorSelection(l,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(h,d,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(h,d,f)},u=this._register(new ZFe(this.textArea.domNode));this._textAreaInput=this._register(new KFe(c,u,co,{isAndroid:Qz,isChrome:m8,isFirefox:Ra,isSafari:ih})),this._register(this._textAreaInput.onKeyDown(h=>{this._viewController.emitKeyDown(h)})),this._register(this._textAreaInput.onKeyUp(h=>{this._viewController.emitKeyUp(h)})),this._register(this._textAreaInput.onPaste(h=>{let d=!1,f=null,g=null;h.metadata&&(d=this._emptySelectionClipboard&&!!h.metadata.isFromEmptySelection,f=typeof h.metadata.multicursorText<"u"?h.metadata.multicursorText:null,g=h.metadata.mode),this._viewController.paste(h.text,d,f,g)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(h=>{h.replacePrevCharCnt||h.replaceNextCharCnt||h.positionDelta?this._viewController.compositionType(h.text,h.replacePrevCharCnt,h.replaceNextCharCnt,h.positionDelta):this._viewController.type(h.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(h=>{this._viewController.setSelection(h)})),this._register(this._textAreaInput.onCompositionStart(h=>{const d=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:g,widthOfHiddenTextBefore:p}=(()=>{const b=d.value.substring(0,Math.min(d.selectionStart,d.selectionEnd)),v=b.lastIndexOf(`
`),w=b.substring(v+1),y=w.lastIndexOf("	"),x=w.length-y-1,D=f.getStartPosition(),S=Math.min(D.column-1,x),T=D.column-1-S,k=w.substring(0,w.length-S),{tabSize:I}=this._context.viewModel.model.getOptions(),N=BPe(this.textArea.domNode.ownerDocument,k,this._fontInfo,I);return{distanceToModelLineStart:T,widthOfHiddenTextBefore:N}})(),{distanceToModelLineEnd:m}=(()=>{const b=d.value.substring(Math.max(d.selectionStart,d.selectionEnd)),v=b.indexOf(`
`),w=v===-1?b:b.substring(0,v),y=w.indexOf("	"),x=y===-1?w.length:w.length-y-1,D=f.getEndPosition(),S=Math.min(this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column,x);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(D.lineNumber)-D.column-S}})();this._context.viewModel.revealRange("keyboard",!0,H.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new OPe(this._context,f.startLineNumber,g,p,m),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${i_} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(h=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${i_}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Kv.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(e){this._textAreaInput.writeScreenReaderContent(e)}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),s=ib(t);let r=!0,o=e.column,a=!0,l=e.column,c=0;for(;c<50&&(r||a);){if(r&&o<=1&&(r=!1),r){const u=i.charCodeAt(o-2);s.get(u)!==0?r=!1:o--}if(a&&l>i.length&&(a=!1),a){const u=i.charCodeAt(l-1);s.get(u)!==0?a=!1:l++}c++}return[i.substring(o-1,l-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=ib(this._context.configuration.options.get(129));let s=e.column,r=0;for(;s>1;){const o=t.charCodeAt(s-2);if(i.get(o)!==0||r>50)return t.substring(s-1,e.column-1);r++,s--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!Dn(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){var t,i,s;if(e.get(2)===1){const o=(t=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))===null||t===void 0?void 0:t.getAriaLabel(),a=(i=this._keybindingService.lookupKeybinding("workbench.action.showCommands"))===null||i===void 0?void 0:i.getAriaLabel(),l=(s=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings"))===null||s===void 0?void 0:s.getAriaLabel(),c=_("accessibilityModeOff","The editor is not accessible at this time.");return o?_("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",c,o):a?_("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?_("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Xp.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const s=e.get(143).wrappingColumn;if(s!==-1&&this._accessibilitySupport!==1){const r=e.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(s*r.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=JN?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(50),this._lineHeight=t.get(66),this._emptySelectionClipboard=t.get(37),this._copyWithSyntaxHighlighting=t.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:s}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${s*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("aria-required",t.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(123))),(e.hasChanged(34)||e.hasChanged(90))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!Kv.enabled||e.get(34)&&e.get(90)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new X(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)===null||t===void 0||t.prepareRender(e)}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){var e;if(this._visibleTextArea){const s=this._visibleTextArea.visibleTextareaStart,r=this._visibleTextArea.visibleTextareaEnd,o=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(o&&a&&s&&r&&r.left>=this._scrollLeft&&s.left<=this._scrollLeft+this._contentWidth){const l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,c=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let u=this._visibleTextArea.widthOfHiddenLineTextBefore,h=this._contentLeft+s.left-this._scrollLeft,d=r.left-s.left+1;if(h<this._contentLeft){const v=this._contentLeft-h;h+=v,u+=v,d-=v}d>this._contentWidth&&(d=this._contentWidth);const f=this._context.viewModel.getViewLineData(o.lineNumber),g=f.tokens.findTokenIndexAtOffset(o.column-1),p=f.tokens.findTokenIndexAtOffset(a.column-1),m=g===p,b=this._visibleTextArea.definePresentation(m?f.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=c*this._lineHeight,this.textArea.domNode.scrollLeft=u,this._doRender({lastRenderPosition:null,top:l,left:h,width:d,height:this._lineHeight,useCover:!1,color:($i.getColorMap()||[])[b.foreground],italic:b.italic,bold:b.bold,underline:b.underline,strikethrough:b.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const i=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(i<0||i>this._contentHeight){this._renderAtTopLeft();return}if(Mt){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const s=(e=this._textAreaInput.textAreaState.newlineCountBeforeSelection)!==null&&e!==void 0?e:this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=s*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:JN?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;do{if(i=e.indexOf(`
`,i+1),i===-1)break;t++}while(!0);return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:JN?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;fs(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?J.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const s=this._context.configuration.options;s.get(57)?i.setClassName("monaco-editor-background textAreaCover "+Lp.OUTER_CLASS_NAME):s.get(67).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+CS.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};mF=FPe([PPe(3,Oi)],mF);function BPe(n,e,t,i){if(e.length===0)return 0;const s=n.createElement("div");s.style.position="absolute",s.style.top="-50000px",s.style.width="50000px";const r=n.createElement("span");fs(r,t),r.style.whiteSpace="pre",r.style.tabSize=`${i*t.spaceWidth}px`,r.append(e),s.appendChild(r),n.body.appendChild(s);const o=r.offsetWidth;return n.body.removeChild(s),o}function WPe(n,e,t){let i=0;for(let r=0;r<n.length;r++)n.charAt(r)==="	"?i=_n.nextIndentTabStop(i,e):i++;let s="";if(!t){const r=Math.floor(i/e);i=i%e;for(let o=0;o<r;o++)s+="	"}for(let r=0;r<i;r++)s+=" ";return s}function yse(n,e,t){let i=Pr(n);return i===-1&&(i=n.length),WPe(n.substring(0,i),e,t)+n.substring(i)}const VPe=()=>!0,$Pe=()=>!1,zPe=n=>n===" "||n==="	";class Bm{static shouldRecreate(e){return e.hasChanged(143)||e.hasChanged(129)||e.hasChanged(37)||e.hasChanged(76)||e.hasChanged(78)||e.hasChanged(79)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(127)||e.hasChanged(50)||e.hasChanged(90)}constructor(e,t,i,s){var r;this.languageConfigurationService=s,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const o=i.options,a=o.get(143),l=o.get(50);this.readOnly=o.get(90),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(115),this.lineHeight=l.lineHeight,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(a.height/this.lineHeight)-2),this.useTabStops=o.get(127),this.wordSeparators=o.get(129),this.emptySelectionClipboard=o.get(37),this.copyWithSyntaxHighlighting=o.get(25),this.multiCursorMergeOverlapping=o.get(76),this.multiCursorPaste=o.get(78),this.multiCursorLimit=o.get(79),this.autoClosingBrackets=o.get(6),this.autoClosingComments=o.get(7),this.autoClosingQuotes=o.get(11),this.autoClosingDelete=o.get(9),this.autoClosingOvertype=o.get(10),this.autoSurround=o.get(14),this.autoIndent=o.get(12),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const c=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(c)for(const h of c)this.surroundingPairs[h.open]=h.close;const u=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(r=u==null?void 0:u.blockCommentStartToken)!==null&&r!==void 0?r:null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)===null||e===void 0?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}onElectricCharacter(e,t,i){const s=DT(t,i-1),r=this.languageConfigurationService.getLanguageConfiguration(s.languageId).electricCharacter;return r?r.onElectricCharacter(e,s,i-s.firstCharOffset):null}normalizeIndentation(e){return yse(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return zPe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return VPe;case"never":return $Pe}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return s=>i.indexOf(s)!==-1}visibleColumnFromColumn(e,t){return _n.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const s=_n.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),r=e.getLineMinColumn(t);if(s<r)return r;const o=e.getLineMaxColumn(t);return s>o?o:s}}class St{static fromModelState(e){return new HPe(e)}static fromViewState(e){return new UPe(e)}static fromModelSelection(e){const t=Lt.liftSelection(e),i=new Vn(H.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return St.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,s=e.length;i<s;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class HPe{constructor(e){this.modelState=e,this.viewState=null}}class UPe{constructor(e){this.modelState=null,this.viewState=e}}class Vn{constructor(e,t,i,s,r){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=s,this.leftoverVisibleColumns=r,this._singleCursorStateBrand=void 0,this.selection=Vn._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,s){return e?new Vn(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new X(t,i),s):new Vn(new H(t,i,t,i),0,s,new X(t,i),s)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Lt.fromPositions(e.getStartPosition(),t):Lt.fromPositions(e.getEndPosition(),t)}}class tr{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function Fh(n){return n==="'"||n==='"'||n==="`"}class sg{static columnSelect(e,t,i,s,r,o){const a=Math.abs(r-i)+1,l=i>r,c=s>o,u=s<o,h=[];for(let d=0;d<a;d++){const f=i+(l?-d:d),g=e.columnFromVisibleColumn(t,f,s),p=e.columnFromVisibleColumn(t,f,o),m=e.visibleColumnFromColumn(t,new X(f,g)),b=e.visibleColumnFromColumn(t,new X(f,p));u&&(m>o||b<s)||c&&(b>s||m<o)||h.push(new Vn(new H(f,g,f,g),0,0,new X(f,p),0))}if(h.length===0)for(let d=0;d<a;d++){const f=i+(l?-d:d),g=t.getLineMaxColumn(f);h.push(new Vn(new H(f,g,f,g),0,0,new X(f,g),0))}return{viewStates:h,reversed:l,fromLineNumber:i,fromVisualColumn:s,toLineNumber:r,toVisualColumn:o}}static columnSelectLeft(e,t,i){let s=i.toViewVisualColumn;return s>0&&s--,sg.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,s)}static columnSelectRight(e,t,i){let s=0;const r=Math.min(i.fromViewLineNumber,i.toViewLineNumber),o=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=r;l<=o;l++){const c=t.getLineMaxColumn(l),u=e.visibleColumnFromColumn(t,new X(l,c));s=Math.max(s,u)}let a=i.toViewVisualColumn;return a<s&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,s){const r=s?e.pageSize:1,o=Math.max(1,i.toViewLineNumber-r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}static columnSelectDown(e,t,i,s){const r=s?e.pageSize:1,o=Math.min(t.getLineCount(),i.toViewLineNumber+r);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}}class nr{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return Lt.fromPositions(s.getEndPosition())}}class Nx{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return Lt.fromPositions(s.getStartPosition())}}class sk{constructor(e,t,i,s,r=!1){this._range=e,this._text=t,this._columnDeltaOffset=s,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=r}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return Lt.fromPositions(s.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class Cse{constructor(e,t,i,s=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=s,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class eR{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class Ut{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Rie(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new X(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const s=e.getLineMinColumn(t.lineNumber),r=e.getLineContent(t.lineNumber),o=Ay.atomicPosition(r,t.column-1,i,0);if(o!==-1&&o+1>=s)return new X(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,i){const s=e.stickyTabStops?Ut.leftPositionAtomicSoftTabs(t,i,e.tabSize):Ut.leftPosition(t,i);return new eR(s.lineNumber,s.column,0)}static moveLeft(e,t,i,s,r){let o,a;if(i.hasSelection()&&!s)o=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(r-1)),c=t.normalizePosition(Ut.clipPositionColumn(l,t),0),u=Ut.left(e,t,c);o=u.lineNumber,a=u.column}return i.move(s,o,a,0)}static clipPositionColumn(e,t){return new X(e.lineNumber,Ut.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+d8(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new X(t,i)}static rightPositionAtomicSoftTabs(e,t,i,s,r){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),a=Ay.atomicPosition(o,i-1,s,1);if(a!==-1)return new X(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const s=e.stickyTabStops?Ut.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):Ut.rightPosition(t,i.lineNumber,i.column);return new eR(s.lineNumber,s.column,0)}static moveRight(e,t,i,s,r){let o,a;if(i.hasSelection()&&!s)o=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,r-1),c=t.normalizePosition(Ut.clipPositionColumn(l,t),1),u=Ut.right(e,t,c);o=u.lineNumber,a=u.column}return i.move(s,o,a,0)}static vertical(e,t,i,s,r,o,a,l){const c=_n.visibleColumnFromColumn(t.getLineContent(i),s,e.tabSize)+r,u=t.getLineCount(),h=i===1&&s===1,d=i===u&&s===t.getLineMaxColumn(i),f=o<i?h:d;if(i=o,i<1?(i=1,a?s=t.getLineMinColumn(i):s=Math.min(t.getLineMaxColumn(i),s)):i>u?(i=u,a?s=t.getLineMaxColumn(i):s=Math.min(t.getLineMaxColumn(i),s)):s=e.columnFromVisibleColumn(t,i,c),f?r=0:r=c-_n.visibleColumnFromColumn(t.getLineContent(i),s,e.tabSize),l!==void 0){const g=new X(i,s),p=t.normalizePosition(g,l);r=r+(s-p.column),i=p.lineNumber,s=p.column}return new eR(i,s,r)}static down(e,t,i,s,r,o,a){return this.vertical(e,t,i,s,r,i+o,a,4)}static moveDown(e,t,i,s,r){let o,a;i.hasSelection()&&!s?(o=i.selection.endLineNumber,a=i.selection.endColumn):(o=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=Ut.down(e,t,o+l,a,i.leftoverVisibleColumns,r,!0),t.normalizePosition(new X(c.lineNumber,c.column),2).lineNumber>o)break;while(l++<10&&o+l<t.getLineCount());return i.move(s,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const s=i.selection,r=Ut.down(e,t,s.selectionStartLineNumber,s.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Ut.down(e,t,s.positionLineNumber,s.positionColumn,i.leftoverVisibleColumns,1,!1);return new Vn(new H(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new X(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,i,s,r,o,a){return this.vertical(e,t,i,s,r,i-o,a,3)}static moveUp(e,t,i,s,r){let o,a;i.hasSelection()&&!s?(o=i.selection.startLineNumber,a=i.selection.startColumn):(o=i.position.lineNumber,a=i.position.column);const l=Ut.up(e,t,o,a,i.leftoverVisibleColumns,r,!0);return i.move(s,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const s=i.selection,r=Ut.up(e,t,s.selectionStartLineNumber,s.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Ut.up(e,t,s.positionLineNumber,s.positionColumn,i.leftoverVisibleColumns,1,!1);return new Vn(new H(r.lineNumber,r.column,r.lineNumber,r.column),0,r.leftoverVisibleColumns,new X(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,s){let r=i.position.lineNumber;for(;r>1&&this._isBlankLine(t,r);)r--;for(;r>1&&!this._isBlankLine(t,r);)r--;return i.move(s,r,t.getLineMinColumn(r),0)}static moveToNextBlankLine(e,t,i,s){const r=t.getLineCount();let o=i.position.lineNumber;for(;o<r&&this._isBlankLine(t,o);)o++;for(;o<r&&!this._isBlankLine(t,o);)o++;return i.move(s,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,i,s){const r=i.position.lineNumber,o=t.getLineMinColumn(r),a=t.getLineFirstNonWhitespaceColumn(r)||o;let l;return i.position.column===a?l=o:l=a,i.move(s,r,l,0)}static moveToEndOfLine(e,t,i,s,r){const o=i.position.lineNumber,a=t.getLineMaxColumn(o);return i.move(s,o,a,r?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,s){return i.move(s,1,1,0)}static moveToEndOfBuffer(e,t,i,s){const r=t.getLineCount(),o=t.getLineMaxColumn(r);return i.move(s,r,o,0)}}class Dp{static deleteRight(e,t,i,s){const r=[];let o=e!==3;for(let a=0,l=s.length;a<l;a++){const c=s[a];let u=c;if(u.isEmpty()){const h=c.getPosition(),d=Ut.right(t,i,h);u=new H(d.lineNumber,d.column,h.lineNumber,h.column)}if(u.isEmpty()){r[a]=null;continue}u.startLineNumber!==u.endLineNumber&&(o=!0),r[a]=new nr(u,"")}return[o,r]}static isAutoClosingPairDelete(e,t,i,s,r,o,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=o.length;l<c;l++){const u=o[l],h=u.getPosition();if(!u.isEmpty())return!1;const d=r.getLineContent(h.lineNumber);if(h.column<2||h.column>=d.length+1)return!1;const f=d.charAt(h.column-2),g=s.get(f);if(!g)return!1;if(Fh(f)){if(i==="never")return!1}else if(t==="never")return!1;const p=d.charAt(h.column-1);let m=!1;for(const b of g)b.open===f&&b.close===p&&(m=!0);if(!m)return!1;if(e==="auto"){let b=!1;for(let v=0,w=a.length;v<w;v++){const y=a[v];if(h.lineNumber===y.startLineNumber&&h.column===y.startColumn){b=!0;break}}if(!b)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const s=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].getPosition(),l=new H(a.lineNumber,a.column-1,a.lineNumber,a.column+1);s[r]=new nr(l,"")}return[!0,s]}static deleteLeft(e,t,i,s,r){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,s,r))return this._runAutoClosingPairDelete(t,i,s);const o=[];let a=e!==2;for(let l=0,c=s.length;l<c;l++){const u=Dp.getDeleteRange(s[l],i,t);if(u.isEmpty()){o[l]=null;continue}u.startLineNumber!==u.endLineNumber&&(a=!0),o[l]=new nr(u,"")}return[a,o]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const s=e.getPosition();if(i.useTabStops&&s.column>1){const r=t.getLineContent(s.lineNumber),o=Pr(r),a=o===-1?r.length+1:o+1;if(s.column<=a){const l=i.visibleColumnFromColumn(t,s),c=_n.prevIndentTabStop(l,i.indentSize),u=i.columnFromVisibleColumn(t,s.lineNumber,c);return new H(s.lineNumber,u,s.lineNumber,s.column)}}return H.fromPositions(Dp.getPositionAfterDeleteLeft(s,t),s)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=nIe(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new X(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const s=[];let r=null;i.sort((o,a)=>X.compare(o.getStartPosition(),a.getEndPosition()));for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let u,h,d,f;c.lineNumber<t.getLineCount()?(u=c.lineNumber,h=1,d=c.lineNumber+1,f=1):c.lineNumber>1&&(r==null?void 0:r.endLineNumber)!==c.lineNumber?(u=c.lineNumber-1,h=t.getLineMaxColumn(c.lineNumber-1),d=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber)):(u=c.lineNumber,h=1,d=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber));const g=new H(u,h,d,f);r=g,g.isEmpty()?s[o]=null:s[o]=new nr(g,"")}else s[o]=null;else s[o]=new nr(l,"")}return new tr(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Wi{static _createWord(e,t,i,s,r){return{start:s,end:r,wordType:t,nextCharClass:i}}static _findPreviousWordOnLine(e,t,i){const s=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(s,e,i)}static _doFindPreviousWordOnLine(e,t,i){let s=0;for(let r=i.column-2;r>=0;r--){const o=e.charCodeAt(r),a=t.get(o);if(a===0){if(s===2)return this._createWord(e,s,a,r+1,this._findEndOfWord(e,t,s,r+1));s=1}else if(a===2){if(s===1)return this._createWord(e,s,a,r+1,this._findEndOfWord(e,t,s,r+1));s=2}else if(a===1&&s!==0)return this._createWord(e,s,a,r+1,this._findEndOfWord(e,t,s,r+1))}return s!==0?this._createWord(e,s,1,0,this._findEndOfWord(e,t,s,0)):null}static _findEndOfWord(e,t,i,s){const r=e.length;for(let o=s;o<r;o++){const a=e.charCodeAt(o),l=t.get(a);if(l===1||i===1&&l===2||i===2&&l===0)return o}return r}static _findNextWordOnLine(e,t,i){const s=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(s,e,i)}static _doFindNextWordOnLine(e,t,i){let s=0;const r=e.length;for(let o=i.column-1;o<r;o++){const a=e.charCodeAt(o),l=t.get(a);if(l===0){if(s===2)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,o-1),o);s=1}else if(l===2){if(s===1)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,o-1),o);s=2}else if(l===1&&s!==0)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,o-1),o)}return s!==0?this._createWord(e,s,1,this._findStartOfWord(e,t,s,r-1),r):null}static _findStartOfWord(e,t,i,s){for(let r=s;r>=0;r--){const o=e.charCodeAt(r),a=t.get(o);if(a===1||i===1&&a===2||i===2&&a===0)return r+1}return 0}static moveWordLeft(e,t,i,s){let r=i.lineNumber,o=i.column;o===1&&r>1&&(r=r-1,o=t.getLineMaxColumn(r));let a=Wi._findPreviousWordOnLine(e,t,new X(r,o));if(s===0)return new X(r,a?a.start+1:1);if(s===1)return a&&a.wordType===2&&a.end-a.start===1&&a.nextCharClass===0&&(a=Wi._findPreviousWordOnLine(e,t,new X(r,a.start+1))),new X(r,a?a.start+1:1);if(s===3){for(;a&&a.wordType===2;)a=Wi._findPreviousWordOnLine(e,t,new X(r,a.start+1));return new X(r,a?a.start+1:1)}return a&&o<=a.end+1&&(a=Wi._findPreviousWordOnLine(e,t,new X(r,a.start+1))),new X(r,a?a.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,s=e.getLineMaxColumn(i);if(t.column===1)return i>1?new X(i-1,e.getLineMaxColumn(i-1)):t;const r=e.getLineContent(i);for(let o=t.column-1;o>1;o--){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a===95&&l!==95)return new X(i,o);if(a===45&&l!==45)return new X(i,o);if((u0(a)||vx(a))&&Bh(l))return new X(i,o);if(Bh(a)&&Bh(l)&&o+1<s){const c=r.charCodeAt(o);if(u0(c)||vx(c))return new X(i,o)}}return new X(i,1)}static moveWordRight(e,t,i,s){let r=i.lineNumber,o=i.column,a=!1;o===t.getLineMaxColumn(r)&&r<t.getLineCount()&&(a=!0,r=r+1,o=1);let l=Wi._findNextWordOnLine(e,t,new X(r,o));if(s===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Wi._findNextWordOnLine(e,t,new X(r,l.end+1))),l?o=l.end+1:o=t.getLineMaxColumn(r);else if(s===3){for(a&&(o=0);l&&(l.wordType===2||l.start+1<=o);)l=Wi._findNextWordOnLine(e,t,new X(r,l.end+1));l?o=l.start+1:o=t.getLineMaxColumn(r)}else l&&!a&&o>=l.start+1&&(l=Wi._findNextWordOnLine(e,t,new X(r,l.end+1))),l?o=l.start+1:o=t.getLineMaxColumn(r);return new X(r,o)}static _moveWordPartRight(e,t){const i=t.lineNumber,s=e.getLineMaxColumn(i);if(t.column===s)return i<e.getLineCount()?new X(i+1,1):t;const r=e.getLineContent(i);for(let o=t.column+1;o<s;o++){const a=r.charCodeAt(o-2),l=r.charCodeAt(o-1);if(a!==95&&l===95)return new X(i,o);if(a!==45&&l===45)return new X(i,o);if((u0(a)||vx(a))&&Bh(l))return new X(i,o);if(Bh(a)&&Bh(l)&&o+1<s){const c=r.charCodeAt(o);if(u0(c)||vx(c))return new X(i,o)}}return new X(i,s)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=t.column-2,r=tm(i,s);return r+1<s?new H(t.lineNumber,r+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,s=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;if(Dp.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const h=e.selection.getPosition();return new H(h.lineNumber,h.column-1,h.lineNumber,h.column+1)}const a=new X(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(o){const h=this._deleteWordLeftWhitespace(s,a);if(h)return h}let u=Wi._findPreviousWordOnLine(i,s,a);return t===0?u?c=u.start+1:c>1?c=1:(l--,c=s.getLineMaxColumn(l)):(u&&c<=u.end+1&&(u=Wi._findPreviousWordOnLine(i,s,new X(l,u.start+1))),u?c=u.end+1:c>1?c=1:(l--,c=s.getLineMaxColumn(l))),new H(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const s=new X(i.positionLineNumber,i.positionColumn),r=this._deleteInsideWordWhitespace(t,s);return r||this._deleteInsideWordDetermineDeleteRange(e,t,s)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=i.length;if(s===0)return null;let r=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,r))return null;let o=Math.min(t.column-1,s-1);if(!this._charAtIsWhitespace(i,o))return null;for(;r>0&&this._charAtIsWhitespace(i,r-1);)r--;for(;o+1<s&&this._charAtIsWhitespace(i,o+1);)o++;return new H(t.lineNumber,r+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const s=t.getLineContent(i.lineNumber),r=s.length;if(r===0)return i.lineNumber>1?new H(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new H(i.lineNumber,1,i.lineNumber+1,1):new H(i.lineNumber,1,i.lineNumber,1);const o=h=>h.start+1<=i.column&&i.column<=h.end+1,a=(h,d)=>(h=Math.min(h,i.column),d=Math.max(d,i.column),new H(i.lineNumber,h,i.lineNumber,d)),l=h=>{let d=h.start+1,f=h.end+1,g=!1;for(;f-1<r&&this._charAtIsWhitespace(s,f-1);)g=!0,f++;if(!g)for(;d>1&&this._charAtIsWhitespace(s,d-2);)d--;return a(d,f)},c=Wi._findPreviousWordOnLine(e,t,i);if(c&&o(c))return l(c);const u=Wi._findNextWordOnLine(e,t,i);return u&&o(u)?l(u):c&&u?a(c.end+1,u.start+1):c?a(c.start+1,c.end+1):u?a(u.start+1,u.end+1):a(1,r+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),s=Wi._moveWordPartLeft(e,i);return new H(i.lineNumber,i.column,s.lineNumber,s.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let s=t;s<i;s++){const r=e.charAt(s);if(r!==" "&&r!=="	")return s}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=t.column-1,r=this._findFirstNonWhitespaceChar(i,s);return s+1<r?new H(t.lineNumber,t.column,t.lineNumber,r+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,s=e.model,r=e.selection,o=e.whitespaceHeuristics;if(!r.isEmpty())return r;const a=new X(r.positionLineNumber,r.positionColumn);let l=a.lineNumber,c=a.column;const u=s.getLineCount(),h=s.getLineMaxColumn(l);if(l===u&&c===h)return null;if(o){const f=this._deleteWordRightWhitespace(s,a);if(f)return f}let d=Wi._findNextWordOnLine(i,s,a);return t===2?d?c=d.end+1:c<h||l===u?c=h:(l++,d=Wi._findNextWordOnLine(i,s,new X(l,1)),d?c=d.start+1:c=s.getLineMaxColumn(l)):(d&&c>=d.start+1&&(d=Wi._findNextWordOnLine(i,s,new X(l,d.end+1))),d?c=d.start+1:c<h||l===u?c=h:(l++,d=Wi._findNextWordOnLine(i,s,new X(l,1)),d?c=d.start+1:c=s.getLineMaxColumn(l))),new H(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),s=Wi._moveWordPartRight(e,i);return new H(i.lineNumber,i.column,s.lineNumber,s.column)}static _createWordAtPosition(e,t,i){const s=new H(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(s),startColumn:s.startColumn,endColumn:s.endColumn}}static getWordAtPosition(e,t,i){const s=ib(t),r=Wi._findPreviousWordOnLine(s,e,i);if(r&&r.wordType===1&&r.start<=i.column-1&&i.column-1<=r.end)return Wi._createWordAtPosition(e,i.lineNumber,r);const o=Wi._findNextWordOnLine(s,e,i);return o&&o.wordType===1&&o.start<=i.column-1&&i.column-1<=o.end?Wi._createWordAtPosition(e,i.lineNumber,o):null}static word(e,t,i,s,r){const o=ib(e.wordSeparators),a=Wi._findPreviousWordOnLine(o,t,r),l=Wi._findNextWordOnLine(o,t,r);if(!s){let f,g;return a&&a.wordType===1&&a.start<=r.column-1&&r.column-1<=a.end?(f=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=r.column-1&&r.column-1<=l.end?(f=l.start+1,g=l.end+1):(a?f=a.end+1:f=1,l?g=l.start+1:g=t.getLineMaxColumn(r.lineNumber)),new Vn(new H(r.lineNumber,f,r.lineNumber,g),1,0,new X(r.lineNumber,g),0)}let c,u;a&&a.wordType===1&&a.start<r.column-1&&r.column-1<a.end?(c=a.start+1,u=a.end+1):l&&l.wordType===1&&l.start<r.column-1&&r.column-1<l.end?(c=l.start+1,u=l.end+1):(c=r.column,u=r.column);const h=r.lineNumber;let d;if(i.selectionStart.containsPosition(r))d=i.selectionStart.endColumn;else if(r.isBeforeOrEqual(i.selectionStart.getStartPosition())){d=c;const f=new X(h,d);i.selectionStart.containsPosition(f)&&(d=i.selectionStart.endColumn)}else{d=u;const f=new X(h,d);i.selectionStart.containsPosition(f)&&(d=i.selectionStart.startColumn)}return i.move(!0,h,d,0)}}class jn{static addCursorDown(e,t,i){const s=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];s[r++]=new St(l.modelState,l.viewState),i?s[r++]=St.fromModelState(Ut.translateDown(e.cursorConfig,e.model,l.modelState)):s[r++]=St.fromViewState(Ut.translateDown(e.cursorConfig,e,l.viewState))}return s}static addCursorUp(e,t,i){const s=[];let r=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];s[r++]=new St(l.modelState,l.viewState),i?s[r++]=St.fromModelState(Ut.translateUp(e.cursorConfig,e.model,l.modelState)):s[r++]=St.fromViewState(Ut.translateUp(e.cursorConfig,e,l.viewState))}return s}static moveToBeginningOfLine(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];s[r]=this._moveToLineStart(e,a,i)}return s}static _moveToLineStart(e,t,i){const s=t.viewState.position.column,r=t.modelState.position.column,o=s===r,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!o&&!(s===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return St.fromViewState(Ut.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return St.fromModelState(Ut.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,s){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=this._moveToLineEnd(e,l,i,s)}return r}static _moveToLineEnd(e,t,i,s){const r=t.viewState.position,o=e.getLineMaxColumn(r.lineNumber),a=r.column===o,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),u=o-r.column===c-l.column;return a||u?this._moveToLineEndByModel(e,t,i,s):this._moveToLineEndByView(e,t,i,s)}static _moveToLineEndByView(e,t,i,s){return St.fromViewState(Ut.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,s))}static _moveToLineEndByModel(e,t,i,s){return St.fromModelState(Ut.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,s))}static expandLineSelection(e,t){const i=[];for(let s=0,r=t.length;s<r;s++){const o=t[s],a=o.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=o.modelState.selection.endLineNumber,u;c===l?u=e.model.getLineMaxColumn(l):(c++,u=1),i[s]=St.fromModelState(new Vn(new H(a,1,a,1),0,0,new X(c,u),0))}return i}static moveToBeginningOfBuffer(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];s[r]=St.fromModelState(Ut.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return s}static moveToEndOfBuffer(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r];s[r]=St.fromModelState(Ut.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return s}static selectAll(e,t){const i=e.model.getLineCount(),s=e.model.getLineMaxColumn(i);return St.fromModelState(new Vn(new H(1,1,1,1),0,0,new X(i,s),0))}static line(e,t,i,s,r){const o=e.model.validatePosition(s),a=r?e.coordinatesConverter.validateViewPosition(new X(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!i){const c=e.model.getLineCount();let u=o.lineNumber+1,h=1;return u>c&&(u=c,h=e.model.getLineMaxColumn(u)),St.fromModelState(new Vn(new H(o.lineNumber,1,u,h),2,0,new X(u,h),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<l)return St.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(o.lineNumber>l){const c=e.getLineCount();let u=a.lineNumber+1,h=1;return u>c&&(u=c,h=e.getLineMaxColumn(u)),St.fromViewState(t.viewState.move(!0,u,h,0))}else{const c=t.modelState.selectionStart.getEndPosition();return St.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,s){const r=e.model.validatePosition(s);return St.fromModelState(Wi.word(e.cursorConfig,e.model,t.modelState,i,r))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new St(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,s=t.viewState.position.column;return St.fromViewState(new Vn(new H(i,s,i,s),0,0,new X(i,s),0))}static moveTo(e,t,i,s,r){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,s);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,s,r)}const o=e.model.validatePosition(s),a=r?e.coordinatesConverter.validateViewPosition(new X(r.lineNumber,r.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return St.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,s,r,o){switch(i){case 0:return o===4?this._moveHalfLineLeft(e,t,s):this._moveLeft(e,t,s,r);case 1:return o===4?this._moveHalfLineRight(e,t,s):this._moveRight(e,t,s,r);case 2:return o===2?this._moveUpByViewLines(e,t,s,r):this._moveUpByModelLines(e,t,s,r);case 3:return o===2?this._moveDownByViewLines(e,t,s,r):this._moveDownByModelLines(e,t,s,r);case 4:return o===2?t.map(a=>St.fromViewState(Ut.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,s))):t.map(a=>St.fromModelState(Ut.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,s)));case 5:return o===2?t.map(a=>St.fromViewState(Ut.moveToNextBlankLine(e.cursorConfig,e,a.viewState,s))):t.map(a=>St.fromModelState(Ut.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,s)));case 6:return this._moveToViewMinColumn(e,t,s);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,s);case 8:return this._moveToViewCenterColumn(e,t,s);case 9:return this._moveToViewMaxColumn(e,t,s);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,s);default:return null}}static viewportMove(e,t,i,s,r){const o=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,r),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 14:{const l=[];for(let c=0,u=t.length;c<u;c++){const h=t[c];l[c]=this.findPositionInViewportIfOutside(e,h,o,s)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,s){const r=t.viewState.position.lineNumber;if(i.startLineNumber<=r&&r<=i.endLineNumber-1)return new St(t.modelState,t.viewState);{let o;r>i.endLineNumber-1?o=i.endLineNumber-1:r<i.startLineNumber?o=i.startLineNumber:o=r;const a=Ut.vertical(e.cursorConfig,e,r,t.viewState.position.column,t.viewState.leftoverVisibleColumns,o,!1);return St.fromViewState(t.viewState.move(s,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let s=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(s)&&s++,Math.min(t.endLineNumber,s+i-1)}static _lastLineNumberInRange(e,t,i){let s=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(s)&&s++,Math.max(s,t.endLineNumber-i+1)}static _moveLeft(e,t,i,s){return t.map(r=>St.fromViewState(Ut.moveLeft(e.cursorConfig,e,r.viewState,i,s)))}static _moveHalfLineLeft(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);s[r]=St.fromViewState(Ut.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return s}static _moveRight(e,t,i,s){return t.map(r=>St.fromViewState(Ut.moveRight(e.cursorConfig,e,r.viewState,i,s)))}static _moveHalfLineRight(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);s[r]=St.fromViewState(Ut.moveRight(e.cursorConfig,e,a.viewState,i,c))}return s}static _moveDownByViewLines(e,t,i,s){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=St.fromViewState(Ut.moveDown(e.cursorConfig,e,l.viewState,i,s))}return r}static _moveDownByModelLines(e,t,i,s){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=St.fromModelState(Ut.moveDown(e.cursorConfig,e.model,l.modelState,i,s))}return r}static _moveUpByViewLines(e,t,i,s){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=St.fromViewState(Ut.moveUp(e.cursorConfig,e,l.viewState,i,s))}return r}static _moveUpByModelLines(e,t,i,s){const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];r[o]=St.fromModelState(Ut.moveUp(e.cursorConfig,e.model,l.modelState,i,s))}return r}static _moveToViewPosition(e,t,i,s,r){return St.fromViewState(t.viewState.move(i,s,r,0))}static _moveToModelPosition(e,t,i,s,r){return St.fromModelState(t.modelState.move(i,s,r,0))}static _moveToViewMinColumn(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);s[r]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);s[r]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewCenterColumn(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);s[r]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewMaxColumn(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);s[r]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewLastNonWhitespaceColumn(e,t,i){const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);s[r]=this._moveToViewPosition(e,a,i,l,c)}return s}}var eD;(function(n){const e=function(i){if(!ur(i))return!1;const s=i;return!(!_r(s.to)||!Mr(s.select)&&!rie(s.select)||!Mr(s.by)&&!_r(s.by)||!Mr(s.value)&&!Xd(s.value))};n.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},n.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let s;switch(i.to){case n.RawDirection.Left:s=0;break;case n.RawDirection.Right:s=1;break;case n.RawDirection.Up:s=2;break;case n.RawDirection.Down:s=3;break;case n.RawDirection.PrevBlankLine:s=4;break;case n.RawDirection.NextBlankLine:s=5;break;case n.RawDirection.WrappedLineStart:s=6;break;case n.RawDirection.WrappedLineFirstNonWhitespaceCharacter:s=7;break;case n.RawDirection.WrappedLineColumnCenter:s=8;break;case n.RawDirection.WrappedLineEnd:s=9;break;case n.RawDirection.WrappedLineLastNonWhitespaceCharacter:s=10;break;case n.RawDirection.ViewPortTop:s=11;break;case n.RawDirection.ViewPortBottom:s=13;break;case n.RawDirection.ViewPortCenter:s=12;break;case n.RawDirection.ViewPortIfOutside:s=14;break;default:return null}let r=0;switch(i.by){case n.RawUnit.Line:r=1;break;case n.RawUnit.WrappedLine:r=2;break;case n.RawUnit.Character:r=3;break;case n.RawUnit.HalfLine:r=4;break}return{direction:s,unit:r,select:!!i.select,value:i.value||1}}n.parse=t})(eD||(eD={}));function _F(n,e,t,i){const s=Y0(e,t.startLineNumber,t.startColumn),r=i.getLanguageConfiguration(s.languageId);if(!r)return null;const o=s.getLineContent(),a=o.substr(0,t.startColumn-1-s.firstCharOffset);let l;t.isEmpty()?l=o.substr(t.startColumn-1-s.firstCharOffset):l=Y0(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-s.firstCharOffset);let c="";if(t.startLineNumber>1&&s.firstCharOffset===0){const p=Y0(e,t.startLineNumber-1);p.languageId===s.languageId&&(c=p.getLineContent())}const u=r.onEnter(n,c,a,l);if(!u)return null;const h=u.indentAction;let d=u.appendText;const f=u.removeText||0;d?h===Ws.Indent&&(d="	"+d):h===Ws.Indent||h===Ws.IndentOutdent?d="	":d="";let g=Ene(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:h,appendText:d,removeText:f,indentation:g}}var jPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},qPe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},rk;const tR=Object.create(null);function Vf(n,e){if(e<=0)return"";tR[n]||(tR[n]=["",n]);const t=tR[n];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+n;return t[e]}let rg=rk=class{static unshiftIndent(e,t,i,s,r){const o=_n.visibleColumnFromColumn(e,t,i);if(r){const a=Vf(" ",s),c=_n.prevIndentTabStop(o,s)/s;return Vf(a,c)}else{const a="	",c=_n.prevRenderTabStop(o,i)/i;return Vf(a,c)}}static shiftIndent(e,t,i,s,r){const o=_n.visibleColumnFromColumn(e,t,i);if(r){const a=Vf(" ",s),c=_n.nextIndentTabStop(o,s)/s;return Vf(a,c)}else{const a="	",c=_n.nextRenderTabStop(o,i)/i;return Vf(a,c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let s=this._selection.endLineNumber;this._selection.endColumn===1&&i!==s&&(s=s-1);const{tabSize:r,indentSize:o,insertSpaces:a}=this._opts,l=i===s;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,u=0;for(let h=i;h<=s;h++,c=u){u=0;const d=e.getLineContent(h);let f=Pr(d);if(this._opts.isUnshift&&(d.length===0||f===0)||!l&&!this._opts.isUnshift&&d.length===0)continue;if(f===-1&&(f=d.length),h>1&&_n.visibleColumnFromColumn(d,f+1,r)%o!==0&&e.tokenization.isCheapToTokenize(h-1)){const m=_F(this._opts.autoIndent,e,new H(h-1,e.getLineMaxColumn(h-1),h-1,e.getLineMaxColumn(h-1)),this._languageConfigurationService);if(m){if(u=c,m.appendText)for(let b=0,v=m.appendText.length;b<v&&u<o&&m.appendText.charCodeAt(b)===32;b++)u++;m.removeText&&(u=Math.max(0,u-m.removeText));for(let b=0;b<u&&!(f===0||d.charCodeAt(f-1)!==32);b++)f--}}if(this._opts.isUnshift&&f===0)continue;let g;this._opts.isUnshift?g=rk.unshiftIndent(d,f+1,r,o,a):g=rk.shiftIndent(d,f+1,r,o,a),this._addEditOperation(t,new H(h,1,h,f+1),g),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=f+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?Vf(" ",o):"	";for(let u=i;u<=s;u++){const h=e.getLineContent(u);let d=Pr(h);if(!(this._opts.isUnshift&&(h.length===0||d===0))&&!(!l&&!this._opts.isUnshift&&h.length===0)&&(d===-1&&(d=h.length),!(this._opts.isUnshift&&d===0)))if(this._opts.isUnshift){d=Math.min(d,o);for(let f=0;f<d;f++)if(h.charCodeAt(f)===9){d=f+1;break}this._addEditOperation(t,new H(u,1,u,d+1),"")}else this._addEditOperation(t,new H(u,1,u,1),c),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const s=t.getInverseEditOperations()[0];return new Lt(s.range.endLineNumber,s.range.endColumn,s.range.endLineNumber,s.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const s=this._selection.startColumn;return i.startColumn<=s?i:i.getDirection()===0?new Lt(i.startLineNumber,s,i.endLineNumber,i.endColumn):new Lt(i.endLineNumber,i.endColumn,i.startLineNumber,s)}return i}};rg=rk=jPe([qPe(2,Ur)],rg);class GPe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new H(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new H(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),s=i[0].range,r=i[1].range;return new Lt(s.endLineNumber,s.endColumn,r.endLineNumber,r.endColumn-this._charAfterSelection.length)}}class KPe{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new H(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return new Lt(s.endLineNumber,s.startColumn,s.endLineNumber,s.endColumn-this._charAfter.length)}}function ZPe(n,e,t){const i=n.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let s,r=-1;for(s=e-1;s>=1;s--){if(n.tokenization.getLanguageIdAtPosition(s,0)!==i)return r;const o=n.getLineContent(s);if(t.shouldIgnore(o)||/^\s+$/.test(o)||o===""){r=s;continue}return s}}return-1}function Y8(n,e,t,i=!0,s){if(n<4)return null;const r=s.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!r)return null;if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const o=ZPe(e,t,r);if(o<0)return null;if(o<1)return{indentation:"",action:null};const a=e.getLineContent(o);if(r.shouldIncrease(a)||r.shouldIndentNextLine(a))return{indentation:Lr(a),action:Ws.Indent,line:o};if(r.shouldDecrease(a))return{indentation:Lr(a),action:null,line:o};{if(o===1)return{indentation:Lr(e.getLineContent(o)),action:null,line:o};const l=o-1,c=r.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let u=0;for(let h=l-1;h>0;h--)if(!r.shouldIndentNextLine(e.getLineContent(h))){u=h;break}return{indentation:Lr(e.getLineContent(u+1)),action:null,line:u+1}}if(i)return{indentation:Lr(e.getLineContent(o)),action:null,line:o};for(let u=o;u>0;u--){const h=e.getLineContent(u);if(r.shouldIncrease(h))return{indentation:Lr(h),action:Ws.Indent,line:u};if(r.shouldIndentNextLine(h)){let d=0;for(let f=u-1;f>0;f--)if(!r.shouldIndentNextLine(e.getLineContent(u))){d=f;break}return{indentation:Lr(e.getLineContent(d+1)),action:null,line:d+1}}else if(r.shouldDecrease(h))return{indentation:Lr(h),action:null,line:u}}return{indentation:Lr(e.getLineContent(1)),action:null,line:1}}}function YPe(n,e,t,i,s){if(n<4)return null;e.tokenization.forceTokenization(t.startLineNumber);const r=e.tokenization.getLineTokens(t.startLineNumber),o=DT(r,t.startColumn-1),a=o.getLineContent();let l=!1,c;o.firstCharOffset>0&&r.getLanguageId(0)!==o.languageId?(l=!0,c=a.substr(0,t.startColumn-1-o.firstCharOffset)):c=r.getLineContent().substring(0,t.startColumn-1);let u;t.isEmpty()?u=a.substr(t.startColumn-1-o.firstCharOffset):u=Y0(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-o.firstCharOffset);const h=s.getLanguageConfiguration(o.languageId).indentRulesSupport;if(!h)return null;const d=c,f=Lr(c),g={tokenization:{getLineTokens:v=>e.tokenization.getLineTokens(v),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(v,w)=>e.getLanguageIdAtPosition(v,w)},getLineContent:v=>v===t.startLineNumber?d:e.getLineContent(v)},p=Lr(r.getLineContent()),m=Y8(n,g,t.startLineNumber+1,void 0,s);if(!m){const v=l?p:f;return{beforeEnter:v,afterEnter:v}}let b=l?p:m.indentation;return m.action===Ws.Indent&&(b=i.shiftIndent(b)),h.shouldDecrease(u)&&(b=i.unshiftIndent(b)),{beforeEnter:l?p:f,afterEnter:b}}function XPe(n,e,t,i,s,r){if(n<4)return null;const o=Y0(e,t.startLineNumber,t.startColumn);if(o.firstCharOffset)return null;const a=r.getLanguageConfiguration(o.languageId).indentRulesSupport;if(!a)return null;const l=o.getLineContent(),c=l.substr(0,t.startColumn-1-o.firstCharOffset);let u;if(t.isEmpty()?u=l.substr(t.startColumn-1-o.firstCharOffset):u=Y0(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-o.firstCharOffset),!a.shouldDecrease(c+u)&&a.shouldDecrease(c+i+u)){const h=Y8(n,e,t.startLineNumber,!1,r);if(!h)return null;let d=h.indentation;return h.action!==Ws.Indent&&(d=s.unshiftIndent(d)),d}return null}class Ni{static indent(e,t,i){if(t===null||i===null)return[];const s=[];for(let r=0,o=i.length;r<o;r++)s[r]=new rg(i[r],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return s}static outdent(e,t,i){const s=[];for(let r=0,o=i.length;r<o;r++)s[r]=new rg(i[r],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return s}static shiftIndent(e,t,i){return i=i||1,rg.shiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,i){return i=i||1,rg.unshiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,i,s){const r=[];for(let o=0,a=i.length;o<a;o++)r[o]=new nr(i[o],s[o]);return new tr(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,s,r){const o=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],u=c.getPosition();if(r&&!c.isEmpty()&&(r=!1),r&&s.indexOf(`
`)!==s.length-1&&(r=!1),r){const h=new H(u.lineNumber,1,u.lineNumber,1);o[a]=new Cse(h,s,c,!0)}else o[a]=new nr(c,s)}return new tr(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,i,s,r){if(s||t.length===1)return null;if(r&&r.length===t.length)return r;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substr(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substr(0,i.length-1));const o=em(i);if(o.length===t.length)return o}return null}static paste(e,t,i,s,r,o){const a=this._distributePasteToCursors(e,i,s,r,o);return a?(i=i.sort(H.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,s,r)}static _goodIndentForLine(e,t,i){let s=null,r="";const o=Y8(e.autoIndent,t,i,!1,e.languageConfigurationService);if(o)s=o.action,r=o.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const u=t.getLineContent(a);if(tm(u)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=_F(e.autoIndent,t,new H(a,l,a,l),e.languageConfigurationService);c&&(r=c.indentation+c.appendText)}return s&&(s===Ws.Indent&&(r=Ni.shiftIndent(e,r)),s===Ws.Outdent&&(r=Ni.unshiftIndent(e,r)),r=e.normalizeIndentation(r)),r||null}static _replaceJumpToNextIndent(e,t,i,s){let r="";const o=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,o),l=e.indentSize,c=l-a%l;for(let u=0;u<c;u++)r+=" "}else r="	";return new nr(i,r,s)}static tab(e,t,i){const s=[];for(let r=0,o=i.length;r<o;r++){const a=i[r];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const u=e.normalizeIndentation(c);if(!l.startsWith(u)){s[r]=new nr(new H(a.startLineNumber,1,a.startLineNumber,l.length+1),u,!0);continue}}s[r]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){s[r]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}s[r]=new rg(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return s}static compositionType(e,t,i,s,r,o,a,l){const c=s.map(u=>this._compositionType(i,u,r,o,a,l));return new tr(4,c,{shouldPushStackElementBefore:Rx(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,s,r,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-s),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+r),u=new H(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(u)===i&&o===0?null:new sk(u,i,0,o)}static _typeCommand(e,t,i){return i?new Nx(e,t,!0):new nr(e,t,!0)}static _enter(e,t,i,s){if(e.autoIndent===0)return Ni._typeCommand(s,`
`,i);if(!t.tokenization.isCheapToTokenize(s.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(s.startLineNumber),c=Lr(l).substring(0,s.startColumn-1);return Ni._typeCommand(s,`
`+e.normalizeIndentation(c),i)}const r=_F(e.autoIndent,t,s,e.languageConfigurationService);if(r){if(r.indentAction===Ws.None)return Ni._typeCommand(s,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===Ws.Indent)return Ni._typeCommand(s,`
`+e.normalizeIndentation(r.indentation+r.appendText),i);if(r.indentAction===Ws.IndentOutdent){const l=e.normalizeIndentation(r.indentation),c=e.normalizeIndentation(r.indentation+r.appendText),u=`
`+c+`
`+l;return i?new Nx(s,u,!0):new sk(s,u,-1,c.length-l.length,!0)}else if(r.indentAction===Ws.Outdent){const l=Ni.unshiftIndent(e,r.indentation);return Ni._typeCommand(s,`
`+e.normalizeIndentation(l+r.appendText),i)}}const o=t.getLineContent(s.startLineNumber),a=Lr(o).substring(0,s.startColumn-1);if(e.autoIndent>=4){const l=YPe(e.autoIndent,t,s,{unshiftIndent:c=>Ni.unshiftIndent(e,c),shiftIndent:c=>Ni.shiftIndent(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,s.getEndPosition());const u=s.endColumn,h=t.getLineContent(s.endLineNumber),d=Pr(h);if(d>=0?s=s.setEndPosition(s.endLineNumber,Math.max(s.endColumn,d+1)):s=s.setEndPosition(s.endLineNumber,t.getLineMaxColumn(s.endLineNumber)),i)return new Nx(s,`
`+e.normalizeIndentation(l.afterEnter),!0);{let f=0;return u<=d+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),f=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new sk(s,`
`+e.normalizeIndentation(l.afterEnter),0,f,!0)}}}return Ni._typeCommand(s,`
`+e.normalizeIndentation(a),i)}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let s=0,r=i.length;s<r;s++)if(!t.tokenization.isCheapToTokenize(i[s].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,i,s){const r=Ene(t,i.startLineNumber,i.startColumn),o=XPe(e.autoIndent,t,i,s,{shiftIndent:a=>Ni.shiftIndent(e,a),unshiftIndent:a=>Ni.unshiftIndent(e,a)},e.languageConfigurationService);if(o===null)return null;if(o!==e.normalizeIndentation(r)){const a=t.getLineFirstNonWhitespaceColumn(i.startLineNumber);return a===0?Ni._typeCommand(new H(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(o)+s,!1):Ni._typeCommand(new H(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(o)+t.getLineContent(i.startLineNumber).substring(a-1,i.startColumn-1)+s,!1)}return null}static _isAutoClosingOvertype(e,t,i,s,r){if(e.autoClosingOvertype==="never"||!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(r))return!1;for(let o=0,a=i.length;o<a;o++){const l=i[o];if(!l.isEmpty())return!1;const c=l.getPosition(),u=t.getLineContent(c.lineNumber);if(u.charAt(c.column-1)!==r)return!1;const d=Fh(r);if((c.column>2?u.charCodeAt(c.column-2):0)===92&&d)return!1;if(e.autoClosingOvertype==="auto"){let g=!1;for(let p=0,m=s.length;p<m;p++){const b=s[p];if(c.lineNumber===b.startLineNumber&&c.column===b.startColumn){g=!0;break}}if(!g)return!1}}return!0}static _runAutoClosingOvertype(e,t,i,s,r){const o=[];for(let a=0,l=s.length;a<l;a++){const u=s[a].getPosition(),h=new H(u.lineNumber,u.column,u.lineNumber,u.column+1);o[a]=new nr(h,r)}return new tr(4,o,{shouldPushStackElementBefore:Rx(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),s=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],r=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],o=s.some(l=>t.startsWith(l.open)),a=r.some(l=>t.startsWith(l.close));return!o&&a}static _findAutoClosingPairOpen(e,t,i,s){const r=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(s);if(!r)return null;let o=null;for(const a of r)if(o===null||a.open.length>o.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new H(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+s!==a.open){l=!1;break}l&&(o=a)}return o}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),s=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let r=null;for(const o of s)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!r||o.open.length>r.open.length)&&(r=o);return r}static _getAutoClosingPairClose(e,t,i,s,r){for(const g of i)if(!g.isEmpty())return null;const o=i.map(g=>{const p=g.getPosition();return r?{lineNumber:p.lineNumber,beforeColumn:p.column-s.length,afterColumn:p.column}:{lineNumber:p.lineNumber,beforeColumn:p.column,afterColumn:p.column}}),a=this._findAutoClosingPairOpen(e,t,o.map(g=>new X(g.lineNumber,g.beforeColumn)),s);if(!a)return null;let l,c;if(Fh(s)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const h=this._findContainedAutoClosingPair(e,a),d=h?h.close:"";let f=!0;for(const g of o){const{lineNumber:p,beforeColumn:m,afterColumn:b}=g,v=t.getLineContent(p),w=v.substring(0,m-1),y=v.substring(b-1);if(y.startsWith(d)||(f=!1),y.length>0){const T=y.charAt(0);if(!Ni._isBeforeClosingBrace(e,y)&&!c(T))return null}if(a.open.length===1&&(s==="'"||s==='"')&&l!=="always"){const T=ib(e.wordSeparators);if(w.length>0){const k=w.charCodeAt(w.length-1);if(T.get(k)===0)return null}}if(!t.tokenization.isCheapToTokenize(p))return null;t.tokenization.forceTokenization(p);const x=t.tokenization.getLineTokens(p),D=DT(x,m-1);if(!a.shouldAutoClose(D,m-D.firstCharOffset))return null;const S=a.findNeutralCharacter();if(S){const T=t.tokenization.getTokenTypeIfInsertingCharacter(p,m,S);if(!a.isOK(T))return null}}return f?a.close.substring(0,a.close.length-d.length):a.close}static _runAutoClosingOpenCharType(e,t,i,s,r,o,a){const l=[];for(let c=0,u=s.length;c<u;c++){const h=s[c];l[c]=new Sse(h,r,!o,a)}return new tr(4,l,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return Fh(t)?e.autoSurround==="quotes"||e.autoSurround==="languageDefined":e.autoSurround==="brackets"||e.autoSurround==="languageDefined"}static _isSurroundSelectionType(e,t,i,s){if(!Ni._shouldSurroundChar(e,s)||!e.surroundingPairs.hasOwnProperty(s))return!1;const r=Fh(s);for(const o of i){if(o.isEmpty())return!1;let a=!0;for(let l=o.startLineNumber;l<=o.endLineNumber;l++){const c=t.getLineContent(l),u=l===o.startLineNumber?o.startColumn-1:0,h=l===o.endLineNumber?o.endColumn-1:c.length,d=c.substring(u,h);if(/[^ \t]/.test(d)){a=!1;break}}if(a)return!1;if(r&&o.startLineNumber===o.endLineNumber&&o.startColumn+1===o.endColumn){const l=t.getValueInRange(o);if(Fh(l))return!1}}return!0}static _runSurroundSelectionType(e,t,i,s,r){const o=[];for(let a=0,l=s.length;a<l;a++){const c=s[a],u=t.surroundingPairs[r];o[a]=new GPe(c,r,u)}return new tr(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,s,r){if(!t.electricChars.hasOwnProperty(r)||!s.isEmpty())return null;const o=s.getPosition();i.tokenization.forceTokenization(o.lineNumber);const a=i.tokenization.getLineTokens(o.lineNumber);let l;try{l=t.onElectricCharacter(r,a,o.column)}catch(c){return Ft(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+r).lastIndexOf(l.matchOpenBracket)+1,u=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:o.lineNumber,column:c},500);if(u){if(u.startLineNumber===o.lineNumber)return null;const h=i.getLineContent(u.startLineNumber),d=Lr(h),f=t.normalizeIndentation(d),g=i.getLineContent(o.lineNumber),p=i.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,m=g.substring(p-1,o.column-1),b=f+m+r,v=new H(o.lineNumber,1,o.lineNumber,o.column),w=new nr(v,b);return new tr(iR(b,e),[w],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,i,s,r,o){if(!s)return null;let a=null;for(const h of s)if(a===null)a=h.insertedText;else if(a!==h.insertedText)return null;if(!a||a.length!==1)return null;const l=a;let c=!1;for(const h of s)if(h.deletedText.length!==0){c=!0;break}if(c){if(!Ni._shouldSurroundChar(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const h=Fh(l);for(const g of s)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||h&&Fh(g.deletedText))return null;const d=[];for(const g of r){if(!g.isEmpty())return null;d.push(g.getPosition())}if(d.length!==s.length)return null;const f=[];for(let g=0,p=d.length;g<p;g++)f.push(new KPe(d[g],s[g].deletedText,t.surroundingPairs[l]));return new tr(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(t,i,r,o,l)){const h=r.map(d=>new nr(new H(d.positionLineNumber,d.positionColumn,d.positionLineNumber,d.positionColumn+1),"",!1));return new tr(4,h,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const u=this._getAutoClosingPairClose(t,i,r,l,!0);return u!==null?this._runAutoClosingOpenCharType(e,t,i,r,l,!0,u):null}static typeWithInterceptors(e,t,i,s,r,o,a){if(!e&&a===`
`){const u=[];for(let h=0,d=r.length;h<d;h++)u[h]=Ni._enter(i,s,!1,r[h]);return new tr(4,u,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(i,s,r)){const u=[];let h=!1;for(let d=0,f=r.length;d<f;d++)if(u[d]=this._runAutoIndentType(i,s,r[d],a),!u[d]){h=!0;break}if(!h)return new tr(4,u,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(i,s,r,o,a))return this._runAutoClosingOvertype(t,i,s,r,a);if(!e){const u=this._getAutoClosingPairClose(i,s,r,a,!1);if(u)return this._runAutoClosingOpenCharType(t,i,s,r,a,!1,u)}if(!e&&this._isSurroundSelectionType(i,s,r,a))return this._runSurroundSelectionType(t,i,s,r,a);if(!e&&this._isTypeInterceptorElectricChar(i,s,r)){const u=this._typeInterceptorElectricChar(t,i,s,r[0],a);if(u)return u}const l=[];for(let u=0,h=r.length;u<h;u++)l[u]=new nr(r[u],a);const c=iR(a,t);return new tr(c,l,{shouldPushStackElementBefore:Rx(t,c),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,i,s,r){const o=[];for(let l=0,c=s.length;l<c;l++)o[l]=new nr(s[l],r);const a=iR(r,e);return new tr(a,o,{shouldPushStackElementBefore:Rx(e,a),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const s=[];for(let r=0,o=i.length;r<o;r++){let a=i[r].positionLineNumber;if(a===1)s[r]=new Nx(new H(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);s[r]=this._enter(e,t,!1,new H(a,l,a,l))}}return s}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const s=[];for(let r=0,o=i.length;r<o;r++){const a=i[r].positionLineNumber,l=t.getLineMaxColumn(a);s[r]=this._enter(e,t,!1,new H(a,l,a,l))}return s}static lineBreakInsert(e,t,i){const s=[];for(let r=0,o=i.length;r<o;r++)s[r]=this._enter(e,t,!0,i[r]);return s}}class Sse extends sk{constructor(e,t,i,s){super(e,(i?t:"")+s,0,-s.length),this._openCharacter=t,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new H(s.startLineNumber,s.endColumn-this._closeCharacter.length,s.endLineNumber,s.endColumn),this.enclosingRange=new H(s.startLineNumber,s.endColumn-this._openCharacter.length-this._closeCharacter.length,s.endLineNumber,s.endColumn),super.computeCursorState(e,t)}}class QPe{constructor(e,t,i,s,r,o){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=s,this.insertedSelectionStart=r,this.insertedSelectionEnd=o}}function iR(n,e){return n===" "?e===5||e===6?6:5:4}function Rx(n,e){return DU(n)&&!DU(e)?!0:n===5?!1:LU(n)!==LU(e)}function LU(n){return n===6||n===5?"space":n}function DU(n){return n===4||n===5||n===6}var ee;(function(n){n.editorSimpleInput=new Fe("editorSimpleInput",!1,!0),n.editorTextFocus=new Fe("editorTextFocus",!1,_("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),n.focus=new Fe("editorFocus",!1,_("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),n.textInputFocus=new Fe("textInputFocus",!1,_("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),n.readOnly=new Fe("editorReadonly",!1,_("editorReadonly","Whether the editor is read-only")),n.inDiffEditor=new Fe("inDiffEditor",!1,_("inDiffEditor","Whether the context is a diff editor")),n.isEmbeddedDiffEditor=new Fe("isEmbeddedDiffEditor",!1,_("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),n.comparingMovedCode=new Fe("comparingMovedCode",!1,_("comparingMovedCode","Whether a moved code block is selected for comparison")),n.accessibleDiffViewerVisible=new Fe("accessibleDiffViewerVisible",!1,_("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),n.diffEditorRenderSideBySideInlineBreakpointReached=new Fe("diffEditorRenderSideBySideInlineBreakpointReached",!1,_("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),n.columnSelection=new Fe("editorColumnSelection",!1,_("editorColumnSelection","Whether `editor.columnSelection` is enabled")),n.writable=n.readOnly.toNegated(),n.hasNonEmptySelection=new Fe("editorHasSelection",!1,_("editorHasSelection","Whether the editor has text selected")),n.hasOnlyEmptySelection=n.hasNonEmptySelection.toNegated(),n.hasMultipleSelections=new Fe("editorHasMultipleSelections",!1,_("editorHasMultipleSelections","Whether the editor has multiple selections")),n.hasSingleSelection=n.hasMultipleSelections.toNegated(),n.tabMovesFocus=new Fe("editorTabMovesFocus",!1,_("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),n.tabDoesNotMoveFocus=n.tabMovesFocus.toNegated(),n.isInWalkThroughSnippet=new Fe("isInEmbeddedEditor",!1,!0),n.canUndo=new Fe("canUndo",!1,!0),n.canRedo=new Fe("canRedo",!1,!0),n.hoverVisible=new Fe("editorHoverVisible",!1,_("editorHoverVisible","Whether the editor hover is visible")),n.hoverFocused=new Fe("editorHoverFocused",!1,_("editorHoverFocused","Whether the editor hover is focused")),n.stickyScrollFocused=new Fe("stickyScrollFocused",!1,_("stickyScrollFocused","Whether the sticky scroll is focused")),n.stickyScrollVisible=new Fe("stickyScrollVisible",!1,_("stickyScrollVisible","Whether the sticky scroll is visible")),n.standaloneColorPickerVisible=new Fe("standaloneColorPickerVisible",!1,_("standaloneColorPickerVisible","Whether the standalone color picker is visible")),n.standaloneColorPickerFocused=new Fe("standaloneColorPickerFocused",!1,_("standaloneColorPickerFocused","Whether the standalone color picker is focused")),n.inCompositeEditor=new Fe("inCompositeEditor",void 0,_("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),n.notInCompositeEditor=n.inCompositeEditor.toNegated(),n.languageId=new Fe("editorLangId","",_("editorLangId","The language identifier of the editor")),n.hasCompletionItemProvider=new Fe("editorHasCompletionItemProvider",!1,_("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),n.hasCodeActionsProvider=new Fe("editorHasCodeActionsProvider",!1,_("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),n.hasCodeLensProvider=new Fe("editorHasCodeLensProvider",!1,_("editorHasCodeLensProvider","Whether the editor has a code lens provider")),n.hasDefinitionProvider=new Fe("editorHasDefinitionProvider",!1,_("editorHasDefinitionProvider","Whether the editor has a definition provider")),n.hasDeclarationProvider=new Fe("editorHasDeclarationProvider",!1,_("editorHasDeclarationProvider","Whether the editor has a declaration provider")),n.hasImplementationProvider=new Fe("editorHasImplementationProvider",!1,_("editorHasImplementationProvider","Whether the editor has an implementation provider")),n.hasTypeDefinitionProvider=new Fe("editorHasTypeDefinitionProvider",!1,_("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),n.hasHoverProvider=new Fe("editorHasHoverProvider",!1,_("editorHasHoverProvider","Whether the editor has a hover provider")),n.hasDocumentHighlightProvider=new Fe("editorHasDocumentHighlightProvider",!1,_("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),n.hasDocumentSymbolProvider=new Fe("editorHasDocumentSymbolProvider",!1,_("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),n.hasReferenceProvider=new Fe("editorHasReferenceProvider",!1,_("editorHasReferenceProvider","Whether the editor has a reference provider")),n.hasRenameProvider=new Fe("editorHasRenameProvider",!1,_("editorHasRenameProvider","Whether the editor has a rename provider")),n.hasSignatureHelpProvider=new Fe("editorHasSignatureHelpProvider",!1,_("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),n.hasInlayHintsProvider=new Fe("editorHasInlayHintsProvider",!1,_("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),n.hasDocumentFormattingProvider=new Fe("editorHasDocumentFormattingProvider",!1,_("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),n.hasDocumentSelectionFormattingProvider=new Fe("editorHasDocumentSelectionFormattingProvider",!1,_("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),n.hasMultipleDocumentFormattingProvider=new Fe("editorHasMultipleDocumentFormattingProvider",!1,_("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),n.hasMultipleDocumentSelectionFormattingProvider=new Fe("editorHasMultipleDocumentSelectionFormattingProvider",!1,_("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(ee||(ee={}));const It=0;class Li extends Pa{runEditorCommand(e,t,i){const s=t._getViewModel();s&&this.runCoreEditorCommand(s,i||{})}}var qn;(function(n){const e=function(i){if(!ur(i))return!1;const s=i;return!(!_r(s.to)||!Mr(s.by)&&!_r(s.by)||!Mr(s.value)&&!Xd(s.value)||!Mr(s.revealCursor)&&!rie(s.revealCursor))};n.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},n.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let s;switch(i.to){case n.RawDirection.Up:s=1;break;case n.RawDirection.Right:s=2;break;case n.RawDirection.Down:s=3;break;case n.RawDirection.Left:s=4;break;default:return null}let r;switch(i.by){case n.RawUnit.Line:r=1;break;case n.RawUnit.WrappedLine:r=2;break;case n.RawUnit.Page:r=3;break;case n.RawUnit.HalfPage:r=4;break;case n.RawUnit.Editor:r=5;break;case n.RawUnit.Column:r=6;break;default:r=2}const o=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:s,unit:r,value:o,revealCursor:a,select:!!i.select}}n.parse=t})(qn||(qn={}));var S0;(function(n){const e=function(t){if(!ur(t))return!1;const i=t;return!(!Xd(i.lineNumber)&&!_r(i.lineNumber)||!Mr(i.at)&&!_r(i.at))};n.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(S0||(S0={}));class bF{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const s=t.get(ci).getFocusedCodeEditor();return s&&s.hasTextFocus()?this._runEditorCommand(t,s,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const s=pl();return s&&["input","textarea"].indexOf(s.tagName.toLowerCase())>=0?(this.runDOMCommand(s),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const s=t.get(ci).getActiveCodeEditor();return s?(s.focus(),this._runEditorCommand(t,s,i)):!1})}_runEditorCommand(e,t,i){const s=this.runEditorCommand(e,t,i);return s||!0}}var Sn;(function(n){class e extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){if(!w.position)return;v.model.pushStackElement(),v.setCursorStates(w.source,3,[jn.moveTo(v,v.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)])&&w.revealType!==2&&v.revealPrimaryCursor(w.source,!0,!0)}}n.MoveTo=qe(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),n.MoveToSelect=qe(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends Li{runCoreEditorCommand(v,w){v.model.pushStackElement();const y=this._getColumnSelectResult(v,v.getPrimaryCursorState(),v.getCursorColumnSelectData(),w);y!==null&&(v.setCursorStates(w.source,3,y.viewStates.map(x=>St.fromViewState(x))),v.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:y.fromLineNumber,fromViewVisualColumn:y.fromVisualColumn,toViewLineNumber:y.toLineNumber,toViewVisualColumn:y.toVisualColumn}),y.reversed?v.revealTopMostCursor(w.source):v.revealBottomMostCursor(w.source))}}n.ColumnSelect=qe(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(b,v,w,y){if(typeof y.position>"u"||typeof y.viewPosition>"u"||typeof y.mouseColumn>"u")return null;const x=b.model.validatePosition(y.position),D=b.coordinatesConverter.validateViewPosition(new X(y.viewPosition.lineNumber,y.viewPosition.column),x),S=y.doColumnSelect?w.fromViewLineNumber:D.lineNumber,T=y.doColumnSelect?w.fromViewVisualColumn:y.mouseColumn-1;return sg.columnSelect(b.cursorConfig,b,S,T,D.lineNumber,y.mouseColumn-1)}}),n.CursorColumnSelectLeft=qe(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(b,v,w,y){return sg.columnSelectLeft(b.cursorConfig,b,w)}}),n.CursorColumnSelectRight=qe(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(b,v,w,y){return sg.columnSelectRight(b.cursorConfig,b,w)}});class i extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,w,y,x){return sg.columnSelectUp(v.cursorConfig,v,y,this._isPaged)}}n.CursorColumnSelectUp=qe(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3600,linux:{primary:0}}})),n.CursorColumnSelectPageUp=qe(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3595,linux:{primary:0}}}));class s extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,w,y,x){return sg.columnSelectDown(v.cursorConfig,v,y,this._isPaged)}}n.CursorColumnSelectDown=qe(new s({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3602,linux:{primary:0}}})),n.CursorColumnSelectPageDown=qe(new s({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends Li{constructor(){super({id:"cursorMove",precondition:void 0,description:eD.description})}runCoreEditorCommand(v,w){const y=eD.parse(w);y&&this._runCursorMove(v,w.source,y)}_runCursorMove(v,w,y){v.model.pushStackElement(),v.setCursorStates(w,3,r._move(v,v.getCursorStates(),y)),v.revealPrimaryCursor(w,!0)}static _move(v,w,y){const x=y.select,D=y.value;switch(y.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return jn.simpleMove(v,w,y.direction,x,D,y.unit);case 11:case 13:case 12:case 14:return jn.viewportMove(v,w,y.direction,x,D);default:return null}}}n.CursorMoveImpl=r,n.CursorMove=qe(new r);class o extends Li{constructor(v){super(v),this._staticArgs=v.args}runCoreEditorCommand(v,w){let y=this._staticArgs;this._staticArgs.value===-1&&(y={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:w.pageSize||v.cursorConfig.pageSize}),v.model.pushStackElement(),v.setCursorStates(w.source,3,jn.simpleMove(v,v.getCursorStates(),y.direction,y.select,y.value,y.unit)),v.revealPrimaryCursor(w.source,!0)}}n.CursorLeft=qe(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),n.CursorLeftSelect=qe(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1039}})),n.CursorRight=qe(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),n.CursorRightSelect=qe(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1041}})),n.CursorUp=qe(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),n.CursorUpSelect=qe(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),n.CursorPageUp=qe(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:11}})),n.CursorPageUpSelect=qe(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1035}})),n.CursorDown=qe(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),n.CursorDownSelect=qe(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),n.CursorPageDown=qe(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:12}})),n.CursorPageDownSelect=qe(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1036}})),n.CreateCursor=qe(new class extends Li{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;let w;v.wholeLine?w=jn.line(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition):w=jn.moveTo(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition);const y=b.getCursorStates();if(y.length>1){const x=w.modelState?w.modelState.position:null,D=w.viewState?w.viewState.position:null;for(let S=0,T=y.length;S<T;S++){const k=y[S];if(!(x&&!k.modelState.selection.containsPosition(x))&&!(D&&!k.viewState.selection.containsPosition(D))){y.splice(S,1),b.model.pushStackElement(),b.setCursorStates(v.source,3,y);return}}}y.push(w),b.model.pushStackElement(),b.setCursorStates(v.source,3,y)}}),n.LastCursorMoveToSelect=qe(new class extends Li{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const w=b.getLastAddedCursorIndex(),y=b.getCursorStates(),x=y.slice(0);x[w]=jn.moveTo(b,y[w],!0,v.position,v.viewPosition),b.model.pushStackElement(),b.setCursorStates(v.source,3,x)}});class a extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,jn.moveToBeginningOfLine(v,v.getCursorStates(),this._inSelectionMode)),v.revealPrimaryCursor(w.source,!0)}}n.CursorHome=qe(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),n.CursorHomeSelect=qe(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,this._exec(v.getCursorStates())),v.revealPrimaryCursor(w.source,!0)}_exec(v){const w=[];for(let y=0,x=v.length;y<x;y++){const D=v[y],S=D.modelState.position.lineNumber;w[y]=St.fromModelState(D.modelState.move(this._inSelectionMode,S,1,0))}return w}}n.CursorLineStart=qe(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:0,mac:{primary:287}}})),n.CursorLineStartSelect=qe(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,jn.moveToEndOfLine(v,v.getCursorStates(),this._inSelectionMode,w.sticky||!1)),v.revealPrimaryCursor(w.source,!0)}}n.CursorEnd=qe(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:It,kbExpr:ee.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:_("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),n.CursorEndSelect=qe(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:It,kbExpr:ee.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:_("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class u extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,this._exec(v,v.getCursorStates())),v.revealPrimaryCursor(w.source,!0)}_exec(v,w){const y=[];for(let x=0,D=w.length;x<D;x++){const S=w[x],T=S.modelState.position.lineNumber,k=v.model.getLineMaxColumn(T);y[x]=St.fromModelState(S.modelState.move(this._inSelectionMode,T,k,0))}return y}}n.CursorLineEnd=qe(new u({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:0,mac:{primary:291}}})),n.CursorLineEndSelect=qe(new u({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,jn.moveToBeginningOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealPrimaryCursor(w.source,!0)}}n.CursorTop=qe(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2062,mac:{primary:2064}}})),n.CursorTopSelect=qe(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3086,mac:{primary:3088}}}));class d extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){v.model.pushStackElement(),v.setCursorStates(w.source,3,jn.moveToEndOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealPrimaryCursor(w.source,!0)}}n.CursorBottom=qe(new d({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2061,mac:{primary:2066}}})),n.CursorBottomSelect=qe(new d({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends Li{constructor(){super({id:"editorScroll",precondition:void 0,description:qn.description})}determineScrollMethod(v){const w=[6],y=[1,2,3,4,5,6],x=[4,2],D=[1,3];return w.includes(v.unit)&&x.includes(v.direction)?this._runHorizontalEditorScroll.bind(this):y.includes(v.unit)&&D.includes(v.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(v,w){const y=qn.parse(w);if(!y)return;const x=this.determineScrollMethod(y);x&&x(v,w.source,y)}_runVerticalEditorScroll(v,w,y){const x=this._computeDesiredScrollTop(v,y);if(y.revealCursor){const D=v.getCompletelyVisibleViewRangeAtScrollTop(x);v.setCursorStates(w,3,[jn.findPositionInViewportIfOutside(v,v.getPrimaryCursorState(),D,y.select)])}v.viewLayout.setScrollPosition({scrollTop:x},0)}_computeDesiredScrollTop(v,w){if(w.unit===1){const D=v.viewLayout.getFutureViewport(),S=v.getCompletelyVisibleViewRangeAtScrollTop(D.top),T=v.coordinatesConverter.convertViewRangeToModelRange(S);let k;w.direction===1?k=Math.max(1,T.startLineNumber-w.value):k=Math.min(v.model.getLineCount(),T.startLineNumber+w.value);const I=v.coordinatesConverter.convertModelPositionToViewPosition(new X(k,1));return v.viewLayout.getVerticalOffsetForLineNumber(I.lineNumber)}if(w.unit===5){let D=0;return w.direction===3&&(D=v.model.getLineCount()-v.cursorConfig.pageSize),v.viewLayout.getVerticalOffsetForLineNumber(D)}let y;w.unit===3?y=v.cursorConfig.pageSize*w.value:w.unit===4?y=Math.round(v.cursorConfig.pageSize/2)*w.value:y=w.value;const x=(w.direction===1?-1:1)*y;return v.viewLayout.getCurrentScrollTop()+x*v.cursorConfig.lineHeight}_runHorizontalEditorScroll(v,w,y){const x=this._computeDesiredScrollLeft(v,y);v.viewLayout.setScrollPosition({scrollLeft:x},0)}_computeDesiredScrollLeft(v,w){const y=(w.direction===4?-1:1)*w.value;return v.viewLayout.getCurrentScrollLeft()+y*v.cursorConfig.typicalHalfwidthCharacterWidth}}n.EditorScrollImpl=f,n.EditorScroll=qe(new f),n.ScrollLineUp=qe(new class extends Li{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Up,by:qn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollPageUp=qe(new class extends Li{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Up,by:qn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollEditorTop=qe(new class extends Li{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Up,by:qn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollLineDown=qe(new class extends Li{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Down,by:qn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollPageDown=qe(new class extends Li{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Down,by:qn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollEditorBottom=qe(new class extends Li{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Down,by:qn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollLeft=qe(new class extends Li{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Left,by:qn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}}),n.ScrollRight=qe(new class extends Li{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus}})}runCoreEditorCommand(b,v){n.EditorScroll.runCoreEditorCommand(b,{to:qn.RawDirection.Right,by:qn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}});class g extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){w.position&&(v.model.pushStackElement(),v.setCursorStates(w.source,3,[jn.word(v,v.getPrimaryCursorState(),this._inSelectionMode,w.position)]),w.revealType!==2&&v.revealPrimaryCursor(w.source,!0,!0))}}n.WordSelect=qe(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),n.WordSelectDrag=qe(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),n.LastCursorWordSelect=qe(new class extends Li{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const w=b.getLastAddedCursorIndex(),y=b.getCursorStates(),x=y.slice(0),D=y[w];x[w]=jn.word(b,D,D.modelState.hasSelection(),v.position),b.model.pushStackElement(),b.setCursorStates(v.source,3,x)}});class p extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){w.position&&(v.model.pushStackElement(),v.setCursorStates(w.source,3,[jn.line(v,v.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)]),w.revealType!==2&&v.revealPrimaryCursor(w.source,!1,!0))}}n.LineSelect=qe(new p({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),n.LineSelectDrag=qe(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class m extends Li{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,w){if(!w.position)return;const y=v.getLastAddedCursorIndex(),x=v.getCursorStates(),D=x.slice(0);D[y]=jn.line(v,x[y],this._inSelectionMode,w.position,w.viewPosition),v.model.pushStackElement(),v.setCursorStates(w.source,3,D)}}n.LastCursorLineSelect=qe(new m({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),n.LastCursorLineSelectDrag=qe(new m({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),n.CancelSelection=qe(new class extends Li{constructor(){super({id:"cancelSelection",precondition:ee.hasNonEmptySelection,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[jn.cancelSelection(b,b.getPrimaryCursorState())]),b.revealPrimaryCursor(v.source,!0)}}),n.RemoveSecondaryCursors=qe(new class extends Li{constructor(){super({id:"removeSecondaryCursors",precondition:ee.hasMultipleSelections,kbOpts:{weight:It+1,kbExpr:ee.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[b.getPrimaryCursorState()]),b.revealPrimaryCursor(v.source,!0),ky(_("removedCursor","Removed secondary cursors"))}}),n.RevealLine=qe(new class extends Li{constructor(){super({id:"revealLine",precondition:void 0,description:S0.description})}runCoreEditorCommand(b,v){const w=v,y=w.lineNumber||0;let x=typeof y=="number"?y+1:parseInt(y)+1;x<1&&(x=1);const D=b.model.getLineCount();x>D&&(x=D);const S=new H(x,1,x,b.model.getLineMaxColumn(x));let T=0;if(w.at)switch(w.at){case S0.RawAtArgument.Top:T=3;break;case S0.RawAtArgument.Center:T=1;break;case S0.RawAtArgument.Bottom:T=4;break}const k=b.coordinatesConverter.convertModelRangeToViewRange(S);b.revealRange(v.source,!1,k,T,0)}}),n.SelectAll=new class extends bF{constructor(){super(BNe)}runDOMCommand(b){Ra&&(b.focus(),b.select()),b.ownerDocument.execCommand("selectAll")}runEditorCommand(b,v,w){const y=v._getViewModel();y&&this.runCoreEditorCommand(y,w)}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates("keyboard",3,[jn.selectAll(b,b.getPrimaryCursorState())])}},n.SetSelection=qe(new class extends Li{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(b,v){v.selection&&(b.model.pushStackElement(),b.setCursorStates(v.source,3,[St.fromModelSelection(v.selection)]))}})})(Sn||(Sn={}));const JPe=Ve.and(ee.textInputFocus,ee.columnSelection);function Yb(n,e){wr.registerKeybindingRule({id:n,primary:e,when:JPe,weight:It+1})}Yb(Sn.CursorColumnSelectLeft.id,1039);Yb(Sn.CursorColumnSelectRight.id,1041);Yb(Sn.CursorColumnSelectUp.id,1040);Yb(Sn.CursorColumnSelectPageUp.id,1035);Yb(Sn.CursorColumnSelectDown.id,1042);Yb(Sn.CursorColumnSelectPageDown.id,1036);function EU(n){return n.register(),n}var TU;(function(n){class e extends Pa{runEditorCommand(i,s,r){const o=s._getViewModel();o&&this.runCoreEditingCommand(s,o,r||{})}}n.CoreEditingCommand=e,n.LineBreakInsert=qe(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:ee.writable,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,Ni.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection)))}}),n.Outdent=qe(new class extends e{constructor(){super({id:"outdent",precondition:ee.writable,kbOpts:{weight:It,kbExpr:Ve.and(ee.editorTextFocus,ee.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,Ni.outdent(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),n.Tab=qe(new class extends e{constructor(){super({id:"tab",precondition:ee.writable,kbOpts:{weight:It,kbExpr:Ve.and(ee.editorTextFocus,ee.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,Ni.tab(i.cursorConfig,i.model,i.getCursorStates().map(r=>r.modelState.selection))),t.pushUndoStop()}}),n.DeleteLeft=qe(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,s){const[r,o]=Dp.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(2)}}),n.DeleteRight=qe(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:It,kbExpr:ee.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,s){const[r,o]=Dp.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));r&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(3)}}),n.Undo=new class extends bF{constructor(){super(dne)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,s){if(!(!i.hasModel()||i.getOption(90)===!0))return i.getModel().undo()}},n.Redo=new class extends bF{constructor(){super(fne)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,s){if(!(!i.hasModel()||i.getOption(90)===!0))return i.getModel().redo()}}})(TU||(TU={}));class AU extends kT{constructor(e,t,i){super({id:e,precondition:void 0,description:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ci).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function cm(n,e){EU(new AU("default:"+n,n)),EU(new AU(n,n,e))}cm("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});cm("replacePreviousChar");cm("compositionType");cm("compositionStart");cm("compositionEnd");cm("paste");cm("cut");class eOe{constructor(e,t,i,s){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=s}paste(e,t,i,s){this.commandDelegate.paste(e,t,i,s)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,s){this.commandDelegate.compositionType(e,t,i,s)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Sn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new X(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=Ts&&t.get(106),s=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):s?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Sn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Sn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Sn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Sn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Sn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Sn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Sn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Sn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Sn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Sn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Sn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Sn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Sn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class HT{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)===null||t===void 0||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)===null||t===void 0||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)===null||e===void 0||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)===null||t===void 0||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return HT.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new X(e.afterLineNumber,1)).lineNumber}}}class xse{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new mn("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),s=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>s)return null;let r=0,o=0;for(let l=i;l<=s;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(o===0?(r=c,o=1):o++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(r,o)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const s=this.getStartLineNumber(),r=this.getEndLineNumber();let o=!1;for(let a=e;a<=i;a++)a>=s&&a<=r&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),o=!0);return o}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,s=this.getStartLineNumber(),r=this.getEndLineNumber();if(e<=s)return this._rendLineNumberStart+=i,null;if(e>r)return null;if(i+e>r)return this._lines.splice(e-this._rendLineNumberStart,r-e+1);const o=[];for(let h=0;h<i;h++)o[h]=this._createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),u=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(o).concat(c),u}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let s=!1;for(let r=0,o=e.length;r<o;r++){const a=e[r];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let u=l;u<=c;u++){const h=u-this._rendLineNumberStart;this._lines[h].onTokensChanged(),s=!0}}return s}}class kse{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new xse(()=>this._host.createVisibleLine())}_createDomNode(){const e=Bt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(143)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,s=t.length;i<s;i++){const r=t[i].getDomNode();r&&this.domNode.domNode.removeChild(r)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,s=t.length;i<s;i++){const r=t[i].getDomNode();r&&this.domNode.domNode.removeChild(r)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new Nu(this.domNode.domNode,this._host,e),s={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},r=i.render(s,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(r.rendLineNumberStart,r.lines)}}class Nu{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,s){const r={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(r.rendLineNumberStart+r.linesLength-1<t||i<r.rendLineNumberStart){r.rendLineNumberStart=t,r.linesLength=i-t+1,r.lines=[];for(let o=t;o<=i;o++)r.lines[o-t]=this.host.createVisibleLine();return this._finishRendering(r,!0,s),r}if(this._renderUntouchedLines(r,Math.max(t-r.rendLineNumberStart,0),Math.min(i-r.rendLineNumberStart,r.linesLength-1),s,t),r.rendLineNumberStart>t){const o=t,a=Math.min(i,r.rendLineNumberStart-1);o<=a&&(this._insertLinesBefore(r,o,a,s,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart<t){const o=Math.min(r.linesLength,t-r.rendLineNumberStart);o>0&&(this._removeLinesBefore(r,o),r.linesLength-=o)}if(r.rendLineNumberStart=t,r.rendLineNumberStart+r.linesLength-1<i){const o=r.rendLineNumberStart+r.linesLength,a=i;o<=a&&(this._insertLinesAfter(r,o,a,s,t),r.linesLength+=a-o+1)}else if(r.rendLineNumberStart+r.linesLength-1>i){const o=Math.max(0,i-r.rendLineNumberStart+1),l=r.linesLength-1-o+1;l>0&&(this._removeLinesAfter(r,l),r.linesLength-=l)}return this._finishRendering(r,!1,s),r}_renderUntouchedLines(e,t,i,s,r){const o=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=o+l;a[l].layoutLine(c,s[c-r])}}_insertLinesBefore(e,t,i,s,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this.host.createVisibleLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const s=e.lines[i].getDomNode();s&&this.domNode.removeChild(s)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,s,r){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this.host.createVisibleLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let s=0;s<t;s++){const r=e.lines[i+s].getDomNode();r&&this.domNode.removeChild(r)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,s){Nu._ttPolicy&&(i=Nu._ttPolicy.createHTML(i));const r=this.domNode.lastChild;t||!r?this.domNode.innerHTML=i:r.insertAdjacentHTML("afterend",i);let o=this.domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];s[a]&&(l.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const s=document.createElement("div");Nu._ttPolicy&&(t=Nu._ttPolicy.createHTML(t)),s.innerHTML=t;for(let r=0;r<e.linesLength;r++){const o=e.lines[r];if(i[r]){const a=s.firstChild,l=o.getDomNode();l.parentNode.replaceChild(a,l),o.setDomNode(a)}}}_finishRendering(e,t,i){const s=Nu._sb,r=e.linesLength,o=e.lines,a=e.rendLineNumberStart,l=[];{s.reset();let c=!1;for(let u=0;u<r;u++){const h=o[u];l[u]=!1,!(h.getDomNode()||!h.renderLine(u+a,i[u],this.viewportData,s))&&(l[u]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,s.build(),l)}{s.reset();let c=!1;const u=[];for(let h=0;h<r;h++){const d=o[h];u[h]=!1,!(l[h]||!d.renderLine(h+a,i[h],this.viewportData,s))&&(u[h]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,s.build(),u)}}}Nu._ttPolicy=rm("editorViewLayer",{createHTML:n=>n});Nu._sb=new ET(1e5);class Lse extends jr{constructor(e){super(e),this._visibleLines=new kse(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);fs(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new tOe(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let o=t;o<=i;o++)this._visibleLines.getVisibleLine(o).onConfigurationChanged(e);const r=this._context.configuration.options.get(50);return fs(this.domNode,r),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,s=t.length;i<s;i++){const r=t[i];r.prepareRender(e),r.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class tOe{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(66),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=Bt(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(66)}renderLine(e,t,i,s){let r="";for(let o=0,a=this._dynamicOverlays.length;o<a;o++){const l=this._dynamicOverlays[o];r+=l.render(i.startLineNumber,e)}return this._renderedContent===r?!1:(this._renderedContent=r,s.appendString('<div style="position:absolute;top:'),s.appendString(String(t)),s.appendString("px;width:100%;height:"),s.appendString(String(this._lineHeight)),s.appendString('px;">'),s.appendString(r),s.appendString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class iOe extends Lse{constructor(e){super(e);const i=this._context.configuration.options.get(143);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class nOe extends Lse{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),fs(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;fs(this.domNode,t.get(50));const i=t.get(143);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class sOe extends jr{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=Bt(document.createElement("div")),Nc.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=Bt(document.createElement("div")),Nc.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new rOe(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,s,r){this._widgets[e.getId()].setPosition(t,i,s,r),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const s=i.domNode.domNode;s.parentNode.removeChild(s),s.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class rOe{constructor(e,t,i){this._primaryAnchor=new T1(null,null),this._secondaryAnchor=new T1(null,null),this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=Bt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const s=this._context.configuration.options,r=s.get(143);this._fixedOverflowWidgets=s.get(42),this._contentWidth=r.contentWidth,this._contentLeft=r.contentLeft,this._lineHeight=s.get(66),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(66),e.hasChanged(143)){const i=t.get(143);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=s(t,this._context.viewModel,this._affinity),this._secondaryAnchor=s(i,this._context.viewModel,this._affinity);function s(r,o,a){if(!r)return new T1(null,null);const l=o.model.validatePosition(r);if(o.coordinatesConverter.modelPositionIsVisible(l)){const c=o.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new T1(r,c)}return new T1(r,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,s){this._setPosition(s,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,s){const r=e.top,o=r,a=e.top+e.height,l=s.viewportHeight-a,c=r-i,u=o>=i,h=a,d=l>=i;let f=e.left;return f+t>s.scrollLeft+s.viewportWidth&&(f=s.scrollLeft+s.viewportWidth-t),f<s.scrollLeft&&(f=s.scrollLeft),{fitsAbove:u,aboveTop:c,fitsBelow:d,belowTop:h,left:f}}_layoutHorizontalSegmentInPage(e,t,i,s){var r;const l=Math.max(15,t.left-s),c=Math.min(t.left+t.width+s,e.width-15),h=this._viewDomNode.domNode.ownerDocument.defaultView;let d=t.left+i-((r=h==null?void 0:h.scrollX)!==null&&r!==void 0?r:0);if(d+s>c){const f=d-(c-s);d-=f,i-=f}if(d<l){const f=d-l;d-=f,i-=f}return[i,d]}_layoutBoxInPage(e,t,i,s){var r,o;const a=e.top-i,l=e.top+e.height,c=hs(this._viewDomNode.domNode),u=this._viewDomNode.domNode.ownerDocument,h=u.defaultView,d=c.top+a-((r=h==null?void 0:h.scrollY)!==null&&r!==void 0?r:0),f=c.top+l-((o=h==null?void 0:h.scrollY)!==null&&o!==void 0?o:0),g=xT(u.body),[p,m]=this._layoutHorizontalSegmentInPage(g,c,e.left-s.scrollLeft+this._contentLeft,t),b=22,v=22,w=d>=b,y=f+i<=g.height-v;return this._fixedOverflowWidgets?{fitsAbove:w,aboveTop:Math.max(d,b),fitsBelow:y,belowTop:f,left:m}:{fitsAbove:w,aboveTop:a,fitsBelow:y,belowTop:l,left:p}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new A1(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var t,i;const s=a(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),r=((t=this._secondaryAnchor.viewPosition)===null||t===void 0?void 0:t.lineNumber)===((i=this._primaryAnchor.viewPosition)===null||i===void 0?void 0:i.lineNumber)?this._secondaryAnchor.viewPosition:null,o=a(r,this._affinity,this._lineHeight);return{primary:s,secondary:o};function a(l,c,u){if(!l)return null;const h=e.visibleRangeForPosition(l);if(!h)return null;const d=l.column===1&&c===3?0:h.left,f=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop;return new IU(f,d,u)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const s=this._context.configuration.options.get(50);let r=t.left;return r<e.left?r=Math.max(r,e.left-i+s.typicalFullwidthCharacterWidth):r=Math.min(r,e.left+i-s.typicalFullwidthCharacterWidth),new IU(e.top,r,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return null;if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let o=null;if(typeof this._actual.beforeRender=="function"&&(o=nR(this._actual.beforeRender,this._actual)),o)this._cachedDomNodeOffsetWidth=o.width,this._cachedDomNodeOffsetHeight=o.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const s=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let r;this.allowEditorOverflow?r=this._layoutBoxInPage(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):r=this._layoutBoxInViewport(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let o=1;o<=2;o++)for(const a of this._preference)if(a===1){if(!r)return null;if(o===2||r.fitsAbove)return{coordinate:new A1(r.aboveTop,r.left),position:1}}else if(a===2){if(!r)return null;if(o===2||r.fitsBelow)return{coordinate:new A1(r.belowTop,r.left),position:2}}else return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new A1(s.top,s.left)),position:0}:{coordinate:new A1(s.top,s.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&nR(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&nR(this._actual.afterRender,this._actual,this._renderData.position)}}class T1{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class A1{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class IU{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function nR(n,e,...t){try{return n.call(e,...t)}catch{return null}}class Dse extends lm{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(143);this._lineHeight=t.get(66),this._renderLineHighlight=t.get(95),this._renderLineHighlightOnlyWhenFocus=t.get(96),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Lt(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=this._selections.map(s=>s.positionLineNumber);t.sort((s,r)=>s-r),yn(this._cursorLineNumbers,t)||(this._cursorLineNumbers=t,e=!0);const i=this._selections.every(s=>s.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._renderLineHighlight=t.get(95),this._renderLineHighlightOnlyWhenFocus=t.get(96),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=this._renderOne(e),i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,r=this._cursorLineNumbers.length;let o=0;const a=[];for(let l=i;l<=s;l++){const c=l-i;for(;o<r&&this._cursorLineNumbers[o]<l;)o++;o<r&&this._cursorLineNumbers[o]===l?a[c]=t:a[c]=""}this._renderData=a}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class oOe extends Dse{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class aOe extends Dse{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}$a((n,e)=>{const t=n.getColor(fse);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||n.defines(kU)){const i=n.getColor(kU);i&&(e.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${i}; }`),Gu(n.type)&&(e.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}});class lOe extends lm{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],s=0;for(let l=0,c=t.length;l<c;l++){const u=t[l];u.options.className&&(i[s++]=u)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const u=l.options.className,h=c.options.className;return u<h?-1:u>h?1:H.compareRangesUsingStarts(l.range,c.range)});const r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[];for(let l=r;l<=o;l++){const c=l-r;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const s=String(this._lineHeight),r=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let a=0,l=t.length;a<l;a++){const c=t[a];if(!c.options.isWholeLine)continue;const u='<div class="cdr '+c.options.className+'" style="left:0;width:100%;height:'+s+'px;"></div>',h=Math.max(c.range.startLineNumber,r),d=Math.min(c.range.endLineNumber,o);for(let f=h;f<=d;f++){const g=f-r;i[g]+=u}}}_renderNormalDecorations(e,t,i){var s;const r=String(this._lineHeight),o=e.visibleRange.startLineNumber;let a=null,l=!1,c=null,u=!1;for(let h=0,d=t.length;h<d;h++){const f=t[h];if(f.options.isWholeLine)continue;const g=f.options.className,p=!!f.options.showIfCollapsed;let m=f.range;if(p&&m.endColumn===1&&m.endLineNumber!==m.startLineNumber&&(m=new H(m.startLineNumber,m.startColumn,m.endLineNumber-1,this._context.viewModel.getLineMaxColumn(m.endLineNumber-1))),a===g&&l===p&&H.areIntersectingOrTouching(c,m)){c=H.plusRange(c,m);continue}a!==null&&this._renderNormalDecoration(e,c,a,u,l,r,o,i),a=g,l=p,c=m,u=(s=f.options.shouldFillLineOnLineBreak)!==null&&s!==void 0?s:!1}a!==null&&this._renderNormalDecoration(e,c,a,u,l,r,o,i)}_renderNormalDecoration(e,t,i,s,r,o,a,l){const c=e.linesVisibleRangesForRange(t,i==="findMatch");if(c)for(let u=0,h=c.length;u<h;u++){const d=c[u];if(d.outsideRenderedLine)continue;const f=d.lineNumber-a;if(r&&d.ranges.length===1){const g=d.ranges[0];if(g.width<this._typicalHalfwidthCharacterWidth){const p=Math.round(g.left+g.width/2),m=Math.max(0,Math.round(p-this._typicalHalfwidthCharacterWidth/2));d.ranges[0]=new VT(m,this._typicalHalfwidthCharacterWidth)}}for(let g=0,p=d.ranges.length;g<p;g++){const m=s&&d.continuesOnNextLine&&p===1,b=d.ranges[g],v='<div class="cdr '+i+'" style="left:'+String(b.left)+(m?"px;width:100%;height:":"px;width:"+String(b.width)+"px;height:")+o+'px;"></div>';l[f]+=v}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class cOe extends jr{constructor(e,t,i,s){super(e);const r=this._context.configuration.options,o=r.get(102),a=r.get(74),l=r.get(40),c=r.get(105),u={listenOnDomNode:i.domNode,className:"editor-scrollable "+pF(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:o.scrollByPage};this.scrollbar=this._register(new G8(t.domNode,u,this._context.viewLayout.getScrollable())),Nc.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=Bt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const h=(d,f,g)=>{const p={};if(f){const m=d.scrollTop;m&&(p.scrollTop=this._context.viewLayout.getCurrentScrollTop()+m,d.scrollTop=0)}if(g){const m=d.scrollLeft;m&&(p.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+m,d.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(p,1)};this._register(oe(i.domNode,"scroll",d=>h(i.domNode,!0,!0))),this._register(oe(t.domNode,"scroll",d=>h(t.domNode,!0,!1))),this._register(oe(s.domNode,"scroll",d=>h(s.domNode,!0,!1))),this._register(oe(this.scrollbarDomNode.domNode,"scroll",d=>h(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(143);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(72).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(102)||e.hasChanged(74)||e.hasChanged(40)){const t=this._context.configuration.options,i=t.get(102),s=t.get(74),r=t.get(40),o=t.get(105),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:s,fastScrollSensitivity:r,scrollPredominantAxis:o};this.scrollbar.updateOptions(a)}return e.hasChanged(143)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+pF(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class Ese extends ae{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function UT(n,e){let t=0,i=0;const s=n.length;for(;i<s;){const r=n.charCodeAt(i);if(r===32)t++;else if(r===9)t=t-t%e+e;else break;i++}return i===s?-1:t}var Gg;(function(n){n[n.Disabled=0]="Disabled",n[n.EnabledForActive=1]="EnabledForActive",n[n.Enabled=2]="Enabled"})(Gg||(Gg={}));class Ag{constructor(e,t,i,s,r,o){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=s,this.forWrappedLinesAfterColumn=r,this.forWrappedLinesBeforeOrAtColumn=o,e!==-1==(t!==-1))throw new Error}}class Zv{constructor(e,t){this.top=e,this.endColumn=t}}class uOe extends Ese{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return UT(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const s=this.textModel.getLineCount();if(e<1||e>s)throw new mn("Illegal value for lineNumber");const r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide);let a=-2,l=-1,c=-2,u=-1;const h=S=>{if(a!==-1&&(a===-2||a>S-1)){a=-1,l=-1;for(let T=S-2;T>=0;T--){const k=this._computeIndentLevel(T);if(k>=0){a=T,l=k;break}}}if(c===-2){c=-1,u=-1;for(let T=S;T<s;T++){const k=this._computeIndentLevel(T);if(k>=0){c=T,u=k;break}}}};let d=-2,f=-1,g=-2,p=-1;const m=S=>{if(d===-2){d=-1,f=-1;for(let T=S-2;T>=0;T--){const k=this._computeIndentLevel(T);if(k>=0){d=T,f=k;break}}}if(g!==-1&&(g===-2||g<S-1)){g=-1,p=-1;for(let T=S;T<s;T++){const k=this._computeIndentLevel(T);if(k>=0){g=T,p=k;break}}}};let b=0,v=!0,w=0,y=!0,x=0,D=0;for(let S=0;v||y;S++){const T=e-S,k=e+S;S>1&&(T<1||T<t)&&(v=!1),S>1&&(k>s||k>i)&&(y=!1),S>5e4&&(v=!1,y=!1);let I=-1;if(v&&T>=1){const z=this._computeIndentLevel(T-1);z>=0?(c=T-1,u=z,I=Math.ceil(z/this.textModel.getOptions().indentSize)):(h(T),I=this._getIndentLevelForWhitespaceLine(o,l,u))}let N=-1;if(y&&k<=s){const z=this._computeIndentLevel(k-1);z>=0?(d=k-1,f=z,N=Math.ceil(z/this.textModel.getOptions().indentSize)):(m(k),N=this._getIndentLevelForWhitespaceLine(o,f,p))}if(S===0){D=I;continue}if(S===1){if(k<=s&&N>=0&&D+1===N){v=!1,b=k,w=k,x=N;continue}if(T>=1&&I>=0&&I-1===D){y=!1,b=T,w=T,x=I;continue}if(b=e,w=e,x=D,x===0)return{startLineNumber:b,endLineNumber:w,indent:x}}v&&(I>=x?b=T:v=!1),y&&(N>=x?w=k:y=!1)}return{startLineNumber:b,endLineNumber:w,indent:x}}getLinesBracketGuides(e,t,i,s){var r;const o=[];for(let d=e;d<=t;d++)o.push([]);const a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new H(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let c;if(i&&l.length>0){const d=(e<=i.lineNumber&&i.lineNumber<=t?l:this.textModel.bracketPairs.getBracketPairsInRange(H.fromPositions(i)).toArray()).filter(f=>H.strictContainsPosition(f.range,i));c=(r=Q3(d,f=>a))===null||r===void 0?void 0:r.range}const u=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,h=new Tse;for(const d of l){if(!d.closingBracketRange)continue;const f=c&&d.range.equalsRange(c);if(!f&&!s.includeInactive)continue;const g=h.getInlineClassName(d.nestingLevel,d.nestingLevelOfEqualBracketType,u)+(s.highlightActive&&f?" "+h.activeClassName:""),p=d.openingBracketRange.getStartPosition(),m=d.closingBracketRange.getStartPosition(),b=s.horizontalGuides===Gg.Enabled||s.horizontalGuides===Gg.EnabledForActive&&f;if(d.range.startLineNumber===d.range.endLineNumber){b&&o[d.range.startLineNumber-e].push(new Ag(-1,d.openingBracketRange.getEndPosition().column,g,new Zv(!1,m.column),-1,-1));continue}const v=this.getVisibleColumnFromPosition(m),w=this.getVisibleColumnFromPosition(d.openingBracketRange.getStartPosition()),y=Math.min(w,v,d.minVisibleColumnIndentation+1);let x=!1;Pr(this.textModel.getLineContent(d.closingBracketRange.startLineNumber))<d.closingBracketRange.startColumn-1&&(x=!0);const T=Math.max(p.lineNumber,e),k=Math.min(m.lineNumber,t),I=x?1:0;for(let N=T;N<k+I;N++)o[N-e].push(new Ag(y,-1,g,null,N===p.lineNumber?p.column:-1,N===m.lineNumber?m.column:-1));b&&(p.lineNumber>=e&&w>y&&o[p.lineNumber-e].push(new Ag(y,-1,g,new Zv(!1,p.column),-1,-1)),m.lineNumber<=t&&v>y&&o[m.lineNumber-e].push(new Ag(y,-1,g,new Zv(!x,m.column),-1,-1)))}for(const d of o)d.sort((f,g)=>f.visibleColumn-g.visibleColumn);return o}getVisibleColumnFromPosition(e){return _n.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const s=this.textModel.getOptions(),r=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,o=!!(r&&r.offSide),a=new Array(t-e+1);let l=-2,c=-1,u=-2,h=-1;for(let d=e;d<=t;d++){const f=d-e,g=this._computeIndentLevel(d-1);if(g>=0){l=d-1,c=g,a[f]=Math.ceil(g/s.indentSize);continue}if(l===-2){l=-1,c=-1;for(let p=d-2;p>=0;p--){const m=this._computeIndentLevel(p);if(m>=0){l=p,c=m;break}}}if(u!==-1&&(u===-2||u<d-1)){u=-1,h=-1;for(let p=d;p<i;p++){const m=this._computeIndentLevel(p);if(m>=0){u=p,h=m;break}}}a[f]=this._getIndentLevelForWhitespaceLine(o,c,h)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const s=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/s.indentSize):t===i||e?Math.ceil(i/s.indentSize):1+Math.floor(i/s.indentSize)}}class Tse{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class hOe extends lm{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(144),s=t.get(50);this._lineHeight=t.get(66),this._spaceWidth=s.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(144),s=t.get(50);return this._lineHeight=t.get(66),this._spaceWidth=s.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){var t;const s=e.selections[0].getPosition();return!((t=this._primaryPosition)===null||t===void 0)&&t.equals(s)?!1:(this._primaryPosition=s,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var t,i,s,r;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const o=e.visibleRange.startLineNumber,a=e.visibleRange.endLineNumber,l=e.scrollWidth,c=this._lineHeight,u=this._primaryPosition,h=this.getGuidesByLine(o,Math.min(a+1,this._context.viewModel.getLineCount()),u),d=[];for(let f=o;f<=a;f++){const g=f-o,p=h[g];let m="";const b=(i=(t=e.visibleRangeForPosition(new X(f,1)))===null||t===void 0?void 0:t.left)!==null&&i!==void 0?i:0;for(const v of p){const w=v.column===-1?b+(v.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new X(f,v.column)).left;if(w>l||this._maxIndentLeft>0&&w>this._maxIndentLeft)break;const y=v.horizontalLine?v.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",x=v.horizontalLine?((r=(s=e.visibleRangeForPosition(new X(f,v.horizontalLine.endColumn)))===null||s===void 0?void 0:s.left)!==null&&r!==void 0?r:w+this._spaceWidth)-w:this._spaceWidth;m+=`<div class="core-guide ${v.className} ${y}" style="left:${w}px;height:${c}px;width:${x}px"></div>`}d[g]=m}this._renderResult=d}getGuidesByLine(e,t,i){const s=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Gg.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Gg.EnabledForActive:Gg.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,r=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let o=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const h=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);o=h.startLineNumber,a=h.endLineNumber,l=h.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),u=[];for(let h=e;h<=t;h++){const d=new Array;u.push(d);const f=s?s[h-e]:[],g=new th(f),p=r?r[h-e]:0;for(let m=1;m<=p;m++){const b=(m-1)*c+1,v=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||f.length===0)&&o<=h&&h<=a&&m===l;d.push(...g.takeWhile(y=>y.visibleColumn<b)||[]);const w=g.peek();(!w||w.visibleColumn!==b||w.horizontalLine)&&d.push(new Ag(b,-1,`core-guide-indent lvl-${(m-1)%30}`+(v?" indent-active":""),null,-1,-1))}d.push(...g.takeWhile(m=>!0)||[])}return u}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function Wm(n){if(!(n&&n.isTransparent()))return n}$a((n,e)=>{const t=[{bracketColor:pse,guideColor:CPe,guideColorActive:EPe},{bracketColor:mse,guideColor:SPe,guideColorActive:TPe},{bracketColor:_se,guideColor:xPe,guideColorActive:APe},{bracketColor:bse,guideColor:kPe,guideColorActive:IPe},{bracketColor:vse,guideColor:LPe,guideColorActive:NPe},{bracketColor:wse,guideColor:DPe,guideColorActive:RPe}],i=new Tse,s=[{indentColor:wS,indentColorActive:yS},{indentColor:nPe,indentColorActive:lPe},{indentColor:sPe,indentColorActive:cPe},{indentColor:rPe,indentColorActive:uPe},{indentColor:oPe,indentColorActive:hPe},{indentColor:aPe,indentColorActive:dPe}],r=t.map(a=>{var l,c;const u=n.getColor(a.bracketColor),h=n.getColor(a.guideColor),d=n.getColor(a.guideColorActive),f=Wm((l=Wm(h))!==null&&l!==void 0?l:u==null?void 0:u.transparent(.3)),g=Wm((c=Wm(d))!==null&&c!==void 0?c:u);if(!(!f||!g))return{guideColor:f,guideColorActive:g}}).filter(SL),o=s.map(a=>{const l=n.getColor(a.indentColor),c=n.getColor(a.indentColorActive),u=Wm(l),h=Wm(c);if(!(!u||!h))return{indentColor:u,indentColorActive:h}}).filter(SL);if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class sR{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class dOe{constructor(){this._currentVisibleRange=new H(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class fOe{constructor(e,t,i,s,r,o,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=s,this.startScrollTop=r,this.stopScrollTop=o,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class gOe{constructor(e,t,i,s,r){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=s,this.scrollType=r,this.type="selections";let o=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const u=t[l];o=Math.min(o,u.startLineNumber),a=Math.max(a,u.endLineNumber)}this.minLineNumber=o,this.maxLineNumber=a}}class jT extends jr{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new kse(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration,s=this._context.configuration.options,r=s.get(50),o=s.get(144);this._lineHeight=s.get(66),this._typicalHalfwidthCharacterWidth=r.typicalHalfwidthCharacterWidth,this._isViewportWrapping=o.isViewportWrapping,this._revealHorizontalRightPadding=s.get(99),this._cursorSurroundingLines=s.get(29),this._cursorSurroundingLinesStyle=s.get(30),this._canUseLayerHinting=!s.get(32),this._viewLineOptions=new wU(i,this._context.theme.type),Nc.write(this.domNode,7),this.domNode.setClassName(`view-lines ${i_}`),fs(this.domNode,r),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Ui(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Ui(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new dOe,this._horizontalRevealRequest=null,this._stickyScrollEnabled=s.get(114).enabled,this._maxNumberStickyLines=s.get(114).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new ac(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(144)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(50),s=t.get(144);return this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=t.get(99),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(114).enabled,this._maxNumberStickyLines=t.get(114).maxLineCount,fs(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(143)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new wU(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let r=i;r<=s;r++)this._visibleLines.getVisibleLine(r).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let s=!1;for(let r=t;r<=i;r++)s=this._visibleLines.getVisibleLine(r).onSelectionChanged()||s;return s}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++)this._visibleLines.getVisibleLine(s).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new fOe(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new gOe(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const r=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,r),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const s=this._getLineNumberFor(i);if(s===-1||s<1||s>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(s)===1)return new X(s,1);const r=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(s<r||s>o)return null;let a=this._visibleLines.getVisibleLine(s).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(s);return a<l&&(a=l),new X(s,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===ac.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++){const r=this._visibleLines.getVisibleLine(s);if(e===r.getDomNode())return s}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const s=new sR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getWidth(s);return this._updateLineWidthsSlowIfDomDidLayout(s),r}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,s=H.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!s)return null;const r=[];let o=0;const a=new sR(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(s.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),u=this._visibleLines.getEndLineNumber();for(let h=s.startLineNumber;h<=s.endLineNumber;h++){if(h<c||h>u)continue;const d=h===s.startLineNumber?s.startColumn:1,f=h!==s.endLineNumber,g=f?this._context.viewModel.getLineMaxColumn(h):s.endColumn,p=this._visibleLines.getVisibleLine(h).getVisibleRangesForRange(h,d,g,a);if(p){if(t&&h<i){const m=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new X(h+1,1)).lineNumber,m!==l&&(p.ranges[p.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}r[o++]=new SFe(p.outsideRenderedLine,h,VT.from(p.ranges),f)}}return this._updateLineWidthsSlowIfDomDidLayout(a),o===0?null:r}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const s=new sR(this.domNode.domNode,this._textRangeRestingSpot),r=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,s);return this._updateLineWidthsSlowIfDomDidLayout(s),r}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new xFe(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let s=1,r=!0;for(let o=t;o<=i;o++){const a=this._visibleLines.getVisibleLine(o);if(e&&!a.getWidthIsFast()){r=!1;continue}s=Math.max(s,a.getWidth(null))}return r&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(s),r}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let r=i;r<=s;r++){const o=this._visibleLines.getVisibleLine(r);if(o.needsMonospaceFontCheck()){const a=o.getWidth(null);a>t&&(t=a,e=r)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let r=i;r<=s;r++)this._visibleLines.getVisibleLine(r).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const s=this._computeScrollLeftToReveal(i);s&&(this._isViewportWrapping||this._ensureMaxLineWidth(s.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:s.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Ts&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let r=i;r<=s;r++)if(this._visibleLines.getVisibleLine(r).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,s,r,o){const a=e.top,l=e.height,c=a+l;let u,h,d;if(r&&r.length>0){let b=r[0].startLineNumber,v=r[0].endLineNumber;for(let w=1,y=r.length;w<y;w++){const x=r[w];b=Math.min(b,x.startLineNumber),v=Math.max(v,x.endLineNumber)}u=!1,h=this._context.viewLayout.getVerticalOffsetForLineNumber(b),d=this._context.viewLayout.getVerticalOffsetForLineNumber(v)+this._lineHeight}else if(s)u=!0,h=this._context.viewLayout.getVerticalOffsetForLineNumber(s.startLineNumber),d=this._context.viewLayout.getVerticalOffsetForLineNumber(s.endLineNumber)+this._lineHeight;else return-1;const f=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let g=0,p=0;if(f)i||(g=this._lineHeight);else{const b=Math.min(l/this._lineHeight/2,this._cursorSurroundingLines);this._stickyScrollEnabled?g=Math.max(b,this._maxNumberStickyLines)*this._lineHeight:g=b*this._lineHeight,p=Math.max(0,b-1)*this._lineHeight}i||(o===0||o===4)&&(p+=this._lineHeight),h-=g,d+=p;let m;if(d-h>l){if(!u)return-1;m=h}else if(o===5||o===6)if(o===6&&a<=h&&d<=c)m=a;else{const b=Math.max(5*this._lineHeight,l*.2),v=h-b,w=d-l;m=Math.max(w,v)}else if(o===1||o===2)if(o===2&&a<=h&&d<=c)m=a;else{const b=(h+d)/2;m=Math.max(0,b-l/2)}else m=this._computeMinimumScrolling(a,c,h,d,o===3,o===4);return m}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(143),s=t.left,r=s+t.width-i.verticalScrollbarWidth;let o=1073741824,a=0;if(e.type==="range"){const c=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!c)return null;for(const u of c.ranges)o=Math.min(o,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}else for(const c of e.selections){if(c.startLineNumber!==c.endLineNumber)return null;const u=this._visibleRangesForLineRange(c.startLineNumber,c.startColumn,c.endColumn);if(!u)return null;for(const h of u.ranges)o=Math.min(o,Math.round(h.left)),a=Math.max(a,Math.round(h.left+h.width))}return e.minimalReveal||(o=Math.max(0,o-jT.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-o>t.width?null:{scrollLeft:this._computeMinimumScrolling(s,r,o,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,s,r,o){e=e|0,t=t|0,i=i|0,s=s|0,r=!!r,o=!!o;const a=t-e;if(s-i<a){if(r)return i;if(o)return Math.max(0,s-a);if(i<e)return i;if(s>t)return Math.max(0,s-a)}else return i;return e}}jT.HORIZONTAL_EXTRA_PX=30;class vF{constructor(e,t,i,s){this._decorationToRenderBrand=void 0,this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(i),this.zIndex=s??0}}class pOe{constructor(e,t){this.className=e,this.zIndex=t}}class mOe{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class Ase extends lm{_render(e,t,i){const s=[];for(let a=e;a<=t;a++){const l=a-e;s[l]=new mOe}if(i.length===0)return s;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let r=null,o=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],u=c.className,h=c.zIndex;let d=Math.max(c.startLineNumber,e)-e;const f=Math.min(c.endLineNumber,t)-e;r===u?(d=Math.max(o+1,d),o=Math.max(o,f)):(r=u,o=f);for(let g=d;g<=o;g++)s[g].add(new pOe(u,h))}return s}}class _Oe extends jr{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(143);this.domNode=Bt(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(66),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=Bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&H.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){var t;const i=e.getId();if(this._widgets[i]){const r=this._widgets[i].domNode.domNode;delete this._widgets[i],(t=r.parentNode)===null||t===void 0||t.removeChild(r),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var i,s,r;const o=e.visibleRange.startLineNumber,a=e.visibleRange.endLineNumber,l=e.getDecorationsInViewport();for(const c of l){const u=c.options.glyphMarginClassName;if(!u)continue;const h=Math.max(c.range.startLineNumber,o),d=Math.min(c.range.endLineNumber,a),f=Math.min((s=(i=c.options.glyphMargin)===null||i===void 0?void 0:i.position)!==null&&s!==void 0?s:1,this._glyphMarginDecorationLaneCount),g=(r=c.options.zIndex)!==null&&r!==void 0?r:0;for(let p=h;p<=d;p++)t.push(new bOe(p,f,g,u))}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber;for(const r of Object.values(this._widgets)){const o=r.preference.range;if(o.endLineNumber<i||o.startLineNumber>s)continue;const a=Math.max(o.startLineNumber,i),l=Math.min(r.preference.lane,this._glyphMarginDecorationLaneCount);t.push(new vOe(a,l,r.preference.zIndex,r))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,s)=>i.lineNumber===s.lineNumber?i.lane===s.lane?i.zIndex===s.zIndex?s.type===i.type?i.type===0&&s.type===0?i.className<s.className?-1:1:0:s.type-i.type:s.zIndex-i.zIndex:i.lane-s.lane:i.lineNumber-s.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const s of Object.values(this._widgets))s.renderInfo=null;const t=new th(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const s=t.peek();if(!s)break;const r=t.takeWhile(a=>a.lineNumber===s.lineNumber&&a.lane===s.lane);if(!r||r.length===0)break;const o=r[0];if(o.type===0){const a=[];for(const l of r){if(l.zIndex!==o.zIndex||l.type!==o.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(o.accept(a.join(" ")))}else o.widget.renderInfo={lineNumber:o.lineNumber,lane:o.lane}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const s=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+(i.renderInfo.lane-1)*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(s),i.domNode.setLeft(r),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const s=this._decorationGlyphsToRender[i],r=e.viewportData.relativeVerticalOffset[s.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+(s.lane-1)*this._lineHeight;let a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=Bt(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+s.combinedClassName),a.setPosition("absolute"),a.setTop(r),a.setLeft(o),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class bOe{constructor(e,t,i,s){this.lineNumber=e,this.lane=t,this.zIndex=i,this.className=s,this.type=0}accept(e){return new wOe(this.lineNumber,this.lane,e)}}class vOe{constructor(e,t,i,s){this.lineNumber=e,this.lane=t,this.zIndex=i,this.widget=s,this.type=1}}class wOe{constructor(e,t,i){this.lineNumber=e,this.lane=t,this.combinedClassName=i}}class yOe extends Ase{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(143);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let s=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[s++]=new vF(a.range.startLineNumber,a.range.endLineNumber,l,c));const u=a.options.firstLineDecorationClassName;u&&(i[s++]=new vF(a.range.startLineNumber,a.range.startLineNumber,u,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,s=this._render(t,i,this._getDecorations(e)),r=this._decorationsLeft.toString(),o=this._decorationsWidth.toString(),a='" style="left:'+r+"px;width:"+o+'px;"></div>',l=[];for(let c=t;c<=i;c++){const u=c-t,h=s[u].getDecorations();let d="";for(const f of h)d+='<div class="cldr '+f.className+a;l[u]=d}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class COe extends Ase{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let s=0;for(let r=0,o=t.length;r<o;r++){const a=t[r],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[s++]=new vF(a.range.startLineNumber,a.range.endLineNumber,l,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,s=this._render(t,i,this._getDecorations(e)),r=[];for(let o=t;o<=i;o++){const a=o-t,l=s[a].getDecorations();let c="";for(const u of l)c+='<div class="cmdr '+u.className+'" style=""></div>';r[a]=c}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Po{constructor(e,t,i,s){this._rgba8Brand=void 0,this.r=Po._clamp(e),this.g=Po._clamp(t),this.b=Po._clamp(i),this.a=Po._clamp(s)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}}Po.Empty=new Po(0,0,0,0);class SS extends ae{static getInstance(){return this._INSTANCE||(this._INSTANCE=new SS),this._INSTANCE}constructor(){super(),this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register($i.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=$i.getColorMap();if(!e){this._colors=[Po.Empty],this._backgroundIsLight=!0;return}this._colors=[Po.Empty];for(let i=1;i<e.length;i++){const s=e[i].rgba;this._colors[i]=new Po(s.r,s.g,s.b,Math.round(s.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}SS._INSTANCE=null;const SOe=(()=>{const n=[];for(let e=32;e<=126;e++)n.push(e);return n.push(65533),n})(),xOe=(n,e)=>(n-=32,n<0||n>96?e<=2?(n+96)%96:96-1:n);class Ny{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Ny.soften(e,12/15),this.charDataLight=Ny.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let s=0,r=e.length;s<r;s++)i[s]=zL(e[s]*t);return i}renderChar(e,t,i,s,r,o,a,l,c,u,h){const d=1*this.scale,f=2*this.scale,g=h?1:f;if(t+d>e.width||i+g>e.height){console.warn("bad render request outside image data");return}const p=u?this.charDataLight:this.charDataNormal,m=xOe(s,c),b=e.width*4,v=a.r,w=a.g,y=a.b,x=r.r-v,D=r.g-w,S=r.b-y,T=Math.max(o,l),k=e.data;let I=m*d*f,N=i*b+t*4;for(let z=0;z<g;z++){let $=N;for(let q=0;q<d;q++){const ne=p[I++]/255*(o/255);k[$++]=v+x*ne,k[$++]=w+D*ne,k[$++]=y+S*ne,k[$++]=T}N+=b}}blockRenderChar(e,t,i,s,r,o,a,l){const c=1*this.scale,u=2*this.scale,h=l?1:u;if(t+c>e.width||i+h>e.height){console.warn("bad render request outside image data");return}const d=e.width*4,f=.5*(r/255),g=o.r,p=o.g,m=o.b,b=s.r-g,v=s.g-p,w=s.b-m,y=g+b*f,x=p+v*f,D=m+w*f,S=Math.max(r,a),T=e.data;let k=i*d+t*4;for(let I=0;I<h;I++){let N=k;for(let z=0;z<c;z++)T[N++]=y,T[N++]=x,T[N++]=D,T[N++]=S;k+=d}}}const NU={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},RU=n=>{const e=new Uint8ClampedArray(n.length/2);for(let t=0;t<n.length;t+=2)e[t>>1]=NU[n[t]]<<4|NU[n[t+1]]&15;return e},MU={1:G_(()=>RU("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:G_(()=>RU("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class Yv{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return MU[e]?i=new Ny(MU[e](),e):i=Yv.createFromSampleData(Yv.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let s=0;for(const r of SOe)i.fillText(String.fromCharCode(r),s,16/2),s+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const s=Yv._downsample(e,t);return new Ny(s,t)}static _downsampleChar(e,t,i,s,r){const o=1*r,a=2*r;let l=s,c=0;for(let u=0;u<a;u++){const h=u/a*16,d=(u+1)/a*16;for(let f=0;f<o;f++){const g=f/o*10,p=(f+1)/o*10;let m=0,b=0;for(let w=h;w<d;w++){const y=t+Math.floor(w)*3840,x=1-(w-Math.floor(w));for(let D=g;D<p;D++){const S=1-(D-Math.floor(D)),T=y+Math.floor(D)*4,k=S*x;b+=k,m+=e[T]*e[T+3]/255*k}}const v=m/b;c=Math.max(c,v),i[l++]=zL(v)}}return c}static _downsample(e,t){const i=2*t*1*t,s=i*96,r=new Uint8ClampedArray(s);let o=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,r,o,t)),o+=i,a+=10*4;if(l>0){const c=255/l;for(let u=0;u<s;u++)r[u]*=c}return r}}const kOe=140,LOe=2;class Ry{constructor(e,t,i){const s=e.options,r=s.get(141),o=s.get(143),a=o.minimap,l=s.get(50),c=s.get(72);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=s.get(104),this.paddingTop=s.get(83).top,this.paddingBottom=s.get(83).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=r,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=s.get(66),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=o.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=G_(()=>Yv.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=Ry._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=Ry._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(cFe);return i?new Po(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(uFe);return t?Po._clamp(Math.round(255*t.rgba.a)):255}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class Xv{constructor(e,t,i,s,r,o,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=s,this.sliderTop=r,this.sliderHeight=o,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,s,r,o,a,l,c,u,h){const d=e.pixelRatio,f=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/f),p=e.lineHeight;if(e.minimapHeightIsEditorHeight){let D=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(D+=Math.max(0,r-e.lineHeight-e.paddingBottom));const S=Math.max(1,Math.floor(r*r/D)),T=Math.max(0,e.minimapHeight-S),k=T/(u-r),I=c*k,N=T>0,z=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),$=Math.floor(e.paddingTop/e.lineHeight);return new Xv(c,u,N,k,I,S,$,1,Math.min(a,z))}let m;if(o&&i!==a){const D=i-t+1;m=Math.floor(D*f/d)}else{const D=r/p;m=Math.floor(D*f/d)}const b=Math.floor(e.paddingTop/p);let v=Math.floor(e.paddingBottom/p);if(e.scrollBeyondLastLine){const D=r/p;v=Math.max(v,D-1)}let w;if(v>0){const D=r/p;w=(b+a+v-D-1)*f/d}else w=Math.max(0,(b+a)*f/d-m);w=Math.min(e.minimapHeight-m,w);const y=w/(u-r),x=c*y;if(g>=b+a+v){const D=w>0;return new Xv(c,u,D,y,x,m,b,1,a)}else{let D;t>1?D=t+b:D=Math.max(1,c/p);let S,T=Math.max(1,Math.floor(D-x*d/f));T<b?(S=b-T+1,T=1):(S=0,T=Math.max(1,T-b)),h&&h.scrollHeight===u&&(h.scrollTop>c&&(T=Math.min(T,h.startLineNumber),S=Math.max(S,h.topPaddingLineCount)),h.scrollTop<c&&(T=Math.max(T,h.startLineNumber),S=Math.min(S,h.topPaddingLineCount)));const k=Math.min(a,T-S+g-1),I=(c-s)/p;let N;return c>=e.paddingTop?N=(t-T+S+I)*f/d:N=c/e.paddingTop*(S+I)*f/d,new Xv(c,u,!0,y,N,m,S,T,k)}}}class tD{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}tD.INVALID=new tD(-1);class FU{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new xse(()=>tD.INVALID),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let s=0,r=i.length;s<r;s++)if(i[s].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class X8{constructor(e,t,i,s){this._backgroundFillData=X8._createBackgroundFillData(t,i,s),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const s=i.r,r=i.g,o=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let u=0;u<t;u++)for(let h=0;h<e;h++)l[c]=s,l[c+1]=r,l[c+2]=o,l[c+3]=a,c+=4;return l}}class My{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:s}=q0.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),r=t/s,o=r/2;if(!i||i.minimapLines.length===0){const m=[];if(m[0]=1,s>1){for(let b=0,v=s-1;b<v;b++)m[b]=Math.round(b*r+o);m[s-1]=t}return[new My(r,m),[]]}const a=i.minimapLines,l=a.length,c=[];let u=0,h=0,d=1;const f=10;let g=[],p=null;for(let m=0;m<s;m++){const b=Math.max(d,Math.round(m*r)),v=Math.max(b,Math.round((m+1)*r));for(;u<l&&a[u]<b;){if(g.length<f){const y=u+1+h;p&&p.type==="deleted"&&p._oldIndex===u-1?p.deleteToLineNumber++:(p={type:"deleted",_oldIndex:u,deleteFromLineNumber:y,deleteToLineNumber:y},g.push(p)),h--}u++}let w;if(u<l&&a[u]<=v)w=a[u],u++;else if(m===0?w=1:m+1===s?w=t:w=Math.round(m*r+o),g.length<f){const y=u+1+h;p&&p.type==="inserted"&&p._i===m-1?p.insertToLineNumber++:(p={type:"inserted",_i:m,insertFromLineNumber:y,insertToLineNumber:y},g.push(p)),h++}c[m]=w,d=w}if(g.length<f)for(;u<l;){const m=u+1+h;p&&p.type==="deleted"&&p._oldIndex===u-1?p.deleteToLineNumber++:(p={type:"deleted",_oldIndex:u,deleteFromLineNumber:m,deleteToLineNumber:m},g.push(p)),h--,u++}else g=[{type:"flush"}];return[new My(r,c),g]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let s=this.modelLineToMinimapLine(t)-1;for(;s+1<this.minimapLines.length&&this.minimapLines[s+1]<=t;)s++;if(i===s){const r=this.minimapLines[i];if(r<e||r>t)return null}return[i+1,s+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),s=this.modelLineToMinimapLine(t);return e!==t&&s===i&&(s===this.minimapLines.length?i>1&&i--:s++),[i,s]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,s=0;for(let r=this.minimapLines.length-1;r>=0&&!(this.minimapLines[r]<e.fromLineNumber);r--)this.minimapLines[r]<=e.toLineNumber?(this.minimapLines[r]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,r),s=Math.max(s,r)):this.minimapLines[r]-=t;return[i,s]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class DOe extends jr{constructor(e){super(e),this.tokensColorTracker=SS.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Ry(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=My.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new iD(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new Ry(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const s=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);s&&t.push({fromLineNumber:s[0],toLineNumber:s[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const s={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(s)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=My.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const s of i)switch(s.type){case"deleted":this._actual.onLinesDeleted(s.deleteFromLineNumber,s.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(s.insertFromLineNumber,s.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const s=[];for(let r=0,o=t-e+1;r<o;r++)i[r]?s[r]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+r-1]):s[r]=null;return s}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Lt(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const r=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new H(r,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new H(e,1,t,this._context.viewModel.getLineMaxColumn(t));const s=this._context.viewModel.getMinimapDecorationsInRange(i);if(this._samplingState){const r=[];for(const o of s){if(!o.options.minimap)continue;const a=o.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);r.push(new Une(new H(l,a.startColumn,c,a.endColumn),o.options))}return r}return s}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new H(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class iD extends ae{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(mU),this._domNode=Bt(document.createElement("div")),Nc.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=Bt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=Bt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=Bt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=Bt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=Bt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=pn(this._domNode.domNode,Le.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){const c=hs(this._slider.domNode),u=c.top+c.height/2;this._startSliderDragging(i,u,this._lastRenderData.renderedLayout)}return}const r=this._model.options.minimapLineHeight,o=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let l=Math.floor(o/r)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new PT,this._sliderPointerDownListener=pn(this._slider.domNode,Le.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Zt.addTarget(this._domNode.domNode),this._sliderTouchStartListener=oe(this._domNode.domNode,Jt.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=oe(this._domNode.domNode,Jt.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=pn(this._domNode.domNode,Jt.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const s=e.pageX;this._slider.toggleClassName("active",!0);const r=(o,a)=>{const l=hs(this._domNode.domNode),c=Math.min(Math.abs(a-s),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(br&&c>kOe){this._model.setScrollTop(i.scrollTop);return}const u=o-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(u))};e.pageY!==t&&r(e.pageY,s),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>r(o.pageY,o.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new X8(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)===null||i===void 0||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)===null||i===void 0||i.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(mU),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=Xv.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(H.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((d,f)=>(d.options.zIndex||0)-(f.options.zIndex||0));const{canvasInnerWidth:s,canvasInnerHeight:r}=this._model.options,o=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,s,r);const u=new PU(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,u,e,o),this._renderDecorationsLineHighlights(c,i,u,e,o);const h=new PU(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,h,e,o,l,a,s),this._renderDecorationsHighlights(c,i,h,e,o,l,a,s)}}_renderSelectionLineHighlights(e,t,i,s,r){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let o=0,a=0;for(const l of t){const c=s.intersectWithViewport(l);if(!c)continue;const[u,h]=c;for(let g=u;g<=h;g++)i.set(g,!0);const d=s.getYForLineNumber(u,r),f=s.getYForLineNumber(h,r);a>=d||(a>o&&e.fillRect(Ih,o,e.canvas.width,a-o),o=d),a=f}a>o&&e.fillRect(Ih,o,e.canvas.width,a-o)}_renderDecorationsLineHighlights(e,t,i,s,r){const o=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==Or.Inline)continue;const u=s.intersectWithViewport(l.range);if(!u)continue;const[h,d]=u,f=c.getColor(this._theme.value);if(!f||f.isTransparent())continue;let g=o.get(f.toString());g||(g=f.transparent(.5).toString(),o.set(f.toString(),g)),e.fillStyle=g;for(let p=h;p<=d;p++){if(i.has(p))continue;i.set(p,!0);const m=s.getYForLineNumber(h,r);e.fillRect(Ih,m,e.canvas.width,r)}}}_renderSelectionsHighlights(e,t,i,s,r,o,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const u=s.intersectWithViewport(c);if(!u)continue;const[h,d]=u;for(let f=h;f<=d;f++)this.renderDecorationOnLine(e,i,c,this._selectionColor,s,f,r,r,o,a,l)}}_renderDecorationsHighlights(e,t,i,s,r,o,a,l){for(const c of t){const u=c.options.minimap;if(!u)continue;const h=s.intersectWithViewport(c.range);if(!h)continue;const[d,f]=h,g=u.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let p=d;p<=f;p++)switch(u.position){case Or.Inline:this.renderDecorationOnLine(e,i,c.range,g,s,p,r,r,o,a,l);continue;case Or.Gutter:{const m=s.getYForLineNumber(p,r),b=2;this.renderDecoration(e,g,b,m,LOe,r);continue}}}}renderDecorationOnLine(e,t,i,s,r,o,a,l,c,u,h){const d=r.getYForLineNumber(o,l);if(d+a<0||d>this._model.options.canvasInnerHeight)return;const{startLineNumber:f,endLineNumber:g}=i,p=f===o?i.startColumn:1,m=g===o?i.endColumn:this._model.getLineMaxColumn(o),b=this.getXOffsetForPosition(t,o,p,c,u,h),v=this.getXOffsetForPosition(t,o,m,c,u,h);this.renderDecoration(e,s,b,d,v-b,a)}getXOffsetForPosition(e,t,i,s,r,o){if(i===1)return Ih;if((i-1)*r>=o)return o;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Ih];let u=Ih;for(let h=1;h<c.length+1;h++){const d=c.charCodeAt(h-1),f=d===9?s*r:Jd(d)?2*r:r,g=u+f;if(g>=o){l[h]=o;break}l[h]=g,u=g}e.set(t,l)}return i-1<l.length?l[i-1]:o}renderDecoration(e,t,i,s,r,o){e.fillStyle=t&&t.toString()||"",e.fillRect(i,s,r,o)}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,s=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const ne=this._lastRenderData._get();return new FU(e,ne.imageData,ne.lines)}const r=this._getBuffer();if(!r)return null;const[o,a,l]=iD._renderUntouchedLines(r,e.topPaddingLineCount,t,i,s,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),u=this._model.getOptions().tabSize,h=this._model.options.defaultBackgroundColor,d=this._model.options.backgroundColor,f=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,p=g.backgroundIsLight(),m=this._model.options.renderMinimap,b=this._model.options.charRenderer(),v=this._model.options.fontScale,w=this._model.options.minimapCharWidth,x=(m===1?2:2+1)*v,D=s>x?Math.floor((s-x)/2):0,S=d.a/255,T=new Po(Math.round((d.r-h.r)*S+h.r),Math.round((d.g-h.g)*S+h.g),Math.round((d.b-h.b)*S+h.b),255);let k=e.topPaddingLineCount*s;const I=[];for(let ne=0,de=i-t+1;ne<de;ne++)l[ne]&&iD._renderLine(r,T,d.a,p,m,w,g,f,b,k,D,u,c[ne],v,s),I[ne]=new tD(k),k+=s;const N=o===-1?0:o,$=(a===-1?r.height:a)-N;return this._canvas.domNode.getContext("2d").putImageData(r,0,0,0,N,r.width,$),new FU(e,r,I)}static _renderUntouchedLines(e,t,i,s,r,o){const a=[];if(!o){for(let k=0,I=s-i+1;k<I;k++)a[k]=!0;return[-1,-1,a]}const l=o._get(),c=l.imageData.data,u=l.rendLineNumberStart,h=l.lines,d=h.length,f=e.width,g=e.data,p=(s-i+1)*r*f*4;let m=-1,b=-1,v=-1,w=-1,y=-1,x=-1,D=t*r;for(let k=i;k<=s;k++){const I=k-i,N=k-u,z=N>=0&&N<d?h[N].dy:-1;if(z===-1){a[I]=!0,D+=r;continue}const $=z*f*4,q=(z+r)*f*4,ne=D*f*4,de=(D+r)*f*4;w===$&&x===ne?(w=q,x=de):(v!==-1&&(g.set(c.subarray(v,w),y),m===-1&&v===0&&v===y&&(m=w),b===-1&&w===p&&v===y&&(b=v)),v=$,w=q,y=ne,x=de),a[I]=!1,D+=r}v!==-1&&(g.set(c.subarray(v,w),y),m===-1&&v===0&&v===y&&(m=w),b===-1&&w===p&&v===y&&(b=v));const S=m===-1?-1:m/(f*4),T=b===-1?-1:b/(f*4);return[S,T,a]}static _renderLine(e,t,i,s,r,o,a,l,c,u,h,d,f,g,p){const m=f.content,b=f.tokens,v=e.width-o,w=p===1;let y=Ih,x=0,D=0;for(let S=0,T=b.getCount();S<T;S++){const k=b.getEndOffset(S),I=b.getForeground(S),N=a.getColor(I);for(;x<k;x++){if(y>v)return;const z=m.charCodeAt(x);if(z===9){const $=d-(x+D)%d;D+=$-1,y+=$*o}else if(z===32)y+=o;else{const $=Jd(z)?2:1;for(let q=0;q<$;q++)if(r===2?c.blockRenderChar(e,y,u+h,N,l,t,i,w):c.renderChar(e,y,u+h,z,N,l,t,i,g,s,w),y+=o,y>v)return}}}}}class PU{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let s=0,r=this._endLineNumber-this._startLineNumber+1;s<r;s++)this._values[s]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class EOe extends jr{constructor(e){super(e);const i=this._context.configuration.options.get(143);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._domNode=Bt(document.createElement("div")),Nc.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=Bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference===t?(this._updateMaxMinWidth(),!1):(i.preference=t,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const s=this._widgets[t].domNode.domNode;delete this._widgets[t],s.parentNode.removeChild(s),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var e,t;let i=0;const s=Object.keys(this._widgets);for(let r=0,o=s.length;r<o;r++){const a=s[r],c=(t=(e=this._widgets[a].widget).getMinContentWidthInPx)===null||t===void 0?void 0:t.call(e);typeof c<"u"&&(i=Math.max(i,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(i)}_renderWidget(e){const t=e.domNode;if(e.preference===null){t.setTop("");return}if(e.preference===0)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(e.preference===1){const i=t.domNode.clientHeight;t.setTop(this._editorHeight-i-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else e.preference===2&&(t.setTop(0),t.domNode.style.right="50%")}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets);for(let i=0,s=t.length;i<s;i++){const r=t[i];this._renderWidget(this._widgets[r])}}}class TOe{constructor(e,t){const i=e.options;this.lineHeight=i.get(66),this.pixelRatio=i.get(141),this.overviewRulerLanes=i.get(82),this.renderBorder=i.get(81);const s=t.getColor(gPe);this.borderColor=s?s.toString():null,this.hideCursor=i.get(59);const r=t.getColor(gse);this.cursorColor=r?r.transparent(.7).toString():null,this.themeType=t.type;const o=i.get(72),a=o.enabled,l=o.side,c=t.getColor(pPe),u=$i.getDefaultBackground();c?this.backgroundColor=c:a&&l==="right"?this.backgroundColor=u:this.backgroundColor=null;const d=i.get(143).overviewRuler;this.top=d.top,this.right=d.right,this.domWidth=d.width,this.domHeight=d.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[f,g]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=g}_initLanes(e,t,i){const s=t-e;if(i>=3){const r=Math.floor(s/3),o=Math.floor(s/3),a=s-r-o,l=e,c=l+r,u=l+r+a;return[[0,l,c,l,u,l,c,l],[0,r,a,r+a,o,r+a+o,a+o,r+a+o]]}else if(i===2){const r=Math.floor(s/2),o=s-r,a=e,l=a+r;return[[0,a,a,a,l,a,a,a],[0,r,r,r,o,r+o,r+o,r+o]]}else{const r=e,o=s;return[[0,r,r,r,r,r,r,r],[0,o,o,o,o,o,o,o]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&J.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class AOe extends jr{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=Bt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=$i.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new TOe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++)this._cursorPositions[t]=e.selections[t].getPosition();return this._cursorPositions.sort(X.compare),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?J.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Cy.compareByRenderingProps),this._actualShouldRender===1&&!Cy.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!yn(this._renderedCursorPositions,this._cursorPositions,(g,p)=>g.lineNumber===p.lineNumber)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,s=this._settings.canvasHeight,r=this._settings.lineHeight,o=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=s/a,c=6*this._settings.pixelRatio|0,u=c/2|0,h=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(h.fillStyle=J.Format.CSS.formatHexA(e),h.fillRect(0,0,i,s)):(h.clearRect(0,0,i,s),h.fillStyle=J.Format.CSS.formatHexA(e),h.fillRect(0,0,i,s)):h.clearRect(0,0,i,s);const d=this._settings.x,f=this._settings.w;for(const g of t){const p=g.color,m=g.data;h.fillStyle=p;let b=0,v=0,w=0;for(let y=0,x=m.length/3;y<x;y++){const D=m[3*y],S=m[3*y+1],T=m[3*y+2];let k=o.getVerticalOffsetForLineNumber(S)*l|0,I=(o.getVerticalOffsetForLineNumber(T)+r)*l|0;if(I-k<c){let z=(k+I)/2|0;z<u?z=u:z+u>s&&(z=s-u),k=z-u,I=z+u}k>w+1||D!==b?(y!==0&&h.fillRect(d[b],v,f[b],w-v),b=D,v=k,w=I):I>w&&(w=I)}h.fillRect(d[b],v,f[b],w-v)}if(!this._settings.hideCursor&&this._settings.cursorColor){const g=2*this._settings.pixelRatio|0,p=g/2|0,m=this._settings.x[7],b=this._settings.w[7];h.fillStyle=this._settings.cursorColor;let v=-100,w=-100;for(let y=0,x=this._cursorPositions.length;y<x;y++){const D=this._cursorPositions[y];let S=o.getVerticalOffsetForLineNumber(D.lineNumber)*l|0;S<p?S=p:S+p>s&&(S=s-p);const T=S-p,k=T+g;T>w+1?(y!==0&&h.fillRect(m,v,b,w-v),v=T,w=k):k>w&&(w=k)}h.fillRect(m,v,b,w-v)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(h.beginPath(),h.lineWidth=1,h.strokeStyle=this._settings.borderColor,h.moveTo(0,0),h.lineTo(0,s),h.stroke(),h.moveTo(0,0),h.lineTo(i,0),h.stroke())}}class OU{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class Ise{constructor(e,t,i,s){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=s,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class IOe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(Ise.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),s=Math.floor(this._outerHeight),r=i/s,o=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const u=this._zones[l];if(!e){const y=u.getColorZones();if(y){a.push(y);continue}}const h=this._getVerticalOffsetForLine(u.startLineNumber),d=u.heightInLines===0?this._getVerticalOffsetForLine(u.endLineNumber)+t:h+u.heightInLines*t,f=Math.floor(r*h),g=Math.floor(r*d);let p=Math.floor((f+g)/2),m=g-p;m<o&&(m=o),p-m<0&&(p=m),p+m>i&&(p=i-m);const b=u.color;let v=this._color2Id[b];v||(v=++this._lastAssignedId,this._color2Id[b]=v,this._id2Color[v]=b);const w=new OU(p-m,p+m,v);u.setColorZone(w),a.push(w)}return this._colorZonesInvalid=!1,a.sort(OU.compare),a}}class NOe extends bS{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=Bt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new IOe(s=>this._context.viewLayout.getVerticalOffsetForLineNumber(s)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(66)),this._zoneManager.setPixelRatio(i.get(141)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(66)&&(this._zoneManager.setLineHeight(t.get(66)),this._render()),e.hasChanged(141)&&(this._zoneManager.setPixelRatio(t.get(141)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),s=this._zoneManager.getId2Color(),r=this._domNode.domNode.getContext("2d");return r.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(r,i,s,e),!0}_renderOneLane(e,t,i,s){let r=0,o=0,a=0;for(const l of t){const c=l.colorId,u=l.from,h=l.to;c!==r?(e.fillRect(0,o,s,a-o),r=c,e.fillStyle=i[r],o=u,a=h):a>=u?a=Math.max(a,h):(e.fillRect(0,o,s,a-o),o=u,a=h)}e.fillRect(0,o,s,a-o)}}class ROe extends jr{constructor(e){super(e),this.domNode=Bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(101),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(101),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:s}=this._context.viewModel.model.getOptions(),r=s;let o=t-e;for(;o>0;){const a=Bt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(r),this.domNode.appendChild(a),this._renderedRulers.push(a),o--}return}let i=e-t;for(;i>0;){const s=this._renderedRulers.pop();this.domNode.removeChild(s),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const s=this._renderedRulers[t],r=this._rulers[t];s.setBoxShadow(r.color?`1px 0 0 0 ${r.color} inset`:""),s.setHeight(Math.min(e.scrollHeight,1e6)),s.setLeft(r.column*this._typicalHalfwidthCharacterWidth)}}}class MOe extends jr{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(102);this._useShadows=i.useShadows,this._domNode=Bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(143);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(102);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class FOe{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class POe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function OOe(n){return new FOe(n)}function BOe(n){return new POe(n.lineNumber,n.ranges.map(OOe))}class Ri extends lm{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(66),this._roundedSelection=t.get(100),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(66),this._roundedSelection=t.get(100),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const s=this._typicalHalfwidthCharacterWidth/4;let r=null,o=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!r&&c<i.length;c++)i[c].lineNumber===a&&(r=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!o&&c>=0;c--)i[c].lineNumber===l&&(o=i[c].ranges[0]);r&&!r.startStyle&&(r=null),o&&!o.startStyle&&(o=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],u=c.left,h=c.left+c.width,d={top:0,bottom:0},f={top:0,bottom:0};if(a>0){const g=t[a-1].ranges[0].left,p=t[a-1].ranges[0].left+t[a-1].ranges[0].width;Mx(u-g)<s?d.top=2:u>g&&(d.top=1),Mx(h-p)<s?f.top=2:g<h&&h<p&&(f.top=1)}else r&&(d.top=r.startStyle.top,f.top=r.endStyle.top);if(a+1<l){const g=t[a+1].ranges[0].left,p=t[a+1].ranges[0].left+t[a+1].ranges[0].width;Mx(u-g)<s?d.bottom=2:g<u&&u<p&&(d.bottom=1),Mx(h-p)<s?f.bottom=2:h<p&&(f.bottom=1)}else o&&(d.bottom=o.startStyle.bottom,f.bottom=o.endStyle.bottom);c.startStyle=d,c.endStyle=f}}_getVisibleRangesWithStyle(e,t,i){const r=(t.linesVisibleRangesForRange(e,!0)||[]).map(BOe);return!this._visibleRangesHaveGaps(r)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,r,i),r}_createSelectionPiece(e,t,i,s,r){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;left:"+s.toString()+"px;width:"+r.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,i,s){if(s.length===0)return;const r=!!s[0].ranges[0].startStyle,o=this._lineHeight.toString(),a=(this._lineHeight-1).toString(),l=s[0].lineNumber,c=s[s.length-1].lineNumber;for(let u=0,h=s.length;u<h;u++){const d=s[u],f=d.lineNumber,g=f-t,p=i&&(f===c||f===l)?a:o,m=i&&f===l?1:0;let b="",v="";for(let w=0,y=d.ranges.length;w<y;w++){const x=d.ranges[w];if(r){const S=x.startStyle,T=x.endStyle;if(S.top===1||S.bottom===1){b+=this._createSelectionPiece(m,p,Ri.SELECTION_CLASS_NAME,x.left-Ri.ROUNDED_PIECE_WIDTH,Ri.ROUNDED_PIECE_WIDTH);let k=Ri.EDITOR_BACKGROUND_CLASS_NAME;S.top===1&&(k+=" "+Ri.SELECTION_TOP_RIGHT),S.bottom===1&&(k+=" "+Ri.SELECTION_BOTTOM_RIGHT),b+=this._createSelectionPiece(m,p,k,x.left-Ri.ROUNDED_PIECE_WIDTH,Ri.ROUNDED_PIECE_WIDTH)}if(T.top===1||T.bottom===1){b+=this._createSelectionPiece(m,p,Ri.SELECTION_CLASS_NAME,x.left+x.width,Ri.ROUNDED_PIECE_WIDTH);let k=Ri.EDITOR_BACKGROUND_CLASS_NAME;T.top===1&&(k+=" "+Ri.SELECTION_TOP_LEFT),T.bottom===1&&(k+=" "+Ri.SELECTION_BOTTOM_LEFT),b+=this._createSelectionPiece(m,p,k,x.left+x.width,Ri.ROUNDED_PIECE_WIDTH)}}let D=Ri.SELECTION_CLASS_NAME;if(r){const S=x.startStyle,T=x.endStyle;S.top===0&&(D+=" "+Ri.SELECTION_TOP_LEFT),S.bottom===0&&(D+=" "+Ri.SELECTION_BOTTOM_LEFT),T.top===0&&(D+=" "+Ri.SELECTION_TOP_RIGHT),T.bottom===0&&(D+=" "+Ri.SELECTION_BOTTOM_RIGHT)}v+=this._createSelectionPiece(m,p,D,x.left,x.width)}e[g][0]+=b,e[g][1]+=v}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber;for(let o=i;o<=s;o++){const a=o-i;t[a]=["",""]}const r=[];for(let o=0,a=this._selections.length;o<a;o++){const l=this._selections[o];if(l.isEmpty()){r[o]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[o]);r[o]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=r,this._renderResult=t.map(([o,a])=>o+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}Ri.SELECTION_CLASS_NAME="selected-text";Ri.SELECTION_TOP_LEFT="top-left-radius";Ri.SELECTION_BOTTOM_LEFT="bottom-left-radius";Ri.SELECTION_TOP_RIGHT="top-right-radius";Ri.SELECTION_BOTTOM_RIGHT="bottom-right-radius";Ri.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";Ri.ROUNDED_PIECE_WIDTH=10;$a((n,e)=>{const t=n.getColor(w3e);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function Mx(n){return n<0?-n:n}class BU{constructor(e,t,i,s,r,o,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=s,this.height=r,this.textContent=o,this.textContentClassName=a}}class WU{constructor(e){this._context=e;const t=this._context.configuration.options,i=t.get(50);this._cursorStyle=t.get(28),this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=Bt(document.createElement("div")),this._domNode.setClassName(`cursor ${i_}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),fs(this._domNode,i),this._domNode.setDisplay("none"),this._position=new X(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(50);return this._cursorStyle=t.get(28),this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),fs(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[s,r]=XAe(i,t-1);return[new X(e,s+1),i.substring(s,r)]}_prepareRender(e){let t="",i="";const[s,r]=this._getGraphemeAwarePosition();if(this._cursorStyle===$n.Line||this._cursorStyle===$n.LineThin){const d=e.visibleRangeForPosition(s);if(!d||d.outsideRenderedLine)return null;let f;this._cursorStyle===$n.Line?(f=gH(this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=r,i=this._getTokenClassName(s))):f=gH(1);let g=d.left,p=0;f>=2&&g>=1&&(p=1,g-=p);const m=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.bigNumbersDelta;return new BU(m,g,p,f,this._lineHeight,t,i)}const o=e.linesVisibleRangesForRange(new H(s.lineNumber,s.column,s.lineNumber,s.column+r.length),!1);if(!o||o.length===0)return null;const a=o[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;const l=a.ranges[0],c=r==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===$n.Block&&(t=r,i=this._getTokenClassName(s));let u=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.bigNumbersDelta,h=this._lineHeight;return(this._cursorStyle===$n.Underline||this._cursorStyle===$n.UnderlineThin)&&(u+=this._lineHeight-2,h=2),new BU(u,l.left,0,c,h,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${i_} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class Fy extends jr{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(90),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new WU(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=Bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new uh,this._cursorFlatBlinkInterval=new gS,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(90),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,s=this._secondaryCursors.length;i<s;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const s=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.onCursorPositionChanged(e,s),this._updateBlinking(),this._secondaryCursors.length<t.length){const r=t.length-this._secondaryCursors.length;for(let o=0;o<r;o++){const a=new WU(this._context);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const r=this._secondaryCursors.length-t.length;for(let o=0;o<r;o++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let r=0;r<t.length;r++)this._secondaryCursors[r].onCursorPositionChanged(t[r],s)}onCursorStateChanged(e){const t=[];for(let s=0,r=e.selections.length;s<r;s++)t[s]=e.selections[s].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let s=0,r=e.ranges.length;s<r;s++)if(e.ranges[s].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[s].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},Fy.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},Fy.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case $n.Line:e+=" cursor-line-style";break;case $n.Block:e+=" cursor-block-style";break;case $n.Underline:e+=" cursor-underline-style";break;case $n.LineThin:e+=" cursor-line-thin-style";break;case $n.BlockOutline:e+=" cursor-block-outline-style";break;case $n.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const s=this._primaryCursor.render(e);s&&(t[i++]=s);for(let r=0,o=this._secondaryCursors.length;r<o;r++){const a=this._secondaryCursors[r].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}}Fy.BLINK_INTERVAL=500;$a((n,e)=>{const t=n.getColor(gse);if(t){let i=n.getColor(tPe);i||(i=t.opposite()),e.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${t}; border-color: ${t}; color: ${i}; }`),Gu(n.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${i}; border-right: 1px solid ${i}; }`)}});const rR=()=>{throw new Error("Invalid change accessor")};class WOe extends jr{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._lineHeight=t.get(66),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=Bt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=Bt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const s of e)t.set(s.id,s);let i=!1;return this._context.viewModel.changeWhitespace(s=>{const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l],u=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=u.isInHiddenArea;const h=t.get(l);h&&(h.afterLineNumber!==u.afterViewLineNumber||h.height!==u.heightInPx)&&(s.changeOneWhitespace(l,u.afterViewLineNumber,u.heightInPx),this._safeCallOnComputedHeight(c.delegate,u.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(66)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){var t,i;return(i=(t=e.ordinal)!==null&&t!==void 0?t:e.afterColumn)!==null&&i!==void 0?i:1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const o=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new X(o,this._context.viewModel.model.getLineMaxColumn(o))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),r=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!r,afterViewLineNumber:s.lineNumber,heightInPx:r?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const s={addZone:r=>(t=!0,this._addZone(i,r)),removeZone:r=>{r&&(t=this._removeZone(i,r)||t)},layoutZone:r=>{r&&(t=this._layoutZone(i,r)||t)}};VOe(e,s),s.addZone=rR,s.removeZone=rR,s.layoutZone=rR}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),r={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:Bt(t.domNode),marginDomNode:t.marginDomNode?Bt(t.marginDomNode):null};return this._safeCallOnComputedHeight(r.delegate,i.heightInPx),r.domNode.setPosition("absolute"),r.domNode.domNode.style.width="100%",r.domNode.setDisplay("none"),r.domNode.setAttribute("monaco-view-zone",r.whitespaceId),this.domNode.appendChild(r.domNode),r.marginDomNode&&(r.marginDomNode.setPosition("absolute"),r.marginDomNode.domNode.style.width="100%",r.marginDomNode.setDisplay("none"),r.marginDomNode.setAttribute("monaco-view-zone",r.whitespaceId),this.marginDomNode.appendChild(r.marginDomNode)),this._zones[r.whitespaceId]=r,this.setShouldRender(),r.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.parentNode.removeChild(i.domNode.domNode),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.parentNode.removeChild(i.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],s=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=s.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,s.afterViewLineNumber,s.heightInPx),this._safeCallOnComputedHeight(i.delegate,s.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){Ft(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){Ft(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let s=!1;for(const o of t)this._zones[o.id].isInHiddenArea||(i[o.id]=o,s=!0);const r=Object.keys(this._zones);for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._zones[l];let u=0,h=0,d="none";i.hasOwnProperty(l)?(u=i[l].verticalOffset-e.bigNumbersDelta,h=i[l].height,d="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(u),c.domNode.setHeight(h),c.domNode.setDisplay(d),c.marginDomNode&&(c.marginDomNode.setTop(u),c.marginDomNode.setHeight(h),c.marginDomNode.setDisplay(d))}s&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function VOe(n,e){try{return n(e)}catch(t){Ft(t)}}class $Oe{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class zOe{constructor(e,t,i){this.configuration=e,this.theme=new $Oe(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}class HOe{constructor(e,t,i,s){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.whitespaceViewportData=i,this._model=s,this.visibleRange=new H(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class UOe extends jr{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=Bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(143),s=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==s&&(this.contentWidth=s,e=!0);const r=i.contentLeft;return this.contentLeft!==r&&(this.contentLeft=r,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){var t;let i=0;const s=e.getDecorationsInViewport();for(const r of s){if(!r.options.blockClassName)continue;let o=this.blocks[i];o||(o=this.blocks[i]=Bt(document.createElement("div")),this.domNode.appendChild(o));let a,l;r.options.blockIsAfterEnd?(a=e.getVerticalOffsetAfterLineNumber(r.range.endLineNumber,!1),l=e.getVerticalOffsetAfterLineNumber(r.range.endLineNumber,!0)):(a=e.getVerticalOffsetForLineNumber(r.range.startLineNumber,!0),l=r.range.isEmpty()&&!r.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(r.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(r.range.endLineNumber,!0));const[c,u,h,d]=(t=r.options.blockPadding)!==null&&t!==void 0?t:[0,0,0,0];o.setClassName("blockDecorations-block "+r.options.blockClassName),o.setLeft(this.contentLeft-d),o.setWidth(this.contentWidth+d+u),o.setTop(a-e.scrollTop-c),o.setHeight(l-a+c+h),i++}for(let r=i;r<this.blocks.length;r++)this.blocks[r].domNode.remove();this.blocks.length=i}}class jOe extends lm{constructor(e){super(),this._context=e,this._options=new VU(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new VU(this._context.configuration);return this._options.equals(t)?e.hasChanged(143):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber-t+1,r=new Array(s);for(let a=0;a<s;a++)r[a]=!0;const o=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,r);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){const l=a-e.viewportData.startLineNumber,c=o.data[l];let u=null;if(this._options.renderWhitespace==="selection"){const h=this._selection;for(const d of h){if(d.endLineNumber<a||d.startLineNumber>a)continue;const f=d.startLineNumber===a?d.startColumn:c.minColumn,g=d.endLineNumber===a?d.endColumn:c.maxColumn;f<g&&(u||(u=[]),u.push(new $ne(f-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,u,c)}}_applyRenderWhitespace(e,t,i,s){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&s.continuesWithWrappedLine)return"";const r=this._context.theme.getColor(zu),o=this._options.renderWithSVG,a=s.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=s.continuesWithWrappedLine,u=s.minColumn-1,h=this._options.renderWhitespace==="boundary",d=this._options.renderWhitespace==="trailing",f=this._options.lineHeight,g=this._options.middotWidth,p=this._options.wsmiddotWidth,m=this._options.spaceWidth,b=Math.abs(p-m),v=Math.abs(g-m),w=b<v?11825:183,y=this._options.canUseHalfwidthRightwardsArrow;let x="",D=!1,S=Pr(a),T;S===-1?(D=!0,S=l,T=l):T=tm(a);let k=0,I=i&&i[k],N=0;for(let z=u;z<l;z++){const $=a.charCodeAt(z);if(I&&z>=I.endOffset&&(k++,I=i&&i[k]),$!==9&&$!==32||d&&!D&&z<=T)continue;if(h&&z>=S&&z<=T&&$===32){const ne=z-1>=0?a.charCodeAt(z-1):0,de=z+1<l?a.charCodeAt(z+1):0;if(ne!==32&&de!==32)continue}if(h&&c&&z===l-1){const ne=z-1>=0?a.charCodeAt(z-1):0;if($===32&&ne!==32&&ne!==9)continue}if(i&&(!I||I.startOffset>z||I.endOffset<=z))continue;const q=e.visibleRangeForPosition(new X(t,z+1));q&&(o?(N=Math.max(N,q.left),$===9?x+=this._renderArrow(f,m,q.left):x+=`<circle cx="${(q.left+m/2).toFixed(2)}" cy="${(f/2).toFixed(2)}" r="${(m/7).toFixed(2)}" />`):$===9?x+=`<div class="mwh" style="left:${q.left}px;height:${f}px;">${y?String.fromCharCode(65515):String.fromCharCode(8594)}</div>`:x+=`<div class="mwh" style="left:${q.left}px;height:${f}px;">${String.fromCharCode(w)}</div>`)}return o?(N=Math.round(N+m),`<svg style="position:absolute;width:${N}px;height:${f}px" viewBox="0 0 ${N} ${f}" xmlns="http://www.w3.org/2000/svg" fill="${r}">`+x+"</svg>"):x}_renderArrow(e,t,i){const s=t/7,r=t,o=e/2,a=i,l={x:0,y:s/2},c={x:100/125*r,y:l.y},u={x:c.x-.2*c.x,y:c.y+.2*c.x},h={x:u.x+.1*c.x,y:u.y+.1*c.x},d={x:h.x+.35*c.x,y:h.y-.35*c.x},f={x:d.x,y:-d.y},g={x:h.x,y:-h.y},p={x:u.x,y:-u.y},m={x:c.x,y:-c.y},b={x:l.x,y:-l.y};return`<path d="M ${[l,c,u,h,d,f,g,p,m,b].map(y=>`${(a+y.x).toFixed(2)} ${(o+y.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class VU{constructor(e){const t=e.options,i=t.get(50),s=t.get(38);s==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):s==="svg"?(this.renderWhitespace=t.get(98),this.renderWithSVG=!0):(this.renderWhitespace=t.get(98),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(66),this.stopRenderingLineAfter=t.get(116)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}var qOe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},GOe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let wF=class extends bS{constructor(e,t,i,s,r,o,a){super(),this._instantiationService=a,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new Lt(1,1,1,1)],this._renderAnimationFrame=null;const l=new eOe(t,s,r,e);this._context=new zOe(t,i,s),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(mF,this._context,l,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=Bt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=Bt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=Bt(document.createElement("div")),Nc.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new cOe(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new jT(this._context,this._linesContent),this._viewZones=new WOe(this._context),this._viewParts.push(this._viewZones);const c=new AOe(this._context);this._viewParts.push(c);const u=new MOe(this._context);this._viewParts.push(u);const h=new iOe(this._context);this._viewParts.push(h),h.addDynamicOverlay(new oOe(this._context)),h.addDynamicOverlay(new Ri(this._context)),h.addDynamicOverlay(new hOe(this._context)),h.addDynamicOverlay(new lOe(this._context)),h.addDynamicOverlay(new jOe(this._context));const d=new nOe(this._context);this._viewParts.push(d),d.addDynamicOverlay(new aOe(this._context)),d.addDynamicOverlay(new COe(this._context)),d.addDynamicOverlay(new yOe(this._context)),d.addDynamicOverlay(new CS(this._context)),this._glyphMarginWidgets=new _Oe(this._context),this._viewParts.push(this._glyphMarginWidgets);const f=new Lp(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(d.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new sOe(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new Fy(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new EOe(this._context),this._viewParts.push(this._overlayWidgets);const g=new ROe(this._context);this._viewParts.push(g);const p=new UOe(this._context);this._viewParts.push(p);const m=new DOe(this._context);if(this._viewParts.push(m),c){const b=this._scrollbar.getOverviewRulerLayoutInfo();b.parent.insertBefore(c.getDomNode(),b.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(g.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(u.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(m.getDomNode()),this._overflowGuardContainer.appendChild(p.domNode),this.domNode.appendChild(this._overflowGuardContainer),o?o.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new QFe(this._context,l,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._shouldRecomputeGlyphMarginLanes&&(this._shouldRecomputeGlyphMarginLanes=!1,this._context.configuration.setGlyphMarginDecorationLaneCount(this._computeGlyphMarginLaneCount())),dd.onRenderStart(),this._renderNow()}_computeGlyphMarginLaneCount(){const e=this._context.viewModel.model;let t=[];t=t.concat(e.getAllMarginDecorations().map(r=>{var o,a;const l=(a=(o=r.options.glyphMargin)===null||o===void 0?void 0:o.position)!==null&&a!==void 0?a:Q0.Left;return{range:r.range,lane:l}})),t=t.concat(this._glyphMarginWidgets.getWidgets().map(r=>({range:e.validateRange(r.preference.range),lane:r.preference.lane}))),t.sort((r,o)=>H.compareRangesUsingStarts(r.range,o.range));let i=null,s=null;for(const r of t)if(r.lane===Q0.Left&&(!i||H.compareRangesUsingEnds(i,r.range)<0)&&(i=r.range),r.lane===Q0.Right&&(!s||H.compareRangesUsingEnds(s,r.range)<0)&&(s=r.range),i&&s){if(i.endLineNumber<s.startLineNumber){i=null;continue}if(s.endLineNumber<i.startLineNumber){s=null;continue}return 2}return 1}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new TFe(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new X(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const t=this._context.configuration.options.get(143);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(140)+" "+pF(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){this._renderAnimationFrame===null&&(this._renderAnimationFrame=ine(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){KOe(()=>this._actualRender())}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!C8(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new HOe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const s=new CFe(this._context.viewLayout,i,this._viewLines);for(const r of e)r.prepareRender(s);for(const r of e)r.render(s),r.onDidRender()}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const r=this._viewLines.visibleRangeForPosition(new X(s.lineNumber,s.column));return r?r.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?HT.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new NOe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,s,r,o,a,l,c;this._contentWidgets.setWidgetPosition(e.widget,(i=(t=e.position)===null||t===void 0?void 0:t.position)!==null&&i!==void 0?i:null,(r=(s=e.position)===null||s===void 0?void 0:s.secondaryPosition)!==null&&r!==void 0?r:null,(a=(o=e.position)===null||o===void 0?void 0:o.preference)!==null&&a!==void 0?a:null,(c=(l=e.position)===null||l===void 0?void 0:l.positionAffinity)!==null&&c!==void 0?c:null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};wF=qOe([GOe(6,Wt)],wF);function KOe(n){try{return n()}catch(e){Ft(e)}}class Nse{constructor(e,t,i,s,r,o){this.id=e,this.label=t,this.alias=i,this._precondition=s,this._run=r,this._contextKeyService=o}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}function Ep(n){let e=0,t=0,i=0,s=0;for(let r=0,o=n.length;r<o;r++){const a=n.charCodeAt(r);a===13?(e===0&&(t=r),e++,r+1<o&&n.charCodeAt(r+1)===10?(s|=2,r++):s|=3,i=r+1):a===10&&(s|=1,e===0&&(t=r),e++,i=r+1)}return e===0&&(t=n.length),[e,t,n.length-i,s]}class $U{constructor(e,t,i,s){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=s}}class ZOe{constructor(e,t,i,s,r,o){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=s,this.nestingLevelOfEqualBracketType=r,this.bracketPairNode=o}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class YOe extends ZOe{constructor(e,t,i,s,r,o,a){super(e,t,i,s,r,o),this.minVisibleColumnIndentation=a}}class Py{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}Py.zero=new Py(0,0);function XOe(n,e,t,i){return n!==t?Vi(t-n,i):Vi(0,i-e)}const fr=0;function nD(n){return n===0}const fo=Math.pow(2,26);function Vi(n,e){return n*fo+e}function Wo(n){const e=n,t=Math.floor(e/fo),i=e-t*fo;return new Py(t,i)}function QOe(n){return Math.floor(n/fo)}function an(n,e){let t=n+e;return e>=fo&&(t=t-n%fo),t}function JOe(n,e){return n.reduce((t,i)=>an(t,e(i)),fr)}function Rse(n,e){return n===e}function Oy(n,e){const t=n,i=e;if(i-t<=0)return fr;const r=Math.floor(t/fo),o=Math.floor(i/fo),a=i-o*fo;if(r===o){const l=t-r*fo;return Vi(0,a-l)}else return Vi(o-r,a)}function n_(n,e){return n<e}function s_(n,e){return n<=e}function dv(n,e){return n>=e}function x0(n){return Vi(n.lineNumber-1,n.column-1)}function Kg(n,e){const t=n,i=Math.floor(t/fo),s=t-i*fo,r=e,o=Math.floor(r/fo),a=r-o*fo;return new H(i+1,s+1,o+1,a+1)}function e5e(n){const e=em(n);return Vi(e.length-1,e[e.length-1].length)}class Hu{static fromModelContentChanges(e){return e.map(i=>{const s=H.lift(i.range);return new Hu(x0(s.getStartPosition()),x0(s.getEndPosition()),e5e(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${Wo(this.startOffset)}...${Wo(this.endOffset)}) -> ${Wo(this.newLength)}`}}class t5e{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>Q8.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:Oy(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Vi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Vi(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Wo(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Vi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Vi(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(s_(i,e)){this.nextEditIdx++;const s=Wo(i),r=Wo(this.translateOldToCur(t.endOffsetBeforeObj)),o=s.lineCount-r.lineCount;this.deltaOldToNewLineCount+=o;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=s.columnCount-r.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class Q8{static from(e){return new Q8(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=Wo(t),this.endOffsetAfterObj=Wo(an(e,i)),this.offsetObj=Wo(e)}}const ok=[];class nn{static create(e,t){if(e<=128&&t.length===0){let i=nn.cache[e];return i||(i=new nn(e,t),nn.cache[e]=i),i}return new nn(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let s=i>>5;if(s===0){const o=1<<i|this.items;return o===this.items?this:nn.create(o,this.additionalItems)}s--;const r=this.additionalItems.slice(0);for(;r.length<s;)r.push(0);return r[s]|=1<<(i&31),nn.create(this.items,r)}merge(e){const t=this.items|e.items;if(this.additionalItems===ok&&e.additionalItems===ok)return t===this.items?this:t===e.items?e:nn.create(t,ok);const i=[];for(let s=0;s<Math.max(this.additionalItems.length,e.additionalItems.length);s++){const r=this.additionalItems[s]||0,o=e.additionalItems[s]||0;i.push(r|o)}return nn.create(t,i)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}}nn.cache=new Array(129);nn.empty=nn.create(0,ok);const zU={getKey(n){return n}};class i5e{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class J8{get length(){return this._length}constructor(e){this._length=e}}class By extends J8{static create(e,t,i){let s=e.length;return t&&(s=an(s,t.length)),i&&(s=an(s,i.length)),new By(s,e,t,i,t?t.missingOpeningBracketIds:nn.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,s,r){super(e),this.openingBracket=t,this.child=i,this.closingBracket=s,this.missingOpeningBracketIds=r}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new By(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(an(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Rc extends J8{static create23(e,t,i,s=!1){let r=e.length,o=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(r=an(r,t.length),o=o.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");r=an(r,i.length),o=o.merge(i.missingOpeningBracketIds)}return s?new n5e(r,e.listHeight+1,e,t,i,o):new Wy(r,e.listHeight+1,e,t,i,o)}static getEmpty(){return new s5e(fr,0,[],nn.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new mn;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let s=1;s<e;s++){const r=this.getChild(s);t=an(t,r.length),i=i.merge(r.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,s=e;for(let r=0;r<this.childrenLength;r++){const o=this.getChild(r);o&&(i=Math.min(i,o.computeMinIndentation(s,t)),s=an(s,o.length))}return this.cachedMinIndentation=i,i}}class Wy extends Rc{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,s,r,o){super(e,t,o),this._item1=i,this._item2=s,this._item3=r}deepClone(){return new Wy(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class n5e extends Wy{toMutable(){return new Wy(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class sD extends Rc{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,s){super(e,t,s),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new sD(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class s5e extends sD{toMutable(){return new sD(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const r5e=[];class e7 extends J8{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return r5e}deepClone(){return this}}class og extends e7{get kind(){return 0}get missingOpeningBracketIds(){return nn.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=Wo(e),s=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,r=QOe(an(e,this.length))+1;let o=Number.MAX_SAFE_INTEGER;for(let a=s;a<=r;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const u=_n.visibleColumnFromColumn(c,l,t.getOptions().tabSize);o=Math.min(o,u)}return o}}class rD extends e7{static create(e,t,i){return new rD(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return nn.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class o5e extends e7{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Xh=class{constructor(e,t,i,s,r){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=s,this.astNode=r}};class a5e{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new l5e(this.textModel,this.bracketTokens),this._offset=fr,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Vi(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=an(this._offset,e);const t=Wo(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=an(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class l5e{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const r=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=r.length,r}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const r=this.lineTokens,o=r.getCount();let a=null;if(this.lineTokenOffset<o){const l=r.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&l===r.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Ir.getTokenType(l)===0,u=Ir.containsBalancedBrackets(l),h=r.getEndOffset(this.lineTokenOffset);if(u&&c&&this.lineCharOffset<h){const d=r.getLanguageId(this.lineTokenOffset),f=this.line.substring(this.lineCharOffset,h),g=this.bracketTokens.getSingleLanguageBracketTokens(d),p=g.regExpGlobal;if(p){p.lastIndex=0;const m=p.exec(f);m&&(a=g.getToken(m[0]),a&&(this.lineCharOffset+=m.index))}}if(i+=h-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=h}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const s=XOe(e,t,this.lineIdx,this.lineCharOffset);return new Xh(s,0,-1,nn.getEmpty(),new og(s))}}class c5e{constructor(e,t){this.text=e,this._offset=fr,this.idx=0;const i=t.getRegExpStr(),s=i?new RegExp(i+`|
`,"gi"):null,r=[];let o,a=0,l=0,c=0,u=0;const h=[];for(let g=0;g<60;g++)h.push(new Xh(Vi(0,g),0,-1,nn.getEmpty(),new og(Vi(0,g))));const d=[];for(let g=0;g<60;g++)d.push(new Xh(Vi(1,g),0,-1,nn.getEmpty(),new og(Vi(1,g))));if(s)for(s.lastIndex=0;(o=s.exec(e))!==null;){const g=o.index,p=o[0];if(p===`
`)a++,l=g+1;else{if(c!==g){let m;if(u===a){const b=g-c;if(b<h.length)m=h[b];else{const v=Vi(0,b);m=new Xh(v,0,-1,nn.getEmpty(),new og(v))}}else{const b=a-u,v=g-l;if(b===1&&v<d.length)m=d[v];else{const w=Vi(b,v);m=new Xh(w,0,-1,nn.getEmpty(),new og(w))}}r.push(m)}r.push(t.getToken(p)),c=g+p.length,u=a}}const f=e.length;if(c!==f){const g=u===a?Vi(0,f-c):Vi(a-u,f-l);r.push(new Xh(g,0,-1,nn.getEmpty(),new og(g)))}this.length=Vi(a,f-l),this.tokens=r}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new aAe}}class t7{static createFromLanguage(e,t){function i(r){return t.getKey(`${r.languageId}:::${r.bracketText}`)}const s=new Map;for(const r of e.bracketsNew.openingBrackets){const o=Vi(0,r.bracketText.length),a=i(r),l=nn.getEmpty().add(a,zU);s.set(r.bracketText,new Xh(o,1,a,l,rD.create(o,r,l)))}for(const r of e.bracketsNew.closingBrackets){const o=Vi(0,r.bracketText.length);let a=nn.getEmpty();const l=r.getOpeningBrackets();for(const c of l)a=a.add(i(c),zU);s.set(r.bracketText,new Xh(o,2,i(l[0]),a,rD.create(o,r,a)))}return new t7(s)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>u5e(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function u5e(n){let e=Na(n);return/^[\w ]+/.test(n)&&(e=`\\b${e}`),/[\w ]+$/.test(n)&&(e=`${e}\\b`),e}class h5e{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=t7.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function d5e(n){if(n.length===0)return null;if(n.length===1)return n[0];let e=0;function t(){if(e>=n.length)return null;const o=e,a=n[o].listHeight;for(e++;e<n.length&&n[e].listHeight===a;)e++;return e-o>=2?Mse(o===0&&e===n.length?n:n.slice(o,e),!1):n[o]}let i=t(),s=t();if(!s)return i;for(let o=t();o;o=t())HU(i,s)<=HU(s,o)?(i=oR(i,s),s=o):s=oR(s,o);return oR(i,s)}function Mse(n,e=!1){if(n.length===0)return null;if(n.length===1)return n[0];let t=n.length;for(;t>3;){const i=t>>1;for(let s=0;s<i;s++){const r=s<<1;n[s]=Rc.create23(n[r],n[r+1],r+3===t?n[r+2]:null,e)}t=i}return Rc.create23(n[0],n[1],t>=3?n[2]:null,e)}function HU(n,e){return Math.abs(n.listHeight-e.listHeight)}function oR(n,e){return n.listHeight===e.listHeight?Rc.create23(n,e,null,!1):n.listHeight>e.listHeight?f5e(n,e):g5e(e,n)}function f5e(n,e){n=n.toMutable();let t=n;const i=[];let s;for(;;){if(e.listHeight===t.listHeight){s=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let r=i.length-1;r>=0;r--){const o=i[r];s?o.childrenLength>=3?s=Rc.create23(o.unappendChild(),s,null,!1):(o.appendChildOfSameHeight(s),s=void 0):o.handleChildrenChanged()}return s?Rc.create23(n,s,null,!1):n}function g5e(n,e){n=n.toMutable();let t=n;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let s=e;for(let r=i.length-1;r>=0;r--){const o=i[r];s?o.childrenLength>=3?s=Rc.create23(s,o.unprependChild(),null,!1):(o.prependChildOfSameHeight(s),s=void 0):o.handleChildrenChanged()}return s?Rc.create23(s,n,null,!1):n}class p5e{constructor(e){this.lastOffset=fr,this.nextNodes=[e],this.offsets=[fr],this.idxs=[]}readLongestNodeAt(e,t){if(n_(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=I1(this.nextNodes);if(!i)return;const s=I1(this.offsets);if(n_(e,s))return;if(n_(s,e))if(an(s,i.length)<=e)this.nextNodeAfterCurrent();else{const r=aR(i);r!==-1?(this.nextNodes.push(i.getChild(r)),this.offsets.push(s),this.idxs.push(r)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const r=aR(i);if(r===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(r)),this.offsets.push(s),this.idxs.push(r)}}}}nextNodeAfterCurrent(){for(;;){const e=I1(this.offsets),t=I1(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=I1(this.nextNodes),s=aR(i,this.idxs[this.idxs.length-1]);if(s!==-1){this.nextNodes.push(i.getChild(s)),this.offsets.push(an(e,t.length)),this.idxs[this.idxs.length-1]=s;break}else this.idxs.pop()}}}function aR(n,e=-1){for(;;){if(e++,e>=n.childrenLength)return-1;if(n.getChild(e))return e}}function I1(n){return n.length>0?n[n.length-1]:void 0}function UU(n,e,t,i){return new m5e(n,e,t,i).parseDocument()}class m5e{constructor(e,t,i,s){if(this.tokenizer=e,this.createImmutableLists=s,this._itemsConstructed=0,this._itemsFromCache=0,i&&s)throw new Error("Not supported");this.oldNodeReader=i?new p5e(i):void 0,this.positionMapper=new t5e(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(nn.getEmpty(),0);return e||(e=Rc.getEmpty()),e}parseList(e,t){const i=[];for(;;){let r=this.tryReadChildFromCache(e);if(!r){const o=this.tokenizer.peek();if(!o||o.kind===2&&o.bracketIds.intersects(e))break;r=this.parseChild(e,t+1)}r.kind===4&&r.childrenLength===0||i.push(r)}return this.oldNodeReader?d5e(i):Mse(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!nD(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),s=>t!==null&&!n_(s.length,t)?!1:s.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new o5e(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new og(i.length);const s=e.merge(i.bracketIds),r=this.parseList(s,t+1),o=this.tokenizer.peek();return o&&o.kind===2&&(o.bracketId===i.bracketId||o.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),By.create(i.astNode,r,o.astNode)):By.create(i.astNode,r,null)}default:throw new Error("unexpected")}}}function oD(n,e){if(n.length===0)return e;if(e.length===0)return n;const t=new th(jU(n)),i=jU(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let s=t.dequeue();function r(c){if(c===void 0){const h=t.takeWhile(d=>!0)||[];return s&&h.unshift(s),h}const u=[];for(;s&&!nD(c);){const[h,d]=s.splitAt(c);u.push(h),c=Oy(h.lengthAfter,c),s=d??t.dequeue()}return nD(c)||u.push(new fd(!1,c,c)),u}const o=[];function a(c,u,h){if(o.length>0&&Rse(o[o.length-1].endOffset,c)){const d=o[o.length-1];o[o.length-1]=new Hu(d.startOffset,u,an(d.newLength,h))}else o.push({startOffset:c,endOffset:u,newLength:h})}let l=fr;for(const c of i){const u=r(c.lengthBefore);if(c.modified){const h=JOe(u,f=>f.lengthBefore),d=an(l,h);a(l,d,c.lengthAfter),l=d}else for(const h of u){const d=l;l=an(l,h.lengthBefore),h.modified&&a(d,l,h.lengthAfter)}}return o}class fd{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=Oy(e,this.lengthAfter);return Rse(t,fr)?[this,void 0]:this.modified?[new fd(this.modified,this.lengthBefore,e),new fd(this.modified,fr,t)]:[new fd(this.modified,e,e),new fd(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Wo(this.lengthBefore)} -> ${Wo(this.lengthAfter)}`}}function jU(n){const e=[];let t=fr;for(const i of n){const s=Oy(t,i.startOffset);nD(s)||e.push(new fd(!1,s,s));const r=Oy(i.startOffset,i.endOffset);e.push(new fd(!0,r,i.newLength)),t=i.endOffset}return e}class _5e extends ae{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new G,this.denseKeyProvider=new i5e,this.brackets=new h5e(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),s=new c5e(this.textModel.getValue(),i);this.initialAstWithoutTokens=UU(s,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Hu(Vi(i.fromLineNumber-1,0),Vi(i.toLineNumber,0),Vi(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Hu.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=oD(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=oD(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const s=t,r=new a5e(this.textModel,this.brackets);return UU(r,e,s,i)}getBracketsInRange(e,t){this.flushQueue();const i=Vi(e.startLineNumber-1,e.startColumn-1),s=Vi(e.endLineNumber-1,e.endColumn-1);return new Dc(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens;yF(o,fr,o.length,i,s,r,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=x0(e.getStartPosition()),s=x0(e.getEndPosition());return new Dc(r=>{const o=this.initialAstWithoutTokens||this.astWithTokens,a=new b5e(r,t,this.textModel);CF(o,fr,o.length,i,s,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Pse(t,fr,t.length,x0(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Fse(t,fr,t.length,x0(e))}}function Fse(n,e,t,i){if(n.kind===4||n.kind===2){const s=[];for(const r of n.children)t=an(e,r.length),s.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let r=s.length-1;r>=0;r--){const{nodeOffsetStart:o,nodeOffsetEnd:a}=s[r];if(n_(o,i)){const l=Fse(n.children[r],o,a,i);if(l)return l}}return null}else{if(n.kind===3)return null;if(n.kind===1){const s=Kg(e,t);return{bracketInfo:n.bracketInfo,range:s}}}return null}function Pse(n,e,t,i){if(n.kind===4||n.kind===2){for(const s of n.children){if(t=an(e,s.length),n_(i,t)){const r=Pse(s,e,t,i);if(r)return r}e=t}return null}else{if(n.kind===3)return null;if(n.kind===1){const s=Kg(e,t);return{bracketInfo:n.bracketInfo,range:s}}}return null}function yF(n,e,t,i,s,r,o,a,l,c,u=!1){if(o>200)return!0;e:for(;;)switch(n.kind){case 4:{const h=n.childrenLength;for(let d=0;d<h;d++){const f=n.getChild(d);if(f){if(t=an(e,f.length),s_(e,s)&&dv(t,i)){if(dv(t,s)){n=f;continue e}if(!yF(f,e,t,i,s,r,o,0,l,c))return!1}e=t}}return!0}case 2:{const h=!c||!n.closingBracket||n.closingBracket.bracketInfo.closesColorized(n.openingBracket.bracketInfo);let d=0;if(l){let g=l.get(n.openingBracket.text);g===void 0&&(g=0),d=g,h&&(g++,l.set(n.openingBracket.text,g))}const f=n.childrenLength;for(let g=0;g<f;g++){const p=n.getChild(g);if(p){if(t=an(e,p.length),s_(e,s)&&dv(t,i)){if(dv(t,s)&&p.kind!==1){n=p,h?(o++,a=d+1):a=d;continue e}if((h||p.kind!==1||!n.closingBracket)&&!yF(p,e,t,i,s,r,h?o+1:o,h?d+1:d,l,c,!n.closingBracket))return!1}e=t}}return l==null||l.set(n.openingBracket.text,d),!0}case 3:{const h=Kg(e,t);return r(new $U(h,o-1,0,!0))}case 1:{const h=Kg(e,t);return r(new $U(h,o-1,a-1,u))}case 0:return!0}}class b5e{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function CF(n,e,t,i,s,r,o,a){var l;if(o>200)return!0;let c=!0;if(n.kind===2){let u=0;if(a){let f=a.get(n.openingBracket.text);f===void 0&&(f=0),u=f,f++,a.set(n.openingBracket.text,f)}const h=an(e,n.openingBracket.length);let d=-1;if(r.includeMinIndentation&&(d=n.computeMinIndentation(e,r.textModel)),c=r.push(new YOe(Kg(e,t),Kg(e,h),n.closingBracket?Kg(an(h,((l=n.child)===null||l===void 0?void 0:l.length)||fr),t):void 0,o,u,n,d)),e=h,c&&n.child){const f=n.child;if(t=an(e,f.length),s_(e,s)&&dv(t,i)&&(c=CF(f,e,t,i,s,r,o+1,a),!c))return!1}a==null||a.set(n.openingBracket.text,u)}else{let u=e;for(const h of n.children){const d=u;if(u=an(u,h.length),s_(d,s)&&s_(i,u)&&(c=CF(h,d,u,i,s,r,o,a),!c))return!1}}return c}class v5e extends ae{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new wl),this.onDidChangeEmitter=new G,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange(i=>{var s;(!i.languageId||!((s=this.bracketPairsTree.value)===null||s===void 0)&&s.object.didLanguageChange(i.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}))}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)===null||t===void 0||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)===null||e===void 0||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)===null||t===void 0||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new Ae;this.bracketPairsTree.value=w5e(e.add(new _5e(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!1))||Dc.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!0))||Dc.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getBracketsInRange(e,t))||Dc.empty}findMatchingBracketUp(e,t,i){const s=this.textModel.validatePosition(t),r=this.textModel.getLanguageIdAtPosition(s.lineNumber,s.column);if(this.canBuildAST){const o=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew.getClosingBracketInfo(e);if(!o)return null;const a=this.getBracketPairsInRange(H.fromPositions(t,t)).findLast(l=>o.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const o=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!a)return null;const l=a.textIsBracket[o];return l?Fx(this._findMatchingBracketUp(l,s,lR(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(H.fromPositions(e,e)).filter(s=>s.closingBracketRange!==void 0&&(s.openingBracketRange.containsPosition(e)||s.closingBracketRange.containsPosition(e))).findLastMaxBy(Sa(s=>s.openingBracketRange.containsPosition(e)?s.openingBracketRange:s.closingBracketRange,H.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=lR(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,s){const r=t.getCount(),o=t.getLanguageId(s);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=s-1;c>=0;c--){const u=t.getEndOffset(c);if(u<=a)break;if(Ul(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){a=u;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=s+1;c<r;c++){const u=t.getStartOffset(c);if(u>=l)break;if(Ul(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){l=u;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,s=this.textModel.tokenization.getLineTokens(i),r=this.textModel.getLineContent(i),o=s.findTokenIndexAtOffset(e.column-1);if(o<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(o)).brackets;if(a&&!Ul(s.getStandardTokenType(o))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,s,a,o),u=null;for(;;){const h=ia.findNextBracketInRange(a.forwardRegex,i,r,l,c);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){const d=r.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),f=this._matchFoundBracket(h,a.textIsBracket[d],a.textIsOpenBracket[d],t);if(f){if(f instanceof vu)return null;u=f}}l=h.endColumn-1}if(u)return u}if(o>0&&s.getStartOffset(o)===e.column-1){const l=o-1,c=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(l)).brackets;if(c&&!Ul(s.getStandardTokenType(l))){const{searchStartOffset:u,searchEndOffset:h}=this._establishBracketSearchOffsets(e,s,c,l),d=ia.findPrevBracketInRange(c.reversedRegex,i,r,u,h);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn){const f=r.substring(d.startColumn-1,d.endColumn-1).toLowerCase(),g=this._matchFoundBracket(d,c.textIsBracket[f],c.textIsOpenBracket[f],t);if(g)return g instanceof vu?null:g}}}return null}_matchFoundBracket(e,t,i,s){if(!t)return null;const r=i?this._findMatchingBracketDown(t,e.getEndPosition(),s):this._findMatchingBracketUp(t,e.getStartPosition(),s);return r?r instanceof vu?r:[e,r]:null}_findMatchingBracketUp(e,t,i){const s=e.languageId,r=e.reversedRegex;let o=-1,a=0;const l=(c,u,h,d)=>{for(;;){if(i&&++a%100===0&&!i())return vu.INSTANCE;const f=ia.findPrevBracketInRange(r,c,u,h,d);if(!f)break;const g=u.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(g)?o++:e.isClose(g)&&o--,o===0)return f;d=f.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const u=this.textModel.tokenization.getLineTokens(c),h=u.getCount(),d=this.textModel.getLineContent(c);let f=h-1,g=d.length,p=d.length;c===t.lineNumber&&(f=u.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1);let m=!0;for(;f>=0;f--){const b=u.getLanguageId(f)===s&&!Ul(u.getStandardTokenType(f));if(b)m?g=u.getStartOffset(f):(g=u.getStartOffset(f),p=u.getEndOffset(f));else if(m&&g!==p){const v=l(c,d,g,p);if(v)return v}m=b}if(m&&g!==p){const b=l(c,d,g,p);if(b)return b}}return null}_findMatchingBracketDown(e,t,i){const s=e.languageId,r=e.forwardRegex;let o=1,a=0;const l=(u,h,d,f)=>{for(;;){if(i&&++a%100===0&&!i())return vu.INSTANCE;const g=ia.findNextBracketInRange(r,u,h,d,f);if(!g)break;const p=h.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(p)?o++:e.isClose(p)&&o--,o===0)return g;d=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let u=t.lineNumber;u<=c;u++){const h=this.textModel.tokenization.getLineTokens(u),d=h.getCount(),f=this.textModel.getLineContent(u);let g=0,p=0,m=0;u===t.lineNumber&&(g=h.findTokenIndexAtOffset(t.column-1),p=t.column-1,m=t.column-1);let b=!0;for(;g<d;g++){const v=h.getLanguageId(g)===s&&!Ul(h.getStandardTokenType(g));if(v)b||(p=h.getStartOffset(g)),m=h.getEndOffset(g);else if(b&&p!==m){const w=l(u,f,p,m);if(w)return w}b=v}if(b&&p!==m){const v=l(u,f,p,m);if(v)return v}}return null}findPrevBracket(e){var t;const i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getFirstBracketBefore(i))||null;let s=null,r=null,o=null;for(let a=i.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),u=this.textModel.getLineContent(a);let h=c-1,d=u.length,f=u.length;if(a===i.lineNumber){h=l.findTokenIndexAtOffset(i.column-1),d=i.column-1,f=i.column-1;const p=l.getLanguageId(h);s!==p&&(s=p,r=this.languageConfigurationService.getLanguageConfiguration(s).brackets,o=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew)}let g=!0;for(;h>=0;h--){const p=l.getLanguageId(h);if(s!==p){if(r&&o&&g&&d!==f){const b=ia.findPrevBracketInRange(r.reversedRegex,a,u,d,f);if(b)return this._toFoundBracket(o,b);g=!1}s=p,r=this.languageConfigurationService.getLanguageConfiguration(s).brackets,o=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew}const m=!!r&&!Ul(l.getStandardTokenType(h));if(m)g?d=l.getStartOffset(h):(d=l.getStartOffset(h),f=l.getEndOffset(h));else if(o&&r&&g&&d!==f){const b=ia.findPrevBracketInRange(r.reversedRegex,a,u,d,f);if(b)return this._toFoundBracket(o,b)}g=m}if(o&&r&&g&&d!==f){const p=ia.findPrevBracketInRange(r.reversedRegex,a,u,d,f);if(p)return this._toFoundBracket(o,p)}}return null}findNextBracket(e){var t;const i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getFirstBracketAfter(i))||null;const s=this.textModel.getLineCount();let r=null,o=null,a=null;for(let l=i.lineNumber;l<=s;l++){const c=this.textModel.tokenization.getLineTokens(l),u=c.getCount(),h=this.textModel.getLineContent(l);let d=0,f=0,g=0;if(l===i.lineNumber){d=c.findTokenIndexAtOffset(i.column-1),f=i.column-1,g=i.column-1;const m=c.getLanguageId(d);r!==m&&(r=m,o=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew)}let p=!0;for(;d<u;d++){const m=c.getLanguageId(d);if(r!==m){if(a&&o&&p&&f!==g){const v=ia.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(v)return this._toFoundBracket(a,v);p=!1}r=m,o=this.languageConfigurationService.getLanguageConfiguration(r).brackets,a=this.languageConfigurationService.getLanguageConfiguration(r).bracketsNew}const b=!!o&&!Ul(c.getStandardTokenType(d));if(b)p||(f=c.getStartOffset(d)),g=c.getEndOffset(d);else if(a&&o&&p&&f!==g){const v=ia.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(v)return this._toFoundBracket(a,v)}p=b}if(a&&o&&p&&f!==g){const m=ia.findNextBracketInRange(o.forwardRegex,l,h,f,g);if(m)return this._toFoundBracket(a,m)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const f=H.fromPositions(i),g=this.getBracketPairsInRange(H.fromPositions(i,i)).findLast(p=>p.closingBracketRange!==void 0&&p.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}const s=lR(t),r=this.textModel.getLineCount(),o=new Map;let a=[];const l=(f,g)=>{if(!o.has(f)){const p=[];for(let m=0,b=g?g.brackets.length:0;m<b;m++)p[m]=0;o.set(f,p)}a=o.get(f)};let c=0;const u=(f,g,p,m,b)=>{for(;;){if(s&&++c%100===0&&!s())return vu.INSTANCE;const v=ia.findNextBracketInRange(f.forwardRegex,g,p,m,b);if(!v)break;const w=p.substring(v.startColumn-1,v.endColumn-1).toLowerCase(),y=f.textIsBracket[w];if(y&&(y.isOpen(w)?a[y.index]++:y.isClose(w)&&a[y.index]--,a[y.index]===-1))return this._matchFoundBracket(v,y,!1,s);m=v.endColumn-1}return null};let h=null,d=null;for(let f=i.lineNumber;f<=r;f++){const g=this.textModel.tokenization.getLineTokens(f),p=g.getCount(),m=this.textModel.getLineContent(f);let b=0,v=0,w=0;if(f===i.lineNumber){b=g.findTokenIndexAtOffset(i.column-1),v=i.column-1,w=i.column-1;const x=g.getLanguageId(b);h!==x&&(h=x,d=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,d))}let y=!0;for(;b<p;b++){const x=g.getLanguageId(b);if(h!==x){if(d&&y&&v!==w){const S=u(d,f,m,v,w);if(S)return Fx(S);y=!1}h=x,d=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,d)}const D=!!d&&!Ul(g.getStandardTokenType(b));if(D)y||(v=g.getStartOffset(b)),w=g.getEndOffset(b);else if(d&&y&&v!==w){const S=u(d,f,m,v,w);if(S)return Fx(S)}y=D}if(d&&y&&v!==w){const x=u(d,f,m,v,w);if(x)return Fx(x)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const s=e.getBracketInfo(i);return s?{range:t,bracketInfo:s}:null}}function w5e(n,e){return{object:n,dispose:()=>e==null?void 0:e.dispose()}}function lR(n){if(typeof n>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=n}}class vu{constructor(){this._searchCanceledBrand=void 0}}vu.INSTANCE=new vu;function Fx(n){return n instanceof vu?null:n}class y5e extends ae{constructor(e){super(),this.textModel=e,this.colorProvider=new Ose,this.onDidChangeEmitter=new G,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,s){return s?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(o=>({id:`bracket${o.range.toString()}-${o.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(o,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:o.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new H(1,1,this.textModel.getLineCount(),1),e,t):[]}}class Ose{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}$a((n,e)=>{const t=[pse,mse,_se,bse,vse,wse],i=new Ose;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${n.getColor(yPe)}; }`);const s=t.map(r=>n.getColor(r)).filter(r=>!!r).filter(r=>!r.isTransparent());for(let r=0;r<30;r++){const o=s[r%s.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(r)} { color: ${o}; }`)}});function Px(n){return n.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Kn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,s){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=s}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Px(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Px(this.oldText)}")`:`(replace@${this.oldPosition} "${Px(this.oldText)}" with "${Px(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const s=t.length;il(e,s,i),i+=4;for(let r=0;r<s;r++)oRe(e,t.charCodeAt(r),i),i+=2;return i}static _readString(e,t){const i=tl(e,t);return t+=4,lRe(e,t,i)}writeSize(){return 4+4+Kn._writeStringSize(this.oldText)+Kn._writeStringSize(this.newText)}write(e,t){return il(e,this.oldPosition,t),t+=4,il(e,this.newPosition,t),t+=4,t=Kn._writeString(e,this.oldText,t),t=Kn._writeString(e,this.newText,t),t}static read(e,t,i){const s=tl(e,t);t+=4;const r=tl(e,t);t+=4;const o=Kn._readString(e,t);t+=Kn._writeStringSize(o);const a=Kn._readString(e,t);return t+=Kn._writeStringSize(a),i.push(new Kn(s,o,r,a)),t}}function C5e(n,e){return n===null||n.length===0?e:new ql(n,e).compress()}class ql{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),s=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(s),s=this._getCurr(++t);continue}if(s===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(s.oldEnd<=i.newPosition){this._acceptCurr(s),s=this._getCurr(++t);continue}if(i.newEnd<=s.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(s.oldPosition<i.newPosition){const[c,u]=ql._splitCurr(s,i.newPosition-s.oldPosition);this._acceptCurr(c),s=u;continue}if(i.newPosition<s.oldPosition){const[c,u]=ql._splitPrev(i,s.oldPosition-i.newPosition);this._acceptPrev(c),i=u;continue}let a,l;if(s.oldEnd===i.newEnd)a=i,l=s,i=this._getPrev(++e),s=this._getCurr(++t);else if(s.oldEnd<i.newEnd){const[c,u]=ql._splitPrev(i,s.oldLength);a=c,l=s,i=u,s=this._getCurr(++t)}else{const[c,u]=ql._splitCurr(s,i.newLength);a=i,l=c,i=this._getPrev(++e),s=u}this._result[this._resultLen++]=new Kn(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const r=ql._merge(this._result);return ql._removeNoOps(r)}_acceptCurr(e){this._result[this._resultLen++]=ql._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=ql._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new Kn(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new Kn(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),s=e.newText.substr(t);return[new Kn(e.oldPosition,e.oldText,e.newPosition,i),new Kn(e.oldEnd,"",e.newPosition+t,s)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),s=e.oldText.substr(t);return[new Kn(e.oldPosition,i,e.newPosition,e.newText),new Kn(e.oldPosition+t,s,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,s=e[0];for(let r=1;r<e.length;r++){const o=e[r];s.oldEnd===o.oldPosition?s=new Kn(s.oldPosition,s.oldText+o.oldText,s.newPosition,s.newText+o.newText):(t[i++]=s,s=o)}return t[i++]=s,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let s=0;s<e.length;s++){const r=e[s];r.oldText!==r.newText&&(t[i++]=r)}return t}}function kh(n){return n===47||n===92}function Bse(n){return n.replace(/[\\/]/g,rn.sep)}function S5e(n){return n.indexOf("/")===-1&&(n=Bse(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function qU(n,e=rn.sep){if(!n)return"";const t=n.length,i=n.charCodeAt(0);if(kh(i)){if(kh(n.charCodeAt(1))&&!kh(n.charCodeAt(2))){let r=3;const o=r;for(;r<t&&!kh(n.charCodeAt(r));r++);if(o!==r&&!kh(n.charCodeAt(r+1))){for(r+=1;r<t;r++)if(kh(n.charCodeAt(r)))return n.slice(0,r+1).replace(/[\\/]/g,e)}}return e}else if(x5e(i)&&n.charCodeAt(1)===58)return kh(n.charCodeAt(2))?n.slice(0,2)+e:n.slice(0,2);let s=n.indexOf("://");if(s!==-1){for(s+=3;s<t;s++)if(kh(n.charCodeAt(s)))return n.slice(0,s+1)}return""}function SF(n,e,t,i=Dd){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!c8(n,e))return!1;if(e.length===n.length)return!0;let r=e.length;return e.charAt(e.length-1)===i&&r--,n.charAt(r)===i}return e.charAt(e.length-1)!==i&&(e+=i),n.indexOf(e)===0}function x5e(n){return n>=65&&n<=90||n>=97&&n<=122}function tu(n){return IL(n,!0)}class k5e{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:cy(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===bt.file)return SF(tu(e),tu(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(KU(e.authority,t.authority))return SF(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return ot.joinPath(e,...t)}basenameOrAuthority(e){return Cl(e)||e.authority}basename(e){return rn.basename(e.path)}extname(e){return rn.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===bt.file?t=ot.file(TAe(tu(e))).path:(t=rn.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===bt.file?t=ot.file(kie(tu(e))).path:t=rn.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!KU(e.authority,t.authority))return;if(e.scheme===bt.file){const r=EAe(tu(e),tu(t));return br?Bse(r):r}let i=e.path||"/";const s=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(i.length,s.length);r<o&&!(i.charCodeAt(r)!==s.charCodeAt(r)&&i.charAt(r).toLowerCase()!==s.charAt(r).toLowerCase());r++);i=s.substr(0,r)+i.substr(r)}return rn.relative(i,s)}resolvePath(e,t){if(e.scheme===bt.file){const i=ot.file(DAe(tu(e),t));return e.with({authority:i.authority,path:i.path})}return t=S5e(t),e.with({path:rn.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&h0(e,t)}hasTrailingPathSeparator(e,t=Dd){if(e.scheme===bt.file){const i=tu(e);return i.length>qU(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Dd){return ZU(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Dd){let i=!1;if(e.scheme===bt.file){const s=tu(e);i=s!==void 0&&s.length===qU(s).length&&s[s.length-1]===t}else{t="/";const s=e.path;i=s.length===1&&s.charCodeAt(s.length-1)===47}return!i&&!ZU(e,t)?e.with({path:e.path+"/"}):e}}const oi=new k5e(()=>!1),i7=oi.isEqual.bind(oi);oi.isEqualOrParent.bind(oi);oi.getComparisonKey.bind(oi);const L5e=oi.basenameOrAuthority.bind(oi),Cl=oi.basename.bind(oi);oi.extname.bind(oi);const n7=oi.dirname.bind(oi);oi.joinPath.bind(oi);const D5e=oi.normalizePath.bind(oi);oi.relativePath.bind(oi);const GU=oi.resolvePath.bind(oi);oi.isAbsolutePath.bind(oi);const KU=oi.isEqualAuthority.bind(oi),ZU=oi.hasTrailingPathSeparator.bind(oi);oi.removeTrailingPathSeparator.bind(oi);oi.addTrailingPathSeparator.bind(oi);var aD;(function(n){n.META_DATA_LABEL="label",n.META_DATA_DESCRIPTION="description",n.META_DATA_SIZE="size",n.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const r=t.path.substring(0,t.path.indexOf(";"));return r&&i.set(n.META_DATA_MIME,r),i}n.parseMetaData=e})(aD||(aD={}));function Vm(n){return n.toString()}class xn{static create(e,t){const i=e.getAlternativeVersionId(),s=xF(e);return new xn(i,i,s,s,t,t,[])}constructor(e,t,i,s,r,o,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=s,this.beforeCursorState=r,this.afterCursorState=o,this.changes=a}append(e,t,i,s,r){t.length>0&&(this.changes=C5e(this.changes,t)),this.afterEOL=i,this.afterVersionId=s,this.afterCursorState=r}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(il(e,t?t.length:0,i),i+=4,t)for(const s of t)il(e,s.selectionStartLineNumber,i),i+=4,il(e,s.selectionStartColumn,i),i+=4,il(e,s.positionLineNumber,i),i+=4,il(e,s.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const s=tl(e,t);t+=4;for(let r=0;r<s;r++){const o=tl(e,t);t+=4;const a=tl(e,t);t+=4;const l=tl(e,t);t+=4;const c=tl(e,t);t+=4,i.push(new Lt(o,a,l,c))}return t}serialize(){let e=10+xn._writeSelectionsSize(this.beforeCursorState)+xn._writeSelectionsSize(this.afterCursorState)+4;for(const s of this.changes)e+=s.writeSize();const t=new Uint8Array(e);let i=0;il(t,this.beforeVersionId,i),i+=4,il(t,this.afterVersionId,i),i+=4,CH(t,this.beforeEOL,i),i+=1,CH(t,this.afterEOL,i),i+=1,i=xn._writeSelections(t,this.beforeCursorState,i),i=xn._writeSelections(t,this.afterCursorState,i),il(t,this.changes.length,i),i+=4;for(const s of this.changes)i=s.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const s=tl(t,i);i+=4;const r=tl(t,i);i+=4;const o=yH(t,i);i+=1;const a=yH(t,i);i+=1;const l=[];i=xn._readSelections(t,i,l);const c=[];i=xn._readSelections(t,i,c);const u=tl(t,i);i+=4;const h=[];for(let d=0;d<u;d++)i=Kn.read(t,i,h);return new xn(s,r,o,a,l,c,h)}}class Wse{get type(){return 0}get resource(){return ot.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,s){this.label=e,this.code=t,this.model=i,this._data=xn.create(i,s)}toString(){return(this._data instanceof xn?this._data:xn.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(ot.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof xn}append(e,t,i,s,r){this._data instanceof xn&&this._data.append(e,t,i,s,r)}close(){this._data instanceof xn&&(this._data=this._data.serialize())}open(){this._data instanceof xn||(this._data=xn.deserialize(this._data))}undo(){if(ot.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof xn&&(this._data=this._data.serialize());const e=xn.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(ot.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof xn&&(this._data=this._data.serialize());const e=xn.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof xn&&(this._data=this._data.serialize()),this._data.byteLength+168}}class E5e{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const s of this._editStackElementsArr){const r=Vm(s.resource);this._editStackElementsMap.set(r,s)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=Vm(e);return this._editStackElementsMap.has(t)}setModel(e){const t=Vm(ot.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=Vm(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,s,r){const o=Vm(e.uri);this._editStackElementsMap.get(o).append(e,t,i,s,r)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=Vm(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${Cl(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function xF(n){return n.getEOL()===`
`?0:1}function wu(n){return n?n instanceof Wse||n instanceof E5e:!1}class s7{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);wu(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);wu(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(wu(i)&&i.canAppend(this._model))return i;const s=new Wse(_("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(s,t),s}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],xF(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,s){const r=this._getOrCreateEditStackElement(e,s),o=this._model.applyEdits(t,!0),a=s7._computeCursorState(i,o),l=o.map((c,u)=>({index:u,textChange:c.textChange}));return l.sort((c,u)=>c.textChange.oldPosition===u.textChange.oldPosition?c.index-u.index:c.textChange.oldPosition-u.textChange.oldPosition),r.append(this._model,l.map(c=>c.textChange),xF(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return Ft(i),null}}}class T5e{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function A5e(n,e,t,i,s){s.spacesDiff=0,s.looksLikeAlignment=!1;let r;for(r=0;r<e&&r<i;r++){const d=n.charCodeAt(r),f=t.charCodeAt(r);if(d!==f)break}let o=0,a=0;for(let d=r;d<e;d++)n.charCodeAt(d)===32?o++:a++;let l=0,c=0;for(let d=r;d<i;d++)t.charCodeAt(d)===32?l++:c++;if(o>0&&a>0||l>0&&c>0)return;const u=Math.abs(a-c),h=Math.abs(o-l);if(u===0){s.spacesDiff=h,h>0&&0<=l-1&&l-1<n.length&&l<t.length&&t.charCodeAt(l)!==32&&n.charCodeAt(l-1)===32&&n.charCodeAt(n.length-1)===44&&(s.looksLikeAlignment=!0);return}if(h%u===0){s.spacesDiff=h/u;return}}function YU(n,e,t){const i=Math.min(n.getLineCount(),1e4);let s=0,r=0,o="",a=0;const l=[2,4,6,8,3,5,7],c=8,u=[0,0,0,0,0,0,0,0,0],h=new T5e;for(let g=1;g<=i;g++){const p=n.getLineLength(g),m=n.getLineContent(g),b=p<=65536;let v=!1,w=0,y=0,x=0;for(let S=0,T=p;S<T;S++){const k=b?m.charCodeAt(S):n.getLineCharCode(g,S);if(k===9)x++;else if(k===32)y++;else{v=!0,w=S;break}}if(!v||(x>0?s++:y>1&&r++,A5e(o,a,m,w,h),h.looksLikeAlignment&&!(t&&e===h.spacesDiff)))continue;const D=h.spacesDiff;D<=c&&u[D]++,o=m,a=w}let d=t;s!==r&&(d=s<r);let f=e;if(d){let g=d?0:.1*i;l.forEach(p=>{const m=u[p];m>g&&(g=m,f=p)}),f===4&&u[4]>0&&u[2]>0&&u[2]>=u[4]/2&&(f=2)}return{insertSpaces:d,tabSize:f}}function ir(n){return(n.metadata&1)>>>0}function ni(n,e){n.metadata=n.metadata&254|e<<0}function Jn(n){return(n.metadata&2)>>>1===1}function ei(n,e){n.metadata=n.metadata&253|(e?1:0)<<1}function Vse(n){return(n.metadata&4)>>>2===1}function XU(n,e){n.metadata=n.metadata&251|(e?1:0)<<2}function $se(n){return(n.metadata&64)>>>6===1}function QU(n,e){n.metadata=n.metadata&191|(e?1:0)<<6}function I5e(n){return(n.metadata&24)>>>3}function JU(n,e){n.metadata=n.metadata&231|e<<3}function N5e(n){return(n.metadata&32)>>>5===1}function ej(n,e){n.metadata=n.metadata&223|(e?1:0)<<5}class zse{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,ni(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,XU(this,!1),QU(this,!1),JU(this,1),ej(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,ei(this,!1)}reset(e,t,i,s){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=s}setOptions(e){this.options=e;const t=this.options.className;XU(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),QU(this,this.options.glyphMarginClassName!==null),JU(this,this.options.stickiness),ej(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const at=new zse(null,0,0);at.parent=at;at.left=at;at.right=at;ni(at,0);class cR{constructor(){this.root=at,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,s,r,o){return this.root===at?[]:V5e(this,e,t,i,s,r,o)}search(e,t,i,s){return this.root===at?[]:W5e(this,e,t,i,s)}collectNodesFromOwner(e){return O5e(this,e)}collectNodesPostOrder(){return B5e(this)}insert(e){tj(this,e),this._normalizeDeltaIfNecessary()}delete(e){ij(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let s=0;for(;e!==this.root;)e===e.parent.right&&(s+=e.parent.delta),e=e.parent;const r=i.start+s,o=i.end+s;i.setCachedOffsets(r,o,t)}acceptReplace(e,t,i,s){const r=F5e(this,e,e+t);for(let o=0,a=r.length;o<a;o++){const l=r[o];ij(this,l)}this._normalizeDeltaIfNecessary(),P5e(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let o=0,a=r.length;o<a;o++){const l=r[o];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,M5e(l,e,e+t,i,s),l.maxEnd=l.end,tj(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,R5e(this))}}function R5e(n){let e=n.root,t=0;for(;e!==at;){if(e.left!==at&&!Jn(e.left)){e=e.left;continue}if(e.right!==at&&!Jn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,of(e),ei(e,!0),ei(e.left,!1),ei(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}ei(n.root,!1)}function $m(n,e,t,i){return n<t?!0:n>t||i===1?!1:i===2?!0:e}function M5e(n,e,t,i,s){const r=I5e(n),o=r===0||r===2,a=r===1||r===2,l=t-e,c=i,u=Math.min(l,c),h=n.start;let d=!1;const f=n.end;let g=!1;e<=h&&f<=t&&N5e(n)&&(n.start=e,d=!0,n.end=e,g=!0);{const m=s?1:l>0?2:0;!d&&$m(h,o,e,m)&&(d=!0),!g&&$m(f,a,e,m)&&(g=!0)}if(u>0&&!s){const m=l>c?2:0;!d&&$m(h,o,e+u,m)&&(d=!0),!g&&$m(f,a,e+u,m)&&(g=!0)}{const m=s?1:0;!d&&$m(h,o,t,m)&&(n.start=e+c,d=!0),!g&&$m(f,a,t,m)&&(n.end=e+c,g=!0)}const p=c-l;d||(n.start=Math.max(0,h+p)),g||(n.end=Math.max(0,f+p)),n.start>n.end&&(n.end=n.start)}function F5e(n,e,t){let i=n.root,s=0,r=0,o=0,a=0;const l=[];let c=0;for(;i!==at;){if(Jn(i)){ei(i.left,!1),ei(i.right,!1),i===i.parent.right&&(s-=i.parent.delta),i=i.parent;continue}if(!Jn(i.left)){if(r=s+i.maxEnd,r<e){ei(i,!0);continue}if(i.left!==at){i=i.left;continue}}if(o=s+i.start,o>t){ei(i,!0);continue}if(a=s+i.end,a>=e&&(i.setCachedOffsets(o,a,0),l[c++]=i),ei(i,!0),i.right!==at&&!Jn(i.right)){s+=i.delta,i=i.right;continue}}return ei(n.root,!1),l}function P5e(n,e,t,i){let s=n.root,r=0,o=0,a=0;const l=i-(t-e);for(;s!==at;){if(Jn(s)){ei(s.left,!1),ei(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),of(s),s=s.parent;continue}if(!Jn(s.left)){if(o=r+s.maxEnd,o<e){ei(s,!0);continue}if(s.left!==at){s=s.left;continue}}if(a=r+s.start,a>t){s.start+=l,s.end+=l,s.delta+=l,(s.delta<-1073741824||s.delta>1073741824)&&(n.requestNormalizeDelta=!0),ei(s,!0);continue}if(ei(s,!0),s.right!==at&&!Jn(s.right)){r+=s.delta,s=s.right;continue}}ei(n.root,!1)}function O5e(n,e){let t=n.root;const i=[];let s=0;for(;t!==at;){if(Jn(t)){ei(t.left,!1),ei(t.right,!1),t=t.parent;continue}if(t.left!==at&&!Jn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[s++]=t),ei(t,!0),t.right!==at&&!Jn(t.right)){t=t.right;continue}}return ei(n.root,!1),i}function B5e(n){let e=n.root;const t=[];let i=0;for(;e!==at;){if(Jn(e)){ei(e.left,!1),ei(e.right,!1),e=e.parent;continue}if(e.left!==at&&!Jn(e.left)){e=e.left;continue}if(e.right!==at&&!Jn(e.right)){e=e.right;continue}t[i++]=e,ei(e,!0)}return ei(n.root,!1),t}function W5e(n,e,t,i,s){let r=n.root,o=0,a=0,l=0;const c=[];let u=0;for(;r!==at;){if(Jn(r)){ei(r.left,!1),ei(r.right,!1),r===r.parent.right&&(o-=r.parent.delta),r=r.parent;continue}if(r.left!==at&&!Jn(r.left)){r=r.left;continue}a=o+r.start,l=o+r.end,r.setCachedOffsets(a,l,i);let h=!0;if(e&&r.ownerId&&r.ownerId!==e&&(h=!1),t&&Vse(r)&&(h=!1),s&&!$se(r)&&(h=!1),h&&(c[u++]=r),ei(r,!0),r.right!==at&&!Jn(r.right)){o+=r.delta,r=r.right;continue}}return ei(n.root,!1),c}function V5e(n,e,t,i,s,r,o){let a=n.root,l=0,c=0,u=0,h=0;const d=[];let f=0;for(;a!==at;){if(Jn(a)){ei(a.left,!1),ei(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Jn(a.left)){if(c=l+a.maxEnd,c<e){ei(a,!0);continue}if(a.left!==at){a=a.left;continue}}if(u=l+a.start,u>t){ei(a,!0);continue}if(h=l+a.end,h>=e){a.setCachedOffsets(u,h,r);let g=!0;i&&a.ownerId&&a.ownerId!==i&&(g=!1),s&&Vse(a)&&(g=!1),o&&!$se(a)&&(g=!1),g&&(d[f++]=a)}if(ei(a,!0),a.right!==at&&!Jn(a.right)){l+=a.delta,a=a.right;continue}}return ei(n.root,!1),d}function tj(n,e){if(n.root===at)return e.parent=at,e.left=at,e.right=at,ni(e,0),n.root=e,n.root;$5e(n,e),Ph(e.parent);let t=e;for(;t!==n.root&&ir(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;ir(i)===1?(ni(t.parent,0),ni(i,0),ni(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Qv(n,t)),ni(t.parent,0),ni(t.parent.parent,1),Jv(n,t.parent.parent))}else{const i=t.parent.parent.left;ir(i)===1?(ni(t.parent,0),ni(i,0),ni(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,Jv(n,t)),ni(t.parent,0),ni(t.parent.parent,1),Qv(n,t.parent.parent))}return ni(n.root,0),e}function $5e(n,e){let t=0,i=n.root;const s=e.start,r=e.end;for(;;)if(H5e(s,r,i.start+t,i.end+t)<0)if(i.left===at){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===at){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=at,e.right=at,ni(e,1)}function ij(n,e){let t,i;if(e.left===at?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===at?(t=e.left,i=e):(i=z5e(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(n.requestNormalizeDelta=!0)),i===n.root){n.root=t,ni(t,0),e.detach(),uR(),of(t),n.root.parent=at;return}const s=ir(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,ni(i,ir(e)),e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==at&&(i.left.parent=i),i.right!==at&&(i.right.parent=i)),e.detach(),s){Ph(t.parent),i!==e&&(Ph(i),Ph(i.parent)),uR();return}Ph(t),Ph(t.parent),i!==e&&(Ph(i),Ph(i.parent));let r;for(;t!==n.root&&ir(t)===0;)t===t.parent.left?(r=t.parent.right,ir(r)===1&&(ni(r,0),ni(t.parent,1),Qv(n,t.parent),r=t.parent.right),ir(r.left)===0&&ir(r.right)===0?(ni(r,1),t=t.parent):(ir(r.right)===0&&(ni(r.left,0),ni(r,1),Jv(n,r),r=t.parent.right),ni(r,ir(t.parent)),ni(t.parent,0),ni(r.right,0),Qv(n,t.parent),t=n.root)):(r=t.parent.left,ir(r)===1&&(ni(r,0),ni(t.parent,1),Jv(n,t.parent),r=t.parent.left),ir(r.left)===0&&ir(r.right)===0?(ni(r,1),t=t.parent):(ir(r.left)===0&&(ni(r.right,0),ni(r,1),Qv(n,r),r=t.parent.left),ni(r,ir(t.parent)),ni(t.parent,0),ni(r.left,0),Jv(n,t.parent),t=n.root));ni(t,0),uR()}function z5e(n){for(;n.left!==at;)n=n.left;return n}function uR(){at.parent=at,at.delta=0,at.start=0,at.end=0}function Qv(n,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==at&&(t.left.parent=e),t.parent=e.parent,e.parent===at?n.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,of(e),of(t)}function Jv(n,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(n.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==at&&(t.right.parent=e),t.parent=e.parent,e.parent===at?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,of(e),of(t)}function Hse(n){let e=n.end;if(n.left!==at){const t=n.left.maxEnd;t>e&&(e=t)}if(n.right!==at){const t=n.right.maxEnd+n.delta;t>e&&(e=t)}return e}function of(n){n.maxEnd=Hse(n)}function Ph(n){for(;n!==at;){const e=Hse(n);if(n.maxEnd===e)return;n.maxEnd=e,n=n.parent}}function H5e(n,e,t,i){return n===t?e-i:n-t}class kF{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Je)return r7(this.right);let e=this;for(;e.parent!==Je&&e.parent.left!==e;)e=e.parent;return e.parent===Je?Je:e.parent}prev(){if(this.left!==Je)return Use(this.left);let e=this;for(;e.parent!==Je&&e.parent.right!==e;)e=e.parent;return e.parent===Je?Je:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Je=new kF(null,0);Je.parent=Je;Je.left=Je;Je.right=Je;Je.color=0;function r7(n){for(;n.left!==Je;)n=n.left;return n}function Use(n){for(;n.right!==Je;)n=n.right;return n}function o7(n){return n===Je?0:n.size_left+n.piece.length+o7(n.right)}function a7(n){return n===Je?0:n.lf_left+n.piece.lineFeedCnt+a7(n.right)}function hR(){Je.parent=Je}function ew(n,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Je&&(t.left.parent=e),t.parent=e.parent,e.parent===Je?n.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function tw(n,e){const t=e.left;e.left=t.right,t.right!==Je&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Je?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Ox(n,e){let t,i;if(e.left===Je?(i=e,t=i.right):e.right===Je?(i=e,t=i.left):(i=r7(e.right),t=i.right),i===n.root){n.root=t,t.color=0,e.detach(),hR(),n.root.parent=Je;return}const s=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,fv(n,t)):(i.parent===e?t.parent=i:t.parent=i.parent,fv(n,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Je&&(i.left.parent=i),i.right!==Je&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,fv(n,i)),e.detach(),t.parent.left===t){const o=o7(t),a=a7(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,uu(n,t.parent,l,c)}}if(fv(n,t.parent),s){hR();return}let r;for(;t!==n.root&&t.color===0;)t===t.parent.left?(r=t.parent.right,r.color===1&&(r.color=0,t.parent.color=1,ew(n,t.parent),r=t.parent.right),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.right.color===0&&(r.left.color=0,r.color=1,tw(n,r),r=t.parent.right),r.color=t.parent.color,t.parent.color=0,r.right.color=0,ew(n,t.parent),t=n.root)):(r=t.parent.left,r.color===1&&(r.color=0,t.parent.color=1,tw(n,t.parent),r=t.parent.left),r.left.color===0&&r.right.color===0?(r.color=1,t=t.parent):(r.left.color===0&&(r.right.color=0,r.color=1,ew(n,r),r=t.parent.left),r.color=t.parent.color,t.parent.color=0,r.left.color=0,tw(n,t.parent),t=n.root));t.color=0,hR()}function nj(n,e){for(fv(n,e);e!==n.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,ew(n,e)),e.parent.color=0,e.parent.parent.color=1,tw(n,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,tw(n,e)),e.parent.color=0,e.parent.parent.color=1,ew(n,e.parent.parent))}n.root.color=0}function uu(n,e,t,i){for(;e!==n.root&&e!==Je;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function fv(n,e){let t=0,i=0;if(e!==n.root){for(;e!==n.root&&e===e.parent.right;)e=e.parent;if(e!==n.root)for(e=e.parent,t=o7(e.left)-e.size_left,i=a7(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==n.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const iu=65535;function jse(n){let e;return n[n.length-1]<65536?e=new Uint16Array(n.length):e=new Uint32Array(n.length),e.set(n,0),e}class U5e{constructor(e,t,i,s,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=s,this.isBasicASCII=r}}function hu(n,e=!0){const t=[0];let i=1;for(let s=0,r=n.length;s<r;s++){const o=n.charCodeAt(s);o===13?s+1<r&&n.charCodeAt(s+1)===10?(t[i++]=s+2,s++):t[i++]=s+1:o===10&&(t[i++]=s+1)}return e?jse(t):t}function j5e(n,e){n.length=0,n[0]=0;let t=1,i=0,s=0,r=0,o=!0;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);u===13?l+1<c&&e.charCodeAt(l+1)===10?(r++,n[t++]=l+2,l++):(i++,n[t++]=l+1):u===10?(s++,n[t++]=l+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new U5e(jse(n),i,s,r,o);return n.length=0,a}class xr{constructor(e,t,i,s,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=s,this.length=r}}class ag{constructor(e,t){this.buffer=e,this.lineStarts=t}}class q5e{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Je&&e.iterate(e.root,i=>(i!==Je&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class G5e{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let s=0;s<i.length;s++){const r=i[s];if(r.node.parent===null||r.nodeStartOffset>=e){i[s]=null,t=!0;continue}}if(t){const s=[];for(const r of i)r!==null&&s.push(r);this._cache=s}}}class K5e{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new ag("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Je,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let s=null;for(let r=0,o=e.length;r<o;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=hu(e[r].buffer));const a=new xr(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]),s=this.rbInsertRight(s,a)}this._searchCache=new G5e(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=iu,i=t-Math.floor(t/3),s=i*2;let r="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),u=c.length;if(o<=i||o+u<s)return r+=c,o+=u,!0;const h=r.replace(/\r\n|\r|\n/g,e);return a.push(new ag(h,hu(h))),r=c,o=u,!0}),o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new ag(l,hu(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new q5e(this,e)}getOffsetAt(e,t){let i=0,s=this.root;for(;s!==Je;)if(s.left!==Je&&s.lf_left+1>=e)s=s.left;else if(s.lf_left+s.piece.lineFeedCnt+1>=e){i+=s.size_left;const r=this.getAccumulatedValue(s,e-s.lf_left-2);return i+=r+t-1}else e-=s.lf_left+s.piece.lineFeedCnt,i+=s.size_left+s.piece.length,s=s.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const s=e;for(;t!==Je;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const o=this.getOffsetAt(i+1,1),a=s-o;return new X(i+1,a+1)}return new X(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===Je){const r=this.getOffsetAt(i+1,1),o=s-e-r;return new X(i+1,o+1)}else t=t.right;return new X(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),s=this.nodeAt2(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,s);return t?t!==this._EOL||!this._EOLNormalized?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const s=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=s.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==Je;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",s=!1;return this.iterate(this.root,r=>{if(r===Je)return!0;const o=r.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,h=o.end.line;let d=c[u]+o.start.column;if(s&&(l.charCodeAt(d)===10&&(d++,a--),e[t++]=i,i="",s=!1,a===0))return!0;if(u===h)return!this._EOLNormalized&&l.charCodeAt(d+a-1)===13?(s=!0,i+=l.substr(d,a-1)):i+=l.substr(d,a),!0;i+=this._EOLNormalized?l.substring(d,Math.max(d,c[u+1]-this._EOLLength)):l.substring(d,c[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=u+1;f<h;f++)i=this._EOLNormalized?l.substring(c[f],c[f+1]-this._EOLLength):l.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[h]+o.end.column-1)===13?(s=!0,o.end.column===0?t--:i=l.substr(c[h],o.end.column-1)):i=l.substr(c[h],o.end.column),!0}),s&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],s=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(s)}else{const t=this._buffers[e.node.piece.bufferIndex],s=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(s)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,s,r,o,a,l,c,u,h){const d=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,r),p=this.offsetInBuffer(e.piece.bufferIndex,o);let m;const b={line:0,column:0};let v,w;t._wordSeparators?(v=d.buffer.substring(g,p),w=y=>y+g,t.reset(0)):(v=d.buffer,w=y=>y,t.reset(g));do if(m=t.next(v),m){if(w(m.index)>=p)return u;this.positionInBuffer(e,w(m.index)-f,b);const y=this.getLineFeedCnt(e.piece.bufferIndex,r,b),x=b.line===r.line?b.column-r.column+s:b.column+1,D=x+m[0].length;if(h[u++]=eg(new H(i+y,x,i+y,D),m,l),w(m.index)+m[0].length>=p||u>=c)return u}while(m);return u}findMatchesLineByLine(e,t,i,s){const r=[];let o=0;const a=new f0(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let u=this.positionInBuffer(l.node,l.remainder);const h=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,h,t,i,s,o,r),r;let d=e.startLineNumber,f=l.node;for(;f!==c.node;){const p=this.getLineFeedCnt(f.piece.bufferIndex,u,f.piece.end);if(p>=1){const b=this._buffers[f.piece.bufferIndex].lineStarts,v=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),w=b[u.line+p],y=d===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(f,a,d,y,u,this.positionInBuffer(f,w-v),t,i,s,o,r),o>=s)return r;d+=p}const m=d===e.startLineNumber?e.startColumn-1:0;if(d===e.endLineNumber){const b=this.getLineContent(d).substring(m,e.endColumn-1);return o=this._findMatchesInLine(t,a,b,e.endLineNumber,m,o,r,i,s),r}if(o=this._findMatchesInLine(t,a,this.getLineContent(d).substr(m),d,m,o,r,i,s),o>=s)return r;d++,l=this.nodeAt2(d,1),f=l.node,u=this.positionInBuffer(l.node,l.remainder)}if(d===e.endLineNumber){const p=d===e.startLineNumber?e.startColumn-1:0,m=this.getLineContent(d).substring(p,e.endColumn-1);return o=this._findMatchesInLine(t,a,m,e.endLineNumber,p,o,r,i,s),r}const g=d===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,d,g,u,h,t,i,s,o,r),r}_findMatchesInLine(e,t,i,s,r,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const d=e.simpleSearch,f=d.length,g=i.length;let p=-f;for(;(p=i.indexOf(d,p+f))!==-1;)if((!u||E8(u,i,g,p,f))&&(a[o++]=new my(new H(s,p+1+r,s,p+1+f+r),null),o>=c))return o;return o}let h;t.reset(0);do if(h=t.next(i),h&&(a[o++]=eg(new H(s,h.index+1+r,s,h.index+1+h[0].length+r),h,l),o>=c))return o;while(h);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Je){const{node:s,remainder:r,nodeStartOffset:o}=this.nodeAt(e),a=s.piece,l=a.bufferIndex,c=this.positionInBuffer(s,r);if(s.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<iu){this.appendToNode(s,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,s),this._searchCache.validate(e);else if(o+s.piece.length>e){const u=[];let h=new xr(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(s,r)===10){const p={line:h.start.line+1,column:0};h=new xr(h.bufferIndex,p,h.end,this.getLineFeedCnt(h.bufferIndex,p,h.end),h.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(s,r-1)===13){const p=this.positionInBuffer(s,r-1);this.deleteNodeTail(s,p),t="\r"+t,s.piece.length===0&&u.push(s)}else this.deleteNodeTail(s,c);else this.deleteNodeTail(s,c);const d=this.createNewPieces(t);h.length>0&&this.rbInsertRight(s,h);let f=s;for(let g=0;g<d.length;g++)f=this.rbInsertRight(f,d[g]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,s)}else{const s=this.createNewPieces(t);let r=this.rbInsertLeft(null,s[0]);for(let o=1;o<s.length;o++)r=this.rbInsertRight(r,s[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Je)return;const i=this.nodeAt(e),s=this.nodeAt(e+t),r=i.node,o=s.node;if(r===o){const d=this.positionInBuffer(r,i.remainder),f=this.positionInBuffer(r,s.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const g=r.next();Ox(this,r),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(r,f),this._searchCache.validate(e),this.validateCRLFWithPrevNode(r),this.computeBufferMetadata();return}if(i.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,d),this.validateCRLFWithNextNode(r),this.computeBufferMetadata();return}this.shrinkNode(r,d,f),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(r,i.remainder);this.deleteNodeTail(r,l),this._searchCache.validate(e),r.piece.length===0&&a.push(r);const c=this.positionInBuffer(o,s.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const u=r.next();for(let d=u;d!==Je&&d!==o;d=d.next())a.push(d);const h=r.piece.length===0?r.prev():r;this.deleteNodes(a),this.validateCRLFWithNextNode(h),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new xr(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,uu(this,t,-1,-1),t.piece.length===0&&i.push(t)}const s=this.createNewPieces(e);let r=this.rbInsertLeft(t,s[s.length-1]);for(let o=s.length-2;o>=0;o--)r=this.rbInsertLeft(r,s[o]);this.validateCRLFWithPrevNode(r),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),s=this.rbInsertRight(t,i[0]);let r=s;for(let o=1;o<i.length;o++)r=this.rbInsertRight(r,i[o]);this.validateCRLFWithPrevNode(s)}positionInBuffer(e,t,i){const s=e.piece,r=e.piece.bufferIndex,o=this._buffers[r].lineStarts,l=o[s.start.line]+s.start.column+t;let c=s.start.line,u=s.end.line,h=0,d=0,f=0;for(;c<=u&&(h=c+(u-c)/2|0,f=o[h],h!==u);)if(d=o[h+1],l<f)u=h-1;else if(l>=d)c=h+1;else break;return i?(i.line=h,i.column=l-f,null):{line:h,column:l-f}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const s=this._buffers[e].lineStarts;if(i.line===s.length-1)return i.line-t.line;const r=s[i.line+1],o=s[i.line]+i.column;if(r>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Ox(this,e[t])}createNewPieces(e){if(e.length>iu){const u=[];for(;e.length>iu;){const d=e.charCodeAt(iu-1);let f;d===13||d>=55296&&d<=56319?(f=e.substring(0,iu-1),e=e.substring(iu-1)):(f=e.substring(0,iu),e=e.substring(iu));const g=hu(f);u.push(new xr(this._buffers.length,{line:0,column:0},{line:g.length-1,column:f.length-g[g.length-1]},g.length-1,f.length)),this._buffers.push(new ag(f,g))}const h=hu(e);return u.push(new xr(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length)),this._buffers.push(new ag(e,h)),u}let t=this._buffers[0].buffer.length;const i=hu(e,!1);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},s=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=r-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new xr(0,s,l,this.getLineFeedCnt(0,s,l),r-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,s="";const r=this._searchCache.get2(e);if(r){i=r.node;const o=this.getAccumulatedValue(i,e-r.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)s=a.substring(l+o,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==Je;)if(i.left!==Je&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(h+l,h+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);s=c.substring(u+l,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Je;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=o.substring(l,l+a-t),s}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);s+=o.substr(a,i.piece.length)}i=i.next()}return s}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==Je;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,s=this.positionInBuffer(e,t),r=s.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,s);if(o!==r)return{index:o,remainder:0}}return{index:r,remainder:s.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,s=this._buffers[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?s[i.end.line]+i.end.column-s[i.start.line]-i.start.column:s[r]-s[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-s,u=a-r,h=i.length+u;e.piece=new xr(i.bufferIndex,i.start,o,l,h),uu(this,e,u,c)}deleteNodeHead(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-s,u=r-l,h=i.length+u;e.piece=new xr(i.bufferIndex,o,i.end,a,h),uu(this,e,u,c)}shrinkNode(e,t,i){const s=e.piece,r=s.start,o=s.end,a=s.length,l=s.lineFeedCnt,c=t,u=this.getLineFeedCnt(s.bufferIndex,s.start,c),h=this.offsetInBuffer(s.bufferIndex,t)-this.offsetInBuffer(s.bufferIndex,r);e.piece=new xr(s.bufferIndex,s.start,c,u,h),uu(this,e,h-a,u-l);const d=new xr(s.bufferIndex,i,o,this.getLineFeedCnt(s.bufferIndex,i,o),this.offsetInBuffer(s.bufferIndex,o)-this.offsetInBuffer(s.bufferIndex,i)),f=this.rbInsertRight(e,d);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),s=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=hu(t,!1);for(let f=0;f<r.length;f++)r[f]+=s;if(i){const f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,u=e.piece.lineFeedCnt,h=this.getLineFeedCnt(0,e.piece.start,l),d=h-u;e.piece=new xr(e.piece.bufferIndex,e.piece.start,l,h,c),this._lastChangeBufferPos=l,uu(this,e,t.length,d)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let s=0;for(;t!==Je;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){s+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:s};return this._searchCache.set(r),r}else e-=t.size_left+t.piece.length,s+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,s=0;for(;i!==Je;)if(i.left!==Je&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return s+=i.size_left,{node:i,remainder:Math.min(r+t-1,o),nodeStartOffset:s}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:s};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Je;){if(i.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:o}}else if(i.piece.length>=t-1){const r=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],s=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(s)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Je||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,s=t.start.line,r=i[s]+t.start.column;return s===i.length-1||i[s+1]>r+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Je||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],s=this._buffers[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new xr(e.piece.bufferIndex,e.piece.start,r,a,o),uu(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new xr(t.piece.bufferIndex,l,t.piece.end,u,c),uu(this,t,-1,-1),t.piece.length===0&&i.push(t);const h=this.createNewPieces(`\r
`);this.rbInsertRight(e,h[0]);for(let d=0;d<i.length;d++)Ox(this,i[d])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Ox(this,i);else{const s=i.piece,r={line:s.start.line+1,column:0},o=s.length-1,a=this.getLineFeedCnt(s.bufferIndex,r,s.end);i.piece=new xr(s.bufferIndex,r,s.end,a,o),uu(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Je)return t(Je);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Je)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,s=this.offsetInBuffer(i.bufferIndex,i.start),r=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(s,r)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),s=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,s)}rbInsertRight(e,t){const i=new kF(t,1);if(i.left=Je,i.right=Je,i.parent=Je,i.size_left=0,i.lf_left=0,this.root===Je)this.root=i,i.color=0;else if(e.right===Je)e.right=i,i.parent=e;else{const r=r7(e.right);r.left=i,i.parent=r}return nj(this,i),i}rbInsertLeft(e,t){const i=new kF(t,1);if(i.left=Je,i.right=Je,i.parent=Je,i.size_left=0,i.lf_left=0,this.root===Je)this.root=i,i.color=0;else if(e.left===Je)e.left=i,i.parent=e;else{const s=Use(e.left);s.right=i,i.parent=s}return nj(this,i),i}}class r_ extends ae{constructor(e,t,i,s,r,o,a){super(),this._onDidChangeContent=this._register(new G),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=s,this._mightContainUnusualLineTerminators=r,this._pieceTree=new K5e(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,s=this.getPositionAt(e),r=this.getPositionAt(i);return new H(s.lineNumber,s.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),s=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;r=l*c}return s-i+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const s=e.startLineNumber,r=e.endLineNumber;for(let o=s;o<=r;o++){const a=this.getLineContent(o),l=o===s?e.startColumn-1:0,c=o===r?e.endColumn-1:a.length;for(let u=l;u<c;u++)Dn(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(r-s),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Pr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=tm(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let s=this._mightContainRTL,r=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let p=0;p<e.length;p++){const m=e[p];a&&m._isTracked&&(a=!1);const b=m.range;if(m.text){let D=!0;o||(D=!f8(m.text),o=D),!s&&D&&(s=uy(m.text)),!r&&D&&(r=Fie(m.text))}let v="",w=0,y=0,x=0;if(m.text){let D;[w,y,x,D]=Ep(m.text);const S=this.getEOL();D===0||D===(S===`\r
`?2:1)?v=m.text:v=m.text.replace(/\r\n|\r|\n/g,S)}l[p]={sortIndex:p,identifier:m.identifier||null,range:b,rangeOffset:this.getOffsetAt(b.startLineNumber,b.startColumn),rangeLength:this.getValueLengthInRange(b),text:v,eolCount:w,firstLineLength:y,lastLineLength:x,forceMoveMarkers:!!m.forceMoveMarkers,isAutoWhitespaceEdit:m.isAutoWhitespaceEdit||!1}}l.sort(r_._sortOpsAscending);let c=!1;for(let p=0,m=l.length-1;p<m;p++){const b=l[p].range.getEndPosition(),v=l[p+1].range.getStartPosition();if(v.isBeforeOrEqual(b)){if(v.isBefore(b))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const u=i||t?r_._getInverseEditRanges(l):[],h=[];if(t)for(let p=0;p<l.length;p++){const m=l[p],b=u[p];if(m.isAutoWhitespaceEdit&&m.range.isEmpty())for(let v=b.startLineNumber;v<=b.endLineNumber;v++){let w="";v===b.startLineNumber&&(w=this.getLineContent(m.range.startLineNumber),Pr(w)!==-1)||h.push({lineNumber:v,oldContent:w})}}let d=null;if(i){let p=0;d=[];for(let m=0;m<l.length;m++){const b=l[m],v=u[m],w=this.getValueInRange(b.range),y=b.rangeOffset+p;p+=b.text.length-w.length,d[m]={sortIndex:b.sortIndex,identifier:b.identifier,range:v,text:w,textChange:new Kn(b.rangeOffset,w,y,b.text)}}c||d.sort((m,b)=>m.sortIndex-b.sortIndex)}this._mightContainRTL=s,this._mightContainUnusualLineTerminators=r,this._mightContainNonBasicASCII=o;const f=this._doApplyEdits(l);let g=null;if(t&&h.length>0){h.sort((p,m)=>m.lineNumber-p.lineNumber),g=[];for(let p=0,m=h.length;p<m;p++){const b=h[p].lineNumber;if(p>0&&h[p-1].lineNumber===b)continue;const v=h[p].oldContent,w=this.getLineContent(b);w.length===0||w===v||Pr(w)!==-1||g.push(b)}}return this._onDidChangeContent.fire(),new nMe(d,f,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,s=e[e.length-1].range,r=new H(i.startLineNumber,i.startColumn,s.endLineNumber,s.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let f=0,g=e.length;f<g;f++){const p=e[f],m=p.range;t=t||p.forceMoveMarkers,l.push(this.getValueInRange(new H(o,a,m.startLineNumber,m.startColumn))),p.text.length>0&&l.push(p.text),o=m.endLineNumber,a=m.endColumn}const c=l.join(""),[u,h,d]=Ep(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:c,eolCount:u,firstLineLength:h,lastLineLength:d,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(r_._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const s=e[i],r=s.range.startLineNumber,o=s.range.startColumn,a=s.range.endLineNumber,l=s.range.endColumn;if(r===a&&o===l&&s.text.length===0)continue;s.text?(this._pieceTree.delete(s.rangeOffset,s.rangeLength),this._pieceTree.insert(s.rangeOffset,s.text,!0)):this._pieceTree.delete(s.rangeOffset,s.rangeLength);const c=new H(r,o,a,l);t.push({range:c,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,s){return this._pieceTree.findMatchesLineByLine(e,t,i,s)}static _getInverseEditRanges(e){const t=[];let i=0,s=0,r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,u;r?r.range.endLineNumber===l.range.startLineNumber?(c=i,u=s+(l.range.startColumn-r.range.endColumn)):(c=i+(l.range.startLineNumber-r.range.endLineNumber),u=l.range.startColumn):(c=l.range.startLineNumber,u=l.range.startColumn);let h;if(l.text.length>0){const d=l.eolCount+1;d===1?h=new H(c,u,c,u+l.firstLineLength):h=new H(c,u,c+d-1,l.lastLineLength+1)}else h=new H(c,u,c,u);i=h.endLineNumber,s=h.endColumn,t.push(h),r=l}return t}static _sortOpsAscending(e,t){const i=H.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=H.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class Z5e{constructor(e,t,i,s,r,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=s,this._crlf=r,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let r=0,o=i.length;r<o;r++){const a=i[r].buffer.replace(/\r\n|\r|\n/g,t),l=hu(a);i[r]=new ag(a,l)}const s=new r_(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:s,disposable:s}}}class qse{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&p8(e)&&(this.BOM=eIe,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=j5e(this._tmpLineStarts,e);this.chunks.push(new ag(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=uy(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Fie(e)))}finish(e=!0){return this._finish(),new Z5e(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=hu(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class Y5e{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const s=this._store.slice(0,e),r=this._store.slice(e+t),o=X5e(i,this._default);this._store=s.concat(o,r)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let s=0;s<t;s++)i[s]=this._default;this._store=lT(this._store,e,i)}}function X5e(n,e){const t=[];for(let i=0;i<n;i++)t[i]=e;return t}class Q5e{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class LF{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new Q5e(e,[t]))}finalize(){return this._tokens}}class J5e{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new DF(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class e6e extends J5e{constructor(e,t,i,s){super(e,t),this._textModel=i,this._languageIdCodec=s}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const s=this.getFirstInvalidLine();if(!s||s.lineNumber>t)break;const r=this._textModel.getLineContent(s.lineNumber),o=N1(this._languageIdCodec,i,this.tokenizationSupport,r,!0,s.startState);e.add(s.lineNumber,o.tokens),this.store.setEndState(s.lineNumber,o.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const s=this._textModel.getLanguageId(),r=this._textModel.getLineContent(e.lineNumber),o=r.substring(0,e.column-1)+t+r.substring(e.column-1),a=N1(this._languageIdCodec,s,this.tokenizationSupport,o,!0,i),l=new An(a.tokens,o,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLineWithEdit(e,t,i){const s=e.lineNumber,r=e.column,o=this.getStartState(s);if(!o)return null;const a=this._textModel.getLineContent(s),l=a.substring(0,r-1)+i+a.substring(r-1+t),c=this._textModel.getLanguageIdAtPosition(s,0),u=N1(this._languageIdCodec,c,this.tokenizationSupport,l,!0,o);return new An(u.tokens,l,this._languageIdCodec)}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let s=this.guessStartState(t);const r=this._textModel.getLanguageId();for(let o=t;o<=i;o++){const a=this._textModel.getLineContent(o),l=N1(this._languageIdCodec,r,this.tokenizationSupport,a,!0,s);e.add(o,l.tokens),s=l.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e);const i=[];let s=null;for(let a=e-1;t>1&&a>=1;a--){const l=this._textModel.getLineFirstNonWhitespaceColumn(a);if(l!==0&&l<t&&(i.push(this._textModel.getLineContent(a)),t=l,s=this.getStartState(a),s))break}s||(s=this.tokenizationSupport.getInitialState()),i.reverse();const r=this._textModel.getLanguageId();let o=s;for(const a of i)o=N1(this._languageIdCodec,r,this.tokenizationSupport,a,!1,o).endState;return o}}class DF{constructor(e){this.lineCount=e,this._tokenizationStateStore=new t6e,this._invalidEndStatesLineNumbers=new i6e,this._invalidEndStatesLineNumbers.addRange(new ct(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new mn("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new ct(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new ct(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=Ep(t.text);this.acceptChange(new gt(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new ct(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new mn("Start state must be defined");return{lineNumber:t,startState:i}}}class t6e{constructor(){this._lineEndStates=new Y5e(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class i6e{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new ct(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new ct(i.start,e):this._ranges.splice(t,1,new ct(i.start,e),new ct(e+1,i.endExclusive))}}addRange(e){ct.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let s=i;for(;!(s>=this._ranges.length||e.endExclusive<this._ranges[s].start);)s++;const r=t-e.length;for(let o=s;o<this._ranges.length;o++)this._ranges[o]=this._ranges[o].delta(r);if(i===s){const o=new ct(e.start,e.start+t);o.isEmpty||this._ranges.splice(i,0,o)}else{const o=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[s-1].endExclusive),l=new ct(o,a+r);l.isEmpty?this._ranges.splice(i,s-i):this._ranges.splice(i,s-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function N1(n,e,t,i,s,r){let o=null;if(t)try{o=t.tokenizeEncoded(i,s,r.clone())}catch(a){Ft(a)}return o||(o=N8(n.encodeLanguageId(e),r)),An.convertToEndOffset(o.tokens,i.length),o}class n6e{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,od(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?uie(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new LF,i=wf.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var t;const i=(t=this._tokenizerWithStateStore)===null||t===void 0?void 0:t.getFirstInvalidLine();return i?(this._tokenizerWithStateStore.updateTokensUntilLine(e,i.lineNumber),i.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new gt(e,t))}}const du=new Uint32Array(0).buffer;class Zl{static deleteBeginning(e,t){return e===null||e===du?e:Zl.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===du)return e;const i=Ru(e),s=i[i.length-2];return Zl.delete(e,t,s)}static delete(e,t,i){if(e===null||e===du||t===i)return e;const s=Ru(e),r=s.length>>>1;if(t===0&&s[s.length-2]===i)return du;const o=An.findIndexInTokensArray(s,t),a=o>0?s[o-1<<1]:0,l=s[o<<1];if(i<l){const f=i-t;for(let g=o;g<r;g++)s[g<<1]-=f;return e}let c,u;a!==t?(s[o<<1]=t,c=o+1<<1,u=t):(c=o<<1,u=a);const h=i-t;for(let f=o+1;f<r;f++){const g=s[f<<1]-h;g>u&&(s[c++]=g,s[c++]=s[(f<<1)+1],u=g)}if(c===s.length)return e;const d=new Uint32Array(c);return d.set(s.subarray(0,c),0),d.buffer}static append(e,t){if(t===du)return e;if(e===du)return t;if(e===null)return e;if(t===null)return null;const i=Ru(e),s=Ru(t),r=s.length>>>1,o=new Uint32Array(i.length+s.length);o.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<r;c++)o[a++]=s[c<<1]+l,o[a++]=s[(c<<1)+1];return o.buffer}static insert(e,t,i){if(e===null||e===du)return e;const s=Ru(e),r=s.length>>>1;let o=An.findIndexInTokensArray(s,t);o>0&&s[o-1<<1]===t&&o--;for(let a=o;a<r;a++)s[a<<1]+=i;return e}}function Ru(n){return n instanceof Uint32Array?n:new Uint32Array(n)}class Vy{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let s=null;if(t<this._len&&(s=this._lineTokens[t]),s!==null&&s!==du)return new An(Ru(s),i,this._languageIdCodec);const r=new Uint32Array(2);return r[0]=i.length,r[1]=sj(this._languageIdCodec.encodeLanguageId(e)),new An(r,i,this._languageIdCodec)}static _massageTokens(e,t,i){const s=i?Ru(i):null;if(t===0){let r=!1;if(s&&s.length>1&&(r=Ir.getLanguageId(s[1])!==e),!r)return du}if(!s||s.length===0){const r=new Uint32Array(2);return r[0]=t,r[1]=sj(e),r.buffer}return s[s.length-2]=t,s.byteOffset===0&&s.byteLength===s.buffer.byteLength?s.buffer:s}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let s=0;s<t;s++)i[s]=null;this._lineTokens=lT(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,s,r){const o=Vy._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,s);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=o,r?!Vy._equals(a,o):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Ru(e),s=Ru(t);if(i.length!==s.length)return!1;for(let r=0,o=i.length;r<o;r++)if(i[r]!==s[r])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new X(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=Zl.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=Zl.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let s=null;i<this._len&&(s=Zl.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=Zl.append(this._lineTokens[t],s),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const s=e.lineNumber-1;if(!(s>=this._len)){if(t===0){this._lineTokens[s]=Zl.insert(this._lineTokens[s],e.column-1,i);return}this._lineTokens[s]=Zl.deleteEnding(this._lineTokens[s],e.column-1),this._lineTokens[s]=Zl.insert(this._lineTokens[s],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];let a=0,l=0,c=!1;for(let u=o.startLineNumber;u<=o.endLineNumber;u++)c?(this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),o.getLineTokens(u),!1),l=u):this.setTokens(t.getLanguageId(),u-1,t.getLineLength(u),o.getLineTokens(u),!0)&&(c=!0,a=u,l=u);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function sj(n){return(n<<0|0|0|32768|2<<24|1024)>>>0}class l7{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const r=t[0].getRange(),o=t[t.length-1].getRange();if(!r||!o)return e;i=e.plusRange(r).plusRange(o)}let s=null;for(let r=0,o=this._pieces.length;r<o;r++){const a=this._pieces[r];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){s=s||{index:r};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(r,1),r--,o--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){s=s||{index:r};continue}const[l,c]=a.split(i);if(l.isEmpty()){s=s||{index:r};continue}c.isEmpty()||(this._pieces.splice(r,1,l,c),r++,o++,s=s||{index:r})}return s=s||{index:this._pieces.length},t.length>0&&(this._pieces=lT(this._pieces,s.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;const i=this._pieces;if(i.length===0)return t;const s=l7._findFirstPieceWithLine(i,e),r=i[s].getLineTokens(e);if(!r)return t;const o=t.getCount(),a=r.getCount();let l=0;const c=[];let u=0,h=0;const d=(f,g)=>{f!==h&&(h=f,c[u++]=f,c[u++]=g)};for(let f=0;f<a;f++){const g=r.getStartCharacter(f),p=r.getEndCharacter(f),m=r.getMetadata(f),b=((m&1?2048:0)|(m&2?4096:0)|(m&4?8192:0)|(m&8?16384:0)|(m&16?16744448:0)|(m&32?4278190080:0))>>>0,v=~b>>>0;for(;l<o&&t.getEndOffset(l)<=g;)d(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<o&&t.getStartOffset(l)<g&&d(g,t.getMetadata(l));l<o&&t.getEndOffset(l)<p;)d(t.getEndOffset(l),t.getMetadata(l)&v|m&b),l++;if(l<o)d(p,t.getMetadata(l)&v|m&b),t.getEndOffset(l)===p&&l++;else{const w=Math.min(Math.max(0,l-1),o-1);d(p,t.getMetadata(w)&v|m&b)}}for(;l<o;)d(t.getEndOffset(l),t.getMetadata(l)),l++;return new An(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,s=e.length-1;for(;i<s;){let r=i+Math.floor((s-i)/2);if(e[r].endLineNumber<t)i=r+1;else if(e[r].startLineNumber>t)s=r-1;else{for(;r>i&&e[r-1].startLineNumber<=t&&t<=e[r-1].endLineNumber;)r--;return r}}return i}acceptEdit(e,t,i,s,r){for(const o of this._pieces)o.acceptEdit(e,t,i,s,r)}}class lD extends Ese{constructor(e,t,i,s,r,o){super(),this._languageService=e,this._languageConfigurationService=t,this._textModel=i,this._bracketPairsTextModelPart=s,this._languageId=r,this._attachedViews=o,this._semanticTokens=new l7(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new G),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new G),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new G),this.onDidChangeTokens=this._onDidChangeTokens.event,this.grammarTokens=this._register(new s6e(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),this._register(this._languageConfigurationService.onDidChange(a=>{a.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(this.grammarTokens.onDidChangeTokens(a=>{this._emitModelTokensChangedEvent(a)})),this._register(this.grammarTokens.onDidChangeBackgroundTokenizationState(a=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()}))}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,s,r]=Ep(t.text);this._semanticTokens.acceptEdit(t.range,i,s,r,t.text.length>0?t.text.charCodeAt(0):0)}this.grammarTokens.handleDidChangeContent(e)}handleDidChangeAttached(){this.grammarTokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this.grammarTokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new mn("Illegal value for lineNumber")}get hasTokens(){return this.grammarTokens.hasTokens}resetTokenization(){this.grammarTokens.resetTokenization()}get backgroundTokenizationState(){return this.grammarTokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this.grammarTokens.forceTokenization(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this.grammarTokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this.grammarTokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this.grammarTokens.getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLineWithEdit(e,t,i){return this.grammarTokens.tokenizeLineWithEdit(e,t,i)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),s=this.getLineTokens(t.lineNumber),r=s.findTokenIndexAtOffset(t.column-1),[o,a]=lD._findLanguageBoundaries(s,r),l=ry(t.column,this.getLanguageConfiguration(s.getLanguageId(r)).getWordDefinition(),i.substring(o,a),o);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(r>0&&o===t.column-1){const[c,u]=lD._findLanguageBoundaries(s,r-1),h=ry(t.column,this.getLanguageConfiguration(s.getLanguageId(r-1)).getWordDefinition(),i.substring(c,u),c);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn)return h}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let s=0;for(let o=t;o>=0&&e.getLanguageId(o)===i;o--)s=e.getStartOffset(o);let r=e.getLineContent().length;for(let o=t,a=e.getCount();o<a&&e.getLanguageId(o)===i;o++)r=e.getEndOffset(o);return[s,r]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new X(e,t)),s=this.getLineTokens(i.lineNumber);return s.getLanguageId(s.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this.grammarTokens.resetTokenization(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}}class s6e extends ae{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t,i,s){super(),this._languageIdCodec=e,this._textModel=t,this.getLanguageId=i,this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new wl),this._tokens=new Vy(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new wl),this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new G),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new G),this.onDidChangeTokens=this._onDidChangeTokens.event,this._attachedViewStates=this._register(new i8),this._register($i.onDidChange(r=>{const o=this.getLanguageId();r.changedLanguages.indexOf(o)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(s.onDidChangeVisibleRanges(({view:r,state:o})=>{if(o){let a=this._attachedViewStates.get(r);a||(a=new r6e(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(r,a)),a.handleStateChange(o)}else this._attachedViewStates.deleteAndDispose(r)}))}resetTokenization(e=!0){var t;this._tokens.flush(),(t=this._debugBackgroundTokens)===null||t===void 0||t.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new DF(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const i=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const o=$i.get(this.getLanguageId());if(!o)return[null,null];let a;try{a=o.getInitialState()}catch(l){return Ft(l),[null,null]}return[o,a]},[s,r]=i();if(s&&r?this._tokenizer=new e6e(this._textModel.getLineCount(),s,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const o={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var c;if(!this._tokenizer)return;const u=this._tokenizer.store.getFirstInvalidEndStateLineNumber();u!==null&&a>=u&&((c=this._tokenizer)===null||c===void 0||c.store.setEndState(a,l))}};s&&s.createBackgroundTokenizer&&!s.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=s.createBackgroundTokenizer(this._textModel,o)),this._backgroundTokenizer.value||(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new n6e(this._tokenizer,o),this._defaultBackgroundTokenizer.handleChanges()),s!=null&&s.backgroundTokenizerShouldOnlyVerifyTokens&&s.createBackgroundTokenizer?(this._debugBackgroundTokens=new Vy(this._languageIdCodec),this._debugBackgroundStates=new DF(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=s.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)===null||l===void 0||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)===null||c===void 0||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)===null||e===void 0||e.handleChanges()}handleDidChangeContent(e){var t,i,s;if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(const r of e.changes){const[o,a]=Ep(r.text);this._tokens.acceptEdit(r.range,o,a),(t=this._debugBackgroundTokens)===null||t===void 0||t.acceptEdit(r.range,o,a)}(i=this._debugBackgroundStates)===null||i===void 0||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=gt.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var i,s;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const r=new LF,{heuristicTokens:o}=this._tokenizer.tokenizeHeuristically(r,e,t),a=this.setTokens(r.finalize());if(o)for(const l of a.changes)(i=this._backgroundTokenizer.value)===null||i===void 0||i.requestTokens(l.fromLineNumber,l.toLineNumber+1);(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.checkFinished()}forceTokenization(e){var t,i;const s=new LF;(t=this._tokenizer)===null||t===void 0||t.updateTokensUntilLine(s,e),this.setTokens(s.finalize()),(i=this._defaultBackgroundTokenizer)===null||i===void 0||i.checkFinished()}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){var t;const i=this._textModel.getLineContent(e),s=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,i);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const r=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,i);!s.equals(r)&&(!((t=this._debugBackgroundTokenizer.value)===null||t===void 0)&&t.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return s}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const s=this._textModel.validatePosition(new X(e,t));return this.forceTokenization(s.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(s,i)}tokenizeLineWithEdit(e,t,i){if(!this._tokenizer)return null;const s=this._textModel.validatePosition(e);return this.forceTokenization(s.lineNumber),this._tokenizer.tokenizeLineWithEdit(s,t,i)}get hasTokens(){return this._tokens.hasTokens}}class r6e extends ae{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new Ui(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){yn(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class o6e{constructor(){this.changeType=1}}class Sl{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",s=0;for(const r of t)i+=e.substring(s,r.column-1),s=r.column-1,i+=r.options.content;return i+=e.substring(s),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new Sl(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new Sl(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,s)=>i.lineNumber===s.lineNumber?i.column===s.column?i.order-s.order:i.column-s.column:i.lineNumber-s.lineNumber),t}constructor(e,t,i,s,r){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=s,this.order=r}}class rj{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class a6e{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class l6e{constructor(e,t,i,s){this.changeType=4,this.injectedTexts=s,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class c6e{constructor(){this.changeType=5}}class o_{constructor(e,t,i,s){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=s,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),s=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new o_(i,s,r,o)}}class Gse{constructor(e){this.changes=e}}class Zg{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=o_.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=Zg._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new Zg(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),s=t.eol,r=t.versionId,o=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:s,isEolChange:c,versionId:r,isUndoing:o,isRedoing:a,isFlush:l}}}const qT=kt("undoRedoService");class Kse{constructor(e,t){this.resource=e,this.elements=t}}class ub{constructor(){this.id=ub._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}ub._ID=0;ub.None=new ub;class lc{constructor(){this.id=lc._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}lc._ID=0;lc.None=new lc;var u6e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},dR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Xf;function h6e(n){const e=new qse;return e.acceptChunk(n),e.finish()}function d6e(n){const e=new qse;let t;for(;typeof(t=n.read())=="string";)e.acceptChunk(t);return e.finish()}function oj(n,e){let t;return typeof n=="string"?t=h6e(n):tMe(n)?t=d6e(n):t=n,t.create(e)}let Bx=0;const f6e=999,g6e=1e4;class p6e{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const s=this._source.read();if(s===null)return this._eos=!0,t===0?null:e.join("");if(s.length>0&&(e[t++]=s,i+=s.length),i>=64*1024)return e.join("")}while(!0)}}const R1=()=>{throw new Error("Invalid change accessor")};let Mc=Xf=class extends ae{static resolveOptions(e,t){if(t.detectIndentation){const i=YU(e,t.tabSize,t.insertSpaces);return new Q2({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new Q2(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return ka(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,s=null,r,o,a){super(),this._undoRedoService=r,this._languageService=o,this._languageConfigurationService=a,this._onWillDispose=this._register(new G),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new w6e(f=>this.handleBeforeFireDecorationsChangedEvent(f))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new G),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new G),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new G),this._eventEmitter=this._register(new y6e),this._languageSelectionListener=this._register(new wl),this._deltaDecorationCallCnt=0,this._attachedViews=new C6e,Bx++,this.id="$model"+Bx,this.isForSimpleWidget=i.isForSimpleWidget,typeof s>"u"||s===null?this._associatedResource=ot.parse("inmemory://model/"+Bx):this._associatedResource=s,this._attachedEditorCount=0;const{textBuffer:l,disposable:c}=oj(e,i.defaultEOL);this._buffer=l,this._bufferDisposable=c,this._options=Xf.resolveOptions(this._buffer,i);const u=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new v5e(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new uOe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new y5e(this)),this._tokenizationTextModelPart=new lD(this._languageService,this._languageConfigurationService,this,this._bracketPairs,u,this._attachedViews);const h=this._buffer.getLineCount(),d=this._buffer.getValueLengthInRange(new H(1,1,h,this._buffer.getLineLength(h)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=d>Xf.LARGE_FILE_SIZE_THRESHOLD||h>Xf.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=d>Xf.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=d>Xf._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Pie(Bx),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new aj,this._commandManager=new s7(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(u)}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new r_([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=ae.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new Zg(e,t)))}setValue(e){if(this._assertNotDisposed(),e==null)throw ju();const{textBuffer:t,disposable:i}=oj(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,s,r,o,a,l){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:s}],eol:this._buffer.getEOL(),isEolChange:l,versionId:this.getVersionId(),isUndoing:r,isRedoing:o,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),s=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new aj,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new o_([new o6e],this._versionId,!1,!1),this._createContentChanged2(new H(1,1,r,o),0,s,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),s=this.getValueLengthInRange(i),r=this.getLineCount(),o=this.getLineMaxColumn(r);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new o_([new c6e],this._versionId,!1,!1),this._createContentChanged2(new H(1,1,r,o),0,s,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,s=t.length;i<s;i++){const r=t[i],o=r.range,a=r.cachedAbsoluteStart-r.start,l=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);r.cachedAbsoluteStart=l,r.cachedAbsoluteEnd=c,r.cachedVersionId=e,r.start=l-a,r.end=c-a,of(r)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let s=1;s<=i;s++){const r=this._buffer.getLineLength(s);r>=g6e?t+=r:e+=r}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,s=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,r=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new Q2({tabSize:t,indentSize:i,insertSpaces:s,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:r,bracketPairColorizationOptions:o});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=YU(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),yse(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(Mie.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new mn("Operation would exceed heap memory limits");const i=this.getFullModelRange(),s=this.getValueInRange(i,e);return t?this._buffer.getBOM()+s:s}createSnapshot(e=!1){return new p6e(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),s=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+s:s}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mn("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mn("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new mn("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mn("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mn("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new mn("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,s=e.startColumn;let r=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),o=Math.floor(typeof s=="number"&&!isNaN(s)?s:1);if(r<1)r=1,o=1;else if(r>t)r=t,o=this.getLineMaxColumn(r);else if(o<=1)o=1;else{const h=this.getLineMaxColumn(r);o>=h&&(o=h)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),u=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,u=1;else if(c>t)c=t,u=this.getLineMaxColumn(c);else if(u<=1)u=1;else{const h=this.getLineMaxColumn(c);u>=h&&(u=h)}return i===r&&s===o&&a===c&&l===u&&e instanceof H&&!(e instanceof Lt)?e:new H(r,o,c,u)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const s=this._buffer.getLineCount();if(e>s)return!1;if(t===1)return!0;const r=this.getLineMaxColumn(e);if(t>r)return!1;if(i===1){const o=this._buffer.getLineCharCode(e,t-2);if(Dn(o))return!1}return!0}_validatePosition(e,t,i){const s=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),r=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),o=this._buffer.getLineCount();if(s<1)return new X(1,1);if(s>o)return new X(o,this.getLineMaxColumn(o));if(r<=1)return new X(s,1);const a=this.getLineMaxColumn(s);if(r>=a)return new X(s,a);if(i===1){const l=this._buffer.getLineCharCode(s,r-2);if(Dn(l))return new X(s,r-1)}return new X(s,r)}validatePosition(e){return this._assertNotDisposed(),e instanceof X&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,s=e.startColumn,r=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(i,s,0)||!this._isValidPosition(r,o,0))return!1;if(t===1){const a=s>1?this._buffer.getLineCharCode(i,s-2):0,l=o>1&&o<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,o-2):0,c=Dn(a),u=Dn(l);return!c&&!u}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof H&&!(e instanceof Lt)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),s=this._validatePosition(e.endLineNumber,e.endColumn,0),r=i.lineNumber,o=i.column,a=s.lineNumber,l=s.column;{const c=o>1?this._buffer.getLineCharCode(r,o-2):0,u=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,h=Dn(c),d=Dn(u);return!h&&!d?new H(r,o,a,l):r===a&&o===l?new H(r,o-1,a,l-1):h&&d?new H(r,o-1,a,l+1):h?new H(r,o-1,a,l):new H(r,o,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new H(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,s){return this._buffer.findMatchesLineByLine(e,t,i,s)}findMatches(e,t,i,s,r,o,a=f6e){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(h=>H.isIRange(h))&&(l=t.map(h=>this.validateRange(h)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((h,d)=>h.startLineNumber-d.startLineNumber||h.startColumn-d.startColumn);const c=[];c.push(l.reduce((h,d)=>H.areIntersecting(h,d)?h.plusRange(d):(c.push(h),d)));let u;if(!i&&e.indexOf(`
`)<0){const d=new Yf(e,i,s,r).parseSearchRequest();if(!d)return[];u=f=>this.findMatchesLineByLine(f,d,o,a)}else u=h=>xx.findMatches(this,new Yf(e,i,s,r),h,o,a);return c.map(u).reduce((h,d)=>h.concat(d),[])}findNextMatch(e,t,i,s,r,o){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Yf(e,i,s,r).parseSearchRequest();if(!c)return null;const u=this.getLineCount();let h=new H(a.lineNumber,a.column,u,this.getLineMaxColumn(u)),d=this.findMatchesLineByLine(h,c,o,1);return xx.findNextMatch(this,new Yf(e,i,s,r),a,o),d.length>0||(h=new H(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),d=this.findMatchesLineByLine(h,c,o,1),d.length>0)?d[0]:null}return xx.findNextMatch(this,new Yf(e,i,s,r),a,o)}findPreviousMatch(e,t,i,s,r,o){this._assertNotDisposed();const a=this.validatePosition(t);return xx.findPreviousMatch(this,new Yf(e,i,s,r),a,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof qN?e:new qN(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,s=e.length;i<s;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,s){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,s)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,s){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const r=t.map(a=>({range:this.validateRange(a.range),text:a.text}));let o=!0;if(e)for(let a=0,l=e.length;a<l;a++){const c=e[a];let u=!1;for(let h=0,d=r.length;h<d;h++){const f=r[h].range,g=f.startLineNumber>c.endLineNumber,p=c.startLineNumber>f.endLineNumber;if(!g&&!p){u=!0;break}}if(!u){o=!1;break}}if(o)for(let a=0,l=this._trimAutoWhitespaceLines.length;a<l;a++){const c=this._trimAutoWhitespaceLines[a],u=this.getLineMaxColumn(c);let h=!0;for(let d=0,f=r.length;d<f;d++){const g=r[d].range,p=r[d].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===u&&g.isEmpty()&&p&&p.length>0&&p.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&p&&p.length>0&&p.charAt(p.length-1)===`
`)){h=!1;break}}if(h){const d=new H(c,1,c,u);t.push(new qN(null,d,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,s)}_applyUndo(e,t,i,s){const r=e.map(o=>{const a=this.getPositionAt(o.newPosition),l=this.getPositionAt(o.newEnd);return{range:new H(a.lineNumber,a.column,l.lineNumber,l.column),text:o.oldText}});this._applyUndoRedoEdits(r,t,!0,!1,i,s)}_applyRedo(e,t,i,s){const r=e.map(o=>{const a=this.getPositionAt(o.oldPosition),l=this.getPositionAt(o.oldEnd);return{range:new H(a.lineNumber,a.column,l.lineNumber,l.column),text:o.newText}});this._applyUndoRedoEdits(r,t,!1,!0,i,s)}_applyUndoRedoEdits(e,t,i,s,r,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=s,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(r)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),s=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),r=this._buffer.getLineCount(),o=s.changes;if(this._trimAutoWhitespaceLines=s.trimAutoWhitespaceLineNumbers,o.length!==0){for(let c=0,u=o.length;c<u;c++){const h=o[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}const a=[];this._increaseVersionId();let l=i;for(let c=0,u=o.length;c<u;c++){const h=o[c],[d]=Ep(h.text);this._onDidChangeDecorations.fire();const f=h.range.startLineNumber,g=h.range.endLineNumber,p=g-f,m=d,b=Math.min(p,m),v=m-p,w=r-l-v+f,y=w,x=w+m,D=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new X(y,1)),this.getOffsetAt(new X(x,this.getLineMaxColumn(x))),0),S=Sl.fromDecorations(D),T=new th(S);for(let k=b;k>=0;k--){const I=f+k,N=w+k;T.takeFromEndWhile($=>$.lineNumber>N);const z=T.takeFromEndWhile($=>$.lineNumber===N);a.push(new rj(I,this.getLineContent(N),z))}if(b<p){const k=f+b;a.push(new a6e(k+1,g))}if(b<m){const k=new th(S),I=f+b,N=m-b,z=r-l-N+I+1,$=[],q=[];for(let ne=0;ne<N;ne++){const de=z+ne;q[ne]=this.getLineContent(de),k.takeWhile(me=>me.lineNumber<de),$[ne]=k.takeWhile(me=>me.lineNumber===de)}a.push(new l6e(I+1,f+m,q,$))}l+=v}this._emitContentChangedEvent(new o_(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:o,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return s.reverseEdits===null?void 0:s.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=Array.from(e).map(s=>new rj(s,this.getLineContent(s),this._getInjectedTextInLine(s)));this._onDidChangeInjectedText.fire(new Gse(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(r,o)=>this._deltaDecorationsImpl(e,[],[{range:r,options:o}])[0],changeDecoration:(r,o)=>{this._changeDecorationImpl(r,o)},changeDecorationOptions:(r,o)=>{this._changeDecorationOptionsImpl(r,cj(o))},removeDecoration:r=>{this._deltaDecorationsImpl(e,[r],[])},deltaDecorations:(r,o)=>r.length===0&&o.length===0?[]:this._deltaDecorationsImpl(e,r,o)};let s=null;try{s=t(i)}catch(r){Ft(r)}return i.addDecoration=R1,i.changeDecoration=R1,i.changeDecorationOptions=R1,i.removeDecoration=R1,i.deltaDecorations=R1,s}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ft(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const s=e?this._decorations[e]:null;if(!s)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:lj[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(s),delete this._decorations[s.id],null;const r=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),a=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);return this._decorationsTree.delete(s),s.reset(this.getVersionId(),o,a,r),s.setOptions(lj[i]),this._decorationsTree.insert(s),s.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,s=t.length;i<s;i++){const r=t[i];this._decorationsTree.delete(r),delete this._decorations[r.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,s=!1,r=!1){const o=this.getLineCount(),a=Math.min(o,Math.max(1,e)),l=Math.min(o,Math.max(1,t)),c=this.getLineMaxColumn(l),u=new H(a,1,l,c),h=this._getDecorationsInRange(u,i,s,r);return O4(h,this._decorationProvider.getDecorationsInRange(u,i,s)),h}getDecorationsInRange(e,t=0,i=!1,s=!1,r=!1){const o=this.validateRange(e),a=this._getDecorationsInRange(o,t,i,r);return O4(a,this._decorationProvider.getDecorationsInRange(o,t,i,s)),a}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),s=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return Sl.fromDecorations(s).filter(r=>r.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,t,i,s){const r=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),o=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,r,o,t,i,s)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const s=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),o=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),r,o,s),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const s=!!(i.options.overviewRuler&&i.options.overviewRuler.color),r=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const o=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber)}if(i.options.before||t.before){const o=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}s!==r?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i,s=!1){const r=this.getVersionId(),o=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const u=new Array(l);for(;a<o||c<l;){let h=null;if(a<o){do h=this._decorations[t[a++]];while(!h&&a<o);if(h){if(h.options.after){const d=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber)}if(h.options.before){const d=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber)}this._decorationsTree.delete(h),s||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<l){if(!h){const b=++this._lastDecorationId,v=`${this._instanceId};${b}`;h=new zse(v,0,0),this._decorations[v]=h}const d=i[c],f=this._validateRangeRelaxedNoAllocations(d.range),g=cj(d.options),p=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),m=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);h.ownerId=e,h.reset(r,p,m,f),h.setOptions(g),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),s||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(h),u[c]=h.id,c++}else h&&delete this._decorations[h.id]}return u}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return m6e(this.getLineContent(e))+1}};Mc._MODEL_SYNC_LIMIT=50*1024*1024;Mc.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;Mc.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;Mc.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;Mc.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:ls.tabSize,indentSize:ls.indentSize,insertSpaces:ls.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:ls.trimAutoWhitespace,largeFileOptimizations:ls.largeFileOptimizations,bracketPairColorizationOptions:ls.bracketPairColorizationOptions};Mc=Xf=u6e([dR(4,qT),dR(5,Ji),dR(6,Ur)],Mc);function m6e(n){let e=0;for(const t of n)if(t===" "||t==="	")e++;else break;return e}function fR(n){return!!(n.options.overviewRuler&&n.options.overviewRuler.color)}function gR(n){return!!n.options.after||!!n.options.before}class aj{constructor(){this._decorationsTree0=new cR,this._decorationsTree1=new cR,this._injectedTextDecorationsTree=new cR}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,s,r,o){const a=e.getVersionId(),l=this._intervalSearch(t,i,s,r,a,o);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,s,r,o){const a=this._decorationsTree0.intervalSearch(e,t,i,s,r,o),l=this._decorationsTree1.intervalSearch(e,t,i,s,r,o),c=this._injectedTextDecorationsTree.intervalSearch(e,t,i,s,r,o);return a.concat(l).concat(c)}getInjectedTextInInterval(e,t,i,s){const r=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,i,s,!1,r,!1);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),s=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,s).filter(r=>r.options.showIfCollapsed||!r.range.isEmpty())}getAll(e,t,i,s,r){const o=e.getVersionId(),a=this._search(t,i,s,o,r);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,s,r){if(i)return this._decorationsTree1.search(e,t,s,r);{const o=this._decorationsTree0.search(e,t,s,r),a=this._decorationsTree1.search(e,t,s,r),l=this._injectedTextDecorationsTree.search(e,t,s,r);return o.concat(a).concat(l)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),s=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(s)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){gR(e)?this._injectedTextDecorationsTree.insert(e):fR(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){gR(e)?this._injectedTextDecorationsTree.delete(e):fR(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){gR(e)?this._injectedTextDecorationsTree.resolveNode(e,t):fR(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,s){this._decorationsTree0.acceptReplace(e,t,i,s),this._decorationsTree1.acceptReplace(e,t,i,s),this._injectedTextDecorationsTree.acceptReplace(e,t,i,s)}}function nu(n){return n.replace(/[^a-z0-9\-_]/gi," ")}class Zse{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class _6e extends Zse{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:zo.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class b6e{constructor(e){var t;this.position=(t=e==null?void 0:e.position)!==null&&t!==void 0?t:Q0.Left}}class v6e extends Zse{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?J.fromHex(e):t.getColor(e.id)}}class hb{static from(e){return e instanceof hb?e:new hb(e)}constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class mt{static register(e){return new mt(e)}static createDynamic(e){return new mt(e)}constructor(e){var t,i,s,r,o,a;this.description=e.description,this.blockClassName=e.blockClassName?nu(e.blockClassName):null,this.blockDoesNotCollapse=(t=e.blockDoesNotCollapse)!==null&&t!==void 0?t:null,this.blockIsAfterEnd=(i=e.blockIsAfterEnd)!==null&&i!==void 0?i:null,this.blockPadding=(s=e.blockPadding)!==null&&s!==void 0?s:null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?nu(e.className):null,this.shouldFillLineOnLineBreak=(r=e.shouldFillLineOnLineBreak)!==null&&r!==void 0?r:null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new _6e(e.overviewRuler):null,this.minimap=e.minimap?new v6e(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new b6e(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?nu(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?nu(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?nu(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?nu(e.marginClassName):null,this.inlineClassName=e.inlineClassName?nu(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?nu(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?nu(e.afterContentClassName):null,this.after=e.after?hb.from(e.after):null,this.before=e.before?hb.from(e.before):null,this.hideInCommentTokens=(o=e.hideInCommentTokens)!==null&&o!==void 0?o:!1,this.hideInStringTokens=(a=e.hideInStringTokens)!==null&&a!==void 0?a:!1}}mt.EMPTY=mt.register({description:"empty"});const lj=[mt.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),mt.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),mt.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),mt.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function cj(n){return n instanceof mt?n:mt.createDynamic(n)}class w6e extends ae{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new G),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)===null||e===void 0||e.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!!(e.minimap&&e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!(e.overviewRuler&&e.overviewRuler.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class y6e extends ae{constructor(){super(),this._fastEmitter=this._register(new G),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new G),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}class C6e{constructor(){this._onDidChangeVisibleRanges=new G,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const e=new S6e(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}}class S6e{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){const i=e.map(s=>new gt(s.startLineNumber,s.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}}class cD{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Vn(new H(1,1,1,1),0,0,new X(1,1),0),new Vn(new H(1,1,1,1),0,0,new X(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new St(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?Lt.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):Lt.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,s){return t.equals(i)?s:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,s=t.selectionStart.getStartPosition(),r=t.selectionStart.getEndPosition(),o=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,s,i,o),l=this._validatePositionWithCache(e,r,s,a);return i.equals(o)&&s.equals(a)&&r.equals(l)?t:new Vn(H.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+s.column-a.column,o,t.leftoverVisibleColumns+i.column-o.column)}_setState(e,t,i){if(i&&(i=cD._validateViewState(e.viewModel,i)),t){const s=e.model.validateRange(t.selectionStart),r=t.selectionStart.equalsRange(s)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),a=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new Vn(s,t.selectionStartKind,r,o,a)}else{if(!i)return;const s=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),r=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new Vn(s,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,r,i.leftoverVisibleColumns)}if(i){const s=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),r=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new Vn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,r,t.leftoverVisibleColumns)}else{const s=e.coordinatesConverter.convertModelPositionToViewPosition(new X(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),r=e.coordinatesConverter.convertModelPositionToViewPosition(new X(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new H(s.lineNumber,s.column,r.lineNumber,r.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new Vn(o,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class uj{constructor(e){this.context=e,this.cursors=[new cD(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return pMe(this.cursors,Sa(e=>e.viewState.position,X.compare)).viewState.position}getBottomMostViewPosition(){return gMe(this.cursors,Sa(e=>e.viewState.position,X.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(St.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const s=i-t;for(let r=0;r<s;r++)this._addSecondaryCursor()}else if(t>i){const s=t-i;for(let r=0;r<s;r++)this._removeSecondaryCursor(this.cursors.length-2)}for(let s=0;s<i;s++)this.cursors[s+1].setState(this.context,e[s].modelState,e[s].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new cD(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,s=e.length;i<s;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(Sa(i=>i.selection,H.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const s=t[i],r=t[i+1],o=s.selection,a=r.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||o.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):l=a.getStartPosition().isBefore(o.getEndPosition()),l){const c=s.index<r.index?i:i+1,u=s.index<r.index?i+1:i,h=t[u].index,d=t[c].index,f=t[u].selection,g=t[c].selection;if(!f.equalsSelection(g)){const p=f.plusRange(g),m=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,b=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn;let v;h===this.lastAddedCursorIndex?(v=m,this.lastAddedCursorIndex=d):v=b;let w;v?w=new Lt(p.startLineNumber,p.startColumn,p.endLineNumber,p.endColumn):w=new Lt(p.endLineNumber,p.endColumn,p.startLineNumber,p.startColumn),t[c].selection=w;const y=St.fromModelSelection(w);e[d].setState(this.context,y.modelState,y.viewState)}for(const p of t)p.index>h&&p.index--;e.splice(h,1),t.splice(u,1),this._removeSecondaryCursor(h-1),i--}}}}class hj{constructor(e,t,i,s){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=s}}class x6e{constructor(){this.type=0}}class k6e{constructor(){this.type=1}}class L6e{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class D6e{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class zm{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0)}}class Wx{constructor(){this.type=5}}class E6e{constructor(e){this.type=6,this.isFocused=e}}class T6e{constructor(){this.type=7}}class Vx{constructor(){this.type=8}}class Yse{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class EF{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class TF{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class ak{constructor(e,t,i,s,r,o,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=s,this.verticalType=r,this.revealHorizontal=o,this.scrollType=a,this.type=12}}class A6e{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class I6e{constructor(e){this.theme=e,this.type=14}}class N6e{constructor(e){this.type=15,this.ranges=e}}class R6e{constructor(){this.type=16}}let M6e=class{constructor(){this.type=17}};class F6e extends ae{constructor(){super(),this._onEvent=this._register(new G),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const s=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(s){this._outgoingEvents[t]=s;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new P6e),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class P6e{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class c7{constructor(e,t,i,s){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=s,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new c7(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class u7{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new u7(this.oldHasFocus,e.hasFocus)}}class h7{constructor(e,t,i,s,r,o,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=s,this.scrollWidth=r,this.scrollLeft=o,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new h7(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class O6e{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class B6e{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class uD{constructor(e,t,i,s,r,o,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=s,this.source=r,this.reason=o,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,s=t.length;if(i!==s)return!1;for(let r=0;r<i;r++)if(!e[r].equalsSelection(t[r]))return!1;return!0}isNoOp(){return uD._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new uD(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class W6e{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class V6e{constructor(e){this.event=e,this.kind=7}isNoOp(){return!1}attemptToMerge(e){return null}}class $6e{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class z6e{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class H6e{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class U6e{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class j6e{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class q6e extends ae{constructor(e,t,i,s){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new hj(this._model,this._viewModel,this._coordinatesConverter,s),this._cursors=new uj(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=ti(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new hj(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,s){let r=!1;const o=this.context.cursorConfig.multiCursorLimit;s!==null&&s.length>o&&(s=s.slice(0,o),r=!0);const a=iw.from(this._model,this);return this._cursors.setStates(s),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,r)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,i,s,r,o){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=H.fromPositions(a[0],a[0]),e.emitViewEvent(new ak(t,i,l,c,s,r,o))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,s=t.length;i<s;i++){const r=t[i];e.push({inSelectionMode:!r.isEmpty(),selectionStart:{lineNumber:r.selectionStartLineNumber,column:r.selectionStartColumn},position:{lineNumber:r.positionLineNumber,column:r.positionColumn}})}return e}restoreState(e,t){const i=[];for(let s=0,r=t.length;s<r;s++){const o=t[s];let a=1,l=1;o.position&&o.position.lineNumber&&(a=o.position.lineNumber),o.position&&o.position.column&&(l=o.position.column);let c=a,u=l;o.selectionStart&&o.selectionStart.lineNumber&&(c=o.selectionStart.lineNumber),o.selectionStart&&o.selectionStart.column&&(u=o.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:u,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,St.fromModelSelections(i)),this.revealPrimary(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof Gse){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const s=i.containsEvent(1);if(this._prevEditOperationType=0,s)this._cursors.dispose(),this._cursors=new uj(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const r=St.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,r)&&this.revealPrimary(e,"modelChange",!1,0,!0,0)}else{const r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,St.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,s){this.setStates(e,t,s,St.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],s=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),s.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const r=this._model.deltaDecorations([],i),o=this._model.deltaDecorations([],s);this._autoClosedActions.push(new dj(this._model,r,o))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=G6e.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],s=[];for(let r=0;r<e.commands.length;r++){const o=e.commands[r];o instanceof Sse&&o.enclosingRange&&o.closeCharacterRange&&(i.push(o.closeCharacterRange),s.push(o.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,s),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,s,r){const o=iw.from(this._model,this);if(o.equals(s))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new D6e(l,a,i)),!s||s.cursorState.length!==o.cursorState.length||o.cursorState.some((c,u)=>!c.modelState.equals(s.cursorState[u].modelState))){const c=s?s.cursorState.map(h=>h.modelState.selection):null,u=s?s.modelVersionId:0;e.emitOutgoingEvent(new uD(c,a,u,o.modelVersionId,t||"keyboard",i,r))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,s=e.length;i<s;i++){const r=e[i];if(!r.text||r.text.indexOf(`
`)>=0)return null;const o=r.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const a=o[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,u=r.text.length-o[2].length-1,h=r.text.lastIndexOf(c,u-1);if(h===-1)return null;t.push([h,u])}return t}executeEdits(e,t,i,s){let r=null;t==="snippet"&&(r=this._findAutoClosingPairs(i)),r&&(i[0]._isTracked=!0);const o=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(r)for(let h=0,d=r.length;h<d;h++){const[f,g]=r[h],p=c[h],m=p.range.startLineNumber,b=p.range.startColumn-1+f,v=p.range.startColumn-1+g;o.push(new H(m,v+1,m,v+2)),a.push(new H(m,b+1,m,v+2))}const u=s(c);return u&&(this._isHandling=!0),u});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),o.length>0&&this._pushAutoClosedAction(o,a)}_executeEdit(e,t,i,s=0){if(this.context.cursorConfig.readOnly)return;const r=iw.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){Ft(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,s,r,!1)&&this.revealPrimary(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return dj.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new nw(this._model,this.getSelections())}endComposition(e,t){const i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Ni.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const s=t.length;let r=0;for(;r<s;){const o=d8(t,r),a=t.substr(r,o);this._executeEditOperation(Ni.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),r+=o}}else this._executeEditOperation(Ni.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,s,r,o){if(t.length===0&&i===0&&s===0){if(r!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new Lt(c.lineNumber,c.column+r,c.lineNumber,c.column+r)});this.setSelections(e,o,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Ni.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,s,r))},e,o)}paste(e,t,i,s,r){this._executeEdit(()=>{this._executeEditOperation(Ni.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,s||[]))},e,r,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(Dp.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new tr(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new tr(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}class iw{static from(e,t){return new iw(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class dj{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const s=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(s&&(t.push(s),s.startLineNumber!==s.endLineNumber))return!1}t.sort(H.compareRangesUsingStarts),e.sort(H.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class G6e{static executeCommands(e,t,i){const s={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},r=this._innerExecuteCommands(s,i);for(let o=0,a=s.trackedRanges.length;o<a;o++)s.model._setTrackedRange(s.trackedRanges[o],null,0);return r}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const s=i.operations,r=this._getLoserCursorMap(s);if(r.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const o=[];for(let c=0,u=s.length;c<u;c++)r.hasOwnProperty(s[c].identifier.major.toString())||o.push(s[c]);i.hadTrackedEditOperation&&o.length>0&&(o[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,o,c=>{const u=[];for(let f=0;f<e.selectionsBefore.length;f++)u[f]=[];for(const f of c)f.identifier&&u[f.identifier.major].push(f);const h=(f,g)=>f.identifier.minor-g.identifier.minor,d=[];for(let f=0;f<e.selectionsBefore.length;f++)u[f].length>0?(u[f].sort(h),d[f]=t[f].computeCursorState(e.model,{getInverseEditOperations:()=>u[f],getTrackedSelection:g=>{const p=parseInt(g,10),m=e.model._getTrackedRange(e.trackedRanges[p]);return e.trackedRangesDirection[p]===0?new Lt(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn):new Lt(m.endLineNumber,m.endColumn,m.startLineNumber,m.startColumn)}})):d[f]=e.selectionsBefore[f];return d});a||(a=e.selectionsBefore);const l=[];for(const c in r)r.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,u)=>u-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],s=!1;for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a){const l=this._getEditOperationsFromCommand(e,r,a);i=i.concat(l.operations),s=s||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:s}}static _getEditOperationsFromCommand(e,t,i){const s=[];let r=0;const o=(h,d,f=!1)=>{H.isEmpty(h)&&d===""||s.push({identifier:{major:t,minor:r++},range:h,text:d,forceMoveMarkers:f,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const u={addEditOperation:o,addTrackedEditOperation:(h,d,f)=>{a=!0,o(h,d,f)},trackSelection:(h,d)=>{const f=Lt.liftSelection(h);let g;if(f.isEmpty())if(typeof d=="boolean")d?g=2:g=3;else{const b=e.model.getLineMaxColumn(f.startLineNumber);f.startColumn===b?g=2:g=3}else g=1;const p=e.trackedRanges.length,m=e.model._setTrackedRange(null,f,g);return e.trackedRanges[p]=m,e.trackedRangesDirection[p]=f.getDirection(),p.toString()}};try{i.getEditOperations(e.model,u)}catch(h){return Ft(h),{operations:[],hadTrackedEditOperation:!1}}return{operations:s,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,s)=>-H.compareRangesUsingEnds(i.range,s.range));const t={};for(let i=1;i<e.length;i++){const s=e[i-1],r=e[i];if(H.getStartPosition(s.range).isBefore(H.getEndPosition(r.range))){let o;s.identifier.major>r.identifier.major?o=s.identifier.major:o=r.identifier.major,t[o.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===o&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class K6e{constructor(e,t,i){this.text=e,this.startSelection=t,this.endSelection=i}}class nw{static _capture(e,t){const i=[];for(const s of t){if(s.startLineNumber!==s.endLineNumber)return null;i.push(new K6e(e.getLineContent(s.startLineNumber),s.startColumn-1,s.endColumn-1))}return i}constructor(e,t){this._original=nw._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=nw._capture(e,t);if(!i||this._original.length!==i.length)return null;const s=[];for(let r=0,o=this._original.length;r<o;r++)s.push(nw._deduceOutcome(this._original[r],i[r]));return s}static _deduceOutcome(e,t){const i=Math.min(e.startSelection,t.startSelection,RL(e.text,t.text)),s=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,M3(e.text,t.text)),r=e.text.substring(i,e.text.length-s),o=t.text.substring(i,t.text.length-s);return new QPe(r,e.startSelection-i,e.endSelection-i,o,t.startSelection-i,t.endSelection-i)}}var Z6e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const fj={getInitialState:()=>yy,tokenizeEncoded:(n,e,t)=>N8(0,t)};function Y6e(n,e,t){return Z6e(this,void 0,void 0,function*(){if(!t)return gj(e,n.languageIdCodec,fj);const i=yield $i.getOrCreate(t);return gj(e,n.languageIdCodec,i||fj)})}function X6e(n,e,t,i,s,r,o){let a="<div>",l=i,c=0,u=!0;for(let h=0,d=e.getCount();h<d;h++){const f=e.getEndOffset(h);if(f<=i)continue;let g="";for(;l<f&&l<s;l++){const p=n.charCodeAt(l);switch(p){case 9:{let m=r-(l+c)%r;for(c+=m-1;m>0;)o&&u?(g+="&#160;",u=!1):(g+=" ",u=!0),m--;break}case 60:g+="&lt;",u=!1;break;case 62:g+="&gt;",u=!1;break;case 38:g+="&amp;",u=!1;break;case 0:g+="&#00;",u=!1;break;case 65279:case 8232:case 8233:case 133:g+="�",u=!1;break;case 13:g+="&#8203",u=!1;break;case 32:o&&u?(g+="&#160;",u=!1):(g+=" ",u=!0);break;default:g+=String.fromCharCode(p),u=!1}}if(a+=`<span style="${e.getInlineStyle(h,t)}">${g}</span>`,f>s||l>=s)break}return a+="</div>",a}function gj(n,e,t){let i='<div class="monaco-tokenized-source">';const s=em(n);let r=t.getInitialState();for(let o=0,a=s.length;o<a;o++){const l=s[o];o>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,r);An.convertToEndOffset(c.tokens,l.length);const h=new An(c.tokens,l,e).inflate();let d=0;for(let f=0,g=h.getCount();f<g;f++){const p=h.getClassName(f),m=h.getEndOffset(f);i+=`<span class="${p}">${NL(l.substring(d,m))}</span>`,d=m}r=c.endState}return i+="</div>",i}class Q6e{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,s=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,s)}}class J6e{constructor(e,t,i,s,r){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=s,this.minWidth=r,this.prefixSum=0}}let Xse=class AF{constructor(e,t,i,s){this._instanceId=Pie(++AF.INSTANCE_COUNT),this._pendingChanges=new Q6e,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=s}static findInsertionIndex(e,t,i){let s=0,r=e.length;for(;s<r;){const o=s+r>>>1;t===e[o].afterLineNumber?i<e[o].ordinal?r=o:s=o+1:t<e[o].afterLineNumber?r=o:s=o+1}return s}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(s,r,o,a)=>{t=!0,s=s|0,r=r|0,o=o|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new J6e(l,s,r,o,a)),l},changeOneWhitespace:(s,r,o)=>{t=!0,r=r|0,o=o|0,this._pendingChanges.change({id:s,newAfterLineNumber:r,newHeight:o})},removeWhitespace:s=>{t=!0,this._pendingChanges.remove({id:s})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const s=new Set;for(const l of i)s.add(l.id);const r=new Map;for(const l of t)r.set(l.id,l);const o=l=>{const c=[];for(const u of l)if(!s.has(u.id)){if(r.has(u.id)){const h=r.get(u.id);u.afterLineNumber=h.newAfterLineNumber,u.height=h.newHeight}c.push(u)}return c},a=o(this._arr).concat(o(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=AF.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,s=t.length;i<s;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const s=this._findWhitespaceIndex(e);if(s!==-1&&(this._arr[s].height!==i&&(this._arr[s].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,s-1)),this._arr[s].afterLineNumber!==t)){const r=this._arr[s];this._removeWhitespace(s),r.afterLineNumber=t,this._insertWhitespace(r)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,s=this._arr.length;i<s;i++){const r=this._arr[i].afterLineNumber;e<=r&&r<=t?this._arr[i].afterLineNumber=e-1:r>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,s=this._arr.length;i<s;i++){const r=this._arr[i].afterLineNumber;e<=r&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,s=t.length-1;for(;i<=s;){const o=(s-i|0)/2|0,a=i+o|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else s=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;const s=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+s+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;const i=this._lineHeight*e,s=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+s+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let s=1,r=t;for(;s<r;){const o=(s+r)/2|0,a=this.getVerticalOffsetForLineNumber(o)|0;if(e>=a+i)s=o+1;else{if(e>=a)return o;r=o}}return s>t?t:s}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,s=this.getLineNumberAtOrAfterVerticalOffset(e)|0,r=this.getVerticalOffsetForLineNumber(s)|0;let o=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(s)|0;const l=this.getWhitespacesCount()|0;let c,u;a===-1?(a=l,u=o+1,c=0):(u=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let h=r,d=h;const f=5e5;let g=0;r>=f&&(g=Math.floor(r/f)*f,g=Math.floor(g/i)*i,d-=g);const p=[],m=e+(t-e)/2;let b=-1;for(let x=s;x<=o;x++){if(b===-1){const D=h,S=h+i;(D<=m&&m<S||D>m)&&(b=x)}for(h+=i,p[x-s]=d,d+=i;u===x;)d+=c,h+=c,a++,a>=l?u=o+1:(u=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(h>=t){o=x;break}}b===-1&&(b=o);const v=this.getVerticalOffsetForLineNumber(o)|0;let w=s,y=o;return w<y&&r<e&&w++,w<y&&v+i>t&&y--,{bigNumbersDelta:g,startLineNumber:s,endLineNumber:o,relativeVerticalOffset:p,centeredLineNumber:b,completelyVisibleStartLineNumber:w,completelyVisibleEndLineNumber:y}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let s;return e>0?s=this.getWhitespacesAccumulatedHeight(e-1):s=0,i+s+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const s=this.getVerticalOffsetForWhitespaceIndex(i),r=this.getHeightForWhitespaceIndex(i);if(e>=s+r)return-1;for(;t<i;){const o=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(e>=a+l)t=o+1;else{if(e>=a)return o;i=o}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const s=this.getHeightForWhitespaceIndex(t),r=this.getIdForWhitespaceIndex(t),o=this.getAfterLineNumberForWhitespaceIndex(t);return{id:r,afterLineNumber:o,verticalOffset:i,height:s}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),s=this.getWhitespacesCount()-1;if(i<0)return[];const r=[];for(let o=i;o<=s;o++){const a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(a>=t)break;r.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:a,height:l})}return r}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};Xse.INSTANCE_COUNT=0;const e8e=125;class gv{constructor(e,t,i,s){e=e|0,t=t|0,i=i|0,s=s|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),s<0&&(s=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=s,this.scrollHeight=Math.max(i,s)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class t8e extends ae{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new G),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new gv(0,0,0,0),this._scrollable=this._register(new vS({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,s=t.contentHeight!==e.contentHeight;(i||s)&&this._onDidContentSizeChange.fire(new c7(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class i8e extends ae{constructor(e,t,i){super(),this._configuration=e;const s=this._configuration.options,r=s.get(143),o=s.get(83);this._linesLayout=new Xse(t,s.get(66),o.top,o.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new t8e(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new gv(r.contentWidth,0,r.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(113)?e8e:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(66)&&this._linesLayout.setLineHeight(t.get(66)),e.hasChanged(83)){const i=t.get(83);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(143)){const i=t.get(143),s=i.contentWidth,r=i.height,o=this._scrollable.getScrollDimensions(),a=o.contentWidth;this._scrollable.setScrollDimensions(new gv(s,o.contentWidth,r,this._getContentHeight(s,r,a)))}else this._updateHeight();e.hasChanged(113)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const s=this._configuration.options.get(102);return s.horizontal===2||e>=t?0:s.horizontalScrollbarSize}_getContentHeight(e,t,i){const s=this._configuration.options;let r=this._linesLayout.getLinesTotalHeight();return s.get(104)?r+=Math.max(0,t-s.get(66)-s.get(83).bottom):r+=this._getHorizontalScrollbarHeight(e,i),r}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,s=e.contentWidth;this._scrollable.setScrollDimensions(new gv(t,e.contentWidth,i,this._getContentHeight(t,i,s)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new nU(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new nU(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(144),s=e.get(50),r=e.get(143);if(i.isViewportWrapping){const o=e.get(72);return t>r.contentWidth+s.typicalHalfwidthCharacterWidth&&o.enabled&&o.side==="right"?t+r.verticalScrollbarWidth:t}else{const o=e.get(103)*s.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+o+r.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new gv(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),s=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-s,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class n8e{constructor(e,t,i,s,r){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=s,this._coordinatesConverter=r,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const s=e.range,r=e.options;let o;if(r.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new X(s.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new X(s.endLineNumber,this.model.getLineMaxColumn(s.endLineNumber)),1);o=new H(a.lineNumber,a.column,l.lineNumber,l.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(s,1);i=new Une(o,r),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){const s=new H(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(s,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){const s=this._linesCollection.getDecorationsInRange(e,this.editorId,DL(this.configuration.options),t,i),r=e.startLineNumber,o=e.endLineNumber,a=[];let l=0;const c=[];for(let u=r;u<=o;u++)c[u-r]=[];for(let u=0,h=s.length;u<h;u++){const d=s[u],f=d.options;if(!s8e(this.model,d))continue;const g=this._getOrCreateViewModelDecoration(d),p=g.range;if(a[l++]=g,f.inlineClassName){const m=new qv(p,f.inlineClassName,f.inlineClassNameAffectsLetterSpacing?3:0),b=Math.max(r,p.startLineNumber),v=Math.min(o,p.endLineNumber);for(let w=b;w<=v;w++)c[w-r].push(m)}if(f.beforeContentClassName&&r<=p.startLineNumber&&p.startLineNumber<=o){const m=new qv(new H(p.startLineNumber,p.startColumn,p.startLineNumber,p.startColumn),f.beforeContentClassName,1);c[p.startLineNumber-r].push(m)}if(f.afterContentClassName&&r<=p.endLineNumber&&p.endLineNumber<=o){const m=new qv(new H(p.endLineNumber,p.endColumn,p.endLineNumber,p.endColumn),f.afterContentClassName,2);c[p.endLineNumber-r].push(m)}}return{decorations:a,inlineDecorations:c}}}function s8e(n,e){return!(e.options.hideInCommentTokens&&r8e(n,e)||e.options.hideInStringTokens&&o8e(n,e))}function r8e(n,e){return Qse(n,e.range,t=>t===1)}function o8e(n,e){return Qse(n,e.range,t=>t===2)}function Qse(n,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const s=n.tokenization.getLineTokens(i),r=i===e.startLineNumber,o=i===e.endLineNumber;let a=r?s.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<s.getCount()&&!(o&&s.getStartOffset(a)>e.endColumn-1);){if(!t(s.getStandardTokenType(a)))return!1;a++}}return!0}function pR(n,e){return n===null?e?hD.INSTANCE:dD.INSTANCE:new a8e(n,e)}class a8e{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const s=i>0?this._projectionData.breakOffsets[i-1]:0,r=this._projectionData.breakOffsets[i];let o;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,u)=>new Sl(0,0,c+1,this._projectionData.injectionOptions[u],0));o=Sl.applyInjectedText(e.getLineContent(t),a).substring(s,r)}else o=e.getValueInRange({startLineNumber:t,startColumn:s+1,endLineNumber:t,endColumn:r+1});return i>0&&(o=pj(this._projectionData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const s=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],s),s[0]}getViewLinesData(e,t,i,s,r,o,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,u=l.injectionOptions;let h=null;if(c){h=[];let f=0,g=0;for(let p=0;p<l.getOutputLineCount();p++){const m=new Array;h[p]=m;const b=p>0?l.breakOffsets[p-1]:0,v=l.breakOffsets[p];for(;g<c.length;){const w=u[g].content.length,y=c[g]+f,x=y+w;if(y>v)break;if(b<x){const D=u[g];if(D.inlineClassName){const S=p>0?l.wrappedTextIndentLength:0,T=S+Math.max(y-b,0),k=S+Math.min(x-b,v-b);T!==k&&m.push(new f4e(T,k,D.inlineClassName,D.inlineClassNameAffectsLetterSpacing))}}if(x<=v)f+=w,g++;else break}}}let d;c?d=e.tokenization.getLineTokens(t).withInserted(c.map((f,g)=>({offset:f,text:u[g].content,tokenMetadata:An.defaultTokenMetadata}))):d=e.tokenization.getLineTokens(t);for(let f=i;f<i+s;f++){const g=r+f-i;if(!o[g]){a[g]=null;continue}a[g]=this._getViewLineData(d,h?h[f]:null,f)}}_getViewLineData(e,t,i){this._assertVisible();const s=this._projectionData,r=i>0?s.wrappedTextIndentLength:0,o=i>0?s.breakOffsets[i-1]:0,a=s.breakOffsets[i],l=e.sliceAndInflate(o,a,r);let c=l.getLineContent();i>0&&(c=pj(s.wrappedTextIndentLength)+c);const u=this._projectionData.getMinOutputOffset(i)+1,h=c.length+1,d=i+1<this.getViewLineCount(),f=i===0?0:s.breakOffsetsVisibleColumn[i-1];return new F8(c,d,u,h,f,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const s=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(s)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class hD{constructor(){}isVisible(){return!0}setVisible(e){return e?this:dD.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const s=e.tokenization.getLineTokens(t),r=s.getLineContent();return new F8(r,!1,1,r.length+1,0,s.inflate(),null)}getViewLinesData(e,t,i,s,r,o,a){if(!o[r]){a[r]=null;return}a[r]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new X(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}}hD.INSTANCE=new hD;class dD{constructor(){}isVisible(){return!1}setVisible(e){return e?hD.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,s,r,o,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}}dD.INSTANCE=new dD;const mR=[""];function pj(n){if(n>=mR.length)for(let e=1;e<=n;e++)mR[e]=l8e(e);return mR[n]}function l8e(n){return new Array(n+1).join(" ")}class c8e{constructor(e,t,i,s,r,o,a,l,c,u){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=s,this.fontInfo=r,this.tabSize=o,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=u,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new h8e(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),s=this.model.getInjectedTextDecorations(this._editorId),r=i.length,o=this.createLineBreaksComputer(),a=new th(Sl.fromDecorations(s));for(let p=0;p<r;p++){const m=a.takeWhile(b=>b.lineNumber===p+1);o.addRequest(i[p],m,t?t[p]:null)}const l=o.finalize(),c=[],u=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(H.compareRangesUsingStarts);let h=1,d=0,f=-1,g=f+1<u.length?d+1:r+2;for(let p=0;p<r;p++){const m=p+1;m===g&&(f++,h=u[f].startLineNumber,d=u[f].endLineNumber,g=f+1<u.length?d+1:r+2);const b=m>=h&&m<=d,v=pR(l[p],!b);c[p]=v.getViewLineCount(),this.modelLineProjections[p]=v}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new qRe(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(d=>this.model.validateRange(d)),i=u8e(t),s=this.hiddenAreasDecorationIds.map(d=>this.model.getDecorationRange(d)).sort(H.compareRangesUsingStarts);if(i.length===s.length){let d=!1;for(let f=0;f<i.length;f++)if(!i[f].equalsRange(s[f])){d=!0;break}if(!d)return!1}const r=i.map(d=>({range:d,options:mt.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,r);const o=i;let a=1,l=0,c=-1,u=c+1<o.length?l+1:this.modelLineProjections.length+2,h=!1;for(let d=0;d<this.modelLineProjections.length;d++){const f=d+1;f===u&&(c++,a=o[c].startLineNumber,l=o[c].endLineNumber,u=c+1<o.length?l+1:this.modelLineProjections.length+2);let g=!1;if(f>=a&&f<=l?this.modelLineProjections[d].isVisible()&&(this.modelLineProjections[d]=this.modelLineProjections[d].setVisible(!1),g=!0):(h=!0,this.modelLineProjections[d].isVisible()||(this.modelLineProjections[d]=this.modelLineProjections[d].setVisible(!0),g=!0)),g){const p=this.modelLineProjections[d].getViewLineCount();this.projectedModelLineLineCounts.setValue(d,p)}}return h||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,s,r){const o=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===s,u=this.wordBreak===r;if(o&&a&&l&&c&&u)return!1;const h=o&&a&&!l&&c&&u;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=s,this.wordBreak=r;let d=null;if(h){d=[];for(let f=0,g=this.modelLineProjections.length;f<g;f++)d[f]=this.modelLineProjections[f].getProjectionData()}return this._constructLines(!1,d),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,r=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new EF(s,r)}onModelLinesInserted(e,t,i,s){if(!e||e<=this._validModelVersionId)return null;const r=t>2&&!this.modelLineProjections[t-2].isVisible(),o=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let u=0,h=s.length;u<h;u++){const d=pR(s[u],!r);l.push(d);const f=d.getViewLineCount();a+=f,c[u]=f}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new TF(o,o+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const s=t-1,r=this.modelLineProjections[s].getViewLineCount(),o=this.modelLineProjections[s].isVisible(),a=pR(i,o);this.modelLineProjections[s]=a;const l=this.modelLineProjections[s].getViewLineCount();let c=!1,u=0,h=-1,d=0,f=-1,g=0,p=-1;r>l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=u+l-1,g=h+1,p=g+(r-l)-1,c=!0):r<l?(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=u+r-1,d=h+1,f=d+(l-r)-1,c=!0):(u=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=u+l-1),this.projectedModelLineLineCounts.setValue(s,l);const m=u<=h?new Yse(u,h-u+1):null,b=d<=f?new TF(d,f):null,v=g<=p?new EF(g,p):null;return[c,m,b,v]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const s=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(s.lineNumber,r.lineNumber,o.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,s=t.remainder;return new mj(i+1,s)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),s=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new X(e.modelLineNumber,s)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),s=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new X(e.modelLineNumber,s)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),s=this.getViewLineInfo(t),r=new Array;let o=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=s.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const u=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,h=l===s.modelLineNumber?s.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let d=u;d<h;d++)a.push(new mj(l,d))}if(!c.isVisible()&&o){const u=new X(l-1,this.model.getLineMaxColumn(l-1)+1),h=H.fromPositions(o,u);r.push(new _j(h,a)),a=[],o=null}else c.isVisible()&&!o&&(o=new X(l,1))}if(o){const l=H.fromPositions(o,this.getModelEndPositionOfViewLine(s));r.push(new _j(l,a))}return r}getViewLinesBracketGuides(e,t,i,s){const r=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,o=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,r,s);for(const u of a.viewLines){const d=c[u.modelLineNumber-l].map(f=>{if(f.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesAfterColumn).lineNumber>=u.modelLineWrappedLineIdx||f.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesBeforeOrAtColumn).lineNumber<u.modelLineWrappedLineIdx)return;if(!f.horizontalLine)return f;let g=-1;if(f.column!==-1){const b=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,f.column);if(b.lineNumber===u.modelLineWrappedLineIdx)g=b.column;else if(b.lineNumber<u.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(u);else if(b.lineNumber>u.modelLineWrappedLineIdx)return}const p=this.convertModelPositionToViewPosition(u.modelLineNumber,f.horizontalLine.endColumn),m=this.modelLineProjections[u.modelLineNumber-1].getViewPositionOfModelPosition(0,f.horizontalLine.endColumn);return m.lineNumber===u.modelLineWrappedLineIdx?new Ag(f.visibleColumn,g,f.className,new Zv(f.horizontalLine.top,p.column),-1,-1):m.lineNumber<u.modelLineWrappedLineIdx||f.visibleColumn!==-1?void 0:new Ag(f.visibleColumn,g,f.className,new Zv(f.horizontalLine.top,this.getMaxColumnOfViewLine(u)),-1,-1)});o.push(d.filter(f=>!!f))}}return o}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let r=[];const o=[],a=[],l=i.lineNumber-1,c=s.lineNumber-1;let u=null;for(let g=l;g<=c;g++){const p=this.modelLineProjections[g];if(p.isVisible()){const m=p.getViewLineNumberOfModelPosition(0,g===l?i.column:1),b=p.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),v=b-m+1;let w=0;v>1&&p.getViewLineMinColumn(this.model,g+1,b)===1&&(w=m===0?1:2),o.push(v),a.push(w),u===null&&(u=new X(g+1,0))}else u!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,g)),u=null)}u!==null&&(r=r.concat(this.model.guides.getLinesIndentGuides(u.lineNumber,s.lineNumber)),u=null);const h=t-e+1,d=new Array(h);let f=0;for(let g=0,p=r.length;g<p;g++){let m=r[g];const b=Math.min(h-f,o[g]),v=a[g];let w;v===2?w=0:v===1?w=1:w=b;for(let y=0;y<b;y++)y===w&&(m=0),d[f++]=m}return d}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const s=this.projectedModelLineLineCounts.getIndexOf(e-1);let r=e;const o=s.index,a=s.remainder,l=[];for(let c=o,u=this.model.getLineCount();c<u;c++){const h=this.modelLineProjections[c];if(!h.isVisible())continue;const d=c===o?a:0;let f=h.getViewLineCount()-d,g=!1;if(r+f>t&&(g=!0,f=t-r+1),h.getViewLinesData(this.model,c+1,d,f,r-e,i,l),r+=f,g)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const s=this.projectedModelLineLineCounts.getIndexOf(e-1),r=s.index,o=s.remainder,a=this.modelLineProjections[r],l=a.getViewLineMinColumn(this.model,r+1,o),c=a.getViewLineMaxColumn(this.model,r+1,o);t<l&&(t=l),t>c&&(t=c);const u=a.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new X(r+1,u)).equals(i)?new X(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),s=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new H(i.lineNumber,i.column,s.lineNumber,s.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),s=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new X(i.modelLineNumber,s))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new H(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,s=!1,r=!1){const o=this.model.validatePosition(new X(e,t)),a=o.lineNumber,l=o.column;let c=a-1,u=!1;if(r)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,u=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,u=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new X(s?0:1,1);const h=1+this.projectedModelLineLineCounts.getPrefixSum(c);let d;return u?r?d=this.modelLineProjections[c].getViewPositionOfModelPosition(h,1,i):d=this.modelLineProjections[c].getViewPositionOfModelPosition(h,this.model.getLineMaxColumn(c+1),i):d=this.modelLineProjections[a-1].getViewPositionOfModelPosition(h,l,i),d}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return H.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),s=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new H(i.lineNumber,i.column,s.lineNumber,s.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const r=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(r,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const s=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(s,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,s,r){const o=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-o.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new H(o.lineNumber,1,a.lineNumber,a.column),t,i,s,r);let l=[];const c=o.lineNumber-1,u=a.lineNumber-1;let h=null;for(let p=c;p<=u;p++)if(this.modelLineProjections[p].isVisible())h===null&&(h=new X(p+1,p===c?o.column:1));else if(h!==null){const b=this.model.getLineMaxColumn(p);l=l.concat(this.model.getDecorationsInRange(new H(h.lineNumber,h.column,p,b),t,i,s)),h=null}h!==null&&(l=l.concat(this.model.getDecorationsInRange(new H(h.lineNumber,h.column,a.lineNumber,a.column),t,i,s)),h=null),l.sort((p,m)=>{const b=H.compareRangesUsingStarts(p.range,m.range);return b===0?p.id<m.id?-1:p.id>m.id?1:0:b});const d=[];let f=0,g=null;for(const p of l){const m=p.id;g!==m&&(g=m,d[f++]=p)}return d}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function u8e(n){if(n.length===0)return[];const e=n.slice();e.sort(H.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,s=e[0].endLineNumber;for(let r=1,o=e.length;r<o;r++){const a=e[r];a.startLineNumber>s+1?(t.push(new H(i,1,s,1)),i=a.startLineNumber,s=a.endLineNumber):a.endLineNumber>s&&(s=a.endLineNumber)}return t.push(new H(i,1,s,1)),t}class mj{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class _j{constructor(e,t){this.modelRange=e,this.viewLines=t}}class h8e{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,s){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,s)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class d8e{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new f8e(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,s){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,s)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new EF(t,i)}onModelLinesInserted(e,t,i,s){return new TF(t,i)}onModelLineChanged(e,t,i){return[!1,new Yse(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,s=new Array(i);for(let r=0;r<i;r++)s[r]=0;return s}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new F8(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const s=this.model.getLineCount();e=Math.min(Math.max(1,e),s),t=Math.min(Math.max(1,t),s);const r=[];for(let o=e;o<=t;o++){const a=o-e;r[a]=i[a]?this.getViewLineData(o):null}return r}getDecorationsInRange(e,t,i,s,r){return this.model.getDecorationsInRange(e,t,i,s,r)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class f8e{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}let g8e=class extends ae{constructor(e,t,i,s,r,o,a,l,c){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this.hiddenAreasModel=new m8e,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new F6e,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Bm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Ui(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=d7.create(this.model),this.model.isTooLargeForTokenization())this._lines=new d8e(this.model);else{const u=this._configuration.options,h=u.get(50),d=u.get(137),f=u.get(144),g=u.get(136),p=u.get(128);this._lines=new c8e(this._editorId,this.model,s,r,h,this.model.getOptions().tabSize,d,f.wrappingColumn,g,p)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new q6e(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new i8e(this._configuration,this.getLineCount(),o)),this._register(this.viewLayout.onDidScroll(u=>{u.scrollTopChanged&&this._handleVisibleLinesChanged(),u.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new A6e(u)),this._eventDispatcher.emitOutgoingEvent(new h7(u.oldScrollWidth,u.oldScrollLeft,u.oldScrollHeight,u.oldScrollTop,u.scrollWidth,u.scrollLeft,u.scrollHeight,u.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(u=>{this._eventDispatcher.emitOutgoingEvent(u)})),this._decorations=new n8e(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(u=>{try{const h=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(h,u)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(SS.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new R6e)})),this._register(this._themeService.onDidColorThemeChange(u=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new I6e(u))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new H(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new E6e(e)),this._eventDispatcher.emitOutgoingEvent(new u7(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new x6e)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new k6e)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new X(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new vj(t,this._viewportStart.startLineDelta)}return new vj(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),s=this._configuration.options,r=s.get(50),o=s.get(137),a=s.get(144),l=s.get(136),c=s.get(128);this._lines.setWrappingSettings(r,o,a.wrappingColumn,l,c)&&(e.emitViewEvent(new Wx),e.emitViewEvent(new Vx),e.emitViewEvent(new zm(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(90)&&(this._decorations.reset(),e.emitViewEvent(new zm(null))),e.emitViewEvent(new L6e(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),Bm.shouldRecreate(t)&&(this.cursorConfig=new Bm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let s=!1,r=!1;const o=e instanceof Zg?e.rawContentChangedEvent.changes:e.changes,a=e instanceof Zg?e.rawContentChangedEvent.versionId:null,l=this._lines.createLineBreaksComputer();for(const h of o)switch(h.changeType){case 4:{for(let d=0;d<h.detail.length;d++){const f=h.detail[d];let g=h.injectedTexts[d];g&&(g=g.filter(p=>!p.ownerId||p.ownerId===this._editorId)),l.addRequest(f,g,null)}break}case 2:{let d=null;h.injectedText&&(d=h.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),l.addRequest(h.detail,d,null);break}}const c=l.finalize(),u=new th(c);for(const h of o)switch(h.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new Wx),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),s=!0;break}case 3:{const d=this._lines.onModelLinesDeleted(a,h.fromLineNumber,h.toLineNumber);d!==null&&(i.emitViewEvent(d),this.viewLayout.onLinesDeleted(d.fromLineNumber,d.toLineNumber)),s=!0;break}case 4:{const d=u.takeCount(h.detail.length),f=this._lines.onModelLinesInserted(a,h.fromLineNumber,h.toLineNumber,d);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),s=!0;break}case 2:{const d=u.dequeue(),[f,g,p,m]=this._lines.onModelLineChanged(a,h.lineNumber,d);r=f,g&&i.emitViewEvent(g),p&&(i.emitViewEvent(p),this.viewLayout.onLinesInserted(p.fromLineNumber,p.toLineNumber)),m&&(i.emitViewEvent(m),this.viewLayout.onLinesDeleted(m.fromLineNumber,m.toLineNumber));break}case 5:break}a!==null&&this._lines.acceptVersionId(a),this.viewLayout.onHeightMaybeChanged(),!s&&r&&(i.emitViewEvent(new Vx),i.emitViewEvent(new zm(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const t=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&t){const i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){const s=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),r=this.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber);this.viewLayout.setScrollPosition({scrollTop:r+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();e instanceof Zg&&i.emitOutgoingEvent(new H6e(e.contentChangedEvent)),this._cursor.onModelContentChanged(i,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{const t=[];for(let i=0,s=e.ranges.length;i<s;i++){const r=e.ranges[i],o=this.coordinatesConverter.convertModelPositionToViewPosition(new X(r.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new X(r.toLineNumber,this.model.getLineMaxColumn(r.toLineNumber))).lineNumber;t[i]={fromLineNumber:o,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new N6e(t)),this._eventDispatcher.emitOutgoingEvent(new j6e(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new T6e),this.cursorConfig=new Bm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new z6e(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Bm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new $6e(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new Wx),t.emitViewEvent(new Vx),t.emitViewEvent(new zm(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Bm(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new U6e(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new zm(e)),this._eventDispatcher.emitOutgoingEvent(new V6e(e))}))}setHiddenAreas(e,t){this.hiddenAreasModel.setHiddenAreas(t,e);const i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;const s=this._captureStableViewport();let r=!1;try{const o=this._eventDispatcher.beginEmitViewEvents();r=this._lines.setHiddenAreas(i),r&&(o.emitViewEvent(new Wx),o.emitViewEvent(new Vx),o.emitViewEvent(new zm(null)),this._cursor.onLineMappingChanged(o),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged()),s.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),r&&this._eventDispatcher.emitOutgoingEvent(new B6e)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(143),t=this._configuration.options.get(66),i=Math.max(20,Math.round(e.height/t)),s=this.viewLayout.getLinesViewportData(),r=Math.max(1,s.completelyVisibleStartLineNumber-i),o=Math.min(this.getLineCount(),s.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new H(r,this.getLineMinColumn(r),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const s=[];let r=0,o=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let u=0,h=i.length;u<h;u++){const d=i[u].startLineNumber,f=i[u].endLineNumber;f<o||d>l||(o<d&&(s[r++]=new H(o,a,d-1,this.model.getLineMaxColumn(d-1))),o=f+1,a=1)}return(o<l||o===l&&a<c)&&(s[r++]=new H(o,a,l,c)),s}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new H(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,s=t.completelyVisibleEndLineNumber;return new H(i,this.getLineMinColumn(i),s,this.getLineMaxColumn(s))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),s=this.coordinatesConverter.convertViewPositionToModelPosition(new X(i,this.getLineMinColumn(i))),r=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:s,firstPositionDeltaTop:r}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),s=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:s}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,s){return this._lines.getViewLinesBracketGuides(e,t,i,s)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Pr(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=tm(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,t){const s=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,s)}getViewLineRenderingData(e){const t=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,t)}_getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),s=this.model.mightContainNonBasicASCII(),r=this.getTabSize(),o=this._lines.getViewLineData(e);return o.inlineDecorations&&(t=[...t,...o.inlineDecorations.map(a=>a.toInlineDecoration(e))]),new wo(o.minColumn,o.maxColumn,o.content,o.continuesWithWrappedLine,i,s,o.tokens,t,r,o.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const s=this._lines.getViewLinesData(e,t,i);return new d4e(this.getTabSize(),s)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,DL(this._configuration.options)),i=new p8e;for(const s of t){const r=s.options,o=r.overviewRuler;if(!o)continue;const a=o.position;if(a===0)continue;const l=o.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.startLineNumber,s.range.startColumn),u=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.endLineNumber,s.range.endColumn);i.accept(l,r.zIndex,c,u,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const s=t.options.minimap;s==null||s.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e);return this.model.modifyPosition(i,t)}deduceModelPositionRelativeToViewPosition(e,t,i){const s=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(s)+t;return this.model.getPositionAt(o)}getPlainTextToCopy(e,t,i){const s=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(H.compareRangesUsingStarts);let r=!1,o=!1;for(const l of e)l.isEmpty()?r=!0:o=!0;if(!o){if(!t)return"";const l=e.map(u=>u.startLineNumber);let c="";for(let u=0;u<l.length;u++)u>0&&l[u-1]===l[u]||(c+=this.model.getLineContent(l[u])+s);return c}if(r&&t){const l=[];let c=0;for(const u of e){const h=u.startLineNumber;u.isEmpty()?h!==c&&l.push(this.model.getLineContent(h)):l.push(this.model.getValueInRange(u,i?2:0)),c=h}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===Bo||e.length!==1)return null;let s=e[0];if(s.isEmpty()){if(!t)return null;const u=s.startLineNumber;s=new H(u,this.model.getLineMinColumn(u),u,this.model.getLineMaxColumn(u))}const r=this._configuration.options.get(50),o=this._getColorMap(),l=/[:;\\\/<>]/.test(r.fontFamily)||r.fontFamily===Oo.fontFamily;let c;return l?c=Oo.fontFamily:(c=r.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Oo.fontFamily}`),{mode:i,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${c};font-weight: ${r.fontWeight};font-size: ${r.fontSize}px;line-height: ${r.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(s,o)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,s=e.startColumn,r=e.endLineNumber,o=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=r;c++){const u=this.model.tokenization.getLineTokens(c),h=u.getLineContent(),d=c===i?s-1:0,f=c===r?o-1:h.length;h===""?l+="<br>":l+=X6e(h,u.inflate(),t,d,f,a,br)}return l}_getColorMap(){const e=$i.getColorMap(),t=["#000000"];if(e)for(let i=1,s=e.length;i<s;i++)t[i]=J.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(s=>this._cursor.setStates(s,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(s=>this._cursor.setSelections(s,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new W6e);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(s=>this._cursor.executeEdits(s,e,t,i))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,s,r){this._executeCursorEdit(o=>this._cursor.compositionType(o,e,t,i,s,r))}paste(e,t,i,s){this._executeCursorEdit(r=>this._cursor.paste(r,e,t,i,s))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(s=>this._cursor.revealPrimary(s,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new H(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(s=>s.emitViewEvent(new ak(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new H(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(s=>s.emitViewEvent(new ak(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,s,r){this._withViewEventsCollector(o=>o.emitViewEvent(new ak(e,!1,i,null,s,t,r)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new M6e),this._eventDispatcher.emitOutgoingEvent(new O6e))}_withViewEventsCollector(e){try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class d7{static create(e){const t=e._setTrackedRange(null,new H(1,1,1,1),1);return new d7(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,s,r){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=s,this._startLineDelta=r}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new X(t,e.getLineMinColumn(t))),s=e.model._setTrackedRange(this._modelTrackedRange,new H(i.lineNumber,i.column,i.lineNumber,i.column),1),r=e.viewLayout.getVerticalOffsetForLineNumber(t),o=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=s,this._startLineDelta=o-r}invalidate(){this._isValid=!1}}class p8e{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,s,r){const o=this._asMap[e];if(o){const a=o.data,l=a[a.length-3],c=a[a.length-1];if(l===r&&c+1>=i){s>c&&(a[a.length-1]=s);return}a.push(r,i,s)}else{const a=new Cy(e,t,[r,i,s]);this._asMap[e]=a,this.asArray.push(a)}}}class m8e{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&bj(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>_8e(t,i),[]);return bj(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function _8e(n,e){const t=[];let i=0,s=0;for(;i<n.length&&s<e.length;){const r=n[i],o=e[s];if(r.endLineNumber<o.startLineNumber-1)t.push(n[i++]);else if(o.endLineNumber<r.startLineNumber-1)t.push(e[s++]);else{const a=Math.min(r.startLineNumber,o.startLineNumber),l=Math.max(r.endLineNumber,o.endLineNumber);t.push(new H(a,1,l,1)),i++,s++}}for(;i<n.length;)t.push(n[i++]);for(;s<e.length;)t.push(e[s++]);return t}function bj(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].equalsRange(e[t]))return!1;return!0}class vj{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),s=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:s+this.startLineDelta},1)}}class GT{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var $y;(function(n){n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})($y||($y={}));(function(n){const e="error",t="warning",i="warn",s="info",r="ignore";function o(l){return l?h0(e,l)?n.Error:h0(t,l)||h0(i,l)?n.Warning:h0(s,l)?n.Info:n.Ignore:n.Ignore}n.fromValue=o;function a(l){switch(l){case n.Error:return e;case n.Warning:return t;case n.Info:return s;default:return r}}n.toString=a})($y||($y={}));const Fi=$y;var Jse=Fi;const ts=kt("notificationService");class b8e{}class sw{constructor(e,t,i,s,r){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=s,this.wrappedTextIndentLength=r}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let s=this.breakOffsets[e]-t;return e>0&&(s+=this.wrappedTextIndentLength),s}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let s=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&s>this.injectionOffsets[r];r++)s<this.injectionOffsets[r]+this.injectionOptions[r].content.length?s=this.injectionOffsets[r]:s-=this.injectionOptions[r].content.length;return s}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let s=0;s<this.injectionOffsets.length&&!(e<this.injectionOffsets[s]||t!==1&&e===this.injectionOffsets[s]);s++)i+=this.injectionOptions[s].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,s=this.breakOffsets.length-1,r=0,o=0;for(;i<=s;){r=i+(s-i)/2|0;const l=this.breakOffsets[r];if(o=r>0?this.breakOffsets[r-1]:0,t===0)if(e<=o)s=r-1;else if(e>l)i=r+1;else break;else if(e<o)s=r-1;else if(e>=l)i=r+1;else break}let a=e-o;return r>0&&(a+=this.wrappedTextIndentLength),new $x(r,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const s=this.outputPositionToOffsetInInputWithInjections(e,t),r=this.normalizeOffsetInInputWithInjectionsAroundInjections(s,i);if(r!==s)return this.offsetInInputWithInjectionsToOutputPosition(r,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new $x(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const s=this.getOutputLineCount()-1;if(e<s&&t===this.getMaxOutputOffset(e))return new $x(e+1,this.getMinOutputOffset(e+1))}return new $x(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&wj(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let s=i.offsetInInputWithInjections;if(yj(this.injectionOptions[i.injectedTextIndex].cursorStops))return s;let r=i.injectedTextIndex-1;for(;r>=0&&this.injectionOffsets[r]===this.injectionOffsets[i.injectedTextIndex]&&!(wj(this.injectionOptions[r].cursorStops)||(s-=this.injectionOptions[r].content.length,yj(this.injectionOptions[r].cursorStops)));)r--;return s}}else if(t===1||t===4){let s=i.offsetInInputWithInjections+i.length,r=i.injectedTextIndex;for(;r+1<this.injectionOffsets.length&&this.injectionOffsets[r+1]===this.injectionOffsets[r];)s+=this.injectionOptions[r+1].content.length,r++;return s}else if(t===0||t===3){let s=i.offsetInInputWithInjections,r=i.injectedTextIndex;for(;r-1>=0&&this.injectionOffsets[r-1]===this.injectionOffsets[r];)s-=this.injectionOptions[r-1].content.length,r--;return s}v8()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),s=this.getInjectedTextAtOffset(i);return s?{options:this.injectionOptions[s.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let s=0;for(let r=0;r<t.length;r++){const o=i[r].content.length,a=t[r]+s,l=t[r]+s+o;if(a>e)break;if(e<=l)return{injectedTextIndex:r,offsetInInputWithInjections:a,length:o};s+=o}}}}function wj(n){return n==null?!0:n===nb.Right||n===nb.Both}function yj(n){return n==null?!0:n===nb.Left||n===nb.Both}class $x{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new X(e+this.outputLineIndex,this.outputOffset+1)}}class f7{static create(e){return new f7(e.get(132),e.get(131))}constructor(e,t){this.classifier=new v8e(e,t)}createLineBreaksComputer(e,t,i,s,r){const o=[],a=[],l=[];return{addRequest:(c,u,h)=>{o.push(c),a.push(u),l.push(h)},finalize:()=>{const c=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,u=[];for(let h=0,d=o.length;h<d;h++){const f=a[h],g=l[h];g&&!g.injectionOptions&&!f?u[h]=w8e(this.classifier,g,o[h],t,i,c,s,r):u[h]=y8e(this.classifier,o[h],f,t,i,c,s,r)}return IF.length=0,NF.length=0,u}}}}class v8e extends pS{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let IF=[],NF=[];function w8e(n,e,t,i,s,r,o,a){if(s===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",u=e.breakOffsets,h=e.breakOffsetsVisibleColumn,d=ere(t,i,s,r,o),f=s-d,g=IF,p=NF;let m=0,b=0,v=0,w=s;const y=u.length;let x=0;if(x>=0){let D=Math.abs(h[x]-w);for(;x+1<y;){const S=Math.abs(h[x+1]-w);if(S>=D)break;D=S,x++}}for(;x<y;){let D=x<0?0:u[x],S=x<0?0:h[x];b>D&&(D=b,S=v);let T=0,k=0,I=0,N=0;if(S<=w){let $=S,q=D===0?0:t.charCodeAt(D-1),ne=D===0?0:n.get(q),de=!0;for(let me=D;me<l;me++){const De=me,ve=t.charCodeAt(me);let $e,Ne;if(Dn(ve)?(me++,$e=0,Ne=2):($e=n.get(ve),Ne=rw(ve,$,i,r)),De>b&&RF(q,ne,ve,$e,c)&&(T=De,k=$),$+=Ne,$>w){De>b?(I=De,N=$-Ne):(I=me+1,N=$),$-k>f&&(T=0),de=!1;break}q=ve,ne=$e}if(de){m>0&&(g[m]=u[u.length-1],p[m]=h[u.length-1],m++);break}}if(T===0){let $=S,q=t.charCodeAt(D),ne=n.get(q),de=!1;for(let me=D-1;me>=b;me--){const De=me+1,ve=t.charCodeAt(me);if(ve===9){de=!0;break}let $e,Ne;if(Y_(ve)?(me--,$e=0,Ne=2):($e=n.get(ve),Ne=Jd(ve)?r:1),$<=w){if(I===0&&(I=De,N=$),$<=w-f)break;if(RF(ve,$e,q,ne,c)){T=De,k=$;break}}$-=Ne,q=ve,ne=$e}if(T!==0){const me=f-(N-k);if(me<=i){const De=t.charCodeAt(I);let ve;Dn(De)?ve=2:ve=rw(De,N,i,r),me-ve<0&&(T=0)}}if(de){x--;continue}}if(T===0&&(T=I,k=N),T<=b){const $=t.charCodeAt(b);Dn($)?(T=b+2,k=v+2):(T=b+1,k=v+rw($,v,i,r))}for(b=T,g[m]=T,v=k,p[m]=k,m++,w=k+f;x<0||x<y&&h[x]<k;)x++;let z=Math.abs(h[x]-w);for(;x+1<y;){const $=Math.abs(h[x+1]-w);if($>=z)break;z=$,x++}}return m===0?null:(g.length=m,p.length=m,IF=e.breakOffsets,NF=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=p,e.wrappedTextIndentLength=d,e)}function y8e(n,e,t,i,s,r,o,a){const l=Sl.applyInjectedText(e,t);let c,u;if(t&&t.length>0?(c=t.map(k=>k.options),u=t.map(k=>k.column-1)):(c=null,u=null),s===-1)return c?new sw(u,c,[l.length],[],0):null;const h=l.length;if(h<=1)return c?new sw(u,c,[l.length],[],0):null;const d=a==="keepAll",f=ere(l,i,s,r,o),g=s-f,p=[],m=[];let b=0,v=0,w=0,y=s,x=l.charCodeAt(0),D=n.get(x),S=rw(x,0,i,r),T=1;Dn(x)&&(S+=1,x=l.charCodeAt(1),D=n.get(x),T++);for(let k=T;k<h;k++){const I=k,N=l.charCodeAt(k);let z,$;Dn(N)?(k++,z=0,$=2):(z=n.get(N),$=rw(N,S,i,r)),RF(x,D,N,z,d)&&(v=I,w=S),S+=$,S>y&&((v===0||S-w>g)&&(v=I,w=S-$),p[b]=v,m[b]=w,b++,y=w+g,v=0),x=N,D=z}return b===0&&(!t||t.length===0)?null:(p[b]=h,m[b]=S,new sw(u,c,p,m,f))}function rw(n,e,t,i){return n===9?t-e%t:Jd(n)||n<32?i:1}function Cj(n,e){return e-n%e}function RF(n,e,t,i,s){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!s&&e===3&&i!==2||!s&&i===3&&e!==1)}function ere(n,e,t,i,s){let r=0;if(s!==0){const o=Pr(n);if(o!==-1){for(let l=0;l<o;l++){const c=n.charCodeAt(l)===9?Cj(r,e):1;r+=c}const a=s===3?2:s===2?1:0;for(let l=0;l<a;l++){const c=Cj(r,e);r+=c}r+i>t&&(r=0)}}return r}const _R=rm("domLineBreaksComputer",{createHTML:n=>n});class g7{static create(){return new g7}constructor(){}createLineBreaksComputer(e,t,i,s,r){const o=[],a=[];return{addRequest:(l,c,u)=>{o.push(l),a.push(c)},finalize:()=>C8e(o,e,t,i,s,r,a)}}}function C8e(n,e,t,i,s,r,o){var a;function l(k){const I=o[k];if(I){const N=Sl.applyInjectedText(n[k],I),z=I.map(q=>q.options),$=I.map(q=>q.column-1);return new sw($,z,[N.length],[],0)}else return null}if(i===-1){const k=[];for(let I=0,N=n.length;I<N;I++)k[I]=l(I);return k}const c=Math.round(i*e.typicalHalfwidthCharacterWidth),h=Math.round(t*(s===3?2:s===2?1:0)),d=Math.ceil(e.spaceWidth*h),f=document.createElement("div");fs(f,e);const g=new ET(1e4),p=[],m=[],b=[],v=[],w=[];for(let k=0;k<n.length;k++){const I=Sl.applyInjectedText(n[k],o[k]);let N=0,z=0,$=c;if(s!==0)if(N=Pr(I),N===-1)N=0;else{for(let me=0;me<N;me++){const De=I.charCodeAt(me)===9?t-z%t:1;z+=De}const de=Math.ceil(e.spaceWidth*z);de+e.typicalFullwidthCharacterWidth>c?(N=0,z=0):$=c-de}const q=I.substr(N),ne=S8e(q,z,t,$,g,d);p[k]=N,m[k]=z,b[k]=q,v[k]=ne[0],w[k]=ne[1]}const y=g.build(),x=(a=_R==null?void 0:_R.createHTML(y))!==null&&a!==void 0?a:y;f.innerHTML=x,f.style.position="absolute",f.style.top="10000",r==="keepAll"?(f.style.wordBreak="keep-all",f.style.overflowWrap="anywhere"):(f.style.wordBreak="inherit",f.style.overflowWrap="break-word"),document.body.appendChild(f);const D=document.createRange(),S=Array.prototype.slice.call(f.children,0),T=[];for(let k=0;k<n.length;k++){const I=S[k],N=x8e(D,I,b[k],v[k]);if(N===null){T[k]=l(k);continue}const z=p[k],$=m[k]+h,q=w[k],ne=[];for(let ve=0,$e=N.length;ve<$e;ve++)ne[ve]=q[N[ve]];if(z!==0)for(let ve=0,$e=N.length;ve<$e;ve++)N[ve]+=z;let de,me;const De=o[k];De?(de=De.map(ve=>ve.options),me=De.map(ve=>ve.column-1)):(de=null,me=null),T[k]=new sw(me,de,N,ne,$)}return document.body.removeChild(f),T}function S8e(n,e,t,i,s,r){if(r!==0){const d=String(r);s.appendString('<div style="text-indent: -'),s.appendString(d),s.appendString("px; padding-left: "),s.appendString(d),s.appendString("px; box-sizing: border-box; width:")}else s.appendString('<div style="width:');s.appendString(String(i)),s.appendString('px;">');const o=n.length;let a=e,l=0;const c=[],u=[];let h=0<o?n.charCodeAt(0):0;s.appendString("<span>");for(let d=0;d<o;d++){d!==0&&d%16384===0&&s.appendString("</span><span>"),c[d]=l,u[d]=a;const f=h;h=d+1<o?n.charCodeAt(d+1):0;let g=1,p=1;switch(f){case 9:g=t-a%t,p=g;for(let m=1;m<=g;m++)m<g?s.appendCharCode(160):s.appendASCIICharCode(32);break;case 32:h===32?s.appendCharCode(160):s.appendASCIICharCode(32);break;case 60:s.appendString("&lt;");break;case 62:s.appendString("&gt;");break;case 38:s.appendString("&amp;");break;case 0:s.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:s.appendCharCode(65533);break;default:Jd(f)&&p++,f<32?s.appendCharCode(9216+f):s.appendCharCode(f)}l+=g,a+=p}return s.appendString("</span>"),c[n.length]=l,u[n.length]=a,s.appendString("</div>"),[c,u]}function x8e(n,e,t,i){if(t.length<=1)return null;const s=Array.prototype.slice.call(e.children,0),r=[];try{MF(n,s,i,0,null,t.length-1,null,r)}catch(o){return console.log(o),null}return r.length===0?null:(r.push(t.length),r)}function MF(n,e,t,i,s,r,o,a){if(i===r||(s=s||bR(n,e,t[i],t[i+1]),o=o||bR(n,e,t[r],t[r+1]),Math.abs(s[0].top-o[0].top)<=.1))return;if(i+1===r){a.push(r);return}const l=i+(r-i)/2|0,c=bR(n,e,t[l],t[l+1]);MF(n,e,t,i,s,l,c,a),MF(n,e,t,l,c,r,o,a)}function bR(n,e,t,i){return n.setStart(e[t/16384|0].firstChild,t%16384),n.setEnd(e[i/16384|0].firstChild,i%16384),n.getClientRects()}class k8e extends ae{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new i8),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const s of t){if(this._pending.has(s.id)){Ft(new Error(`Cannot have two contributions with the same id ${s.id}`));continue}this._pending.set(s.id,s)}this._instantiateSome(0),this._register(od(()=>{this._instantiateSome(1)})),this._register(od(()=>{this._instantiateSome(2)})),this._register(od(()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register(od(()=>{this._instantiateSome(1)},50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Ft(i)}}}}var L8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},su=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},D8e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},Qf;let E8e=0,T8e=class{constructor(e,t,i,s,r,o){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=s,this.listenersToRemove=r,this.attachedView=o}dispose(){ti(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}},db=Qf=class extends ae{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,t,i,s,r,o,a,l,c,u,h,d){var f;super(),this.languageConfigurationService=h,this._deliveryQueue=gAe(),this._contributions=this._register(new k8e),this._onDidDispose=this._register(new G),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new Sj({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new Sj({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new ws(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new ws(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new ws(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new ws(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new ws(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new ws(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new G({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),r.willCreateCodeEditor();const g=Object.assign({},t);this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++E8e,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,g,u)),this._register(this._configuration.onDidChange(b=>{this._onDidChangeConfiguration.fire(b);const v=this._configuration.options;if(b.hasChanged(143)){const w=v.get(143);this._onDidLayoutChange.fire(w)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=r,this._commandService=o,this._themeService=l,this._register(new A8e(this,this._contextKeyService)),this._register(new I8e(this,this._contextKeyService,d)),this._instantiationService=s.createChild(new GT([_t,this._contextKeyService])),this._modelData=null,this._focusTracker=new N8e(e),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let p;Array.isArray(i.contributions)?p=i.contributions:p=Z0.getEditorContributions(),this._contributions.initialize(this,p,this._instantiationService);for(const b of Z0.getEditorActions()){if(this._actions.has(b.id)){Ft(new Error(`Cannot have two actions with the same id ${b.id}`));continue}const v=new Nse(b.id,b.label,b.alias,(f=b.precondition)!==null&&f!==void 0?f:void 0,()=>this._instantiationService.invokeFunction(w=>Promise.resolve(b.runEditorCommand(w,this,null))),this._contextKeyService);this._actions.set(v.id,v)}const m=()=>!this._configuration.options.get(90)&&this._configuration.options.get(36).enabled;this._register(new RNe(this._domElement,{onDragEnter:()=>{},onDragOver:b=>{if(!m())return;const v=this.getTargetAtClientPoint(b.clientX,b.clientY);v!=null&&v.position&&this.showDropIndicatorAt(v.position)},onDrop:b=>D8e(this,void 0,void 0,function*(){if(!m()||(this.removeDropIndicator(),!b.dataTransfer))return;const v=this.getTargetAtClientPoint(b.clientX,b.clientY);v!=null&&v.position&&this._onDropIntoEditor.fire({position:v.position,event:b})}),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)===null||t===void 0||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i){return new lF(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return MT.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Wi.getWordAtPosition(this._modelData.model,this._configuration.options.get(129),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(this._modelData===null&&t===null||this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),s=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const r={oldModelUrl:s?s.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(r),this._postDetachModelCleanup(s),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,s){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(o.lineNumber,s)}getTopForLineNumber(e,t=!1){return this._modelData?Qf._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?Qf._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,s=!1){const r=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber,s)}getBottomForLineNumber(e,t=!1){return this._modelData?Qf._getVerticalOffsetAfterPosition(this._modelData,e,1,t):-1}setHiddenAreas(e,t){var i;(i=this._modelData)===null||i===void 0||i.viewModel.setHiddenAreas(e.map(s=>H.lift(s)),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return _n.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!X.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,s){if(!this._modelData)return;if(!H.isIRange(e))throw new Error("Invalid arguments");const r=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(r);this._modelData.viewModel.revealRange("api",i,o,t,s)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new H(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,s){if(!X.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new H(e.lineNumber,e.column,e.lineNumber,e.column),t,i,s)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=Lt.isISelection(e),s=H.isIRange(e);if(!i&&!s)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(s){const r={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(r,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new Lt(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,s){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new H(e,1,t,1),i,!1,s)}revealRange(e,t=0,i=!1,s=!0){this._revealRange(e,i?1:0,s,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,s){if(!H.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(H.lift(e),t,i,s)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let s=0,r=e.length;s<r;s++)if(!Lt.isISelection(e[s]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const s=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(s)}}handleInitialized(){var e;(e=this._getViewModel())===null||e===void 0||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const r=i;this._type(e,r.text||"");return}case"replacePreviousChar":{const r=i;this._compositionType(e,r.text||"",r.replaceCharCnt||0,0,0);return}case"compositionType":{const r=i;this._compositionType(e,r.text||"",r.replacePrevCharCnt||0,r.replaceNextCharCnt||0,r.positionDelta||0);return}case"paste":{const r=i;this._paste(e,r.text||"",r.pasteOnNewLine||!1,r.multicursorText||null,r.mode||null);return}case"cut":this._cut(e);return}const s=this.getAction(t);if(s){Promise.resolve(s.run(i)).then(void 0,Ft);return}this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,s,r){this._modelData&&this._modelData.viewModel.compositionType(t,i,s,r,e)}_paste(e,t,i,s,r){if(!this._modelData||t.length===0)return;const o=this._modelData.viewModel,a=o.getSelection().getStartPosition();o.paste(t,i,s,e);const l=o.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({range:new H(a.lineNumber,a.column,l.lineNumber,l.column),languageId:r})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const s=Z0.getEditorCommand(t);return s?(i=i||{},i.source=e,this._instantiationService.invokeFunction(r=>{Promise.resolve(s.runEditorCommand(r,this,i)).then(void 0,Ft)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(90)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(90)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(90))return!1;let s;return i?Array.isArray(i)?s=()=>i:s=i:s=()=>null,this._modelData.viewModel.executeEdits(e,t,s),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new R8e(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,DL(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,DL(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(143)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,s=i.get(143),r=Qf._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),o=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+s.glyphMarginWidth+s.lineNumbersWidth+s.decorationsWidth-this.getScrollLeft();return{top:r,left:o,height:i.get(66)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.view.render(!0,e)}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){fs(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),s=new g8e(this._id,this._configuration,e,g7.create(),f7.create(this._configuration.options),a=>$o(a),this.languageConfigurationService,this._themeService,i);t.push(e.onWillDispose(()=>this.setModel(null))),t.push(s.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._onDidScrollChange.fire(a);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(a.reachedMaxCursorCount){const h=this.getOption(79),d=_("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(Jse.Warning,d,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:_("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let h=0,d=a.selections.length;h<d;h++)l[h]=a.selections[h].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const u={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(u);break}case 7:this._onDidChangeModelDecorations.fire(a.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 10:this._onDidChangeModelContent.fire(a.event);break;case 11:this._onDidChangeModelOptions.fire(a.event);break;case 12:this._onDidChangeModelTokens.fire(a.event);break}}));const[r,o]=this._createView(s);if(o){this._domElement.appendChild(r.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addContentWidget(this._contentWidgets[u])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addOverlayWidget(this._overlayWidgets[u])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const u=a[l];r.addGlyphMarginWidget(this._glyphMarginWidgets[u])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new T8e(e,s,r,o,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(r,o,a,l)=>{this._paste("keyboard",r,o,a,l)},type:r=>{this._type("keyboard",r)},compositionType:(r,o,a,l)=>{this._compositionType("keyboard",r,o,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(r,o,a,l)=>{const c={text:r,pasteOnNewLine:o,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:r=>{const o={text:r};this._commandService.executeCommand("type",o)},compositionType:(r,o,a,l)=>{if(a||l){const c={text:r,replacePrevCharCnt:o,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:r,replaceCharCnt:o};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new HT(e.coordinatesConverter);return i.onKeyDown=r=>this._onKeyDown.fire(r),i.onKeyUp=r=>this._onKeyUp.fire(r),i.onContextMenu=r=>this._onContextMenu.fire(r),i.onMouseMove=r=>this._onMouseMove.fire(r),i.onMouseLeave=r=>this._onMouseLeave.fire(r),i.onMouseDown=r=>this._onMouseDown.fire(r),i.onMouseUp=r=>this._onMouseUp.fire(r),i.onMouseDrag=r=>this._onMouseDrag.fire(r),i.onMouseDrop=r=>this._onMouseDrop.fire(r),i.onMouseDropCanceled=r=>this._onMouseDropCanceled.fire(r),i.onMouseWheel=r=>this._onMouseWheel.fire(r),[new wF(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new H(e.lineNumber,e.column,e.lineNumber,e.column),options:Qf.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}};db.dropIntoEditorDecorationOptions=mt.register({description:"workbench-dnd-target",className:"dnd-target"});db=Qf=L8e([su(3,Wt),su(4,ci),su(5,Ys),su(6,_t),su(7,qr),su(8,ts),su(9,Lf),su(10,Ur),su(11,wt)],db);class Sj extends ae{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new G(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new G(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class ws extends G{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class A8e extends ae{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=ee.editorSimpleInput.bindTo(t),this._editorFocus=ee.focus.bindTo(t),this._textInputFocus=ee.textInputFocus.bindTo(t),this._editorTextFocus=ee.editorTextFocus.bindTo(t),this._tabMovesFocus=ee.tabMovesFocus.bindTo(t),this._editorReadonly=ee.readOnly.bindTo(t),this._inDiffEditor=ee.inDiffEditor.bindTo(t),this._editorColumnSelection=ee.columnSelection.bindTo(t),this._hasMultipleSelections=ee.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=ee.hasNonEmptySelection.bindTo(t),this._canUndo=ee.canUndo.bindTo(t),this._canRedo=ee.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(ZL.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(ZL.getTabFocusMode()),this._editorReadonly.set(e.get(90)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class I8e extends ae{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=ee.languageId.bindTo(t),this._hasCompletionItemProvider=ee.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=ee.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=ee.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=ee.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=ee.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=ee.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=ee.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=ee.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=ee.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=ee.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=ee.hasReferenceProvider.bindTo(t),this._hasRenameProvider=ee.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=ee.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=ee.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=ee.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=ee.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=ee.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=ee.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=ee.isInWalkThroughSnippet.bindTo(t);const s=()=>this._update();this._register(e.onDidChangeModel(s)),this._register(e.onDidChangeModelLanguage(s)),this._register(i.completionProvider.onDidChange(s)),this._register(i.codeActionProvider.onDidChange(s)),this._register(i.codeLensProvider.onDidChange(s)),this._register(i.definitionProvider.onDidChange(s)),this._register(i.declarationProvider.onDidChange(s)),this._register(i.implementationProvider.onDidChange(s)),this._register(i.typeDefinitionProvider.onDidChange(s)),this._register(i.hoverProvider.onDidChange(s)),this._register(i.documentHighlightProvider.onDidChange(s)),this._register(i.documentSymbolProvider.onDidChange(s)),this._register(i.referenceProvider.onDidChange(s)),this._register(i.renameProvider.onDidChange(s)),this._register(i.documentFormattingEditProvider.onDidChange(s)),this._register(i.documentRangeFormattingEditProvider.onDidChange(s)),this._register(i.signatureHelpProvider.onDidChange(s)),this._register(i.inlayHintsProvider.onDidChange(s)),s()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===bt.walkThroughSnippet)})}}class N8e extends ae{constructor(e){super(),this._onChange=this._register(new G),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(ef(e)),this._register(this._domFocusTracker.onDidFocus(()=>{this._hasFocus=!0,this._onChange.fire(void 0)})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasFocus=!1,this._onChange.fire(void 0)}))}hasFocus(){return this._hasFocus}}class R8e{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(s=>{this._isChangingDecorations||e.call(t,s)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const s=e.getDecorationRange(i);s&&t.push(s)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}}const M8e=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),F8e=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function vR(n){return M8e+encodeURIComponent(n.toString())+F8e}const P8e=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),O8e=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function B8e(n){return P8e+encodeURIComponent(n.toString())+O8e}$a((n,e)=>{const t=n.getColor(mc);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${vR(t)}") repeat-x bottom left; }`);const i=n.getColor(ho);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${vR(i)}") repeat-x bottom left; }`);const s=n.getColor(dr);s&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${vR(s)}") repeat-x bottom left; }`);const r=n.getColor(h3e);r&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${B8e(r)}") no-repeat bottom left; }`);const o=n.getColor(mPe);o&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${o.rgba.a}; }`)});var W8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},V8e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},$8e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let FF=class extends ae{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new G),this._onCodeEditorAdd=this._register(new G),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new G),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new G),this._onDiffEditorAdd=this._register(new G),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new G),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new hr,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const s=e.toString();let r;this._modelProperties.has(s)?r=this._modelProperties.get(s):(r=new Map,this._modelProperties.set(s,r)),r.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}openCodeEditor(e,t,i){return $8e(this,void 0,void 0,function*(){for(const s of this._codeEditorOpenHandlers){const r=yield s(e,t,i);if(r!==null)return r}return null})}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return ut(t)}};FF=W8e([V8e(0,qr)],FF);var z8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},xj=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},H8e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let fD=class extends FF{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler((i,s,r)=>H8e(this,void 0,void 0,function*(){return s?this.doOpenEditor(s,i):null})))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const r=t.resource.scheme;if(r===bt.http||r===bt.https)return lne(t.resource.toString()),e}return null}const s=t.options?t.options.selection:null;if(s)if(typeof s.endLineNumber=="number"&&typeof s.endColumn=="number")e.setSelection(s),e.revealRangeInCenter(s,1);else{const r={lineNumber:s.startLineNumber,column:s.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};fD=z8e([xj(0,_t),xj(1,qr)],fD);At(ci,fD,0);const Xb=kt("layoutService");var tre=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ire=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let gD=class{get dimension(){return this._dimension||(this._dimension=xT(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())===null||e===void 0||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayout=Ee.None,this.offset={top:0,quickPickTop:0}}};gD=tre([ire(0,ci)],gD);let PF=class extends gD{get hasContainer(){return!1}get container(){return this._container}constructor(e,t){super(t),this._container=e}};PF=tre([ire(1,ci)],PF);At(Xb,gD,1);const nre=kt("dialogService");var U8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},kj=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},zx=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function Hx(n){return n.scheme===bt.file?n.fsPath:n.path}let sre=0;class Ux{constructor(e,t,i,s,r,o,a){this.id=++sre,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=s,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Lj{constructor(e,t){this.resourceLabel=e,this.reason=t}}class Dj{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,s]of this.elements)(s.reason===0?e:t).push(s.resourceLabel);const i=[];return e.length>0&&i.push(_({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(_({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class j8e{constructor(e,t,i,s,r,o,a){this.id=++sre,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=s,this.groupOrder=r,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new Dj),this.removedResources.has(t)||this.removedResources.set(t,new Lj(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new Dj),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new Lj(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class rre{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,s=this._past.length;i<s;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new Kse(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,s=0,r=-1;for(let a=0,l=this._past.length;a<l;a++,s++){const c=this._past[a];i&&(s>=t||c.id!==e.elements[s])&&(i=!1,r=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,s++){const l=this._future[a];i&&(s>=t||l.id!==e.elements[s])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}r!==-1&&(this._past=this._past.slice(0,r)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class wR{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const ore=new rre("","");ore.locked=!0;let OF=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=ub.None,i=lc.None){if(e.type===0){const s=Hx(e.resource),r=this.getUriComparisonKey(e.resource);this._pushElement(new Ux(e,s,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const s=new Set,r=[],o=[];for(const a of e.resources){const l=Hx(a),c=this.getUriComparisonKey(a);s.has(c)||(s.add(c),r.push(l),o.push(c))}r.length===1?this._pushElement(new Ux(e,r[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new j8e(e,r,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const s=e.resourceLabels[t],r=e.strResources[t];let o;this._editStacks.has(r)?o=this._editStacks.get(r):(o=new rre(s,r),this._editStacks.set(r,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const s=i.getClosestPastElement();return s?s.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const r of i){const o=Hx(r.resource),a=this.getUriComparisonKey(r.resource),l=new Ux(r,o,a,0,0,0,0);s.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitPastWorkspaceElement(e,s)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const r of i){const o=Hx(r.resource),a=this.getUriComparisonKey(r.resource),l=new Ux(r,o,a,0,0,0,0);s.set(l.strResource,l)}for(const r of e.strResources){if(t&&t.has(r))continue;this._editStacks.get(r).splitFutureWorkspaceElement(e,s)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const s=this.getUriComparisonKey(e);this._editStacks.has(s)&&this._editStacks.get(s).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new Kse(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=s)}return[t,i]}canUndo(e){if(e instanceof lc){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){Ft(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,s,r){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),s.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),s.dispose(),r()),l=>(o(),s.dispose(),this._onError(l,e))):(o(),s.dispose(),r())}_invokeWorkspacePrepare(e){return zx(this,void 0,void 0,function*(){if(typeof e.actual.prepareUndoRedo>"u")return ae.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?ae.None:t})}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(ae.None);const i=e.actual.prepareUndoRedo();return i?lAe(i)?t(i):i.then(s=>t(s)):t(ae.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||ore);return new wR(t)}_tryToSplitAndUndo(e,t,i,s){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(s),new jx(this._undo(e,0,!0));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(s),new jx}_checkWorkspaceUndo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,_({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,_({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndUndo(e,t,null,_({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,_({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,_({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const s=this._getAffectedEditStacks(t),r=this._checkWorkspaceUndo(e,t,s,!1);return r?r.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,s,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const s=t.getSecondClosestPastElement();if(s&&s.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,i,s){return zx(this,void 0,void 0,function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(u){u[u.All=0]="All",u[u.This=1]="This",u[u.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=yield this._dialogService.prompt({type:Fi.Info,message:_("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:_({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:_({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;s=!0}let r;try{r=yield this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return r.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,r,()=>this._continueUndoInGroup(t.groupId,s))})}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const s=_({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(s);return}return this._invokeResourcePrepare(t,s=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new wR([e]),s,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=s)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof lc){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const s=this._editStacks.get(e),r=s.getClosestPastElement();if(!r)return;if(r.groupId){const[a,l]=this._findClosestUndoElementInGroup(r.groupId);if(r!==a&&l)return this._undo(l,t,i)}if((r.sourceId!==t||r.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,r);try{return r.type===1?this._workspaceUndo(e,r,i):this._resourceUndo(s,r,i)}finally{}}_confirmAndContinueUndo(e,t,i){return zx(this,void 0,void 0,function*(){if((yield this._dialogService.confirm({message:_("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:_({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:_("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)})}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=s)}return[t,i]}canRedo(e){if(e instanceof lc){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,s){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(s),new jx(this._redo(e));for(const r of t.strResources)this.removeElements(r);return this._notificationService.warn(s),new jx}_checkWorkspaceRedo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,_({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,_({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const r=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&r.push(a.resourceLabel);if(r.length>0)return this._tryToSplitAndRedo(e,t,null,_({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,r.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,_({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,_({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),s=this._checkWorkspaceRedo(e,t,i,!1);return s?s.returnValue:this._executeWorkspaceRedo(e,t,i)}_executeWorkspaceRedo(e,t,i){return zx(this,void 0,void 0,function*(){let s;try{s=yield this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const r=this._checkWorkspaceRedo(e,t,i,!0);if(r)return s.dispose(),r.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,s,()=>this._continueRedoInGroup(t.groupId))})}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=_({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new wR([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,r]of this._editStacks){const o=r.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=s)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof lc){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[s,r]=this._findClosestRedoElementInGroup(i.groupId);if(i!==s&&r)return this._redo(r)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};OF=U8e([kj(0,nre),kj(1,ts)],OF);class jx{constructor(e){this.returnValue=e}}At(qT,OF,1);function Xr(n,e,t){return Math.min(Math.max(n,e),t)}class are{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class q8e{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const lre=kt("environmentService"),hh=kt("openerService");function p7(n,e){return ot.isUri(n)?h0(n.scheme,e):c8(n,e+":")}function Ej(n,...e){return e.some(t=>p7(n,t))}function G8e(n){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(n.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},n=n.with({fragment:""})),{selection:e,uri:n}}var K8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Tj=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const cre=kt("ILanguageFeatureDebounceService");var pD;(function(n){const e=new WeakMap;let t=0;function i(s){let r=e.get(s);return r===void 0&&(r=++t,e.set(s,r)),r}n.of=i})(pD||(pD={}));class Z8e{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class Y8e{constructor(e,t,i,s,r,o){this._logService=e,this._name=t,this._registry=i,this._default=s,this._min=r,this._max=o,this._cache=new A8(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>NT(pD.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?Xr(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let s=this._cache.get(i);s||(s=new q8e(6),this._cache.set(i,s));const r=Xr(s.update(t),this._min,this._max);return p7(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${r}ms`),r}_overall(){const e=new are;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return Xr(e,this._min,this._max)}}let BF=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){var s,r,o;const a=(s=i==null?void 0:i.min)!==null&&s!==void 0?s:50,l=(r=i==null?void 0:i.max)!==null&&r!==void 0?r:Math.pow(a,2),c=(o=i==null?void 0:i.key)!==null&&o!==void 0?o:void 0,u=`${pD.of(e)},${a}${c?","+c:""}`;let h=this._data.get(u);return h||(this._isDev?h=new Y8e(this._logService,t,e,this._overallAverage()|0||a*1.5,a,l):(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),h=new Z8e(a*1.5)),this._data.set(u,h)),h}_overallAverage(){const e=new are;for(const t of this._data.values())e.update(t.default());return e.value}};BF=K8e([Tj(0,lh),Tj(1,lre)],BF);At(cre,BF,1);var X8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},yR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let WF=class{constructor(e,t,i,s){this._legend=e,this._themeService=t,this._languageService=i,this._logService=s,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new yu}getMetadata(e,t,i){const s=this._languageService.languageIdCodec.encodeLanguageId(i),r=this._hashTable.get(e,t,s);let o;if(r)o=r.metadata,this._logService.getLevel()===Xn.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${e} / ${t}: foreground ${Ir.getForeground(o)}, fontStyle ${Ir.getFontStyle(o).toString(2)}`);else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let h=0;c>0&&h<this._legend.tokenModifiers.length;h++)c&1&&l.push(this._legend.tokenModifiers[h]),c=c>>1;c>0&&this._logService.getLevel()===Xn.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${t.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),l.push("not-in-legend"));const u=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof u>"u")o=2147483647;else{if(o=0,typeof u.italic<"u"){const h=(u.italic?1:0)<<11;o|=h|1}if(typeof u.bold<"u"){const h=(u.bold?2:0)<<11;o|=h|2}if(typeof u.underline<"u"){const h=(u.underline?4:0)<<11;o|=h|4}if(typeof u.strikethrough<"u"){const h=(u.strikethrough?8:0)<<11;o|=h|8}if(u.foreground){const h=u.foreground<<15;o|=h|16}o===0&&(o=2147483647)}}else this._logService.getLevel()===Xn.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${e} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),o=2147483647,a="not-in-legend";this._hashTable.add(e,t,s,o),this._logService.getLevel()===Xn.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${e} (${a}) / ${t} (${l.join(" ")}): foreground ${Ir.getForeground(o)}, fontStyle ${Ir.getFontStyle(o).toString(2)}`)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,console.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,s,r){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,console.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${s} is outside the previous data (length ${r}).`))}};WF=X8e([yR(1,qr),yR(2,Ji),yR(3,lh)],WF);class Q8e{constructor(e,t,i,s){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=s,this.next=null}}class yu{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=yu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<yu._SIZES.length?2/3*this._currentLength:0),this._elements=[],yu._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const s=this._hashFunc(e,t,i);let r=this._elements[s];for(;r;){if(r.tokenTypeIndex===e&&r.tokenModifierSet===t&&r.languageId===i)return r;r=r.next}return null}add(e,t,i,s){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const r=this._elements;this._currentLengthIndex++,this._currentLength=yu._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<yu._SIZES.length?2/3*this._currentLength:0),this._elements=[],yu._nullOutEntries(this._elements,this._currentLength);for(const o of r){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new Q8e(e,t,i,s))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}yu._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];const J8e=kt("semanticTokensStylingService");var e7e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},CR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let VF=class extends ae{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new WF(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};VF=e7e([CR(0,qr),CR(1,lh),CR(2,Ji)],VF);At(J8e,VF,1);var Aj=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const qx="**",Ij="/",lk="[/\\\\]",ck="[^/\\\\]",t7e=/\//g;function Nj(n,e){switch(n){case 0:return"";case 1:return`${ck}*?`;default:return`(?:${lk}|${ck}+${lk}${e?`|${lk}${ck}+`:""})*?`}}function Rj(n,e){if(!n)return[];const t=[];let i=!1,s=!1,r="";for(const o of n){switch(o){case e:if(!i&&!s){t.push(r),r="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":s=!0;break;case"]":s=!1;break}r+=o}return r&&t.push(r),t}function ure(n){if(!n)return"";let e="";const t=Rj(n,Ij);if(t.every(i=>i===qx))e=".*";else{let i=!1;t.forEach((s,r)=>{if(s===qx){if(i)return;e+=Nj(2,r===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of s){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let h;u==="-"?h=u:(u==="^"||u==="!")&&!c?h="^":u===Ij?h="":h=Na(u),c+=h;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const d=`(?:${Rj(a,",").map(f=>ure(f)).join("|")})`;e+=d,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=ck;continue;case"*":e+=Nj(1);continue;default:e+=Na(u)}}r<t.length-1&&(t[r+1]!==qx||r+2<t.length)&&(e+=lk)}i=s===qx})}return e}const i7e=/^\*\*\/\*\.[\w\.-]+$/,n7e=/^\*\*\/([\w\.-]+)\/?$/,s7e=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,r7e=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,o7e=/^\*\*((\/[\w\.-]+)+)\/?$/,a7e=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Mj=new A8(1e4),Fj=function(){return!1},Ec=function(){return null};function m7(n,e){if(!n)return Ec;let t;typeof n!="string"?t=n.pattern:t=n,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let s=Mj.get(i);if(s)return Pj(s,n);let r;return i7e.test(t)?s=l7e(t.substr(4),t):(r=n7e.exec(SR(t,e)))?s=c7e(r[1],t):(e.trimForExclusions?r7e:s7e).test(t)?s=u7e(t,e):(r=o7e.exec(SR(t,e)))?s=Oj(r[1].substr(1),t,!0):(r=a7e.exec(SR(t,e)))?s=Oj(r[1],t,!1):s=h7e(t),Mj.set(i,s),Pj(s,n)}function Pj(n,e){if(typeof e=="string")return n;const t=function(i,s){return SF(i,e.base,!Ts)?n(dT(i.substr(e.base.length),Dd),s):null};return t.allBasenames=n.allBasenames,t.allPaths=n.allPaths,t.basenames=n.basenames,t.patterns=n.patterns,t}function SR(n,e){return e.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function l7e(n,e){return function(t,i){return typeof t=="string"&&t.endsWith(n)?e:null}}function c7e(n,e){const t=`/${n}`,i=`\\${n}`,s=function(o,a){return typeof o!="string"?null:a?a===n?e:null:o===n||o.endsWith(t)||o.endsWith(i)?e:null},r=[n];return s.basenames=r,s.patterns=[e],s.allBasenames=r,s}function u7e(n,e){const t=dre(n.slice(1,-1).split(",").map(a=>m7(a,e)).filter(a=>a!==Ec),n),i=t.length;if(!i)return Ec;if(i===1)return t[0];const s=function(a,l){for(let c=0,u=t.length;c<u;c++)if(t[c](a,l))return n;return null},r=t.find(a=>!!a.allBasenames);r&&(s.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function Oj(n,e,t){const i=Dd===rn.sep,s=i?n:n.replace(t7e,Dd),r=Dd+s,o=rn.sep+n;let a;return t?a=function(l,c){return typeof l=="string"&&(l===s||l.endsWith(r)||!i&&(l===n||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===s||!i&&l===n)?e:null},a.allPaths=[(t?"*/":"./")+n],a}function h7e(n){try{const e=new RegExp(`^${ure(n)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?n:null}}catch{return Ec}}function d7e(n,e,t){return!n||typeof e!="string"?!1:hre(n)(e,void 0,t)}function hre(n,e={}){if(!n)return Fj;if(typeof n=="string"||f7e(n)){const t=m7(n,e);if(t===Ec)return Fj;const i=function(s,r){return!!t(s,r)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return g7e(n,e)}function f7e(n){const e=n;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function g7e(n,e){const t=dre(Object.getOwnPropertyNames(n).map(a=>p7e(a,n[a],e)).filter(a=>a!==Ec)),i=t.length;if(!i)return Ec;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,h){let d;for(let f=0,g=t.length;f<g;f++){const p=t[f](u,h);if(typeof p=="string")return p;j3(p)&&(d||(d=[]),d.push(p))}return d?(()=>Aj(this,void 0,void 0,function*(){for(const f of d){const g=yield f;if(typeof g=="string")return g}return null}))():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((u,h)=>h.allPaths?u.concat(h.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const s=function(a,l,c){let u,h;for(let d=0,f=t.length;d<f;d++){const g=t[d];g.requiresSiblings&&c&&(l||(l=Lie(a)),u||(u=l.substr(0,l.length-AAe(a).length)));const p=g(a,l,u,c);if(typeof p=="string")return p;j3(p)&&(h||(h=[]),h.push(p))}return h?(()=>Aj(this,void 0,void 0,function*(){for(const d of h){const f=yield d;if(typeof f=="string")return f}return null}))():null},r=t.find(a=>!!a.allBasenames);r&&(s.allBasenames=r.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function p7e(n,e,t){if(e===!1)return Ec;const i=m7(n,t);if(i===Ec)return Ec;if(typeof e=="boolean")return i;if(e){const s=e.when;if(typeof s=="string"){const r=(o,a,l,c)=>{if(!c||!i(o,a))return null;const u=s.replace("$(basename)",()=>l),h=c(u);return j3(h)?h.then(d=>d?n:null):h?n:null};return r.requiresSiblings=!0,r}}return i}function dre(n,e){const t=n.filter(a=>!!a.basenames);if(t.length<2)return n;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let s;if(e){s=[];for(let a=0,l=i.length;a<l;a++)s.push(e)}else s=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const r=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const h=a.charCodeAt(u-1);if(h===47||h===92)break}l=a.substr(u)}const c=i.indexOf(l);return c!==-1?s[c]:null};r.basenames=i,r.patterns=s,r.allBasenames=i;const o=n.filter(a=>!a.basenames);return o.push(r),o}function fre(n,e,t,i,s,r){if(Array.isArray(n)){let o=0;for(const a of n){const l=fre(a,e,t,i,s,r);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof n=="string")return i?n==="*"?5:n===t?10:0:0;if(n){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=n;if(!i&&!c)return 0;u&&s&&(e=s);let h=0;if(l)if(l===e.scheme)h=10;else if(l==="*")h=5;else return 0;if(o)if(o===t)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(u)if(u===r)h=10;else if(u==="*"&&r!==void 0)h=Math.max(h,5);else return 0;if(a){let d;if(typeof a=="string"?d=a:d=Object.assign(Object.assign({},a),{base:kie(a.base)}),d===e.fsPath||d7e(d,e.fsPath))h=10;else return 0}return h}else return 0}}function gre(n){return typeof n=="string"?!1:Array.isArray(n)?n.every(gre):!!n.exclusive}class Bj{constructor(e,t,i,s){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=s}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)===null||t===void 0?void 0:t.toString())===((i=e.notebookUri)===null||i===void 0?void 0:i.toString())}}class Di{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new G,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),ut(()=>{if(i){const s=this._entries.indexOf(i);s>=0&&(this._entries.splice(s,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,i=>t.push(i.provider)),t}orderedGroups(e){const t=[];let i,s;return this._orderedForEach(e,r=>{i&&s===r._score?i.push(r.provider):(s=r._score,i=[r.provider],t.push(i))}),t}_orderedForEach(e,t){this._updateScores(e);for(const i of this._entries)i._score>0&&t(i)}_updateScores(e){var t,i;const s=(t=this._notebookInfoResolver)===null||t===void 0?void 0:t.call(this,e.uri),r=s?new Bj(e.uri,e.getLanguageId(),s.uri,s.type):new Bj(e.uri,e.getLanguageId(),void 0,void 0);if(!(!((i=this._lastCandidate)===null||i===void 0)&&i.equals(r))){this._lastCandidate=r;for(const o of this._entries)if(o._score=fre(o.selector,r.uri,r.languageId,sMe(e),r.notebookUri,r.notebookType),gre(o.selector)&&o._score>0){for(const a of this._entries)a._score=0;o._score=1e3;break}this._entries.sort(Di._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:pv(e.selector)&&!pv(t.selector)?1:!pv(e.selector)&&pv(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function pv(n){return typeof n=="string"?!1:Array.isArray(n)?n.some(pv):!!n.isBuiltin}class m7e{constructor(){this.referenceProvider=new Di(this._score.bind(this)),this.renameProvider=new Di(this._score.bind(this)),this.codeActionProvider=new Di(this._score.bind(this)),this.definitionProvider=new Di(this._score.bind(this)),this.typeDefinitionProvider=new Di(this._score.bind(this)),this.declarationProvider=new Di(this._score.bind(this)),this.implementationProvider=new Di(this._score.bind(this)),this.documentSymbolProvider=new Di(this._score.bind(this)),this.inlayHintsProvider=new Di(this._score.bind(this)),this.colorProvider=new Di(this._score.bind(this)),this.codeLensProvider=new Di(this._score.bind(this)),this.documentFormattingEditProvider=new Di(this._score.bind(this)),this.documentRangeFormattingEditProvider=new Di(this._score.bind(this)),this.onTypeFormattingEditProvider=new Di(this._score.bind(this)),this.signatureHelpProvider=new Di(this._score.bind(this)),this.hoverProvider=new Di(this._score.bind(this)),this.documentHighlightProvider=new Di(this._score.bind(this)),this.selectionRangeProvider=new Di(this._score.bind(this)),this.foldingRangeProvider=new Di(this._score.bind(this)),this.linkProvider=new Di(this._score.bind(this)),this.inlineCompletionsProvider=new Di(this._score.bind(this)),this.completionProvider=new Di(this._score.bind(this)),this.linkedEditingRangeProvider=new Di(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new Di(this._score.bind(this)),this.documentSemanticTokensProvider=new Di(this._score.bind(this)),this.documentOnDropEditProvider=new Di(this._score.bind(this)),this.documentPasteEditProvider=new Di(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)===null||t===void 0?void 0:t.call(this,e)}}At(wt,m7e,1);const pre=kt("IWorkspaceEditService");class _7{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(Yg.is(t))return Yg.lift(t);if(a_.is(t))return a_.lift(t);throw new Error("Unsupported edit")})}}class Yg extends _7{static is(e){return e instanceof Yg?!0:ur(e)&&ot.isUri(e.resource)&&ur(e.textEdit)}static lift(e){return e instanceof Yg?e:new Yg(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,s){super(s),this.resource=e,this.textEdit=t,this.versionId=i}}class a_ extends _7{static is(e){return e instanceof a_?!0:ur(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof a_?e:new a_(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},s){super(s),this.oldResource=e,this.newResource=t,this.options=i}}const ys={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0},_7e=Object.freeze({id:"editor",order:5,type:"object",title:_("editorConfigurationTitle","Editor"),scope:5}),mD=Object.assign(Object.assign({},_7e),{properties:{"editor.tabSize":{type:"number",default:ls.tabSize,minimum:1,markdownDescription:_("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:_("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:ls.insertSpaces,markdownDescription:_("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:ls.detectIndentation,markdownDescription:_("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:ls.trimAutoWhitespace,description:_("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:ls.largeFileOptimizations,description:_("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:_("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[_("wordBasedSuggestionsMode.currentDocument","Only suggest words from the active document."),_("wordBasedSuggestionsMode.matchingDocuments","Suggest words from all open documents of the same language."),_("wordBasedSuggestionsMode.allDocuments","Suggest words from all open documents.")],description:_("wordBasedSuggestionsMode","Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[_("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),_("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),_("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:_("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:_("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:_("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!1,description:_("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:_("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:_("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:_("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:_("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:_("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:_("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:_("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:_("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:ys.maxComputationTime,description:_("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:ys.maxFileSize,description:_("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:ys.renderSideBySide,description:_("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:ys.renderSideBySideInlineBreakpoint,description:_("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:ys.useInlineViewWhenSpaceIsLimited,description:_("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:ys.renderMarginRevertIcon,description:_("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:ys.ignoreTrimWhitespace,description:_("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:ys.renderIndicators,description:_("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:ys.diffCodeLens,description:_("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:ys.diffWordWrap,markdownEnumDescriptions:[_("wordWrap.off","Lines will never wrap."),_("wordWrap.on","Lines will wrap at the viewport width."),_("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:ys.diffAlgorithm,markdownEnumDescriptions:[_("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),_("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:ys.hideUnchangedRegions.enabled,markdownDescription:_("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:ys.hideUnchangedRegions.revealLineCount,markdownDescription:_("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:ys.hideUnchangedRegions.minimumLineCount,markdownDescription:_("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:ys.hideUnchangedRegions.contextLineCount,markdownDescription:_("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:ys.experimental.showMoves,markdownDescription:_("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:ys.experimental.showEmptyDecorations,description:_("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")}}});function b7e(n){return typeof n.type<"u"||typeof n.anyOf<"u"}for(const n of c0){const e=n.schema;if(typeof e<"u")if(b7e(e))mD.properties[`editor.${n.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(mD.properties[t]=e[t])}let Gx=null;function mre(){return Gx===null&&(Gx=Object.create(null),Object.keys(mD.properties).forEach(n=>{Gx[n]=!0})),Gx}function v7e(n){return mre()[`editor.${n}`]||!1}function w7e(n){return mre()[`diffEditor.${n}`]||!1}const y7e=Un.as(om.Configuration);y7e.registerConfiguration(mD);class C7e{static insert(e,t){return{range:new H(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function xR(n){return Object.isFrozen(n)?n:eTe(n)}class os{constructor(e={},t=[],i=[],s){this._contents=e,this._keys=t,this._overrides=i,this.raw=s,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if(!((e=this.raw)===null||e===void 0)&&e.length){const t=this.raw.map(i=>{if(i instanceof os)return i;const s=new S7e("");return s.parseRaw(i),s.configurationModel});this._rawConfiguration=t.reduce((i,s)=>s===i?s:i.merge(s),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?SH(this.contents,e):this.contents}inspect(e,t){const i=this.rawConfiguration.getValue(e),s=t?this.rawConfiguration.getOverrideValue(e,t):void 0,r=t?this.rawConfiguration.override(t).getValue(e):i;return{value:i,override:s,merged:r}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?SH(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var t,i;const s=bu(this.contents),r=bu(this.overrides),o=[...this.keys],a=!((t=this.raw)===null||t===void 0)&&t.length?[...this.raw]:[this];for(const l of e)if(a.push(...!((i=l.raw)===null||i===void 0)&&i.length?l.raw:[l]),!l.isEmpty()){this.mergeContents(s,l.contents);for(const c of l.overrides){const[u]=r.filter(h=>yn(h.identifiers,c.identifiers));u?(this.mergeContents(u.contents,c.contents),u.keys.push(...c.keys),u.keys=Cp(u.keys)):r.push(bu(c))}for(const c of l.keys)o.indexOf(c)===-1&&o.push(c)}return new os(s,o,r,a.every(l=>l instanceof os)?void 0:a)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const s of Cp([...Object.keys(this.contents),...Object.keys(t)])){let r=this.contents[s];const o=t[s];o&&(typeof r=="object"&&typeof o=="object"?(r=bu(r),this.mergeContents(r,o)):r=o),i[s]=r}return new os(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&ur(e[i])&&ur(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=bu(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const s=r=>{r&&(i?this.mergeContents(i,r):i=bu(r))};for(const r of this.overrides)r.identifiers.length===1&&r.identifiers[0]===e?t=r.contents:r.identifiers.includes(e)&&s(r.contents);return s(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),vRe(this.contents,e),nf.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>yn(i.identifiers,$L(e))),1))}updateValue(e,t,i){Sne(this.contents,e,t,s=>console.error(s)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),nf.test(e)&&this.overrides.push({identifiers:$L(e),keys:Object.keys(this.contents[e]),contents:K3(this.contents[e],s=>console.error(s))})}}class S7e{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||new os}parseRaw(e,t){this._raw=e;const{contents:i,keys:s,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new os(i,s,r,a?[e]:void 0),this._restrictedConfigurations=o||[]}doParseRaw(e,t){const i=Un.as(om.Configuration).getConfigurationProperties(),s=this.filter(e,i,!0,t);e=s.raw;const r=K3(e,l=>console.error(`Conflict in settings file ${this._name}: ${l}`)),o=Object.keys(e),a=this.toOverrides(e,l=>console.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:r,keys:o,overrides:a,restricted:s.restricted,hasExcludedProperties:s.hasExcludedProperties}}filter(e,t,i,s){var r,o,a;let l=!1;if(!(s!=null&&s.scopes)&&!(s!=null&&s.skipRestricted)&&!(!((r=s==null?void 0:s.exclude)===null||r===void 0)&&r.length))return{raw:e,restricted:[],hasExcludedProperties:l};const c={},u=[];for(const h in e)if(nf.test(h)&&i){const d=this.filter(e[h],t,!1,s);c[h]=d.raw,l=l||d.hasExcludedProperties,u.push(...d.restricted)}else{const d=t[h],f=d?typeof d.scope<"u"?d.scope:3:void 0;d!=null&&d.restricted&&u.push(h),!(!((o=s.exclude)===null||o===void 0)&&o.includes(h))&&(!((a=s.include)===null||a===void 0)&&a.includes(h)||(f===void 0||s.scopes===void 0||s.scopes.includes(f))&&!(s.skipRestricted&&(d!=null&&d.restricted)))?c[h]=e[h]:l=!0}return{raw:c,restricted:u,hasExcludedProperties:l}}toOverrides(e,t){const i=[];for(const s of Object.keys(e))if(nf.test(s)){const r={};for(const o in e[s])r[o]=e[s][o];i.push({identifiers:$L(s),keys:Object.keys(r),contents:K3(r,t)})}return i}}class x7e{constructor(e,t,i,s,r,o,a,l,c,u,h,d,f){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=s,this.defaultConfiguration=r,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=u,this.workspaceConfiguration=h,this.folderConfigurationModel=d,this.memoryConfigurationModel=f}inspect(e,t,i){const s=e.inspect(t,i);return{get value(){return xR(s.value)},get override(){return xR(s.override)},get merged(){return xR(s.merged)}}}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.inspect(this.userConfiguration,this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.userInspectValue.value!==void 0||this.userInspectValue.override!==void 0?{value:this.userInspectValue.value,override:this.userInspectValue.override}:void 0}}class KT{constructor(e,t,i,s,r=new os,o=new os,a=new us,l=new os,c=new us){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=s,this._remoteUserConfiguration=r,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new us,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let s;i.resource?(s=this._memoryConfigurationByResource.get(i.resource),s||(s=new os,this._memoryConfigurationByResource.set(i.resource,s))):s=this._memoryConfiguration,t===void 0?s.removeValue(e):s.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const s=this.getConsolidatedConfigurationModel(e,t,i),r=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of s.overrides)for(const c of l.identifiers)s.getOverrideValue(e,c)!==void 0&&a.add(c);return new x7e(e,t,s.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,r||void 0,o)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let s=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(s=s.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(s=s.merge(this._policyConfiguration)),s}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const s=t.getFolder(e);s&&(i=this.getFolderConsolidatedConfiguration(s.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),s=this._folderConfigurations.get(e);s?(t=i.merge(s),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:s,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:s,keys:r}]),e},[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.policy),s=this.parseConfigurationModel(e.application),r=this.parseConfigurationModel(e.user),o=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((l,c)=>(l.set(ot.revive(c[0]),this.parseConfigurationModel(c[1])),l),new us);return new KT(t,i,s,r,new os,o,a,new os,new us)}static parseConfigurationModel(e){return new os(e.contents,e.keys,e.overrides)}}class k7e{constructor(e,t,i,s){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=".".charCodeAt(0),this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const r of e.keys)this.affectedKeys.add(r);for(const[,r]of e.overrides)for(const o of r)this.affectedKeys.add(o);this._affectsConfigStr=this._marker;for(const r of this.affectedKeys)this._affectsConfigStr+=r+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=KT.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var i;const s=this._marker+e,r=this._affectsConfigStr.indexOf(s);if(r<0)return!1;const o=r+s.length;if(o>=this._affectsConfigStr.length)return!1;const a=this._affectsConfigStr.charCodeAt(o);if(a!==this._markerCode1&&a!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(i=this.previous)===null||i===void 0?void 0:i.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!mo(l,c)}return!0}}const _D={kind:0},L7e={kind:1};function D7e(n,e,t){return{kind:2,commandId:n,commandArgs:e,isBubble:t}}class ow{constructor(e,t,i){var s;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const r of e){const o=r.command;o&&o.charAt(0)!=="-"&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=ow.handleRemovals([].concat(e).concat(t));for(let r=0,o=this._keybindings.length;r<o;r++){const a=this._keybindings[r];if(a.chords.length===0)continue;const l=(s=a.when)===null||s===void 0?void 0:s.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let s=0;s<t.length;s++)if(t[s]!==e.chords[s])return!1}return!(i&&i.type!==1&&(!e.when||!EIe(i,e.when)))}static handleRemovals(e){const t=new Map;for(let s=0,r=e.length;s<r;s++){const o=e[s];if(o.command&&o.command.charAt(0)==="-"){const a=o.command.substring(1);t.has(a)?t.get(a).push(o):t.set(a,[o])}}if(t.size===0)return e;const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];if(!o.command||o.command.length===0){i.push(o);continue}if(o.command.charAt(0)==="-")continue;const a=t.get(o.command);if(!a||!o.isDefault){i.push(o);continue}let l=!1;for(const c of a){const u=c.when;if(this._isTargetedForRemoval(o,c.chords,u)){l=!0;break}}if(!l){i.push(o);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let s=i.length-1;s>=0;s--){const r=i[s];if(r.command===t.command)continue;let o=!0;for(let a=1;a<r.chords.length&&a<t.chords.length;a++)if(r.chords[a]!==t.chords[a]){o=!1;break}o&&ow.whenIsEntirelyIncluded(r.when,t.when)&&this._removeFromLookupMap(r)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,s=t.length;i<s;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:W3(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let s=i.length-1;s>=0;s--){const r=i[s];if(t.contextMatchesRules(r.when))return r}return i[i.length-1]}resolve(e,t,i){const s=[...t,i];this._log(`| Resolving ${s}`);const r=this._map.get(s[0]);if(r===void 0)return this._log("\\ No keybinding entries."),_D;let o=null;if(s.length<2)o=r;else{o=[];for(let l=0,c=r.length;l<c;l++){const u=r[l];if(s.length>u.chords.length)continue;let h=!0;for(let d=1;d<s.length;d++)if(u.chords[d]!==s[d]){h=!1;break}h&&o.push(u)}}const a=this._findCommand(e,o);return a?s.length<a.chords.length?(this._log(`\\ From ${o.length} keybinding entries, awaiting ${a.chords.length-s.length} more chord(s), when: ${Wj(a.when)}, source: ${Vj(a)}.`),L7e):(this._log(`\\ From ${o.length} keybinding entries, matched ${a.command}, when: ${Wj(a.when)}, source: ${Vj(a)}.`),D7e(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${o.length} keybinding entries, no when clauses matched the context.`),_D)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const s=t[i];if(ow._contextMatchesRules(e,s.when))return s}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function Wj(n){return n?`${n.serialize()}`:"no when condition"}function Vj(n){return n.extensionId?n.isBuiltinExtension?`built-in extension ${n.extensionId}`:`user extension ${n.extensionId}`:n.isDefault?"built-in":"user"}const E7e=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class T7e extends ae{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Ee.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,s,r){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=s,this._logService=r,this._onDidUpdateKeybindings=this._register(new G),this._currentChords=[],this._currentChordChecker=new gS,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=k0.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new uh,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),_D;const[s]=i.getDispatchChords();if(s===null)return this._log("\\ Keyboard event cannot be dispatched"),_D;const r=this._contextKeyService.getContext(t),o=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(r,o,s)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw t8("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(_("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:s})=>s).join(", ");this._currentChordStatusMessage=this._notificationService.status(_("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),Kv.enabled&&Kv.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],Kv.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[s]=i.getSingleModifierDispatchChords();if(s)return this._ignoreSingleModifiers.has(s)?(this._log(`+ Ignoring single modifier ${s} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=k0.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=k0.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${s}.`),this._currentSingleModifier=s,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):s===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${s} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[r]=i.getChords();return this._ignoreSingleModifiers=new k0(r),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){var s;let r=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let o=null,a=null;if(i){const[h]=e.getSingleModifierDispatchChords();o=h,a=h?[h]:[]}else[o]=e.getDispatchChords(),a=this._currentChords.map(({keypress:h})=>h);if(o===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),r;const l=this._contextKeyService.getContext(t),c=e.getLabel(),u=this._getResolver().resolve(l,a,o);switch(u.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",c,"[ No matching keybinding ]"),this.inChordMode){const h=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${h}, ${c}".`),this._notificationService.status(_("missing.chord","The key combination ({0}, {1}) is not a command.",h,c),{hideAfter:10*1e3}),this._leaveChordMode(),r=!0}return r}case 1:return this._logService.trace("KeybindingService#dispatch",c,"[ Several keybindings match - more chords needed ]"),r=!0,this._expectAnotherChord(o,c),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),r;case 2:{if(this._logService.trace("KeybindingService#dispatch",c,`[ Will dispatch command ${u.commandId} ]`),u.commandId===null||u.commandId===""){if(this.inChordMode){const h=this._currentChords.map(({label:d})=>d).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${h}, ${c}".`),this._notificationService.status(_("missing.chord","The key combination ({0}, {1}) is not a command.",h,c),{hideAfter:10*1e3}),this._leaveChordMode(),r=!0}}else this.inChordMode&&this._leaveChordMode(),u.isBubble||(r=!0),this._log(`+ Invoking command ${u.commandId}.`),typeof u.commandArgs>"u"?this._commandService.executeCommand(u.commandId).then(void 0,h=>this._notificationService.warn(h)):this._commandService.executeCommand(u.commandId,u.commandArgs).then(void 0,h=>this._notificationService.warn(h)),E7e.test(u.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:u.commandId,from:"keybinding",detail:(s=e.getUserSettingsLabel())!==null&&s!==void 0?s:void 0});return r}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}class k0{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}k0.EMPTY=new k0(null);class $j{constructor(e,t,i,s,r,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?$F(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=$F(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=s,this.isDefault=r,this.extensionId=o,this.isBuiltinExtension=a}}function $F(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n[t];if(!s)return[];e.push(s)}return e}class ZT{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=i(a);if(l===null)return null;s[r]=R7e(a,l,this.modifierLabels[e])}return s.join(" ")}}const b7=new ZT({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:_({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:_({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:_({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:_({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:_({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:_({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:_({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:_({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),A7e=new ZT({ctrlKey:_({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:_({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:_({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:_({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:_({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:_({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:_({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:_({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:_({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:_({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:_({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:_({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),I7e=new ZT({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),N7e=new ZT({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function R7e(n,e,t){if(e===null)return"";const i=[];return n.ctrlKey&&i.push(t.ctrlKey),n.shiftKey&&i.push(t.shiftKey),n.altKey&&i.push(t.altKey),n.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class M7e extends AIe{constructor(e,t){if(super(),t.length===0)throw ju("chords");this._os=e,this._chords=t}getLabel(){return b7.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return A7e.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:I7e.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return N7e.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new TIe(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class zy extends M7e{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return Du.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":Du.toString(e.keyCode)}_getElectronAccelerator(e){return Du.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=Du.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return zy.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Du.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=o8[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof xp)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new xp(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=$F(e.chords.map(s=>this._toKeyCodeChord(s)));return i.length>0?[new zy(i,t)]:[]}}const YT=kt("labelService"),F7e=kt("progressService");class l_{constructor(e,t){this.callback=e,this.report=t!=null&&t.async?this._reportAsync.bind(this):this._reportSync.bind(this)}_reportSync(e){this._value=e,this.callback(this._value)}_reportAsync(e){Promise.resolve(this._lastTask).finally(()=>{this._value=e;const t=this.callback(this._value);this._lastTask=Promise.resolve(t).finally(()=>this._lastTask=void 0)})}}l_.None=Object.freeze({report(){}});const xS=kt("editorProgressService");class P7e{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class O7e{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?l8(e,this._value,0,e.length,this._from,this._to):hS(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class B7e{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?l8(e,this._value,0,e.length,this._from,this._to):hS(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class W7e{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new B7e(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return Yz(e,this._value.scheme);if(this._states[this._stateIdx]===2)return Yz(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return cy(e,this._value.query);if(this._states[this._stateIdx]===5)return cy(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class Kx{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e,t;return(t=(e=this.left)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get heightRight(){var e,t;return(t=(e=this.right)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}}class aw{static forUris(e=()=>!1,t=()=>!1){return new aw(new W7e(e,t))}static forStrings(){return new aw(new P7e)}static forConfigKeys(){return new aw(new O7e)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let s;this._root||(this._root=new Kx,this._root.segment=i.value());const r=[];for(s=this._root;;){const a=i.cmp(s.segment);if(a>0)s.left||(s.left=new Kx,s.left.segment=i.value()),r.push([-1,s]),s=s.left;else if(a<0)s.right||(s.right=new Kx,s.right.segment=i.value()),r.push([1,s]),s=s.right;else if(i.hasNext())i.next(),s.mid||(s.mid=new Kx,s.mid.segment=i.value()),r.push([0,s]),s=s.mid;else break}const o=s.value;s.value=t,s.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=r[a][0],h=r[a+1][0];if(u===1&&h===1)r[a][1]=l.rotateLeft();else if(u===-1&&h===-1)r[a][1]=l.rotateRight();else if(u===1&&h===-1)l.right=r[a+1][1]=r[a+1][1].rotateRight(),r[a][1]=l.rotateLeft();else if(u===-1&&h===1)l.left=r[a+1][1]=r[a+1][1].rotateLeft(),r[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}return o}get(e){var t;return(t=this._getNode(e))===null||t===void 0?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){var i;const s=this._iter.reset(e),r=[];let o=this._root;for(;o;){const a=s.cmp(o.segment);if(a>0)r.push([-1,o]),o=o.left;else if(a<0)r.push([1,o]),o=o.right;else if(s.hasNext())s.next(),r.push([0,o]),o=o.mid;else break}if(o){if(t?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){const a=this._min(o.right);if(a.key){const{key:l,value:c,segment:u}=a;this._delete(a.key,!1),o.key=l,o.value=c,o.segment=u}}else{const a=(i=o.left)!==null&&i!==void 0?i:o.right;if(r.length>0){const[l,c]=r[r.length-1];switch(l){case-1:c.left=a;break;case 0:c.mid=a;break;case 1:c.right=a;break}}else this._root=a}for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c>1?(l.right.balanceFactor()>=0||(l.right=l.right.rotateRight()),r[a][1]=l.rotateLeft()):c<-1&&(l.left.balanceFactor()<=0||(l.left=l.left.rotateLeft()),r[a][1]=l.rotateRight()),a>0)switch(r[a-1][0]){case-1:r[a-1][1].left=r[a][1];break;case 1:r[a-1][1].right=r[a][1];break;case 0:r[a-1][1].mid=r[a][1];break}else this._root=r[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,s;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),s=i.value||s,i=i.mid;else break}return i&&i.value||s}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let s=this._root;for(;s;){const r=i.cmp(s.segment);if(r>0)s=s.left;else if(r<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else return s.mid?this._entries(s.mid):t?s.value:void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const V7e=kt("contextService");class $7e{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const z7e="code-workspace";_("codeWorkspace","Code Workspace");const H7e="4064f6ec-cb38-4ad0-af64-ee6467e63c82";var zj;(function(n){n.inspectTokensAction=_("inspectTokens","Developer: Inspect Tokens")})(zj||(zj={}));var Hj;(function(n){n.gotoLineActionLabel=_("gotoLineActionLabel","Go to Line/Column...")})(Hj||(Hj={}));var Uj;(function(n){n.helpQuickAccessActionLabel=_("helpQuickAccess","Show all Quick Access Providers")})(Uj||(Uj={}));var jj;(function(n){n.quickCommandActionLabel=_("quickCommandActionLabel","Command Palette"),n.quickCommandHelp=_("quickCommandActionHelp","Show And Run Commands")})(jj||(jj={}));var qj;(function(n){n.quickOutlineActionLabel=_("quickOutlineActionLabel","Go to Symbol..."),n.quickOutlineByCategoryActionLabel=_("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(qj||(qj={}));var bD;(function(n){n.editorViewAccessibleLabel=_("editorViewAccessibleLabel","Editor content"),n.accessibilityHelpMessage=_("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options.")})(bD||(bD={}));var Gj;(function(n){n.toggleHighContrast=_("toggleHighContrast","Toggle High Contrast Theme")})(Gj||(Gj={}));var zF;(function(n){n.bulkEditServiceSummary=_("bulkEditServiceSummary","Made {0} edits in {1} files")})(zF||(zF={}));const U7e=kt("workspaceTrustManagementService"),Ef=kt("contextViewService"),Tf=kt("contextMenuService");var ss;(function(n){function e(r,o){if(r.start>=o.end||o.start>=r.end)return{start:0,end:0};const a=Math.max(r.start,o.start),l=Math.min(r.end,o.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=e;function t(r){return r.end-r.start<=0}n.isEmpty=t;function i(r,o){return!t(e(r,o))}n.intersects=i;function s(r,o){const a=[],l={start:r.start,end:Math.min(o.start,r.end)},c={start:Math.max(o.end,r.start),end:r.end};return t(l)||a.push(l),t(c)||a.push(c),a}n.relativeComplement=s})(ss||(ss={}));function j7e(n){const e=n;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var gd;(function(n){n[n.AVOID=0]="AVOID",n[n.ALIGN=1]="ALIGN"})(gd||(gd={}));function L0(n,e,t){const i=t.mode===gd.ALIGN?t.offset:t.offset+t.size,s=t.mode===gd.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=n-i?i:e<=s?s-e:Math.max(n-e,0):e<=s?s-e:e<=n-i?i:0}class fb extends ae{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=ae.None,this.toDisposeOnSetContainer=ae.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=Be(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,sd(this.view),this.setContainer(e,t),this._register(ut(()=>this.setContainer(null,1)))}setContainer(e,t){var i;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(i=this.shadowRootHostElement)===null||i===void 0||i.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=t!==1,this.useShadowDOM=t===3,this.useShadowDOM){this.shadowRootHostElement=Be(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const r=document.createElement("style");r.textContent=q7e,this.shadowRoot.appendChild(r),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(Be("slot"))}else this.container.appendChild(this.view);const s=new Ae;fb.BUBBLE_UP_EVENTS.forEach(r=>{s.add(pn(this.container,r,o=>{this.onDOMEvent(o,!1)}))}),fb.BUBBLE_DOWN_EVENTS.forEach(r=>{s.add(pn(this.container,r,o=>{this.onDOMEvent(o,!0)},!0))}),this.toDisposeOnSetContainer=s}}show(e){var t,i;this.isVisible()&&this.hide(),vo(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2575",this.view.style.position=this.useFixedPosition?"fixed":"absolute",Ug(this.view),this.toDisposeOnClean=e.render(this.view)||ae.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)===null||i===void 0||i.call(t)}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Qd&&y8.pointerEvents)){this.hide();return}this.delegate.layout&&this.delegate.layout(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(S8(e)){const h=hs(e),d=wNe(e);t={top:h.top*d,left:h.left*d,width:h.width*d,height:h.height*d}}else j7e(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=sr(this.view),s=Dg(this.view),r=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;if(a===0){const h={offset:t.top-window.pageYOffset,size:t.height,position:r===0?0:1},d={offset:t.left,size:t.width,position:o===0?0:1,mode:gd.ALIGN};l=L0(window.innerHeight,s,h)+window.pageYOffset,ss.intersects({start:l,end:l+s},{start:h.offset,end:h.offset+h.size})&&(d.mode=gd.AVOID),c=L0(window.innerWidth,i,d)}else{const h={offset:t.left,size:t.width,position:o===0?0:1},d={offset:t.top,size:t.height,position:r===0?0:1,mode:gd.ALIGN};c=L0(window.innerWidth,i,h),ss.intersects({start:c,end:c+i},{start:h.offset,end:h.offset+h.size})&&(d.mode=gd.AVOID),l=L0(window.innerHeight,s,d)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(r===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const u=hs(this.container);this.view.style.top=`${l-(this.useFixedPosition?hs(this.view).top:u.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?hs(this.view).left:u.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),sd(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!Qn(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}fb.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"];fb.BUBBLE_DOWN_EVENTS=["click"];const q7e=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var G7e=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},K7e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let HF=class extends ae{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=ae.None,this.container=e.hasContainer?e.container:null,this.contextView=this._register(new fb(this.container,1)),this.layout(),this._register(e.onDidLayout(()=>this.layout()))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,i){t?(t!==this.container||this.shadowRoot!==i)&&(this.container=t,this.setContainer(t,i?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.shadowRoot=i,this.contextView.show(e);const s=ut(()=>{this.currentViewDisposable===s&&this.hideContextView()});return this.currentViewDisposable=s,s}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};HF=G7e([K7e(0,Xb)],HF);let gb=[],v7=[],_re=[];function Zx(n,e=!1){Z7e(n,!1,e)}function Z7e(n,e,t){const i=Y7e(n,e);gb.push(i),i.userConfigured?_re.push(i):v7.push(i),t&&!i.userConfigured&&gb.forEach(s=>{s.mime===i.mime||s.userConfigured||(i.extension&&s.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&s.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&s.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&s.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function Y7e(n,e){return{id:n.id,mime:n.mime,filename:n.filename,extension:n.extension,filepattern:n.filepattern,firstline:n.firstline,userConfigured:e,filenameLowercase:n.filename?n.filename.toLowerCase():void 0,extensionLowercase:n.extension?n.extension.toLowerCase():void 0,filepatternLowercase:n.filepattern?hre(n.filepattern.toLowerCase()):void 0,filepatternOnPath:n.filepattern?n.filepattern.indexOf(rn.sep)>=0:!1}}function X7e(){gb=gb.filter(n=>n.userConfigured),v7=[]}function Q7e(n,e){return J7e(n,e).map(t=>t.id)}function J7e(n,e){let t;if(n)switch(n.scheme){case bt.file:t=n.fsPath;break;case bt.data:{t=aD.parseMetaData(n).get(aD.META_DATA_LABEL);break}case bt.vscodeNotebookCell:t=void 0;break;default:t=n.path}if(!t)return[{id:"unknown",mime:Au.unknown}];t=t.toLowerCase();const i=Lie(t),s=Kj(t,i,_re);if(s)return[s,{id:Bo,mime:Au.text}];const r=Kj(t,i,v7);if(r)return[r,{id:Bo,mime:Au.text}];if(e){const o=e9e(e);if(o)return[o,{id:Bo,mime:Au.text}]}return[{id:"unknown",mime:Au.unknown}]}function Kj(n,e,t){var i;let s,r,o;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){s=l;break}if(l.filepattern&&(!r||l.filepattern.length>r.filepattern.length)){const c=l.filepatternOnPath?n:e;!((i=l.filepatternLowercase)===null||i===void 0)&&i.call(l,c)&&(r=l)}l.extension&&(!o||l.extension.length>o.extension.length)&&e.endsWith(l.extensionLowercase)&&(o=l)}if(s)return s;if(r)return r;if(o)return o}function e9e(n){if(p8(n)&&(n=n.substr(1)),n.length>0)for(let e=gb.length-1;e>=0;e--){const t=gb[e];if(!t.firstline)continue;const i=n.match(t.firstline);if(i&&i.length>0)return t}}const Yx=Object.prototype.hasOwnProperty,Zj="vs.editor.nullLanguage";class t9e{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(Zj,0),this._register(Bo,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||Zj}}class Hy extends ae{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,Hy.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new t9e,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(tb.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){Hy.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},X7e();const e=[].concat(tb.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(s=>{this._lowercaseNameMap[s.toLowerCase()]=i.identifier}),i.mimetypes.forEach(s=>{this._mimeTypesMap[s]=i.identifier})}),Un.as(om.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;Yx.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let s=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),s=t.mimetypes[0]),s||(s=`text/x-${i}`,e.mimetypes.push(s)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)Zx({id:i,mime:s,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)Zx({id:i,mime:s,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)Zx({id:i,mime:s,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);ZAe(l)||Zx({id:i,mime:s,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let r=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?r=[null]:r=t.aliases),r!==null)for(const a of r)!a||a.length===0||e.aliases.push(a);const o=r!==null&&r.length>0;if(!(o&&r[0]===null)){const a=(o?r[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?Yx.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return Yx.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&Yx.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:Q7e(e,t)}}Hy.instanceCount=0;class Uy extends ae{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new G),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new G),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new G({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,Uy.instanceCount++,this._registry=this._register(new Hy(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){Uy.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return tie(i,null)}createById(e){return new Yj(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new Yj(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=Bo),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),$i.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}}Uy.instanceCount=0;class Yj{constructor(e,t){this._onDidChangeLanguages=e,this._selector=t,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages(()=>this._evaluate())),this._emitter||(this._emitter=new G({onDidRemoveLastListener:()=>{this._dispose()}})),this._emitter.event}_evaluate(){var e;const t=this._selector();t!==this.languageId&&(this.languageId=t,(e=this._emitter)===null||e===void 0||e.fire(this.languageId))}}const bre={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Au.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function vre(...n){return function(e,t){for(let i=0,s=n.length;i<s;i++){const r=n[i](e,t);if(r)return r}return null}}wre.bind(void 0,!1);const vD=wre.bind(void 0,!0);function wre(n,e,t){if(!t||t.length<e.length)return null;let i;return n?i=c8(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function i9e(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t===-1?null:[{start:t,end:t+n.length}]}function n9e(n,e){return UF(n.toLowerCase(),e.toLowerCase(),0,0)}function UF(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]===e[i]){let s=null;return(s=UF(n,e,t+1,i+1))?Cre({start:i,end:i+1},s):null}return UF(n,e,t,i+1)}function w7(n){return 97<=n&&n<=122}function XT(n){return 65<=n&&n<=90}function y7(n){return 48<=n&&n<=57}function s9e(n){return n===32||n===9||n===10||n===13}const r9e=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(n=>r9e.add(n.charCodeAt(0)));function yre(n){return w7(n)||XT(n)||y7(n)}function Cre(n,e){return e.length===0?e=[n]:n.end===e[0].start?e[0].start=n.start:e.unshift(n),e}function Sre(n,e){for(let t=e;t<n.length;t++){const i=n.charCodeAt(t);if(XT(i)||y7(i)||t>0&&!yre(n.charCodeAt(t-1)))return t}return n.length}function jF(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]!==e[i].toLowerCase())return null;{let s=null,r=i+1;for(s=jF(n,e,t+1,i+1);!s&&(r=Sre(e,r))<e.length;)s=jF(n,e,t+1,r),r++;return s===null?null:Cre({start:i,end:i+1},s)}}function o9e(n){let e=0,t=0,i=0,s=0,r=0;for(let u=0;u<n.length;u++)r=n.charCodeAt(u),XT(r)&&e++,w7(r)&&t++,yre(r)&&i++,y7(r)&&s++;const o=e/n.length,a=t/n.length,l=i/n.length,c=s/n.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function a9e(n){const{upperPercent:e,lowerPercent:t}=n;return t===0&&e>.6}function l9e(n){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:s}=n;return t>.2&&e<.8&&i>.6&&s<.2}function c9e(n){let e=0,t=0,i=0,s=0;for(let r=0;r<n.length;r++)i=n.charCodeAt(r),XT(i)&&e++,w7(i)&&t++,s9e(i)&&s++;return(e===0||t===0)&&s===0?n.length<=30:e<=5}function xre(n,e){if(!e||(e=e.trim(),e.length===0)||!c9e(n)||e.length>60)return null;const t=o9e(e);if(!l9e(t)){if(!a9e(t))return null;e=e.toLowerCase()}let i=null,s=0;for(n=n.toLowerCase();s<e.length&&(i=jF(n,e,0,s))===null;)s=Sre(e,s+1);return i}const u9e=vre(vD,xre,i9e),h9e=vre(vD,xre,n9e),Xj=new A8(1e4);function Qj(n,e,t=!1){if(typeof n!="string"||typeof e!="string")return null;let i=Xj.get(n);i||(i=new RegExp(KAe(n),"i"),Xj.set(n,i));const s=i.exec(e);return s?[{start:s.index,end:s.index+s[0].length}]:t?h9e(n,e):u9e(n,e)}function d9e(n,e){const t=Ere(n,n.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?C7(t):null}function C7(n){if(typeof n>"u")return[];const e=[],t=n[1];for(let i=n.length-1;i>1;i--){const s=n[i]+t,r=e[e.length-1];r&&r.end===s?r.end=s+1:e.push({start:s,end:s+1})}return e}const pd=128;function S7(){const n=[],e=[];for(let t=0;t<=pd;t++)e[t]=0;for(let t=0;t<=pd;t++)n.push(e.slice(0));return n}function kre(n){const e=[];for(let t=0;t<=n;t++)e[t]=0;return e}const Lre=kre(2*pd),qF=kre(2*pd),ru=S7(),$f=S7(),Xx=S7();function Qx(n,e){if(e<0||e>=n.length)return!1;const t=n.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!g8(t)}}function Jj(n,e){if(e<0||e>=n.length)return!1;switch(n.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function uk(n,e,t){return e[n]!==t[n]}function f9e(n,e,t,i,s,r,o=!1){for(;e<t&&s<r;)n[e]===i[s]&&(o&&(Lre[e]=s),e+=1),s+=1;return e===t}var Xg;(function(n){n.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}n.isDefault=e})(Xg||(Xg={}));class Dre{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}}Dre.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};function Ere(n,e,t,i,s,r,o=Dre.default){const a=n.length>pd?pd:n.length,l=i.length>pd?pd:i.length;if(t>=a||r>=l||a-t>l-r||!f9e(e,t,a,s,r,l,!0))return;g9e(a,l,t,r,e,s);let c=1,u=1,h=t,d=r;const f=[!1];for(c=1,h=t;h<a;c++,h++){const v=Lre[h],w=qF[h],y=h+1<a?qF[h+1]:l;for(u=v-r+1,d=v;d<y;u++,d++){let x=Number.MIN_SAFE_INTEGER,D=!1;d<=w&&(x=p9e(n,e,h,t,i,s,d,l,r,ru[c-1][u-1]===0,f));let S=0;x!==Number.MAX_SAFE_INTEGER&&(D=!0,S=x+$f[c-1][u-1]);const T=d>v,k=T?$f[c][u-1]+(ru[c][u-1]>0?-5:0):0,I=d>v+1&&ru[c][u-1]>0,N=I?$f[c][u-2]+(ru[c][u-2]>0?-5:0):0;if(I&&(!T||N>=k)&&(!D||N>=S))$f[c][u]=N,Xx[c][u]=3,ru[c][u]=0;else if(T&&(!D||k>=S))$f[c][u]=k,Xx[c][u]=2,ru[c][u]=0;else if(D)$f[c][u]=S,Xx[c][u]=1,ru[c][u]=ru[c-1][u-1]+1;else throw new Error("not possible")}}if(!f[0]&&!o.firstMatchCanBeWeak)return;c--,u--;const g=[$f[c][u],r];let p=0,m=0;for(;c>=1;){let v=u;do{const w=Xx[c][v];if(w===3)v=v-2;else if(w===2)v=v-1;else break}while(v>=1);p>1&&e[t+c-1]===s[r+u-1]&&!uk(v+r-1,i,s)&&p+1>ru[c][v]&&(v=u),v===u?p++:p=1,m||(m=v),c--,u=v-1,g.push(u)}l===a&&o.boostFullMatch&&(g[0]+=2);const b=m-a;return g[0]-=b,g}function g9e(n,e,t,i,s,r){let o=n-1,a=e-1;for(;o>=t&&a>=i;)s[o]===r[a]&&(qF[o]=a,o--),a--}function p9e(n,e,t,i,s,r,o,a,l,c,u){if(e[t]!==r[o])return Number.MIN_SAFE_INTEGER;let h=1,d=!1;return o===t-i?h=n[t]===s[o]?7:5:uk(o,s,r)&&(o===0||!uk(o-1,s,r))?(h=n[t]===s[o]?7:5,d=!0):Qx(r,o)&&(o===0||!Qx(r,o-1))?h=5:(Qx(r,o-1)||Jj(r,o-1))&&(h=5,d=!0),h>1&&t===i&&(u[0]=!0),d||(d=uk(o,s,r)||Qx(r,o-1)||Jj(r,o-1)),t===i?o>l&&(h-=d?3:5):c?h+=d?2:0:h+=d?0:1,o+1===a&&(h-=d?3:5),h}const m9e="$(",x7=new RegExp(`\\$\\(${Ye.iconNameExpression}(?:${Ye.iconModifierExpression})?\\)`,"g"),_9e=new RegExp(`(\\\\)?${x7.source}`,"g");function b9e(n){return n.replace(_9e,(e,t)=>t?e:`\\${e}`)}const v9e=new RegExp(`\\\\${x7.source}`,"g");function w9e(n){return n.replace(v9e,e=>`\\${e}`)}const y9e=new RegExp(`(\\s)?(\\\\)?${x7.source}(\\s)?`,"g");function Tre(n){return n.indexOf(m9e)===-1?n:n.replace(y9e,(e,t,i,s)=>i?e:t||s||"")}function C9e(n){return n?n.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const kR=new RegExp(`\\$\\(${Ye.iconNameCharacter}+\\)`,"g");function mv(n){kR.lastIndex=0;let e="";const t=[];let i=0;for(;;){const s=kR.lastIndex,r=kR.exec(n),o=n.substring(s,r==null?void 0:r.index);if(o.length>0){e+=o;for(let a=0;a<o.length;a++)t.push(i)}if(!r)break;i+=r[0].length}return{text:e,iconOffsets:t}}function LR(n,e,t=!1){const{text:i,iconOffsets:s}=e;if(!s||s.length===0)return Qj(n,i,t);const r=dT(i," "),o=i.length-r.length,a=Qj(n,r,t);if(a)for(const l of a){const c=s[l.start+o]+o;l.start+=c,l.end+=c}return a}class pb{constructor(e="",t=!1){var i,s,r;if(this.value=e,typeof this.value!="string")throw ju("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=(i=t.isTrusted)!==null&&i!==void 0?i:void 0,this.supportThemeIcons=(s=t.supportThemeIcons)!==null&&s!==void 0?s:!1,this.supportHtml=(r=t.supportHtml)!==null&&r!==void 0?r:!1)}appendText(e,t=0){return this.value+=x9e(this.supportThemeIcons?b9e(e):e).replace(/([ \t]+)/g,(i,s)=>"&nbsp;".repeat(s.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+=`
`,this.value+=t,this.value+="\n```\n",this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Na(t),"g");return e.replace(i,(s,r)=>e.charAt(r-1)!=="\\"?`\\${s}`:s)}}function jy(n){return Rd(n)?!n.value:Array.isArray(n)?n.every(jy):!0}function Rd(n){return n instanceof pb?!0:n&&typeof n=="object"?typeof n.value=="string"&&(typeof n.isTrusted=="boolean"||typeof n.isTrusted=="object"||n.isTrusted===void 0)&&(typeof n.supportThemeIcons=="boolean"||n.supportThemeIcons===void 0):!1}function S9e(n,e){return n===e?!0:!n||!e?!1:n.value===e.value&&n.isTrusted===e.isTrusted&&n.supportThemeIcons===e.supportThemeIcons&&n.supportHtml===e.supportHtml&&(n.baseUri===e.baseUri||!!n.baseUri&&!!e.baseUri&&i7(ot.from(n.baseUri),ot.from(e.baseUri)))}function x9e(n){return n.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Jx(n){return n.replace(/"/g,"&quot;")}function DR(n){return n&&n.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function k9e(n){const e=[],t=n.split("|").map(s=>s.trim());n=t[0];const i=t[1];if(i){const s=/height=(\d+)/.exec(i),r=/width=(\d+)/.exec(i),o=s?s[1]:"",a=r?r[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:n,dimensions:e}}var GF=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function L9e(n,e){_r(e)?n.title=Tre(e):e!=null&&e.markdownNotSupportedFallback?n.title=e.markdownNotSupportedFallback:n.removeAttribute("title")}class D9e{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}update(e,t,i){var s;return GF(this,void 0,void 0,function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let r;if(e===void 0||_r(e)||e instanceof HTMLElement)r=e;else if(!xL(e.markdown))r=(s=e.markdown)!==null&&s!==void 0?s:e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(_("iconLabel.loading","Loading..."),t),this._cancellationTokenSource=new Wa;const o=this._cancellationTokenSource.token;if(r=yield e.markdown(o),r===void 0&&(r=e.markdownNotSupportedFallback),this.isDisposed||o.isCancellationRequested)return}this.show(r,t,i)})}show(e,t,i){const s=this._hoverWidget;if(this.hasContent(e)){const r=Object.assign({content:e,target:this.target,showPointer:this.hoverDelegate.placement==="element",hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!s},i);this._hoverWidget=this.hoverDelegate.showHover(r,t)}s==null||s.dispose()}hasContent(e){return e?Rd(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)===null||e===void 0?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)===null||e===void 0||e.dispose(),(t=this._cancellationTokenSource)===null||t===void 0||t.dispose(!0),this._cancellationTokenSource=void 0}}function Are(n,e,t,i){let s,r;const o=(h,d)=>{var f;const g=r!==void 0;h&&(r==null||r.dispose(),r=void 0),d&&(s==null||s.dispose(),s=void 0),g&&((f=n.onDidHideHover)===null||f===void 0||f.call(n))},a=(h,d,f)=>new uh(()=>GF(this,void 0,void 0,function*(){(!r||r.isDisposed)&&(r=new D9e(n,f||e,h>0),yield r.update(t,d,i))}),h),l=()=>{if(s)return;const h=new Ae,d=p=>o(!1,p.fromElement===e);h.add(oe(e,Le.MOUSE_LEAVE,d,!0));const f=()=>o(!0,!0);h.add(oe(e,Le.MOUSE_DOWN,f,!0));const g={targetElements:[e],dispose:()=>{}};if(n.placement===void 0||n.placement==="mouse"){const p=m=>{g.x=m.x+10,m.target instanceof HTMLElement&&m.target.classList.contains("action-label")&&o(!0,!0)};h.add(oe(e,Le.MOUSE_MOVE,p,!0))}h.add(a(n.delay,!1,g)),s=h},c=oe(e,Le.MOUSE_OVER,l,!0);return{show:h=>{o(!1,!0),a(0,h)},hide:()=>{o(!0,!0)},update:(h,d)=>GF(this,void 0,void 0,function*(){t=h,yield r==null?void 0:r.update(t,void 0,d)}),dispose:()=>{c.dispose(),o(!0,!0)}}}function E9e(n,e={}){const t=k7(e);return t.textContent=n,t}function T9e(n,e={}){const t=k7(e);return Ire(t,I9e(n,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function k7(n){const e=n.inline?"span":"div",t=document.createElement(e);return n.className&&(t.className=n.className),t}class A9e{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function Ire(n,e,t,i){let s;if(e.type===2)s=document.createTextNode(e.content||"");else if(e.type===3)s=document.createElement("b");else if(e.type===4)s=document.createElement("i");else if(e.type===7&&i)s=document.createElement("code");else if(e.type===5&&t){const r=document.createElement("a");t.disposables.add(pn(r,"click",o=>{t.callback(String(e.index),o)})),s=r}else e.type===8?s=document.createElement("br"):e.type===1&&(s=n);s&&n!==s&&n.appendChild(s),s&&Array.isArray(e.children)&&e.children.forEach(r=>{Ire(s,r,t,i)})}function I9e(n,e){const t={type:1,children:[]};let i=0,s=t;const r=[],o=new A9e(n);for(;!o.eos();){let a=o.next();const l=a==="\\"&&KF(o.peek(),e)!==0;if(l&&(a=o.next()),!l&&N9e(a,e)&&a===o.peek()){o.advance(),s.type===2&&(s=r.pop());const c=KF(a,e);if(s.type===c||s.type===5&&c===6)s=r.pop();else{const u={type:c,children:[]};c===5&&(u.index=i,i++),s.children.push(u),r.push(s),s=u}}else if(a===`
`)s.type===2&&(s=r.pop()),s.children.push({type:8});else if(s.type!==2){const c={type:2,content:a};s.children.push(c),r.push(s),s=c}else s.content+=a}return s.type===2&&(s=r.pop()),t}function N9e(n,e){return KF(n,e)!==0}function KF(n,e){switch(n){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}const R9e=new RegExp(`(\\\\)?\\$\\((${Ye.iconNameExpression}(?:${Ye.iconModifierExpression})?)\\)`,"g");function Qg(n){const e=new Array;let t,i=0,s=0;for(;(t=R9e.exec(n))!==null;){s=t.index||0,i<s&&e.push(n.substring(i,s)),i=(t.index||0)+t[0].length;const[,r,o]=t;e.push(r?`$(${o})`:ZF({id:o}))}return i<n.length&&e.push(n.substring(i)),e}function ZF(n){const e=Be("span");return e.classList.add(...Ye.asClassNameArray(n)),e}class L7{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const YF=new L7("id#");let Xs={};(function(){function n(e,t){t(Xs)}n.amd=!0,function(e,t){typeof n=="function"&&n.amd?n(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(global=typeof e<"u"?e:e||self,t(e.marked={}))}(this,function(e){function t(le,ie){for(var Q=0;Q<ie.length;Q++){var R=ie[Q];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(le,R.key,R)}}function i(le,ie,Q){return ie&&t(le.prototype,ie),Q&&t(le,Q),Object.defineProperty(le,"prototype",{writable:!1}),le}function s(le,ie){if(le){if(typeof le=="string")return r(le,ie);var Q=Object.prototype.toString.call(le).slice(8,-1);if(Q==="Object"&&le.constructor&&(Q=le.constructor.name),Q==="Map"||Q==="Set")return Array.from(le);if(Q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q))return r(le,ie)}}function r(le,ie){(ie==null||ie>le.length)&&(ie=le.length);for(var Q=0,R=new Array(ie);Q<ie;Q++)R[Q]=le[Q];return R}function o(le,ie){var Q=typeof Symbol<"u"&&le[Symbol.iterator]||le["@@iterator"];if(Q)return(Q=Q.call(le)).next.bind(Q);if(Array.isArray(le)||(Q=s(le))||ie&&le&&typeof le.length=="number"){Q&&(le=Q);var R=0;return function(){return R>=le.length?{done:!0}:{done:!1,value:le[R++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}e.defaults=a();function l(le){e.defaults=le}var c=/[&<>"']/,u=/[&<>"']/g,h=/[<>"']|&(?!#?\w+;)/,d=/[<>"']|&(?!#?\w+;)/g,f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},g=function(ie){return f[ie]};function p(le,ie){if(ie){if(c.test(le))return le.replace(u,g)}else if(h.test(le))return le.replace(d,g);return le}var m=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function b(le){return le.replace(m,function(ie,Q){return Q=Q.toLowerCase(),Q==="colon"?":":Q.charAt(0)==="#"?Q.charAt(1)==="x"?String.fromCharCode(parseInt(Q.substring(2),16)):String.fromCharCode(+Q.substring(1)):""})}var v=/(^|[^\[])\^/g;function w(le,ie){le=typeof le=="string"?le:le.source,ie=ie||"";var Q={replace:function(W,K){return K=K.source||K,K=K.replace(v,"$1"),le=le.replace(W,K),Q},getRegex:function(){return new RegExp(le,ie)}};return Q}var y=/[^\w:]/g,x=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function D(le,ie,Q){if(le){var R;try{R=decodeURIComponent(b(Q)).replace(y,"").toLowerCase()}catch{return null}if(R.indexOf("javascript:")===0||R.indexOf("vbscript:")===0||R.indexOf("data:")===0)return null}ie&&!x.test(Q)&&(Q=N(ie,Q));try{Q=encodeURI(Q).replace(/%25/g,"%")}catch{return null}return Q}var S={},T=/^[^:]+:\/*[^/]*$/,k=/^([^:]+:)[\s\S]*$/,I=/^([^:]+:\/*[^/]*)[\s\S]*$/;function N(le,ie){S[" "+le]||(T.test(le)?S[" "+le]=le+"/":S[" "+le]=ne(le,"/",!0)),le=S[" "+le];var Q=le.indexOf(":")===-1;return ie.substring(0,2)==="//"?Q?ie:le.replace(k,"$1")+ie:ie.charAt(0)==="/"?Q?ie:le.replace(I,"$1")+ie:le+ie}var z={exec:function(){}};function $(le){for(var ie=1,Q,R;ie<arguments.length;ie++){Q=arguments[ie];for(R in Q)Object.prototype.hasOwnProperty.call(Q,R)&&(le[R]=Q[R])}return le}function q(le,ie){var Q=le.replace(/\|/g,function(K,U,A){for(var C=!1,L=U;--L>=0&&A[L]==="\\";)C=!C;return C?"|":" |"}),R=Q.split(/ \|/),W=0;if(R[0].trim()||R.shift(),R.length>0&&!R[R.length-1].trim()&&R.pop(),R.length>ie)R.splice(ie);else for(;R.length<ie;)R.push("");for(;W<R.length;W++)R[W]=R[W].trim().replace(/\\\|/g,"|");return R}function ne(le,ie,Q){var R=le.length;if(R===0)return"";for(var W=0;W<R;){var K=le.charAt(R-W-1);if(K===ie&&!Q)W++;else if(K!==ie&&Q)W++;else break}return le.slice(0,R-W)}function de(le,ie){if(le.indexOf(ie[1])===-1)return-1;for(var Q=le.length,R=0,W=0;W<Q;W++)if(le[W]==="\\")W++;else if(le[W]===ie[0])R++;else if(le[W]===ie[1]&&(R--,R<0))return W;return-1}function me(le){le&&le.sanitize&&!le.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function De(le,ie){if(ie<1)return"";for(var Q="";ie>1;)ie&1&&(Q+=le),ie>>=1,le+=le;return Q+le}function ve(le,ie,Q,R){var W=ie.href,K=ie.title?p(ie.title):null,U=le[1].replace(/\\([\[\]])/g,"$1");if(le[0].charAt(0)!=="!"){R.state.inLink=!0;var A={type:"link",raw:Q,href:W,title:K,text:U,tokens:R.inlineTokens(U)};return R.state.inLink=!1,A}return{type:"image",raw:Q,href:W,title:K,text:p(U)}}function $e(le,ie){var Q=le.match(/^(\s+)(?:```)/);if(Q===null)return ie;var R=Q[1];return ie.split(`
`).map(function(W){var K=W.match(/^\s+/);if(K===null)return W;var U=K[0];return U.length>=R.length?W.slice(R.length):W}).join(`
`)}var Ne=function(){function le(Q){this.options=Q||e.defaults}var ie=le.prototype;return ie.space=function(R){var W=this.rules.block.newline.exec(R);if(W&&W[0].length>0)return{type:"space",raw:W[0]}},ie.code=function(R){var W=this.rules.block.code.exec(R);if(W){var K=W[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:W[0],codeBlockStyle:"indented",text:this.options.pedantic?K:ne(K,`
`)}}},ie.fences=function(R){var W=this.rules.block.fences.exec(R);if(W){var K=W[0],U=$e(K,W[3]||"");return{type:"code",raw:K,lang:W[2]?W[2].trim():W[2],text:U}}},ie.heading=function(R){var W=this.rules.block.heading.exec(R);if(W){var K=W[2].trim();if(/#$/.test(K)){var U=ne(K,"#");(this.options.pedantic||!U||/ $/.test(U))&&(K=U.trim())}return{type:"heading",raw:W[0],depth:W[1].length,text:K,tokens:this.lexer.inline(K)}}},ie.hr=function(R){var W=this.rules.block.hr.exec(R);if(W)return{type:"hr",raw:W[0]}},ie.blockquote=function(R){var W=this.rules.block.blockquote.exec(R);if(W){var K=W[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:W[0],tokens:this.lexer.blockTokens(K,[]),text:K}}},ie.list=function(R){var W=this.rules.block.list.exec(R);if(W){var K,U,A,C,L,O,j,Z,ce,Ue,Re,lt,ft=W[1].trim(),$t=ft.length>1,Rt={type:"list",raw:"",ordered:$t,start:$t?+ft.slice(0,-1):"",loose:!1,items:[]};ft=$t?"\\d{1,9}\\"+ft.slice(-1):"\\"+ft,this.options.pedantic&&(ft=$t?ft:"[*+-]");for(var qi=new RegExp("^( {0,3}"+ft+")((?:[	 ][^\\n]*)?(?:\\n|$))");R&&(lt=!1,!(!(W=qi.exec(R))||this.rules.block.hr.test(R)));){if(K=W[0],R=R.substring(K.length),Z=W[2].split(`
`,1)[0],ce=R.split(`
`,1)[0],this.options.pedantic?(C=2,Re=Z.trimLeft()):(C=W[2].search(/[^ ]/),C=C>4?1:C,Re=Z.slice(C),C+=W[1].length),O=!1,!Z&&/^ *$/.test(ce)&&(K+=ce+`
`,R=R.substring(ce.length+1),lt=!0),!lt)for(var jc=new RegExp("^ {0,"+Math.min(3,C-1)+"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))"),Fl=new RegExp("^ {0,"+Math.min(3,C-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),Gr=new RegExp("^ {0,"+Math.min(3,C-1)+"}(?:```|~~~)"),Pl=new RegExp("^ {0,"+Math.min(3,C-1)+"}#");R&&(Ue=R.split(`
`,1)[0],Z=Ue,this.options.pedantic&&(Z=Z.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Gr.test(Z)||Pl.test(Z)||jc.test(Z)||Fl.test(R)));){if(Z.search(/[^ ]/)>=C||!Z.trim())Re+=`
`+Z.slice(C);else if(!O)Re+=`
`+Z;else break;!O&&!Z.trim()&&(O=!0),K+=Ue+`
`,R=R.substring(Ue.length+1)}Rt.loose||(j?Rt.loose=!0:/\n *\n *$/.test(K)&&(j=!0)),this.options.gfm&&(U=/^\[[ xX]\] /.exec(Re),U&&(A=U[0]!=="[ ] ",Re=Re.replace(/^\[[ xX]\] +/,""))),Rt.items.push({type:"list_item",raw:K,task:!!U,checked:A,loose:!1,text:Re}),Rt.raw+=K}Rt.items[Rt.items.length-1].raw=K.trimRight(),Rt.items[Rt.items.length-1].text=Re.trimRight(),Rt.raw=Rt.raw.trimRight();var qc=Rt.items.length;for(L=0;L<qc;L++){this.lexer.state.top=!1,Rt.items[L].tokens=this.lexer.blockTokens(Rt.items[L].text,[]);var Ol=Rt.items[L].tokens.filter(function(Y){return Y.type==="space"}),Gc=Ol.every(function(Y){for(var ns=Y.raw.split(""),Sr=0,Js=o(ns),Kc;!(Kc=Js()).done;){var ht=Kc.value;if(ht===`
`&&(Sr+=1),Sr>1)return!0}return!1});!Rt.loose&&Ol.length&&Gc&&(Rt.loose=!0,Rt.items[L].loose=!0)}return Rt}},ie.html=function(R){var W=this.rules.block.html.exec(R);if(W){var K={type:"html",raw:W[0],pre:!this.options.sanitizer&&(W[1]==="pre"||W[1]==="script"||W[1]==="style"),text:W[0]};if(this.options.sanitize){var U=this.options.sanitizer?this.options.sanitizer(W[0]):p(W[0]);K.type="paragraph",K.text=U,K.tokens=this.lexer.inline(U)}return K}},ie.def=function(R){var W=this.rules.block.def.exec(R);if(W){W[3]&&(W[3]=W[3].substring(1,W[3].length-1));var K=W[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:K,raw:W[0],href:W[2],title:W[3]}}},ie.table=function(R){var W=this.rules.block.table.exec(R);if(W){var K={type:"table",header:q(W[1]).map(function(j){return{text:j}}),align:W[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:W[3]&&W[3].trim()?W[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(K.header.length===K.align.length){K.raw=W[0];var U=K.align.length,A,C,L,O;for(A=0;A<U;A++)/^ *-+: *$/.test(K.align[A])?K.align[A]="right":/^ *:-+: *$/.test(K.align[A])?K.align[A]="center":/^ *:-+ *$/.test(K.align[A])?K.align[A]="left":K.align[A]=null;for(U=K.rows.length,A=0;A<U;A++)K.rows[A]=q(K.rows[A],K.header.length).map(function(j){return{text:j}});for(U=K.header.length,C=0;C<U;C++)K.header[C].tokens=this.lexer.inline(K.header[C].text);for(U=K.rows.length,C=0;C<U;C++)for(O=K.rows[C],L=0;L<O.length;L++)O[L].tokens=this.lexer.inline(O[L].text);return K}}},ie.lheading=function(R){var W=this.rules.block.lheading.exec(R);if(W)return{type:"heading",raw:W[0],depth:W[2].charAt(0)==="="?1:2,text:W[1],tokens:this.lexer.inline(W[1])}},ie.paragraph=function(R){var W=this.rules.block.paragraph.exec(R);if(W){var K=W[1].charAt(W[1].length-1)===`
`?W[1].slice(0,-1):W[1];return{type:"paragraph",raw:W[0],text:K,tokens:this.lexer.inline(K)}}},ie.text=function(R){var W=this.rules.block.text.exec(R);if(W)return{type:"text",raw:W[0],text:W[0],tokens:this.lexer.inline(W[0])}},ie.escape=function(R){var W=this.rules.inline.escape.exec(R);if(W)return{type:"escape",raw:W[0],text:p(W[1])}},ie.tag=function(R){var W=this.rules.inline.tag.exec(R);if(W)return!this.lexer.state.inLink&&/^<a /i.test(W[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(W[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(W[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(W[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:W[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(W[0]):p(W[0]):W[0]}},ie.link=function(R){var W=this.rules.inline.link.exec(R);if(W){var K=W[2].trim();if(!this.options.pedantic&&/^</.test(K)){if(!/>$/.test(K))return;var U=ne(K.slice(0,-1),"\\");if((K.length-U.length)%2===0)return}else{var A=de(W[2],"()");if(A>-1){var C=W[0].indexOf("!")===0?5:4,L=C+W[1].length+A;W[2]=W[2].substring(0,A),W[0]=W[0].substring(0,L).trim(),W[3]=""}}var O=W[2],j="";if(this.options.pedantic){var Z=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(O);Z&&(O=Z[1],j=Z[3])}else j=W[3]?W[3].slice(1,-1):"";return O=O.trim(),/^</.test(O)&&(this.options.pedantic&&!/>$/.test(K)?O=O.slice(1):O=O.slice(1,-1)),ve(W,{href:O&&O.replace(this.rules.inline._escapes,"$1"),title:j&&j.replace(this.rules.inline._escapes,"$1")},W[0],this.lexer)}},ie.reflink=function(R,W){var K;if((K=this.rules.inline.reflink.exec(R))||(K=this.rules.inline.nolink.exec(R))){var U=(K[2]||K[1]).replace(/\s+/g," ");if(U=W[U.toLowerCase()],!U||!U.href){var A=K[0].charAt(0);return{type:"text",raw:A,text:A}}return ve(K,U,K[0],this.lexer)}},ie.emStrong=function(R,W,K){K===void 0&&(K="");var U=this.rules.inline.emStrong.lDelim.exec(R);if(U&&!(U[3]&&K.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var A=U[1]||U[2]||"";if(!A||A&&(K===""||this.rules.inline.punctuation.exec(K))){var C=U[0].length-1,L,O,j=C,Z=0,ce=U[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ce.lastIndex=0,W=W.slice(-1*R.length+C);(U=ce.exec(W))!=null;)if(L=U[1]||U[2]||U[3]||U[4]||U[5]||U[6],!!L){if(O=L.length,U[3]||U[4]){j+=O;continue}else if((U[5]||U[6])&&C%3&&!((C+O)%3)){Z+=O;continue}if(j-=O,!(j>0)){if(O=Math.min(O,O+j+Z),Math.min(C,O)%2){var Ue=R.slice(1,C+U.index+O);return{type:"em",raw:R.slice(0,C+U.index+O+1),text:Ue,tokens:this.lexer.inlineTokens(Ue)}}var Re=R.slice(2,C+U.index+O-1);return{type:"strong",raw:R.slice(0,C+U.index+O+1),text:Re,tokens:this.lexer.inlineTokens(Re)}}}}}},ie.codespan=function(R){var W=this.rules.inline.code.exec(R);if(W){var K=W[2].replace(/\n/g," "),U=/[^ ]/.test(K),A=/^ /.test(K)&&/ $/.test(K);return U&&A&&(K=K.substring(1,K.length-1)),K=p(K,!0),{type:"codespan",raw:W[0],text:K}}},ie.br=function(R){var W=this.rules.inline.br.exec(R);if(W)return{type:"br",raw:W[0]}},ie.del=function(R){var W=this.rules.inline.del.exec(R);if(W)return{type:"del",raw:W[0],text:W[2],tokens:this.lexer.inlineTokens(W[2])}},ie.autolink=function(R,W){var K=this.rules.inline.autolink.exec(R);if(K){var U,A;return K[2]==="@"?(U=p(this.options.mangle?W(K[1]):K[1]),A="mailto:"+U):(U=p(K[1]),A=U),{type:"link",raw:K[0],text:U,href:A,tokens:[{type:"text",raw:U,text:U}]}}},ie.url=function(R,W){var K;if(K=this.rules.inline.url.exec(R)){var U,A;if(K[2]==="@")U=p(this.options.mangle?W(K[0]):K[0]),A="mailto:"+U;else{var C;do C=K[0],K[0]=this.rules.inline._backpedal.exec(K[0])[0];while(C!==K[0]);U=p(K[0]),K[1]==="www."?A="http://"+U:A=U}return{type:"link",raw:K[0],text:U,href:A,tokens:[{type:"text",raw:U,text:U}]}}},ie.inlineText=function(R,W){var K=this.rules.inline.text.exec(R);if(K){var U;return this.lexer.state.inRawBlock?U=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(K[0]):p(K[0]):K[0]:U=p(this.options.smartypants?W(K[0]):K[0]),{type:"text",raw:K[0],text:U}}},le}(),xe={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:z,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};xe._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,xe._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,xe.def=w(xe.def).replace("label",xe._label).replace("title",xe._title).getRegex(),xe.bullet=/(?:[*+-]|\d{1,9}[.)])/,xe.listItemStart=w(/^( *)(bull) */).replace("bull",xe.bullet).getRegex(),xe.list=w(xe.list).replace(/bull/g,xe.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+xe.def.source+")").getRegex(),xe._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",xe._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,xe.html=w(xe.html,"i").replace("comment",xe._comment).replace("tag",xe._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),xe.paragraph=w(xe._paragraph).replace("hr",xe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe._tag).getRegex(),xe.blockquote=w(xe.blockquote).replace("paragraph",xe.paragraph).getRegex(),xe.normal=$({},xe),xe.gfm=$({},xe.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),xe.gfm.table=w(xe.gfm.table).replace("hr",xe.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe._tag).getRegex(),xe.gfm.paragraph=w(xe._paragraph).replace("hr",xe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",xe.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xe._tag).getRegex(),xe.pedantic=$({},xe.normal,{html:w(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",xe._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:z,paragraph:w(xe.normal._paragraph).replace("hr",xe.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xe.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var fe={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:z,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:z,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};fe._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",fe.punctuation=w(fe.punctuation).replace(/punctuation/g,fe._punctuation).getRegex(),fe.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,fe.escapedEmSt=/\\\*|\\_/g,fe._comment=w(xe._comment).replace("(?:-->|$)","-->").getRegex(),fe.emStrong.lDelim=w(fe.emStrong.lDelim).replace(/punct/g,fe._punctuation).getRegex(),fe.emStrong.rDelimAst=w(fe.emStrong.rDelimAst,"g").replace(/punct/g,fe._punctuation).getRegex(),fe.emStrong.rDelimUnd=w(fe.emStrong.rDelimUnd,"g").replace(/punct/g,fe._punctuation).getRegex(),fe._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,fe._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,fe._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,fe.autolink=w(fe.autolink).replace("scheme",fe._scheme).replace("email",fe._email).getRegex(),fe._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,fe.tag=w(fe.tag).replace("comment",fe._comment).replace("attribute",fe._attribute).getRegex(),fe._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,fe._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,fe._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,fe.link=w(fe.link).replace("label",fe._label).replace("href",fe._href).replace("title",fe._title).getRegex(),fe.reflink=w(fe.reflink).replace("label",fe._label).replace("ref",xe._label).getRegex(),fe.nolink=w(fe.nolink).replace("ref",xe._label).getRegex(),fe.reflinkSearch=w(fe.reflinkSearch,"g").replace("reflink",fe.reflink).replace("nolink",fe.nolink).getRegex(),fe.normal=$({},fe),fe.pedantic=$({},fe.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:w(/^!?\[(label)\]\((.*?)\)/).replace("label",fe._label).getRegex(),reflink:w(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",fe._label).getRegex()}),fe.gfm=$({},fe.normal,{escape:w(fe.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),fe.gfm.url=w(fe.gfm.url,"i").replace("email",fe.gfm._extended_email).getRegex(),fe.breaks=$({},fe.gfm,{br:w(fe.br).replace("{2,}","*").getRegex(),text:w(fe.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function jt(le){return le.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function mi(le){var ie="",Q,R,W=le.length;for(Q=0;Q<W;Q++)R=le.charCodeAt(Q),Math.random()>.5&&(R="x"+R.toString(16)),ie+="&#"+R+";";return ie}var re=function(){function le(Q){this.tokens=[],this.tokens.links=Object.create(null),this.options=Q||e.defaults,this.options.tokenizer=this.options.tokenizer||new Ne,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var R={block:xe.normal,inline:fe.normal};this.options.pedantic?(R.block=xe.pedantic,R.inline=fe.pedantic):this.options.gfm&&(R.block=xe.gfm,this.options.breaks?R.inline=fe.breaks:R.inline=fe.gfm),this.tokenizer.rules=R}le.lex=function(R,W){var K=new le(W);return K.lex(R)},le.lexInline=function(R,W){var K=new le(W);return K.inlineTokens(R)};var ie=le.prototype;return ie.lex=function(R){R=R.replace(/\r\n|\r/g,`
`),this.blockTokens(R,this.tokens);for(var W;W=this.inlineQueue.shift();)this.inlineTokens(W.src,W.tokens);return this.tokens},ie.blockTokens=function(R,W){var K=this;W===void 0&&(W=[]),this.options.pedantic?R=R.replace(/\t/g,"    ").replace(/^ +$/gm,""):R=R.replace(/^( *)(\t+)/gm,function(j,Z,ce){return Z+"    ".repeat(ce.length)});for(var U,A,C,L;R;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(j){return(U=j.call({lexer:K},R,W))?(R=R.substring(U.raw.length),W.push(U),!0):!1}))){if(U=this.tokenizer.space(R)){R=R.substring(U.raw.length),U.raw.length===1&&W.length>0?W[W.length-1].raw+=`
`:W.push(U);continue}if(U=this.tokenizer.code(R)){R=R.substring(U.raw.length),A=W[W.length-1],A&&(A.type==="paragraph"||A.type==="text")?(A.raw+=`
`+U.raw,A.text+=`
`+U.text,this.inlineQueue[this.inlineQueue.length-1].src=A.text):W.push(U);continue}if(U=this.tokenizer.fences(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.heading(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.hr(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.blockquote(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.list(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.html(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.def(R)){R=R.substring(U.raw.length),A=W[W.length-1],A&&(A.type==="paragraph"||A.type==="text")?(A.raw+=`
`+U.raw,A.text+=`
`+U.raw,this.inlineQueue[this.inlineQueue.length-1].src=A.text):this.tokens.links[U.tag]||(this.tokens.links[U.tag]={href:U.href,title:U.title});continue}if(U=this.tokenizer.table(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.lheading(R)){R=R.substring(U.raw.length),W.push(U);continue}if(C=R,this.options.extensions&&this.options.extensions.startBlock&&function(){var j=1/0,Z=R.slice(1),ce=void 0;K.options.extensions.startBlock.forEach(function(Ue){ce=Ue.call({lexer:this},Z),typeof ce=="number"&&ce>=0&&(j=Math.min(j,ce))}),j<1/0&&j>=0&&(C=R.substring(0,j+1))}(),this.state.top&&(U=this.tokenizer.paragraph(C))){A=W[W.length-1],L&&A.type==="paragraph"?(A.raw+=`
`+U.raw,A.text+=`
`+U.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=A.text):W.push(U),L=C.length!==R.length,R=R.substring(U.raw.length);continue}if(U=this.tokenizer.text(R)){R=R.substring(U.raw.length),A=W[W.length-1],A&&A.type==="text"?(A.raw+=`
`+U.raw,A.text+=`
`+U.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=A.text):W.push(U);continue}if(R){var O="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(O);break}else throw new Error(O)}}return this.state.top=!0,W},ie.inline=function(R,W){return W===void 0&&(W=[]),this.inlineQueue.push({src:R,tokens:W}),W},ie.inlineTokens=function(R,W){var K=this;W===void 0&&(W=[]);var U,A,C,L=R,O,j,Z;if(this.tokens.links){var ce=Object.keys(this.tokens.links);if(ce.length>0)for(;(O=this.tokenizer.rules.inline.reflinkSearch.exec(L))!=null;)ce.includes(O[0].slice(O[0].lastIndexOf("[")+1,-1))&&(L=L.slice(0,O.index)+"["+De("a",O[0].length-2)+"]"+L.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(O=this.tokenizer.rules.inline.blockSkip.exec(L))!=null;)L=L.slice(0,O.index)+"["+De("a",O[0].length-2)+"]"+L.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(O=this.tokenizer.rules.inline.escapedEmSt.exec(L))!=null;)L=L.slice(0,O.index)+"++"+L.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;R;)if(j||(Z=""),j=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Re){return(U=Re.call({lexer:K},R,W))?(R=R.substring(U.raw.length),W.push(U),!0):!1}))){if(U=this.tokenizer.escape(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.tag(R)){R=R.substring(U.raw.length),A=W[W.length-1],A&&U.type==="text"&&A.type==="text"?(A.raw+=U.raw,A.text+=U.text):W.push(U);continue}if(U=this.tokenizer.link(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.reflink(R,this.tokens.links)){R=R.substring(U.raw.length),A=W[W.length-1],A&&U.type==="text"&&A.type==="text"?(A.raw+=U.raw,A.text+=U.text):W.push(U);continue}if(U=this.tokenizer.emStrong(R,L,Z)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.codespan(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.br(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.del(R)){R=R.substring(U.raw.length),W.push(U);continue}if(U=this.tokenizer.autolink(R,mi)){R=R.substring(U.raw.length),W.push(U);continue}if(!this.state.inLink&&(U=this.tokenizer.url(R,mi))){R=R.substring(U.raw.length),W.push(U);continue}if(C=R,this.options.extensions&&this.options.extensions.startInline&&function(){var Re=1/0,lt=R.slice(1),ft=void 0;K.options.extensions.startInline.forEach(function($t){ft=$t.call({lexer:this},lt),typeof ft=="number"&&ft>=0&&(Re=Math.min(Re,ft))}),Re<1/0&&Re>=0&&(C=R.substring(0,Re+1))}(),U=this.tokenizer.inlineText(C,jt)){R=R.substring(U.raw.length),U.raw.slice(-1)!=="_"&&(Z=U.raw.slice(-1)),j=!0,A=W[W.length-1],A&&A.type==="text"?(A.raw+=U.raw,A.text+=U.text):W.push(U);continue}if(R){var Ue="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(Ue);break}else throw new Error(Ue)}}return W},i(le,null,[{key:"rules",get:function(){return{block:xe,inline:fe}}}]),le}(),te=function(){function le(Q){this.options=Q||e.defaults}var ie=le.prototype;return ie.code=function(R,W,K){var U=(W||"").match(/\S*/)[0];if(this.options.highlight){var A=this.options.highlight(R,U);A!=null&&A!==R&&(K=!0,R=A)}return R=R.replace(/\n$/,"")+`
`,U?'<pre><code class="'+this.options.langPrefix+p(U,!0)+'">'+(K?R:p(R,!0))+`</code></pre>
`:"<pre><code>"+(K?R:p(R,!0))+`</code></pre>
`},ie.blockquote=function(R){return`<blockquote>
`+R+`</blockquote>
`},ie.html=function(R){return R},ie.heading=function(R,W,K,U){if(this.options.headerIds){var A=this.options.headerPrefix+U.slug(K);return"<h"+W+' id="'+A+'">'+R+"</h"+W+`>
`}return"<h"+W+">"+R+"</h"+W+`>
`},ie.hr=function(){return this.options.xhtml?`<hr/>
`:`<hr>
`},ie.list=function(R,W,K){var U=W?"ol":"ul",A=W&&K!==1?' start="'+K+'"':"";return"<"+U+A+`>
`+R+"</"+U+`>
`},ie.listitem=function(R){return"<li>"+R+`</li>
`},ie.checkbox=function(R){return"<input "+(R?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},ie.paragraph=function(R){return"<p>"+R+`</p>
`},ie.table=function(R,W){return W&&(W="<tbody>"+W+"</tbody>"),`<table>
<thead>
`+R+`</thead>
`+W+`</table>
`},ie.tablerow=function(R){return`<tr>
`+R+`</tr>
`},ie.tablecell=function(R,W){var K=W.header?"th":"td",U=W.align?"<"+K+' align="'+W.align+'">':"<"+K+">";return U+R+("</"+K+`>
`)},ie.strong=function(R){return"<strong>"+R+"</strong>"},ie.em=function(R){return"<em>"+R+"</em>"},ie.codespan=function(R){return"<code>"+R+"</code>"},ie.br=function(){return this.options.xhtml?"<br/>":"<br>"},ie.del=function(R){return"<del>"+R+"</del>"},ie.link=function(R,W,K){if(R=D(this.options.sanitize,this.options.baseUrl,R),R===null)return K;var U='<a href="'+p(R)+'"';return W&&(U+=' title="'+W+'"'),U+=">"+K+"</a>",U},ie.image=function(R,W,K){if(R=D(this.options.sanitize,this.options.baseUrl,R),R===null)return K;var U='<img src="'+R+'" alt="'+K+'"';return W&&(U+=' title="'+W+'"'),U+=this.options.xhtml?"/>":">",U},ie.text=function(R){return R},le}(),ye=function(){function le(){}var ie=le.prototype;return ie.strong=function(R){return R},ie.em=function(R){return R},ie.codespan=function(R){return R},ie.del=function(R){return R},ie.html=function(R){return R},ie.text=function(R){return R},ie.link=function(R,W,K){return""+K},ie.image=function(R,W,K){return""+K},ie.br=function(){return""},le}(),_e=function(){function le(){this.seen={}}var ie=le.prototype;return ie.serialize=function(R){return R.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},ie.getNextSafeSlug=function(R,W){var K=R,U=0;if(this.seen.hasOwnProperty(K)){U=this.seen[R];do U++,K=R+"-"+U;while(this.seen.hasOwnProperty(K))}return W||(this.seen[R]=U,this.seen[K]=0),K},ie.slug=function(R,W){W===void 0&&(W={});var K=this.serialize(R);return this.getNextSafeSlug(K,W.dryrun)},le}(),Ie=function(){function le(Q){this.options=Q||e.defaults,this.options.renderer=this.options.renderer||new te,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ye,this.slugger=new _e}le.parse=function(R,W){var K=new le(W);return K.parse(R)},le.parseInline=function(R,W){var K=new le(W);return K.parseInline(R)};var ie=le.prototype;return ie.parse=function(R,W){W===void 0&&(W=!0);var K="",U,A,C,L,O,j,Z,ce,Ue,Re,lt,ft,$t,Rt,qi,jc,Fl,Gr,Pl,qc=R.length;for(U=0;U<qc;U++){if(Re=R[U],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Re.type]&&(Pl=this.options.extensions.renderers[Re.type].call({parser:this},Re),Pl!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Re.type))){K+=Pl||"";continue}switch(Re.type){case"space":continue;case"hr":{K+=this.renderer.hr();continue}case"heading":{K+=this.renderer.heading(this.parseInline(Re.tokens),Re.depth,b(this.parseInline(Re.tokens,this.textRenderer)),this.slugger);continue}case"code":{K+=this.renderer.code(Re.text,Re.lang,Re.escaped);continue}case"table":{for(ce="",Z="",L=Re.header.length,A=0;A<L;A++)Z+=this.renderer.tablecell(this.parseInline(Re.header[A].tokens),{header:!0,align:Re.align[A]});for(ce+=this.renderer.tablerow(Z),Ue="",L=Re.rows.length,A=0;A<L;A++){for(j=Re.rows[A],Z="",O=j.length,C=0;C<O;C++)Z+=this.renderer.tablecell(this.parseInline(j[C].tokens),{header:!1,align:Re.align[C]});Ue+=this.renderer.tablerow(Z)}K+=this.renderer.table(ce,Ue);continue}case"blockquote":{Ue=this.parse(Re.tokens),K+=this.renderer.blockquote(Ue);continue}case"list":{for(lt=Re.ordered,ft=Re.start,$t=Re.loose,L=Re.items.length,Ue="",A=0;A<L;A++)qi=Re.items[A],jc=qi.checked,Fl=qi.task,Rt="",qi.task&&(Gr=this.renderer.checkbox(jc),$t?qi.tokens.length>0&&qi.tokens[0].type==="paragraph"?(qi.tokens[0].text=Gr+" "+qi.tokens[0].text,qi.tokens[0].tokens&&qi.tokens[0].tokens.length>0&&qi.tokens[0].tokens[0].type==="text"&&(qi.tokens[0].tokens[0].text=Gr+" "+qi.tokens[0].tokens[0].text)):qi.tokens.unshift({type:"text",text:Gr}):Rt+=Gr),Rt+=this.parse(qi.tokens,$t),Ue+=this.renderer.listitem(Rt,Fl,jc);K+=this.renderer.list(Ue,lt,ft);continue}case"html":{K+=this.renderer.html(Re.text);continue}case"paragraph":{K+=this.renderer.paragraph(this.parseInline(Re.tokens));continue}case"text":{for(Ue=Re.tokens?this.parseInline(Re.tokens):Re.text;U+1<qc&&R[U+1].type==="text";)Re=R[++U],Ue+=`
`+(Re.tokens?this.parseInline(Re.tokens):Re.text);K+=W?this.renderer.paragraph(Ue):Ue;continue}default:{var Ol='Token with "'+Re.type+'" type was not found.';if(this.options.silent){console.error(Ol);return}else throw new Error(Ol)}}}return K},ie.parseInline=function(R,W){W=W||this.renderer;var K="",U,A,C,L=R.length;for(U=0;U<L;U++){if(A=R[U],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[A.type]&&(C=this.options.extensions.renderers[A.type].call({parser:this},A),C!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(A.type))){K+=C||"";continue}switch(A.type){case"escape":{K+=W.text(A.text);break}case"html":{K+=W.html(A.text);break}case"link":{K+=W.link(A.href,A.title,this.parseInline(A.tokens,W));break}case"image":{K+=W.image(A.href,A.title,A.text);break}case"strong":{K+=W.strong(this.parseInline(A.tokens,W));break}case"em":{K+=W.em(this.parseInline(A.tokens,W));break}case"codespan":{K+=W.codespan(A.text);break}case"br":{K+=W.br();break}case"del":{K+=W.del(this.parseInline(A.tokens,W));break}case"text":{K+=W.text(A.text);break}default:{var O='Token with "'+A.type+'" type was not found.';if(this.options.silent){console.error(O);return}else throw new Error(O)}}}return K},le}();function F(le,ie,Q){if(typeof le>"u"||le===null)throw new Error("marked(): input parameter is undefined or null");if(typeof le!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(le)+", string expected");if(typeof ie=="function"&&(Q=ie,ie=null),ie=$({},F.defaults,ie||{}),me(ie),Q){var R=ie.highlight,W;try{W=re.lex(le,ie)}catch(L){return Q(L)}var K=function(O){var j;if(!O)try{ie.walkTokens&&F.walkTokens(W,ie.walkTokens),j=Ie.parse(W,ie)}catch(Z){O=Z}return ie.highlight=R,O?Q(O):Q(null,j)};if(!R||R.length<3||(delete ie.highlight,!W.length))return K();var U=0;F.walkTokens(W,function(L){L.type==="code"&&(U++,setTimeout(function(){R(L.text,L.lang,function(O,j){if(O)return K(O);j!=null&&j!==L.text&&(L.text=j,L.escaped=!0),U--,U===0&&K()})},0))}),U===0&&K();return}function A(L){if(L.message+=`
Please report this to https://github.com/markedjs/marked.`,ie.silent)return"<p>An error occurred:</p><pre>"+p(L.message+"",!0)+"</pre>";throw L}try{var C=re.lex(le,ie);if(ie.walkTokens){if(ie.async)return Promise.all(F.walkTokens(C,ie.walkTokens)).then(function(){return Ie.parse(C,ie)}).catch(A);F.walkTokens(C,ie.walkTokens)}return Ie.parse(C,ie)}catch(L){A(L)}}F.options=F.setOptions=function(le){return $(F.defaults,le),l(F.defaults),F},F.getDefaults=a,F.defaults=e.defaults,F.use=function(){for(var le=arguments.length,ie=new Array(le),Q=0;Q<le;Q++)ie[Q]=arguments[Q];var R=$.apply(void 0,[{}].concat(ie)),W=F.defaults.extensions||{renderers:{},childTokens:{}},K;ie.forEach(function(U){if(U.extensions&&(K=!0,U.extensions.forEach(function(C){if(!C.name)throw new Error("extension name required");if(C.renderer){var L=W.renderers?W.renderers[C.name]:null;L?W.renderers[C.name]=function(){for(var O=arguments.length,j=new Array(O),Z=0;Z<O;Z++)j[Z]=arguments[Z];var ce=C.renderer.apply(this,j);return ce===!1&&(ce=L.apply(this,j)),ce}:W.renderers[C.name]=C.renderer}if(C.tokenizer){if(!C.level||C.level!=="block"&&C.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");W[C.level]?W[C.level].unshift(C.tokenizer):W[C.level]=[C.tokenizer],C.start&&(C.level==="block"?W.startBlock?W.startBlock.push(C.start):W.startBlock=[C.start]:C.level==="inline"&&(W.startInline?W.startInline.push(C.start):W.startInline=[C.start]))}C.childTokens&&(W.childTokens[C.name]=C.childTokens)})),U.renderer&&function(){var C=F.defaults.renderer||new te,L=function(Z){var ce=C[Z];C[Z]=function(){for(var Ue=arguments.length,Re=new Array(Ue),lt=0;lt<Ue;lt++)Re[lt]=arguments[lt];var ft=U.renderer[Z].apply(C,Re);return ft===!1&&(ft=ce.apply(C,Re)),ft}};for(var O in U.renderer)L(O);R.renderer=C}(),U.tokenizer&&function(){var C=F.defaults.tokenizer||new Ne,L=function(Z){var ce=C[Z];C[Z]=function(){for(var Ue=arguments.length,Re=new Array(Ue),lt=0;lt<Ue;lt++)Re[lt]=arguments[lt];var ft=U.tokenizer[Z].apply(C,Re);return ft===!1&&(ft=ce.apply(C,Re)),ft}};for(var O in U.tokenizer)L(O);R.tokenizer=C}(),U.walkTokens){var A=F.defaults.walkTokens;R.walkTokens=function(C){var L=[];return L.push(U.walkTokens.call(this,C)),A&&(L=L.concat(A.call(this,C))),L}}K&&(R.extensions=W),F.setOptions(R)})},F.walkTokens=function(le,ie){for(var Q=[],R=function(){var A=K.value;switch(Q=Q.concat(ie.call(F,A)),A.type){case"table":{for(var C=o(A.header),L;!(L=C()).done;){var O=L.value;Q=Q.concat(F.walkTokens(O.tokens,ie))}for(var j=o(A.rows),Z;!(Z=j()).done;)for(var ce=Z.value,Ue=o(ce),Re;!(Re=Ue()).done;){var lt=Re.value;Q=Q.concat(F.walkTokens(lt.tokens,ie))}break}case"list":{Q=Q.concat(F.walkTokens(A.items,ie));break}default:F.defaults.extensions&&F.defaults.extensions.childTokens&&F.defaults.extensions.childTokens[A.type]?F.defaults.extensions.childTokens[A.type].forEach(function(ft){Q=Q.concat(F.walkTokens(A[ft],ie))}):A.tokens&&(Q=Q.concat(F.walkTokens(A.tokens,ie)))}},W=o(le),K;!(K=W()).done;)R();return Q},F.parseInline=function(le,ie){if(typeof le>"u"||le===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof le!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(le)+", string expected");ie=$({},F.defaults,ie||{}),me(ie);try{var Q=re.lexInline(le,ie);return ie.walkTokens&&F.walkTokens(Q,ie.walkTokens),Ie.parseInline(Q,ie)}catch(R){if(R.message+=`
Please report this to https://github.com/markedjs/marked.`,ie.silent)return"<p>An error occurred:</p><pre>"+p(R.message+"",!0)+"</pre>";throw R}},F.Parser=Ie,F.parser=Ie.parse,F.Renderer=te,F.TextRenderer=ye,F.Lexer=re,F.lexer=re.lex,F.Tokenizer=Ne,F.Slugger=_e,F.parse=F;var M=F.options,pe=F.setOptions,ke=F.use,et=F.walkTokens,Xe=F.parseInline,Nt=F,is=Ie.parse,Zo=re.lex;e.Lexer=re,e.Parser=Ie,e.Renderer=te,e.Slugger=_e,e.TextRenderer=ye,e.Tokenizer=Ne,e.getDefaults=a,e.lexer=Zo,e.marked=F,e.options=M,e.parse=Nt,e.parseInline=Xe,e.parser=is,e.setOptions=pe,e.use=ke,e.walkTokens=et,Object.defineProperty(e,"__esModule",{value:!0})})})();Xs.Lexer||exports.Lexer;Xs.Parser||exports.Parser;Xs.Renderer||exports.Renderer;Xs.Slugger||exports.Slugger;Xs.TextRenderer||exports.TextRenderer;Xs.Tokenizer||exports.Tokenizer;Xs.getDefaults||exports.getDefaults;Xs.lexer||exports.lexer;var cc=Xs.marked||exports.marked;Xs.options||exports.options;Xs.parse||exports.parse;Xs.parseInline||exports.parseInline;Xs.parser||exports.parser;Xs.setOptions||exports.setOptions;Xs.use||exports.use;Xs.walkTokens||exports.walkTokens;function M9e(n){return JSON.stringify(n,F9e)}function XF(n){let e=JSON.parse(n);return e=QF(e),e}function F9e(n,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function QF(n,e=0){if(!n||e>200)return n;if(typeof n=="object"){switch(n.$mid){case 1:return ot.revive(n);case 2:return new RegExp(n.source,n.flags);case 17:return new Date(n.source)}if(n instanceof k8||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let t=0;t<n.length;++t)n[t]=QF(n[t],e+1);else for(const t in n)Object.hasOwnProperty.call(n,t)&&(n[t]=QF(n[t],e+1))}return n}const ER=Object.freeze({image:(n,e,t)=>{let i=[],s=[];return n&&({href:n,dimensions:i}=k9e(n),s.push(`src="${Jx(n)}"`)),t&&s.push(`alt="${Jx(t)}"`),e&&s.push(`title="${Jx(e)}"`),i.length&&(s=s.concat(i)),"<img "+s.join(" ")+">"},paragraph:n=>`<p>${n}</p>`,link:(n,e,t)=>typeof n!="string"?"":(n===t&&(t=DR(t)),e=typeof e=="string"?Jx(DR(e)):"",n=DR(n),n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${n}" title="${e||n}">${t}</a>`)});function QT(n,e={},t={}){var i,s;const r=new Ae;let o=!1;const a=k7(e),l=function(b){let v;try{v=XF(decodeURIComponent(b))}catch{}return v?(v=aie(v,w=>{if(n.uris&&n.uris[w])return ot.revive(n.uris[w])}),encodeURIComponent(JSON.stringify(v))):b},c=function(b,v){const w=n.uris&&n.uris[b];let y=ot.revive(w);return v?b.startsWith(bt.data+":")?b:(y||(y=ot.parse(b)),ene.uriToBrowserUri(y).toString(!0)):!y||ot.parse(b).toString()===y.toString()?b:(y.query&&(y=y.with({query:l(y.query)})),y.toString())},u=new cc.Renderer;u.image=ER.image,u.link=ER.link,u.paragraph=ER.paragraph;const h=[],d=[];if(e.codeBlockRendererSync?u.code=(b,v)=>{const w=YF.nextId(),y=e.codeBlockRendererSync(eq(v),b);return d.push([w,y]),`<div class="code" data-code="${w}">${NL(b)}</div>`}:e.codeBlockRenderer&&(u.code=(b,v)=>{const w=YF.nextId(),y=e.codeBlockRenderer(eq(v),b);return h.push(y.then(x=>[w,x])),`<div class="code" data-code="${w}">${NL(b)}</div>`}),e.actionHandler){const b=function(y){let x=y.target;if(!(x.tagName!=="A"&&(x=x.parentElement,!x||x.tagName!=="A")))try{let D=x.dataset.href;D&&(n.baseUri&&(D=TR(ot.from(n.baseUri),D)),e.actionHandler.callback(D,y))}catch(D){Ft(D)}finally{y.preventDefault()}},v=e.actionHandler.disposables.add(new xt(a,"click")),w=e.actionHandler.disposables.add(new xt(a,"auxclick"));e.actionHandler.disposables.add(Ee.any(v.event,w.event)(y=>{const x=new ba(y);!x.leftButton&&!x.middleButton||b(x)})),e.actionHandler.disposables.add(oe(a,"keydown",y=>{const x=new ri(y);!x.equals(10)&&!x.equals(3)||b(x)}))}n.supportHtml||(t.sanitizer=b=>(n.isTrusted?b.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?b:"",t.sanitize=!0,t.silent=!0),t.renderer=u;let f=(i=n.value)!==null&&i!==void 0?i:"";f.length>1e5&&(f=`${f.substr(0,1e5)}…`),n.supportThemeIcons&&(f=w9e(f));let g;if(e.fillInIncompleteTokens){const b=Object.assign(Object.assign({},cc.defaults),t),v=cc.lexer(f,b),w=H9e(v);g=cc.parser(w,b)}else g=cc.parse(f,t);n.supportThemeIcons&&(g=Qg(g).map(v=>typeof v=="string"?v:v.outerHTML).join(""));const m=new DOMParser().parseFromString(JF(n,g),"text/html");if(m.body.querySelectorAll("img").forEach(b=>{const v=b.getAttribute("src");if(v){let w=v;try{n.baseUri&&(w=TR(ot.from(n.baseUri),w))}catch{}b.src=c(w,!0)}}),m.body.querySelectorAll("a").forEach(b=>{const v=b.getAttribute("href");if(b.setAttribute("href",""),!v||/^data:|javascript:/i.test(v)||/^command:/i.test(v)&&!n.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(v))b.replaceWith(...b.childNodes);else{let w=c(v,!1);n.baseUri&&(w=TR(ot.from(n.baseUri),v)),b.dataset.href=w}}),a.innerHTML=JF(n,m.body.innerHTML),h.length>0)Promise.all(h).then(b=>{var v,w;if(o)return;const y=new Map(b),x=a.querySelectorAll("div[data-code]");for(const D of x){const S=y.get((v=D.dataset.code)!==null&&v!==void 0?v:"");S&&qs(D,S)}(w=e.asyncRenderCallback)===null||w===void 0||w.call(e)});else if(d.length>0){const b=new Map(d),v=a.querySelectorAll("div[data-code]");for(const w of v){const y=b.get((s=w.dataset.code)!==null&&s!==void 0?s:"");y&&qs(w,y)}}if(e.asyncRenderCallback)for(const b of a.getElementsByTagName("img")){const v=r.add(oe(b,"load",()=>{v.dispose(),e.asyncRenderCallback()}))}return{element:a,dispose:()=>{o=!0,r.dispose()}}}function eq(n){if(!n)return"";const e=n.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:n}function TR(n,e){return/^\w[\w\d+.-]*:/.test(e)?e:n.path.endsWith("/")?GU(n,e).toString():GU(n7(n),e).toString()}function JF(n,e){const{config:t,allowedSchemes:i}=O9e(n);Xie("uponSanitizeAttribute",(r,o)=>{if(o.attrName==="style"||o.attrName==="class"){if(r.tagName==="SPAN"){if(o.attrName==="style"){o.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?$/.test(o.attrValue);return}else if(o.attrName==="class"){o.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(o.attrValue);return}}o.keepAttr=!1;return}});const s=INe(i);try{return Yie(e,Object.assign(Object.assign({},t),{RETURN_TRUSTED_TYPE:!0}))}finally{Qie("uponSanitizeAttribute"),s.dispose()}}const P9e=["align","autoplay","alt","class","controls","data-code","data-href","height","href","loop","muted","playsinline","poster","src","style","target","title","width","start"];function O9e(n){const e=[bt.http,bt.https,bt.mailto,bt.data,bt.file,bt.vscodeFileResource,bt.vscodeRemote,bt.vscodeRemoteResource];return n.isTrusted&&e.push(bt.command),{config:{ALLOWED_TAGS:[...NNe],ALLOWED_ATTR:P9e,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function B9e(n){return typeof n=="string"?n:W9e(n)}function W9e(n){var e;let t=(e=n.value)!==null&&e!==void 0?e:"";t.length>1e5&&(t=`${t.substr(0,1e5)}…`);const i=cc.parse(t,{renderer:$9e.value}).replace(/&(#\d+|[a-zA-Z]+);/g,s=>{var r;return(r=V9e.get(s))!==null&&r!==void 0?r:s});return JF({isTrusted:!1},i).toString()}const V9e=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]),$9e=new Jp(()=>{const n=new cc.Renderer;return n.code=e=>e,n.blockquote=e=>e,n.html=e=>"",n.heading=(e,t,i)=>e+`
`,n.hr=()=>"",n.list=(e,t)=>e,n.listitem=e=>e+`
`,n.paragraph=e=>e+`
`,n.table=(e,t)=>e+t+`
`,n.tablerow=e=>e,n.tablecell=(e,t)=>e+" ",n.strong=e=>e,n.em=e=>e,n.codespan=e=>e,n.br=()=>`
`,n.del=e=>e,n.image=(e,t,i)=>"",n.text=e=>e,n.link=(e,t,i)=>i,n});function D7(n){let e="";return n.forEach(t=>{e+=t.raw}),e}function z9e(n){for(const e of n.tokens)if(e.type==="text"){const t=e.raw.split(`
`),i=t[t.length-1];if(i.includes("`"))return j9e(n);if(i.includes("**"))return Y9e(n);if(i.match(/\*\w/))return q9e(n);if(i.match(/(^|\s)__\w/))return X9e(n);if(i.match(/(^|\s)_\w/))return G9e(n);if(i.match(/(^|\s)\[.*\]\(\w*/))return K9e(n);if(i.match(/(^|\s)\[\w/))return Z9e(n)}}function H9e(n){let e,t;for(e=0;e<n.length;e++){const i=n[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)```/)){t=U9e(n.slice(e));break}if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=Q9e(n.slice(e));break}if(e===n.length-1&&i.type==="paragraph"){const s=z9e(i);if(s){t=[s];break}}}if(t){const i=[...n.slice(0,e),...t];return i.links=n.links,i}return n}function U9e(n){const e=D7(n);return cc.lexer(e+"\n```")}function j9e(n){return um(n,"`")}function q9e(n){return um(n,"*")}function G9e(n){return um(n,"_")}function K9e(n){return um(n,")")}function Z9e(n){return um(n,"](about:blank)")}function Y9e(n){return um(n,"**")}function X9e(n){return um(n,"__")}function um(n,e){const t=D7(Array.isArray(n)?n:[n]);return cc.lexer(t+e)[0]}function Q9e(n){const e=D7(n),t=e.split(`
`);let i,s=!1;for(let r=0;r<t.length;r++){const o=t[r].trim();if(typeof i>"u"&&o.match(/^\s*\|/)){const a=o.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(o.match(/^\s*\|/)){if(r!==t.length-1)return;s=!0}else return}if(typeof i=="number"&&i>0){const r=s?t.slice(0,-1).join(`
`):e,o=!!r.match(/\|\s*$/),a=r+(o?"":"|")+`
|${" --- |".repeat(i)}`;return cc.lexer(a)}}class J9e{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(s=>s.splice(e,t,i))}}class Hm extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function tq(n,e){const t=[];for(const i of e){if(n.start>=i.range.end)continue;if(n.end<i.range.start)break;const s=ss.intersect(n,i.range);ss.isEmpty(s)||t.push({range:s,size:i.size})}return t}function eP({start:n,end:e},t){return{start:n+t,end:e+t}}function eBe(n){const e=[];let t=null;for(const i of n){const s=i.range.start,r=i.range.end,o=i.size;if(t&&o===t.size){t.range.end=r;continue}t={range:{start:s,end:r},size:o},e.push(t)}return e}function tBe(...n){return eBe(n.reduce((e,t)=>e.concat(t),[]))}class iq{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const s=i.length-t,r=tq({start:0,end:e},this.groups),o=tq({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:eP(l.range,s),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=tBe(r,a,o),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const s of this.groups){const r=s.range.end-s.range.start,o=i+r*s.size;if(e<o)return t+Math.floor((e-i)/s.size);t+=r,i=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const s of this.groups){const r=s.range.end-s.range.start,o=i+r;if(e<o)return this._paddingTop+t+(e-i)*s.size;t+=r*s.size,i=o}return-1}}function iBe(n){var e;try{(e=n.parentElement)===null||e===void 0||e.removeChild(n)}catch{}}class nBe{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const s=Be(".monaco-list-row"),o=this.getRenderer(e).renderTemplate(s);t={domNode:s,templateId:e,templateData:o}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),iBe(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var dh=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};const zf={CurrentDragAndDropData:void 0},zl={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(n){return[n]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class kS{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class sBe{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class rBe{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function oBe(n,e){return Array.isArray(n)&&Array.isArray(e)?yn(n,e):n===e}class aBe{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,s)=>s,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}class Go{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:FN(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,s=zl){var r,o,a,l,c,u,h,d,f,g,p,m,b;if(this.virtualDelegate=t,this.domId=`list_id_${++Go.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new xf(50),this.splicing=!1,this.dragOverAnimationStopDisposable=ae.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=ae.None,this.onDragLeaveTimeout=ae.None,this.disposables=new Ae,this._onDidChangeContentHeight=new G,this._onDidChangeContentWidth=new G,this._horizontalScrolling=!1,s.horizontalScrolling&&s.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new iq((r=s.paddingTop)!==null&&r!==void 0?r:0);for(const w of i)this.renderers.set(w.templateId,w);this.cache=this.disposables.add(new nBe(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof s.mouseSupport=="boolean"?s.mouseSupport:!0),this._horizontalScrolling=(o=s.horizontalScrolling)!==null&&o!==void 0?o:zl.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof s.paddingBottom>"u"?0:s.paddingBottom,this.accessibilityProvider=new aBe(s.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",((a=s.transformOptimization)!==null&&a!==void 0?a:zl.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Zt.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new vS({forceIntegerValues:!0,smoothScrollDuration:(l=s.smoothScrolling)!==null&&l!==void 0&&l?125:0,scheduleAtNextAnimationFrame:w=>$o(w)})),this.scrollableElement=this.disposables.add(new G8(this.rowsContainer,{alwaysConsumeMouseWheel:(c=s.alwaysConsumeMouseWheel)!==null&&c!==void 0?c:zl.alwaysConsumeMouseWheel,horizontal:1,vertical:(u=s.verticalScrollMode)!==null&&u!==void 0?u:zl.verticalScrollMode,useShadows:(h=s.useShadows)!==null&&h!==void 0?h:zl.useShadows,mouseWheelScrollSensitivity:s.mouseWheelScrollSensitivity,fastScrollSensitivity:s.fastScrollSensitivity,scrollByPage:s.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(oe(this.rowsContainer,Jt.Change,w=>this.onTouchChange(w))),this.disposables.add(oe(this.scrollableElement.getDomNode(),"scroll",w=>w.target.scrollTop=0)),this.disposables.add(oe(this.domNode,"dragover",w=>this.onDragOver(this.toDragEvent(w)))),this.disposables.add(oe(this.domNode,"drop",w=>this.onDrop(this.toDragEvent(w)))),this.disposables.add(oe(this.domNode,"dragleave",w=>this.onDragLeave(this.toDragEvent(w)))),this.disposables.add(oe(this.domNode,"dragend",w=>this.onDragEnd(w))),this.setRowLineHeight=(d=s.setRowLineHeight)!==null&&d!==void 0?d:zl.setRowLineHeight,this.setRowHeight=(f=s.setRowHeight)!==null&&f!==void 0?f:zl.setRowHeight,this.supportDynamicHeights=(g=s.supportDynamicHeights)!==null&&g!==void 0?g:zl.supportDynamicHeights,this.dnd=(p=s.dnd)!==null&&p!==void 0?p:this.disposables.add(zl.dnd),this.layout((m=s.initialSize)===null||m===void 0?void 0:m.height,(b=s.initialSize)===null||b===void 0?void 0:b.width)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t=Object.assign(Object.assign({},t??{}),{scrollByPage:e.scrollByPage})),e.mouseWheelScrollSensitivity!==void 0&&(t=Object.assign(Object.assign({},t??{}),{mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity})),e.fastScrollSensitivity!==void 0&&(t=Object.assign(Object.assign({},t??{}),{fastScrollSensitivity:e.fastScrollSensitivity})),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const s=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),r={start:e,end:e+t},o=ss.intersect(s,r),a=new Map;for(let D=o.end-1;D>=o.start;D--){const S=this.items[D];if(S.dragStartDisposable.dispose(),S.checkedDisposable.dispose(),S.row){let T=a.get(S.templateId);T||(T=[],a.set(S.templateId,T));const k=this.renderers.get(S.templateId);k&&k.disposeElement&&k.disposeElement(S.element,D,S.row.templateData,S.size),T.push(S.row)}S.row=null}const l={start:e+t,end:this.items.length},c=ss.intersect(l,s),u=ss.relativeComplement(l,s),h=i.map(D=>({id:String(this.itemId++),element:D,templateId:this.virtualDelegate.getTemplateId(D),size:this.virtualDelegate.getHeight(D),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(D),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:ae.None,checkedDisposable:ae.None}));let d;e===0&&t>=this.items.length?(this.rangeMap=new iq(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,h),d=this.items,this.items=h):(this.rangeMap.splice(e,t,h),d=this.items.splice(e,t,...h));const f=i.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),p=eP(c,f),m=ss.intersect(g,p);for(let D=m.start;D<m.end;D++)this.updateItemInDOM(this.items[D],D);const b=ss.relativeComplement(p,g);for(const D of b)for(let S=D.start;S<D.end;S++)this.removeItemFromDOM(S);const v=u.map(D=>eP(D,f)),y=[{start:e,end:e+i.length},...v].map(D=>ss.intersect(g,D)),x=this.getNextToLastElement(y);for(const D of y)for(let S=D.start;S<D.end;S++){const T=this.items[S],k=a.get(T.templateId),I=k==null?void 0:k.pop();this.insertItemInDOM(S,x,I)}for(const D of a.values())for(const S of D)this.cache.release(S);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),d.map(D=>D.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=$o(()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){const e=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),t=this.rangeMap.positionAt(e.start),i=this.rangeMap.positionAt(e.start+1);return i!==-1&&(i-t)/2+t<this.scrollTop?e.start+1:e.start}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:yNe(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:FN(this.domNode)})}render(e,t,i,s,r,o=!1){const a=this.getRenderRange(t,i),l=ss.relativeComplement(a,e),c=ss.relativeComplement(e,a),u=this.getNextToLastElement(l);if(o){const h=ss.intersect(e,a);for(let d=h.start;d<h.end;d++)this.updateItemInDOM(this.items[d],d)}this.cache.transact(()=>{for(const h of c)for(let d=h.start;d<h.end;d++)this.removeItemFromDOM(d);for(const h of l)for(let d=h.start;d<h.end;d++)this.insertItemInDOM(d,u)}),s!==void 0&&(this.rowsContainer.style.left=`-${s}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&r!==void 0&&(this.rowsContainer.style.width=`${Math.max(r,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t,i){const s=this.items[e];let r=!1;if(!s.row)if(i)s.row=i;else{const u=this.cache.alloc(s.templateId);s.row=u.row,r=u.isReusingConnectedDomNode}const o=this.accessibilityProvider.getRole(s.element)||"listitem";s.row.domNode.setAttribute("role",o);const a=this.accessibilityProvider.isChecked(s.element);if(typeof a=="boolean")s.row.domNode.setAttribute("aria-checked",String(!!a));else if(a){const u=h=>s.row.domNode.setAttribute("aria-checked",String(!!h));u(a.value),s.checkedDisposable=a.onDidChange(u)}(r||!s.row.domNode.parentElement)&&(t?this.rowsContainer.insertBefore(s.row.domNode,t):this.rowsContainer.appendChild(s.row.domNode)),this.updateItemInDOM(s,e);const l=this.renderers.get(s.templateId);if(!l)throw new Error(`No renderer found for template id ${s.templateId}`);l==null||l.renderElement(s.element,e,s.row.templateData,s.size);const c=this.dnd.getDragURI(s.element);s.dragStartDisposable.dispose(),s.row.domNode.draggable=!!c,c&&(s.dragStartDisposable=oe(s.row.domNode,"dragstart",u=>this.onDragStart(s.element,c,u))),this.horizontalScrolling&&(this.measureItemWidth(s),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=FN(e.row.domNode);const t=window.getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return Ee.map(this.disposables.add(new xt(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return Ee.map(this.disposables.add(new xt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return Ee.filter(Ee.map(this.disposables.add(new xt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return Ee.map(this.disposables.add(new xt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return Ee.map(this.disposables.add(new xt(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return Ee.map(this.disposables.add(new xt(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return Ee.any(Ee.map(this.disposables.add(new xt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),Ee.map(this.disposables.add(new xt(this.domNode,Jt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return Ee.map(this.disposables.add(new xt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return Ee.map(this.disposables.add(new xt(this.rowsContainer,Jt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var s,r;if(!i.dataTransfer)return;const o=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(bre.TEXT,t),i.dataTransfer.setDragImage){let a;this.dnd.getDragLabel&&(a=this.dnd.getDragLabel(o,i)),typeof a>"u"&&(a=String(o.length));const l=Be(".monaco-drag-image");l.textContent=a;const u=(h=>{for(;h&&!h.classList.contains("monaco-workbench");)h=h.parentElement;return h||document.body})(this.domNode);u.appendChild(l),i.dataTransfer.setDragImage(l,-10,-10),setTimeout(()=>u.removeChild(l),0)}this.domNode.classList.add("dragging"),this.currentDragData=new kS(o),zf.CurrentDragAndDropData=new sBe(o),(r=(s=this.dnd).onDragStart)===null||r===void 0||r.call(s,this.currentDragData,i)}onDragOver(e){var t;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),zf.CurrentDragAndDropData&&zf.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(zf.CurrentDragAndDropData)this.currentDragData=zf.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new rBe}const i=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.browserEvent);if(this.canDrop=typeof i=="boolean"?i:i.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof i!="boolean"&&i.effect===0?"copy":"move";let s;if(typeof i!="boolean"&&i.feedback?s=i.feedback:typeof e.index>"u"?s=[-1]:s=[e.index],s=Cp(s).filter(r=>r>=-1&&r<this.length).sort((r,o)=>r-o),s=s[0]===-1?[-1]:s,oBe(this.currentDragFeedback,s))return!0;if(this.currentDragFeedback=s,this.currentDragFeedbackDisposable.dispose(),s[0]===-1)this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=ut(()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")});else{for(const r of s){const o=this.items[r];o.dropTarget=!0,(t=o.row)===null||t===void 0||t.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=ut(()=>{var r;for(const o of s){const a=this.items[o];a.dropTarget=!1,(r=a.row)===null||r===void 0||r.domNode.classList.remove("drop-target")}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=WL(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)===null||i===void 0||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,zf.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,zf.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=ae.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=nne(this.domNode).top;this.dragOverAnimationDisposable=ANe(this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=WL(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;i instanceof HTMLElement&&i!==this.rowsContainer&&t.contains(i);){const s=i.getAttribute("data-index");if(s){const r=Number(s);if(!isNaN(r))return r}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const s=this.getRenderRange(e,t);let r,o;e===this.elementTop(s.start)?(r=s.start,o=0):s.end-s.start>1&&(r=s.start+1,o=this.elementTop(r)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let u=l.start;u<l.end;u++){const h=this.probeDynamicHeight(u);h!==0&&this.rangeMap.splice(u,1,[this.items[u]]),a+=h,c=c||h!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const u=ss.relativeComplement(s,l);for(const d of u)for(let f=d.start;f<d.end;f++)this.items[f].row&&this.removeItemFromDOM(f);const h=ss.relativeComplement(l,s);for(const d of h)for(let f=d.start;f<d.end;f++){const g=f+1,p=g<this.items.length?this.items[g].row:null,m=p?p.domNode:null;this.insertItemInDOM(f,m)}for(let d=l.start;d<l.end;d++)this.items[d].row&&this.updateItemInDOM(this.items[d],d);if(typeof r=="number"){const d=this.scrollable.getFutureScrollPosition().scrollTop-e,f=this.elementTop(r)-o+d;this.setScrollTop(f,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var t,i,s;const r=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(r.element);if(c!==null){const u=r.size;return r.size=c,r.lastDynamicHeightWidth=this.renderWidth,c-u}}if(!r.hasDynamicHeight||r.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(r.element))return 0;const o=r.size;if(r.row)return r.row.domNode.style.height="",r.size=r.row.domNode.offsetHeight,r.lastDynamicHeightWidth=this.renderWidth,r.size-o;const{row:a}=this.cache.alloc(r.templateId);a.domNode.style.height="",this.rowsContainer.appendChild(a.domNode);const l=this.renderers.get(r.templateId);if(!l)throw new mn("Missing renderer for templateId: "+r.templateId);return l.renderElement(r.element,e,a.templateData,void 0),r.size=a.domNode.offsetHeight,(t=l.disposeElement)===null||t===void 0||t.call(l,r.element,e,a.templateData,void 0),(s=(i=this.virtualDelegate).setDynamicHeight)===null||s===void 0||s.call(i,r.element,r.size),r.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(a.domNode),this.cache.release(a),r.size-o}getNextToLastElement(e){const t=e[e.length-1];if(!t)return null;const i=this.items[t.end];return!i||!i.row?null:i.row.domNode}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t;for(const i of this.items)if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const s=this.renderers.get(i.row.templateId);s&&((e=s.disposeElement)===null||e===void 0||e.call(s,i.element,-1,i.row.templateData,void 0),s.disposeTemplate(i.row.templateData))}this.items=[],this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),(t=this.dragOverAnimationDisposable)===null||t===void 0||t.dispose(),this.disposables.dispose()}}Go.InstanceCount=0;dh([ji],Go.prototype,"onMouseClick",null);dh([ji],Go.prototype,"onMouseDblClick",null);dh([ji],Go.prototype,"onMouseMiddleClick",null);dh([ji],Go.prototype,"onMouseDown",null);dh([ji],Go.prototype,"onMouseOver",null);dh([ji],Go.prototype,"onMouseOut",null);dh([ji],Go.prototype,"onContextMenu",null);dh([ji],Go.prototype,"onTouchStart",null);dh([ji],Go.prototype,"onTap",null);var hm=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},nq=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class lBe{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const s=this.renderedElements.findIndex(r=>r.templateData===i);if(s>=0){const r=this.renderedElements[s];this.trait.unrender(i),r.index=t}else{const r={index:t,templateData:i};this.renderedElements.push(r)}this.trait.renderIndex(t,i)}splice(e,t,i){const s=[];for(const r of this.renderedElements)r.index<e?s.push(r):r.index>=e+t&&s.push({index:r.index+i-t,templateData:r.templateData});this.renderedElements=s}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let wD=class{get name(){return this._trait}get renderer(){return new lBe(this)}constructor(e){this._trait=e,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new G,this.onChange=this._onChange.event}splice(e,t,i){var s;t=Math.max(0,Math.min(t,this.length-e));const r=i.length-t,o=e+t,a=[];let l=0;for(;l<this.sortedIndexes.length&&this.sortedIndexes[l]<e;)a.push(this.sortedIndexes[l++]);for(let u=0;u<i.length;u++)i[u]&&a.push(u+e);for(;l<this.sortedIndexes.length&&this.sortedIndexes[l]>=o;)a.push(this.sortedIndexes[l++]+r);const c=this.length+r;if(this.sortedIndexes.length>0&&a.length===0&&c>0){const u=(s=this.sortedIndexes.find(h=>h>=e))!==null&&s!==void 0?s:c-1;a.push(Math.min(u,c-1))}this.renderer.splice(e,t,i.length),this._set(a,a),this.length=c}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(rq),t)}_set(e,t,i){const s=this.indexes,r=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=tP(r,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:i}),s}get(){return this.indexes}contains(e){return Qte(this.sortedIndexes,e,rq)>=0}dispose(){ti(this._onChange)}};hm([ji],wD.prototype,"renderer",null);class cBe extends wD{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class AR{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const s=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(s.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const r=new Set(s),o=i.map(a=>r.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,o)}}function Md(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"}function D0(n){return n.classList.contains("monaco-editor")?!0:n.classList.contains("monaco-list")||!n.parentElement?!1:D0(n.parentElement)}function Nre(n){return n.tagName==="A"&&n.classList.contains("monaco-button")||n.tagName==="DIV"&&n.classList.contains("monaco-button-dropdown")?!0:n.classList.contains("monaco-list")||!n.parentElement?!1:Nre(n.parentElement)}class Rre{get onKeyDown(){return Ee.chain(this.disposables.add(new xt(this.view.domNode,"keydown")).event,e=>e.filter(t=>!Md(t.target)).map(t=>new ri(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new Ae,this.multipleSelectionDisposables=new Ae,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(s=>{switch(s.keyCode){case 3:return this.onEnter(s);case 16:return this.onUpArrow(s);case 18:return this.onDownArrow(s);case 11:return this.onPageUpArrow(s);case 12:return this.onPageDownArrow(s);case 9:return this.onEscape(s);case 31:this.multipleSelectionSupport&&(Mt?s.metaKey:s.ctrlKey)&&this.onCtrlA(s)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Ps(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}hm([ji],Rre.prototype,"onKeyDown",null);var uc;(function(n){n[n.Automatic=0]="Automatic",n[n.Trigger=1]="Trigger"})(uc||(uc={}));var E0;(function(n){n[n.Idle=0]="Idle",n[n.Typing=1]="Typing"})(E0||(E0={}));const uBe=new class{mightProducePrintableCharacter(n){return n.ctrlKey||n.metaKey||n.altKey?!1:n.keyCode>=31&&n.keyCode<=56||n.keyCode>=21&&n.keyCode<=30||n.keyCode>=98&&n.keyCode<=107||n.keyCode>=85&&n.keyCode<=95}};class hBe{constructor(e,t,i,s,r){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=s,this.delegate=r,this.enabled=!1,this.state=E0.Idle,this.mode=uc.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new Ae,this.disposables=new Ae,this.updateOptions(e.options)}updateOptions(e){var t,i;!((t=e.typeNavigationEnabled)!==null&&t!==void 0)||t?this.enable():this.disable(),this.mode=(i=e.typeNavigationMode)!==null&&i!==void 0?i:uc.Automatic}enable(){if(this.enabled)return;let e=!1;const t=Ee.chain(this.enabledDisposables.add(new xt(this.view.domNode,"keydown")).event,r=>r.filter(o=>!Md(o.target)).filter(()=>this.mode===uc.Automatic||this.triggered).map(o=>new ri(o)).filter(o=>e||this.keyboardNavigationEventFilter(o)).filter(o=>this.delegate.mightProducePrintableCharacter(o)).forEach(o=>rt.stop(o,!0)).map(o=>o.browserEvent.key)),i=Ee.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);Ee.reduce(Ee.any(t,i),(r,o)=>o===null?null:(r||"")+o,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var e;const t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){const i=(e=this.list.options.accessibilityProvider)===null||e===void 0?void 0:e.getAriaLabel(this.list.element(t[0]));i&&_S(i)}this.previouslyFocused=-1}onInput(e){if(!e){this.state=E0.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,s=this.state===E0.Idle?1:0;this.state=E0.Typing;for(let r=0;r<this.list.length;r++){const o=(i+r+s)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(o)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(vD(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}const c=d9e(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}else if(typeof l>"u"||vD(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class dBe{constructor(e,t){this.list=e,this.view=t,this.disposables=new Ae;const i=Ee.chain(this.disposables.add(new xt(t.domNode,"keydown")).event,r=>r.filter(o=>!Md(o.target)).map(o=>new ri(o)));Ee.chain(i,r=>r.filter(o=>o.keyCode===2&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const s=i.querySelector("[tabIndex]");if(!s||!(s instanceof HTMLElement)||s.tabIndex===-1)return;const r=window.getComputedStyle(s);r.visibility==="hidden"||r.display==="none"||(e.preventDefault(),e.stopPropagation(),s.focus())}dispose(){this.disposables.dispose()}}function Mre(n){return Mt?n.browserEvent.metaKey:n.browserEvent.ctrlKey}function Fre(n){return n.browserEvent.shiftKey}function fBe(n){return n instanceof MouseEvent&&n.button===2}const sq={isSelectionSingleChangeEvent:Mre,isSelectionRangeChangeEvent:Fre};class Pre{constructor(e){this.list=e,this.disposables=new Ae,this._onPointer=new G,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||sq),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Zt.addTarget(e.getHTMLElement()))),Ee.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||sq))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){D0(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Md(e.browserEvent.target)||D0(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Md(e.browserEvent.target)||D0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),fBe(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Md(e.browserEvent.target)||D0(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(typeof i>"u"){const u=this.list.getFocus()[0];i=u??t,this.list.setAnchor(i)}const s=Math.min(i,t),r=Math.max(i,t),o=Ps(s,r+1),a=this.list.getSelection(),l=mBe(tP(a,[i]),i);if(l.length===0)return;const c=tP(o,_Be(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const s=this.list.getSelection(),r=s.filter(o=>o!==t);this.list.setFocus([t]),this.list.setAnchor(t),s.length===r.length?this.list.setSelection([...r,t],e.browserEvent):this.list.setSelection(r,e.browserEvent)}}dispose(){this.disposables.dispose()}}class Ore{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){var t,i;const s=this.selectorSuffix&&`.${this.selectorSuffix}`,r=[];e.listBackground&&r.push(`.monaco-list${s} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(r.push(`.monaco-list${s}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),r.push(`.monaco-list${s}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&r.push(`.monaco-list${s}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(r.push(`.monaco-list${s}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),r.push(`.monaco-list${s}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&r.push(`.monaco-list${s}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&r.push(`.monaco-list${s}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&r.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&r.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(r.push(`.monaco-list${s} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),r.push(`.monaco-list${s} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&r.push(`.monaco-list${s} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(r.push(`.monaco-list${s} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),r.push(`.monaco-list${s} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(r.push(`.monaco-list${s} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),r.push(`.monaco-list${s} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&r.push(`.monaco-list${s} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&r.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&r.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const o=jg(e.listFocusAndSelectionOutline,jg(e.listSelectionOutline,(t=e.listFocusOutline)!==null&&t!==void 0?t:""));o&&r.push(`.monaco-list${s}:focus .monaco-list-row.focused.selected { outline: 1px solid ${o}; outline-offset: -1px;}`),e.listFocusOutline&&r.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const a=jg(e.listSelectionOutline,(i=e.listInactiveFocusOutline)!==null&&i!==void 0?i:"");a&&r.push(`.monaco-list${s} .monaco-list-row.focused.selected { outline: 1px dotted ${a}; outline-offset: -1px; }`),e.listSelectionOutline&&r.push(`.monaco-list${s} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&r.push(`.monaco-list${s} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&r.push(`.monaco-list${s} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropBackground&&r.push(`
				.monaco-list${s}.drop-target,
				.monaco-list${s} .monaco-list-rows.drop-target,
				.monaco-list${s} .monaco-list-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }
			`),e.tableColumnsBorder&&r.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&r.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=r.join(`
`)}}const gBe={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropBackground:"#383B3D",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:J.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:J.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:J.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0},pBe={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function mBe(n,e){const t=n.indexOf(e);if(t===-1)return[];const i=[];let s=t-1;for(;s>=0&&n[s]===e-(t-s);)i.push(n[s--]);for(i.reverse(),s=t;s<n.length&&n[s]===e+(s-t);)i.push(n[s++]);return i}function tP(n,e){const t=[];let i=0,s=0;for(;i<n.length||s<e.length;)if(i>=n.length)t.push(e[s++]);else if(s>=e.length)t.push(n[i++]);else if(n[i]===e[s]){t.push(n[i]),i++,s++;continue}else n[i]<e[s]?t.push(n[i++]):t.push(e[s++]);return t}function _Be(n,e){const t=[];let i=0,s=0;for(;i<n.length||s<e.length;)if(i>=n.length)t.push(e[s++]);else if(s>=e.length)t.push(n[i++]);else if(n[i]===e[s]){i++,s++;continue}else n[i]<e[s]?t.push(n[i++]):s++;return t}const rq=(n,e)=>n-e;class bBe{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,s){let r=0;for(const o of this.renderers)o.renderElement(e,t,i[r++],s)}disposeElement(e,t,i,s){var r;let o=0;for(const a of this.renderers)(r=a.disposeElement)===null||r===void 0||r.call(a,e,t,i[o],s),o+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class vBe{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return e}renderElement(e,t,i){const s=this.accessibilityProvider.getAriaLabel(e);s?i.setAttribute("aria-label",s):i.removeAttribute("aria-label");const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof r=="number"?i.setAttribute("aria-level",`${r}`):i.removeAttribute("aria-level")}disposeTemplate(e){}}class wBe{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,e,t)}onDragOver(e,t,i,s){return this.dnd.onDragOver(e,t,i,s)}onDragLeave(e,t,i,s){var r,o;(o=(r=this.dnd).onDragLeave)===null||o===void 0||o.call(r,e,t,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}drop(e,t,i,s){this.dnd.drop(e,t,i,s)}dispose(){this.dnd.dispose()}}class Rl{get onDidChangeFocus(){return Ee.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return Ee.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=Ee.chain(this.disposables.add(new xt(this.view.domNode,"keydown")).event,r=>r.map(o=>new ri(o)).filter(o=>e=o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>rt.stop(o,!0)).filter(()=>!1)),i=Ee.chain(this.disposables.add(new xt(this.view.domNode,"keyup")).event,r=>r.forEach(()=>e=!1).map(o=>new ri(o)).filter(o=>o.keyCode===58||o.shiftKey&&o.keyCode===68).map(o=>rt.stop(o,!0)).map(({browserEvent:o})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,u=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:u,browserEvent:o}})),s=Ee.chain(this.view.onContextMenu,r=>r.filter(o=>!e).map(({element:o,index:a,browserEvent:l})=>({element:o,index:a,anchor:new ba(l),browserEvent:l})));return Ee.any(t,i,s)}get onKeyDown(){return this.disposables.add(new xt(this.view.domNode,"keydown")).event}get onDidFocus(){return Ee.signal(this.disposables.add(new xt(this.view.domNode,"focus",!0)).event)}constructor(e,t,i,s,r=pBe){var o,a,l,c;this.user=e,this._options=r,this.focus=new wD("focused"),this.anchor=new wD("anchor"),this.eventBufferer=new s8,this._ariaLabel="",this.disposables=new Ae,this._onDidDispose=new G,this.onDidDispose=this._onDidDispose.event;const u=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(o=this._options.accessibilityProvider)===null||o===void 0?void 0:o.getWidgetRole():"list";this.selection=new cBe(u!=="listbox");const h=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=r.accessibilityProvider,this.accessibilityProvider&&(h.push(new vBe(this.accessibilityProvider)),(l=(a=this.accessibilityProvider).onDidChangeActiveDescendant)===null||l===void 0||l.call(a,this.onDidChangeActiveDescendant,this,this.disposables)),s=s.map(f=>new bBe(f.templateId,[...h,f]));const d=Object.assign(Object.assign({},r),{dnd:r.dnd&&new wBe(this,r.dnd)});if(this.view=this.createListView(t,i,s,d),this.view.domNode.setAttribute("role",u),r.styleController)this.styleController=r.styleController(this.view.domId);else{const f=Fa(this.view.domNode);this.styleController=new Ore(f,this.view.domId)}if(this.spliceable=new J9e([new AR(this.focus,this.view,r.identityProvider),new AR(this.selection,this.view,r.identityProvider),new AR(this.anchor,this.view,r.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new dBe(this,this.view)),(typeof r.keyboardSupport!="boolean"||r.keyboardSupport)&&(this.keyboardController=new Rre(this,this.view,r),this.disposables.add(this.keyboardController)),r.keyboardNavigationLabelProvider){const f=r.keyboardNavigationDelegate||uBe;this.typeNavigationController=new hBe(this,this.view,r.keyboardNavigationLabelProvider,(c=r.keyboardNavigationEventFilter)!==null&&c!==void 0?c:()=>!0,f),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(r),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,s){return new Go(e,t,i,s)}createMouseController(e){return new Pre(this)}updateOptions(e={}){var t,i;this._options=Object.assign(Object.assign({},this._options),e),(t=this.typeNavigationController)===null||t===void 0||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)===null||i===void 0||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new Hm(this.user,`Invalid start index: ${e}`);if(t<0)throw new Hm(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new Hm(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Hm(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return tie(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new Hm(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,s){if(this.length===0)return;const r=this.focus.get(),o=this.findNextIndex(r.length>0?r[0]+e:0,t,s);o>-1&&this.setFocus([o],i)}focusPrevious(e=1,t=!1,i,s){if(this.length===0)return;const r=this.focus.get(),o=this.findPreviousIndex(r.length>0?r[0]-e:0,t,s);o>-1&&this.setFocus([o],i)}focusNextPage(e,t){return nq(this,void 0,void 0,function*(){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const s=this.getFocus()[0];if(s!==i&&(s===void 0||i>s)){const r=this.findPreviousIndex(i,!1,t);r>-1&&s!==r?this.setFocus([r],e):this.setFocus([i],e)}else{const r=this.view.getScrollTop();let o=r+this.view.renderHeight;i>s&&(o-=this.view.elementHeight(i)),this.view.setScrollTop(o),this.view.getScrollTop()!==r&&(this.setFocus([]),yield py(0),yield this.focusNextPage(e,t))}})}focusPreviousPage(e,t){return nq(this,void 0,void 0,function*(){let i;const s=this.view.getScrollTop();s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);const r=this.getFocus()[0];if(r!==i&&(r===void 0||r>=i)){const o=this.findNextIndex(i,!1,t);o>-1&&r!==o?this.setFocus([o],e):this.setFocus([i],e)}else{const o=s;this.view.setScrollTop(s-this.view.renderHeight),this.view.getScrollTop()!==o&&(this.setFocus([]),yield py(0),yield this.focusPreviousPage(e,t))}})}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const s=this.findNextIndex(e,!1,i);s>-1&&this.setFocus([s],t)}findNextIndex(e,t=!1,i){for(let s=0;s<this.length;s++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let s=0;s<this.length;s++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t){if(e<0||e>=this.length)throw new Hm(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),s=this.view.elementTop(e),r=this.view.elementHeight(e);if(Xd(t)){const o=r-this.view.renderHeight;this.view.setScrollTop(o*Xr(t,0,1)+s)}else{const o=s+r,a=i+this.view.renderHeight;s<i&&o>=a||(s<i||o>=a&&r>=this.view.renderHeight?this.view.setScrollTop(s):o>=a&&this.view.setScrollTop(o-this.view.renderHeight))}}getHTMLElement(){return this.view.domNode}getElementID(e){return this.view.getElementDomId(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var e;const t=this.focus.get();if(t.length>0){let i;!((e=this.accessibilityProvider)===null||e===void 0)&&e.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}hm([ji],Rl.prototype,"onDidChangeFocus",null);hm([ji],Rl.prototype,"onDidChangeSelection",null);hm([ji],Rl.prototype,"onContextMenu",null);hm([ji],Rl.prototype,"onKeyDown",null);hm([ji],Rl.prototype,"onDidFocus",null);const Ig=Be,Bre="selectOption.entry.template";class yBe{get templateId(){return Bre}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=Se(e,Ig(".option-text")),t.detail=Se(e,Ig(".option-detail")),t.decoratorRight=Se(e,Ig(".option-decorator-right")),t}renderElement(e,t,i){const s=i,r=e.text,o=e.detail,a=e.decoratorRight,l=e.isDisabled;s.text.textContent=r,s.detail.textContent=o||"",s.decoratorRight.innerText=a||"",l?s.root.classList.add("option-disabled"):s.root.classList.remove("option-disabled")}disposeTemplate(e){}}class hc extends ae{constructor(e,t,i,s,r){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=s,this.selectBoxOptions=r||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=hc.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new G,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}getHeight(){return 22}getTemplateId(){return Bre}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=Be(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Se(this.selectDropDownContainer,Ig(".select-box-details-pane"));const t=Se(this.selectDropDownContainer,Ig(".select-box-dropdown-container-width-control")),i=Se(t,Ig(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Se(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Fa(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(oe(this.selectDropDownContainer,Le.DRAG_START,s=>{rt.stop(s,!0)}))}registerListeners(){this._register(pn(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)})),this._register(oe(this.selectElement,Le.CLICK,t=>{rt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(oe(this.selectElement,Le.MOUSE_DOWN,t=>{rt.stop(t)}));let e;this._register(oe(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(oe(this.selectElement,"touchend",t=>{rt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(oe(this.selectElement,Le.KEY_DOWN,t=>{const i=new ri(t);let s=!1;Mt?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(s=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(s=!0),s&&(this.showSelectDropDown(),rt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){yn(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,s)=>{this.selectElement.add(this.createOption(i.text,s,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)===null||e===void 0||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){var e,t,i;const s=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",r=(t=this.styles.selectForeground)!==null&&t!==void 0?t:"",o=(i=this.styles.selectBorder)!==null&&i!==void 0?i:"";this.selectElement.style.backgroundColor=s,this.selectElement.style.color=r,this.selectElement.style.borderColor=o}styleList(){var e,t;const i=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",s=jg(this.styles.selectListBackground,i);this.selectDropDownListContainer.style.backgroundColor=s,this.selectionDetailsPane.style.backgroundColor=s;const r=(t=this.styles.focusBorder)!==null&&t!==void 0?t:"";this.selectDropDownContainer.style.outlineColor=r,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const s=document.createElement("option");return s.value=e,s.text=e,s.disabled=!!i,s}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{try{e.removeChild(this.selectDropDownContainer)}catch{}}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=hs(this.selectElement),i=getComputedStyle(this.selectElement),s=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),r=window.innerHeight-t.top-t.height-(this.selectBoxOptions.minBottomMargin||0),o=t.top-hc.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,a=this.selectElement.offsetWidth,l=this.setWidthControlElement(this.widthControlElement),c=Math.max(l,Math.round(a)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let u=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const h=this._hasDetails?this._cachedMaxDetailsHeight:0,d=u+s+h,f=Math.floor((r-s-h)/this.getHeight()),g=Math.floor((o-s-h)/this.getHeight());if(e)return t.top+t.height>window.innerHeight-22||t.top<hc.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<hc.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(t.top+t.height>window.innerHeight-22||t.top<hc.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;d>r&&(u=f*this.getHeight())}else d>o&&(u=g*this.getHeight());return this.selectList.layout(u),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=u+s+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=u+s+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,s=0;this.options.forEach((r,o)=>{const a=r.detail?r.detail.length:0,l=r.decoratorRight?r.decoratorRight.length:0,c=r.text.length+a+l;c>s&&(i=o,s=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=sr(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Se(e,Ig(".select-box-dropdown-list-container")),this.listRenderer=new yBe,this.selectList=new Rl("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:s=>{let r=s.text;return s.detail&&(r+=`. ${s.detail}`),s.decoratorRight&&(r+=`. ${s.decoratorRight}`),s.description&&(r+=`. ${s.description}`),r},getWidgetAriaLabel:()=>_({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Mt?"":"option",getWidgetRole:()=>"listbox"}}),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new xt(this.selectDropDownListContainer,"keydown")),i=Ee.chain(t.event,s=>s.filter(()=>this.selectList.length>0).map(r=>new ri(r)));this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===3))(this.onEnter,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===2))(this.onEnter,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===9))(this.onEscape,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===16))(this.onUpArrow,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===18))(this.onDownArrow,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===12))(this.onPageDown,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===11))(this.onPageUp,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===14))(this.onHome,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode===13))(this.onEnd,this)),this._register(Ee.chain(i,s=>s.filter(r=>r.keyCode>=21&&r.keyCode<=56||r.keyCode>=85&&r.keyCode<=113))(this.onCharacter,this)),this._register(oe(this.selectList.getHTMLElement(),Le.POINTER_UP,s=>this.onPointerUp(s))),this._register(this.selectList.onMouseOver(s=>typeof s.index<"u"&&this.selectList.setFocus([s.index]))),this._register(this.selectList.onDidChangeFocus(s=>this.onListFocus(s))),this._register(oe(this.selectDropDownContainer,Le.FOCUS_OUT,s=>{!this._isVisible||Qn(s.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;rt.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const s=Number(i.getAttribute("data-index")),r=i.classList.contains("option-disabled");s>=0&&s<this.options.length&&!r&&(this.selected=s,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=r=>{for(let o=0;o<r.childNodes.length;o++){const a=r.childNodes.item(o);(a.tagName&&a.tagName.toLowerCase())==="img"?r.removeChild(a):i(a)}},s=QT({value:e,supportThemeIcons:!0},{actionHandler:t});return s.element.classList.add("select-box-description-markdown"),i(s.element),s.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){var t,i;this.selectionDetailsPane.innerText="";const s=this.options[e],r=(t=s==null?void 0:s.description)!==null&&t!==void 0?t:"",o=(i=s==null?void 0:s.descriptionIsMarkdown)!==null&&i!==void 0?i:!1;if(r){if(o){const a=s.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(r,a))}else this.selectionDetailsPane.innerText=r;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){rt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){rt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){rt.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(rt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){rt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){rt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){rt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){rt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=Du.toString(e.keyCode);let i=-1;for(let s=0;s<this.options.length-1;s++)if(i=(s+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),rt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}hc.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;hc.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;hc.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;class CBe extends ae{constructor(e,t,i,s){super(),this.selected=0,this.selectBoxOptions=s||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new G),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Zt.addTarget(this.selectElement)),[Jt.Tap].forEach(e=>{this._register(oe(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(pn(this.selectElement,"click",e=>{rt.stop(e,!0)})),this._register(pn(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(pn(this.selectElement,"keydown",e=>{let t=!1;Mt?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!yn(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,s)=>{this.selectElement.add(this.createOption(i.text,s,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){var e,t,i;this.selectElement&&(this.selectElement.style.backgroundColor=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",this.selectElement.style.color=(t=this.styles.selectForeground)!==null&&t!==void 0?t:"",this.selectElement.style.borderColor=(i=this.styles.selectBorder)!==null&&i!==void 0?i:"")}createOption(e,t,i){const s=document.createElement("option");return s.value=e,s.text=e,s.disabled=!!i,s}}class SBe extends Nl{constructor(e,t,i,s,r){super(),Mt&&!(r!=null&&r.useCustomDrawn)?this.selectBoxDelegate=new CBe(e,t,s,r):this.selectBoxDelegate=new hc(e,t,i,s,r),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class al extends ae{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof _o&&this._register(t.onDidChange(s=>{this.element&&this.handleActionChangeEvent(s)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Q_)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Zt.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,Ra&&this._register(oe(e,Le.DRAG_START,s=>{var r;return(r=s.dataTransfer)===null||r===void 0?void 0:r.setData(bre.TEXT,this._action.label)}))),this._register(oe(t,Jt.Tap,s=>this.onClick(s,!0))),this._register(oe(t,Le.MOUSE_DOWN,s=>{i||rt.stop(s,!0),this._action.enabled&&s.button===0&&t.classList.add("active")})),Mt&&this._register(oe(t,Le.CONTEXT_MENU,s=>{s.button===0&&s.ctrlKey===!0&&this.onClick(s)})),this._register(oe(t,Le.CLICK,s=>{rt.stop(s,!0),this.options&&this.options.isMenu||this.onClick(s)})),this._register(oe(t,Le.DBLCLICK,s=>{rt.stop(s,!0)})),[Le.MOUSE_UP,Le.MOUSE_OUT].forEach(s=>{this._register(oe(t,s,r=>{rt.stop(r),t.classList.remove("active")}))})}onClick(e,t=!1){var i;rt.stop(e,!0);const s=to(this._context)?!((i=this.options)===null||i===void 0)&&i.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,s)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getTooltip(){return this.action.tooltip}updateTooltip(){var e;if(!this.element)return;const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.updateAriaLabel(),this.options.hoverDelegate?(this.element.title="",this.customHover?this.customHover.update(t):(this.customHover=Are(this.options.hoverDelegate,this.element,t),this._store.add(this.customHover))):this.element.title=t}updateAriaLabel(){var e;if(this.element){const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class JT extends al{constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),this.element&&(this.label=Se(this.element,Be("a.action-label"))),this.label&&this.label.setAttribute("role",this.getDefaultAriaRole()),this.options.label&&this.options.keybinding&&this.element&&(Se(this.element,Be("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===gs.ID?"presentation":this.options.isMenu?"menuitem":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=_({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.action.class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)===null||e===void 0||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)===null||e===void 0||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)===null||t===void 0||t.classList.add("disabled"))}updateAriaLabel(){var e;if(this.label){const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.label.setAttribute("aria-label",t)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox")):(this.label.classList.remove("checked"),this.label.setAttribute("aria-checked",""),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class xBe extends al{constructor(e,t,i,s,r,o,a){super(e,t),this.selectBox=new SBe(i,s,r,o,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)===null||e===void 0||e.focus()}blur(){var e;(e=this.selectBox)===null||e===void 0||e.blur()}render(e){this.selectBox.render(e)}}class kBe extends Q_{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new G),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=Se(e,Be(".monaco-dropdown")),this._label=Se(this._element,Be(".dropdown-label"));let i=t.labelRenderer;i||(i=r=>(r.textContent=t.label||"",null));for(const r of[Le.CLICK,Le.MOUSE_DOWN,Jt.Tap])this._register(oe(this.element,r,o=>rt.stop(o,!0)));for(const r of[Le.MOUSE_DOWN,Jt.Tap])this._register(oe(this._label,r,o=>{o instanceof MouseEvent&&(o.detail>1||o.button!==0)||(this.visible?this.hide():this.show())}));this._register(oe(this._label,Le.KEY_UP,r=>{const o=new ri(r);(o.equals(3)||o.equals(10))&&(rt.stop(r,!0),this.visible?this.hide():this.show())}));const s=i(this._label);s&&this._register(s),this._register(Zt.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class LBe extends kBe{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class yD extends al{constructor(e,t,i,s=Object.create(null)){super(null,e,s),this.actionItem=null,this._onDidChangeVisibility=this._register(new G),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=s,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=r=>{this.element=Se(r,Be("a.action-label"));let o=[];return typeof this.options.classNames=="string"?o=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(o=this.options.classNames),o.find(a=>a==="icon")||o.push("codicon"),this.element.classList.add(...o),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),s={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new LBe(e,s)),this._register(this.dropdownMenu.onDidChangeVisibility(r=>{var o;(o=this.element)===null||o===void 0||o.setAttribute("aria-expanded",`${r}`),this._onDidChangeVisibility.fire(r)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const r=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return r.options.anchorAlignmentProvider()}})}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)===null||e===void 0||e.show()}updateEnabled(){var e,t;const i=!this.action.enabled;(e=this.actionItem)===null||e===void 0||e.classList.toggle("disabled",i),(t=this.element)===null||t===void 0||t.classList.toggle("disabled",i)}}function DBe(n){return n?n.condition!==void 0:!1}var _v=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},c_;(function(n){n[n.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",n[n.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(c_||(c_={}));var T0;(function(n){n[n.None=0]="None",n[n.Initialized=1]="Initialized",n[n.Closed=2]="Closed"})(T0||(T0={}));class u_ extends ae{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new oy),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=T0.None,this.cache=new Map,this.flushDelayer=this._register(new pne(u_.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)===null||t===void 0||t.forEach((s,r)=>this.acceptExternal(r,s)),(i=e.deleted)===null||i===void 0||i.forEach(s=>this.acceptExternal(s,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===T0.Closed)return;let i=!1;to(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return to(i)?t:i}getBoolean(e,t){const i=this.get(e);return to(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return to(i)?t:parseInt(i,10)}set(e,t,i=!1){return _v(this,void 0,void 0,function*(){if(this.state===T0.Closed)return;if(to(t))return this.delete(e,i);const s=ur(t)||Array.isArray(t)?M9e(t):String(t);if(this.cache.get(e)!==s)return this.cache.set(e,s),this.pendingInserts.set(e,s),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()})}delete(e,t=!1){return _v(this,void 0,void 0,function*(){if(!(this.state===T0.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()})}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return _v(this,void 0,void 0,function*(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())===null||t===void 0||t()})})}doFlush(e){return _v(this,void 0,void 0,function*(){return this.options.hint===c_.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)})}}u_.DEFAULT_FLUSH_DELAY=100;class IR{constructor(){this.onDidChangeItemsExternal=Ee.None,this.items=new Map}updateItems(e){var t,i;return _v(this,void 0,void 0,function*(){(t=e.insert)===null||t===void 0||t.forEach((s,r)=>this.items.set(r,s)),(i=e.delete)===null||i===void 0||i.forEach(s=>this.items.delete(s))})}}const hk="__$__targetStorageMarker",dm=kt("storageService");var oq;(function(n){n[n.NONE=0]="NONE",n[n.SHUTDOWN=1]="SHUTDOWN"})(oq||(oq={}));function EBe(n){const e=n.get(hk);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}class eA extends ae{constructor(e={flushInterval:eA.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new oy),this._onDidChangeTarget=this._register(new oy),this._onWillSaveState=this._register(new G),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,i){return Ee.filter(this._onDidChangeValue.event,s=>s.scope===e&&(t===void 0||s.key===t),i)}emitDidChangeValue(e,t){const{key:i,external:s}=t;if(i===hk){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:s})}get(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.get(e,i)}getBoolean(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.getBoolean(e,i)}getNumber(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.getNumber(e,i)}store(e,t,i,s,r=!1){if(to(t)){this.remove(e,i,r);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,i,s),(o=this.getStorage(i))===null||o===void 0||o.set(e,t,r)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var s;this.updateKeyTarget(e,t,void 0),(s=this.getStorage(t))===null||s===void 0||s.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,s=!1){var r,o;const a=this.getKeyTargets(t);typeof i=="number"?a[e]!==i&&(a[e]=i,(r=this.getStorage(t))===null||r===void 0||r.set(hk,JSON.stringify(a),s)):typeof a[e]=="number"&&(delete a[e],(o=this.getStorage(t))===null||o===void 0||o.set(hk,JSON.stringify(a),s))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?EBe(t):Object.create(null)}}eA.DEFAULT_FLUSH_INTERVAL=60*1e3;class TBe extends eA{constructor(){super(),this.applicationStorage=this._register(new u_(new IR,{hint:c_.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new u_(new IR,{hint:c_.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new u_(new IR,{hint:c_.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function ABe(n,e){const t=Object.assign({},e);for(const i in n){const s=n[i];t[i]=s!==void 0?Ce(s):void 0}return t}const IBe={keybindingLabelBackground:Ce(m3e),keybindingLabelForeground:Ce(_3e),keybindingLabelBorder:Ce(b3e),keybindingLabelBottomBorder:Ce(v3e),keybindingLabelShadow:Ce(Wu)},NBe={buttonForeground:Ce(sv),buttonSeparator:Ce(i3e),buttonBackground:Ce(rv),buttonHoverBackground:Ce(n3e),buttonSecondaryForeground:Ce(r3e),buttonSecondaryBackground:Ce(cF),buttonSecondaryHoverBackground:Ce(o3e),buttonBorder:Ce(s3e)},RBe={progressBarBackground:Ce(c3e)},CD={inputActiveOptionBorder:Ce(W8),inputActiveOptionForeground:Ce(V8),inputActiveOptionBackground:Ce(Eg)};Ce(G3e),Ce(Z3e),Ce(K3e);Ce(gn),Ce(_c),Ce(Wu),Ce(pt),Ce(hFe),Ce(dFe),Ce(fFe),Ce(z4e);const SD={inputBackground:Ce(H4e),inputForeground:Ce(U4e),inputBorder:Ce(j4e),inputValidationInfoBorder:Ce(K4e),inputValidationInfoBackground:Ce(q4e),inputValidationInfoForeground:Ce(G4e),inputValidationWarningBorder:Ce(X4e),inputValidationWarningBackground:Ce(Z4e),inputValidationWarningForeground:Ce(Y4e),inputValidationErrorBorder:Ce(e3e),inputValidationErrorBackground:Ce(Q4e),inputValidationErrorForeground:Ce(J4e)},MBe={listFilterWidgetBackground:Ce(V3e),listFilterWidgetOutline:Ce($3e),listFilterWidgetNoMatchesOutline:Ce(z3e),listFilterWidgetShadow:Ce(H3e),inputBoxStyles:SD,toggleStyles:CD},Wre={badgeBackground:Ce(ik),badgeForeground:Ce(a3e),badgeBorder:Ce(pt)};Ce(sFe),Ce(nFe),Ce(dU),Ce(dU),Ce(rFe);const fm={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:Ce(A3e),listFocusForeground:Ce(I3e),listFocusOutline:Ce(N3e),listActiveSelectionBackground:Ce($u),listActiveSelectionForeground:Ce(vc),listActiveSelectionIconForeground:Ce(cv),listFocusAndSelectionOutline:Ce(R3e),listFocusAndSelectionBackground:Ce($u),listFocusAndSelectionForeground:Ce(vc),listInactiveSelectionBackground:Ce(M3e),listInactiveSelectionIconForeground:Ce(P3e),listInactiveSelectionForeground:Ce(F3e),listInactiveFocusBackground:Ce(O3e),listInactiveFocusOutline:Ce(B3e),listHoverBackground:Ce(Qne),listHoverForeground:Ce(Jne),listDropBackground:Ce(W3e),listSelectionOutline:Ce(ui),listHoverOutline:Ce(ui),treeIndentGuidesStroke:Ce(uv),treeInactiveIndentGuidesStroke:Ce(U3e),tableColumnsBorder:Ce(j3e),tableOddRowsBackgroundColor:Ce(q3e)};function LS(n){return ABe(n,fm)}const FBe={selectBackground:Ce(pc),selectListBackground:Ce(t3e),selectForeground:Ce(Vu),decoratorRightForeground:Ce(Yne),selectBorder:Ce(m0),focusBorder:Ce(uo),listFocusBackground:Ce(fF),listInactiveSelectionIconForeground:Ce(ese),listFocusForeground:Ce(dF),listFocusOutline:W4e(ui,J.transparent.toString()),listHoverBackground:Ce(Qne),listHoverForeground:Ce(Jne),listHoverOutline:Ce(ui),selectListBorder:Ce(_0),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0},PBe={shadowColor:Ce(Wu),borderColor:Ce(Y3e),foregroundColor:Ce(X3e),backgroundColor:Ce(Q3e),selectionForegroundColor:Ce(J3e),selectionBackgroundColor:Ce(eFe),selectionBorderColor:Ce(tFe),separatorColor:Ce(iFe),scrollbarShadow:Ce(l3e),scrollbarSliderBackground:Ce(ov),scrollbarSliderHoverBackground:Ce(av),scrollbarSliderActiveBackground:Ce(lv)};var tA=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ar=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Vre=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function OBe(n,e,t,i){const s=n.getActions(e),r=rd.getInstance(),o=r.keyStatus.altKey||(br||Ts)&&r.keyStatus.shiftKey;zre(s,t,o,i?a=>a===i:a=>a==="navigation")}function $re(n,e,t,i,s,r){const o=n.getActions(e);zre(o,t,!1,typeof i=="string"?l=>l===i:i,s,r)}function zre(n,e,t,i=o=>o==="navigation",s=()=>!1,r=!1){let o,a;Array.isArray(e)?(o=e,a=e):(o=e.primary,a=e.secondary);const l=new Set;for(const[c,u]of n){let h;i(c)?(h=o,h.length>0&&r&&h.push(new gs)):(h=a,h.length>0&&h.push(new gs));for(let d of u){t&&(d=d instanceof Ac&&d.alt?d.alt:d);const f=h.push(d);d instanceof fT&&l.add({group:c,action:d,index:f-1})}}for(const{group:c,action:u,index:h}of l){const d=i(c)?o:a,f=u.actions;s(u,c,d.length)&&d.splice(h,1,...f)}}let mb=class extends JT{constructor(e,t,i,s,r,o,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate}),this._keybindingService=i,this._notificationService=s,this._contextKeyService=r,this._themeService=o,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new wl),this._altKey=rd.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return Vre(this,void 0,void 0,function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}})}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var s;const r=!!(!((s=this._menuItemAction.alt)===null||s===void 0)&&s.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);r!==this._wantsAltCommand&&(this._wantsAltCommand=r,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(oe(e,"mouseleave",s=>{t=!1,i()})),this._register(oe(e,"mouseenter",s=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var e;const t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),i=t&&t.getLabel(),s=this._commandAction.tooltip||this._commandAction.label;let r=i?_("titleAndKb","{0} ({1})",s,i):s;if(!this._wantsAltCommand&&(!((e=this._menuItemAction.alt)===null||e===void 0)&&e.enabled)){const o=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?_("titleAndKb","{0} ({1})",o,l):o;r=_("titleAndKbAndAlt",`{0}
[{1}] {2}`,r,b7.modifierLabels[co].altKey,c)}return r}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const s=this._commandAction.checked&&DBe(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(s)if(Ye.isThemeIcon(s)){const r=Ye.asClassNameArray(s);i.classList.add(...r),this._itemClassDispose.value=ut(()=>{i.classList.remove(...r)})}else{const r=$T(this._themeService.getColorTheme().type)?tf(s.dark):tf(s.light),o=Be("span");o.style.webkitMask=o.style.mask=`${r} no-repeat 50% 50%`,o.style.background="var(--vscode-icon-foreground)",o.style.display="inline-block",o.style.width="100%",o.style.height="100%",i.appendChild(o),i.classList.add("icon"),this._itemClassDispose.value=ka(ut(()=>{i.classList.remove("icon"),qs(i)}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}}};mb=tA([ar(2,Oi),ar(3,ts),ar(4,_t),ar(5,qr),ar(6,Tf),ar(7,Lf)],mb);let iP=class extends yD{constructor(e,t,i,s,r){var o,a,l;const c=Object.assign(Object.assign({},t),{menuAsChild:(o=t==null?void 0:t.menuAsChild)!==null&&o!==void 0?o:!1,classNames:(a=t==null?void 0:t.classNames)!==null&&a!==void 0?a:Ye.isThemeIcon(e.item.icon)?Ye.asClassName(e.item.icon):void 0,keybindingProvider:(l=t==null?void 0:t.keybindingProvider)!==null&&l!==void 0?l:u=>i.lookupKeybinding(u.id)});super(e,{getActions:()=>e.actions},s,c),this._keybindingService=i,this._contextMenuService=s,this._themeService=r}render(e){super.render(e),cr(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!Ye.isThemeIcon(i)){this.element.classList.add("icon");const s=()=>{this.element&&(this.element.style.backgroundImage=$T(this._themeService.getColorTheme().type)?tf(i.dark):tf(i.light))};s(),this._register(this._themeService.onDidColorThemeChange(()=>{s()}))}}};iP=tA([ar(2,Oi),ar(3,Tf),ar(4,qr)],iP);let nP=class extends al{constructor(e,t,i,s,r,o,a,l){var c,u,h;super(null,e),this._keybindingService=i,this._notificationService=s,this._contextMenuService=r,this._menuService=o,this._instaService=a,this._storageService=l,this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let d;const f=t!=null&&t.persistLastActionId?l.get(this._storageKey,1):void 0;f&&(d=e.actions.find(p=>f===p.id)),d||(d=e.actions[0]),this._defaultAction=this._instaService.createInstance(mb,d,{keybinding:this._getDefaultActionKeybindingLabel(d)});const g=Object.assign(Object.assign({keybindingProvider:p=>this._keybindingService.lookupKeybinding(p.id)},t),{menuAsChild:(c=t==null?void 0:t.menuAsChild)!==null&&c!==void 0?c:!0,classNames:(u=t==null?void 0:t.classNames)!==null&&u!==void 0?u:["codicon","codicon-chevron-down"],actionRunner:(h=t==null?void 0:t.actionRunner)!==null&&h!==void 0?h:new Q_});this._dropdown=new yD(e,e.actions,this._contextMenuService,g),this._dropdown.actionRunner.onDidRun(p=>{p.action instanceof Ac&&this.update(p.action)})}update(e){var t;!((t=this._options)===null||t===void 0)&&t.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(mb,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends Q_{runAction(i,s){return Vre(this,void 0,void 0,function*(){yield i.run(void 0)})}},this._container&&this._defaultAction.render(one(this._container,Be(".action-container")))}_getDefaultActionKeybindingLabel(e){var t;let i;if(!((t=this._options)===null||t===void 0)&&t.renderKeybindingWithDefaultActionLabel){const s=this._keybindingService.lookupKeybinding(e.id);s&&(i=`(${s.getLabel()})`)}return i}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=Be(".action-container");this._defaultAction.render(Se(this._container,t)),this._register(oe(t,Le.KEY_DOWN,s=>{const r=new ri(s);r.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),r.stopPropagation())}));const i=Be(".dropdown-action-container");this._dropdown.render(Se(this._container,i)),this._register(oe(i,Le.KEY_DOWN,s=>{var r;const o=new ri(s);o.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(r=this._defaultAction.element)===null||r===void 0||r.focus(),o.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};nP=tA([ar(2,Oi),ar(3,ts),ar(4,Tf),ar(5,Sf),ar(6,Wt),ar(7,dm)],nP);let sP=class extends xBe{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===gs.ID?"─────────":i.label,isDisabled:!i.enabled})),0,t,FBe,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=Ce(m0)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};sP=tA([ar(1,Ef)],sP);function BBe(n,e,t){return e instanceof Ac?n.createInstance(mb,e,t):e instanceof OL?e.item.isSelection?n.createInstance(sP,e):e.item.rememberDefaultAction?n.createInstance(nP,e,Object.assign(Object.assign({},t),{persistLastActionId:!0})):n.createInstance(iP,e,t):void 0}var WBe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class Fc extends ae{constructor(e,t={}){var i,s,r,o,a,l;super(),this._actionRunnerDisposables=this._register(new Ae),this.viewItemDisposables=this._register(new i8),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new G),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new G({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new G),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new G),this.onWillRun=this._onWillRun.event,this.options=t,this._context=(i=t.context)!==null&&i!==void 0?i:null,this._orientation=(s=this.options.orientation)!==null&&s!==void 0?s:0,this._triggerKeys={keyDown:(o=(r=this.options.triggerKeys)===null||r===void 0?void 0:r.keyDown)!==null&&o!==void 0?o:!1,keys:(l=(a=this.options.triggerKeys)===null||a===void 0?void 0:a.keys)!==null&&l!==void 0?l:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Q_,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(h=>this._onDidRun.fire(h))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(h=>this._onWillRun.fire(h))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",t.animated!==!1&&this.domNode.classList.add("animated");let c,u;switch(this._orientation){case 0:c=[15],u=[17];break;case 1:c=[16],u=[18],this.domNode.className+=" vertical";break}this._register(oe(this.domNode,Le.KEY_DOWN,h=>{const d=new ri(h);let f=!0;const g=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;c&&(d.equals(c[0])||d.equals(c[1]))?f=this.focusPrevious():u&&(d.equals(u[0])||d.equals(u[1]))?f=this.focusNext():d.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():d.equals(14)?f=this.focusFirst():d.equals(13)?f=this.focusLast():d.equals(2)&&g instanceof al&&g.trapsArrowNavigation?f=this.focusNext():this.isTriggerKeyEvent(d)?this._triggerKeys.keyDown?this.doTrigger(d):this.triggerKeyDown=!0:f=!1,f&&(d.preventDefault(),d.stopPropagation())})),this._register(oe(this.domNode,Le.KEY_UP,h=>{const d=new ri(h);this.isTriggerKeyEvent(d)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(d)),d.preventDefault(),d.stopPropagation()):(d.equals(2)||d.equals(1026))&&this.updateFocusedItem()})),this.focusTracker=this._register(ef(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(pl()===this.domNode||!Qn(pl(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=2?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof al&&i.isEnabled());t instanceof al&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof al&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(Qn(pl(),t)){this.focusedItem=e;break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])===null||t===void 0?void 0:t.action;if(e instanceof HTMLElement){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let s=Xd(t.index)?t.index:null;i.forEach(r=>{const o=document.createElement("li");o.className="action-item",o.setAttribute("role","presentation");let a;const l=Object.assign({hoverDelegate:this.options.hoverDelegate},t);this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(r,l)),a||(a=new JT(this.context,r,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,oe(o,Le.CONTEXT_MENU,c=>{rt.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(o),this.focusable&&a instanceof al&&this.viewItems.length===0&&a.setFocusable(!0),s===null||s<0||s>=this.actionsList.children.length?(this.actionsList.appendChild(o),this.viewItems.push(a)):(this.actionsList.insertBefore(o,this.actionsList.children[s]),this.viewItems.splice(s,0,a),s++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=ti(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),vo(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const s=this.viewItems.findIndex(r=>r.isEnabled());this.focusedItem=s===-1?void 0:s,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=t,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===gs.ID));return this.updateFocus(),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===gs.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var s;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((s=this.viewItems[this.previouslyFocusedItem])===null||s===void 0||s.blur());const r=this.focusedItem!==void 0&&this.viewItems[this.focusedItem];if(r){let o=!0;xL(r.focus)||(o=!1),this.options.focusOnlyEnabledItems&&xL(r.isEnabled)&&!r.isEnabled()&&(o=!1),r.action.id===gs.ID&&(o=!1),o?(i||this.previouslyFocusedItem!==this.focusedItem)&&(r.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0)}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof al){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}run(e,t){return WBe(this,void 0,void 0,function*(){yield this._actionRunner.run(e,t)})}dispose(){this._context=void 0,this.viewItems=ti(this.viewItems),this.getContainer().remove(),super.dispose()}}const rP=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,NR=/(&amp;)?(&amp;)([^\s&])/g;var xD;(function(n){n[n.Right=0]="Right",n[n.Left=1]="Left"})(xD||(xD={}));class h_ extends Fc{constructor(e,t,i,s){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:l=>this.doGetActionViewItem(l,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Mt||Ts?[10]:[]],keyDown:!0}}),this.menuStyles=s,this.menuElement=r,this.actionsList.tabIndex=0,this.menuDisposables=this._register(new Ae),this.initializeOrUpdateStyleSheet(e,s),this._register(Zt.addTarget(r)),oe(r,Le.KEY_DOWN,l=>{new ri(l).equals(2)&&l.preventDefault()}),i.enableMnemonics&&this.menuDisposables.add(oe(r,Le.KEY_DOWN,l=>{const c=l.key.toLocaleLowerCase();if(this.mnemonics.has(c)){rt.stop(l,!0);const u=this.mnemonics.get(c);if(u.length===1&&(u[0]instanceof aq&&u[0].container&&this.focusItemByElement(u[0].container),u[0].onClick(l)),u.length>1){const h=u.shift();h&&h.container&&(this.focusItemByElement(h.container),u.push(h)),this.mnemonics.set(c,u)}}})),Ts&&this._register(oe(r,Le.KEY_DOWN,l=>{const c=new ri(l);c.equals(14)||c.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),rt.stop(l,!0)):(c.equals(13)||c.equals(12))&&(this.focusedItem=0,this.focusPrevious(),rt.stop(l,!0))})),this._register(oe(this.domNode,Le.MOUSE_OUT,l=>{const c=l.relatedTarget;Qn(c,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),l.stopPropagation())})),this._register(oe(this.actionsList,Le.MOUSE_OVER,l=>{let c=l.target;if(!(!c||!Qn(c,this.actionsList)||c===this.actionsList)){for(;c.parentElement!==this.actionsList&&c.parentElement!==null;)c=c.parentElement;if(c.classList.contains("action-item")){const u=this.focusedItem;this.setFocusedItem(c),u!==this.focusedItem&&this.updateFocus()}}})),this._register(Zt.addTarget(this.actionsList)),this._register(oe(this.actionsList,Jt.Tap,l=>{let c=l.initialTarget;if(!(!c||!Qn(c,this.actionsList)||c===this.actionsList)){for(;c.parentElement!==this.actionsList&&c.parentElement!==null;)c=c.parentElement;if(c.classList.contains("action-item")){const u=this.focusedItem;this.setFocusedItem(c),u!==this.focusedItem&&this.updateFocus()}}}));const o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new K8(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,s),this._register(oe(r,Jt.Change,l=>{rt.stop(l,!0);const c=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:c-l.translationY})})),this._register(oe(a,Le.MOUSE_UP,l=>{l.preventDefault()})),r.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter(l=>{var c;return!((c=i.submenuIds)===null||c===void 0)&&c.has(l.id)?(console.warn(`Found submenu cycle: ${l.id}`),!1):!0}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(l=>!(l instanceof lq)).forEach((l,c,u)=>{l.updatePositionInSet(c+1,u.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(H3(e)?this.styleSheet=Fa(e):(h_.globalStyleSheet||(h_.globalStyleSheet=Fa()),this.styleSheet=h_.globalStyleSheet)),this.styleSheet.textContent=$Be(t,H3(e))}styleScrollElement(e,t){var i,s;const r=(i=t.foregroundColor)!==null&&i!==void 0?i:"",o=(s=t.backgroundColor)!==null&&s!==void 0?s:"",a=t.borderColor?`1px solid ${t.borderColor}`:"",l="5px",c=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=a,e.style.borderRadius=l,e.style.color=r,e.style.backgroundColor=o,e.style.boxShadow=c}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof gs)return new lq(t.context,e,{icon:!0},this.menuStyles);if(e instanceof fT){const s=new aq(e,e.actions,i,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}),this.menuStyles);if(t.enableMnemonics){const r=s.getMnemonic();if(r&&s.isEnabled()){let o=[];this.mnemonics.has(r)&&(o=this.mnemonics.get(r)),o.push(s),this.mnemonics.set(r,o)}}return s}else{const s={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const o=t.getKeyBinding(e);if(o){const a=o.getLabel();a&&(s.keybinding=a)}}const r=new Hre(t.context,e,s,this.menuStyles);if(t.enableMnemonics){const o=r.getMnemonic();if(o&&r.isEnabled()){let a=[];this.mnemonics.has(o)&&(a=this.mnemonics.get(o)),a.push(r),this.mnemonics.set(o,a)}}return r}}}class Hre extends al{constructor(e,t,i,s){if(i.isMenu=!0,super(t,t,i),this.menuStyle=s,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const r=this.action.label;if(r){const o=rP.exec(r);o&&(this.mnemonic=(o[1]?o[1]:o[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Ui(()=>{this.element&&(this._register(oe(this.element,Le.MOUSE_UP,r=>{if(rt.stop(r,!0),Ra){if(new ba(r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(oe(this.element,Le.CONTEXT_MENU,r=>{rt.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=Se(this.element,Be("a.action-menu-item")),this._action.id===gs.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=Se(this.item,Be("span.menu-item-check"+Ye.asCSSSelector(we.menuSelection))),this.check.setAttribute("role","none"),this.label=Se(this.item,Be("span.action-label")),this.options.label&&this.options.keybinding&&(Se(this.item,Be("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)===null||e===void 0||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){vo(this.label);let t=Tre(this.action.label);if(t){const i=VBe(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const s=rP.exec(t);if(s){t=NL(t),NR.lastIndex=0;let r=NR.exec(t);for(;r&&r[1];)r=NR.exec(t);const o=a=>a.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(dT(o(t.substr(0,r.index))," "),Be("u",{"aria-hidden":"true"},r[3]),GAe(o(t.substr(r.index+r[0].length))," ")):this.label.innerText=o(t).trim(),(e=this.item)===null||e===void 0||e.setAttribute("aria-keyshortcuts",(s[1]?s[1]:s[3]).toLocaleLowerCase())}else this.label.innerText=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,s=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",r=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=s,this.item.style.outlineOffset=r),this.check&&(this.check.style.color=t??"")}}class aq extends Hre{constructor(e,t,i,s,r){super(e,e,s,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=s,this.mysubmenu=null,this.submenuDisposables=this._register(new Ae),this.mouseOver=!1,this.expandDirection=s&&s.expandDirection!==void 0?s.expandDirection:xD.Right,this.showScheduler=new Ui(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Ui(()=>{this.element&&!Qn(pl(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=Se(this.item,Be("span.submenu-indicator"+Ye.asCSSSelector(we.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(oe(this.element,Le.KEY_UP,t=>{const i=new ri(t);(i.equals(17)||i.equals(3))&&(rt.stop(t,!0),this.createSubmenu(!0))})),this._register(oe(this.element,Le.KEY_DOWN,t=>{const i=new ri(t);pl()===this.item&&(i.equals(17)||i.equals(3))&&rt.stop(t,!0)})),this._register(oe(this.element,Le.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(oe(this.element,Le.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(oe(this.element,Le.FOCUS_OUT,t=>{this.element&&!Qn(pl(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){rt.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,s){const r={top:0,left:0};return r.left=L0(e.width,t.width,{position:s===xD.Right?0:1,offset:i.left,size:i.width}),r.left>=i.left&&r.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(r.left=i.left+10),i.top+=10,i.height=0),r.top=L0(e.height,t.height,{position:0,offset:i.top,size:0}),r.top+t.height===i.top&&r.top+i.height+t.height<=e.height&&(r.top+=i.height),r}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=Se(this.element,Be("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new h_(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new gT],this.submenuOptions,this.menuStyle);const s=this.element.getBoundingClientRect(),r={top:s.top-i,left:s.left,height:s.height+2*i,width:s.width},o=this.submenuContainer.getBoundingClientRect(),{top:a,left:l}=this.calculateSubmenuMenuLayout(new yi(window.innerWidth,window.innerHeight),yi.lift(o),r,this.expandDirection);this.submenuContainer.style.left=`${l-o.left}px`,this.submenuContainer.style.top=`${a-o.top}px`,this.submenuDisposables.add(oe(this.submenuContainer,Le.KEY_UP,c=>{new ri(c).equals(15)&&(rt.stop(c,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(oe(this.submenuContainer,Le.KEY_DOWN,c=>{new ri(c).equals(15)&&rt.stop(c,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)===null||t===void 0||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class lq extends JT{constructor(e,t,i,s){super(e,t,i),this.menuStyles=s}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function VBe(n){const e=rP,t=e.exec(n);if(!t)return n;const i=!t[1];return n.replace(e,i?"$2$3":"").trim()}function cq(n){const e=Aie()[n.id];return`.codicon-${n.id}:before { content: '\\${e.toString(16)}'; }`}function $Be(n,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${cq(we.menuSelection)}
${cq(we.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar.animated .action-item.active {
	transform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=n.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const s=n.scrollbarSliderBackground;s&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${s};
				}
			`);const r=n.scrollbarSliderHoverBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${r};
				}
			`);const o=n.scrollbarSliderActiveBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${o};
				}
			`)}return t}class zBe{constructor(e,t,i,s){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=s,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=document.activeElement;let i;const s=S8(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:r=>{var o;this.lastContainer=r;const a=e.getMenuClassName?e.getMenuClassName():"";a&&(r.className+=" "+a),this.options.blockMouse&&(this.block=r.appendChild(Be(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(o=this.blockDisposable)===null||o===void 0||o.dispose(),this.blockDisposable=oe(this.block,Le.MOUSE_DOWN,u=>u.stopPropagation()));const l=new Ae,c=e.actionRunner||new Q_;return c.onWillRun(u=>this.onActionRun(u,!e.skipTelemetry),this,l),c.onDidRun(this.onDidActionRun,this,l),i=new h_(r,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:c,getKeyBinding:e.getKeyBinding?e.getKeyBinding:u=>this.keybindingService.lookupKeybinding(u.id)},PBe),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,l),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,l),l.add(oe(window,Le.BLUR,()=>this.contextViewService.hideContextView(!0))),l.add(oe(window,Le.MOUSE_DOWN,u=>{if(u.defaultPrevented)return;const h=new ba(u);let d=h.target;if(!h.rightButton){for(;d;){if(d===r)return;d=d.parentElement}this.contextViewService.hideContextView(!0)}})),ka(l,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:r=>{var o,a,l;(o=e.onHide)===null||o===void 0||o.call(e,!!r),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)===null||a===void 0||a.dispose(),this.blockDisposable=null,this.lastContainer&&(pl()===this.lastContainer||Qn(pl(),this.lastContainer))&&((l=this.focusToReturn)===null||l===void 0||l.focus()),this.lastContainer=null}},s,!!s)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!Qp(e.error)&&this.notificationService.error(e.error)}}var HBe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Um=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let oP=class extends ae{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new zBe(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,s,r,o){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=s,this.menuService=r,this.contextKeyService=o,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new G),this._onDidHideContextMenu=this._store.add(new G)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=aP.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},e),{onHide:t=>{var i;(i=e.onHide)===null||i===void 0||i.call(e,t),this._onDidHideContextMenu.fire()}})),rd.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};oP=HBe([Um(0,ah),Um(1,ts),Um(2,Ef),Um(3,Oi),Um(4,Sf),Um(5,_t)],oP);var aP;(function(n){function e(i){return i&&i.menuId instanceof B}function t(i,s,r){if(!e(i))return i;const{menuId:o,menuActionOptions:a,contextKeyService:l}=i;return Object.assign(Object.assign({},i),{getActions:()=>{const c=[];if(o){const u=s.createMenu(o,l??r);OBe(u,a,c),u.dispose()}return i.getActions?gs.join(i.getActions(),c):c}})}n.transform=t})(aP||(aP={}));var kD;(function(n){n[n.API=0]="API",n[n.USER=1]="USER"})(kD||(kD={}));var E7=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},LD=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},lg=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let lP=class{constructor(e){this._commandService=e}open(e,t){return lg(this,void 0,void 0,function*(){if(!p7(e,bt.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=ot.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=XF(decodeURIComponent(e.query))}catch{try{i=XF(e.query)}catch{}}return Array.isArray(i)||(i=[i]),yield this._commandService.executeCommand(e.path,...i),!0})}};lP=E7([LD(0,Ys)],lP);let cP=class{constructor(e){this._editorService=e}open(e,t){return lg(this,void 0,void 0,function*(){typeof e=="string"&&(e=ot.parse(e));const{selection:i,uri:s}=G8e(e);return e=s,e.scheme===bt.file&&(e=D5e(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:i,source:t!=null&&t.fromUserGesture?kD.USER:kD.API},t==null?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0})}};cP=E7([LD(0,ci)],cP);let uP=class{constructor(e,t){this._openers=new hr,this._validators=new hr,this._resolvers=new hr,this._resolvedUriTargets=new us(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new hr,this._defaultExternalOpener={openExternal:i=>lg(this,void 0,void 0,function*(){return Ej(i,bt.http,bt.https)?lne(i):window.location.href=i,!0})},this._openers.push({open:(i,s)=>lg(this,void 0,void 0,function*(){return s!=null&&s.openExternal||Ej(i,bt.mailto,bt.http,bt.https,bt.vsls)?(yield this._doOpenExternal(i,s),!0):!1})}),this._openers.push(new lP(t)),this._openers.push(new cP(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}open(e,t){var i;return lg(this,void 0,void 0,function*(){const s=typeof e=="string"?ot.parse(e):e,r=(i=this._resolvedUriTargets.get(s))!==null&&i!==void 0?i:e;for(const o of this._validators)if(!(yield o.shouldOpen(r,t)))return!1;for(const o of this._openers)if(yield o.open(e,t))return!0;return!1})}resolveExternalUri(e,t){return lg(this,void 0,void 0,function*(){for(const i of this._resolvers)try{const s=yield i.resolveExternalUri(e,t);if(s)return this._resolvedUriTargets.has(s.resolved)||this._resolvedUriTargets.set(s.resolved,e),s}catch{}throw new Error("Could not resolve external URI: "+e.toString())})}_doOpenExternal(e,t){return lg(this,void 0,void 0,function*(){const i=typeof e=="string"?ot.parse(e):e;let s;try{s=(yield this.resolveExternalUri(i,t)).resolved}catch{s=i}let r;if(typeof e=="string"&&i.toString()===s.toString()?r=e:r=encodeURI(s.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(yield a.openExternal(r,{sourceUri:i,preferredOpenerId:o},In.None))return!0}return this._defaultExternalOpener.openExternal(r,{sourceUri:i},In.None)})}dispose(){this._validators.clear()}};uP=E7([LD(0,ci),LD(1,Ys)],uP);const DS=kt("editorWorkerService");var Ci;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(Ci||(Ci={}));(function(n){function e(o,a){return a-o}n.compare=e;const t=Object.create(null);t[n.Error]=_("sev.error","Error"),t[n.Warning]=_("sev.warning","Warning"),t[n.Info]=_("sev.info","Info");function i(o){return t[o]||""}n.toString=i;function s(o){switch(o){case Fi.Error:return n.Error;case Fi.Warning:return n.Warning;case Fi.Info:return n.Info;case Fi.Ignore:return n.Hint}}n.fromSeverity=s;function r(o){switch(o){case n.Error:return Fi.Error;case n.Warning:return Fi.Warning;case n.Info:return Fi.Info;case n.Hint:return Fi.Ignore}}n.toSeverity=r})(Ci||(Ci={}));var DD;(function(n){const e="";function t(s){return i(s,!0)}n.makeKey=t;function i(s,r){const o=[e];return s.source?o.push(s.source.replace("¦","\\¦")):o.push(e),s.code?typeof s.code=="string"?o.push(s.code.replace("¦","\\¦")):o.push(s.code.value.replace("¦","\\¦")):o.push(e),s.severity!==void 0&&s.severity!==null?o.push(Ci.toString(s.severity)):o.push(e),s.message&&r?o.push(s.message.replace("¦","\\¦")):o.push(e),s.startLineNumber!==void 0&&s.startLineNumber!==null?o.push(s.startLineNumber.toString()):o.push(e),s.startColumn!==void 0&&s.startColumn!==null?o.push(s.startColumn.toString()):o.push(e),s.endLineNumber!==void 0&&s.endLineNumber!==null?o.push(s.endLineNumber.toString()):o.push(e),s.endColumn!==void 0&&s.endColumn!==null?o.push(s.endColumn.toString()):o.push(e),o.push(e),o.join("¦")}n.makeKeyOptionalMessage=i})(DD||(DD={}));const Uc=kt("markerService");function UBe(n,e){const t=[],i=[];for(const s of n)e.has(s)||t.push(s);for(const s of e)n.has(s)||i.push(s);return{removed:t,added:i}}function jBe(n,e){const t=new Set;for(const i of e)n.has(i)&&t.add(i);return t}var qBe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},uq=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let hP=class extends ae{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new G),this._markerDecorations=new us,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new GBe(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var t;const i=this._markerDecorations.get(e.uri);i&&(i.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===bt.inMemory||e.uri.scheme===bt.internal||e.uri.scheme===bt.vscode)&&((t=this._markerService)===null||t===void 0||t.read({resource:e.uri}).map(s=>s.owner).forEach(s=>this._markerService.remove(s,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};hP=qBe([uq(0,Zs),uq(1,Uc)],hP);class GBe extends ae{constructor(e){super(),this.model=e,this._map=new TMe,this._register(ut(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=UBe(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const s=i.map(a=>this._map.get(a)),r=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),o=this.model.deltaDecorations(s,r);for(const a of i)this._map.delete(a);for(let a=0;a<o.length;a++)this._map.set(t[a],o[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=H.lift(t);if(t.severity===Ci.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const s=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(s===1||i.endColumn>=s)return i;const r=e.getWordAtPosition(i.getStartPosition());r&&(i=new H(i.startLineNumber,r.startColumn,i.endLineNumber,r.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const s=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);s<i.endColumn&&(i=new H(i.startLineNumber,s,i.endLineNumber,i.endColumn),t.startColumn=s)}return i}_createDecorationOption(e){let t,i,s,r,o;switch(e.severity){case Ci.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",s=0;break;case Ci.Info:t="squiggly-info",i=Tn(wPe),s=10,o={color:Tn(oFe),position:Or.Inline};break;case Ci.Warning:t="squiggly-warning",i=Tn(vPe),s=20,o={color:Tn(aFe),position:Or.Inline};break;case Ci.Error:default:t="squiggly-error",i=Tn(bPe),s=30,o={color:Tn(lFe),position:Or.Inline};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(r="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(r="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:zo.Right},minimap:o,zIndex:s,inlineClassName:r}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var KBe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},M1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Qm;function Hf(n){return n.toString()}class ZBe{constructor(e,t,i){this.model=e,this._modelEventListeners=new Ae,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(s=>i(e,s)))}dispose(){this._modelEventListeners.dispose()}}const YBe=Ts||Mt?1:2;class XBe{constructor(e,t,i,s,r,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=s,this.heapSize=r,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}let ED=Qm=class extends ae{constructor(e,t,i,s,r){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._languageService=s,this._languageConfigurationService=r,this._onModelAdded=this._register(new G),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new G),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new G),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(o=>this._updateModelOptions(o))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var i;let s=ls.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const f=parseInt(e.editor.tabSize,10);isNaN(f)||(s=f),s<1&&(s=1)}let r="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const f=parseInt(e.editor.indentSize,10);isNaN(f)||(r=Math.max(f,1))}let o=ls.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(o=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let a=YBe;const l=e.eol;l===`\r
`?a=2:l===`
`&&(a=1);let c=ls.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(c=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let u=ls.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(u=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let h=ls.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(h=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let d=ls.bracketPairColorizationOptions;return!((i=e.editor)===null||i===void 0)&&i.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(d={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:s,indentSize:r,insertSpaces:o,detectIndentation:u,defaultEOL:a,trimAutoWhitespace:c,largeFileOptimizations:h,bracketPairColorizationOptions:d}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:co===3||co===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const s=typeof e=="string"?e:e.languageId;let r=this._modelCreationOptionsByLanguageAndResource[s+t];if(!r){const o=this._configurationService.getValue("editor",{overrideIdentifier:s,resource:t}),a=this._getEOL(t,s);r=Qm._readModelOptions({editor:o,eol:a},i),this._modelCreationOptionsByLanguageAndResource[s+t]=r}return r}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let s=0,r=i.length;s<r;s++){const o=i[s],a=this._models[o],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const u=t[l+c],h=this.getCreationOptions(l,c,a.model.isForSimpleWidget);Qm._setModelOptionsForModel(a.model,h,u)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&mo(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(Hf(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(Hf(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(Hf(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,s)=>i.time-s.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,s){const r=this.getCreationOptions(t,i,s),o=new Mc(e,t,r,i,this._undoRedoService,this._languageService,this._languageConfigurationService);if(i&&this._disposedModels.has(Hf(i))){const c=this._removeDisposedModel(i),u=this._undoRedoService.getElements(i),h=this._getSHA1Computer(),d=h.canComputeSHA1(o)?h.computeSHA1(o)===c.sha1:!1;if(d||c.sharesUndoRedoStack){for(const f of u.past)wu(f)&&f.matchesResource(i)&&f.setModel(o);for(const f of u.future)wu(f)&&f.matchesResource(i)&&f.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,f=>wu(f)&&f.matchesResource(i)),d&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=Hf(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new ZBe(o,c=>this._onWillDispose(c),(c,u)=>this._onDidChangeLanguage(c,u));return this._models[a]=l,l}createModel(e,t,i,s=!1){let r;return t?r=this._createModelData(e,t,i,s):r=this._createModelData(e,Bo,i,s),this._onModelAdded.fire(r.model),r.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,s=t.length;i<s;i++){const r=t[i];e.push(this._models[r].model)}return e}getModel(e){const t=Hf(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===bt.file||e.scheme===bt.vscodeRemote||e.scheme===bt.vscodeUserData||e.scheme===bt.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=Hf(e.uri),i=this._models[t],s=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let r=!1,o=0;if(s||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const u of c.past)wu(u)&&u.matchesResource(e.uri)&&(r=!0,o+=u.heapSize(e.uri),u.setModel(e.uri));for(const u of c.future)wu(u)&&u.matchesResource(e.uri)&&(r=!0,o+=u.heapSize(e.uri),u.setModel(e.uri))}}const a=Qm.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(r)if(!s&&(o>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>wu(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new XBe(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),s,o,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!s){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,s=e.getLanguageId(),r=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(s,e.uri,e.isForSimpleWidget);Qm._setModelOptionsForModel(e,o,r),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new iA}};ED.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024;ED=Qm=KBe([M1(0,xi),M1(1,Bne),M1(2,qT),M1(3,Ji),M1(4,Ur)],ED);class iA{canComputeSHA1(e){return e.getValueLength()<=iA.MAX_MODEL_SIZE}computeSHA1(e){const t=new RT,i=e.createSnapshot();let s;for(;s=i.read();)t.update(s);return t.digest()}}iA.MAX_MODEL_SIZE=10*1024*1024;class QBe{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:ae.None}}renderElement(e,t,i,s){var r;if((r=i.disposable)===null||r===void 0||r.dispose(),!i.data)return;const o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,i.data,s);const a=new Wa,l=o.resolve(e,a.token);i.disposable={dispose:()=>a.cancel()},this.renderer.renderPlaceholder(e,i.data),l.then(c=>this.renderer.renderElement(c,e,i.data,s))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class JBe{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function eWe(n,e){return Object.assign(Object.assign({},e),{accessibilityProvider:e.accessibilityProvider&&new JBe(n,e.accessibilityProvider)})}class tWe{constructor(e,t,i,s,r={}){const o=()=>this.model,a=s.map(l=>new QBe(l,o));this.list=new Rl(e,t,i,a,eWe(o,r))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Ee.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return Ee.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return Ee.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(s=>this._model.get(s)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,Ps(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var Qb=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};const iWe=!1;var TD;(function(n){n.North="north",n.South="south",n.East="east",n.West="west"})(TD||(TD={}));let nWe=4;const sWe=new G;let rWe=300;const oWe=new G;class T7{constructor(){this.disposables=new Ae}get onPointerMove(){return this.disposables.add(new xt(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new xt(window,"mouseup")).event}dispose(){this.disposables.dispose()}}Qb([ji],T7.prototype,"onPointerMove",null);Qb([ji],T7.prototype,"onPointerUp",null);class A7{get onPointerMove(){return this.disposables.add(new xt(this.el,Jt.Change)).event}get onPointerUp(){return this.disposables.add(new xt(this.el,Jt.End)).event}constructor(e){this.el=e,this.disposables=new Ae}dispose(){this.disposables.dispose()}}Qb([ji],A7.prototype,"onPointerMove",null);Qb([ji],A7.prototype,"onPointerUp",null);class AD{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}Qb([ji],AD.prototype,"onPointerMove",null);Qb([ji],AD.prototype,"onPointerUp",null);const hq="pointer-events-disabled";class rs extends ae{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=Se(this.el,Be(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(ut(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new xt(this._orthogonalStartDragHandle,"mouseenter")).event(()=>rs.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new xt(this._orthogonalStartDragHandle,"mouseleave")).event(()=>rs.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=Se(this.el,Be(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(ut(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new xt(this._orthogonalEndDragHandle,"mouseenter")).event(()=>rs.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new xt(this._orthogonalEndDragHandle,"mouseleave")).event(()=>rs.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=rWe,this.hoverDelayer=this._register(new xf(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new G),this._onDidStart=this._register(new G),this._onDidChange=this._register(new G),this._onDidReset=this._register(new G),this._onDidEnd=this._register(new G),this.orthogonalStartSashDisposables=this._register(new Ae),this.orthogonalStartDragHandleDisposables=this._register(new Ae),this.orthogonalEndSashDisposables=this._register(new Ae),this.orthogonalEndDragHandleDisposables=this._register(new Ae),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=Se(e,Be(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),Mt&&this.el.classList.add("mac");const s=this._register(new xt(this.el,"mousedown")).event;this._register(s(h=>this.onPointerStart(h,new T7),this));const r=this._register(new xt(this.el,"dblclick")).event;this._register(r(this.onPointerDoublePress,this));const o=this._register(new xt(this.el,"mouseenter")).event;this._register(o(()=>rs.onMouseEnter(this)));const a=this._register(new xt(this.el,"mouseleave")).event;this._register(a(()=>rs.onMouseLeave(this))),this._register(Zt.addTarget(this.el));const l=this._register(new xt(this.el,Jt.Start)).event;this._register(l(h=>this.onPointerStart(h,new A7(this.el)),this));const c=this._register(new xt(this.el,Jt.Tap)).event;let u;this._register(c(h=>{if(u){clearTimeout(u),u=void 0,this.onPointerDoublePress(h);return}clearTimeout(u),u=setTimeout(()=>u=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=nWe,this._register(sWe.event(h=>{this.size=h,this.layout()}))),this._register(oWe.event(h=>this.hoverDelay=h)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",iWe),this.layout()}onPointerStart(e,t){rt.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const g=this.getOrthogonalSash(e);g&&(i=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new AD(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new AD(t))),!this.state)return;const s=document.getElementsByTagName("iframe");for(const g of s)g.classList.add(hq);const r=e.pageX,o=e.pageY,a=e.altKey,l={startX:r,currentX:r,startY:o,currentY:o,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=Fa(this.el),u=()=>{let g="";i?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=Mt?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=Mt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${g} !important; }`},h=new Ae;u(),i||this.onDidEnablementChange.event(u,null,h);const d=g=>{rt.stop(g,!1);const p={startX:r,currentX:g.pageX,startY:o,currentY:g.pageY,altKey:a};this._onDidChange.fire(p)},f=g=>{rt.stop(g,!1),this.el.removeChild(c),this.el.classList.remove("active"),this._onDidEnd.fire(),h.dispose();for(const p of s)p.classList.remove(hq)};t.onPointerMove(d,null,h),t.onPointerUp(f,null,h),h.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&rs.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&rs.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){rs.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){var t;const i=(t=e.initialTarget)!==null&&t!==void 0?t:e.target;if(!(!i||!(i instanceof HTMLElement))&&i.classList.contains("orthogonal-drag-handle"))return i.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const aWe={separatorBorder:J.transparent};class Ure{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,s;e!==this.visible&&(e?(this.size=Xr(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e),(s=(i=this.view).setVisible)===null||s===void 0||s.call(i,e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){var e;return(e=this.view.proportionalLayout)!==null&&e!==void 0?e:!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,s){this.container=e,this.view=t,this.disposable=s,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e),this.view.layout(this.size,e,t)}dispose(){this.disposable.dispose()}}class lWe extends Ure{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class cWe extends Ure{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var fu;(function(n){n[n.Idle=0]="Idle",n[n.Busy=1]="Busy"})(fu||(fu={}));var ID;(function(n){n.Distribute={type:"distribute"};function e(s){return{type:"split",index:s}}n.Split=e;function t(s){return{type:"auto",index:s}}n.Auto=t;function i(s){return{type:"invisible",cachedVisibleSize:s}}n.Invisible=i})(ID||(ID={}));class jre extends ae{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){var i,s,r,o,a;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=fu.Idle,this._onDidSashChange=this._register(new G),this._onDidSashReset=this._register(new G),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=(i=t.orientation)!==null&&i!==void 0?i:0,this.inverseAltBehavior=(s=t.inverseAltBehavior)!==null&&s!==void 0?s:!1,this.proportionalLayout=(r=t.proportionalLayout)!==null&&r!==void 0?r:!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=Se(this.el,Be(".sash-container")),this.viewContainer=Be(".split-view-container"),this.scrollable=this._register(new vS({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:$o})),this.scrollableElement=this._register(new G8(this.viewContainer,{vertical:this.orientation===0?(o=t.scrollbarVisibility)!==null&&o!==void 0?o:1:2,horizontal:this.orientation===1?(a=t.scrollbarVisibility)!==null&&a!==void 0?a:1:2},this.scrollable));const l=this._register(new xt(this.viewContainer,"scroll")).event;this._register(l(c=>{const u=this.scrollableElement.getScrollPosition(),h=Math.abs(this.viewContainer.scrollLeft-u.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,d=Math.abs(this.viewContainer.scrollTop-u.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(h!==void 0||d!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:h,scrollTop:d})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(c=>{c.scrollTopChanged&&(this.viewContainer.scrollTop=c.scrollTop),c.scrollLeftChanged&&(this.viewContainer.scrollLeft=c.scrollLeft)})),Se(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||aWe),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((c,u)=>{const h=Mr(c.visible)||c.visible?c.size:{type:"invisible",cachedVisibleSize:c.size},d=c.view;this.doAddView(d,h,u,!0)}),this.contentSize=this.viewItems.reduce((c,u)=>c+u.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,s){this.doAddView(e,t,i,s)}layout(e,t){const i=Math.max(this.size,this.contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let s=0;for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"?s+=a:e-=o.size}for(let r=0;r<this.viewItems.length;r++){const o=this.viewItems[r],a=this.proportions[r];typeof a=="number"&&(o.size=Xr(Math.round(a*e/s),o.minimumSize,o.maximumSize))}}else{const s=Ps(this.viewItems.length),r=s.filter(a=>this.viewItems[a].priority===1),o=s.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,r,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout?e.size/this.contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const s=this.sashItems.findIndex(a=>a.sash===e),r=ka(oe(document.body,"keydown",a=>o(this.sashDragState.current,a.altKey)),oe(document.body,"keyup",()=>o(this.sashDragState.current,!1))),o=(a,l)=>{const c=this.viewItems.map(g=>g.size);let u=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(s===this.sashItems.length-1){const p=this.viewItems[s];u=(p.minimumSize-p.size)/2,h=(p.maximumSize-p.size)/2}else{const p=this.viewItems[s+1];u=(p.size-p.maximumSize)/2,h=(p.size-p.minimumSize)/2}let d,f;if(!l){const g=Ps(s,-1),p=Ps(s+1,this.viewItems.length),m=g.reduce((T,k)=>T+(this.viewItems[k].minimumSize-c[k]),0),b=g.reduce((T,k)=>T+(this.viewItems[k].viewMaximumSize-c[k]),0),v=p.length===0?Number.POSITIVE_INFINITY:p.reduce((T,k)=>T+(c[k]-this.viewItems[k].minimumSize),0),w=p.length===0?Number.NEGATIVE_INFINITY:p.reduce((T,k)=>T+(c[k]-this.viewItems[k].viewMaximumSize),0),y=Math.max(m,w),x=Math.min(v,b),D=this.findFirstSnapIndex(g),S=this.findFirstSnapIndex(p);if(typeof D=="number"){const T=this.viewItems[D],k=Math.floor(T.viewMinimumSize/2);d={index:D,limitDelta:T.visible?y-k:y+k,size:T.size}}if(typeof S=="number"){const T=this.viewItems[S],k=Math.floor(T.viewMinimumSize/2);f={index:S,limitDelta:T.visible?x+k:x-k,size:T.size}}}this.sashDragState={start:a,current:a,index:s,sizes:c,minDelta:u,maxDelta:h,alt:l,snapBefore:d,snapAfter:f,disposable:r}};o(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:s,alt:r,minDelta:o,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const u=e-i,h=this.resize(t,u,s,void 0,void 0,o,a,l,c);if(r){const d=t===this.sashItems.length-1,f=this.viewItems.map(w=>w.size),g=d?t:t+1,p=this.viewItems[g],m=p.size-p.maximumSize,b=p.size-p.minimumSize,v=d?t-1:t+1;this.resize(v,-h,f,void 0,void 0,m,b)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=Xr(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(this.state!==fu.Idle)throw new Error("Cant modify splitview");if(this.state=fu.Busy,e<0||e>=this.viewItems.length)return;const i=Ps(this.viewItems.length).filter(a=>a!==e),s=[...i.filter(a=>this.viewItems[a].priority===1),e],r=i.filter(a=>this.viewItems[a].priority===2),o=this.viewItems[e];t=Math.round(t),t=Xr(t,o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(s,r),this.state=fu.Idle}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=Xr(i,a.minimumSize,a.maximumSize);const s=Ps(this.viewItems.length),r=s.filter(a=>this.viewItems[a].priority===1),o=s.filter(a=>this.viewItems[a].priority===2);this.relayout(r,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,s){if(this.state!==fu.Idle)throw new Error("Cant modify splitview");this.state=fu.Busy;const r=Be(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(r):this.viewContainer.insertBefore(r,this.viewContainer.children.item(i));const o=e.onDidChange(d=>this.onViewChange(u,d)),a=ut(()=>this.viewContainer.removeChild(r)),l=ka(o,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const u=this.orientation===0?new lWe(r,e,c,l):new cWe(r,e,c,l);if(this.viewItems.splice(i,0,u),this.viewItems.length>1){const d={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},f=this.orientation===0?new rs(this.sashContainer,{getHorizontalSashTop:T=>this.getSashPosition(T),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},d),{orientation:1})):new rs(this.sashContainer,{getVerticalSashLeft:T=>this.getSashPosition(T),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},d),{orientation:0})),g=this.orientation===0?T=>({sash:f,start:T.startY,current:T.currentY,alt:T.altKey}):T=>({sash:f,start:T.startX,current:T.currentX,alt:T.altKey}),m=Ee.map(f.onDidStart,g)(this.onSashStart,this),v=Ee.map(f.onDidChange,g)(this.onSashChange,this),y=Ee.map(f.onDidEnd,()=>this.sashItems.findIndex(T=>T.sash===f))(this.onSashEnd,this),x=f.onDidReset(()=>{const T=this.sashItems.findIndex($=>$.sash===f),k=Ps(T,-1),I=Ps(T+1,this.viewItems.length),N=this.findFirstSnapIndex(k),z=this.findFirstSnapIndex(I);typeof N=="number"&&!this.viewItems[N].visible||typeof z=="number"&&!this.viewItems[z].visible||this._onDidSashReset.fire(T)}),D=ka(m,v,y,x,f),S={sash:f,disposable:D};this.sashItems.splice(i-1,0,S)}r.appendChild(e.element);let h;typeof t!="number"&&t.type==="split"&&(h=[t.index]),s||this.relayout([i],h),this.state=fu.Idle,!s&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}relayout(e,t){const i=this.viewItems.reduce((s,r)=>s+r.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(u=>u.size),s,r,o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const u=Ps(e,-1),h=Ps(e+1,this.viewItems.length);if(r)for(const S of r)wN(u,S),wN(h,S);if(s)for(const S of s)px(u,S),px(h,S);const d=u.map(S=>this.viewItems[S]),f=u.map(S=>i[S]),g=h.map(S=>this.viewItems[S]),p=h.map(S=>i[S]),m=u.reduce((S,T)=>S+(this.viewItems[T].minimumSize-i[T]),0),b=u.reduce((S,T)=>S+(this.viewItems[T].maximumSize-i[T]),0),v=h.length===0?Number.POSITIVE_INFINITY:h.reduce((S,T)=>S+(i[T]-this.viewItems[T].minimumSize),0),w=h.length===0?Number.NEGATIVE_INFINITY:h.reduce((S,T)=>S+(i[T]-this.viewItems[T].maximumSize),0),y=Math.max(m,w,o),x=Math.min(v,b,a);let D=!1;if(l){const S=this.viewItems[l.index],T=t>=l.limitDelta;D=T!==S.visible,S.setVisible(T,l.size)}if(!D&&c){const S=this.viewItems[c.index],T=t<c.limitDelta;D=T!==S.visible,S.setVisible(T,c.size)}if(D)return this.resize(e,t,i,s,r,o,a);t=Xr(t,y,x);for(let S=0,T=t;S<d.length;S++){const k=d[S],I=Xr(f[S]+T,k.minimumSize,k.maximumSize),N=I-f[S];T-=N,k.size=I}for(let S=0,T=t;S<g.length;S++){const k=g[S],I=Xr(p[S]-T,k.minimumSize,k.maximumSize),N=I-p[S];T+=N,k.size=I}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const s=Ps(this.viewItems.length-1,-1),r=s.filter(a=>this.viewItems[a].priority===1),o=s.filter(a=>this.viewItems[a].priority===2);for(const a of o)wN(s,a);for(const a of r)px(s,a);typeof e=="number"&&px(s,e);for(let a=0;i!==0&&a<s.length;a++){const l=this.viewItems[s[a]],c=Xr(l.size+i,l.minimumSize,l.maximumSize),u=c-l.size;i-=u,l.size=c}}layoutViews(){this.contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),s=[...this.viewItems].reverse();e=!1;const r=s.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const o=s.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],u=this.viewItems[l];a+=u.size;const h=!(t[l]&&o[l+1]),d=!(i[l]&&r[l+1]);if(h&&d){const f=Ps(l,-1),g=Ps(l+1,this.viewItems.length),p=this.findFirstSnapIndex(f),m=this.findFirstSnapIndex(g),b=typeof p=="number"&&!this.viewItems[p].visible,v=typeof m=="number"&&!this.viewItems[m].visible;b&&r[l]&&(a>0||this.startSnappingEnabled)?c.state=1:v&&t[l]&&(a<this.contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else h&&!d?c.state=1:!h&&d?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)===null||e===void 0||e.disposable.dispose(),ti(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}class ES{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=ES.TemplateId,this.renderedTemplates=new Set;const s=new Map(t.map(r=>[r.templateId,r]));this.renderers=[];for(const r of e){const o=s.get(r.templateId);if(!o)throw new Error(`Table cell renderer for template id ${r.templateId} not found.`);this.renderers.push(o)}}renderTemplate(e){const t=Se(e,Be(".monaco-table-tr")),i=[],s=[];for(let o=0;o<this.columns.length;o++){const a=this.renderers[o],l=Se(t,Be(".monaco-table-td",{"data-col-index":o}));l.style.width=`${this.getColumnSize(o)}px`,i.push(l),s.push(a.renderTemplate(l))}const r={container:e,cellContainers:i,cellTemplateData:s};return this.renderedTemplates.add(r),r}renderElement(e,t,i,s){for(let r=0;r<this.columns.length;r++){const a=this.columns[r].project(e);this.renderers[r].renderElement(a,t,i.cellTemplateData[r],s)}}disposeElement(e,t,i,s){for(let r=0;r<this.columns.length;r++){const o=this.renderers[r];if(o.disposeElement){const l=this.columns[r].project(e);o.disposeElement(l,t,i.cellTemplateData[r],s)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);vo(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}ES.TemplateId="row";function uWe(n){return{getHeight(e){return n.getHeight(e)},getTemplateId(){return ES.TemplateId}}}class hWe{get minimumSize(){var e;return(e=this.column.minimumWidth)!==null&&e!==void 0?e:120}get maximumSize(){var e;return(e=this.column.maximumWidth)!==null&&e!==void 0?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return(e=this.column.onDidChangeWidthConstraints)!==null&&e!==void 0?e:Ee.None}constructor(e,t){this.column=e,this.index=t,this._onDidLayout=new G,this.onDidLayout=this._onDidLayout.event,this.element=Be(".monaco-table-th",{"data-col-index":t,title:e.tooltip},e.label)}layout(e){this._onDidLayout.fire([this.index,e])}}class nA{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,s,r,o){this.virtualDelegate=i,this.domId=`table_id_${++nA.InstanceCount}`,this.disposables=new Ae,this.cachedWidth=0,this.cachedHeight=0,this.domNode=Se(t,Be(`.monaco-table.${this.domId}`));const a=s.map((u,h)=>new hWe(u,h)),l={size:a.reduce((u,h)=>u+h.column.weight,0),views:a.map(u=>({size:u.column.weight,view:u}))};this.splitview=this.disposables.add(new jre(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new ES(s,r,u=>this.splitview.getViewSize(u));this.list=this.disposables.add(new Rl(e,this.domNode,uWe(i),[c],o)),Ee.any(...a.map(u=>u.onDidLayout))(([u,h])=>c.layoutColumn(u,h),null,this.disposables),this.splitview.onDidSashReset(u=>{const h=s.reduce((f,g)=>f+g.weight,0),d=s[u].weight/h*this.cachedWidth;this.splitview.resizeView(u,d)},null,this.disposables),this.styleElement=Fa(this.domNode),this.style(gBe)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}nA.InstanceCount=0;class Jb extends Nl{constructor(e){super(),this._onChange=this._register(new G),this.onChange=this._onChange.event,this._onKeyDown=this._register(new G),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Ye.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 2+2+2+16}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const dWe=_("caseDescription","Match Case"),fWe=_("wordsDescription","Match Whole Word"),gWe=_("regexDescription","Use Regular Expression");class qre extends Jb{constructor(e){super({icon:we.caseSensitive,title:dWe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Gre extends Jb{constructor(e){super({icon:we.wholeWord,title:fWe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Kre extends Jb{constructor(e){super({icon:we.regex,title:gWe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class pWe{constructor(e,t=0,i=e.length,s=t-1){this.items=e,this.start=t,this.end=i,this.index=s}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class mWe{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new pWe(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const F1=Be;let _We=class extends Nl{constructor(e,t,i){var s;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new G),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new G),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=(s=this.options.tooltip)!==null&&s!==void 0?s:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Se(e,F1(".monaco-inputbox.idle"));const r=this.options.flexibleHeight?"textarea":"input",o=Se(this.element,F1(".ibwrapper"));if(this.input=Se(o,F1(r+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Se(o,F1("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new use(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Se(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(c=>this.input.scrollTop=c.scrollTop));const a=this._register(new xt(document,"selectionchange")),l=Ee.filter(a.event,()=>{const c=document.getSelection();return(c==null?void 0:c.anchorNode)===o});this._register(l(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Fc(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.input.title=e}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:Dg(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&mo(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${jg(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=sr(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:s=>{var r,o;if(!this.message)return null;e=Se(s,F1(".monaco-inputbox-container")),t();const a={inline:!0,className:"monaco-inputbox-message"},l=this.message.formatContent?T9e(this.message.content,a):E9e(this.message.content,a);l.classList.add(this.classForType(this.message.type));const c=this.stylesForType(this.message.type);return l.style.backgroundColor=(r=c.background)!==null&&r!==void 0?r:"",l.style.color=(o=c.foreground)!==null&&o!==void 0?o:"",l.style.border=c.border?`1px solid ${c.border}`:"",Se(e,l),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=_("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=_("alertWarningMessage","Warning: {0}",this.message.content):i=_("alertInfoMessage","Info: {0}",this.message.content),_S(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText=" ",this.layout()}applyStyles(){var e,t,i;const s=this.options.inputBoxStyles,r=(e=s.inputBackground)!==null&&e!==void 0?e:"",o=(t=s.inputForeground)!==null&&t!==void 0?t:"",a=(i=s.inputBorder)!==null&&i!==void 0?i:"";this.element.style.backgroundColor=r,this.element.style.color=o,this.input.style.backgroundColor="inherit",this.input.style.color=o,this.element.style.border=`1px solid ${jg(a,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=Dg(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,s=t.selectionEnd,r=t.value;i!==null&&s!==null&&(this.value=r.substr(0,i)+e+r.substr(s),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)===null||e===void 0||e.dispose(),super.dispose()}};class Zre extends _We{constructor(e,t,i){const s=_({key:"history.inputbox.hint",comment:["Text will be prefixed with ⇅ plus a single space, then used as a hint where input field keeps history"]},"for history"),r=` or ⇅ ${s}`,o=` (⇅ ${s})`;super(e,t,i),this._onDidFocus=this._register(new G),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new G),this.onDidBlur=this._onDidBlur.event,this.history=new mWe(i.history,100);const a=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(r)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){const l=this.placeholder.endsWith(")")?r:o,c=this.placeholder+l;i.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=c:this.setPlaceHolder(c)}};this.observer=new MutationObserver((l,c)=>{l.forEach(u=>{u.target.textContent||a()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>a()),this.onblur(this.input,()=>{const l=c=>{if(this.placeholder.endsWith(c)){const u=this.placeholder.slice(0,this.placeholder.length-c.length);return i.showPlaceholderOnFocus?this.placeholder=u:this.setPlaceHolder(u),!0}else return!1};l(o)||l(r)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",ky(this.value?this.value:_("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,ky(this.value))}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const bWe=_("defaultLabel","input");class Yre extends Nl{constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new wl),this.additionalToggles=[],this._onDidOptionChange=this._register(new G),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new G),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new G),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new G),this._onKeyUp=this._register(new G),this._onCaseSensitiveKeyDown=this._register(new G),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new G),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||bWe,this.showCommonFindToggles=!!i.showCommonFindToggles;const s=i.appendCaseSensitiveLabel||"",r=i.appendWholeWordsLabel||"",o=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,u=i.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Zre(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:u,inputBoxStyles:i.inputBoxStyles})),this.showCommonFindToggles){this.regex=this._register(new Kre(Object.assign({appendTitle:o,isChecked:!1},i.toggleStyles))),this._register(this.regex.onChange(d=>{this._onDidOptionChange.fire(d),!d&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(d=>{this._onRegexKeyDown.fire(d)})),this.wholeWords=this._register(new Gre(Object.assign({appendTitle:r,isChecked:!1},i.toggleStyles))),this._register(this.wholeWords.onChange(d=>{this._onDidOptionChange.fire(d),!d&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new qre(Object.assign({appendTitle:s,isChecked:!1},i.toggleStyles))),this._register(this.caseSensitive.onChange(d=>{this._onDidOptionChange.fire(d),!d&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(d=>{this._onCaseSensitiveKeyDown.fire(d)}));const h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,d=>{if(d.equals(15)||d.equals(17)||d.equals(9)){const f=h.indexOf(document.activeElement);if(f>=0){let g=-1;d.equals(17)?g=(f+1)%h.length:d.equals(15)&&(f===0?g=h.length-1:g=f-1),d.equals(9)?(h[f].blur(),this.inputBox.focus()):g>=0&&h[g].focus(),rt.stop(d,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(oe(this.inputBox.inputElement,"compositionstart",h=>{this.imeSessionInProgress=!0})),this._register(oe(this.inputBox.inputElement,"compositionend",h=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)===null||e===void 0||e.enable(),(t=this.wholeWords)===null||t===void 0||t.enable(),(i=this.caseSensitive)===null||i===void 0||i.enable();for(const s of this.additionalToggles)s.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)===null||e===void 0||e.disable(),(t=this.wholeWords)===null||t===void 0||t.disable(),(i=this.caseSensitive)===null||i===void 0||i.disable();for(const s of this.additionalToggles)s.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new Ae;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,s,r,o,a;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=((i=(t=this.caseSensitive)===null||t===void 0?void 0:t.width())!==null&&i!==void 0?i:0)+((r=(s=this.wholeWords)===null||s===void 0?void 0:s.width())!==null&&r!==void 0?r:0)+((a=(o=this.regex)===null||o===void 0?void 0:o.width())!==null&&a!==void 0?a:0)+this.additionalToggles.reduce((l,c)=>l+c.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e,t;return(t=(e=this.caseSensitive)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e,t;return(t=(e=this.wholeWords)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e,t;return(t=(e=this.regex)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)===null||e===void 0||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}var Gl;(function(n){n[n.Expanded=0]="Expanded",n[n.Collapsed=1]="Collapsed",n[n.PreserveOrExpanded=2]="PreserveOrExpanded",n[n.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(Gl||(Gl={}));var Ng;(function(n){n[n.Unknown=0]="Unknown",n[n.Twistie=1]="Twistie",n[n.Element=2]="Element",n[n.Filter=3]="Filter"})(Ng||(Ng={}));class io extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class I7{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function N7(n){return typeof n=="object"&&"visibility"in n&&"data"in n}function qy(n){switch(n){case!0:return 1;case!1:return 0;default:return n}}function RR(n){return typeof n.collapsible=="boolean"}class vWe{constructor(e,t,i,s={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new s8,this._onDidChangeCollapseState=new G,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new G,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new G,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new xf(gne),this.collapseByDefault=typeof s.collapseByDefault>"u"?!1:s.collapseByDefault,this.filter=s.filter,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=Et.empty(),s={}){if(e.length===0)throw new io(this.user,"Invalid tree location");s.diffIdentityProvider?this.spliceSmart(s.diffIdentityProvider,e,t,i,s):this.spliceSimple(e,t,i,s)}spliceSmart(e,t,i,s,r,o){var a;s===void 0&&(s=Et.empty()),o===void 0&&(o=(a=r.diffDepth)!==null&&a!==void 0?a:0);const{parentNode:l}=this.getParentNodeWithListIndex(t);if(!l.lastDiffIds)return this.spliceSimple(t,i,s,r);const c=[...s],u=t[t.length-1],h=new Iu({getElements:()=>l.lastDiffIds},{getElements:()=>[...l.children.slice(0,u),...c,...l.children.slice(u+i)].map(m=>e.getId(m.element).toString())}).ComputeDiff(!1);if(h.quitEarly)return l.lastDiffIds=void 0,this.spliceSimple(t,i,c,r);const d=t.slice(0,-1),f=(m,b,v)=>{if(o>0)for(let w=0;w<v;w++)m--,b--,this.spliceSmart(e,[...d,m,0],Number.MAX_SAFE_INTEGER,c[b].children,r,o-1)};let g=Math.min(l.children.length,u+i),p=c.length;for(const m of h.changes.sort((b,v)=>v.originalStart-b.originalStart))f(g,p,g-(m.originalStart+m.originalLength)),g=m.originalStart,p=m.modifiedStart-u,this.spliceSimple([...d,g],m.originalLength,Et.slice(c,p,p+m.modifiedLength),r);f(g,p,g)}spliceSimple(e,t,i=Et.empty(),{onDidCreateNode:s,onDidDeleteNode:r,diffIdentityProvider:o}){const{parentNode:a,listIndex:l,revealed:c,visible:u}=this.getParentNodeWithListIndex(e),h=[],d=Et.map(i,S=>this.createTreeNode(S,a,a.visible?1:0,c,h,s)),f=e[e.length-1],g=a.children.length>0;let p=0;for(let S=f;S>=0&&S<a.children.length;S--){const T=a.children[S];if(T.visible){p=T.visibleChildIndex;break}}const m=[];let b=0,v=0;for(const S of d)m.push(S),v+=S.renderNodeCount,S.visible&&(S.visibleChildIndex=p+b++);const w=Mz(a.children,f,t,m);o?a.lastDiffIds?Mz(a.lastDiffIds,f,t,m.map(S=>o.getId(S.element).toString())):a.lastDiffIds=a.children.map(S=>o.getId(S.element).toString()):a.lastDiffIds=void 0;let y=0;for(const S of w)S.visible&&y++;if(y!==0)for(let S=f+m.length;S<a.children.length;S++){const T=a.children[S];T.visible&&(T.visibleChildIndex-=y)}if(a.visibleChildrenCount+=b-y,c&&u){const S=w.reduce((T,k)=>T+(k.visible?k.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,v-S),this.list.splice(l,S,h)}if(w.length>0&&r){const S=T=>{r(T),T.children.forEach(S)};w.forEach(S)}this._onDidSplice.fire({insertedNodes:m,deletedNodes:w});const x=a.children.length>0;g!==x&&this.setCollapsible(e.slice(0,-1),x);let D=a;for(;D;){if(D.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}D=D.parent}}rerender(e){if(e.length===0)throw new io(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:s}=this.getTreeNodeWithListIndex(e);t.visible&&s&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:s}=this.getTreeNodeWithListIndex(e);return i&&s?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const s={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,s))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const s=this.getTreeNode(e);typeof t>"u"&&(t=!s.collapsed);const r={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}_setCollapseState(e,t){const{node:i,listIndex:s,revealed:r}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(i,s,r,t);if(i!==this.root&&this.autoExpandSingleChildren&&o&&!RR(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return o}_setListNodeCollapseState(e,t,i,s){const r=this._setNodeCollapseState(e,s,!1);if(!i||!e.visible||!r)return r;const o=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=o-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),r}_setNodeCollapseState(e,t,i){let s;if(e===this.root?s=!1:(RR(t)?(s=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(s=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):s=!1,s&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!RR(t)&&t.recursive)for(const r of e.children)s=this._setNodeCollapseState(r,t,!0)||s;return s}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,s,r,o){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,s&&r.push(a);const c=e.children||Et.empty(),u=s&&l!==0&&!a.collapsed;let h=0,d=1;for(const f of c){const g=this.createTreeNode(f,a,l,u,r,o);a.children.push(g),d+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=h++)}return a.collapsible=a.collapsible||a.children.length>0,a.visibleChildrenCount=h,a.visible=l===2?h>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=d):(a.renderNodeCount=0,s&&r.pop()),o==null||o(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,s=!0){let r;if(e!==this.root){if(r=this._filterNode(e,t),r===0)return e.visible=!1,e.renderNodeCount=0,!1;s&&i.push(e)}const o=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||r!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,r,i,s&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=r===2?a:r===1,e.visibility=r),e.visible?e.collapsed||(e.renderNodeCount+=i.length-o):(e.renderNodeCount=0,s&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):N7(i)?(e.filterData=i.data,qy(i.visibility)):(e.filterData=void 0,qy(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...s]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(s,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...s]=e;if(i<0||i>t.children.length)throw new io(this.user,"Invalid tree location");return this.getTreeNode(s,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:s,visible:r}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new io(this.user,"Invalid tree location");const a=t.children[o];return{node:a,listIndex:i,revealed:s,visible:r&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,s=!0,r=!0){const[o,...a]=e;if(o<0||o>t.children.length)throw new io(this.user,"Invalid tree location");for(let l=0;l<o;l++)i+=t.children[l].renderNodeCount;return s=s&&!t.collapsed,r=r&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:s,visible:r}:this.getParentNodeWithListIndex(a,t.children[o],i+1,s,r)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:HEe(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}globalThis&&globalThis.__awaiter;class wWe extends kS{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function MR(n){return n instanceof kS?new wWe(n):n}class yWe{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=ae.None,this.disposables=new Ae}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,MR(e),t)}onDragOver(e,t,i,s,r=!0){const o=this.dnd.onDragOver(MR(e),t&&t.element,i,s),a=this.autoExpandNode!==t;if(a&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return o;if(a&&typeof o!="boolean"&&o.autoExpand&&(this.autoExpandDisposable=WL(()=>{const d=this.modelProvider(),f=d.getNodeLocation(t);d.isCollapsed(f)&&d.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof o=="boolean"||!o.accept||typeof o.bubble>"u"||o.feedback){if(!r){const d=typeof o=="boolean"?o:o.accept,f=typeof o=="boolean"?void 0:o.effect;return{accept:d,effect:f,feedback:[i]}}return o}if(o.bubble===1){const d=this.modelProvider(),f=d.getNodeLocation(t),g=d.getParentNodeLocation(f),p=d.getNode(g),m=g&&d.getListIndex(g);return this.onDragOver(e,p,m,s,!1)}const l=this.modelProvider(),c=l.getNodeLocation(t),u=l.getListIndex(c),h=l.getListRenderCount(c);return Object.assign(Object.assign({},o),{feedback:Ps(u,u+h)})}drop(e,t,i,s){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(MR(e),t&&t.element,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function CWe(n,e){return e&&Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new yWe(n,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))}},accessibilityProvider:e.accessibilityProvider&&Object.assign(Object.assign({},e.accessibilityProvider),{getSetSize(t){const i=n(),s=i.getNodeLocation(t),r=i.getParentNodeLocation(s);return i.getNode(r).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))}),keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}})})}class R7{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,s;(s=(i=this.delegate).setDynamicHeight)===null||s===void 0||s.call(i,e.element,t)}}var Gy;(function(n){n.None="none",n.OnHover="onHover",n.Always="always"})(Gy||(Gy={}));class SWe{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new Ae,this.onDidChange=Ee.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}class Ky{constructor(e,t,i,s,r,o={}){var a;this.renderer=e,this.modelProvider=t,this.activeNodes=s,this.renderedIndentGuides=r,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=Ky.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=ae.None,this.disposables=new Ae,this.templateId=e.templateId,this.updateOptions(o),Ee.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)===null||a===void 0||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=Xr(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,s]of this.renderedNodes)this.renderTreeElement(i,s)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==Gy.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,s]of this.renderedNodes)this._renderIndentGuides(i,s);if(this.indentGuidesDisposable.dispose(),t){const i=new Ae;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=Se(e,Be(".monaco-tl-row")),i=Se(t,Be(".monaco-tl-indent")),s=Se(t,Be(".monaco-tl-twistie")),r=Se(t,Be(".monaco-tl-contents")),o=this.renderer.renderTemplate(r);return{container:e,indent:i,twistie:s,indentGuidesDisposable:ae.None,templateData:o}}renderElement(e,t,i,s){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,s)}disposeElement(e,t,i,s){var r,o;i.indentGuidesDisposable.dispose(),(o=(r=this.renderer).disposeElement)===null||o===void 0||o.call(r,e,t,i.templateData,s),typeof s=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=Ky.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Ye.asClassNameArray(we.treeItemExpanded));let s=!1;this.renderer.renderTwistie&&(s=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(s||t.twistie.classList.add(...Ye.asClassNameArray(we.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(vo(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new Ae,s=this.modelProvider();for(;;){const r=s.getNodeLocation(e),o=s.getParentNodeLocation(r);if(!o)break;const a=s.getNode(o),l=Be(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(a)&&l.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(l):t.indent.insertBefore(l,t.indent.firstElementChild),this.renderedIndentGuides.add(a,l),i.add(ut(()=>this.renderedIndentGuides.delete(a,l))),e=a}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(s=>{const r=i.getNodeLocation(s);try{const o=i.getParentNodeLocation(r);s.collapsible&&s.children.length>0&&!s.collapsed?t.add(s):o&&t.add(i.getNode(o))}catch{}}),this.activeIndentNodes.forEach(s=>{t.has(s)||this.renderedIndentGuides.forEach(s,r=>r.classList.remove("active"))}),t.forEach(s=>{this.activeIndentNodes.has(s)||this.renderedIndentGuides.forEach(s,r=>r.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),ti(this.disposables)}}Ky.DefaultIndent=8;class xWe{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new Ae,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const o=this._filter.filter(e,t);if(typeof o=="boolean"?i=o?1:0:N7(o)?i=qy(o.visibility):i=o,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Xg.Default,visibility:i};const s=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(s)?s:[s];for(const o of r){const a=o&&o.toString();if(typeof a>"u")return{data:Xg.Default,visibility:i};let l;if(this.tree.findMatchType===Tp.Contiguous){const c=a.toLowerCase().indexOf(this._lowercasePattern);if(c>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let u=this._lowercasePattern.length;u>0;u--)l.push(c+u-1)}}else l=Ere(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,r.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===wc.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:Xg.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){ti(this.disposables)}}var wc;(function(n){n[n.Highlight=0]="Highlight",n[n.Filter=1]="Filter"})(wc||(wc={}));var Tp;(function(n){n[n.Fuzzy=0]="Fuzzy",n[n.Contiguous=1]="Contiguous"})(Tp||(Tp={}));let kWe=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,s,r,o={}){var a,l;this.tree=e,this.view=i,this.filter=s,this.contextViewProvider=r,this.options=o,this._pattern="",this.width=0,this._onDidChangeMode=new G,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new G,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new G,this._onDidChangeOpenState=new G,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new Ae,this.disposables=new Ae,this._mode=(a=e.options.defaultFindMode)!==null&&a!==void 0?a:wc.Highlight,this._matchType=(l=e.options.defaultFindMatchType)!==null&&l!==void 0?l:Tp.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){var e,t,i,s;const r=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&r?!((e=this.tree.options.showNotFoundMessage)!==null&&e!==void 0)||e?(t=this.widget)===null||t===void 0||t.showMessage({type:2,content:_("not found","No elements found.")}):(i=this.widget)===null||i===void 0||i.showMessage({type:2}):(s=this.widget)===null||s===void 0||s.clearMessage()}shouldAllowFocus(e){return!this.widget||!this.pattern||this._mode===wc.Filter||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Xg.isDefault(e.filterData)}layout(e){var t;this.width=e,(t=this.widget)===null||t===void 0||t.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function dq(n){let e=Ng.Unknown;return PN(n.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=Ng.Twistie:PN(n.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=Ng.Element:PN(n.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=Ng.Filter),{browserEvent:n.browserEvent,element:n.element?n.element.element:null,target:e}}function dk(n,e){e(n),n.children.forEach(t=>dk(t,e))}class FR{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new G,this.onDidChange=this._onDidChange.event}set(e,t){!(t!=null&&t.__forceEvent)&&yn(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const s=this;this._onDidChange.fire({get elements(){return s.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=u=>l.delete(u);t.forEach(u=>dk(u,c)),this.set([...l.values()]);return}const i=new Set,s=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>dk(l,s));const r=new Map,o=l=>r.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>dk(l,o));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const h=r.get(c);h&&h.visible&&a.push(h)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class LWe extends Pre{constructor(e,t){super(e),this.tree=t}onViewPointer(e){if(Nre(e.browserEvent.target)||Md(e.browserEvent.target)||D0(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,s=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let r=!1;if(typeof this.tree.expandOnlyOnTwistieClick=="function"?r=this.tree.expandOnlyOnTwistieClick(t.element):r=!!this.tree.expandOnlyOnTwistieClick,r&&!s&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e);if(t.collapsible){const o=this.tree.getNodeLocation(t),a=e.browserEvent.altKey;if(this.tree.setFocus([o]),this.tree.toggleCollapsed(o,a),r&&s){e.browserEvent.isHandledByList=!0;return}}super.onViewPointer(e)}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}}class DWe extends Rl{constructor(e,t,i,s,r,o,a,l){super(e,t,i,s,l),this.focusTrait=r,this.selectionTrait=o,this.anchorTrait=a}createMouseController(e){return new LWe(this,e.tree)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const s=[],r=[];let o;i.forEach((a,l)=>{this.focusTrait.has(a)&&s.push(e+l),this.selectionTrait.has(a)&&r.push(e+l),this.anchorTrait.has(a)&&(o=e+l)}),s.length>0&&super.setFocus(Cp([...super.getFocus(),...s])),r.length>0&&super.setSelection(Cp([...super.getSelection(),...r])),typeof o=="number"&&super.setAnchor(o)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(s=>this.element(s)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(s=>this.element(s)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class Xre{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Ee.filter(Ee.map(this.view.onMouseDblClick,dq),e=>e.target!==Ng.Filter)}get onPointer(){return Ee.map(this.view.onPointer,dq)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Ee.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var e,t;return(t=(e=this.findController)===null||e===void 0?void 0:e.mode)!==null&&t!==void 0?t:wc.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){var e,t;return(t=(e=this.findController)===null||e===void 0?void 0:e.matchType)!==null&&t!==void 0?t:Tp.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,s,r={}){var o;this._user=e,this._options=r,this.eventBufferer=new s8,this.onDidChangeFindOpenState=Ee.None,this.disposables=new Ae,this._onWillRefilter=new G,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new G;const a=new R7(i),l=new $z,c=new $z,u=this.disposables.add(new SWe(c.event)),h=new Mne;this.renderers=s.map(m=>new Ky(m,()=>this.model,l.event,u,h,r));for(const m of this.renderers)this.disposables.add(m);let d;r.keyboardNavigationLabelProvider&&(d=new xWe(this,r.keyboardNavigationLabelProvider,r.filter),r=Object.assign(Object.assign({},r),{filter:d}),this.disposables.add(d)),this.focus=new FR(()=>this.view.getFocusedElements()[0],r.identityProvider),this.selection=new FR(()=>this.view.getSelectedElements()[0],r.identityProvider),this.anchor=new FR(()=>this.view.getAnchorElement(),r.identityProvider),this.view=new DWe(e,t,a,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},CWe(()=>this.model,r)),{tree:this})),this.model=this.createModel(e,this.view,r),l.input=this.model.onDidChangeCollapseState;const f=Ee.forEach(this.model.onDidSplice,m=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(m),this.selection.onDidModelSplice(m)})},this.disposables);f(()=>null,null,this.disposables);const g=this.disposables.add(new G),p=this.disposables.add(new xf(0));if(this.disposables.add(Ee.any(f,this.focus.onDidChange,this.selection.onDidChange)(()=>{p.trigger(()=>{const m=new Set;for(const b of this.focus.getNodes())m.add(b);for(const b of this.selection.getNodes())m.add(b);g.fire([...m.values()])})})),c.input=g.event,r.keyboardSupport!==!1){const m=Ee.chain(this.view.onKeyDown,b=>b.filter(v=>!Md(v.target)).map(v=>new ri(v)));Ee.chain(m,b=>b.filter(v=>v.keyCode===15))(this.onLeftArrow,this,this.disposables),Ee.chain(m,b=>b.filter(v=>v.keyCode===17))(this.onRightArrow,this,this.disposables),Ee.chain(m,b=>b.filter(v=>v.keyCode===10))(this.onSpace,this,this.disposables)}if((!((o=r.findWidgetEnabled)!==null&&o!==void 0)||o)&&r.keyboardNavigationLabelProvider&&r.contextViewProvider){const m=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new kWe(this,this.model,this.view,d,r.contextViewProvider,m),this.focusNavigationFilter=b=>this.findController.shouldAllowFocus(b),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=Ee.None,this.onDidChangeFindMatchType=Ee.None;this.styleElement=Fa(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Gy.Always)}updateOptions(e={}){var t;this._options=Object.assign(Object.assign({},this._options),e);for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)===null||t===void 0||t.updateOptions(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Gy.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}domFocus(){this.view.domFocus()}layout(e,t){var i;this.view.layout(e,t),Xd(t)&&((i=this.findController)===null||i===void 0||i.layout(t))}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){const i=e.map(r=>this.model.getNode(r));this.selection.set(i,t);const s=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setSelection(s,t,!0)}getSelection(){return this.selection.get()}setFocus(e,t){const i=e.map(r=>this.model.getNode(r));this.focus.set(i,t);const s=e.map(r=>this.model.getListIndex(r)).filter(r=>r>-1);this.view.setFocus(s,t,!0)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);i!==-1&&this.view.reveal(i,t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!0)){const o=this.model.getParentNodeLocation(s);if(!o)return;const a=this.model.getListIndex(o);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!1)){if(!i.children.some(l=>l.visible))return;const[o]=this.view.getFocus(),a=o+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i),r=e.browserEvent.altKey;this.model.setCollapsed(s,void 0,r)}dispose(){ti(this.disposables),this.view.dispose()}}class M7{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new vWe(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(s,r){return i.sorter.compare(s.element,r.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=Et.empty(),i={}){const s=this.getElementLocation(e);this._setChildren(s,this.preserveCollapseState(t),i)}_setChildren(e,t=Et.empty(),i){const s=new Set,r=new Set,o=l=>{var c;if(l.element===null)return;const u=l;if(s.add(u.element),this.nodes.set(u.element,u),this.identityProvider){const h=this.identityProvider.getId(u.element).toString();r.add(h),this.nodesByIdentity.set(h,u)}(c=i.onDidCreateNode)===null||c===void 0||c.call(i,u)},a=l=>{var c;if(l.element===null)return;const u=l;if(s.has(u.element)||this.nodes.delete(u.element),this.identityProvider){const h=this.identityProvider.getId(u.element).toString();r.has(h)||this.nodesByIdentity.delete(h)}(c=i.onDidDeleteNode)===null||c===void 0||c.call(i,u)};this.model.splice([...e,0],Number.MAX_VALUE,t,Object.assign(Object.assign({},i),{onDidCreateNode:o,onDidDeleteNode:a}))}preserveCollapseState(e=Et.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Et.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const o=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(o)}if(!i){let o;return typeof t.collapsed>"u"?o=void 0:t.collapsed===Gl.Collapsed||t.collapsed===Gl.PreserveOrCollapsed?o=!0:t.collapsed===Gl.Expanded||t.collapsed===Gl.PreserveOrExpanded?o=!1:o=!!t.collapsed,Object.assign(Object.assign({},t),{children:this.preserveCollapseState(t.children),collapsed:o})}const s=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let r;return typeof t.collapsed>"u"||t.collapsed===Gl.PreserveOrCollapsed||t.collapsed===Gl.PreserveOrExpanded?r=i.collapsed:t.collapsed===Gl.Collapsed?r=!0:t.collapsed===Gl.Expanded?r=!1:r=!!t.collapsed,Object.assign(Object.assign({},t),{collapsible:s,collapsed:r,children:this.preserveCollapseState(t.children)})})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const s=this.getElementLocation(e);return this.model.setCollapsed(s,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new io(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new io(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new io(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),s=this.model.getParentNodeLocation(i);return this.model.getNode(s).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new io(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function fk(n){const e=[n.element],t=n.incompressible||!1;return{element:{elements:e,incompressible:t},children:Et.map(Et.from(n.children),fk),collapsible:n.collapsible,collapsed:n.collapsed}}function gk(n){const e=[n.element],t=n.incompressible||!1;let i,s;for(;[s,i]=Et.consume(Et.from(n.children),2),!(s.length!==1||s[0].incompressible);)n=s[0],e.push(n.element);return{element:{elements:e,incompressible:t},children:Et.map(Et.concat(s,i),gk),collapsible:n.collapsible,collapsed:n.collapsed}}function dP(n,e=0){let t;return e<n.element.elements.length-1?t=[dP(n,e+1)]:t=Et.map(Et.from(n.children),i=>dP(i,0)),e===0&&n.element.incompressible?{element:n.element.elements[e],children:t,incompressible:!0,collapsible:n.collapsible,collapsed:n.collapsed}:{element:n.element.elements[e],children:t,collapsible:n.collapsible,collapsed:n.collapsed}}function fq(n){return dP(n,0)}function Qre(n,e,t){return n.element===e?Object.assign(Object.assign({},n),{children:t}):Object.assign(Object.assign({},n),{children:Et.map(Et.from(n.children),i=>Qre(i,e,t))})}const EWe=n=>({getId(e){return e.elements.map(t=>n.getId(t).toString()).join("\0")}});class TWe{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new M7(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=Et.empty(),i){const s=i.diffIdentityProvider&&EWe(i.diffIdentityProvider);if(e===null){const g=Et.map(t,this.enabled?gk:fk);this._setChildren(null,g,{diffIdentityProvider:s,diffDepth:1/0});return}const r=this.nodes.get(e);if(!r)throw new io(this.user,"Unknown compressed tree node");const o=this.model.getNode(r),a=this.model.getParentNodeLocation(r),l=this.model.getNode(a),c=fq(o),u=Qre(c,e,t),h=(this.enabled?gk:fk)(u),d=i.diffIdentityProvider?(g,p)=>i.diffIdentityProvider.getId(g)===i.diffIdentityProvider.getId(p):void 0;if(yn(h.element.elements,o.element.elements,d)){this._setChildren(r,h.children||Et.empty(),{diffIdentityProvider:s,diffDepth:1});return}const f=l.children.map(g=>g===o?h:g);this._setChildren(l.element,f,{diffIdentityProvider:s,diffDepth:o.depth-l.depth})}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,s=Et.map(i,fq),r=Et.map(s,e?gk:fk);this._setChildren(null,r,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const s=new Set,r=a=>{for(const l of a.element.elements)s.add(l),this.nodes.set(l,a.element)},o=a=>{for(const l of a.element.elements)s.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,Object.assign(Object.assign({},i),{onDidCreateNode:r,onDidDeleteNode:o}))}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const s=this.getCompressedNode(e);return this.model.setCollapsed(s,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new io(this.user,`Tree element not found: ${e}`);return t}}const AWe=n=>n[n.length-1];class F7{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new F7(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function IWe(n,e){return{splice(t,i,s){e.splice(t,i,s.map(r=>n.map(r)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function NWe(n,e){return Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(n(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(n(t),i)}}})}class RWe{get onDidSplice(){return Ee.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return Ee.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return Ee.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||AWe;const s=r=>this.elementMapper(r.elements);this.nodeMapper=new I7(r=>new F7(s,r)),this.model=new TWe(e,IWe(this.nodeMapper,t),NWe(s,i))}setChildren(e,t=Et.empty(),i={}){this.model.setChildren(e,t,i)}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var MWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};class P7 extends Xre{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,s,r={}){super(e,t,i,s,r),this.user=e}setChildren(e,t=Et.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new M7(e,t,i)}}class Jre{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t){this._compressedTreeNodeProvider=e,this.renderer=t,this.templateId=t.templateId,t.onDidChangeTwistieState&&(this.onDidChangeTwistieState=t.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){const r=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element);r.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,s)):(i.compressedTreeNode=r,this.renderer.renderCompressedElements(r,t,i.data,s))}disposeElement(e,t,i,s){var r,o,a,l;i.compressedTreeNode?(o=(r=this.renderer).disposeCompressedElements)===null||o===void 0||o.call(r,i.compressedTreeNode,t,i.data,s):(l=(a=this.renderer).disposeElement)===null||l===void 0||l.call(a,e,t,i.data,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}MWe([ji],Jre.prototype,"compressedTreeNodeProvider",null);function FWe(n,e){return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=n().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}})}class eoe extends P7{constructor(e,t,i,s,r={}){const o=()=>this,a=s.map(l=>new Jre(o,l));super(e,t,i,a,FWe(o,r))}setChildren(e,t=Et.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new RWe(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}var Lh=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function PR(n){return Object.assign(Object.assign({},n),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function fP(n,e){return e.parent?e.parent===n?!0:fP(n,e.parent):!1}function PWe(n,e){return n===e||fP(n,e)||fP(e,n)}class O7{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new O7(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class OWe{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ye.asClassNameArray(we.treeItemLoading)),!0):(t.classList.remove(...Ye.asClassNameArray(we.treeItemLoading)),!1)}disposeElement(e,t,i,s){var r,o;(o=(r=this.renderer).disposeElement)===null||o===void 0||o.call(r,this.nodeMapper.map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function gq(n){return{browserEvent:n.browserEvent,elements:n.elements.map(e=>e.element)}}function pq(n){return{browserEvent:n.browserEvent,element:n.element&&n.element.element,target:n.target}}class BWe extends kS{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function OR(n){return n instanceof kS?new BWe(n):n}class WWe{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,OR(e),t)}onDragOver(e,t,i,s,r=!0){return this.dnd.onDragOver(OR(e),t&&t.element,i,s)}drop(e,t,i,s){this.dnd.drop(OR(e),t&&t.element,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}dispose(){this.dnd.dispose()}}function toe(n){return n&&Object.assign(Object.assign({},n),{collapseByDefault:!0,identityProvider:n.identityProvider&&{getId(e){return n.identityProvider.getId(e.element)}},dnd:n.dnd&&new WWe(n.dnd),multipleSelectionController:n.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return n.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},isSelectionRangeChangeEvent(e){return n.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))}},accessibilityProvider:n.accessibilityProvider&&Object.assign(Object.assign({},n.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:n.accessibilityProvider.getRole?e=>n.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:n.accessibilityProvider.isChecked?e=>{var t;return!!(!((t=n.accessibilityProvider)===null||t===void 0)&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return n.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return n.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:n.accessibilityProvider.getWidgetRole?()=>n.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:n.accessibilityProvider.getAriaLevel&&(e=>n.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:n.accessibilityProvider.getActiveDescendantId&&(e=>n.accessibilityProvider.getActiveDescendantId(e.element))}),filter:n.filter&&{filter(e,t){return n.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:n.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},n.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(e){return n.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}),sorter:void 0,expandOnlyOnTwistieClick:typeof n.expandOnlyOnTwistieClick>"u"?void 0:typeof n.expandOnlyOnTwistieClick!="function"?n.expandOnlyOnTwistieClick:e=>n.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof n.defaultFindVisibility=="number"?n.defaultFindVisibility:typeof n.defaultFindVisibility>"u"?2:n.defaultFindVisibility(e.element)})}function gP(n,e){e(n),n.children.forEach(t=>gP(t,e))}class ioe{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return Ee.map(this.tree.onDidChangeFocus,gq)}get onDidChangeSelection(){return Ee.map(this.tree.onDidChangeSelection,gq)}get onMouseDblClick(){return Ee.map(this.tree.onMouseDblClick,pq)}get onPointer(){return Ee.map(this.tree.onPointer,pq)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,s,r,o={}){this.user=e,this.dataSource=r,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new G,this._onDidChangeNodeSlowState=new G,this.nodeMapper=new I7(a=>new O7(a)),this.disposables=new Ae,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=typeof o.autoExpandSingleChildren>"u"?!1:o.autoExpandSingleChildren,this.sorter=o.sorter,this.collapseByDefault=o.collapseByDefault,this.tree=this.createTree(e,t,i,s,o),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.root=PR({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,s,r){const o=new R7(i),a=s.map(c=>new OWe(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=toe(r)||{};return new P7(e,t,o,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}setInput(e,t){return Lh(this,void 0,void 0,function*(){this.refreshPromises.forEach(s=>s.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};yield this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)})}_updateChildren(e=this.root.element,t=!0,i=!1,s,r){return Lh(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new io(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Ee.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(yield this.refreshAndRenderNode(o,t,s,r),i)try{this.tree.rerender(o)}catch{}})}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}expand(e,t=!1){return Lh(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new io(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Ee.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(yield this.root.refreshPromise,yield Ee.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const s=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(yield this.root.refreshPromise,yield Ee.toPromise(this._onDidRender.event)),s})}setSelection(e,t){const i=e.map(s=>this.getDataNode(s));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(s=>this.getDataNode(s));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new io(this.user,`Data tree node not found: ${e}`);return t}refreshAndRenderNode(e,t,i,s){return Lh(this,void 0,void 0,function*(){yield this.refreshNode(e,t,i),this.render(e,i,s)})}refreshNode(e,t,i){return Lh(this,void 0,void 0,function*(){let s;if(this.subTreeRefreshPromises.forEach((r,o)=>{!s&&PWe(o,e)&&(s=r.then(()=>this.refreshNode(e,t,i)))}),s)return s;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0;return}return this.doRefreshSubTree(e,t,i)})}doRefreshSubTree(e,t,i){return Lh(this,void 0,void 0,function*(){let s;e.refreshPromise=new Promise(r=>s=r),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const r=yield this.doRefreshNode(e,t,i);e.stale=!1,yield q3.settled(r.map(o=>this.doRefreshSubTree(o,t,i)))}finally{s()}})}doRefreshNode(e,t,i){return Lh(this,void 0,void 0,function*(){e.hasChildren=!!this.dataSource.hasChildren(e.element);let s;if(!e.hasChildren)s=Promise.resolve(Et.empty());else{const r=this.doGetChildren(e);if(Fz(r))s=Promise.resolve(r);else{const o=py(800);o.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),s=r.finally(()=>o.cancel())}}try{const r=yield s;return this.setChildren(e,r,t,i)}catch(r){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),Qp(r))return[];throw r}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}})}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return Fz(i)?this.processChildren(i):(t=ch(()=>Lh(this,void 0,void 0,function*(){return this.processChildren(yield i)})),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(Ft))}setChildren(e,t,i,s){const r=[...t];if(e.children.length===0&&r.length===0)return[];const o=new Map,a=new Map;for(const u of e.children)if(o.set(u.element,u),this.identityProvider){const h=this.tree.isCollapsed(u);a.set(u.id,{node:u,collapsed:h})}const l=[],c=r.map(u=>{const h=!!this.dataSource.hasChildren(u);if(!this.identityProvider){const p=PR({element:u,parent:e,hasChildren:h});return h&&this.collapseByDefault&&!this.collapseByDefault(u)&&(p.collapsedByDefault=!1,l.push(p)),p}const d=this.identityProvider.getId(u).toString(),f=a.get(d);if(f){const p=f.node;return o.delete(p.element),this.nodes.delete(p.element),this.nodes.set(u,p),p.element=u,p.hasChildren=h,i?f.collapsed?(p.children.forEach(m=>gP(m,b=>this.nodes.delete(b.element))),p.children.splice(0,p.children.length),p.stale=!0):l.push(p):h&&this.collapseByDefault&&!this.collapseByDefault(u)&&(p.collapsedByDefault=!1,l.push(p)),p}const g=PR({element:u,parent:e,id:d,hasChildren:h});return s&&s.viewState.focus&&s.viewState.focus.indexOf(d)>-1&&s.focus.push(g),s&&s.viewState.selection&&s.viewState.selection.indexOf(d)>-1&&s.selection.push(g),s&&s.viewState.expanded&&s.viewState.expanded.indexOf(d)>-1?l.push(g):h&&this.collapseByDefault&&!this.collapseByDefault(u)&&(g.collapsedByDefault=!1,l.push(g)),g});for(const u of o.values())gP(u,h=>this.nodes.delete(h.element));for(const u of c)this.nodes.set(u.element,u);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].collapsedByDefault=!1,l.push(c[0])),l}render(e,t,i){const s=e.children.map(o=>this.asTreeElement(o,t)),r=i&&Object.assign(Object.assign({},i),{diffIdentityProvider:i.diffIdentityProvider&&{getId(o){return i.diffIdentityProvider.getId(o.element)}}});this.tree.setChildren(e===this.root?null:e,s,r),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:i=e.collapsedByDefault,e.collapsedByDefault=void 0,{element:e,children:e.hasChildren?Et.map(e.children,s=>this.asTreeElement(s,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class B7{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new B7(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class VWe{constructor(e,t,i,s){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=s,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderCompressedElements(e,t,i,s){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ye.asClassNameArray(we.treeItemLoading)),!0):(t.classList.remove(...Ye.asClassNameArray(we.treeItemLoading)),!1)}disposeElement(e,t,i,s){var r,o;(o=(r=this.renderer).disposeElement)===null||o===void 0||o.call(r,this.nodeMapper.map(e),t,i.templateData,s)}disposeCompressedElements(e,t,i,s){var r,o;(o=(r=this.renderer).disposeCompressedElements)===null||o===void 0||o.call(r,this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=ti(this.disposables)}}function $We(n){const e=n&&toe(n);return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel(t){return n.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}})})}class zWe extends ioe{constructor(e,t,i,s,r,o,a={}){super(e,t,i,r,o,a),this.compressionDelegate=s,this.compressibleNodeMapper=new I7(l=>new B7(l)),this.filter=a.filter}createTree(e,t,i,s,r){const o=new R7(i),a=s.map(c=>new VWe(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=$We(r)||{};return new eoe(e,t,o,a,l)}asTreeElement(e,t){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(e.element)},super.asTreeElement(e,t))}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t){if(!this.identityProvider)return super.render(e,t);const i=d=>this.identityProvider.getId(d).toString(),s=d=>{const f=new Set;for(const g of d){const p=this.tree.getCompressedTreeNode(g===this.root?null:g);if(p.element)for(const m of p.element.elements)f.add(i(m.element))}return f},r=s(this.tree.getSelection()),o=s(this.tree.getFocus());super.render(e,t);const a=this.getSelection();let l=!1;const c=this.getFocus();let u=!1;const h=d=>{const f=d.element;if(f)for(let g=0;g<f.elements.length;g++){const p=i(f.elements[g].element),m=f.elements[f.elements.length-1].element;r.has(p)&&a.indexOf(m)===-1&&(a.push(m),l=!0),o.has(p)&&c.indexOf(m)===-1&&(c.push(m),u=!0)}d.children.forEach(h)};h(this.tree.getCompressedTreeNode(e===this.root?null:e)),l&&this.setSelection(a),u&&this.setFocus(c)}processChildren(e){return this.filter&&(e=Et.filter(e,t=>{const i=this.filter.filter(t,1),s=HWe(i);if(s===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return s===1})),super.processChildren(e)}}function HWe(n){return typeof n=="boolean"?n?1:0:N7(n)?qy(n.visibility):qy(n)}class UWe extends Xre{constructor(e,t,i,s,r,o={}){super(e,t,i,s,o),this.user=e,this.dataSource=r,this.identityProvider=o.identityProvider}createModel(e,t,i){return new M7(e,t,i)}}new Fe("isMac",Mt,_("isMac","Whether the operating system is macOS"));new Fe("isLinux",Ts,_("isLinux","Whether the operating system is Linux"));new Fe("isWindows",br,_("isWindows","Whether the operating system is Windows"));const noe=new Fe("isWeb",Hb,_("isWeb","Whether the platform is a web browser"));new Fe("isMacNative",Mt&&!Hb,_("isMacNative","Whether the operating system is macOS on a non-browser platform"));new Fe("isIOS",Qd,_("isIOS","Whether the operating system is iOS"));new Fe("isMobile",cTe,_("isMobile","Whether the platform is a mobile web browser"));new Fe("isDevelopment",!1,!0);new Fe("productQualityType","",_("productQualityType","Quality type of VS Code"));const soe="inputFocus";new Fe(soe,!1,_("inputFocus","Whether keyboard focus is inside an input box"));var fh=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ii=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const Ko=kt("listService");class jWe{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new Ae,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)===null||t===void 0||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)===null||i===void 0||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new Ore(Fa(),"").style(fm)),this.lists.some(s=>s.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),e.getHTMLElement()===document.activeElement&&this.setLastFocusedList(e),ka(e.onDidFocus(()=>this.setLastFocusedList(e)),ut(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(s=>s!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const Zy=new Fe("listScrollAtBoundary","none");Ve.or(Zy.isEqualTo("top"),Zy.isEqualTo("both"));Ve.or(Zy.isEqualTo("bottom"),Zy.isEqualTo("both"));const roe=new Fe("listFocus",!0),sA=new Fe("listSupportsMultiselect",!0),ooe=Ve.and(roe,Ve.not(soe)),W7=new Fe("listHasSelectionOrFocus",!1),V7=new Fe("listDoubleSelection",!1),$7=new Fe("listMultiSelection",!1),rA=new Fe("listSelectionNavigation",!1),qWe=new Fe("listSupportsFind",!0),z7=new Fe("treeElementCanCollapse",!1),GWe=new Fe("treeElementHasParent",!1),H7=new Fe("treeElementCanExpand",!1),KWe=new Fe("treeElementHasChild",!1),ZWe=new Fe("treeFindOpen",!1),aoe="listTypeNavigationMode",loe="listAutomaticKeyboardNavigation";function oA(n,e){const t=n.createScoped(e.getHTMLElement());return roe.bindTo(t),t}function aA(n,e){const t=Zy.bindTo(n),i=()=>{const s=e.scrollTop===0,r=e.scrollHeight-e.renderHeight-e.scrollTop<1;s&&r?t.set("both"):s?t.set("top"):r?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const gm="workbench.list.multiSelectModifier",pk="workbench.list.openMode",Vo="workbench.list.horizontalScrolling",U7="workbench.list.defaultFindMode",j7="workbench.list.typeNavigationMode",ND="workbench.list.keyboardNavigation",xl="workbench.list.scrollByPage",q7="workbench.list.defaultFindMatchType",Yy="workbench.tree.indent",RD="workbench.tree.renderIndentGuides",kl="workbench.list.smoothScrolling",Pc="workbench.list.mouseWheelScrollSensitivity",Oc="workbench.list.fastScrollSensitivity",MD="workbench.tree.expandMode";function Bc(n){return n.getValue(gm)==="alt"}class YWe extends ae{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Bc(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(gm)&&(this.useAltAsMultipleSelectionModifier=Bc(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:Mre(e)}isSelectionRangeChangeEvent(e){return Fre(e)}}function lA(n,e){var t;const i=n.get(xi),s=n.get(Oi),r=new Ae;return[Object.assign(Object.assign({},e),{keyboardNavigationDelegate:{mightProducePrintableCharacter(a){return s.mightProducePrintableCharacter(a)}},smoothScrolling:!!i.getValue(kl),mouseWheelScrollSensitivity:i.getValue(Pc),fastScrollSensitivity:i.getValue(Oc),multipleSelectionController:(t=e.multipleSelectionController)!==null&&t!==void 0?t:r.add(new YWe(i)),keyboardNavigationEventFilter:JWe(s),scrollByPage:!!i.getValue(xl)}),r]}let pP=class extends Rl{constructor(e,t,i,s,r,o,a,l,c){const u=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Vo),[h,d]=c.invokeFunction(lA,r);super(e,t,i,s,Object.assign(Object.assign({keyboardSupport:!1},h),{horizontalScrolling:u})),this.disposables.add(d),this.contextKeyService=oA(o,this),this.disposables.add(aA(this.contextKeyService,this)),this.listSupportsMultiSelect=sA.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),rA.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=W7.bindTo(this.contextKeyService),this.listDoubleSelection=V7.bindTo(this.contextKeyService),this.listMultiSelection=$7.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Bc(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const g=this.getSelection(),p=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||p.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const g=this.getSelection(),p=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||p.length>0)})),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(gm)&&(this._useAltAsMultipleSelectionModifier=Bc(l));let p={};if(g.affectsConfiguration(Vo)&&this.horizontalScrolling===void 0){const m=!!l.getValue(Vo);p=Object.assign(Object.assign({},p),{horizontalScrolling:m})}if(g.affectsConfiguration(xl)){const m=!!l.getValue(xl);p=Object.assign(Object.assign({},p),{scrollByPage:m})}if(g.affectsConfiguration(kl)){const m=!!l.getValue(kl);p=Object.assign(Object.assign({},p),{smoothScrolling:m})}if(g.affectsConfiguration(Pc)){const m=l.getValue(Pc);p=Object.assign(Object.assign({},p),{mouseWheelScrollSensitivity:m})}if(g.affectsConfiguration(Oc)){const m=l.getValue(Oc);p=Object.assign(Object.assign({},p),{fastScrollSensitivity:m})}Object.keys(p).length>0&&this.updateOptions(p)})),this.navigator=new coe(this,Object.assign({configurationService:l},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?LS(e):fm)}};pP=fh([ii(5,_t),ii(6,Ko),ii(7,xi),ii(8,Wt)],pP);let mq=class extends tWe{constructor(e,t,i,s,r,o,a,l,c){const u=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!l.getValue(Vo),[h,d]=c.invokeFunction(lA,r);super(e,t,i,s,Object.assign(Object.assign({keyboardSupport:!1},h),{horizontalScrolling:u})),this.disposables=new Ae,this.disposables.add(d),this.contextKeyService=oA(o,this),this.disposables.add(aA(this.contextKeyService,this.widget)),this.horizontalScrolling=r.horizontalScrolling,this.listSupportsMultiSelect=sA.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),rA.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this._useAltAsMultipleSelectionModifier=Bc(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(gm)&&(this._useAltAsMultipleSelectionModifier=Bc(l));let p={};if(g.affectsConfiguration(Vo)&&this.horizontalScrolling===void 0){const m=!!l.getValue(Vo);p=Object.assign(Object.assign({},p),{horizontalScrolling:m})}if(g.affectsConfiguration(xl)){const m=!!l.getValue(xl);p=Object.assign(Object.assign({},p),{scrollByPage:m})}if(g.affectsConfiguration(kl)){const m=!!l.getValue(kl);p=Object.assign(Object.assign({},p),{smoothScrolling:m})}if(g.affectsConfiguration(Pc)){const m=l.getValue(Pc);p=Object.assign(Object.assign({},p),{mouseWheelScrollSensitivity:m})}if(g.affectsConfiguration(Oc)){const m=l.getValue(Oc);p=Object.assign(Object.assign({},p),{fastScrollSensitivity:m})}Object.keys(p).length>0&&this.updateOptions(p)})),this.navigator=new coe(this,Object.assign({configurationService:l},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?LS(e):fm)}dispose(){this.disposables.dispose(),super.dispose()}};mq=fh([ii(5,_t),ii(6,Ko),ii(7,xi),ii(8,Wt)],mq);let _q=class extends nA{constructor(e,t,i,s,r,o,a,l,c,u){const h=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!c.getValue(Vo),[d,f]=u.invokeFunction(lA,o);super(e,t,i,s,r,Object.assign(Object.assign({keyboardSupport:!1},d),{horizontalScrolling:h})),this.disposables.add(f),this.contextKeyService=oA(a,this),this.disposables.add(aA(this.contextKeyService,this)),this.listSupportsMultiSelect=sA.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),rA.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=W7.bindTo(this.contextKeyService),this.listDoubleSelection=V7.bindTo(this.contextKeyService),this.listMultiSelection=$7.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Bc(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const p=this.getSelection(),m=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(p.length>0||m.length>0),this.listMultiSelection.set(p.length>1),this.listDoubleSelection.set(p.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const p=this.getSelection(),m=this.getFocus();this.listHasSelectionOrFocus.set(p.length>0||m.length>0)})),this.disposables.add(c.onDidChangeConfiguration(p=>{p.affectsConfiguration(gm)&&(this._useAltAsMultipleSelectionModifier=Bc(c));let m={};if(p.affectsConfiguration(Vo)&&this.horizontalScrolling===void 0){const b=!!c.getValue(Vo);m=Object.assign(Object.assign({},m),{horizontalScrolling:b})}if(p.affectsConfiguration(xl)){const b=!!c.getValue(xl);m=Object.assign(Object.assign({},m),{scrollByPage:b})}if(p.affectsConfiguration(kl)){const b=!!c.getValue(kl);m=Object.assign(Object.assign({},m),{smoothScrolling:b})}if(p.affectsConfiguration(Pc)){const b=c.getValue(Pc);m=Object.assign(Object.assign({},m),{mouseWheelScrollSensitivity:b})}if(p.affectsConfiguration(Oc)){const b=c.getValue(Oc);m=Object.assign(Object.assign({},m),{fastScrollSensitivity:b})}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new XWe(this,Object.assign({configurationService:c},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?LS(e):fm)}dispose(){this.disposables.dispose(),super.dispose()}};_q=fh([ii(6,_t),ii(7,Ko),ii(8,xi),ii(9,Wt)],_q);class G7 extends ae{constructor(e,t){var i;super(),this.widget=e,this._onDidOpen=this._register(new G),this.onDidOpen=this._onDidOpen.event,this._register(Ee.filter(this.widget.onDidChangeSelection,s=>s.browserEvent instanceof KeyboardEvent)(s=>this.onSelectionFromKeyboard(s))),this._register(this.widget.onPointer(s=>this.onPointer(s.element,s.browserEvent))),this._register(this.widget.onMouseDblClick(s=>this.onMouseDblClick(s.element,s.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(pk))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(s=>{s.affectsConfiguration(pk)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(pk))!=="doubleClick")}))):this.openOnSingleClick=(i=t==null?void 0:t.openOnSingleClick)!==null&&i!==void 0?i:!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,s=typeof t.pinned=="boolean"?t.pinned:!i,r=!1;this._open(this.getSelectedElement(),i,s,r,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const s=t.button===1,r=!0,o=s,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const r=!1,o=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,r,o,a,t)}_open(e,t,i,s,r){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:s,element:e,browserEvent:r})}}class coe extends G7{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class XWe extends G7{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class QWe extends G7{constructor(e,t){super(e,t)}getSelectedElement(){var e;return(e=this.widget.getSelection()[0])!==null&&e!==void 0?e:void 0}}function JWe(n){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=n.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let bq=class extends P7{constructor(e,t,i,s,r,o,a,l,c){const{options:u,getTypeNavigationMode:h,disposable:d}=o.invokeFunction(TS,r);super(e,t,i,s,u),this.disposables.add(d),this.internals=new Ap(this,r,h,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};bq=fh([ii(5,Wt),ii(6,_t),ii(7,Ko),ii(8,xi)],bq);let vq=class extends eoe{constructor(e,t,i,s,r,o,a,l,c){const{options:u,getTypeNavigationMode:h,disposable:d}=o.invokeFunction(TS,r);super(e,t,i,s,u),this.disposables.add(d),this.internals=new Ap(this,r,h,r.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};vq=fh([ii(5,Wt),ii(6,_t),ii(7,Ko),ii(8,xi)],vq);let wq=class extends UWe{constructor(e,t,i,s,r,o,a,l,c,u){const{options:h,getTypeNavigationMode:d,disposable:f}=a.invokeFunction(TS,o);super(e,t,i,s,r,h),this.disposables.add(f),this.internals=new Ap(this,o,d,o.overrideStyles,l,c,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};wq=fh([ii(6,Wt),ii(7,_t),ii(8,Ko),ii(9,xi)],wq);let mP=class extends ioe{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,s,r,o,a,l,c,u){const{options:h,getTypeNavigationMode:d,disposable:f}=a.invokeFunction(TS,o);super(e,t,i,s,r,h),this.disposables.add(f),this.internals=new Ap(this,o,d,o.overrideStyles,l,c,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};mP=fh([ii(6,Wt),ii(7,_t),ii(8,Ko),ii(9,xi)],mP);let yq=class extends zWe{constructor(e,t,i,s,r,o,a,l,c,u,h){const{options:d,getTypeNavigationMode:f,disposable:g}=l.invokeFunction(TS,a);super(e,t,i,s,r,o,d),this.disposables.add(g),this.internals=new Ap(this,a,f,a.overrideStyles,c,u,h),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};yq=fh([ii(7,Wt),ii(8,_t),ii(9,Ko),ii(10,xi)],yq);function uoe(n){const e=n.getValue(U7);if(e==="highlight")return wc.Highlight;if(e==="filter")return wc.Filter;const t=n.getValue(ND);if(t==="simple"||t==="highlight")return wc.Highlight;if(t==="filter")return wc.Filter}function hoe(n){const e=n.getValue(q7);if(e==="fuzzy")return Tp.Fuzzy;if(e==="contiguous")return Tp.Contiguous}function TS(n,e){var t;const i=n.get(xi),s=n.get(Ef),r=n.get(_t),o=n.get(Wt),a=()=>{const f=r.getContextKeyValue(aoe);if(f==="automatic")return uc.Automatic;if(f==="trigger"||r.getContextKeyValue(loe)===!1)return uc.Trigger;const p=i.getValue(j7);if(p==="automatic")return uc.Automatic;if(p==="trigger")return uc.Trigger},l=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!i.getValue(Vo),[c,u]=o.invokeFunction(lA,e),h=e.paddingBottom,d=e.renderIndentGuides!==void 0?e.renderIndentGuides:i.getValue(RD);return{getTypeNavigationMode:a,disposable:u,options:Object.assign(Object.assign({keyboardSupport:!1},c),{indent:typeof i.getValue(Yy)=="number"?i.getValue(Yy):void 0,renderIndentGuides:d,smoothScrolling:!!i.getValue(kl),defaultFindMode:uoe(i),defaultFindMatchType:hoe(i),horizontalScrolling:l,scrollByPage:!!i.getValue(xl),paddingBottom:h,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:(t=e.expandOnlyOnTwistieClick)!==null&&t!==void 0?t:i.getValue(MD)==="doubleClick",contextViewProvider:s,findWidgetStyles:MBe})}}let Ap=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,s,r,o,a){var l;this.tree=e,this.disposables=[],this.contextKeyService=oA(r,e),this.disposables.push(aA(this.contextKeyService,e)),this.listSupportsMultiSelect=sA.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),rA.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=qWe.bindTo(this.contextKeyService),this.listSupportFindWidget.set((l=t.findWidgetEnabled)!==null&&l!==void 0?l:!0),this.hasSelectionOrFocus=W7.bindTo(this.contextKeyService),this.hasDoubleSelection=V7.bindTo(this.contextKeyService),this.hasMultiSelection=$7.bindTo(this.contextKeyService),this.treeElementCanCollapse=z7.bindTo(this.contextKeyService),this.treeElementHasParent=GWe.bindTo(this.contextKeyService),this.treeElementCanExpand=H7.bindTo(this.contextKeyService),this.treeElementHasChild=KWe.bindTo(this.contextKeyService),this.treeFindOpen=ZWe.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Bc(a),this.updateStyleOverrides(s);const u=()=>{const d=e.getFocus()[0];if(!d)return;const f=e.getNode(d);this.treeElementCanCollapse.set(f.collapsible&&!f.collapsed),this.treeElementHasParent.set(!!e.getParentElement(d)),this.treeElementCanExpand.set(f.collapsible&&f.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(d))},h=new Set;h.add(aoe),h.add(loe),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection(()=>{const d=e.getSelection(),f=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(d.length>0||f.length>0),this.hasMultiSelection.set(d.length>1),this.hasDoubleSelection.set(d.length===2)})}),e.onDidChangeFocus(()=>{const d=e.getSelection(),f=e.getFocus();this.hasSelectionOrFocus.set(d.length>0||f.length>0),u()}),e.onDidChangeCollapseState(u),e.onDidChangeModel(u),e.onDidChangeFindOpenState(d=>this.treeFindOpen.set(d)),a.onDidChangeConfiguration(d=>{let f={};if(d.affectsConfiguration(gm)&&(this._useAltAsMultipleSelectionModifier=Bc(a)),d.affectsConfiguration(Yy)){const g=a.getValue(Yy);f=Object.assign(Object.assign({},f),{indent:g})}if(d.affectsConfiguration(RD)&&t.renderIndentGuides===void 0){const g=a.getValue(RD);f=Object.assign(Object.assign({},f),{renderIndentGuides:g})}if(d.affectsConfiguration(kl)){const g=!!a.getValue(kl);f=Object.assign(Object.assign({},f),{smoothScrolling:g})}if(d.affectsConfiguration(U7)||d.affectsConfiguration(ND)){const g=uoe(a);f=Object.assign(Object.assign({},f),{defaultFindMode:g})}if(d.affectsConfiguration(j7)||d.affectsConfiguration(ND)){const g=i();f=Object.assign(Object.assign({},f),{typeNavigationMode:g})}if(d.affectsConfiguration(q7)){const g=hoe(a);f=Object.assign(Object.assign({},f),{defaultFindMatchType:g})}if(d.affectsConfiguration(Vo)&&t.horizontalScrolling===void 0){const g=!!a.getValue(Vo);f=Object.assign(Object.assign({},f),{horizontalScrolling:g})}if(d.affectsConfiguration(xl)){const g=!!a.getValue(xl);f=Object.assign(Object.assign({},f),{scrollByPage:g})}if(d.affectsConfiguration(MD)&&t.expandOnlyOnTwistieClick===void 0&&(f=Object.assign(Object.assign({},f),{expandOnlyOnTwistieClick:a.getValue(MD)==="doubleClick"})),d.affectsConfiguration(Pc)){const g=a.getValue(Pc);f=Object.assign(Object.assign({},f),{mouseWheelScrollSensitivity:g})}if(d.affectsConfiguration(Oc)){const g=a.getValue(Oc);f=Object.assign(Object.assign({},f),{fastScrollSensitivity:g})}Object.keys(f).length>0&&e.updateOptions(f)}),this.contextKeyService.onDidChangeContext(d=>{d.affectsSome(h)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new QWe(e,Object.assign({configurationService:a},t)),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?LS(e):fm)}dispose(){this.disposables=ti(this.disposables)}};Ap=fh([ii(4,_t),ii(5,Ko),ii(6,xi)],Ap);const eVe=Un.as(om.Configuration);eVe.registerConfiguration({id:"workbench",order:7,title:_("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[gm]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[_("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),_("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:_({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[pk]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:_({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Vo]:{type:"boolean",default:!1,description:_("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[xl]:{type:"boolean",default:!1,description:_("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[Yy]:{type:"number",default:8,minimum:4,maximum:40,description:_("tree indent setting","Controls tree indentation in pixels.")},[RD]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:_("render tree indent guides","Controls whether the tree should render indent guides.")},[kl]:{type:"boolean",default:!1,description:_("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Pc]:{type:"number",default:1,markdownDescription:_("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Oc]:{type:"number",default:5,markdownDescription:_("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[U7]:{type:"string",enum:["highlight","filter"],enumDescriptions:[_("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),_("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:_("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[ND]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[_("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),_("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),_("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:_("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:_("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[q7]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[_("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),_("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:_("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[MD]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:_("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[j7]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:_("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var _P;(function(n){n[n.PRESERVE=0]="PRESERVE",n[n.LAST=1]="LAST"})(_P||(_P={}));const doe={Quickaccess:"workbench.contributions.quickaccess"};class tVe{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),ut(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return aT([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}Un.add(doe.Quickaccess,new tVe);const iVe={ctrlCmd:!1,alt:!1};var Xy;(function(n){n[n.Blur=1]="Blur",n[n.Gesture=2]="Gesture",n[n.Other=3]="Other"})(Xy||(Xy={}));var Yl;(function(n){n[n.NONE=0]="NONE",n[n.FIRST=1]="FIRST",n[n.SECOND=2]="SECOND",n[n.LAST=3]="LAST"})(Yl||(Yl={}));const K7=kt("quickInputService");var nVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Cq=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let bP=class extends ae{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=Un.as(doe.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var s;const[r,o]=this.getOrInstantiateProvider(e),a=this.visibleQuickAccess,l=a==null?void 0:a.descriptor;if(a&&o&&l===o){e!==o.prefix&&!(i!=null&&i.preserveValue)&&(a.picker.value=e),this.adjustValueSelection(a.picker,o,i);return}if(o&&!(i!=null&&i.preserveValue)){let f;if(a&&l&&l!==o){const g=a.value.substr(l.prefix.length);g&&(f=`${o.prefix}${g}`)}if(!f){const g=r==null?void 0:r.defaultFilterValue;g===_P.LAST?f=this.lastAcceptedPickerValues.get(o):typeof g=="string"&&(f=`${o.prefix}${g}`)}typeof f=="string"&&(e=f)}const c=new Ae,u=c.add(this.quickInputService.createQuickPick());u.value=e,this.adjustValueSelection(u,o,i),u.placeholder=o==null?void 0:o.placeholder,u.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,u.hideInput=!!u.quickNavigate&&!a,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(u.itemActivation=(s=i==null?void 0:i.itemActivation)!==null&&s!==void 0?s:Yl.SECOND),u.contextKey=o==null?void 0:o.contextKey,u.filterValue=f=>f.substring(o?o.prefix.length:0);let h;t&&(h=new mne,c.add(Ee.once(u.onWillAccept)(f=>{f.veto(),u.hide()}))),c.add(this.registerPickerListeners(u,r,o,e,i==null?void 0:i.providerOptions));const d=c.add(new Wa);if(r&&c.add(r.provide(u,d.token,i==null?void 0:i.providerOptions)),Ee.once(u.onDidHide)(()=>{u.selectedItems.length===0&&d.cancel(),c.dispose(),h==null||h.complete(u.selectedItems.slice(0))}),u.show(),t)return h==null?void 0:h.p}adjustValueSelection(e,t,i){var s;let r;i!=null&&i.preserveValue?r=[e.value.length,e.value.length]:r=[(s=t==null?void 0:t.prefix.length)!==null&&s!==void 0?s:0,e.value.length],e.valueSelection=r}registerPickerListeners(e,t,i,s,r){const o=new Ae,a=this.visibleQuickAccess={picker:e,descriptor:i,value:s};return o.add(ut(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),o.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l);c!==t?this.show(l,{preserveValue:!0,providerOptions:r}):a.value=l})),i&&o.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),o}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let i=this.mapProviderToDescriptor.get(t);return i||(i=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,i)),[i,t]}};bP=nVe([Cq(0,K7),Cq(1,Wt)],bP);J.white.toString(),J.white.toString();class Sq extends ae{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new G),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,s=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=s||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),e.appendChild(this._element),this._register(Zt.addTarget(this._element)),[Le.CLICK,Jt.Tap].forEach(r=>{this._register(oe(this._element,r,o=>{if(!this.enabled){rt.stop(o);return}this._onDidClick.fire(o)}))}),this._register(oe(this._element,Le.KEY_DOWN,r=>{const o=new ri(r);let a=!1;this.enabled&&(o.equals(3)||o.equals(10))?(this._onDidClick.fire(r),a=!0):o.equals(9)&&(this._element.blur(),a=!0),a&&rt.stop(o,!0)})),this._register(oe(this._element,Le.MOUSE_OVER,r=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(oe(this._element,Le.MOUSE_OUT,r=>{this.updateBackground(!1)})),this.focusTracker=this._register(ef(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of Qg(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const s=document.createElement("span");s.textContent=i,t.push(s)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var t;if(this._label===e||Rd(this._label)&&Rd(e)&&S9e(this._label,e))return;this._element.classList.add("monaco-text-button");const i=this.options.supportShortLabel?this._labelElement:this._element;if(Rd(e)){const s=QT(e,{inline:!0});s.dispose();const r=(t=s.element.querySelector("p"))===null||t===void 0?void 0:t.innerHTML;if(r){const o=Yie(r,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});i.innerHTML=o}else qs(i)}else this.options.supportIcons?qs(i,...this.getContentElements(e)):i.textContent=e;typeof this.options.title=="string"?this._element.title=this.options.title:this.options.title&&(this._element.title=B9e(e)),this._label=e}get label(){return this._label}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}class vP{constructor(e,t,i){this.options=t,this.styles=i,this.count=0,this.element=Se(e,Be(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){var e,t;this.element.textContent=ly(this.countFormat,this.count),this.element.title=ly(this.titleFormat,this.count),this.element.style.backgroundColor=(e=this.styles.badgeBackground)!==null&&e!==void 0?e:"",this.element.style.color=(t=this.styles.badgeForeground)!==null&&t!==void 0?t:"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const xq="done",kq="active",BR="infinite",WR="infinite-long-running",Lq="discrete";class cA extends ae{constructor(e,t){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Ui(()=>Ug(this.element),0)),this.longRunningScheduler=this._register(new Ui(()=>this.infiniteLongRunning(),cA.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(kq,BR,WR,Lq),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(xq),this.element.classList.contains(BR)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Lq,xq,WR),this.element.classList.add(kq,BR),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(WR)}getContainer(){return this.element}}cA.LONG_RUNNING_INFINITE_THRESHOLD=1e4;const sVe=Be;class rVe extends ae{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=r=>oe(this.findInput.inputBox.inputElement,Le.KEY_DOWN,o=>{r(new ri(o))}),this.onMouseDown=r=>oe(this.findInput.inputBox.inputElement,Le.MOUSE_DOWN,o=>{r(new ba(o))}),this.onDidChange=r=>this.findInput.onDidChange(r),this.container=Se(this.parent,sVe(".quick-input-box")),this.findInput=this._register(new Yre(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const s=this.findInput.inputBox.inputElement;s.role="combobox",s.ariaHasPopup="menu",s.ariaAutoComplete="list",s.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===Fi.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===Fi.Info?1:e===Fi.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===Fi.Info?1:e===Fi.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Fd{constructor(e,t){var i;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=(i=t==null?void 0:t.supportIcons)!==null&&i!==void 0?i:!1,this.domNode=Se(e,Be("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",s){e||(e=""),s&&(e=Fd.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&mo(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const o=this.text.substring(t,i.start);this.supportIcons?e.push(...Qg(o)):e.push(o),t=i.start}const s=this.text.substring(t,i.end),r=Be("span.highlight",void 0,...this.supportIcons?Qg(s):[s]);i.extraClasses&&r.classList.add(...i.extraClasses),e.push(r),t=i.end}if(t<this.text.length){const i=this.text.substring(t);this.supportIcons?e.push(...Qg(i)):e.push(i)}qs(this.domNode,...e),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(e,t){let i=0,s=0;return e.replace(/\r\n|\r|\n/g,(r,o)=>{s=r===`\r
`?-1:0,o+=i;for(const a of t)a.end<=o||(a.start>=o&&(a.start+=s),a.end>=o&&(a.end+=s));return i+=s,"⏎"})}}class VR{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class wP extends ae{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new VR(Se(e,Be(".monaco-icon-label")))),this.labelContainer=Se(this.domNode.element,Be(".monaco-icon-label-container"));const i=Se(this.labelContainer,Be("span.monaco-icon-name-container"));t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=new lVe(i,!!t.supportIcons):this.nameNode=new oVe(i),this.hoverDelegate=t==null?void 0:t.hoverDelegate}get element(){return this.domNode.element}setLabel(e,t,i){const s=["monaco-icon-label"],r=["monaco-icon-label-container"];let o="";if(i&&(i.extraClasses&&s.push(...i.extraClasses),i.italic&&s.push("italic"),i.strikethrough&&s.push("strikethrough"),i.disabledCommand&&r.push("disabled"),i.title&&(o+=i.title)),this.domNode.className=s.join(" "),this.domNode.element.setAttribute("aria-label",o),this.labelContainer.className=r.join(" "),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const a=this.getOrCreateDescriptionNode();a instanceof Fd?(a.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines),this.setupHover(a.element,i==null?void 0:i.descriptionTitle)):(a.textContent=t&&(i!=null&&i.labelEscapeNewLines)?Fd.escapeNewLines(t,[]):t||"",this.setupHover(a.element,(i==null?void 0:i.descriptionTitle)||""),a.empty=!t)}}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(!this.hoverDelegate)L9e(e,t);else{const s=Are(this.hoverDelegate,e,t);s&&this.customHovers.set(e,s)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new VR(Se(this.labelContainer,Be("span.monaco-icon-description-container"))));!((e=this.creationOptions)===null||e===void 0)&&e.supportDescriptionHighlights?this.descriptionNode=new Fd(Se(t.element,Be("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons}):this.descriptionNode=this._register(new VR(Se(t.element,Be("span.label-description"))))}return this.descriptionNode}}class oVe{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&mo(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Se(this.container,Be("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const s=e[i],r=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;Se(this.container,Be("a.label-name",{id:r,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},s)),i<e.length-1&&Se(this.container,Be("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function aVe(n,e,t){if(!t)return;let i=0;return n.map(s=>{const r={start:i,end:i+s.length},o=t.map(a=>ss.intersect(r,a)).filter(a=>!ss.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=r.end+e.length,o})}class lVe{constructor(e,t){this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&mo(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new Fd(Se(this.container,Be("a.label-name",{id:t==null?void 0:t.domId})),{supportIcons:this.supportIcons})),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=(t==null?void 0:t.separator)||"/",s=aVe(e,i,t==null?void 0:t.matches);for(let r=0;r<e.length;r++){const o=e[r],a=s?s[r]:void 0,l=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${r}`,c=Be("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":r,role:"treeitem"});new Fd(Se(this.container,c),{supportIcons:this.supportIcons}).set(o,a,void 0,t==null?void 0:t.labelEscapeNewLines),r<e.length-1&&Se(c,Be("span.label-separator",void 0,i))}}}}const e2=Be,cVe={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class AS{constructor(e,t,i){this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const s=this.options.keybindingLabelForeground;this.domNode=Se(e,e2(".monaco-keybinding")),s&&(this.domNode.style.color=s),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&AS.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){var e;if(this.clear(),this.keybinding){const t=this.keybinding.getChords();t[0]&&this.renderChord(this.domNode,t[0],this.matches?this.matches.firstPart:null);for(let s=1;s<t.length;s++)Se(this.domNode,e2("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,t[s],this.matches?this.matches.chordPart:null);const i=(e=this.options.disableTitle)!==null&&e!==void 0&&e?void 0:this.keybinding.getAriaLabel()||void 0;i!==void 0?this.domNode.title=i:this.domNode.removeAttribute("title")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){vo(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const s=b7.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,s.ctrlKey,!!(i!=null&&i.ctrlKey),s.separator),t.shiftKey&&this.renderKey(e,s.shiftKey,!!(i!=null&&i.shiftKey),s.separator),t.altKey&&this.renderKey(e,s.altKey,!!(i!=null&&i.altKey),s.separator),t.metaKey&&this.renderKey(e,s.metaKey,!!(i!=null&&i.metaKey),s.separator);const r=t.keyLabel;r&&this.renderKey(e,r,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,s){Se(e,this.createKeyElement(t,i?".highlight":"")),s&&Se(e,e2("span.monaco-keybinding-key-separator",void 0,s))}renderUnbound(e){Se(e,this.createKeyElement(_("unbound","Unbound")))}createKeyElement(e,t=""){const i=e2("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&mo(e.firstPart,t.firstPart)&&mo(e.chordPart,t.chordPart)}}const Dq=new Jp(()=>{const n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}});function uVe(n,e,t=!1){const i=n||"",s=e||"",r=Dq.value.collator.compare(i,s);return Dq.value.collatorIsNumeric&&r===0&&i!==s?i<s?-1:1:r}function hVe(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),r=dVe(n,e,t);if(r)return r;const o=i.endsWith(t),a=s.endsWith(t);if(o!==a)return o?-1:1;const l=uVe(i,s);return l!==0?l:i.localeCompare(s)}function dVe(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),r=i.startsWith(t),o=s.startsWith(t);if(r!==o)return r?-1:1;if(r&&o){if(i.length<s.length)return-1;if(i.length>s.length)return 1}return 0}var fVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r};class foe{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}fVe([ji],foe.prototype,"toString",null);const gVe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function pVe(n){const e=[];let t=0,i;for(;i=gVe.exec(n);){i.index-t>0&&e.push(n.substring(t,i.index));const[,s,r,,o]=i;o?e.push({label:s,href:r,title:o}):e.push({label:s,href:r}),t=i.index+i[0].length}return t<n.length&&e.push(n.substring(t)),new foe(e)}const $R={},mVe=new L7("quick-input-button-icon-");function yP(n){if(!n)return;let e;const t=n.dark.toString();return $R[t]?e=$R[t]:(e=mVe.nextId(),U3(`.${e}, .hc-light .${e}`,`background-image: ${tf(n.light||n.dark)}`),U3(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${tf(n.dark)}`),$R[t]=e),e}function _Ve(n,e,t){qs(e);const i=pVe(n);let s=0;for(const r of i.nodes)if(typeof r=="string")e.append(...Qg(r));else{let o=r.title;!o&&r.href.startsWith("command:")?o=_("executeCommand","Click to execute command '{0}'",r.href.substring(8)):o||(o=r.href);const a=Be("a",{href:r.href,title:o,tabIndex:s++},r.label);a.style.textDecoration="underline";const l=f=>{kNe(f)&&rt.stop(f,!0),t.callback(r.href)},c=t.disposables.add(new xt(a,Le.CLICK)).event,u=t.disposables.add(new xt(a,Le.KEY_DOWN)).event,h=Ee.chain(u,f=>f.filter(g=>{const p=new ri(g);return p.equals(10)||p.equals(3)}));t.disposables.add(Zt.addTarget(a));const d=t.disposables.add(new xt(a,Jt.Tap)).event;Ee.any(c,d,h)(l,null,t.disposables),e.appendChild(a)}}var goe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Eq=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Ja=Be;class bVe{constructor(e,t,i,s,r,o,a){var l,c,u;this._checked=!1,this._hidden=!1,this.hasCheckbox=s,this.index=i,this.fireButtonTriggered=r,this.fireSeparatorButtonTriggered=o,this._onChecked=a,this.onChecked=s?Ee.map(Ee.filter(this._onChecked.event,h=>h.listElement===this),h=>h.checked):Ee.None,e.type==="separator"?this._separator=e:(this.item=e,t&&t.type==="separator"&&!t.buttons&&(this._separator=t),this.saneDescription=this.item.description,this.saneDetail=this.item.detail,this._labelHighlights=(l=this.item.highlights)===null||l===void 0?void 0:l.label,this._descriptionHighlights=(c=this.item.highlights)===null||c===void 0?void 0:c.description,this._detailHighlights=(u=this.item.highlights)===null||u===void 0?void 0:u.detail,this.saneTooltip=this.item.tooltip),this._init=new Jp(()=>{var h;const d=(h=e.label)!==null&&h!==void 0?h:"",f=mv(d).text.trim(),g=e.ariaLabel||[d,this.saneDescription,this.saneDetail].map(p=>C9e(p)).filter(p=>!!p).join(", ");return{saneLabel:d,saneSortLabel:f,saneAriaLabel:g}})}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({listElement:this,checked:e}))}get separator(){return this._separator}set separator(e){this._separator=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class IS{constructor(e){this.themeService=e}get templateId(){return IS.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=Se(e,Ja(".quick-input-list-entry"));const i=Se(t.entry,Ja("label.quick-input-list-label"));t.toDisposeTemplate.push(pn(i,Le.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=Se(i,Ja("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(pn(t.checkbox,Le.CHANGE,c=>{t.element.checked=t.checkbox.checked}));const s=Se(i,Ja(".quick-input-list-rows")),r=Se(s,Ja(".quick-input-list-row")),o=Se(s,Ja(".quick-input-list-row"));t.label=new wP(r,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0}),t.toDisposeTemplate.push(t.label),t.icon=one(t.label.element,Ja(".quick-input-list-icon"));const a=Se(r,Ja(".quick-input-list-entry-keybinding"));t.keybinding=new AS(a,co);const l=Se(o,Ja(".quick-input-list-label-meta"));return t.detail=new wP(l,{supportHighlights:!0,supportIcons:!0}),t.toDisposeTemplate.push(t.detail),t.separator=Se(t.entry,Ja(".quick-input-list-separator")),t.actionBar=new Fc(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,i){var s,r,o,a;i.element=e,e.element=(s=i.entry)!==null&&s!==void 0?s:void 0;const l=e.item?e.item:e.separator;i.checkbox.checked=e.checked,i.toDisposeElement.push(e.onChecked(g=>i.checkbox.checked=g));const{labelHighlights:c,descriptionHighlights:u,detailHighlights:h}=e;if(!((r=e.item)===null||r===void 0)&&r.iconPath){const g=$T(this.themeService.getColorTheme().type)?e.item.iconPath.dark:(o=e.item.iconPath.light)!==null&&o!==void 0?o:e.item.iconPath.dark,p=ot.revive(g);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=tf(p)}else i.icon.style.backgroundImage="",i.icon.className=!((a=e.item)===null||a===void 0)&&a.iconClass?`quick-input-list-icon ${e.item.iconClass}`:"";const d={matches:c||[],descriptionTitle:e.saneDescription,descriptionMatches:u||[],labelEscapeNewLines:!0};l.type!=="separator"?(d.extraClasses=l.iconClasses,d.italic=l.italic,d.strikethrough=l.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item")):i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(e.saneLabel,e.saneDescription,d),i.keybinding.set(l.type==="separator"?void 0:l.keybinding),e.saneDetail?(i.detail.element.style.display="",i.detail.setLabel(e.saneDetail,void 0,{matches:h,title:e.saneDetail,labelEscapeNewLines:!0})):i.detail.element.style.display="none",e.item&&e.separator&&e.separator.label?(i.separator.textContent=e.separator.label,i.separator.style.display=""):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!e.separator);const f=l.buttons;f&&f.length?(i.actionBar.push(f.map((g,p)=>{let m=g.iconClass||(g.iconPath?yP(g.iconPath):void 0);return g.alwaysVisible&&(m=m?`${m} always-visible`:"always-visible"),{id:`id-${p}`,class:m,enabled:!0,label:"",tooltip:g.tooltip||"",run:()=>{l.type!=="separator"?e.fireButtonTriggered({button:g,item:l}):e.fireSeparatorButtonTriggered({button:g,separator:l})}}}),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){i.toDisposeElement=ti(i.toDisposeElement),i.actionBar.clear()}disposeTemplate(e){e.toDisposeElement=ti(e.toDisposeElement),e.toDisposeTemplate=ti(e.toDisposeTemplate)}}IS.ID="listelement";class vVe{getHeight(e){return e.item?e.saneDetail?44:22:24}getTemplateId(e){return IS.ID}}var Ln;(function(n){n[n.First=1]="First",n[n.Second=2]="Second",n[n.Last=3]="Last",n[n.Next=4]="Next",n[n.Previous=5]="Previous",n[n.NextPage=6]="NextPage",n[n.PreviousPage=7]="PreviousPage"})(Ln||(Ln={}));class Z7{constructor(e,t,i,s){this.parent=e,this.options=i,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnLabelMode="fuzzy",this.sortByLabel=!0,this._onChangedAllVisibleChecked=new G,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new G,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new G,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new G,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new G,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new G,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._onKeyDown=new G,this.onKeyDown=this._onKeyDown.event,this._onLeave=new G,this.onLeave=this._onLeave.event,this._listElementChecked=new G,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=Se(this.parent,Ja(".quick-input-list"));const r=new vVe,o=new CVe;if(this.list=i.createList("QuickInput",this.container,r,[new IS(s)],{identityProvider:{getId:a=>{var l,c,u,h,d,f,g,p;return(p=(f=(h=(c=(l=a.item)===null||l===void 0?void 0:l.id)!==null&&c!==void 0?c:(u=a.item)===null||u===void 0?void 0:u.label)!==null&&h!==void 0?h:(d=a.separator)===null||d===void 0?void 0:d.id)!==null&&f!==void 0?f:(g=a.separator)===null||g===void 0?void 0:g.label)!==null&&p!==void 0?p:""}},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:o}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown(a=>{const l=new ri(a);switch(l.keyCode){case 10:this.toggleCheckbox();break;case 31:(Mt?a.metaKey:a.ctrlKey)&&this.list.setFocus(Ps(this.list.length));break;case 16:{const c=this.list.getFocus();c.length===1&&c[0]===0&&this._onLeave.fire();break}case 18:{const c=this.list.getFocus();c.length===1&&c[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(l)})),this.disposables.push(this.list.onMouseDown(a=>{a.browserEvent.button!==2&&a.browserEvent.preventDefault()})),this.disposables.push(oe(this.container,Le.CLICK,a=>{(a.x||a.y)&&this._onLeave.fire()})),this.disposables.push(this.list.onMouseMiddleClick(a=>{this._onLeave.fire()})),this.disposables.push(this.list.onContextMenu(a=>{typeof a.index=="number"&&(a.browserEvent.preventDefault(),this.list.setSelection([a.index]))})),i.hoverDelegate){const a=new pne(i.hoverDelegate.delay);this.disposables.push(this.list.onMouseOver(l=>Eq(this,void 0,void 0,function*(){var c;if(l.browserEvent.target instanceof HTMLAnchorElement){a.cancel();return}if(!(!(l.browserEvent.relatedTarget instanceof HTMLAnchorElement)&&Qn(l.browserEvent.relatedTarget,(c=l.element)===null||c===void 0?void 0:c.element)))try{yield a.trigger(()=>Eq(this,void 0,void 0,function*(){l.element&&this.showHover(l.element)}))}catch(u){if(!Qp(u))throw u}}))),this.disposables.push(this.list.onMouseOut(l=>{var c;Qn(l.browserEvent.relatedTarget,(c=l.element)===null||c===void 0?void 0:c.element)||a.cancel()})),this.disposables.push(a)}this.disposables.push(this._listElementChecked.event(a=>this.fireCheckedEvents())),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onSeparatorButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return Ee.map(this.list.onDidChangeFocus,e=>e.elements.map(t=>t.item))}get onDidChangeSelection(){return Ee.map(this.list.onDidChangeSelection,e=>({items:e.elements.map(t=>t.item),event:e.browserEvent}))}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get ariaLabel(){return this.list.getHTMLElement().ariaLabel}set ariaLabel(e){this.list.getHTMLElement().ariaLabel=e}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let i=0,s=e.length;i<s;i++){const r=e[i];if(!r.hidden)if(r.checked)t=!0;else return!1}return t}getCheckedCount(){let e=0;const t=this.elements;for(let i=0,s=t.length;i<s;i++)t[i].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let i=0,s=t.length;i<s;i++)t[i].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach(t=>{t.hidden||(t.checked=e)})}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=ti(this.elementDisposables);const t=o=>this.fireButtonTriggered(o),i=o=>this.fireSeparatorButtonTriggered(o);this.inputElements=e;const s=new Map,r=this.parent.classList.contains("show-checkboxes");this.elements=e.reduce((o,a,l)=>{var c;const u=l>0?e[l-1]:void 0;if(a.type==="separator"&&!a.buttons)return o;const h=new bVe(a,u,l,r,t,i,this._listElementChecked),d=o.length;return o.push(h),s.set((c=h.item)!==null&&c!==void 0?c:h.separator,d),o},[]),this.elementsToIndexes=s,this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map(e=>e.item)}setFocusedElements(e){if(this.list.setFocus(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t))),e.length>0){const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t)))}getCheckedElements(){return this.elements.filter(e=>e.checked).map(e=>e.item).filter(e=>!!e)}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const i of e)t.add(i);for(const i of this.elements)i.checked=t.has(i.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===Ln.Second&&this.list.length<2&&(e=Ln.First),e){case Ln.First:this.list.scrollTop=0,this.list.focusFirst(void 0,i=>!!i.item);break;case Ln.Second:this.list.scrollTop=0,this.list.focusNth(1,void 0,i=>!!i.item);break;case Ln.Last:this.list.scrollTop=this.list.scrollHeight,this.list.focusLast(void 0,i=>!!i.item);break;case Ln.Next:{this.list.focusNext(void 0,!0,void 0,s=>!!s.item);const i=this.list.getFocus()[0];i!==0&&!this.elements[i-1].item&&this.list.firstVisibleIndex>i-1&&this.list.reveal(i-1);break}case Ln.Previous:{this.list.focusPrevious(void 0,!0,void 0,s=>!!s.item);const i=this.list.getFocus()[0];i!==0&&!this.elements[i-1].item&&this.list.firstVisibleIndex>i-1&&this.list.reveal(i-1);break}case Ln.NextPage:this.list.focusNextPage(void 0,i=>!!i.item);break;case Ln.PreviousPage:this.list.focusPreviousPage(void 0,i=>!!i.item);break}const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}showHover(e){var t,i,s;this.options.hoverDelegate!==void 0&&(this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.options.hoverDelegate).onDidHideHover)===null||i===void 0||i.call(t),(s=this._lastHover)===null||s===void 0||s.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.options.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:r=>{this.options.linkOpenerDelegate(r)},showPointer:!0,container:this.container,hoverPosition:1},!1)))}layout(e){this.list.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this.elements.forEach(s=>{s.labelHighlights=void 0,s.descriptionHighlights=void 0,s.detailHighlights=void 0,s.hidden=!1;const r=s.index&&this.inputElements[s.index-1];s.item&&(s.separator=r&&r.type==="separator"&&!r.buttons?r:void 0)});else{let s;this.elements.forEach(r=>{var o,a,l,c;let u;this.matchOnLabelMode==="fuzzy"?u=this.matchOnLabel&&(o=LR(e,mv(r.saneLabel)))!==null&&o!==void 0?o:void 0:u=this.matchOnLabel&&(a=wVe(t,mv(r.saneLabel)))!==null&&a!==void 0?a:void 0;const h=this.matchOnDescription&&(l=LR(e,mv(r.saneDescription||"")))!==null&&l!==void 0?l:void 0,d=this.matchOnDetail&&(c=LR(e,mv(r.saneDetail||"")))!==null&&c!==void 0?c:void 0;if(u||h||d?(r.labelHighlights=u,r.descriptionHighlights=h,r.detailHighlights=d,r.hidden=!1):(r.labelHighlights=void 0,r.descriptionHighlights=void 0,r.detailHighlights=void 0,r.hidden=r.item?!r.item.alwaysShow:!0),r.item?r.separator=void 0:r.separator&&(r.hidden=!0),!this.sortByLabel){const f=r.index&&this.inputElements[r.index-1];s=f&&f.type==="separator"?f:s,s&&!r.hidden&&(r.separator=s,s=void 0)}})}const i=this.elements.filter(s=>!s.hidden);if(this.sortByLabel&&e){const s=e.toLowerCase();i.sort((r,o)=>yVe(r,o,s))}return this.elementsToIndexes=i.reduce((s,r,o)=>{var a;return s.set((a=r.item)!==null&&a!==void 0?a:r.separator,o),s},new Map),this.list.splice(0,this.list.length,i),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(i.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const i of e)i.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return this.container.style.display!=="none"}dispose(){this.elementDisposables=ti(this.elementDisposables),this.disposables=ti(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}fireSeparatorButtonTriggered(e){this._onSeparatorButtonTriggered.fire(e)}style(e){this.list.style(e)}toggleHover(){const e=this.list.getFocusedElements()[0];if(!(e!=null&&e.saneTooltip))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}const t=this.list.getFocusedElements()[0];if(!t)return;this.showHover(t);const i=new Ae;i.add(this.list.onDidChangeFocus(s=>{s.indexes.length&&this.showHover(s.elements[0])})),this._lastHover&&i.add(this._lastHover),this._toggleHover=i,this.elementDisposables.push(this._toggleHover)}}goe([ji],Z7.prototype,"onDidChangeFocus",null);goe([ji],Z7.prototype,"onDidChangeSelection",null);function wVe(n,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return Tq(n,t);const s=dT(t," "),r=t.length-s.length,o=Tq(n,s);if(o)for(const a of o){const l=i[a.start+r]+r;a.start+=l,a.end+=l}return o}function Tq(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t!==-1?[{start:t,end:t+n.length}]:null}function yVe(n,e,t){const i=n.labelHighlights||[],s=e.labelHighlights||[];return i.length&&!s.length?-1:!i.length&&s.length?1:i.length===0&&s.length===0?0:hVe(n.saneSortLabel,e.saneSortLabel,t)}class CVe{getWidgetAriaLabel(){return _("quickInput","Quick Input")}getAriaLabel(e){var t;return!((t=e.separator)===null||t===void 0)&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(e.hasCheckbox)return{value:e.checked,onDidChange:e.onChecked}}}var Aq=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const CP={iconClass:Ye.asClassName(we.quickInputBack),tooltip:_("quickInput.back","Back"),handle:-1};class NS extends ae{constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=NS.noPromptMessage,this._severity=Fi.Ignore,this.onDidTriggerButtonEmitter=this._register(new G),this.onDidHideEmitter=this._register(new G),this.onDisposeEmitter=this._register(new G),this.visibleDisposables=this._register(new Ae),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Qd;this._ignoreFocusOut=e&&!Qd,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=Xy.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){var e,t;if(!this.visible)return;const i=this.getTitle();i&&this.ui.title.textContent!==i?this.ui.title.textContent=i:!i&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const s=this.getDescription();if(this.ui.description1.textContent!==s&&(this.ui.description1.textContent=s),this.ui.description2.textContent!==s&&(this.ui.description2.textContent=s),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?qs(this.ui.widget,this._widget):qs(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new uh,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const o=this.buttons.filter(l=>l===CP);this.ui.leftActionBar.push(o.map((l,c)=>{const u=new _o(`id-${c}`,"",l.iconClass||yP(l.iconPath),!0,()=>Aq(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(l)}));return u.tooltip=l.tooltip||"",u}),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const a=this.buttons.filter(l=>l!==CP);this.ui.rightActionBar.push(a.map((l,c)=>{const u=new _o(`id-${c}`,"",l.iconClass||yP(l.iconPath),!0,()=>Aq(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(l)}));return u.tooltip=l.tooltip||"",u}),{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const o=(t=(e=this.toggles)===null||e===void 0?void 0:e.filter(a=>a instanceof Jb))!==null&&t!==void 0?t:[];this.ui.inputBox.toggles=o}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const r=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==r&&(this._lastValidationMessage=r,qs(this.ui.message),_Ve(r,this.ui.message,{callback:o=>{this.ui.linkOpenerDelegate(o)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?_("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Fi.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}NS.noPromptMessage=_("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class Qy extends NS{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new G),this.onWillAcceptEmitter=this._register(new G),this.onDidAcceptEmitter=this._register(new G),this.onDidCustomEmitter=this._register(new G),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=Yl.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new G),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new G),this.onDidTriggerItemButtonEmitter=this._register(new G),this.onDidTriggerSeparatorButtonEmitter=this._register(new G),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?iVe:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(Ln.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.inputBox.onMouseDown(e=>{this.autoFocusOnList||this.ui.list.clearFocus()})),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown(e=>{switch(e.keyCode){case 18:this.ui.list.focus(Ln.Next),this.canSelectMany&&this.ui.list.domFocus(),rt.stop(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(Ln.Previous):this.ui.list.focus(Ln.Last),this.canSelectMany&&this.ui.list.domFocus(),rt.stop(e,!0);break;case 12:this.ui.list.focus(Ln.NextPage),this.canSelectMany&&this.ui.list.domFocus(),rt.stop(e,!0);break;case 11:this.ui.list.focus(Ln.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),rt.stop(e,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Ln.First),rt.stop(e,!0));break;case 13:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Ln.Last),rt.stop(e,!0));break}})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this.ui.list.onDidChangeFocus(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&yn(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&yn(e,this._selectedItems,(i,s)=>i===s)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&yn(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return oe(this.ui.container,Le.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new ri(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const a=o.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.buttons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let s=this.ariaLabel;if(!s&&i.inputBox&&(s=this.placeholder||Qy.DEFAULT_ARIA_LABEL,this.title&&(s+=` - ${this.title}`)),this.ui.list.ariaLabel!==s&&(this.ui.list.ariaLabel=s??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case Yl.NONE:this._itemActivation=Yl.FIRST;break;case Yl.SECOND:this.ui.list.focus(Ln.Second),this._itemActivation=Yl.FIRST;break;case Yl.LAST:this.ui.list.focus(Ln.Last),this._itemActivation=Yl.FIRST;break;default:this.trySelectFirst();break}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Ln.First)),this.keepScrollPosition&&(this.scrollTop=e)}}Qy.DEFAULT_ARIA_LABEL=_("quickInputBox.ariaLabel","Type to narrow down results.");class SVe extends NS{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new G),this.onDidAcceptEmitter=this._register(new G),this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}const kr=Be;class uA extends ae{constructor(e,t){super(),this.options=e,this.themeService=t,this.enabled=!0,this.onDidAcceptEmitter=this._register(new G),this.onDidCustomEmitter=this._register(new G),this.onDidTriggerButtonEmitter=this._register(new G),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new G),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new G),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=t=>{this.keyMods.ctrlCmd=t.ctrlKey||t.metaKey,this.keyMods.alt=t.altKey};this._register(oe(window,Le.KEY_DOWN,e,!0)),this._register(oe(window,Le.KEY_UP,e,!0)),this._register(oe(window,Le.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=Se(this.parentElement,kr(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=Fa(e),i=Se(e,kr(".quick-input-titlebar")),s=this.options.hoverDelegate?{hoverDelegate:this.options.hoverDelegate}:void 0,r=this._register(new Fc(i,s));r.domNode.classList.add("quick-input-left-action-bar");const o=Se(i,kr(".quick-input-title")),a=this._register(new Fc(i,s));a.domNode.classList.add("quick-input-right-action-bar");const l=Se(e,kr(".quick-input-header")),c=Se(l,kr("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",_("quickInput.checkAll","Toggle all checkboxes")),this._register(pn(c,Le.CHANGE,$=>{const q=c.checked;N.setAllVisibleChecked(q)})),this._register(oe(c,Le.CLICK,$=>{($.x||$.y)&&f.setFocus()}));const u=Se(l,kr(".quick-input-description")),h=Se(l,kr(".quick-input-and-message")),d=Se(h,kr(".quick-input-filter")),f=this._register(new rVe(d,this.styles.inputBox,this.styles.toggle));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=Se(d,kr(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new vP(g,{countFormat:_({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),m=Se(d,kr(".quick-input-count"));m.setAttribute("aria-live","polite");const b=new vP(m,{countFormat:_({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),v=Se(l,kr(".quick-input-action")),w=this._register(new Sq(v,this.styles.button));w.label=_("ok","OK"),this._register(w.onDidClick($=>{this.onDidAcceptEmitter.fire()}));const y=Se(l,kr(".quick-input-action")),x=this._register(new Sq(y,this.styles.button));x.label=_("custom","Custom"),this._register(x.onDidClick($=>{this.onDidCustomEmitter.fire()}));const D=Se(h,kr(`#${this.idPrefix}message.quick-input-message`)),S=this._register(new cA(e,this.styles.progressBar));S.getContainer().classList.add("quick-input-progress");const T=Se(e,kr(".quick-input-html-widget"));T.tabIndex=-1;const k=Se(e,kr(".quick-input-description")),I=this.idPrefix+"list",N=this._register(new Z7(e,I,this.options,this.themeService));f.setAttribute("aria-controls",I),this._register(N.onDidChangeFocus(()=>{var $;f.setAttribute("aria-activedescendant",($=N.getActiveDescendant())!==null&&$!==void 0?$:"")})),this._register(N.onChangedAllVisibleChecked($=>{c.checked=$})),this._register(N.onChangedVisibleCount($=>{p.setCount($)})),this._register(N.onChangedCheckedCount($=>{b.setCount($)})),this._register(N.onLeave(()=>{setTimeout(()=>{f.setFocus(),this.controller instanceof Qy&&this.controller.canSelectMany&&N.clearFocus()},0)}));const z=ef(e);return this._register(z),this._register(oe(e,Le.FOCUS,$=>{Qn($.relatedTarget,e)||(this.previousFocusElement=$.relatedTarget instanceof HTMLElement?$.relatedTarget:void 0)},!0)),this._register(z.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(Xy.Blur),this.previousFocusElement=void 0})),this._register(oe(e,Le.FOCUS,$=>{f.setFocus()})),this._register(pn(e,Le.KEY_DOWN,$=>{if(!Qn($.target,T))switch($.keyCode){case 3:rt.stop($,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:rt.stop($,!0),this.hide(Xy.Gesture);break;case 2:if(!$.altKey&&!$.ctrlKey&&!$.metaKey){const q=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(e.classList.contains("show-checkboxes")?q.push("input"):q.push("input[type=text]"),this.getUI().list.isDisplayed()&&q.push(".monaco-list"),this.getUI().message&&q.push(".quick-input-message a"),this.getUI().widget){if(Qn($.target,this.getUI().widget))break;q.push(".quick-input-html-widget")}const ne=e.querySelectorAll(q.join(", "));$.shiftKey&&$.target===ne[0]?(rt.stop($,!0),N.clearFocus()):!$.shiftKey&&Qn($.target,ne[ne.length-1])&&(rt.stop($,!0),ne[0].focus())}break;case 10:$.ctrlKey&&(rt.stop($,!0),this.getUI().list.toggleHover());break}})),this.ui={container:e,styleSheet:t,leftActionBar:r,titleBar:i,title:o,description1:k,description2:u,widget:T,rightActionBar:a,checkAll:c,inputContainer:h,filterContainer:d,inputBox:f,visibleCountContainer:g,visibleCount:p,countContainer:m,count:b,okContainer:v,ok:w,message:D,customButtonContainer:y,customButton:x,list:N,progressBar:S,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:$=>this.show($),hide:()=>this.hide(),setVisibilities:$=>this.setVisibilities($),setEnabled:$=>this.setEnabled($),setContextKey:$=>this.options.setContextKey($),linkOpenerDelegate:$=>this.options.linkOpenerDelegate($)},this.updateStyles(),this.ui}pick(e,t={},i=In.None){return new Promise((s,r)=>{let o=u=>{var h;o=s,(h=t.onKeyMods)===null||h===void 0||h.call(t,a.keyMods),s(u)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick();let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const u=a.activeItems[0];u&&(o(u),a.hide())}}),a.onDidChangeActive(u=>{const h=u[0];h&&t.onDidFocus&&t.onDidFocus(h)}),a.onDidChangeSelection(u=>{if(!a.canSelectMany){const h=u[0];h&&(o(h),a.hide())}}),a.onDidTriggerItemButton(u=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},u),{removeItem:()=>{const h=a.items.indexOf(u.item);if(h!==-1){const d=a.items.slice(),f=d.splice(h,1),g=a.activeItems.filter(m=>m!==f[0]),p=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=d,g&&(a.activeItems=g),a.keepScrollPosition=p}}}))),a.onDidTriggerSeparatorButton(u=>{var h;return(h=t.onDidTriggerSeparatorButton)===null||h===void 0?void 0:h.call(t,u)}),a.onDidChangeValue(u=>{l&&!u&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{ti(c),o(void 0)})];a.title=t.title,a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.autoFocusOnList=t.autoFocusOnList===void 0||t.autoFocusOnList,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([u,h])=>{l=h,a.busy=!1,a.items=u,a.canSelectMany&&(a.selectedItems=u.filter(d=>d.type!=="separator"&&d.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,u=>{r(u),a.hide()})})}createQuickPick(){const e=this.getUI();return new Qy(e)}createInputBox(){const e=this.getUI();return new SVe(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",qs(t.widget),t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Fi.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),qs(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const s=this.options.backKeybindingLabel();CP.tooltip=s?_("quickInput.backWithKeybinding","Back ({0})",s):_("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t,i,s;const r=this.controller;if(!r)return;const o=!Qn(document.activeElement,(i=(t=this.ui)===null||t===void 0?void 0:t.container)!==null&&i!==void 0?i:null);if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!o){let a=this.previousFocusElement;for(;a&&!a.offsetParent;)a=(s=a.parentElement)!==null&&s!==void 0?s:void 0;a!=null&&a.offsetParent?(a.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}r.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isDisplayed()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,uA.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:s,widgetShadow:r}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=s?`1px solid ${s}`:"",this.ui.container.style.boxShadow=r?`0 0 8px 2px ${r}`:"",this.ui.list.style(this.styles.list);const o=[];this.styles.pickerGroup.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&o.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}isDisplayed(){return this.ui&&this.ui.container.style.display!=="none"}}uA.MAX_WIDTH=600;var xVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},t2=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let SP=class extends ePe{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(bP))),this._quickAccess}constructor(e,t,i,s){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=s,this._onShow=this._register(new G),this._onHide=this._register(new G),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:r=>this.setContextKey(r),linkOpenerDelegate:r=>{this.instantiationService.invokeFunction(o=>{o.get(hh).open(r,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),createList:(r,o,a,l,c)=>this.instantiationService.createInstance(pP,r,o,a,l,c),styles:this.computeStyles()},s=this._register(new uA(Object.assign(Object.assign({},i),t),this.themeService));return s.layout(e.dimension,e.offset.quickPickTop),this._register(e.onDidLayout(r=>s.layout(r,e.offset.quickPickTop))),this._register(s.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(s.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),s}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Fe(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t={},i=In.None){return this.controller.pick(e,t,i)}createQuickPick(){return this.controller.createQuickPick()}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:Ce(cU),quickInputForeground:Ce(f3e),quickInputTitleBackground:Ce(g3e),widgetBorder:Ce(Zne),widgetShadow:Ce(Wu)},inputBox:SD,toggle:CD,countBadge:Wre,button:NBe,progressBar:RBe,keybindingLabel:IBe,list:LS({listBackground:cU,listFocusBackground:fF,listFocusForeground:dF,listInactiveFocusForeground:dF,listInactiveSelectionIconForeground:ese,listInactiveFocusBackground:fF,listFocusOutline:ui,listInactiveFocusOutline:ui}),pickerGroup:{pickerGroupBorder:Ce(p3e),pickerGroupForeground:Ce(Yne)}}}};SP=xVe([t2(0,Wt),t2(1,_t),t2(2,qr),t2(3,Xb)],SP);var poe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},A0=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let xP=class extends SP{constructor(e,t,i,s,r){super(t,i,s,new PF(e.getContainerDomNode(),r)),this.host=void 0;const o=_b.get(e);if(o){const a=o.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return a.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus(),offset:{top:0,quickPickTop:0}}}else this.host=void 0}createController(){return super.createController(this.host)}};xP=poe([A0(1,Wt),A0(2,_t),A0(3,qr),A0(4,ci)],xP);let kP=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(xP,e);this.mapEditorToService.set(e,t),G_(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t={},i=In.None){return this.activeService.pick(e,t,i)}createQuickPick(){return this.activeService.createQuickPick()}createInputBox(){return this.activeService.createInputBox()}};kP=poe([A0(0,Wt),A0(1,ci)],kP);class _b{static get(e){return e.getContribution(_b.ID)}constructor(e){this.editor=e,this.widget=new hA(this.editor)}dispose(){this.widget.dispose()}}_b.ID="editor.controller.quickInput";class hA{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return hA.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}hA.ID="editor.contrib.quickInputWidget";Va(_b.ID,_b,4);class kVe{constructor(e,t,i,s,r){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=s,this.background=r}}function LVe(n){if(!n||!Array.isArray(n))return[];const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const r=n[i];let o=-1;if(typeof r.fontStyle=="string"){o=0;const c=r.fontStyle.split(" ");for(let u=0,h=c.length;u<h;u++)switch(c[u]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break;case"strikethrough":o=o|8;break}}let a=null;typeof r.foreground=="string"&&(a=r.foreground);let l=null;typeof r.background=="string"&&(l=r.background),e[t++]=new kVe(r.token||"",i,o,a,l)}return e}function DVe(n,e){n.sort((u,h)=>{const d=NVe(u.token,h.token);return d!==0?d:u.index-h.index});let t=0,i="000000",s="ffffff";for(;n.length>=1&&n[0].token==="";){const u=n.shift();u.fontStyle!==-1&&(t=u.fontStyle),u.foreground!==null&&(i=u.foreground),u.background!==null&&(s=u.background)}const r=new TVe;for(const u of e)r.getId(u);const o=r.getId(i),a=r.getId(s),l=new Y7(t,o,a),c=new X7(l);for(let u=0,h=n.length;u<h;u++){const d=n[u];c.insert(d.token,d.fontStyle,r.getId(d.foreground),r.getId(d.background))}return new moe(r,c)}const EVe=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class TVe{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(EVe);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=J.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class moe{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(LVe(e),t)}static createFromParsedTokenTheme(e,t){return DVe(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const s=this._match(t),r=IVe(t);i=(s.metadata|r<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const AVe=/\b(comment|string|regex|regexp)\b/;function IVe(n){const e=n.match(AVe);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function NVe(n,e){return n<e?-1:n>e?1:0}class Y7{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new Y7(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class X7{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,s;t===-1?(i=e,s=""):(i=e.substring(0,t),s=e.substring(t+1));const r=this._children.get(i);return typeof r<"u"?r.match(s):this._mainRule}insert(e,t,i,s){if(e===""){this._mainRule.acceptOverwrite(t,i,s);return}const r=e.indexOf(".");let o,a;r===-1?(o=e,a=""):(o=e.substring(0,r),a=e.substring(r+1));let l=this._children.get(o);typeof l>"u"&&(l=new X7(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,s)}}function RVe(n){const e=[];for(let t=1,i=n.length;t<i;t++){const s=n[t];e[t]=`.mtk${t} { color: ${s}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const MVe={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[vn]:"#FFFFFE",[Df]:"#000000",[Xne]:"#E5EBF1",[wS]:"#D3D3D3",[yS]:"#939393",[$8]:"#ADD6FF4D"}},FVe={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[vn]:"#1E1E1E",[Df]:"#D4D4D4",[Xne]:"#3A3D41",[wS]:"#404040",[yS]:"#707070",[$8]:"#ADD6FF26"}},PVe={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[vn]:"#000000",[Df]:"#FFFFFF",[wS]:"#FFFFFF",[yS]:"#FFFFFF"}},OVe={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[vn]:"#FFFFFF",[Df]:"#292929",[wS]:"#292929",[yS]:"#292929"}},BVe={IconContribution:"base.contributions.icons"};var Iq;(function(n){function e(t,i){let s=t.defaults;for(;Ye.isThemeIcon(s);){const r=pm.getIcon(s.id);if(!r)return;s=r.defaults}return s}n.getDefinition=e})(Iq||(Iq={}));var Nq;(function(n){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(s=>({format:s.format,location:s.location.toString()}))}}n.toJSONObject=e;function t(i){const s=r=>_r(r)?r:void 0;if(i&&Array.isArray(i.src)&&i.src.every(r=>_r(r.format)&&_r(r.location)))return{weight:s(i.weight),style:s(i.style),src:i.src.map(r=>({format:r.format,location:ot.parse(r.location)}))}}n.fromJSONObject=t})(Nq||(Nq={}));class WVe{constructor(){this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:_("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:_("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Ye.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,s){const r=this.iconsById[e];if(r){if(i&&!r.description){r.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return r}const o={id:e,description:i,defaults:t,deprecationMessage:s};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return s&&(a.deprecationMessage=s),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(r,o)=>r.id.localeCompare(o.id),t=r=>{for(;Ye.isThemeIcon(r.defaults);)r=this.iconsById[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const s=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of s.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${Ye.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of s.filter(o=>!Ye.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}}const pm=new WVe;Un.add(BVe.IconContribution,pm);function Cn(n,e,t,i){return pm.registerIcon(n,e,t,i)}function _oe(){return pm}function VVe(){const n=Aie();for(const e in n){const t="\\"+n[e].toString(16);pm.registerIcon(e,{fontCharacter:t})}}VVe();const boe="vscode://schemas/icons",voe=Un.as(IT.JSONContribution);voe.registerSchema(boe,pm.getIconSchema());const Rq=new Ui(()=>voe.notifySchemaChanged(boe),200);pm.onDidChange(()=>{Rq.isScheduled()||Rq.schedule()});const $Ve=Cn("widget-close",we.close,_("widgetClose","Icon for the close action in widgets."));Cn("goto-previous-location",we.arrowUp,_("previousChangeIcon","Icon for goto previous editor location."));Cn("goto-next-location",we.arrowDown,_("nextChangeIcon","Icon for goto next editor location."));Ye.modify(we.sync,"spin");Ye.modify(we.loading,"spin");function zVe(n){const e=new Ae,t=e.add(new G),i=_oe();return e.add(i.onDidChange(()=>t.fire())),n&&e.add(n.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const s=n?n.getProductIconTheme():new woe,r={},o=l=>{const c=s.getIcon(l);if(!c)return;const u=c.font;return u?(r[u.id]=u.definition,`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${pH(u.id)}; }`):`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`},a=[];for(const l of i.getIcons()){const c=o(l);c&&a.push(c)}for(const l in r){const c=r[l],u=c.weight?`font-weight: ${c.weight};`:"",h=c.style?`font-style: ${c.style};`:"",d=c.src.map(f=>`${tf(f.location)} format('${f.format}')`).join(", ");a.push(`@font-face { src: ${d}; font-family: ${pH(l)};${u}${h} font-display: block; }`)}return a.join(`
`)}}}class woe{getIcon(e){const t=_oe();let i=e.defaults;for(;Ye.isThemeIcon(i);){const s=t.getIcon(i.id);if(!s)return;i=s.defaults}return i}}const Qh="vs",lw="vs-dark",d_="hc-black",f_="hc-light",yoe=Un.as(Kne.ColorContribution),HVe=Un.as(hse.ThemingContribution);class Coe{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(mk(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,J.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=LP(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,J.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=yoe.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Qh:return Fo.LIGHT;case d_:return Fo.HIGH_CONTRAST_DARK;case f_:return Fo.HIGH_CONTRAST_LIGHT;default:return Fo.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const r=LP(this.themeData.base);e=r.rules,r.encodedTokensColors&&(t=r.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],s=this.themeData.colors["editor.background"];if(i||s){const r={token:""};i&&(r.foreground=i),s&&(r.background=s),e.push(r)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=moe.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const r=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=Ir.getForeground(r),a=Ir.getFontStyle(r);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function mk(n){return n===Qh||n===lw||n===d_||n===f_}function LP(n){switch(n){case Qh:return MVe;case lw:return FVe;case d_:return PVe;case f_:return OVe}}function i2(n){const e=LP(n);return new Coe(n,e)}class UVe extends ae{constructor(){super(),this._onColorThemeChange=this._register(new G),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new G),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new woe,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Qh,i2(Qh)),this._knownThemes.set(lw,i2(lw)),this._knownThemes.set(d_,i2(d_)),this._knownThemes.set(f_,i2(f_));const e=this._register(zVe(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Qh),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),Oie("(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return H3(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Fa(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),ae.None}_registerShadowDomContainer(e){const t=Fa(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!mk(t.base)&&!mk(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new Coe(e,t)),mk(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Qh),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=window.matchMedia("(forced-colors: active)").matches;if(e!==Gu(this._theme.type)){let t;$T(this._theme.type)?t=e?d_:lw:t=e?f_:Qh,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:o=>{t[o]||(e.push(o),t[o]=!0)}};HVe.getThemingParticipants().forEach(o=>o(this._theme,i,this._environment));const s=[];for(const o of yoe.getColors()){const a=this._theme.getColor(o.id,!0);a&&s.push(`${B8(o.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor { ${s.join(`
`)} }`);const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(RVe(r)),this._themeCSS=e.join(`
`),this._updateCSS(),$i.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const za=kt("themeService");var jVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},zR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let DP=class extends ae{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new G,this._onDidChangeReducedMotion=new G,this._accessibilityModeEnabledContext=I4e.bindTo(this._contextKeyService);const s=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(o=>{o.affectsConfiguration("editor.accessibilitySupport")&&(s(),this._onDidChangeScreenReaderOptimized.fire()),o.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),s(),this._register(this.onDidChangeScreenReaderOptimized(()=>s()));const r=window.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=r.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(r)}initReducedMotionListeners(e){if(!this._layoutService.hasContainer)return;this._register(oe(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.container.classList.toggle("reduce-motion",i),this._layoutService.container.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};DP=jVe([zR(0,_t),zR(1,Xb),zR(2,xi)],DP);var dA=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Ip=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Jm,Oh;let EP=class{constructor(e,t){this._commandService=e,this._hiddenStates=new FD(t)}createMenu(e,t,i){return new AP(e,this._hiddenStates,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},i),this._commandService,t)}resetHiddenStates(e){this._hiddenStates.reset(e)}};EP=dA([Ip(0,Ys),Ip(1,dm)],EP);let FD=Jm=class{constructor(e){this._storageService=e,this._disposables=new Ae,this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(Jm._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Jm._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(Jm._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){var i;return(i=this._hiddenByDefaultCache.get(`${e.id}/${t}`))!==null&&i!==void 0?i:!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var i,s;const r=this._isHiddenByDefault(e,t),o=(s=(i=this._data[e.id])===null||i===void 0?void 0:i.includes(t))!==null&&s!==void 0?s:!1;return r?!o:o}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const r=this._data[e.id];if(i)r?r.indexOf(t)<0&&r.push(t):this._data[e.id]=[t];else if(r){const o=r.indexOf(t);o>=0&&UEe(r,o),r.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(Jm._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};FD._key="menu.hiddenCommands";FD=Jm=dA([Ip(0,dm)],FD);let TP=Oh=class{constructor(e,t,i,s,r){this._id=e,this._hiddenStates=t,this._collectContextKeysForSubmenus=i,this._commandService=s,this._contextKeyService=r,this._menuGroups=[],this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=_a.getMenuItems(this._id);let t;e.sort(Oh._compareMenuItems);for(const i of e){const s=i.group||"";(!t||t[0]!==s)&&(t=[s,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeys(i)}}_collectContextKeys(e){if(Oh._fillInKbExprKeys(e.when,this._structureContextKeys),iv(e)){if(e.command.precondition&&Oh._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;Oh._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&_a.getMenuItems(e.submenu).forEach(this._collectContextKeys,this)}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[s,r]=i,o=[];for(const a of r)if(this._contextKeyService.contextMatchesRules(a.when)){const l=iv(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=qVe(this._id,l?a.command:a,this._hiddenStates);if(l)o.push(new Ac(a.command,a.alt,e,c,this._contextKeyService,this._commandService));else{const u=new Oh(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._contextKeyService).createActionGroups(e),h=gs.join(...u.map(d=>d[1]));h.length>0&&o.push(new OL(a,c,h))}}o.length>0&&t.push([s,o])}return t}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}static _compareMenuItems(e,t){const i=e.group,s=t.group;if(i!==s){if(i){if(!s)return-1}else return 1;if(i==="navigation")return-1;if(s==="navigation")return 1;const a=i.localeCompare(s);if(a!==0)return a}const r=e.order||0,o=t.order||0;return r<o?-1:r>o?1:Oh._compareTitles(iv(e)?e.command.title:e.title,iv(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,s=typeof t=="string"?t:t.original;return i.localeCompare(s)}};TP=Oh=dA([Ip(3,Ys),Ip(4,_t)],TP);let AP=class{constructor(e,t,i,s,r){this._disposables=new Ae,this._menuInfo=new TP(e,t,i.emitEventsForSubmenuChanges,s,r);const o=new Ui(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(o),this._disposables.add(_a.onDidChangeMenu(u=>{u.has(e)&&o.schedule()}));const a=this._disposables.add(new Ae),l=u=>{let h=!1,d=!1,f=!1;for(const g of u)if(h=h||g.isStructuralChange,d=d||g.isEnablementChange,f=f||g.isToggleChange,h&&d&&f)break;return{menu:this,isStructuralChange:h,isEnablementChange:d,isToggleChange:f}},c=()=>{a.add(r.onDidChangeContext(u=>{const h=u.affectsSome(this._menuInfo.structureContextKeys),d=u.affectsSome(this._menuInfo.preconditionContextKeys),f=u.affectsSome(this._menuInfo.toggledContextKeys);(h||d||f)&&this._onDidChange.fire({menu:this,isStructuralChange:h,isEnablementChange:d,isToggleChange:f})})),a.add(t.onDidChange(u=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new vie({onWillAddFirstListener:c,onDidRemoveLastListener:a.clear.bind(a),delay:i.eventDebounceDelay,merge:l}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};AP=dA([Ip(3,Ys),Ip(4,_t)],AP);function qVe(n,e,t){const i=PIe(e)?e.submenu.id:e.id,s=typeof e.title=="string"?e.title:e.title.value,r=Hv({id:`hide/${n.id}/${i}`,label:_("hide.label","Hide '{0}'",s),run(){t.updateHidden(n,i,!0)}}),o=Hv({id:`toggle/${n.id}/${i}`,label:s,get checked(){return!t.isHidden(n,i)},run(){t.updateHidden(n,i,!!this.checked)}});return{hide:r,toggle:o,get isHidden(){return!o.checked}}}var GVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Mq=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Uf=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let IP=class extends ae{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],(ih||Bie)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const e=()=>{const t=new mne;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(i=>Uf(this,void 0,void 0,function*(){(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)}))};this.layoutService.hasContainer&&(this._register(oe(this.layoutService.container,"click",e)),this._register(oe(this.layoutService.container,"keydown",e)))}writeText(e,t){return Uf(this,void 0,void 0,function*(){if(t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return yield navigator.clipboard.writeText(e)}catch(r){console.error(r)}const i=document.activeElement,s=document.body.appendChild(Be("textarea",{"aria-hidden":!0}));s.style.height="1px",s.style.width="1px",s.style.position="absolute",s.value=e,s.focus(),s.select(),document.execCommand("copy"),i instanceof HTMLElement&&i.focus(),document.body.removeChild(s)})}readText(e){return Uf(this,void 0,void 0,function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return console.error(t),""}})}readFindText(){return Uf(this,void 0,void 0,function*(){return this.findText})}writeFindText(e){return Uf(this,void 0,void 0,function*(){this.findText=e})}writeResources(e){return Uf(this,void 0,void 0,function*(){this.resources=e})}readResources(){return Uf(this,void 0,void 0,function*(){return this.resources})}};IP=GVe([Mq(0,Xb),Mq(1,lh)],IP);const RS=kt("clipboardService");var KVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ZVe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const cw="data-keybinding-context";class Q7{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return Object.assign({},this._value)}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}class bb extends Q7{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}bb.INSTANCE=new bb;class Jy extends Q7{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=aw.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(s=>{if(s.source===7){const r=Array.from(this._values,([o])=>o);this._values.clear(),i.fire(new Pq(r))}else{const r=[];for(const o of s.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(r.push(...Et.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(r.push(a),this._values.delete(a))}i.fire(new Pq(r))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Jy._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Jy._keyPrefix.length),i=this._configurationService.getValue(t);let s;switch(typeof i){case"number":case"boolean":case"string":s=i;break;default:Array.isArray(i)?s=JSON.stringify(i):s=i}return this._values.set(e,s),s}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}Jy._keyPrefix="config.";class YVe{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Fq{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class Pq{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class XVe{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function QVe(n,e){return n.allKeysContainedIn(new Set(Object.keys(e)))}class Soe extends ae{constructor(e){super(),this._onDidChangeContext=this._register(new oy({merge:t=>new XVe(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new YVe(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new JVe(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new Fq(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Fq(e))}getContext(e){return this._isDisposed?bb.INSTANCE:this.getContextValuesContainer(e$e(e))}dispose(){super.dispose(),this._isDisposed=!0}}let NP=class extends Soe{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new Jy(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?bb.INSTANCE:this._contexts.get(e)||bb.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new Q7(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};NP=KVe([ZVe(0,xi)],NP);class JVe extends Soe{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new wl),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(cw)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(cw,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;QVe(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(cw),super.dispose())}getContextValuesContainer(e){return this._isDisposed?bb.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function e$e(n){for(;n;){if(n.hasAttribute(cw)){const e=n.getAttribute(cw);return e?parseInt(e,10):NaN}n=n.parentElement}return 0}function t$e(n,e,t){n.get(_t).createKey(String(e),i$e(t))}function i$e(n){return aie(n,e=>{if(typeof e=="object"&&e.$mid===1)return ot.revive(e).toString();if(e instanceof ot)return e.toString()})}pi.registerCommand("_setContext",t$e);pi.registerCommand({id:"getContextKeyInfo",handler(){return[...Fe.all()].sort((n,e)=>n.key.localeCompare(e.key))},description:{description:_("getContextKeyInfo","A command that returns information about context keys"),args:[]}});pi.registerCommand("_generateContextKeyInfo",function(){const n=[],e=new Set;for(const t of Fe.all())e.has(t.key)||(e.add(t.key),n.push(t));n.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(n,void 0,2))});let n$e=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class Oq{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),s=this.lookupOrInsertNode(t);i.outgoing.set(s.key,s),s.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new n$e(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),s=this._findCycle(t,i);if(s)return s}}_findCycle(e,t){for(const[i,s]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this._findCycle(s,t);if(r)return r;t.delete(i)}}}const s$e=!1;class Bq extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=(t=e.findCycleSlow())!==null&&t!==void 0?t:`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class PD{constructor(e=new GT,t=!1,i,s=s$e){var r;this._services=e,this._strict=t,this._parent=i,this._enableTracing=s,this._activeInstantiations=new Set,this._services.set(Wt,this),this._globalGraph=s?(r=i==null?void 0:i._globalGraph)!==null&&r!==void 0?r:new Oq(o=>o):void 0}createChild(e){return new PD(e,this._strict,this,this._enableTracing)}invokeFunction(e,...t){const i=or.traceInvocation(this._enableTracing,e);let s=!1;try{return e({get:o=>{if(s)throw t8("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{s=!0,i.stop()}}createInstance(e,...t){let i,s;return e instanceof Ql?(i=or.traceCreation(this._enableTracing,e.ctor),s=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=or.traceCreation(this._enableTracing,e),s=this._createInstance(e,t,i)),i.stop(),s}_createInstance(e,t=[],i){const s=fl.getServiceDependencies(e).sort((a,l)=>a.index-l.index),r=[];for(const a of s){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),r.push(l)}const o=s.length>0?s[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(r))}_setServiceInstance(e,t){if(this._services.get(e)instanceof Ql)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Ql?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var s;const r=new Oq(l=>l.id.toString());let o=0;const a=[{id:e,desc:t,_trace:i}];for(;a.length;){const l=a.pop();if(r.lookupOrInsertNode(l),o++>1e3)throw new Bq(r);for(const c of fl.getServiceDependencies(l.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(c.id);if(u||this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,!0),(s=this._globalGraph)===null||s===void 0||s.insertEdge(String(l.id),String(c.id)),u instanceof Ql){const h={id:c.id,desc:u,_trace:l._trace.branch(c.id,!0)};r.insertEdge(l,h),a.push(h)}}}for(;;){const l=r.roots();if(l.length===0){if(!r.isEmpty())throw new Bq(r);break}for(const{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof Ql){const h=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setServiceInstance(c.id,h)}r.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],s,r){if(this._services.get(e)instanceof Ql)return this._createServiceInstance(e,t,i,s,r);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,s,r);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],s,r){if(s){const o=new PD(void 0,this._strict,this,this._enableTracing);o._globalGraphImplicitDependency=String(e);const a=new Map,l=new HNe(()=>{const c=o._createInstance(t,i,r);for(const[u,h]of a){const d=c[u];if(typeof d=="function")for(const f of h)d.apply(c,f)}return a.clear(),c});return new Proxy(Object.create(null),{get(c,u){if(!l.isInitialized&&typeof u=="string"&&(u.startsWith("onDid")||u.startsWith("onWill"))){let f=a.get(u);return f||(f=new hr,a.set(u,f)),(p,m,b)=>{const v=f.push([p,m,b]);return ut(v)}}if(u in c)return c[u];const h=l.value;let d=h[u];return typeof d!="function"||(d=d.bind(h),c[u]=d),d},set(c,u,h){return l.value[u]=h,!0},getPrototypeOf(c){return t.prototype}})}else return this._createInstance(t,i,r)}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class or{static traceInvocation(e,t){return e?new or(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):or._None}static traceCreation(e,t){return e?new or(1,t.name):or._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new or(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;or._totals+=e;let t=!1;function i(r,o){const a=[],l=new Array(r+1).join("	");for(const[c,u,h]of o._dep)if(u&&h){t=!0,a.push(`${l}CREATES -> ${c}`);const d=i(r+1,h);d&&a.push(d)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const s=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${or._totals.toFixed(2)}ms)`];(e>2||t)&&or.all.add(s.join(`
`))}}or.all=new Set;or._None=new class extends or{constructor(){super(0,null)}stop(){}branch(){return this}};or._totals=0;const r$e=new Set([bt.inMemory,bt.vscodeSourceControl,bt.walkThrough,bt.walkThroughSnippet]);class o$e{constructor(){this._byResource=new us,this._byOwner=new Map}set(e,t,i){let s=this._byResource.get(e);s||(s=new Map,this._byResource.set(e,s)),s.set(t,i);let r=this._byOwner.get(t);r||(r=new us,this._byOwner.set(t,r)),r.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,s=!1;const r=this._byResource.get(e);r&&(i=r.delete(t));const o=this._byOwner.get(t);if(o&&(s=o.delete(e)),i!==s)throw new Error("illegal state");return i&&s}values(e){var t,i,s,r;return typeof e=="string"?(i=(t=this._byOwner.get(e))===null||t===void 0?void 0:t.values())!==null&&i!==void 0?i:Et.empty():ot.isUri(e)?(r=(s=this._byResource.get(e))===null||s===void 0?void 0:s.values())!==null&&r!==void 0?r:Et.empty():Et.map(Et.concat(...this._byOwner.values()),o=>o[1])}}class a$e{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new us,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const s=this._resourceStats(t);this._add(s),this._data.set(t,s)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(r$e.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===Ci.Error?t.errors+=1:i===Ci.Warning?t.warnings+=1:i===Ci.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class Wh{constructor(){this._onMarkerChanged=new vie({delay:0,merge:Wh._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new o$e,this._stats=new a$e(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(GEe(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const s=[];for(const r of i){const o=Wh._toMarker(e,t,r);o&&s.push(o)}this._data.set(t,e,s),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:s,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:h,relatedInformation:d,tags:f}=i;if(o)return l=l>0?l:1,c=c>0?c:1,u=u>=l?u:l,h=h>0?h:c,{resource:t,owner:e,code:s,severity:r,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:u,endColumn:h,relatedInformation:d,tags:f}}changeAll(e,t){const i=[],s=this._data.values(e);if(s)for(const r of s){const o=Et.first(r);o&&(i.push(o.resource),this._data.delete(o.resource,e))}if(Uu(t)){const r=new us;for(const{resource:o,marker:a}of t){const l=Wh._toMarker(e,o,a);if(!l)continue;const c=r.get(o);c?c.push(l):(r.set(o,[l]),i.push(o))}for(const[o,a]of r)this._data.set(o,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:s,take:r}=e;if((!r||r<0)&&(r=-1),t&&i){const o=this._data.get(i,t);if(o){const a=[];for(const l of o)if(Wh._accept(l,s)){const c=a.push(l);if(r>0&&c===r)break}return a}else return[]}else if(!t&&!i){const o=[];for(const a of this._data.values())for(const l of a)if(Wh._accept(l,s)){const c=o.push(l);if(r>0&&c===r)return o}return o}else{const o=this._data.values(i??t),a=[];for(const l of o)for(const c of l)if(Wh._accept(c,s)){const u=a.push(c);if(r>0&&u===r)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new us;for(const i of e)for(const s of i)t.set(s,!0);return Array.from(t.keys())}}class l$e extends ae{constructor(){super(...arguments),this._configurationModel=new os}get configurationModel(){return this._configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=new os;const e=Un.as(om.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const s of e){const r=i[s],o=t[s];r!==void 0?this._configurationModel.addValue(s,r):o?this._configurationModel.addValue(s,o.default):this._configurationModel.removeValue(s)}}}const fA=kt("audioCue");class st{static register(e){return new st(e.fileName)}constructor(e){this.fileName=e}}st.error=st.register({fileName:"error.mp3"});st.warning=st.register({fileName:"warning.mp3"});st.foldedArea=st.register({fileName:"foldedAreas.mp3"});st.break=st.register({fileName:"break.mp3"});st.quickFixes=st.register({fileName:"quickFixes.mp3"});st.taskCompleted=st.register({fileName:"taskCompleted.mp3"});st.taskFailed=st.register({fileName:"taskFailed.mp3"});st.terminalBell=st.register({fileName:"terminalBell.mp3"});st.diffLineInserted=st.register({fileName:"diffLineInserted.mp3"});st.diffLineDeleted=st.register({fileName:"diffLineDeleted.mp3"});st.diffLineModified=st.register({fileName:"diffLineModified.mp3"});st.chatRequestSent=st.register({fileName:"chatRequestSent.mp3"});st.chatResponsePending=st.register({fileName:"chatResponsePending.mp3"});st.chatResponseReceived1=st.register({fileName:"chatResponseReceived1.mp3"});st.chatResponseReceived2=st.register({fileName:"chatResponseReceived2.mp3"});st.chatResponseReceived3=st.register({fileName:"chatResponseReceived3.mp3"});st.chatResponseReceived4=st.register({fileName:"chatResponseReceived4.mp3"});class c$e{constructor(e){this.randomOneOf=e}}class Dt{static register(e){const t=new c$e("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new Dt(t,e.name,e.settingsKey);return Dt._audioCues.add(i),i}constructor(e,t,i){this.sound=e,this.name=t,this.settingsKey=i}}Dt._audioCues=new Set;Dt.error=Dt.register({name:_("audioCues.lineHasError.name","Error on Line"),sound:st.error,settingsKey:"audioCues.lineHasError"});Dt.warning=Dt.register({name:_("audioCues.lineHasWarning.name","Warning on Line"),sound:st.warning,settingsKey:"audioCues.lineHasWarning"});Dt.foldedArea=Dt.register({name:_("audioCues.lineHasFoldedArea.name","Folded Area on Line"),sound:st.foldedArea,settingsKey:"audioCues.lineHasFoldedArea"});Dt.break=Dt.register({name:_("audioCues.lineHasBreakpoint.name","Breakpoint on Line"),sound:st.break,settingsKey:"audioCues.lineHasBreakpoint"});Dt.inlineSuggestion=Dt.register({name:_("audioCues.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:st.quickFixes,settingsKey:"audioCues.lineHasInlineSuggestion"});Dt.terminalQuickFix=Dt.register({name:_("audioCues.terminalQuickFix.name","Terminal Quick Fix"),sound:st.quickFixes,settingsKey:"audioCues.terminalQuickFix"});Dt.onDebugBreak=Dt.register({name:_("audioCues.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:st.break,settingsKey:"audioCues.onDebugBreak"});Dt.noInlayHints=Dt.register({name:_("audioCues.noInlayHints","No Inlay Hints on Line"),sound:st.error,settingsKey:"audioCues.noInlayHints"});Dt.taskCompleted=Dt.register({name:_("audioCues.taskCompleted","Task Completed"),sound:st.taskCompleted,settingsKey:"audioCues.taskCompleted"});Dt.taskFailed=Dt.register({name:_("audioCues.taskFailed","Task Failed"),sound:st.taskFailed,settingsKey:"audioCues.taskFailed"});Dt.terminalCommandFailed=Dt.register({name:_("audioCues.terminalCommandFailed","Terminal Command Failed"),sound:st.error,settingsKey:"audioCues.terminalCommandFailed"});Dt.terminalBell=Dt.register({name:_("audioCues.terminalBell","Terminal Bell"),sound:st.terminalBell,settingsKey:"audioCues.terminalBell"});Dt.notebookCellCompleted=Dt.register({name:_("audioCues.notebookCellCompleted","Notebook Cell Completed"),sound:st.taskCompleted,settingsKey:"audioCues.notebookCellCompleted"});Dt.notebookCellFailed=Dt.register({name:_("audioCues.notebookCellFailed","Notebook Cell Failed"),sound:st.taskFailed,settingsKey:"audioCues.notebookCellFailed"});Dt.diffLineInserted=Dt.register({name:_("audioCues.diffLineInserted","Diff Line Inserted"),sound:st.diffLineInserted,settingsKey:"audioCues.diffLineInserted"});Dt.diffLineDeleted=Dt.register({name:_("audioCues.diffLineDeleted","Diff Line Deleted"),sound:st.diffLineDeleted,settingsKey:"audioCues.diffLineDeleted"});Dt.diffLineModified=Dt.register({name:_("audioCues.diffLineModified","Diff Line Modified"),sound:st.diffLineModified,settingsKey:"audioCues.diffLineModified"});Dt.chatRequestSent=Dt.register({name:_("audioCues.chatRequestSent","Chat Request Sent"),sound:st.chatRequestSent,settingsKey:"audioCues.chatRequestSent"});Dt.chatResponseReceived=Dt.register({name:_("audioCues.chatResponseReceived","Chat Response Received"),settingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[st.chatResponseReceived1,st.chatResponseReceived2,st.chatResponseReceived3,st.chatResponseReceived4]}});Dt.chatResponsePending=Dt.register({name:_("audioCues.chatResponsePending","Chat Response Pending"),sound:st.chatResponsePending,settingsKey:"audioCues.chatResponsePending"});class u$e extends ae{constructor(e,t=[]){super(),this.logger=new BIe([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const h$e=[];function d$e(){return h$e.slice(0)}var Af=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},zn=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},g_=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class f$e{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new G}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let RP=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new cAe(new f$e(t))):Promise.reject(new Error("Model not found"))}};RP=Af([zn(0,Zs)],RP);class gA{show(){return gA.NULL_PROGRESS_RUNNER}showWhile(e,t){return g_(this,void 0,void 0,function*(){yield e})}}gA.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class g$e{withProgress(e,t,i){return t({report:()=>{}})}}class p$e{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class m$e{confirm(e){return g_(this,void 0,void 0,function*(){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}})}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),window.confirm(i)}prompt(e){var t,i;return g_(this,void 0,void 0,function*(){let s;if(this.doConfirm(e.message,e.detail)){const o=[...(t=e.buttons)!==null&&t!==void 0?t:[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&o.push(e.cancelButton),s=yield(i=o[0])===null||i===void 0?void 0:i.run({checkboxChecked:!1})}return{result:s}})}error(e,t){return g_(this,void 0,void 0,function*(){yield this.prompt({type:Fi.Error,message:e,detail:t})})}}class eC{info(e){return this.notify({severity:Fi.Info,message:e})}warn(e){return this.notify({severity:Fi.Warning,message:e})}error(e){return this.notify({severity:Fi.Error,message:e})}notify(e){switch(e.severity){case Fi.Error:console.error(e.message);break;case Fi.Warning:console.warn(e.message);break;default:console.log(e.message);break}return eC.NO_OP}prompt(e,t,i,s){return eC.NO_OP}status(e,t){return ae.None}}eC.NO_OP=new b8e;let MP=class{constructor(e){this._onWillExecuteCommand=new G,this._onDidExecuteCommand=new G,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=pi.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const s=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(s)}catch(s){return Promise.reject(s)}}};MP=Af([zn(0,Wt)],MP);let vb=class extends T7e{constructor(e,t,i,s,r,o){super(e,t,i,s,r),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=f=>{const g=new Ae;g.add(oe(f,Le.KEY_DOWN,p=>{const m=new ri(p);this._dispatch(m,m.target)&&(m.preventDefault(),m.stopPropagation())})),g.add(oe(f,Le.KEY_UP,p=>{const m=new ri(p);this._singleModifierDispatch(m,m.target)&&m.preventDefault()})),this._domNodeListeners.push(new _$e(f,g))},l=f=>{for(let g=0;g<this._domNodeListeners.length;g++){const p=this._domNodeListeners[g];p.domNode===f&&(this._domNodeListeners.splice(g,1),p.dispose())}},c=f=>{f.getOption(61)||a(f.getContainerDomNode())},u=f=>{f.getOption(61)||l(f.getContainerDomNode())};this._register(o.onCodeEditorAdd(c)),this._register(o.onCodeEditorRemove(u)),o.listCodeEditors().forEach(c);const h=f=>{a(f.getContainerDomNode())},d=f=>{l(f.getContainerDomNode())};this._register(o.onDiffEditorAdd(h)),this._register(o.onDiffEditorRemove(d)),o.listDiffEditors().forEach(h)}addDynamicKeybinding(e,t,i,s){return ka(pi.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:s}]))}addDynamicKeybindings(e){const t=e.map(i=>{var s;return{keybinding:V3(i.keybinding,co),command:(s=i.command)!==null&&s!==void 0?s:null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}});return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),ut(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(wr.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new ow(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let s=0;for(const r of e){const o=r.when||void 0,a=r.keybinding;if(!a)i[s++]=new $j(void 0,r.command,r.commandArgs,o,t,null,!1);else{const l=zy.resolveKeybinding(a,co);for(const c of l)i[s++]=new $j(c,r.command,r.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new xp(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new zy([t],co)}};vb=Af([zn(0,_t),zn(1,Ys),zn(2,ah),zn(3,ts),zn(4,lh),zn(5,ci)],vb);class _$e extends ae{constructor(e,t){super(),this.domNode=e,this._register(t)}}function Wq(n){return n&&typeof n=="object"&&(!n.overrideIdentifier||typeof n.overrideIdentifier=="string")&&(!n.resource||n.resource instanceof ot)}class xoe{constructor(){this._onDidChangeConfiguration=new G,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const e=new l$e;this._configuration=new KT(e.reload(),new os,new os,new os),e.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,s=Wq(e)?e:Wq(t)?t:{};return this._configuration.getValue(i,s,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const s of e){const[r,o]=s;this.getValue(r)!==o&&(this._configuration.updateValue(r,o),i.push(r))}if(i.length>0){const s=new k7e({keys:i,overrides:[]},t,this._configuration);s.source=8,s.sourceConfig=null,this._onDidChangeConfiguration.fire(s)}return Promise.resolve()}updateValue(e,t,i,s){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}}let FP=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new G,this.configurationService.onDidChangeConfiguration(s=>{this._onDidChangeConfiguration.fire({affectedKeys:s.affectedKeys,affectsConfiguration:(r,o)=>s.affectsConfiguration(o)})})}getValue(e,t,i){const s=X.isIPosition(t)?t:null,r=s?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,o=e?this.getLanguage(e,s):void 0;return typeof r>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:o}):this.configurationService.getValue(r,{resource:e,overrideIdentifier:o})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};FP=Af([zn(0,xi),zn(1,Zs),zn(2,Ji)],FP);let PP=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Ts||Mt?`
`:`\r
`}};PP=Af([zn(0,xi)],PP);class b$e{publicLog2(){}}class tC{constructor(){const e=ot.from({scheme:tC.SCHEME,authority:"model",path:"/"});this.workspace={id:H7e,folders:[new $7e({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===tC.SCHEME?this.workspace.folders[0]:null}}tC.SCHEME="inmemory";function OD(n,e,t){if(!e||!(n instanceof xoe))return;const i=[];Object.keys(e).forEach(s=>{v7e(s)&&i.push([`editor.${s}`,e[s]]),t&&w7e(s)&&i.push([`diffEditor.${s}`,e[s]])}),i.length>0&&n.updateValues(i)}let OP=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return g_(this,void 0,void 0,function*(){const i=Array.isArray(e)?e:_7.convert(e),s=new Map;for(const a of i){if(!(a instanceof Yg))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=s.get(l);c||(c=[],s.set(l,c)),c.push(C7e.replaceMove(H.lift(a.textEdit.range),a.textEdit.text))}let r=0,o=0;for(const[a,l]of s)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),o+=1,r+=l.length;return{ariaSummary:ly(zF.bulkEditServiceSummary,r,o),isApplied:r>0}})}};OP=Af([zn(0,Zs)],OP);class v$e{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return Cl(e)}}let BP=class extends HF{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const s=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();s&&(t=s.getContainerDomNode())}return super.showContextView(e,t,i)}};BP=Af([zn(0,Xb),zn(1,ci)],BP);class w$e{constructor(){this._neverEmitter=new G,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class y$e extends Uy{constructor(){super()}}class C$e extends u$e{constructor(){super(new OIe)}}let WP=class extends oP{constructor(e,t,i,s,r,o){super(e,t,i,s,r,o),this.configure({blockMouse:!1})}};WP=Af([zn(0,ah),zn(1,ts),zn(2,Ef),zn(3,Oi),zn(4,Sf),zn(5,_t)],WP);class S$e{playAudioCue(e,t){return g_(this,void 0,void 0,function*(){})}}At(xi,xoe,0);At(One,FP,0);At(Bne,PP,0);At(V7e,tC,0);At(YT,v$e,0);At(ah,b$e,0);At(nre,m$e,0);At(lre,p$e,0);At(ts,eC,0);At(Uc,Wh,0);At(Ji,y$e,0);At(za,UVe,0);At(lh,C$e,0);At(Zs,ED,0);At(O8,hP,0);At(_t,NP,0);At(F7e,g$e,0);At(xS,gA,0);At(dm,TBe,0);At(DS,nF,0);At(pre,OP,0);At(U7e,w$e,0);At(Cf,RP,0);At(Lf,DP,0);At(Ko,jWe,0);At(Ys,MP,0);At(Oi,vb,0);At(K7,kP,0);At(Ef,BP,0);At(hh,uP,0);At(RS,IP,0);At(Tf,WP,0);At(Sf,EP,0);At(fA,S$e,0);var Ge;(function(n){const e=new GT;for(const[l,c]of xH())e.set(l,c);const t=new PD(e,!0);e.set(Wt,t);function i(l){s||o({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Ql?t.invokeFunction(u=>u.get(l)):c}n.get=i;let s=!1;const r=new G;function o(l){if(s)return t;s=!0;for(const[u,h]of xH())e.get(u)||e.set(u,h);for(const u in l)if(l.hasOwnProperty(u)){const h=kt(u);e.get(h)instanceof Ql&&e.set(h,l[u])}const c=d$e();for(const u of c)try{t.createInstance(u)}catch(h){Ft(h)}return r.fire(),t}n.initialize=o;function a(l){if(s)return l();const c=new Ae,u=c.add(r.event(()=>{u.dispose(),c.add(l())}));return c}n.withServices=a})(Ge||(Ge={}));let x$e;function Ku(){return x$e}let koe;function k$e(n){koe=n}class Loe{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,s=t===void 0?e:t;return koe({owner:i,debugName:()=>{const r=mm(s);if(r!==void 0)return r;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(s.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`}},r=>s(this.read(r),r))}}class MS extends Loe{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function ps(n,e){const t=new Doe(n,e);try{n(t)}finally{t.finish()}}function L$e(n,e,t){n?e(n):ps(e,t)}class Doe{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this.updatingObservers=[],(i=Ku())===null||i===void 0||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():mm(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var e;const t=this.updatingObservers;this.updatingObservers=null;for(const{observer:i,observable:s}of t)i.endUpdate(s);(e=Ku())===null||e===void 0||e.handleEndTransaction()}}function J7(n,e,t,i){let s;if(n!==void 0)if(typeof n=="function"){if(s=n(),s!==void 0)return s}else return n;if(e!==void 0&&(s=mm(e),s!==void 0))return s;if(t!==void 0){for(const r in t)if(t[r]===i)return r}}function mm(n){const e=n.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),s=i?i[1]:void 0;return s==null?void 0:s.trim()}function Ti(n,e){return typeof n=="string"?new VP(void 0,n,e):new VP(n,void 0,e)}class VP extends MS{get debugName(){var e;return(e=J7(this._debugName,void 0,this._owner,this))!==null&&e!==void 0?e:"ObservableValue"}constructor(e,t,i){super(),this._owner=e,this._debugName=t,this._value=i}get(){return this._value}set(e,t,i){var s;if(this._value===e)return;let r;t||(t=r=new Doe(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(s=Ku())===null||s===void 0||s.handleObservableChanged(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this.observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function D$e(n,e){return typeof n=="string"?new Vq(void 0,n,e):new Vq(n,void 0,e)}class Vq extends VP{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)===null||e===void 0||e.dispose()}}const $P=(n,e)=>n===e;function Ot(n,e){return e!==void 0?new zP(n,void 0,e,void 0,void 0,void 0,$P):new zP(void 0,void 0,n,void 0,void 0,void 0,$P)}function iC(n,e){let t,i;e===void 0?(t=n,i=void 0):(i=n,t=e);const s=new Ae;return new zP(i,()=>{var r;return(r=mm(t))!==null&&r!==void 0?r:"(anonymous)"},r=>(s.clear(),t(r,s)),void 0,void 0,()=>s.dispose(),$P)}k$e(Ot);class zP extends MS{get debugName(){var e;return(e=J7(this._debugName,this._computeFn,this._owner,this))!==null&&e!==void 0?e:"(anonymous)"}constructor(e,t,i,s,r,o=void 0,a){var l,c;super(),this._owner=e,this._debugName=t,this._computeFn=i,this.createChangeSummary=s,this._handleChange=r,this._handleLastObserverRemoved=o,this._equalityComparator=a,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=(l=this.createChangeSummary)===null||l===void 0?void 0:l.call(this),(c=Ku())===null||c===void 0||c.handleDerivedCreated(this)}onLastObserverRemoved(){var e;this.state=0,this.value=void 0;for(const t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),(e=this._handleLastObserverRemoved)===null||e===void 0||e.call(this)}get(){var e;if(this.observers.size===0){const t=this._computeFn(this,(e=this.createChangeSummary)===null||e===void 0?void 0:e.call(this));return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(const t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){var e,t;if(this.state===3)return;const i=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=i;const s=this.state!==0,r=this.value;this.state=3;const o=this.changeSummary;this.changeSummary=(e=this.createChangeSummary)===null||e===void 0?void 0:e.call(this);try{this.value=this._computeFn(this,o)}finally{for(const l of this.dependenciesToBeRemoved)l.removeObserver(this);this.dependenciesToBeRemoved.clear()}const a=s&&!this._equalityComparator(r,this.value);if((t=Ku())===null||t===void 0||t.handleDerivedRecomputed(this,{oldValue:r,newValue:this.value,change:void 0,didChange:a,hadValue:s}),a)for(const l of this.observers)l.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;const t=this.updateCount===1;if(this.state===3&&(this.state=1,!t))for(const i of this.observers)i.handlePossibleChange(this);if(t)for(const i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}if(this.updateCount<0)throw new mn}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){const i=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:r=>r===e},this.changeSummary):!0,s=this.state===3;if(i&&(this.state===1||s)&&(this.state=2,s))for(const r of this.observers)r.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}function Eoe(n,e){return new mA(n.debugName,e,void 0,void 0)}function Ii(n){return new mA(void 0,n,void 0,void 0)}function pA(n,e){return new mA(n.debugName,e,n.createEmptyChangeSummary,n.handleChange)}function Tr(n){const e=new Ae,t=Eoe({debugName:()=>mm(n)||"(anonymous)"},i=>{e.clear(),n(i,e)});return ut(()=>{t.dispose(),e.dispose()})}class mA{get debugName(){if(typeof this._debugName=="string")return this._debugName;if(typeof this._debugName=="function"){const t=this._debugName();if(t!==void 0)return t}const e=mm(this._runFn);return e!==void 0?e:"(anonymous)"}constructor(e,t,i,s){var r,o;this._debugName=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=s,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=(r=this.createChangeSummary)===null||r===void 0?void 0:r.call(this),(o=Ku())===null||o===void 0||o.handleAutorunCreated(this),this._runIfNeeded()}dispose(){this.disposed=!0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){var e,t,i;if(this.state===3)return;const s=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=s,this.state=3;try{if(!this.disposed){(e=Ku())===null||e===void 0||e.handleAutorunTriggered(this);const r=this.changeSummary;this.changeSummary=(t=this.createChangeSummary)===null||t===void 0?void 0:t.call(this),this._runFn(this,r)}}finally{(i=Ku())===null||i===void 0||i.handleAutorunFinished(this);for(const r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,dy(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}(function(n){n.Observer=mA})(Ii||(Ii={}));function $q(n){return new E$e(n)}class E$e extends Loe{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function T$e(n,e){return new Promise(t=>{let i=!1,s=!1;const r=Ii(o=>{const a=n.read(o);e(a)&&(i?r.dispose():s=!0,t(a))});i=!0,s&&r.dispose()})}function gr(n,e){return new Toe(n,e)}class Toe extends MS{constructor(e,t){super(),this.event=e,this._getValue=t,this.hasValue=!1,this.handleEvent=i=>{var s;const r=this._getValue(i),o=!this.hasValue||this.value!==r;(s=Ku())===null||s===void 0||s.handleFromEventObservableTriggered(this,{oldValue:this.value,newValue:r,change:void 0,didChange:o,hadValue:this.hasValue}),o&&(this.value=r,this.hasValue&&ps(a=>{for(const l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{const a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")}),this.hasValue=!0)}}getDebugName(){return mm(this._getValue)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(n){n.Observer=Toe})(gr||(gr={}));function Ao(n,e){return new A$e(n,e)}class A$e extends MS{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{ps(i=>{for(const s of this.observers)i.updateObserver(s,this),s.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function I$e(n){return typeof n=="string"?new zq(n):new zq(void 0,n)}class zq extends MS{get debugName(){var e;return(e=J7(this._debugName,void 0,this._owner,this))!==null&&e!==void 0?e:"Observable Signal"}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e){ps(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this.observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}function BD(n){const e=new N$e(!0);return n.addObserver(e),n.reportChanges(),ut(()=>{n.removeObserver(e)})}class N$e{constructor(e){this.forceRecompute=e,this.counter=0}beginUpdate(e){this.counter++}endUpdate(e){this.counter--,this.counter===0&&this.forceRecompute&&e.reportChanges()}handlePossibleChange(e){}handleChange(e,t){}}function Aoe(){return!!Cie.VSCODE_DEV}function R$e(n){if(Aoe()){const e=M$e();return e.add(n),{dispose(){e.delete(n)}}}else return{dispose(){}}}function M$e(){n2||(n2=new Set);const n=globalThis;return n.$hotReload_applyNewExports||(n.$hotReload_applyNewExports=e=>{for(const t of n2){const i=t(e);if(i)return i}}),n2}let n2;function F$e(n,e,t,i){if(n.length===0)return e;if(e.length===0)return n;const s=[];let r=0,o=0;for(;r<n.length&&o<e.length;){const a=n[r],l=e[o],c=t(a),u=t(l);c<u?(s.push(a),r++):c>u?(s.push(l),o++):(s.push(i(a,l)),r++,o++)}for(;r<n.length;)s.push(n[r]),r++;for(;o<e.length;)s.push(e[o]),o++;return s}function WD(n,e){const t=new Ae,i=n.createDecorationsCollection();return t.add(Eoe({debugName:()=>`Apply decorations from ${e.debugName}`},s=>{const r=e.read(s);i.set(r)})),t.add({dispose:()=>{i.clear()}}),t}function s2(n,e){return n.appendChild(e),ut(()=>{n.removeChild(e)})}class P$e extends ae{get width(){return this._width}get height(){return this._height}constructor(e,t){super(),this.elementSizeObserver=this._register(new Gne(e,t)),this._width=Ti(this,this.elementSizeObserver.getWidth()),this._height=Ti(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>ps(s=>{this._width.set(this.elementSizeObserver.getWidth(),s),this._height.set(this.elementSizeObserver.getHeight(),s)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function Hq(n,e){let t=n.get(),i=t,s=t;const r=Ti("animatedValue",t);let o=-1;const a=300;let l;e.add(pA({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(u,h)=>(u.didChange(n)&&(h.animate=h.animate||u.change),!0)},(u,h)=>{l!==void 0&&(cancelAnimationFrame(l),l=void 0),i=s,t=n.read(u),o=Date.now()-(h.animate?0:a),c()}));function c(){const u=Date.now()-o;s=Math.floor(O$e(u,i,t-i,a)),u<a?l=requestAnimationFrame(c):s=t,r.set(s,void 0)}return r}function O$e(n,e,t,i){return n===i?e+t:t*(-Math.pow(2,-10*n/i)+1)+e}class Ioe extends ae{constructor(e,t,i){super(),this._register(new _A(e,i)),this._register(Pd(i,{height:t.actualHeight,top:t.actualTop}))}}class VD{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=Ti(this,void 0),this._actualHeight=Ti(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}class _A{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${_A._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}_A._counter=0;function Pd(n,e){return Ii(t=>{for(let[i,s]of Object.entries(e))s&&typeof s=="object"&&"read"in s&&(s=s.read(t)),typeof s=="number"&&(s=`${s}px`),i=i.replace(/[A-Z]/g,r=>"-"+r.toLowerCase()),n.style[i]=s})}function Vh(n,e){return B$e([n],e),n}function B$e(n,e){Aoe()&&Ao("reload",i=>R$e(s=>{if([...Object.values(s)].some(r=>n.includes(r)))return r=>(i(void 0),!0)})).read(e)}function $D(n,e,t){const i=new Ae,s=[];return i.add(Ii(r=>{const o=e.read(r),a=new Map,l=new Map;t&&t(!0),n.changeViewZones(c=>{for(const u of s)c.removeZone(u);s.length=0;for(const u of o){const h=c.addZone(u);s.push(h),a.set(u,h)}}),t&&t(!1),i.add(pA({createEmptyChangeSummary(){return[]},handleChange(c,u){const h=l.get(c.changedObservable);return h!==void 0&&u.push(h),!0}},(c,u)=>{for(const h of o)h.onChange&&(l.set(h.onChange,a.get(h)),h.onChange.read(c));t&&t(!0),n.changeViewZones(h=>{for(const d of u)h.layoutZone(d)}),t&&t(!1)}))})),i.add({dispose(){t&&t(!0),n.changeViewZones(r=>{for(const o of s)r.removeZone(o)}),t&&t(!1)}}),i}class W$e extends Wa{dispose(){super.dispose(!0)}}var e9=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},t9=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},V$e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const $$e=Cn("diff-review-insert",we.add,_("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),z$e=Cn("diff-review-remove",we.remove,_("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),H$e=Cn("diff-review-close",we.close,_("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let md=class extends ae{constructor(e,t,i,s,r,o,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=s,this._width=r,this._height=o,this._diffs=a,this._editors=l,this._instantiationService=c,this.model=iC(this,(u,h)=>{const d=this._visible.read(u);if(this._parentNode.style.visibility=d?"visible":"hidden",!d)return null;const f=h.add(this._instantiationService.createInstance(HP,this._diffs,this._editors,this._setVisible,this._canClose)),g=h.add(this._instantiationService.createInstance(UP,this._parentNode,f,this._width,this._height,this._editors));return{model:f,view:g}}),this._register(BD(this.model))}next(){ps(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this.model.get().model.nextGroup(e)})}prev(){ps(e=>{this._setVisible(!0,e),this.model.get().model.previousGroup(e)})}close(){ps(e=>{this._setVisible(!1,e)})}};md._ttPolicy=rm("diffReview",{createHTML:n=>n});md=e9([t9(8,Wt)],md);let HP=class extends ae{constructor(e,t,i,s,r){super(),this._diffs=e,this._editors=t,this._setVisible=i,this.canClose=s,this._audioCueService=r,this._groups=Ti(this,[]),this._currentGroupIdx=Ti(this,0),this._currentElementIdx=Ti(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((o,a)=>this._groups.read(a)[o]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((o,a)=>{var l;return(l=this.currentGroup.read(a))===null||l===void 0?void 0:l.lines[o]}),this._register(Ii(o=>{const a=this._diffs.read(o);if(!a){this._groups.set([],void 0);return}const l=U$e(a,this._editors.original.getModel().getLineCount(),this._editors.modified.getModel().getLineCount());ps(c=>{const u=this._editors.modified.getPosition();if(u){const h=l.findIndex(d=>(u==null?void 0:u.lineNumber)<d.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(l,c)})})),this._register(Ii(o=>{const a=this.currentElement.read(o);(a==null?void 0:a.type)===Vs.Deleted?this._audioCueService.playAudioCue(Dt.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===Vs.Added&&this._audioCueService.playAudioCue(Dt.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(Ii(o=>{var a;const l=this.currentElement.read(o);if(l&&l.type!==Vs.Header){const c=(a=l.modifiedLineNumber)!==null&&a!==void 0?a:l.diff.modified.startLineNumber;this._editors.modified.setSelection(H.fromPositions(new X(c,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||L$e(t,s=>{this._currentGroupIdx.set(ct.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),s),this._currentElementIdx.set(0,s)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||ps(i=>{this._currentElementIdx.set(ct.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&ps(s=>{this._currentElementIdx.set(i,s)})}revealCurrentElementInEditor(){this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===Vs.Deleted?(this._editors.original.setSelection(H.fromPositions(new X(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==Vs.Header&&(this._editors.modified.setSelection(H.fromPositions(new X(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}close(){this._setVisible(!1,void 0),this._editors.modified.focus()}};HP=e9([t9(4,fA)],HP);const P1=3;function U$e(n,e,t){const i=[];for(const s of Jte(n,(r,o)=>o.modified.startLineNumber-r.modified.endLineNumberExclusive<2*P1)){const r=[];r.push(new q$e);const o=new gt(Math.max(1,s[0].original.startLineNumber-P1),Math.min(s[s.length-1].original.endLineNumberExclusive+P1,e+1)),a=new gt(Math.max(1,s[0].modified.startLineNumber-P1),Math.min(s[s.length-1].modified.endLineNumberExclusive+P1,t+1));eie(s,(u,h)=>{const d=new gt(u?u.original.endLineNumberExclusive:o.startLineNumber,h?h.original.startLineNumber:o.endLineNumberExclusive),f=new gt(u?u.modified.endLineNumberExclusive:a.startLineNumber,h?h.modified.startLineNumber:a.endLineNumberExclusive);d.forEach(g=>{r.push(new Z$e(g,f.startLineNumber+(g-d.startLineNumber)))}),h&&(h.original.forEach(g=>{r.push(new G$e(h,g))}),h.modified.forEach(g=>{r.push(new K$e(h,g))}))});const l=s[0].modified.join(s[s.length-1].modified),c=s[0].original.join(s[s.length-1].original);i.push(new j$e(new Ic(l,c),r))}return i}var Vs;(function(n){n[n.Header=0]="Header",n[n.Unchanged=1]="Unchanged",n[n.Deleted=2]="Deleted",n[n.Added=3]="Added"})(Vs||(Vs={}));class j$e{constructor(e,t){this.range=e,this.lines=t}}class q$e{constructor(){this.type=Vs.Header}}class G$e{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=Vs.Deleted,this.modifiedLineNumber=void 0}}class K$e{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=Vs.Added,this.originalLineNumber=void 0}}class Z$e{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=Vs.Unchanged}}let UP=class extends ae{constructor(e,t,i,s,r,o){super(),this._element=e,this._model=t,this._width=i,this._height=s,this._editors=r,this._languageService=o,this.domNode=this._element,this.domNode.className="diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new Fc(a)),this._register(Ii(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new _o("diffreview.close",_("label.close","Close"),"close-diff-review "+Ye.asClassName(H$e),!0,()=>V$e(this,void 0,void 0,function*(){return t.close()})),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new K8(this._content,{})),qs(this.domNode,this._scrollbar.getDomNode(),a),this._register(ut(()=>{qs(this.domNode)})),this._register(Pd(this.domNode,{width:this._width,height:this._height})),this._register(Pd(this._content,{width:this._width,height:this._height})),this._register(Tr((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(pn(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._editors.original.getOptions(),i=this._editors.modified.getOptions(),s=document.createElement("div");s.className="diff-review-table",s.setAttribute("role","list"),s.setAttribute("aria-label",_("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),fs(s,i.get(50)),qs(this._content,s);const r=this._editors.original.getModel(),o=this._editors.modified.getModel();if(!r||!o)return;const a=r.getOptions(),l=o.getOptions(),c=i.get(66),u=this._model.currentGroup.get();for(const h of(u==null?void 0:u.lines)||[]){if(!u)break;let d;if(h.type===Vs.Header){const g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");const p=u.range,m=this._model.currentGroupIndex.get(),b=this._model.groups.get().length,v=D=>D===0?_("no_lines_changed","no lines changed"):D===1?_("one_line_changed","1 line changed"):_("more_lines_changed","{0} lines changed",D),w=v(p.original.length),y=v(p.modified.length);g.setAttribute("aria-label",_({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",m+1,b,p.original.startLineNumber,w,p.modified.startLineNumber,y));const x=document.createElement("div");x.className="diff-review-cell diff-review-summary",x.appendChild(document.createTextNode(`${m+1}/${b}: @@ -${p.original.startLineNumber},${p.original.length} +${p.modified.startLineNumber},${p.modified.length} @@`)),g.appendChild(x),d=g}else d=this._createRow(h,c,this._width.get(),t,r,a,i,o,l);s.appendChild(d);const f=Ot(g=>this._model.currentElement.read(g)===h);e.add(Ii(g=>{const p=f.read(g);d.tabIndex=p?0:-1,p&&d.focus()})),e.add(oe(d,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,s,r,o,a,l,c){const u=s.get(143),h=u.glyphMarginWidth+u.lineNumbersWidth,d=a.get(143),f=10+d.glyphMarginWidth+d.lineNumbersWidth;let g="diff-review-row",p="";const m="diff-review-spacer";let b=null;switch(e.type){case Vs.Added:g="diff-review-row line-insert",p=" char-insert",b=$$e;break;case Vs.Deleted:g="diff-review-row line-delete",p=" char-delete",b=z$e;break}const v=document.createElement("div");v.style.minWidth=i+"px",v.className=g,v.setAttribute("role","listitem"),v.ariaLevel="";const w=document.createElement("div");w.className="diff-review-cell",w.style.height=`${t}px`,v.appendChild(w);const y=document.createElement("span");y.style.width=h+"px",y.style.minWidth=h+"px",y.className="diff-review-line-number"+p,e.originalLineNumber!==void 0?y.appendChild(document.createTextNode(String(e.originalLineNumber))):y.innerText=" ",w.appendChild(y);const x=document.createElement("span");x.style.width=f+"px",x.style.minWidth=f+"px",x.style.paddingRight="10px",x.className="diff-review-line-number"+p,e.modifiedLineNumber!==void 0?x.appendChild(document.createTextNode(String(e.modifiedLineNumber))):x.innerText=" ",w.appendChild(x);const D=document.createElement("span");if(D.className=m,b){const k=document.createElement("span");k.className=Ye.asClassName(b),k.innerText="  ",D.appendChild(k)}else D.innerText="  ";w.appendChild(D);let S;if(e.modifiedLineNumber!==void 0){let k=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);md._ttPolicy&&(k=md._ttPolicy.createHTML(k)),w.insertAdjacentHTML("beforeend",k),S=l.getLineContent(e.modifiedLineNumber)}else{let k=this._getLineHtml(r,s,o.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);md._ttPolicy&&(k=md._ttPolicy.createHTML(k)),w.insertAdjacentHTML("beforeend",k),S=r.getLineContent(e.originalLineNumber)}S.length===0&&(S=_("blankLine","blank"));let T="";switch(e.type){case Vs.Unchanged:e.originalLineNumber===e.modifiedLineNumber?T=_({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",S,e.originalLineNumber):T=_("equalLine","{0} original line {1} modified line {2}",S,e.originalLineNumber,e.modifiedLineNumber);break;case Vs.Added:T=_("insertLine","+ {0} modified line {1}",S,e.modifiedLineNumber);break;case Vs.Deleted:T=_("deleteLine","- {0} original line {1}",S,e.originalLineNumber);break}return v.setAttribute("aria-label",T),v}_getLineHtml(e,t,i,s,r){const o=e.getLineContent(s),a=t.get(50),l=An.createEmpty(o,r),c=wo.isBasicASCII(o,e.mightContainNonBasicASCII()),u=wo.containsRTL(o,c,e.mightContainRTL());return FT(new Zb(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,o,!1,c,u,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(116),t.get(98),t.get(93),t.get(51)!==Eo.OFF,null)).html}};UP=e9([t9(5,Ji)],UP);const Y$e=Cn("diff-insert",we.add,_("diffInsertIcon","Line decoration for inserts in the diff editor.")),Noe=Cn("diff-remove",we.remove,_("diffRemoveIcon","Line decoration for removals in the diff editor.")),Uq=mt.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Ye.asClassName(Y$e),marginClassName:"gutter-insert"}),jq=mt.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Ye.asClassName(Noe),marginClassName:"gutter-delete"}),qq=mt.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),Gq=mt.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),Kq=mt.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),X$e=mt.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),Q$e=mt.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),jP=mt.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),J$e=mt.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),eze=mt.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),tze=mt.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new pb(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(_("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+Ye.asClassName(we.arrowRight),zIndex:10001});class Od extends ae{constructor(e,t,i,s,r){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=s,this._editors=r,this._originalScrollTop=gr(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=gr(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=Ao("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=Ti(this,0),this._modifiedViewZonesChangedSignal=Ao("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=Ao("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=iC((d,f)=>{var g;this._element.replaceChildren();const p=this._diffModel.read(d),m=(g=p==null?void 0:p.diff.read(d))===null||g===void 0?void 0:g.movedTexts;if(!m||m.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const b=this._originalEditorLayoutInfo.read(d),v=this._modifiedEditorLayoutInfo.read(d);if(!b||!v){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const w=m.map(I=>{function N($e,Ne){const xe=Ne.getTopForLineNumber($e.startLineNumber,!0),fe=Ne.getTopForLineNumber($e.endLineNumberExclusive,!0);return(xe+fe)/2}const z=N(I.lineRangeMapping.original,this._editors.original),$=this._originalScrollTop.read(d),q=N(I.lineRangeMapping.modified,this._editors.modified),ne=this._modifiedScrollTop.read(d),de=z-$,me=q-ne,De=Math.min(z,q),ve=Math.max(z,q);return{range:new ct(De,ve),from:de,to:me,fromWithoutScroll:z,toWithoutScroll:q,move:I}});w.sort(ZEe(Sa(I=>I.fromWithoutScroll>I.toWithoutScroll,YEe),Sa(I=>I.fromWithoutScroll>I.toWithoutScroll?I.fromWithoutScroll:-I.toWithoutScroll,kd)));const y=i9.compute(w.map(I=>I.range)),x=10,D=b.verticalScrollbarWidth,S=(y.getTrackCount()-1)*10+x*2,T=D+S+(v.contentLeft-Od.movedCodeBlockPadding);let k=0;for(const I of w){const N=y.getTrack(k),z=D+x+N*10,$=15,q=15,ne=T,de=v.glyphMarginWidth+v.lineNumbersWidth,me=18,De=document.createElementNS("http://www.w3.org/2000/svg","rect");De.classList.add("arrow-rectangle"),De.setAttribute("x",`${ne-de}`),De.setAttribute("y",`${I.to-me/2}`),De.setAttribute("width",`${de}`),De.setAttribute("height",`${me}`),this._element.appendChild(De);const ve=document.createElementNS("http://www.w3.org/2000/svg","g"),$e=document.createElementNS("http://www.w3.org/2000/svg","path");$e.setAttribute("d",`M 0 ${I.from} L ${z} ${I.from} L ${z} ${I.to} L ${ne-q} ${I.to}`),$e.setAttribute("fill","none"),ve.appendChild($e);const Ne=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ne.classList.add("arrow"),f.add(Ii(xe=>{$e.classList.toggle("currentMove",I.move===p.activeMovedText.read(xe)),Ne.classList.toggle("currentMove",I.move===p.activeMovedText.read(xe))})),Ne.setAttribute("points",`${ne-q},${I.to-$/2} ${ne},${I.to} ${ne-q},${I.to+$/2}`),ve.appendChild(Ne),this._element.appendChild(ve),k++}this.width.set(S,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(ut(()=>this._element.remove())),this._register(Ii(d=>{const f=this._originalEditorLayoutInfo.read(d),g=this._modifiedEditorLayoutInfo.read(d);!f||!g||(this._element.style.left=`${f.width-f.verticalScrollbarWidth}px`,this._element.style.height=`${f.height}px`,this._element.style.width=`${f.verticalScrollbarWidth+f.contentLeft-Od.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(BD(this._state));const o=Ot(d=>{const f=this._diffModel.read(d),g=f==null?void 0:f.diff.read(d);return g?g.movedTexts.map(p=>({move:p,original:new VD($q(p.lineRangeMapping.original.startLineNumber-1),18),modified:new VD($q(p.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register($D(this._editors.original,o.map(d=>d.map(f=>f.original)))),this._register($D(this._editors.modified,o.map(d=>d.map(f=>f.modified)))),this._register(Tr((d,f)=>{const g=o.read(d);for(const p of g)f.add(new Zq(this._editors.original,p.original,p.move,"original",this._diffModel.get())),f.add(new Zq(this._editors.modified,p.modified,p.move,"modified",this._diffModel.get()))}));const a=gr(this._editors.original.onDidChangeCursorPosition,()=>this._editors.original.getPosition()),l=gr(this._editors.modified.onDidChangeCursorPosition,()=>this._editors.modified.getPosition()),c=Ao("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),u=Ao("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let h="modified";this._register(pA({createEmptyChangeSummary:()=>{},handleChange:(d,f)=>(d.didChange(c)&&(h="original"),d.didChange(u)&&(h="modified"),!0)},d=>{c.read(d),u.read(d);const f=this._diffModel.read(d);if(!f)return;const g=f.diff.read(d);let p;if(g&&h==="original"){const m=a.read(d);m&&(p=g.movedTexts.find(b=>b.lineRangeMapping.original.contains(m.lineNumber)))}if(g&&h==="modified"){const m=l.read(d);m&&(p=g.movedTexts.find(b=>b.lineRangeMapping.modified.contains(m.lineNumber)))}p!==f.movedTextToCompare.get()&&f.movedTextToCompare.set(void 0,void 0),f.setActiveMovedText(p)}))}}Od.movedCodeBlockPadding=4;class i9{static compute(e){const t=[],i=[];for(const s of e){let r=t.findIndex(o=>!o.intersectsStrict(s));r===-1&&(t.length>=6?r=mMe(t,Sa(a=>a.intersectWithRangeLength(s),kd)):(r=t.length,t.push(new T8))),t[r].addRange(s),i.push(r)}return new i9(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class Zq extends Ioe{constructor(e,t,i,s,r){const o=Bn("div.diff-hidden-lines-widget");super(e,t,o.root),this._editor=e,this._move=i,this._kind=s,this._diffModel=r,this._nodes=Bn("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Bn("div.text-content@textContent"),Bn("div.action-bar@actionBar")]),o.root.appendChild(this._nodes.root);const a=gr(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Pd(this._nodes.root,{paddingRight:a.map(d=>d.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?_("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):_("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?_("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):_("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new Fc(this._nodes.actionBar,{highlightToggledItems:!0})),u=new _o("",l,"",!1);c.push(u,{icon:!1,label:!0});const h=new _o("","Compare",Ye.asClassName(we.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(Ii(d=>{const f=this._diffModel.movedTextToCompare.read(d)===i;h.checked=f})),c.push(h,{icon:!1,label:!0})}}class ize extends ae{constructor(e,t,i){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=Ot(this,s=>{var r;const o=(r=this._diffModel.read(s))===null||r===void 0?void 0:r.diff.read(s);if(!o)return null;const a=this._diffModel.read(s).movedTextToCompare.read(s),l=this._options.renderIndicators.read(s),c=this._options.showEmptyDecorations.read(s),u=[],h=[];if(!a)for(const f of o.mappings){if(f.lineRangeMapping.original.isEmpty||u.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:l?jq:Gq}),f.lineRangeMapping.modified.isEmpty||h.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:l?Uq:qq}),f.lineRangeMapping.modified.isEmpty||f.lineRangeMapping.original.isEmpty)f.lineRangeMapping.original.isEmpty||u.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:J$e}),f.lineRangeMapping.modified.isEmpty||h.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:X$e});else for(const g of f.lineRangeMapping.innerChanges||[])f.lineRangeMapping.original.contains(g.originalRange.startLineNumber)&&u.push({range:g.originalRange,options:g.originalRange.isEmpty()&&c?eze:jP}),f.lineRangeMapping.modified.contains(g.modifiedRange.startLineNumber)&&h.push({range:g.modifiedRange,options:g.modifiedRange.isEmpty()&&c?Q$e:Kq});!f.lineRangeMapping.modified.isEmpty&&this._options.shouldRenderRevertArrows.read(s)&&!a&&h.push({range:H.fromPositions(new X(f.lineRangeMapping.modified.startLineNumber,1)),options:tze})}if(a)for(const f of a.changes){const g=f.original.toInclusiveRange();g&&u.push({range:g,options:l?jq:Gq});const p=f.modified.toInclusiveRange();p&&h.push({range:p,options:l?Uq:qq});for(const m of f.innerChanges||[])u.push({range:m.originalRange,options:jP}),h.push({range:m.modifiedRange,options:Kq})}const d=this._diffModel.read(s).activeMovedText.read(s);for(const f of o.movedTexts)u.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(f===d?" currentMove":""),blockPadding:[Od.movedCodeBlockPadding,0,Od.movedCodeBlockPadding,Od.movedCodeBlockPadding]}}),h.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(f===d?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:u,modifiedDecorations:h}}),this._register(WD(this._editors.original,this._decorations.map(s=>(s==null?void 0:s.originalDecorations)||[]))),this._register(WD(this._editors.modified,this._decorations.map(s=>(s==null?void 0:s.modifiedDecorations)||[])))}}class nze extends ae{constructor(e,t,i){super(),this._options=e,this._domNode=t,this._dimensions=i,this._sashRatio=Ti(this,void 0),this.sashLeft=Ot(this,s=>{var r;const o=(r=this._sashRatio.read(s))!==null&&r!==void 0?r:this._options.splitViewDefaultRatio.read(s);return this._computeSashLeft(o,s)}),this._sash=this._register(new rs(this._domNode,{getVerticalSashTop:s=>0,getVerticalSashLeft:s=>this.sashLeft.get(),getVerticalSashHeight:s=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(s=>{const r=this._dimensions.width.get(),o=this._computeSashLeft((this._startSashPosition+(s.currentX-s.startX))/r,void 0);this._sashRatio.set(o/r,void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._sashRatio.set(void 0,void 0))),this._register(Ii(s=>{const r=this._options.enableSplitViewResizing.read(s);this._sash.state=r?3:0,this.sashLeft.read(s),this._dimensions.height.read(s),this._sash.layout()}))}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_computeSashLeft(e,t){const i=this._dimensions.width.read(t),s=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),r=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):s,o=100;return i<=o*2?s:r<o?o:r>i-o?i-o:r}}class I0{remove(){var e;(e=this.parent)===null||e===void 0||e.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let s=i;for(let r=0;t.children.get(s)!==void 0;r++)s=`${i}_${r}`;return s}static empty(e){return e.children.size===0}}class Yq extends I0{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class sze extends I0{constructor(e,t,i,s){super(),this.id=e,this.parent=t,this.label=i,this.order=s,this.children=new Map}}class $h extends I0{static create(e,t,i){const s=new Wa(i),r=new $h(t.uri),o=e.ordered(t),a=o.map((c,u)=>{var h;const d=I0.findId(`provider_${u}`,r),f=new sze(d,r,(h=c.displayName)!==null&&h!==void 0?h:"Unknown Outline Provider",u);return Promise.resolve(c.provideDocumentSymbols(t,s.token)).then(g=>{for(const p of g||[])$h._makeOutlineElement(p,f);return f},g=>(oh(g),f)).then(g=>{I0.empty(g)?g.remove():r._groups.set(d,g)})}),l=e.onDidChange(()=>{const c=e.ordered(t);yn(c,o)||s.cancel()});return Promise.all(a).then(()=>s.token.isCancellationRequested&&!i.isCancellationRequested?$h.create(e,t,i):r._compact()).finally(()=>{s.dispose(),l.dispose()})}static _makeOutlineElement(e,t){const i=I0.findId(e,t),s=new Yq(i,t,e);if(e.children)for(const r of e.children)$h._makeOutlineElement(r,s);t.children.set(s.id,s)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=Et.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof Yq?e.push(t.symbol):e.push(...Et.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>H.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return $h._flattenDocumentSymbols(t,e,""),t.sort((i,s)=>X.compare(H.getStartPosition(i.range),H.getStartPosition(s.range))||X.compare(H.getEndPosition(s.range),H.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const s of t)e.push({kind:s.kind,tags:s.tags,name:s.name,detail:s.detail,containerName:s.containerName||i,range:s.range,selectionRange:s.selectionRange,children:void 0}),s.children&&$h._flattenDocumentSymbols(e,s.children,s.name)}}var Roe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Moe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},rze=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let qP=class extends ae{get isUpdatingViewZones(){return this._isUpdatingViewZones}constructor(e,t,i,s){super(),this._editors=e,this._diffModel=t,this._options=i,this._languageFeaturesService=s,this._isUpdatingViewZones=!1,this._modifiedOutlineSource=iC(this,(c,u)=>{const h=this._editors.modifiedModel.read(c);if(h)return u.add(new GP(this._languageFeaturesService,h))}),this._register(this._editors.original.onDidChangeCursorPosition(c=>{if(c.reason===3){const u=this._diffModel.get();ps(h=>{for(const d of this._editors.original.getSelections()||[])u==null||u.ensureOriginalLineIsVisible(d.getStartPosition().lineNumber,h),u==null||u.ensureOriginalLineIsVisible(d.getEndPosition().lineNumber,h)})}})),this._register(this._editors.modified.onDidChangeCursorPosition(c=>{if(c.reason===3){const u=this._diffModel.get();ps(h=>{for(const d of this._editors.modified.getSelections()||[])u==null||u.ensureModifiedLineIsVisible(d.getStartPosition().lineNumber,h),u==null||u.ensureModifiedLineIsVisible(d.getEndPosition().lineNumber,h)})}}));const r=this._diffModel.map((c,u)=>{var h,d;return((h=c==null?void 0:c.diff.read(u))===null||h===void 0?void 0:h.mappings.length)===0?[]:(d=c==null?void 0:c.unchangedRegions.read(u))!==null&&d!==void 0?d:[]}),o=iC(this,(c,u)=>{const h=this._modifiedOutlineSource.read(c);if(!h)return{origViewZones:[],modViewZones:[]};const d=[],f=[],g=this._options.renderSideBySide.read(c),p=r.read(c);for(const m of p)if(!m.shouldHideControls(c)){{const b=Ot(w=>m.getHiddenOriginalRange(w).startLineNumber-1),v=new VD(b,24);d.push(v),u.add(new Xq(this._editors.original,v,m,m.originalUnchangedRange,!g,h,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,void 0),this._options))}{const b=Ot(w=>m.getHiddenModifiedRange(w).startLineNumber-1),v=new VD(b,24);f.push(v),u.add(new Xq(this._editors.modified,v,m,m.modifiedUnchangedRange,!1,h,w=>this._diffModel.get().ensureModifiedLineIsVisible(w,void 0),this._options))}}return{origViewZones:d,modViewZones:f}}),a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new pb(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(_("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Ye.asClassName(we.fold),zIndex:10001};this._register(WD(this._editors.original,Ot(c=>{const u=r.read(c),h=u.map(d=>({range:d.originalUnchangedRange.toInclusiveRange(),options:a}));for(const d of u)d.shouldHideControls(c)&&h.push({range:H.fromPositions(new X(d.originalLineNumber,1)),options:l});return h}))),this._register(WD(this._editors.modified,Ot(c=>{const u=r.read(c),h=u.map(d=>({range:d.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(const d of u)d.shouldHideControls(c)&&h.push({range:gt.ofLength(d.modifiedLineNumber,1).toInclusiveRange(),options:l});return h}))),this._register($D(this._editors.original,o.map(c=>c.origViewZones),c=>this._isUpdatingViewZones=c)),this._register($D(this._editors.modified,o.map(c=>c.modViewZones),c=>this._isUpdatingViewZones=c)),this._register(Ii(c=>{const u=r.read(c);this._editors.original.setHiddenAreas(u.map(h=>h.getHiddenOriginalRange(c).toInclusiveRange()).filter(SL)),this._editors.modified.setHiddenAreas(u.map(h=>h.getHiddenModifiedRange(c).toInclusiveRange()).filter(SL))})),this._register(this._editors.modified.onMouseUp(c=>{var u;if(!c.event.rightButton&&c.target.position&&(!((u=c.target.element)===null||u===void 0)&&u.className.includes("fold-unchanged"))){const h=c.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const f=d.unchangedRegions.get().find(g=>g.modifiedUnchangedRange.includes(h));if(!f)return;f.collapseAll(void 0),c.event.stopPropagation(),c.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(c=>{var u;if(!c.event.rightButton&&c.target.position&&(!((u=c.target.element)===null||u===void 0)&&u.className.includes("fold-unchanged"))){const h=c.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const f=d.unchangedRegions.get().find(g=>g.originalUnchangedRange.includes(h));if(!f)return;f.collapseAll(void 0),c.event.stopPropagation(),c.event.preventDefault()}}))}};qP=Roe([Moe(3,wt)],qP);let GP=class extends ae{constructor(e,t){super(),this._languageFeaturesService=e,this._textModel=t,this._currentModel=Ti(this,void 0);const i=Ao("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),s=Ao("_textModel.onDidChangeContent",Ee.debounce(r=>this._textModel.onDidChangeContent(r),()=>{},100));this._register(Tr((r,o)=>rze(this,void 0,void 0,function*(){i.read(r),s.read(r);const a=o.add(new W$e),l=yield $h.create(this._languageFeaturesService.documentSymbolProvider,this._textModel,a.token);o.isDisposed||this._currentModel.set(l,void 0)})))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const s=i.asListOfDocumentSymbols().filter(r=>e.contains(r.range.startLineNumber)&&!e.contains(r.range.endLineNumber));return s.sort(sie(Sa(r=>r.range.endLineNumber-r.range.startLineNumber,kd))),s.map(r=>({name:r.name,kind:r.kind,startLineNumber:r.range.startLineNumber}))}};GP=Roe([Moe(0,wt)],GP);class Xq extends Ioe{constructor(e,t,i,s,r,o,a,l){const c=Bn("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=s,this.hide=r,this._modifiedOutlineSource=o,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=Bn("div.diff-hidden-lines",[Bn("div.top@top",{title:_("diff.hiddenLines.top","Click or drag to show more above")}),Bn("div.center@content",{style:{display:"flex"}},[Bn("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[Be("a",{title:_("showAll","Show all"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Qg("$(unfold)"))]),Bn("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Bn("div.bottom@bottom",{title:_("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root);const u=gr(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this.hide?qs(this._nodes.first):this._register(Pd(this._nodes.first,{width:u.map(d=>d.contentLeft)}));const h=this._editor;this._register(oe(this._nodes.top,"mousedown",d=>{if(d.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const f=d.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set(!0,void 0);const m=oe(window,"mousemove",v=>{const y=v.clientY-f;g=g||Math.abs(y)>2;const x=Math.round(y/h.getOption(66)),D=Math.max(0,Math.min(p+x,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(D,void 0)}),b=oe(window,"mouseup",v=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(!1,void 0),m.dispose(),b.dispose()})})),this._register(oe(this._nodes.bottom,"mousedown",d=>{if(d.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),d.preventDefault();const f=d.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set(!0,void 0);const m=oe(window,"mousemove",v=>{const y=v.clientY-f;g=g||Math.abs(y)>2;const x=Math.round(y/h.getOption(66)),D=Math.max(0,Math.min(p-x,this._unchangedRegion.getMaxVisibleLineCountBottom())),S=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(D,void 0);const T=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(T-S))}),b=oe(window,"mouseup",v=>{if(this._unchangedRegion.isDragged.set(!1,void 0),!g){const w=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const y=h.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);h.setScrollTop(h.getScrollTop()+(y-w))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),m.dispose(),b.dispose()})})),this._register(Ii(d=>{const f=[];if(!this.hide){const g=i.getHiddenModifiedRange(d).length,p=_("hiddenLines","{0} hidden lines",g),m=Be("span",{title:_("diff.hiddenLines.expandAll","Double click to unfold")},p);m.addEventListener("dblclick",w=>{w.button===0&&(w.preventDefault(),this._unchangedRegion.showAll(void 0))}),f.push(m);const b=this._unchangedRegion.getHiddenModifiedRange(d),v=this._modifiedOutlineSource.getBreadcrumbItems(b,d);if(v.length>0){f.push(Be("span",void 0,"  |  "));for(let w=0;w<v.length;w++){const y=v[w],x=K4.toIcon(y.kind),D=Bn("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[ZF(x)," ",y.name,...w===v.length-1?[]:[ZF(we.chevronRight)]]).root;f.push(D),D.onclick=()=>{this._revealModifiedHiddenLine(y.startLineNumber)}}}}qs(this._nodes.others,...f)}))}}class nC{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new nC(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const s=e.getVisibleRanges();if(s.length>0){t=s[0].getStartPosition();const r=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-r}return new nC(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,s,r){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=s,this._cursorPosition=r}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i)}}var oze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Qq=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},aze=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},Jf;let zD=Jf=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new G,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)===null||e===void 0||e.dispose()}computeDiff(e,t,i,s){var r,o;return aze(this,void 0,void 0,function*(){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,s);if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Ho(new gt(1,2),new gt(1,t.getLineCount()+1),[new sf(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const a=JSON.stringify([e.uri.toString(),t.uri.toString()]),l=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),c=Jf.diffCache.get(a);if(c&&c.context===l)return c.result;const u=wf.create(),h=yield this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=u.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:(r=h==null?void 0:h.quitEarly)!==null&&r!==void 0?r:!0,detectedMoves:i.computeMoves?(o=h==null?void 0:h.moves.length)!==null&&o!==void 0?o:0:-1}),s.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!h)throw new Error("no diff result available");return Jf.diffCache.size>10&&Jf.diffCache.delete(Jf.diffCache.keys().next().value),Jf.diffCache.set(a,{result:h,context:l}),h})}setOptions(e){var t;let i=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((t=this.diffAlgorithmOnDidChangeSubscription)===null||t===void 0||t.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),i=!0),i&&this.onDidChangeEventEmitter.fire()}};zD.diffCache=new Map;zD=Jf=oze([Qq(1,DS),Qq(2,ah)],zD);var lze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},cze=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const Foe=kt("diffProviderFactoryService");let KP=class{constructor(e){this.instantiationService=e}createDiffProvider(e,t){return this.instantiationService.createInstance(zD,t)}};KP=lze([cze(0,Wt)],KP);At(Foe,KP,1);var uze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},hze=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Jq=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let ZP=class extends ae{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i,s){super(),this.model=e,this._options=t,this._editor=i,this._diffProviderFactoryService=s,this._isDiffUpToDate=Ti(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=Ti(this,void 0),this.diff=this._diff,this._unchangedRegions=Ti(this,{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),this.unchangedRegions=Ot(this,l=>this._options.hideUnchangedRegions.read(l)?this._unchangedRegions.read(l).regions:(ps(c=>{for(const u of this._unchangedRegions.get().regions)u.collapseAll(c)}),[])),this.movedTextToCompare=Ti(this,void 0),this._activeMovedText=Ti(this,void 0),this._hoveredMovedText=Ti(this,void 0),this.activeMovedText=Ot(this,l=>{var c,u;return(u=(c=this.movedTextToCompare.read(l))!==null&&c!==void 0?c:this._hoveredMovedText.read(l))!==null&&u!==void 0?u:this._activeMovedText.read(l)}),this._cancellationTokenSource=new Wa,this._diffProvider=Ot(this,l=>{const c=this._diffProviderFactoryService.createDiffProvider(this._editor,{diffAlgorithm:this._options.diffAlgorithm.read(l)}),u=Ao("onDidChange",c.onDidChange);return{diffProvider:c,onChangeSignal:u}}),this._register(ut(()=>this._cancellationTokenSource.cancel()));const r=I$e("contentChangedSignal"),o=this._register(new Ui(()=>r.trigger(void 0),200)),a=(l,c,u)=>{const h=HD.fromDiffs(l.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(u),this._options.hideUnchangedRegionsContextLineCount.read(u)),d=this._unchangedRegions.get(),f=d.originalDecorationIds.map(b=>e.original.getDecorationRange(b)).filter(b=>!!b).map(b=>gt.fromRange(b)),g=d.modifiedDecorationIds.map(b=>e.modified.getDecorationRange(b)).filter(b=>!!b).map(b=>gt.fromRange(b)),p=e.original.deltaDecorations(d.originalDecorationIds,h.map(b=>({range:b.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(d.modifiedDecorationIds,h.map(b=>({range:b.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));for(const b of h)for(let v=0;v<d.regions.length;v++)if(b.originalUnchangedRange.intersectsStrict(f[v])&&b.modifiedUnchangedRange.intersectsStrict(g[v])){b.setHiddenModifiedRange(d.regions[v].getHiddenModifiedRange(void 0),c);break}this._unchangedRegions.set({regions:h,originalDecorationIds:p,modifiedDecorationIds:m},c)};this._register(e.modified.onDidChangeContent(l=>{if(this._diff.get()){const u=Hu.fromModelContentChanges(l.changes);this._lastDiff,e.original,e.modified}o.schedule()})),this._register(e.original.onDidChangeContent(l=>{if(this._diff.get()){const u=Hu.fromModelContentChanges(l.changes);this._lastDiff,e.original,e.modified}o.schedule()})),this._register(Tr((l,c)=>Jq(this,void 0,void 0,function*(){var u,h;this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),o.cancel(),r.read(l);const d=this._diffProvider.read(l);d.onChangeSignal.read(l),Vh(Fne,l),Vh(iF,l),this._isDiffUpToDate.set(!1,void 0);let f=[];c.add(e.original.onDidChangeContent(m=>{const b=Hu.fromModelContentChanges(m.changes);f=oD(f,b)}));let g=[];c.add(e.modified.onDidChangeContent(m=>{const b=Hu.fromModelContentChanges(m.changes);g=oD(g,b)}));let p=yield d.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||(p=dze(p,e.original,e.modified),p=(u=(e.original,e.modified,void 0))!==null&&u!==void 0?u:p,p=(h=(e.original,e.modified,void 0))!==null&&h!==void 0?h:p,ps(m=>{a(p,m),this._lastDiff=p;const b=n9.fromDiffResult(p);this._diff.set(b,m),this._isDiffUpToDate.set(!0,m);const v=this.movedTextToCompare.get();this.movedTextToCompare.set(v?this._lastDiff.moves.find(w=>w.lineRangeMapping.modified.intersect(v.lineRangeMapping.modified)):void 0,m)}))})))}ensureModifiedLineIsVisible(e,t){var i;if(((i=this.diff.get())===null||i===void 0?void 0:i.mappings.length)===0)return;const s=this._unchangedRegions.get().regions;for(const r of s)if(r.getHiddenModifiedRange(void 0).contains(e)){r.showModifiedLine(e,t);return}}ensureOriginalLineIsVisible(e,t){var i;if(((i=this.diff.get())===null||i===void 0?void 0:i.mappings.length)===0)return;const s=this._unchangedRegions.get().regions;for(const r of s)if(r.getHiddenOriginalRange(void 0).contains(e)){r.showOriginalLine(e,t);return}}waitForDiff(){return Jq(this,void 0,void 0,function*(){yield T$e(this.isDiffUpToDate,e=>e)})}serializeState(){return{collapsedRegions:this._unchangedRegions.get().regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){const t=e.collapsedRegions.map(s=>gt.deserialize(s.range)),i=this._unchangedRegions.get();ps(s=>{for(const r of i.regions)for(const o of t)if(r.modifiedUnchangedRange.intersect(o)){r.setHiddenModifiedRange(o,s);break}})}};ZP=uze([hze(3,Foe)],ZP);function dze(n,e,t){return{changes:n.changes.map(i=>new Ho(i.original,i.modified,i.innerChanges?i.innerChanges.map(s=>fze(s,e,t)):void 0)),moves:n.moves,identical:n.identical,quitEarly:n.quitEarly}}function fze(n,e,t){let i=n.originalRange,s=n.modifiedRange;return(i.endColumn!==1||s.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&s.endColumn===t.getLineMaxColumn(s.endLineNumber)&&i.endLineNumber<e.getLineCount()&&s.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),s=s.setEndPosition(s.endLineNumber+1,1)),new sf(i,s)}class n9{static fromDiffResult(e){return new n9(e.changes.map(t=>new Poe(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,s){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=s}}class Poe{constructor(e){this.lineRangeMapping=e}}class HD{static fromDiffs(e,t,i,s,r){const o=Ho.inverse(e,t,i),a=[];for(const l of o){let c=l.original.startLineNumber,u=l.modified.startLineNumber,h=l.original.length;const d=c===1&&u===1,f=c+h===t+1&&u+h===i+1;(d||f)&&h>=r+s?(d&&!f&&(h-=r),f&&!d&&(c+=r,u+=r,h-=r),a.push(new HD(c,u,h,0,0))):h>=r*2+s&&(c+=r,u+=r,h-=r*2,a.push(new HD(c,u,h,0,0)))}return a}get originalUnchangedRange(){return gt.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return gt.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,s,r){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=Ti(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=Ti(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=Ot(this,o=>this.visibleLineCountTop.read(o)+this.visibleLineCountBottom.read(o)===this.lineCount&&!this.isDragged.read(o)),this.isDragged=Ti(this,!1),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(r,void 0)}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return gt.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return gt.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,s=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,s,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t){const i=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),s=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;i<s?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+i,t):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+s,t)}showOriginalLine(e,t){const i=e-this.originalLineNumber,s=this.originalLineNumber+this.lineCount-e;i<s?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+s-i,this.getMaxVisibleLineCountTop()),t):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+i-s,this.getMaxVisibleLineCountBottom()),t)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}var HR=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class gze extends ae{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,s,r,o,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=s,this._editor=r,this._viewLineCounts=o,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ye.asClassName(we.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const u=this._modifiedEditor.getOption(66);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${u}px`,this._diffActions.style.lineHeight=`${u}px`,this._marginDomNode.appendChild(this._diffActions);let h=0;const d=i.getOption(126)&&!Qd,f=(g,p)=>{var m;this._contextMenuService.showContextMenu({domForShadowRoot:d&&(m=i.getDomNode())!==null&&m!==void 0?m:void 0,getAnchor:()=>({x:g,y:p}),getActions:()=>{const b=[],v=s.modified.isEmpty;return b.push(new _o("diff.clipboard.copyDeletedContent",v?s.original.length>1?_("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):_("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):s.original.length>1?_("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):_("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,()=>HR(this,void 0,void 0,function*(){const y=this._originalTextModel.getValueInRange(s.original.toExclusiveRange());yield this._clipboardService.writeText(y)}))),s.original.length>1&&b.push(new _o("diff.clipboard.copyDeletedLineContent",v?_("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",s.original.startLineNumber+h):_("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",s.original.startLineNumber+h),void 0,!0,()=>HR(this,void 0,void 0,function*(){let y=this._originalTextModel.getLineContent(s.original.startLineNumber+h);y===""&&(y=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),yield this._clipboardService.writeText(y)}))),i.getOption(90)||b.push(new _o("diff.inline.revertChange",_("diff.inline.revertChange.label","Revert this change"),void 0,!0,()=>HR(this,void 0,void 0,function*(){this._editor.revert(this._diff)}))),b},autoSelectFirstItem:!0})};this._register(pn(this._diffActions,"mousedown",g=>{const{top:p,height:m}=hs(this._diffActions),b=Math.floor(u/3);g.preventDefault(),f(g.posx,p+m+b)})),this._register(i.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(g=>{g.event.rightButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,u),f(g.event.posx,g.event.posy+u))}))}_updateLightBulbPosition(e,t,i){const{top:s}=hs(e),r=t-s,o=Math.floor(r/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],o<l)return c}return o}}const eG=rm("diffEditorWidget",{createHTML:n=>n});function pze(n,e,t,i){fs(i,e.fontInfo);const s=t.length>0,r=new ET(1e4);let o=0,a=0;const l=[];for(let d=0;d<n.lineTokens.length;d++){const f=d+1,g=n.lineTokens[d],p=n.lineBreakData[d],m=va.filter(t,f,1,Number.MAX_SAFE_INTEGER);if(p){let b=0;for(const v of p.breakOffsets){const w=g.sliceAndInflate(b,v,0);o=Math.max(o,tG(a,w,va.extractWrapped(m,b,v),s,n.mightContainNonBasicASCII,n.mightContainRTL,e,r)),a++,b=v}l.push(p.breakOffsets.length)}else l.push(1),o=Math.max(o,tG(a,g,m,s,n.mightContainNonBasicASCII,n.mightContainRTL,e,r)),a++}o+=e.scrollBeyondLastColumn;const c=r.build(),u=eG?eG.createHTML(c):c;i.innerHTML=u;const h=o*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:h,viewLineCounts:l}}class mze{constructor(e,t,i,s){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=s}}class s9{static fromEditor(e){var t;const i=e.getOptions(),s=i.get(50),r=i.get(143);return new s9(((t=e.getModel())===null||t===void 0?void 0:t.getOptions().tabSize)||0,s,i.get(33),s.typicalHalfwidthCharacterWidth,i.get(103),i.get(66),r.decorationsWidth,i.get(116),i.get(98),i.get(93),i.get(51))}constructor(e,t,i,s,r,o,a,l,c,u,h){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=s,this.scrollBeyondLastColumn=r,this.lineHeight=o,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=u,this.fontLigatures=h}}function tG(n,e,t,i,s,r,o,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(n*o.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=wo.isBasicASCII(l,s),u=wo.containsRTL(l,c,r),h=M8(new Zb(o.fontInfo.isMonospace&&!o.disableMonospaceOptimizations,o.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,u,0,e,t,o.tabSize,0,o.fontInfo.spaceWidth,o.fontInfo.middotWidth,o.fontInfo.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==Eo.OFF,null),a);return a.appendString("</div>"),h.characterMapping.getHorizontalOffset(h.characterMapping.length)}var _ze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},iG=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let YP=class extends ae{constructor(e,t,i,s,r,o,a){super(),this._editors=e,this._diffModel=t,this._options=i,this._diffEditorWidget=s,this._canIgnoreViewZoneUpdateEvent=r,this._clipboardService=o,this._contextMenuService=a,this._originalTopPadding=Ti(this,0),this._originalScrollOffset=Ti(this,0),this._originalScrollOffsetAnimated=Hq(this._originalScrollOffset,this._store),this._modifiedTopPadding=Ti(this,0),this._modifiedScrollOffset=Ti(this,0),this._modifiedScrollOffsetAnimated=Hq(this._modifiedScrollOffset,this._store);let l=!1;const c=Ti("state",0),u=this._register(new Ui(()=>{c.set(c.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(y=>{!l&&!this._canIgnoreViewZoneUpdateEvent()&&u.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(y=>{!l&&!this._canIgnoreViewZoneUpdateEvent()&&u.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(y=>{(y.hasChanged(144)||y.hasChanged(66))&&u.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(y=>{(y.hasChanged(144)||y.hasChanged(66))&&u.schedule()}));const h=this._diffModel.map(y=>y?gr(y.model.original.onDidChangeTokens,()=>y.model.original.tokenization.backgroundTokenizationState===2):void 0).map((y,x)=>y==null?void 0:y.read(x)),d=new Set,f=new Set,g=Ot(y=>{const x=this._diffModel.read(y),D=x==null?void 0:x.diff.read(y);if(!x||!D)return null;c.read(y);const T=this._options.renderSideBySide.read(y);return nG(this._editors.original,this._editors.modified,D.mappings,d,f,T)}),p=Ot(y=>{var x;const D=(x=this._diffModel.read(y))===null||x===void 0?void 0:x.movedTextToCompare.read(y);if(!D)return null;c.read(y);const S=D.changes.map(T=>new Poe(T));return nG(this._editors.original,this._editors.modified,S,d,f,!0)});function m(){const y=document.createElement("div");return y.className="diagonal-fill",y}const b=this._register(new Ae),v=Ot(y=>{var x,D,S,T,k,I,N,z;b.clear();const $=g.read(y)||[],q=[],ne=[],de=this._modifiedTopPadding.read(y);de>0&&ne.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:de,showInHiddenAreas:!0,suppressMouseDown:!0});const me=this._originalTopPadding.read(y);me>0&&q.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:me,showInHiddenAreas:!0,suppressMouseDown:!0});const De=this._options.renderSideBySide.read(y),ve=De||(x=this._editors.modified._getViewModel())===null||x===void 0?void 0:x.createLineBreaksComputer();if(ve){for(const te of $)if(te.diff)for(let ye=te.originalRange.startLineNumber;ye<te.originalRange.endLineNumberExclusive;ye++)ve==null||ve.addRequest(this._editors.original.getModel().getLineContent(ye),null,null)}const $e=(D=ve==null?void 0:ve.finalize())!==null&&D!==void 0?D:[];let Ne=0;const xe=this._editors.modified.getOption(66),fe=(S=this._diffModel.read(y))===null||S===void 0?void 0:S.movedTextToCompare.read(y),jt=(k=(T=this._editors.original.getModel())===null||T===void 0?void 0:T.mightContainNonBasicASCII())!==null&&k!==void 0?k:!1,mi=(N=(I=this._editors.original.getModel())===null||I===void 0?void 0:I.mightContainRTL())!==null&&N!==void 0?N:!1,re=s9.fromEditor(this._editors.modified);for(const te of $)if(te.diff&&!De){if(!te.originalRange.isEmpty){h.read(y);const _e=document.createElement("div");_e.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const Ie=new mze(te.originalRange.mapToLineArray(et=>this._editors.original.getModel().tokenization.getLineTokens(et)),te.originalRange.mapToLineArray(et=>$e[Ne++]),jt,mi),F=[];for(const et of te.diff.innerChanges||[])F.push(new qv(et.originalRange.delta(-(te.diff.original.startLineNumber-1)),jP.className,0));const M=pze(Ie,re,F,_e),pe=document.createElement("div");if(pe.className="inline-deleted-margin-view-zone",fs(pe,re.fontInfo),this._options.renderIndicators.read(y))for(let et=0;et<M.heightInLines;et++){const Xe=document.createElement("div");Xe.className=`delete-sign ${Ye.asClassName(Noe)}`,Xe.setAttribute("style",`position:absolute;top:${et*xe}px;width:${re.lineDecorationsWidth}px;height:${xe}px;right:0;`),pe.appendChild(Xe)}let ke;b.add(new gze(()=>B4(ke),pe,this._editors.modified,te.diff,this._diffEditorWidget,M.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let et=0;et<M.viewLineCounts.length;et++){const Xe=M.viewLineCounts[et];Xe>1&&q.push({afterLineNumber:te.originalRange.startLineNumber+et,domNode:m(),heightInPx:(Xe-1)*xe,showInHiddenAreas:!0,suppressMouseDown:!0})}ne.push({afterLineNumber:te.modifiedRange.startLineNumber-1,domNode:_e,heightInPx:M.heightInLines*xe,minWidthInPx:M.minWidthInPx,marginDomNode:pe,setZoneId(et){ke=et},showInHiddenAreas:!0,suppressMouseDown:!0})}const ye=document.createElement("div");ye.className="gutter-delete",q.push({afterLineNumber:te.originalRange.endLineNumberExclusive-1,domNode:m(),heightInPx:te.modifiedHeightInPx,marginDomNode:ye,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const ye=te.modifiedHeightInPx-te.originalHeightInPx;if(ye>0){if(fe!=null&&fe.lineRangeMapping.original.delta(-1).deltaLength(2).contains(te.originalRange.endLineNumberExclusive-1))continue;q.push({afterLineNumber:te.originalRange.endLineNumberExclusive-1,domNode:m(),heightInPx:ye,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let _e=function(){const F=document.createElement("div");return F.className="arrow-revert-change "+Ye.asClassName(we.arrowRight),Be("div",{},F)};if(fe!=null&&fe.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(te.modifiedRange.endLineNumberExclusive-1))continue;let Ie;te.diff&&te.diff.modified.isEmpty&&this._options.shouldRenderRevertArrows.read(y)&&(Ie=_e()),ne.push({afterLineNumber:te.modifiedRange.endLineNumberExclusive-1,domNode:m(),heightInPx:-ye,marginDomNode:Ie,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const te of(z=p.read(y))!==null&&z!==void 0?z:[]){if(!(fe!=null&&fe.lineRangeMapping.original.intersect(te.originalRange))||!(fe!=null&&fe.lineRangeMapping.modified.intersect(te.modifiedRange)))continue;const ye=te.modifiedHeightInPx-te.originalHeightInPx;ye>0?q.push({afterLineNumber:te.originalRange.endLineNumberExclusive-1,domNode:m(),heightInPx:ye,showInHiddenAreas:!0,suppressMouseDown:!0}):ne.push({afterLineNumber:te.modifiedRange.endLineNumberExclusive-1,domNode:m(),heightInPx:-ye,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:q,mod:ne}});this._register(Tr(y=>{const x=nC.capture(this._editors.modified),D=v.read(y);l=!0,this._editors.original.changeViewZones(S=>{for(const T of d)S.removeZone(T);d.clear();for(const T of D.orig){const k=S.addZone(T);T.setZoneId&&T.setZoneId(k),d.add(k)}}),this._editors.modified.changeViewZones(S=>{for(const T of f)S.removeZone(T);f.clear();for(const T of D.mod){const k=S.addZone(T);T.setZoneId&&T.setZoneId(k),f.add(k)}}),l=!1,x.restore(this._editors.modified)})),this._register(ut(()=>{this._editors.original.changeViewZones(y=>{for(const x of d)y.removeZone(x);d.clear()}),this._editors.modified.changeViewZones(y=>{for(const x of f)y.removeZone(x);f.clear()})}));let w=!1;this._register(this._editors.original.onDidScrollChange(y=>{y.scrollLeftChanged&&!w&&(w=!0,this._editors.modified.setScrollLeft(y.scrollLeft),w=!1)})),this._register(this._editors.modified.onDidScrollChange(y=>{y.scrollLeftChanged&&!w&&(w=!0,this._editors.original.setScrollLeft(y.scrollLeft),w=!1)})),this._originalScrollTop=gr(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=gr(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(Ii(y=>{const x=this._originalScrollTop.read(y)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(y))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(y));x!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(x,1)})),this._register(Ii(y=>{const x=this._modifiedScrollTop.read(y)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(y))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(y));x!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(x,1)})),this._register(Ii(y=>{var x;const D=(x=this._diffModel.read(y))===null||x===void 0?void 0:x.movedTextToCompare.read(y);let S=0;if(D){const T=this._editors.original.getTopForLineNumber(D.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();S=this._editors.modified.getTopForLineNumber(D.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-T}S>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(S,void 0)):S<0?(this._modifiedTopPadding.set(-S,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-S,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+S,void 0,!0)}))}};YP=_ze([iG(5,RS),iG(6,Tf)],YP);function nG(n,e,t,i,s,r){const o=new th(sG(n,i)),a=new th(sG(e,s)),l=n.getOption(66),c=e.getOption(66),u=[];let h=0,d=0;function f(g,p){for(;;){let m=o.peek(),b=a.peek();if(m&&m.lineNumber>=g&&(m=void 0),b&&b.lineNumber>=p&&(b=void 0),!m&&!b)break;const v=m?m.lineNumber-h:Number.MAX_VALUE,w=b?b.lineNumber-d:Number.MAX_VALUE;v<w?(o.dequeue(),b={lineNumber:m.lineNumber-h+d,heightInPx:0}):v>w?(a.dequeue(),m={lineNumber:b.lineNumber-d+h,heightInPx:0}):(o.dequeue(),a.dequeue()),u.push({originalRange:gt.ofLength(m.lineNumber,1),modifiedRange:gt.ofLength(b.lineNumber,1),originalHeightInPx:l+m.heightInPx,modifiedHeightInPx:c+b.heightInPx,diff:void 0})}}for(const g of t){let w=function(y,x){var D,S,T,k;if(y<v||x<b)return;if(m)m=!1;else if(y===v||x===b)return;const I=new gt(v,y),N=new gt(b,x);if(I.isEmpty&&N.isEmpty)return;const z=(S=(D=o.takeWhile(q=>q.lineNumber<y))===null||D===void 0?void 0:D.reduce((q,ne)=>q+ne.heightInPx,0))!==null&&S!==void 0?S:0,$=(k=(T=a.takeWhile(q=>q.lineNumber<x))===null||T===void 0?void 0:T.reduce((q,ne)=>q+ne.heightInPx,0))!==null&&k!==void 0?k:0;u.push({originalRange:I,modifiedRange:N,originalHeightInPx:I.length*l+z,modifiedHeightInPx:N.length*c+$,diff:g.lineRangeMapping}),v=y,b=x};const p=g.lineRangeMapping;f(p.original.startLineNumber,p.modified.startLineNumber);let m=!0,b=p.modified.startLineNumber,v=p.original.startLineNumber;if(r)for(const y of p.innerChanges||[])y.originalRange.startColumn>1&&y.modifiedRange.startColumn>1&&w(y.originalRange.startLineNumber,y.modifiedRange.startLineNumber),y.originalRange.endColumn<n.getModel().getLineMaxColumn(y.originalRange.endLineNumber)&&w(y.originalRange.endLineNumber,y.modifiedRange.endLineNumber);w(p.original.endLineNumberExclusive,p.modified.endLineNumberExclusive),h=p.original.endLineNumberExclusive,d=p.modified.endLineNumberExclusive}return f(Number.MAX_VALUE,Number.MAX_VALUE),u}function sG(n,e){const t=[],i=[],s=n.getOption(144).wrappingColumn!==-1,r=n._getViewModel().coordinatesConverter,o=n.getOption(66);if(s)for(let l=1;l<=n.getModel().getLineCount();l++){const c=r.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:o*(c-1)})}for(const l of n.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:r.convertViewPositionToModelPosition(new X(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return F$e(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}var bze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},vze=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},el;let Zu=el=class extends ae{constructor(e,t,i,s,r,o,a,l){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=s,this._rootHeight=r,this._modifiedEditorLayoutInfo=o,this._options=a,this._themeService=l;const c=gr(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),u=Ot(f=>{const g=c.read(f),p=g.getColor(E3e)||(g.getColor(L3e)||uF).transparent(2),m=g.getColor(T3e)||(g.getColor(D3e)||hF).transparent(2);return{insertColor:p,removeColor:m}}),h=gr(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),d=gr(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollHeight());this._register(Tr((f,g)=>{if(!this._options.renderOverviewRuler.read(f))return;const p=Bt(document.createElement("div"));p.setClassName("diffViewport"),p.setPosition("absolute");const m=Bn("div.diffOverview",{style:{position:"absolute",top:"0px",width:el.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;g.add(s2(m,p.domNode)),g.add(pn(m,Le.POINTER_DOWN,b=>{this._editors.modified.delegateVerticalScrollbarPointerDown(b)})),g.add(oe(m,Le.MOUSE_WHEEL,b=>{this._editors.modified.delegateScrollFromMouseWheelEvent(b)},{passive:!1})),g.add(s2(this._rootElement,m)),g.add(Tr((b,v)=>{const w=this._diffModel.read(b),y=this._editors.original.createOverviewRuler("original diffOverviewRuler");y&&(v.add(y),v.add(s2(m,y.getDomNode())));const x=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(x&&(v.add(x),v.add(s2(m,x.getDomNode()))),!y||!x)return;const D=Ao("viewZoneChanged",this._editors.original.onDidChangeViewZones),S=Ao("viewZoneChanged",this._editors.modified.onDidChangeViewZones),T=Ao("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),k=Ao("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);v.add(Ii(I=>{var N;D.read(I),S.read(I),T.read(I),k.read(I);const z=u.read(I),$=(N=w==null?void 0:w.diff.read(I))===null||N===void 0?void 0:N.mappings;function q(me,De,ve){const $e=ve._getViewModel();return $e?me.filter(Ne=>Ne.length>0).map(Ne=>{const xe=$e.coordinatesConverter.convertModelPositionToViewPosition(new X(Ne.startLineNumber,1)),fe=$e.coordinatesConverter.convertModelPositionToViewPosition(new X(Ne.endLineNumberExclusive,1)),jt=fe.lineNumber-xe.lineNumber;return new Ise(xe.lineNumber,fe.lineNumber,jt,De.toString())}):[]}const ne=q(($||[]).map(me=>me.lineRangeMapping.original),z.removeColor,this._editors.original),de=q(($||[]).map(me=>me.lineRangeMapping.modified),z.insertColor,this._editors.modified);y==null||y.setZones(ne),x==null||x.setZones(de)})),v.add(Ii(I=>{const N=this._rootHeight.read(I),z=this._rootWidth.read(I),$=this._modifiedEditorLayoutInfo.read(I);if($){const q=el.ENTIRE_DIFF_OVERVIEW_WIDTH-2*el.ONE_OVERVIEW_WIDTH;y.setLayout({top:0,height:N,right:q+el.ONE_OVERVIEW_WIDTH,width:el.ONE_OVERVIEW_WIDTH}),x.setLayout({top:0,height:N,right:0,width:el.ONE_OVERVIEW_WIDTH});const ne=h.read(I),de=d.read(I),me=this._editors.modified.getOption(102),De=new cb(me.verticalHasArrows?me.arrowSize:0,me.verticalScrollbarSize,0,$.height,de,ne);p.setTop(De.getSliderPosition()),p.setHeight(De.getSliderSize())}else p.setTop(0),p.setHeight(0);m.style.height=N+"px",m.style.left=z-el.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",p.setWidth(el.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}))}};Zu.ONE_OVERVIEW_WIDTH=15;Zu.ENTIRE_DIFF_OVERVIEW_WIDTH=el.ONE_OVERVIEW_WIDTH*2;Zu=el=bze([vze(7,qr)],Zu);P("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},_("diffEditor.move.border","The border color for text that got moved in the diff editor."));P("diffEditor.moveActive.border",{dark:"#FFA500",light:"#FFA500",hcDark:"#FFA500",hcLight:"#FFA500"},_("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));class bA extends ae{constructor(){super(...arguments),this._id=++bA.idCounter,this._onDidDispose=this._register(new G),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,s=!0){this._targetEditor.revealRange(e,t,i,s)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}bA.idCounter=0;var wze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},rG=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let XP=class extends ae{constructor(e,t,i,s,r,o,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._createInnerEditor=r,this._instantiationService=o,this._keybindingService=a,this._onDidContentSizeChange=this._register(new G),this.original=this._register(this._createLeftHandSideEditor(i.editorOptions.get(),s.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(i.editorOptions.get(),s.modifiedEditor||{})),this.modifiedModel=gr(this.modified.onDidChangeModel,()=>this.modified.getModel()),this._register(pA({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return s.setContextValue("isInDiffLeftEditor",!0),s}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return s.setContextValue("isInDiffRightEditor",!0),s}_constructInnerEditor(e,t,i,s){const r=this._createInnerEditor(e,t,i,s);return this._register(r.onDidContentSizeChange(o=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+Zu.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:o.contentHeightChanged,contentWidthChanged:o.contentWidthChanged})})),r}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Xp.revealHorizontalRightPadding.defaultValue+Zu.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var t;e||(e="");const i=_("diff-aria-navigation-tip"," use {0} to open the accessibility help.",(t=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))===null||t===void 0?void 0:t.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};XP=wze([rG(5,Wt),rG(6,Oi)],XP);class yze{get editorOptions(){return this._options}constructor(e,t){this.diffEditorWidth=t,this.couldShowInlineViewBecauseOfSize=Ot(this,s=>this._options.read(s).renderSideBySide&&this.diffEditorWidth.read(s)<=this._options.read(s).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=Ot(this,s=>this._options.read(s).renderOverviewRuler),this.renderSideBySide=Ot(this,s=>this._options.read(s).renderSideBySide&&!(this._options.read(s).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(s))),this.readOnly=Ot(this,s=>this._options.read(s).readOnly),this.shouldRenderRevertArrows=Ot(this,s=>!(!this._options.read(s).renderMarginRevertIcon||!this.renderSideBySide.read(s)||this.readOnly.read(s))),this.renderIndicators=Ot(this,s=>this._options.read(s).renderIndicators),this.enableSplitViewResizing=Ot(this,s=>this._options.read(s).enableSplitViewResizing),this.splitViewDefaultRatio=Ot(this,s=>this._options.read(s).splitViewDefaultRatio),this.ignoreTrimWhitespace=Ot(this,s=>this._options.read(s).ignoreTrimWhitespace),this.maxComputationTimeMs=Ot(this,s=>this._options.read(s).maxComputationTime),this.showMoves=Ot(this,s=>this._options.read(s).experimental.showMoves&&this.renderSideBySide.read(s)),this.isInEmbeddedEditor=Ot(this,s=>this._options.read(s).isInEmbeddedEditor),this.diffWordWrap=Ot(this,s=>this._options.read(s).diffWordWrap),this.originalEditable=Ot(this,s=>this._options.read(s).originalEditable),this.diffCodeLens=Ot(this,s=>this._options.read(s).diffCodeLens),this.accessibilityVerbose=Ot(this,s=>this._options.read(s).accessibilityVerbose),this.diffAlgorithm=Ot(this,s=>this._options.read(s).diffAlgorithm),this.showEmptyDecorations=Ot(this,s=>this._options.read(s).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=Ot(this,s=>this._options.read(s).onlyShowAccessibleDiffViewer),this.hideUnchangedRegions=Ot(this,s=>this._options.read(s).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=Ot(this,s=>this._options.read(s).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=Ot(this,s=>this._options.read(s).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=Ot(this,s=>this._options.read(s).hideUnchangedRegions.minimumLineCount);const i=Object.assign(Object.assign({},e),oG(e,ys));this._options=Ti(this,i)}updateOptions(e){const t=oG(e,this._options.get()),i=Object.assign(Object.assign(Object.assign({},this._options.get()),e),t);this._options.set(i,void 0,{changedOptions:e})}}function oG(n,e){var t,i,s,r,o,a,l,c;return{enableSplitViewResizing:Oe(n.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:_Te(n.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:Oe(n.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:Oe(n.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:Kf(n.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:Kf(n.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Oe(n.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Oe(n.renderIndicators,e.renderIndicators),originalEditable:Oe(n.originalEditable,e.originalEditable),diffCodeLens:Oe(n.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Oe(n.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:zi(n.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:zi(n.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:Oe(n.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:Oe((t=n.experimental)===null||t===void 0?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:Oe((i=n.experimental)===null||i===void 0?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations)},hideUnchangedRegions:{enabled:Oe((r=(s=n.hideUnchangedRegions)===null||s===void 0?void 0:s.enabled)!==null&&r!==void 0?r:(o=n.experimental)===null||o===void 0?void 0:o.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:Kf((a=n.hideUnchangedRegions)===null||a===void 0?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Kf((l=n.hideUnchangedRegions)===null||l===void 0?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Kf((c=n.hideUnchangedRegions)===null||c===void 0?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:Oe(n.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:Oe(n.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Kf(n.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:Oe(n.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited)}}var Cze=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},O1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let QP=class extends bA{constructor(e,t,i,s,r,o,a,l){var c;super(),this._domElement=e,this._parentContextKeyService=s,this._parentInstantiationService=r,this._audioCueService=a,this._editorProgressService=l,this.elements=Bn("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Bn("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[Be("span",{},"No Changes")]),Bn("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Bn("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Bn("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=this._register(D$e("diffModel",void 0)),this.onDidChangeModel=Ee.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new GT([_t,this._contextKeyService])),this._boundarySashes=Ti(this,void 0),this._accessibleDiffViewerShouldBeVisible=Ti(this,!1),this._accessibleDiffViewerVisible=Ot(this,p=>this._options.onlyShowAccessibleDiffViewer.read(p)?!0:this._accessibleDiffViewerShouldBeVisible.read(p)),this.movedBlocksLinesPart=Ti(this,void 0),this._layoutInfo=Ot(this,p=>{var m,b,v;const w=this._rootSizeObserver.width.read(p),y=this._rootSizeObserver.height.read(p),x=(m=this._sash.read(p))===null||m===void 0?void 0:m.sashLeft.read(p),D=x??Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),S=w-D-(this._options.renderOverviewRuler.read(p)?Zu.ENTIRE_DIFF_OVERVIEW_WIDTH:0),T=(v=(b=this.movedBlocksLinesPart.read(p))===null||b===void 0?void 0:b.width.read(p))!==null&&v!==void 0?v:0,k=D-T;return this.elements.original.style.width=k+"px",this.elements.original.style.left="0px",this.elements.modified.style.width=S+"px",this.elements.modified.style.left=D+"px",this._editors.original.layout({width:k,height:y}),this._editors.modified.layout({width:S,height:y}),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((p,m)=>p==null?void 0:p.diff.read(m)),this.onDidUpdateDiff=Ee.fromObservableLight(this._diffValue),o.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(ut(()=>this._domElement.removeChild(this.elements.root))),this._rootSizeObserver=this._register(new P$e(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout((c=t.automaticLayout)!==null&&c!==void 0?c:!1),this._options=new yze(t,this._rootSizeObserver.width),this._contextKeyService.createKey(ee.isEmbeddedDiffEditor.key,!1);const u=ee.isEmbeddedDiffEditor.bindTo(this._contextKeyService);this._register(Ii(p=>{u.set(this._options.isInEmbeddedEditor.read(p))}));const h=ee.comparingMovedCode.bindTo(this._contextKeyService);this._register(Ii(p=>{var m;h.set(!!(!((m=this._diffModel.read(p))===null||m===void 0)&&m.movedTextToCompare.read(p)))}));const d=ee.diffEditorRenderSideBySideInlineBreakpointReached.bindTo(this._contextKeyService);this._register(Ii(p=>{d.set(this._options.couldShowInlineViewBecauseOfSize.read(p))})),this._editors=this._register(this._instantiationService.createInstance(XP,this.elements.original,this.elements.modified,this._options,i,(p,m,b,v)=>this._createInnerEditor(p,m,b,v))),this._sash=iC(this,(p,m)=>{const b=this._options.renderSideBySide.read(p);if(this.elements.root.classList.toggle("side-by-side",b),!b)return;const v=m.add(new nze(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((w,y)=>w-(this._options.renderOverviewRuler.read(y)?Zu.ENTIRE_DIFF_OVERVIEW_WIDTH:0))}));return m.add(Ii(w=>{const y=this._boundarySashes.read(w);y&&v.setBoundarySashes(y)})),v}),this._register(BD(this._sash)),this._register(Tr((p,m)=>{this.unchangedRangesFeature=m.add(this._instantiationService.createInstance(Vh(qP,p),this._editors,this._diffModel,this._options))})),this._register(Tr((p,m)=>{m.add(new(Vh(ize,p))(this._editors,this._diffModel,this._options))})),this._register(Tr((p,m)=>{m.add(this._instantiationService.createInstance(Vh(YP,p),this._editors,this._diffModel,this._options,this,()=>this.unchangedRangesFeature.isUpdatingViewZones))})),this._register(Tr((p,m)=>{m.add(this._instantiationService.createInstance(Vh(Zu,p),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(b=>b.modifiedEditor),this._options))})),this._register(Tr((p,m)=>{this._accessibleDiffViewer=m.add(this._register(this._instantiationService.createInstance(Vh(md,p),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(b,v)=>this._accessibleDiffViewerShouldBeVisible.set(b,v),this._options.onlyShowAccessibleDiffViewer.map(b=>!b),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((b,v)=>{var w;return(w=b==null?void 0:b.diff.read(v))===null||w===void 0?void 0:w.mappings.map(y=>y.lineRangeMapping)}),this._editors)))}));const f=this._accessibleDiffViewerVisible.map(p=>p?"hidden":"visible");this._register(Pd(this.elements.modified,{visibility:f})),this._register(Pd(this.elements.original,{visibility:f})),this._createDiffEditorContributions(),o.addDiffEditor(this),this._register(BD(this._layoutInfo)),this._register(Tr((p,m)=>{this.movedBlocksLinesPart.set(m.add(new(Vh(Od,p))(this.elements.root,this._diffModel,this._layoutInfo.map(b=>b.originalEditor),this._layoutInfo.map(b=>b.modifiedEditor),this._editors)),void 0)})),this._register(Pd(this.elements.overlay,{width:this._layoutInfo.map((p,m)=>p.originalEditor.width+(this._options.renderSideBySide.read(m)?0:p.modifiedEditor.width)),visibility:Ot(p=>{var m,b;return this._options.hideUnchangedRegions.read(p)&&((b=(m=this._diffModel.read(p))===null||m===void 0?void 0:m.diff.read(p))===null||b===void 0?void 0:b.mappings.length)===0?"visible":"hidden"})})),this._register(this._editors.modified.onMouseDown(p=>{var m,b;if(!p.event.rightButton&&p.target.position&&(!((m=p.target.element)===null||m===void 0)&&m.className.includes("arrow-revert-change"))){const v=p.target.position.lineNumber,w=p.target,y=this._diffModel.get();if(!y)return;const x=(b=y.diff.get())===null||b===void 0?void 0:b.mappings;if(!x)return;const D=x.find(S=>(w==null?void 0:w.detail.afterLineNumber)===S.lineRangeMapping.modified.startLineNumber-1||S.lineRangeMapping.modified.startLineNumber===v);if(!D)return;this.revert(D.lineRangeMapping),p.event.stopPropagation()}})),this._register(Ee.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,p=>{var m,b;if((p==null?void 0:p.reason)===3){const v=(b=(m=this._diffModel.get())===null||m===void 0?void 0:m.diff.get())===null||b===void 0?void 0:b.mappings.find(w=>w.lineRangeMapping.modified.contains(p.position.lineNumber));v!=null&&v.lineRangeMapping.modified.isEmpty?this._audioCueService.playAudioCue(Dt.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):v!=null&&v.lineRangeMapping.original.isEmpty?this._audioCueService.playAudioCue(Dt.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):v&&this._audioCueService.playAudioCue(Dt.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}));const g=this._diffModel.map((p,m)=>p==null?void 0:p.isDiffUpToDate.read(m));this._register(Tr((p,m)=>{if(g.read(p)===!1){const b=this._editorProgressService.show(!0,1e3);m.add(ut(()=>b.done()))}}))}_createInnerEditor(e,t,i,s){return e.createInstance(db,t,i,s)}_createDiffEditorContributions(){const e=Z0.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){Ft(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return MT.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var e;const t=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:t,modified:i,modelState:(e=this._diffModel.get())===null||e===void 0?void 0:e.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())===null||t===void 0||t.restoreSerializedState(i.modelState))}}createViewModel(e){return this._instantiationService.createInstance(ZP,e,this._options,this)}getModel(){var e,t;return(t=(e=this._diffModel.get())===null||e===void 0?void 0:e.model)!==null&&t!==void 0?t:null}setModel(e){!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();const t=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(t?t.model.original:null),this._editors.modified.setModel(t?t.model.modified:null),ps(i=>{this._diffModel.set(t,i)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.diff.get();return t?kze(t):null}revert(e){var t;const i=(t=this._diffModel.get())===null||t===void 0?void 0:t.model;if(!i)return;const s=e.innerChanges?e.innerChanges.map(r=>({range:r.modifiedRange,text:i.original.getValueInRange(r.originalRange)})):[{range:e.modified.toExclusiveRange(),text:i.original.getValueInRange(e.original.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",s)}accessibleDiffViewerNext(){this._accessibleDiffViewer.next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.prev()}mapToOtherSide(){var e,t;const i=this._editors.modified.hasWidgetFocus(),s=i?this._editors.modified:this._editors.original,r=i?this._editors.original:this._editors.modified;let o;const a=s.getSelection();if(a){const l=(t=(e=this._diffModel.get())===null||e===void 0?void 0:e.diff.get())===null||t===void 0?void 0:t.mappings.map(c=>i?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=aG(a.getStartPosition(),l),u=aG(a.getEndPosition(),l);o=H.plusRange(c,u)}}return{destination:r,destinationSelection:o}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.unchangedRegions.get();t&&ps(i=>{for(const s of t)s.collapseAll(i)})}showAllUnchangedRegions(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.unchangedRegions.get();t&&ps(i=>{for(const s of t)s.showAll(i)})}};QP=Cze([O1(3,_t),O1(4,Wt),O1(5,ci),O1(6,fA),O1(7,xS)],QP);function aG(n,e){const t=Q3(e,s=>s.original.startLineNumber<=n.lineNumber);if(!t)return H.fromPositions(n);if(t.original.endLineNumberExclusive<=n.lineNumber){const s=n.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return H.fromPositions(new X(s,n.column))}if(!t.innerChanges)return H.fromPositions(new X(t.modified.startLineNumber,1));const i=Q3(t.innerChanges,s=>s.originalRange.getStartPosition().isBeforeOrEqual(n));if(!i){const s=n.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return H.fromPositions(new X(s,n.column))}if(i.originalRange.containsPosition(n))return i.modifiedRange;{const s=Sze(i.originalRange.getEndPosition(),n);return H.fromPositions(xze(i.modifiedRange.getEndPosition(),s))}}function Sze(n,e){return n.lineNumber===e.lineNumber?new Py(0,e.column-n.column):new Py(e.lineNumber-n.lineNumber,e.column-1)}function xze(n,e){return e.lineCount===0?new X(n.lineNumber,n.column+e.columnCount):new X(n.lineNumber+e.lineCount,e.columnCount+1)}function kze(n){return n.mappings.map(e=>{const t=e.lineRangeMapping;let i,s,r,o,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,s=0,a=void 0):(i=t.original.startLineNumber,s=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(r=t.modified.startLineNumber-1,o=0,a=void 0):(r=t.modified.startLineNumber,o=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:s,modifiedStartLineNumber:r,modifiedEndLineNumber:o,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var r9=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},li=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let Lze=0,lG=!1;function Dze(n){if(!n){if(lG)return;lG=!0}k4e(n||document.body)}let UD=class extends db{constructor(e,t,i,s,r,o,a,l,c,u,h,d){const f=Object.assign({},t);f.ariaLabel=f.ariaLabel||bD.editorViewAccessibleLabel,f.ariaLabel=f.ariaLabel+";"+bD.accessibilityHelpMessage,super(e,f,{},i,s,r,o,l,c,u,h,d),a instanceof vb?this._standaloneKeybindingService=a:this._standaloneKeybindingService=null,Dze(f.ariaContainerElement)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const s="DYNAMIC_"+ ++Lze,r=Ve.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(s,e,t,r),s}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),ae.None;const t=e.id,i=e.label,s=Ve.and(Ve.equals("editorId",this.getId()),Ve.deserialize(e.precondition)),r=e.keybindings,o=Ve.and(s,Ve.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),u=new Ae,h=this.getId()+":"+t;if(u.add(pi.registerCommand(h,c)),a){const f={command:{id:h,title:i},when:s,group:a,order:l};u.add(_a.appendMenuItem(B.EditorContext,f))}if(Array.isArray(r))for(const f of r)u.add(this._standaloneKeybindingService.addDynamicKeybinding(h,f,c,o));const d=new Nse(h,i,i,s,(...f)=>Promise.resolve(e.run(this,...f)),this._contextKeyService);return this._actions.set(t,d),u.add(ut(()=>{this._actions.delete(t)})),u}_triggerCommand(e,t){if(this._codeEditorService instanceof fD)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};UD=r9([li(2,Wt),li(3,ci),li(4,Ys),li(5,_t),li(6,Oi),li(7,qr),li(8,ts),li(9,Lf),li(10,Ur),li(11,wt)],UD);let JP=class extends UD{constructor(e,t,i,s,r,o,a,l,c,u,h,d,f,g,p){const m=Object.assign({},t);OD(u,m,!1);const b=l.registerEditorContainer(e);typeof m.theme=="string"&&l.setTheme(m.theme),typeof m.autoDetectHighContrast<"u"&&l.setAutoDetectHighContrast(!!m.autoDetectHighContrast);const v=m.model;delete m.model,super(e,m,i,s,r,o,a,l,c,h,g,p),this._configurationService=u,this._standaloneThemeService=l,this._register(b);let w;if(typeof v>"u"){const y=f.getLanguageIdByMimeType(m.language)||m.language||Bo;w=Ooe(d,f,m.value||"",y,void 0),this._ownsModel=!0}else w=v,this._ownsModel=!1;if(this._attachModel(w),w){const y={oldModelUrl:null,newModelUrl:w.uri};this._onDidChangeModel.fire(y)}}dispose(){super.dispose()}updateOptions(e){OD(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};JP=r9([li(2,Wt),li(3,ci),li(4,Ys),li(5,_t),li(6,Oi),li(7,za),li(8,ts),li(9,xi),li(10,Lf),li(11,Zs),li(12,Ji),li(13,Ur),li(14,wt)],JP);let eO=class extends QP{constructor(e,t,i,s,r,o,a,l,c,u,h,d){const f=Object.assign({},t);OD(l,f,!0);const g=o.registerEditorContainer(e);typeof f.theme=="string"&&o.setTheme(f.theme),typeof f.autoDetectHighContrast<"u"&&o.setAutoDetectHighContrast(!!f.autoDetectHighContrast),super(e,f,{},s,i,r,d,u),this._configurationService=l,this._standaloneThemeService=o,this._register(g)}dispose(){super.dispose()}updateOptions(e){OD(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(UD,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};eO=r9([li(2,Wt),li(3,_t),li(4,ci),li(5,za),li(6,ts),li(7,xi),li(8,Tf),li(9,xS),li(10,RS),li(11,fA)],eO);function Ooe(n,e,t,i,s){if(t=t||"",!i){const r=t.indexOf(`
`);let o=t;return r!==-1&&(o=t.substring(0,r)),cG(n,t,e.createByFilepathOrFirstLine(s||null,o),s)}return cG(n,t,e.createById(i),s)}function cG(n,e,t,i){return n.createModel(e,t,i)}var Boe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function Eze(n,e,t){return Ge.initialize(t||{}).createInstance(JP,n,e)}function Tze(n){return Ge.get(ci).onCodeEditorAdd(t=>{n(t)})}function Aze(n){return Ge.get(ci).onDiffEditorAdd(t=>{n(t)})}function Ize(){return Ge.get(ci).listCodeEditors()}function Nze(){return Ge.get(ci).listDiffEditors()}function Rze(n,e,t){return Ge.initialize(t||{}).createInstance(eO,n,e)}function Mze(n){if(typeof n.id!="string"||typeof n.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return pi.registerCommand(n.id,n.run)}function Fze(n){if(typeof n.id!="string"||typeof n.label!="string"||typeof n.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=Ve.deserialize(n.precondition),t=(s,...r)=>Pa.runEditorCommand(s,r,e,(o,a,l)=>Promise.resolve(n.run(a,...l))),i=new Ae;if(i.add(pi.registerCommand(n.id,t)),n.contextMenuGroupId){const s={command:{id:n.id,title:n.label},when:e,group:n.contextMenuGroupId,order:n.contextMenuOrder||0};i.add(_a.appendMenuItem(B.EditorContext,s))}if(Array.isArray(n.keybindings)){const s=Ge.get(Oi);if(!(s instanceof vb))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const r=Ve.and(e,Ve.deserialize(n.keybindingContext));i.add(s.addDynamicKeybindings(n.keybindings.map(o=>({keybinding:o,command:n.id,when:r}))))}}return i}function Pze(n){return Woe([n])}function Woe(n){const e=Ge.get(Oi);return e instanceof vb?e.addDynamicKeybindings(n.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:Ve.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),ae.None)}function Oze(n,e,t){const i=Ge.get(Ji),s=i.getLanguageIdByMimeType(e)||e;return Ooe(Ge.get(Zs),i,n,s,t)}function Bze(n,e){const t=Ge.get(Ji),i=t.getLanguageIdByMimeType(e)||e||Bo;n.setLanguage(t.createById(i))}function Wze(n,e,t){n&&Ge.get(Uc).changeOne(e,n.uri,t)}function Vze(n){Ge.get(Uc).changeAll(n,[])}function $ze(n){return Ge.get(Uc).read(n)}function zze(n){return Ge.get(Uc).onMarkerChanged(n)}function Hze(n){return Ge.get(Zs).getModel(n)}function Uze(){return Ge.get(Zs).getModels()}function jze(n){return Ge.get(Zs).onModelAdded(n)}function qze(n){return Ge.get(Zs).onModelRemoved(n)}function Gze(n){return Ge.get(Zs).onModelLanguageChanged(t=>{n({model:t.model,oldLanguage:t.oldLanguageId})})}function Kze(n){return QMe(Ge.get(Zs),Ge.get(Ur),n)}function Zze(n,e){const t=Ge.get(Ji),i=Ge.get(za);return P8.colorizeElement(i,t,n,e).then(()=>{i.registerEditorContainer(n)})}function Yze(n,e,t){const i=Ge.get(Ji);return Ge.get(za).registerEditorContainer(document.body),P8.colorize(i,n,e,t)}function Xze(n,e,t=4){return Ge.get(za).registerEditorContainer(document.body),P8.colorizeModelLine(n,e,t)}function Qze(n){const e=$i.get(n);return e||{getInitialState:()=>yy,tokenize:(t,i,s)=>Vne(n,s)}}function Jze(n,e){$i.getOrCreate(e);const t=Qze(e),i=em(n),s=[];let r=t.getInitialState();for(let o=0,a=i.length;o<a;o++){const l=i[o],c=t.tokenize(l,!0,r);s[o]=c.tokens,r=c.endState}return s}function eHe(n,e){Ge.get(za).defineTheme(n,e)}function tHe(n){Ge.get(za).setTheme(n)}function iHe(){O3.clearAllFontInfos()}function nHe(n,e){return pi.registerCommand({id:n,handler:e})}function sHe(n){return Ge.get(hh).registerOpener({open(t){return Boe(this,void 0,void 0,function*(){return typeof t=="string"&&(t=ot.parse(t)),n.open(t)})}})}function rHe(n){return Ge.get(ci).registerCodeEditorOpenHandler((t,i,s)=>Boe(this,void 0,void 0,function*(){var r;if(!i)return null;const o=(r=t.options)===null||r===void 0?void 0:r.selection;let a;return o&&typeof o.endLineNumber=="number"&&typeof o.endColumn=="number"?a=o:o&&(a={lineNumber:o.startLineNumber,column:o.startColumn}),(yield n.openCodeEditor(i,t.resource,a))?i:null}))}function oHe(){return{create:Eze,getEditors:Ize,getDiffEditors:Nze,onDidCreateEditor:Tze,onDidCreateDiffEditor:Aze,createDiffEditor:Rze,addCommand:Mze,addEditorAction:Fze,addKeybindingRule:Pze,addKeybindingRules:Woe,createModel:Oze,setModelLanguage:Bze,setModelMarkers:Wze,getModelMarkers:$ze,removeAllMarkers:Vze,onDidChangeMarkers:zze,getModels:Uze,getModel:Hze,onDidCreateModel:jze,onWillDisposeModel:qze,onDidChangeModelLanguage:Gze,createWebWorker:Kze,colorizeElement:Zze,colorize:Yze,colorizeModelLine:Xze,tokenize:Jze,defineTheme:eHe,setTheme:tHe,remeasureFonts:iHe,registerCommand:nHe,registerLinkOpener:sHe,registerEditorOpener:rHe,AccessibilitySupport:Z4,ContentWidgetPositionPreference:t3,CursorChangeReason:i3,DefaultEndOfLine:n3,EditorAutoIndentStrategy:r3,EditorOption:o3,EndOfLinePreference:a3,EndOfLineSequence:l3,MinimapPosition:_3,MouseTargetType:b3,OverlayWidgetPositionPreference:v3,OverviewRulerLane:w3,GlyphMarginLane:c3,RenderLineNumbersType:C3,RenderMinimap:S3,ScrollbarVisibility:k3,ScrollType:x3,TextEditorCursorBlinkingStyle:A3,TextEditorCursorStyle:I3,TrackedRangeStickiness:N3,WrappingIndent:R3,InjectedTextCursorStops:h3,PositionAffinity:y3,ConfigurationChangedEvent:pie,BareFontInfo:Hg,FontInfo:P3,TextModelResolvedOptions:Q2,FindMatch:my,ApplyUpdateResult:zv,EditorZoom:Gh,EditorType:MT,EditorOptions:Xp}}function aHe(n,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!n(t))return!1;return!0}function r2(n,e){return typeof n=="boolean"?n:e}function uG(n,e){return typeof n=="string"?n:e}function lHe(n){const e={};for(const t of n)e[t]=!0;return e}function hG(n,e=!1){e&&(n=n.map(function(i){return i.toLowerCase()}));const t=lHe(n);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function tO(n,e){e=e.replace(/@@/g,"");let t=0,i;do i=!1,e=e.replace(/@(\w+)/g,function(r,o){i=!0;let a="";if(typeof n[o]=="string")a=n[o];else if(n[o]&&n[o]instanceof RegExp)a=n[o].source;else throw n[o]===void 0?si(n,"language definition does not contain attribute '"+o+"', used at: "+e):si(n,"attribute reference '"+o+"' must be a string, used at: "+e);return Xm(a)?"":"(?:"+a+")"}),t++;while(i&&t<5);e=e.replace(/\x01/g,"@");const s=(n.ignoreCase?"i":"")+(n.unicode?"u":"");return new RegExp(e,s)}function cHe(n,e,t,i){if(i<0)return n;if(i<e.length)return e[i];if(i>=100){i=i-100;const s=t.split(".");if(s.unshift(t),i<s.length)return s[i]}return null}function uHe(n,e,t,i){let s=-1,r=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(s=parseInt(o[3]),o[2]&&(s=s+100)),r=o[4]);let a="~",l=r;!r||r.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const u=hG(l.split("|"),n.ignoreCase);c=function(h){return a==="~"?u(h):!u(h)}}else if(a==="@"||a==="!@"){const u=n[l];if(!u)throw si(n,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!aHe(function(d){return typeof d=="string"},u))throw si(n,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const h=hG(u,n.ignoreCase);c=function(d){return a==="@"?h(d):!h(d)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const u=tO(n,"^"+l+"$");c=function(h){return a==="~"?u.test(h):!u.test(h)}}else c=function(u,h,d,f){return tO(n,"^"+Kh(n,l,h,d,f)+"$").test(u)};else if(l.indexOf("$")<0){const u=Id(n,l);c=function(h){return a==="=="?h===u:h!==u}}else{const u=Id(n,l);c=function(h,d,f,g,p){const m=Kh(n,u,d,f,g);return a==="=="?h===m:h!==m}}return s===-1?{name:t,value:i,test:function(u,h,d,f){return c(u,u,h,d,f)}}:{name:t,value:i,test:function(u,h,d,f){const g=cHe(u,h,d,s);return c(g||"",u,h,d,f)}}}function iO(n,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw si(n,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw si(n,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw si(n,"the next state must be a string value in rule: "+e);{let s=t.next;if(!/^(@pop|@push|@popall)$/.test(s)&&(s[0]==="@"&&(s=s.substr(1)),s.indexOf("$")<0&&!_4e(n,Kh(n,s,"",[],""))))throw si(n,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=s}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,n.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let s=0,r=t.length;s<r;s++)i[s]=iO(n,e,t[s]);return{group:i}}else if(t.cases){const i=[];for(const r in t.cases)if(t.cases.hasOwnProperty(r)){const o=iO(n,e,t.cases[r]);r==="@default"||r==="@"||r===""?i.push({test:void 0,value:o,name:r}):r==="@eos"?i.push({test:function(a,l,c,u){return u},value:o,name:r}):i.push(uHe(n,e,r,o))}const s=n.defaultToken;return{test:function(r,o,a,l){for(const c of i)if(!c.test||c.test(r,o,a,l))return c.value;return s}}}else throw si(n,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class hHe{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw si(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=tO(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=iO(e,this.name,t)}}function Voe(n,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={};t.languageId=n,t.includeLF=r2(e.includeLF,!1),t.noThrow=!1,t.maxStack=100,t.start=typeof e.start=="string"?e.start:null,t.ignoreCase=r2(e.ignoreCase,!1),t.unicode=r2(e.unicode,!1),t.tokenPostfix=uG(e.tokenPostfix,"."+t.languageId),t.defaultToken=uG(e.defaultToken,"source"),t.usesEmbedded=!1;const i=e;i.languageId=n,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function s(o,a,l){for(const c of l){let u=c.include;if(u){if(typeof u!="string")throw si(t,"an 'include' attribute must be a string at: "+o);if(u[0]==="@"&&(u=u.substr(1)),!e.tokenizer[u])throw si(t,"include target '"+u+"' is not defined at: "+o);s(o+"."+u,a,e.tokenizer[u])}else{const h=new hHe(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(h.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")h.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const d=c[1];d.next=c[2],h.setAction(i,d)}else throw si(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else h.setAction(i,c[1]);else{if(!c.regex)throw si(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(h.name=c.name),c.matchOnlyAtStart&&(h.matchOnlyAtLineStart=r2(c.matchOnlyAtLineStart,!1)),h.setRegex(i,c.regex),h.setAction(i,c.action)}a.push(h)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw si(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,s("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw si(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(const o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw si(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")r.push({token:a.token+t.tokenPostfix,open:Id(t,a.open),close:Id(t,a.close)});else throw si(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=r,t.noThrow=!0,t}var dHe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function fHe(n){tb.registerLanguage(n)}function gHe(){let n=[];return n=n.concat(tb.getLanguages()),n}function pHe(n){return Ge.get(Ji).languageIdCodec.encodeLanguageId(n)}function mHe(n,e){return Ge.withServices(()=>{const i=Ge.get(Ji).onDidRequestRichLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function _He(n,e){return Ge.withServices(()=>{const i=Ge.get(Ji).onDidRequestBasicLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function bHe(n,e){if(!Ge.get(Ji).isRegisteredLanguageId(n))throw new Error(`Cannot set configuration for unknown language ${n}`);return Ge.get(Ur).register(n,e,100)}class vHe{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return sC.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const s=this._actual.tokenizeEncoded(e,i);return new hT(s.tokens,s.endState)}}class sC{constructor(e,t,i,s){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=s}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let s=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];let l=a.startIndex;r===0?l=0:l<s&&(l=s),i[r]=new ay(l,a.scopes,t),s=l}return i}static adaptTokenize(e,t,i,s){const r=t.tokenize(i,s),o=sC._toClassicTokens(r.tokens,e);let a;return r.endState.equals(s)?a=s:a=r.endState,new a8(o,a)}tokenize(e,t,i){return sC.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),s=this._standaloneThemeService.getColorTheme().tokenTheme,r=[];let o=0,a=0;for(let c=0,u=t.length;c<u;c++){const h=t[c],d=s.match(i,h.scopes)|1024;if(o>0&&r[o-1]===d)continue;let f=h.startIndex;c===0?f=0:f<a&&(f=a),r[o++]=f,r[o++]=d,a=f}const l=new Uint32Array(o);for(let c=0;c<o;c++)l[c]=r[c];return l}tokenizeEncoded(e,t,i){const s=this._actual.tokenize(e,i),r=this._toBinaryTokens(this._languageService.languageIdCodec,s.tokens);let o;return s.endState.equals(i)?o=i:o=s.endState,new hT(r,o)}}function wHe(n){return typeof n.getInitialState=="function"}function yHe(n){return"tokenizeEncoded"in n}function $oe(n){return n&&typeof n.then=="function"}function CHe(n){const e=Ge.get(za);if(n){const t=[null];for(let i=1,s=n.length;i<s;i++)t[i]=J.fromHex(n[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function zoe(n,e){return yHe(e)?new vHe(n,e):new sC(n,e,Ge.get(Ji),Ge.get(za))}function o9(n,e){const t=new HAe(()=>dHe(this,void 0,void 0,function*(){const i=yield Promise.resolve(e.create());return i?wHe(i)?zoe(n,i):new xy(Ge.get(Ji),Ge.get(za),n,Voe(n,i),Ge.get(xi)):null}));return $i.registerFactory(n,t)}function SHe(n,e){if(!Ge.get(Ji).isRegisteredLanguageId(n))throw new Error(`Cannot set tokens provider for unknown language ${n}`);return $oe(e)?o9(n,{create:()=>e}):$i.register(n,zoe(n,e))}function xHe(n,e){const t=i=>new xy(Ge.get(Ji),Ge.get(za),n,Voe(n,i),Ge.get(xi));return $oe(e)?o9(n,{create:()=>e}):$i.register(n,t(e))}function kHe(n,e){return Ge.get(wt).referenceProvider.register(n,e)}function LHe(n,e){return Ge.get(wt).renameProvider.register(n,e)}function DHe(n,e){return Ge.get(wt).signatureHelpProvider.register(n,e)}function EHe(n,e){return Ge.get(wt).hoverProvider.register(n,{provideHover:(i,s,r)=>{const o=i.getWordAtPosition(s);return Promise.resolve(e.provideHover(i,s,r)).then(a=>{if(a)return!a.range&&o&&(a.range=new H(s.lineNumber,o.startColumn,s.lineNumber,o.endColumn)),a.range||(a.range=new H(s.lineNumber,s.column,s.lineNumber,s.column)),a})}})}function THe(n,e){return Ge.get(wt).documentSymbolProvider.register(n,e)}function AHe(n,e){return Ge.get(wt).documentHighlightProvider.register(n,e)}function IHe(n,e){return Ge.get(wt).linkedEditingRangeProvider.register(n,e)}function NHe(n,e){return Ge.get(wt).definitionProvider.register(n,e)}function RHe(n,e){return Ge.get(wt).implementationProvider.register(n,e)}function MHe(n,e){return Ge.get(wt).typeDefinitionProvider.register(n,e)}function FHe(n,e){return Ge.get(wt).codeLensProvider.register(n,e)}function PHe(n,e,t){return Ge.get(wt).codeActionProvider.register(n,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(s,r,o,a)=>{const c=Ge.get(Uc).read({resource:s.uri}).filter(u=>H.areIntersectingOrTouching(u,r));return e.provideCodeActions(s,r,{markers:c,only:o.only,trigger:o.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function OHe(n,e){return Ge.get(wt).documentFormattingEditProvider.register(n,e)}function BHe(n,e){return Ge.get(wt).documentRangeFormattingEditProvider.register(n,e)}function WHe(n,e){return Ge.get(wt).onTypeFormattingEditProvider.register(n,e)}function VHe(n,e){return Ge.get(wt).linkProvider.register(n,e)}function $He(n,e){return Ge.get(wt).completionProvider.register(n,e)}function zHe(n,e){return Ge.get(wt).colorProvider.register(n,e)}function HHe(n,e){return Ge.get(wt).foldingRangeProvider.register(n,e)}function UHe(n,e){return Ge.get(wt).declarationProvider.register(n,e)}function jHe(n,e){return Ge.get(wt).selectionRangeProvider.register(n,e)}function qHe(n,e){return Ge.get(wt).documentSemanticTokensProvider.register(n,e)}function GHe(n,e){return Ge.get(wt).documentRangeSemanticTokensProvider.register(n,e)}function KHe(n,e){return Ge.get(wt).inlineCompletionsProvider.register(n,e)}function ZHe(n,e){return Ge.get(wt).inlayHintsProvider.register(n,e)}function YHe(){return{register:fHe,getLanguages:gHe,onLanguage:mHe,onLanguageEncountered:_He,getEncodedLanguageId:pHe,setLanguageConfiguration:bHe,setColorMap:CHe,registerTokensProviderFactory:o9,setTokensProvider:SHe,setMonarchTokensProvider:xHe,registerReferenceProvider:kHe,registerRenameProvider:LHe,registerCompletionItemProvider:$He,registerSignatureHelpProvider:DHe,registerHoverProvider:EHe,registerDocumentSymbolProvider:THe,registerDocumentHighlightProvider:AHe,registerLinkedEditingRangeProvider:IHe,registerDefinitionProvider:NHe,registerImplementationProvider:RHe,registerTypeDefinitionProvider:MHe,registerCodeLensProvider:FHe,registerCodeActionProvider:PHe,registerDocumentFormattingEditProvider:OHe,registerDocumentRangeFormattingEditProvider:BHe,registerOnTypeFormattingEditProvider:WHe,registerLinkProvider:VHe,registerColorProvider:zHe,registerFoldingRangeProvider:HHe,registerDeclarationProvider:UHe,registerSelectionRangeProvider:jHe,registerDocumentSemanticTokensProvider:qHe,registerDocumentRangeSemanticTokensProvider:GHe,registerInlineCompletionsProvider:KHe,registerInlayHintsProvider:ZHe,DocumentHighlightKind:s3,CompletionItemKind:Q4,CompletionItemTag:J4,CompletionItemInsertTextRule:X4,SymbolKind:E3,SymbolTag:T3,IndentAction:u3,CompletionTriggerKind:e3,SignatureHelpTriggerKind:D3,InlayHintKind:d3,InlineCompletionTriggerKind:f3,CodeActionTriggerType:Y4,FoldingRangeKind:Us,SelectedSuggestionInfo:$Ae}}const a9=kt("IEditorCancelService"),Hoe=new Fe("cancellableOperation",!1,_("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));At(a9,class{constructor(){this._tokens=new WeakMap}add(n,e){let t=this._tokens.get(n);t||(t=n.invokeWithinContext(s=>{const r=Hoe.bindTo(s.get(_t)),o=new hr;return{key:r,tokens:o}}),this._tokens.set(n,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(n){const e=this._tokens.get(n);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class XHe extends Wa{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(a9).add(e,this))}dispose(){this._unregister(),super.dispose()}}qe(new class extends Pa{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:Hoe})}runEditorCommand(n,e){n.get(a9).cancel(e)}});let QHe=class nO{constructor(e,t){if(this.flags=t,this.flags&1){const i=e.getModel();this.modelVersionId=i?ly("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=e.getPosition():this.position=null,this.flags&2?this.selection=e.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof nO))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new nO(e,this.flags))}};class JHe extends XHe{constructor(e,t,i,s){super(e,s),this._listener=new Ae,t&4&&this._listener.add(e.onDidChangeCursorPosition(r=>{(!i||!H.containsPosition(i,r.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(r=>{(!i||!H.containsRange(i,r.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(r=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(r=>this.cancel())),this._listener.add(e.onDidChangeModelContent(r=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class eUe extends Wa{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function Uoe(n){return n&&typeof n.getEditorType=="function"?n.getEditorType()===MT.ICodeEditor:!1}class dG{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class tUe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(dG.toKey(e))}has(e){return this._set.has(dG.toKey(e))}}var e1=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function iUe(n,e,t){const i=[],s=new tUe,r=n.ordered(t);for(const a of r)i.push(a),a.extensionId&&s.add(a.extensionId);const o=e.ordered(t);for(const a of o){if(a.extensionId){if(s.has(a.extensionId))continue;s.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,u){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,u)}})}return i}class rC{static setFormatterSelector(e){return{dispose:rC._selectors.unshift(e)}}static select(e,t,i){return e1(this,void 0,void 0,function*(){if(e.length===0)return;const s=Et.first(rC._selectors);if(s)return yield s(e,t,i)})}}rC._selectors=new hr;function nUe(n,e,t,i,s,r){return e1(this,void 0,void 0,function*(){const o=e.documentRangeFormattingEditProvider.ordered(t);for(const a of o){const l=yield Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,s,r)).catch(oh);if(Uu(l))return yield n.computeMoreMinimalEdits(t.uri,l)}})}function sUe(n,e,t,i,s){return e1(this,void 0,void 0,function*(){const r=iUe(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const o of r){const a=yield Promise.resolve(o.provideDocumentFormattingEdits(t,i,s)).catch(oh);if(Uu(a))return yield n.computeMoreMinimalEdits(t.uri,a)}})}function rUe(n,e,t,i,s,r,o){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(s)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,s,r,o)).catch(oh).then(l=>n.computeMoreMinimalEdits(t.uri,l))}pi.registerCommand("_executeFormatRangeProvider",function(n,...e){return e1(this,void 0,void 0,function*(){const[t,i,s]=e;cr(ot.isUri(t)),cr(H.isIRange(i));const r=n.get(Cf),o=n.get(DS),a=n.get(wt),l=yield r.createModelReference(t);try{return nUe(o,a,l.object.textEditorModel,H.lift(i),s,In.None)}finally{l.dispose()}})});pi.registerCommand("_executeFormatDocumentProvider",function(n,...e){return e1(this,void 0,void 0,function*(){const[t,i]=e;cr(ot.isUri(t));const s=n.get(Cf),r=n.get(DS),o=n.get(wt),a=yield s.createModelReference(t);try{return sUe(r,o,a.object.textEditorModel,i,In.None)}finally{a.dispose()}})});pi.registerCommand("_executeFormatOnTypeProvider",function(n,...e){return e1(this,void 0,void 0,function*(){const[t,i,s,r]=e;cr(ot.isUri(t)),cr(X.isIPosition(i)),cr(typeof s=="string");const o=n.get(Cf),a=n.get(DS),l=n.get(wt),c=yield o.createModelReference(t);try{return rUe(a,l,c.object.textEditorModel,X.lift(i),s,r,In.None)}finally{c.dispose()}})});Xp.wrappingIndent.defaultValue=0;Xp.glyphMargin.defaultValue=!1;Xp.autoIndent.defaultValue=3;Xp.overviewRulerLanes.defaultValue=2;rC.setFormatterSelector((n,e,t)=>Promise.resolve(n[0]));const Qs=Iie();Qs.editor=oHe();Qs.languages=YHe();const oUe=Qs.CancellationTokenSource,aUe=Qs.Emitter,lUe=Qs.KeyCode,cUe=Qs.KeyMod,uUe=Qs.Position,hUe=Qs.Range,dUe=Qs.Selection,fUe=Qs.SelectionDirection,gUe=Qs.MarkerSeverity,pUe=Qs.MarkerTag,mUe=Qs.Uri,_Ue=Qs.Token,joe=Qs.editor,qoe=Qs.languages,UR=globalThis.MonacoEnvironment;(UR!=null&&UR.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=Qs);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const bUe=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:oUe,Emitter:aUe,KeyCode:lUe,KeyMod:cUe,MarkerSeverity:gUe,MarkerTag:pUe,Position:uUe,Range:hUe,Selection:dUe,SelectionDirection:fUe,Token:_Ue,Uri:mUe,editor:joe,languages:qoe},Symbol.toStringTag,{value:"Module"})),vUe="#/definitions/RootSpec",wUe="http://json-schema.org/draft-07/schema#",yUe={AggregateParams:{additionalProperties:!1,properties:{groupby:{description:"Which fields to use for grouping. Missing `groupby` results in a single group that includes all the data items.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"aggregate",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},Align:{enum:["left","center","right"],type:"string"},Axis:{additionalProperties:!1,properties:{domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},AxisGenomeData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to use"},type:{const:"axisGenome",type:"string"}},required:["type","channel"],type:"object"},AxisOrient:{enum:["top","bottom","left","right"],type:"string"},AxisTicksData:{additionalProperties:!1,properties:{axis:{$ref:"#/definitions/Axis",description:"Optional axis properties"},channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to listen to"},type:{const:"axisTicks",type:"string"}},required:["type","channel"],type:"object"},BamData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".bai"`.',type:"string"},type:{const:"bam",type:"string"},url:{description:"URL of the BigBed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `10000`",type:"number"}},required:["type","url"],type:"object"},Baseline:{enum:["top","middle","bottom","alphabetic"],type:"string"},BigBedData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},type:{const:"bigbed",type:"string"},url:{description:"URL of the BigBed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `1000000`",type:"number"}},required:["type","url"],type:"object"},BigWigData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},pixelsPerBin:{description:"The approximate minimum width of each data bin, in pixels.\n\n__Default value:__ `2`",type:"number"},type:{const:"bigwig",type:"string"},url:{description:"URL of the BigWig file.",type:"string"}},required:["type","url"],type:"object"},ChannelWithScale:{anyOf:[{$ref:"#/definitions/PositionalChannel"},{const:"color",type:"string"},{const:"fill",type:"string"},{const:"stroke",type:"string"},{const:"opacity",type:"string"},{const:"fillOpacity",type:"string"},{const:"strokeOpacity",type:"string"},{const:"strokeWidth",type:"string"},{const:"size",type:"string"},{const:"shape",type:"string"},{const:"angle",type:"string"},{const:"dx",type:"string"},{const:"dy",type:"string"},{const:"sample",type:"string"}]},ChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{const:"locus",type:"string"}},required:["chrom","type"],type:"object"},ChromosomalLocus:{additionalProperties:!1,properties:{chrom:{description:'The name of the chromosome. For example: `"chr1"`, `"CHR1"`, or `"1"`.',type:"string"},pos:{description:"The zero-based position inside the chromosome or contig.",type:"number"}},required:["chrom"],type:"object"},CollectParams:{additionalProperties:!1,properties:{groupby:{description:"Arranges the data into consecutive batches based on the groups. This is mainly intended for internal use so that faceted data can be handled as batches.",items:{$ref:"#/definitions/Field"},type:"array"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order."},type:{const:"collect",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},"ColorDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2C(string%7Cnull)%3E"},CompareParams:{additionalProperties:!1,properties:{field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to sort by"},order:{anyOf:[{items:{$ref:"#/definitions/SortOrder"},type:"array"},{$ref:"#/definitions/SortOrder"}],description:'The order(s) to use: `"ascending"` (default), `"descending"`.'}},required:["field"],type:"object"},ComplexDomain:{description:"A complex domain that needs to be converted into a scalar domain before it is assigned to a scale.",items:{$ref:"#/definitions/ChromosomalLocus"},type:"array"},ConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},columns:{type:"number"},concat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["concat","columns"],type:"object"},Contig:{additionalProperties:!1,properties:{name:{type:"string"},size:{type:"number"}},required:["name","size"],type:"object"},CoverageParams:{additionalProperties:!1,properties:{as:{description:"The output field for the computed coverage.",type:"string"},asChrom:{description:"The output field for the chromosome.\n\n**Default:** Same as `chrom`",type:"string"},asEnd:{description:"The output field for the end coordinate.\n\n**Default:** Same as `end`",type:"string"},asStart:{description:"The output field for the start coordinate.\n\n**Default:** Same as `start`",type:"string"},chrom:{$ref:"#/definitions/Field",description:"An optional chromosome field that is passed through. TODO: groupby"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"coverage",description:"The type of the transform to be applied",type:"string"},weight:{$ref:"#/definitions/Field",description:"A field representing an optional weight for the segment. Can be used with copy ratios, for example."}},required:["end","start","type"],type:"object"},CsvDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',enum:["csv","tsv"],type:"string"}},type:"object"},Data:{anyOf:[{$ref:"#/definitions/DataSource"},{$ref:"#/definitions/Generator"}]},DataFormat:{anyOf:[{$ref:"#/definitions/CsvDataFormat"},{$ref:"#/definitions/DsvDataFormat"},{$ref:"#/definitions/JsonDataFormat"},{$ref:"#/definitions/OtherDataFormat"}]},DataSource:{anyOf:[{$ref:"#/definitions/UrlData"},{$ref:"#/definitions/InlineData"},{$ref:"#/definitions/NamedData"},{$ref:"#/definitions/DynamicCallbackData"},{$ref:"#/definitions/LazyData"}]},DsvDataFormat:{additionalProperties:!1,properties:{delimiter:{description:"The delimiter between records. The delimiter must be a single character (i.e., a single 16-bit code unit); so, ASCII delimiters are fine, but emoji delimiters are not.",maxLength:1,minLength:1,type:"string"},parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{const:"dsv",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},required:["delimiter"],type:"object"},DynamicCallbackData:{additionalProperties:!1,properties:{dynamicCallbackSource:{description:"The View class has `getDynamicData()` methods that provides the data. This is intended for internal use.",type:"boolean"},format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["dynamicCallbackSource"],type:"object"},DynamicOpacity:{additionalProperties:!1,description:"DynamicOpacity specifies a zoom-dependent behavior for view opacity. The opacity is interpolated between the specified stops.",properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel"},unitsPerPixel:{description:"Stops expressed as units (base pairs, for example) per pixel.",items:{type:"number"},type:"array"},values:{description:"Opacity values that match the given stops.",items:{type:"number"},type:"array"}},required:["unitsPerPixel","values"],type:"object"},Encoding:{additionalProperties:!1,properties:{angle:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Rotation angle of point and text marks."},color:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Color of the marks – either fill or stroke color based on  the `filled` property of mark definition.\n\n_Note:_ 1) For fine-grained control over both fill and stroke colors of the marks, please use the `fill` and `stroke` channels. The `fill` or `stroke` encodings have higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified. 2) See the scale documentation for more information about customizing [color scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme)."},dx:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E"},dy:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E"},facetIndex:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"For internal use"},fill:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Fill color of the marks.\n\n_Note:_ The `fill` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},fillOpacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Fill opacity of the marks."},opacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Opacity of the marks."},sample:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"Facet identifier for interactive filtering, sorting, and grouping in the App."},search:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E"},semanticScore:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E"},shape:{$ref:"#/definitions/ShapeDef%3Cstring%3E",description:'Shape of the mark.\n\nFor `point` marks the supported values include:\n- plotting shapes: `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, or `"triangle-left"`.\n- centered directional shape `"triangle"`'},size:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:'Size of the mark.\n- For `"point"` – the symbol size, or pixel area of the mark.\n- For `"text"` – the text\'s font size.'},stroke:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Stroke color of the marks.\n\n_Note:_ The `stroke` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},strokeOpacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Stroke opacity of the marks."},strokeWidth:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Stroke width of the marks."},text:{$ref:"#/definitions/TextDef%3Cstring%3E",description:"Text of the `text` mark."},uniqueId:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"For internal use"},x:{$ref:"#/definitions/PositionDef%3Cstring%3E",description:"X coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},x2:{$ref:"#/definitions/Position2Def%3Cstring%3E",description:"X2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y:{$ref:"#/definitions/PositionDef%3Cstring%3E",description:"Y coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y2:{$ref:"#/definitions/Position2Def%3Cstring%3E",description:"Y2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."}},type:"object"},ExprDef:{additionalProperties:!1,properties:{expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"}},required:["expr"],type:"object"},Field:{description:"The name of the field or a JavaScript expression for accessing nested properties. Dots and brackets in the field name must be escaped.",type:"string"},"FieldDefWithoutScale<string>":{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},FieldName:{type:"string"},FilterParams:{additionalProperties:!1,properties:{expr:{description:"An expression string. The data object is removed if the expression evaluates to false.",type:"string"},type:{const:"filter",description:"The type of the transform to be applied",type:"string"}},required:["expr","type"],type:"object"},FilterScoredLabelsParams:{additionalProperties:!1,properties:{channel:{description:'**Default:** `"x"`',enum:["x","y"],type:"string"},lane:{$ref:"#/definitions/Field",description:"An optional field representing element's lane, e.g., if transcripts are shown using a piled up layout."},padding:{description:"Padding (in pixels) around the element.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/Field",description:"The field representing element's position on the domain."},score:{$ref:"#/definitions/Field",description:"The field representing the score used for prioritization."},type:{const:"filterScoredLabels",description:"The type of the transform to be applied",type:"string"},width:{$ref:"#/definitions/Field",description:"The field representing element's width in pixels"}},required:["pos","score","type","width"],type:"object"},FlattenCompressedExonsParams:{additionalProperties:!1,properties:{as:{description:'Field names for the flattened exons.\n\n**Default:** `["exonStart", "exonEnd"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},exons:{$ref:"#/definitions/Field",description:'The field containing the exons.\n\n**Default:** `"exons"`'},start:{$ref:"#/definitions/Field",description:'Start coordinate of the gene body.\n\n**Default:** `"start"`'},type:{const:"flattenCompressedExons",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenDelimitedParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to split and flatten"},separator:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"Separator(s) used on the field(s) TODO: Rename to delimiter"},type:{const:"flattenDelimited",description:"The type of the transform to be applied",type:"string"}},required:["field","separator","type"],type:"object"},FlattenParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},fields:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to flatten. If no field is defined, the data object itself is treated as an array to be flattened."},index:{description:"The output field name for the zero-based index of the array values. If unspecified, an index field is not added.",type:"string"},type:{const:"flatten",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenSequenceParams:{additionalProperties:!1,properties:{as:{description:'Name of the fields where the zero-based index number and flattened sequence letter are written to.\n\n**Default:** `["pos", "sequence"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},field:{$ref:"#/definitions/Field",description:'The field to flatten.\n\n**Default:** `"sequence"`'},type:{const:"flattenSequence",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FontStyle:{enum:["normal","italic"],type:"string"},FontWeight:{anyOf:[{type:"number"},{const:"thin",type:"string"},{const:"light",type:"string"},{const:"regular",type:"string"},{const:"normal",type:"string"},{const:"medium",type:"string"},{const:"bold",type:"string"},{const:"black",type:"string"}]},FormulaParams:{additionalProperties:!1,properties:{as:{description:"The (new) field where the computed value is written to",type:"string"},expr:{description:"An expression string",type:"string"},type:{const:"formula",description:"The type of the transform to be applied",type:"string"}},required:["as","expr","type"],type:"object"},Generator:{$ref:"#/definitions/SequenceGenerator"},GenomeAxis:{additionalProperties:!1,properties:{chromGrid:{description:"A boolean flag indicating if chromosome grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},chromGridCap:{description:'The stroke cap for the chromosome grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},chromGridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},chromGridDash:{description:"An array of alternating [stroke, space] lengths for dashed chromosome grid mark lines.",items:{type:"number"},type:"array"},chromGridDashOffset:{description:"The pixel offset at which to start drawing with the chromosome grid mark dash array.",type:"number"},chromGridFillEven:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridFillOdd:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridOpacity:{description:"The opacity of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromGridWidth:{description:"Width of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromLabelAlign:{$ref:"#/definitions/Align"},chromLabelColor:{type:"string"},chromLabelFont:{type:"string"},chromLabelFontSize:{type:"number"},chromLabelFontStyle:{$ref:"#/definitions/FontStyle"},chromLabelFontWeight:{$ref:"#/definitions/FontWeight"},chromLabelPadding:{type:"number"},chromLabels:{type:"boolean"},chromTickColor:{type:"string"},chromTickDash:{items:{type:"number"},type:"array"},chromTickDashOffset:{type:"number"},chromTickSize:{type:"number"},chromTickWidth:{type:"number"},chromTicks:{type:"boolean"},domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},GenomeConfig:{additionalProperties:!1,properties:{baseUrl:{description:'Base url of data files: chromsizes, cytobands, and gene annotations.\n\n**Default:** `"https://genomespy.app/data/genomes/"`',type:"string"},contigs:{description:"As an alternative for chromSizes, the contigs can be provided inline.",items:{$ref:"#/definitions/Contig"},type:"array"},name:{description:"Name of the genome assembly, e.g., `hg19` or `hg38`.",type:"string"}},required:["name"],type:"object"},Gff3Data:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounceDomainChange:{description:"The debounce time for domain changes, in milliseconds. Debouncing prevents data fetches while the user is still panning around.\n\n__Default value:__ `200`",type:"number"},indexUrl:{description:'Url of the tabix index file.\n\n__Default value:__ `url` + `".tbi"`.',type:"string"},type:{const:"gff3",type:"string"},url:{description:"Url of the bgzip compressed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the Tabix file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `30000000`",type:"number"}},required:["type","url"],type:"object"},HConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},hconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["hconcat"],type:"object"},HandledTooltip:{additionalProperties:!1,properties:{handler:{type:"string"},params:{type:"object"}},required:["handler"],type:"object"},IdentifierParams:{additionalProperties:!1,properties:{as:{description:'**Default:** `"_uniqueId"`',type:"string"},type:{const:"identifier",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},ImportConfig:{additionalProperties:!1,properties:{name:{type:"string"},params:{type:"object"},url:{type:"string"}},type:"object"},ImportSpec:{additionalProperties:!1,properties:{import:{$ref:"#/definitions/ImportConfig"}},required:["import"],type:"object"},IndexedFastaData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".fai"`.',type:"string"},type:{const:"indexedFasta",type:"string"},url:{description:"URL of the fasta file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the fasta file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `7000`",type:"number"}},required:["type","url"],type:"object"},InlineData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},values:{$ref:"#/definitions/InlineDataset",description:"The full data set, included inline. This can be an array of objects or primitive values, an object, or a string. Arrays of primitive values are ingested as objects with a `data` property. Strings are parsed according to the specified format type."}},required:["values"],type:"object"},InlineDataset:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"},{items:{type:"object"},type:"array"},{type:"string"},{type:"object"}]},JsonDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},property:{description:'The JSON property containing the desired data. This parameter can be used when the loaded JSON file may have surrounding structure or meta-data. For example `"property": "values.features"` is equivalent to retrieving `json.values.features` from the loaded JSON object.',type:"string"},type:{const:"json",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},type:"object"},LayerSpec:{additionalProperties:!1,properties:{aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}]},type:"array"},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["layer"],type:"object"},LazyData:{additionalProperties:!1,properties:{lazy:{$ref:"#/definitions/LazyDataParams"}},required:["lazy"],type:"object"},LazyDataParams:{anyOf:[{$ref:"#/definitions/AxisTicksData"},{$ref:"#/definitions/AxisGenomeData"},{$ref:"#/definitions/IndexedFastaData"},{$ref:"#/definitions/BigWigData"},{$ref:"#/definitions/BigBedData"},{$ref:"#/definitions/BamData"},{$ref:"#/definitions/Gff3Data"}]},LinearizeGenomicCoordinateParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The output field or fields for linearized coordinates."},channel:{description:'Get the genome assembly from the scale of the channel.\n\n**Default:** `"x"`',enum:["x","y"],type:"string"},chrom:{$ref:"#/definitions/Field",description:"The chromosome/contig field"},offset:{anyOf:[{type:"number"},{items:{type:"number"},type:"array"}],description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`"},pos:{anyOf:[{$ref:"#/definitions/Field"},{items:{$ref:"#/definitions/Field"},type:"array"}],description:"The field or fields that contain intra-chromosomal positions"},type:{const:"linearizeGenomicCoordinate",description:"The type of the transform to be applied",type:"string"}},required:["as","chrom","pos","type"],type:"object"},MarkConfigAndType:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},angle:{description:"The rotation angle in degrees.\n\n**Default value:** `0`",type:"number"},baseline:{$ref:"#/definitions/Baseline",description:'The vertical alignment of the text.  One of `"top"`, `"middle"`, `"bottom"`.\n\n**Default value:** `"bottom"`'},buildIndex:{description:`Builds and index for efficient rendering of subsets of the data. The data must be sorted by the x coordinate.

TODO: This should be enabled automatically if the data are sorted.`,type:"boolean"},clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{type:"string"},color2:{description:"TODO",type:"string"},cornerRadius:{description:"Radius of the rounded corners.\n\n**Default value:** `0`",type:"number"},cornerRadiusBottomLeft:{description:"Radius of the bottom left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusBottomRight:{description:"Radius of the bottom right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusTopLeft:{description:"Radius of the top left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusTopRight:{description:"Radius of the top right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},dx:{description:"The horizontal offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},dy:{description:"The vertical offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},fill:{description:"The fill color",type:"string"},fillGradientStrength:{description:"Gradient strength controls the amount of the gradient eye-candy effect in the fill color. Valid values are between 0 and 1.\n\n**Default value:** `0`",type:"number"},fillOpacity:{description:"The fill opacity. Value between [0, 1].",type:"number"},filled:{description:"Whether the `color` represents the `fill` color (`true`) or the `stroke` color (`false`).",type:"boolean"},fitToBand:{description:'If true, sets the secondary positional channel that allows the text to be squeezed (see the `squeeze` property). Can be used when: 1) `"band"`, `"index"`, or `"locus"` scale is being used and 2) only the primary positional channel is specified.\n\n**Default value:** `false`',type:"boolean"},flushX:{description:"If true, the text is kept inside the viewport when the range of `x` and `x2` intersect the viewport.",type:"boolean"},flushY:{description:"If true, the text is kept inside the viewport when the range of `y` and `y2` intersect the viewport.",type:"boolean"},font:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},fontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},fontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},geometricZoomBound:{description:"Enables geometric zooming. The value is the base two logarithmic zoom level where the maximum point size is reached.\n\n**Default value:** `0`",type:"number"},inwardStroke:{description:"Should the stroke only grow inwards, e.g, the diameter/outline is not affected by the stroke width. Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with geometric zoom, etc.\n\n**Default value:** `false`",type:"boolean"},logoLetters:{description:"Stretch letters so that they can be used with [sequence logos](https://en.wikipedia.org/wiki/Sequence_logo), etc...",type:"boolean"},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minHeight:{description:"The minimum height of a rectangle in pixels. The property clamps rectangles' heights.\n\n**Default value:** `0`",type:"number"},minLength:{description:"The minimum length of the rule in pixels. Use this property to ensure that very short ranged rules remain visible even when the user zooms out.\n\n**Default value:** `0`",type:"number"},minOpacity:{description:"Clamps the minimum size-dependent opacity. The property does not affect the `opacity` channel. Valid values are between `0` and `1`.\n\nWhen a rectangle would be smaller than what is specified in `minHeight` and `minWidth`, it is faded out proportionally. Example: a rectangle would be rendered as one pixel wide, but `minWidth` clamps it to five pixels. The rectangle is actually rendered as five pixels wide, but its opacity is multiplied by 0.2. With this setting, you can limit the factor to, for example, 0.5 to keep the rectangles more clearly visible.\n\n**Default value:** `0`",type:"number"},minSagittaLength:{description:"Minimum length of the arc's sagitta. Makes very short links more clearly visible.\n\n**Default value:** `1.5`",type:"number"},minWidth:{description:`The minimum width of a rectangle in pixels. The property clamps rectangles' widths when the viewport is zoomed out.

This property also reduces flickering of very narrow rectangles when zooming. The value should generally be at least one.

**Default value:** \`1\``,type:"number"},opacity:{type:"number"},paddingX:{description:"The horizontal padding, in pixels, when the `x2` channel is used for ranged text.\n\n**Default value:** `0`",type:"number"},paddingY:{description:"The vertical padding, in pixels, when the `y2` channel is used for ranged text.\n\n**Default value:** `0`",type:"number"},sagittaScaleFactor:{description:"Scaling factor of the arc's sagitta. The default value `1.0` produces roughly circular arcs.\n\n**Default value:** `1.0`",type:"number"},sampleFacetPadding:{description:"Padding between sample facet's upper/lower edge and the maximum point size. This property controls how tightly points are squeezed when facet's height is smaller than the maximum point size. The unit is a proportion of facet's height. The value must be between `0` and `0.5`. This property has no effect when sample faceting is not used.\n\n**Default value:** `0.1`",type:"number"},segments:{description:"The number of segments in the bézier curve. Affects the rendering quality and performance. Use a higher value for a smoother curve.\n\n**Default value:* `101`",type:"number"},semanticZoomFraction:{description:"TODO\n\n**Default value:** `0.02`",type:"number"},shape:{description:'One of `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, or `"triangle-left"`.\n\n**Default value:** `"circle"`',type:"string"},size:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},size2:{description:"TODO",type:"number"},squeeze:{description:"If the `squeeze` property is true and secondary positional channels (`x2` and/or `y2`) are used, the text is scaled to fit mark's width and/or height.\n\n**Default value:** `true`",type:"boolean"},stroke:{description:"The stroke color",type:"string"},strokeCap:{description:'The style of stroke ends. Available choices: `"butt"`, `"round`", and `"square"`.\n\n**Default value:** `"butt"`',enum:["butt","square","round"],type:"string"},strokeDash:{description:"An array of of alternating stroke and gap lengths or `null` for solid strokes.\n\n**Default value:** `null`",items:{type:"number"},type:"array"},strokeDashOffset:{description:"An offset for the stroke dash pattern.\n\n**Default value:** `0`",type:"number"},strokeOpacity:{description:"The stroke opacity. Value between [0, 1].",type:"number"},strokeWidth:{description:"The stroke width in pixels.",type:"number"},text:{$ref:"#/definitions/Scalar",description:'The text to display. The format of numeric data can be customized by setting a [format specifier](https://github.com/d3/d3-format#locale_format) to channel definition\'s `format` property.\n\n**Default value:** `""`'},tooltip:{$ref:"#/definitions/Tooltip",description:"TODO"},type:{$ref:"#/definitions/MarkType"},viewportEdgeFadeDistanceBottom:{type:"number"},viewportEdgeFadeDistanceLeft:{type:"number"},viewportEdgeFadeDistanceRight:{type:"number"},viewportEdgeFadeDistanceTop:{type:"number"},viewportEdgeFadeWidthBottom:{type:"number"},viewportEdgeFadeWidthLeft:{type:"number"},viewportEdgeFadeWidthRight:{type:"number"},viewportEdgeFadeWidthTop:{type:"number"},x:{type:"number"},x2:{type:"number"},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{type:"number"},y2:{type:"number"},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},"MarkPropDatumDef<Type>":{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"MarkPropDatumDef<TypeForShape>":{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/TypeForShape"}},required:["type"],type:"object"},"MarkPropDef<string,(string|null),TypeForShape>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CTypeForShape%3E"},{$ref:"#/definitions/ValueDef%3C(string%7Cnull)%3E"}]},"MarkPropDef<string,(string|null)>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CType%3E"},{$ref:"#/definitions/ValueDef%3C(string%7Cnull)%3E"}]},"MarkPropDef<string,number>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CType%3E"},{$ref:"#/definitions/ValueDef%3Cnumber%3E"}]},MarkPropExprDef:{additionalProperties:!1,properties:{expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},"MarkPropFieldDef<string,Type>":{additionalProperties:!1,description:"Field definition of a mark property, which can contain a legend.",properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"MarkPropFieldDef<string,TypeForShape>":{additionalProperties:!1,description:"Field definition of a mark property, which can contain a legend.",properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/TypeForShape"}},required:["type"],type:"object"},"MarkPropFieldOrDatumOrExprDef<string,Type>":{anyOf:[{$ref:"#/definitions/MarkPropFieldDef%3Cstring%2CType%3E"},{$ref:"#/definitions/MarkPropDatumDef%3CType%3E"},{$ref:"#/definitions/MarkPropExprDef"}]},"MarkPropFieldOrDatumOrExprDef<string,TypeForShape>":{anyOf:[{$ref:"#/definitions/MarkPropFieldDef%3Cstring%2CTypeForShape%3E"},{$ref:"#/definitions/MarkPropDatumDef%3CTypeForShape%3E"},{$ref:"#/definitions/MarkPropExprDef"}]},MarkType:{enum:["rect","point","rule","text","link"],type:"string"},MeasureTextParams:{additionalProperties:!1,properties:{as:{type:"string"},field:{$ref:"#/definitions/Field"},fontSize:{type:"number"},type:{const:"measureText",description:"The type of the transform to be applied",type:"string"}},required:["as","field","fontSize","type"],type:"object"},MergeFacetsParams:{additionalProperties:!1,properties:{type:{const:"mergeFacets",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},NamedData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["name"],type:"object"},NumericDomain:{items:{type:"number"},type:"array"},"NumericMarkPropDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2Cnumber%3E"},NumericValueDef:{$ref:"#/definitions/ValueDef%3Cnumber%3E"},OtherDataFormat:{additionalProperties:!1,description:'Other data format, such as `"fasta"`',properties:{type:{type:"string"}},required:["type"],type:"object"},PaddingConfig:{anyOf:[{$ref:"#/definitions/Paddings"},{type:"number"}]},Paddings:{additionalProperties:!1,properties:{bottom:{type:"number"},left:{type:"number"},right:{type:"number"},top:{type:"number"}},type:"object"},Parse:{additionalProperties:{$ref:"#/definitions/ParseValue"},type:"object"},ParseValue:{anyOf:[{type:"null"},{type:"string"},{const:"string",type:"string"},{const:"boolean",type:"string"},{const:"date",type:"string"},{const:"number",type:"string"}]},PileupParams:{additionalProperties:!1,properties:{as:{description:'The output field name for the computed lane.\n\n**Default:** `"lane"`.',type:"string"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},preference:{$ref:"#/definitions/Field",description:"An optional field indicating the preferred lane. Use together with the `preferredOrder` property."},preferredOrder:{anyOf:[{items:{type:"string"},type:"array"},{items:{type:"number"},type:"array"},{items:{type:"boolean"},type:"array"}],description:"The order of the lane preferences. The first element contains the value that should place the segment on the first lane and so forth. If the preferred lane is occupied, the first available lane is taken."},spacing:{description:"The spacing between adjacent segments on the same lane in coordinate units.\n\n**Default:** `1`.",type:"number"},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"pileup",description:"The type of the transform to be applied",type:"string"}},required:["end","start","type"],type:"object"},"Position2Def<string>":{anyOf:[{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},{$ref:"#/definitions/SecondaryChromPosDef"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"}},required:["expr"],type:"object"},{$ref:"#/definitions/PositionValueDef"}]},PositionDatumDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"PositionDef<string>":{anyOf:[{$ref:"#/definitions/PositionFieldDef%3Cstring%3E"},{$ref:"#/definitions/ChromPosDef"},{$ref:"#/definitions/PositionDatumDef"},{$ref:"#/definitions/PositionExprDef"},{$ref:"#/definitions/PositionValueDef"}]},PositionExprDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},"PositionFieldDef<string>":{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},PositionValueDef:{$ref:"#/definitions/NumericValueDef"},PositionalChannel:{anyOf:[{$ref:"#/definitions/PrimaryPositionalChannel"},{$ref:"#/definitions/SecondaryPositionalChannel"}]},PrimaryPositionalChannel:{enum:["x","y"],type:"string"},ProjectParams:{additionalProperties:!1,properties:{as:{description:"New names for the projected fields. If omitted, the names of the source fields are used.",items:{type:"string"},type:"array"},fields:{description:"The fields to be projected.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"project",description:"The type of the transform to be applied",type:"string"}},required:["fields","type"],type:"object"},RegexExtractParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The new field or an array of fields where the extracted values are written."},field:{$ref:"#/definitions/Field",description:"The source field"},regex:{description:'A valid JavaScript regular expression with at least one group. For example: `"^Sample(\\\\d+)$"`.\n\nRead more at: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions',type:"string"},skipInvalidInput:{description:"Do not complain about invalid input. Just skip it and leave the new fields undefined on the affected datum.\n\n**Default:** `false`",type:"boolean"},type:{const:"regexExtract",description:"The type of the transform to be applied",type:"string"}},required:["as","field","regex","type"],type:"object"},RegexFoldParams:{additionalProperties:!1,properties:{asKey:{description:'**Default:** `"sample"`',type:"string"},asValue:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A new column name for the extracted values."},columnRegex:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A regular expression that matches to column names. The regex must have one capturing group that is used for extracting the key (e.g., a sample id) from the column name."},skipRegex:{description:"An optional regex that matches to fields that should not be included in the new folded data objects.",type:"string"},type:{const:"regexFold",description:"The type of the transform to be applied",type:"string"}},required:["asValue","columnRegex","type"],type:"object"},ResolutionBehavior:{description:'`"independent"` and `"shared"` behave similarly to Vega-Lite. `"excluded"` behaves like `"shared"`, but is not pulled towards the root. `"forced"` behaves like `"shared"`, but is forced towards the root even if the parent has `"independent"` behavior.',enum:["independent","shared","excluded","forced"],type:"string"},RootSpec:{anyOf:[{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkConfigAndType"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["mark"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}]},type:"array"},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["layer"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["samples","spec"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["vconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},hconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["hconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},columns:{type:"number"},concat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["columns","concat"],type:"object"}]},SampleAttributeDef:{additionalProperties:!1,properties:{barScale:{$ref:"#/definitions/Scale",description:"An optional scale definition for mapping the attribute to the width of a metadata rectangle."},scale:{$ref:"#/definitions/Scale",description:"Scale definition for the (default) color channel"},type:{$ref:"#/definitions/Type",description:'The attribute type. One of `"nominal"`, `"ordinal"`, or `"quantitative"`.'},visible:{description:"Whether the attribute is visible by default.",type:"boolean"},width:{description:"Width of the column in pixels.",type:"number"}},required:["type"],type:"object"},SampleDef:{additionalProperties:!1,properties:{attributeLabelAngle:{description:"Angle to be added to the default label angle (-90).\n\n**Default value:** `0`",type:"number"},attributeLabelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},attributeLabelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},attributeLabelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},attributeLabelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},attributeSize:{description:"Default size (width) of the metadata attribute columns. Can be configured per attribute using the `attributes` property.\n\n**Default value:** `10`",type:"number"},attributeSpacing:{description:"Spacing between attribute columns in pixels.\n\n**Default value:** `1`",type:"number"},attributes:{additionalProperties:{$ref:"#/definitions/SampleAttributeDef"},description:"Explicitly specify the sample attributes.",type:"object"},data:{$ref:"#/definitions/Data",description:"Optional metadata about the samples."},labelAlign:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},labelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},labelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},labelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},labelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},labelLength:{description:"How much space in pixels to reserve for the labels.\n\n**Default:** `140`",type:"number"},labelTitleText:{description:'Text in the label title\n\n**Default:** `"Sample name"`',type:"string"}},type:"object"},SampleParams:{additionalProperties:!1,properties:{size:{description:"The maximum sample size.\n\n**Default:** `500`",type:"number"},type:{const:"sample",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},SampleSpec:{additionalProperties:!1,description:"A view specification for a SampleView. This is only functional in the GenomeSpy app.",properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["samples","spec"],type:"object"},Scalar:{type:["string","number","boolean"]},ScalarDomain:{anyOf:[{$ref:"#/definitions/NumericDomain"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"}]},Scale:{additionalProperties:!1,properties:{align:{description:"The alignment of the steps within the scale range.\n\nThis value must lie in the range `[0,1]`. A value of `0.5` indicates that the steps should be centered within the range. A value of `0` or `1` may be used to shift the bands to one side, say to position them adjacent to an axis.\n\n__Default value:__ `0.5`",type:"number"},base:{description:"The logarithm base of the `log` scale (default `10`).",type:"number"},bins:{description:"An array of bin boundaries over the scale domain. If provided, axes and legends will use the bin boundaries to inform the choice of tick marks and text labels.",items:{type:"number"},type:"array"},clamp:{description:"If `true`, values that exceed the data domain are clamped to either the minimum or maximum range value\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/config.html#scale-config)'s `clamp` (`true` by default).",type:"boolean"},constant:{description:"A constant determining the slope of the symlog function around zero. Only used for `symlog` scales.\n\n__Default value:__ `1`",type:"number"},domain:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"Customized domain values.\n\nFor _quantitative_ fields, `domain` can take the form of a two-element array with minimum and maximum values.  [Piecewise scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise) can be created by providing a `domain` with more than two entries.\n\nFor _temporal_ fields, `domain` can be a two-element array minimum and maximum values, in the form of either timestamps or the [DateTime definition objects](https://vega.github.io/vega-lite/docs/types.html#datetime).\n\nFor _ordinal_ and _nominal_ fields, `domain` can be an array that lists valid input values."},domainMax:{description:"Sets the maximum value in the scale domain, overriding the `domain` property. This property is only intended for use with scales having continuous domains.",type:"number"},domainMid:{description:"Inserts a single mid-point value into a two-element domain. The mid-point value must lie between the domain minimum and maximum values. This property can be useful for setting a midpoint for [diverging color scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise). The domainMid property is only intended for use with scales supporting continuous, piecewise domains.",type:"number"},domainMin:{description:"Sets the minimum value in the scale domain, overriding the domain property. This property is only intended for use with scales having continuous domains.",type:"number"},exponent:{description:"The exponent of the `pow` scale.",type:"number"},interpolate:{anyOf:[{$ref:"#/definitions/ScaleInterpolate"},{$ref:"#/definitions/ScaleInterpolateParams"}],description:"The interpolation method for range values. By default, a general interpolator for numbers, dates, strings and colors (in HCL space) is used. For color ranges, this property allows interpolation in alternative color spaces. Legal values include `rgb`, `hsl`, `hsl-long`, `lab`, `hcl`, `hcl-long`, `cubehelix` and `cubehelix-long` ('-long' variants use longer paths in polar coordinate spaces). If object-valued, this property accepts an object with a string-valued _type_ property and an optional numeric _gamma_ property applicable to rgb and cubehelix interpolators. For more, see the [d3-interpolate documentation](https://github.com/d3/d3-interpolate).\n\n__Default value:__ `hcl`"},name:{description:"The name of the scale. Names are optional but allow the scales to be referenced and found with the API.",type:"string"},nice:{anyOf:[{type:"boolean"},{type:"number"},{additionalProperties:!1,properties:{interval:{type:"string"},step:{type:"number"}},required:["interval","step"],type:"object"}],description:"Extending the domain so that it starts and ends on nice round values. This method typically modifies the scale’s domain, and may only extend the bounds to the nearest round value. Nicing is useful if the domain is computed from data and may be irregular. For example, for a domain of _[0.201479…, 0.996679…]_, a nice domain might be _[0.2, 1.0]_.\n\nFor quantitative scales such as linear, `nice` can be either a boolean flag or a number. If `nice` is a number, it will represent a desired tick count. This allows greater control over the step size used to extend the bounds, guaranteeing that the returned ticks will exactly cover the domain.\n\n__Default value:__ `true` for unbinned _quantitative_ fields; `false` otherwise."},padding:{description:"For _[continuous](https://vega.github.io/vega-lite/docs/scale.html#continuous)_ scales, expands the scale domain to accommodate the specified number of pixels on each of the scale range. The scale range must represent pixels for this parameter to function as intended. Padding adjustment is performed prior to all other adjustments, including the effects of the `zero`, `nice`, `domainMin`, and `domainMax` properties.\n\nFor _[band](https://vega.github.io/vega-lite/docs/scale.html#band)_ scales, shortcut for setting `paddingInner` and `paddingOuter` to the same value.\n\nFor _[point](https://vega.github.io/vega-lite/docs/scale.html#point)_ scales, alias for `paddingOuter`.\n\n__Default value:__ For _continuous_ scales, derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `continuousPadding`. For _band and point_ scales, see `paddingInner` and `paddingOuter`.  By default, Vega-Lite sets padding such that _width/height = number of unique values * step_.",minimum:0,type:"number"},paddingInner:{description:`The inner padding (spacing) within each band step of band scales, as a fraction of the step size. This value must lie in the range [0,1].

For point scale, this property is invalid as point scales do not have internal band widths (only step sizes between bands).

__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s \`bandPaddingInner\`.`,maximum:1,minimum:0,type:"number"},paddingOuter:{description:"The outer padding (spacing) at the ends of the range of band and point scales, as a fraction of the step size. This value must lie in the range [0,1].\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `bandPaddingOuter` for band scales and `pointPadding` for point scales. By default, Vega-Lite sets outer padding such that _width/height = number of unique values * step_.",maximum:1,minimum:0,type:"number"},range:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{type:"string"}],description:'The range of the scale. One of:\n\n- A string indicating a [pre-defined named scale range](https://vega.github.io/vega-lite/docs/scale.html#range-config) (e.g., example, `"symbol"`, or `"diverging"`).\n\n- For [continuous scales](https://vega.github.io/vega-lite/docs/scale.html#continuous), two-element array indicating  minimum and maximum values, or an array with more than two entries for specifying a [piecewise scale](https://vega.github.io/vega-lite/docs/scale.html#piecewise).\n\n- For [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) and [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales, an array of desired output values.\n\n__Notes:__\n\n1) For color scales you can also specify a color [`scheme`](https://vega.github.io/vega-lite/docs/scale.html#scheme) instead of `range`.\n\n2) Any directly specified `range` for `x` and `y` channels will be ignored. Range can be customized via the view\'s corresponding [size](https://vega.github.io/vega-lite/docs/size.html) (`width` and `height`).'},reverse:{description:"If true, reverses the order of the scale range.\n\n__Default value:__ `false`.",type:"boolean"},round:{description:"If `true`, rounds numeric output values to integers. This can be helpful for snapping to the pixel grid.\n\n__Default value:__ `false`.",type:"boolean"},scheme:{anyOf:[{type:"string"},{$ref:"#/definitions/SchemeParams"}],description:'A string indicating a color [scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme) name (e.g., `"category10"` or `"blues"`) or a [scheme parameter object](https://vega.github.io/vega-lite/docs/scale.html#scheme-params).\n\nDiscrete color schemes may be used with [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) or [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales. Continuous color schemes are intended for use with color scales.\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.'},type:{$ref:"#/definitions/ScaleType",description:'The type of scale.  Vega-Lite supports the following categories of scale types:\n\n1) [**Continuous Scales**](https://vega.github.io/vega-lite/docs/scale.html#continuous) -- mapping continuous domains to continuous output ranges ([`"linear"`](https://vega.github.io/vega-lite/docs/scale.html#linear), [`"pow"`](https://vega.github.io/vega-lite/docs/scale.html#pow), [`"sqrt"`](https://vega.github.io/vega-lite/docs/scale.html#sqrt), [`"symlog"`](https://vega.github.io/vega-lite/docs/scale.html#symlog), [`"log"`](https://vega.github.io/vega-lite/docs/scale.html#log), [`"time"`](https://vega.github.io/vega-lite/docs/scale.html#time), [`"utc"`](https://vega.github.io/vega-lite/docs/scale.html#utc).\n\n2) [**Discrete Scales**](https://vega.github.io/vega-lite/docs/scale.html#discrete) -- mapping discrete domains to discrete ([`"ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#ordinal)) or continuous ([`"band"`](https://vega.github.io/vega-lite/docs/scale.html#band) and [`"point"`](https://vega.github.io/vega-lite/docs/scale.html#point)) output ranges.\n\n3) [**Discretizing Scales**](https://vega.github.io/vega-lite/docs/scale.html#discretizing) -- mapping continuous domains to discrete output ranges [`"bin-ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#bin-ordinal), [`"quantile"`](https://vega.github.io/vega-lite/docs/scale.html#quantile), [`"quantize"`](https://vega.github.io/vega-lite/docs/scale.html#quantize) and [`"threshold"`](https://vega.github.io/vega-lite/docs/scale.html#threshold).\n\n__Default value:__ please see the [scale type table](https://vega.github.io/vega-lite/docs/scale.html#type).'},zero:{description:"If `true`, ensures that a zero baseline value is included in the scale domain.\n\n__Default value:__ `true` for x and y channels if the quantitative field is not binned and no custom `domain` is provided; `false` otherwise.\n\n__Note:__ Log, time, and utc scales do not support `zero`.",type:"boolean"},zoom:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ZoomParams"}],description:"If `true` and the scale is used on a positional channel, it can bee zoomed and translated interactively."}},type:"object"},ScaleInterpolate:{enum:["rgb","lab","hcl","hsl","hsl-long","hcl-long","cubehelix","cubehelix-long"],type:"string"},ScaleInterpolateParams:{additionalProperties:!1,properties:{gamma:{type:"number"},type:{enum:["rgb","cubehelix","cubehelix-long"],type:"string"}},required:["type"],type:"object"},ScaleType:{enum:["null","linear","log","pow","sqrt","symlog","identity","sequential","quantize","threshold","ordinal","point","band","index","locus"],type:"string"},SchemeParams:{additionalProperties:!1,properties:{count:{description:'The number of colors to use in the scheme. This can be useful for scale types such as `"quantize"`, which use the length of the scale range to determine the number of discrete bins for the scale domain.',type:"number"},extent:{description:"The extent of the color range to use. For example `[0.2, 1]` will rescale the color scheme such that color values in the range _[0, 0.2)_ are excluded from the scheme.",items:{type:"number"},type:"array"},name:{description:'A color scheme name for ordinal scales (e.g., `"category10"` or `"blues"`).\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.',type:"string"}},required:["name"],type:"object"},SecondaryChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},required:["chrom"],type:"object"},SecondaryPositionalChannel:{enum:["x2","y2"],type:"string"},SequenceGenerator:{additionalProperties:!1,properties:{name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},sequence:{$ref:"#/definitions/SequenceParams",description:"Generate a sequence of numbers."}},required:["sequence"],type:"object"},SequenceParams:{additionalProperties:!1,properties:{as:{$ref:"#/definitions/FieldName",description:'The name of the generated sequence field.\n\n__Default value:__ `"data"`'},start:{description:"The starting value of the sequence (inclusive).",type:"number"},step:{description:"The step value between sequence entries.\n\n__Default value:__ `1`",type:"number"},stop:{description:"The ending value of the sequence (exclusive).",type:"number"}},required:["start","stop"],type:"object"},"ShapeDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2C(string%7Cnull)%2CTypeForShape%3E"},SizeDef:{additionalProperties:!1,properties:{grow:{description:"Share of the remaining space",type:"number"},px:{description:"Size in pixels",type:"number"}},type:"object"},SortOrder:{enum:["ascending","descending"],type:"string"},StackParams:{additionalProperties:!1,properties:{as:{description:'Fields to write the stacked values.\n\n**Default:** `["y0", "y1"]`',items:{type:"string"},type:"array"},baseField:{$ref:"#/definitions/Field",description:'The field that contains the base or amino acid. Used for information content calculation when the offset is `"information"`. The data objects that have `null` in the baseField are considered gaps and they are taken into account when scaling the the locus\' information content.'},cardinality:{description:'Cardinality, e.g., the number if distinct bases or amino acids. Used for information content calculation when the offset is `"information"`.\n\n**Default:** `4`',type:"number"},field:{$ref:"#/definitions/Field",description:"The field to stack. If no field is defined, a constant value of one is assumed."},groupby:{description:"The fields to be used for forming groups for different stacks.",items:{$ref:"#/definitions/Field"},type:"array"},offset:{description:'How to offset the values in a stack. `"zero"` (default) starts stacking at 0. `"center"` centers the values around zero. `"normalize"` computes intra-stack percentages and normalizes the values to the range of `[0, 1]`. `"information"` computes a layout for a sequence logo. The total height of the stack reflects the group\'s information content.',enum:["zero","center","normalize","information"],type:"string"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order of data in each stack."},type:{const:"stack",description:"The type of the transform to be applied",type:"string"}},required:["as","groupby","type"],type:"object"},Step:{additionalProperties:!1,properties:{step:{type:"number"}},required:["step"],type:"object"},StringDatumDef:{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},"StringFieldDef<string>":{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},"TextDef<string>":{anyOf:[{$ref:"#/definitions/StringFieldDef%3Cstring%3E"},{$ref:"#/definitions/StringDatumDef"},{$ref:"#/definitions/ExprDef"}]},Title:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'Horizontal text alignment for title text. One of `"left"`, `"center"`, or `"right"`.'},anchor:{$ref:"#/definitions/TitleAnchor",description:'The anchor position for placing the title and subtitle text. One of `"start"`, `"middle"`, or `"end"`. For example, with an orientation of top these anchor positions map to a left-, center-, or right-aligned title.'},angle:{description:"Angle in degrees of title and subtitle text.",type:"number"},baseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline for title and subtitle text. One of `"alphabetic"` (default), `"top"`, `"middle"`, or `"bottom"`.'},color:{description:"Text color for title text.",type:"string"},dx:{description:"Delta offset for title and subtitle text x-coordinate.",type:"number"},dy:{description:"Delta offset for title and subtitle text y-coordinate.",type:"number"},font:{description:"Font name for title text.",type:"string"},fontSize:{description:"Font size in pixels for title text.",minimum:0,type:"number"},fontStyle:{$ref:"#/definitions/FontStyle",description:"Font style for title text."},fontWeight:{$ref:"#/definitions/FontWeight",description:'Font weight for title text. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).'},frame:{$ref:"#/definitions/TitleFrame",description:'The reference frame for the anchor position, one of `"bounds"` (to anchor relative to the full bounding box) or `"group"` (to anchor relative to the group width or height).'},offset:{description:"The orthogonal offset in pixels by which to displace the title group from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/TitleOrient",description:'Default title orientation (`"top"`, `"bottom"`, `"left"`, or `"right"`)'},style:{description:'A mark style property to apply to the title text mark. If not specified, a default style of `"group-title"` is applied.',type:"string"},text:{description:"The title text.",type:"string"}},required:["text"],type:"object"},TitleAnchor:{enum:[null,"start","middle","end"],type:["null","string"]},TitleFrame:{enum:["bounds","group"],type:"string"},TitleOrient:{enum:["none","left","right","top","bottom"],type:"string"},Tooltip:{anyOf:[{$ref:"#/definitions/HandledTooltip"},{type:"null"}]},TransformParams:{anyOf:[{$ref:"#/definitions/AggregateParams"},{$ref:"#/definitions/CollectParams"},{$ref:"#/definitions/CoverageParams"},{$ref:"#/definitions/FlattenDelimitedParams"},{$ref:"#/definitions/FormulaParams"},{$ref:"#/definitions/FilterParams"},{$ref:"#/definitions/FilterScoredLabelsParams"},{$ref:"#/definitions/FlattenParams"},{$ref:"#/definitions/FlattenCompressedExonsParams"},{$ref:"#/definitions/FlattenSequenceParams"},{$ref:"#/definitions/IdentifierParams"},{$ref:"#/definitions/LinearizeGenomicCoordinateParams"},{$ref:"#/definitions/MeasureTextParams"},{$ref:"#/definitions/MergeFacetsParams"},{$ref:"#/definitions/PileupParams"},{$ref:"#/definitions/ProjectParams"},{$ref:"#/definitions/RegexExtractParams"},{$ref:"#/definitions/RegexFoldParams"},{$ref:"#/definitions/SampleParams"},{$ref:"#/definitions/StackParams"}]},Type:{enum:["quantitative","ordinal","nominal","index","locus"],type:"string"},TypeForShape:{enum:["ordinal","nominal"],type:"string"},UnitSpec:{additionalProperties:!1,properties:{aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkConfigAndType"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["mark"],type:"object"},UrlData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},url:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"An URL or an array of URLs from which to load the data set. Use the `format.type` property to ensure the loaded data is correctly parsed."}},required:["url"],type:"object"},VConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["vconcat"],type:"object"},"ValueDef<(string|null)>":{additionalProperties:!1,properties:{title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).',type:["string","null"]}},required:["value"],type:"object"},"ValueDef<number>":{additionalProperties:!1,properties:{title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).',type:"number"}},required:["value"],type:"object"},ViewBackground:{additionalProperties:!1,properties:{fill:{description:"The fill color",type:"string"},fillOpacity:{description:"The fill opacity. Value between [0, 1].",type:"number"},stroke:{description:"The stroke color",type:"string"},strokeOpacity:{description:"The stroke opacity. Value between [0, 1].",type:"number"},strokeWidth:{type:"number"}},type:"object"},ViewOpacityDef:{anyOf:[{type:"number"},{$ref:"#/definitions/DynamicOpacity"}]},ViewSpec:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/SampleSpec"},{$ref:"#/definitions/VConcatSpec"},{$ref:"#/definitions/HConcatSpec"},{$ref:"#/definitions/ConcatSpec"}]},ZoomParams:{additionalProperties:!1,properties:{extent:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"The boundaries that limit the zoom and pan interactions."}},type:"object"}},fG={$ref:vUe,$schema:wUe,definitions:yUe},CUe="@genome-spy/playground",SUe="0.37.4",xUe="A playground for testing GenomeSpy visualizations",kUe={dev:"vite",build:"vite build",serve:"vite preview"},LUe="Kari Lavikka",DUe="MIT",EUe={"@fortawesome/fontawesome-free":"^6.1.1","@fortawesome/fontawesome-svg-core":"^6.1.1","@fortawesome/free-solid-svg-icons":"^6.1.1","@genome-spy/core":"^0.37.4",lit:"^3.0.2","monaco-editor":"^0.44.0","vega-loader":"^4.4.0"},gG={name:CUe,private:!0,version:SUe,description:xUe,scripts:kUe,author:LUe,license:DUe,dependencies:EUe},TUe="modulepreload",AUe=function(n,e){return new URL(n,e).href},pG={},IUe=function(e,t,i){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=AUe(r,i),r in pG)return;pG[r]=!0;const o=r.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let u=s.length-1;u>=0;u--){const h=s[u];if(h.href===r&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":TUe,o||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),o)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})};/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.44.0(3e047efd345ff102c8c61b5398fb30845aaac166)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var NUe=Object.defineProperty,RUe=Object.getOwnPropertyDescriptor,MUe=Object.getOwnPropertyNames,FUe=Object.prototype.hasOwnProperty,mG=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of MUe(e))!FUe.call(n,s)&&s!==t&&NUe(n,s,{get:()=>e[s],enumerable:!(i=RUe(e,s))||i.enumerable});return n},PUe=(n,e,t)=>(mG(n,e,"default"),t&&mG(t,e,"default")),FS={};PUe(FS,bUe);var OUe=class{constructor(n,e,t){Rn(this,"_onDidChange",new FS.Emitter);Rn(this,"_diagnosticsOptions");Rn(this,"_modeConfiguration");Rn(this,"_languageId");this._languageId=n,this.setDiagnosticsOptions(e),this.setModeConfiguration(t)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(n){this._diagnosticsOptions=n||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(n){this._modeConfiguration=n||Object.create(null),this._onDidChange.fire(this)}},BUe={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},WUe={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},Goe=new OUe("json",BUe,WUe);FS.languages.json={jsonDefaults:Goe};function VUe(){return IUe(()=>import("./jsonMode-129a63e4.js"),[],import.meta.url)}FS.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});FS.languages.onLanguage("json",()=>{VUe().then(n=>n.setupMode(Goe))});const $Ue={0:" ",1:"u",2:"r"},_G=65535,nl=16777215,bG=4278190080;class jR{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,s=e%32,r=this._states[i];t?this._states[i]=r|1<<s:this._states[i]=r&~(1<<s)}}class Jr{constructor(e,t,i){if(e.length!==t.length||e.length>_G)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new jR(e.length),this._userDefinedStates=new jR(e.length),this._recoveredStates=new jR(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,s)=>{const r=e[e.length-1];return this.getStartLineNumber(r)<=i&&this.getEndLineNumber(r)>=s};for(let i=0,s=this._startIndexes.length;i<s;i++){const r=this._startIndexes[i],o=this._endIndexes[i];if(r>nl||o>nl)throw new Error("startLineNumber or endLineNumber must not exceed "+nl);for(;e.length>0&&!t(r,o);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=r+((a&255)<<24),this._endIndexes[i]=o+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&nl}getEndLineNumber(e){return this._endIndexes[e]&nl}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let s=0;s<this._types.length;s++)this._types[s]===e&&(this.setCollapsed(s,t),i=!0);return i}toRegion(e){return new zUe(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&bG)>>>24)+((this._endIndexes[e]&bG)>>>16);return t===_G?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const s=Math.floor((t+i)/2);e<this.getStartLineNumber(s)?i=s:t=s+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${$Ue[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&nl,endLineNumber:this._endIndexes[e]&nl,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),s=new Uint32Array(t);let r=[],o=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,s[l]=c.endLineNumber,r.push(c.type),c.type&&(o=!0)}o||(r=void 0);const a=new Jr(i,s,r);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i){i=i??Number.MAX_VALUE;const s=(p,m)=>Array.isArray(p)?b=>b<m?p[b]:void 0:b=>b<m?p.toFoldRange(b):void 0,r=s(e,e.length),o=s(t,t.length);let a=0,l=0,c=r(0),u=o(0);const h=[];let d,f=0;const g=[];for(;c||u;){let p;if(u&&(!c||c.startLineNumber>=u.startLineNumber))c&&c.startLineNumber===u.startLineNumber?(u.source===1?p=u:(p=c,p.isCollapsed=u.isCollapsed&&c.endLineNumber===u.endLineNumber,p.source=0),c=r(++a)):(p=u,u.isCollapsed&&u.source===0&&(p.source=2)),u=o(++l);else{let m=l,b=u;for(;;){if(!b||b.startLineNumber>c.endLineNumber){p=c;break}if(b.source===1&&b.endLineNumber>c.endLineNumber)break;b=o(++m)}c=r(++a)}if(p){for(;d&&d.endLineNumber<p.startLineNumber;)d=h.pop();p.endLineNumber>p.startLineNumber&&p.startLineNumber>f&&p.endLineNumber<=i&&(!d||d.endLineNumber>=p.endLineNumber)&&(g.push(p),f=p.startLineNumber,d&&h.push(d),d=p)}}return g}}class zUe{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class HUe{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new G,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new Jr(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,s)=>i.regionIndex-s.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let s=0,r=-1,o=-1;const a=l=>{for(;s<l;){const c=this._regions.getEndLineNumber(s),u=this._regions.isCollapsed(s);if(c<=r){const h=this.regions.getSource(s)!==0;i.changeDecorationOptions(this._editorDecorationIds[s],this._decorationProvider.getDecorationOption(u,c<=o,h))}u&&c>o&&(o=c),s++}};for(const l of e){const c=l.regionIndex,u=this._editorDecorationIds[c];if(u&&!t[u]){t[u]=!0,a(c);const h=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,h),r=Math.max(r,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=s=>{for(const r of e)if(!(r.startLineNumber>s.endLineNumber||s.startLineNumber>r.endLineNumber))return!0;return!1};for(let s=0;s<this._regions.length;s++){const r=this._regions.toFoldRange(s);(r.source===0||!i(r))&&t.push(r)}this.updatePost(Jr.fromFoldRanges(t))}update(e,t=[]){const i=this._currentFoldedOrManualRanges(t),s=Jr.sanitizeAndMerge(e,i,this._textModel.getLineCount());this.updatePost(Jr.fromFoldRanges(s))}updatePost(e){const t=[];let i=-1;for(let s=0,r=e.length;s<r;s++){const o=e.getStartLineNumber(s),a=e.getEndLineNumber(s),l=e.isCollapsed(s),c=e.getSource(s)!==0,u={startLineNumber:o,startColumn:this._textModel.getLineMaxColumn(o),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:u,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(s=>this._editorDecorationIds=s.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e=[]){const t=(s,r)=>{for(const o of e)if(s<o&&o<=r)return!0;return!1},i=[];for(let s=0,r=this._regions.length;s<r;s++){let o=this.regions.isCollapsed(s);const a=this.regions.getSource(s);if(o||a!==0){const l=this._regions.toFoldRange(s),c=this._textModel.getDecorationRange(this._editorDecorationIds[s]);c&&(o&&t(c.startLineNumber,c.endLineNumber)&&(o=!1),i.push({startLineNumber:c.startLineNumber,endLineNumber:c.endLineNumber,type:l.type,isCollapsed:o,source:a}))}}return i}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let s=0,r=e.length;s<r;s++){const o=e[s];if(o.startLineNumber>=o.endLineNumber||o.startLineNumber<1||o.endLineNumber>i)continue;const a=this._getLinesChecksum(o.startLineNumber+1,o.endLineNumber);t.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,isCollapsed:o.isCollapsed,source:o.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){var t,i;if(!Array.isArray(e))return;const s=[],r=this._textModel.getLineCount();for(const a of e){if(a.startLineNumber>=a.endLineNumber||a.startLineNumber<1||a.endLineNumber>r)continue;const l=this._getLinesChecksum(a.startLineNumber+1,a.endLineNumber);(!a.checksum||l===a.checksum)&&s.push({startLineNumber:a.startLineNumber,endLineNumber:a.endLineNumber,type:void 0,isCollapsed:(t=a.isCollapsed)!==null&&t!==void 0?t:!0,source:(i=a.source)!==null&&i!==void 0?i:0})}const o=Jr.sanitizeAndMerge(this._regions,s,r);this.updatePost(Jr.fromFoldRanges(o))}_getLinesChecksum(e,t){return WRe(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let s=this._regions.findRange(e),r=1;for(;s>=0;){const o=this._regions.toRegion(s);(!t||t(o,r))&&i.push(o),r++,s=o.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],s=e?e.regionIndex+1:0,r=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const o=[];for(let a=s,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<r){for(;o.length>0&&!c.containedBy(o[o.length-1]);)o.pop();o.push(c),t(c,o.length)&&i.push(c)}else break}}else for(let o=s,a=this._regions.length;o<a;o++){const l=this._regions.toRegion(o);if(this._regions.getStartLineNumber(o)<r)(!t||t(l))&&i.push(l);else break}return i}}function UUe(n,e,t){const i=[];for(const s of t){const r=n.getRegionAtLine(s);if(r){const o=!r.isCollapsed;if(i.push(r),e>1){const a=n.getRegionsInside(r,(l,c)=>l.isCollapsed!==o&&c<e);i.push(...a)}}}n.toggleCollapseState(i)}function t1(n,e,t=Number.MAX_VALUE,i){const s=[];if(i&&i.length>0)for(const r of i){const o=n.getRegionAtLine(r);if(o&&(o.isCollapsed!==e&&s.push(o),t>1)){const a=n.getRegionsInside(o,(l,c)=>l.isCollapsed!==e&&c<t);s.push(...a)}}else{const r=n.getRegionsInside(null,(o,a)=>o.isCollapsed!==e&&a<t);s.push(...r)}n.toggleCollapseState(s)}function Koe(n,e,t,i){const s=[];for(const r of i){const o=n.getAllRegionsAtLine(r,(a,l)=>a.isCollapsed!==e&&l<=t);s.push(...o)}n.toggleCollapseState(s)}function jUe(n,e,t){const i=[];for(const s of t){const r=n.getAllRegionsAtLine(s,o=>o.isCollapsed!==e);r.length>0&&i.push(r[0])}n.toggleCollapseState(i)}function qUe(n,e,t,i){const s=(o,a)=>a===e&&o.isCollapsed!==t&&!i.some(l=>o.containsLine(l)),r=n.getRegionsInside(null,s);n.toggleCollapseState(r)}function Zoe(n,e,t){const i=[];for(const o of t){const a=n.getAllRegionsAtLine(o,void 0);a.length>0&&i.push(a[0])}const s=o=>i.every(a=>!a.containedBy(o)&&!o.containedBy(a))&&o.isCollapsed!==e,r=n.getRegionsInside(null,s);n.toggleCollapseState(r)}function l9(n,e,t){const i=n.textModel,s=n.regions,r=[];for(let o=s.length-1;o>=0;o--)if(t!==s.isCollapsed(o)){const a=s.getStartLineNumber(o);e.test(i.getLineContent(a))&&r.push(s.toRegion(o))}n.toggleCollapseState(r)}function c9(n,e,t){const i=n.regions,s=[];for(let r=i.length-1;r>=0;r--)t!==i.isCollapsed(r)&&e===i.getType(r)&&s.push(i.toRegion(r));n.toggleCollapseState(s)}function GUe(n,e){let t=null;const i=e.getRegionAtLine(n);if(i!==null&&(t=i.startLineNumber,n===t)){const s=i.parentIndex;s!==-1?t=e.regions.getStartLineNumber(s):t=null}return t}function KUe(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){if(n!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let s=0;for(i!==-1&&(s=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=s)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<n)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function ZUe(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){const i=t.parentIndex;let s=0;if(i!==-1)s=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;s=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=s)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>n)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class YUe{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new G,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||Ep(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,s=0,r=Number.MAX_VALUE,o=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);r<=l&&c<=o||(!e&&s<this._hiddenRanges.length&&this._hiddenRanges[s].startLineNumber===l&&this._hiddenRanges[s].endLineNumber===c?(t.push(this._hiddenRanges[s]),s++):(e=!0,t.push(new H(l,1,c,1))),r=l,o=c)}(this._hasLineChanges||e||s<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return vG(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let s=null;const r=o=>((!s||!XUe(o,s))&&(s=vG(this._hiddenRanges,o)),s?s.startLineNumber-1:null);for(let o=0,a=e.length;o<a;o++){let l=e[o];const c=r(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const u=r(l.endLineNumber);u&&(l=l.setEndPosition(u,i.getLineMaxColumn(u)),t=!0),e[o]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function XUe(n,e){return n>=e.startLineNumber&&n<=e.endLineNumber}function vG(n,e){const t=vy(n,i=>e<i.startLineNumber)-1;return t>=0&&n[t].endLineNumber>=e?n[t]:null}const QUe=5e3,JUe="indent";class Yoe{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=JUe}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,s=t&&t.markers;return Promise.resolve(ije(this.editorModel,i,s,this.foldingRangesLimit))}}let eje=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>nl||t>nl)return;const s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),s=new Uint32Array(this._length);for(let r=this._length-1,o=0;r>=0;r--,o++)i[o]=this._startIndexes[r],s[o]=this._endIndexes[r];return new Jr(i,s)}else{this._foldingRangesLimit.update(this._length,t);let i=0,s=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){s=l;break}i+=c}}const r=e.getOptions().tabSize,o=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const u=this._startIndexes[l],h=e.getLineContent(u),d=UT(h,r);(d<s||d===s&&i++<t)&&(o[c]=u,a[c]=this._endIndexes[l],c++)}return new Jr(o,a)}}};const tje={limit:QUe,update:()=>{}};function ije(n,e,t,i=tje){const s=n.getOptions().tabSize,r=new eje(i);let o;t&&(o=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=n.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=n.getLineCount();c>0;c--){const u=n.getLineContent(c),h=UT(u,s);let d=a[a.length-1];if(h===-1){e&&(d.endAbove=c);continue}let f;if(o&&(f=u.match(o)))if(f[1]){let g=a.length-1;for(;g>0&&a[g].indent!==-2;)g--;if(g>0){a.length=g+1,d=a[g],r.insertFirst(c,d.line,h),d.line=c,d.indent=h,d.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(d.indent>h){do a.pop(),d=a[a.length-1];while(d.indent>h);const g=d.endAbove-1;g-c>=1&&r.insertFirst(c,g,h)}d.indent===h?d.endAbove=c:a.push({indent:h,endAbove:c,line:c})}return r.toIndentRanges(n)}const nje=P("editor.foldBackground",{light:We(ld,.3),dark:We(ld,.3),hcDark:null,hcLight:null},_("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);P("editorGutter.foldingControlForeground",{dark:ad,light:ad,hcDark:ad,hcLight:ad},_("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const u9=Cn("folding-expanded",we.chevronDown,_("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),h9=Cn("folding-collapsed",we.chevronRight,_("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),Xoe=Cn("folding-manual-collapsed",h9,_("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),Qoe=Cn("folding-manual-expanded",u9,_("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),d9={color:Tn(nje),position:Or.Inline};class Ki{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?Ki.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?Ki.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:Ki.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:Ki.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?Ki.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Ki.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?Ki.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Ki.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?Ki.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:Ki.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?Ki.MANUALLY_EXPANDED_VISUAL_DECORATION:Ki.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}}Ki.COLLAPSED_VISUAL_DECORATION=mt.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(h9)});Ki.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=mt.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:d9,isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(h9)});Ki.MANUALLY_COLLAPSED_VISUAL_DECORATION=mt.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(Xoe)});Ki.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=mt.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:d9,isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(Xoe)});Ki.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=mt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0});Ki.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=mt.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:d9,isWholeLine:!0});Ki.EXPANDED_VISUAL_DECORATION=mt.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ye.asClassName(u9)});Ki.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=mt.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(u9)});Ki.MANUALLY_EXPANDED_VISUAL_DECORATION=mt.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ye.asClassName(Qoe)});Ki.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=mt.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:Ye.asClassName(Qoe)});Ki.NO_CONTROLS_EXPANDED_RANGE_DECORATION=mt.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0});Ki.HIDDEN_RANGE_DECORATION=mt.register({description:"folding-hidden-range-decoration",stickiness:1});const sje={},rje="syntax";class Joe{constructor(e,t,i,s,r){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=s,this.fallbackRangeProvider=r,this.id=rje,this.disposables=new Ae,r&&this.disposables.add(r);for(const o of t)typeof o.onDidChange=="function"&&this.disposables.add(o.onDidChange(i))}compute(e){return oje(this.providers,this.editorModel,e).then(t=>{var i,s;return t?lje(t,this.foldingRangesLimit):(s=(i=this.fallbackRangeProvider)===null||i===void 0?void 0:i.compute(e))!==null&&s!==void 0?s:null})}dispose(){this.disposables.dispose()}}function oje(n,e,t){let i=null;const s=n.map((r,o)=>Promise.resolve(r.provideFoldingRanges(e,sje,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:o,kind:c.kind})}},oh));return Promise.all(s).then(r=>i)}class aje{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,s){if(e>nl||t>nl)return;const r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._nestingLevels[r]=s,this._types[r]=i,this._length++,s<30&&(this._nestingLevelCounts[s]=(this._nestingLevelCounts[s]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let s=0;s<this._length;s++)t[s]=this._startIndexes[s],i[s]=this._endIndexes[s];return new Jr(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const s=new Uint32Array(e),r=new Uint32Array(e),o=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(s[l]=this._startIndexes[a],r[l]=this._endIndexes[a],o[l]=this._types[a],l++)}return new Jr(s,r,o)}}}function lje(n,e){const t=n.sort((o,a)=>{let l=o.start-a.start;return l===0&&(l=o.rank-a.rank),l}),i=new aje(e);let s;const r=[];for(const o of t)if(!s)s=o,i.add(o.start,o.end,o.kind&&o.kind.value,r.length);else if(o.start>s.start)if(o.end<=s.end)r.push(s),s=o,i.add(o.start,o.end,o.kind&&o.kind.value,r.length);else{if(o.start>s.end){do s=r.pop();while(s&&o.start>s.end);s&&r.push(s),s=o}i.add(o.start,o.end,o.kind&&o.kind.value,r.length)}return i.toIndentRanges()}var cje=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},B1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},uje=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},e0;const vs=new Fe("foldingEnabled",!1);let Np=e0=class extends ae{static get(e){return e.getContribution(e0.ID)}static getFoldingRangeProviders(e,t){var i,s;const r=e.foldingRangeProvider.ordered(t);return(s=(i=e0._foldingRangeSelector)===null||i===void 0?void 0:i.call(e0,r,t))!==null&&s!==void 0?s:r}constructor(e,t,i,s,r,o){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=o,this.localToDispose=this._register(new Ae),this.editor=e,this._foldingLimitReporter=new hje(e);const a=this.editor.getOptions();this._isEnabled=a.get(43),this._useFoldingProviders=a.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(46),this.updateDebounceInfo=r.for(o.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new Ki(e),this.foldingDecorationProvider.showFoldingControls=a.get(109),this.foldingDecorationProvider.showFoldingHighlights=a.get(45),this.foldingEnabled=vs.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(47)&&this.onModelChanged(),l.hasChanged(109)||l.hasChanged(45)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(109),this.foldingDecorationProvider.showFoldingHighlights=c.get(45),this.triggerFoldingModelChanged()}l.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),l.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new HUe(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new YUe(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new xf(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new Ui(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{var t,i;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(t=this.updateScheduler)===null||t===void 0||t.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(i=this.rangeProvider)===null||i===void 0||i.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var e;(e=this.rangeProvider)===null||e===void 0||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new Yoe(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=e0.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new Joe(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;(t=this.hiddenRangeModel)===null||t===void 0||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new wf,i=this.getRangeProvider(e.textModel),s=this.foldingRegionPromise=ch(r=>i.compute(r));return s.then(r=>{if(r&&s===this.foldingRegionPromise){let o;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const u=r.setCollapsedAllOfType(Us.Imports.value,!0);u&&(o=nC.capture(this.editor),this._currentModelHasFoldedImports=u)}const a=this.editor.getSelections(),l=a?a.map(u=>u.startLineNumber):[];e.update(r,l),o==null||o.restore(this.editor);const c=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=c)}return e})}).then(void 0,e=>(Ft(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const s=[];for(const r of i){const o=r.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(o)&&s.push(...t.getAllRegionsAtLine(o,a=>a.isCollapsed&&o>a.startLineNumber))}s.length&&(t.toggleCollapseState(s),this.reveal(i[0].getPosition()))}}}).then(void 0,Ft)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const s=e.target.detail,r=e.target.element.offsetLeft;if(s.offsetX-r<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const s=this.editor.getModel();if(s&&t.startColumn===s.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,s=this.mouseDownInfo.iconClicked,r=e.target.range;if(!r||r.startLineNumber!==i)return;if(s){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||r.startColumn!==a.getLineMaxColumn(i))return}const o=t.getRegionAtLine(i);if(o&&o.startLineNumber===i){const a=o.isCollapsed;if(s||a){const l=e.event.altKey;let c=[];if(l){const u=d=>!d.containedBy(o)&&!o.containedBy(d),h=t.getRegionsInside(null,u);for(const d of h)d.isCollapsed&&c.push(d);c.length===0&&(c=h)}else{const u=e.event.middleButton||e.event.shiftKey;if(u)for(const h of t.getRegionsInside(o))h.isCollapsed===a&&c.push(h);(a||!u||c.length===0)&&c.push(o)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};Np.ID="editor.contrib.folding";Np=e0=cje([B1(1,_t),B1(2,Ur),B1(3,ts),B1(4,cre),B1(5,wt)],Np);class hje{constructor(e){this.editor=e,this._onDidChange=new G,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class Ns extends wi{runEditorCommand(e,t,i){const s=e.get(Ur),r=Np.get(t);if(!r)return;const o=r.getFoldingModel();if(o)return this.reportTelemetry(e,t),o.then(a=>{if(a){this.invoke(r,a,t,i,s);const l=t.getSelection();l&&r.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function eae(n){if(!Mr(n)){if(!ur(n))return!1;const e=n;if(!Mr(e.levels)&&!Xd(e.levels)||!Mr(e.direction)&&!_r(e.direction)||!Mr(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(Xd)))return!1}return!0}class dje extends Ns{constructor(){super({id:"editor.unfold",label:_("unfoldAction.label","Unfold"),alias:"Unfold",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:eae,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){const r=s&&s.levels||1,o=this.getLineNumbers(s,i);s&&s.direction==="up"?Koe(t,!1,r,o):t1(t,!1,r,o)}}class fje extends Ns{constructor(){super({id:"editor.unfoldRecursively",label:_("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2142),weight:100}})}invoke(e,t,i,s){t1(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class gje extends Ns{constructor(){super({id:"editor.fold",label:_("foldAction.label","Fold"),alias:"Fold",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:eae,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){const r=this.getLineNumbers(s,i),o=s&&s.levels,a=s&&s.direction;typeof o!="number"&&typeof a!="string"?jUe(t,!0,r):a==="up"?Koe(t,!0,o||1,r):t1(t,!0,o||1,r)}}class pje extends Ns{constructor(){super({id:"editor.toggleFold",label:_("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2090),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);UUe(t,1,s)}}class mje extends Ns{constructor(){super({id:"editor.foldRecursively",label:_("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2140),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);t1(t,!0,Number.MAX_VALUE,s)}}class _je extends Ns{constructor(){super({id:"editor.foldAllBlockComments",label:_("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2138),weight:100}})}invoke(e,t,i,s,r){if(t.regions.hasTypes())c9(t,Us.Comment.value,!0);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+Na(a.blockCommentStartToken));l9(t,l,!0)}}}}class bje extends Ns{constructor(){super({id:"editor.foldAllMarkerRegions",label:_("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2077),weight:100}})}invoke(e,t,i,s,r){if(t.regions.hasTypes())c9(t,Us.Region.value,!0);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);l9(t,l,!0)}}}}class vje extends Ns{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:_("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2078),weight:100}})}invoke(e,t,i,s,r){if(t.regions.hasTypes())c9(t,Us.Region.value,!1);else{const o=i.getModel();if(!o)return;const a=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);l9(t,l,!1)}}}}class wje extends Ns{constructor(){super({id:"editor.foldAllExcept",label:_("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2136),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);Zoe(t,!0,s)}}class yje extends Ns{constructor(){super({id:"editor.unfoldAllExcept",label:_("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2134),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);Zoe(t,!1,s)}}class Cje extends Ns{constructor(){super({id:"editor.foldAll",label:_("foldAllAction.label","Fold All"),alias:"Fold All",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2069),weight:100}})}invoke(e,t,i){t1(t,!0)}}class Sje extends Ns{constructor(){super({id:"editor.unfoldAll",label:_("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2088),weight:100}})}invoke(e,t,i){t1(t,!1)}}class Rp extends Ns{getFoldingLevel(){return parseInt(this.id.substr(Rp.ID_PREFIX.length))}invoke(e,t,i){qUe(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}Rp.ID_PREFIX="editor.foldLevel";Rp.ID=n=>Rp.ID_PREFIX+n;class xje extends Ns{constructor(){super({id:"editor.gotoParentFold",label:_("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const r=GUe(s[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class kje extends Ns{constructor(){super({id:"editor.gotoPreviousFold",label:_("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const r=KUe(s[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class Lje extends Ns{constructor(){super({id:"editor.gotoNextFold",label:_("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const r=ZUe(s[0],t);r!==null&&i.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}class Dje extends Ns{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:_("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2135),weight:100}})}invoke(e,t,i){var s;const r=[],o=i.getSelections();if(o){for(const a of o){let l=a.endLineNumber;a.endColumn===1&&--l,l>a.startLineNumber&&(r.push({startLineNumber:a.startLineNumber,endLineNumber:l,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:a.startLineNumber,startColumn:1,endLineNumber:a.startLineNumber,endColumn:1}))}if(r.length>0){r.sort((l,c)=>l.startLineNumber-c.startLineNumber);const a=Jr.sanitizeAndMerge(t.regions,r,(s=i.getModel())===null||s===void 0?void 0:s.getLineCount());t.updatePost(Jr.fromFoldRanges(a))}}}}class Eje extends Ns{constructor(){super({id:"editor.removeManualFoldingRanges",label:_("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2137),weight:100}})}invoke(e,t,i){const s=i.getSelections();if(s){const r=[];for(const o of s){const{startLineNumber:a,endLineNumber:l}=o;r.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(r),e.triggerFoldingModelChanged()}}}Va(Np.ID,Np,0);dt(dje);dt(fje);dt(gje);dt(mje);dt(Cje);dt(Sje);dt(_je);dt(bje);dt(vje);dt(wje);dt(yje);dt(pje);dt(xje);dt(kje);dt(Lje);dt(Dje);dt(Eje);for(let n=1;n<=7;n++)PNe(new Rp({id:Rp.ID(n),label:_("foldLevelAction.label","Fold Level {0}",n),alias:`Fold Level ${n}`,precondition:vs,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2048|21+n),weight:100}}));pi.registerCommand("_executeFoldingRangeProvider",function(n,...e){return uje(this,void 0,void 0,function*(){const[t]=e;if(!(t instanceof ot))throw ju();const i=n.get(wt),s=n.get(Zs).getModel(t);if(!s)throw ju();const r=n.get(xi);if(!r.getValue("editor.folding",{resource:t}))return[];const o=n.get(Ur),a=r.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return r.getValue("editor.foldingMaximumRegions",{resource:t})},update:(f,g)=>{}},c=new Yoe(s,o,l);let u=c;if(a!=="indentation"){const f=Np.getFoldingRangeProviders(i,s);f.length&&(u=new Joe(s,f,()=>{},l,c))}const h=yield u.compute(In.None),d=[];try{if(h)for(let f=0;f<h.length;f++){const g=h.getType(f);d.push({start:h.getStartLineNumber(f),end:h.getEndLineNumber(f),kind:g?Us.fromValue(g):void 0})}return d}finally{u.dispose()}})});class xs{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const s=i.options;if(s===xs._FIND_MATCH_DECORATION||s===xs._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let s=0,r=this._decorations.length;s<r;s++){const o=this._editor.getModel().getDecorationRange(this._decorations[s]);if(e.equalsRange(o)){t=this._decorations[s],i=s+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(s=>{if(this._highlightedDecorationId!==null&&(s.changeDecorationOptions(this._highlightedDecorationId,xs._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,s.changeDecorationOptions(this._highlightedDecorationId,xs._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(s.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let r=this._editor.getModel().getDecorationRange(t);if(r.startLineNumber!==r.endLineNumber&&r.endColumn===1){const o=r.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(o);r=new H(r.startLineNumber,r.startColumn,o,a)}this._rangeHighlightDecorationId=s.addDecoration(r,xs._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let s=xs._FIND_MATCH_DECORATION;const r=[];if(e.length>1e3){s=xs._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,u=Math.max(2,Math.ceil(3/c));let h=e[0].range.startLineNumber,d=e[0].range.endLineNumber;for(let f=1,g=e.length;f<g;f++){const p=e[f].range;d+u>=p.startLineNumber?p.endLineNumber>d&&(d=p.endLineNumber):(r.push({range:new H(h,1,d,1),options:xs._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),h=p.startLineNumber,d=p.endLineNumber)}r.push({range:new H(h,1,d,1),options:xs._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const o=new Array(e.length);for(let a=0,l=e.length;a<l;a++)o[a]={range:e[a].range,options:s};this._decorations=i.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,r),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t!=null&&t.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,xs._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(!(!s||s.endLineNumber>e.lineNumber)){if(s.endLineNumber<e.lineNumber)return s;if(!(s.endColumn>e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const s=this._decorations[t],r=this._editor.getModel().getDecorationRange(s);if(!(!r||r.startLineNumber<e.lineNumber)){if(r.startLineNumber>e.lineNumber)return r;if(!(r.startColumn<e.column))return r}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}xs._CURRENT_FIND_MATCH_DECORATION=mt.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:Tn(z8),position:zo.Center},minimap:{color:Tn(y0),position:Or.Inline}});xs._FIND_MATCH_DECORATION=mt.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:Tn(z8),position:zo.Center},minimap:{color:Tn(y0),position:Or.Inline}});xs._FIND_MATCH_NO_OVERVIEW_DECORATION=mt.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0});xs._FIND_MATCH_ONLY_OVERVIEW_DECORATION=mt.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:Tn(z8),position:zo.Center}});xs._RANGE_HIGHLIGHT_DECORATION=mt.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0});xs._FIND_SCOPE_DECORATION=mt.register({description:"find-scope",className:"findScope",isWholeLine:!0});class Tje{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let o=0;o<this._ranges.length;o++)i.push({range:this._ranges[o],text:this._replaceStrings[o]});i.sort((o,a)=>H.compareRangesUsingStarts(o.range,a.range));const s=[];let r=i[0];for(let o=1;o<i.length;o++)r.range.endLineNumber===i[o].range.startLineNumber&&r.range.endColumn===i[o].range.startColumn?(r.range=r.range.plusRange(i[o].range),r.text=r.text+i[o].text):(s.push(r),r=i[o]);s.push(r);for(const o of s)t.addEditOperation(o.range,o.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function tae(n,e){if(n&&n[0]!==""){const t=wG(n,e,"-"),i=wG(n,e,"_");return t&&!i?yG(n,e,"-"):!t&&i?yG(n,e,"_"):n[0].toUpperCase()===n[0]?e.toUpperCase():n[0].toLowerCase()===n[0]?e.toLowerCase():tIe(n[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):n[0][0].toUpperCase()!==n[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function wG(n,e,t){return n[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&n[0].split(t).length===e.split(t).length}function yG(n,e,t){const i=e.split(t),s=n[0].split(t);let r="";return i.forEach((o,a)=>{r+=tae([s[a]],o)+t}),r.slice(0,-1)}class CG{constructor(e){this.staticValue=e,this.kind=0}}class Aje{constructor(e){this.pieces=e,this.kind=1}}class wb{static fromStaticValue(e){return new wb([Jg.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new CG(""):e.length===1&&e[0].staticValue!==null?this._state=new CG(e[0].staticValue):this._state=new Aje(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?tae(e,this._state.staticValue):this._state.staticValue;let i="";for(let s=0,r=this._state.pieces.length;s<r;s++){const o=this._state.pieces[s];if(o.staticValue!==null){i+=o.staticValue;continue}let a=wb._substitute(o.matchIndex,e);if(o.caseOps!==null&&o.caseOps.length>0){const l=[],c=o.caseOps.length;let u=0;for(let h=0,d=a.length;h<d;h++){if(u>=c){l.push(a.slice(h));break}switch(o.caseOps[u]){case"U":l.push(a[h].toUpperCase());break;case"u":l.push(a[h].toUpperCase()),u++;break;case"L":l.push(a[h].toLowerCase());break;case"l":l.push(a[h].toLowerCase()),u++;break;default:l.push(a[h])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class Jg{static staticValue(e){return new Jg(e,-1,null)}static caseOps(e,t){return new Jg(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class Ije{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Jg.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=Jg.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Jg.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new wb(this._result)}}function Nje(n){if(!n||n.length===0)return new wb(null);const e=[],t=new Ije(n);for(let i=0,s=n.length;i<s;i++){const r=n.charCodeAt(i);if(r===92){if(i++,i>=s)break;const o=n.charCodeAt(i);switch(o){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(o));break}continue}if(r===36){if(i++,i>=s)break;const o=n.charCodeAt(i);if(o===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(o===48||o===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=o&&o<=57){let a=o-48;if(i+1<s){const l=n.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const gh=new Fe("findWidgetVisible",!1);gh.toNegated();const vA=new Fe("findInputFocussed",!1),f9=new Fe("replaceInputFocussed",!1),o2={primary:545,mac:{primary:2593}},a2={primary:565,mac:{primary:2613}},l2={primary:560,mac:{primary:2608}},c2={primary:554,mac:{primary:2602}},u2={primary:558,mac:{primary:2606}},Qt={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},_d=19999,Rje=240;class uw{constructor(e,t){this._toDispose=new Ae,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new uh,this._decorations=new xs(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new Ui(()=>this.research(!1),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,ti(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},Rje)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new H(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const s=this._findMatches(i,!1,_d);this._decorations.set(s,i);const r=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(r);if(o===0&&s.length>0){const a=vy(s.map(l=>l.range),l=>H.compareRangesUsingStarts(l,r)>=0);o=a>0?a-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const r=this._editor.getModel();return t||s===1?(i===1?i=r.getLineCount():i--,s=r.getLineMaxColumn(i)):s--,new X(i,s)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const u=this._decorations.matchAfterPosition(e);u&&this._setCurrentFindMatch(u);return}if(this._decorations.getCount()<_d){let u=this._decorations.matchBeforePosition(e);u&&u.isEmpty()&&u.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),u=this._decorations.matchBeforePosition(e)),u&&this._setCurrentFindMatch(u);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),s=uw._getSearchRange(this._editor.getModel(),i);s.getEndPosition().isBefore(e)&&(e=s.getEndPosition()),e.isBefore(s.getStartPosition())&&(e=s.getEndPosition());const{lineNumber:r,column:o}=e,a=this._editor.getModel();let l=new X(r,o),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1)),!!c){if(!t&&!s.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const r=this._editor.getModel();return t||s===r.getLineMaxColumn(i)?(i===r.getLineCount()?i=1:i++,s=1):s++,new X(i,s)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<_d){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,s=!1){if(this._cannotFind())return null;const r=this._decorations.getFindScope(),o=uw._getSearchRange(this._editor.getModel(),r);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let u=new X(a,l),h=c.findNextMatch(this._state.searchString,u,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t);return i&&h&&h.range.isEmpty()&&h.range.getStartPosition().equals(u)&&(u=this._nextSearchPosition(u),h=c.findNextMatch(this._state.searchString,u,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t)),h?!s&&!o.containsRange(h.range)?this._getNextMatch(h.range.getEndPosition(),t,i,!0):h:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?Nje(this._state.replaceString):wb.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const s=e.buildReplaceString(i.matches,this._state.preserveCase),r=new nr(t,s);this._executeEditorCommand("replace",r),this._decorations.setStartPosition(new X(t.startLineNumber,t.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const s=(e||[null]).map(r=>uw._getSearchRange(this._editor.getModel(),r));return this._editor.getModel().findMatches(this._state.searchString,s,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=_d?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new Yf(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let h="mu";i.ignoreCase&&(h+="i"),i.global&&(h+="g"),i=new RegExp(i.source,h)}const s=this._editor.getModel(),r=s.getValue(1),o=s.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=r.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=r.replace(i,a.buildReplaceString(null,c));const u=new Cse(o,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",u)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),s=[];for(let o=0,a=i.length;o<a;o++)s[o]=t.buildReplaceString(i[o].matches,this._state.preserveCase);const r=new Tje(this._editor.getSelection(),i.map(o=>o.range),s);this._executeEditorCommand("replaceAll",r)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(r=>new Lt(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn));const s=this._editor.getSelection();for(let r=0,o=i.length;r<o;r++)if(i[r].equalsRange(s)){i=[s].concat(i.slice(0,r)).concat(i.slice(r+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class wA extends Nl{constructor(e,t,i){super(),this._hideSoon=this._register(new Ui(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s={inputActiveOptionBorder:Ce(W8),inputActiveOptionForeground:Ce(V8),inputActiveOptionBackground:Ce(Eg)};this.caseSensitive=this._register(new qre(Object.assign({appendTitle:this._keybindingLabelFor(Qt.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase},s))),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new Gre(Object.assign({appendTitle:this._keybindingLabelFor(Qt.ToggleWholeWordCommand),isChecked:this._state.wholeWord},s))),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new Kre(Object.assign({appendTitle:this._keybindingLabelFor(Qt.ToggleRegexCommand),isChecked:this._state.isRegex},s))),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(r=>{let o=!1;r.isRegex&&(this.regex.checked=this._state.isRegex,o=!0),r.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,o=!0),r.matchCase&&(this.caseSensitive.checked=this._state.matchCase,o=!0),!this._state.isRevealed&&o&&this._revealTemporarily()})),this._register(oe(this._domNode,Le.MOUSE_LEAVE,r=>this._onMouseLeave())),this._register(oe(this._domNode,"mouseover",r=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return wA.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}wA.ID="editor.contrib.findOptionsWidget";function h2(n,e){return n===1?!0:n===2?!1:e}class Mje extends ae{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return h2(this._isRegexOverride,this._isRegex)}get wholeWord(){return h2(this._wholeWordOverride,this._wholeWord)}get matchCase(){return h2(this._matchCaseOverride,this._matchCase)}get preserveCase(){return h2(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new G),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let r=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,s.matchesPosition=!0,r=!0),this._matchesCount!==t&&(this._matchesCount=t,s.matchesCount=!0,r=!0),typeof i<"u"&&(H.equalsRange(this._currentMatch,i)||(this._currentMatch=i,s.currentMatch=!0,r=!0)),r&&this._onFindReplaceStateChange.fire(s)}change(e,t,i=!0){var s;const r={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;const a=this.isRegex,l=this.wholeWord,c=this.matchCase,u=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,r.searchString=!0,o=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,r.replaceString=!0,o=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,r.isRevealed=!0,o=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,r.isReplaceRevealed=!0,o=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&(!((s=e.searchScope)===null||s===void 0)&&s.every(h=>{var d;return(d=this._searchScope)===null||d===void 0?void 0:d.some(f=>!H.equalsRange(f,h))})||(this._searchScope=e.searchScope,r.searchScope=!0,o=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,r.loop=!0,o=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,r.isSearching=!0,o=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,r.filters=!0,o=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,a!==this.isRegex&&(o=!0,r.isRegex=!0),l!==this.wholeWord&&(o=!0,r.wholeWord=!0),c!==this.matchCase&&(o=!0,r.matchCase=!0),u!==this.preserveCase&&(o=!0,r.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(r)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=_d}}const Fje=_("defaultLabel","input"),Pje=_("label.preserveCaseToggle","Preserve Case");class Oje extends Jb{constructor(e){super({icon:we.preserveCase,title:Pje+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Bje extends Nl{constructor(e,t,i,s){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new G),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new G),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new G),this._onInput=this._register(new G),this._onKeyUp=this._register(new G),this._onPreserveCaseKeyDown=this._register(new G),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=s.placeholder||"",this.validation=s.validation,this.label=s.label||Fje;const r=s.appendPreserveCaseLabel||"",o=s.history||[],a=!!s.flexibleHeight,l=!!s.flexibleWidth,c=s.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new Zre(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:o,showHistoryHint:s.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:s.inputBoxStyles})),this.preserveCase=this._register(new Oje(Object.assign({appendTitle:r,isChecked:!1},s.toggleStyles))),this._register(this.preserveCase.onChange(d=>{this._onDidOptionChange.fire(d),!d&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(d=>{this._onPreserveCaseKeyDown.fire(d)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const u=[this.preserveCase.domNode];this.onkeydown(this.domNode,d=>{if(d.equals(15)||d.equals(17)||d.equals(9)){const f=u.indexOf(document.activeElement);if(f>=0){let g=-1;d.equals(17)?g=(f+1)%u.length:d.equals(15)&&(f===0?g=u.length-1:g=f-1),d.equals(9)?(u[f].blur(),this.inputBox.focus()):g>=0&&u[g].focus(),rt.stop(d,!0)}}});const h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),e==null||e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,d=>this._onKeyDown.fire(d)),this.onkeyup(this.inputBox.inputElement,d=>this._onKeyUp.fire(d)),this.oninput(this.inputBox.inputElement,d=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,d=>this._onMouseDown.fire(d))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){var e;(e=this.inputBox)===null||e===void 0||e.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var iae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},nae=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const sae=new Fe("suggestWidgetVisible",!1,_("suggestWidgetVisible","Whether suggestion are visible")),g9="historyNavigationWidgetFocus",rae="historyNavigationForwardsEnabled",oae="historyNavigationBackwardsEnabled";let Yu;const d2=[];function aae(n,e){if(d2.includes(e))throw new Error("Cannot register the same widget multiple times");d2.push(e);const t=new Ae,i=new Fe(g9,!1).bindTo(n),s=new Fe(rae,!0).bindTo(n),r=new Fe(oae,!0).bindTo(n),o=()=>{i.set(!0),Yu=e},a=()=>{i.set(!1),Yu===e&&(Yu=void 0)};return e.element===document.activeElement&&o(),t.add(e.onDidFocus(()=>o())),t.add(e.onDidBlur(()=>a())),t.add(ut(()=>{d2.splice(d2.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:s,historyNavigationBackwardsEnablement:r,dispose(){t.dispose()}}}let sO=class extends Yre{constructor(e,t,i,s){super(e,t,i);const r=this._register(s.createScoped(this.inputBox.element));this._register(aae(r,this.inputBox))}};sO=iae([nae(3,_t)],sO);let rO=class extends Bje{constructor(e,t,i,s,r=!1){super(e,t,r,i);const o=this._register(s.createScoped(this.inputBox.element));this._register(aae(o,this.inputBox))}};rO=iae([nae(3,_t)],rO);wr.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:Ve.and(Ve.has(g9),Ve.equals(oae,!0),Ve.not("isComposing"),sae.isEqualTo(!1)),primary:16,secondary:[528],handler:n=>{Yu==null||Yu.showPreviousValue()}});wr.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:Ve.and(Ve.has(g9),Ve.equals(rae,!0),Ve.not("isComposing"),sae.isEqualTo(!1)),primary:18,secondary:[530],handler:n=>{Yu==null||Yu.showNextValue()}});function SG(n){var e,t;return((e=n.lookupKeybinding("history.showPrevious"))===null||e===void 0?void 0:e.getElectronAccelerator())==="Up"&&((t=n.lookupKeybinding("history.showNext"))===null||t===void 0?void 0:t.getElectronAccelerator())==="Down"}var Wje=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Vje=Cn("find-selection",we.selection,_("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),xG=Cn("find-collapsed",we.chevronRight,_("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),kG=Cn("find-expanded",we.chevronDown,_("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),$je=Cn("find-replace",we.replace,_("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),zje=Cn("find-replace-all",we.replaceAll,_("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),Hje=Cn("find-previous-match",we.arrowUp,_("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),Uje=Cn("find-next-match",we.arrowDown,_("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),jje=_("label.findDialog","Find / Replace"),qje=_("label.find","Find"),Gje=_("placeholder.find","Find"),Kje=_("label.previousMatchButton","Previous Match"),Zje=_("label.nextMatchButton","Next Match"),Yje=_("label.toggleSelectionFind","Find in Selection"),Xje=_("label.closeButton","Close"),Qje=_("label.replace","Replace"),Jje=_("placeholder.replace","Replace"),eqe=_("label.replaceButton","Replace"),tqe=_("label.replaceAllButton","Replace All"),iqe=_("label.toggleReplaceButton","Toggle Replace"),nqe=_("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",_d),sqe=_("label.matchesLocation","{0} of {1}"),LG=_("label.noResults","No results"),Hl=419,rqe=275,oqe=rqe-54;let W1=69;const aqe=33,DG="ctrlEnterReplaceAll.windows.donotask",EG=Mt?256:2048;class qR{constructor(e){this.afterLineNumber=e,this.heightInPx=aqe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function TG(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){n.stopPropagation();return}}function AG(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){n.stopPropagation();return}}class yA extends Nl{constructor(e,t,i,s,r,o,a,l,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=s,this._keybindingService=r,this._contextKeyService=o,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(DG,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new xf(500),this._register(ut(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(u=>this._onStateChanged(u))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(u=>{if(u.hasChanged(90)&&(this._codeEditor.getOption(90)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),u.hasChanged(143)&&this._tryUpdateWidgetWidth(),u.hasChanged(2)&&this.updateAccessibilitySupport(),u.hasChanged(41)){const h=this._codeEditor.getOption(41).loop;this._state.change({loop:h},!1);const d=this._codeEditor.getOption(41).addExtraSpaceOnTop;d&&!this._viewZone&&(this._viewZone=new qR(0),this._showViewZone()),!d&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(()=>Wje(this,void 0,void 0,function*(){if(this._isVisible){const u=yield this._controller.getGlobalBufferTerm();u&&u!==this._state.searchString&&(this._state.change({searchString:u},!1),this._findInput.select())}}))),this._findInputFocused=vA.bindTo(o),this._findFocusTracker=this._register(ef(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=f9.bindTo(o),this._replaceFocusTracker=this._register(ef(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new qR(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(u=>{if(u.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return yA.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(90)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=sr(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,Ft)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=W1+"px",this._state.matchesCount>=_d?this._matchesCount.title=nqe:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild);let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=_d&&(t+="+");let i=String(this._state.matchesPosition);i==="0"&&(i="?"),e=ly(sqe,i,t)}else e=LG;this._matchesCount.appendChild(document.createTextNode(e)),_S(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),W1=Math.max(W1,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===LG)return i===""?_("ariaSearchNoResultEmpty","{0} found",e):_("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const s=_("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),r=this._codeEditor.getModel();return r&&t.startLineNumber<=r.getLineCount()&&t.startLineNumber>=1?`${r.getLineContent(t.startLineNumber)}, ${s}`:s}return _("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(90);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const s=hs(i),r=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=s.left+(r?r.left:0),a=r?r.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=nne(this._domNode).left;o>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());s.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(s=>{i.heightInPx=this._getHeight(),this._viewZoneId=s.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new qR(0));const i=this._viewZone;this._codeEditor.changeViewZones(s=>{if(this._viewZoneId!==void 0){const r=this._getHeight();if(r===i.heightInPx)return;const o=r-i.heightInPx;i.heightInPx=r,s.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o);return}else{let r=this._getHeight();if(r-=this._codeEditor.getOption(83).top,r<=0)return;i.heightInPx=r,this._viewZoneId=s.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!C8(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,s=e.minimap.minimapWidth;let r=!1,o=!1,a=!1;if(this._resized&&sr(this._domNode)>Hl){this._domNode.style.maxWidth=`${i-28-s-15}px`,this._replaceInput.width=sr(this._findInput.domNode);return}if(Hl+28+s>=i&&(o=!0),Hl+28+s-W1>=i&&(a=!0),Hl+28+s-W1>=i+50&&(r=!0),this._domNode.classList.toggle("collapsed-find-widget",r),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",o),!a&&!r&&(this._domNode.style.maxWidth=`${i-28-s-15}px`),this._findInput.layout({collapsedFindWidget:r,narrowFindWidget:a,reducedFindWidget:o}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=sr(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!H.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(EG|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return TG(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return AG(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(EG|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{br&&j0&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(_("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(DG,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return TG(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return AG(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new sO(null,this._contextViewProvider,{width:oqe,label:qje,placeholder:Gje,appendCaseSensitiveLabel:this._keybindingLabelFor(Qt.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Qt.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Qt.ToggleRegexCommand),validation:l=>{if(l.length===0||!this._findInput.getRegex())return null;try{return new RegExp(l,"gu"),null}catch(c){return{content:c.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>SG(this._keybindingService),inputBoxStyles:SD,toggleStyles:CD},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(l=>this._onFindInputKeyDown(l))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(l=>{l.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),l.preventDefault())})),this._register(this._findInput.onRegexKeyDown(l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),l.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(l=>{this._tryUpdateHeight()&&this._showViewZone()})),Ts&&this._register(this._findInput.onMouseDown(l=>this._onFindInputMouseDown(l))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new jm({label:Kje+this._keybindingLabelFor(Qt.PreviousMatchFindAction),icon:Hje,onTrigger:()=>{B4(this._codeEditor.getAction(Qt.PreviousMatchFindAction)).run().then(void 0,Ft)}})),this._nextBtn=this._register(new jm({label:Zje+this._keybindingLabelFor(Qt.NextMatchFindAction),icon:Uje,onTrigger:()=>{B4(this._codeEditor.getAction(Qt.NextMatchFindAction)).run().then(void 0,Ft)}}));const i=document.createElement("div");i.className="find-part",i.appendChild(this._findInput.domNode);const s=document.createElement("div");s.className="find-actions",i.appendChild(s),s.appendChild(this._matchesCount),s.appendChild(this._prevBtn.domNode),s.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Jb({icon:Vje,title:Yje+this._keybindingLabelFor(Qt.ToggleSearchScopeCommand),isChecked:!1,inputActiveOptionBackground:Ce(Eg),inputActiveOptionBorder:Ce(W8),inputActiveOptionForeground:Ce(V8)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){const l=this._codeEditor.getSelections();l.map(c=>(c.endColumn===1&&c.endLineNumber>c.startLineNumber&&(c=c.setEndPosition(c.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(c.endLineNumber-1))),c.isEmpty()?null:c)).filter(c=>!!c),l.length&&this._state.change({searchScope:l},!0)}}else this._state.change({searchScope:null},!0)})),s.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new jm({label:Xje+this._keybindingLabelFor(Qt.CloseFindWidgetCommand),icon:$Ve,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),l.preventDefault())}})),this._replaceInput=this._register(new rO(null,void 0,{label:Qje,placeholder:Jje,appendPreserveCaseLabel:this._keybindingLabelFor(Qt.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>SG(this._keybindingService),inputBoxStyles:SD,toggleStyles:CD},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(l=>this._onReplaceInputKeyDown(l))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(l=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(l=>{l.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),l.preventDefault())})),this._replaceBtn=this._register(new jm({label:eqe+this._keybindingLabelFor(Qt.ReplaceOneAction),icon:$je,onTrigger:()=>{this._controller.replace()},onKeyDown:l=>{l.equals(1026)&&(this._closeBtn.focus(),l.preventDefault())}})),this._replaceAllBtn=this._register(new jm({label:tqe+this._keybindingLabelFor(Qt.ReplaceAllAction),icon:zje,onTrigger:()=>{this._controller.replaceAll()}}));const r=document.createElement("div");r.className="replace-part",r.appendChild(this._replaceInput.domNode);const o=document.createElement("div");o.className="replace-actions",r.appendChild(o),o.appendChild(this._replaceBtn.domNode),o.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new jm({label:iqe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=sr(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=jje,this._domNode.role="dialog",this._domNode.style.width=`${Hl}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(i),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(r),this._resizeSash=new rs(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let a=Hl;this._register(this._resizeSash.onDidStart(()=>{a=sr(this._domNode)})),this._register(this._resizeSash.onDidChange(l=>{this._resized=!0;const c=a+l.startX-l.currentX;if(c<Hl)return;const u=parseFloat(ST(this._domNode).maxWidth)||0;c>u||(this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=sr(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const l=sr(this._domNode);if(l<Hl)return;let c=Hl;if(!this._resized||l===Hl){const u=this._codeEditor.getLayoutInfo();c=u.width-28-u.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=sr(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}}yA.ID="editor.contrib.findWidget";class jm extends Nl{constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+Ye.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,i=>{this._opts.onTrigger(),i.preventDefault()}),this.onkeydown(this._domNode,i=>{var s,r;if(i.equals(10)||i.equals(3)){this._opts.onTrigger(),i.preventDefault();return}(r=(s=this._opts).onKeyDown)===null||r===void 0||r.call(s,i)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...Ye.asClassNameArray(xG)),this._domNode.classList.add(...Ye.asClassNameArray(kG))):(this._domNode.classList.remove(...Ye.asClassNameArray(kG)),this._domNode.classList.add(...Ye.asClassNameArray(xG)))}}$a((n,e)=>{const t=(p,m)=>{m&&e.addRule(`.monaco-editor ${p} { background-color: ${m}; }`)};t(".findMatch",n.getColor(bc)),t(".currentFindMatch",n.getColor(y3e)),t(".findScope",n.getColor(C3e));const i=n.getColor(gn);t(".find-widget",i);const s=n.getColor(Wu);s&&e.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${s}; }`);const r=n.getColor(Zne);r&&e.addRule(`.monaco-editor .find-widget { border-left: 1px solid ${r}; border-right: 1px solid ${r}; border-bottom: 1px solid ${r}; }`);const o=n.getColor(cd);o&&e.addRule(`.monaco-editor .findMatch { border: 1px ${Gu(n.type)?"dotted":"solid"} ${o}; box-sizing: border-box; }`);const a=n.getColor(S3e);a&&e.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${a}; padding: 1px; box-sizing: border-box; }`);const l=n.getColor(x3e);l&&e.addRule(`.monaco-editor .findScope { border: 1px ${Gu(n.type)?"dashed":"solid"} ${l}; }`);const c=n.getColor(pt);c&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${c}; }`);const u=n.getColor(_c);u&&e.addRule(`.monaco-editor .find-widget { color: ${u}; }`);const h=n.getColor($4e);h&&e.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${h}; }`);const d=n.getColor(d3e);if(d)e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${d}; }`);else{const p=n.getColor(_0);p&&e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${p}; }`)}const f=n.getColor(gF);f&&e.addRule(`
		.monaco-editor .find-widget .button:not(.disabled):hover,
		.monaco-editor .find-widget .codicon-find-selection:hover {
			background-color: ${f} !important;
		}
	`);const g=n.getColor(uo);g&&e.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${g}; }`)});var lae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},sl=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Mp=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},oO;const lqe=524288;function aO(n,e="single",t=!1){if(!n.hasModel())return null;const i=n.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const s=n.getConfiguredWordAtPosition(i.getStartPosition());if(s&&t===!1)return s.word}else if(n.getModel().getValueLengthInRange(i)<lqe)return n.getModel().getValueInRange(i)}return null}let Ks=oO=class extends ae{get editor(){return this._editor}static get(e){return e.getContribution(oO.ID)}constructor(e,t,i,s,r){super(),this._editor=e,this._findWidgetVisible=gh.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=s,this._notificationService=r,this._updateHistoryDelayer=new xf(500),this._state=this._register(new Mje),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(o=>this._onStateChanged(o))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const o=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),o&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!vA.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const e=this._editor.getSelections();e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Na(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return Mp(this,void 0,void 0,function*(){if(this.disposeModel(),!this._editor.hasModel())return;const i=Object.assign(Object.assign({},t),{isRevealed:!0});if(e.seedSearchStringFromSelection==="single"){const s=aO(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);s&&(this._state.isRegex?i.searchString=Na(s):i.searchString=s)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const s=aO(this._editor,e.seedSearchStringFromSelection);s&&(i.searchString=s)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const s=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;s&&(i.searchString=s)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const s=this._editor.getSelections();s.some(r=>!r.isEmpty())&&(i.searchScope=s)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new uw(this._editor,this._state))})}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){var e;return this._model?!((e=this._editor.getModel())===null||e===void 0)&&e.isTooLargeForHeapOperation()?(this._notificationService.warn(_("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}getGlobalBufferTerm(){return Mp(this,void 0,void 0,function*(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""})}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};Ks.ID="editor.contrib.findController";Ks=oO=lae([sl(1,_t),sl(2,dm),sl(3,RS),sl(4,ts)],Ks);let lO=class extends Ks{constructor(e,t,i,s,r,o,a,l){super(e,i,a,l,o),this._contextViewService=t,this._keybindingService=s,this._themeService=r,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return Mp(this,void 0,void 0,function*(){this._widget||this._createFindWidget();const s=this._editor.getSelection();let r=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":r=!0;break;case"never":r=!1;break;case"multiline":{r=!!s&&s.startLineNumber!==s.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||r,yield i._start.call(this,e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())})}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new yA(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new wA(this._editor,this._state,this._keybindingService))}};lO=lae([sl(1,Ef),sl(2,_t),sl(3,Oi),sl(4,qr),sl(5,ts),sl(6,dm),sl(7,RS)],lO);const cqe=hne(new une({id:Qt.StartFindAction,label:_("startFindAction","Find"),alias:"Find",precondition:Ve.or(ee.focus,Ve.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:B.MenubarEditMenu,group:"3_find",title:_({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));cqe.addImplementation(0,(n,e,t)=>{const i=Ks.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop}):!1});const uqe={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:_("actions.find.isRegexOverride",`Overrides "Use Regular Expression" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:_("actions.find.wholeWordOverride",`Overrides "Match Whole Word" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:_("actions.find.matchCaseOverride",`Overrides "Math Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:_("actions.find.preserveCaseOverride",`Overrides "Preserve Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},findInSelection:{type:"boolean"}}}}]};class hqe extends wi{constructor(){super({id:Qt.StartFindWithArgs,label:_("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:uqe})}run(e,t,i){return Mp(this,void 0,void 0,function*(){const s=Ks.get(t);if(s){const r=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield s.start({forceRevealReplace:!1,seedSearchStringFromSelection:s.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(i==null?void 0:i.findInSelection)||!1,loop:t.getOption(41).loop},r),s.setGlobalBufferTerm(s.getState().searchString)}})}}class dqe extends wi{constructor(){super({id:Qt.StartFindWithSelection,label:_("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return Mp(this,void 0,void 0,function*(){const i=Ks.get(t);i&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),i.setGlobalBufferTerm(i.getState().searchString))})}}class cae extends wi{run(e,t){return Mp(this,void 0,void 0,function*(){const i=Ks.get(t);i&&!this._run(i)&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))})}}class fqe extends cae{constructor(){super({id:Qt.NextMatchFindAction,label:_("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:ee.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:Ve.and(ee.focus,vA),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class gqe extends cae{constructor(){super({id:Qt.PreviousMatchFindAction,label:_("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:ee.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:Ve.and(ee.focus,vA),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class pqe extends wi{constructor(){super({id:Qt.GoToMatchFindAction,label:_("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:gh}),this._highlightDecorations=[]}run(e,t,i){const s=Ks.get(t);if(!s)return;const r=s.getState().matchesCount;if(r<1){e.get(ts).notify({severity:Jse.Warning,message:_("findMatchAction.noResults","No matches. Try searching for something else.")});return}const a=e.get(K7).createInputBox();a.placeholder=_("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",r);const l=u=>{const h=parseInt(u);if(isNaN(h))return;const d=s.getState().matchesCount;if(h>0&&h<=d)return h-1;if(h<0&&h>=-d)return d+h},c=u=>{const h=l(u);if(typeof h=="number"){a.validationMessage=void 0,s.goToMatch(h);const d=s.getState().currentMatch;d&&this.addDecorations(t,d)}else a.validationMessage=_("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount),this.clearDecorations(t)};a.onDidChangeValue(u=>{c(u)}),a.onDidAccept(()=>{const u=l(a.value);typeof u=="number"?(s.goToMatch(u),a.hide()):a.validationMessage=_("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount)}),a.onDidHide(()=>{this.clearDecorations(t),a.dispose()}),a.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:Tn(_Pe),position:zo.Full}}}])})}}class uae extends wi{run(e,t){return Mp(this,void 0,void 0,function*(){const i=Ks.get(t);if(!i)return;const s=aO(t,"single",!1);s&&i.setSearchString(s),this._run(i)||(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))})}}class mqe extends uae{constructor(){super({id:Qt.NextSelectionMatchFindAction,label:_("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class _qe extends uae{constructor(){super({id:Qt.PreviousSelectionMatchFindAction,label:_("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const bqe=hne(new une({id:Qt.StartFindReplaceAction,label:_("startReplace","Replace"),alias:"Replace",precondition:Ve.or(ee.focus,Ve.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:B.MenubarEditMenu,group:"3_find",title:_({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));bqe.addImplementation(0,(n,e,t)=>{if(!e.hasModel()||e.getOption(90))return!1;const i=Ks.get(e);if(!i)return!1;const s=e.getSelection(),r=i.isFindInputFocused(),o=!s.isEmpty()&&s.startLineNumber===s.endLineNumber&&e.getOption(41).seedSearchStringFromSelection!=="never"&&!r,a=r||o?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:o?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop})});Va(Ks.ID,lO,0);dt(hqe);dt(dqe);dt(fqe);dt(gqe);dt(pqe);dt(mqe);dt(_qe);const Ml=Pa.bindToContribution(Ks.get);qe(new Ml({id:Qt.CloseFindWidgetCommand,precondition:gh,handler:n=>n.closeFindWidget(),kbOpts:{weight:100+5,kbExpr:Ve.and(ee.focus,Ve.not("isComposing")),primary:9,secondary:[1033]}}));qe(new Ml({id:Qt.ToggleCaseSensitiveCommand,precondition:void 0,handler:n=>n.toggleCaseSensitive(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:o2.primary,mac:o2.mac,win:o2.win,linux:o2.linux}}));qe(new Ml({id:Qt.ToggleWholeWordCommand,precondition:void 0,handler:n=>n.toggleWholeWords(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:a2.primary,mac:a2.mac,win:a2.win,linux:a2.linux}}));qe(new Ml({id:Qt.ToggleRegexCommand,precondition:void 0,handler:n=>n.toggleRegex(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:l2.primary,mac:l2.mac,win:l2.win,linux:l2.linux}}));qe(new Ml({id:Qt.ToggleSearchScopeCommand,precondition:void 0,handler:n=>n.toggleSearchScope(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:c2.primary,mac:c2.mac,win:c2.win,linux:c2.linux}}));qe(new Ml({id:Qt.TogglePreserveCaseCommand,precondition:void 0,handler:n=>n.togglePreserveCase(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:u2.primary,mac:u2.mac,win:u2.win,linux:u2.linux}}));qe(new Ml({id:Qt.ReplaceOneAction,precondition:gh,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:3094}}));qe(new Ml({id:Qt.ReplaceOneAction,precondition:gh,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:Ve.and(ee.focus,f9),primary:3}}));qe(new Ml({id:Qt.ReplaceAllAction,precondition:gh,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:2563}}));qe(new Ml({id:Qt.ReplaceAllAction,precondition:gh,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:Ve.and(ee.focus,f9),primary:void 0,mac:{primary:2051}}}));qe(new Ml({id:Qt.SelectAllMatchesAction,precondition:gh,handler:n=>n.selectAllMatches(),kbOpts:{weight:100+5,kbExpr:ee.focus,primary:515}}));const f2=P("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},_("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);P("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},_("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);P("editor.wordHighlightTextBackground",{light:f2,dark:f2,hcDark:f2,hcLight:f2},_("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const g2=P("editor.wordHighlightBorder",{light:null,dark:null,hcDark:ui,hcLight:ui},_("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));P("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:ui,hcLight:ui},_("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));P("editor.wordHighlightTextBorder",{light:g2,dark:g2,hcDark:g2,hcLight:g2},_("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const vqe=P("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},_("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),wqe=P("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hcDark:"#C0A0C0CC",hcLight:"#C0A0C0CC"},_("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),yqe=P("editorOverviewRuler.wordHighlightTextForeground",{dark:hv,light:hv,hcDark:hv,hcLight:hv},_("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);mt.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:Tn(wqe),position:zo.Center},minimap:{color:Tn(BT),position:Or.Inline}});mt.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:Tn(yqe),position:zo.Center},minimap:{color:Tn(BT),position:Or.Inline}});const Cqe=mt.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:Tn(hv),position:zo.Center},minimap:{color:Tn(BT),position:Or.Inline}}),Sqe=mt.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"});mt.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:Tn(vqe),position:zo.Center},minimap:{color:Tn(BT),position:Or.Inline}});function xqe(n){return n?Sqe:Cqe}$a((n,e)=>{const t=n.getColor($8);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var kqe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Lqe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},cO;function If(n,e){const t=e.filter(i=>!n.find(s=>s.equals(i)));if(t.length>=1){const i=t.map(r=>`line ${r.viewState.position.lineNumber} column ${r.viewState.position.column}`).join(", "),s=t.length===1?_("cursorAdded","Cursor added: {0}",i):_("cursorsAdded","Cursors added: {0}",i);ky(s)}}class Dqe extends wi{constructor(){super({id:"editor.action.insertCursorAbove",label:_("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&i.logicalLine===!1&&(s=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,jn.addCursorUp(r,o,s)),r.revealTopMostCursor(i.source),If(o,r.getCursorStates())}}class Eqe extends wi{constructor(){super({id:"editor.action.insertCursorBelow",label:_("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&i.logicalLine===!1&&(s=!1);const r=t._getViewModel();if(r.cursorConfig.readOnly)return;r.model.pushStackElement();const o=r.getCursorStates();r.setCursorStates(i.source,3,jn.addCursorDown(r,o,s)),r.revealBottomMostCursor(i.source),If(o,r.getCursorStates())}}class Tqe extends wi{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:_("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let s=e.startLineNumber;s<e.endLineNumber;s++){const r=t.getLineMaxColumn(s);i.push(new Lt(s,r,s,r))}e.endColumn>1&&i.push(new Lt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),s=t.getSelections(),r=t._getViewModel(),o=r.getCursorStates(),a=[];s.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),If(o,r.getCursorStates())}}class Aqe extends wi{constructor(){super({id:"editor.action.addCursorsToBottom",label:_("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=t.getModel().getLineCount(),r=[];for(let l=i[0].startLineNumber;l<=s;l++)r.push(new Lt(l,i[0].startColumn,l,i[0].endColumn));const o=t._getViewModel(),a=o.getCursorStates();r.length>0&&t.setSelections(r),If(a,o.getCursorStates())}}class Iqe extends wi{constructor(){super({id:"editor.action.addCursorsToTop",label:_("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=[];for(let a=i[0].startLineNumber;a>=1;a--)s.push(new Lt(a,i[0].startColumn,a,i[0].endColumn));const r=t._getViewModel(),o=r.getCursorStates();s.length>0&&t.setSelections(s),If(o,r.getCursorStates())}}class p2{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class oC{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new oC(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let s=!1,r,o;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(s=!0,r=!0,o=!0):(r=i.wholeWord,o=i.matchCase);const l=e.getSelection();let c,u=null;if(l.isEmpty()){const h=e.getConfiguredWordAtPosition(l.getStartPosition());if(!h)return null;c=h.word,u=new Lt(l.startLineNumber,h.startColumn,l.startLineNumber,h.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new oC(e,t,s,c,r,o,u)}constructor(e,t,i,s,r,o,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=s,this.wholeWord=r,this.matchCase=o,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new p2(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new p2(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const s=this.currentMatch;return this.currentMatch=null,s}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1);return i?new Lt(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new p2(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new p2(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const s=this.currentMatch;return this.currentMatch=null,s}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1);return i?new Lt(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1,1073741824)}}class Fp extends ae{static get(e){return e.getContribution(Fp.ID)}constructor(e){super(),this._sessionDispose=this._register(new Ae),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=oC.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(s=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(s=>{(s.matchCase||s.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new Lt(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const s=e.getState().matchCase;if(!hae(this._editor.getModel(),t,s)){const o=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(o,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const s=this._editor.getModel();i.searchScope?t=s.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(129):null,!1,1073741824):t=s.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(129):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const s=this._editor.getSelection();for(let r=0,o=t.length;r<o;r++){const a=t[r];if(a.range.intersectRanges(s)){t[r]=t[0],t[0]=a;break}}this._setSelections(t.map(r=>new Lt(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn)))}}}Fp.ID="editor.contrib.multiCursorController";class i1 extends wi{run(e,t){const i=Fp.get(t);if(!i)return;const s=t._getViewModel();if(s){const r=s.getCursorStates(),o=Ks.get(t);if(o)this._run(i,o);else{const a=e.get(Wt).createInstance(Ks,t);this._run(i,a),a.dispose()}If(r,s.getCursorStates())}}}class Nqe extends i1{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:_("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:2082,weight:100},menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class Rqe extends i1{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:_("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class Mqe extends i1{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:_("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:ms(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class Fqe extends i1{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:_("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class Pqe extends i1{constructor(){super({id:"editor.action.selectHighlights",label:_("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:3114,weight:100},menuOpts:{menuId:B.MenubarSelectionMenu,group:"3_multi",title:_({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class Oqe extends i1{constructor(){super({id:"editor.action.changeAll",label:_("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:Ve.and(ee.writable,ee.editorTextFocus),kbOpts:{kbExpr:ee.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class Bqe{constructor(e,t,i,s,r){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=s,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,r&&this._model===r._model&&this._searchText===r._searchText&&this._matchCase===r._matchCase&&this._wordSeparators===r._wordSeparators&&this._modelVersionId===r._modelVersionId&&(this._cachedFindMatches=r._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(H.compareRangesUsingStarts)),this._cachedFindMatches}}let aC=cO=class extends ae{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(107),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new Ui(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(s=>{this._isEnabled=e.getOption(107)})),this._register(e.onDidChangeCursorSelection(s=>{this._isEnabled&&(s.selection.isEmpty()?s.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(s=>{this._setState(null)})),this._register(e.onDidChangeModelContent(s=>{this._isEnabled&&this.updateSoon.schedule()}));const i=Ks.get(e);i&&this._register(i.getState().onFindReplaceStateChange(s=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(cO._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t||!i.hasModel())return null;const s=i.getSelection();if(s.startLineNumber!==s.endLineNumber)return null;const r=Fp.get(i);if(!r)return null;const o=Ks.get(i);if(!o)return null;let a=r.getSession(o);if(!a){const u=i.getSelections();if(u.length>1){const d=o.getState().matchCase;if(!hae(i.getModel(),u,d))return null}a=oC.create(i,o)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;const l=o.getState(),c=l.matchCase;if(l.isRevealed){let u=l.searchString;c||(u=u.toLowerCase());let h=a.searchText;if(c||(h=h.toLowerCase()),u===h&&a.matchCase===l.matchCase&&a.wholeWord===l.wholeWord&&!l.isRegex)return null}return new Bqe(i.getModel(),a.searchText,a.matchCase,a.wholeWord?i.getOption(129):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),s=this.editor.getSelections();s.sort(H.compareRangesUsingStarts);const r=[];for(let l=0,c=0,u=i.length,h=s.length;l<u;){const d=i[l];if(c>=h)r.push(d),l++;else{const f=H.compareRangesUsingStarts(d,s[c]);f<0?((s[c].isEmpty()||!H.areIntersecting(d,s[c]))&&r.push(d),l++):(f>0||l++,c++)}}const o=this._languageFeaturesService.documentHighlightProvider.has(t)&&this.editor.getOption(80),a=r.map(l=>({range:l,options:xqe(o)}));this._decorations.set(a)}dispose(){this._setState(null),super.dispose()}};aC.ID="editor.contrib.selectionHighlighter";aC=cO=kqe([Lqe(1,wt)],aC);function hae(n,e,t){const i=IG(n,e[0],!t);for(let s=1,r=e.length;s<r;s++){const o=e[s];if(o.isEmpty())return!1;const a=IG(n,o,!t);if(i!==a)return!1}return!0}function IG(n,e,t){const i=n.getValueInRange(e);return t?i.toLowerCase():i}class Wqe extends wi{constructor(){super({id:"editor.action.focusNextCursor",label:_("mutlicursor.focusNextCursor","Focus Next Cursor"),description:{description:_("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=Array.from(s.getCursorStates()),o=r.shift();o&&(r.push(o),s.setCursorStates(i.source,3,r),s.revealPrimaryCursor(i.source,!0),If(r,s.getCursorStates()))}}class Vqe extends wi{constructor(){super({id:"editor.action.focusPreviousCursor",label:_("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),description:{description:_("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=Array.from(s.getCursorStates()),o=r.pop();o&&(r.unshift(o),s.setCursorStates(i.source,3,r),s.revealPrimaryCursor(i.source,!0),If(r,s.getCursorStates()))}}Va(Fp.ID,Fp,4);Va(aC.ID,aC,1);dt(Dqe);dt(Eqe);dt(Tqe);dt(Nqe);dt(Rqe);dt(Mqe);dt(Fqe);dt(Pqe);dt(Oqe);dt(Aqe);dt(Iqe);dt(Wqe);dt(Vqe);const $qe=P("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hcDark:"#A0A0A0",hcLight:"#A0A0A0"},_("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class zqe extends wi{constructor(){super({id:"editor.action.jumpToBracket",label:_("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:3165,weight:100}})}run(e,t){var i;(i=La.get(t))===null||i===void 0||i.jumpToBracket()}}class Hqe extends wi{constructor(){super({id:"editor.action.selectToBracket",label:_("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){var s;let r=!0;i&&i.selectBrackets===!1&&(r=!1),(s=La.get(t))===null||s===void 0||s.selectToBracket(r)}}class Uqe extends wi{constructor(){super({id:"editor.action.removeBrackets",label:_("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:2561,weight:100}})}run(e,t){var i;(i=La.get(t))===null||i===void 0||i.removeBrackets(this.id)}}class jqe{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}class La extends ae{static get(e){return e.getContribution(La.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new Ui(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(71),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(71)&&(this._matchBrackets=this._editor.getOption(71),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const s=i.getStartPosition(),r=e.bracketPairs.matchBracket(s);let o=null;if(r)r[0].containsPosition(s)&&!r[1].containsPosition(s)?o=r[1].getStartPosition():r[1].containsPosition(s)&&(o=r[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(s);if(a)o=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(s);l&&l.range&&(o=l.range.getStartPosition())}}return o?new Lt(o.lineNumber,o.column,o.lineNumber,o.column):new Lt(s.lineNumber,s.column,s.lineNumber,s.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(s=>{const r=s.getStartPosition();let o=t.bracketPairs.matchBracket(r);if(!o&&(o=t.bracketPairs.findEnclosingBrackets(r),!o)){const c=t.bracketPairs.findNextBracket(r);c&&c.range&&(o=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(o){o.sort(H.compareRangesUsingStarts);const[c,u]=o;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?u.getEndPosition():u.getStartPosition(),u.containsPosition(r)){const h=a;a=l,l=h}}a&&l&&i.push(new Lt(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const s=i.getPosition();let r=t.bracketPairs.matchBracket(s);r||(r=t.bracketPairs.findEnclosingBrackets(s)),r&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:r[0],text:""},{range:r[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const s=i.brackets;s&&(e[t++]={range:s[0],options:i.options},e[t++]={range:s[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let s=[];this._lastVersionId===i&&(s=this._lastBracketsData);const r=[];let o=0;for(let h=0,d=e.length;h<d;h++){const f=e[h];f.isEmpty()&&(r[o++]=f.getStartPosition())}r.length>1&&r.sort(X.compare);const a=[];let l=0,c=0;const u=s.length;for(let h=0,d=r.length;h<d;h++){const f=r[h];for(;c<u&&s[c].position.isBefore(f);)c++;if(c<u&&s[c].position.equals(f))a[l++]=s[c];else{let g=t.bracketPairs.matchBracket(f,20),p=La._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!g&&this._matchBrackets==="always"&&(g=t.bracketPairs.findEnclosingBrackets(f,20),p=La._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new jqe(f,g,p)}}this._lastBracketsData=a,this._lastVersionId=i}}La.ID="editor.contrib.bracketMatchingController";La._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=mt.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:Tn($qe),position:zo.Center}});La._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=mt.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});Va(La.ID,La,1);dt(Hqe);dt(zqe);dt(Uqe);_a.appendMenuItem(B.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:_({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});function uO(n,e){return!!n[e]}class GR{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=uO(e.event,t.triggerModifier),this.hasSideBySideModifier=uO(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class NG{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=uO(e,t.triggerModifier)}}class m2{constructor(e,t,i,s){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=s}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function RG(n){return n==="altKey"?Mt?new m2(57,"metaKey",6,"altKey"):new m2(5,"ctrlKey",6,"altKey"):Mt?new m2(6,"altKey",57,"metaKey"):new m2(6,"altKey",5,"ctrlKey")}class qqe extends ae{constructor(e,t){var i;super(),this._onMouseMoveOrRelevantKeyDown=this._register(new G),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new G),this.onExecute=this._onExecute.event,this._onCancel=this._register(new G),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=(i=t==null?void 0:t.extractLineNumberFromMouseEvent)!==null&&i!==void 0?i:s=>s.target.position?s.target.position.lineNumber:0,this._opts=RG(this._editor.getOption(77)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(s=>{if(s.hasChanged(77)){const r=RG(this._editor.getOption(77));if(this._opts.equals(r))return;this._opts=r,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(s=>this._onEditorMouseMove(new GR(s,this._opts)))),this._register(this._editor.onMouseDown(s=>this._onEditorMouseDown(new GR(s,this._opts)))),this._register(this._editor.onMouseUp(s=>this._onEditorMouseUp(new GR(s,this._opts)))),this._register(this._editor.onKeyDown(s=>this._onEditorKeyDown(new NG(s,this._opts)))),this._register(this._editor.onKeyUp(s=>this._onEditorKeyUp(new NG(s,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(s=>this._onDidChangeCursorSelection(s))),this._register(this._editor.onDidChangeModel(s=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(s=>{(s.scrollTopChanged||s.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var Gqe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ou=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let yb=class extends db{constructor(e,t,i,s,r,o,a,l,c,u,h,d,f){super(e,Object.assign(Object.assign({},s.getRawOptions()),{overflowWidgetsDomNode:s.getOverflowWidgetsDomNode()}),i,r,o,a,l,c,u,h,d,f),this._parentEditor=s,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(s.onDidChangeConfiguration(g=>this._onParentConfigurationChanged(g)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){cT(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};yb=Gqe([ou(4,Wt),ou(5,ci),ou(6,Ys),ou(7,_t),ou(8,qr),ou(9,ts),ou(10,Lf),ou(11,Ur),ou(12,wt)],yb);const MG=new J(new Tt(0,122,204)),Kqe={showArrow:!0,showFrame:!0,className:"",frameColor:MG,arrowColor:MG,keepEditorSelection:!1},Zqe="vs.editor.contrib.zoneWidget";class Yqe{constructor(e,t,i,s,r,o,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=s,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=r,this._onComputedHeight=o}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class Xqe{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class CA{constructor(e){this._editor=e,this._ruleName=CA._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),fH(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){fH(this._ruleName),U3(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:H.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}}CA._IdGenerator=new L7(".arrow-decoration-");class Qqe{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new Ae,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=bu(t),cT(this.options,Kqe,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const s=this._getWidth(i);this.domNode.style.width=s+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(s)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new CA(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){var t;if(this.domNode.style.height=`${e}px`,this.container){const i=e-this._decoratingElementsHeight();this.container.style.height=`${i}px`;const s=this.editor.getLayoutInfo();this._doLayout(i,this._getWidth(s))}(t=this._resizeSash)===null||t===void 0||t.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=H.isIRange(e)?H.lift(e):H.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:mt.EMPTY}])}hide(){var e;this._viewZone&&(this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(e=this._arrow)===null||e===void 0||e.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const e=this.editor.getOption(66);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),s=this.editor.getLayoutInfo(),r=this._getWidth(s);this.domNode.style.width=`${r}px`,this.domNode.style.left=this._getLeft(s)+"px";const o=document.createElement("div");o.style.overflow="hidden";const a=this.editor.getOption(66);if(!this.options.allowUnlimitedHeight){const d=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,d)}let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(c=Math.round(a/9)),this.editor.changeViewZones(d=>{this._viewZone&&d.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new Yqe(o,i.lineNumber,i.column,t,f=>this._onViewZoneTop(f),f=>this._onViewZoneHeight(f),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=d.addZone(this._viewZone),this._overlayWidget=new Xqe(Zqe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const d=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=d+"px",this.container.style.borderBottomWidth=d+"px"}const u=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=u+"px",this.container.style.overflow="hidden"),this._doLayout(u,r),this.options.keepEditorSelection||this.editor.setSelection(e);const h=this.editor.getModel();if(h){const d=h.validateRange(new H(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(d,d.startLineNumber===h.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new rs(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(66),s=i<0?Math.ceil(i):Math.floor(i),r=e.heightInLines+s;r>5&&r<35&&this._relayout(r)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var dae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},fae=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const gae=kt("IPeekViewService");At(gae,class{constructor(){this._widgets=new Map}addExclusiveWidget(n,e){const t=this._widgets.get(n);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const s=this._widgets.get(n);s&&s.widget===e&&(s.listener.dispose(),this._widgets.delete(n))};this._widgets.set(n,{widget:e,listener:e.onDidClose(i)})}},1);var Vr;(function(n){n.inPeekEditor=new Fe("inReferenceSearchEditor",!0,_("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),n.notInPeekEditor=n.inPeekEditor.toNegated()})(Vr||(Vr={}));let lC=class{constructor(e,t){e instanceof yb&&Vr.inPeekEditor.bindTo(t)}dispose(){}};lC.ID="editor.contrib.referenceController";lC=dae([fae(1,_t)],lC);Va(lC.ID,lC,0);function Jqe(n){const e=n.get(ci).getFocusedCodeEditor();return e instanceof yb?e.getParentEditor():e}const eGe={headerBackgroundColor:J.white,primaryHeadingColor:J.fromHex("#333333"),secondaryHeadingColor:J.fromHex("#6c6c6cb3")};let jD=class extends Qqe{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new G,this.onDidClose=this._onDidClose.event,cT(this.options,eGe,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=Be(".head"),this._bodyElement=Be(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=Be(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),pn(this._titleElement,"click",r=>this._onTitleClick(r))),Se(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=Be("span.filename"),this._secondaryHeading=Be("span.dirname"),this._metaHeading=Be("span.meta"),Se(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=Be(".peekview-actions");Se(this._headElement,i);const s=this._getActionBarOptions();this._actionbarWidget=new Fc(i,s),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new _o("peekview.close",_("label.close","Close"),Ye.asClassName(we.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:BBe.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:vo(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,Ug(this._metaHeading)):sd(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(66)*1.2),s=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(s,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};jD=dae([fae(2,Wt)],jD);const tGe=P("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:J.black,hcLight:J.white},_("peekViewTitleBackground","Background color of the peek view title area.")),pae=P("peekViewTitleLabel.foreground",{dark:J.white,light:J.black,hcDark:J.white,hcLight:Df},_("peekViewTitleForeground","Color of the peek view title.")),mae=P("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},_("peekViewTitleInfoForeground","Color of the peek view title info.")),iGe=P("peekView.border",{dark:dr,light:dr,hcDark:pt,hcLight:pt},_("peekViewBorder","Color of the peek view borders and arrow.")),nGe=P("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:J.black,hcLight:J.white},_("peekViewResultsBackground","Background color of the peek view result list."));P("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:J.white,hcLight:Df},_("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));P("peekViewResult.fileForeground",{dark:J.white,light:"#1E1E1E",hcDark:J.white,hcLight:Df},_("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));P("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},_("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));P("peekViewResult.selectionForeground",{dark:J.white,light:"#6C6C6C",hcDark:J.white,hcLight:Df},_("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const bd=P("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:J.black,hcLight:J.white},_("peekViewEditorBackground","Background color of the peek view editor."));P("peekViewEditorGutter.background",{dark:bd,light:bd,hcDark:bd,hcLight:bd},_("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));P("peekViewEditorStickyScroll.background",{dark:bd,light:bd,hcDark:bd,hcLight:bd},_("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));P("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},_("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));P("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},_("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));P("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:ui,hcLight:ui},_("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var sGe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class af{constructor(e,t,i,s){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=s,this.id=YF.nextId()}get uri(){return this.link.uri}get range(){var e,t;return(t=(e=this._range)!==null&&e!==void 0?e:this.link.targetSelectionRange)!==null&&t!==void 0?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=(e=this.parent.getPreview(this))===null||e===void 0?void 0:e.preview(this.range);return t?_({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",t.value,Cl(this.uri),this.range.startLineNumber,this.range.startColumn):_("aria.oneReference","in {0} on line {1} at column {2}",Cl(this.uri),this.range.startLineNumber,this.range.startColumn)}}class rGe{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:s,startColumn:r,endLineNumber:o,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:s,column:r-t}),c=new H(s,l.startColumn,s,r),u=new H(o,a,o,1073741824),h=i.getValueInRange(c).replace(/^\s+/,""),d=i.getValueInRange(e),f=i.getValueInRange(u).replace(/\s+$/,"");return{value:h+d+f,highlight:{start:h.length,end:h.length+d.length}}}}class cC{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new us}dispose(){ti(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?_("aria.fileReferences.1","1 symbol in {0}, full path {1}",Cl(this.uri),this.uri.fsPath):_("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,Cl(this.uri),this.uri.fsPath)}resolve(e){return sGe(this,void 0,void 0,function*(){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=yield e.createModelReference(t.uri);this._previews.set(t.uri,new rGe(i))}catch(i){Ft(i)}return this})}}class Br{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new G,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(Br._compareReferences);let s;for(const r of e)if((!s||!oi.isEqual(s.uri,r.uri,!0))&&(s=new cC(this,r.uri),this.groups.push(s)),s.children.length===0||Br._compareReferences(r,s.children[s.children.length-1])!==0){const o=new af(i===r,s,r,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(o),s.children.push(o)}}dispose(){ti(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new Br(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?_("aria.result.0","No results found"):this.references.length===1?_("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?_("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):_("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let s=i.children.indexOf(e);const r=i.children.length,o=i.parent.groups.length;return o===1||t&&s+1<r||!t&&s>0?(t?s=(s+1)%r:s=(s+r-1)%r,i.children[s]):(s=i.parent.groups.indexOf(i),t?(s=(s+1)%o,i.parent.groups[s].children[0]):(s=(s+o-1)%o,i.parent.groups[s].children[i.parent.groups[s].children.length-1]))}nearestReference(e,t){const i=this.references.map((s,r)=>({idx:r,prefixLen:RL(s.uri.toString(),e.toString()),offsetDist:Math.abs(s.range.startLineNumber-t.lineNumber)*100+Math.abs(s.range.startColumn-t.column)})).sort((s,r)=>s.prefixLen>r.prefixLen?-1:s.prefixLen<r.prefixLen?1:s.offsetDist<r.offsetDist?-1:s.offsetDist>r.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&H.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return oi.compare(e.uri,t.uri)||H.compareRangesUsingStarts(e.range,t.range)}}var SA=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},xA=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},hO;let dO=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof Br||e instanceof cC}getChildren(e){if(e instanceof Br)return e.groups;if(e instanceof cC)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};dO=SA([xA(0,Cf)],dO);class oGe{getHeight(){return 23}getTemplateId(e){return e instanceof cC?uC.id:PS.id}}let fO=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof af){const i=(t=e.parent.getPreview(e))===null||t===void 0?void 0:t.preview(e.range);if(i)return i.value}return Cl(e.uri)}};fO=SA([xA(0,Oi)],fO);class aGe{getId(e){return e instanceof af?e.id:e.uri}}let gO=class extends ae{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new wP(i,{supportHighlights:!0})),this.badge=new vP(Se(i,Be(".count")),{},Wre),e.appendChild(i)}set(e,t){const i=n7(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const s=e.children.length;this.badge.setCount(s),s>1?this.badge.setTitleFormat(_("referencesCount","{0} references",s)):this.badge.setTitleFormat(_("referenceCount","{0} reference",s))}};gO=SA([xA(1,YT)],gO);let uC=hO=class{constructor(e){this._instantiationService=e,this.templateId=hO.id}renderTemplate(e){return this._instantiationService.createInstance(gO,e)}renderElement(e,t,i){i.set(e.element,C7(e.filterData))}disposeTemplate(e){e.dispose()}};uC.id="FileReferencesRenderer";uC=hO=SA([xA(0,Wt)],uC);class lGe{constructor(e){this.label=new Fd(e)}set(e,t){var i;const s=(i=e.parent.getPreview(e))===null||i===void 0?void 0:i.preview(e.range);if(!s||!s.value)this.label.set(`${Cl(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:r,highlight:o}=s;t&&!Xg.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(r,C7(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(r,[o]))}}}class PS{constructor(){this.templateId=PS.id}renderTemplate(e){return new lGe(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}PS.id="OneReferenceRenderer";class cGe{getWidgetAriaLabel(){return _("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var uGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},au=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},FG=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class kA{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new Ae,this._callOnModelChange=new Ae,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let s=0,r=e.children.length;s<r;s++){const o=e.children[s];this._decorationIgnoreSet.has(o.id)||o.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:o.range,options:kA.DecorationOptions}),i.push(s))}this._editor.changeDecorations(s=>{const r=s.deltaDecorations([],t);for(let o=0;o<r.length;o++)this._decorations.set(r[o],e.children[i[o]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,s]of this._decorations){const r=t.getDecorationRange(i);if(!r)continue;let o=!1;if(!H.equalsRange(r,s.range)){if(H.spansMultipleLines(r))o=!0;else{const a=s.range.endColumn-s.range.startColumn,l=r.endColumn-r.startColumn;a!==l&&(o=!0)}o?(this._decorationIgnoreSet.add(s.id),e.push(i)):s.range=r}}for(let i=0,s=e.length;i<s;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}kA.DecorationOptions=mt.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class hGe{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const s=JSON.parse(e);t=s.ratio,i=s.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class dGe extends mP{}let pO=class extends jD{constructor(e,t,i,s,r,o,a,l,c,u,h,d){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},o),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=r,this._instantiationService=o,this._peekViewService=a,this._uriLabel=l,this._undoRedoService=c,this._keybindingService=u,this._languageService=h,this._languageConfigurationService=d,this._disposeOnNewModel=new Ae,this._callOnDispose=new Ae,this._onDidSelectReference=new G,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new yi(0,0),this._applyTheme(s.getColorTheme()),this._callOnDispose.add(s.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),ti(this._preview),ti(this._previewNotAvailableMessage),ti(this._tree),ti(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(iGe)||J.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(tGe)||J.transparent,primaryHeadingColor:e.getColor(pae),secondaryHeadingColor:e.getColor(mae)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=Se(e,Be("div.messages")),sd(this._messageContainer),this._splitView=new jre(e,{orientation:1}),this._previewContainer=Se(e,Be("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(yb,this._previewContainer,t,{},this.editor),sd(this._previewContainer),this._previewNotAvailableMessage=new Mc(_("missingPreviewMessage","no preview available"),Bo,Mc.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=Se(e,Be("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new cGe,keyboardNavigationLabelProvider:this._instantiationService.createInstance(fO),identityProvider:new aGe,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:nGe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(pn(this._treeContainer,"keydown",r=>{r.equals(9)&&(this._keybindingService.dispatchEvent(r,r.target),r.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(dGe,"ReferencesWidget",this._treeContainer,new oGe,[this._instantiationService.createInstance(uC),this._instantiationService.createInstance(PS)],this._instantiationService.createInstance(dO),i),this._splitView.addView({onDidChange:Ee.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:r=>{this._preview.layout({height:this._dim.height,width:r})}},ID.Distribute),this._splitView.addView({onDidChange:Ee.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:r=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${r}px`,this._tree.layout(this._dim.height,r)}},ID.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const s=(r,o)=>{r instanceof af&&(o==="show"&&this._revealReference(r,!1),this._onDidSelectReference.fire({element:r,kind:o,source:"tree"}))};this._tree.onDidOpen(r=>{r.sideBySide?s(r.element,"side"):r.editorOptions.pinned?s(r.element,"goto"):s(r.element,"show")}),sd(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new yi(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=_("noResults","No results"),Ug(this._messageContainer),Promise.resolve(void 0)):(sd(this._messageContainer),this._decorationsManager=new kA(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const s=this._getFocusedReference();s&&this._onDidSelectReference.fire({element:{uri:s.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),Ug(this._treeContainer),Ug(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof af)return e;if(e instanceof cC&&e.children.length>0)return e.children[0]}revealReference(e){return FG(this,void 0,void 0,function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})})}_revealReference(e,t){return FG(this,void 0,void 0,function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==bt.inMemory?this.setTitle(L5e(e.uri),this._uriLabel.getUriLabel(n7(e.uri))):this.setTitle(_("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent),this._tree.reveal(e));const s=yield i;if(!this._model){s.dispose();return}ti(this._previewModelReference);const r=s.object;if(r){const o=this._preview.getModel()===r.textEditorModel?0:1,a=H.lift(e.range).collapseToStart();this._previewModelReference=s,this._preview.setModel(r.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,o)}else this._preview.setModel(this._previewNotAvailableMessage),s.dispose()})}};pO=uGe([au(3,qr),au(4,Cf),au(5,Wt),au(6,gae),au(7,YT),au(8,qT),au(9,Oi),au(10,Ji),au(11,Ur)],pO);var fGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},qm=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},PG=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},_k;const _m=new Fe("referenceSearchVisible",!1,_("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let Cb=_k=class{static get(e){return e.getContribution(_k.ID)}constructor(e,t,i,s,r,o,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=s,this._notificationService=r,this._instantiationService=o,this._storageService=a,this._configurationService=l,this._disposables=new Ae,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=_m.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)===null||e===void 0||e.dispose(),(t=this._model)===null||t===void 0||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let s;if(this._widget&&(s=this._widget.position),this.closeWidget(),s&&e.containsPosition(s))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const r="peekViewLayout",o=hGe.fromJSON(this._storageService.get(r,0,"{}"));this._widget=this._instantiationService.createInstance(pO,this._editor,this._defaultTreeKeyboardSupport,o),this._widget.setTitle(_("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget&&(this._storageService.store(r,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:u}=l;if(c)switch(u){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{var c;if(a!==this._requestIdPool||!this._widget){l.dispose();return}return(c=this._model)===null||c===void 0||c.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(_("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const u=this._editor.getModel().uri,h=new X(e.startLineNumber,e.startColumn),d=this._model.nearestReference(u,h);if(d)return this._widget.setSelection(d).then(()=>{this._widget&&this._editor.getOption(86)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return PG(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const s=this._model.nextOrPreviousReference(i,e),r=this._editor.hasTextFocus(),o=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(s),yield this._gotoReference(s,!1),r?this._editor.focus():this._widget&&o&&this._widget.focusOnPreviewEditor()})}revealReference(e){return PG(this,void 0,void 0,function*(){!this._editor.hasModel()||!this._model||!this._widget||(yield this._widget.revealReference(e))})}closeWidget(e=!0){var t,i;(t=this._widget)===null||t===void 0||t.dispose(),(i=this._model)===null||i===void 0||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){var i;(i=this._widget)===null||i===void 0||i.hide(),this._ignoreModelChangeEvent=!0;const s=H.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:s,selectionSource:"code.jump",pinned:t}},this._editor).then(r=>{var o;if(this._ignoreModelChangeEvent=!1,!r||!this._widget){this.closeWidget();return}if(this._editor===r)this._widget.show(s),this._widget.focusOnReferenceTree();else{const a=_k.get(r),l=this._model.clone();this.closeWidget(),r.focus(),a==null||a.toggleWidget(s,ch(c=>Promise.resolve(l)),(o=this._peekMode)!==null&&o!==void 0?o:!1)}},r=>{this._ignoreModelChangeEvent=!1,Ft(r)})}openReference(e,t,i){t||this.closeWidget();const{uri:s,range:r}=e;this._editorService.openCodeEditor({resource:s,options:{selection:r,selectionSource:"code.jump",pinned:i}},this._editor,t)}};Cb.ID="editor.contrib.referencesController";Cb=_k=fGe([qm(2,_t),qm(3,ci),qm(4,ts),qm(5,Wt),qm(6,dm),qm(7,xi)],Cb);function bm(n,e){const t=Jqe(n);if(!t)return;const i=Cb.get(t);i&&e(i)}wr.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:ms(2089,60),when:Ve.or(_m,Vr.inPeekEditor),handler(n){bm(n,e=>{e.changeFocusBetweenPreviewAndReferences()})}});wr.registerCommandAndKeybindingRule({id:"goToNextReference",weight:100-10,primary:62,secondary:[70],when:Ve.or(_m,Vr.inPeekEditor),handler(n){bm(n,e=>{e.goToNextOrPreviousReference(!0)})}});wr.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:100-10,primary:1086,secondary:[1094],when:Ve.or(_m,Vr.inPeekEditor),handler(n){bm(n,e=>{e.goToNextOrPreviousReference(!1)})}});pi.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");pi.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");pi.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");pi.registerCommand("closeReferenceSearch",n=>bm(n,e=>e.closeWidget()));wr.registerKeybindingRule({id:"closeReferenceSearch",weight:100-101,primary:9,secondary:[1033],when:Ve.and(Vr.inPeekEditor,Ve.not("config.editor.stablePeek"))});wr.registerKeybindingRule({id:"closeReferenceSearch",weight:200+50,primary:9,secondary:[1033],when:Ve.and(_m,Ve.not("config.editor.stablePeek"))});wr.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:Ve.and(_m,ooe,z7.negate(),H7.negate()),handler(n){var e;const i=(e=n.get(Ko).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof af&&bm(n,s=>s.revealReference(i[0]))}});wr.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:Ve.and(_m,ooe,z7.negate(),H7.negate()),handler(n){var e;const i=(e=n.get(Ko).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof af&&bm(n,s=>s.openReference(i[0],!0,!0))}});pi.registerCommand("openReference",n=>{var e;const i=(e=n.get(Ko).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof af&&bm(n,s=>s.openReference(i[0],!1,!0))});var _ae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},bv=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const p9=new Fe("hasSymbols",!1,_("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),LA=kt("ISymbolNavigationService");let mO=class{constructor(e,t,i,s){this._editorService=t,this._notificationService=i,this._keybindingService=s,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=p9.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)===null||e===void 0||e.dispose(),(t=this._currentMessage)===null||t===void 0||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new _O(this._editorService),s=i.onDidChange(r=>{if(this._ignoreEditorChange)return;const o=this._editorService.getActiveCodeEditor();if(!o)return;const a=o.getModel(),l=o.getPosition();if(!a||!l)return;let c=!1,u=!1;for(const h of t.references)if(i7(h.uri,a.uri))c=!0,u=u||H.containsPosition(h.range,l);else if(c)break;(!c||!u)&&this.reset()});this._currentState=ka(i,s)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:H.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var e;(e=this._currentMessage)===null||e===void 0||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?_("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):_("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};mO=_ae([bv(0,_t),bv(1,ci),bv(2,ts),bv(3,Oi)],mO);At(LA,mO,1);qe(new class extends Pa{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:p9,kbOpts:{weight:100,primary:70}})}runEditorCommand(n,e){return n.get(LA).revealNext(e)}});wr.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:p9,primary:9,handler(n){n.get(LA).reset()}});let _O=class{constructor(e){this._listener=new Map,this._disposables=new Ae,this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),ti(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,ka(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))===null||t===void 0||t.dispose(),this._listener.delete(e)}};_O=_ae([bv(0,ci)],_O);var gGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},OG=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},bae=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},bO;let hC=bO=class{constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new G,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const s=new Ae,r=s.add(QT(e,Object.assign(Object.assign({},this._getRenderOptions(e,s)),t),i));return r.element.classList.add("rendered-markdown"),{element:r.element,dispose:()=>s.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:(i,s)=>bae(this,void 0,void 0,function*(){var r,o,a;let l;i?l=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(l=(r=this._options.editor.getModel())===null||r===void 0?void 0:r.getLanguageId()),l||(l=Bo);const c=yield Y6e(this._languageService,s,l),u=document.createElement("span");if(u.innerHTML=(a=(o=bO._ttpTokenizer)===null||o===void 0?void 0:o.createHTML(c))!==null&&a!==void 0?a:c,this._options.editor){const h=this._options.editor.getOption(50);fs(u,h)}else this._options.codeBlockFontFamily&&(u.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(u.style.fontSize=this._options.codeBlockFontSize),u}),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>vae(this._openerService,i,e.isTrusted),disposables:t}}}};hC._ttpTokenizer=rm("tokenizeToString",{createHTML(n){return n}});hC=bO=gGe([OG(1,Ji),OG(2,hh)],hC);function vae(n,e,t){return bae(this,void 0,void 0,function*(){try{return yield n.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:pGe(t)})}catch(i){return Ft(i),!1}})}function pGe(n){return n===!0?!0:n&&Array.isArray(n.enabledCommands)?n.enabledCommands:!1}var mGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},BG=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},bk;let Da=bk=class{static get(e){return e.getContribution(bk.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new wl,this._messageListeners=new Ae,this._mouseOverMessage=!1,this._editor=e,this._visible=bk.MESSAGE_VISIBLE.bindTo(t)}dispose(){var e;(e=this._message)===null||e===void 0||e.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){_S(Rd(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=Rd(e)?QT(e,{actionHandler:{callback:s=>vae(this._openerService,s,Rd(e)?e.isTrusted:void 0),disposables:this._messageListeners}}):void 0,this._messageWidget.value=new WG(this._editor,t,typeof e=="string"?e:this._message.element),this._messageListeners.add(Ee.debounce(this._editor.onDidBlurEditorText,(s,r)=>r,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&Qn(pl(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(oe(this._messageWidget.value.getDomNode(),Le.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(oe(this._messageWidget.value.getDomNode(),Le.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(s=>{s.target.position&&(i?i.containsPosition(s.target.position)||this.closeMessage():i=new H(t.lineNumber-3,1,s.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(WG.fadeOut(this._messageWidget.value))}};Da.ID="editor.contrib.messageController";Da.MESSAGE_VISIBLE=new Fe("messageVisible",!1,_("messageVisible","Whether the editor is currently showing an inline message"));Da=bk=mGe([BG(1,_t),BG(2,hh)],Da);const _Ge=Pa.bindToContribution(Da.get);qe(new _Ge({id:"leaveEditorMessage",precondition:Da.MESSAGE_VISIBLE,handler:n=>n.closeMessage(),kbOpts:{weight:100+30,primary:9}}));let WG=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},s){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const r=document.createElement("div");r.classList.add("anchor","top"),this._domNode.appendChild(r);const o=document.createElement("div");typeof s=="string"?(o.classList.add("message"),o.textContent=s):(s.classList.add("message"),o.appendChild(s)),this._domNode.appendChild(o);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};Va(Da.ID,Da,4);var m9=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function OS(n,e,t,i){return m9(this,void 0,void 0,function*(){const r=t.ordered(n).map(a=>Promise.resolve(i(a,n,e)).then(void 0,l=>{oh(l)})),o=yield Promise.all(r);return aT(o.flat())})}function _9(n,e,t,i){return OS(e,t,n,(s,r,o)=>s.provideDefinition(r,o,i))}function wae(n,e,t,i){return OS(e,t,n,(s,r,o)=>s.provideDeclaration(r,o,i))}function yae(n,e,t,i){return OS(e,t,n,(s,r,o)=>s.provideImplementation(r,o,i))}function Cae(n,e,t,i){return OS(e,t,n,(s,r,o)=>s.provideTypeDefinition(r,o,i))}function DA(n,e,t,i,s){return OS(e,t,n,(r,o,a)=>m9(this,void 0,void 0,function*(){const l=yield r.provideReferences(o,a,{includeDeclaration:!0},s);if(!i||!l||l.length!==2)return l;const c=yield r.provideReferences(o,a,{includeDeclaration:!1},s);return c&&c.length===1?c:l}))}function BS(n){return m9(this,void 0,void 0,function*(){const e=yield n(),t=new Br(e,""),i=t.references.map(s=>s.link);return t.dispose(),i})}Kb("_executeDefinitionProvider",(n,e,t)=>{const i=n.get(wt),s=_9(i.definitionProvider,e,t,In.None);return BS(()=>s)});Kb("_executeTypeDefinitionProvider",(n,e,t)=>{const i=n.get(wt),s=Cae(i.typeDefinitionProvider,e,t,In.None);return BS(()=>s)});Kb("_executeDeclarationProvider",(n,e,t)=>{const i=n.get(wt),s=wae(i.declarationProvider,e,t,In.None);return BS(()=>s)});Kb("_executeReferenceProvider",(n,e,t)=>{const i=n.get(wt),s=DA(i.referenceProvider,e,t,!1,In.None);return BS(()=>s)});Kb("_executeImplementationProvider",(n,e,t)=>{const i=n.get(wt),s=yae(i.implementationProvider,e,t,In.None);return BS(()=>s)});var Ea=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},V1,$1,z1,_2,b2,v2,w2,y2;_a.appendMenuItem(B.EditorContext,{submenu:B.EditorContextPeek,title:_("peek.submenu","Peek"),group:"navigation",order:100});class qD{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof qD||X.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}class Bs extends FNe{static all(){return Bs._allSymbolNavigationCommands.values()}static _patchConfig(e){const t=Object.assign(Object.assign({},e),{f1:!0});if(t.menu)for(const i of Et.wrap(t.menu))(i.id===B.EditorContext||i.id===B.EditorContextPeek)&&(i.when=Ve.and(e.precondition,i.when));return t}constructor(e,t){super(Bs._patchConfig(t)),this.configuration=e,Bs._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,s){if(!t.hasModel())return Promise.resolve(void 0);const r=e.get(ts),o=e.get(ci),a=e.get(xS),l=e.get(LA),c=e.get(wt),u=e.get(Wt),h=t.getModel(),d=t.getPosition(),f=qD.is(i)?i:new qD(h,d),g=new JHe(t,5),p=WNe(this._getLocationModel(c,f.model,f.position,g.token),g.token).then(m=>Ea(this,void 0,void 0,function*(){var b;if(!m||g.token.isCancellationRequested)return;_S(m.ariaMessage);let v;if(m.referenceAt(h.uri,d)){const y=this._getAlternativeCommand(t);!Bs._activeAlternativeCommands.has(y)&&Bs._allSymbolNavigationCommands.has(y)&&(v=Bs._allSymbolNavigationCommands.get(y))}const w=m.references.length;if(w===0){if(!this.configuration.muteMessage){const y=h.getWordAtPosition(d);(b=Da.get(t))===null||b===void 0||b.showMessage(this._getNoResultFoundMessage(y),d)}}else if(w===1&&v)Bs._activeAlternativeCommands.add(this.desc.id),u.invokeFunction(y=>v.runEditorCommand(y,t,i,s).finally(()=>{Bs._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(o,l,t,m,s)}),m=>{r.error(m)}).finally(()=>{g.dispose()});return a.showWhile(p,250),p}_onResult(e,t,i,s,r){return Ea(this,void 0,void 0,function*(){const o=this._getGoToPreference(i);if(!(i instanceof yb)&&(this.configuration.openInPeek||o==="peek"&&s.references.length>1))this._openInPeek(i,s,r);else{const a=s.firstReference(),l=s.references.length>1&&o==="gotoAndPeek",c=yield this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,s,r):s.dispose(),o==="goto"&&t.put(a)}})}_openReference(e,t,i,s,r){return Ea(this,void 0,void 0,function*(){let o;if(zAe(i)&&(o=i.targetSelectionRange),o||(o=i.range),!o)return;const a=yield t.openCodeEditor({resource:i.uri,options:{selection:H.collapseToStart(o),selectionRevealType:3,selectionSource:"code.jump"}},e,s);if(a){if(r){const l=a.getModel(),c=a.createDecorationsCollection([{range:o,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}})}_openInPeek(e,t,i){const s=Cb.get(e);s&&e.hasModel()?s.toggleWidget(i??e.getSelection(),ch(r=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}}Bs._allSymbolNavigationCommands=new Map;Bs._activeAlternativeCommands=new Set;class EA extends Bs{_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield _9(e.definitionProvider,t,i,s),_("def.title","Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?_("noResultWord","No definition found for '{0}'",e.word):_("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}Cr((V1=class extends EA{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:V1.id,title:{value:_("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:_({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:Ve.and(ee.hasDefinitionProvider,ee.isInWalkThroughSnippet.toNegated()),keybinding:[{when:ee.editorTextFocus,primary:70,weight:100},{when:Ve.and(ee.editorTextFocus,noe),primary:2118,weight:100}],menu:[{id:B.EditorContext,group:"navigation",order:1.1},{id:B.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),pi.registerCommandAlias("editor.action.goToDeclaration",V1.id)}},V1.id="editor.action.revealDefinition",V1));Cr(($1=class extends EA{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:$1.id,title:{value:_("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:Ve.and(ee.hasDefinitionProvider,ee.isInWalkThroughSnippet.toNegated()),keybinding:[{when:ee.editorTextFocus,primary:ms(2089,70),weight:100},{when:Ve.and(ee.editorTextFocus,noe),primary:ms(2089,2118),weight:100}]}),pi.registerCommandAlias("editor.action.openDeclarationToTheSide",$1.id)}},$1.id="editor.action.revealDefinitionAside",$1));Cr((z1=class extends EA{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:z1.id,title:{value:_("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:Ve.and(ee.hasDefinitionProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),keybinding:{when:ee.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:B.EditorContextPeek,group:"peek",order:2}}),pi.registerCommandAlias("editor.action.previewDeclaration",z1.id)}},z1.id="editor.action.peekDefinition",z1));class Sae extends Bs{_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield wae(e.declarationProvider,t,i,s),_("decl.title","Declarations"))})}_getNoResultFoundMessage(e){return e&&e.word?_("decl.noResultWord","No declaration found for '{0}'",e.word):_("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}Cr((_2=class extends Sae{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:_2.id,title:{value:_("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:_({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:Ve.and(ee.hasDeclarationProvider,ee.isInWalkThroughSnippet.toNegated()),menu:[{id:B.EditorContext,group:"navigation",order:1.3},{id:B.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?_("decl.noResultWord","No declaration found for '{0}'",e.word):_("decl.generic.noResults","No declaration found")}},_2.id="editor.action.revealDeclaration",_2));Cr(class extends Sae{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:_("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:Ve.and(ee.hasDeclarationProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),menu:{id:B.EditorContextPeek,group:"peek",order:3}})}});class xae extends Bs{_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield Cae(e.typeDefinitionProvider,t,i,s),_("typedef.title","Type Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?_("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):_("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}Cr((b2=class extends xae{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:b2.ID,title:{value:_("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:_({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:Ve.and(ee.hasTypeDefinitionProvider,ee.isInWalkThroughSnippet.toNegated()),keybinding:{when:ee.editorTextFocus,primary:0,weight:100},menu:[{id:B.EditorContext,group:"navigation",order:1.4},{id:B.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},b2.ID="editor.action.goToTypeDefinition",b2));Cr((v2=class extends xae{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:v2.ID,title:{value:_("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:Ve.and(ee.hasTypeDefinitionProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),menu:{id:B.EditorContextPeek,group:"peek",order:4}})}},v2.ID="editor.action.peekTypeDefinition",v2));class kae extends Bs{_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield yae(e.implementationProvider,t,i,s),_("impl.title","Implementations"))})}_getNoResultFoundMessage(e){return e&&e.word?_("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):_("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}Cr((w2=class extends kae{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:w2.ID,title:{value:_("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:_({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:Ve.and(ee.hasImplementationProvider,ee.isInWalkThroughSnippet.toNegated()),keybinding:{when:ee.editorTextFocus,primary:2118,weight:100},menu:[{id:B.EditorContext,group:"navigation",order:1.45},{id:B.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},w2.ID="editor.action.goToImplementation",w2));Cr((y2=class extends kae{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:y2.ID,title:{value:_("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:Ve.and(ee.hasImplementationProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),keybinding:{when:ee.editorTextFocus,primary:3142,weight:100},menu:{id:B.EditorContextPeek,group:"peek",order:5}})}},y2.ID="editor.action.peekImplementation",y2));class Lae extends Bs{_getNoResultFoundMessage(e){return e?_("references.no","No references found for '{0}'",e.word):_("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}Cr(class extends Lae{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:_("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:_({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:Ve.and(ee.hasReferenceProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),keybinding:{when:ee.editorTextFocus,primary:1094,weight:100},menu:[{id:B.EditorContext,group:"navigation",order:1.45},{id:B.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield DA(e.referenceProvider,t,i,!0,s),_("ref.title","References"))})}});Cr(class extends Lae{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:_("references.action.label","Peek References"),original:"Peek References"},precondition:Ve.and(ee.hasReferenceProvider,Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated()),menu:{id:B.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(yield DA(e.referenceProvider,t,i,!1,s),_("ref.title","References"))})}});class bGe extends Bs{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:{value:_("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:Ve.and(Vr.notInPeekEditor,ee.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i,s){return Ea(this,void 0,void 0,function*(){return new Br(this._references,_("generic.title","Locations"))})}_getNoResultFoundMessage(e){return e&&_("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return(t=this._gotoMultipleBehaviour)!==null&&t!==void 0?t:e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}pi.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:ot},{name:"position",description:"The position at which to start",constraint:X.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(n,e,t,i,s,r,o)=>Ea(void 0,void 0,void 0,function*(){cr(ot.isUri(e)),cr(X.isIPosition(t)),cr(Array.isArray(i)),cr(typeof s>"u"||typeof s=="string"),cr(typeof o>"u"||typeof o=="boolean");const a=n.get(ci),l=yield a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(Uoe(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const u=new class extends bGe{_getNoResultFoundMessage(h){return r||super._getNoResultFoundMessage(h)}}({muteMessage:!r,openInPeek:!!o,openToSide:!1},i,s);c.get(Wt).invokeFunction(u.run.bind(u),l)})})});pi.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:ot},{name:"position",description:"The position at which to start",constraint:X.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(n,e,t,i,s)=>Ea(void 0,void 0,void 0,function*(){n.get(Ys).executeCommand("editor.action.goToLocations",e,t,i,s,void 0,!0)})});pi.registerCommand({id:"editor.action.findReferences",handler:(n,e,t)=>{cr(ot.isUri(e)),cr(X.isIPosition(t));const i=n.get(wt),s=n.get(ci);return s.openCodeEditor({resource:e},s.getFocusedCodeEditor()).then(r=>{if(!Uoe(r)||!r.hasModel())return;const o=Cb.get(r);if(!o)return;const a=ch(c=>DA(i.referenceProvider,r.getModel(),X.lift(t),!1,c).then(u=>new Br(u,_("ref.title","References")))),l=new H(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(o.toggleWidget(l,a,!1))})}});pi.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");var vGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},KR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},VG=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},vv;let Pp=vv=class{constructor(e,t,i,s){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=s,this.toUnhook=new Ae,this.toUnhookForKeyboard=new Ae,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const r=new qqe(e);this.toUnhook.add(r),this.toUnhook.add(r.onMouseMoveOrRelevantKeyDown(([o,a])=>{this.startFindDefinitionFromMouse(o,a??void 0)})),this.toUnhook.add(r.onExecute(o=>{this.isEnabled(o)&&this.gotoDefinition(o.target.position,o.hasSideBySideModifier).catch(a=>{Ft(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(r.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(vv.ID)}startFindDefinitionFromCursor(e){return VG(this,void 0,void 0,function*(){yield this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))})}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;return VG(this,void 0,void 0,function*(){this.toUnhookForKeyboard.clear();const i=e?(t=this.editor.getModel())===null||t===void 0?void 0:t.getWordAtPosition(e):null;if(!i){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return;this.currentWordAtPosition=i;const s=new QHe(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=ch(a=>this.findDefinition(e,a));let r;try{r=yield this.previousPromise}catch(a){Ft(a);return}if(!r||!r.length||!s.validate(this.editor)){this.removeLinkDecorations();return}const o=r[0].originSelectionRange?H.lift(r[0].originSelectionRange):new H(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);if(r.length>1){let a=o;for(const{originSelectionRange:l}of r)l&&(a=H.plusRange(a,l));this.addDecoration(a,new pb().appendText(_("multipleResults","Click to show {0} definitions.",r.length)))}else{const a=r[0];if(!a.uri)return;this.textModelResolverService.createModelReference(a.uri).then(l=>{if(!l.object||!l.object.textEditorModel){l.dispose();return}const{object:{textEditorModel:c}}=l,{startLineNumber:u}=a.range;if(u<1||u>c.getLineCount()){l.dispose();return}const h=this.getPreviewValue(c,u,a),d=this.languageService.guessLanguageIdByFilepathOrFirstLine(c.uri);this.addDecoration(o,h?new pb().appendCodeblock(d||"",h):void 0),l.dispose()})}})}getPreviewValue(e,t,i){let s=i.range;return s.endLineNumber-s.startLineNumber>=vv.MAX_SOURCE_PREVIEW_LINES&&(s=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,s)}stripIndentationFromPreviewRange(e,t,i){let r=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);r=Math.min(r,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${r-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),s=Math.min(e.getLineCount(),t+vv.MAX_SOURCE_PREVIEW_LINES);let r=t+1;for(;r<s;r++){const o=e.getLineFirstNonWhitespaceColumn(r);if(i===o)break}return new H(t,1,r+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(((i=e.target.detail.injectedText)===null||i===void 0?void 0:i.options)instanceof hb)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?_9(this.languageFeaturesService.definitionProvider,i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const s=!t&&this.editor.getOption(87)&&!this.isInPeekEditor(i);return new EA({openToSide:t,openInPeek:s,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(_t);return Vr.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};Pp.ID="editor.contrib.gotodefinitionatposition";Pp.MAX_SOURCE_PREVIEW_LINES=8;Pp=vv=vGe([KR(1,Cf),KR(2,Ji),KR(3,wt)],Pp);Va(Pp.ID,Pp,2);const C2=Be;class Dae extends ae{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new K8(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}}class b9 extends ae{static render(e,t,i){return new b9(e,t,i)}constructor(e,t,i){super(),this.actionContainer=Se(e,C2("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=Se(this.actionContainer,C2("a.action")),this.action.setAttribute("role","button"),t.iconClass&&Se(this.action,C2(`span.icon.${t.iconClass}`));const s=Se(this.action,C2("span"));s.textContent=i?`${t.label} (${i})`:t.label,this._register(oe(this.actionContainer,Le.CLICK,r=>{r.stopPropagation(),r.preventDefault(),t.run(this.actionContainer)})),this._register(oe(this.actionContainer,Le.KEY_DOWN,r=>{const o=new ri(r);(o.equals(3)||o.equals(10))&&(r.stopPropagation(),r.preventDefault(),t.run(this.actionContainer))})),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function wGe(n,e){return n&&e?_("acessibleViewHint","Inspect this in the accessible view with {0}.",e):n?_("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}var yGe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},CGe=globalThis&&globalThis.__asyncValues||function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(c){r({value:c,done:a})},o)}};let SGe=class{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}};class Eae extends ae{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new G),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new Ui(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new Ui(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new Ui(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=jNe(e=>this._computer.computeAsync(e)),yGe(this,void 0,void 0,function*(){var e,t,i,s;try{try{for(var r=!0,o=CGe(this._asyncIterable),a;a=yield o.next(),e=a.done,!e;r=!0){s=a.value,r=!1;const l=s;l&&(this._result.push(l),this._fireResult())}}catch(l){t={error:l}}finally{try{!r&&!e&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(l){Ft(l)}})):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const e=this._state===0,t=this._state===4;this._onResult.fire(new SGe(this._result.slice(0),e,t))}start(e){if(e===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class ZR{constructor(e,t,i,s){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=s,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}const v9=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};class xGe{constructor(){this._onDidWillResize=new G,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new G,this.onDidResize=this._onDidResize.event,this._sashListener=new Ae,this._size=new yi(0,0),this._minSize=new yi(0,0),this._maxSize=new yi(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new rs(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new rs(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new rs(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:TD.North}),this._southSash=new rs(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:TD.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(Ee.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(Ee.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(s=>{e&&(i=s.currentX-s.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(s=>{e&&(i=-(s.currentX-s.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(s=>{e&&(t=-(s.currentY-s.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(s=>{e&&(t=s.currentY-s.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(Ee.any(this._eastSash.onDidReset,this._westSash.onDidReset)(s=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(Ee.any(this._northSash.onDidReset,this._southSash.onDidReset)(s=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,s){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=s?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:s}=this._minSize,{height:r,width:o}=this._maxSize;e=Math.max(i,Math.min(r,e)),t=Math.max(s,Math.min(o,t));const a=new yi(t,e);yi.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const kGe=30,LGe=24;class DGe extends ae{constructor(e,t=new yi(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new xGe),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=yi.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new yi(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return!((e=this._contentPosition)===null||e===void 0)&&e.position?X.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:hs(t).top+i.top-kGe}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const s=hs(t),r=xT(t.ownerDocument.body),o=s.top+i.top+i.height;return r.height-o-LGe}_findPositionPreference(e,t){var i,s;const r=Math.min((i=this._availableVerticalSpaceBelow(t))!==null&&i!==void 0?i:1/0,e),o=Math.min((s=this._availableVerticalSpaceAbove(t))!==null&&s!==void 0?s:1/0,e),a=Math.min(Math.max(o,r),e),l=Math.min(e,a);let c;return this._editor.getOption(60).above?c=l<=o?1:2:c=l<=r?2:1,c===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),c}_resize(e){this._resizableNode.layout(e.height,e.width)}}var w9=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Rg=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},vk,jl;const $G=Be;let GD=vk=class extends ae{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._widget=this._register(this._instantiationService.createInstance(Bd,this._editor)),this._participants=[];for(const s of v9.getAll())this._participants.push(this._instantiationService.createInstance(s,this._editor));this._participants.sort((s,r)=>s.hoverOrdinal-r.hoverOrdinal),this._computer=new KD(this._editor,this._participants),this._hoverOperation=this._register(new Eae(this._editor,this._computer)),this._register(this._hoverOperation.onResult(s=>{if(!this._computer.anchor)return;const r=s.hasLoadingMessage?this._addLoadingMessage(s.value):s.value;this._withResult(new Tae(this._computer.anchor,r,s.isComplete))})),this._register(pn(this._widget.getDomNode(),"keydown",s=>{s.equals(9)&&this.hide()})),this._register($i.onDidChange(()=>{this._widget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}get widget(){return this._widget}maybeShowAt(e){if(this._widget.isResizing)return!0;const t=[];for(const s of this._participants)if(s.suggestHoverAnchor){const r=s.suggestHoverAnchor(e);r&&t.push(r)}const i=e.target;if(i.type===6&&t.push(new ZR(0,i.range,e.event.posx,e.event.posy)),i.type===7){const s=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<s&&t.push(new ZR(0,i.range,e.event.posx,e.event.posy))}return t.length===0?this._startShowingOrUpdateHover(null,0,0,!1,e):(t.sort((s,r)=>r.priority-s.priority),this._startShowingOrUpdateHover(t[0],0,0,!1,e))}startShowingAtRange(e,t,i,s){this._startShowingOrUpdateHover(new ZR(0,e,void 0,void 0),t,i,s,null)}_startShowingOrUpdateHover(e,t,i,s,r){return!this._widget.position||!this._currentResult?e?(this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):!1:this._editor.getOption(60).sticky&&r&&this._widget.isMouseGettingCloser(r.event.posx,r.event.posy)?(e&&this._startHoverOperationIfNecessary(e,t,i,s,!0),!0):e?e&&this._currentResult.anchor.equals(e)?!0:e.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,s,r){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=s,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=r,this._hoverOperation.start(t))}_setCurrentResult(e){this._currentResult!==e&&(e&&e.messages.length===0&&(e=null),this._currentResult=e,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}get isColorPickerVisible(){return this._widget.isColorPickerVisible}get isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}get isVisible(){return this._widget.isVisible}get isFocused(){return this._widget.isFocused}get isResizing(){return this._widget.isResizing}containsNode(e){return e?this._widget.getDomNode().contains(e):!1}_addLoadingMessage(e){if(this._computer.anchor){for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}}return e}_withResult(e){this._widget.position&&this._currentResult&&this._currentResult.isComplete&&(!e.isComplete||this._computer.insistOnKeepingHoverVisible&&e.messages.length===0)||this._setCurrentResult(e)}_renderMessages(e,t){const{showAtPosition:i,showAtSecondaryPosition:s,highlightRange:r}=vk.computeHoverRanges(this._editor,e.range,t),o=new Ae,a=o.add(new vO(this._keybindingService)),l=document.createDocumentFragment();let c=null;const u={fragment:l,statusBar:a,setColorPicker:d=>c=d,onContentsChanged:()=>this._widget.onContentsChanged(),setMinimumDimensions:d=>this._widget.setMinimumDimensions(d),hide:()=>this.hide()};for(const d of this._participants){const f=t.filter(g=>g.owner===d);f.length>0&&o.add(d.renderHoverParts(u,f))}const h=t.some(d=>d.isBeforeContent);if(a.hasContent&&l.appendChild(a.hoverElement),l.hasChildNodes()){if(r){const d=this._editor.createDecorationsCollection();d.set([{range:r,options:vk._DECORATION_OPTIONS}]),o.add(ut(()=>{d.clear()}))}this._widget.showAt(l,new TGe(c,i,s,this._editor.getOption(60).above,this._computer.shouldFocus,this._computer.source,h,e.initialMousePosX,e.initialMousePosY,o))}else o.dispose()}static computeHoverRanges(e,t,i){let s=1;if(e.hasModel()){const c=e._getViewModel(),u=c.coordinatesConverter,h=u.convertModelRangeToViewRange(t),d=new X(h.startLineNumber,c.getLineMinColumn(h.startLineNumber));s=u.convertViewPositionToModelPosition(d).column}const r=t.startLineNumber;let o=t.startColumn,a=i[0].range,l=null;for(const c of i)a=H.plusRange(a,c.range),c.range.startLineNumber===r&&c.range.endLineNumber===r&&(o=Math.max(Math.min(o,c.range.startColumn),s)),c.forceShowAtRange&&(l=c.range);return{showAtPosition:l?l.getStartPosition():new X(r,t.startColumn),showAtSecondaryPosition:l?l.getStartPosition():new X(r,o),highlightRange:a}}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}};GD._DECORATION_OPTIONS=mt.register({description:"content-hover-highlight",className:"hoverHighlight"});GD=vk=w9([Rg(1,Wt),Rg(2,Oi)],GD);class Tae{constructor(e,t,i){this.anchor=e,this.messages=t,this.isComplete=i}filter(e){const t=this.messages.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.messages.length?this:new EGe(this,this.anchor,t,this.isComplete)}}class EGe extends Tae{constructor(e,t,i,s){super(t,i,s),this.original=e}filter(e){return this.original.filter(e)}}class TGe{constructor(e,t,i,s,r,o,a,l,c,u){this.colorPicker=e,this.showAtPosition=t,this.showAtSecondaryPosition=i,this.preferAbove=s,this.stoleFocus=r,this.source=o,this.isBeforeContent=a,this.initialMousePosX=l,this.initialMousePosY=c,this.disposables=u,this.closestMouseDistance=void 0}}const zG=30,YR=10,AGe=6;let Bd=jl=class extends DGe{get isColorPickerVisible(){var e;return!!(!((e=this._visibleData)===null||e===void 0)&&e.colorPicker)}get isVisibleFromKeyboard(){var e;return((e=this._visibleData)===null||e===void 0?void 0:e.source)===1}get isVisible(){var e;return(e=this._hoverVisibleKey.get())!==null&&e!==void 0?e:!1}get isFocused(){var e;return(e=this._hoverFocusedKey.get())!==null&&e!==void 0?e:!1}constructor(e,t,i,s,r){const o=e.getOption(66)+8,a=150,l=new yi(a,o);super(e,l),this._configurationService=i,this._accessibilityService=s,this._keybindingService=r,this._hover=this._register(new Dae),this._minimumSize=l,this._hoverVisibleKey=ee.hoverVisible.bindTo(t),this._hoverFocusedKey=ee.hoverFocused.bindTo(t),Se(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>this._layout())),this._register(this._editor.onDidChangeConfiguration(u=>{u.hasChanged(50)&&this._updateFont()}));const c=this._register(ef(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setHoverData(void 0),this._layout(),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),(e=this._visibleData)===null||e===void 0||e.disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return jl.ID}static _applyDimensions(e,t,i){const s=typeof t=="number"?`${t}px`:t,r=typeof i=="number"?`${i}px`:i;e.style.width=s,e.style.height=r}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return jl._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return jl._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const s=typeof t=="number"?`${t}px`:t,r=typeof i=="number"?`${i}px`:i;e.style.maxWidth=s,e.style.maxHeight=r}_setHoverWidgetMaxDimensions(e,t){jl._applyMaxDimensions(this._hover.contentsDomNode,e,t),jl._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_hasHorizontalScrollbar(){const e=this._hover.scrollbar.getScrollDimensions();return e.scrollWidth>e.width}_adjustContentsBottomPadding(){const e=this._hover.contentsDomNode,t=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;e.style.paddingBottom!==t&&(e.style.paddingBottom=t)}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._setContentsDomNodeDimensions(t,i-YR))}_updateResizableNodeMaxDimensions(){var e,t;const i=(e=this._findMaximumRenderingWidth())!==null&&e!==void 0?e:1/0,s=(t=this._findMaximumRenderingHeight())!==null&&t!==void 0?t:1/0;this._resizableNode.maxSize=new yi(i,s),this._setHoverWidgetMaxDimensions(i,s)}_resize(e){var t,i;jl._lastDimensions=new yi(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),(i=(t=this._visibleData)===null||t===void 0?void 0:t.colorPicker)===null||i===void 0||i.layout()}_findAvailableSpaceVertically(){var e;const t=(e=this._visibleData)===null||e===void 0?void 0:e.showAtPosition;if(t)return this._positionPreference===1?this._availableVerticalSpaceAbove(t):this._availableVerticalSpaceBelow(t)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=AGe;return Array.from(this._hover.contentsDomNode.children).forEach(i=>{t+=i.clientHeight}),this._hasHorizontalScrollbar()&&(t+=YR),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<t?xT(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._visibleData)return!1;if(typeof this._visibleData.initialMousePosX>"u"||typeof this._visibleData.initialMousePosY>"u")return this._visibleData.initialMousePosX=e,this._visibleData.initialMousePosY=t,!1;const i=hs(this.getDomNode());typeof this._visibleData.closestMouseDistance>"u"&&(this._visibleData.closestMouseDistance=HG(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,i.left,i.top,i.width,i.height));const s=HG(e,t,i.left,i.top,i.width,i.height);return s>this._visibleData.closestMouseDistance+4?!1:(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,s),!0)}_setHoverData(e){var t;(t=this._visibleData)===null||t===void 0||t.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_layout(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,this._updateMaxDimensions()}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,jl._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,500,jl._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e,t){this._setHoverData(t),this._updateFont(),this._updateContent(e),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){var e;return this._visibleData?{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,positionAffinity:this._visibleData.isBeforeContent?3:void 0,preference:[(e=this._positionPreference)!==null&&e!==void 0?e:1]}:null}showAt(e,t){var i,s,r,o;if(!this._editor||!this._editor.hasModel())return;this._render(e,t);const a=Dg(this._hover.containerDomNode),l=t.showAtPosition;this._positionPreference=(i=this._findPositionPreference(a,l))!==null&&i!==void 0?i:1,this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),(s=t.colorPicker)===null||s===void 0||s.layout();const c=wGe(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(o=(r=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))===null||r===void 0?void 0:r.getAriaLabel())!==null&&o!==void 0?o:"");c&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+c)}hide(){if(!this._visibleData)return;const e=this._visibleData.stoleFocus||this._hoverFocusedKey.get();this._setHoverData(void 0),this._resizableNode.maxSize=new yi(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}_adjustHoverHeightForScrollbar(e){var t;const i=this._hover.containerDomNode,s=this._hover.contentsDomNode,r=(t=this._findMaximumRenderingHeight())!==null&&t!==void 0?t:1/0;this._setContainerDomNodeDimensions(sr(i),Math.min(r,e)),this._setContentsDomNodeDimensions(sr(s),Math.min(r,e-YR))}setMinimumDimensions(e){this._minimumSize=new yi(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new yi(e,this._minimumSize.height)}onContentsChanged(){var e;this._removeConstraintsRenderNormally();const t=this._hover.containerDomNode;let i=Dg(t),s=sr(t);if(this._resizableNode.layout(i,s),this._setHoverWidgetDimensions(s,i),i=Dg(t),s=sr(t),this._contentWidth=s,this._updateMinimumWidth(),this._resizableNode.layout(i,s),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._adjustHoverHeightForScrollbar(i)),!((e=this._visibleData)===null||e===void 0)&&e.showAtPosition){const r=Dg(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(r,this._visibleData.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-zG})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+zG})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};Bd.ID="editor.contrib.resizableContentHoverWidget";Bd._lastDimensions=new yi(0,0);Bd=jl=w9([Rg(1,_t),Rg(2,xi),Rg(3,Lf),Rg(4,Oi)],Bd);let vO=class extends ae{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=$G("div.hover-row.status-bar"),this.actionsElement=Se(this.hoverElement,$G("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(b9.render(this.actionsElement,e,i))}append(e){const t=Se(this.actionsElement,e);return this._hasContent=!0,t}};vO=w9([Rg(0,Oi)],vO);class KD{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),s=t.range.startLineNumber;if(s>i.getLineCount())return[];const r=i.getLineMaxColumn(s);return e.getLineDecorations(s).filter(o=>{if(o.options.isWholeLine)return!0;const a=o.range.startLineNumber===s?o.range.startColumn:1,l=o.range.endLineNumber===s?o.range.endColumn:r;if(o.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return Pn.EMPTY;const i=KD._getLineDecorations(this._editor,t);return Pn.merge(this._participants.map(s=>s.computeAsync?s.computeAsync(t,i,e):Pn.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=KD._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return aT(t)}}function HG(n,e,t,i,s,r){const o=t+s/2,a=i+r/2,l=Math.max(Math.abs(n-o)-s/2,0),c=Math.max(Math.abs(e-a)-r/2,0);return Math.sqrt(l*l+c*c)}const UG=Be;class p_ extends ae{constructor(e,t,i){super(),this._renderDisposeables=this._register(new Ae),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new Dae),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new hC({editor:this._editor},t,i)),this._computer=new IGe(this._editor),this._hoverOperation=this._register(new Eae(this._editor,this._computer)),this._register(this._hoverOperation.onResult(s=>{this._withResult(s.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(s=>{s.hasChanged(50)&&this._updateFont()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return p_.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const s of t){const r=UG("div.hover-row.markdown-hover"),o=Se(r,UG("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(s.value));o.appendChild(a.element),i.appendChild(r)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),s=this._editor.getScrollTop(),r=this._editor.getOption(66),o=this._hover.containerDomNode.clientHeight,a=i-s-(o-r)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}}p_.ID="editor.contrib.modesGlyphHoverWidget";class IGe{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}constructor(e){this._editor=e,this._lineNumber=-1}computeSync(){const e=s=>({value:s}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const s of t){if(!s.options.glyphMarginClassName)continue;const r=s.options.glyphMarginHoverMessage;!r||jy(r)||i.push(...iie(r).map(e))}return i}}var NGe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class RGe{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function MGe(n,e,t,i,s){return NGe(this,void 0,void 0,function*(){try{const r=yield Promise.resolve(n.provideHover(t,i,s));if(r&&PGe(r))return new RGe(n,r,e)}catch(r){oh(r)}})}function Aae(n,e,t,i){const r=n.ordered(e).map((o,a)=>MGe(o,a,e,t,i));return Pn.fromPromises(r).coalesce()}function FGe(n,e,t,i){return Aae(n,e,t,i).map(s=>s.hover).toPromise()}Kb("_executeHoverProvider",(n,e,t)=>{const i=n.get(wt);return FGe(i.hoverProvider,e,t,In.None)});function PGe(n){const e=typeof n.range<"u",t=typeof n.contents<"u"&&n.contents&&n.contents.length>0;return e&&t}var OGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},S2=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const jG=Be;class H1{constructor(e,t,i,s,r){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=s,this.ordinal=r}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let wO=class{constructor(e,t,i,s,r){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=s,this._languageFeaturesService=r,this.hoverOrdinal=3}createLoadingMessage(e){return new H1(this,e.range,[new pb().appendText(_("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),s=e.range.startLineNumber,r=i.getLineMaxColumn(s),o=[];let a=1e3;const l=i.getLineLength(s),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),u=this._editor.getOption(116),h=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let d=!1;u>=0&&l>u&&e.range.startColumn>=u&&(d=!0,o.push(new H1(this,e.range,[{value:_("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!d&&typeof h=="number"&&l>=h&&o.push(new H1(this,e.range,[{value:_("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let f=!1;for(const g of t){const p=g.range.startLineNumber===s?g.range.startColumn:1,m=g.range.endLineNumber===s?g.range.endColumn:r,b=g.options.hoverMessage;if(!b||jy(b))continue;g.options.beforeContentClassName&&(f=!0);const v=new H(e.range.startLineNumber,p,e.range.startLineNumber,m);o.push(new H1(this,v,iie(b),f,a++))}return o}computeAsync(e,t,i){if(!this._editor.hasModel()||e.type!==1)return Pn.EMPTY;const s=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(s))return Pn.EMPTY;const r=new X(e.range.startLineNumber,e.range.startColumn);return Aae(this._languageFeaturesService.hoverProvider,s,r,i).filter(o=>!jy(o.hover.contents)).map(o=>{const a=o.hover.range?H.lift(o.hover.range):e.range;return new H1(this,a,o.hover.contents,!1,o.ordinal)})}renderHoverParts(e,t){return BGe(e,t,this._editor,this._languageService,this._openerService)}};wO=OGe([S2(1,Ji),S2(2,hh),S2(3,xi),S2(4,wt)],wO);function BGe(n,e,t,i,s){e.sort((o,a)=>o.ordinal-a.ordinal);const r=new Ae;for(const o of e)for(const a of o.contents){if(jy(a))continue;const l=jG("div.hover-row.markdown-hover"),c=Se(l,jG("div.hover-contents")),u=r.add(new hC({editor:t},i,s));r.add(u.onDidRenderAsync(()=>{c.className="hover-contents code-hover-contents",n.onContentsChanged()}));const h=r.add(u.render(a));c.appendChild(h.element),n.fragment.appendChild(l)}return r}var WGe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class it{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+it.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(e){return new it(this.value+it.sep+e)}}it.sep=".";it.None=new it("@@none@@");it.Empty=new it("");it.QuickFix=new it("quickfix");it.Refactor=new it("refactor");it.RefactorExtract=it.Refactor.append("extract");it.RefactorInline=it.Refactor.append("inline");it.RefactorMove=it.Refactor.append("move");it.RefactorRewrite=it.Refactor.append("rewrite");it.Notebook=new it("notebook");it.Source=new it("source");it.SourceOrganizeImports=it.Source.append("organizeImports");it.SourceFixAll=it.Source.append("fixAll");it.SurroundWith=it.Refactor.append("surround");var lf;(function(n){n.Refactor="refactor",n.RefactorPreview="refactor preview",n.Lightbulb="lightbulb",n.Default="other (default)",n.SourceAction="source action",n.QuickFix="quick fix action",n.FixAll="fix all",n.OrganizeImports="organize imports",n.AutoFix="auto fix",n.QuickFixHover="quick fix hover window",n.OnSave="save participants",n.ProblemsView="problems view"})(lf||(lf={}));function VGe(n,e){return!(n.include&&!n.include.intersects(e)||n.excludes&&n.excludes.some(t=>Iae(e,t,n.include))||!n.includeSourceActions&&it.Source.contains(e))}function $Ge(n,e){const t=e.kind?new it(e.kind):void 0;return!(n.include&&(!t||!n.include.contains(t))||n.excludes&&t&&n.excludes.some(i=>Iae(t,i,n.include))||!n.includeSourceActions&&t&&it.Source.contains(t)||n.onlyIncludePreferredActions&&!e.isPreferred)}function Iae(n,e,t){return!(!e.contains(n)||t&&e.contains(t))}class cg{static fromUser(e,t){return!e||typeof e!="object"?new cg(t.kind,t.apply,!1):new cg(cg.getKindFromUser(e,t.kind),cg.getApplyFromUser(e,t.apply),cg.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new it(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class zGe{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}resolve(e){var t;return WGe(this,void 0,void 0,function*(){if(!((t=this.provider)===null||t===void 0)&&t.resolveCodeAction&&!this.action.edit){let i;try{i=yield this.provider.resolveCodeAction(this.action,e)}catch(s){oh(s)}i&&(this.action.edit=i.edit)}return this})}}var ZD=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const HGe="editor.action.codeAction",Nae="editor.action.quickFix",UGe="editor.action.autoFix",jGe="editor.action.refactor",qGe="editor.action.sourceAction",Rae="editor.action.organizeImports",Mae="editor.action.fixAll";class hw extends ae{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return Uu(e.diagnostics)?Uu(t.diagnostics)?hw.codeActionsPreferredComparator(e,t):-1:Uu(t.diagnostics)?1:hw.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(hw.codeActionsComparator),this.validActions=this.allActions.filter(({action:s})=>!s.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&it.QuickFix.contains(new it(e.kind))&&!!e.isPreferred)}}const qG={actions:[],documentation:void 0};function dw(n,e,t,i,s,r){var o;return ZD(this,void 0,void 0,function*(){const a=i.filter||{},l=Object.assign(Object.assign({},a),{excludes:[...a.excludes||[],it.Notebook]}),c={only:(o=a.include)===null||o===void 0?void 0:o.value,trigger:i.type},u=new eUe(e,r),h=i.type===2,d=GGe(n,e,h?l:a),f=new Ae,g=d.map(m=>ZD(this,void 0,void 0,function*(){try{s.report(m);const b=yield m.provideCodeActions(e,t,c,u.token);if(b&&f.add(b),u.token.isCancellationRequested)return qG;const v=((b==null?void 0:b.actions)||[]).filter(y=>y&&$Ge(a,y)),w=ZGe(m,v,a.include);return{actions:v.map(y=>new zGe(y,m)),documentation:w}}catch(b){if(Qp(b))throw b;return oh(b),qG}})),p=n.onDidChange(()=>{const m=n.all(e);yn(m,d)||u.cancel()});try{const m=yield Promise.all(g),b=m.map(w=>w.actions).flat(),v=[...aT(m.map(w=>w.documentation)),...KGe(n,e,i,b)];return new hw(b,v,f)}finally{p.dispose(),u.dispose()}})}function GGe(n,e,t){return n.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(s=>VGe(t,new it(s))):!0)}function*KGe(n,e,t,i){var s,r,o;if(e&&i.length)for(const a of n.all(e))a._getAdditionalMenuItems&&(yield*(s=a._getAdditionalMenuItems)===null||s===void 0?void 0:s.call(a,{trigger:t.type,only:(o=(r=t.filter)===null||r===void 0?void 0:r.include)===null||o===void 0?void 0:o.value},i.map(l=>l.action)))}function ZGe(n,e,t){if(!n.documentation)return;const i=n.documentation.map(s=>({kind:new it(s.kind),command:s.command}));if(t){let s;for(const r of i)r.kind.contains(t)&&(s?s.kind.contains(r.kind)&&(s=r):s=r);if(s)return s==null?void 0:s.command}for(const s of e)if(s.kind){for(const r of i)if(r.kind.contains(new it(s.kind)))return r.command}}var YD;(function(n){n.OnSave="onSave",n.FromProblemsView="fromProblemsView",n.FromCodeActions="fromCodeActions"})(YD||(YD={}));function YGe(n,e,t,i,s=In.None){var r;return ZD(this,void 0,void 0,function*(){const o=n.get(pre),a=n.get(Ys),l=n.get(ah),c=n.get(ts);if(l.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),yield e.resolve(s),!s.isCancellationRequested&&!(!((r=e.action.edit)===null||r===void 0)&&r.edits.length&&!(yield o.apply(e.action.edit,{editor:i==null?void 0:i.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==YD.OnSave,showPreview:i==null?void 0:i.preview})).isApplied)&&e.action.command)try{yield a.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(u){const h=XGe(u);c.error(typeof h=="string"?h:_("applyCodeActionFailed","An unknown error occurred while applying the code action"))}})}function XGe(n){return typeof n=="string"?n:n instanceof Error&&typeof n.message=="string"?n.message:void 0}pi.registerCommand("_executeCodeActionProvider",function(n,e,t,i,s){return ZD(this,void 0,void 0,function*(){if(!(e instanceof ot))throw ju();const{codeActionProvider:r}=n.get(wt),o=n.get(Zs).getModel(e);if(!o)throw ju();const a=Lt.isISelection(t)?Lt.liftSelection(t):H.isIRange(t)?o.validateRange(t):void 0;if(!a)throw ju();const l=typeof i=="string"?new it(i):void 0,c=yield dw(r,o,a,{type:1,triggerAction:lf.Default,filter:{includeSourceActions:!0,include:l}},l_.None,In.None),u=[],h=Math.min(c.validActions.length,typeof s=="number"?s:0);for(let d=0;d<h;d++)u.push(c.validActions[d].resolve(In.None));try{return yield Promise.all(u),c.validActions.map(d=>d.action)}finally{setTimeout(()=>c.dispose(),100)}})});var QGe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},JGe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},yO;let XD=yO=class{constructor(e){this.keybindingService=e}getResolver(){const e=new Jp(()=>this.keybindingService.getKeybindings().filter(t=>yO.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===Rae?i={kind:it.SourceOrganizeImports.value}:t.command===Mae&&(i={kind:it.SourceFixAll.value}),Object.assign({resolvedKeybinding:t.resolvedKeybinding},cg.fromUser(i,{kind:it.None,apply:"never"}))}));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.value);return i==null?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new it(e.kind);return t.filter(s=>s.kind.contains(i)).filter(s=>s.preferred?e.isPreferred:!0).reduceRight((s,r)=>s?s.kind.contains(r.kind)?r:s:r,void 0)}};XD.codeActionCommands=[jGe,HGe,qGe,Rae,Mae];XD=yO=QGe([JGe(0,Oi)],XD);P("symbolIcon.arrayForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.booleanForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.colorForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.constantForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},_("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.fileForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.folderForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.keyForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.keywordForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},_("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.moduleForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.namespaceForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.nullForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.numberForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.objectForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.operatorForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.packageForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.propertyForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.referenceForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.snippetForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.stringForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.structForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.textForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.typeParameterForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.unitForeground",{dark:he,light:he,hcDark:he,hcLight:he},_("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));P("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},_("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const Fae=Object.freeze({kind:it.Empty,title:_("codeAction.widget.id.more","More Actions...")}),eKe=Object.freeze([{kind:it.QuickFix,title:_("codeAction.widget.id.quickfix","Quick Fix")},{kind:it.RefactorExtract,title:_("codeAction.widget.id.extract","Extract"),icon:we.wrench},{kind:it.RefactorInline,title:_("codeAction.widget.id.inline","Inline"),icon:we.wrench},{kind:it.RefactorRewrite,title:_("codeAction.widget.id.convert","Rewrite"),icon:we.wrench},{kind:it.RefactorMove,title:_("codeAction.widget.id.move","Move"),icon:we.wrench},{kind:it.SurroundWith,title:_("codeAction.widget.id.surround","Surround With"),icon:we.symbolSnippet},{kind:it.Source,title:_("codeAction.widget.id.source","Source Action"),icon:we.symbolFile},Fae]);function tKe(n,e,t){if(!e)return n.map(r=>{var o;return{kind:"action",item:r,group:Fae,disabled:!!r.action.disabled,label:r.action.disabled||r.action.title,canPreview:!!(!((o=r.action.edit)===null||o===void 0)&&o.edits.length)}});const i=eKe.map(r=>({group:r,actions:[]}));for(const r of n){const o=r.action.kind?new it(r.action.kind):it.None;for(const a of i)if(a.group.kind.contains(o)){a.actions.push(r);break}}const s=[];for(const r of i)if(r.actions.length){s.push({kind:"header",group:r.group});for(const o of r.actions)s.push({kind:"action",item:o,group:r.group,label:o.action.title,disabled:!!o.action.disabled,keybinding:t(o.action)})}return s}var iKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},nKe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},CO,N0;(function(n){n.Hidden={type:0};class e{constructor(i,s,r,o){this.actions=i,this.trigger=s,this.editorPosition=r,this.widgetPosition=o,this.type=1}}n.Showing=e})(N0||(N0={}));let dC=CO=class extends ae{constructor(e,t){super(),this._editor=e,this._onClick=this._register(new G),this.onClick=this._onClick.event,this._state=N0.Hidden,this._domNode=Be("div.lightBulbWidget"),this._register(Zt.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const s=this._editor.getModel();(this.state.type!==1||!s||this.state.editorPosition.lineNumber>=s.getLineCount())&&this.hide()})),this._register(bNe(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:s,height:r}=hs(this._domNode),o=this._editor.getOption(66);let a=Math.floor(o/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=o),this._onClick.fire({x:i.posx,y:s+r+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(oe(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(64)&&!this._editor.getOption(64).enabled&&this.hide()})),this._register(Ee.runAndSubscribe(t.onDidUpdateKeybindings,()=>{var i,s,r,o;this._preferredKbLabel=(s=(i=t.lookupKeybinding(UGe))===null||i===void 0?void 0:i.getLabel())!==null&&s!==void 0?s:void 0,this._quickFixKbLabel=(o=(r=t.lookupKeybinding(Nae))===null||r===void 0?void 0:r.getLabel())!==null&&o!==void 0?o:void 0,this._updateLightBulbTitleAndIcon()}))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.hide();const s=this._editor.getOptions();if(!s.get(64).enabled)return this.hide();const r=this._editor.getModel();if(!r)return this.hide();const{lineNumber:o,column:a}=r.validatePosition(i),l=r.getOptions().tabSize,c=s.get(50),u=r.getLineContent(o),h=UT(u,l),d=c.spaceWidth*h>22,f=p=>p>2&&this._editor.getTopForLineNumber(p)===this._editor.getTopForLineNumber(p-1);let g=o;if(!d){if(o>1&&!f(o-1))g-=1;else if(!f(o+1))g+=1;else if(a*c.spaceWidth<22)return this.hide()}this.state=new N0.Showing(e,t,i,{position:{lineNumber:g,column:1},preference:CO._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state!==N0.Hidden&&(this.state=N0.Hidden,this._editor.layoutContentWidget(this))}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this.state.type===1&&this.state.actions.hasAutoFix&&(this._domNode.classList.remove(...Ye.asClassNameArray(we.lightBulb)),this._domNode.classList.add(...Ye.asClassNameArray(we.lightbulbAutofix)),this._preferredKbLabel)){this.title=_("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel);return}this._domNode.classList.remove(...Ye.asClassNameArray(we.lightbulbAutofix)),this._domNode.classList.add(...Ye.asClassNameArray(we.lightBulb)),this._quickFixKbLabel?this.title=_("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):this.title=_("codeAction","Show Code Actions")}set title(e){this._domNode.title=e}};dC.ID="editor.contrib.lightbulbWidget";dC._posPref=[0];dC=CO=iKe([nKe(1,Oi)],dC);var Pae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},SO=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},sKe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Oae="acceptSelectedCodeAction",Bae="previewSelectedCodeAction";class rKe{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){var s,r;i.text.textContent=(r=(s=e.group)===null||s===void 0?void 0:s.title)!==null&&r!==void 0?r:""}disposeTemplate(e){}}let xO=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const s=new AS(e,co);return{container:e,icon:t,text:i,keybinding:s}}renderElement(e,t,i){var s,r,o;if(!((s=e.group)===null||s===void 0)&&s.icon?(i.icon.className=Ye.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=Ce(e.group.icon.color.id))):(i.icon.className=Ye.asClassName(we.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;i.text.textContent=Wae(e.label),i.keybinding.set(e.keybinding),TNe(!!e.keybinding,i.keybinding.element);const a=(r=this._keybindingService.lookupKeybinding(Oae))===null||r===void 0?void 0:r.getLabel(),l=(o=this._keybindingService.lookupKeybinding(Bae))===null||o===void 0?void 0:o.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.disabled?i.container.title=e.label:a&&l?this._supportsPreview&&e.canPreview?i.container.title=_({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to apply, Shift+F2 to preview"']},"{0} to apply, {1} to preview",a,l):i.container.title=_({key:"label",comment:['placeholder is a keybinding, e.g "F2 to apply"']},"{0} to apply",a):i.container.title=""}disposeTemplate(e){}};xO=Pae([SO(1,Oi)],xO);class oKe extends UIEvent{constructor(){super("acceptSelectedAction")}}class GG extends UIEvent{constructor(){super("previewSelectedAction")}}function aKe(n){if(n.kind==="action")return n.label}let kO=class extends ae{constructor(e,t,i,s,r,o){super(),this._delegate=s,this._contextViewService=r,this._keybindingService=o,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new Wa),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const a={getHeight:l=>l.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:l=>l.kind};this._list=this._register(new Rl(e,this.domNode,a,[new xO(t,this._keybindingService),new rKe],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:aKe},accessibilityProvider:{getAriaLabel:l=>{if(l.kind==="action"){let c=l.label?Wae(l==null?void 0:l.label):"";return l.disabled&&(c=_({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",c,l.disabled)),c}return null},getWidgetAriaLabel:()=>_({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:l=>l.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(fm),this._register(this._list.onMouseClick(l=>this.onListClick(l))),this._register(this._list.onMouseOver(l=>this.onListHover(l))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(l=>this.onListSelection(l))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(c=>c.kind==="header").length,s=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight;this._list.layout(s);const r=this._allMenuItems.map((c,u)=>{const h=document.getElementById(this._list.getElementID(u));if(h){h.style.width="auto";const d=h.getBoundingClientRect().width;return h.style.width="",d}return 0}),o=Math.max(...r,e),a=.7,l=Math.min(s,document.body.clientHeight*a);return this._list.layout(l,o),this.domNode.style.height=`${l}px`,this._list.domFocus(),o}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],s=this._list.element(i);if(!this.focusCondition(s))return;const r=e?new GG:new oKe;this._list.setSelection([i],r)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof GG):this._list.setSelection([])}onFocus(){var e,t;this._list.domFocus();const i=this._list.getFocus();if(i.length===0)return;const s=i[0],r=this._list.element(s);(t=(e=this._delegate).onFocus)===null||t===void 0||t.call(e,r.item)}onListHover(e){return sKe(this,void 0,void 0,function*(){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=yield this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])})}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};kO=Pae([SO(4,Ef),SO(5,Oi)],kO);function Wae(n){return n.replace(/\r\n|\r|\n/g," ")}var lKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},XR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};P("actionBar.toggledBackground",{dark:Eg,light:Eg,hcDark:Eg,hcLight:Eg},_("actionBar.toggledBackground","Background color for toggled action items in action bar."));const Op={Visible:new Fe("codeActionMenuVisible",!1,_("codeActionMenuVisible","Whether the action widget list is visible"))},vm=kt("actionWidgetService");let Bp=class extends ae{get isVisible(){return Op.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new wl)}show(e,t,i,s,r,o,a){const l=Op.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance(kO,e,t,i,s);this._contextViewService.showContextView({getAnchor:()=>r,render:u=>(l.set(!0),this._renderWidget(u,c,a??[])),onHide:u=>{l.reset(),this._onWidgetClosed(u)}},o,!1)}acceptSelected(e){var t;(t=this._list.value)===null||t===void 0||t.acceptSelected(e)}focusPrevious(){var e,t;(t=(e=this._list)===null||e===void 0?void 0:e.value)===null||t===void 0||t.focusPrevious()}focusNext(){var e,t;(t=(e=this._list)===null||e===void 0?void 0:e.value)===null||t===void 0||t.focusNext()}hide(){var e;(e=this._list.value)===null||e===void 0||e.hide(),this._list.clear()}_renderWidget(e,t,i){var s;const r=document.createElement("div");if(r.classList.add("action-widget"),e.appendChild(r),this._list.value=t,this._list.value)r.appendChild(this._list.value.domNode);else throw new Error("List has no value");const o=new Ae,a=document.createElement("div"),l=e.appendChild(a);l.classList.add("context-view-block"),o.add(oe(l,Le.MOUSE_DOWN,g=>g.stopPropagation()));const c=document.createElement("div"),u=e.appendChild(c);u.classList.add("context-view-pointerBlock"),o.add(oe(u,Le.POINTER_MOVE,()=>u.remove())),o.add(oe(u,Le.MOUSE_DOWN,()=>u.remove()));let h=0;if(i.length){const g=this._createActionBar(".action-widget-action-bar",i);g&&(r.appendChild(g.getContainer().parentElement),o.add(g),h=g.getContainer().offsetWidth)}const d=(s=this._list.value)===null||s===void 0?void 0:s.layout(h);r.style.width=`${d}px`;const f=o.add(ef(e));return o.add(f.onDidBlur(()=>this.hide())),o}_createActionBar(e,t){if(!t.length)return;const i=Be(e),s=new Fc(i);return s.push(t,{icon:!1,label:!0}),s}_onWidgetClosed(e){var t;(t=this._list.value)===null||t===void 0||t.hide(e)}};Bp=lKe([XR(0,Ef),XR(1,_t),XR(2,Wt)],Bp);At(vm,Bp,1);const WS=100+1e3;Cr(class extends Gb{constructor(){super({id:"hideCodeActionWidget",title:{value:_("hideCodeActionWidget.title","Hide action widget"),original:"Hide action widget"},precondition:Op.Visible,keybinding:{weight:WS,primary:9,secondary:[1033]}})}run(n){n.get(vm).hide()}});Cr(class extends Gb{constructor(){super({id:"selectPrevCodeAction",title:{value:_("selectPrevCodeAction.title","Select previous action"),original:"Select previous action"},precondition:Op.Visible,keybinding:{weight:WS,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(n){const e=n.get(vm);e instanceof Bp&&e.focusPrevious()}});Cr(class extends Gb{constructor(){super({id:"selectNextCodeAction",title:{value:_("selectNextCodeAction.title","Select next action"),original:"Select next action"},precondition:Op.Visible,keybinding:{weight:WS,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(n){const e=n.get(vm);e instanceof Bp&&e.focusNext()}});Cr(class extends Gb{constructor(){super({id:Oae,title:{value:_("acceptSelected.title","Accept selected action"),original:"Accept selected action"},precondition:Op.Visible,keybinding:{weight:WS,primary:3,secondary:[2137]}})}run(n){const e=n.get(vm);e instanceof Bp&&e.acceptSelected()}});Cr(class extends Gb{constructor(){super({id:Bae,title:{value:_("previewSelected.title","Preview selected action"),original:"Preview selected action"},precondition:Op.Visible,keybinding:{weight:WS,primary:2051}})}run(n){const e=n.get(vm);e instanceof Bp&&e.acceptSelected(!0)}});var cKe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const uKe=new Fe("supportedCodeAction","");class hKe extends ae{constructor(e,t,i,s=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=s,this._autoTriggerTimer=this._register(new uh),this._register(this._markerService.onMarkerChanged(r=>this._onMarkerChanges(r))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>i7(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:lf.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelection();if(i.isEmpty()&&e.type===2){const{lineNumber:s,column:r}=i.getPosition(),o=t.getLineContent(s);if(o.length===0)return;if(r===1){if(/\s/.test(o[0]))return}else if(r===t.getLineMaxColumn(s)){if(/\s/.test(o[o.length-1]))return}else if(/\s/.test(o[r-2])&&/\s/.test(o[r-1]))return}return i}}var ug;(function(n){n.Empty={type:0};class e{constructor(i,s,r){this.trigger=i,this.position=s,this._cancellablePromise=r,this.type=1,this.actions=r.catch(o=>{if(Qp(o))return Vae;throw o})}cancel(){this._cancellablePromise.cancel()}}n.Triggered=e})(ug||(ug={}));const Vae=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1});class dKe extends ae{constructor(e,t,i,s,r,o){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=r,this._configurationService=o,this._codeActionOracle=this._register(new wl),this._state=ug.Empty,this._onDidChangeState=this._register(new G),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=uKe.bindTo(s),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(ug.Empty,!0))}_settingEnabledNearbyQuickfixes(){var e;const t=(e=this._editor)===null||e===void 0?void 0:e.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickfixes",{resource:t==null?void 0:t.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(ug.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(90)){const t=this._registry.all(e).flatMap(i=>{var s;return(s=i.providedCodeActionKinds)!==null&&s!==void 0?s:[]});this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new hKe(this._editor,this._markerService,i=>{var s;if(!i){this.setState(ug.Empty);return}const r=i.selection.getStartPosition(),o=ch(a=>cKe(this,void 0,void 0,function*(){var l,c,u,h,d,f;if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===lf.QuickFix||!((c=(l=i.trigger.filter)===null||l===void 0?void 0:l.include)===null||c===void 0)&&c.contains(it.QuickFix))){const g=yield dw(this._registry,e,i.selection,i.trigger,l_.None,a);if(a.isCancellationRequested)return Vae;if(!((u=g.validActions)===null||u===void 0?void 0:u.some(m=>m.action.kind?it.QuickFix.contains(new it(m.action.kind)):!1))){const m=this._markerService.read({resource:e.uri});if(m.length>0){const b=i.selection.getPosition();let v=b,w=Number.MAX_VALUE,y=!1;for(const x of m){const D=x.endColumn,S=x.endLineNumber,T=x.startLineNumber;(S===b.lineNumber||T===b.lineNumber)&&Math.abs(b.column-D)<w&&(w=Math.abs(b.column-D),y=!0,v=new X(S,D))}if(y){const x={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:!((h=i.trigger.filter)===null||h===void 0)&&h.include?(d=i.trigger.filter)===null||d===void 0?void 0:d.include:it.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:((f=i.trigger.context)===null||f===void 0?void 0:f.notAvailableMessage)||"",position:v}},D=new Lt(v.lineNumber,v.column,v.lineNumber,v.column),S=yield dw(this._registry,e,D,x,l_.None,a),T=[...g.validActions];return S.validActions.length!==0&&(S.validActions.forEach(k=>{k.highlightRange=k.action.isPreferred}),T.push(...S.validActions)),{validActions:T,allActions:g.allActions,documentation:g.documentation,hasAutoFix:g.hasAutoFix,dispose:()=>{g.dispose()}}}}}}return dw(this._registry,e,i.selection,i.trigger,l_.None,a)}));i.trigger.type===1&&((s=this._progressService)===null||s===void 0||s.showWhile(o,250)),this.setState(new ug.Triggered(i.trigger,r,o))},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:lf.Default})}else this._supportedCodeActions.reset()}trigger(e){var t;(t=this._codeActionOracle.value)===null||t===void 0||t.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var fKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},lu=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},U1=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},wk;const gKe="quickfix-edit-highlight";let fC=wk=class extends ae{static get(e){return e.getContribution(wk.ID)}constructor(e,t,i,s,r,o,a,l,c,u){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=u,this._activeCodeActions=this._register(new wl),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new dKe(this._editor,r.codeActionProvider,t,i,o,l)),this._register(this._model.onDidChangeState(h=>this.update(h))),this._lightBulbWidget=new Jp(()=>{const h=this._editor.getContribution(dC.ID);return h&&this._register(h.onClick(d=>this.showCodeActionList(d.actions,d,{includeDisabledActions:!1,fromLightbulb:!0}))),h}),this._resolver=s.createInstance(XD),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,s){var r;if(!this._editor.hasModel())return;(r=Da.get(this._editor))===null||r===void 0||r.closeMessage();const o=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:s,context:{notAvailableMessage:e,position:o}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e,t,i){return U1(this,void 0,void 0,function*(){try{yield this._instantiationService.invokeFunction(YGe,e,YD.FromCodeActions,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:lf.QuickFix,filter:{}})}})}update(e){var t,i,s,r,o,a,l;return U1(this,void 0,void 0,function*(){if(e.type!==1){(t=this._lightBulbWidget.rawValue)===null||t===void 0||t.hide();return}let c;try{c=yield e.actions}catch(u){Ft(u);return}if(!this._disposed)if((i=this._lightBulbWidget.value)===null||i===void 0||i.update(c,e.trigger,e.position),e.trigger.type===1){if(!((s=e.trigger.filter)===null||s===void 0)&&s.include){const h=this.tryGetValidActionToApply(e.trigger,c);if(h){try{(r=this._lightBulbWidget.value)===null||r===void 0||r.hide(),yield this._applyCodeAction(h,!1,!1)}finally{c.dispose()}return}if(e.trigger.context){const d=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,c);if(d&&d.action.disabled){(o=Da.get(this._editor))===null||o===void 0||o.showMessage(d.action.disabled,e.trigger.context.position),c.dispose();return}}}const u=!!(!((a=e.trigger.filter)===null||a===void 0)&&a.include);if(e.trigger.context&&(!c.allActions.length||!u&&!c.validActions.length)){(l=Da.get(this._editor))===null||l===void 0||l.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=c,c.dispose();return}this._activeCodeActions.value=c,this.showCodeActionList(c,this.toCoords(e.position),{includeDisabledActions:u,fromLightbulb:!1})}else this._actionWidgetService.isVisible?c.dispose():this._activeCodeActions.value=c})}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}showCodeActionList(e,t,i){return U1(this,void 0,void 0,function*(){const s=this._editor.createDecorationsCollection(),r=this._editor.getDomNode();if(!r)return;const o=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!o.length)return;const a=X.isIPosition(t)?this.toCoords(t):t,l={onSelect:(c,u)=>U1(this,void 0,void 0,function*(){this._applyCodeAction(c,!0,!!u),this._actionWidgetService.hide(),s.clear()}),onHide:()=>{var c;(c=this._editor)===null||c===void 0||c.focus(),s.clear()},onHover:(c,u)=>U1(this,void 0,void 0,function*(){var h;if(yield c.resolve(u),!u.isCancellationRequested)return{canPreview:!!(!((h=c.action.edit)===null||h===void 0)&&h.edits.length)}}),onFocus:c=>{var u,h;if(c&&c.highlightRange&&c.action.diagnostics){const d=[{range:c.action.diagnostics[0],options:wk.DECORATION}];s.set(d);const f=c.action.diagnostics[0],g=(h=(u=this._editor.getModel())===null||u===void 0?void 0:u.getWordAtPosition({lineNumber:f.startLineNumber,column:f.startColumn}))===null||h===void 0?void 0:h.word;ky(_("editingNewSelection","Context: {0} at line {1} and column {2}.",g,f.startLineNumber,f.startColumn))}else s.clear()}};this._actionWidgetService.show("codeActionWidget",!0,tKe(o,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,r,this._getActionBarActions(e,t,i))})}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=hs(this._editor.getDomNode()),s=i.left+t.left,r=i.top+t.top+t.height;return{x:s,y:r}}_shouldShowHeaders(){var e;const t=(e=this._editor)===null||e===void 0?void 0:e.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:t==null?void 0:t.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const s=e.documentation.map(r=>{var o;return{id:r.id,label:r.title,tooltip:(o=r.tooltip)!==null&&o!==void 0?o:"",class:void 0,enabled:!0,run:()=>{var a;return this._commandService.executeCommand(r.id,...(a=r.arguments)!==null&&a!==void 0?a:[])}}});return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&s.push(this._showDisabled?{id:"hideMoreActions",label:_("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:_("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),s}};fC.ID="editor.contrib.codeActionController";fC.DECORATION=mt.register({description:"quickfix-highlight",className:gKe});fC=wk=fKe([lu(1,Uc),lu(2,_t),lu(3,Wt),lu(4,wt),lu(5,xS),lu(6,Ys),lu(7,xi),lu(8,vm),lu(9,Wt)],fC);$a((n,e)=>{((s,r)=>{r&&e.addRule(`.monaco-editor ${s} { background-color: ${r}; }`)})(".quickfix-edit-highlight",n.getColor(bc));const i=n.getColor(cd);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${Gu(n.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});var $ae=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},QD=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class KG{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let LO=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new G,this.onDidChange=this._onDidChange.event,this._dispoables=new Ae,this._markers=[],this._nextIdx=-1,ot.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const s=this._configService.getValue("problems.sortOrder"),r=(a,l)=>{let c=cy(a.resource.toString(),l.resource.toString());return c===0&&(s==="position"?c=H.compareRangesUsingStarts(a,l)||Ci.compare(a.severity,l.severity):c=Ci.compare(a.severity,l.severity)||H.compareRangesUsingStarts(a,l)),c},o=()=>{this._markers=this._markerService.read({resource:ot.isUri(e)?e:void 0,severities:Ci.Error|Ci.Warning|Ci.Info}),typeof e=="function"&&(this._markers=this._markers.filter(a=>this._resourceFilter(a.resource))),this._markers.sort(r)};o(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&(o(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new KG(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let s=!1,r=this._markers.findIndex(o=>o.resource.toString()===e.uri.toString());r<0&&(r=Qte(this._markers,{resource:e.uri},(o,a)=>cy(o.resource.toString(),a.resource.toString())),r<0&&(r=~r));for(let o=r;o<this._markers.length;o++){let a=H.lift(this._markers[o]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new H(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=o,s=!0;break}if(this._markers[o].resource.toString()!==e.uri.toString())break}s||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const s=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),s!==this._nextIdx}find(e,t){let i=this._markers.findIndex(s=>s.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(H.containsPosition(this._markers[i],t))return new KG(this._markers[i],i+1,this._markers.length)}}};LO=$ae([QD(1,Uc),QD(2,xi)],LO);const zae=kt("IMarkerNavigationService");let DO=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new hr}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new LO(e,this._markerService,this._configService)}};DO=$ae([QD(0,Uc),QD(1,xi)],DO);At(zae,DO,1);var EO;(function(n){function e(t){switch(t){case Fi.Ignore:return"severity-ignore "+Ye.asClassName(we.info);case Fi.Info:return Ye.asClassName(we.info);case Fi.Warning:return Ye.asClassName(we.warning);case Fi.Error:return Ye.asClassName(we.error);default:return""}}n.className=e})(EO||(EO={}));var pKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},Gm=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},TO;class mKe{constructor(e,t,i,s,r){this._openerService=s,this._labelService=r,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new Ae,this._editor=t;const o=document.createElement("div");o.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),o.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),o.appendChild(this._relatedBlock),this._disposables.add(pn(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new use(o,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{o.style.left=`-${a.scrollLeft}px`,o.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){ti(this._disposables)}update(e){const{source:t,message:i,relatedInformation:s,code:r}=e;let o=((t==null?void 0:t.length)||0)+2;r&&(typeof r=="string"?o+=r.length:o+=r.value.length);const a=em(i);this._lines=a.length,this._longestLineLength=0;for(const d of a)this._longestLineLength=Math.max(d.length+o,this._longestLineLength);vo(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const d of a)l=document.createElement("div"),l.innerText=d,d===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||r){const d=document.createElement("span");if(d.classList.add("details"),l.appendChild(d),t){const f=document.createElement("span");f.innerText=t,f.classList.add("source"),d.appendChild(f)}if(r)if(typeof r=="string"){const f=document.createElement("span");f.innerText=`(${r})`,f.classList.add("code"),d.appendChild(f)}else{this._codeLink=Be("a.code-link"),this._codeLink.setAttribute("href",`${r.target.toString()}`),this._codeLink.onclick=g=>{this._openerService.open(r.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()};const f=Se(this._codeLink,Be("span"));f.innerText=r.value,d.appendChild(this._codeLink)}}if(vo(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),Uu(s)){const d=this._relatedBlock.appendChild(document.createElement("div"));d.style.paddingTop=`${Math.floor(this._editor.getOption(66)*.66)}px`,this._lines+=1;for(const f of s){const g=document.createElement("div"),p=document.createElement("a");p.classList.add("filename"),p.innerText=`${this._labelService.getUriBasenameLabel(f.resource)}(${f.startLineNumber}, ${f.startColumn}): `,p.title=this._labelService.getUriLabel(f.resource),this._relatedDiagnostics.set(p,f);const m=document.createElement("span");m.innerText=f.message,g.appendChild(p),g.appendChild(m),this._lines+=1,d.appendChild(g)}}const c=this._editor.getOption(50),u=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:u,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case Ci.Error:t=_("Error","Error");break;case Ci.Warning:t=_("Warning","Warning");break;case Ci.Info:t=_("Info","Info");break;case Ci.Hint:t=_("Hint","Hint");break}let i=_("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const s=this._editor.getModel();return s&&e.startLineNumber<=s.getLineCount()&&e.startLineNumber>=1&&(i=`${s.getLineContent(e.startLineNumber)}, ${i}`),i}}let Sb=TO=class extends jD{constructor(e,t,i,s,r,o,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},r),this._themeService=t,this._openerService=i,this._menuService=s,this._contextKeyService=o,this._labelService=a,this._callOnDispose=new Ae,this._onDidSelectRelatedInformation=new G,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=Ci.Warning,this._backgroundColor=J.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(wKe);let t=AO,i=_Ke;this._severity===Ci.Warning?(t=yk,i=bKe):this._severity===Ci.Info&&(t=IO,i=vKe);const s=e.getColor(t),r=e.getColor(i);this.style({arrowColor:s,frameColor:s,headerBackgroundColor:r,primaryHeadingColor:e.getColor(pae),secondaryHeadingColor:e.getColor(mae)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(s=>this.editor.focus()));const t=[],i=this._menuService.createMenu(TO.TitleMenu,this._contextKeyService);$re(i,void 0,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0}),i.dispose()}_fillTitleIcon(e){this._icon=Se(e,Be(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new mKe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const s=H.lift(e),r=this.editor.getPosition(),o=r&&s.containsPosition(r)?r:s.getStartPosition();super.show(o,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?_("problems","{0} of {1} problems",t,i):_("change","{0} of {1} problem",t,i);this.setTitle(Cl(a.uri),l)}this._icon.className=`codicon ${EO.className(Ci.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(o,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};Sb.TitleMenu=new B("gotoErrorTitleMenu");Sb=TO=pKe([Gm(1,qr),Gm(2,hh),Gm(3,Sf),Gm(4,Wt),Gm(5,_t),Gm(6,YT)],Sb);const ZG=Ty(mc,u3e),YG=Ty(ho,Dy),XG=Ty(dr,Ey),AO=P("editorMarkerNavigationError.background",{dark:ZG,light:ZG,hcDark:pt,hcLight:pt},_("editorMarkerNavigationError","Editor marker navigation widget error color.")),_Ke=P("editorMarkerNavigationError.headerBackground",{dark:We(AO,.1),light:We(AO,.1),hcDark:null,hcLight:null},_("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),yk=P("editorMarkerNavigationWarning.background",{dark:YG,light:YG,hcDark:pt,hcLight:pt},_("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),bKe=P("editorMarkerNavigationWarning.headerBackground",{dark:We(yk,.1),light:We(yk,.1),hcDark:"#0C141F",hcLight:We(yk,.2)},_("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),IO=P("editorMarkerNavigationInfo.background",{dark:XG,light:XG,hcDark:pt,hcLight:pt},_("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),vKe=P("editorMarkerNavigationInfo.headerBackground",{dark:We(IO,.1),light:We(IO,.1),hcDark:null,hcLight:null},_("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),wKe=P("editorMarkerNavigation.background",{dark:vn,light:vn,hcDark:vn,hcLight:vn},_("editorMarkerNavigationBackground","Editor marker navigation widget background."));var yKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},x2=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Hae=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},wv;let cf=wv=class{static get(e){return e.getContribution(wv.ID)}constructor(e,t,i,s,r){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=s,this._instantiationService=r,this._sessionDispoables=new Ae,this._editor=e,this._widgetVisible=Uae.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(Sb,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{var s,r,o;(!(!((s=this._model)===null||s===void 0)&&s.selected)||!H.containsPosition((r=this._model)===null||r===void 0?void 0:r.selected.marker,i.position))&&((o=this._model)===null||o===void 0||o.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:H.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new X(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(e,t){var i,s;return Hae(this,void 0,void 0,function*(){if(this._editor.hasModel()){const r=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(r.move(e,this._editor.getModel(),this._editor.getPosition()),!r.selected)return;if(r.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const o=yield this._editorService.openCodeEditor({resource:r.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:r.selected.marker}},this._editor);o&&((i=wv.get(o))===null||i===void 0||i.close(),(s=wv.get(o))===null||s===void 0||s.nagivate(e,t))}else this._widget.showAtMarker(r.selected.marker,r.selected.index,r.selected.total)}})}};cf.ID="editor.contrib.markerController";cf=wv=yKe([x2(1,zae),x2(2,_t),x2(3,ci),x2(4,Wt)],cf);class TA extends wi{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return Hae(this,void 0,void 0,function*(){t.hasModel()&&((i=cf.get(t))===null||i===void 0||i.nagivate(this._next,this._multiFile))})}}class Wd extends TA{constructor(){super(!0,!1,{id:Wd.ID,label:Wd.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:578,weight:100},menuOpts:{menuId:Sb.TitleMenu,title:Wd.LABEL,icon:Cn("marker-navigation-next",we.arrowDown,_("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}Wd.ID="editor.action.marker.next";Wd.LABEL=_("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class ep extends TA{constructor(){super(!1,!1,{id:ep.ID,label:ep.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:1602,weight:100},menuOpts:{menuId:Sb.TitleMenu,title:ep.LABEL,icon:Cn("marker-navigation-previous",we.arrowUp,_("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}ep.ID="editor.action.marker.prev";ep.LABEL=_("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class CKe extends TA{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:_("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:66,weight:100},menuOpts:{menuId:B.MenubarGoMenu,title:_({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class SKe extends TA{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:_("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:ee.focus,primary:1090,weight:100},menuOpts:{menuId:B.MenubarGoMenu,title:_({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}Va(cf.ID,cf,4);dt(Wd);dt(ep);dt(CKe);dt(SKe);const Uae=new Fe("markersNavigationVisible",!1),xKe=Pa.bindToContribution(cf.get);qe(new xKe({id:"closeMarkersNavigation",precondition:Uae,handler:n=>n.close(),kbOpts:{weight:100+50,kbExpr:ee.focus,primary:9,secondary:[1033]}}));var kKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},QR=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const ea=Be;class LKe{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const QG={type:1,filter:{include:it.QuickFix},triggerAction:lf.QuickFixHover};let NO=class{constructor(e,t,i,s){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=s,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),s=e.range.startLineNumber,r=i.getLineMaxColumn(s),o=[];for(const a of t){const l=a.range.startLineNumber===s?a.range.startColumn:1,c=a.range.endLineNumber===s?a.range.endColumn:r,u=this._markerDecorationsService.getMarker(i.uri,a);if(!u)continue;const h=new H(e.range.startLineNumber,l,e.range.startLineNumber,c);o.push(new LKe(this,h,u))}return o}renderHoverParts(e,t){if(!t.length)return ae.None;const i=new Ae;t.forEach(r=>e.fragment.appendChild(this.renderMarkerHover(r,i)));const s=t.length===1?t[0]:t.sort((r,o)=>Ci.compare(r.marker.severity,o.marker.severity))[0];return this.renderMarkerStatusbar(e,s,i),i}renderMarkerHover(e,t){const i=ea("div.hover-row"),s=Se(i,ea("div.marker.hover-contents")),{source:r,message:o,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(s);const c=Se(s,ea("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=o,r||a)if(a&&typeof a!="string"){const u=ea("span");if(r){const g=Se(u,ea("span"));g.innerText=r}const h=Se(u,ea("a.code-link"));h.setAttribute("href",a.target.toString()),t.add(oe(h,"click",g=>{this._openerService.open(a.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()}));const d=Se(h,ea("span"));d.innerText=a.value;const f=Se(s,u);f.style.opacity="0.6",f.style.paddingLeft="6px"}else{const u=Se(s,ea("span"));u.style.opacity="0.6",u.style.paddingLeft="6px",u.innerText=r&&a?`${r}(${a})`:r||`(${a})`}if(Uu(l))for(const{message:u,resource:h,startLineNumber:d,startColumn:f}of l){const g=Se(s,ea("div"));g.style.marginTop="8px";const p=Se(g,ea("a"));p.innerText=`${Cl(h)}(${d}, ${f}): `,p.style.cursor="pointer",t.add(oe(p,"click",b=>{b.stopPropagation(),b.preventDefault(),this._openerService&&this._openerService.open(h,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:d,startColumn:f}}}).catch(Ft)}));const m=Se(g,ea("span"));m.innerText=u,this._editor.applyFontInfo(m)}return i}renderMarkerStatusbar(e,t,i){if((t.marker.severity===Ci.Error||t.marker.severity===Ci.Warning||t.marker.severity===Ci.Info)&&e.statusBar.addAction({label:_("view problem","View Problem"),commandId:Wd.ID,run:()=>{var s;e.hide(),(s=cf.get(this._editor))===null||s===void 0||s.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(90)){const s=e.statusBar.append(ea("div"));this.recentMarkerCodeActionsInfo&&(DD.makeKey(this.recentMarkerCodeActionsInfo.marker)===DD.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(s.textContent=_("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const r=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?ae.None:i.add(WL(()=>s.textContent=_("checkingForQuickFixes","Checking for quick fixes..."),200));s.textContent||(s.textContent=String.fromCharCode(160));const o=this.getCodeActions(t.marker);i.add(ut(()=>o.cancel())),o.then(a=>{if(r.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),s.textContent=_("noQuickFixes","No quick fixes available");return}s.style.display="none";let l=!1;i.add(ut(()=>{l||a.dispose()})),e.statusBar.addAction({label:_("quick fixes","Quick Fix..."),commandId:Nae,run:c=>{l=!0;const u=fC.get(this._editor),h=hs(c);e.hide(),u==null||u.showCodeActions(QG,a,{x:h.left,y:h.top,width:h.width,height:h.height})}})},Ft)}}getCodeActions(e){return ch(t=>dw(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new H(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),QG,l_.None,t))}};NO=kKe([QR(1,O8),QR(2,hh),QR(3,wt)],NO);const DKe="editor.action.inlineSuggest.showPrevious",EKe="editor.action.inlineSuggest.showNext";var TKe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):s(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class AKe extends ae{constructor(e,t,i={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new mAe),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new Ae),this.options=i,this.lookupKeybindings=typeof this.options.getKeyBinding=="function",this.toggleMenuAction=this._register(new gC(()=>{var s;return(s=this.toggleMenuActionViewItem)===null||s===void 0?void 0:s.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Fc(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,actionViewItemProvider:(s,r)=>{var o;if(s.id===gC.ID)return this.toggleMenuActionViewItem=new yD(s,s.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Ye.asClassNameArray((o=i.moreIcon)!==null&&o!==void 0?o:we.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const a=i.actionViewItemProvider(s,r);if(a)return a}if(s instanceof fT){const a=new yD(s,s.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:s.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry});return a.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(a),this.disposables.add(this._onDidChangeDropdownVisibility.add(a.onDidChangeVisibility)),a}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(s=>{this.actionBar.push(s,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(s)})})}getKeybindingLabel(e){var t,i,s;const r=this.lookupKeybindings?(i=(t=this.options).getKeyBinding)===null||i===void 0?void 0:i.call(t,e):void 0;return(s=r==null?void 0:r.getLabel())!==null&&s!==void 0?s:void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class gC extends _o{constructor(e,t){t=t||_("moreActions","More Actions..."),super(gC.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}run(){return TKe(this,void 0,void 0,function*(){this.toggleDropdownMenu()})}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}}gC.ID="toolbar.toggle.more";var IKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},j1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let RO=class extends AKe{constructor(e,t,i,s,r,o,a){super(e,r,Object.assign(Object.assign({getKeyBinding:c=>{var u;return(u=o.lookupKeybinding(c.id))!==null&&u!==void 0?u:void 0}},t),{allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"})),this._options=t,this._menuService=i,this._contextKeyService=s,this._contextMenuService=r,this._sessionDisposables=this._store.add(new Ae);const l=t==null?void 0:t.telemetrySource;l&&this._store.add(this.actionBar.onDidRun(c=>a.publicLog2("workbenchActionExecuted",{id:c.action.id,from:l})))}setActions(e,t=[],i){var s,r,o;this._sessionDisposables.clear();const a=e.slice(),l=t.slice(),c=[];let u=0;const h=[];let d=!1;if(((s=this._options)===null||s===void 0?void 0:s.hiddenItemStrategy)!==-1)for(let f=0;f<a.length;f++){const g=a[f];!(g instanceof Ac)&&!(g instanceof OL)||g.hideActions&&(c.push(g.hideActions.toggle),g.hideActions.toggle.checked&&u++,g.hideActions.isHidden&&(d=!0,a[f]=void 0,((r=this._options)===null||r===void 0?void 0:r.hiddenItemStrategy)!==0&&(h[f]=g)))}if(((o=this._options)===null||o===void 0?void 0:o.overflowBehavior)!==void 0){const f=jBe(new Set(this._options.overflowBehavior.exempted),Et.map(a,m=>m==null?void 0:m.id)),g=this._options.overflowBehavior.maxItems-f.size;let p=0;for(let m=0;m<a.length;m++){const b=a[m];b&&(p++,!f.has(b.id)&&p>=g&&(a[m]=void 0,h[m]=b))}}Rz(a),Rz(h),super.setActions(a,gs.join(h,l)),c.length>0&&this._sessionDisposables.add(oe(this.getElement(),"contextmenu",f=>{var g,p,m,b,v;const w=new ba(f),y=this.getItemAction(w.target);if(!y)return;w.preventDefault(),w.stopPropagation();let x=!1;if(u===1&&((g=this._options)===null||g===void 0?void 0:g.hiddenItemStrategy)===0){x=!0;for(let T=0;T<c.length;T++)if(c[T].checked){c[T]=Hv({id:y.id,label:y.label,checked:!0,enabled:!1,run(){}});break}}let D;if(!x&&(y instanceof Ac||y instanceof OL)){if(!y.hideActions)return;D=y.hideActions.hide}else D=Hv({id:"label",label:_("hide","Hide"),enabled:!1,run(){}});const S=gs.join([D],c);!((p=this._options)===null||p===void 0)&&p.resetMenu&&!i&&(i=[this._options.resetMenu]),d&&i&&(S.push(new gs),S.push(Hv({id:"resetThisMenu",label:_("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),this._contextMenuService.showContextMenu({getAnchor:()=>w,getActions:()=>S,menuId:(m=this._options)===null||m===void 0?void 0:m.contextMenu,menuActionOptions:Object.assign({renderShortTitle:!0},(b=this._options)===null||b===void 0?void 0:b.menuOptions),skipTelemetry:typeof((v=this._options)===null||v===void 0?void 0:v.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};RO=IKe([j1(2,Sf),j1(3,_t),j1(4,Tf),j1(5,Oi),j1(6,ah)],RO);var y9=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},ul=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Ck;let JG=class extends ae{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=gr(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).showToolbar==="always"),this.sessionPosition=void 0,this.position=Ot(this,s=>{var r,o,a;const l=(r=this.model.read(s))===null||r===void 0?void 0:r.ghostText.read(s);if(!this.alwaysShowToolbar.read(s)||!l||l.parts.length===0)return this.sessionPosition=void 0,null;const c=l.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==l.lineNumber&&(this.sessionPosition=void 0);const u=new X(l.lineNumber,Math.min(c,(a=(o=this.sessionPosition)===null||o===void 0?void 0:o.column)!==null&&a!==void 0?a:Number.MAX_SAFE_INTEGER));return this.sessionPosition=u,u}),this._register(Tr((s,r)=>{const o=this.model.read(s);if(!o||!this.alwaysShowToolbar.read(s))return;const a=r.add(this.instantiationService.createInstance(xb,this.editor,!0,this.position,o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.selectedInlineCompletion.map(l=>{var c;return(c=l==null?void 0:l.inlineCompletion.source.inlineCompletions.commands)!==null&&c!==void 0?c:[]})));e.addContentWidget(a),r.add(ut(()=>e.removeContentWidget(a))),r.add(Ii(l=>{this.position.read(l)&&o.lastTriggerKind.read(l)!==G4.Explicit&&o.triggerExplicitly()}))}))}};JG=y9([ul(2,Wt)],JG);const NKe=Cn("inline-suggestion-hints-next",we.chevronRight,_("parameterHintsNextIcon","Icon for show next parameter hint.")),RKe=Cn("inline-suggestion-hints-previous",we.chevronLeft,_("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let xb=Ck=class extends ae{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const s=new _o(e,t,i,!0,()=>this._commandService.executeCommand(e)),r=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let o=t;return r&&(o=_({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,r.getLabel())),s.tooltip=o,s}constructor(e,t,i,s,r,o,a,l,c,u,h){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=s,this._suggestionCount=r,this._extraCommands=o,this._commandService=a,this.keybindingService=c,this._contextKeyService=u,this._menuService=h,this.id=`InlineSuggestionHintsContentWidget${Ck.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Bn("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[Bn("div@toolBar")]),this.previousAction=this.createCommandAction(DKe,_("previous","Previous"),Ye.asClassName(RKe)),this.availableSuggestionCountAction=new _o("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(EKe,_("next","Next"),Ye.asClassName(NKe)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(B.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new Ui(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new Ui(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.lastCommands=[],this.toolBar=this._register(l.createInstance(MO,this.nodes.toolBar,B.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:d=>d.startsWith("primary")},actionViewItemProvider:(d,f)=>{if(d instanceof Ac)return l.createInstance(FKe,d,void 0);if(d===this.availableSuggestionCountAction){const g=new MKe(void 0,d,{label:!0,icon:!1});return g.setClass("availableSuggestionCount"),g}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(d=>{Ck._dropDownVisible=d})),this._register(Ii(d=>{this._position.read(d),this.editor.layoutContentWidget(this)})),this._register(Ii(d=>{const f=this._suggestionCount.read(d),g=this._currentSuggestionIdx.read(d);f!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${g+1}/${f}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),f!==void 0&&f>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(Ii(d=>{const f=this._extraCommands.read(d);if(yn(this.lastCommands,f))return;this.lastCommands=f;const g=f.map(p=>({class:void 0,id:p.id,enabled:!0,tooltip:p.tooltip||"",label:p.title,run:m=>this._commandService.executeCommand(p.id)}));for(const[p,m]of this.inlineCompletionsActionsMenus.getActions())for(const b of m)b instanceof Ac&&g.push(b);g.length>0&&g.unshift(new gs),this.toolBar.setAdditionalSecondaryActions(g)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};xb._dropDownVisible=!1;xb.id=0;xb=Ck=y9([ul(6,Ys),ul(7,Wt),ul(8,Oi),ul(9,_t),ul(10,Sf)],xb);class MKe extends JT{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}}class FKe extends mb{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Bn("div.keybinding").root;new AS(t,co,Object.assign({disableTitle:!0},cVe)).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}}let MO=class extends RO{constructor(e,t,i,s,r,o,a,l){super(e,Object.assign({resetMenu:t},i),s,r,o,a,l),this.menuId=t,this.options2=i,this.menuService=s,this.contextKeyService=r,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var e,t,i,s,r,o,a;const l=[],c=[];$re(this.menu,(e=this.options2)===null||e===void 0?void 0:e.menuOptions,{primary:l,secondary:c},(i=(t=this.options2)===null||t===void 0?void 0:t.toolbarOptions)===null||i===void 0?void 0:i.primaryGroup,(r=(s=this.options2)===null||s===void 0?void 0:s.toolbarOptions)===null||r===void 0?void 0:r.shouldInlineSubmenu,(a=(o=this.options2)===null||o===void 0?void 0:o.toolbarOptions)===null||a===void 0?void 0:a.useSeparatorsInPrimaryActions),c.push(...this.additionalActions),l.unshift(...this.prependedPrimaryActions),this.setActions(l,c)}setPrependedPrimaryActions(e){yn(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){yn(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};MO=y9([ul(3,Sf),ul(4,_t),ul(5,Tf),ul(6,Oi),ul(7,ah)],MO);var PKe=globalThis&&globalThis.__decorate||function(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r},k2=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},FO;const OKe=!1;let $r=FO=class extends ae{static get(e){return e.getContribution(FO.ID)}constructor(e,t,i,s,r){super(),this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=s,this._keybindingService=r,this._toUnhook=new Ae,this._hoverActivatedByColorDecoratorClick=!1,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._reactToEditorMouseMoveRunner=this._register(new Ui(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookEvents(),this._register(this._editor.onDidChangeConfiguration(o=>{o.hasChanged(60)&&(this._unhookEvents(),this._hookEvents())})),this._register(this._editor.onMouseLeave(()=>{this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}))}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(60);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._hidingDelay=t.hidingDelay,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown(i=>this._onEditorMouseDown(i))),this._toUnhook.add(this._editor.onMouseUp(i=>this._onEditorMouseUp(i))),this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))):(this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))),this._toUnhook.add(this._editor.onMouseLeave(i=>this._onEditorMouseLeave(i))),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange(i=>this._onEditorScrollChanged(i)))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){var t;this._isMouseDown=!0;const i=e.target;if(i.type===9&&i.detail===Bd.ID){this._hoverClicked=!0;return}i.type===12&&i.detail===p_.ID||(i.type!==12&&(this._hoverClicked=!1),!((t=this._contentWidget)===null||t===void 0)&&t.widget.isResizing||this._hideWidgets())}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseLeave(e){var t,i;const s=e.event.browserEvent.relatedTarget;!((t=this._contentWidget)===null||t===void 0)&&t.widget.isResizing||!((i=this._contentWidget)===null||i===void 0)&&i.containsNode(s)||this._hideWidgets()}_isMouseOverWidget(e){var t,i,s,r,o;const a=e.target;return!!(this._isHoverSticky&&a.type===9&&a.detail===Bd.ID||this._isHoverSticky&&(!((t=this._contentWidget)===null||t===void 0)&&t.containsNode((i=e.event.browserEvent.view)===null||i===void 0?void 0:i.document.activeElement))&&!(!((r=(s=e.event.browserEvent.view)===null||s===void 0?void 0:s.getSelection())===null||r===void 0)&&r.isCollapsed)||!this._isHoverSticky&&a.type===9&&a.detail===Bd.ID&&(!((o=this._contentWidget)===null||o===void 0)&&o.isColorPickerVisible)||this._isHoverSticky&&a.type===12&&a.detail===p_.ID)}_onEditorMouseMove(e){var t,i,s,r;if(this._mouseMoveEvent=e,!((t=this._contentWidget)===null||t===void 0)&&t.isFocused||!((i=this._contentWidget)===null||i===void 0)&&i.isResizing||this._isMouseDown&&this._hoverClicked||this._isHoverSticky&&(!((s=this._contentWidget)===null||s===void 0)&&s.isVisibleFromKeyboard))return;if(this._isMouseOverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}if(!((r=this._contentWidget)===null||r===void 0)&&r.isVisible&&this._isHoverSticky&&this._hidingDelay>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(this._hidingDelay);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){var t,i,s;if(!e)return;const r=e.target,o=(t=r.element)===null||t===void 0?void 0:t.classList.contains("colorpicker-color-decoration"),a=this._editor.getOption(146);if(o&&(a==="click"&&!this._hoverActivatedByColorDecoratorClick||a==="hover"&&!this._isHoverEnabled&&!OKe||a==="clickAndHover"&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)||!o&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick){this._hideWidgets();return}if(this._getOrCreateContentWidget().maybeShowAt(e)){(i=this._glyphWidget)===null||i===void 0||i.hide();return}if(r.type===2&&r.position){(s=this._contentWidget)===null||s===void 0||s.hide(),this._glyphWidget||(this._glyphWidget=new p_(this._editor,this._languageService,this._openerService)),this._glyphWidget.startShowingAt(r.position.lineNumber);return}this._hideWidgets()}_onKeyDown(e){var t;if(!this._editor.hasModel())return;const i=this._keybindingService.softDispatch(e,this._editor.getDomNode()),s=i.kind===1||i.kind===2&&i.commandId==="editor.action.showHover"&&((t=this._contentWidget)===null||t===void 0?void 0:t.isVisible);e.keyCode!==5&&e.keyCode!==6&&e.keyCode!==57&&e.keyCode!==4&&!s&&this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(!((e=this._contentWidget)===null||e===void 0)&&e.isColorPickerVisible)||xb.dropDownVisible||(this._hoverActivatedByColorDecoratorClick=!1,this._hoverClicked=!1,(t=this._glyphWidget)===null||t===void 0||t.hide(),(i=this._contentWidget)===null||i===void 0||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(GD,this._editor)),this._contentWidget}showContentHover(e,t,i,s,r=!1){this._hoverActivatedByColorDecoratorClick=r,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,s)}focus(){var e;(e=this._contentWidget)===null||e===void 0||e.focus()}scrollUp(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollUp()}scrollDown(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollDown()}scrollLeft(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollLeft()}scrollRight(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollRight()}pageUp(){var e;(e=this._contentWidget)===null||e===void 0||e.pageUp()}pageDown(){var e;(e=this._contentWidget)===null||e===void 0||e.pageDown()}goToTop(){var e;(e=this._contentWidget)===null||e===void 0||e.goToTop()}goToBottom(){var e;(e=this._contentWidget)===null||e===void 0||e.goToBottom()}get isColorPickerVisible(){var e;return(e=this._contentWidget)===null||e===void 0?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return(e=this._contentWidget)===null||e===void 0?void 0:e.isVisible}dispose(){var e,t;super.dispose(),this._unhookEvents(),this._toUnhook.dispose(),(e=this._glyphWidget)===null||e===void 0||e.dispose(),(t=this._contentWidget)===null||t===void 0||t.dispose()}};$r.ID="editor.contrib.hover";$r=FO=PKe([k2(1,Wt),k2(2,hh),k2(3,Ji),k2(4,Oi)],$r);class BKe extends wi{constructor(){super({id:"editor.action.showHover",label:_({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse.","If the hover is already visible, it will take focus."]},"Show or Focus Hover"),description:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if when triggered with the keyboard, the hover should take focus immediately.",type:"boolean",default:!1}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:ee.editorTextFocus,primary:ms(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const s=$r.get(t);if(!s)return;const r=t.getPosition(),o=new H(r.lineNumber,r.column,r.lineNumber,r.column),a=t.getOption(2)===2||!!(i!=null&&i.focus);s.isHoverVisible?s.focus():s.showContentHover(o,1,1,a)}}class WKe extends wi{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:_({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=$r.get(t);if(!i)return;const s=t.getPosition();if(!s)return;const r=new H(s.lineNumber,s.column,s.lineNumber,s.column),o=Pp.get(t);if(!o)return;o.startFindDefinitionFromCursor(s).then(()=>{i.showContentHover(r,1,1,!0)})}}class VKe extends wi{constructor(){super({id:"editor.action.scrollUpHover",label:_({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:16,weight:100}})}run(e,t){const i=$r.get(t);i&&i.scrollUp()}}class $Ke extends wi{constructor(){super({id:"editor.action.scrollDownHover",label:_({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:18,weight:100}})}run(e,t){const i=$r.get(t);i&&i.scrollDown()}}class zKe extends wi{constructor(){super({id:"editor.action.scrollLeftHover",label:_({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:15,weight:100}})}run(e,t){const i=$r.get(t);i&&i.scrollLeft()}}class HKe extends wi{constructor(){super({id:"editor.action.scrollRightHover",label:_({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:17,weight:100}})}run(e,t){const i=$r.get(t);i&&i.scrollRight()}}class UKe extends wi{constructor(){super({id:"editor.action.pageUpHover",label:_({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:11,secondary:[528],weight:100}})}run(e,t){const i=$r.get(t);i&&i.pageUp()}}class jKe extends wi{constructor(){super({id:"editor.action.pageDownHover",label:_({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:12,secondary:[530],weight:100}})}run(e,t){const i=$r.get(t);i&&i.pageDown()}}class qKe extends wi{constructor(){super({id:"editor.action.goToTopHover",label:_({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(e,t){const i=$r.get(t);i&&i.goToTop()}}class GKe extends wi{constructor(){super({id:"editor.action.goToBottomHover",label:_({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:ee.hoverFocused,kbOpts:{kbExpr:ee.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(e,t){const i=$r.get(t);i&&i.goToBottom()}}Va($r.ID,$r,2);dt(BKe);dt(WKe);dt(VKe);dt($Ke);dt(zKe);dt(HKe);dt(UKe);dt(jKe);dt(qKe);dt(GKe);v9.register(wO);v9.register(NO);$a((n,e)=>{const t=n.getColor(k3e);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});function KKe(){return new Worker(""+new URL("json.worker-9474b90b.js",import.meta.url).href)}self.MonacoEnvironment={getWorker(n,e){if(e==="json")return new KKe;throw new Error("Unsupported language: "+e)}};class ZKe extends R0{constructor(){super();Rn(this,"_editor");Rn(this,"_initialValue")}set value(t){this._editor?this._editor.setValue(t):this._initialValue=t}get value(){var t;return((t=this._editor)==null?void 0:t.getValue())??this._initialValue}createRenderRoot(){return this}disconnectedCallback(){var t,i,s;(t=this._editor)==null||t.dispose(),(s=(i=this._editor)==null?void 0:i.getModel())==null||s.dispose()}render(){return Yn}firstUpdated(){this._editor=joe.create(this,{value:this._initialValue,language:"json",minimap:{enabled:!1},fontFamily:"'Source Code Pro', monospace",fontSize:12}),this._editor.getModel().onDidChangeContent(()=>{this.dispatchEvent(new CustomEvent("change",{detail:{}}))}),new ResizeObserver(i=>{this._editor.layout()}).observe(this)}}customElements.define("code-editor",ZKe);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*YKe(n,e){if(n!==void 0){let t=0;for(const i of n)yield e(i,t++)}}var ku;class jae extends R0{constructor(){super();Kt(this,ku,void 0);Rn(this,"files");this.missingFiles=new Set}createRenderRoot(){return this}render(){return Dr`
            <ul class="tabs">
                ${Object.keys(this.files).map(t=>Dr`
                            <li
                                data-name=${t}
                                class=${t==nt(this,ku)?"selected":""}
                            >
                                <a
                                    href="#"
                                    @click=${i=>this._changeTab(i)}
                                    >${t}</a
                                >
                            </li>
                        `)}
                <li class=${nt(this,ku)===void 0?"selected":""}>
                    <a
                        href="#"
                        @click=${t=>this._changeTab(t)}
                        >Add new files</a
                    >
                </li>
                <li style="flex-grow: 1"></li>
            </ul>

            <div class="tab-pages">
                ${Object.keys(this.files).map(t=>Dr`
                        <div
                            class=${t==nt(this,ku)?"selected":""}
                        >
                            ${QKe(this.files[t].data)}
                        </div>
                    `)}

                <div class=${nt(this,ku)===void 0?"selected":""}>
                    ${this.missingFiles.size?Dr`<div class="missing-files">
                              <p>Please add the following files:</p>
                              <ul>
                                  ${YKe(this.missingFiles,t=>Dr`<li>${t}</li>`)}
                              </ul>
                          </div>`:Yn}
                    ${XKe(t=>this._handleFiles(t))}
                </div>
            </div>
        `}async _handleFiles(t){const s=t.target.files;for(const r of s){const o=await JKe(r),a=m5(o,{type:eZe(o,r.name),parse:"auto"});this.files[r.name]={metadata:r,data:a},Qo(this,ku,r.name)}this.requestUpdate(),this.dispatchEvent(new CustomEvent("upload",{detail:{}}))}_changeTab(t){const s=t.target.parentElement.dataset.name;Qo(this,ku,s),t.preventDefault(),this.requestUpdate()}}ku=new WeakMap,Rn(jae,"properties",{missingFiles:{type:Set,attribute:!1}});customElements.define("file-pane",jae);function XKe(n){return Dr` <form class="upload-form">
        <input
            type="file"
            multiple
            accept=".csv,.tsv,.txt,.json"
            id="fileInput"
            @change=${n}
            style="display:none"
        />
        <div id="upload-button-wrapper">
            <button
                class="btn"
                @click=${e=>{document.getElementById("fileInput").click(),e.preventDefault(),e.stopPropagation()}}
            >
                Choose files
            </button>
        </div>

        <p>
            The added file becomes a named datasource, which can be accessed as
            follows:
        </p>

        <pre>
"data": {
    "name": "filename.csv"
}
</pre
        >

        <p>
            N.B. All data processing takes place in your web browser. Nothing is
            uploaded anywhere.
        </p>
    </form>`}function QKe(n){const e=Object.keys(n[0]),t=n.slice(0,30),i=e.map(a=>"text-align: "+(typeof n[0][a]=="number"?"right":"left")),s=a=>Dr`
        <tr>
            ${e.map((l,c)=>Dr`<td style=${i[c]}>${a[l]}</td> `)}
        </tr>
    `,r=()=>Dr`
        <tr>
            ${e.map((a,l)=>Dr`<td style=${i[l]}>...</td> `)}
        </tr>
    `;return Dr`
        <table class="data-sample-table">
            <thead>
                ${(()=>Dr`
        <tr>
            ${e.map((a,l)=>Dr`<th style=${i[l]}>${a}</th> `)}
        </tr>
    `)()}
            </thead>
            <tbody>
                ${t.map(s)}
                ${t.length<n.length?r():""}
            </tbody>
        </table>
    `}function JKe(n){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>e(i.result),i.onerror=t,i.readAsText(n)})}function eZe(n,e){return/\.json$/.test(e)?"json":n.indexOf("	")>=0?"tsv":"csv"}function qae(n){if(typeof n=="object"&&n!==null){n.description&&(n.markdownDescription=n.description);for(const e in n)n.hasOwnProperty(e)&&(n[e]=qae(n[e]))}return n}nZe();const Gae="playgroundSpec",Kae=CK(),C9=CK(),Zae={};let S9=new Set,JR,eK="";const Sk=["stacked","parallel","full"];let PO=Sk[0],xk,Yae="";async function tZe(){const e=new URLSearchParams(window.location.search).get("spec");if(e){const s=await fetch(e);return xk=e.match(/.*\//)[0],s.text()}const t=window.localStorage.getItem(Gae),i=(t==null?void 0:t.length)>0?t:zEe;return console.log("Jeejee",i),i}function iZe(){PO=Sk[(Sk.indexOf(PO)+1)%Sk.length],x9(),window.dispatchEvent(new Event("resize"))}function nZe(){qae(fG),qoe.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"https://unpkg.com/@genome-spy/core/dist/schema.json",fileMatch:["*"],schema:fG}]})}function sZe(n){let e=Zae[n];return e||S9.add(n),e==null?void 0:e.data}async function Xae(n=!1){var t,i;S9=new Set,xk&&window.location.search&&window.history.replaceState(null,"",window.location.pathname);const e=(t=C9.value)==null?void 0:t.value;e&&window.localStorage.setItem(Gae,e);try{const s=JSON.parse(e),r=JSON.stringify(s);if(r===eK&&!n)return;eK=r,JR&&JR.finalize(),xk&&!s.baseUrl&&(s.baseUrl=xk),Yae=(i=po(s.description))==null?void 0:i[0],JR=await WEe(Kae.value,s,{namedDataProvider:sZe}),x9()}catch(s){console.log(s)}}const rZe=()=>Dr`
    <div class="toolbar">
        <a
            href="https://genomespy.app/"
            target="_blank"
            class="genome-spy-icon"
        >
            <img title="GenomeSpy" alt="GenomeSpy" src="${BEe}" />
        </a>
        <span class="title">
            <span>GenomeSpy Playground</span>
        </span>
        <button @click=${iZe} class="tool-button hide-mobile">
            ${mB(yue).node[0]}
            <span>Toggle layout</span>
        </button>
        <span class="vis-title">
            <span class="hide-mobile">${Yae}</span>
        </span>
        <a
            class="version tool-button"
            href="https://github.com/genome-spy/genome-spy/releases/tag/v${gG.version}"
            >v${gG.version}</a
        >
        <a
            href="https://genomespy.app/docs/"
            target="_blank"
            class="tool-button hide-mobile"
            >${mB(vue).node[0]} <span>Docs</span></a
        >
    </div>
`,oZe=oS(()=>Xae(),500,!1),aZe=()=>Dr`
    <section id="playground-layout" class="${PO}">
        ${rZe()}
        <section id="editor-pane">
            <code-editor
                ${j9(C9)}
                @change=${oZe}
            ></code-editor>
        </section>
        <section id="genome-spy-pane">
            <div ${j9(Kae)}></div>
        </section>
        <section id="file-pane">
            <file-pane
                @upload=${Xae}
                .files=${Zae}
                .missingFiles=${S9}
            ></file-pane>
        </section>
    </section>
`;function x9(){wK(aZe(),document.body)}x9();tZe().then(n=>{C9.value.value=n});export{bUe as m};
