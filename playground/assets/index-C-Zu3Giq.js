var gZ=Object.defineProperty;var pZ=(n,e,t)=>e in n?gZ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ui=(n,e,t)=>(pZ(n,typeof e!="symbol"?e+"":e,t),t),Pk=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var J=(n,e,t)=>(Pk(n,e,"read from private field"),t?t.call(n):e.get(n)),ve=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},gt=(n,e,t,i)=>(Pk(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var y5=(n,e,t,i)=>({set _(s){gt(n,e,s,t)},get _(){return J(n,e,i)}}),De=(n,e,t)=>(Pk(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uC=globalThis,bM=uC.ShadowRoot&&(uC.ShadyCSS===void 0||uC.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,_W=Symbol(),w5=new WeakMap;let mZ=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==_W)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(bM&&e===void 0){const i=t!==void 0&&t.length===1;i&&(e=w5.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&w5.set(t,e))}return e}toString(){return this.cssText}};const _Z=n=>new mZ(typeof n=="string"?n:n+"",void 0,_W),bZ=(n,e)=>{if(bM)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const i=document.createElement("style"),s=uC.litNonce;s!==void 0&&i.setAttribute("nonce",s),i.textContent=t.cssText,n.appendChild(i)}},C5=bM?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return _Z(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:vZ,defineProperty:yZ,getOwnPropertyDescriptor:wZ,getOwnPropertyNames:CZ,getOwnPropertySymbols:SZ,getPrototypeOf:xZ}=Object,vd=globalThis,S5=vd.trustedTypes,LZ=S5?S5.emptyScript:"",Ok=vd.reactiveElementPolyfillSupport,b_=(n,e)=>n,XE={toAttribute(n,e){switch(e){case Boolean:n=n?LZ:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},bW=(n,e)=>!vZ(n,e),x5={attribute:!0,type:String,converter:XE,reflect:!1,hasChanged:bW};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),vd.litPropertyMetadata??(vd.litPropertyMetadata=new WeakMap);class Sg extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=x5){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const i=Symbol(),s=this.getPropertyDescriptor(e,i,t);s!==void 0&&yZ(this.prototype,e,s)}}static getPropertyDescriptor(e,t,i){const{get:s,set:o}=wZ(this.prototype,e)??{get(){return this[t]},set(r){this[t]=r}};return{get(){return s==null?void 0:s.call(this)},set(r){const a=s==null?void 0:s.call(this);o.call(this,r),this.requestUpdate(e,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??x5}static _$Ei(){if(this.hasOwnProperty(b_("elementProperties")))return;const e=xZ(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(b_("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(b_("properties"))){const t=this.properties,i=[...CZ(t),...SZ(t)];for(const s of i)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[i,s]of t)this.elementProperties.set(i,s)}this._$Eh=new Map;for(const[t,i]of this.elementProperties){const s=this._$Eu(t,i);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const s of i)t.unshift(C5(s))}else e!==void 0&&t.push(C5(e));return t}static _$Eu(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const i of t.keys())this.hasOwnProperty(i)&&(e.set(i,this[i]),delete this[i]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return bZ(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostConnected)==null?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var i;return(i=t.hostDisconnected)==null?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EC(e,t){var o;const i=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,i);if(s!==void 0&&i.reflect===!0){const r=(((o=i.converter)==null?void 0:o.toAttribute)!==void 0?i.converter:XE).toAttribute(t,i.type);this._$Em=e,r==null?this.removeAttribute(s):this.setAttribute(s,r),this._$Em=null}}_$AK(e,t){var o;const i=this.constructor,s=i._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const r=i.getPropertyOptions(s),a=typeof r.converter=="function"?{fromAttribute:r.converter}:((o=r.converter)==null?void 0:o.fromAttribute)!==void 0?r.converter:XE;this._$Em=s,this[s]=a.fromAttribute(t,r.type),this._$Em=null}}requestUpdate(e,t,i){if(e!==void 0){if(i??(i=this.constructor.getPropertyOptions(e)),!(i.hasChanged??bW)(this[e],t))return;this.P(e,t,i)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,t,i){this._$AL.has(e)||this._$AL.set(e,t),i.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var i;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[o,r]of this._$Ep)this[o]=r;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[o,r]of s)r.wrapped!==!0||this._$AL.has(o)||this[o]===void 0||this.P(o,this[o],r)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(i=this._$EO)==null||i.forEach(s=>{var o;return(o=s.hostUpdate)==null?void 0:o.call(s)}),this.update(t)):this._$EU()}catch(s){throw e=!1,this._$EU(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(i=>{var s;return(s=i.hostUpdated)==null?void 0:s.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EC(t,this[t]))),this._$EU()}updated(e){}firstUpdated(e){}}Sg.elementStyles=[],Sg.shadowRootOptions={mode:"open"},Sg[b_("elementProperties")]=new Map,Sg[b_("finalized")]=new Map,Ok==null||Ok({ReactiveElement:Sg}),(vd.reactiveElementVersions??(vd.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const v_=globalThis,tS=v_.trustedTypes,L5=tS?tS.createPolicy("lit-html",{createHTML:n=>n}):void 0,vW="$lit$",qc=`lit$${(Math.random()+"").slice(9)}$`,yW="?"+qc,DZ=`<${yW}>`,tf=document,Q_=()=>tf.createComment(""),J_=n=>n===null||typeof n!="object"&&typeof n!="function",wW=Array.isArray,kZ=n=>wW(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",Fk=`[ 	
\f\r]`,h0=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,D5=/-->/g,k5=/>/g,Bu=RegExp(`>|${Fk}(?:([^\\s"'>=/]+)(${Fk}*=${Fk}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),E5=/'/g,A5=/"/g,CW=/^(?:script|style|textarea|title)$/i,EZ=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),At=EZ(1),nf=Symbol.for("lit-noChange"),Vi=Symbol.for("lit-nothing"),I5=new WeakMap,gh=tf.createTreeWalker(tf,129);function SW(n,e){if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return L5!==void 0?L5.createHTML(e):e}const AZ=(n,e)=>{const t=n.length-1,i=[];let s,o=e===2?"<svg>":"",r=h0;for(let a=0;a<t;a++){const l=n[a];let c,d,u=-1,h=0;for(;h<l.length&&(r.lastIndex=h,d=r.exec(l),d!==null);)h=r.lastIndex,r===h0?d[1]==="!--"?r=D5:d[1]!==void 0?r=k5:d[2]!==void 0?(CW.test(d[2])&&(s=RegExp("</"+d[2],"g")),r=Bu):d[3]!==void 0&&(r=Bu):r===Bu?d[0]===">"?(r=s??h0,u=-1):d[1]===void 0?u=-2:(u=r.lastIndex-d[2].length,c=d[1],r=d[3]===void 0?Bu:d[3]==='"'?A5:E5):r===A5||r===E5?r=Bu:r===D5||r===k5?r=h0:(r=Bu,s=void 0);const f=r===Bu&&n[a+1].startsWith("/>")?" ":"";o+=r===h0?l+DZ:u>=0?(i.push(c),l.slice(0,u)+vW+l.slice(u)+qc+f):l+qc+(u===-2?a:f)}return[SW(n,o+(n[t]||"<?>")+(e===2?"</svg>":"")),i]};class eb{constructor({strings:e,_$litType$:t},i){let s;this.parts=[];let o=0,r=0;const a=e.length-1,l=this.parts,[c,d]=AZ(e,t);if(this.el=eb.createElement(c,i),gh.currentNode=this.el.content,t===2){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(s=gh.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const u of s.getAttributeNames())if(u.endsWith(vW)){const h=d[r++],f=s.getAttribute(u).split(qc),g=/([.?@])?(.*)/.exec(h);l.push({type:1,index:o,name:g[2],strings:f,ctor:g[1]==="."?TZ:g[1]==="?"?NZ:g[1]==="@"?RZ:bL}),s.removeAttribute(u)}else u.startsWith(qc)&&(l.push({type:6,index:o}),s.removeAttribute(u));if(CW.test(s.tagName)){const u=s.textContent.split(qc),h=u.length-1;if(h>0){s.textContent=tS?tS.emptyScript:"";for(let f=0;f<h;f++)s.append(u[f],Q_()),gh.nextNode(),l.push({type:2,index:++o});s.append(u[h],Q_())}}}else if(s.nodeType===8)if(s.data===yW)l.push({type:2,index:o});else{let u=-1;for(;(u=s.data.indexOf(qc,u+1))!==-1;)l.push({type:7,index:o}),u+=qc.length-1}o++}}static createElement(e,t){const i=tf.createElement("template");return i.innerHTML=e,i}}function Xp(n,e,t=n,i){var r,a;if(e===nf)return e;let s=i!==void 0?(r=t._$Co)==null?void 0:r[i]:t._$Cl;const o=J_(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==o&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),o===void 0?s=void 0:(s=new o(n),s._$AT(n,t,i)),i!==void 0?(t._$Co??(t._$Co=[]))[i]=s:t._$Cl=s),s!==void 0&&(e=Xp(n,s._$AS(n,e.values),s,i)),e}class IZ{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:i}=this._$AD,s=((e==null?void 0:e.creationScope)??tf).importNode(t,!0);gh.currentNode=s;let o=gh.nextNode(),r=0,a=0,l=i[0];for(;l!==void 0;){if(r===l.index){let c;l.type===2?c=new w1(o,o.nextSibling,this,e):l.type===1?c=new l.ctor(o,l.name,l.strings,this,e):l.type===6&&(c=new MZ(o,this,e)),this._$AV.push(c),l=i[++a]}r!==(l==null?void 0:l.index)&&(o=gh.nextNode(),r++)}return gh.currentNode=tf,s}p(e){let t=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class w1{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,i,s){this.type=2,this._$AH=Vi,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Xp(this,e,t),J_(e)?e===Vi||e==null||e===""?(this._$AH!==Vi&&this._$AR(),this._$AH=Vi):e!==this._$AH&&e!==nf&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):kZ(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==Vi&&J_(this._$AH)?this._$AA.nextSibling.data=e:this.T(tf.createTextNode(e)),this._$AH=e}$(e){var o;const{values:t,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=eb.createElement(SW(i.h,i.h[0]),this.options)),i);if(((o=this._$AH)==null?void 0:o._$AD)===s)this._$AH.p(t);else{const r=new IZ(s,this),a=r.u(this.options);r.p(t),this.T(a),this._$AH=r}}_$AC(e){let t=I5.get(e.strings);return t===void 0&&I5.set(e.strings,t=new eb(e)),t}k(e){wW(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,s=0;for(const o of e)s===t.length?t.push(i=new w1(this.S(Q_()),this.S(Q_()),this,this.options)):i=t[s],i._$AI(o),s++;s<t.length&&(this._$AR(i&&i._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)==null?void 0:i.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class bL{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,i,s,o){this.type=1,this._$AH=Vi,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=o,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=Vi}_$AI(e,t=this,i,s){const o=this.strings;let r=!1;if(o===void 0)e=Xp(this,e,t,0),r=!J_(e)||e!==this._$AH&&e!==nf,r&&(this._$AH=e);else{const a=e;let l,c;for(e=o[0],l=0;l<o.length-1;l++)c=Xp(this,a[i+l],t,l),c===nf&&(c=this._$AH[l]),r||(r=!J_(c)||c!==this._$AH[l]),c===Vi?e=Vi:e!==Vi&&(e+=(c??"")+o[l+1]),this._$AH[l]=c}r&&!s&&this.j(e)}j(e){e===Vi?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class TZ extends bL{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Vi?void 0:e}}class NZ extends bL{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Vi)}}class RZ extends bL{constructor(e,t,i,s,o){super(e,t,i,s,o),this.type=5}_$AI(e,t=this){if((e=Xp(this,e,t,0)??Vi)===nf)return;const i=this._$AH,s=e===Vi&&i!==Vi||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==Vi&&(i===Vi||s);s&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class MZ{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Xp(this,e)}}const Bk=v_.litHtmlPolyfillSupport;Bk==null||Bk(eb,w1),(v_.litHtmlVersions??(v_.litHtmlVersions=[])).push("3.1.2");const Qp=(n,e,t)=>{const i=(t==null?void 0:t.renderBefore)??e;let s=i._$litPart$;if(s===void 0){const o=(t==null?void 0:t.renderBefore)??null;i._$litPart$=s=new w1(e.insertBefore(Q_(),o),o,void 0,t??{})}return s._$AI(n),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let np=class extends Sg{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Qp(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return nf}};var pW;np._$litElement$=!0,np.finalized=!0,(pW=globalThis.litElementHydrateSupport)==null||pW.call(globalThis,{LitElement:np});const Wk=globalThis.litElementPolyfillSupport;Wk==null||Wk({LitElement:np});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.4");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const PZ=n=>n.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const xW={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},LW=n=>(...e)=>({_$litDirective$:n,values:e});let DW=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,i){this._$Ct=e,this._$AM=t,this._$Ci=i}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const y_=(n,e)=>{var i;const t=n._$AN;if(t===void 0)return!1;for(const s of t)(i=s._$AO)==null||i.call(s,e,!1),y_(s,e);return!0},iS=n=>{let e,t;do{if((e=n._$AM)===void 0)break;t=e._$AN,t.delete(n),n=e}while((t==null?void 0:t.size)===0)},kW=n=>{for(let e;e=n._$AM;n=e){let t=e._$AN;if(t===void 0)e._$AN=t=new Set;else if(t.has(n))break;t.add(n),BZ(e)}};function OZ(n){this._$AN!==void 0?(iS(this),this._$AM=n,kW(this)):this._$AM=n}function FZ(n,e=!1,t=0){const i=this._$AH,s=this._$AN;if(s!==void 0&&s.size!==0)if(e)if(Array.isArray(i))for(let o=t;o<i.length;o++)y_(i[o],!1),iS(i[o]);else i!=null&&(y_(i,!1),iS(i));else y_(this,n)}const BZ=n=>{n.type==xW.CHILD&&(n._$AP??(n._$AP=FZ),n._$AQ??(n._$AQ=OZ))};class WZ extends DW{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),kW(this),this.isConnected=e._$AU}_$AO(e,t=!0){var i,s;e!==this.isConnected&&(this.isConnected=e,e?(i=this.reconnected)==null||i.call(this):(s=this.disconnected)==null||s.call(this)),t&&(y_(this,e),iS(this))}setValue(e){if(PZ(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const EW=()=>new VZ;let VZ=class{};const Vk=new WeakMap,T5=LW(class extends WZ{render(n){return Vi}update(n,[e]){var i;const t=e!==this.Y;return t&&this.Y!==void 0&&this.rt(void 0),(t||this.lt!==this.ct)&&(this.Y=e,this.ht=(i=n.options)==null?void 0:i.host,this.rt(this.ct=n.element)),Vi}rt(n){if(typeof this.Y=="function"){const e=this.ht??globalThis;let t=Vk.get(e);t===void 0&&(t=new WeakMap,Vk.set(e,t)),t.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),t.set(this.Y,n),n!==void 0&&this.Y.call(this.ht,n)}else this.Y.value=n}get lt(){var n,e;return typeof this.Y=="function"?(n=Vk.get(this.ht??globalThis))==null?void 0:n.get(this.Y):(e=this.Y)==null?void 0:e.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});function N5(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?N5(Object(t),!0).forEach(function(i){On(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):N5(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function nS(n){"@babel/helpers - typeof";return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nS(n)}function zZ(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function R5(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function HZ(n,e,t){return e&&R5(n.prototype,e),t&&R5(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function On(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vM(n,e){return UZ(n)||qZ(n,e)||AW(n,e)||KZ()}function C1(n){return $Z(n)||jZ(n)||AW(n)||GZ()}function $Z(n){if(Array.isArray(n))return QE(n)}function UZ(n){if(Array.isArray(n))return n}function jZ(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function qZ(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],s=!0,o=!1,r,a;try{for(t=t.call(n);!(s=(r=t.next()).done)&&(i.push(r.value),!(e&&i.length===e));s=!0);}catch(l){o=!0,a=l}finally{try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}return i}}function AW(n,e){if(n){if(typeof n=="string")return QE(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return QE(n,e)}}function QE(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function GZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M5=function(){},yM={},IW={},TW=null,NW={mark:M5,measure:M5};try{typeof window<"u"&&(yM=window),typeof document<"u"&&(IW=document),typeof MutationObserver<"u"&&(TW=MutationObserver),typeof performance<"u"&&(NW=performance)}catch{}var YZ=yM.navigator||{},P5=YZ.userAgent,O5=P5===void 0?"":P5,Od=yM,Pi=IW,F5=TW,Ny=NW;Od.document;var mc=!!Pi.documentElement&&!!Pi.head&&typeof Pi.addEventListener=="function"&&typeof Pi.createElement=="function",RW=~O5.indexOf("MSIE")||~O5.indexOf("Trident/"),Ry,My,Py,Oy,Fy,lc="___FONT_AWESOME___",JE=16,MW="fa",PW="svg-inline--fa",sf="data-fa-i2svg",eA="data-fa-pseudo-element",ZZ="data-fa-pseudo-element-pending",wM="data-prefix",CM="data-icon",B5="fontawesome-i2svg",XZ="async",QZ=["HTML","HEAD","STYLE","SCRIPT"],OW=function(){try{return!0}catch{return!1}}(),Ni="classic",en="sharp",SM=[Ni,en];function S1(n){return new Proxy(n,{get:function(t,i){return i in t?t[i]:t[Ni]}})}var tb=S1((Ry={},On(Ry,Ni,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),On(Ry,en,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Ry)),ib=S1((My={},On(My,Ni,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),On(My,en,{solid:"fass",regular:"fasr",light:"fasl"}),My)),nb=S1((Py={},On(Py,Ni,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),On(Py,en,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),Py)),JZ=S1((Oy={},On(Oy,Ni,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),On(Oy,en,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Oy)),eX=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,FW="fa-layers-text",tX=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,iX=S1((Fy={},On(Fy,Ni,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),On(Fy,en,{900:"fass",400:"fasr",300:"fasl"}),Fy)),BW=[1,2,3,4,5,6,7,8,9,10],nX=BW.concat([11,12,13,14,15,16,17,18,19,20]),sX=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],ph={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},sb=new Set;Object.keys(ib[Ni]).map(sb.add.bind(sb));Object.keys(ib[en]).map(sb.add.bind(sb));var oX=[].concat(SM,C1(sb),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",ph.GROUP,ph.SWAP_OPACITY,ph.PRIMARY,ph.SECONDARY]).concat(BW.map(function(n){return"".concat(n,"x")})).concat(nX.map(function(n){return"w-".concat(n)})),w_=Od.FontAwesomeConfig||{};function rX(n){var e=Pi.querySelector("script["+n+"]");if(e)return e.getAttribute(n)}function aX(n){return n===""?!0:n==="false"?!1:n==="true"?!0:n}if(Pi&&typeof Pi.querySelector=="function"){var lX=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];lX.forEach(function(n){var e=vM(n,2),t=e[0],i=e[1],s=aX(rX(t));s!=null&&(w_[i]=s)})}var WW={styleDefault:"solid",familyDefault:"classic",cssPrefix:MW,replacementClass:PW,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};w_.familyPrefix&&(w_.cssPrefix=w_.familyPrefix);var Jp=Pe(Pe({},WW),w_);Jp.autoReplaceSvg||(Jp.observeMutations=!1);var ze={};Object.keys(WW).forEach(function(n){Object.defineProperty(ze,n,{enumerable:!0,set:function(t){Jp[n]=t,C_.forEach(function(i){return i(ze)})},get:function(){return Jp[n]}})});Object.defineProperty(ze,"familyPrefix",{enumerable:!0,set:function(e){Jp.cssPrefix=e,C_.forEach(function(t){return t(ze)})},get:function(){return Jp.cssPrefix}});Od.FontAwesomeConfig=ze;var C_=[];function cX(n){return C_.push(n),function(){C_.splice(C_.indexOf(n),1)}}var Ec=JE,Ra={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function dX(n){if(!(!n||!mc)){var e=Pi.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=n;for(var t=Pi.head.childNodes,i=null,s=t.length-1;s>-1;s--){var o=t[s],r=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(r)>-1&&(i=o)}return Pi.head.insertBefore(e,i),n}}var uX="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function ob(){for(var n=12,e="";n-- >0;)e+=uX[Math.random()*62|0];return e}function $m(n){for(var e=[],t=(n||[]).length>>>0;t--;)e[t]=n[t];return e}function xM(n){return n.classList?$m(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(e){return e})}function VW(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hX(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(VW(n[t]),'" ')},"").trim()}function vL(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(n[t].trim(),";")},"")}function LM(n){return n.size!==Ra.size||n.x!==Ra.x||n.y!==Ra.y||n.rotate!==Ra.rotate||n.flipX||n.flipY}function fX(n){var e=n.transform,t=n.containerWidth,i=n.iconWidth,s={transform:"translate(".concat(t/2," 256)")},o="translate(".concat(e.x*32,", ").concat(e.y*32,") "),r="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(o," ").concat(r," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:s,inner:l,path:c}}function gX(n){var e=n.transform,t=n.width,i=t===void 0?JE:t,s=n.height,o=s===void 0?JE:s,r=n.startCentered,a=r===void 0?!1:r,l="";return a&&RW?l+="translate(".concat(e.x/Ec-i/2,"em, ").concat(e.y/Ec-o/2,"em) "):a?l+="translate(calc(-50% + ".concat(e.x/Ec,"em), calc(-50% + ").concat(e.y/Ec,"em)) "):l+="translate(".concat(e.x/Ec,"em, ").concat(e.y/Ec,"em) "),l+="scale(".concat(e.size/Ec*(e.flipX?-1:1),", ").concat(e.size/Ec*(e.flipY?-1:1),") "),l+="rotate(".concat(e.rotate,"deg) "),l}var pX=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    -webkit-transition-delay: 0s;
            transition-delay: 0s;
    -webkit-transition-duration: 0s;
            transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function zW(){var n=MW,e=PW,t=ze.cssPrefix,i=ze.replacementClass,s=pX;if(t!==n||i!==e){var o=new RegExp("\\.".concat(n,"\\-"),"g"),r=new RegExp("\\--".concat(n,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");s=s.replace(o,".".concat(t,"-")).replace(r,"--".concat(t,"-")).replace(a,".".concat(i))}return s}var W5=!1;function zk(){ze.autoAddCss&&!W5&&(dX(zW()),W5=!0)}var mX={mixout:function(){return{dom:{css:zW,insertCss:zk}}},hooks:function(){return{beforeDOMElementCreation:function(){zk()},beforeI2svg:function(){zk()}}}},cc=Od||{};cc[lc]||(cc[lc]={});cc[lc].styles||(cc[lc].styles={});cc[lc].hooks||(cc[lc].hooks={});cc[lc].shims||(cc[lc].shims=[]);var Yr=cc[lc],HW=[],_X=function n(){Pi.removeEventListener("DOMContentLoaded",n),sS=1,HW.map(function(e){return e()})},sS=!1;mc&&(sS=(Pi.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Pi.readyState),sS||Pi.addEventListener("DOMContentLoaded",_X));function bX(n){mc&&(sS?setTimeout(n,0):HW.push(n))}function x1(n){var e=n.tag,t=n.attributes,i=t===void 0?{}:t,s=n.children,o=s===void 0?[]:s;return typeof n=="string"?VW(n):"<".concat(e," ").concat(hX(i),">").concat(o.map(x1).join(""),"</").concat(e,">")}function V5(n,e,t){if(n&&n[e]&&n[e][t])return{prefix:e,iconName:t,icon:n[e][t]}}var vX=function(e,t){return function(i,s,o,r){return e.call(t,i,s,o,r)}},Hk=function(e,t,i,s){var o=Object.keys(e),r=o.length,a=s!==void 0?vX(t,s):t,l,c,d;for(i===void 0?(l=1,d=e[o[0]]):(l=0,d=i);l<r;l++)c=o[l],d=a(d,e[c],c,e);return d};function yX(n){for(var e=[],t=0,i=n.length;t<i;){var s=n.charCodeAt(t++);if(s>=55296&&s<=56319&&t<i){var o=n.charCodeAt(t++);(o&64512)==56320?e.push(((s&1023)<<10)+(o&1023)+65536):(e.push(s),t--)}else e.push(s)}return e}function tA(n){var e=yX(n);return e.length===1?e[0].toString(16):null}function wX(n,e){var t=n.length,i=n.charCodeAt(e),s;return i>=55296&&i<=56319&&t>e+1&&(s=n.charCodeAt(e+1),s>=56320&&s<=57343)?(i-55296)*1024+s-56320+65536:i}function z5(n){return Object.keys(n).reduce(function(e,t){var i=n[t],s=!!i.icon;return s?e[i.iconName]=i.icon:e[t]=i,e},{})}function iA(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.skipHooks,s=i===void 0?!1:i,o=z5(e);typeof Yr.hooks.addPack=="function"&&!s?Yr.hooks.addPack(n,z5(e)):Yr.styles[n]=Pe(Pe({},Yr.styles[n]||{}),o),n==="fas"&&iA("fa",e)}var By,Wy,Vy,Eg=Yr.styles,CX=Yr.shims,SX=(By={},On(By,Ni,Object.values(nb[Ni])),On(By,en,Object.values(nb[en])),By),DM=null,$W={},UW={},jW={},qW={},GW={},xX=(Wy={},On(Wy,Ni,Object.keys(tb[Ni])),On(Wy,en,Object.keys(tb[en])),Wy);function LX(n){return~oX.indexOf(n)}function DX(n,e){var t=e.split("-"),i=t[0],s=t.slice(1).join("-");return i===n&&s!==""&&!LX(s)?s:null}var KW=function(){var e=function(o){return Hk(Eg,function(r,a,l){return r[l]=Hk(a,o,{}),r},{})};$W=e(function(s,o,r){if(o[3]&&(s[o[3]]=r),o[2]){var a=o[2].filter(function(l){return typeof l=="number"});a.forEach(function(l){s[l.toString(16)]=r})}return s}),UW=e(function(s,o,r){if(s[r]=r,o[2]){var a=o[2].filter(function(l){return typeof l=="string"});a.forEach(function(l){s[l]=r})}return s}),GW=e(function(s,o,r){var a=o[2];return s[r]=r,a.forEach(function(l){s[l]=r}),s});var t="far"in Eg||ze.autoFetchSvg,i=Hk(CX,function(s,o){var r=o[0],a=o[1],l=o[2];return a==="far"&&!t&&(a="fas"),typeof r=="string"&&(s.names[r]={prefix:a,iconName:l}),typeof r=="number"&&(s.unicodes[r.toString(16)]={prefix:a,iconName:l}),s},{names:{},unicodes:{}});jW=i.names,qW=i.unicodes,DM=yL(ze.styleDefault,{family:ze.familyDefault})};cX(function(n){DM=yL(n.styleDefault,{family:ze.familyDefault})});KW();function kM(n,e){return($W[n]||{})[e]}function kX(n,e){return(UW[n]||{})[e]}function mh(n,e){return(GW[n]||{})[e]}function YW(n){return jW[n]||{prefix:null,iconName:null}}function EX(n){var e=qW[n],t=kM("fas",n);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}function Fd(){return DM}var EM=function(){return{prefix:null,iconName:null,rest:[]}};function yL(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.family,i=t===void 0?Ni:t,s=tb[i][n],o=ib[i][n]||ib[i][s],r=n in Yr.styles?n:null;return o||r||null}var H5=(Vy={},On(Vy,Ni,Object.keys(nb[Ni])),On(Vy,en,Object.keys(nb[en])),Vy);function wL(n){var e,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.skipLookups,s=i===void 0?!1:i,o=(e={},On(e,Ni,"".concat(ze.cssPrefix,"-").concat(Ni)),On(e,en,"".concat(ze.cssPrefix,"-").concat(en)),e),r=null,a=Ni;(n.includes(o[Ni])||n.some(function(c){return H5[Ni].includes(c)}))&&(a=Ni),(n.includes(o[en])||n.some(function(c){return H5[en].includes(c)}))&&(a=en);var l=n.reduce(function(c,d){var u=DX(ze.cssPrefix,d);if(Eg[d]?(d=SX[a].includes(d)?JZ[a][d]:d,r=d,c.prefix=d):xX[a].indexOf(d)>-1?(r=d,c.prefix=yL(d,{family:a})):u?c.iconName=u:d!==ze.replacementClass&&d!==o[Ni]&&d!==o[en]&&c.rest.push(d),!s&&c.prefix&&c.iconName){var h=r==="fa"?YW(c.iconName):{},f=mh(c.prefix,c.iconName);h.prefix&&(r=null),c.iconName=h.iconName||f||c.iconName,c.prefix=h.prefix||c.prefix,c.prefix==="far"&&!Eg.far&&Eg.fas&&!ze.autoFetchSvg&&(c.prefix="fas")}return c},EM());return(n.includes("fa-brands")||n.includes("fab"))&&(l.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(l.prefix="fad"),!l.prefix&&a===en&&(Eg.fass||ze.autoFetchSvg)&&(l.prefix="fass",l.iconName=mh(l.prefix,l.iconName)||l.iconName),(l.prefix==="fa"||r==="fa")&&(l.prefix=Fd()||"fas"),l}var AX=function(){function n(){zZ(this,n),this.definitions={}}return HZ(n,[{key:"add",value:function(){for(var t=this,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var r=s.reduce(this._pullDefinitions,{});Object.keys(r).forEach(function(a){t.definitions[a]=Pe(Pe({},t.definitions[a]||{}),r[a]),iA(a,r[a]);var l=nb[Ni][a];l&&iA(l,r[a]),KW()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,i){var s=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(s).map(function(o){var r=s[o],a=r.prefix,l=r.iconName,c=r.icon,d=c[2];t[a]||(t[a]={}),d.length>0&&d.forEach(function(u){typeof u=="string"&&(t[a][u]=c)}),t[a][l]=c}),t}}]),n}(),$5=[],Ag={},sp={},IX=Object.keys(sp);function TX(n,e){var t=e.mixoutsTo;return $5=n,Ag={},Object.keys(sp).forEach(function(i){IX.indexOf(i)===-1&&delete sp[i]}),$5.forEach(function(i){var s=i.mixout?i.mixout():{};if(Object.keys(s).forEach(function(r){typeof s[r]=="function"&&(t[r]=s[r]),nS(s[r])==="object"&&Object.keys(s[r]).forEach(function(a){t[r]||(t[r]={}),t[r][a]=s[r][a]})}),i.hooks){var o=i.hooks();Object.keys(o).forEach(function(r){Ag[r]||(Ag[r]=[]),Ag[r].push(o[r])})}i.provides&&i.provides(sp)}),t}function nA(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),s=2;s<t;s++)i[s-2]=arguments[s];var o=Ag[n]||[];return o.forEach(function(r){e=r.apply(null,[e].concat(i))}),e}function of(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];var s=Ag[n]||[];s.forEach(function(o){o.apply(null,t)})}function dc(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);return sp[n]?sp[n].apply(null,e):void 0}function sA(n){n.prefix==="fa"&&(n.prefix="fas");var e=n.iconName,t=n.prefix||Fd();if(e)return e=mh(t,e)||e,V5(ZW.definitions,t,e)||V5(Yr.styles,t,e)}var ZW=new AX,NX=function(){ze.autoReplaceSvg=!1,ze.observeMutations=!1,of("noAuto")},RX={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mc?(of("beforeI2svg",e),dc("pseudoElements2svg",e),dc("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot;ze.autoReplaceSvg===!1&&(ze.autoReplaceSvg=!0),ze.observeMutations=!0,bX(function(){PX({autoReplaceSvgRoot:t}),of("watch",e)})}},MX={icon:function(e){if(e===null)return null;if(nS(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:mh(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var t=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=yL(e[0]);return{prefix:i,iconName:mh(i,t)||t}}if(typeof e=="string"&&(e.indexOf("".concat(ze.cssPrefix,"-"))>-1||e.match(eX))){var s=wL(e.split(" "),{skipLookups:!0});return{prefix:s.prefix||Fd(),iconName:mh(s.prefix,s.iconName)||s.iconName}}if(typeof e=="string"){var o=Fd();return{prefix:o,iconName:mh(o,e)||e}}}},Go={noAuto:NX,config:ze,dom:RX,parse:MX,library:ZW,findIconDefinition:sA,toHtml:x1},PX=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot,i=t===void 0?Pi:t;(Object.keys(Yr.styles).length>0||ze.autoFetchSvg)&&mc&&ze.autoReplaceSvg&&Go.dom.i2svg({node:i})};function CL(n,e){return Object.defineProperty(n,"abstract",{get:e}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(i){return x1(i)})}}),Object.defineProperty(n,"node",{get:function(){if(mc){var i=Pi.createElement("div");return i.innerHTML=n.html,i.children}}}),n}function OX(n){var e=n.children,t=n.main,i=n.mask,s=n.attributes,o=n.styles,r=n.transform;if(LM(r)&&t.found&&!i.found){var a=t.width,l=t.height,c={x:a/l/2,y:.5};s.style=vL(Pe(Pe({},o),{},{"transform-origin":"".concat(c.x+r.x/16,"em ").concat(c.y+r.y/16,"em")}))}return[{tag:"svg",attributes:s,children:e}]}function FX(n){var e=n.prefix,t=n.iconName,i=n.children,s=n.attributes,o=n.symbol,r=o===!0?"".concat(e,"-").concat(ze.cssPrefix,"-").concat(t):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Pe(Pe({},s),{},{id:r}),children:i}]}]}function AM(n){var e=n.icons,t=e.main,i=e.mask,s=n.prefix,o=n.iconName,r=n.transform,a=n.symbol,l=n.title,c=n.maskId,d=n.titleId,u=n.extra,h=n.watchable,f=h===void 0?!1:h,g=i.found?i:t,p=g.width,_=g.height,v=s==="fak",b=[ze.replacementClass,o?"".concat(ze.cssPrefix,"-").concat(o):""].filter(function(k){return u.classes.indexOf(k)===-1}).filter(function(k){return k!==""||!!k}).concat(u.classes).join(" "),y={children:[],attributes:Pe(Pe({},u.attributes),{},{"data-prefix":s,"data-icon":o,class:b,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(_)})},w=v&&!~u.classes.indexOf("fa-fw")?{width:"".concat(p/_*16*.0625,"em")}:{};f&&(y.attributes[sf]=""),l&&(y.children.push({tag:"title",attributes:{id:y.attributes["aria-labelledby"]||"title-".concat(d||ob())},children:[l]}),delete y.attributes.title);var C=Pe(Pe({},y),{},{prefix:s,iconName:o,main:t,mask:i,maskId:c,transform:r,symbol:a,styles:Pe(Pe({},w),u.styles)}),L=i.found&&t.found?dc("generateAbstractMask",C)||{children:[],attributes:{}}:dc("generateAbstractIcon",C)||{children:[],attributes:{}},x=L.children,D=L.attributes;return C.children=x,C.attributes=D,a?FX(C):OX(C)}function U5(n){var e=n.content,t=n.width,i=n.height,s=n.transform,o=n.title,r=n.extra,a=n.watchable,l=a===void 0?!1:a,c=Pe(Pe(Pe({},r.attributes),o?{title:o}:{}),{},{class:r.classes.join(" ")});l&&(c[sf]="");var d=Pe({},r.styles);LM(s)&&(d.transform=gX({transform:s,startCentered:!0,width:t,height:i}),d["-webkit-transform"]=d.transform);var u=vL(d);u.length>0&&(c.style=u);var h=[];return h.push({tag:"span",attributes:c,children:[e]}),o&&h.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),h}function BX(n){var e=n.content,t=n.title,i=n.extra,s=Pe(Pe(Pe({},i.attributes),t?{title:t}:{}),{},{class:i.classes.join(" ")}),o=vL(i.styles);o.length>0&&(s.style=o);var r=[];return r.push({tag:"span",attributes:s,children:[e]}),t&&r.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),r}var $k=Yr.styles;function oA(n){var e=n[0],t=n[1],i=n.slice(4),s=vM(i,1),o=s[0],r=null;return Array.isArray(o)?r={tag:"g",attributes:{class:"".concat(ze.cssPrefix,"-").concat(ph.GROUP)},children:[{tag:"path",attributes:{class:"".concat(ze.cssPrefix,"-").concat(ph.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(ze.cssPrefix,"-").concat(ph.PRIMARY),fill:"currentColor",d:o[1]}}]}:r={tag:"path",attributes:{fill:"currentColor",d:o}},{found:!0,width:e,height:t,icon:r}}var WX={found:!1,width:512,height:512};function VX(n,e){!OW&&!ze.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(e,'" is missing.'))}function rA(n,e){var t=e;return e==="fa"&&ze.styleDefault!==null&&(e=Fd()),new Promise(function(i,s){if(dc("missingIconAbstract"),t==="fa"){var o=YW(n)||{};n=o.iconName||n,e=o.prefix||e}if(n&&e&&$k[e]&&$k[e][n]){var r=$k[e][n];return i(oA(r))}VX(n,e),i(Pe(Pe({},WX),{},{icon:ze.showMissingIcons&&n?dc("missingIconAbstract")||{}:{}}))})}var j5=function(){},aA=ze.measurePerformance&&Ny&&Ny.mark&&Ny.measure?Ny:{mark:j5,measure:j5},q0='FA "6.4.2"',zX=function(e){return aA.mark("".concat(q0," ").concat(e," begins")),function(){return XW(e)}},XW=function(e){aA.mark("".concat(q0," ").concat(e," ends")),aA.measure("".concat(q0," ").concat(e),"".concat(q0," ").concat(e," begins"),"".concat(q0," ").concat(e," ends"))},IM={begin:zX,end:XW},hC=function(){};function q5(n){var e=n.getAttribute?n.getAttribute(sf):null;return typeof e=="string"}function HX(n){var e=n.getAttribute?n.getAttribute(wM):null,t=n.getAttribute?n.getAttribute(CM):null;return e&&t}function $X(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(ze.replacementClass)}function UX(){if(ze.autoReplaceSvg===!0)return fC.replace;var n=fC[ze.autoReplaceSvg];return n||fC.replace}function jX(n){return Pi.createElementNS("http://www.w3.org/2000/svg",n)}function qX(n){return Pi.createElement(n)}function QW(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.ceFn,i=t===void 0?n.tag==="svg"?jX:qX:t;if(typeof n=="string")return Pi.createTextNode(n);var s=i(n.tag);Object.keys(n.attributes||[]).forEach(function(r){s.setAttribute(r,n.attributes[r])});var o=n.children||[];return o.forEach(function(r){s.appendChild(QW(r,{ceFn:i}))}),s}function GX(n){var e=" ".concat(n.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var fC={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(s){t.parentNode.insertBefore(QW(s),t)}),t.getAttribute(sf)===null&&ze.keepOriginalSource){var i=Pi.createComment(GX(t));t.parentNode.replaceChild(i,t)}else t.remove()},nest:function(e){var t=e[0],i=e[1];if(~xM(t).indexOf(ze.replacementClass))return fC.replace(e);var s=new RegExp("".concat(ze.cssPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var o=i[0].attributes.class.split(" ").reduce(function(a,l){return l===ze.replacementClass||l.match(s)?a.toSvg.push(l):a.toNode.push(l),a},{toNode:[],toSvg:[]});i[0].attributes.class=o.toSvg.join(" "),o.toNode.length===0?t.removeAttribute("class"):t.setAttribute("class",o.toNode.join(" "))}var r=i.map(function(a){return x1(a)}).join(`
`);t.setAttribute(sf,""),t.innerHTML=r}};function G5(n){n()}function JW(n,e){var t=typeof e=="function"?e:hC;if(n.length===0)t();else{var i=G5;ze.mutateApproach===XZ&&(i=Od.requestAnimationFrame||G5),i(function(){var s=UX(),o=IM.begin("mutate");n.map(s),o(),t()})}}var TM=!1;function eV(){TM=!0}function lA(){TM=!1}var oS=null;function K5(n){if(F5&&ze.observeMutations){var e=n.treeCallback,t=e===void 0?hC:e,i=n.nodeCallback,s=i===void 0?hC:i,o=n.pseudoElementsCallback,r=o===void 0?hC:o,a=n.observeMutationsRoot,l=a===void 0?Pi:a;oS=new F5(function(c){if(!TM){var d=Fd();$m(c).forEach(function(u){if(u.type==="childList"&&u.addedNodes.length>0&&!q5(u.addedNodes[0])&&(ze.searchPseudoElements&&r(u.target),t(u.target)),u.type==="attributes"&&u.target.parentNode&&ze.searchPseudoElements&&r(u.target.parentNode),u.type==="attributes"&&q5(u.target)&&~sX.indexOf(u.attributeName))if(u.attributeName==="class"&&HX(u.target)){var h=wL(xM(u.target)),f=h.prefix,g=h.iconName;u.target.setAttribute(wM,f||d),g&&u.target.setAttribute(CM,g)}else $X(u.target)&&s(u.target)})}}),mc&&oS.observe(l,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function KX(){oS&&oS.disconnect()}function YX(n){var e=n.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(i,s){var o=s.split(":"),r=o[0],a=o.slice(1);return r&&a.length>0&&(i[r]=a.join(":").trim()),i},{})),t}function ZX(n){var e=n.getAttribute("data-prefix"),t=n.getAttribute("data-icon"),i=n.innerText!==void 0?n.innerText.trim():"",s=wL(xM(n));return s.prefix||(s.prefix=Fd()),e&&t&&(s.prefix=e,s.iconName=t),s.iconName&&s.prefix||(s.prefix&&i.length>0&&(s.iconName=kX(s.prefix,n.innerText)||kM(s.prefix,tA(n.innerText))),!s.iconName&&ze.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function XX(n){var e=$m(n.attributes).reduce(function(s,o){return s.name!=="class"&&s.name!=="style"&&(s[o.name]=o.value),s},{}),t=n.getAttribute("title"),i=n.getAttribute("data-fa-title-id");return ze.autoA11y&&(t?e["aria-labelledby"]="".concat(ze.replacementClass,"-title-").concat(i||ob()):(e["aria-hidden"]="true",e.focusable="false")),e}function QX(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Ra,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function Y5(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},t=ZX(n),i=t.iconName,s=t.prefix,o=t.rest,r=XX(n),a=nA("parseNodeAttributes",{},n),l=e.styleParser?YX(n):[];return Pe({iconName:i,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:Ra,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:l,attributes:r}},a)}var JX=Yr.styles;function tV(n){var e=ze.autoReplaceSvg==="nest"?Y5(n,{styleParser:!1}):Y5(n);return~e.extra.classes.indexOf(FW)?dc("generateLayersText",n,e):dc("generateSvgReplacementMutation",n,e)}var Bd=new Set;SM.map(function(n){Bd.add("fa-".concat(n))});Object.keys(tb[Ni]).map(Bd.add.bind(Bd));Object.keys(tb[en]).map(Bd.add.bind(Bd));Bd=C1(Bd);function Z5(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mc)return Promise.resolve();var t=Pi.documentElement.classList,i=function(u){return t.add("".concat(B5,"-").concat(u))},s=function(u){return t.remove("".concat(B5,"-").concat(u))},o=ze.autoFetchSvg?Bd:SM.map(function(d){return"fa-".concat(d)}).concat(Object.keys(JX));o.includes("fa")||o.push("fa");var r=[".".concat(FW,":not([").concat(sf,"])")].concat(o.map(function(d){return".".concat(d,":not([").concat(sf,"])")})).join(", ");if(r.length===0)return Promise.resolve();var a=[];try{a=$m(n.querySelectorAll(r))}catch{}if(a.length>0)i("pending"),s("complete");else return Promise.resolve();var l=IM.begin("onTree"),c=a.reduce(function(d,u){try{var h=tV(u);h&&d.push(h)}catch(f){OW||f.name==="MissingIcon"&&console.error(f)}return d},[]);return new Promise(function(d,u){Promise.all(c).then(function(h){JW(h,function(){i("active"),i("complete"),s("pending"),typeof e=="function"&&e(),l(),d()})}).catch(function(h){l(),u(h)})})}function eQ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;tV(n).then(function(t){t&&JW([t],e)})}function tQ(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:sA(e||{}),s=t.mask;return s&&(s=(s||{}).icon?s:sA(s||{})),n(i,Pe(Pe({},t),{},{mask:s}))}}var iQ=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transform,s=i===void 0?Ra:i,o=t.symbol,r=o===void 0?!1:o,a=t.mask,l=a===void 0?null:a,c=t.maskId,d=c===void 0?null:c,u=t.title,h=u===void 0?null:u,f=t.titleId,g=f===void 0?null:f,p=t.classes,_=p===void 0?[]:p,v=t.attributes,b=v===void 0?{}:v,y=t.styles,w=y===void 0?{}:y;if(e){var C=e.prefix,L=e.iconName,x=e.icon;return CL(Pe({type:"icon"},e),function(){return of("beforeDOMElementCreation",{iconDefinition:e,params:t}),ze.autoA11y&&(h?b["aria-labelledby"]="".concat(ze.replacementClass,"-title-").concat(g||ob()):(b["aria-hidden"]="true",b.focusable="false")),AM({icons:{main:oA(x),mask:l?oA(l.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:L,transform:Pe(Pe({},Ra),s),symbol:r,title:h,maskId:d,titleId:g,extra:{attributes:b,styles:w,classes:_}})})}},nQ={mixout:function(){return{icon:tQ(iQ)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=Z5,t.nodeCallback=eQ,t}}},provides:function(e){e.i2svg=function(t){var i=t.node,s=i===void 0?Pi:i,o=t.callback,r=o===void 0?function(){}:o;return Z5(s,r)},e.generateSvgReplacementMutation=function(t,i){var s=i.iconName,o=i.title,r=i.titleId,a=i.prefix,l=i.transform,c=i.symbol,d=i.mask,u=i.maskId,h=i.extra;return new Promise(function(f,g){Promise.all([rA(s,a),d.iconName?rA(d.iconName,d.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(p){var _=vM(p,2),v=_[0],b=_[1];f([t,AM({icons:{main:v,mask:b},prefix:a,iconName:s,transform:l,symbol:c,maskId:u,title:o,titleId:r,extra:h,watchable:!0})])}).catch(g)})},e.generateAbstractIcon=function(t){var i=t.children,s=t.attributes,o=t.main,r=t.transform,a=t.styles,l=vL(a);l.length>0&&(s.style=l);var c;return LM(r)&&(c=dc("generateAbstractTransformGrouping",{main:o,transform:r,containerWidth:o.width,iconWidth:o.width})),i.push(c||o.icon),{children:i,attributes:s}}}},sQ={mixout:function(){return{layer:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.classes,o=s===void 0?[]:s;return CL({type:"layer"},function(){of("beforeDOMElementCreation",{assembler:t,params:i});var r=[];return t(function(a){Array.isArray(a)?a.map(function(l){r=r.concat(l.abstract)}):r=r.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(ze.cssPrefix,"-layers")].concat(C1(o)).join(" ")},children:r}]})}}}},oQ={mixout:function(){return{counter:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.title,o=s===void 0?null:s,r=i.classes,a=r===void 0?[]:r,l=i.attributes,c=l===void 0?{}:l,d=i.styles,u=d===void 0?{}:d;return CL({type:"counter",content:t},function(){return of("beforeDOMElementCreation",{content:t,params:i}),BX({content:t.toString(),title:o,extra:{attributes:c,styles:u,classes:["".concat(ze.cssPrefix,"-layers-counter")].concat(C1(a))}})})}}}},rQ={mixout:function(){return{text:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.transform,o=s===void 0?Ra:s,r=i.title,a=r===void 0?null:r,l=i.classes,c=l===void 0?[]:l,d=i.attributes,u=d===void 0?{}:d,h=i.styles,f=h===void 0?{}:h;return CL({type:"text",content:t},function(){return of("beforeDOMElementCreation",{content:t,params:i}),U5({content:t,transform:Pe(Pe({},Ra),o),title:a,extra:{attributes:u,styles:f,classes:["".concat(ze.cssPrefix,"-layers-text")].concat(C1(c))}})})}}},provides:function(e){e.generateLayersText=function(t,i){var s=i.title,o=i.transform,r=i.extra,a=null,l=null;if(RW){var c=parseInt(getComputedStyle(t).fontSize,10),d=t.getBoundingClientRect();a=d.width/c,l=d.height/c}return ze.autoA11y&&!s&&(r.attributes["aria-hidden"]="true"),Promise.resolve([t,U5({content:t.innerHTML,width:a,height:l,transform:o,title:s,extra:r,watchable:!0})])}}},aQ=new RegExp('"',"ug"),X5=[1105920,1112319];function lQ(n){var e=n.replace(aQ,""),t=wX(e,0),i=t>=X5[0]&&t<=X5[1],s=e.length===2?e[0]===e[1]:!1;return{value:tA(s?e[0]:e),isSecondary:i||s}}function Q5(n,e){var t="".concat(ZZ).concat(e.replace(":","-"));return new Promise(function(i,s){if(n.getAttribute(t)!==null)return i();var o=$m(n.children),r=o.filter(function(x){return x.getAttribute(eA)===e})[0],a=Od.getComputedStyle(n,e),l=a.getPropertyValue("font-family").match(tX),c=a.getPropertyValue("font-weight"),d=a.getPropertyValue("content");if(r&&!l)return n.removeChild(r),i();if(l&&d!=="none"&&d!==""){var u=a.getPropertyValue("content"),h=~["Sharp"].indexOf(l[2])?en:Ni,f=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(l[2])?ib[h][l[2].toLowerCase()]:iX[h][c],g=lQ(u),p=g.value,_=g.isSecondary,v=l[0].startsWith("FontAwesome"),b=kM(f,p),y=b;if(v){var w=EX(p);w.iconName&&w.prefix&&(b=w.iconName,f=w.prefix)}if(b&&!_&&(!r||r.getAttribute(wM)!==f||r.getAttribute(CM)!==y)){n.setAttribute(t,y),r&&n.removeChild(r);var C=QX(),L=C.extra;L.attributes[eA]=e,rA(b,f).then(function(x){var D=AM(Pe(Pe({},C),{},{icons:{main:x,mask:EM()},prefix:f,iconName:y,extra:L,watchable:!0})),k=Pi.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?n.insertBefore(k,n.firstChild):n.appendChild(k),k.outerHTML=D.map(function(P){return x1(P)}).join(`
`),n.removeAttribute(t),i()}).catch(s)}else i()}else i()})}function cQ(n){return Promise.all([Q5(n,"::before"),Q5(n,"::after")])}function dQ(n){return n.parentNode!==document.head&&!~QZ.indexOf(n.tagName.toUpperCase())&&!n.getAttribute(eA)&&(!n.parentNode||n.parentNode.tagName!=="svg")}function J5(n){if(mc)return new Promise(function(e,t){var i=$m(n.querySelectorAll("*")).filter(dQ).map(cQ),s=IM.begin("searchPseudoElements");eV(),Promise.all(i).then(function(){s(),lA(),e()}).catch(function(){s(),lA(),t()})})}var uQ={hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=J5,t}}},provides:function(e){e.pseudoElements2svg=function(t){var i=t.node,s=i===void 0?Pi:i;ze.searchPseudoElements&&J5(s)}}},eO=!1,hQ={mixout:function(){return{dom:{unwatch:function(){eV(),eO=!0}}}},hooks:function(){return{bootstrap:function(){K5(nA("mutationObserverCallbacks",{}))},noAuto:function(){KX()},watch:function(t){var i=t.observeMutationsRoot;eO?lA():K5(nA("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},tO=function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,s){var o=s.toLowerCase().split("-"),r=o[0],a=o.slice(1).join("-");if(r&&a==="h")return i.flipX=!0,i;if(r&&a==="v")return i.flipY=!0,i;if(a=parseFloat(a),isNaN(a))return i;switch(r){case"grow":i.size=i.size+a;break;case"shrink":i.size=i.size-a;break;case"left":i.x=i.x-a;break;case"right":i.x=i.x+a;break;case"up":i.y=i.y-a;break;case"down":i.y=i.y+a;break;case"rotate":i.rotate=i.rotate+a;break}return i},t)},fQ={mixout:function(){return{parse:{transform:function(t){return tO(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-transform");return s&&(t.transform=tO(s)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var i=t.main,s=t.transform,o=t.containerWidth,r=t.iconWidth,a={transform:"translate(".concat(o/2," 256)")},l="translate(".concat(s.x*32,", ").concat(s.y*32,") "),c="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),d="rotate(".concat(s.rotate," 0 0)"),u={transform:"".concat(l," ").concat(c," ").concat(d)},h={transform:"translate(".concat(r/2*-1," -256)")},f={outer:a,inner:u,path:h};return{tag:"g",attributes:Pe({},f.outer),children:[{tag:"g",attributes:Pe({},f.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:Pe(Pe({},i.icon.attributes),f.path)}]}]}}}},Uk={x:0,y:0,width:"100%",height:"100%"};function iO(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.attributes&&(n.attributes.fill||e)&&(n.attributes.fill="black"),n}function gQ(n){return n.tag==="g"?n.children:[n]}var pQ={hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-mask"),o=s?wL(s.split(" ").map(function(r){return r.trim()})):EM();return o.prefix||(o.prefix=Fd()),t.mask=o,t.maskId=i.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var i=t.children,s=t.attributes,o=t.main,r=t.mask,a=t.maskId,l=t.transform,c=o.width,d=o.icon,u=r.width,h=r.icon,f=fX({transform:l,containerWidth:u,iconWidth:c}),g={tag:"rect",attributes:Pe(Pe({},Uk),{},{fill:"white"})},p=d.children?{children:d.children.map(iO)}:{},_={tag:"g",attributes:Pe({},f.inner),children:[iO(Pe({tag:d.tag,attributes:Pe(Pe({},d.attributes),f.path)},p))]},v={tag:"g",attributes:Pe({},f.outer),children:[_]},b="mask-".concat(a||ob()),y="clip-".concat(a||ob()),w={tag:"mask",attributes:Pe(Pe({},Uk),{},{id:b,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,v]},C={tag:"defs",children:[{tag:"clipPath",attributes:{id:y},children:gQ(h)},w]};return i.push(C,{tag:"rect",attributes:Pe({fill:"currentColor","clip-path":"url(#".concat(y,")"),mask:"url(#".concat(b,")")},Uk)}),{children:i,attributes:s}}}},mQ={provides:function(e){var t=!1;Od.matchMedia&&(t=Od.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],s={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:Pe(Pe({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var r=Pe(Pe({},o),{},{attributeName:"opacity"}),a={tag:"circle",attributes:Pe(Pe({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:Pe(Pe({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Pe(Pe({},r),{},{values:"1;0;1;1;0;1;"})}),i.push(a),i.push({tag:"path",attributes:Pe(Pe({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:Pe(Pe({},r),{},{values:"1;0;0;0;0;1;"})}]}),t||i.push({tag:"path",attributes:Pe(Pe({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Pe(Pe({},r),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},_Q={hooks:function(){return{parseNodeAttributes:function(t,i){var s=i.getAttribute("data-fa-symbol"),o=s===null?!1:s===""?!0:s;return t.symbol=o,t}}}},bQ=[mX,nQ,sQ,oQ,rQ,uQ,hQ,fQ,pQ,mQ,_Q];TX(bQ,{mixoutsTo:Go});Go.noAuto;Go.config;Go.library;Go.dom;Go.parse;Go.findIconDefinition;Go.toHtml;var nO=Go.icon;Go.layer;Go.text;Go.counter;var vQ={prefix:"fas",iconName:"table-columns",icon:[512,512,["columns"],"f0db","M0 96C0 60.7 28.7 32 64 32H448c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zm64 64V416H224V160H64zm384 0H288V416H448V160z"]},yQ=vQ,wQ={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},CQ=wQ;function cu(n,e,t){return n.fields=e||[],n.fname=t,n}function SQ(n){return n==null?null:n.fname}function xQ(n){return n==null?null:n.fields}function LQ(n){return n.length===1?DQ(n[0]):kQ(n)}const DQ=n=>function(e){return e[n]},kQ=n=>{const e=n.length;return function(t){for(let i=0;i<e;++i)t=t[n[i]];return t}};function Tn(n){throw Error(n)}function EQ(n){const e=[],t=n.length;let i=null,s=0,o="",r,a,l;n=n+"";function c(){e.push(o+n.substring(r,a)),o="",r=a+1}for(r=a=0;a<t;++a)if(l=n[a],l==="\\")o+=n.substring(r,a++),r=a;else if(l===i)c(),i=null,s=-1;else{if(i)continue;r===s&&l==='"'||r===s&&l==="'"?(r=a+1,i=l):l==="."&&!s?a>r?c():r=a+1:l==="["?(a>r&&c(),s=r=a+1):l==="]"&&(s||Tn("Access path missing open bracket: "+n),s>0&&c(),s=0,r=a+1)}return s&&Tn("Access path missing closing bracket: "+n),i&&Tn("Access path missing closing quote: "+n),a>r&&(a++,c()),e}function SL(n,e,t){const i=EQ(n);return n=i.length===1?i[0]:n,cu((t&&t.get||LQ)(i),[n],e||n)}SL("id");const xL=cu(n=>n,[],"identity");cu(()=>0,[],"zero");cu(()=>1,[],"one");cu(()=>!0,[],"true");cu(()=>!1,[],"false");var Rs=Array.isArray;function Ms(n){return n===Object(n)}function Jr(n){return n[n.length-1]}function rb(n){return n==null||n===""?null:+n}const iV=n=>e=>n*Math.exp(e),nV=n=>e=>Math.log(n*e),AQ=n=>e=>Math.sign(e)*Math.log1p(Math.abs(e/n)),IQ=n=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*n,rS=n=>e=>e<0?-Math.pow(-e,n):Math.pow(e,n);function NM(n,e,t,i){const s=t(n[0]),o=t(Jr(n)),r=(o-s)*e;return[i(s-r),i(o-r)]}function TQ(n,e){return NM(n,e,rb,xL)}function NQ(n,e){var t=Math.sign(n[0]);return NM(n,e,nV(t),iV(t))}function RQ(n,e,t){return NM(n,e,rS(t),rS(1/t))}function LL(n,e,t,i,s){const o=i(n[0]),r=i(Jr(n)),a=e!=null?i(e):(o+r)/2;return[s(a+(o-a)*t),s(a+(r-a)*t)]}function sV(n,e,t){return LL(n,e,t,rb,xL)}function oV(n,e,t){const i=Math.sign(n[0]);return LL(n,e,t,nV(i),iV(i))}function cA(n,e,t,i){return LL(n,e,t,rS(i),rS(1/i))}function MQ(n,e,t,i){return LL(n,e,t,AQ(i),IQ(i))}function dA(n){return n!=null?Rs(n)?n:[n]:[]}function PQ(n,e,t){let i=n[0],s=n[1],o;return s<i&&(o=s,s=i,i=o),o=s-i,o>=t-e?[e,t]:[i=Math.min(Math.max(i,e),t-o),i+o]}function dr(n){return typeof n=="function"}const OQ="descending";function rV(n,e,t){t=t||{},e=dA(e)||[];const i=[],s=[],o={},r=t.comparator||FQ;return dA(n).forEach((a,l)=>{a!=null&&(i.push(e[l]===OQ?-1:1),s.push(a=dr(a)?a:SL(a,null,t)),(xQ(a)||[]).forEach(c=>o[c]=1))}),s.length===0?null:cu(r(s,i),Object.keys(o))}const aV=(n,e)=>(n<e||n==null)&&e!=null?-1:(n>e||e==null)&&n!=null?1:(e=e instanceof Date?+e:e,(n=n instanceof Date?+n:n)!==n&&e===e?-1:e!==e&&n===n?1:0),FQ=(n,e)=>n.length===1?BQ(n[0],e[0]):WQ(n,e,n.length),BQ=(n,e)=>function(t,i){return aV(n(t),n(i))*e},WQ=(n,e,t)=>(e.push(0),function(i,s){let o,r=0,a=-1;for(;r===0&&++a<t;)o=n[a],r=aV(o(i),o(s));return r*e[a]});function VQ(n){for(let e,t,i=1,s=arguments.length;i<s;++i){e=arguments[i];for(t in e)n[t]=e[t]}return n}const zQ=Object.prototype.hasOwnProperty;function Ig(n,e){return zQ.call(n,e)}function L1(n){return typeof n=="boolean"}function HQ(n){return Object.prototype.toString.call(n)==="[object Date]"}function $Q(n){return n&&dr(n[Symbol.iterator])}function Js(n){return typeof n=="number"}function UQ(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function ci(n){return typeof n=="string"}function lV(n,e){const t=n[0],i=Jr(n),s=+e;return s?s===1?i:t+s*(i-t):t}function aS(n){return n&&Jr(n)-n[0]||0}function RM(n){return Rs(n)?"["+n.map(RM)+"]":Ms(n)||ci(n)?JSON.stringify(n).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):n}function jQ(n){return n==null||n===""?null:!n||n==="false"||n==="0"?!1:!!n}const qQ=n=>Js(n)||HQ(n)?n:Date.parse(n);function GQ(n,e){return e=e||qQ,n==null||n===""?null:e(n)}function KQ(n){return n==null||n===""?null:n+""}function lS(n){const e={},t=n.length;for(let i=0;i<t;++i)e[n[i]]=!0;return e}var sO={},jk={},qk=34,f0=10,Gk=13;function cV(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function YQ(n,e){var t=cV(n);return function(i,s){return e(t(i),s,n)}}function oO(n){var e=Object.create(null),t=[];return n.forEach(function(i){for(var s in i)s in e||t.push(e[s]=s)}),t}function uo(n,e){var t=n+"",i=t.length;return i<e?new Array(e-i+1).join(0)+t:t}function ZQ(n){return n<0?"-"+uo(-n,6):n>9999?"+"+uo(n,6):uo(n,4)}function XQ(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),i=n.getUTCSeconds(),s=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":ZQ(n.getUTCFullYear())+"-"+uo(n.getUTCMonth()+1,2)+"-"+uo(n.getUTCDate(),2)+(s?"T"+uo(e,2)+":"+uo(t,2)+":"+uo(i,2)+"."+uo(s,3)+"Z":i?"T"+uo(e,2)+":"+uo(t,2)+":"+uo(i,2)+"Z":t||e?"T"+uo(e,2)+":"+uo(t,2)+"Z":"")}function dV(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function i(u,h){var f,g,p=s(u,function(_,v){if(f)return f(_,v-1);g=_,f=h?YQ(_,h):cV(_)});return p.columns=g||[],p}function s(u,h){var f=[],g=u.length,p=0,_=0,v,b=g<=0,y=!1;u.charCodeAt(g-1)===f0&&--g,u.charCodeAt(g-1)===Gk&&--g;function w(){if(b)return jk;if(y)return y=!1,sO;var L,x=p,D;if(u.charCodeAt(x)===qk){for(;p++<g&&u.charCodeAt(p)!==qk||u.charCodeAt(++p)===qk;);return(L=p)>=g?b=!0:(D=u.charCodeAt(p++))===f0?y=!0:D===Gk&&(y=!0,u.charCodeAt(p)===f0&&++p),u.slice(x+1,L-1).replace(/""/g,'"')}for(;p<g;){if((D=u.charCodeAt(L=p++))===f0)y=!0;else if(D===Gk)y=!0,u.charCodeAt(p)===f0&&++p;else if(D!==t)continue;return u.slice(x,L)}return b=!0,u.slice(x,g)}for(;(v=w())!==jk;){for(var C=[];v!==sO&&v!==jk;)C.push(v),v=w();h&&(C=h(C,_++))==null||f.push(C)}return f}function o(u,h){return u.map(function(f){return h.map(function(g){return d(f[g])}).join(n)})}function r(u,h){return h==null&&(h=oO(u)),[h.map(d).join(n)].concat(o(u,h)).join(`
`)}function a(u,h){return h==null&&(h=oO(u)),o(u,h).join(`
`)}function l(u){return u.map(c).join(`
`)}function c(u){return u.map(d).join(n)}function d(u){return u==null?"":u instanceof Date?XQ(u):e.test(u+="")?'"'+u.replace(/"/g,'""')+'"':u}return{parse:i,parseRows:s,format:r,formatBody:a,formatRows:l,formatRow:c,formatValue:d}}var QQ=dV("	"),JQ=QQ.parseRows;function eJ(n){return n}function tJ(n){if(n==null)return eJ;var e,t,i=n.scale[0],s=n.scale[1],o=n.translate[0],r=n.translate[1];return function(a,l){l||(e=t=0);var c=2,d=a.length,u=new Array(d);for(u[0]=(e+=a[0])*i+o,u[1]=(t+=a[1])*s+r;c<d;)u[c]=a[c],++c;return u}}function iJ(n,e){for(var t,i=n.length,s=i-e;s<--i;)t=n[s],n[s++]=n[i],n[i]=t}function nJ(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(t){return rO(n,t)})}:rO(n,e)}function rO(n,e){var t=e.id,i=e.bbox,s=e.properties==null?{}:e.properties,o=uV(n,e);return t==null&&i==null?{type:"Feature",properties:s,geometry:o}:i==null?{type:"Feature",id:t,properties:s,geometry:o}:{type:"Feature",id:t,bbox:i,properties:s,geometry:o}}function uV(n,e){var t=tJ(n.transform),i=n.arcs;function s(d,u){u.length&&u.pop();for(var h=i[d<0?~d:d],f=0,g=h.length;f<g;++f)u.push(t(h[f],f));d<0&&iJ(u,g)}function o(d){return t(d)}function r(d){for(var u=[],h=0,f=d.length;h<f;++h)s(d[h],u);return u.length<2&&u.push(u[0]),u}function a(d){for(var u=r(d);u.length<4;)u.push(u[0]);return u}function l(d){return d.map(a)}function c(d){var u=d.type,h;switch(u){case"GeometryCollection":return{type:u,geometries:d.geometries.map(c)};case"Point":h=o(d.coordinates);break;case"MultiPoint":h=d.coordinates.map(o);break;case"LineString":h=r(d.arcs);break;case"MultiLineString":h=d.arcs.map(r);break;case"Polygon":h=l(d.arcs);break;case"MultiPolygon":h=d.arcs.map(l);break;default:return null}return{type:u,coordinates:h}}return c(e)}function sJ(n,e){var t={},i={},s={},o=[],r=-1;e.forEach(function(c,d){var u=n.arcs[c<0?~c:c],h;u.length<3&&!u[1][0]&&!u[1][1]&&(h=e[++r],e[r]=c,e[d]=h)}),e.forEach(function(c){var d=a(c),u=d[0],h=d[1],f,g;if(f=s[u])if(delete s[f.end],f.push(c),f.end=h,g=i[h]){delete i[g.start];var p=g===f?f:f.concat(g);i[p.start=f.start]=s[p.end=g.end]=p}else i[f.start]=s[f.end]=f;else if(f=i[h])if(delete i[f.start],f.unshift(c),f.start=u,g=s[u]){delete s[g.end];var _=g===f?f:g.concat(f);i[_.start=g.start]=s[_.end=f.end]=_}else i[f.start]=s[f.end]=f;else f=[c],i[f.start=u]=s[f.end=h]=f});function a(c){var d=n.arcs[c<0?~c:c],u=d[0],h;return n.transform?(h=[0,0],d.forEach(function(f){h[0]+=f[0],h[1]+=f[1]})):h=d[d.length-1],c<0?[h,u]:[u,h]}function l(c,d){for(var u in c){var h=c[u];delete d[h.start],delete h.start,delete h.end,h.forEach(function(f){t[f<0?~f:f]=1}),o.push(h)}}return l(s,i),l(i,s),e.forEach(function(c){t[c<0?~c:c]||o.push([c])}),o}function oJ(n){return uV(n,rJ.apply(this,arguments))}function rJ(n,e,t){var i,s,o;if(arguments.length>1)i=aJ(n,e,t);else for(s=0,i=new Array(o=n.arcs.length);s<o;++s)i[s]=s;return{type:"MultiLineString",arcs:sJ(n,i)}}function aJ(n,e,t){var i=[],s=[],o;function r(u){var h=u<0?~u:u;(s[h]||(s[h]=[])).push({i:u,g:o})}function a(u){u.forEach(r)}function l(u){u.forEach(a)}function c(u){u.forEach(l)}function d(u){switch(o=u,u.type){case"GeometryCollection":u.geometries.forEach(d);break;case"LineString":a(u.arcs);break;case"MultiLineString":case"Polygon":l(u.arcs);break;case"MultiPolygon":c(u.arcs);break}}return d(e),s.forEach(t==null?function(u){i.push(u[0].i)}:function(u){t(u[0].g,u[u.length-1].g)&&i.push(u[0].i)}),i}function S_(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function lJ(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function em(n){let e,t,i;n.length!==2?(e=S_,t=(a,l)=>S_(n(a),l),i=(a,l)=>n(a)-l):(e=n===S_||n===lJ?n:cJ,t=n,i=n);function s(a,l,c=0,d=a.length){if(c<d){if(e(l,l)!==0)return d;do{const u=c+d>>>1;t(a[u],l)<0?c=u+1:d=u}while(c<d)}return c}function o(a,l,c=0,d=a.length){if(c<d){if(e(l,l)!==0)return d;do{const u=c+d>>>1;t(a[u],l)<=0?c=u+1:d=u}while(c<d)}return c}function r(a,l,c=0,d=a.length){const u=s(a,l,c,d-1);return u>c&&i(a[u-1],l)>-i(a[u],l)?u-1:u}return{left:s,center:r,right:o}}function cJ(){return 0}function hV(n){return n===null?NaN:+n}const fV=em(S_),Wd=fV.right;fV.left;em(hV).center;function dJ(n,e){let t,i;if(e===void 0)for(const s of n)s!=null&&(t===void 0?s>=s&&(t=i=s):(t>s&&(t=s),i<s&&(i=s)));else{let s=-1;for(let o of n)(o=e(o,++s,n))!=null&&(t===void 0?o>=o&&(t=i=o):(t>o&&(t=o),i<o&&(i=o)))}return[t,i]}class uc extends Map{constructor(e,t=fJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[i,s]of e)this.set(i,s)}get(e){return super.get(aO(this,e))}has(e){return super.has(aO(this,e))}set(e,t){return super.set(uJ(this,e),t)}delete(e){return super.delete(hJ(this,e))}}function aO({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):t}function uJ({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function hJ({_intern:n,_key:e},t){const i=e(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function fJ(n){return n!==null&&typeof n=="object"?n.valueOf():n}function uA(n){return n}function DL(n,...e){return gV(n,uA,uA,e)}function gJ(n,...e){return gV(n,Array.from,uA,e)}function gV(n,e,t,i){return function s(o,r){if(r>=i.length)return t(o);const a=new uc,l=i[r++];let c=-1;for(const d of o){const u=l(d,++c,o),h=a.get(u);h?h.push(d):a.set(u,[d])}for(const[d,u]of a)a.set(d,s(u,r));return e(a)}(n,0)}const pJ=Math.sqrt(50),mJ=Math.sqrt(10),_J=Math.sqrt(2);function cS(n,e,t){const i=(e-n)/Math.max(0,t),s=Math.floor(Math.log10(i)),o=i/Math.pow(10,s),r=o>=pJ?10:o>=mJ?5:o>=_J?2:1;let a,l,c;return s<0?(c=Math.pow(10,-s)/r,a=Math.round(n*c),l=Math.round(e*c),a/c<n&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,s)*r,a=Math.round(n/c),l=Math.round(e/c),a*c<n&&++a,l*c>e&&--l),l<a&&.5<=t&&t<2?cS(n,e,t*2):[a,l,c]}function dS(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const i=e<n,[s,o,r]=i?cS(e,n,t):cS(n,e,t);if(!(o>=s))return[];const a=o-s+1,l=new Array(a);if(i)if(r<0)for(let c=0;c<a;++c)l[c]=(o-c)/-r;else for(let c=0;c<a;++c)l[c]=(o-c)*r;else if(r<0)for(let c=0;c<a;++c)l[c]=(s+c)/-r;else for(let c=0;c<a;++c)l[c]=(s+c)*r;return l}function hA(n,e,t){return e=+e,n=+n,t=+t,cS(n,e,t)[2]}function Vd(n,e,t){e=+e,n=+n,t=+t;const i=e<n,s=i?hA(e,n,t):hA(n,e,t);return(i?-1:1)*(s<0?1/-s:s)}function pV(n,e,t=hV){if(!(!(i=n.length)||isNaN(e=+e))){if(e<=0||i<2)return+t(n[0],0,n);if(e>=1)return+t(n[i-1],i-1,n);var i,s=(i-1)*e,o=Math.floor(s),r=+t(n[o],o,n),a=+t(n[o+1],o+1,n);return r+(a-r)*(s-o)}}function ab(n,e,t){n=+n,e=+e,t=(s=arguments.length)<2?(e=n,n=0,1):s<3?1:+t;for(var i=-1,s=Math.max(0,Math.ceil((e-n)/t))|0,o=new Array(s);++i<s;)o[i]=n+i*t;return o}function zy(n,e){let t=0;if(e===void 0)for(let i of n)(i=+i)&&(t+=i);else{let i=-1;for(let s of n)(s=+e(s,++i,n))&&(t+=s)}return t}function bJ(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function uS(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function tm(n){return n=uS(Math.abs(n)),n?n[1]:NaN}function vJ(n,e){return function(t,i){for(var s=t.length,o=[],r=0,a=n[0],l=0;s>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(t.substring(s-=a,s+a)),!((l+=a+1)>i));)a=n[r=(r+1)%n.length];return o.reverse().join(e)}}function yJ(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var wJ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zd(n){if(!(e=wJ.exec(n)))throw new Error("invalid format: "+n);var e;return new MM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}zd.prototype=MM.prototype;function MM(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}MM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function CJ(n){e:for(var e=n.length,t=1,i=-1,s;t<e;++t)switch(n[t]){case".":i=s=t;break;case"0":i===0&&(i=t),s=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(s+1):n}var mV;function SJ(n,e){var t=uS(n,e);if(!t)return n+"";var i=t[0],s=t[1],o=s-(mV=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,r=i.length;return o===r?i:o>r?i+new Array(o-r+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+uS(n,Math.max(0,e+o-1))[0]}function lO(n,e){var t=uS(n,e);if(!t)return n+"";var i=t[0],s=t[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}const cO={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:bJ,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>lO(n*100,e),r:lO,s:SJ,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function dO(n){return n}var uO=Array.prototype.map,hO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function xJ(n){var e=n.grouping===void 0||n.thousands===void 0?dO:vJ(uO.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",o=n.numerals===void 0?dO:yJ(uO.call(n.numerals,String)),r=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function c(u){u=zd(u);var h=u.fill,f=u.align,g=u.sign,p=u.symbol,_=u.zero,v=u.width,b=u.comma,y=u.precision,w=u.trim,C=u.type;C==="n"?(b=!0,C="g"):cO[C]||(y===void 0&&(y=12),w=!0,C="g"),(_||h==="0"&&f==="=")&&(_=!0,h="0",f="=");var L=p==="$"?t:p==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",x=p==="$"?i:/[%p]/.test(C)?r:"",D=cO[C],k=/[defgprs%]/.test(C);y=y===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function P(O){var M=L,R=x,$,G,ne;if(C==="c")R=D(O)+R,O="";else{O=+O;var ae=O<0||1/O<0;if(O=isNaN(O)?l:D(Math.abs(O),y),w&&(O=CJ(O)),ae&&+O==0&&g!=="+"&&(ae=!1),M=(ae?g==="("?g:a:g==="-"||g==="("?"":g)+M,R=(C==="s"?hO[8+mV/3]:"")+R+(ae&&g==="("?")":""),k){for($=-1,G=O.length;++$<G;)if(ne=O.charCodeAt($),48>ne||ne>57){R=(ne===46?s+O.slice($+1):O.slice($))+R,O=O.slice(0,$);break}}}b&&!_&&(O=e(O,1/0));var fe=M.length+O.length+R.length,oe=fe<v?new Array(v-fe+1).join(h):"";switch(b&&_&&(O=e(oe+O,oe.length?v-R.length:1/0),oe=""),f){case"<":O=M+O+R+oe;break;case"=":O=M+oe+O+R;break;case"^":O=oe.slice(0,fe=oe.length>>1)+M+O+R+oe.slice(fe);break;default:O=oe+M+O+R;break}return o(O)}return P.toString=function(){return u+""},P}function d(u,h){var f=c((u=zd(u),u.type="f",u)),g=Math.max(-8,Math.min(8,Math.floor(tm(h)/3)))*3,p=Math.pow(10,-g),_=hO[8+g/3];return function(v){return f(p*v)+_}}return{format:c,formatPrefix:d}}var Hy,ls,PM;LJ({thousands:",",grouping:[3],currency:["$",""]});function LJ(n){return Hy=xJ(n),ls=Hy.format,PM=Hy.formatPrefix,Hy}function _V(n){return Math.max(0,-tm(Math.abs(n)))}function bV(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(tm(e)/3)))*3-tm(Math.abs(n)))}function vV(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,tm(e)-tm(n))+1}const Kk=new Date,Yk=new Date;function Wn(n,e,t,i){function s(o){return n(o=arguments.length===0?new Date:new Date(+o)),o}return s.floor=o=>(n(o=new Date(+o)),o),s.ceil=o=>(n(o=new Date(o-1)),e(o,1),n(o),o),s.round=o=>{const r=s(o),a=s.ceil(o);return o-r<a-o?r:a},s.offset=(o,r)=>(e(o=new Date(+o),r==null?1:Math.floor(r)),o),s.range=(o,r,a)=>{const l=[];if(o=s.ceil(o),a=a==null?1:Math.floor(a),!(o<r)||!(a>0))return l;let c;do l.push(c=new Date(+o)),e(o,a),n(o);while(c<o&&o<r);return l},s.filter=o=>Wn(r=>{if(r>=r)for(;n(r),!o(r);)r.setTime(r-1)},(r,a)=>{if(r>=r)if(a<0)for(;++a<=0;)for(;e(r,-1),!o(r););else for(;--a>=0;)for(;e(r,1),!o(r););}),t&&(s.count=(o,r)=>(Kk.setTime(+o),Yk.setTime(+r),n(Kk),n(Yk),Math.floor(t(Kk,Yk))),s.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?s.filter(i?r=>i(r)%o===0:r=>s.count(0,r)%o===0):s)),s}const im=Wn(()=>{},(n,e)=>{n.setTime(+n+e)},(n,e)=>e-n);im.every=n=>(n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?Wn(e=>{e.setTime(Math.floor(e/n)*n)},(e,t)=>{e.setTime(+e+t*n)},(e,t)=>(t-e)/n):im);im.range;const Ul=1e3,sr=Ul*60,jl=sr*60,hc=jl*24,OM=hc*7,fO=hc*30,Zk=hc*365,ql=Wn(n=>{n.setTime(n-n.getMilliseconds())},(n,e)=>{n.setTime(+n+e*Ul)},(n,e)=>(e-n)/Ul,n=>n.getUTCSeconds());ql.range;const kL=Wn(n=>{n.setTime(n-n.getMilliseconds()-n.getSeconds()*Ul)},(n,e)=>{n.setTime(+n+e*sr)},(n,e)=>(e-n)/sr,n=>n.getMinutes());kL.range;const EL=Wn(n=>{n.setUTCSeconds(0,0)},(n,e)=>{n.setTime(+n+e*sr)},(n,e)=>(e-n)/sr,n=>n.getUTCMinutes());EL.range;const AL=Wn(n=>{n.setTime(n-n.getMilliseconds()-n.getSeconds()*Ul-n.getMinutes()*sr)},(n,e)=>{n.setTime(+n+e*jl)},(n,e)=>(e-n)/jl,n=>n.getHours());AL.range;const IL=Wn(n=>{n.setUTCMinutes(0,0,0)},(n,e)=>{n.setTime(+n+e*jl)},(n,e)=>(e-n)/jl,n=>n.getUTCHours());IL.range;const yd=Wn(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*sr)/hc,n=>n.getDate()-1);yd.range;const Bh=Wn(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/hc,n=>n.getUTCDate()-1);Bh.range;const yV=Wn(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/hc,n=>Math.floor(n/hc));yV.range;function Ef(n){return Wn(e=>{e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sr)/OM)}const D1=Ef(0),hS=Ef(1),DJ=Ef(2),kJ=Ef(3),nm=Ef(4),EJ=Ef(5),AJ=Ef(6);D1.range;hS.range;DJ.range;kJ.range;nm.range;EJ.range;AJ.range;function Af(n){return Wn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/OM)}const k1=Af(0),fS=Af(1),IJ=Af(2),TJ=Af(3),sm=Af(4),NJ=Af(5),RJ=Af(6);k1.range;fS.range;IJ.range;TJ.range;sm.range;NJ.range;RJ.range;const lb=Wn(n=>{n.setDate(1),n.setHours(0,0,0,0)},(n,e)=>{n.setMonth(n.getMonth()+e)},(n,e)=>e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12,n=>n.getMonth());lb.range;const cb=Wn(n=>{n.setUTCDate(1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCMonth(n.getUTCMonth()+e)},(n,e)=>e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12,n=>n.getUTCMonth());cb.range;const Ka=Wn(n=>{n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e)},(n,e)=>e.getFullYear()-n.getFullYear(),n=>n.getFullYear());Ka.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:Wn(e=>{e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*n)});Ka.range;const Ya=Wn(n=>{n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e)},(n,e)=>e.getUTCFullYear()-n.getUTCFullYear(),n=>n.getUTCFullYear());Ya.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:Wn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*n)});Ya.range;function wV(n,e,t,i,s,o){const r=[[ql,1,Ul],[ql,5,5*Ul],[ql,15,15*Ul],[ql,30,30*Ul],[o,1,sr],[o,5,5*sr],[o,15,15*sr],[o,30,30*sr],[s,1,jl],[s,3,3*jl],[s,6,6*jl],[s,12,12*jl],[i,1,hc],[i,2,2*hc],[t,1,OM],[e,1,fO],[e,3,3*fO],[n,1,Zk]];function a(c,d,u){const h=d<c;h&&([c,d]=[d,c]);const f=u&&typeof u.range=="function"?u:l(c,d,u),g=f?f.range(c,+d+1):[];return h?g.reverse():g}function l(c,d,u){const h=Math.abs(d-c)/u,f=em(([,,_])=>_).right(r,h);if(f===r.length)return n.every(Vd(c/Zk,d/Zk,u));if(f===0)return im.every(Math.max(Vd(c,d,u),1));const[g,p]=r[h/r[f-1][2]<r[f][2]/h?f-1:f];return g.every(p)}return[a,l]}const[MJ,PJ]=wV(Ya,cb,k1,yV,IL,EL),[OJ,FJ]=wV(Ka,lb,D1,yd,AL,kL),db="year",ub="quarter",hb="month",fb="week",gb="date",TL="day",FM="dayofyear",pb="hours",mb="minutes",_b="seconds",NL="milliseconds",BJ=[db,ub,hb,fb,gb,TL,FM,pb,mb,_b,NL];BJ.reduce((n,e,t)=>(n[e]=1+t,n),{});const WJ={[db]:Ka,[ub]:lb.every(3),[hb]:lb,[fb]:D1,[gb]:yd,[TL]:yd,[FM]:yd,[pb]:AL,[mb]:kL,[_b]:ql,[NL]:im},VJ={[db]:Ya,[ub]:cb.every(3),[hb]:cb,[fb]:k1,[gb]:Bh,[TL]:Bh,[FM]:Bh,[pb]:IL,[mb]:EL,[_b]:ql,[NL]:im};function zJ(n){return WJ[n]}function HJ(n){return VJ[n]}function Xk(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function Qk(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function g0(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function CV(n){var e=n.dateTime,t=n.date,i=n.time,s=n.periods,o=n.days,r=n.shortDays,a=n.months,l=n.shortMonths,c=p0(s),d=m0(s),u=p0(o),h=m0(o),f=p0(r),g=m0(r),p=p0(a),_=m0(a),v=p0(l),b=m0(l),y={a:ae,A:fe,b:oe,B:xe,c:null,d:vO,e:vO,f:uee,g:wee,G:See,H:lee,I:cee,j:dee,L:SV,m:hee,M:fee,p:Te,q:me,Q:CO,s:SO,S:gee,u:pee,U:mee,V:_ee,w:bee,W:vee,x:null,X:null,y:yee,Y:Cee,Z:xee,"%":wO},w={a:te,A:Yt,b:Lt,B:Tt,c:null,d:yO,e:yO,f:Eee,g:Bee,G:Vee,H:Lee,I:Dee,j:kee,L:LV,m:Aee,M:Iee,p:Ge,q:ii,Q:CO,s:SO,S:Tee,u:Nee,U:Ree,V:Mee,w:Pee,W:Oee,x:null,X:null,y:Fee,Y:Wee,Z:zee,"%":wO},C={a:P,A:O,b:M,B:R,c:$,d:_O,e:_O,f:see,g:mO,G:pO,H:bO,I:bO,j:eee,L:nee,m:JJ,M:tee,p:k,q:QJ,Q:ree,s:aee,S:iee,u:GJ,U:KJ,V:YJ,w:qJ,W:ZJ,x:G,X:ne,y:mO,Y:pO,Z:XJ,"%":oee};y.x=L(t,y),y.X=L(i,y),y.c=L(e,y),w.x=L(t,w),w.X=L(i,w),w.c=L(e,w);function L(Ee,Ve){return function(ge){var he=[],ki=-1,Dt=0,It=Ee.length,vi,Xo,Nu;for(ge instanceof Date||(ge=new Date(+ge));++ki<It;)Ee.charCodeAt(ki)===37&&(he.push(Ee.slice(Dt,ki)),(Xo=gO[vi=Ee.charAt(++ki)])!=null?vi=Ee.charAt(++ki):Xo=vi==="e"?" ":"0",(Nu=Ve[vi])&&(vi=Nu(ge,Xo)),he.push(vi),Dt=ki+1);return he.push(Ee.slice(Dt,ki)),he.join("")}}function x(Ee,Ve){return function(ge){var he=g0(1900,void 0,1),ki=D(he,Ee,ge+="",0),Dt,It;if(ki!=ge.length)return null;if("Q"in he)return new Date(he.Q);if("s"in he)return new Date(he.s*1e3+("L"in he?he.L:0));if(Ve&&!("Z"in he)&&(he.Z=0),"p"in he&&(he.H=he.H%12+he.p*12),he.m===void 0&&(he.m="q"in he?he.q:0),"V"in he){if(he.V<1||he.V>53)return null;"w"in he||(he.w=1),"Z"in he?(Dt=Qk(g0(he.y,0,1)),It=Dt.getUTCDay(),Dt=It>4||It===0?fS.ceil(Dt):fS(Dt),Dt=Bh.offset(Dt,(he.V-1)*7),he.y=Dt.getUTCFullYear(),he.m=Dt.getUTCMonth(),he.d=Dt.getUTCDate()+(he.w+6)%7):(Dt=Xk(g0(he.y,0,1)),It=Dt.getDay(),Dt=It>4||It===0?hS.ceil(Dt):hS(Dt),Dt=yd.offset(Dt,(he.V-1)*7),he.y=Dt.getFullYear(),he.m=Dt.getMonth(),he.d=Dt.getDate()+(he.w+6)%7)}else("W"in he||"U"in he)&&("w"in he||(he.w="u"in he?he.u%7:"W"in he?1:0),It="Z"in he?Qk(g0(he.y,0,1)).getUTCDay():Xk(g0(he.y,0,1)).getDay(),he.m=0,he.d="W"in he?(he.w+6)%7+he.W*7-(It+5)%7:he.w+he.U*7-(It+6)%7);return"Z"in he?(he.H+=he.Z/100|0,he.M+=he.Z%100,Qk(he)):Xk(he)}}function D(Ee,Ve,ge,he){for(var ki=0,Dt=Ve.length,It=ge.length,vi,Xo;ki<Dt;){if(he>=It)return-1;if(vi=Ve.charCodeAt(ki++),vi===37){if(vi=Ve.charAt(ki++),Xo=C[vi in gO?Ve.charAt(ki++):vi],!Xo||(he=Xo(Ee,ge,he))<0)return-1}else if(vi!=ge.charCodeAt(he++))return-1}return he}function k(Ee,Ve,ge){var he=c.exec(Ve.slice(ge));return he?(Ee.p=d.get(he[0].toLowerCase()),ge+he[0].length):-1}function P(Ee,Ve,ge){var he=f.exec(Ve.slice(ge));return he?(Ee.w=g.get(he[0].toLowerCase()),ge+he[0].length):-1}function O(Ee,Ve,ge){var he=u.exec(Ve.slice(ge));return he?(Ee.w=h.get(he[0].toLowerCase()),ge+he[0].length):-1}function M(Ee,Ve,ge){var he=v.exec(Ve.slice(ge));return he?(Ee.m=b.get(he[0].toLowerCase()),ge+he[0].length):-1}function R(Ee,Ve,ge){var he=p.exec(Ve.slice(ge));return he?(Ee.m=_.get(he[0].toLowerCase()),ge+he[0].length):-1}function $(Ee,Ve,ge){return D(Ee,e,Ve,ge)}function G(Ee,Ve,ge){return D(Ee,t,Ve,ge)}function ne(Ee,Ve,ge){return D(Ee,i,Ve,ge)}function ae(Ee){return r[Ee.getDay()]}function fe(Ee){return o[Ee.getDay()]}function oe(Ee){return l[Ee.getMonth()]}function xe(Ee){return a[Ee.getMonth()]}function Te(Ee){return s[+(Ee.getHours()>=12)]}function me(Ee){return 1+~~(Ee.getMonth()/3)}function te(Ee){return r[Ee.getUTCDay()]}function Yt(Ee){return o[Ee.getUTCDay()]}function Lt(Ee){return l[Ee.getUTCMonth()]}function Tt(Ee){return a[Ee.getUTCMonth()]}function Ge(Ee){return s[+(Ee.getUTCHours()>=12)]}function ii(Ee){return 1+~~(Ee.getUTCMonth()/3)}return{format:function(Ee){var Ve=L(Ee+="",y);return Ve.toString=function(){return Ee},Ve},parse:function(Ee){var Ve=x(Ee+="",!1);return Ve.toString=function(){return Ee},Ve},utcFormat:function(Ee){var Ve=L(Ee+="",w);return Ve.toString=function(){return Ee},Ve},utcParse:function(Ee){var Ve=x(Ee+="",!0);return Ve.toString=function(){return Ee},Ve}}}var gO={"-":"",_:" ",0:"0"},Qn=/^\s*\d+/,$J=/^%/,UJ=/[\\^$*+?|[\]().{}]/g;function Gt(n,e,t){var i=n<0?"-":"",s=(i?-n:n)+"",o=s.length;return i+(o<t?new Array(t-o+1).join(e)+s:s)}function jJ(n){return n.replace(UJ,"\\$&")}function p0(n){return new RegExp("^(?:"+n.map(jJ).join("|")+")","i")}function m0(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function qJ(n,e,t){var i=Qn.exec(e.slice(t,t+1));return i?(n.w=+i[0],t+i[0].length):-1}function GJ(n,e,t){var i=Qn.exec(e.slice(t,t+1));return i?(n.u=+i[0],t+i[0].length):-1}function KJ(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.U=+i[0],t+i[0].length):-1}function YJ(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.V=+i[0],t+i[0].length):-1}function ZJ(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.W=+i[0],t+i[0].length):-1}function pO(n,e,t){var i=Qn.exec(e.slice(t,t+4));return i?(n.y=+i[0],t+i[0].length):-1}function mO(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function XJ(n,e,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return i?(n.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function QJ(n,e,t){var i=Qn.exec(e.slice(t,t+1));return i?(n.q=i[0]*3-3,t+i[0].length):-1}function JJ(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.m=i[0]-1,t+i[0].length):-1}function _O(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.d=+i[0],t+i[0].length):-1}function eee(n,e,t){var i=Qn.exec(e.slice(t,t+3));return i?(n.m=0,n.d=+i[0],t+i[0].length):-1}function bO(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.H=+i[0],t+i[0].length):-1}function tee(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.M=+i[0],t+i[0].length):-1}function iee(n,e,t){var i=Qn.exec(e.slice(t,t+2));return i?(n.S=+i[0],t+i[0].length):-1}function nee(n,e,t){var i=Qn.exec(e.slice(t,t+3));return i?(n.L=+i[0],t+i[0].length):-1}function see(n,e,t){var i=Qn.exec(e.slice(t,t+6));return i?(n.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function oee(n,e,t){var i=$J.exec(e.slice(t,t+1));return i?t+i[0].length:-1}function ree(n,e,t){var i=Qn.exec(e.slice(t));return i?(n.Q=+i[0],t+i[0].length):-1}function aee(n,e,t){var i=Qn.exec(e.slice(t));return i?(n.s=+i[0],t+i[0].length):-1}function vO(n,e){return Gt(n.getDate(),e,2)}function lee(n,e){return Gt(n.getHours(),e,2)}function cee(n,e){return Gt(n.getHours()%12||12,e,2)}function dee(n,e){return Gt(1+yd.count(Ka(n),n),e,3)}function SV(n,e){return Gt(n.getMilliseconds(),e,3)}function uee(n,e){return SV(n,e)+"000"}function hee(n,e){return Gt(n.getMonth()+1,e,2)}function fee(n,e){return Gt(n.getMinutes(),e,2)}function gee(n,e){return Gt(n.getSeconds(),e,2)}function pee(n){var e=n.getDay();return e===0?7:e}function mee(n,e){return Gt(D1.count(Ka(n)-1,n),e,2)}function xV(n){var e=n.getDay();return e>=4||e===0?nm(n):nm.ceil(n)}function _ee(n,e){return n=xV(n),Gt(nm.count(Ka(n),n)+(Ka(n).getDay()===4),e,2)}function bee(n){return n.getDay()}function vee(n,e){return Gt(hS.count(Ka(n)-1,n),e,2)}function yee(n,e){return Gt(n.getFullYear()%100,e,2)}function wee(n,e){return n=xV(n),Gt(n.getFullYear()%100,e,2)}function Cee(n,e){return Gt(n.getFullYear()%1e4,e,4)}function See(n,e){var t=n.getDay();return n=t>=4||t===0?nm(n):nm.ceil(n),Gt(n.getFullYear()%1e4,e,4)}function xee(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Gt(e/60|0,"0",2)+Gt(e%60,"0",2)}function yO(n,e){return Gt(n.getUTCDate(),e,2)}function Lee(n,e){return Gt(n.getUTCHours(),e,2)}function Dee(n,e){return Gt(n.getUTCHours()%12||12,e,2)}function kee(n,e){return Gt(1+Bh.count(Ya(n),n),e,3)}function LV(n,e){return Gt(n.getUTCMilliseconds(),e,3)}function Eee(n,e){return LV(n,e)+"000"}function Aee(n,e){return Gt(n.getUTCMonth()+1,e,2)}function Iee(n,e){return Gt(n.getUTCMinutes(),e,2)}function Tee(n,e){return Gt(n.getUTCSeconds(),e,2)}function Nee(n){var e=n.getUTCDay();return e===0?7:e}function Ree(n,e){return Gt(k1.count(Ya(n)-1,n),e,2)}function DV(n){var e=n.getUTCDay();return e>=4||e===0?sm(n):sm.ceil(n)}function Mee(n,e){return n=DV(n),Gt(sm.count(Ya(n),n)+(Ya(n).getUTCDay()===4),e,2)}function Pee(n){return n.getUTCDay()}function Oee(n,e){return Gt(fS.count(Ya(n)-1,n),e,2)}function Fee(n,e){return Gt(n.getUTCFullYear()%100,e,2)}function Bee(n,e){return n=DV(n),Gt(n.getUTCFullYear()%100,e,2)}function Wee(n,e){return Gt(n.getUTCFullYear()%1e4,e,4)}function Vee(n,e){var t=n.getUTCDay();return n=t>=4||t===0?sm(n):sm.ceil(n),Gt(n.getUTCFullYear()%1e4,e,4)}function zee(){return"+0000"}function wO(){return"%"}function CO(n){return+n}function SO(n){return Math.floor(+n/1e3)}var ig,BM,kV,WM,EV;Hee({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Hee(n){return ig=CV(n),BM=ig.format,kV=ig.parse,WM=ig.utcFormat,EV=ig.utcParse,ig}function G0(n){const e={};return t=>e[t]||(e[t]=n(t))}function $ee(n,e){return t=>{const i=n(t),s=i.indexOf(e);if(s<0)return i;let o=Uee(i,s);const r=o<i.length?i.slice(o):"";for(;--o>s;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+r}}function Uee(n,e){let t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}function jee(n){const e=G0(n.format),t=n.formatPrefix;return{format:e,formatPrefix:t,formatFloat(i){const s=zd(i||",");if(s.precision==null){switch(s.precision=12,s.type){case"%":s.precision-=2;break;case"e":s.precision-=1;break}return $ee(e(s),e(".1f")(1)[1])}else return e(s)},formatSpan(i,s,o,r){r=zd(r??",f");const a=Vd(i,s,o),l=Math.max(Math.abs(i),Math.abs(s));let c;if(r.precision==null)switch(r.type){case"s":return isNaN(c=bV(a,l))||(r.precision=c),t(r,l);case"":case"e":case"g":case"p":case"r":{isNaN(c=vV(a,l))||(r.precision=c-(r.type==="e"));break}case"f":case"%":{isNaN(c=_V(a))||(r.precision=c-(r.type==="%")*2);break}}return e(r)}}}qee();function qee(){return jee({format:ls,formatPrefix:PM})}function xO(n,e,t){t=t||{},Ms(t)||Tn(`Invalid time multi-format specifier: ${t}`);const i=e(_b),s=e(mb),o=e(pb),r=e(gb),a=e(fb),l=e(hb),c=e(ub),d=e(db),u=n(t[NL]||".%L"),h=n(t[_b]||":%S"),f=n(t[mb]||"%I:%M"),g=n(t[pb]||"%I %p"),p=n(t[gb]||t[TL]||"%a %d"),_=n(t[fb]||"%b %d"),v=n(t[hb]||"%B"),b=n(t[ub]||"%B"),y=n(t[db]||"%Y");return w=>(i(w)<w?u:s(w)<w?h:o(w)<w?f:r(w)<w?g:l(w)<w?a(w)<w?p:_:d(w)<w?c(w)<w?v:b:y)(w)}function AV(n){const e=G0(n.format),t=G0(n.utcFormat);return{timeFormat:i=>ci(i)?e(i):xO(e,zJ,i),utcFormat:i=>ci(i)?t(i):xO(t,HJ,i),timeParse:G0(n.parse),utcParse:G0(n.utcParse)}}let fA;Gee();function Gee(){return fA=AV({format:BM,parse:kV,utcFormat:WM,utcParse:EV})}function Kee(n){return AV(CV(n))}function Yee(n){return arguments.length?fA=Kee(n):fA}const Zee=n=>n!=null&&n===n,Xee=n=>n==="true"||n==="false"||n===!0||n===!1,Qee=n=>!Number.isNaN(Date.parse(n)),IV=n=>!Number.isNaN(+n)&&!(n instanceof Date),Jee=n=>IV(n)&&Number.isInteger(+n),LO={boolean:jQ,integer:rb,number:rb,date:GQ,string:KQ,unknown:xL},$y=[Xee,Jee,IV,Qee],ete=["boolean","integer","number","date"];function tte(n,e){if(!n||!n.length)return"unknown";const t=n.length,i=$y.length,s=$y.map((o,r)=>r+1);for(let o=0,r=0,a,l;o<t;++o)for(l=e?n[o][e]:n[o],a=0;a<i;++a)if(s[a]&&Zee(l)&&!$y[a](l)&&(s[a]=0,++r,r===$y.length))return"string";return ete[s.reduce((o,r)=>o===0?r:o,0)-1]}function ite(n,e){return e.reduce((t,i)=>(t[i]=tte(n,i),t),{})}function DO(n){const e=function(t,i){const s={delimiter:n};return VM(t,i?VQ(i,s):s)};return e.responseType="text",e}function VM(n,e){return e.header&&(n=e.header.map(RM).join(e.delimiter)+`
`+n),dV(e.delimiter).parse(n+"")}VM.responseType="text";function nte(n){return typeof Buffer=="function"&&dr(Buffer.isBuffer)?Buffer.isBuffer(n):!1}function zM(n,e){const t=e&&e.property?SL(e.property):xL;return Ms(n)&&!nte(n)?ste(t(n),e):t(JSON.parse(n))}zM.responseType="json";function ste(n,e){return!Rs(n)&&$Q(n)&&(n=[...n]),e&&e.copy?JSON.parse(JSON.stringify(n)):n}const ote={interior:(n,e)=>n!==e,exterior:(n,e)=>n===e};function TV(n,e){let t,i,s,o;return n=zM(n,e),e&&e.feature?(t=nJ,s=e.feature):e&&e.mesh?(t=oJ,s=e.mesh,o=ote[e.filter]):Tn("Missing TopoJSON feature or mesh parameter."),i=(i=n.objects[s])?t(n,i,o):Tn("Invalid TopoJSON object: "+s),i&&i.features||[i]}TV.responseType="json";const Jk={dsv:VM,csv:DO(","),tsv:DO("	"),json:zM,topojson:TV};function NV(n,e){return arguments.length>1?(Jk[n]=e,this):Ig(Jk,n)?Jk[n]:null}function HM(n,e,t,i){e=e||{};const s=NV(e.type||"json");return s||Tn("Unknown data format type: "+e.type),n=s(n,e),e.parse&&rte(n,e.parse,t,i),Ig(n,"columns")&&delete n.columns,n}function rte(n,e,t,i){if(!n.length)return;const s=Yee();t=t||s.timeParse,i=i||s.utcParse;let o=n.columns||Object.keys(n[0]),r,a,l,c,d,u;e==="auto"&&(e=ite(n,o)),o=Object.keys(e);const h=o.map(f=>{const g=e[f];let p,_;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),_=p[1],(_[0]==="'"&&_[_.length-1]==="'"||_[0]==='"'&&_[_.length-1]==='"')&&(_=_.slice(1,-1)),(p[0]==="utc"?i:t)(_);if(!LO[g])throw Error("Illegal format pattern: "+f+":"+g);return LO[g]});for(l=0,d=n.length,u=o.length;l<d;++l)for(r=n[l],c=0;c<u;++c)a=o[c],r[a]=h[c](r[a])}/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const RV="important",ate=" !"+RV,lte=LW(class extends DW{constructor(n){var e;if(super(n),n.type!==xW.ATTRIBUTE||n.name!=="style"||((e=n.strings)==null?void 0:e.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(n){return Object.keys(n).reduce((e,t)=>{const i=n[t];return i==null?e:e+`${t=t.includes("-")?t:t.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`},"")}update(n,[e]){const{style:t}=n.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const i of this.ft)e[i]==null&&(this.ft.delete(i),i.includes("-")?t.removeProperty(i):t[i]=null);for(const i in e){const s=e[i];if(s!=null){this.ft.add(i);const o=typeof s=="string"&&s.endsWith(ate);i.includes("-")||o?t.setProperty(i,o?s.slice(0,-11):s,o?RV:""):t[i]=s}}return nf}}),cte="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cstyle%3e.spinner_ajPY{transform-origin:center;animation:spinner_AtaB%20.75s%20infinite%20linear}@keyframes%20spinner_AtaB{100%25{transform:rotate(360deg)}}%3c/style%3e%3cpath%20d='M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z'%20opacity='.25'/%3e%3cpath%20d='M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z'%20class='spinner_ajPY'/%3e%3c/svg%3e",dte=`
.genome-spy {
  font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  position: relative;
  display: flex;
  flex-direction: column;
}
.genome-spy .canvas-wrapper {
  position: relative;
  flex-grow: 1;
  overflow: hidden;
}
.genome-spy canvas {
  display: block;
  transform: scale(1, 1);
  opacity: 1;
  transition: transform 0.6s, opacity 0.6s;
}
.genome-spy .loading-message {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}
.genome-spy .loading-message .message {
  color: #666;
  opacity: 0;
  transition: opacity 0.7s;
}
.genome-spy .loading > canvas {
  transform: scale(0.95, 0.95);
  opacity: 0;
}
.genome-spy .loading > .loading-message .message {
  opacity: 1;
}
.genome-spy .loading > .loading-message .message .ellipsis {
  animation: blinker 1s linear infinite;
}
@keyframes blinker {
  50% {
    opacity: 0;
  }
}
.genome-spy .loading-indicators {
  position: absolute;
  inset: 0;
  user-select: none;
  pointer-events: none;
}
.genome-spy .loading-indicators div {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
}
.genome-spy .loading-indicators div > div {
  font-size: 11px;
  transition: opacity 0.2s;
  background: white;
  padding: 2px 5px;
  display: flex;
  border-radius: 3px;
  gap: 0.5em;
  opacity: 0;
}
.genome-spy .loading-indicators div > div.loading {
  opacity: 0.5;
}
.genome-spy .loading-indicators div > div.error {
  opacity: 0.8;
  color: firebrick;
}
.genome-spy .loading-indicators div > div > * {
  display: block;
}
.genome-spy .loading-indicators div > div img {
  width: 1.5em;
  height: 1.5em;
}
.genome-spy .tooltip {
  position: absolute;
  max-width: 450px;
  overflow: hidden;
  background: #f6f6f6;
  padding: 10px;
  font-size: 13px;
  box-shadow: 0px 3px 15px 0px rgba(0, 0, 0, 0.21);
  pointer-events: none;
  z-index: 100;
}
.genome-spy .tooltip > :last-child {
  margin-bottom: 0;
}
.genome-spy .tooltip > .title {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px dashed #b6b6b6;
}
.genome-spy .tooltip .summary {
  font-size: 12px;
}
.genome-spy .tooltip table {
  border-collapse: collapse;
}
.genome-spy .tooltip table:first-child {
  margin-top: 0;
}
.genome-spy .tooltip table th,
.genome-spy .tooltip table td {
  padding: 2px 0.4em;
  vertical-align: top;
}
.genome-spy .tooltip table th:first-child,
.genome-spy .tooltip table td:first-child {
  padding-left: 0;
}
.genome-spy .tooltip table th {
  text-align: left;
  font-weight: bold;
}
.genome-spy .tooltip .color-legend {
  display: inline-block;
  width: 0.8em;
  height: 0.8em;
  margin-left: 0.4em;
  box-shadow: 0px 0px 3px 1px white;
}
.genome-spy .tooltip .attributes .hovered {
  background-color: #e0e0e0;
}
.genome-spy .tooltip .na {
  color: #aaa;
  font-style: italic;
  font-size: 80%;
}
.genome-spy .gene-track-tooltip .summary {
  font-size: 90%;
}
.genome-spy .message-box {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
}
.genome-spy .message-box > div {
  border: 1px solid red;
  padding: 10px;
  background: #fff0f0;
}

.gs-input-binding {
  display: grid;
  grid-template-columns: max-content max-content;
  column-gap: 1em;
  row-gap: 0.3em;
  justify-items: start;
}
.gs-input-binding > select,
.gs-input-binding > input:not([type=checkbox]) {
  width: 100%;
}
.gs-input-binding input[type=range] + span {
  display: inline-block;
  margin-left: 0.3em;
  min-width: 2.2em;
  font-variant-numeric: tabular-nums;
}
.gs-input-binding input[type=range],
.gs-input-binding input[type=radio] {
  vertical-align: text-bottom;
}
.gs-input-binding .radio-group {
  display: flex;
  align-items: center;
}
.gs-input-binding .description {
  max-width: 26em;
  grid-column: 1/-1;
  color: #777;
  font-size: 90%;
  margin-top: -0.5em;
}

.gs-input-bindings {
  flex-basis: content;
  font-size: 14px;
  padding: 10px;
}
`;function ute(n,e){var t=n.getBoundingClientRect();return[e.clientX-t.left-n.clientLeft,e.clientY-t.top-n.clientTop]}function gA(n,e){return n.length==e.length&&n.every((t,i)=>n[i]===e[i])}function Ks(n){return Array.isArray(n)?n:typeof n<"u"?[n]:[]}function E1(n){return n[n.length-1]}class hte{constructor(e){this.container=e,this.element=document.createElement("div"),this.element.className="tooltip",this._visible=!0,this.container.appendChild(this.element),this._previousTooltipDatum=void 0,this.enabledStack=[!0],this._penaltyUntil=0,this._lastCoords=void 0,this._previousMove=0,this.clear()}set visible(e){e!=this._visible&&(this.element.style.display=e?null:"none",this._visible=e)}get visible(){return this._visible}get enabled(){return E1(this.enabledStack)??!0}pushEnabledState(e){this.enabledStack.push(e),e||(this.visible=!1)}popEnabledState(){this.enabledStack.pop()}handleMouseMove(e){this.mouseCoords=ute(this.container,e);const t=performance.now();!this.visible&&!this._isPenalty()&&t-this._previousMove>500&&(this._penaltyUntil=t+70),this._lastCoords&&fte(this.mouseCoords,this._lastCoords)>20&&(this._penaltyUntil=t+400),this._lastCoords=this.mouseCoords,this.visible&&this.updatePlacement(),this._previousMove=t}updatePlacement(){const[t,i]=this.mouseCoords;let s=t+20;s>this.container.clientWidth-this.element.offsetWidth&&(s=t-20-this.element.offsetWidth),this.element.style.left=s+"px",this.element.style.top=Math.min(i+20,this.container.clientHeight-this.element.offsetHeight)+"px"}setContent(e){if(!e||!this.enabled||this._isPenalty()){this.visible&&(Qp("",this.element),this.visible=!1),this._previousTooltipDatum=void 0;return}Qp(e,this.element),this.visible=!0,this.updatePlacement()}clear(){this._previousTooltipDatum=void 0,this.setContent(void 0)}updateWithDatum(e,t){e!==this._previousTooltipDatum&&(this._previousTooltipDatum=e,t||(t=i=>Promise.resolve(At` ${JSON.stringify(i)} `)),t(e).then(i=>this.setContent(i)).catch(i=>{if(i!=="debounced")throw i}))}_isPenalty(){return this._penaltyUntil&&this._penaltyUntil>performance.now()}}function fte(n,e){let t=0;for(let i=0;i<n.length;i++)t+=(n[i]-e[i])**2;return Math.sqrt(t)}/* @license twgl.js 4.22.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const $M=5120,bb=5121,UM=5122,jM=5123,qM=5124,GM=5125,KM=5126,gte=32819,pte=32820,mte=33635,_te=5131,bte=33640,vte=35899,yte=35902,wte=36269,Cte=34042,MV={};{const n=MV;n[$M]=Int8Array,n[bb]=Uint8Array,n[UM]=Int16Array,n[jM]=Uint16Array,n[qM]=Int32Array,n[GM]=Uint32Array,n[KM]=Float32Array,n[gte]=Uint16Array,n[pte]=Uint16Array,n[mte]=Uint16Array,n[_te]=Uint16Array,n[bte]=Uint32Array,n[vte]=Uint32Array,n[yte]=Uint32Array,n[wte]=Uint32Array,n[Cte]=Uint32Array}function YM(n){if(n instanceof Int8Array)return $M;if(n instanceof Uint8Array||n instanceof Uint8ClampedArray)return bb;if(n instanceof Int16Array)return UM;if(n instanceof Uint16Array)return jM;if(n instanceof Int32Array)return qM;if(n instanceof Uint32Array)return GM;if(n instanceof Float32Array)return KM;throw new Error("unsupported typed array type")}function Ste(n){if(n===Int8Array)return $M;if(n===Uint8Array||n===Uint8ClampedArray)return bb;if(n===Int16Array)return UM;if(n===Uint16Array)return jM;if(n===Int32Array)return qM;if(n===Uint32Array)return GM;if(n===Float32Array)return KM;throw new Error("unsupported typed array type")}function xte(n){const e=MV[n];if(!e)throw new Error("unknown gl type");return e}const gS=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function Lte(...n){console.error(...n)}function PV(...n){console.warn(...n)}function Dte(n,e){return typeof WebGLBuffer<"u"&&e instanceof WebGLBuffer}function OV(n,e){return typeof WebGLRenderbuffer<"u"&&e instanceof WebGLRenderbuffer}function RL(n,e){return typeof WebGLTexture<"u"&&e instanceof WebGLTexture}function kte(n,e){return typeof WebGLSampler<"u"&&e instanceof WebGLSampler}const FV=35044,Ha=34962,Ete=34963,Ate=34660,Ite=5120,Tte=5121,Nte=5122,Rte=5123,Mte=5124,Pte=5125,Ote=5126,BV={attribPrefix:""};function WV(n,e,t,i,s){n.bindBuffer(e,t),n.bufferData(e,i,s||FV)}function VV(n,e,t,i){if(Dte(n,e))return e;t=t||Ha;const s=n.createBuffer();return WV(n,t,s,e,i),s}function zV(n){return n==="indices"}function Fte(n){return n instanceof Int8Array||n instanceof Uint8Array}function Bte(n){return n===Int8Array||n===Uint8Array}function Wte(n){return n.length?n:n.data}const Vte=/coord|texture/i,zte=/color|colour/i;function HV(n,e){let t;if(Vte.test(n)?t=2:zte.test(n)?t=4:t=3,e%t>0)throw new Error(`Can not guess numComponents for attribute '${n}'. Tried ${t} but ${e} values is not evenly divisible by ${t}. You should specify it.`);return t}function Hte(n,e){return n.numComponents||n.size||HV(e,Wte(n).length)}function ZM(n,e){if(gS(n))return n;if(gS(n.data))return n.data;Array.isArray(n)&&(n={data:n});let t=n.type;return t||(zV(e)?t=Uint16Array:t=Float32Array),new t(n.data)}function $te(n,e){const t={};return Object.keys(e).forEach(function(i){if(!zV(i)){const s=e[i],o=s.attrib||s.name||s.attribName||BV.attribPrefix+i;if(s.value){if(!Array.isArray(s.value)&&!gS(s.value))throw new Error("array.value is not array or typedarray");t[o]={value:s.value}}else{let r,a,l,c;if(s.buffer&&s.buffer instanceof WebGLBuffer)r=s.buffer,c=s.numComponents||s.size,a=s.type,l=s.normalize;else if(typeof s=="number"||typeof s.data=="number"){const d=s.data||s,u=s.type||Float32Array,h=d*u.BYTES_PER_ELEMENT;a=Ste(u),l=s.normalize!==void 0?s.normalize:Bte(u),c=s.numComponents||s.size||HV(i,d),r=n.createBuffer(),n.bindBuffer(Ha,r),n.bufferData(Ha,h,s.drawType||FV)}else{const d=ZM(s,i);r=VV(n,d,void 0,s.drawType),a=YM(d),l=s.normalize!==void 0?s.normalize:Fte(d),c=Hte(s,i)}t[o]={buffer:r,numComponents:c,type:a,normalize:l,stride:s.stride||0,offset:s.offset||0,divisor:s.divisor===void 0?void 0:s.divisor,drawType:s.drawType}}}}),n.bindBuffer(Ha,null),t}function Ute(n,e,t,i){t=ZM(t),i!==void 0?(n.bindBuffer(Ha,e.buffer),n.bufferSubData(Ha,i,t)):WV(n,Ha,e.buffer,t,e.drawType)}function jte(n,e){return e===Ite||e===Tte?1:e===Nte||e===Rte?2:e===Mte||e===Pte||e===Ote?4:0}const e2=["position","positions","a_position"];function qte(n,e){let t,i;for(i=0;i<e2.length&&(t=e2[i],!(t in e||(t=BV.attribPrefix+t,t in e)));++i);i===e2.length&&(t=Object.keys(e)[0]);const s=e[t];n.bindBuffer(Ha,s.buffer);const o=n.getBufferParameter(Ha,Ate);n.bindBuffer(Ha,null);const r=jte(n,s.type),a=o/r,l=s.numComponents||s.size,c=a/l;if(c%1!==0)throw new Error(`numComponents ${l} not correct for length ${length}`);return c}function Gte(n,e,t){const i=$te(n,e),s=Object.assign({},t||{});s.attribs=Object.assign({},t?t.attribs:{},i);const o=e.indices;if(o){const r=ZM(o,"indices");s.indices=VV(n,r,Ete),s.numElements=r.length,s.elementType=YM(r)}else s.numElements||(s.numElements=qte(n,s.attribs));return s}function Um(n){return!!n.texStorage2D}const pA=function(){const n={},e={};function t(i){const s=i.constructor.name;if(!n[s]){for(const o in i)if(typeof i[o]=="number"){const r=e[i[o]];e[i[o]]=r?`${r} | ${o}`:o}n[s]=!0}}return function(s,o){return t(s),e[o]||(typeof o=="number"?`0x${o.toString(16)}`:o)}}(),du={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},om=gS,$V=function(){let n;return function(){return n=n||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),n}}(),kO=6406,fa=6407,Wi=6408,EO=6409,AO=6410,_0=6402,IO=34041,pS=33071,Kte=9728,Yte=9729,_c=3553,fc=34067,Hd=32879,$d=35866,ML=34069,Zte=34070,Xte=34071,Qte=34072,Jte=34073,eie=34074,mA=10241,_A=10240,mS=10242,_S=10243,TO=32882,tie=33082,iie=33083,nie=33084,sie=33085,XM=3317,UV=3314,jV=32878,qV=3316,GV=3315,KV=32877,oie=37443,rie=37441,aie=37440,lie=33321,cie=36756,die=33325,uie=33326,hie=33330,fie=33329,gie=33338,pie=33337,mie=33340,_ie=33339,bie=33323,vie=36757,yie=33327,wie=33328,Cie=33336,Sie=33335,xie=33332,Lie=33331,Die=33334,kie=33333,Eie=32849,Aie=35905,Iie=36194,Tie=36758,Nie=35898,Rie=35901,Mie=34843,Pie=34837,Oie=36221,Fie=36239,Bie=36215,Wie=36233,Vie=36209,zie=36227,Hie=32856,$ie=35907,Uie=36759,jie=32855,qie=32854,Gie=32857,Kie=34842,Yie=34836,Zie=36220,Xie=36238,Qie=36975,Jie=36214,ene=36232,tne=36226,ine=36208,nne=33189,sne=33190,one=36012,rne=36013,ane=35056,Ac=5120,Bi=5121,Uy=5122,ng=5123,jy=5124,Wu=5125,ms=5126,NO=32819,RO=32820,MO=33635,Ar=5131,b0=36193,t2=33640,lne=35899,cne=35902,dne=36269,une=34042,qy=33319,sg=33320,Gy=6403,og=36244,rg=36248,Vu=36249;let i2;function PL(n){if(!i2){const e={};e[kO]={textureFormat:kO,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Bi,Ar,b0,ms]},e[EO]={textureFormat:EO,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[Bi,Ar,b0,ms]},e[AO]={textureFormat:AO,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[Bi,Ar,b0,ms]},e[fa]={textureFormat:fa,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[Bi,Ar,b0,ms,MO]},e[Wi]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[Bi,Ar,b0,ms,NO,RO]},e[_0]={textureFormat:_0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Wu,ng]},e[lie]={textureFormat:Gy,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[Bi]},e[cie]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[Ac]},e[die]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[ms,Ar]},e[uie]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[ms]},e[hie]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Bi]},e[fie]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Ac]},e[xie]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ng]},e[Lie]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Uy]},e[Die]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wu]},e[kie]={textureFormat:og,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[jy]},e[bie]={textureFormat:qy,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[Bi]},e[vie]={textureFormat:qy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[Ac]},e[yie]={textureFormat:qy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[ms,Ar]},e[wie]={textureFormat:qy,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[ms]},e[Cie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Bi]},e[Sie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ac]},e[gie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ng]},e[pie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Uy]},e[mie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Wu]},e[_ie]={textureFormat:sg,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[jy]},e[Eie]={textureFormat:fa,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[Bi]},e[Aie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Bi]},e[Iie]={textureFormat:fa,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[Bi,MO]},e[Tie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Ac]},e[Nie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ms,Ar,lne]},e[Rie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[ms,Ar,cne]},e[Mie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[ms,Ar]},e[Pie]={textureFormat:fa,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ms]},e[Oie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Bi]},e[Fie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Ac]},e[Bie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[ng]},e[Wie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Uy]},e[Vie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Wu]},e[zie]={textureFormat:rg,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[jy]},e[Hie]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Bi]},e[$ie]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Bi]},e[Uie]={textureFormat:Wi,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[Ac]},e[jie]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[Bi,RO,t2]},e[qie]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[Bi,NO]},e[Gie]={textureFormat:Wi,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[t2]},e[Kie]={textureFormat:Wi,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[ms,Ar]},e[Yie]={textureFormat:Wi,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[ms]},e[Zie]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Bi]},e[Xie]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ac]},e[Qie]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[t2]},e[Jie]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ng]},e[ene]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Uy]},e[tne]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[jy]},e[ine]={textureFormat:Vu,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Wu]},e[nne]={textureFormat:_0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ng,Wu]},e[sne]={textureFormat:_0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wu]},e[one]={textureFormat:_0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ms]},e[ane]={textureFormat:IO,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[une]},e[rne]={textureFormat:IO,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[dne]},Object.keys(e).forEach(function(t){const i=e[t];i.bytesPerElementMap={},i.bytesPerElement.forEach(function(s,o){const r=i.type[o];i.bytesPerElementMap[r]=s})}),i2=e}return i2[n]}function hne(n,e){const t=PL(n);if(!t)throw"unknown internal format";const i=t.bytesPerElementMap[e];if(i===void 0)throw"unknown internal format";return i}function jm(n){const e=PL(n);if(!e)throw"unknown internal format";return{format:e.textureFormat,type:e.type[0]}}function PO(n){return(n&n-1)===0}function fne(n,e,t,i){if(!Um(n))return PO(e)&&PO(t);const s=PL(i);if(!s)throw"unknown internal format";return s.colorRenderable&&s.textureFilterable}function gne(n){const e=PL(n);if(!e)throw"unknown internal format";return e.textureFilterable}function YV(n,e,t){return om(e)?YM(e):t||Bi}function Ky(n,e,t,i,s){if(s%1!==0)throw"can't guess dimensions";if(!t&&!i){const o=Math.sqrt(s/(e===fc?6:1));o%1===0?(t=o,i=o):(t=s,i=1)}else if(i){if(!t&&(t=s/i,t%1))throw"can't guess dimensions"}else if(i=s/t,i%1)throw"can't guess dimensions";return{width:t,height:i}}function rm(n,e){e.colorspaceConversion!==void 0&&n.pixelStorei(oie,e.colorspaceConversion),e.premultiplyAlpha!==void 0&&n.pixelStorei(rie,e.premultiplyAlpha),e.flipY!==void 0&&n.pixelStorei(aie,e.flipY)}function ZV(n){n.pixelStorei(XM,4),Um(n)&&(n.pixelStorei(UV,0),n.pixelStorei(jV,0),n.pixelStorei(qV,0),n.pixelStorei(GV,0),n.pixelStorei(KV,0))}function pne(n,e,t,i){i.minMag&&(t.call(n,e,mA,i.minMag),t.call(n,e,_A,i.minMag)),i.min&&t.call(n,e,mA,i.min),i.mag&&t.call(n,e,_A,i.mag),i.wrap&&(t.call(n,e,mS,i.wrap),t.call(n,e,_S,i.wrap),(e===Hd||kte(n,e))&&t.call(n,e,TO,i.wrap)),i.wrapR&&t.call(n,e,TO,i.wrapR),i.wrapS&&t.call(n,e,mS,i.wrapS),i.wrapT&&t.call(n,e,_S,i.wrapT),i.minLod&&t.call(n,e,tie,i.minLod),i.maxLod&&t.call(n,e,iie,i.maxLod),i.baseLevel&&t.call(n,e,nie,i.baseLevel),i.maxLevel&&t.call(n,e,sie,i.maxLevel)}function XV(n,e,t){const i=t.target||_c;n.bindTexture(i,e),pne(n,i,n.texParameteri,t)}function mne(n){return n=n||du.textureColor,om(n)?n:new Uint8Array([n[0]*255,n[1]*255,n[2]*255,n[3]*255])}function bA(n,e,t,i,s,o){t=t||du.textureOptions,o=o||Wi;const r=t.target||_c;if(i=i||t.width,s=s||t.height,n.bindTexture(r,e),fne(n,i,s,o))n.generateMipmap(r);else{const a=gne(o)?Yte:Kte;n.texParameteri(r,mA,a),n.texParameteri(r,_A,a),n.texParameteri(r,mS,pS),n.texParameteri(r,_S,pS)}}function vb(n){return n.auto===!0||n.auto===void 0&&n.level===void 0}function vA(n,e){return e=e||{},e.cubeFaceOrder||[ML,Zte,Xte,Qte,Jte,eie]}function yA(n,e){const i=vA(n,e).map(function(s,o){return{face:s,ndx:o}});return i.sort(function(s,o){return s.face-o.face}),i}function QV(n,e,t,i){i=i||du.textureOptions;const s=i.target||_c,o=i.level||0;let r=t.width,a=t.height;const l=i.internalFormat||i.format||Wi,c=jm(l),d=i.format||c.format,u=i.type||c.type;if(rm(n,i),n.bindTexture(s,e),s===fc){const h=t.width,f=t.height;let g,p;if(h/6===f)g=f,p=[0,0,1,0,2,0,3,0,4,0,5,0];else if(f/6===h)g=h,p=[0,0,0,1,0,2,0,3,0,4,0,5];else if(h/3===f/2)g=h/3,p=[0,0,1,0,2,0,0,1,1,1,2,1];else if(h/2===f/3)g=h/2,p=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);const _=$V();_?(_.canvas.width=g,_.canvas.height=g,r=g,a=g,yA(n,i).forEach(function(v){const b=p[v.ndx*2+0]*g,y=p[v.ndx*2+1]*g;_.drawImage(t,b,y,g,g,0,0,g,g),n.texImage2D(v.face,o,l,d,u,_.canvas)}),_.canvas.width=1,_.canvas.height=1):typeof createImageBitmap<"u"&&(r=g,a=g,yA(n,i).forEach(function(v){const b=p[v.ndx*2+0]*g,y=p[v.ndx*2+1]*g;n.texImage2D(v.face,o,l,g,g,0,d,u,null),createImageBitmap(t,b,y,g,g,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(w){rm(n,i),n.bindTexture(s,e),n.texImage2D(v.face,o,l,d,u,w),vb(i)&&bA(n,e,i,r,a,l)})}))}else if(s===Hd||s===$d){const h=Math.min(t.width,t.height),f=Math.max(t.width,t.height),g=f/h;if(g%1!==0)throw"can not compute 3D dimensions of element";const p=t.width===f?1:0,_=t.height===f?1:0;n.pixelStorei(XM,1),n.pixelStorei(UV,t.width),n.pixelStorei(jV,0),n.pixelStorei(KV,0),n.texImage3D(s,o,l,h,h,h,0,d,u,null);for(let v=0;v<g;++v){const b=v*h*p,y=v*h*_;n.pixelStorei(qV,b),n.pixelStorei(GV,y),n.texSubImage3D(s,o,0,0,v,h,h,1,d,u,t)}ZV(n)}else n.texImage2D(s,o,l,d,u,t);vb(i)&&bA(n,e,i,r,a,l),XV(n,e,i)}function A1(){}function _ne(n){if(typeof document<"u"){const e=document.createElement("a");return e.href=n,e.hostname===location.hostname&&e.port===location.port&&e.protocol===location.protocol}else{const e=new URL(location.href).origin;return new URL(n,location.href).origin===e}}function bne(n,e){return e===void 0&&!_ne(n)?"anonymous":e}function vne(n,e,t){t=t||A1;let i;if(e=e!==void 0?e:du.crossOrigin,e=bne(n,e),typeof Image<"u"){i=new Image,e!==void 0&&(i.crossOrigin=e);const s=function(){i.removeEventListener("error",o),i.removeEventListener("load",r),i=null},o=function(){const l="couldn't load image: "+n;Lte(l),t(l,i),s()},r=function(){t(null,i),s()};return i.addEventListener("error",o),i.addEventListener("load",r),i.src=n,i}else if(typeof ImageBitmap<"u"){let s,o;const r=function(){t(s,o)},a={};e&&(a.mode="cors"),fetch(n,a).then(function(l){if(!l.ok)throw l;return l.blob()}).then(function(l){return createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(l){o=l,setTimeout(r)}).catch(function(l){s=l,setTimeout(r)}),i=null}return i}function JV(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof ImageData<"u"&&n instanceof ImageData||typeof HTMLElement<"u"&&n instanceof HTMLElement}function QM(n,e,t){return JV(n)?(setTimeout(function(){t(null,n)}),n):vne(n,e,t)}function JM(n,e,t){t=t||du.textureOptions;const i=t.target||_c;if(n.bindTexture(i,e),t.color===!1)return;const s=mne(t.color);if(i===fc)for(let o=0;o<6;++o)n.texImage2D(ML+o,0,Wi,1,1,0,Wi,Bi,s);else i===Hd||i===$d?n.texImage3D(i,0,Wi,1,1,1,0,Wi,Bi,s):n.texImage2D(i,0,Wi,1,1,0,Wi,Bi,s)}function yne(n,e,t,i){return i=i||A1,t=t||du.textureOptions,JM(n,e,t),t=Object.assign({},t),QM(t.src,t.crossOrigin,function(o,r){o?i(o,e,r):(QV(n,e,r,t),i(null,e,r))})}function wne(n,e,t,i){i=i||A1;const s=t.src;if(s.length!==6)throw"there must be 6 urls for a cubemap";const o=t.level||0,r=t.internalFormat||t.format||Wi,a=jm(r),l=t.format||a.format,c=t.type||Bi,d=t.target||_c;if(d!==fc)throw"target must be TEXTURE_CUBE_MAP";JM(n,e,t),t=Object.assign({},t);let u=6;const h=[],f=vA(n,t);let g;function p(_){return function(v,b){--u,v?h.push(v):b.width!==b.height?h.push("cubemap face img is not a square: "+b.src):(rm(n,t),n.bindTexture(d,e),u===5?vA().forEach(function(y){n.texImage2D(y,o,r,l,c,b)}):n.texImage2D(_,o,r,l,c,b),vb(t)&&n.generateMipmap(d)),u===0&&i(h.length?h:void 0,e,g)}}g=s.map(function(_,v){return QM(_,t.crossOrigin,p(f[v]))})}function Cne(n,e,t,i){i=i||A1;const s=t.src,o=t.internalFormat||t.format||Wi,r=jm(o),a=t.format||r.format,l=t.type||Bi,c=t.target||$d;if(c!==Hd&&c!==$d)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";JM(n,e,t),t=Object.assign({},t);let d=s.length;const u=[];let h;const f=t.level||0;let g=t.width,p=t.height;const _=s.length;let v=!0;function b(y){return function(w,C){if(--d,w)u.push(w);else{if(rm(n,t),n.bindTexture(c,e),v){v=!1,g=t.width||C.width,p=t.height||C.height,n.texImage3D(c,f,o,g,p,_,0,a,l,null);for(let L=0;L<_;++L)n.texSubImage3D(c,f,0,0,L,g,p,1,a,l,C)}else{let L=C,x;(C.width!==g||C.height!==p)&&(x=$V(),L=x.canvas,x.canvas.width=g,x.canvas.height=p,x.drawImage(C,0,0,g,p)),n.texSubImage3D(c,f,0,0,y,g,p,1,a,l,L),x&&L===x.canvas&&(x.canvas.width=0,x.canvas.height=0)}vb(t)&&n.generateMipmap(c)}d===0&&i(u.length?u:void 0,e,h)}}h=s.map(function(y,w){return QM(y,t.crossOrigin,b(w))})}function ez(n,e,t,i){i=i||du.textureOptions;const s=i.target||_c;n.bindTexture(s,e);let o=i.width,r=i.height,a=i.depth;const l=i.level||0,c=i.internalFormat||i.format||Wi,d=jm(c),u=i.format||d.format,h=i.type||YV(n,t,d.type);if(om(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{const _=xte(h);t=new _(t)}const f=hne(c,h),g=t.byteLength/f;if(g%1)throw"length wrong size for format: "+pA(n,u);let p;if(s===Hd||s===$d)if(!o&&!r&&!a){const _=Math.cbrt(g);if(_%1!==0)throw"can't guess cube size of array of numElements: "+g;o=_,r=_,a=_}else o&&(!r||!a)?(p=Ky(n,s,r,a,g/o),r=p.width,a=p.height):r&&(!o||!a)?(p=Ky(n,s,o,a,g/r),o=p.width,a=p.height):(p=Ky(n,s,o,r,g/a),o=p.width,r=p.height);else p=Ky(n,s,o,r,g),o=p.width,r=p.height;if(ZV(n),n.pixelStorei(XM,i.unpackAlignment||1),rm(n,i),s===fc){const _=f/t.BYTES_PER_ELEMENT,v=g/6*_;yA(n,i).forEach(b=>{const y=v*b.ndx,w=t.subarray(y,y+v);n.texImage2D(b.face,l,c,o,r,0,u,h,w)})}else s===Hd||s===$d?n.texImage3D(s,l,c,o,r,a,0,u,h,t):n.texImage2D(s,l,c,o,r,0,u,h,t);return{width:o,height:r,depth:a,type:h}}function Sne(n,e,t){const i=t.target||_c;n.bindTexture(i,e);const s=t.level||0,o=t.internalFormat||t.format||Wi,r=jm(o),a=t.format||r.format,l=t.type||r.type;if(rm(n,t),i===fc)for(let c=0;c<6;++c)n.texImage2D(ML+c,s,o,t.width,t.height,0,a,l,null);else i===Hd||i===$d?n.texImage3D(i,s,o,t.width,t.height,t.depth,0,a,l,null):n.texImage2D(i,s,o,t.width,t.height,0,a,l,null)}function yb(n,e,t){t=t||A1,e=e||du.textureOptions;const i=n.createTexture(),s=e.target||_c;let o=e.width||1,r=e.height||1;const a=e.internalFormat||Wi;n.bindTexture(s,i),s===fc&&(n.texParameteri(s,mS,pS),n.texParameteri(s,_S,pS));let l=e.src;if(l)if(typeof l=="function"&&(l=l(n,e)),typeof l=="string")yne(n,i,e,t);else if(om(l)||Array.isArray(l)&&(typeof l[0]=="number"||Array.isArray(l[0])||om(l[0]))){const c=ez(n,i,l,e);o=c.width,r=c.height}else Array.isArray(l)&&(typeof l[0]=="string"||JV(l[0]))?s===fc?wne(n,i,e,t):Cne(n,i,e,t):(QV(n,i,l,e),o=l.width,r=l.height);else Sne(n,i,e);return vb(e)&&bA(n,i,e,o,r,a),XV(n,i,e),i}function xne(n,e,t,i,s,o){i=i||t.width,s=s||t.height,o=o||t.depth;const r=t.target||_c;n.bindTexture(r,e);const a=t.level||0,l=t.internalFormat||t.format||Wi,c=jm(l),d=t.format||c.format;let u;const h=t.src;if(h&&(om(h)||Array.isArray(h)&&typeof h[0]=="number")?u=t.type||YV(n,h,c.type):u=t.type||c.type,r===fc)for(let f=0;f<6;++f)n.texImage2D(ML+f,a,l,i,s,0,d,u,null);else r===Hd||r===$d?n.texImage3D(r,a,l,i,s,o,0,d,u,null):n.texImage2D(r,a,l,i,s,0,d,u,null)}const Lne=PV,bS=33984,Dne=35048,OL=34962,kne=34963,e4=35345,tz=35718,Ene=35721,Ane=35971,Ine=35382,Tne=35396,Nne=35398,Rne=35392,Mne=35395,FL=5126,iz=35664,nz=35665,sz=35666,t4=5124,oz=35667,rz=35668,az=35669,lz=35670,cz=35671,dz=35672,uz=35673,hz=35674,fz=35675,gz=35676,Pne=35678,One=35680,Fne=35679,Bne=35682,Wne=35685,Vne=35686,zne=35687,Hne=35688,$ne=35689,Une=35690,jne=36289,qne=36292,Gne=36293,i4=5125,pz=36294,mz=36295,_z=36296,Kne=36298,Yne=36299,Zne=36300,Xne=36303,Qne=36306,Jne=36307,ese=36308,tse=36311,BL=3553,WL=34067,n4=32879,VL=35866,yt={};function bz(n,e){return yt[e].bindPoint}function ise(n,e){return function(t){n.uniform1f(e,t)}}function nse(n,e){return function(t){n.uniform1fv(e,t)}}function sse(n,e){return function(t){n.uniform2fv(e,t)}}function ose(n,e){return function(t){n.uniform3fv(e,t)}}function rse(n,e){return function(t){n.uniform4fv(e,t)}}function vz(n,e){return function(t){n.uniform1i(e,t)}}function yz(n,e){return function(t){n.uniform1iv(e,t)}}function wz(n,e){return function(t){n.uniform2iv(e,t)}}function Cz(n,e){return function(t){n.uniform3iv(e,t)}}function Sz(n,e){return function(t){n.uniform4iv(e,t)}}function ase(n,e){return function(t){n.uniform1ui(e,t)}}function lse(n,e){return function(t){n.uniform1uiv(e,t)}}function cse(n,e){return function(t){n.uniform2uiv(e,t)}}function dse(n,e){return function(t){n.uniform3uiv(e,t)}}function use(n,e){return function(t){n.uniform4uiv(e,t)}}function hse(n,e){return function(t){n.uniformMatrix2fv(e,!1,t)}}function fse(n,e){return function(t){n.uniformMatrix3fv(e,!1,t)}}function gse(n,e){return function(t){n.uniformMatrix4fv(e,!1,t)}}function pse(n,e){return function(t){n.uniformMatrix2x3fv(e,!1,t)}}function mse(n,e){return function(t){n.uniformMatrix3x2fv(e,!1,t)}}function _se(n,e){return function(t){n.uniformMatrix2x4fv(e,!1,t)}}function bse(n,e){return function(t){n.uniformMatrix4x2fv(e,!1,t)}}function vse(n,e){return function(t){n.uniformMatrix3x4fv(e,!1,t)}}function yse(n,e){return function(t){n.uniformMatrix4x3fv(e,!1,t)}}function no(n,e,t,i){const s=bz(n,e);return Um(n)?function(o){let r,a;RL(n,o)?(r=o,a=null):(r=o.texture,a=o.sampler),n.uniform1i(i,t),n.activeTexture(bS+t),n.bindTexture(s,r),n.bindSampler(t,a)}:function(o){n.uniform1i(i,t),n.activeTexture(bS+t),n.bindTexture(s,o)}}function so(n,e,t,i,s){const o=bz(n,e),r=new Int32Array(s);for(let a=0;a<s;++a)r[a]=t+a;return Um(n)?function(a){n.uniform1iv(i,r),a.forEach(function(l,c){n.activeTexture(bS+r[c]);let d,u;RL(n,l)?(d=l,u=null):(d=l.texture,u=l.sampler),n.bindSampler(t,u),n.bindTexture(o,d)})}:function(a){n.uniform1iv(i,r),a.forEach(function(l,c){n.activeTexture(bS+r[c]),n.bindTexture(o,l)})}}yt[FL]={Type:Float32Array,size:4,setter:ise,arraySetter:nse};yt[iz]={Type:Float32Array,size:8,setter:sse,cols:2};yt[nz]={Type:Float32Array,size:12,setter:ose,cols:3};yt[sz]={Type:Float32Array,size:16,setter:rse,cols:4};yt[t4]={Type:Int32Array,size:4,setter:vz,arraySetter:yz};yt[oz]={Type:Int32Array,size:8,setter:wz,cols:2};yt[rz]={Type:Int32Array,size:12,setter:Cz,cols:3};yt[az]={Type:Int32Array,size:16,setter:Sz,cols:4};yt[i4]={Type:Uint32Array,size:4,setter:ase,arraySetter:lse};yt[pz]={Type:Uint32Array,size:8,setter:cse,cols:2};yt[mz]={Type:Uint32Array,size:12,setter:dse,cols:3};yt[_z]={Type:Uint32Array,size:16,setter:use,cols:4};yt[lz]={Type:Uint32Array,size:4,setter:vz,arraySetter:yz};yt[cz]={Type:Uint32Array,size:8,setter:wz,cols:2};yt[dz]={Type:Uint32Array,size:12,setter:Cz,cols:3};yt[uz]={Type:Uint32Array,size:16,setter:Sz,cols:4};yt[hz]={Type:Float32Array,size:32,setter:hse,rows:2,cols:2};yt[fz]={Type:Float32Array,size:48,setter:fse,rows:3,cols:3};yt[gz]={Type:Float32Array,size:64,setter:gse,rows:4,cols:4};yt[Wne]={Type:Float32Array,size:32,setter:pse,rows:2,cols:3};yt[Vne]={Type:Float32Array,size:32,setter:_se,rows:2,cols:4};yt[zne]={Type:Float32Array,size:48,setter:mse,rows:3,cols:2};yt[Hne]={Type:Float32Array,size:48,setter:vse,rows:3,cols:4};yt[$ne]={Type:Float32Array,size:64,setter:bse,rows:4,cols:2};yt[Une]={Type:Float32Array,size:64,setter:yse,rows:4,cols:3};yt[Pne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:BL};yt[One]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:WL};yt[Fne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:n4};yt[Bne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:BL};yt[jne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:VL};yt[qne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:VL};yt[Gne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:WL};yt[Kne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:BL};yt[Yne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:n4};yt[Zne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:WL};yt[Xne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:VL};yt[Qne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:BL};yt[Jne]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:n4};yt[ese]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:WL};yt[tse]={Type:null,size:0,setter:no,arraySetter:so,bindPoint:VL};function zL(n,e){return function(t){if(t.value)switch(n.disableVertexAttribArray(e),t.value.length){case 4:n.vertexAttrib4fv(e,t.value);break;case 3:n.vertexAttrib3fv(e,t.value);break;case 2:n.vertexAttrib2fv(e,t.value);break;case 1:n.vertexAttrib1fv(e,t.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else n.bindBuffer(OL,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribPointer(e,t.numComponents||t.size,t.type||FL,t.normalize||!1,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function uu(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4iv(e,t.value);else throw new Error("The length of an integer constant value must be 4!");else n.bindBuffer(OL,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||t4,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function HL(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4uiv(e,t.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else n.bindBuffer(OL,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||i4,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function s4(n,e,t){const i=t.size,s=t.count;return function(o){n.bindBuffer(OL,o.buffer);const r=o.size||o.numComponents||i,a=r/s,l=o.type||FL,d=yt[l].size*r,u=o.normalize||!1,h=o.offset||0,f=d/s;for(let g=0;g<s;++g)n.enableVertexAttribArray(e+g),n.vertexAttribPointer(e+g,a,l,u,d,h+f*g),o.divisor!==void 0&&n.vertexAttribDivisor(e+g,o.divisor)}}const xn={};xn[FL]={size:4,setter:zL};xn[iz]={size:8,setter:zL};xn[nz]={size:12,setter:zL};xn[sz]={size:16,setter:zL};xn[t4]={size:4,setter:uu};xn[oz]={size:8,setter:uu};xn[rz]={size:12,setter:uu};xn[az]={size:16,setter:uu};xn[i4]={size:4,setter:HL};xn[pz]={size:8,setter:HL};xn[mz]={size:12,setter:HL};xn[_z]={size:16,setter:HL};xn[lz]={size:4,setter:uu};xn[cz]={size:8,setter:uu};xn[dz]={size:12,setter:uu};xn[uz]={size:16,setter:uu};xn[hz]={size:4,setter:s4,count:2};xn[fz]={size:9,setter:s4,count:3};xn[gz]={size:16,setter:s4,count:4};function xz(n){const e=n.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const wse=/(\.|\[|]|\w+)/g,Cse=n=>n>="0"&&n<="9";function Lz(n,e,t,i){const s=n.split(wse).filter(a=>a!=="");let o=0,r="";for(;;){const a=s[o++];r+=a;const l=Cse(a[0]),c=l?parseInt(a):a;if(l&&(r+=s[o++]),o===s.length){t[c]=e;break}else{const u=s[o++],h=u==="[",f=t[c]||(h?[]:{});t[c]=f,t=f,i[r]=i[r]||function(g){return function(p){kz(g,p)}}(f),r+=u}}}function Sse(n,e){let t=0;function i(a,l,c){const d=l.name.endsWith("[0]"),u=l.type,h=yt[u];if(!h)throw new Error(`unknown type: 0x${u.toString(16)}`);let f;if(h.bindPoint){const g=t;t+=l.size,d?f=h.arraySetter(n,u,g,c,l.size):f=h.setter(n,u,g,c,l.size)}else h.arraySetter&&d?f=h.arraySetter(n,c):f=h.setter(n,c);return f.location=c,f}const s={},o={},r=n.getProgramParameter(e,tz);for(let a=0;a<r;++a){const l=n.getActiveUniform(e,a);if(xz(l))continue;let c=l.name;c.endsWith("[0]")&&(c=c.substr(0,c.length-3));const d=n.getUniformLocation(e,l.name);if(d){const u=i(e,l,d);s[c]=u,Lz(c,u,o,s)}}return s}function xse(n,e){const t={},i=n.getProgramParameter(e,Ane);for(let s=0;s<i;++s){const o=n.getTransformFeedbackVarying(e,s);t[o.name]={index:s,type:o.type,size:o.size}}return t}function Lse(n,e){const t=n.getProgramParameter(e,tz),i=[],s=[];for(let a=0;a<t;++a){s.push(a),i.push({});const l=n.getActiveUniform(e,a);i[a].name=l.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){const l=a[0],c=a[1];n.getActiveUniforms(e,s,n[l]).forEach(function(d,u){i[u][c]=d})});const o={},r=n.getProgramParameter(e,Ine);for(let a=0;a<r;++a){const l=n.getActiveUniformBlockName(e,a),c={index:n.getUniformBlockIndex(e,l),usedByVertexShader:n.getActiveUniformBlockParameter(e,a,Tne),usedByFragmentShader:n.getActiveUniformBlockParameter(e,a,Nne),size:n.getActiveUniformBlockParameter(e,a,Rne),uniformIndices:n.getActiveUniformBlockParameter(e,a,Mne)};c.used=c.usedByVertexShader||c.usedByFragmentShader,o[l]=c}return{blockSpecs:o,uniformData:i}}const OO=/\[\d+\]\.$/,Dse=(n,e)=>((n+(e-1))/e|0)*e;function kse(n,e,t,i){if(e||t){i=i||1;const o=n.length/4;return function(r){let a=0,l=0;for(let c=0;c<o;++c){for(let d=0;d<i;++d)n[a++]=r[l++];a+=4-i}}}else return function(s){s.length?n.set(s):n[0]=s}}function Ese(n,e,t,i){const s=t.blockSpecs,o=t.uniformData,r=s[i];if(!r)return Lne("no uniform block object named:",i),{name:i,uniforms:{}};const a=new ArrayBuffer(r.size),l=n.createBuffer(),c=r.index;n.bindBuffer(e4,l),n.uniformBlockBinding(e,r.index,c);let d=i+".";OO.test(d)&&(d=d.replace(OO,"."));const u={},h={},f={};return r.uniformIndices.forEach(function(g){const p=o[g];let _=p.name;_.startsWith(d)&&(_=_.substr(d.length));const v=_.endsWith("[0]");v&&(_=_.substr(0,_.length-3));const b=yt[p.type],y=b.Type,w=v?Dse(b.size,16)*p.size:b.size*p.size,C=new y(a,p.offset,w/y.BYTES_PER_ELEMENT);u[_]=C;const L=kse(C,v,b.rows,b.cols);h[_]=L,Lz(_,L,f,h)}),{name:i,array:a,asFloat:new Float32Array(a),buffer:l,uniforms:u,setters:h}}function FO(n,e,t){return Ese(n,e.program,e.uniformBlockSpec,t)}function Dz(n,e,t){const s=(e.uniformBlockSpec||e).blockSpecs[t.name];if(s){const o=s.index;return n.bindBufferRange(e4,o,t.buffer,t.offset||0,t.array.byteLength),!0}return!1}function BO(n,e,t){Dz(n,e,t)&&n.bufferData(e4,t.array,Dne)}function wb(n,e){const t=n.setters;for(const i in e){const s=t[i];if(s){const o=e[i];s(o)}}}function kz(n,e){for(const t in e){const i=n[t];typeof i=="function"?i(e[t]):kz(n[t],e[t])}}function op(n,...e){const t=n.uniformSetters||n,i=e.length;for(let s=0;s<i;++s){const o=e[s];if(Array.isArray(o)){const r=o.length;for(let a=0;a<r;++a)op(t,o[a])}else for(const r in o){const a=t[r];a&&a(o[r])}}}function Ase(n,e){const t={},i=n.getProgramParameter(e,Ene);for(let s=0;s<i;++s){const o=n.getActiveAttrib(e,s);if(xz(o))continue;const r=n.getAttribLocation(e,o.name),a=xn[o.type],l=a.setter(n,r,a);l.location=r,t[o.name]=l}return t}function Ise(n,e){for(const t in e){const i=n[t];i&&i(e[t])}}function rf(n,e,t){t.vertexArrayObject?n.bindVertexArray(t.vertexArrayObject):(Ise(e.attribSetters||e,t.attribs),t.indices&&n.bindBuffer(kne,t.indices))}function Tse(n,e){const t=Sse(n,e),i=Ase(n,e),s={program:e,uniformSetters:t,attribSetters:i};return Um(n)&&(s.uniformBlockSpec=Lse(n,e),s.transformFeedbackInfo=xse(n,e)),s}const Nse=4,WO=5123;function $L(n,e,t,i,s,o){t=t===void 0?Nse:t;const r=e.indices,a=e.elementType,l=i===void 0?e.numElements:i;s=s===void 0?0:s,a||r?o!==void 0?n.drawElementsInstanced(t,l,a===void 0?WO:e.elementType,s,o):n.drawElements(t,l,a===void 0?WO:e.elementType,s):o!==void 0?n.drawArraysInstanced(t,s,l,o):n.drawArrays(t,s,l)}const Rse=36160,_h=36161,Mse=3553,Pse=5121,Ose=6402,Fse=6408,Bse=33190,Wse=36012,Vse=35056,zse=36013,Hse=32854,$se=32855,Use=36194,Ez=33189,Az=6401,Iz=36168,o4=34041,jse=36064,UL=36096,Tz=36128,r4=33306,wA=33071,CA=9729,Nz=[{format:Fse,type:Pse,min:CA,wrap:wA},{format:o4}],ea={};ea[o4]=r4;ea[Az]=Tz;ea[Iz]=Tz;ea[Ose]=UL;ea[Ez]=UL;ea[Bse]=UL;ea[Wse]=UL;ea[Vse]=r4;ea[zse]=r4;function qse(n,e){return ea[n]||ea[e]}const hu={};hu[Hse]=!0;hu[$se]=!0;hu[Use]=!0;hu[o4]=!0;hu[Ez]=!0;hu[Az]=!0;hu[Iz]=!0;function Gse(n){return hu[n]}function Kse(n,e,t,i){const s=Rse,o=n.createFramebuffer();n.bindFramebuffer(s,o),t=t||n.drawingBufferWidth,i=i||n.drawingBufferHeight,e=e||Nz;let r=0;const a={framebuffer:o,attachments:[],width:t,height:i};return e.forEach(function(l){let c=l.attachment;const d=l.samples,u=l.format;let h=l.attachmentPoint||qse(u,l.internalFormat);if(h||(h=jse+r++),!c)if(d!==void 0||Gse(u))c=n.createRenderbuffer(),n.bindRenderbuffer(_h,c),d>1?n.renderbufferStorageMultisample(_h,d,u,t,i):n.renderbufferStorage(_h,u,t,i);else{const f=Object.assign({},l);f.width=t,f.height=i,f.auto===void 0&&(f.auto=!1,f.min=f.min||f.minMag||CA,f.mag=f.mag||f.minMag||CA,f.wrapS=f.wrapS||f.wrap||wA,f.wrapT=f.wrapT||f.wrap||wA),c=yb(n,f)}if(OV(n,c))n.framebufferRenderbuffer(s,h,_h,c);else if(RL(n,c))l.layer!==void 0?n.framebufferTextureLayer(s,h,c,l.level||0,l.layer):n.framebufferTexture2D(s,h,l.target||Mse,c,l.level||0);else throw new Error("unknown attachment type");a.attachments.push(c)}),a}function Yse(n,e,t,i,s){i=i||n.drawingBufferWidth,s=s||n.drawingBufferHeight,e.width=i,e.height=s,t=t||Nz,t.forEach(function(o,r){const a=e.attachments[r],l=o.format,c=o.samples;if(c!==void 0||OV(n,a))n.bindRenderbuffer(_h,a),c>1?n.renderbufferStorageMultisample(_h,c,l,i,s):n.renderbufferStorage(_h,l,i,s);else if(RL(n,a))xne(n,a,o,i,s);else throw new Error("unknown attachment type")})}function Zse(n,e,t){const i=n.createVertexArray();return n.bindVertexArray(i),e.length||(e=[e]),e.forEach(function(s){rf(n,s,t)}),n.bindVertexArray(null),{numElements:t.numElements,elementType:t.elementType,vertexArrayObject:i}}const Xse=/^(.*?)_/;function Qse(n,e){pA(n,0);const t=n.getExtension(e);if(t){const i={},s=Xse.exec(e)[1],o="_"+s;for(const r in t){const a=t[r],l=typeof a=="function",c=l?s:o;let d=r;r.endsWith(c)&&(d=r.substring(0,r.length-c.length)),n[d]!==void 0?!l&&n[d]!==a&&PV(d,n[d],a,r):l?n[d]=function(u){return function(){return u.apply(t,arguments)}}(a):(n[d]=a,i[d]=a)}i.constructor={name:t.constructor.name},pA(i,0)}return t}const VO=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function Rz(n){for(let e=0;e<VO.length;++e)Qse(n,VO[e])}function Jse(n,e){const t=["webgl2","webgl","experimental-webgl"];let i=null;for(let s=0;s<t.length;++s)if(i=n.getContext(t[s],e),i){Rz(i);break}return i}function eoe(n,e){return Jse(n,e)}const toe=`out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out float vHalfStrokeWidth;
out vec4 vCornerRadii;

#if defined(ROUNDED_CORNERS) || defined(STROKED)
/** Position for SDF-strokes */
out vec2 vPosInPixels;
#endif

/** Size of the rect in pixels */
out vec2 vHalfSizeInPixels;

/**
 * Clamps the minimumSize and returns an opacity that reflects the amount of clamping.
 */
float clampMinSize(inout float pos, float frac, float size, float minSize) {
    if (minSize > 0.0 && abs(size) < minSize) {
        pos += (frac - 0.5) * (minSize * sign(size) - size);
        return abs(size) / minSize;
    }

    return 1.0;
}

void sort(inout float a, inout float b) {
    if (a > b) {
        float tmp = b;
        b = a;
        a = tmp;
    }
}

/**
 * The vertex position wrt the rectangle specified by (x, x2, y, y2).
 * [0, 0] = [x, y], [1, 1] = [x2, y2]. 
 * The x or y component may contain fractional values if the rectangle 
 * have been tessellated.
 */
vec2 getVertexPos() {
    int index = gl_VertexID % 6;
    return vec2(
        index == 0 || index == 1 || index == 3 ? 0.0 : 1.0,
        index == 0 || index == 1 || index == 2 ? 0.0 : 1.0
    );
    
}

void main(void) {
    vec2 frac = getVertexPos();

    vec2 normalizedMinSize = vec2(uMinWidth, uMinHeight) / uViewportSize;
    vec4 cornerRadii = vec4(
        uCornerRadiusTopRight,
        uCornerRadiusBottomRight,
        uCornerRadiusTopLeft,
        uCornerRadiusBottomLeft
    );

    float x = getScaled_x();
    float x2 = getScaled_x2();
    float y = getScaled_y();
    float y2 = getScaled_y2();

    sort(x, x2);
    sort(y, y2);

    // Clamp x to prevent precision artifacts when the scale is zoomed very close.
	// TODO: clamp y as well
	float clampMargin = 1.0;
    vec2 pos1 = vec2(clamp(x, 0.0 - clampMargin, 1.0 + clampMargin), y);
    vec2 pos2 = vec2(clamp(x2, 0.0 - clampMargin, 1.0 + clampMargin), y2);

    vec2 size = pos2 - pos1;

    if (size.x <= 0.0 || size.y <= 0.0) {
        // Early exit. May increase performance or not...
        gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
        return;
    }

    vec2 pos = pos1 + frac * size;

    size.y *= getSampleFacetHeight(pos);

    // Clamp to minimum size, optionally compensate with opacity
    float opaFactor = uViewOpacity * max(uMinOpacity,
        clampMinSize(pos.x, frac.x, size.x, normalizedMinSize.x) *
        clampMinSize(pos.y, frac.y, size.y, normalizedMinSize.y));

    pos = applySampleFacet(pos);

#if defined(ROUNDED_CORNERS) || defined(STROKED)
    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = 1.0 / uDevicePixelRatio;
    float strokeWidth = getScaled_strokeWidth();
    float strokeOpacity = getScaled_strokeOpacity() * opaFactor;

    vec2 centeredFrac = frac - 0.5;
    vec2 expand = centeredFrac * (strokeWidth + aaPadding) / uViewportSize;
    pos += expand;

    vec2 sizeInPixels = size * uViewportSize;
    vPosInPixels = (centeredFrac + expand / size) * sizeInPixels;

    vHalfSizeInPixels = sizeInPixels / 2.0;

    vCornerRadii = min(cornerRadii, min(vHalfSizeInPixels.x, vHalfSizeInPixels.y));
    vHalfStrokeWidth = strokeWidth / 2.0;
    vStrokeColor = vec4(getScaled_stroke() * strokeOpacity, strokeOpacity);
#endif

    gl_Position = unitToNdc(pos);

    float fillOpacity = getScaled_fillOpacity() * opaFactor;
    vFillColor = vec4(getScaled_fill() * fillOpacity, fillOpacity);

    setupPicking();
}
`,ioe=`#if defined(ROUNDED_CORNERS) || defined(STROKED)
in vec2 vPosInPixels;
#endif

in vec2 vHalfSizeInPixels;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in float vHalfStrokeWidth;
in vec4 vCornerRadii;

out lowp vec4 fragColor;

// Source: https://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
float sdRoundedBox(vec2 p, vec2 b, vec4 r) {
    r.xy = p.x > 0.0 ? r.xy : r.zw;
    r.x  = p.y > 0.0 ? r.x  : r.y;
    vec2 q = abs(p) - b + r.x;
    return min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - r.x;
}

// Not a true SDF. Makes the corners of strokes sharp and is faster.
float sdSharpBox(vec2 p, vec2 b) {
    vec2 q = abs(p) - b;
    return max(q.x, q.y);
}

void main(void) {

#if defined(ROUNDED_CORNERS) || defined(STROKED)
#ifdef ROUNDED_CORNERS
    // Distance from rectangle's edge in pixels. Negative inside the rectangle.
    float d = sdRoundedBox(vPosInPixels, vHalfSizeInPixels, vCornerRadii);
#else
    float d = sdSharpBox(vPosInPixels, vHalfSizeInPixels);
#endif

    fragColor = distanceToColor(d, vFillColor, vStrokeColor, vHalfStrokeWidth);

    if (fragColor.a == 0.0) {
        discard;
    }
#else
    // The trivial, non-decorated case
    fragColor = vFillColor;
#endif

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,noe=`layout(std140) uniform Mark {
    /** Minimum size (width, height) of the displayed rectangle in pixels */
    uniform float uMinWidth;
    uniform float uMinHeight;

    /** Minimum opacity for the size clamping */
    uniform float uMinOpacity;

    uniform float uCornerRadiusTopRight;
    uniform float uCornerRadiusBottomRight;
    uniform float uCornerRadiusTopLeft;
    uniform float uCornerRadiusBottomLeft;

#pragma markUniforms
};
`;function rl(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function fu(n,e){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const SA=Symbol("implicit");function a4(){var n=new uc,e=[],t=[],i=SA;function s(o){let r=n.get(o);if(r===void 0){if(i!==SA)return i;n.set(o,r=e.push(o)-1)}return t[r%t.length]}return s.domain=function(o){if(!arguments.length)return e.slice();e=[],n=new uc;for(const r of o)n.has(r)||n.set(r,e.push(r)-1);return s},s.range=function(o){return arguments.length?(t=Array.from(o),s):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.copy=function(){return a4(e,t).unknown(i)},rl.apply(s,arguments),s}function qm(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function I1(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function gu(){}var af=.7,am=1/af,rp="\\s*([+-]?\\d+)\\s*",Cb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",soe=/^#([0-9a-f]{3,8})$/,ooe=new RegExp(`^rgb\\(${rp},${rp},${rp}\\)$`),roe=new RegExp(`^rgb\\(${$a},${$a},${$a}\\)$`),aoe=new RegExp(`^rgba\\(${rp},${rp},${rp},${Cb}\\)$`),loe=new RegExp(`^rgba\\(${$a},${$a},${$a},${Cb}\\)$`),coe=new RegExp(`^hsl\\(${Cb},${$a},${$a}\\)$`),doe=new RegExp(`^hsla\\(${Cb},${$a},${$a},${Cb}\\)$`),zO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qm(gu,Ud,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:HO,formatHex:HO,formatHex8:uoe,formatHsl:hoe,formatRgb:$O,toString:$O});function HO(){return this.rgb().formatHex()}function uoe(){return this.rgb().formatHex8()}function hoe(){return Mz(this).formatHsl()}function $O(){return this.rgb().formatRgb()}function Ud(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=soe.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?UO(e):t===3?new Kn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Yy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Yy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ooe.exec(n))?new Kn(e[1],e[2],e[3],1):(e=roe.exec(n))?new Kn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=aoe.exec(n))?Yy(e[1],e[2],e[3],e[4]):(e=loe.exec(n))?Yy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=coe.exec(n))?GO(e[1],e[2]/100,e[3]/100,1):(e=doe.exec(n))?GO(e[1],e[2]/100,e[3]/100,e[4]):zO.hasOwnProperty(n)?UO(zO[n]):n==="transparent"?new Kn(NaN,NaN,NaN,0):null}function UO(n){return new Kn(n>>16&255,n>>8&255,n&255,1)}function Yy(n,e,t,i){return i<=0&&(n=e=t=NaN),new Kn(n,e,t,i)}function l4(n){return n instanceof gu||(n=Ud(n)),n?(n=n.rgb(),new Kn(n.r,n.g,n.b,n.opacity)):new Kn}function vS(n,e,t,i){return arguments.length===1?l4(n):new Kn(n,e,t,i??1)}function Kn(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}qm(Kn,vS,I1(gu,{brighter(n){return n=n==null?am:Math.pow(am,n),new Kn(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?af:Math.pow(af,n),new Kn(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Kn(Wh(this.r),Wh(this.g),Wh(this.b),yS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jO,formatHex:jO,formatHex8:foe,formatRgb:qO,toString:qO}));function jO(){return`#${bh(this.r)}${bh(this.g)}${bh(this.b)}`}function foe(){return`#${bh(this.r)}${bh(this.g)}${bh(this.b)}${bh((isNaN(this.opacity)?1:this.opacity)*255)}`}function qO(){const n=yS(this.opacity);return`${n===1?"rgb(":"rgba("}${Wh(this.r)}, ${Wh(this.g)}, ${Wh(this.b)}${n===1?")":`, ${n})`}`}function yS(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Wh(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function bh(n){return n=Wh(n),(n<16?"0":"")+n.toString(16)}function GO(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new qr(n,e,t,i)}function Mz(n){if(n instanceof qr)return new qr(n.h,n.s,n.l,n.opacity);if(n instanceof gu||(n=Ud(n)),!n)return new qr;if(n instanceof qr)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,s=Math.min(e,t,i),o=Math.max(e,t,i),r=NaN,a=o-s,l=(o+s)/2;return a?(e===o?r=(t-i)/a+(t<i)*6:t===o?r=(i-e)/a+2:r=(e-t)/a+4,a/=l<.5?o+s:2-o-s,r*=60):a=l>0&&l<1?0:r,new qr(r,a,l,n.opacity)}function xA(n,e,t,i){return arguments.length===1?Mz(n):new qr(n,e,t,i??1)}function qr(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}qm(qr,xA,I1(gu,{brighter(n){return n=n==null?am:Math.pow(am,n),new qr(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?af:Math.pow(af,n),new qr(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,s=2*t-i;return new Kn(n2(n>=240?n-240:n+120,s,i),n2(n,s,i),n2(n<120?n+240:n-120,s,i),this.opacity)},clamp(){return new qr(KO(this.h),Zy(this.s),Zy(this.l),yS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=yS(this.opacity);return`${n===1?"hsl(":"hsla("}${KO(this.h)}, ${Zy(this.s)*100}%, ${Zy(this.l)*100}%${n===1?")":`, ${n})`}`}}));function KO(n){return n=(n||0)%360,n<0?n+360:n}function Zy(n){return Math.max(0,Math.min(1,n||0))}function n2(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Pz=Math.PI/180,Oz=180/Math.PI,wS=18,Fz=.96422,Bz=1,Wz=.82521,Vz=4/29,ap=6/29,zz=3*ap*ap,goe=ap*ap*ap;function Hz(n){if(n instanceof Ua)return new Ua(n.l,n.a,n.b,n.opacity);if(n instanceof Gl)return $z(n);n instanceof Kn||(n=l4(n));var e=a2(n.r),t=a2(n.g),i=a2(n.b),s=s2((.2225045*e+.7168786*t+.0606169*i)/Bz),o,r;return e===t&&t===i?o=r=s:(o=s2((.4360747*e+.3850649*t+.1430804*i)/Fz),r=s2((.0139322*e+.0971045*t+.7141733*i)/Wz)),new Ua(116*s-16,500*(o-s),200*(s-r),n.opacity)}function LA(n,e,t,i){return arguments.length===1?Hz(n):new Ua(n,e,t,i??1)}function Ua(n,e,t,i){this.l=+n,this.a=+e,this.b=+t,this.opacity=+i}qm(Ua,LA,I1(gu,{brighter(n){return new Ua(this.l+wS*(n??1),this.a,this.b,this.opacity)},darker(n){return new Ua(this.l-wS*(n??1),this.a,this.b,this.opacity)},rgb(){var n=(this.l+16)/116,e=isNaN(this.a)?n:n+this.a/500,t=isNaN(this.b)?n:n-this.b/200;return e=Fz*o2(e),n=Bz*o2(n),t=Wz*o2(t),new Kn(r2(3.1338561*e-1.6168667*n-.4906146*t),r2(-.9787684*e+1.9161415*n+.033454*t),r2(.0719453*e-.2289914*n+1.4052427*t),this.opacity)}}));function s2(n){return n>goe?Math.pow(n,1/3):n/zz+Vz}function o2(n){return n>ap?n*n*n:zz*(n-Vz)}function r2(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function a2(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function poe(n){if(n instanceof Gl)return new Gl(n.h,n.c,n.l,n.opacity);if(n instanceof Ua||(n=Hz(n)),n.a===0&&n.b===0)return new Gl(NaN,0<n.l&&n.l<100?0:NaN,n.l,n.opacity);var e=Math.atan2(n.b,n.a)*Oz;return new Gl(e<0?e+360:e,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity)}function DA(n,e,t,i){return arguments.length===1?poe(n):new Gl(n,e,t,i??1)}function Gl(n,e,t,i){this.h=+n,this.c=+e,this.l=+t,this.opacity=+i}function $z(n){if(isNaN(n.h))return new Ua(n.l,0,0,n.opacity);var e=n.h*Pz;return new Ua(n.l,Math.cos(e)*n.c,Math.sin(e)*n.c,n.opacity)}qm(Gl,DA,I1(gu,{brighter(n){return new Gl(this.h,this.c,this.l+wS*(n??1),this.opacity)},darker(n){return new Gl(this.h,this.c,this.l-wS*(n??1),this.opacity)},rgb(){return $z(this).rgb()}}));var Uz=-.14861,c4=1.78277,d4=-.29227,jL=-.90649,Sb=1.97294,YO=Sb*jL,ZO=Sb*c4,XO=c4*d4-jL*Uz;function moe(n){if(n instanceof Vh)return new Vh(n.h,n.s,n.l,n.opacity);n instanceof Kn||(n=l4(n));var e=n.r/255,t=n.g/255,i=n.b/255,s=(XO*i+YO*e-ZO*t)/(XO+YO-ZO),o=i-s,r=(Sb*(t-s)-d4*o)/jL,a=Math.sqrt(r*r+o*o)/(Sb*s*(1-s)),l=a?Math.atan2(r,o)*Oz-120:NaN;return new Vh(l<0?l+360:l,a,s,n.opacity)}function kA(n,e,t,i){return arguments.length===1?moe(n):new Vh(n,e,t,i??1)}function Vh(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}qm(Vh,kA,I1(gu,{brighter(n){return n=n==null?am:Math.pow(am,n),new Vh(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?af:Math.pow(af,n),new Vh(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=isNaN(this.h)?0:(this.h+120)*Pz,e=+this.l,t=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(n),s=Math.sin(n);return new Kn(255*(e+t*(Uz*i+c4*s)),255*(e+t*(d4*i+jL*s)),255*(e+t*(Sb*i)),this.opacity)}}));function jz(n,e,t,i,s){var o=n*n,r=o*n;return((1-3*n+3*o-r)*e+(4-6*o+3*r)*t+(1+3*n+3*o-3*r)*i+r*s)/6}function qz(n){var e=n.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),s=n[i],o=n[i+1],r=i>0?n[i-1]:2*s-o,a=i<e-1?n[i+2]:2*o-s;return jz((t-i/e)*e,r,s,o,a)}}function Gz(n){var e=n.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*e),s=n[(i+e-1)%e],o=n[i%e],r=n[(i+1)%e],a=n[(i+2)%e];return jz((t-i/e)*e,s,o,r,a)}}const qL=n=>()=>n;function Kz(n,e){return function(t){return n+t*e}}function _oe(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function GL(n,e){var t=e-n;return t?Kz(n,t>180||t<-180?t-360*Math.round(t/360):t):qL(isNaN(n)?e:n)}function boe(n){return(n=+n)==1?Yn:function(e,t){return t-e?_oe(e,t,n):qL(isNaN(e)?t:e)}}function Yn(n,e){var t=e-n;return t?Kz(n,t):qL(isNaN(n)?e:n)}const EA=function n(e){var t=boe(e);function i(s,o){var r=t((s=vS(s)).r,(o=vS(o)).r),a=t(s.g,o.g),l=t(s.b,o.b),c=Yn(s.opacity,o.opacity);return function(d){return s.r=r(d),s.g=a(d),s.b=l(d),s.opacity=c(d),s+""}}return i.gamma=n,i}(1);function Yz(n){return function(e){var t=e.length,i=new Array(t),s=new Array(t),o=new Array(t),r,a;for(r=0;r<t;++r)a=vS(e[r]),i[r]=a.r||0,s[r]=a.g||0,o[r]=a.b||0;return i=n(i),s=n(s),o=n(o),a.opacity=1,function(l){return a.r=i(l),a.g=s(l),a.b=o(l),a+""}}}var voe=Yz(qz),yoe=Yz(Gz);function u4(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),s;return function(o){for(s=0;s<t;++s)i[s]=n[s]*(1-o)+e[s]*o;return i}}function Zz(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function woe(n,e){return(Zz(e)?u4:Xz)(n,e)}function Xz(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,s=new Array(i),o=new Array(t),r;for(r=0;r<i;++r)s[r]=pu(n[r],e[r]);for(;r<t;++r)o[r]=e[r];return function(a){for(r=0;r<i;++r)o[r]=s[r](a);return o}}function Qz(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function $r(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function Jz(n,e){var t={},i={},s;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in n?t[s]=pu(n[s],e[s]):i[s]=e[s];return function(o){for(s in t)i[s]=t[s](o);return i}}var AA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,l2=new RegExp(AA.source,"g");function Coe(n){return function(){return n}}function Soe(n){return function(e){return n(e)+""}}function eH(n,e){var t=AA.lastIndex=l2.lastIndex=0,i,s,o,r=-1,a=[],l=[];for(n=n+"",e=e+"";(i=AA.exec(n))&&(s=l2.exec(e));)(o=s.index)>t&&(o=e.slice(t,o),a[r]?a[r]+=o:a[++r]=o),(i=i[0])===(s=s[0])?a[r]?a[r]+=s:a[++r]=s:(a[++r]=null,l.push({i:r,x:$r(i,s)})),t=l2.lastIndex;return t<e.length&&(o=e.slice(t),a[r]?a[r]+=o:a[++r]=o),a.length<2?l[0]?Soe(l[0].x):Coe(e):(e=l.length,function(c){for(var d=0,u;d<e;++d)a[(u=l[d]).i]=u.x(c);return a.join("")})}function pu(n,e){var t=typeof e,i;return e==null||t==="boolean"?qL(e):(t==="number"?$r:t==="string"?(i=Ud(e))?(e=i,EA):eH:e instanceof Ud?EA:e instanceof Date?Qz:Zz(e)?u4:Array.isArray(e)?Xz:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Jz:$r)(n,e)}function xoe(n){var e=n.length;return function(t){return n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}}function Loe(n,e){var t=GL(+n,+e);return function(i){var s=t(i);return s-360*Math.floor(s/360)}}function T1(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var QO=180/Math.PI,IA={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tH(n,e,t,i,s,o){var r,a,l;return(r=Math.sqrt(n*n+e*e))&&(n/=r,e/=r),(l=n*t+e*i)&&(t-=n*l,i-=e*l),(a=Math.sqrt(t*t+i*i))&&(t/=a,i/=a,l/=a),n*i<e*t&&(n=-n,e=-e,l=-l,r=-r),{translateX:s,translateY:o,rotate:Math.atan2(e,n)*QO,skewX:Math.atan(l)*QO,scaleX:r,scaleY:a}}var Xy;function Doe(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?IA:tH(e.a,e.b,e.c,e.d,e.e,e.f)}function koe(n){return n==null||(Xy||(Xy=document.createElementNS("http://www.w3.org/2000/svg","g")),Xy.setAttribute("transform",n),!(n=Xy.transform.baseVal.consolidate()))?IA:(n=n.matrix,tH(n.a,n.b,n.c,n.d,n.e,n.f))}function iH(n,e,t,i){function s(c){return c.length?c.pop()+" ":""}function o(c,d,u,h,f,g){if(c!==u||d!==h){var p=f.push("translate(",null,e,null,t);g.push({i:p-4,x:$r(c,u)},{i:p-2,x:$r(d,h)})}else(u||h)&&f.push("translate("+u+e+h+t)}function r(c,d,u,h){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),h.push({i:u.push(s(u)+"rotate(",null,i)-2,x:$r(c,d)})):d&&u.push(s(u)+"rotate("+d+i)}function a(c,d,u,h){c!==d?h.push({i:u.push(s(u)+"skewX(",null,i)-2,x:$r(c,d)}):d&&u.push(s(u)+"skewX("+d+i)}function l(c,d,u,h,f,g){if(c!==u||d!==h){var p=f.push(s(f)+"scale(",null,",",null,")");g.push({i:p-4,x:$r(c,u)},{i:p-2,x:$r(d,h)})}else(u!==1||h!==1)&&f.push(s(f)+"scale("+u+","+h+")")}return function(c,d){var u=[],h=[];return c=n(c),d=n(d),o(c.translateX,c.translateY,d.translateX,d.translateY,u,h),r(c.rotate,d.rotate,u,h),a(c.skewX,d.skewX,u,h),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,u,h),c=d=null,function(f){for(var g=-1,p=h.length,_;++g<p;)u[(_=h[g]).i]=_.x(f);return u.join("")}}}var Eoe=iH(Doe,"px, ","px)","deg)"),Aoe=iH(koe,", ",")",")"),Ioe=1e-12;function JO(n){return((n=Math.exp(n))+1/n)/2}function Toe(n){return((n=Math.exp(n))-1/n)/2}function Noe(n){return((n=Math.exp(2*n))-1)/(n+1)}const Roe=function n(e,t,i){function s(o,r){var a=o[0],l=o[1],c=o[2],d=r[0],u=r[1],h=r[2],f=d-a,g=u-l,p=f*f+g*g,_,v;if(p<Ioe)v=Math.log(h/c)/e,_=function(x){return[a+x*f,l+x*g,c*Math.exp(e*x*v)]};else{var b=Math.sqrt(p),y=(h*h-c*c+i*p)/(2*c*t*b),w=(h*h-c*c-i*p)/(2*h*t*b),C=Math.log(Math.sqrt(y*y+1)-y),L=Math.log(Math.sqrt(w*w+1)-w);v=(L-C)/e,_=function(x){var D=x*v,k=JO(C),P=c/(t*b)*(k*Noe(e*D+C)-Toe(C));return[a+P*f,l+P*g,c*k/JO(e*D+C)]}}return _.duration=v*1e3*e/Math.SQRT2,_}return s.rho=function(o){var r=Math.max(.001,+o),a=r*r,l=a*a;return n(r,a,l)},s}(Math.SQRT2,2,4);function nH(n){return function(e,t){var i=n((e=xA(e)).h,(t=xA(t)).h),s=Yn(e.s,t.s),o=Yn(e.l,t.l),r=Yn(e.opacity,t.opacity);return function(a){return e.h=i(a),e.s=s(a),e.l=o(a),e.opacity=r(a),e+""}}}const Moe=nH(GL);var Poe=nH(Yn);function Ooe(n,e){var t=Yn((n=LA(n)).l,(e=LA(e)).l),i=Yn(n.a,e.a),s=Yn(n.b,e.b),o=Yn(n.opacity,e.opacity);return function(r){return n.l=t(r),n.a=i(r),n.b=s(r),n.opacity=o(r),n+""}}function sH(n){return function(e,t){var i=n((e=DA(e)).h,(t=DA(t)).h),s=Yn(e.c,t.c),o=Yn(e.l,t.l),r=Yn(e.opacity,t.opacity);return function(a){return e.h=i(a),e.c=s(a),e.l=o(a),e.opacity=r(a),e+""}}}const Foe=sH(GL);var Boe=sH(Yn);function oH(n){return function e(t){t=+t;function i(s,o){var r=n((s=kA(s)).h,(o=kA(o)).h),a=Yn(s.s,o.s),l=Yn(s.l,o.l),c=Yn(s.opacity,o.opacity);return function(d){return s.h=r(d),s.s=a(d),s.l=l(Math.pow(d,t)),s.opacity=c(d),s+""}}return i.gamma=e,i}(1)}const Woe=oH(GL);var Voe=oH(Yn);function h4(n,e){e===void 0&&(e=n,n=pu);for(var t=0,i=e.length-1,s=e[0],o=new Array(i<0?0:i);t<i;)o[t]=n(s,s=e[++t]);return function(r){var a=Math.max(0,Math.min(i-1,Math.floor(r*=i)));return o[a](r-a)}}function zoe(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n(i/(e-1));return t}const Hoe=Object.freeze(Object.defineProperty({__proto__:null,interpolate:pu,interpolateArray:woe,interpolateBasis:qz,interpolateBasisClosed:Gz,interpolateCubehelix:Woe,interpolateCubehelixLong:Voe,interpolateDate:Qz,interpolateDiscrete:xoe,interpolateHcl:Foe,interpolateHclLong:Boe,interpolateHsl:Moe,interpolateHslLong:Poe,interpolateHue:Loe,interpolateLab:Ooe,interpolateNumber:$r,interpolateNumberArray:u4,interpolateObject:Jz,interpolateRgb:EA,interpolateRgbBasis:voe,interpolateRgbBasisClosed:yoe,interpolateRound:T1,interpolateString:eH,interpolateTransformCss:Eoe,interpolateTransformSvg:Aoe,interpolateZoom:Roe,piecewise:h4,quantize:zoe},Symbol.toStringTag,{value:"Module"}));function $oe(n){return function(){return n}}function TA(n){return+n}var eF=[0,1];function bo(n){return n}function NA(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:$oe(isNaN(e)?NaN:.5)}function Uoe(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function joe(n,e,t){var i=n[0],s=n[1],o=e[0],r=e[1];return s<i?(i=NA(s,i),o=t(r,o)):(i=NA(i,s),o=t(o,r)),function(a){return o(i(a))}}function qoe(n,e,t){var i=Math.min(n.length,e.length)-1,s=new Array(i),o=new Array(i),r=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++r<i;)s[r]=NA(n[r],n[r+1]),o[r]=t(e[r],e[r+1]);return function(a){var l=Wd(n,a,1,i)-1;return o[l](s[l](a))}}function N1(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function KL(){var n=eF,e=eF,t=pu,i,s,o,r=bo,a,l,c;function d(){var h=Math.min(n.length,e.length);return r!==bo&&(r=Uoe(n[0],n[h-1])),a=h>2?qoe:joe,l=c=null,u}function u(h){return h==null||isNaN(h=+h)?o:(l||(l=a(n.map(i),e,t)))(i(r(h)))}return u.invert=function(h){return r(s((c||(c=a(e,n.map(i),$r)))(h)))},u.domain=function(h){return arguments.length?(n=Array.from(h,TA),d()):n.slice()},u.range=function(h){return arguments.length?(e=Array.from(h),d()):e.slice()},u.rangeRound=function(h){return e=Array.from(h),t=T1,d()},u.clamp=function(h){return arguments.length?(r=h?!0:bo,d()):r!==bo},u.interpolate=function(h){return arguments.length?(t=h,d()):t},u.unknown=function(h){return arguments.length?(o=h,u):o},function(h,f){return i=h,s=f,d()}}function rH(){return KL()(bo,bo)}function aH(n,e,t,i){var s=Vd(n,e,t),o;switch(i=zd(i??",f"),i.type){case"s":{var r=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(o=bV(s,r))&&(i.precision=o),PM(i,r)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=vV(s,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=_V(s))&&(i.precision=o-(i.type==="%")*2);break}}return ls(i)}function If(n){var e=n.domain;return n.ticks=function(t){var i=e();return dS(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var s=e();return aH(s[0],s[s.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),s=0,o=i.length-1,r=i[s],a=i[o],l,c,d=10;for(a<r&&(c=r,r=a,a=c,c=s,s=o,o=c);d-- >0;){if(c=hA(r,a,t),c===l)return i[s]=r,i[o]=a,e(i);if(c>0)r=Math.floor(r/c)*c,a=Math.ceil(a/c)*c;else if(c<0)r=Math.ceil(r*c)/c,a=Math.floor(a*c)/c;else break;l=c}return n},n}function lH(){var n=rH();return n.copy=function(){return N1(n,lH())},rl.apply(n,arguments),If(n)}function cH(n){var e;function t(i){return i==null||isNaN(i=+i)?e:i}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=Array.from(i,TA),t):n.slice()},t.unknown=function(i){return arguments.length?(e=i,t):e},t.copy=function(){return cH(n).unknown(e)},n=arguments.length?Array.from(n,TA):[0,1],If(t)}function dH(n,e){n=n.slice();var t=0,i=n.length-1,s=n[t],o=n[i],r;return o<s&&(r=t,t=i,i=r,r=s,s=o,o=r),n[t]=e.floor(s),n[i]=e.ceil(o),n}function tF(n){return Math.log(n)}function iF(n){return Math.exp(n)}function Goe(n){return-Math.log(-n)}function Koe(n){return-Math.exp(-n)}function Yoe(n){return isFinite(n)?+("1e"+n):n<0?0:n}function Zoe(n){return n===10?Yoe:n===Math.E?Math.exp:e=>Math.pow(n,e)}function Xoe(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function nF(n){return(e,t)=>-n(-e,t)}function f4(n){const e=n(tF,iF),t=e.domain;let i=10,s,o;function r(){return s=Xoe(i),o=Zoe(i),t()[0]<0?(s=nF(s),o=nF(o),n(Goe,Koe)):n(tF,iF),e}return e.base=function(a){return arguments.length?(i=+a,r()):i},e.domain=function(a){return arguments.length?(t(a),r()):t()},e.ticks=a=>{const l=t();let c=l[0],d=l[l.length-1];const u=d<c;u&&([c,d]=[d,c]);let h=s(c),f=s(d),g,p;const _=a==null?10:+a;let v=[];if(!(i%1)&&f-h<_){if(h=Math.floor(h),f=Math.ceil(f),c>0){for(;h<=f;++h)for(g=1;g<i;++g)if(p=h<0?g/o(-h):g*o(h),!(p<c)){if(p>d)break;v.push(p)}}else for(;h<=f;++h)for(g=i-1;g>=1;--g)if(p=h>0?g/o(-h):g*o(h),!(p<c)){if(p>d)break;v.push(p)}v.length*2<_&&(v=dS(c,d,_))}else v=dS(h,f,Math.min(f-h,_)).map(o);return u?v.reverse():v},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=zd(l)).precision==null&&(l.trim=!0),l=ls(l)),a===1/0)return l;const c=Math.max(1,i*a/e.ticks().length);return d=>{let u=d/o(Math.round(s(d)));return u*i<i-.5&&(u*=i),u<=c?l(d):""}},e.nice=()=>t(dH(t(),{floor:a=>o(Math.floor(s(a))),ceil:a=>o(Math.ceil(s(a)))})),e}function g4(){const n=f4(KL()).domain([1,10]);return n.copy=()=>N1(n,g4()).base(n.base()),rl.apply(n,arguments),n}function sF(n){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/n))}}function oF(n){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*n}}function p4(n){var e=1,t=n(sF(e),oF(e));return t.constant=function(i){return arguments.length?n(sF(e=+i),oF(e)):e},If(t)}function uH(){var n=p4(KL());return n.copy=function(){return N1(n,uH()).constant(n.constant())},rl.apply(n,arguments)}function rF(n){return function(e){return e<0?-Math.pow(-e,n):Math.pow(e,n)}}function Qoe(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function Joe(n){return n<0?-n*n:n*n}function m4(n){var e=n(bo,bo),t=1;function i(){return t===1?n(bo,bo):t===.5?n(Qoe,Joe):n(rF(t),rF(1/t))}return e.exponent=function(s){return arguments.length?(t=+s,i()):t},If(e)}function _4(){var n=m4(KL());return n.copy=function(){return N1(n,_4()).exponent(n.exponent())},rl.apply(n,arguments),n}function ere(){return _4.apply(null,arguments).exponent(.5)}function hH(){var n=[],e=[],t=[],i;function s(){var r=0,a=Math.max(1,e.length);for(t=new Array(a-1);++r<a;)t[r-1]=pV(n,r/a);return o}function o(r){return r==null||isNaN(r=+r)?i:e[Wd(t,r)]}return o.invertExtent=function(r){var a=e.indexOf(r);return a<0?[NaN,NaN]:[a>0?t[a-1]:n[0],a<t.length?t[a]:n[n.length-1]]},o.domain=function(r){if(!arguments.length)return n.slice();n=[];for(let a of r)a!=null&&!isNaN(a=+a)&&n.push(a);return n.sort(S_),s()},o.range=function(r){return arguments.length?(e=Array.from(r),s()):e.slice()},o.unknown=function(r){return arguments.length?(i=r,o):i},o.quantiles=function(){return t.slice()},o.copy=function(){return hH().domain(n).range(e).unknown(i)},rl.apply(o,arguments)}function fH(){var n=0,e=1,t=1,i=[.5],s=[0,1],o;function r(l){return l!=null&&l<=l?s[Wd(i,l,0,t)]:o}function a(){var l=-1;for(i=new Array(t);++l<t;)i[l]=((l+1)*e-(l-t)*n)/(t+1);return r}return r.domain=function(l){return arguments.length?([n,e]=l,n=+n,e=+e,a()):[n,e]},r.range=function(l){return arguments.length?(t=(s=Array.from(l)).length-1,a()):s.slice()},r.invertExtent=function(l){var c=s.indexOf(l);return c<0?[NaN,NaN]:c<1?[n,i[0]]:c>=t?[i[t-1],e]:[i[c-1],i[c]]},r.unknown=function(l){return arguments.length&&(o=l),r},r.thresholds=function(){return i.slice()},r.copy=function(){return fH().domain([n,e]).range(s).unknown(o)},rl.apply(If(r),arguments)}function gH(){var n=[.5],e=[0,1],t,i=1;function s(o){return o!=null&&o<=o?e[Wd(n,o,0,i)]:t}return s.domain=function(o){return arguments.length?(n=Array.from(o),i=Math.min(n.length,e.length-1),s):n.slice()},s.range=function(o){return arguments.length?(e=Array.from(o),i=Math.min(n.length,e.length-1),s):e.slice()},s.invertExtent=function(o){var r=e.indexOf(o);return[n[r-1],n[r]]},s.unknown=function(o){return arguments.length?(t=o,s):t},s.copy=function(){return gH().domain(n).range(e).unknown(t)},rl.apply(s,arguments)}function tre(n){return new Date(n)}function ire(n){return n instanceof Date?+n:+new Date(+n)}function b4(n,e,t,i,s,o,r,a,l,c){var d=rH(),u=d.invert,h=d.domain,f=c(".%L"),g=c(":%S"),p=c("%I:%M"),_=c("%I %p"),v=c("%a %d"),b=c("%b %d"),y=c("%B"),w=c("%Y");function C(L){return(l(L)<L?f:a(L)<L?g:r(L)<L?p:o(L)<L?_:i(L)<L?s(L)<L?v:b:t(L)<L?y:w)(L)}return d.invert=function(L){return new Date(u(L))},d.domain=function(L){return arguments.length?h(Array.from(L,ire)):h().map(tre)},d.ticks=function(L){var x=h();return n(x[0],x[x.length-1],L??10)},d.tickFormat=function(L,x){return x==null?C:c(x)},d.nice=function(L){var x=h();return(!L||typeof L.range!="function")&&(L=e(x[0],x[x.length-1],L??10)),L?h(dH(x,L)):d},d.copy=function(){return N1(d,b4(n,e,t,i,s,o,r,a,l,c))},d}function nre(){return rl.apply(b4(OJ,FJ,Ka,lb,D1,yd,AL,kL,ql,BM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function sre(){return rl.apply(b4(MJ,PJ,Ya,cb,k1,Bh,IL,EL,ql,WM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function YL(){var n=0,e=1,t,i,s,o,r=bo,a=!1,l;function c(u){return u==null||isNaN(u=+u)?l:r(s===0?.5:(u=(o(u)-t)*s,a?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([n,e]=u,t=o(n=+n),i=o(e=+e),s=t===i?0:1/(i-t),c):[n,e]},c.clamp=function(u){return arguments.length?(a=!!u,c):a},c.interpolator=function(u){return arguments.length?(r=u,c):r};function d(u){return function(h){var f,g;return arguments.length?([f,g]=h,r=u(f,g),c):[r(0),r(1)]}}return c.range=d(pu),c.rangeRound=d(T1),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return o=u,t=u(n),i=u(e),s=t===i?0:1/(i-t),c}}function mu(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function v4(){var n=If(YL()(bo));return n.copy=function(){return mu(n,v4())},fu.apply(n,arguments)}function pH(){var n=f4(YL()).domain([1,10]);return n.copy=function(){return mu(n,pH()).base(n.base())},fu.apply(n,arguments)}function mH(){var n=p4(YL());return n.copy=function(){return mu(n,mH()).constant(n.constant())},fu.apply(n,arguments)}function y4(){var n=m4(YL());return n.copy=function(){return mu(n,y4()).exponent(n.exponent())},fu.apply(n,arguments)}function ore(){return y4.apply(null,arguments).exponent(.5)}function ZL(){var n=0,e=.5,t=1,i=1,s,o,r,a,l,c=bo,d,u=!1,h;function f(p){return isNaN(p=+p)?h:(p=.5+((p=+d(p))-o)*(i*p<i*o?a:l),c(u?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([n,e,t]=p,s=d(n=+n),o=d(e=+e),r=d(t=+t),a=s===o?0:.5/(o-s),l=o===r?0:.5/(r-o),i=o<s?-1:1,f):[n,e,t]},f.clamp=function(p){return arguments.length?(u=!!p,f):u},f.interpolator=function(p){return arguments.length?(c=p,f):c};function g(p){return function(_){var v,b,y;return arguments.length?([v,b,y]=_,c=h4(p,[v,b,y]),f):[c(0),c(.5),c(1)]}}return f.range=g(pu),f.rangeRound=g(T1),f.unknown=function(p){return arguments.length?(h=p,f):h},function(p){return d=p,s=p(n),o=p(e),r=p(t),a=s===o?0:.5/(o-s),l=o===r?0:.5/(r-o),i=o<s?-1:1,f}}function _H(){var n=If(ZL()(bo));return n.copy=function(){return mu(n,_H())},fu.apply(n,arguments)}function bH(){var n=f4(ZL()).domain([.1,1,10]);return n.copy=function(){return mu(n,bH()).base(n.base())},fu.apply(n,arguments)}function vH(){var n=p4(ZL());return n.copy=function(){return mu(n,vH()).constant(n.constant())},fu.apply(n,arguments)}function w4(){var n=m4(ZL());return n.copy=function(){return mu(n,w4()).exponent(n.exponent())},fu.apply(n,arguments)}function rre(){return w4.apply(null,arguments).exponent(.5)}function C4(n,e,t){const i=n-e+t*2;return n?i>0?i:1:0}const are="identity",lm="linear",jd="log",R1="pow",M1="sqrt",XL="symlog",yH="time",wH="utc",ja="sequential",Gm="diverging",RA="quantile",CH="quantize",SH="threshold",S4="ordinal",MA="point",xH="band",x4="bin-ordinal",Vn="continuous",P1="discrete",O1="discretizing",Sr="interpolating",LH="temporal";function lre(n){return function(e){let t=e[0],i=e[1],s;return i<t&&(s=t,t=i,i=s),[n.invert(t),n.invert(i)]}}function cre(n){return function(e){const t=n.range();let i=e[0],s=e[1],o=-1,r,a,l,c;for(s<i&&(a=i,i=s,s=a),l=0,c=t.length;l<c;++l)t[l]>=i&&t[l]<=s&&(o<0&&(o=l),r=l);if(!(o<0))return i=n.invertExtent(t[o]),s=n.invertExtent(t[r]),[i[0]===void 0?i[1]:i[0],s[1]===void 0?s[0]:s[1]]}}function L4(){const n=a4().unknown(void 0),e=n.domain,t=n.range;let i=[0,1],s,o,r=!1,a=0,l=0,c=.5;delete n.unknown;function d(){const u=e().length,h=i[1]<i[0],f=i[1-h],g=C4(u,a,l);let p=i[h-0];s=(f-p)/(g||1),r&&(s=Math.floor(s)),p+=(f-p-s*(u-a))*c,o=s*(1-a),r&&(p=Math.round(p),o=Math.round(o));const _=ab(u).map(v=>p+s*v);return t(h?_.reverse():_)}return n.domain=function(u){return arguments.length?(e(u),d()):e()},n.range=function(u){return arguments.length?(i=[+u[0],+u[1]],d()):i.slice()},n.rangeRound=function(u){return i=[+u[0],+u[1]],r=!0,d()},n.bandwidth=function(){return o},n.step=function(){return s},n.round=function(u){return arguments.length?(r=!!u,d()):r},n.padding=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),a=l,d()):a},n.paddingInner=function(u){return arguments.length?(a=Math.max(0,Math.min(1,u)),d()):a},n.paddingOuter=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),d()):l},n.align=function(u){return arguments.length?(c=Math.max(0,Math.min(1,u)),d()):c},n.invertRange=function(u){if(u[0]==null||u[1]==null)return;const h=i[1]<i[0],f=h?t().reverse():t(),g=f.length-1;let p=+u[0],_=+u[1],v,b,y;if(!(p!==p||_!==_)&&(_<p&&(y=p,p=_,_=y),!(_<f[0]||p>i[1-h])))return v=Math.max(0,Wd(f,p)-1),b=p===_?v:Wd(f,_)-1,p-f[v]>o+1e-10&&++v,h&&(y=v,v=g-b,b=g-y),v>b?void 0:e().slice(v,b+1)},n.invert=function(u){const h=n.invertRange([u,u]);return h&&h[0]},n.copy=function(){return L4().domain(e()).range(i).round(r).paddingInner(a).paddingOuter(l).align(c)},d()}function DH(n){const e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,n.copy=function(){return DH(e())},n}function dre(){return DH(L4().paddingInner(1))}var ure=Array.prototype.map;function hre(n){return ure.call(n,rb)}const fre=Array.prototype.slice;function kH(){let n=[],e=[];function t(i){return i==null||i!==i?void 0:e[(Wd(n,i)-1)%e.length]}return t.domain=function(i){return arguments.length?(n=hre(i),t):n.slice()},t.range=function(i){return arguments.length?(e=fre.call(i),t):e.slice()},t.tickFormat=function(i,s){return aH(n[0],Jr(n),i??10,s)},t.copy=function(){return kH().domain(t.domain()).range(t.range())},t}const CS=new Map,gre=Symbol("vega_scale");function pre(n){return n[gre]=!0,n}function mre(n,e,t){const i=function(){const o=e();return o.invertRange||(o.invertRange=o.invert?lre(o):o.invertExtent?cre(o):void 0),o.type=n,pre(o)};return i.metadata=lS(dA(t)),i}function ei(n,e,t){return arguments.length>1?(CS.set(n,mre(n,e,t)),this):_re(n)?CS.get(n):void 0}ei(are,cH);ei(lm,lH,Vn);ei(jd,g4,[Vn,jd]);ei(R1,_4,Vn);ei(M1,ere,Vn);ei(XL,uH,Vn);ei(yH,nre,[Vn,LH]);ei(wH,sre,[Vn,LH]);ei(ja,v4,[Vn,Sr]);ei(`${ja}-${lm}`,v4,[Vn,Sr]);ei(`${ja}-${jd}`,pH,[Vn,Sr,jd]);ei(`${ja}-${R1}`,y4,[Vn,Sr]);ei(`${ja}-${M1}`,ore,[Vn,Sr]);ei(`${ja}-${XL}`,mH,[Vn,Sr]);ei(`${Gm}-${lm}`,_H,[Vn,Sr]);ei(`${Gm}-${jd}`,bH,[Vn,Sr,jd]);ei(`${Gm}-${R1}`,w4,[Vn,Sr]);ei(`${Gm}-${M1}`,rre,[Vn,Sr]);ei(`${Gm}-${XL}`,vH,[Vn,Sr]);ei(RA,hH,[O1,RA]);ei(CH,fH,O1);ei(SH,gH,O1);ei(x4,kH,[P1,O1]);ei(S4,a4,P1);ei(xH,L4,P1);ei(MA,dre,P1);function _re(n){return CS.has(n)}function F1(n,e){const t=CS.get(n);return t&&t.metadata[e]}function os(n){return F1(n,Vn)}function qd(n){return F1(n,P1)}function ih(n){return F1(n,O1)}function EH(n){return F1(n,jd)}function QL(n){return F1(n,Sr)}function bre(n,e){const t=e[0],i=Jr(e)-t;return function(s){return n(t+s*i)}}function JL(n,e,t){return h4(AH(e||"rgb",t),n)}function vre(n,e){const t=new Array(e),i=e+1;for(let s=0;s<e;)t[s]=n(++s/i);return t}function AH(n,e){const t=Hoe[yre(n)];return e!=null&&t&&t.gamma?t.gamma(e):t}function yre(n){return"interpolate"+n.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")}const wre={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},Cre={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function IH(n){const e=n.length/6|0,t=new Array(e);for(let i=0;i<e;)t[i]="#"+n.slice(i*6,++i*6);return t}function TH(n,e){for(const t in n)D4(t,e(n[t]))}const aF={};TH(Cre,IH);TH(wre,n=>JL(IH(n)));function D4(n,e){return n=n&&n.toLowerCase(),arguments.length>1?(aF[n]=e,this):aF[n]}function _i(n,e=n){if(/^[A-Za-z0-9_]+$/.test(n)){const t=new Function("datum",`return datum[${JSON.stringify(n)}]`);return cu(t,[n],e)}else return SL(n)}const Sre="RawCode",xre="Literal",Lre="Property",Dre="Identifier",kre="ArrayExpression",Ere="BinaryExpression",Are="CallExpression",Ire="ConditionalExpression",Tre="LogicalExpression",Nre="MemberExpression",Rre="ObjectExpression",Mre="UnaryExpression";function aa(n){this.type=n}aa.prototype.visit=function(n){let e,t,i;if(n(this))return 1;for(e=Pre(this),t=0,i=e.length;t<i;++t)if(e[t].visit(n))return 1};function Pre(n){switch(n.type){case kre:return n.elements;case Ere:case Tre:return[n.left,n.right];case Are:return[n.callee].concat(n.arguments);case Ire:return[n.test,n.consequent,n.alternate];case Nre:return[n.object,n.property];case Rre:return n.properties;case Lre:return[n.key,n.value];case Mre:return[n.argument];case Dre:case xre:case Sre:default:return[]}}var al,Be,ie,Is,ai,eD=1,B1=2,lf=3,_u=4,tD=5,Tf=6,fo=7,W1=8,Ore=9;al={};al[eD]="Boolean";al[B1]="<end>";al[lf]="Identifier";al[_u]="Keyword";al[tD]="Null";al[Tf]="Numeric";al[fo]="Punctuator";al[W1]="String";al[Ore]="RegularExpression";var Fre="ArrayExpression",Bre="BinaryExpression",Wre="CallExpression",Vre="ConditionalExpression",NH="Identifier",zre="Literal",Hre="LogicalExpression",$re="MemberExpression",Ure="ObjectExpression",jre="Property",qre="UnaryExpression",Zn="Unexpected token %0",Gre="Unexpected number",Kre="Unexpected string",Yre="Unexpected identifier",Zre="Unexpected reserved word",Xre="Unexpected end of input",PA="Invalid regular expression",c2="Invalid regular expression: missing /",RH="Octal literals are not allowed in strict mode.",Qre="Duplicate data property in object literal not allowed in strict mode",rs="ILLEGAL",xb="Disabled.",Jre=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),eae=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function iD(n,e){if(!n)throw new Error("ASSERT: "+e)}function Dl(n){return n>=48&&n<=57}function k4(n){return"0123456789abcdefABCDEF".indexOf(n)>=0}function x_(n){return"01234567".indexOf(n)>=0}function tae(n){return n===32||n===9||n===11||n===12||n===160||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(n)>=0}function Lb(n){return n===10||n===13||n===8232||n===8233}function V1(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n===92||n>=128&&Jre.test(String.fromCharCode(n))}function SS(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57||n===92||n>=128&&eae.test(String.fromCharCode(n))}const iae={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function MH(){for(;ie<Is;){const n=Be.charCodeAt(ie);if(tae(n)||Lb(n))++ie;else break}}function OA(n){var e,t,i,s=0;for(t=n==="u"?4:2,e=0;e<t;++e)ie<Is&&k4(Be[ie])?(i=Be[ie++],s=s*16+"0123456789abcdef".indexOf(i.toLowerCase())):qt({},Zn,rs);return String.fromCharCode(s)}function nae(){var n,e,t,i;for(n=Be[ie],e=0,n==="}"&&qt({},Zn,rs);ie<Is&&(n=Be[ie++],!!k4(n));)e=e*16+"0123456789abcdef".indexOf(n.toLowerCase());return(e>1114111||n!=="}")&&qt({},Zn,rs),e<=65535?String.fromCharCode(e):(t=(e-65536>>10)+55296,i=(e-65536&1023)+56320,String.fromCharCode(t,i))}function PH(){var n,e;for(n=Be.charCodeAt(ie++),e=String.fromCharCode(n),n===92&&(Be.charCodeAt(ie)!==117&&qt({},Zn,rs),++ie,n=OA("u"),(!n||n==="\\"||!V1(n.charCodeAt(0)))&&qt({},Zn,rs),e=n);ie<Is&&(n=Be.charCodeAt(ie),!!SS(n));)++ie,e+=String.fromCharCode(n),n===92&&(e=e.substr(0,e.length-1),Be.charCodeAt(ie)!==117&&qt({},Zn,rs),++ie,n=OA("u"),(!n||n==="\\"||!SS(n.charCodeAt(0)))&&qt({},Zn,rs),e+=n);return e}function sae(){var n,e;for(n=ie++;ie<Is;){if(e=Be.charCodeAt(ie),e===92)return ie=n,PH();if(SS(e))++ie;else break}return Be.slice(n,ie)}function oae(){var n,e,t;return n=ie,e=Be.charCodeAt(ie)===92?PH():sae(),e.length===1?t=lf:iae.hasOwnProperty(e)?t=_u:e==="null"?t=tD:e==="true"||e==="false"?t=eD:t=lf,{type:t,value:e,start:n,end:ie}}function d2(){var n=ie,e=Be.charCodeAt(ie),t,i=Be[ie],s,o,r;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ie,{type:fo,value:String.fromCharCode(e),start:n,end:ie};default:if(t=Be.charCodeAt(ie+1),t===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ie+=2,{type:fo,value:String.fromCharCode(e)+String.fromCharCode(t),start:n,end:ie};case 33:case 61:return ie+=2,Be.charCodeAt(ie)===61&&++ie,{type:fo,value:Be.slice(n,ie),start:n,end:ie}}}if(r=Be.substr(ie,4),r===">>>=")return ie+=4,{type:fo,value:r,start:n,end:ie};if(o=r.substr(0,3),o===">>>"||o==="<<="||o===">>=")return ie+=3,{type:fo,value:o,start:n,end:ie};if(s=o.substr(0,2),i===s[1]&&"+-<>&|".indexOf(i)>=0||s==="=>")return ie+=2,{type:fo,value:s,start:n,end:ie};if(s==="//"&&qt({},Zn,rs),"<>=!+-*%&|^/".indexOf(i)>=0)return++ie,{type:fo,value:i,start:n,end:ie};qt({},Zn,rs)}function rae(n){let e="";for(;ie<Is&&k4(Be[ie]);)e+=Be[ie++];return e.length===0&&qt({},Zn,rs),V1(Be.charCodeAt(ie))&&qt({},Zn,rs),{type:Tf,value:parseInt("0x"+e,16),start:n,end:ie}}function aae(n){let e="0"+Be[ie++];for(;ie<Is&&x_(Be[ie]);)e+=Be[ie++];return(V1(Be.charCodeAt(ie))||Dl(Be.charCodeAt(ie)))&&qt({},Zn,rs),{type:Tf,value:parseInt(e,8),octal:!0,start:n,end:ie}}function lF(){var n,e,t;if(t=Be[ie],iD(Dl(t.charCodeAt(0))||t===".","Numeric literal must start with a decimal digit or a decimal point"),e=ie,n="",t!=="."){if(n=Be[ie++],t=Be[ie],n==="0"){if(t==="x"||t==="X")return++ie,rae(e);if(x_(t))return aae(e);t&&Dl(t.charCodeAt(0))&&qt({},Zn,rs)}for(;Dl(Be.charCodeAt(ie));)n+=Be[ie++];t=Be[ie]}if(t==="."){for(n+=Be[ie++];Dl(Be.charCodeAt(ie));)n+=Be[ie++];t=Be[ie]}if(t==="e"||t==="E")if(n+=Be[ie++],t=Be[ie],(t==="+"||t==="-")&&(n+=Be[ie++]),Dl(Be.charCodeAt(ie)))for(;Dl(Be.charCodeAt(ie));)n+=Be[ie++];else qt({},Zn,rs);return V1(Be.charCodeAt(ie))&&qt({},Zn,rs),{type:Tf,value:parseFloat(n),start:e,end:ie}}function lae(){var n="",e,t,i,s,o=!1;for(e=Be[ie],iD(e==="'"||e==='"',"String literal must starts with a quote"),t=ie,++ie;ie<Is;)if(i=Be[ie++],i===e){e="";break}else if(i==="\\")if(i=Be[ie++],!i||!Lb(i.charCodeAt(0)))switch(i){case"u":case"x":Be[ie]==="{"?(++ie,n+=nae()):n+=OA(i);break;case"n":n+=`
`;break;case"r":n+="\r";break;case"t":n+="	";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v";break;default:x_(i)?(s="01234567".indexOf(i),s!==0&&(o=!0),ie<Is&&x_(Be[ie])&&(o=!0,s=s*8+"01234567".indexOf(Be[ie++]),"0123".indexOf(i)>=0&&ie<Is&&x_(Be[ie])&&(s=s*8+"01234567".indexOf(Be[ie++]))),n+=String.fromCharCode(s)):n+=i;break}else i==="\r"&&Be[ie]===`
`&&++ie;else{if(Lb(i.charCodeAt(0)))break;n+=i}return e!==""&&qt({},Zn,rs),{type:W1,value:n,octal:o,start:t,end:ie}}function cae(n,e){let t=n;e.indexOf("u")>=0&&(t=t.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,s)=>{if(parseInt(s,16)<=1114111)return"x";qt({},PA)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(t)}catch{qt({},PA)}try{return new RegExp(n,e)}catch{return null}}function dae(){var n,e,t,i,s;for(n=Be[ie],iD(n==="/","Regular expression literal must start with a slash"),e=Be[ie++],t=!1,i=!1;ie<Is;)if(n=Be[ie++],e+=n,n==="\\")n=Be[ie++],Lb(n.charCodeAt(0))&&qt({},c2),e+=n;else if(Lb(n.charCodeAt(0)))qt({},c2);else if(t)n==="]"&&(t=!1);else if(n==="/"){i=!0;break}else n==="["&&(t=!0);return i||qt({},c2),s=e.substr(1,e.length-2),{value:s,literal:e}}function uae(){var n,e,t;for(e="",t="";ie<Is&&(n=Be[ie],!!SS(n.charCodeAt(0)));)++ie,n==="\\"&&ie<Is?qt({},Zn,rs):(t+=n,e+=n);return t.search(/[^gimuy]/g)>=0&&qt({},PA,t),{value:t,literal:e}}function hae(){var n,e,t,i;return ai=null,MH(),n=ie,e=dae(),t=uae(),i=cae(e.value,t.value),{literal:e.literal+t.literal,value:i,regex:{pattern:e.value,flags:t.value},start:n,end:ie}}function fae(n){return n.type===lf||n.type===_u||n.type===eD||n.type===tD}function OH(){if(MH(),ie>=Is)return{type:B1,start:ie,end:ie};const n=Be.charCodeAt(ie);return V1(n)?oae():n===40||n===41||n===59?d2():n===39||n===34?lae():n===46?Dl(Be.charCodeAt(ie+1))?lF():d2():Dl(n)?lF():d2()}function po(){const n=ai;return ie=n.end,ai=OH(),ie=n.end,n}function FH(){const n=ie;ai=OH(),ie=n}function gae(n){const e=new aa(Fre);return e.elements=n,e}function cF(n,e,t){const i=new aa(n==="||"||n==="&&"?Hre:Bre);return i.operator=n,i.left=e,i.right=t,i}function pae(n,e){const t=new aa(Wre);return t.callee=n,t.arguments=e,t}function mae(n,e,t){const i=new aa(Vre);return i.test=n,i.consequent=e,i.alternate=t,i}function E4(n){const e=new aa(NH);return e.name=n,e}function K0(n){const e=new aa(zre);return e.value=n.value,e.raw=Be.slice(n.start,n.end),n.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=n.regex),e}function dF(n,e,t){const i=new aa($re);return i.computed=n==="[",i.object=e,i.property=t,i.computed||(t.member=!0),i}function _ae(n){const e=new aa(Ure);return e.properties=n,e}function uF(n,e,t){const i=new aa(jre);return i.key=e,i.value=t,i.kind=n,i}function bae(n,e){const t=new aa(qre);return t.operator=n,t.argument=e,t.prefix=!0,t}function qt(n,e){var t,i=Array.prototype.slice.call(arguments,2),s=e.replace(/%(\d)/g,(o,r)=>(iD(r<i.length,"Message reference must be in range"),i[r]));throw t=new Error(s),t.index=ie,t.description=s,t}function nD(n){n.type===B1&&qt(n,Xre),n.type===Tf&&qt(n,Gre),n.type===W1&&qt(n,Kre),n.type===lf&&qt(n,Yre),n.type===_u&&qt(n,Zre),qt(n,Zn,n.value)}function Ts(n){const e=po();(e.type!==fo||e.value!==n)&&nD(e)}function Ri(n){return ai.type===fo&&ai.value===n}function u2(n){return ai.type===_u&&ai.value===n}function vae(){const n=[];for(ie=ai.start,Ts("[");!Ri("]");)Ri(",")?(po(),n.push(null)):(n.push(cf()),Ri("]")||Ts(","));return po(),gae(n)}function hF(){ie=ai.start;const n=po();return n.type===W1||n.type===Tf?(n.octal&&qt(n,RH),K0(n)):E4(n.value)}function yae(){var n,e,t,i;if(ie=ai.start,n=ai,n.type===lf)return t=hF(),Ts(":"),i=cf(),uF("init",t,i);if(n.type===B1||n.type===fo)nD(n);else return e=hF(),Ts(":"),i=cf(),uF("init",e,i)}function wae(){var n=[],e,t,i,s={},o=String;for(ie=ai.start,Ts("{");!Ri("}");)e=yae(),e.key.type===NH?t=e.key.name:t=o(e.key.value),i="$"+t,Object.prototype.hasOwnProperty.call(s,i)?qt({},Qre):s[i]=!0,n.push(e),Ri("}")||Ts(",");return Ts("}"),_ae(n)}function Cae(){Ts("(");const n=A4();return Ts(")"),n}const Sae={if:1};function xae(){var n,e,t;if(Ri("("))return Cae();if(Ri("["))return vae();if(Ri("{"))return wae();if(n=ai.type,ie=ai.start,n===lf||Sae[ai.value])t=E4(po().value);else if(n===W1||n===Tf)ai.octal&&qt(ai,RH),t=K0(po());else{if(n===_u)throw new Error(xb);n===eD?(e=po(),e.value=e.value==="true",t=K0(e)):n===tD?(e=po(),e.value=null,t=K0(e)):Ri("/")||Ri("/=")?(t=K0(hae()),FH()):nD(po())}return t}function Lae(){const n=[];if(Ts("("),!Ri(")"))for(;ie<Is&&(n.push(cf()),!Ri(")"));)Ts(",");return Ts(")"),n}function Dae(){ie=ai.start;const n=po();return fae(n)||nD(n),E4(n.value)}function kae(){return Ts("."),Dae()}function Eae(){Ts("[");const n=A4();return Ts("]"),n}function Aae(){var n,e,t;for(n=xae();;)if(Ri("."))t=kae(),n=dF(".",n,t);else if(Ri("("))e=Lae(),n=pae(n,e);else if(Ri("["))t=Eae(),n=dF("[",n,t);else break;return n}function fF(){const n=Aae();if(ai.type===fo&&(Ri("++")||Ri("--")))throw new Error(xb);return n}function gC(){var n,e;if(ai.type!==fo&&ai.type!==_u)e=fF();else{if(Ri("++")||Ri("--"))throw new Error(xb);if(Ri("+")||Ri("-")||Ri("~")||Ri("!"))n=po(),e=gC(),e=bae(n.value,e);else{if(u2("delete")||u2("void")||u2("typeof"))throw new Error(xb);e=fF()}}return e}function gF(n){let e=0;if(n.type!==fo&&n.type!==_u)return 0;switch(n.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function Iae(){var n,e,t,i,s,o,r,a,l,c;if(n=ai,l=gC(),i=ai,s=gF(i),s===0)return l;for(i.prec=s,po(),e=[n,ai],r=gC(),o=[l,i,r];(s=gF(ai))>0;){for(;o.length>2&&s<=o[o.length-2].prec;)r=o.pop(),a=o.pop().value,l=o.pop(),e.pop(),t=cF(a,l,r),o.push(t);i=po(),i.prec=s,o.push(i),e.push(ai),t=gC(),o.push(t)}for(c=o.length-1,t=o[c],e.pop();c>1;)e.pop(),t=cF(o[c-1].value,o[c-2],t),c-=2;return t}function cf(){var n,e,t;return n=Iae(),Ri("?")&&(po(),e=cf(),Ts(":"),t=cf(),n=mae(n,e,t)),n}function A4(){const n=cf();if(Ri(","))throw new Error(xb);return n}function Tae(n){Be=n,ie=0,Is=Be.length,ai=null,FH();const e=A4();if(ai.type!==B1)throw new Error("Unexpect token after expression.");return e}var Nae={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function BH(n){function e(r,a,l,c){let d=n(a[0]);return l&&(d=l+"("+d+")",l.lastIndexOf("new ",0)===0&&(d="("+d+")")),d+"."+r+(c<0?"":c===0?"()":"("+a.slice(1).map(n).join(",")+")")}function t(r,a,l){return c=>e(r,c,a,l)}const i="new Date",s="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(r){r.length<3&&Tn("Missing arguments to clamp function."),r.length>3&&Tn("Too many arguments to clamp function.");const a=r.map(n);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:t("getDate",i,0),day:t("getDay",i,0),year:t("getFullYear",i,0),month:t("getMonth",i,0),hours:t("getHours",i,0),minutes:t("getMinutes",i,0),seconds:t("getSeconds",i,0),milliseconds:t("getMilliseconds",i,0),time:t("getTime",i,0),timezoneoffset:t("getTimezoneOffset",i,0),utcdate:t("getUTCDate",i,0),utcday:t("getUTCDay",i,0),utcyear:t("getUTCFullYear",i,0),utcmonth:t("getUTCMonth",i,0),utchours:t("getUTCHours",i,0),utcminutes:t("getUTCMinutes",i,0),utcseconds:t("getUTCSeconds",i,0),utcmilliseconds:t("getUTCMilliseconds",i,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",s,0),lower:t("toLowerCase",s,0),substring:t("substring",s),split:t("split",s),trim:t("trim",s,0),regexp:o,test:t("test",o),if:function(r){r.length<3&&Tn("Missing arguments to if function."),r.length>3&&Tn("Too many arguments to if function.");const a=r.map(n);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Rae(n){const e=n&&n.length-1;return e&&(n[0]==='"'&&n[e]==='"'||n[0]==="'"&&n[e]==="'")?n.slice(1,-1):n}function Mae(n){n=n||{};const e=n.allowed?lS(n.allowed):{},t=n.forbidden?lS(n.forbidden):{},i=n.constants||Nae,s=(n.functions||BH)(u),o=n.globalvar,r=n.fieldvar,a=dr(o)?o:g=>`${o}["${g}"]`;let l={},c={},d=0;function u(g){if(ci(g))return g;const p=h[g.type];return p==null&&Tn("Unsupported type: "+g.type),p(g)}const h={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return d>0?p:Ig(t,p)?Tn("Illegal identifier: "+p):Ig(i,p)?i[p]:Ig(e,p)?p:(l[p]=1,a(p))},MemberExpression:g=>{const p=!g.computed,_=u(g.object);p&&(d+=1);const v=u(g.property);return _===r&&(c[Rae(v)]=1),p&&(d-=1),_+(p?"."+v:"["+v+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&Tn("Illegal callee type: "+g.callee.type);const p=g.callee.name,_=g.arguments,v=Ig(s,p)&&s[p];return v||Tn("Unrecognized function: "+p),dr(v)?v(_):v+"("+_.map(u).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(u).join(",")+"]",BinaryExpression:g=>"("+u(g.left)+" "+g.operator+" "+u(g.right)+")",UnaryExpression:g=>"("+g.operator+u(g.argument)+")",ConditionalExpression:g=>"("+u(g.test)+"?"+u(g.consequent)+":"+u(g.alternate)+")",LogicalExpression:g=>"("+u(g.left)+g.operator+u(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(u).join(",")+"}",Property:g=>{d+=1;const p=u(g.key);return d-=1,p+":"+u(g.value)}};function f(g){const p={code:u(g),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},p}return f.functions=s,f.constants=i,f}function WH(n,e,t){return t=(t-n)/(e-n),t=Math.max(0,Math.min(1,t)),t*t*(3-2*t)}function cm(n,e=0,t=1){return Math.max(e,Math.min(t,n))}function Pae(n,e,t){return cm((t-n)/(e-n),0,1)}const ll=1,bu=2,I4=4;var Eh,Y0;class pn{constructor(e){ve(this,Eh);Ui(this,"paramMediatorProvider",null);this.paramMediatorProvider=e,this.children=[],this.parent=void 0,this.completed=!1}get behavior(){return 0}reset(){this.completed=!1;for(const e of this.children)e.reset()}initialize(){}setParent(e){this.parent=e}addChild(e){if(e.parent)throw new Error("Cannot add the child! It already has a parent.");return this.children.push(e),e.setParent(this),De(this,Eh,Y0).call(this),this}adopt(e){e.parent&&e.parent.removeChild(e),this.addChild(e)}adoptChildrenOf(e){for(const t of e.children)this.adopt(t)}insertAsParent(e){var t;if(this.isRoot())throw new Error("Cannot insert a new parent for a root node!");e.parent=this.parent,this.parent.children[this.parent.children.indexOf(this)]=e,De(t=this.parent,Eh,Y0).call(t),this.parent=void 0,e.addChild(this)}removeChild(e){const t=this.children.indexOf(e);if(t>-1)this.children.splice(t,1),e.parent=void 0,De(this,Eh,Y0).call(this);else throw new Error("Trying to remove an unknown child node!")}excise(){var e;if(this.isRoot())throw new Error("Cannot excise root node!");if(this.isTerminal())this.parent.removeChild(this);else if(this.children.length==1){const t=this.children[0];t.setParent(this.parent),this.parent.children[this.parent.children.indexOf(this)]=t,De(e=this.parent,Eh,Y0).call(e),this.setParent(void 0),this.children.length=0}else throw new Error("Cannot excise a node that has multiple children!")}isRoot(){return!this.parent}isBranching(){return this.children.length>1}isTerminal(){return this.children.length==0}visit(e){e(this);for(const t of this.children)t.visit(e);e.afterChildren&&e.afterChildren(this)}subtreeToString(e=0){const t=this.children.map(i=>i.subtreeToString(e+1)).join("");return`${" ".repeat(e*2)}* ${this.constructor.name}${("identifier"in this&&this.identifier?": "+this.identifier:"")??""} 
${t}`}handle(e){this._propagate(e)}complete(){this.completed=!0;for(const e of this.children)e.complete()}beginBatch(e){for(const t of this.children)t.beginBatch(e)}get paramMediator(){if(this.paramMediatorProvider)return this.paramMediatorProvider.paramMediator;if(!this.parent)throw new Error("Cannot find paramMediator!");return this.parent.paramMediator}repropagate(){if(this.parent)this.parent.repropagate();else throw new Error("Cannot repropagate data, no FlowNode with stored data found!")}_propagate(e){}}Eh=new WeakSet,Y0=function(){this._propagate=Function("children",ab(this.children.length).map(e=>`const child${e} = children[${e}];`).join(`
`)+`return function propagate(datum) {${ab(this.children.length).map(e=>`child${e}.handle(datum);`).join(`
`)}}`)(this.children)};function VH(n){return n.type=="file"}function Oae(n){return n.type=="facet"}const Gd="_uniqueId",pF=1e4,mF=[null];class FA extends pn{get behavior(){return bu}constructor(e){super(),this.params=e,this.as=e.as??Gd,this._blocks=[],this._usedBlocks=0,this._id=-1}initialize(){}reset(){super.reset(),this._usedBlocks=0,this._id=-1}handle(e){e[this.as]=this._nextId(),this._propagate(e)}_nextId(){return++this._id%pF==0&&(this._id=this._getBlock()*pF),this._id}_getBlock(){return this._usedBlocks<this._blocks.length?this._blocks[this._usedBlocks++]:this._reserveBlock()}_reserveBlock(){const e=mF.length;return mF[e]=this,this._blocks.push(e),this._usedBlocks++,e}}function zH(n){return{type:"single",datum:n,uniqueId:n==null?void 0:n[Gd]}}function Fae(n,e,t=!0){if(!n||!e)return!1;if($H(n))return n.uniqueId==null?t:n.uniqueId===e[Gd];if(Bae(n))return n.uniqueIds.size==0?t:n.uniqueIds.has(e[Gd]);throw new Error("Not a selection: "+JSON.stringify(n))}function HH(n){return`selectionTest(${oD(n.param)}, datum, ${!!(n.empty??!0)})`}function $H(n){return n.type==="single"}function Bae(n){return n.type==="multi"}const UH={clamp:cm,isArray:Rs,isBoolean:L1,isDefined(n){return n!==void 0},isNumber:Js,isObject:Ms,isRegExp:UQ,isString:ci,isValid(n){return n!=null&&n===n},lerp:lV,linearstep:Pae,smoothstep:WH,selectionTest:Fae};function Wae(n){const e=BH(n);for(const t in UH)e[t]=`this.${t}`;return e}const Vae=Mae({forbidden:[],allowed:["datum","undefined"],globalvar:"globalObject",fieldvar:"datum",functions:Wae});function zae(n,e={}){try{const t=Tae(n),i=Vae(t),s=Function("datum","globalObject",`"use strict";
            try {
                return (${i.code});
            } catch (e) {
                throw new Error("Error evaluating expression: " + ${JSON.stringify(n)} + ", " + e.message, e);
            }`).bind(UH),o=r=>s(r,e);return o.fields=i.fields,o.globals=i.globals,o.code=i.code,o}catch(t){throw new Error(`Invalid expression: ${n}, ${t.message}`)}}var Jc,Ah,Rp,Mp,Hv;class Hae{constructor(e){ve(this,Jc,void 0);Ui(this,"paramListeners");ve(this,Ah,new Map);ve(this,Rp,new Map);ve(this,Mp,new Map);ve(this,Hv,void 0);gt(this,Hv,e??(()=>{})),gt(this,Jc,new Map),this.paramListeners=new Map}registerParam(e){const t=e.name;if("value"in e&&"expr"in e)throw new Error(`The parameter "${t}" must not have both value and expr properties!`);let i;if(e.push=="outer"){const s=this.findMediatorForParam(t);if(!s)throw new Error(`Parameter "${t}" not found in outer scope!`);const o=s.paramConfigs.get(t);if("expr"in o||"select"in o)throw new Error(`The outer parameter "${t}" must not have expr or select properties!`);i=s.getSetter(t),J(this,Ah).set(t,i)}else if("value"in e)i=this.allocateSetter(t,e.value);else if("expr"in e){const s=this.createExpression(e.expr),o=this.allocateSetter(t,s(null));s.addListener(()=>o(s(null))),i=r=>{}}else i=this.allocateSetter(t,null);return"select"in e&&(ci(e.select)?e.select:e.select.type)=="point"&&i(zH(null)),J(this,Mp).set(t,e),i}allocateSetter(e,t,i=!1){if(oD(e),J(this,Ah).has(e))throw new Error("Setter already allocated for parameter: "+e);const s=o=>{const r=J(this,Jc).get(e);if(o!==r){J(this,Jc).set(e,o);const a=this.paramListeners.get(e);if(a&&!i)for(const l of a)l()}};return s(t),J(this,Ah).set(e,s),s}getSetter(e){const t=J(this,Ah).get(e);if(!t)throw new Error("Setter not found for parameter: "+e);return t}getValue(e){return J(this,Jc).get(e)}findValue(e){const t=this.findMediatorForParam(e);return t==null?void 0:t.getValue(e)}get paramConfigs(){return J(this,Mp)}findMediatorForParam(e){var t;return J(this,Jc).has(e)?this:(t=J(this,Hv).call(this))==null?void 0:t.findMediatorForParam(e)}createExpression(e){if(J(this,Rp).has(e))return J(this,Rp).get(e);const t={},i=zae(e,t),s=new Map;for(const r of i.globals){const a=this.findMediatorForParam(r);if(!a)throw new Error(`Unknown variable "${r}" in expression: ${e}`);s.set(r,a),Object.defineProperty(t,r,{enumerable:!0,get(){return a.getValue(r)}})}const o=new Set;return i.addListener=r=>{for(const[a,l]of s){const c=l.paramListeners.get(a)??new Set;l.paramListeners.set(a,c),c.add(r),o.add(r)}},i.invalidate=()=>{var r;for(const[a,l]of s)for(const c of o)(r=l.paramListeners.get(a))==null||r.delete(c)},i.identifier=()=>i.code,J(this,Rp).set(e,i),i}evaluateAndGet(e){return this.createExpression(e)()}hasPointSelections(){for(const e of J(this,Mp).values())if(Uae(e)){const t=e.select;if(ci(t)){if(t=="point")return!0}else if(t.type=="point")return!0}return!1}}Jc=new WeakMap,Ah=new WeakMap,Rp=new WeakMap,Mp=new WeakMap,Hv=new WeakMap;function js(n){return typeof n=="object"&&n!=null&&"expr"in n&&ci(n.expr)}function Po(n){if(js(n))throw new Error(`ExprRef ${JSON.stringify(n)} not allowed here. Expected a scalar value.`);return n}function $ae(n){return("expr"in n||"bind"in n)&&!("select"in n)}function Uae(n){return!("expr"in n||"bind"in n)&&"select"in n}function sD(n,e,t){const i={...e},s=[],o=r=>{s.push(r),s.length===1&&queueMicrotask(()=>{t(s.slice()),s.length=0})};for(const[r,a]of Object.entries(e))if(js(a)){const l=n.createExpression(a.expr);t&&l.addListener(()=>o(r)),Object.defineProperty(i,r,{enumerable:!0,get(){return l()}})}else i[r]=a;return i}function oD(n){if(!/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(n))throw new Error(`Invalid parameter name: ${n}. Must be a valid JavaScript identifier.`);return n}function jae(n){return Object.assign(()=>n,{addListener:()=>{},invalidate:()=>{},identifier:()=>"constant",fields:[],globals:[],code:JSON.stringify(n)})}function _F(n,e,t){if(!n)return;function i(o){const r=o;return r.fields??(r.fields=[]),r.constant=r.fields.length===0,r.channelDef=e,r.channel=n,r.scaleChannel=((Wo(e)&&e.resolutionChannel)??(kb(n)&&n))||void 0,"param"in e?(r.predicate=t.createExpression(HH(e)),r.predicate.param=e.param,r.predicate.empty=e.empty??!0):(r.predicate=jae(!0),r.predicate.empty=!1),r.asNumberAccessor=()=>r,r}function s(o){if(js(o)){const r=i(t.createExpression(o.expr));if(r.fields.length>0)throw new Error("Expression in DatumDef/ValueDef cannot access data fields: "+o.expr);return r}else{const r=o;return i(()=>r)}}if(vu(e))try{return i(_i(e.field))}catch(o){throw new Error(`Invalid field definition: ${o.message}`)}else{if(H1(e))return i(t.createExpression(e.expr));if(z1(e))return s(e.datum);if(_r(e))return s(e.value);throw new Error(`Invalid channel definition: ${JSON.stringify(e)}. Cannot create an accessor for channel ${n}!`)}}function qae(n,e,t){const i=[];if(Zae(e)||Xae(e)){const s=Array.isArray(e.condition)?e.condition:[e.condition];for(const o of s)i.push(_F(n,o,t))}if(i.push(_F(n,e,t)),i.filter(s=>!s.constant).length>1)throw new Error("Only one accessor can be non-constant. Channel: "+n);return i}function Gae(n,e){const t={},i=s=>{var o;return(o=n.getScaleResolution(s))==null?void 0:o.scale};for(const[s,o]of Object.entries(e))o&&(t[s]=Kae(qae(s,o,n.paramMediator),i));return t}function Kae(n,e){if(n.length===1)return bF(n[0],e);const t=n.map(o=>o.predicate),i=n.map(o=>bF(o,e));return Object.assign(o=>{for(let r=0;r<i.length;r++)if(t[r](o))return i[r](o)},{constant:!1,accessors:i.map(o=>o.accessors[0]),dataAccessor:i.map(o=>o.dataAccessor).find(o=>o),scale:i.map(o=>o.scale).find(o=>o),channelDef:n.at(-1).channelDef})}function bF(n,e){const{channel:t,scaleChannel:i,channelDef:s}=n,o=n.scaleChannel?e(i):void 0;if(i&&!o)throw new Error(`Missing scale! "${t}": ${JSON.stringify(s)}`);return Object.assign(o?r=>o(n(r)):r=>n(r),{scale:o,constant:n.constant,accessors:[n],dataAccessor:n.constant?void 0:n,channelDef:s})}function _r(n){return n&&"value"in n}function vu(n){return n&&"field"in n}function z1(n){return n&&"datum"in n}function Wo(n){return vu(n)||z1(n)||H1(n)||jH(n)}function Yae(n,e){const t=n.mark.encoding[e];if(Wo(t))return t;throw new Error("Not a channel def with scale!")}function jH(n){return n&&"chrom"in n}function H1(n){return n&&"expr"in n}function Zae(n){return(vu(n)||z1(n))&&"condition"in n}function Xae(n){return _r(n)&&"condition"in n}const Km=["x","y"],Qae=["x2","y2"],Jae=[...Km,...Qae];function qH(n){return Km.includes(n)}function Db(n){return Jae.includes(n)}const GH={x:"x2",y:"y2"},KH=Object.fromEntries(Object.entries(GH).map(n=>[n[1],n[0]]));function YH(n){return n in KH}function ele(n){const e=GH[n];if(e)return e;throw new Error(`${n} has no secondary channel!`)}function df(n){return KH[n]??n}function Kd(n){return["color","fill","stroke"].includes(df(n))}function rD(n){return["shape"].includes(n)}function kb(n){return["x","y","x2","y2","color","fill","stroke","opacity","fillOpacity","strokeOpacity","strokeWidth","size","shape","angle","dx","dy"].includes(n)}function tle(n){switch(n){case"shape":return["circle","square","cross","diamond","triangle-up","triangle-right","triangle-down","triangle-left","tick-up","tick-right","tick-down","tick-left"]}}function ZH(n){if(!rD(n))throw new Error("Not a discrete channel: "+n);const e=new Map(tle(n).map((t,i)=>[t,i]));return t=>{const i=e.get(t);if(i!==void 0)return i;throw new Error(`Invalid value for "${n}" channel: ${t}`)}}function T4(){const n=e=>e;return n.invert=e=>e,n.copy=T4,n.invertRange=()=>{},n.type="null",n}const $1="attr_",ile="uDomain_",nle="range_",sle="accessor_",XH="scale_",ole="getScaled_",BA="uRangeTexture_",WA="uParam_",vF=3402823466e29;function rle(n){const e=n.match(/^(?:(\w+)-)?(\w+)$/);if(!e)throw new Error("Not a scale type: "+n);return{family:e[1]||"continuous",transform:e[2]}}function U1(n,e){return`${sle}${n}_${e}`}function ale(n,e,t){let i;if(rD(n))i=vh(ZH(n)(t));else if(ci(t))if(Kd(n))i=hle(t);else throw new Error(`String values are not supported on the "${n}" channel: ${t}`);else if(L1(t))i=vh(t?1:0);else if(t===null)if(Kd(n))i=vh([0,0,0]);else throw new Error(`null value is not supported on the "${n}" chanel.`);else i=vh(t);const s=U1(n,e),o=`
${i.type} ${s}() {
    // Constant value
    return ${i};
}`;return{channel:n,accessorGlsl:o,accessorFunctionName:s}}function lle(n,e){let t="float",i=l=>l;Kd(n)&&(t="vec3",i=l=>t$(l));const s=`u${ble(n)}_${e}`,o=`    // Dynamic value
    uniform ${t} ${s};`,r=U1(n,e);let a=`
${t} ${r}() {
    // Dynamic value
    return ${s};
}`;return{channel:n,uniformName:s,uniformGlsl:o,accessorGlsl:a,accessorFunctionName:r,adjuster:i}}function yF(n,e,t,i=[n]){const{attributeType:s}=j1(e,n),o=$1+N4(i),r=`in highp ${s} ${o};`,a=U1(n,t),l=`
${s} ${a}() {
    return ${o};
}`;return{channel:n,attributeName:o,attributeGlsl:r,accessorGlsl:l,accessorFunctionName:a}}function cle(n,e,t){const{attributeType:i}=j1(e,n),s=$1+N4(n),o=`    uniform highp ${i} ${s};`,r=U1(n,t),a=`
${i} ${r}() {
    return ${s};
}`;return{channel:n,uniformName:s,uniformGlsl:o,accessorGlsl:a,accessorFunctionName:r}}function dle(n,e,t){e??(e=T4());const i=df(n),s=ile+i,o=nle+i,{hp:r,attributeType:a}=j1(e,n),l=e.domain?e.domain().length:void 0;let c;const d=[];d.push(""),d.push("/".repeat(70)),d.push(`// Channel: ${n}`),d.push("");const{transform:u}=rle(e.type),h=(x,...D)=>fle.apply(null,[x,"value",...D]);let f;switch(u){case"linear":f=h("scaleLinear","domain",o);break;case"log":f=h("scaleLog","domain",o,e.base());break;case"symlog":f=h("scaleSymlog","domain",o,e.constant());break;case"pow":case"sqrt":f=h("scalePow","domain",o,e.exponent());break;case"index":case"locus":f=h("scaleBandHp","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"point":case"band":f=h("scaleBand","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"ordinal":case"null":case"identity":f=h("scaleIdentity");break;case"threshold":break;default:throw new Error(`Unsupported scale type: ${e.type}! ${n}: ${JSON.stringify(t)}`)}const g=o$(e,n);let p;if(g&&n==i){const x=e.props.range??[];if(js(x)||x.some(js)){if(g.length<1||g.length>4)throw new Error(`A range with ExprRefs must have 1-4 elements, not ${g.length}! Range: ${JSON.stringify(g)}`);p=`    uniform ${JH(g.length)} ${o};`}else if(g.length&&g.every(Js)){const D=wF(g);d.push(`const ${D.type} ${o} = ${D};`)}}const _=e$(n);let v;if(Kd(n)){const x=BA+i;if(n==i&&d.push(`uniform sampler2D ${x};`),os(e.type))v=`getInterpolatedColor(${x}, transformed)`;else if(qd(e.type)||ih(e.type))v=`getDiscreteColor(${x}, int(transformed))`;else throw new Error("Problem with color scale!")}else if(e.type==="ordinal"||ih(e.type)){const x=BA+i;n==i&&d.push(`uniform sampler2D ${x};`),v=`getDiscreteColor(${x}, int(transformed)).r`}const b=[],y=os(e.type)&&l>2,w=ih(e.type)||y;if(b.push("int slot = 0;"),w){const x=s;b.push(y?`while (slot < ${x}.length() - 2 && value >= ${x}[slot + 1]) { slot++; }`:`while (slot < ${x}.length() && value >= ${x}[slot]) { slot++; }`)}const C=os(e.type)||ih(e.type)||["band","point"].includes(e.type);if(f){const x=s;C&&(r?b.push(`vec3 domain = ${x};`):b.push(`vec2 domain = vec2(${x}[slot], ${x}[slot + 1]);`)),b.push(`float transformed = ${f};`),y&&b.push(`transformed = (float(slot) + transformed) / (float(${x}.length() - 1));`)}else b.push("float transformed = float(slot);");"clamp"in e&&e.clamp()&&b.push(`transformed = clampToRange(transformed, ${wF(g)});`),b.push(`return ${v??"transformed"};`),d.push(`
${_} ${XH}${n}(${a} value) {
${b.map(x=>`    ${x}
`).join("")}
}`);const L=d.join(`
`);if(C&&n==i){const x=os(e.type)||ih(e.type)?l:2;c=r?`    highp vec3 ${s};`:`    mediump float ${s}[${x}];`}return{glsl:L,domainUniformName:s,domainUniform:c,rangeUniformName:o,rangeUniform:p}}function ule(n,e){const t=e$(n),i=[],s=[];for(let o=0;o<e.length;o++){const r=e[o],a=U1(n,o),{param:l,empty:c}=r.predicate,d=WA+oD(l),u=$1+"uniqueId";i.push(l?`${u} == ${d}${c?` || ${d} == uint(0)`:""}`:null),s.push(r.scaleChannel?`return ${XH}${n}(${a}());`:`return ${a}();`)}return`${t} ${ole}${n}() {
${vle(i,s)}
}

#define ${n}_DEFINED`}function QH(n){if(!Js(n))throw new Error(`Not a number: ${n}`);if(n==1/0)return""+vF;if(n==-1/0)return""+-vF;{let e=`${n}`;return/^(-)?\d+$/.test(e)&&(e+=".0"),e}}function vh(n){typeof n=="number"&&(n=[n]);const e=n.length;if(e<1||e>4)throw new Error("Invalid number of components: "+e);const t=JH(e),i=`${t}(${n.map(QH).join(", ")})`;return Object.assign(i,{type:t,numComponents:e})}function JH(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error("Invalid number of components: "+n)}}function e$(n){return Kd(n)?"vec3":n=="uniqueId"?"uint":"float"}function t$(n){const e=Ud(n).rgb();return[e.r,e.g,e.b].map(t=>t/255)}function hle(n){return vh(t$(n))}function wF(n){return vh([n[0],E1(n)])}function fle(n,...e){const t=[];for(const i of e)Js(i)?t.push(QH(i)):Rs(i)?t.push(vh(i)):t.push(i);return`${n}(${t.join(", ")})`}function j1(n,e){var r;const t=n&&qd(n.type),i=n&&i$(n.type),s=i&&gle(n.domain()),o=s?{attributeType:"uvec2",arrayConstructor:Uint32Array}:i?{attributeType:"uint",arrayConstructor:Uint32Array}:t?{attributeType:"uint",arrayConstructor:Uint16Array}:e=="uniqueId"?{attributeType:"uint",arrayConstructor:Uint32Array}:{attributeType:"float",arrayConstructor:Float32Array};return Object.assign(o,{numComponents:+(((r=o.attributeType.match(/^vec([234])$/))==null?void 0:r[1])??1),discrete:t,hp:i,largeHp:s})}function i$(n){return n=="index"||n=="locus"}function gle(n){return n[1]>2**32}const ple=12,VA=2**ple;function n$(n,e=[]){const t=n%VA,i=(n-t)/VA;return e[0]=i,e[1]=t,e}function mle(n){const e=n%VA;return[n-e,e]}function _le(n){return[...mle(n[0]),n[1]-n[0]]}function s$(n){const e=new uc([],JSON.stringify);for(const[t,i]of Object.entries(n)){const s=i.channelDef;if(vu(s)){const r=[s.field,i.scale?(os(i.scale.type)||ih(i.scale.type))??!1:!1];e.set(r,[...e.get(r)??[],t])}}return e}function N4(n){return Ks(n).join("_")}function ble(n){return n[0].toUpperCase()+n.slice(1)}const o$=(n,e)=>QL(n.type)||os(n.type)&&Kd(e)?[0,1]:n.range?n.range():void 0;function vle(n,e){if(n.length!=e.length)throw new Error("Unequal array lengths");const t=n.length;if(t==0)return"";if(t==1&&n[0]==null)return e[0];const i=[];for(let s=0;s<t;s++){const o=n[s],r=s==0?`if (${o})`:o==null&&s==t-1?"else":`else if (${o})`;i.push(`    ${r} {
        ${e[s]}
    }`)}return i.join(`
`)}const CF=1e4;var $v,sL,r$,oL,a$;class yle{constructor(e){ve(this,sL);ve(this,oL);ve(this,$v,!1);this.size=e,this.arrays={},this.pushers=[],this.dataUpdaters=[],this.vertexCount=0}configure(){if(J(this,$v))throw new Error("Already configured!");De(this,sL,r$).call(this),De(this,oL,a$).call(this),gt(this,$v,!0)}addConverter(e,t){const i=this.createUpdater($1+e,t.numComponents||1,t.targetArrayType??Float32Array,t.arrayReference),s=t.f;this.dataUpdaters.push(t.arrayReference?o=>i(s(o)):o=>i(s(o)))}createUpdater(e,t,i=Float32Array,s=void 0){if(!Js(this.size))throw new Error("The number of vertices must be defined!");let o,r,a=0;const l=new i(this.size*t);if(this.arrays[e]={data:l,numComponents:t},t==1){let c=0;const d=u=>{c=+u};o=()=>{l[a++]=c},r=d}else{let c=s??[0];const d=s?u=>{}:u=>{c=u};switch(t){case 1:break;case 2:o=()=>{l[a++]=c[0],l[a++]=c[1]},r=d;break;case 3:o=()=>{l[a++]=c[0],l[a++]=c[1],l[a++]=c[2]},r=d;break;case 4:o=()=>{l[a++]=c[0],l[a++]=c[1],l[a++]=c[2],l[a++]=c[3]},r=d;break;default:throw new Error("Invalid numComponents: "+t)}}return this.pushers.push(o),r}pushAll(){throw new Error("Call configure() first!")}updateFromDatum(e){throw new Error("Call configure() first!")}pushFromDatum(e){this.updateFromDatum(e),this.pushAll()}}$v=new WeakMap,sL=new WeakSet,r$=function(){if(this.size>CF){const e=this.pushers.map((i,s)=>`const p${s} = that.pushers[${s}];`).join(`
`),t=this.pushers.map((i,s)=>`  p${s}();`).join(`
`);this.pushAll=new Function("that",`${e}
return function unrolledPushAll() {
${t}
  that.vertexCount++;
};`)(this)}else this.pushAll=()=>{for(let e=0;e<this.pushers.length;e++)this.pushers[e]();this.vertexCount++}},oL=new WeakSet,a$=function(){if(this.size>CF){const e=this.dataUpdaters.map((i,s)=>`const u${s} = that.dataUpdaters[${s}];`).join(`
`),t=this.dataUpdaters.map((i,s)=>`  u${s}(datum);`).join(`
`);this.updateFromDatum=new Function("that","datum",`${e}
return function unrolledUpdateFromDatum(datum) {
${t}
};`)(this)}else this.updateFromDatum=e=>{for(let t=0;t<this.dataUpdaters.length;t++)this.dataUpdaters[t](e)}};const Tg=5,h2=127;function zA(n){const e=[];for(let g=0;g<=h2;g++)e.push(void 0);const t=new Map;for(const g of n.chars)g.id<=h2?e[g.id]=g:t.set(g.id,g);const i=8722;t.has(i)||t.set(i,e["-".charCodeAt(0)]);function s(g){return(g<=h2?e[g]:t.get(g))||e[63]}function o(g){return s(g.charCodeAt(0))}const r=n.common.base,a=o("x"),l=o("X"),c=o("q"),d=a.height-Tg*2,u=l.height-Tg*2,h=c.height-a.height+c.yoffset-a.yoffset;function f(g,p=1){let _=0;for(let v=0;v<g.length;v++)_+=s(g.charCodeAt(v)).xadvance;return _/r*p}return{measureWidth:f,getCharByCode:s,getChar:o,xHeight:d,capHeight:u,descent:h,common:n.common}}const SF=2**31-1,wle=-(2**31);function Cle(n,e,t,i=t){const s=new Array(n);s.fill(SF);let o=wle,r=-1/0,a=!1;const l=new Array(n);l.fill(0);const c=e[0],u=(e[1]-e[0])/n,h=(v,b)=>{const y=(v-c)/u,w=Math.floor(y);return cm(b&&w==y?w-1:w,0,n-1)};function f(v,b,y){if(a)return;if(b>o)o=b;else{a=!0,console.debug("Items are not ordered properly. Disabling binned index.");return}const w=t(v);if(w<r){a=!0,console.debug("Items are not ordered properly. Disabling binned index.");return}r=w;const C=h(w,!1);s[C]>b&&(s[C]=b),l[C]<y&&(l[C]=y)}function g(v,b,y){if(a)return;if(b>o)o=b;else{a=!0,console.debug("Items (vertices) are not ordered properly. Disabling binned index.");return}const w=t(v),C=i(v);if(w<r){a=!0,console.debug("Items are not ordered properly. Disabling binned index.");return}else if(C<w){a=!0,console.debug("End index is less than start index. Disabling binned index. Datum: ",v);return}r=w;const L=h(w,!1),x=h(C,!0);for(let D=L;D<=x;D++)s[D]>b&&(s[D]=b),l[D]<y&&(l[D]=y)}const p=(v,b,y=[0,0])=>{const w=h(v,!1),C=h(b,!0),L=s[w],x=Math.max(l[C],L);return y[0]=L,y[1]=x,y},_=()=>{if(a)return;for(let b=1;b<l.length;b++)l[b]<l[b-1]&&(l[b]=l[b-1]);let v=!0;for(let b=s.length-1;b>0;b--)v&&s[b]==SF?(s[b]=l[b],v=!1):s[b-1]>s[b]&&(s[b-1]=s[b]);return p};return f.getIndex=_,g.getIndex=_,t==i?f:g}function Sle(){let n=0,e,t=0;const i=new Map,s=o=>(o===e||(t=i.get(o),t===void 0&&(t=n++,i.set(o,t)),e=o),t);return s.addAll=o=>{for(const r of o)s(r)},s.invert=o=>{for(const r of i.entries())if(r[1]==o)return r[0]},s.domain=()=>[...i.keys()],s}class q1{constructor({encoders:e,numVertices:t=void 0,attributes:i=[]}){this.encoders=e,this.variableEncoders=Object.fromEntries(Object.entries(e).filter(([o,r])=>i.includes(o)&&r&&!r.constant));const s=[...s$(e).entries()].filter(([o,r])=>o[1]&&r.length>1).map(([o,r])=>r);this.allocatedVertices=t,this.variableBuilder=new yle(t);for(const[o,r]of Object.entries(this.variableEncoders)){const a=r.dataAccessor;if(!a)continue;const l=s.find(y=>y.find(w=>w==o));if(l&&o!=l[0])continue;const c=a.asNumberAccessor(),d=r.scale,{largeHp:u,arrayConstructor:h,discrete:f,numComponents:g}=j1(d,o),p=[0,0];let _;d&&f&&"domain"in d&&(_=Sle(),_.addAll(d.domain()));const v=_?y=>_(a(y)):u?y=>n$(c(y),p):c,b=l?N4(l):o;this.variableBuilder.addConverter(b,{f:v,numComponents:g,arrayReference:u?p:void 0,targetArrayType:h})}this.lastOffset=0,this.rangeMap=new uc([],JSON.stringify)}registerBatch(e){var o;const t=this.lastOffset,i=this.variableBuilder.vertexCount,s=i-t;s&&this.rangeMap.set(e,{offset:t,count:s,xIndex:(o=this.xIndexer)==null?void 0:o.getIndex()}),this.lastOffset=i}addBatches(e){for(const[t,i]of e)this.addBatch(t,i)}addBatch(e,t,i=0,s=t.length){this.prepareXIndexer(t,i,s);for(let o=i;o<s;o++){const r=t[o];this.variableBuilder.pushFromDatum(r),this.addToXIndex(r)}this.registerBatch(e)}prepareXIndexer(e,t=0,i=t+e.length){var c;const s=()=>{this.addToXIndex=d=>{},this.xIndexer=void 0},o=(c=this.encoders.x)==null?void 0:c.channelDef;if(!("buildIndex"in o)||!o.buildIndex||!e.length||i-t<0){s();return}const r=d=>{var u;return d&&os((u=d.scale)==null?void 0:u.type)&&d},a=r(this.variableEncoders.x),l=r(this.variableEncoders.x2);if(a&&!a.constant&&(!l||!l.constant)){const d=a.dataAccessor.asNumberAccessor(),u=l?l.dataAccessor.asNumberAccessor():d,h=[d(e[t]),u(e[i-1])];if(h[1]>h[0]){this.xIndexer=Cle(50,h,d,u);let f=this.variableBuilder.vertexCount;this.addToXIndex=g=>{let p=this.variableBuilder.vertexCount;this.xIndexer(g,f,p),f=p}}else s()}else s()}addToXIndex(e){}toArrays(){return{arrays:this.variableBuilder.arrays,vertexCount:this.variableBuilder.vertexCount,allocatedVertices:this.allocatedVertices,rangeMap:this.rangeMap}}}class xle extends q1{constructor({encoders:e,attributes:t,numItems:i}){super({encoders:e,attributes:t,numVertices:i*6}),this.variableBuilder.configure();const s=this.variableBuilder.pushAll;this.pushAllSixTimes=i>500?new Function("pushAll",`return function unrolledPushAllSixTimes() {
  pushAll(); pushAll(); pushAll(); pushAll(); pushAll(); pushAll();
};`)(s):function(){s(),s(),s(),s(),s(),s()}}addBatch(e,t,i=0,s=t.length){if(!(s<=i)){this.prepareXIndexer(t,i,s);for(let o=i;o<s;o++){const r=t[o];this.variableBuilder.updateFromDatum(r),this.pushAllSixTimes(),this.addToXIndex(r)}this.registerBatch(e)}}}class Lle extends q1{constructor({encoders:e,attributes:t,tessellationThreshold:i=1/0,visibleRange:s=[-1/0,1/0],numItems:o}){super({encoders:e,attributes:t,numVertices:i==1/0?o*6:void 0}),this.visibleRange=s,this.tessellationThreshold=i||1/0,this.updateSide=this.variableBuilder.createUpdater("side",1),this.updatePos=this.variableBuilder.createUpdater("pos",1),this.variableBuilder.configure()}addBatch(e,t,i=0,s=t.length){this.prepareXIndexer(t,i,s);for(let o=i;o<s;o++){const r=t[o];this.variableBuilder.updateFromDatum(r),this.updateSide(-.5),this.updatePos(0),this.variableBuilder.pushAll();const a=1;for(let l=0;l<=a;l++)this.updatePos(l/a),this.updateSide(-.5),this.variableBuilder.pushAll(),this.updateSide(.5),this.variableBuilder.pushAll();this.variableBuilder.pushAll(),this.addToXIndex(r)}this.registerBatch(e)}}class Dle extends q1{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i}),this.variableBuilder.configure()}}class kle extends q1{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i}),this.variableBuilder.configure()}toArrays(){const e=this.variableBuilder.arrays;for(let t of Object.values(e))t.divisor=1;return super.toArrays()}}class Ele extends q1{constructor({encoders:e,attributes:t,fontMetrics:i,properties:s,numCharacters:o=void 0}){super({encoders:e,attributes:t,numVertices:o*6}),this.metadata=i,this.metrics=i,this.properties=s;const a=e.text.channelDef;this.numberFormat=!_r(a)&&"format"in a&&a.format?ls(a.format):l=>l,this.updateVertexCoord=this.variableBuilder.createUpdater("vertexCoord",2),this.updateTextureCoord=this.variableBuilder.createUpdater("textureCoord",2),this.updateWidth=this.variableBuilder.createUpdater("width",1),this.variableBuilder.configure()}addBatch(e,t,i=0,s=t.length){const o=this.properties.align||"left",r=this.properties.logoLetters??!1,a=this.metadata.common.base,l=this.metadata.common.scaleH;let c=-Tg;switch(this.properties.baseline){case"top":c+=this.metrics.capHeight;break;case"middle":c+=this.metrics.capHeight/2;break;case"bottom":c-=this.metrics.descent;break}const d=this.encoders.text,u=[0,0];this.updateVertexCoord(u);const h=[0,0];this.updateTextureCoord(h),this.prepareXIndexer(t,i,s);for(let f=i;f<s;f++){const g=t[f],p=this.numberFormat(d(g)),_=ci(p)?p:p===null?"":""+p;if(_.length==0)continue;this.variableBuilder.updateFromDatum(g);const v=r?_.length:this.metrics.measureWidth(_);this.updateWidth(v);let b=o=="right"?-v:o=="center"?-v/2:0;if(!r){const L=this.metrics.getCharByCode(_.charCodeAt(0));b-=(L.width-L.xadvance)/a/2}let y=-.5,w=1,C=1;for(let L=0;L<_.length;L++){const x=this.metrics.getCharByCode(_.charCodeAt(L)),D=r?1:x.xadvance/a;if(x.id==32){b+=D;continue}r?(C=(x.width+Tg*2)/x.width,b=-C/2,w=(x.height+Tg*2)/x.height,y=-.5-Tg/x.height):(w=x.height/a,y=-(x.height+x.yoffset+c)/a,C=x.width/a);const k=x.x,P=x.y;u[0]=b,u[1]=y+w,h[0]=k/l,h[1]=P/l,this.variableBuilder.pushAll(),u[0]=b+C,u[1]=y+w,h[0]=(k+x.width)/l,h[1]=P/l,this.variableBuilder.pushAll(),u[0]=b,u[1]=y,h[0]=k/l,h[1]=(P+x.height)/l,this.variableBuilder.pushAll(),u[0]=b+C,u[1]=y+w,h[0]=(k+x.width)/l,h[1]=P/l,this.variableBuilder.pushAll(),u[0]=b,u[1]=y,h[0]=k/l,h[1]=(P+x.height)/l,this.variableBuilder.pushAll(),u[0]=b+C,u[1]=y,h[0]=(k+x.width)/l,h[1]=(P+x.height)/l,this.variableBuilder.pushAll(),b+=D}this.addToXIndex(g)}this.registerBatch(e)}}const xF=`#define PI 3.141593

uniform View {
    /** Offset in "unit" units */
    mediump vec2 uViewOffset;
    mediump vec2 uViewScale;
    /** Size of the logical viewport in pixels, i.e., the view */
    mediump vec2 uViewportSize;
    lowp float uDevicePixelRatio;
    // TODO: Views with opacity less than 1.0 should be rendered into a texture
    // that is rendered with the specified opacity.
    lowp float uViewOpacity;
    bool uPickingEnabled;
};


/**
 * Maps a coordinate on the unit scale to a normalized device coordinate.
 * (0, 0) is at the bottom left corner.
 */
vec4 unitToNdc(vec2 coord) {
    return vec4((coord * uViewScale + uViewOffset) * 2.0 - 1.0, 0.0, 1.0);
}

vec4 unitToNdc(float x, float y) {
    return unitToNdc(vec2(x, y));
}

vec4 pixelsToNdc(vec2 coord) {
    return unitToNdc(coord / uViewportSize);
}

vec4 pixelsToNdc(float x, float y) {
    return pixelsToNdc(vec2(x, y));
}

float linearstep(float edge0, float edge1, float x) {
    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
}

/**
 * Calculates a gamma for antialiasing opacity based on the color.
 */
float getGammaForColor(vec3 rgb) {
    return mix(
        1.25,
        0.75,
        // RGB should be linearized but this is good enough for now
        smoothstep(0.0, 1.0, dot(rgb, vec3(0.299, 0.587, 0.114))));
}

// Fragment shader stuff ////////////////////////////////////////////////////////

// TODO: include the following only in fragment shaders

/**
 * Specialized linearstep for doing antialiasing
 */
float distanceToRatio(float d) {
	return clamp(d * uDevicePixelRatio + 0.5, 0.0, 1.0);
}

vec4 distanceToColor(float d, vec4 fill, vec4 stroke, float halfStrokeWidth) {
    if (halfStrokeWidth > 0.0) {
        // Distance to stroke's edge. Negative inside the stroke.
        float sd = abs(d) - halfStrokeWidth;
        return mix(
            stroke,
            d <= 0.0 ? fill : vec4(0.0),
            distanceToRatio(sd));
    } else {
        return fill * distanceToRatio(-d);
    }
}
`,Ale=`uniform highp float uZero;

// Utils ------------

vec3 getDiscreteColor(sampler2D s, int index) {
    return texelFetch(s, ivec2(index % textureSize(s, 0).x, 0), 0).rgb;
}

vec3 getInterpolatedColor(sampler2D s, float unitValue) {
    return texture(s, vec2(unitValue, 0.0)).rgb;
}

float clampToRange(float value, vec2 range) {
    return clamp(value, min(range[0], range[1]), max(range[0], range[1]));
}

// Scales ------------
// Based on d3 scales: https://github.com/d3/d3-scale

float scaleIdentity(float value) {
    return value;
}

float scaleIdentity(uint value) {
    return float(value);
}

float scaleLinear(float value, vec2 domain, vec2 range) {
    float domainSpan = domain[1] - domain[0];
    float rangeSpan = range[1] - range[0];
    return (value - domain[0]) / domainSpan * rangeSpan + range[0];
}

float scaleLog(float value, vec2 domain, vec2 range, float base) {
    // y = m log(x) + b 
    // TODO: Perf optimization: precalculate log domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(log(value) / log(base), log(domain) / log(base), range);
}

float symlog(float value, float constant) {
    // WARNING: emulating log1p with log(x + 1). Small numbers are likely to
    // have significant precision problems.
    return sign(value) * log(abs(value / constant) + 1.0);
}

float scaleSymlog(float value, vec2 domain, vec2 range, float constant) {
    return scaleLinear(
        symlog(value, constant),
        vec2(symlog(domain[0], constant), symlog(domain[1], constant)),
        range
    );
}

float scalePow(float value, vec2 domain, vec2 range, float exponent) {
    // y = mx^k + b
    // TODO: Perf optimization: precalculate pow domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(
        pow(abs(value), exponent) * sign(value),
        pow(abs(domain), vec2(exponent)) * sign(domain),
        range
    );
}

// TODO: scaleThreshold
// TODO: scaleQuantile (special case of threshold scale)

// TODO: domainExtent should be uint
float scaleBand(uint value, vec2 domainExtent, vec2 range,
                float paddingInner, float paddingOuter,
                float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    float n = domainExtent[1] - domainExtent[0];

    // This fix departs from Vega and d3: https://github.com/vega/vega/issues/3357#issuecomment-1063253596
    paddingInner = int(n) > 1 ? paddingInner : 0.0;

    // Adapted from: https://github.com/d3/d3-scale/blob/master/src/band.js
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    return start + (float(value) - domainExtent[0]) * step + bandwidth * band;
}

const int lowBits = 12;
const float lowDivisor = pow(2.0, float(lowBits));
const uint lowMask = uint(lowDivisor - 1.0);

vec2 splitUint(uint value) {
    uint valueLo = value & lowMask;
    uint valueHi = value - valueLo;
    return vec2(float(valueHi), float(valueLo));
}

/**
 * High precision variant of scaleBand for index/locus scales
 */
float scaleBandHp(uint value, vec3 domainExtent, vec2 range,
                 float paddingInner, float paddingOuter,
                 float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    vec2 domainStart = domainExtent.xy;
    float n = domainExtent[2];

    // The following computation is identical for every vertex. Could be done on the JS side.
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    // Split into to values with each having a reduced number of significant digits
    // to mitigate the lack of precision in float32 calculations.
    vec2 splitValue = splitUint(value);

    // Using max to prevent the shader compiler from wrecking the precision.
    // Othwewise the compiler could optimize the sum of the four terms into
    // some equivalent form that does premature rounding.
    float inf = 1.0 / uZero;
    float hi = max(splitValue[0] - domainStart[0], -inf);
    float lo = max(splitValue[1] - domainStart[1], -inf);

    return dot(vec4(start, hi, lo, bandwidth), vec4(1.0, step, step, band));
}

/**
 * High precision variant of scaleBand for index/locus scales for large
 * domains where 32bit uints are not sufficient to represent the domain.
 */
float scaleBandHp(uvec2 value, vec3 domainExtent, vec2 range,
                 float paddingInner, float paddingOuter,
                 float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    vec2 domainStart = domainExtent.xy;
    float n = domainExtent[2];

    // The following computation is identical for every vertex. Could be done on the JS side.
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    // Split into to values with each having a reduced number of significant digits
    // to mitigate the lack of precision in float32 calculations.
    vec2 splitValue = vec2(float(value[0]) * lowDivisor, float(value[1]));

    // Using max to prevent the shader compiler from wrecking the precision.
    // Othwewise the compiler could optimize the sum of the four terms into
    // some equivalent form that does premature rounding.
    float inf = 1.0 / uZero;
    float hi = max(splitValue[0] - domainStart[0], -inf);
    float lo = max(splitValue[1] - domainStart[1], -inf);

    return dot(vec4(start, hi, lo, bandwidth), vec4(1.0, step, step, band));
}
`,Ile=`
/**
 * Describes where a sample facet should be shown. Interpolating between the
 * current and target positions/heights allows for transitioning between facet
 * configurations.
 */
struct SampleFacetPosition {
    float pos;
    float height;
    float targetPos;
    float targetHeight;
};

/**
 * Trasition fraction [0, 1] between the current and target configurations.
 */
uniform float uTransitionOffset;


// ----------------------------------------------------------------------------

#if !defined(SAMPLE_FACET_UNIFORM) && !defined(SAMPLE_FACET_TEXTURE)

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

#elif defined(SAMPLE_FACET_UNIFORM)

/**
 * Location and height of the band on the Y axis on a normalized [0, 1] scale.
 * Elements: curr pos, curr height, target pos, target height
 */
uniform vec4 uSampleFacet;

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(
        1.0 - uSampleFacet.x - uSampleFacet.y,
        uSampleFacet.y,
        1.0 - uSampleFacet.z - uSampleFacet.w,
        uSampleFacet.w
    );
}

#elif defined(SAMPLE_FACET_TEXTURE)

uniform sampler2D uSampleFacetTexture;

SampleFacetPosition getSampleFacetPos() {
    vec4 texel = texelFetch(uSampleFacetTexture, ivec2(int(attr_facetIndex), 0), 0);
    return SampleFacetPosition(
        1.0 - texel.r - texel.g,
        texel.g,
        1.0 - texel.r - texel.g,
        texel.g);
}

#endif

// ----------------------------------------------------------------------------

bool isFacetedSamples(SampleFacetPosition facetPos) {
    return facetPos != SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

bool isFacetedSamples() {
    return isFacetedSamples(getSampleFacetPos());
}

bool isInTransit() {
    return uTransitionOffset > 0.0;
}

float getTransitionFraction(float xPos) {
    return smoothstep(0.0, 0.7 + uTransitionOffset, (xPos - uTransitionOffset) * 2.0);
}

vec2 applySampleFacet(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return pos;
    } else if (isInTransit()) {
        vec2 interpolated = mix(
            vec2(facetPos.pos, facetPos.height),
            vec2(facetPos.targetPos, facetPos.targetHeight),
            getTransitionFraction(pos.x));
        return vec2(pos.x, interpolated[0] + pos.y * interpolated[1]);
    } else {
        return vec2(pos.x, facetPos.pos + pos.y * facetPos.height);
    }
}

float getSampleFacetHeight(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return 1.0;
    } else if (isInTransit()) {
        return mix(
            facetPos.height,
            facetPos.targetHeight,
            getTransitionFraction(pos.x));
    } else {
        return facetPos.height;
    }
}
`,Tle=`/*
 * Based on concepts presented at:
 * https://webglfundamentals.org/webgl/lessons/webgl-picking.html
 * https://deck.gl/docs/developer-guide/custom-layers/picking
 */

out highp vec4 vPickingColor;

/**
 * Passes the unique id to the fragment shader as a color if picking is enabled.
 * Returns true if picking is enabled.
 */
bool setupPicking() {
    if (uPickingEnabled) {
#ifdef uniqueId_DEFINED
        uint id = attr_uniqueId;
        vPickingColor = vec4(
            ivec4(id >> 0, id >> 8, id >> 16, id >> 24) & 0xFF
        ) / float(0xFF);
#else
        vPickingColor = vec4(1.0);
#endif
        return true;
    }
    return false;
}
`,Nle=`in highp vec4 vPickingColor;
`,pC=Symbol("cacheMap");function aD(n,e,t){let i=Eb(n).get(e);return i===void 0&&(i=t(e),Eb(n).set(e,i)),i}function Rle(n,e){Eb(n).delete(e)}function mC(n,e){const t=Eb(n);for(const i of t.keys())i.startsWith(e)&&t.delete(i);Eb(n).delete(e)}function l$(n){n[pC]=new Map}function Eb(n){return n[pC]||l$(n),n[pC]}function Mle(n,e,t,i){const s=ci(n)?n:n.name,o=!ci(n)&&n.extent||[0,1];if(t===void 0&&!ci(n)&&(t=n.count),s){const r=D4(s);if(dr(r)){const a=c$(r,{extent:o,count:t});return lD(e,{minMag:e.LINEAR,format:e.RGB,height:1,wrap:e.CLAMP_TO_EDGE},a,i)}else{if(Rs(r))return HA(r,e);throw new Error("Unknown scheme: "+s)}}}function Ple(n,e="rgb",t,i){const s=JL(n,ci(e)?e:e.type,ci(e)?void 0:e.gamma),o=c$(s);return lD(t,{minMag:t.LINEAR,format:t.RGB,height:1,wrap:t.CLAMP_TO_EDGE},o,i)}function Ole(n,e,t,i){const s=Math.max(n.length,t||0),o=new Float32Array(s);for(let r=0;r<s;r++)o[r]=n[r%n.length];return lD(e,{minMag:e.NEAREST,format:e.RED,internalFormat:e.R32F,height:1},o,i)}function HA(n,e,t,i){const s=d$(n,t);return lD(e,{minMag:e.NEAREST,format:e.RGB,height:1},s,i)}function c$(n,{extent:e=[0,1],reverse:t=!1,count:i=256}={}){const s=e[0],o=E1(e)-s,r=ab(i).map(a=>a/(i-1)).map(a=>s+a/o).map(n);return t&&r.reverse(),d$(r)}function d$(n,e){const t=Math.max(n.length,e||0),i=new Uint8Array(t*3);for(let s=0;s<t;s++){const o=Ud(n[s%n.length]).rgb();i[s*3+0]=o.r,i[s*3+1]=o.g,i[s*3+2]=o.b}return i}class Fle{constructor(e,t,i,s={}){this._container=e,this._sizeSource=t??(()=>({width:void 0,height:void 0})),this._shaderCache=new Map,this.rangeTextures=new WeakMap;const o=document.createElement("canvas");e.appendChild(o);const r=eoe(o,{antialias:!0,depth:!1,premultipliedAlpha:!0,...s});if(!r)throw new Error("Unable to initialize WebGL. Your browser or machine may not support it.");if(!Um(r))throw new Error("Your web browser does not support WebGL 2.0. Chrome, Firefox, and Safari Tech Preview should work.");if(Rz(r),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),this.canvas=o,this.gl=r,this._pickingAttachmentOptions=[{format:r.RGBA,type:r.UNSIGNED_BYTE,minMag:r.LINEAR,wrap:r.CLAMP_TO_EDGE}],this._pickingBufferInfo=Kse(r,this._pickingAttachmentOptions),r.bindFramebuffer(r.FRAMEBUFFER,null),this.adjustGl(),this._updateDpr(),this._clearColor=[0,0,0,0],i){const a=Ud(i).rgb();this._clearColor=[a.r/255,a.g/255,a.b/255,a.opacity]}}invalidateSize(){this._logicalCanvasSize=void 0,this._updateDpr(),this.adjustGl()}_updateDpr(){this.dpr=window.devicePixelRatio}compileShader(e,t){const i="#version 300 es",s="precision mediump float;";Rs(t)&&(t=t.join(`

`));const o=this.gl,r=t.replaceAll(/ {2,}|^\s*\/\/.*$/gm,"");let a=this._shaderCache.get(r);if(!a){const l=[i,s,t].join(`

`);a=o.createShader(e),o.shaderSource(a,l),o.compileShader(a),this._shaderCache.set(r,a)}return a}adjustGl(){const e=this.getLogicalCanvasSize();this.canvas.style.width=`${e.width}px`,this.canvas.style.height=`${e.height}px`;const t=this.getPhysicalCanvasSize(e);this.canvas.width=t.width,this.canvas.height=t.height,Yse(this.gl,this._pickingBufferInfo,this._pickingAttachmentOptions)}finalize(){this.canvas.remove()}getPhysicalCanvasSize(e){return e=e||this.getLogicalCanvasSize(),{width:e.width*this.dpr,height:e.height*this.dpr}}getLogicalCanvasSize(){if(this._logicalCanvasSize)return this._logicalCanvasSize;const e=this._sizeSource(),t=window.getComputedStyle(this._container,null),i=e.width??this._container.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),s=e.height??this._container.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);return this._logicalCanvasSize={width:i,height:s},this._logicalCanvasSize}readPickingPixel(e,t){const i=this.gl;e*=this.dpr,t*=this.dpr;const s=this.getPhysicalCanvasSize().height,o=new Uint8Array(4);return i.bindFramebuffer(i.FRAMEBUFFER,this._pickingBufferInfo.framebuffer),i.readPixels(e,s-t-1,1,1,i.RGBA,i.UNSIGNED_BYTE,o),i.bindFramebuffer(i.FRAMEBUFFER,null),o}clearAll(){const e=this.gl,{width:t,height:i}=this.getPhysicalCanvasSize();e.viewport(0,0,t,i),e.disable(e.SCISSOR_TEST),e.clearColor(...this._clearColor),e.clear(e.COLOR_BUFFER_BIT)}createRangeTexture(e,t=!1){const i=this.rangeTextures.get(e);if(!t&&i)return;function s(r,a){return qd(a.type)?a.domain().length:a.type=="threshold"?a.domain().length+1:a.type=="quantize"||a.type=="quantile"?r??4:r}const o=e.channel;if(Kd(o)){const r=e.scale,a=r.props,l=r.range();let c;if(a.scheme)if(r.type=="threshold"&&l)c=HA(l,this.gl,r.domain().length,i);else{let d=ci(a.scheme)?void 0:a.scheme.count;d=s(d,r),c=Mle(a.scheme,this.gl,d,i)}else QL(r.type)||os(r.type)&&l.length>1?c=Ple(l,a.interpolate,this.gl,i):c=HA(l,this.gl,r.domain().length,i);this.rangeTextures.set(e,c)}else{const r=e.scale;if(r.type==="ordinal"||ih(r.type)){const a=rD(o)?ZH(o):c=>c,l=r.range();this.rangeTextures.set(e,Ole(l.map(a),this.gl,r.domain().length,i))}}}}function Ble(n,e="",t=0){const i=/ERROR:\s*\d+:(\d+)/gi,s=[...e.matchAll(i)],o=new Map(s.map((r,a)=>{const l=parseInt(r[1]),c=s[a+1],d=c?c.index:e.length,u=e.substring(r.index,d);return[l-1,u]}));return n.split(`
`).map((r,a)=>{const l=o.get(a);return`${a+1+t}: ${r}${l?`

^^^ ${l}`:""}`}).join(`
`)}function Wle(n,e,t){const i=n.createProgram();n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i);function s(){let o,r;if(!n.getProgramParameter(i,n.LINK_STATUS)){o=n.getProgramInfoLog(i);for(const l of[e,t])n.getShaderParameter(l,n.COMPILE_STATUS)||(o=n.getShaderInfoLog(l),r=Ble(n.getShaderSource(l),o,0)+`
Error compiling: ${o}`,n.deleteShader(l));n.deleteProgram(i)}if(o)return{message:o,detail:r}}return{program:i,getProgramErrors:s}}function lD(n,e,t,i){return i?ez(n,i,t,e):i=yb(n,{...e,src:t}),i}function LF(...n){const e={get(t,i,s){for(const o of n){const a=o()[i];if(a!==void 0)return a}},has(t,i,s){for(const o of n){const r=o();if(i in r)return!0}return!1}};return new Proxy({},e)}function Vle(n){return ci(n)||Js(n)||L1(n)}class zh extends Error{constructor(e,t){super(e),this.name="ViewError",this.view=t}}const zle="SAMPLE_FACET_UNIFORM",DF="SAMPLE_FACET_TEXTURE";var Ca;class G1{constructor(e){ve(this,Ca,[]);this.unitView=e,this.encoders=void 0,this.bufferInfo=void 0,this.bytesPerElement=new Map,this.programInfo=void 0,this.vertexArrayInfo=void 0,this.viewUniformInfo=void 0,this.markUniformInfo=void 0,this.markUniformsAltered=!0,this.rangeMap=new Hle,this.defaultProperties={get clip(){return["x","y"].map(t=>e.getScaleResolution(t)).some(t=>(t==null?void 0:t.isZoomable())??!1)},xOffset:0,yOffset:0,minBufferSize:0},this.properties=LF(typeof this.unitView.spec.mark=="object"?()=>this.unitView.spec.mark:()=>({}),()=>this.defaultProperties)}augmentDefaultProperties(e){Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors(e))}get opaque(){return!1}getAttributes(){throw new Error("Not implemented!")}getSupportedChannels(){return["sample","facetIndex","x","y","color","opacity","search","uniqueId"]}getDefaultEncoding(){const e={sample:void 0,uniqueId:void 0};return this.isPickingParticipant()&&(e.uniqueId={field:Gd}),e}fixEncoding(e){return e}setupExprRefsNeedingGraphicsUpdate(e){const t=this.getSupportedChannels(),i={};for(const o of e){const r=this.properties[o];if(r&&js(r)){const a=this.unitView.paramMediator.createExpression(r.expr);a.addListener(()=>{this.updateGraphicsData(),this.unitView.context.animator.requestRender()}),t.includes(o)||Object.defineProperty(i,o,{get(){return a()}})}}const s=this.properties;this.properties=LF(()=>i,()=>s)}get encoding(){return aD(this,"encoding",()=>{var r;const e=this.getDefaultEncoding(),t=this.unitView.getEncoding(),i=a=>{const l=this.properties[a];return Vle(l)||js(l)?{value:l}:void 0},s=Object.fromEntries(this.getSupportedChannels().map(a=>[a,i(a)]).filter(a=>_r(a[1]))),o=this.fixEncoding({...e,...s,...t});for(const a of Object.keys(o))this.getSupportedChannels().includes(a)||delete o[a];return o.x&&((r=o.x).buildIndex??(r.buildIndex=!0)),o})}getContext(){return this.unitView.context}getType(){return this.unitView.getMarkType()}initializeData(){}initializeEncoders(){this.encoders=Gae(this.unitView,this.encoding)}async initializeGraphics(){}updateGraphicsData(){}getSampleFacetMode(){if(this.encoders.facetIndex)return DF;if(this.unitView.getLayoutAncestors().find(e=>"samples"in e.spec))return zle}createAndLinkShaders(e,t,i=[]){const s=this.getAttributes(),o=this.encoders,r=this.getSampleFacetMode();r&&i.push(`#define ${r}`);const a="// view: "+this.unitView.getPathString();let l=[];const c=new Set,d=s$(o),u=[],h=Object.values(o).flatMap(C=>C.accessors).map(C=>C.predicate).filter(C=>C.param),f=new Map;for(const C of h){const L=C.param,x=this.unitView.paramMediator.getValue(L);if(!x)throw new Error(`Cannot infer selection type as the parameter "${L}" has no value. Please ensure that the parameter is properly defined!`);if($H(x)){if(!f.has(L)){const D=WA+oD(L);f.set(L,"single"),u.push("    // Selection parameter"),u.push(`    uniform highp uint ${D};`),J(this,Ca).push(()=>{this.registerMarkUniformValue(D,{expr:L},k=>k.uniqueId??0)})}}else throw new Error(`Unsupported selection (${L}) in condition: ${JSON.stringify(x)}`)}const g=(C,L,x,D)=>{const k=L.channelDef;if(_r(k))if(js(k.value)){const{uniformName:P,uniformGlsl:O,accessorGlsl:M,adjuster:R}=lle(C,x);l.push(M),u.push(O),J(this,Ca).push(()=>{this.registerMarkUniformValue(P,k.value,R)})}else l.push(ale(C,x,k.value).accessorGlsl);else if(z1(k)){const{uniformName:P,uniformGlsl:O,accessorGlsl:M}=cle(C,D,x);u.push(O),l.push(M);const{largeHp:R,discrete:$}=j1(D,C),G=$&&"domain"in D?ne=>D.domain().indexOf(ne):R?n$:ne=>+ne;J(this,Ca).push(()=>{this.registerMarkUniformValue(P,k.datum,G)})}else if(vu(k)){const P=d.get([k.field,!0]),{attributeGlsl:O,accessorGlsl:M}=yF(C,D,x,P!=null&&P.includes(C)?P:void 0);c.add(O),l.push(M)}else if(H1(k)){const{attributeGlsl:P,accessorGlsl:O}=yF(C,D,x);c.add(P),l.push(O)}else throw new zh(`Unsupported channel definition: ${JSON.stringify(k)}`,this.unitView)};for(const[C,L]of Object.entries(o)){if(!s.includes(C))continue;const{channelDef:x,accessors:D,scale:k}=L;for(let P=0;P<D.length;P++)g(C,D[P],P,k);if(k){const P=Wo(x)&&x.resolutionChannel||C,O=kb(P)?this.unitView.getScaleResolution(P):null,{glsl:M,domainUniform:R,domainUniformName:$,rangeUniform:G,rangeUniformName:ne}=dle(C,k,x);l.push(M),u.push(R),u.push(G),G&&J(this,Ca).push(()=>{const ae=this.createMarkUniformSetter(ne),fe=()=>ae(o$(k,C));O.addEventListener("range",fe),fe()}),R&&J(this,Ca).push(()=>{const ae=this.createMarkUniformSetter($),fe=()=>{const oe=qd(k.type)?[0,k.domain().length]:k.domain();ae(i$(k.type)?_le(oe):oe)};O.addEventListener("domain",fe),fe()})}l.push(ule(C,D))}const p=[...f.entries()].filter(([,C])=>C=="single").map(([C])=>`${WA}${C} == ${$1}uniqueId`);l.push("bool isPointSelected() {",this.encoders.uniqueId&&p.length>0?`    return ${p.join(" || ")};`:"    return false;","}");const _=`precision highp float;
precision highp int;`,v=C=>C.replace("#pragma markUniforms",u.join(`
`));i=i.map(v),e=v(e),t=v(t);const b=[_,a,...i,xF,Ale,[...c].join(`
`),...l,Ile,Tle,e],y=[_,a,...i,xF,Nle,t],w=this.gl;this.programStatus=Wle(w,this.glHelper.compileShader(w.VERTEX_SHADER,b),this.glHelper.compileShader(w.FRAGMENT_SHADER,y))}finalizeGraphicsInitialization(){const e=this.programStatus.getProgramErrors();if(e){e.detail&&console.warn(e.detail);const t=new Error("Cannot create shader program: "+e.message);throw t.view=this.unitView,t}this.programInfo=Tse(this.gl,this.programStatus.program),delete this.programStatus,this.viewUniformInfo=FO(this.gl,this.programInfo,"View"),this.markUniformInfo=FO(this.gl,this.programInfo,"Mark"),this.gl.useProgram(this.programInfo.program),op(this.programInfo,{uSampleFacet:[0,1,0,1],uTransitionOffset:0,uZero:0});for(const t of J(this,Ca))t();gt(this,Ca,void 0)}createMarkUniformSetter(e){const t=this.markUniformInfo.setters[e];if(!t)throw new Error(`Uniform "${e}" not found int the Mark block!`);return i=>{t(i),this.markUniformsAltered=!0,this.unitView.context.animator.requestRender()}}registerMarkUniformValue(e,t,i=s=>s){const s=this.createMarkUniformSetter(e),o=r=>{if(r==null)throw new Error(`Trying to set null/undefined value for uniform: ${e}${js(t)?`Expr: ${t.expr}`:""}`);s(r)};if(js(t)){const r=this.unitView.paramMediator.createExpression(t.expr),a=()=>o(i(r(null)));r.addListener(a),a()}else o(i(t))}deleteGraphicsData(){const e=this.gl;if(this.vertexArrayInfo&&(this.gl.bindVertexArray(null),e.deleteVertexArray(this.vertexArrayInfo.vertexArrayObject),this.vertexArrayInfo=void 0),this.bufferInfo){for(let t=0;t<8;t++)e.disableVertexAttribArray(t);Object.values(this.bufferInfo.attribs).forEach(t=>this.gl.deleteBuffer(t.buffer)),this.bufferInfo.indices&&this.gl.deleteBuffer(this.bufferInfo.indices),this.bufferInfo=void 0}}updateBufferInfo(e){if(this.gl.bindVertexArray(null),this.bufferInfo&&e.vertexCount<=this.bufferInfo.allocatedVertices)for(const[t,i]of Object.entries(e.arrays))i.data&&Ute(this.gl,this.bufferInfo.attribs[t],i.data,0);else{this.deleteGraphicsData(),this.bufferInfo=Gte(this.gl,e.arrays,{numElements:e.vertexCount}),this.bufferInfo.allocatedVertices=e.allocatedVertices;for(const[t,i]of Object.entries(e.arrays))this.bytesPerElement.set(t,i.data.BYTES_PER_ELEMENT)}}get glHelper(){return this.getContext().glHelper}get gl(){return this.glHelper.gl}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}isReady(){return this.bufferInfo&&this.programInfo}isPickingParticipant(){if(this.properties.tooltip===null&&!this.unitView.paramMediator.hasPointSelections())return!1;for(const e of this.unitView.getLayoutAncestors())if(!e.isPickingSupported())return!1;return!0}bindOrSetMarkUniformBlock(){this.markUniformsAltered?(BO(this.gl,this.programInfo,this.markUniformInfo),this.markUniformsAltered=!1):Dz(this.gl,this.programInfo,this.markUniformInfo)}prepareRender(e){const t=this.glHelper,i=this.gl,s=[];s.push(()=>{this.vertexArrayInfo||(this.vertexArrayInfo=Zse(this.gl,this.programInfo,this.bufferInfo)),i.useProgram(this.programInfo.program)});for(const[r,a]of Object.entries(this.encoding))if(Wo(a)){const l=Wo(a)&&a.resolutionChannel||r;if(kb(l)){const c=this.unitView.getScaleResolution(l),d=t.rangeTextures.get(c);d&&s.push(()=>op(this.programInfo,{[BA+r]:d}))}}this.getSampleFacetMode()==DF&&s.push(()=>{let r;for(const a of this.unitView.getLayoutAncestors())if(r=a.getSampleFacetTexture(),r)break;if(!r)throw new Error("No facet texture available. This is bug.");op(this.programInfo,{uSampleFacetTexture:r})});const o=(e.picking??!1)&&this.isPickingParticipant();return s.push(()=>wb(this.viewUniformInfo,{uViewOpacity:this.unitView.getEffectiveOpacity(),uPickingEnabled:o})),this.opaque||e.picking?s.push(()=>i.disable(i.BLEND)):s.push(()=>i.enable(i.BLEND)),s}prepareSampleFacetRendering(e){const t=e.sampleFacetRenderingOptions,i=this.programInfo.uniformSetters.uSampleFacet;if(t&&i){const s=t.locSize?t.locSize.location:0,o=t.locSize?t.locSize.size:1;if(s>1||s+o<0)return!1;const r=t.targetLocSize?t.targetLocSize.location:s,a=t.targetLocSize?t.targetLocSize.size:o;this.gl.uniform4f(i.location,s,o,r,a)}return!0}render(e){}createRenderCallback(e,t){var u;if(!this.bufferInfo)return()=>{};const i=this;let s;const o=(u=this.unitView.getScaleResolution("x"))==null?void 0:u.scale,r=o&&os(o.type),a=["index","locus"].includes(o==null?void 0:o.type)?-1:0,l=[0,0];s=h=>{if(r&&h.xIndex){const f=o.domain(),g=h.xIndex(f[0]+a,f[1],l),p=g[0],_=g[1]-p;_>0&&e(p,_)}else e(h.offset,h.count)};const c=this.rangeMap.get(void 0).count==0?t.facetId:void 0,d=this.rangeMap.get(c);return t.sampleFacetRenderingOptions?function(){d.count&&i.prepareSampleFacetRendering(t)&&s(d)}:function(){d.count&&s(d)}}setViewport(e,t){e=e.flatten();const i=this.unitView.context.devicePixelRatio,s=this.gl,o=this.properties,r=this.glHelper.getLogicalCanvasSize(),a=.5,l=(o.xOffset??0)+a,c=(o.yOffset??0)+a;let d,u=e;if(o.clip!=="never"&&(o.clip||t)){let h=0,f=0,g;if(t){if(u=e.intersect(t).flatten(),!u.isDefined())return!1;g=[e.width/u.width,e.height/u.height],f=Math.max(0,e.y2-t.y2),h=Math.min(0,e.x-t.x)}else g=[1,1];const p=[u.x,r.height-u.y2,u.width,u.height].map(y=>y*i),_=p.map(y=>Math.floor(y)),v=p[0]-_[0],b=p[1]-_[1];s.viewport(..._),s.scissor(..._),s.enable(s.SCISSOR_TEST),d={uViewOffset:[(l+h+v/i)/u.width,-(c+f-b/i)/u.height],uViewScale:g}}else{if(!e.isDefined())return!1;s.viewport(0,0,r.width*i,r.height*i),s.disable(s.SCISSOR_TEST),d={uViewOffset:[(e.x+l)/r.width,(r.height-e.y-c-e.height)/r.height],uViewScale:[e.width/r.width,e.height/r.height]}}return wb(this.viewUniformInfo,{...d,uViewportSize:[e.width,e.height],uDevicePixelRatio:i}),BO(this.gl,this.programInfo,this.viewUniformInfo),!0}findDatumAt(e,t){}}Ca=new WeakMap;let Hle=class extends uc{constructor(){super([],JSON.stringify)}get(e){let t=super.get(e);return t===void 0&&(t={offset:0,count:0,xIndex:void 0},super.set(e,t)),t}migrateEntries(e){for(const[t,i]of this.entries())e.has(t)||(i.offset=0,i.count=0,i.xIndex=void 0);for(const[t,i]of e.entries())Object.assign(this.get(t),i)}};function $A(n,e){const t=ele(e);let i=n[e]&&{...n[e]},s=n[t]&&{...n[t]};if(!(_r(i)||_r(s))){if(i){if(!Wo(n[e]))return;if(s){if(i.type!="quantitative"){const o=(1-(i.band||1))/2;i.band=o,s.band=-o}}else if(i.type=="quantitative")s={datum:0,contributesToScaleDomain:!1};else{s={...i};const o=(1-(i.band??1))/2;i.band=0+o,s.band=1-o}}else i={value:0},s={value:1};n[e]=i,n[t]=s}}function u$(n,e){n.stroke||(e?n.stroke={value:null}:n.stroke={resolutionChannel:"color",...n.color}),_r(n.stroke)&&n.stroke.value===null&&(n.strokeWidth={value:0}),n.strokeOpacity||(n.strokeOpacity={resolutionChannel:"opacity",...n.opacity})}function h$(n,e){_r(n.fill)&&n.fill.value===null?n.fillOpacity={value:0}:n.fill||(n.fill={resolutionChannel:"color",...n.color},!e&&!n.fillOpacity&&(n.fillOpacity={value:0})),n.fillOpacity||(e?n.fillOpacity={resolutionChannel:"opacity",...n.opacity}:n.fillOpacity={value:0})}var Uv,UA,jv,jA;class $le extends G1{constructor(t){super(t);ve(this,Uv);ve(this,jv);this.augmentDefaultProperties({x2:void 0,y2:void 0,filled:!0,color:"#4c78a8",opacity:1,strokeWidth:3,cornerRadius:0,minWidth:.5,minHeight:.5,minOpacity:1})}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}get opaque(){return aD(this,"opaque",()=>!De(this,Uv,UA).call(this)&&!De(this,jv,jA).call(this)&&_r(this.encoding.fillOpacity)&&this.encoding.fillOpacity.value==1&&this.properties.minOpacity==1)&&this.unitView.getEffectiveOpacity()==1}fixEncoding(t){return $A(t,"x"),$A(t,"y"),u$(t,this.properties.filled),h$(t,this.properties.filled),delete t.color,delete t.opacity,t}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}async initializeGraphics(){await super.initializeGraphics();const t=[];De(this,Uv,UA).call(this)&&t.push("ROUNDED_CORNERS"),De(this,jv,jA).call(this)&&t.push("STROKED"),this.createAndLinkShaders(toe,ioe,[noe,...t.map(i=>"#define "+i)])}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const t=this.properties;this.registerMarkUniformValue("uMinWidth",t.minWidth),this.registerMarkUniformValue("uMinHeight",t.minHeight),this.registerMarkUniformValue("uMinOpacity",t.minOpacity),this.registerMarkUniformValue("uCornerRadiusTopRight",t.cornerRadiusTopRight??t.cornerRadius??0),this.registerMarkUniformValue("uCornerRadiusBottomRight",t.cornerRadiusBottomRight??t.cornerRadius??0),this.registerMarkUniformValue("uCornerRadiusTopLeft",t.cornerRadiusTopLeft??t.cornerRadius??0),this.registerMarkUniformValue("uCornerRadiusBottomLeft",t.cornerRadiusBottomLeft??t.cornerRadius??0)}updateGraphicsData(){const t=this.unitView.getCollector();if(!t){console.debug("No collector");return}const i=t.getItemCount(),s=new xle({encoders:this.encoders,attributes:this.getAttributes(),numItems:i});s.addBatches(t.facetBatches);const o=s.toArrays();this.rangeMap.migrateEntries(o.rangeMap),this.updateBufferInfo(o)}prepareRender(t){const i=super.prepareRender(t);return i.push(()=>this.bindOrSetMarkUniformBlock()),i.push(()=>rf(this.gl,this.programInfo,this.vertexArrayInfo)),i}render(t){const i=this.gl;return this.createRenderCallback((s,o)=>{$L(i,this.vertexArrayInfo,i.TRIANGLE_STRIP,o,s)},t)}findDatumAt(t,i){t=Ks(t);const s=this.unitView.getCollector().facetBatches.get(t);if(!s)return;const o=this.encoders,r=o.x.scale.type;if(qd(r)){const a=o.x.dataAccessor;return s.find(l=>i==a(l))}else{const a=o.x.dataAccessor,l=o.x2.dataAccessor;return s.find(c=>i>=a(c)&&i<l(c))}}}Uv=new WeakSet,UA=function(){const t=this.properties;return t.cornerRadius||t.cornerRadiusBottomLeft||t.cornerRadiusBottomRight||t.cornerRadiusTopLeft||t.cornerRadiusTopRight},jv=new WeakSet,jA=function(){const t=this.encoding.strokeWidth;return!(_r(t)&&!t.value)||"condition"in t};const Ule=`out float vRadius;
out float vRadiusWithPadding;
out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out lowp float vShape;
out lowp float vHalfStrokeWidth;
out mat2 vRotationMatrix;

// Copypaste from fragment shader
const float CIRCLE = 0.0;
const float SQUARE = 1.0;
const float CROSS = 2.0;
const float DIAMOND = 3.0;
const float TRIANGLE_UP = 4.0;
const float TRIANGLE_RIGHT = 5.0;
const float TRIANGLE_DOWN = 6.0;
const float TRIANGLE_LEFT = 7.0;
const float TICK_UP = 8.0;
const float TICK_RIGHT = 9.0;
const float TICK_DOWN = 10.0;
const float TICK_LEFT = 11.0;

float computeSemanticThresholdFactor() {
    // TODO: add smooth transition
    return getScaled_semanticScore() >= uSemanticThreshold ? 1.0 : 0.0;
}

// TODO: Move this into common.glsl or something
vec2 getDxDy() {
#if defined(dx_DEFINED) || defined(dy_DEFINED)
    return vec2(getScaled_dx(), getScaled_dy()) / uViewportSize;
#else
    return vec2(0.0, 0.0);
#endif
}

void main(void) {
    float shapeAngle = 0.0;

    float semanticThresholdFactor = computeSemanticThresholdFactor();
    if (semanticThresholdFactor <= 0.0) {
        gl_PointSize = 0.0;
        // Place the vertex outside the viewport. The default (0, 0) makes this super-slow
        // on Apple Silicon. Probably related to the tile-based GPU architecture.
        gl_Position = vec4(100.0, 0.0, 0.0, 0.0);
        // Exit early. MAY prevent some unnecessary calculations.
        return;
    }

    float size = getScaled_size();
    vec2 pos = vec2(getScaled_x(), getScaled_y()) + getDxDy();

    gl_Position = unitToNdc(applySampleFacet(pos));

    float strokeWidth = getScaled_strokeWidth();

    float diameter = sqrt(size) *
        uScaleFactor *
        semanticThresholdFactor;

    // Clamp minimum size and adjust opacity instead. Yields more pleasing result,
    // no flickering etc.
    float opacity = uViewOpacity;
	if (strokeWidth <= 0.0 || uInwardStroke) {
		float minDiameter = 1.0 / uDevicePixelRatio;
		if (diameter < minDiameter) {
			// We do some "cheap" gamma correction here. It breaks on dark background, though.
			// First we take a square of the size and then apply "gamma" of 1.5.
			opacity *= pow(diameter / minDiameter, 2.5);
			diameter = minDiameter;
		}
	}

	float fillOpa = getScaled_fillOpacity() * opacity;
	float strokeOpa = getScaled_strokeOpacity() * opacity;

    vShape = getScaled_shape();

	// Circle doesn't have sharp corners. Do some special optimizations to minimize the point size.
	bool circle = vShape == 0.0;

    if (vShape > TICK_UP && vShape <= TICK_LEFT) {
        shapeAngle = (vShape - TICK_UP) * 90.0;
        vShape = TICK_UP;
    } else if (vShape > TRIANGLE_UP && vShape <= TRIANGLE_LEFT) {
        shapeAngle = (vShape - TRIANGLE_UP) * 90.0;
        vShape = TRIANGLE_UP;
    }

	float angleInDegrees = getScaled_angle();
	float angle = -(shapeAngle + angleInDegrees) * PI / 180.0;
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    vRotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);

    // Not needed if we would draw rotated quads instead of gl.POINTS
	float roomForRotation = circle ? 1.0 : sin(mod(angle, PI / 2.0) + PI / 4.0) / sin(PI / 4.0);

	float aaPadding = 1.0 / uDevicePixelRatio;
	float rotationPadding = (diameter * roomForRotation) - diameter;
	// sqrt(3.0) ensures that the angles of equilateral triangles have enough room
	float strokePadding = uInwardStroke ? 0.0 : strokeWidth * (circle ? 1.0 : sqrt(3.0));
	float padding = rotationPadding + strokePadding + aaPadding;

    gl_PointSize = max(
        (diameter + padding),
        uPickingEnabled ? uMinPickingSize : 0.0
    ) * uDevicePixelRatio;

	vRadius = diameter / 2.0;
	vRadiusWithPadding = vRadius + padding / 2.0;

    vHalfStrokeWidth = strokeWidth / 2.0;

    vFillColor = vec4(getScaled_fill() * fillOpa, fillOpa);
    vStrokeColor = vec4(getScaled_stroke() * strokeOpa, strokeOpa);

    setupPicking();
}
`,jle=`const lowp vec4 white = vec4(1.0);
const lowp vec4 black = vec4(0.0, 0.0, 0.0, 1.0);

in float vRadius;
in float vRadiusWithPadding;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in lowp float vShape;
in lowp float vHalfStrokeWidth;

in mat2 vRotationMatrix;

out lowp vec4 fragColor;

// Copypaste from vertex shader
const float CIRCLE = 0.0;
const float SQUARE = 1.0;
const float CROSS = 2.0;
const float DIAMOND = 3.0;
const float TRIANGLE_UP = 4.0;
const float TICK_UP = 8.0;

// The distance functions are inspired by:
// http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
// However, these are not true distance functions, because the corners need to be sharp.

float circle(vec2 p, float r) {
    return length(p) - r;
}

float square(vec2 p, float r) {
    p = abs(p);
    return max(p.x, p.y) - r;
}

float tickUp(vec2 p, float r) {
    float halfR = r * 0.5;
    p.y += halfR;
    p = abs(p);
    return max(p.x - r * 0.15, p.y - halfR);
}

float equilateralTriangle(vec2 p, float r) {
    p.y = -p.y;
    float k = sqrt(3.0);
    float kr = k * r;
    p.y -= kr / 2.0;
    return max((abs(p.x) * k + p.y) / 2.0, -p.y - kr);
}

float crossShape(vec2 p, float r) {
    p = abs(p);

	vec2 b = vec2(0.4, 1.0) * r;
    vec2 v = abs(p) - b.xy;
    vec2 h = abs(p) - b.yx;
    return min(max(v.x, v.y), max(h.x, h.y));
}

float diamond(vec2 p, float r) {
    p = abs(p);
    return (max(abs(p.x - p.y), abs(p.x + p.y)) - r) / sqrt(2.0);
}

void main() {
    float d;

	/** Normalized point coord */
    vec2 p = vRotationMatrix * (2.0 * gl_PointCoord - 1.0) * vRadiusWithPadding;
	float r = vRadius;

    // We could also use textures here. Could even be faster, because we have plenty of branching here.
    if (vShape == CIRCLE) {
        d = circle(p, r);

    } else if (vShape == SQUARE) {
        d = square(p, r);

    } else if (vShape == CROSS) {
        d = crossShape(p, r);

    } else if (vShape == DIAMOND) {
        d = diamond(p, r);

    } else if (vShape == TRIANGLE_UP) {
        d = equilateralTriangle(p, r);

    } else if (vShape == TICK_UP) {
        d = tickUp(p, r);

    } else {
        d = 0.0;
    }

	if (!uPickingEnabled) {
		lowp vec4 fillColor = mix(vFillColor, white, -d * uGradientStrength / vRadius);

		fragColor = distanceToColor(
			d + (uInwardStroke ? vHalfStrokeWidth : 0.0),
			fillColor,
			vStrokeColor,
			vHalfStrokeWidth);

	} else if (d - vHalfStrokeWidth <= 0.0) {
        fragColor = vPickingColor;

	} else {
		discard;
    }
}

`,qle=`layout(std140) uniform Mark {
    /**
    * The stroke should only grow inwards, e.g, the diameter/outline is not affected by the stroke width.
    * Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with
    * geometric zoom, etc.
    */
    uniform bool uInwardStroke;

    /** The minimum point size in pixels when rendering into the picking buffer */
    uniform float uMinPickingSize;

    /** Scale factor for geometric zoom */
    uniform mediump float uScaleFactor;

    uniform mediump float uZoomLevel;
    uniform highp float uSemanticThreshold;

    uniform mediump float uGradientStrength;

#pragma markUniforms
};
`;class f$ extends pn{constructor(e){super(),this.k=e.size||500,this.reset()}reset(){super.reset(),this.reservoir=[],this.W=void 0,this.ingester=this._initialIngester}_initialIngester(e){this.reservoir.push(e),this.reservoir.length==this.k&&(this.W=Math.exp(Math.log(Math.random())/this.k),this.i=this.k,this.next=this.i,this.ingester=this._finalIngester,this._setNextStop())}_finalIngester(e){++this.i==this.next&&(this.reservoir[Math.floor(Math.random()*this.k)]=e,this.W*=Math.exp(Math.log(Math.random())/this.k),this._setNextStop())}_setNextStop(){this.next+=Math.floor(Math.log(Math.random())/Math.log(1-this.W))+1}handle(e){this.ingester(e)}complete(){for(const e of this.reservoir)this._propagate(e);super.complete()}}function Gle(n,e,t){const i=new f$({type:"sample",size:n});for(const s of e)i.handle(t(s));return i.complete(),i.reservoir}const Kle={};var Pp,rL,g$;class Yle extends G1{constructor(t){super(t);ve(this,rL);ve(this,Pp,()=>0);this.augmentDefaultProperties({x:.5,y:.5,color:"#4c78a8",filled:!0,opacity:1,size:100,semanticScore:0,shape:"circle",strokeWidth:2,fillGradientStrength:0,dx:0,dy:0,angle:0,sampleFacetPadding:.1,semanticZoomFraction:.02,minPickingSize:2});const i=this.properties.semanticZoomFraction;if(i!=null)if(js(i)){const s=this.unitView.paramMediator.createExpression(i.expr);s.addListener(()=>this.getContext().animator.requestRender()),gt(this,Pp,s)}else gt(this,Pp,()=>i)}getAttributes(){return["uniqueId","facetIndex","x","y","size","semanticScore","shape","strokeWidth","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"size","semanticScore","shape","strokeWidth","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getDefaultEncoding(){return{...super.getDefaultEncoding(),...Kle}}fixEncoding(t){return u$(t,this.properties.filled),h$(t,this.properties.filled),delete t.color,delete t.opacity,t}initializeData(){var i,s;super.initializeData();const t=(s=(i=this.encoders.semanticScore)==null?void 0:i.dataAccessor)==null?void 0:s.asNumberAccessor();t&&(this.sampledSemanticScores=Float32Array.from(Gle(1e4,this.unitView.getCollector().getData(),t)),this.sampledSemanticScores.sort((o,r)=>o-r))}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(Ule,jle,[qle])}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const t=this.properties;this.registerMarkUniformValue("uInwardStroke",t.inwardStroke,i=>!!i),this.registerMarkUniformValue("uGradientStrength",t.fillGradientStrength),this.registerMarkUniformValue("uMinPickingSize",t.minPickingSize)}updateGraphicsData(){const t=this.unitView.getCollector();if(!t){console.debug("No collector");return}const i=t.getItemCount(),s=new Dle({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(i,this.properties.minBufferSize||0)});s.addBatches(t.facetBatches);const o=s.toArrays();this.rangeMap.migrateEntries(o.rangeMap),this.updateBufferInfo(o)}getSemanticThreshold(){if(this.sampledSemanticScores){const t=Math.max(0,1-J(this,Pp).call(this)*this.unitView.getZoomLevel());if(t<=0)return-1/0;if(t>=1)return 1/0;{const i=this.sampledSemanticScores;return pV(i,t)}}else return-1}prepareRender(t){const i=super.prepareRender(t);return i.push(()=>{wb(this.markUniformInfo,{uScaleFactor:De(this,rL,g$).call(this),uSemanticThreshold:this.getSemanticThreshold()}),this.markUniformsAltered=!0}),i.push(()=>this.bindOrSetMarkUniformBlock()),i.push(()=>rf(this.gl,this.programInfo,this.vertexArrayInfo)),i}render(t){const i=this.gl;return this.createRenderCallback((s,o)=>{o&&$L(i,this.vertexArrayInfo,i.POINTS,o,s)},t)}}Pp=new WeakMap,rL=new WeakSet,g$=function(){const t=Math.pow(2,this.properties.geometricZoomBound||0);return Math.pow(Math.min(1,this.unitView.getZoomLevel()/t),1/3)};const Zle=`// Line caps
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

/** Position along the rule */
in float pos;

/** Which side of the stroke: -0.5 or 0.5 */
in float side;

out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

/** Distances from the line endings. Used for rendering the round caps and dashes */
out highp vec2 vPosInPixels;


void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;

    // Stroke width in pixels
    float size = getScaled_size();
    float opacity = getScaled_opacity() * uViewOpacity;

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (size < pixelSize) {
        opacity *= size / pixelSize;
        size = pixelSize;
    }

    vec2 a = applySampleFacet(vec2(getScaled_x(), getScaled_y()));
    vec2 b = applySampleFacet(vec2(getScaled_x2(), getScaled_y2()));

    vec2 tangent = b - a;

    float offset = 0.0;
    float relativeDiff = 0.0;
    if (uMinLength > 0.0 || uStrokeCap != BUTT) {
        float len = length(tangent * uViewportSize);

        // Elongate to reach the minimum length.
        // The length difference in pixels
        float diff = max(0.0, uMinLength - len);

        // Add line caps
        if (uStrokeCap != BUTT) {
            diff += size;
        }

        relativeDiff = diff / len;
        offset = relativeDiff * (pos - 0.5);
    }

    // Apply caps and minimum length by spreading the vertices along the tangent
    vec2 p = pos < 1.0
        ? a + tangent * (pos + offset)
        : b + tangent * offset;

    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = pixelSize;

    // Extrude
    vec2 normal = normalize(vec2(-tangent.y, tangent.x) / uViewportSize);
    p += normal * side * (size + aaPadding) / uViewportSize;

    gl_Position = unitToNdc(p);

    vColor = vec4(getScaled_color() * opacity, opacity);
    vSize = size;
    vNormalLengthInPixels = side * (size + aaPadding);

    // TODO: Here's a precision problem that breaks round caps when zoomed in enough
    vPosInPixels = vec2(pos, (1.0 - pos)) * (1.0 + relativeDiff) * length(tangent * uViewportSize) -
        vec2(uStrokeCap != BUTT ? size / 2.0 : 0.0);
    
    setupPicking();
}
`,Xle=`// Line ending
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

uniform sampler2D uDashTexture;

in vec4 vColor;
in float vSize;

/** Position on the rule along its length in pixels */
in vec2 vPosInPixels;
in float vNormalLengthInPixels;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distanceFromEnd = -min(vPosInPixels[0], vPosInPixels[1]);
    float distance; // from the rule centerline or end
    if (distanceFromEnd > 0.0 && uStrokeCap == ROUND) {
        // round cap
        distance = length(vec2(distanceFromEnd, vNormalLengthInPixels));
    } else {
        distance = abs(vNormalLengthInPixels);
    }

    // Use a signed distance field to implement edge antialiasing
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), -0.5, 0.5) + 0.5;

    if (uDashTextureSize > 0.0) {
        float pos = (vPosInPixels[0] + uStrokeDashOffset) * dpr;
        float floored = floor(pos);
        vec2 texelPositions = (floored + vec2(0.5, 1.5)) / dpr / uDashTextureSize;
      
        // Do antialiasing
        opacity *= mix(
            texture(uDashTexture, vec2(texelPositions[0], 0)).r,
            texture(uDashTexture, vec2(texelPositions[1], 0)).r,
            clamp((pos - floored), 0.0, 1.0));
    }

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,Qle=`layout(std140) uniform Mark {
    /** Minimum rule length in pixels */
    uniform mediump float uMinLength;

    uniform mediump float uDashTextureSize;
    uniform lowp int uStrokeCap;
    uniform mediump float uStrokeDashOffset;

#pragma markUniforms
};
`;class Jle extends G1{constructor(e){super(e),this.dashTextureSize=0,this.augmentDefaultProperties({x2:void 0,y2:void 0,size:1,color:"black",opacity:1,minLength:0,strokeDash:null,strokeDashOffset:0,strokeCap:"butt"})}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){if(!(e.x&&e.y&&e.x2&&e.y2))if(e.x&&e.x2&&!e.y)e.y={value:.5},e.y2=e.y;else if(e.y&&e.y2&&!e.x)e.x={value:.5},e.x2=e.x;else if(e.x&&!e.y)e.y={value:0},e.y2={value:1},e.x2=e.x;else if(e.y&&!e.x)e.x={value:0},e.x2={value:1},e.y2=e.y;else if(e.x&&e.y&&e.y2)e.x2=e.x;else if(e.y&&e.x&&e.x2)e.y2=e.y;else if(e.y&&e.x)if(!e.x2&&Wo(e.y)&&e.y.type=="quantitative")e.x2=e.x,e.y2={datum:0};else if(!e.y2&&Wo(e.x)&&e.x.type=="quantitative")e.y2=e.y,e.x2={datum:0};else throw new Error("A bug!");else throw new Error("Invalid x and y encodings for rule mark: "+JSON.stringify(e));return e}async initializeGraphics(){if(await super.initializeGraphics(),this.properties.strokeDash){const e=this.gl,t=ece(this.properties.strokeDash);this.dashTexture=yb(e,{mag:e.NEAREST,min:e.NEAREST,internalFormat:e.R8,format:e.RED,src:t,height:1}),this.dashTextureSize=t.length}this.createAndLinkShaders(Zle,Xle,[Qle])}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;this.registerMarkUniformValue("uMinLength",e.minLength),this.registerMarkUniformValue("uStrokeCap",e.strokeCap??"butt",t=>["butt","square","round"].indexOf(t)),wb(this.markUniformInfo,{uDashTextureSize:+this.dashTextureSize}),this.markUniformsAltered=!0}updateGraphicsData(){const e=this.unitView.getCollector();if(!e){console.debug("No collector");return}const t=e.getItemCount(),i=new Lle({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(t,this.properties.minBufferSize||0)});i.addBatches(e.facetBatches);const s=i.toArrays();this.rangeMap.migrateEntries(s.rangeMap),this.updateBufferInfo(s)}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>this.bindOrSetMarkUniformBlock()),this.dashTexture&&t.push(()=>op(this.programInfo,{uDashTexture:this.dashTexture})),t.push(()=>rf(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>$L(t,this.vertexArrayInfo,t.TRIANGLE_STRIP,s,i),e)}}function ece(n){if(n.length==0||n.length%2||n.findIndex(o=>Math.round(o)!=o||o<1||o>1e3)>=0)throw new Error("Invalid stroke dash pattern: "+JSON.stringify(n));const e=n.reduce((o,r)=>o+r),t=new Uint8Array(e);let i=!0,s=0;for(let o of n){for(;o;)t[s++]=i&&255||0,o--;i=!i}return t}const tce=`out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

out float vGamma;

const int SHAPE_ARC = 0;
const int SHAPE_DOME = 1;
const int SHAPE_DIAGONAL = 2;
const int SHAPE_LINE = 3;
const int ORIENT_VERTICAL = 0;
const int ORIENT_HORIZONTAL = 1;

float distanceFromLine(vec2 pointOnLine1, vec2 pointOnLine2, vec2 point) {
    vec2 a = point - pointOnLine1;
    vec2 b = pointOnLine2 - pointOnLine1;
    vec2 proj = dot(a, b) / dot(b, b) * b;
    return length(a - proj);
}

bool isInsideViewport(vec2 point, float marginFactor) {
    vec2 margin = uViewportSize * vec2(marginFactor);
    return point.x >= -margin.x
        && point.x <= uViewportSize.x + margin.x
        && point.y >= -margin.y
        && point.y <= uViewportSize.y + margin.y;
}

void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;
    float opacity = getScaled_opacity() * uViewOpacity;

    // The bezier's control points
    vec2 p1, p2, p3, p4;

    vec2 a = applySampleFacet(vec2(getScaled_x(), getScaled_y())) * uViewportSize;
    vec2 b = applySampleFacet(vec2(getScaled_x2(), getScaled_y2())) * uViewportSize;

    if (uShape <= SHAPE_DOME) {
        if (uShape == SHAPE_DOME) {
            vec2 height = vec2(0.0);
            if (uOrient == ORIENT_VERTICAL) {
                p1 = vec2(min(a.x, b.x), b.y);
                p4 = vec2(max(a.x, b.x), b.y);
                height = vec2(0.0, a.y - b.y);

                if (uClampApex) {
                    if (p4.x > 0.0) {
                        p1.x = max(p1.x, -p4.x);
                    }
                    if (p1.x < uViewportSize.x) {
                        p4.x = min(p4.x, 2.0 * uViewportSize.x - p1.x);
                    }
                }

            } else {
                p1 = vec2(b.x, min(a.y, b.y));
                p4 = vec2(b.x, max(a.y, b.y));
                height = vec2(a.x - b.x, 0.0);

                if (uClampApex) {
                    if (p4.y > 0.0) {
                        p1.y = max(p1.y, -p4.y);
                    }
                    if (p1.y < uViewportSize.y) {
                        p4.y = min(p4.y, 2.0 * uViewportSize.y - p1.y);
                    }
                }
            }

            vec2 controlOffset = height / 0.75;

            p2 = p1 + controlOffset;
            p3 = p4 + controlOffset;

        } if (uShape == SHAPE_ARC) {
            p1 = a;
            p4 = b;

            vec2 chordVector = p4 - p1;
            vec2 unitChordVector = normalize(chordVector);
            vec2 chordNormal = vec2(-unitChordVector.y, unitChordVector.x);
            float chordLength = length(chordVector);

            if (chordLength > uMaxChordLength) {
                if (isInsideViewport(p1, 2.0)) {
                    chordLength = uMaxChordLength;
                    p4 = p1 + unitChordVector * uMaxChordLength;
                } else if (isInsideViewport(p4, 2.0)) {
                    chordLength = uMaxChordLength;
                    p1 = p4 - unitChordVector * uMaxChordLength;
                }
            }

            float height = max(
                chordLength / 2.0 * uArcHeightFactor,
                uMinArcHeight
            );

            // This is a bit poor approximation of a circular arc, but it's probably enough for most purposes.
            // TODO: Consider a more sophisticated approach: https://stackoverflow.com/a/44829356/1547896
            vec2 controlOffset = chordNormal * height / 0.75;

            p2 = p1 + controlOffset;
            p3 = p4 + controlOffset;
        }

    } else if (uShape == SHAPE_DIAGONAL) {
        if (uOrient == ORIENT_VERTICAL) {
            p1 = a;
            p2 = vec2(a.x, (a.y + b.y) / 2.0);
            p3 = vec2(b.x, (a.y + b.y) / 2.0);
            p4 = b;
        } else {
            p1 = a;
            p2 = vec2((a.x + b.x) / 2.0, a.y);
            p3 = vec2((a.x + b.x) / 2.0, b.y);
            p4 = b;
        }
    } else if (uShape == SHAPE_LINE) {
        p1 = a;
        p2 = (a + b) / 2.0;
        p3 = p2;
        p4 = b;
    }

    vec2 strip = vec2(
        float(gl_VertexID / 2) / float(uSegmentBreaks),
        float(gl_VertexID % 2) - 0.5
    );

    // Make segments shorter near the endpoints to make the tightly bent attachment points smoother
    float t = smoothstep(0.0, 1.0, strip.x);

    // https://stackoverflow.com/a/31317254/1547896
    vec2 C1 = p4 - 3.0 * p3 + 3.0 * p2 - p1;
    vec2 C2 = 3.0 * p3 - 6.0 * p2 + 3.0 * p1;
    vec2 C3 = 3.0 * p2 - 3.0 * p1;
    vec2 C4 = p1;

    vec2 p;
    // Skip computation at endpoints to maintain precision
    if (t == 0.0) {
        p = p1;
    } else if (t == 1.0) {
        p = p4;
    } else {
        p = C1*t*t*t + C2*t*t + C3*t + C4;
    }

    vec2 tangent = normalize(3.0*C1*t*t + 2.0*C2*t + C3);
    vec2 normal = vec2(-tangent.y, tangent.x);

    float size = getScaled_size();

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (size < pixelSize) {
        opacity *= size / pixelSize;
        size = pixelSize;
    }

    // Handle minimum picking size or add an extra pixel to the stroke width to accommodate edge antialiasing
    float paddedSize = uPickingEnabled
        ? max(size, uMinPickingSize)
        : size + pixelSize;

    vNormalLengthInPixels = strip.y * paddedSize;
    
    if (uShape == SHAPE_ARC &&
        uArcFadingDistance[0] > 0.0 &&
        uArcFadingDistance[1] > 0.0 &&
        (!uNoFadingOnPointSelection || !isPointSelected()))
    {
        float d = distanceFromLine(p1, p4, p);
        float distanceOpacity = smoothstep(uArcFadingDistance[1], uArcFadingDistance[0], d);    

        // Fade out
        opacity *= distanceOpacity;

        // Collapse fully transparent triangles to skip fragment processing 
        if (distanceOpacity <= 0.0) {
            vNormalLengthInPixels = 0.0;
        }
    }

    // Extrude
    p += normal * vNormalLengthInPixels;

    gl_Position = pixelsToNdc(p);

    vec3 color = getScaled_color();

    vColor = vec4(color * opacity, opacity);

    vGamma = getGammaForColor(color);

    vSize = paddedSize;

    setupPicking();
}
`,ice=`in vec4 vColor;
in float vSize;
in float vNormalLengthInPixels;
in float vGamma;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distance = abs(vNormalLengthInPixels);
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), 0.0, 1.0);

    opacity = pow(opacity, vGamma);

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,nce=`layout(std140) uniform Mark {
    uniform float uArcHeightFactor;

    /** Make very small arcs visible */
    uniform float uMinArcHeight;

    /** The minimum stroke width in pixels when rendering into the picking buffer */
    uniform float uMinPickingSize;

    uniform int uShape;
    uniform int uOrient;
    uniform bool uClampApex;

    // In pixels
    uniform float uMaxChordLength;
    // In pixels
    uniform vec2 uArcFadingDistance;
    uniform bool uNoFadingOnPointSelection;

    uniform int uSegmentBreaks;

#pragma markUniforms
};
`,sce=["arc","dome","diagonal","line"],oce=["vertical","horizontal"];class rce extends G1{constructor(e){super(e),this.augmentDefaultProperties({x:0,x2:void 0,y:0,y2:void 0,size:1,color:"black",opacity:1,segments:101,arcHeightFactor:1,minArcHeight:1.5,minPickingSize:3,clampApex:!1,maxChordLength:5e4,arcFadingDistance:!1,noFadingOnPointSelection:!0,linkShape:"arc",orient:"vertical"}),this._baseInstanceExt=this.gl.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){return e.x2||(Wo(e.x)?e.x2={datum:0}:e.x2=e.x),e.y2||(Wo(e.y)?e.y2={datum:0}:e.y2=e.y),e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(tce,ice,[nce])}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;this.registerMarkUniformValue("uArcFadingDistance",e.arcFadingDistance,t=>t||[0,0]),this.registerMarkUniformValue("uArcHeightFactor",e.arcHeightFactor),this.registerMarkUniformValue("uMinArcHeight",e.minArcHeight),this.registerMarkUniformValue("uMinPickingSize",e.minPickingSize),this.registerMarkUniformValue("uShape",e.linkShape,t=>sce.indexOf(t)),this.registerMarkUniformValue("uOrient",e.orient,t=>oce.indexOf(t)),this.registerMarkUniformValue("uClampApex",e.clampApex,t=>!!t),this.registerMarkUniformValue("uMaxChordLength",e.maxChordLength),this.registerMarkUniformValue("uSegmentBreaks",e.segments,t=>t),this.registerMarkUniformValue("uNoFadingOnPointSelection",e.noFadingOnPointSelection,t=>!!t)}updateGraphicsData(){const e=this.unitView.getCollector();if(!e){console.debug("No collector");return}const t=e.getItemCount(),i=new kle({encoders:this.encoders,attributes:this.getAttributes(),numItems:t});i.addBatches(e.facetBatches);const s=i.toArrays();this.rangeMap.migrateEntries(s.rangeMap),this.arrays=Object.fromEntries(Object.entries(s.arrays).map(([o,r])=>[o,{...r,data:void 0}])),this.updateBufferInfo(s)}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>this.bindOrSetMarkUniformBlock()),this._baseInstanceExt?t.push(()=>rf(this.gl,this.programInfo,this.vertexArrayInfo)):t.push(()=>this.gl.bindVertexArray(null)),t}render(e){const t=this.gl,i=()=>(this.markUniformInfo.uniforms.uSegmentBreaks[0]+1)*2;return this._baseInstanceExt?this.createRenderCallback((s,o)=>{this._baseInstanceExt.drawArraysInstancedBaseInstanceWEBGL(t.TRIANGLE_STRIP,0,i(),o,s)},e):this.createRenderCallback((s,o)=>{for(const r of Object.entries(this.bufferInfo.attribs)){const[a,l]=r;l.buffer&&l.numComponents&&l.divisor&&(l.offset=s*this.arrays[a].numComponents*this.bytesPerElement.get(a))}rf(t,this.programInfo,this.bufferInfo),t.drawArraysInstanced(t.TRIANGLE_STRIP,0,i(),o)},e)}}const ace=`in mediump vec2 vertexCoord;
in lowp vec2 textureCoord;

// Width of the text (all letters)
in float width;

out vec2 vTexCoord;
out vec4 vColor;
out float vSlope;
out float vEdgeFadeOpacity;
out float vGamma;

struct RangeResult {
    float pos;
    float scale;
};

float minValue(vec4 v) {
    return min(min(v.x, v.y), min(v.z, v.w));
}

float maxValue(vec4 v) {
    return max(max(v.x, v.y), max(v.z, v.w));
}

/**
 * All measures are in [0, 1]
 */
RangeResult positionInsideRange(float a, float b, float width, float padding,
                                int align, bool flush) {
    float span = b - a;
    float paddedWidth = width + 2.0 * padding;

    // Is the text clearly outside the viewport
    if (a > 1.0 || b < 0.0) {
        return RangeResult(0.0, 0.0);
    }

    // How much extra space we have for adjusting the position so that the
    // text stays inside the range.
    float extra = max(0.0, span - paddedWidth);

    float pos;

    // Align the text and try to keep it inside the range and the viewport
    if (align == 0) {
        float centre = a + b;

        if (flush) {
            float leftOver = max(0.0, paddedWidth - centre);
            centre += min(leftOver, extra);

            float rightOver = max(0.0, paddedWidth + centre - 2.0);
            centre -= min(rightOver, extra);
        }

        pos = centre / 2.0;

    } else if (align < 0) {
        float edge = a;

        if (flush) {
            float over = max(0.0, -edge);
            edge += min(over, extra);
        }

        pos = edge + padding;

    } else {
        float edge = b;

        if (flush) {
            float over = max(0.0, edge - 1.0);
            edge -= min(over, extra);
        }

		// TODO: If the text spans the whole viewport, try to keep it centered if possible.

        pos = edge - padding;
    }

    // How the text should be scaled to make it fit inside the range (if it didn't fit).
    float scale = clamp((span - padding) / paddedWidth, 0.0, 1.0);

    // TODO: Fix padding in scale factor. Padding should stay constant
    return RangeResult(pos, scale);
}

vec2 calculateRotatedDimensions(float width, mat2 rotationMatrix) {
    vec2 a = abs(rotationMatrix * vec2(width / 2.0, 0.5));
    vec2 b = abs(rotationMatrix * vec2(width / 2.0, -0.5));
    return vec2(max(a.x, b.x), max(a.y, b.y)) * 2.0;
}

/** Needed when using ranged text */
ivec2 fixAlignForAngle(ivec2 align, float angleInDegrees) {
    float a = mod(angleInDegrees + 45.0, 360.0);
    int x = align.x;
    int y = -align.y;

    // TODO: Optimize by avoiding branching
    if (a < 90.0) {
        return ivec2(x, y);
    } else if (a < 180.0) {
        return ivec2(y, -x);
    } else if (a < 270.0) {
        return ivec2(-x, y);
    } else {
        return ivec2(-y, x);
    }
}

void main(void) {
    float opacity = getScaled_opacity() * uViewOpacity;
    vec2 size = vec2(getScaled_size());
    float x = getScaled_x();
    float y = getScaled_y();

    float scale = 1.0;

	float angleInDegrees = getScaled_angle();
	float angle = -angleInDegrees * PI / 180.0;
	
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    mat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);

    vec2 flushSize = calculateRotatedDimensions(width, rotationMatrix);

#if defined(x2_DEFINED) || defined(y2_DEFINED)
    ivec2 align = fixAlignForAngle(uAlign, angleInDegrees);
#else
    ivec2 align = uAlign;
#endif

#ifdef x2_DEFINED
    float x2 = getScaled_x2();

    if (uLogoLetter) {
        size.x = (x2 - x) * uViewportSize.x;
        x += (x2 - x) / 2.0;

    } else {
        float x2 = getScaled_x2();
        RangeResult result = positionInsideRange(
            min(x, x2), max(x, x2),
            size.x * scale * flushSize.x / uViewportSize.x, uPaddingX / uViewportSize.x,
            align.x, uFlushX);
        
        x = result.pos;
        scale *= result.scale;
    }
#endif

    // Position of the text origo 
    vec2 pos = applySampleFacet(vec2(x, y));

#ifdef y2_DEFINED
    float y2 = getScaled_y2();
    vec2 pos2 = applySampleFacet(vec2(x, y2));

    if (uLogoLetter) {
        size.y = (pos2.y - pos.y) * uViewportSize.y;
        pos.y += (pos2.y - pos.y) / 2.0;

    } else {
        RangeResult result = positionInsideRange(
            min(pos.y, pos2.y), max(pos.y, pos2.y),
            size.y * scale * flushSize.y / uViewportSize.y, uPaddingY / uViewportSize.y,
            align.y, uFlushY);
        
        pos.y = result.pos;
        scale *= result.scale;
    }
#endif

    if (scale < 1.0) {
        if (uSqueeze) {
            vec2 scaleFadeExtent = vec2(3.0, 6.0) / size;

            if (scale  < scaleFadeExtent[0]) {
                gl_Position = vec4(0.0);
                return;
            }

            size *= scale;
            opacity *= linearstep(scaleFadeExtent[0], scaleFadeExtent[1], scale);

        } else if (scale < 1.0) {
            // Eliminate the text
            gl_Position = vec4(0.0);
            return;
        }
    }

    // Position of the character vertex in relation to the text origo
    vec2 charPos = rotationMatrix * (vertexCoord * size + uD);

    // Position of the character vertex inside the unit viewport
    vec2 unitPos = pos + charPos / uViewportSize;

    gl_Position = unitToNdc(unitPos);

    // Controls antialiasing of the SDF
    vSlope = max(1.0, min(size.x, size.y) / uSdfNumerator);

    vec3 color = getScaled_color();

    // Premultiply alpha
    vColor = vec4(color * opacity, opacity);

    // Do something like gamma correction for text when the color is close to black or white.
    vGamma = getGammaForColor(color);

    vTexCoord = textureCoord;

    // Edge fading. The implementation is simplistic and fails with primitives that
    // span the whole viewport. However, it works just fine with reasonable font sizes.
    // x: top, y: right, z: bottom, w: left
    if (maxValue(uViewportEdgeFadeDistance) > -pow(10.0, 10.0)) { // -Infinity would be nice
        vEdgeFadeOpacity = minValue(
            ((vec4(1.0, 1.0, 0.0, 0.0) + vec4(-1.0, -1.0, 1.0, 1.0) * unitPos.yxyx) *
                uViewportSize.yxyx - uViewportEdgeFadeDistance) / uViewportEdgeFadeWidth);
    } else {
        vEdgeFadeOpacity = 1.0;
    }

    setupPicking();
}
`,lce=`uniform sampler2D uTexture;

in vec2 vTexCoord;
in float vEdgeFadeOpacity;
in vec4 vColor;
in float vSlope;
in float vGamma;

out lowp vec4 fragColor;

float median(float r, float g, float b) {
    return max(min(r, g), min(max(r, g), b));
}

void main() {
    // TODO: Really small text should fall back to normal (non-SDF) texture that can be mip-mapped.
    // Currently small text has severe aliasing artifacts.

    vec3 c = texture(uTexture, vTexCoord).rgb;

    float sigDist = 1.0 - median(c.r, c.g, c.b);

    // Using screen-space derivatives for logo letters because skewed aspect ratios
    // result in blurry edges otherwise. However, use of screen-space derivatives
    // results in crappy looking text with regular letters text.
    float slope = uLogoLetter
        ? 0.7 / length(vec2(dFdy(sigDist), dFdx(sigDist)))
        : vSlope;

    float opa = clamp((sigDist - 0.5) * slope + 0.5, 0.0, 1.0);

    opa *= clamp(vEdgeFadeOpacity, 0.0, 1.0);

    opa = pow(opa, vGamma);

    fragColor = vColor * opa;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,cce=`layout(std140) uniform Mark {
    uniform mediump float uSdfNumerator;

    uniform mediump vec2 uD; // dx & dy

    uniform mediump vec4 uViewportEdgeFadeWidth;
    uniform mediump vec4 uViewportEdgeFadeDistance;
        
    uniform bool uSqueeze;
    uniform bool uLogoLetter;

    // x: -1, 0, 1 = left, center, right
    // y: -1, 0, 1 = top, middle, bottom 
    uniform lowp ivec2 uAlign;

    uniform mediump float uPaddingX;
    uniform bool uFlushX;
    uniform mediump float uPaddingY;
    uniform bool uFlushY;

#pragma markUniforms
};
`,dce={left:-1,center:0,right:1},uce={top:-1,middle:0,bottom:1,alphabetic:1};class hce extends G1{constructor(e){super(e),this.augmentDefaultProperties({x:.5,y:.5,x2:void 0,y2:void 0,text:"",size:11,color:"black",opacity:1,font:void 0,fontStyle:void 0,fontWeight:void 0,align:"center",baseline:"middle",dx:0,dy:0,angle:0,fitToBand:!1,squeeze:!0,paddingX:0,paddingY:0,flushX:!0,flushY:!0,logoLetters:!1,viewportEdgeFadeWidthTop:0,viewportEdgeFadeWidthRight:0,viewportEdgeFadeWidthBottom:0,viewportEdgeFadeWidthLeft:0,viewportEdgeFadeDistanceTop:-1/0,viewportEdgeFadeDistanceRight:-1/0,viewportEdgeFadeDistanceBottom:-1/0,viewportEdgeFadeDistanceLeft:-1/0}),this.font=this.properties.font?e.context.fontManager.getFont(this.properties.font,this.properties.fontStyle,this.properties.fontWeight):e.context.fontManager.getDefaultFont(),this.setupExprRefsNeedingGraphicsUpdate(["text","fitToBand","logoLetters"])}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","color","size","opacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size","text","angle"]}fixEncoding(e){for(const t of Km)this.properties.fitToBand&&$A(e,t);return e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(ace,lce,[cce])}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;this.registerMarkUniformValue("uSdfNumerator",{expr:"devicePixelRatio"},t=>{let i=.35;return this.properties.logoLetters&&(i/=2),this.font.metrics.common.base/(t/i)}),this.registerMarkUniformValue("uPaddingX",e.paddingX),this.registerMarkUniformValue("uPaddingY",e.paddingY),this.registerMarkUniformValue("uFlushX",e.flushX,t=>!!t),this.registerMarkUniformValue("uFlushY",e.flushY,t=>!!t),this.registerMarkUniformValue("uSqueeze",e.squeeze,t=>!!t),wb(this.markUniformInfo,{uAlign:[dce[e.align],uce[e.baseline]],uD:[e.dx,-e.dy],uLogoLetter:!!e.logoLetters,uViewportEdgeFadeWidth:[e.viewportEdgeFadeWidthTop,e.viewportEdgeFadeWidthRight,e.viewportEdgeFadeWidthBottom,e.viewportEdgeFadeWidthLeft],uViewportEdgeFadeDistance:[e.viewportEdgeFadeDistanceTop,e.viewportEdgeFadeDistanceRight,e.viewportEdgeFadeDistanceBottom,e.viewportEdgeFadeDistanceLeft]})}updateGraphicsData(){const e=this.unitView.getCollector();if(!e){console.debug("No collector");return}const t=e.getData(),i=this.encoding,s=this.encoders.text;let o=0;const r="format"in i.text?ls(i.text.format):c=>c;for(const c of t){const d=r(s(c)),u=ci(d)?d:d===null?"":""+d;o+=u&&u.length||0}const a=new Ele({encoders:this.encoders,attributes:this.getAttributes(),properties:this.properties,fontMetrics:this.font.metrics,numCharacters:Math.max(o,this.properties.minBufferSize||1024)});a.addBatches(e.facetBatches);const l=a.toArrays();this.rangeMap.migrateEntries(l.rangeMap),this.updateBufferInfo(l)}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>{op(this.programInfo,{uTexture:this.font.texture})}),t.push(()=>this.bindOrSetMarkUniformBlock()),t.push(()=>rf(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,s)=>$L(t,this.vertexArrayInfo,t.TRIANGLES,s,i),e)}}const kF=1;function R4(){let n=[0,1],e=[0,1],t=1,i=1,s=0,o=0,r=.5,a=0;const c=d=>(d+r-n[0])/t*i+e[0];return c.invert=d=>(d-e[0])/i*t+n[0]-r,c.domain=function(d){if(arguments.length){n=dJ(d),t=n[1]-n[0];const u=n[0]===0&&n[0]===0;if(t<kF&&!u){t=kF;const h=(n[0]+n[1])/2;n[0]=h-t/2,n[1]=h+t/2}return c}else return n.slice()},c.range=function(d){return arguments.length?(e=[...d],i=e[1]-e[0],c):e},c.numberingOffset=function(d){return arguments.length?(a=d,c):a},c.padding=function(d){return arguments.length?(o=d,s=Math.min(1,d),c):s},c.paddingInner=function(d){return arguments.length?(s=Math.min(1,d),c):s},c.paddingOuter=function(d){return arguments.length?(o=d,c):o},c.align=function(d){return arguments.length?(r=Math.max(0,Math.min(1,d)),c):r},c.step=()=>i/t,c.bandwidth=()=>c.step(),c.ticks=d=>{const u=c.align(),h=c.numberingOffset();return dS(n[0]-u+h,n[1]-u+h,Math.min(d,Math.ceil(t))).filter(Number.isInteger).map(f=>f-a)},c.tickFormat=(d,u)=>{if(u)throw new Error("Index scale's tickFormat does not support a specifier!");const f=Vd(n[0],n[1],Math.min(d,Math.ceil(t)))<1e5?ls(","):ls(".3s");return g=>f(g+a)},c.copy=()=>R4().domain(n).range(e).paddingInner(s).paddingOuter(o).numberingOffset(a),c}function fce(){const n=R4().numberingOffset(1);let e;n.genome=function(i){return arguments.length?(e=i,n):e},n.ticks=i=>{if(!e)return[];const s=n.domain(),o=n.numberingOffset(),[r,a]=[Math.max(s[0],0),Math.min(s[1],e.totalSize-1)].map(d=>e.toChromosome(d)),l=Math.max(1,Vd(s[0],s[1],i)),c=[];for(let d=r.index;d<=a.index;d++){const u=e.chromosomes[d],h=Math.max(u.continuousStart+l,s[0]-(s[0]-u.continuousStart)%l),f=Math.min(u.continuousEnd-l/4,s[1]+1);for(let g=h;g<=f;g+=l){const p=g-o;p>=s[0]&&p<s[1]&&c.push(p)}}return c},n.tickFormat=(i,s)=>{if(!e)return;if(s)throw new Error("Locus scale's tickFormat does not support a specifier!");const o=n.domain(),r=o[1]-o[0],a=n.numberingOffset(),c=Vd(o[0],o[1],Math.min(i,Math.ceil(r)))<1e6?ls(","):ls(".3s"),d=u=>u-e.toChromosome(u).continuousStart;return u=>c(d(u)+a)};const t=n.copy;return n.copy=()=>t().genome(e),n}function gce(n){return n.type=="locus"}function xS(n,e,t){if(t=t||[],n.some(r=>r===null)){if(n.every(r=>r===null))return null;throw console.warn(n),new Error("Cannot merge objects with nulls!")}const i={},s=(r,a)=>r===a||ag(r)&&ag(a)||ag(r)&&a===!0||r===!0&&Ms(a),o=r=>{for(let a in r){const l=r[a];if(!t.includes(a)&&l!==void 0)if(i[a]!==void 0&&!s(i[a],l))console.warn(`Conflicting property ${a} of ${e}: (${JSON.stringify(i[a])} and ${JSON.stringify(r[a])}). Using ${JSON.stringify(i[a])}.`);else{const c=i[a];if(ag(c))ag(l)&&(i[a]=xS([c,l],a));else if(ag(l)){if(!(c===!0||c===void 0))throw new Error("Bug in merge! Target is: "+c);i[a]=xS([{},l],a)}else i[a]=l}}};for(const r of n)o(r);return i}function ag(n){return Ms(n)&&!Array.isArray(n)}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/ticks.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */function p$(n,e,t){return Js(e)&&t!=null&&(e=Math.min(e,~~(aS(n.domain())/t)||1)),Ms(e)&&(e.step,e=e.interval),e}function m$(n,e,t){var i=n.range(),s=Math.floor(i[0]),o=Math.ceil(Jr(i));if(s>o&&(i=o,o=s,s=i),e=e.filter(function(a){return a=n(a),s<=a&&a<=o}),t>0&&e.length>1){for(var r=[e[0],Jr(e)];e.length>t&&e.length>=3;)e=e.filter(function(a,l){return!(l%2)});e.length<3&&(e=r)}return e}function pce(n,e){return n.bins?m$(n,mce(n.bins,e)):n.ticks?n.ticks(e):n.domain()}function mce(n,e){var t=n.length,i=~~(t/(e||t));return i<2?n.slice():n.filter(function(s,o){return!(o%i)})}function _ce(n,e,t){var i=n.tickFormat?n.tickFormat(e,t):t?ls(t):String;if(EH(n.type)){var s=vce(t);i=n.bins?s:bce(i,s)}return i}function bce(n,e){return function(t){return n(t)?e(t):""}}function vce(n){var e=zd(n||",");if(e.precision==null){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1;break}return yce(ls(e),ls(".1f")(1)[1])}else return ls(e)}function yce(n,e){return function(t){var i=n(t),s=i.indexOf(e),o,r;if(s<0)return i;for(o=wce(i,s),r=o<i.length?i.slice(o):"";--o>s;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+r}}function wce(n,e){var t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/Scale.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */const Cce="locus",Sce="index";var xce=5;function Lce(n){const e=n.type;return!n.bins&&(e===lm||e===R1||e===M1)}function _$(n){return os(n)&&![ja,Sce,Cce].includes(n)}function b$(n){return n||{warn:(e,...t)=>console.warn(e,...t)}}var Dce=lS(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma","zoom","fp64","name"]);function v$(n,e,t){t=b$(t);for(const i in n)if(!Dce[i]){if(i==="padding"&&_$(e.type))continue;dr(e[i])?e[i](n[i]):t.warn("Unsupported scale property: "+i)}Mce(e,n,Rce(e,n,Ice(e,n,t)))}function kce(n,e){const t=Ece(n),i=ei(t);if(!i)throw new Error("Unknown scale type: "+t);const s=i();return!n.domain&&os(s.type)&&(n.domain=[0,0]),v$(n,s,e),s}function Ece(n){var e=n.type,t="",i;return e===ja?ja+"-"+lm:(Ace(n)&&(i=n.rawDomain?n.rawDomain.length:n.domain?n.domain.length+ +(n.domainMid!=null):0,t=i===2?ja+"-":i===3?Gm+"-":""),(t+e||lm).toLowerCase())}function Ace(n){const e=n.type;return os(e)&&e!==yH&&e!==wH&&(n.scheme||n.range&&n.range.length&&n.range.every(ci))}function Ice(n,e,t){if(!n.domain)return 0;t=b$(t);var i=Tce(n,e.domainRaw,t);if(i>-1)return i;var s=e.domain,o=n.type,r=e.zero||e.zero===void 0&&Lce(n),a,l;return s?(_$(o)&&e.padding&&s[0]!==Jr(s)&&(s=Nce(o,s,e.range,e.padding,e.exponent,e.constant)),(r||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null)&&(a=(s=s.slice()).length-1||1,r&&(s[0]>0&&(s[0]=0),s[a]<0&&(s[a]=0)),e.domainMin!=null&&(s[0]=e.domainMin),e.domainMax!=null&&(s[a]=e.domainMax),e.domainMid!=null&&(l=e.domainMid,(l<s[0]||l>s[a])&&t.warn("Scale domainMid exceeds domain min or max.",l),s.splice(a,0,l))),n.domain(y$(o,s,t)),o===S4&&n.unknown(e.domainImplicit?SA:void 0),e.nice&&n.nice&&n.nice(e.nice!==!0&&p$(n,e.nice)||null),s.length):0}function Tce(n,e,t){return e?(n.domain(y$(n.type,e,t)),e.length):-1}function Nce(n,e,t,i,s,o){t??(t=[0,1]);var r=Math.abs(Jr(t)-t[0]),a=r/(r-2*i),l=n===jd?oV(e,null,a):n===M1?cA(e,null,a,.5):n===R1?cA(e,null,a,s||1):n===XL?MQ(e,null,a,o||1):sV(e,null,a);return e=e.slice(),e[0]=l[0],e[e.length-1]=l[1],e}function y$(n,e,t){if(EH(n)){var i=Math.abs(e.reduce(function(s,o){return s+(o<0?-1:o>0?1:0)},0));i!==e.length&&t.warn("Log scale domain includes zero: "+RM(e))}return e}function Rce(n,e,t){let i=e.bins;if(i&&!Rs(i)){const s=(i.start==null||i.stop==null)&&n.domain(),o=i.start==null?s[0]:i.start,r=i.stop==null?Jr(s):i.stop,a=i.step;a||Tn("Scale bins parameter missing step property."),i=ab(o,r+a,a)}return i?n.bins=i:n.bins&&delete n.bins,n.type===x4&&(i?!e.domain&&!e.domainRaw&&(n.domain(i),t=i.length):n.bins=n.domain()),t}function Mce(n,e,t){var i=n.type,s=e.round||!1,o=e.range;if(e.rangeStep!=null)o=Pce(i,e,t);else if(e.scheme&&(o=Oce(i,e,t),dr(o))){if(n.interpolator)return n.interpolator(o);Tn(`Scale type ${i} does not support interpolating color schemes.`)}if(o&&QL(i))return n.interpolator(JL(qA(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&n.interpolate?n.interpolate(AH(e.interpolate,e.interpolateGamma)):dr(n.round)?n.round(s):dr(n.rangeRound)&&n.interpolate(s?T1:pu),o&&n.range(qA(o,e.reverse))}function Pce(n,e,t){n!==xH&&n!==MA&&Tn("Only band and point scales support rangeStep.");var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,s=n===MA?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*C4(t,s,i)]}function Oce(n,e,t){var i=e.schemeExtent,s,o;return Rs(e.scheme)?o=JL(e.scheme,e.interpolate,e.interpolateGamma):(s=e.scheme.toLowerCase(),o=D4(s),o||Tn(`Unrecognized scheme name: ${e.scheme}`)),t=n===SH?t+1:n===x4?t-1:n===RA||n===CH?+e.schemeCount||xce:t,QL(n)?EF(o,i,e.reverse):dr(o)?vre(EF(o,i),t):n===S4?o:o.slice(0,t)}function EF(n,e,t){return dr(n)&&(e||t)?bre(n,qA(e||[0,1],t)):n}function qA(n,e){return e?n.slice().reverse():n}const AF=ls(",d");function Fce(n,e){return n.chrom+":"+AF(Math.floor(n.pos+1))+"-"+(n.chrom!=e.chrom?e.chrom+":":"")+AF(Math.ceil(e.pos))}const Bce=`chr3R	32079331
chr3L	28110227
chr2R	25286936
chrX	23542271
chr2L	23513712
chrY	3667352
chr4	1348131
chrM	19524`,Wce=`chr1	247249719
chr2	242951149
chr3	199501827
chr4	191273063
chr5	180857866
chr6	170899992
chr7	158821424
chr8	146274826
chr9	140273252
chr10	135374737
chr11	134452384
chr12	132349534
chr13	114142980
chr14	106368585
chr15	100338915
chr16	88827254
chr17	78774742
chr18	76117153
chr19	63811651
chr20	62435964
chr21	46944323
chr22	49691432
chrX	154913754
chrY	57772954
chrM	16571`,Vce=`chr1	249250621
chr2	243199373
chr3	198022430
chr4	191154276
chr5	180915260
chr6	171115067
chr7	159138663
chr8	146364022
chr9	141213431
chr10	135534747
chr11	135006516
chr12	133851895
chr13	115169878
chr14	107349540
chr15	102531392
chr16	90354753
chr17	81195210
chr18	78077248
chr19	59128983
chr20	63025520
chr21	48129895
chr22	51304566
chrX	155270560
chrY	59373566
chrM	16571`,zce=`chr1	248956422
chr2	242193529
chr3	198295559
chr4	190214555
chr5	181538259
chr6	170805979
chr7	159345973
chr8	145138636
chr9	138394717
chr10	133797422
chr11	135086622
chr12	133275309
chr13	114364328
chr14	107043718
chr15	101991189
chr16	90338345
chr17	83257441
chr18	80373285
chr19	58617616
chr20	64444167
chr21	46709983
chr22	50818468
chrX	156040895
chrY	57227415
chrM	16569`,Hce=`chr1	197195432
chr2	181748087
chr3	159599783
chr4	155630120
chr5	152537259
chr6	149517037
chr7	152524553
chr8	131738871
chr9	124076172
chr10	129993255
chr11	121843856
chr12	121257530
chr13	120284312
chr14	125194864
chr15	103494974
chr16	98319150
chr17	95272651
chr18	90772031
chr19	61342430
chrX	166650296
chrY	15902555
chrM	16299`,$ce=`chr1	195471971
chr2	182113224
chr3	160039680
chr4	156508116
chr5	151834684
chr6	149736546
chr7	145441459
chr8	129401213
chr9	124595110
chr10	130694993
chr11	122082543
chr12	120129022
chr13	120421639
chr14	124902244
chr15	104043685
chr16	98207768
chr17	94987271
chr18	90702639
chr19	61431566
chrX	171031299
chrY	91744698
chrM	16299`,IF={dm6:Bce,hg18:Wce,hg19:Vce,hg38:zce,mm9:Hce,mm10:$ce};function Uce(n){if(!(n in IF))throw new Error(`Unknown assembly: ${n}`);return IF[n].split(`
`).map(e=>{const t=e.split("	");return{name:t[0],size:parseInt(t[1])}})}const jce=/^([A-Za-z]+:)?\/\//;function Ab(n,e){if(e&&jce.test(e))return e;const t=typeof n=="function"?n():n;if(!t)return e;if(!e)return t;if(/[#?]/.test(t))throw new Error(`Cannot append to a url with query or hash. Append: ${e}, base: ${t}`);return w$(t)+e}function w$(n){const e=n.replace(/[^/]*$/,"");return e===""?void 0:e.endsWith("://")?n+"/":e}class qce{constructor(e){if(this.config={name:"custom",...e},"baseUrl"in e)throw new Error("The `baseUrl` property in genome config has been removed in GenomeSpy v0.52.0. Use `url` instead. See https://genomespy.app/docs/genomic-data/genomic-coordinates/.");if(!M4(e))throw new Error("Not a genome configuration: "+JSON.stringify(e));if(this.chromosomes=[],this.cumulativeChromPositions=new Map,this.chromosomesByName=new Map,this.startByIndex=[],this.totalSize=0,S$(this.config))this.setChromSizes(this.config.contigs);else if(!GA(this.config)){const t=Uce(this.config.name);if(t)this.setChromSizes(t);else throw new Error(`Unknown genome: ${this.config.name}. Please provide contigs or a URL. See https://genomespy.app/docs/genomic-data/genomic-coordinates/.`)}}get name(){return this.config.name}async load(e){if(GA(this.config))try{const t=Ab(e,this.config.url),i=await fetch(t);if(!i.ok)throw new Error(`${i.status} ${i.statusText}`);this.setChromSizes(Gce(await i.text()))}catch(t){throw new Error(`Could not load chrom sizes: ${this.config.url}. Reason: ${t.message}`)}}hasChrPrefix(){return this.chromosomes.some(e=>e.name.startsWith("chr"))}setChromSizes(e){let t=0;this.startByIndex=[0];for(let i=0;i<e.length;i++){this.startByIndex.push(t);const s=e[i].size,o={...e[i],continuousStart:t,continuousEnd:t+s,continuousInterval:[t,t+s],index:i,number:i+1,odd:!(i&1)};this.chromosomes.push(o);const r=o.name.replace(/^chr/i,"");for(const a of["chr"+r,"CHR"+r,"Chr"+r,o.number,""+o.number,r,o.name])this.cumulativeChromPositions.set(a,t),this.chromosomesByName.set(a,o);t+=o.size}this.totalSize=t}getExtent(){return[0,this.totalSize]}toContinuous(e,t){let i=this.cumulativeChromPositions.get(e);if(i===void 0)throw new Error("Unknown chromosome/contig: "+e);return i+ +t}toChromosome(e){if(e>this.totalSize)return;e=Math.floor(e);const t=Wd(this.startByIndex,e)-1;if(t>0&&t<=this.chromosomes.length)return this.chromosomes[t-1]}toChromosomal(e){const t=this.toChromosome(e);if(t)return{chrom:t.name,pos:Math.floor(e)-t.continuousStart}}getChromosome(e){return this.chromosomesByName.get(e)}formatInterval(e){return Fce(...this.toChromosomalInterval(e))}toChromosomalInterval(e){const t=this.toChromosomal(e[0]+.5),i=this.toChromosomal(e[1]-.5);return i.pos+=1,[t,i]}toContinuousInterval(e){var s;let[t,i]=e;return i||(i=t),[this.toContinuous(t.chrom,t.pos??0),this.toContinuous(i.chrom,i.pos??((s=this.chromosomesByName.get(i.chrom))==null?void 0:s.size))]}toDiscreteChromosomeIntervals(e){const t=e[0],i=e[1],s=[];if(t.chrom===i.chrom)s.push({chrom:t.chrom,startPos:t.pos,endPos:i.pos});else{const o=this.chromosomes.findIndex(a=>a.name===t.chrom),r=this.chromosomes.findIndex(a=>a.name===i.chrom);s.push({chrom:t.chrom,startPos:t.pos,endPos:this.chromosomes[o].size});for(let a=o+1;a<r;a++)s.push({chrom:this.chromosomes[a].name,startPos:0,endPos:this.chromosomes[a].size});s.push({chrom:i.chrom,startPos:0,endPos:i.pos})}return s}continuousToDiscreteChromosomeIntervals(e){return this.toDiscreteChromosomeIntervals([this.toChromosomal(e[0]),this.toChromosomal(e[1])])}parseInterval(e){const t=e.match(/^(chr[0-9A-Z]+)(?::([0-9,]+)(?:-(?:(chr[0-9A-Z]+):)?([0-9,]+))?)?$/);if(t){const i=t[1];if(t.slice(2).every(a=>a===void 0)){const a=this.getChromosome(i);return a?[a.continuousStart,a.continuousEnd]:void 0}const s=t[3]||i,o=parseInt(t[2].replace(/,/g,"")),r=t[4]!==void 0?parseInt(t[4].replace(/,/g,"")):o;return[this.toContinuous(i,o-1),this.toContinuous(s,r)]}}}function Gce(n){return JQ(n).map(([e,t])=>({name:e,size:parseInt(t)}))}function C$(n){return Ms(n)&&"chrom"in n}function Kce(n){return n.every(C$)}function M4(n){return Ms(n)&&("name"in n||GA(n)||S$(n))}function GA(n){return M4(n)&&"url"in n}function S$(n){return M4(n)&&"contigs"in n}class K1 extends Array{constructor(){super(),this.type=void 0}extend(e){return this}extendAll(e){if(e instanceof K1&&e.type!=this.type)throw new Error(`Cannot combine different types of domains: ${this.type} and ${e.type}`);for(const t of e)this.extend(t);return this}extendAllWithAccessor(e,t){for(const i of e)this.extend(t(i));return this}}class f2 extends K1{constructor(){super(),this.type="quantitative"}extend(e){return e==null||Number.isNaN(e)?this:(e=+e,this.length?e<this[0]?this[0]=e:e>this[1]&&(this[1]=e):(this.push(e),this.push(e)),this)}}class x$ extends K1{constructor(){super(),this.type="ordinal",this.uniqueValues=new Set}extend(e){return e==null||Number.isNaN(e)?this:(this.uniqueValues.has(e)||(this.uniqueValues.add(e),this.push(e)),this)}}class L$ extends x${constructor(){super(),this.type="nominal"}}class Yce extends K1{constructor(e){super();let t=0;for(let i=1;i<e.length;i++)t+=Math.sign(e[i]-e[i-1]);if(Math.abs(t)!=e.length-1)throw new Error("Piecewise domain must be strictly increasing or decreasing: "+JSON.stringify(e));e.forEach(i=>this.push(i))}extend(e){if(this.includes(e))return this;throw new Error("Piecewise domains are immutable and cannot be unioned!")}}const TF={quantitative:f2,index:f2,locus:f2,nominal:L$,ordinal:x$};function D$(n,e){if(n=="quantitative"&&Zce(e)){const t=new Yce(e);return t.type=n,t}else if(TF[n]){const t=new TF[n];return t.type=n,e&&t.extendAll(e),t}throw new Error("Unknown type: "+n)}function Zce(n){return n&&n.length>0&&n.length!=2&&n.every(e=>typeof e=="number")}function Xce(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}function Qce(n,e,t){return n*Math.pow(e/n,t)}ei("index",R4,["continuous"]);ei("locus",fce,["continuous"]);ei("null",T4,[]);const NF="quantitative",k$="ordinal",E$="nominal",A$="locus",Jce="index";var Tl,Op,Io,qv,Gv,KA,Kv,YA,Vr,wl,Yv,ZA,aL,I$,lL,T$,Zv,XA,Xv,QA,Fp,_C,Qv,JA,Nl,Ku,Jv,eI,cL,N$;class ede{constructor(e){ve(this,Gv);ve(this,Kv);ve(this,Vr);ve(this,Yv);ve(this,aL);ve(this,lL);ve(this,Zv);ve(this,Xv);ve(this,Fp);ve(this,Qv);ve(this,Nl);ve(this,Jv);ve(this,cL);ve(this,Tl,void 0);ve(this,Op,{domain:new Set,range:new Set});ve(this,Io,void 0);ve(this,qv,new Set);this.channel=e,this.members=[],this.type=null,this.name=void 0}addEventListener(e,t){J(this,Op)[e].add(t)}removeEventListener(e,t){J(this,Op)[e].delete(t)}addMember(e){var r;const{channel:t,channelDef:i}=e,s=i.type,o=(r=i==null?void 0:i.scale)==null?void 0:r.name;if(o){if(this.name!==void 0&&o!=this.name)throw new Error(`Shared scales have conflicting names: "${o}" vs. "${this.name}"!`);this.name=o}if(!this.type)this.type=s;else if(s!==this.type&&!YH(t))throw new Error(`Can not use shared scale for different data types: ${this.type} vs. ${s}. Use "resolve: independent" for channel ${this.channel}`);this.members.push(e)}getDataDomain(){return this.members.map(e=>{var t;return(t=e.dataDomainSource)==null?void 0:t.call(e,e.channel,this.type)}).filter(e=>!!e).reduce((e,t)=>e.extendAll(t))}reconfigure(){const e=J(this,Io);if(!e||e.type=="null")return;const t=De(this,aL,I$).call(this),i=e.domain(),s=De(this,Zv,XA).call(this,!0);if(v$({...s,range:void 0},e),e.props=s,De(this,Xv,QA).call(this),os(e.type)&&gt(this,Tl,De(this,Jv,eI).call(this)),!t){De(this,Vr,wl).call(this,"domain");return}const o=e.domain();gA(o,i)||(this.isZoomable()?e.domain(i):De(this,Nl,Ku).call(this)?(e.domain(i),this.zoomTo(o,500)):De(this,Vr,wl).call(this,"domain"))}get scale(){if(J(this,Io))return J(this,Io);const e=De(this,Zv,XA).call(this),t=kce({...e,range:void 0});t.props=e,"unknown"in t&&t.unknown(null),gt(this,Io,t),De(this,Xv,QA).call(this),gce(t)&&t.genome(this.getGenome()),os(t.type)&&gt(this,Tl,De(this,Jv,eI).call(this));const i=t.range;if(i){const s=()=>De(this,Vr,wl).call(this,"range");t.range=function(o){if(arguments.length)i(o),s();else return i()},s()}return t}getDomain(){return this.scale.domain()}getComplexDomain(){var e;return((e=this.getGenome())==null?void 0:e.toChromosomalInterval(this.getDomain()))??this.getDomain()}isZoomed(){return De(this,Nl,Ku).call(this)&&gA(De(this,Fp,_C).call(this),this.getDomain())}isZoomable(){return De(this,Nl,Ku).call(this)&&!!this.scale.props.zoom}zoom(e,t,i){if(!De(this,Nl,Ku).call(this))return!1;const s=this.scale,o=s.domain();let r=[...o],a=s.invert(t);switch(s.props.reverse&&(i=-i),"align"in s&&(a+=s.align()),s.type){case"linear":case"index":case"locus":r=TQ(r,i||0),r=sV(r,a,e);break;case"log":r=NQ(r,i||0),r=oV(r,a,e);break;case"pow":case"sqrt":{const l=s;r=RQ(r,i||0,l.exponent()),r=cA(r,a,e,l.exponent());break}default:throw new Error("Zooming is not implemented for: "+s.type)}return J(this,Tl)&&(r=PQ(r,J(this,Tl)[0],J(this,Tl)[1])),[0,1].some(l=>r[l]!=o[l])?(s.domain(r),De(this,Vr,wl).call(this,"domain"),!0):!1}async zoomTo(e,t=!1){if(L1(t)&&(t=t?700:0),!De(this,Nl,Ku).call(this))throw new Error("Not a zoomable scale!");const i=this.fromComplexInterval(e),s=J(this,Kv,YA).animator,o=this.scale,r=o.domain();if(t>0&&r.length==2){const a=r[1]-r[0],l=i[1]-i[0],c=r[0]+a/2,d=i[0]+l/2,u=r[0]==i[0],h=r[1]==i[1];await s.transition({duration:t,easingFunction:Xce,onUpdate:f=>{const g=Qce(a,l,f),p=a==l?f:(a-g)/(a-l),_=p*d+(1-p)*c,v=[u?r[0]:_-g/2,h?r[1]:_+g/2];o.domain(v),De(this,Vr,wl).call(this,"domain")}}),o.domain(i),De(this,Vr,wl).call(this,"domain")}else o.domain(i),s==null||s.requestRender(),De(this,Vr,wl).call(this,"domain")}resetZoom(){if(!De(this,Nl,Ku).call(this))throw new Error("Not a zoomable scale!");const e=this.getDomain(),t=De(this,Fp,_C).call(this);return[0,1].some(i=>t[i]!=e[i])?(J(this,Io).domain(t),De(this,Vr,wl).call(this,"domain"),!0):!1}getZoomLevel(){return this.isZoomable()?aS(J(this,Tl))/aS(this.scale.domain()):1}getGenome(){var t;if(this.type!=="locus")return;const e=(t=J(this,Kv,YA).genomeStore)==null?void 0:t.getGenome();if(!e)throw new Error("No genome has been defined!");return e}invertToComplex(e){const t=this.scale;if("invert"in t){const i=t.invert(e);return this.toComplex(i)}else throw new Error("The scale does not support inverting!")}toComplex(e){const t=this.getGenome();return t?t.toChromosomal(e):e}fromComplex(e){return C$(e)?this.getGenome().toContinuous(e.chrom,e.pos):e}fromComplexInterval(e){return this.type==="locus"&&Kce(e)?this.getGenome().toContinuousInterval(e):e}}Tl=new WeakMap,Op=new WeakMap,Io=new WeakMap,qv=new WeakMap,Gv=new WeakSet,KA=function(){return this.members[0].view},Kv=new WeakSet,YA=function(){return J(this,Gv,KA).context},Vr=new WeakSet,wl=function(e){for(const t of J(this,Op)[e].values())t({type:e,scaleResolution:this})},Yv=new WeakSet,ZA=function(){return!!De(this,Qv,JA).call(this)},aL=new WeakSet,I$=function(){const e=J(this,Io);if(!e)return!1;const t=e.domain();return os(e.type)?t.length>2||t.length==2&&(t[0]!==0||t[1]!==0):t.length>0},lL=new WeakSet,T$=function(){const e=this.members.map(t=>t.channelDef.scale).filter(t=>t!==void 0);return xS(e,"scale",["domain"])},Zv=new WeakSet,XA=function(e=!1){const t=De(this,lL,T$).call(this);if(t===null||t.type=="null")return{type:"null"};const i={...De(this,cL,N$).call(this,this.type),...t};i.type||(i.type=tde(this.channel,this.type));const s=De(this,Fp,_C).call(this,e);return s&&s.length>0?i.domain=s:qd(i.type)&&(i.domain=new L$),!i.domain&&i.domainMid!==void 0&&(i.domain=[i.domainMin??0,i.domainMax??1]),this.channel=="y"&&qd(i.type)&&i.reverse==null&&(i.reverse=!0),i.range&&i.scheme&&delete i.scheme,!("zoom"in i)&&["index","locus"].includes(i.type)&&(i.zoom=!0),ide(i,this.channel),i},Xv=new WeakSet,QA=function(){const e=J(this,Io).props,t=e.range;if(J(this,qv).forEach(s=>s.invalidate()),!t||!Rs(t))return;const i=(s,o)=>o?s.slice().reverse():s;if(t.some(js)){let s;const o=()=>{J(this,Io).range(i(s.map(r=>r()),e.reverse))};s=t.map(r=>{if(js(r)){const a=J(this,Gv,KA).paramMediator.createExpression(r.expr);return a.addListener(o),J(this,qv).add(a),()=>a(null)}else return()=>r}),o()}else J(this,Io).range(i(t,e.reverse))},Fp=new WeakSet,_C=function(e=!1){return De(this,Qv,JA).call(this)??(this.type==A$?this.getGenome().getExtent():e?this.getDataDomain():[])},Qv=new WeakSet,JA=function(){const e=this.members.map(t=>t.channelDef).filter(t=>{var i;return(i=t.scale)==null?void 0:i.domain}).map(t=>D$(t.type,this.fromComplexInterval(t.scale.domain)));if(e.length>0)return e.reduce((t,i)=>t.extendAll(i))},Nl=new WeakSet,Ku=function(){const e=this.scale.type;return os(e)},Jv=new WeakSet,eI=function(){const e=this.scale.props,t=e.zoom;if(nde(t)&&Rs(t.extent))return this.fromComplexInterval(t.extent);if(t)return e.type=="locus"?this.getGenome().getExtent():J(this,Io).domain()},cL=new WeakSet,N$=function(e){const t=this.channel,i={};return De(this,Yv,ZA).call(this)&&(i.zero=!1),Db(t)?i.nice=!De(this,Yv,ZA).call(this):Kd(t)?i.scheme=e==E$?"tableau10":e==k$?"blues":"viridis":rD(t)?i.range=t=="shape"?["circle","square","triangle-up","cross","diamond"]:[]:t=="size"?i.range=[0,400]:t=="angle"&&(i.range=[0,360]),i};function tde(n,e){if(e==Jce||e==A$){if(qH(n))return e;throw new Error(`${n} does not support ${e} data type. Only positional channels do.`)}const t={x:["band","band","linear"],y:["band","band","linear"],size:[void 0,"point","linear"],opacity:[void 0,"point","linear"],fillOpacity:[void 0,"point","linear"],strokeOpacity:[void 0,"point","linear"],color:["ordinal","ordinal","linear"],fill:["ordinal","ordinal","linear"],stroke:["ordinal","ordinal","linear"],strokeWidth:[void 0,void 0,"linear"],shape:["ordinal","ordinal",void 0],dx:[void 0,void 0,"null"],dy:[void 0,void 0,"null"],angle:[void 0,void 0,"linear"]},s=["sample"].includes(n)?"null":t[n]?t[n][[E$,k$,NF].indexOf(e)]:e==NF?"linear":"ordinal";if(s===void 0)throw new Error(`Channel "${n}" is not compatible with "${e}" data type. Use of a proper scale may be needed.`);return s}function ide(n,e){Db(e)&&n.type!=="ordinal"&&(n.range=[0,1]),e=="opacity"&&os(n.type)&&(n.clamp=!0)}function nde(n){return Ms(n)}function tI(n){const e=new Set;function t(i){for(const s of Object.values(i.resolutions.scale))e.add(s)}for(const i of Ks(n)){i.visit(t);for(const s of i.getDataAncestors()){if(!s.options.contributesToScaleDomain)break;t(s)}}e.forEach(i=>i.reconfigure())}function g2(...n){for(const e of n)if(e!==void 0)return e}class sde{constructor(e){this.channel=e,this.members=[]}get scaleResolution(){var e;return(e=E1(this.members))==null?void 0:e.view.getScaleResolution(this.channel)}addMember(e){const{view:t}=e,i=t.getScaleResolution(this.channel);if(!i)throw new Error("Cannot find a scale resolution!");if(this.scaleResolution&&i!==this.scaleResolution)throw new Error(`Shared axes must have a shared scale! Channel: ${this.channel}, existing views: [${this.members.map(s=>s.view.getPathString()).join(", ")}], new view: ${t.getPathString()}.`);this.members.push(e)}getAxisProps(){return aD(this,"axisProps",()=>{const e=this.members.map(t=>{const i=t.view.mark.encoding[t.channel];return"axis"in i&&i.axis});return e.length>0&&e.some(t=>t===null)?null:xS(e.filter(t=>t!==void 0),"axis",["title"])})}getTitle(){const e=o=>{var a;const r=Yae(o.view,o.channel);if(!_r(r))return{member:o,explicitTitle:g2("axis"in r?(a=r.axis)==null?void 0:a.title:void 0,r.title),implicitTitle:g2(vu(r)?r.field:void 0,H1(r)?r.expr:void 0)}},t=this.members.map(e),i=t.filter(o=>{var r;if(YH(o.member.channel)&&!o.explicitTitle){const a=df(o.member.channel);return((r=t.find(l=>l.member.view==o.member.view&&l.member.channel==a))==null?void 0:r.explicitTitle)===void 0}return!0}),s=new Set(i.map(o=>g2(o.explicitTitle,o.implicitTitle)).filter(ci));return s.size?[...s].join(", "):null}}function RF(n,e,{spacing:t,devicePixelRatio:i,offset:s,reverse:o}={}){t=t||0,s=s||0;let r=0,a=0;for(const g of n)r+=Qy(g.px)+(p2(g)?0:t),a+=Qy(g.grow);r-=t;const l=Math.max(0,e-r),c=i!==void 0?g=>Math.round(g*i)/i:g=>g,d=[],u=[],h=g=>{const p=d.length;if(!p)return;const _=(g?t:0)*(o?-1:1);f-=_;for(let v=0;v<p;v++)u.push({location:f+(v+1)/(p+1)*_,size:0});f+=_,d.length=0};let f=o?Math.max(e,r):0+s;if(n.length==1&&p2(n[0]))return[{location:f,size:0}];for(let g=0;g<n.length;g++){const p=n[g];if(p2(p))d.push(p);else{h(u.length>0);const _=Qy(p.px)+(a?Qy(p.grow)/a*l:0);o&&(f-=_),u.push({location:c(f),size:c(_)}),o?f-=t:f+=_+t}}return f+=o?t:-t,h(!1),u}function ode(n){let e=0,t=0;for(const i of n)e=Math.max(e,i.px??0),t=Math.max(t,i.grow??0);return{px:e,grow:t}}var e1,iI;const g5=class g5{constructor(e,t){ve(this,e1);this.width=e,this.height=t}addPadding(e){return De(this,e1,iI).call(this,e.width,e.height)}subtractPadding(e){return De(this,e1,iI).call(this,-e.width,-e.height)}isGrowing(){return!!(this.width.grow||this.height.grow)}};e1=new WeakSet,iI=function(e,t){return new g5({px:(this.width.px??0)+e,grow:this.width.grow},{px:(this.height.px??0)+t,grow:this.height.grow})};let Yd=g5;const L_=Object.freeze({px:0,grow:0}),MF=new Yd(L_,L_);function p2(n){return!n.px&&!n.grow}function Qy(n){return n||0}function rde(n){return n&&(Js(n.px)||Js(n.grow))}function R$(n){if(P$(n))throw new Error("parseSizeDef does not accept step-based sizes.");if(rde(n))return n;if(Js(n))return{px:n,grow:0};if(n==="container")return{px:0,grow:1};if(!n)return{px:0,grow:1};throw new Error(`Invalid sizeDef: ${n}`)}class ws{constructor(e,t,i,s){this.top=e||0,this.right=t||0,this.bottom=i||0,this.left=s||0}get width(){return this.left+this.right}get height(){return this.top+this.bottom}expand(e){return e<=0?this:new ws(this.top+e,this.right+e,this.bottom+e,this.left+e)}add(e){return new ws(this.top+e.top,this.right+e.right,this.bottom+e.bottom,this.left+e.left)}subtract(e){return new ws(this.top-e.top,this.right-e.right,this.bottom-e.bottom,this.left-e.left)}union(e){return new ws(Math.max(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom),Math.max(this.left,e.left))}getHorizontal(){return new ws(0,this.right,0,this.left)}getVertical(){return new ws(this.top,0,this.bottom,0)}get horizontalTotal(){return this.left+this.right}get verticalTotal(){return this.top+this.bottom}static createFromConfig(e){return typeof e=="number"?this.createUniformPadding(e):e?this.createFromRecord(e):nI}static createFromRecord(e){return new ws(e.top,e.right,e.bottom,e.left)}static zero(){return nI}static createUniformPadding(e){return new ws(e,e,e,e)}}const nI=ws.createUniformPadding(0);Object.freeze(nI);function Y1(n,e){return!e||/^(data:|([A-Za-z]+:)?\/\/)/.test(n)||n.startsWith("/")?n:(e.endsWith("/")||(e+="/"),e+n)}function ade(n){if(!n)return n;if(/[?#]/.test(n))throw new Error(`Invalid base URL: ${n} - cannot contain query or hash.`);return n.endsWith("/")?n:n+"/"}const lde="VISIT_SKIP",D_="VISIT_STOP",PF=n=>n;var Bp,t1,i1,n1,s1,Ih,Z0,o1,sI,mW;let M$=(mW=class{constructor(e,t,i,s,o,r={}){ve(this,Ih);ve(this,o1);ve(this,Bp,{});ve(this,t1,{});ve(this,i1,{});ve(this,n1,void 0);ve(this,s1,void 0);Ui(this,"opacityFunction",PF);Ui(this,"facetCoords",new uc([],JSON.stringify));var a;if(!e)throw new Error("View spec must be defined!");if(this.context=t,this.layoutParent=i,this.dataParent=s,this.name=e.name||o,this.spec=e,this.resolutions={scale:{},axis:{}},l$(this),this.options={blockEncodingInheritance:!1,contributesToScaleDomain:!0,...r},this.needsAxes={x:!1,y:!1},this.paramMediator=new Hae(()=>{var l;return(l=this.dataParent)==null?void 0:l.paramMediator}),e.params)for(const l of e.params)this.paramMediator.registerParam(l);if(!((a=this.layoutParent)!=null&&a.options.layeredChildren)){const l=c=>this.paramMediator.findMediatorForParam(c)?void 0:this.paramMediator.allocateSetter(c,0);gt(this,s1,l("height")),gt(this,n1,l("width"))}}get coords(){return this.facetCoords.values().next().value}getPadding(){return this._cache("size/padding",()=>ws.createFromConfig(this.spec.padding))}getOverhang(){return ws.zero()}isScrollable(){return this.spec.viewportWidth!=null||this.spec.viewportHeight!=null}getSize(){return this._cache("size/size",()=>this.isConfiguredVisible()?new Yd(De(this,Ih,Z0).call(this,"width"),De(this,Ih,Z0).call(this,"height")):MF)}getViewportSize(){if(!this.isScrollable())return this.getSize();if(!this.isConfiguredVisible())return MF;const e=this.getSize();return new Yd(De(this,Ih,Z0).call(this,"viewportWidth")??e.width,De(this,Ih,Z0).call(this,"viewportHeight")??e.height)}isConfiguredVisible(){return this.context.isViewConfiguredVisible(this)}isVisibleInSpec(){return this.spec.visible??!0}isVisible(){return this.getLayoutAncestors().every(e=>e.isConfiguredVisible())}getEffectiveOpacity(){var e;return this.opacityFunction(((e=this.layoutParent)==null?void 0:e.getEffectiveOpacity())??1)}getPathString(){return this.getLayoutAncestors().map(e=>e.name).reverse().join("/")}getLayoutAncestors(){return De(this,o1,sI).call(this,"layoutParent")}getDataAncestors(){return De(this,o1,sI).call(this,"dataParent")}handleBroadcast(e){for(const t of J(this,Bp)[e.type]||[])t(e)}_addBroadcastHandler(e,t){let i=J(this,Bp)[e];i||(i=[],J(this,Bp)[e]=i),i.push(t)}handleInteractionEvent(e,t,i){const s=i?J(this,t1):J(this,i1);for(const o of s[t.type]||[])o(e,t)}addInteractionEventListener(e,t,i){const s=i?J(this,t1):J(this,i1);let o=s[e];o||(o=[],s[e]=o),o.push(t)}visit(e){try{const t=e(this);if(e.postOrder&&e.postOrder(this),t!==D_)return t}catch(t){throw t.view=this,t}}getDescendants(){const e=[];return this.visit(t=>{e.push(t)}),e}configureViewOpacity(){(!this.opacityFunction||this.opacityFunction===PF)&&(this.opacityFunction=dde(this))}onBeforeRender(){}render(e,t,i={}){var s,o;i.firstFacet&&this.facetCoords.clear(),this.facetCoords.set(i.facetId,i.clipRect?t.intersect(i.clipRect):t),(s=J(this,n1))==null||s.call(this,t.width),(o=J(this,s1))==null||o.call(this,t.height)}getEncoding(){const e=this.dataParent&&!this.options.blockEncodingInheritance?this.dataParent.getEncoding():{},t=this.spec.encoding||{},i={...e,...t};for(const[s,o]of Object.entries(i))o===null&&delete i[s];return i}getFacetAccessor(e){if(this.layoutParent)return this.layoutParent.getFacetAccessor(this)}getFacetFields(e){var i;const t=this.getEncoding().sample;return vu(t)?[t.field]:(i=this.layoutParent)==null?void 0:i.getFacetFields(this)}getSampleFacetTexture(){}getScaleResolution(e){const t=df(e);return this.getDataAncestors().map(i=>i.resolutions.scale[t]).find(i=>i)}getAxisResolution(e){const t=df(e);return this.getDataAncestors().map(i=>i.resolutions.axis[t]).find(i=>i)}getConfiguredResolution(e,t){var i,s;return(s=(i=this.spec.resolve)==null?void 0:i[t])==null?void 0:s[e]}getConfiguredOrDefaultResolution(e,t){return this.getConfiguredResolution(e,t)??this.getConfiguredResolution("default",t)??this.getDefaultResolution(e,t)}getDefaultResolution(e,t){return"independent"}getBaseUrl(){return Ab(()=>{var e;return(e=this.dataParent)==null?void 0:e.getBaseUrl()},ade(this.spec.baseUrl))}isPickingSupported(){return!0}getTitleText(){const e=this.spec.title;if(e)return ci(e)?e:js(e.text)?this.paramMediator.evaluateAndGet(e.text.expr):e.text}_cache(e,t){return aD(this,e,t)}_invalidateCacheByPrefix(e,t="self"){switch(t){case"self":mC(this,e);break;case"ancestors":for(const i of this.getLayoutAncestors())mC(i,e);break;case"progeny":this.visit(i=>mC(i,e));break}}invalidateSizeCache(){this._invalidateCacheByPrefix("size/","ancestors")}propagateInteractionEvent(e){}},Bp=new WeakMap,t1=new WeakMap,i1=new WeakMap,n1=new WeakMap,s1=new WeakMap,Ih=new WeakSet,Z0=function(e){var s;let t=this.spec[e];const i=e=="viewportWidth"||e=="viewportHeight";if(P$(t)){if(i)throw new zh(`Cannot use step-based size with "${e}"!`,this);const o=t.step,r=(s=this.getScaleResolution(e=="width"?"x":"y"))==null?void 0:s.scale;if(r){let a=0;if(qd(r.type))a=r.domain().length;else if(["locus","index"].includes(r.type)){const c=r.domain();a=E1(c)-c[0]}else throw new zh(`Cannot use step-based size with "${r.type}" scale!`,this);const l=r;return a=C4(a,l.paddingInner(),l.paddingOuter()),{px:a*o,grow:0}}else throw new zh("Cannot use 'step' size with missing scale!",this)}else return(t&&R$(t))??(i?void 0:{px:0,grow:1})},o1=new WeakSet,sI=function(e){const t=[];let i=this;do t.push(i),i=i[e];while(i);return t},mW);function cde(n){return"unitsPerPixel"in n}function dde(n){const e="opacity"in n.spec?n.spec.opacity:void 0;if(e!==void 0){if(Js(e))return t=>t*e;if(cde(e)){const t=o=>{var a;const r=(a=n.getScaleResolution(o))==null?void 0:a.scale;if(["linear","index","locus"].includes(r==null?void 0:r.type))return r},i=e.channel?t(e.channel):t("x")??t("y");if(!i)throw new zh("Cannot find a resolved quantitative scale for dynamic opacity!",n);const s=g4().domain(e.unitsPerPixel).range(e.values).clamp(!0);return o=>{const a=aS(i.domain())/1e3;return s(a)*o}}else if(js(e)){const t=n.paramMediator.createExpression(e.expr);return t.addListener(()=>n.context.animator.requestRender()),i=>t(null)*i}}return t=>t}const P$=n=>!!(n!=null&&n.step),ude={point:Yle,rect:$le,rule:Jle,link:rce,text:hce};var r1,dL,O$;class Oo extends M${constructor(t,i,s,o,r,a){super(t,i,s,o,r,a);ve(this,dL);ve(this,r1,void 0);this.spec=t;const l=ude[this.getMarkType()];if(l)this.mark=new l(this);else throw new Error(`No such mark: ${this.getMarkType()}`);this.resolve(),gt(this,r1,this.paramMediator.allocateSetter("zoomLevel",1)),["x","y"].forEach(c=>{var d;return(d=this.getScaleResolution(c))==null?void 0:d.addEventListener("domain",()=>J(this,r1).call(this,Math.sqrt(this.getZoomLevel())))}),this.needsAxes={x:!0,y:!0},De(this,dL,O$).call(this)}render(t,i,s={}){super.render(t,i,s),this.isConfiguredVisible()&&(t.pushView(this,i),t.renderMark(this.mark,s),t.popView(this))}getMarkType(){return typeof this.spec.mark=="object"?this.spec.mark.type:this.spec.mark}resolve(t){t||(this.resolve("scale"),this.resolve("axis"));const i=this.mark.encoding;for(const[s,o]of Object.entries(i)){if(!Wo(o))continue;const r=df(o.resolutionChannel??s);if(!kb(r)||t=="axis"&&!Db(r))continue;let a=this;for(;(a.getConfiguredOrDefaultResolution(r,t)=="forced"||a.dataParent&&["shared","excluded","forced"].includes(a.dataParent.getConfiguredOrDefaultResolution(r,t)))&&a.getConfiguredOrDefaultResolution(r,t)!="excluded";)a=a.dataParent;if(t=="axis"&&Db(s)&&qH(r))a.resolutions[t][r]||(a.resolutions[t][r]=new sde(r)),a.resolutions[t][r].addMember({view:this,channel:s,channelDef:o});else if(t=="scale"&&kb(s)){if(!a.resolutions[t][r]){const c=new ede(r);a.resolutions[t][r]=c,c.addEventListener("range",d=>{var u;(u=this.context.glHelper)==null||u.createRangeTexture(d.scaleResolution,!0)})}const l=this.getLayoutAncestors().some(c=>!c.options.contributesToScaleDomain)||Wo(o)&&o.contributesToScaleDomain===!1?void 0:this.extractDataDomain.bind(this);a.resolutions[t][r].addMember({view:this,channel:s,channelDef:o,dataDomainSource:l})}}}getDataAccessor(t){var i;return(i=this.mark.encoders[t])==null?void 0:i.dataAccessor}getFacetAccessor(t){const i=this.getDataAccessor("sample");return i||super.getFacetAccessor(this)}getCollector(){return this.context.dataFlow.findCollectorByKey(this)}extractDataDomain(t,i){var o;let s=D$(i);return(((o=this.mark.encoders[t])==null?void 0:o.accessors)??[]).filter(r=>r.scaleChannel).forEach(r=>{if(r.constant)s.extend(r({}));else{const a=this.getCollector();a!=null&&a.completed&&a.visitData(l=>s.extend(r(l)))}}),s}getZoomLevel(){const t=i=>{var s;return((s=this.getScaleResolution(i))==null?void 0:s.getZoomLevel())??1};return Km.map(t).reduce((i,s)=>i*s,1)}propagateInteractionEvent(t){this.handleInteractionEvent(void 0,t,!0),t.target=this,!t.stopped&&this.handleInteractionEvent(void 0,t,!1)}getDefaultResolution(t,i){return t=="x"?"shared":"independent"}}r1=new WeakMap,dL=new WeakSet,O$=function(){for(const[t,i]of this.paramMediator.paramConfigs){if(!("select"in i))continue;const s=i.select;if((ci(s)?s:s.type)==="point"){let a=-1;const l=this.paramMediator.getSetter(t),c=()=>{var h;const u=this.context.getCurrentHover();return((h=u==null?void 0:u.mark)==null?void 0:h.unitView)===this?u.datum:null},d=!ci(s)&&"on"in s?s.on:"click";this.addInteractionEventListener(["mouseover","pointerover"].includes(d)?"mousemove":"click",(u,h)=>{const f=c(),g=f?f[Gd]:-1;if(g!=a){a=g;const p=zH(c());l(p)}})}}};function*P4(n,e=[]){for(const[t,i]of n.entries())if(i instanceof Map)for(const s of P4(i,[...e,t]))yield s;else yield[[...e,t],i]}const F$=2147483647,hde=B$([F$]);function B$(n){let e=0;for(let t=0,i=n.length;t<i;t++)e=Math.max(e,n[t]);return Math.floor(Math.log2(e)/4)+1}function fde(n){const e=B$(n);let t=Array.from({length:n.length},(o,r)=>r),i=new Array(n.length);const s=new Array(16);for(let o=0;o<e;o++){s.fill(0);const r=o*4,a=Math.pow(16,o),l=c=>{const d=n[t[c]];return o>=hde?d>F$?Math.floor(d/a)%16:0:d>>r&15};for(let c=0;c<n.length;c++)s[l(c)]++;for(let c=1;c<16;c++)s[c]+=s[c-1];for(let c=n.length-1;c>=0;c--)i[--s[l(c)]]=t[c];[t,i]=[i,t]}return t}var Rl,a1,Th,Nh,l1,oI,c1,rI,d1,aI,uL,V$;class W$ extends pn{constructor(t){super();ve(this,l1);ve(this,c1);ve(this,d1);ve(this,uL);ve(this,Rl,[]);ve(this,a1,_i(Gd));ve(this,Th,[]);ve(this,Nh,void 0);this.params=t??{type:"collect"},this.observers=[],this.facetBatches=new uc([],JSON.stringify),De(this,l1,oI).call(this)}get behavior(){return I4}reset(){super.reset(),De(this,l1,oI).call(this)}handle(t){J(this,Rl).push(t)}beginBatch(t){Oae(t)&&(gt(this,Rl,[]),this.facetBatches.set(Ks(t.facetId),J(this,Rl)))}complete(){var o,r;gt(this,Rl,[]);const t=(o=this.params)==null?void 0:o.sort,i=t?rV(t.field,t.order):void 0,s=a=>{i&&a.sort(i)};if((r=this.params.groupby)!=null&&r.length){if(this.facetBatches.size>1)throw new Error("TODO: Support faceted data!");const a=this.facetBatches.get(void 0),l=this.params.groupby.map(d=>_i(d)),c=l.length>1?DL(a,...l):gde(a,l[0]);this.facetBatches.clear();for(const[d,u]of P4(c))this.facetBatches.set(d,u)}for(const a of this.facetBatches.values())s(a);De(this,uL,V$).call(this),De(this,c1,rI).call(this),super.complete();for(const a of this.observers)a(this)}repropagate(){for(const t of this.children)t.reset();De(this,c1,rI).call(this);for(const t of this.children)t.complete()}getData(){switch(De(this,d1,aI).call(this),this.facetBatches.size){case 0:return[];case 1:return[...this.facetBatches.values()][0];default:{const t=this.facetBatches;return{[Symbol.iterator]:function*(){for(const s of t.values())yield*s}}}}}visitData(t){De(this,d1,aI).call(this);for(const i of this.facetBatches.values())for(let s=0;s<i.length;s++)t(i[s])}getItemCount(){let t=0;for(const i of this.facetBatches.values())t+=i.length;return t}findDatumByUniqueId(t){if(!J(this,Th).length)return;const i=em(l=>l.start).right,s=J(this,a1),o=em(l=>s(r(l))).left,r=l=>{const c=i(J(this,Nh),l),d=J(this,Nh)[c-1];return!d||l>=d.stop?void 0:this.facetBatches.get(d.facetId)[l-d.start]},a=o(J(this,Th),t);if(a>=0){const l=r(J(this,Th)[a]);if(l&&s(l)===t)return l}}}Rl=new WeakMap,a1=new WeakMap,Th=new WeakMap,Nh=new WeakMap,l1=new WeakSet,oI=function(){gt(this,Rl,[]),this.facetBatches.clear(),this.facetBatches.set(void 0,J(this,Rl))},c1=new WeakSet,rI=function(){if(this.children.length)for(const[t,i]of this.facetBatches.entries()){if(t){const s={type:"facet",facetId:t};for(const o of this.children)o.beginBatch(s)}for(let s=0,o=i.length;s<o;s++)this._propagate(i[s])}},d1=new WeakSet,aI=function(){if(!this.completed)throw new Error("Data propagation is not completed! No data are available.")},uL=new WeakSet,V$=function(){var r;gt(this,Nh,[]);const t=(r=this.facetBatches.values().next().value)==null?void 0:r[0];if(t==null||!(Gd in t))return;let i=0;const s=[],o=J(this,a1);for(const[a,l]of this.facetBatches){J(this,Nh).push({start:i,stop:i+l.length,facetId:a}),i+=l.length;for(let c=0,d=l.length;c<d;c++)s.push(o(l[c]))}gt(this,Th,fde(s))};function gde(n,e){const t=new Map;for(let i=0,s=n.length;i<s;i++){const o=n[i],r=e(o);let a=t.get(r);a||(a=[],t.set(r,a)),a.push(o)}return t}class LS{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let i=this.length++;for(;i>0;){const s=i-1>>1,o=this.values[s];if(t>=o)break;this.ids[i]=this.ids[s],this.values[i]=o,i=s}this.ids[i]=e,this.values[i]=t}pop(){if(this.length===0)return;const e=this.ids[0];if(this.length--,this.length>0){const t=this.ids[0]=this.ids[this.length],i=this.values[0]=this.values[this.length],s=this.length>>1;let o=0;for(;o<s;){let r=(o<<1)+1;const a=r+1;let l=this.ids[r],c=this.values[r];const d=this.values[a];if(a<this.length&&d<c&&(r=a,l=this.ids[a],c=d),c>=i)break;this.ids[o]=l,this.values[o]=c,o=r}this.ids[o]=t,this.values[o]=i}return e}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}class pde extends pn{get behavior(){return ll}constructor(e){super(),this.params=e,this.startAccessor=_i(e.start),this.endAccessor=_i(e.end),this.chromAccessor=e.chrom?_i(e.chrom):t=>{},this.weightAccessor=e.weight?_i(e.weight):t=>1,this.as={coverage:e.as??"coverage",start:e.asStart??e.start,end:e.asEnd??e.end,chrom:e.asChrom??e.chrom},this.createSegment=new Function("start","end","coverage","chrom","return {"+Object.entries(this.as).filter(([t,i])=>i).map(([t,i])=>`${JSON.stringify(i)}: ${t}`).join(", ")+"};"),this.ends=new LS}reset(){super.reset(),this.initialize()}initialize(){const e=this.as.coverage,t=this.as.end,i=this.as.chrom,s=this.startAccessor,o=this.endAccessor,r=this.chromAccessor,a=this.weightAccessor;let l,c,d,u=0,h=NaN;const f=this.ends;f.clear();const g=v=>{this._propagate(v),l=null},p=(v,b,y)=>{if(v==b)return;let w=!1;l&&(l[e]===y?(l[t]=b,w=!0):l[e]!=0&&g(l)),w||(l=this.createSegment(v,b,y,d))},_=()=>{let v=0;for(;(v=f.peekValue())!==void 0;)p(h,v,u),h=v,u-=f.pop();h=NaN,l&&g(l)};this.handle=v=>{const b=s(v);let y=0;for(;(y=f.peekValue())!==void 0&&y<b;)p(h,y,u),h=y,u-=f.pop();if(i){let C=r(v);C!==c&&(_(),d=C,c=d)}isNaN(h)||p(h,b,u),h=b;const w=a(v);u+=w,f.push(w,o(v))},this.complete=()=>{_(),super.complete()},this.beginBatch=v=>{_(),c=null,super.beginBatch(v)}}}function mde(n,e,t=0,i=n.length){const s=new LS,o=i-t;let r;for(r=0;r<e&&r<o;r++)s.push(r,n[t+r]);for(;r<o;r++){const c=n[t+r];c>=s.peekValue()&&(s.push(r,c),s.pop())}const a=[];let l;for(;(l=s.pop())!==void 0;)a.push(t+l);return a.reverse()}class _de{constructor(e,t=-1/0,i=1/0){this.maxSize=e,this.lowerLimit=t,this.upperLimit=i;const s=this.maxSize*2+1;this.lowerLimits=new Float64Array(s),this.upperLimits=new Float64Array(s),this.lowerChildren=new Int32Array(s),this.upperChildren=new Int32Array(s),this.reset()}reset(){this.lowerLimits.fill(0),this.upperLimits.fill(0),this.lowerChildren.fill(0),this.upperChildren.fill(0),this.n=1,this.lowerLimits[0]=this.lowerLimit,this.upperLimits[0]=this.upperLimit}_findSlot(e,t,i=0){if(e>=this.lowerLimits[i]&&t<=this.upperLimits[i]){const s=this.lowerChildren[i];if(s){const o=this._findSlot(e,t,s);return o>=0?o:this._findSlot(e,t,this.upperChildren[i])}else return i}else return-1}reserve(e,t){if(t-e<=0)throw new Error("Cannot reserve an empty or negative-size slot!");if(this.n+1>this.lowerLimits.length)return!1;const i=this._findSlot(e,t);if(i<0)return!1;const s=this.n++,o=this.n++;return this.lowerLimits[s]=this.lowerLimits[i],this.upperLimits[s]=e,this.lowerLimits[o]=t,this.upperLimits[o]=this.upperLimits[i],this.lowerChildren[i]=s,this.upperChildren[i]=o,!0}}class bde extends pn{get behavior(){return I4}constructor(e,t){if(super(),this.params=e,this._data=[],this.channel=e.channel??"x",!["x","y"].includes(this.channel))throw new Error("Invalid channel: "+this.channel);this.posAccessor=_i(this.params.pos),this.posBisector=em(this.posAccessor),this.scoreAccessor=_i(this.params.score),this.widthAccessor=_i(this.params.width),this.laneAccessor=this.params.lane?_i(this.params.lane):s=>0,this.padding=this.params.padding??0,this.reservationMaps=new Map,this.resolution=t.getScaleResolution(this.channel);const i=()=>this._filterAndPropagate();this.schedule=()=>t.context.animator.requestTransition(i),this.resolution.addEventListener("domain",s=>this.schedule()),t._addBroadcastHandler("layoutComputed",()=>this.schedule())}complete(){const e=this.posAccessor;this._data.sort((t,i)=>e(t)-e(i)),this._scores=this._data.map(this.scoreAccessor);for(const t of new Set(this._data.map(this.laneAccessor)))this.reservationMaps.set(t,new _de(200));this.schedule(),super.complete()}_filterAndPropagate(){var r;super.reset();const e=this.resolution.scale,t=(r=this.resolution.members[0].view.coords)==null?void 0:r[this.channel=="x"?"width":"height"];if(!t)return;for(const a of this.reservationMaps.values())a.reset();const i=e.domain(),s=70,o=mde(this._scores,s,this.posBisector.left(this._data,i[0]),this.posBisector.right(this._data,i[1]));for(const a of o){const l=this._data[a],c=e(this.posAccessor(l))*t,d=this.widthAccessor(l)/2+this.padding;this.reservationMaps.get(this.laneAccessor(l)).reserve(c-d,c+d)&&this._propagate(l)}super.complete()}reset(){super.reset(),this._data=[],this.groups=new Map}handle(e){this._data.push(e)}}class vde extends pn{constructor(e,t){super(t),this.params=e,this.predicate=void 0}initialize(){let e="";if(yde(this.params))e=this.params.expr;else if(wde(this.params))e=HH(this.params);else throw new Error("Invalid filter params: "+JSON.stringify(this.params));this.predicate=this.paramMediator.createExpression(e),this.predicate.addListener(()=>this.repropagate())}handle(e){this.predicate(e)&&this._propagate(e)}}function yde(n){return"expr"in n}function wde(n){return"param"in n}class Cde extends pn{get behavior(){return ll}constructor(e){super();const t=e.index;if(e.fields){const i=Ks(e.fields).map(o=>_i(o)),s=Ks(e.as||e.fields);if(i.length!==s.length)throw new Error(`Lengths of "fields" (${i.length}), and "as" (${s.length}) do not match!`);this.handle=o=>{const r=i.map((l,c)=>l(o)??[]),a=r[0].length;for(let l=0;l<a;l++){const c=Object.assign({},o);for(let d=0;d<i.length;d++)c[s[d]]=l<r[d].length?r[d][l]:null;t&&(c[t]=l),this._propagate(c)}}}else this.handle=i=>{for(let s=0;s<i.length;s++){const o=Object.assign({},i[s]);t&&(o[t]=s),this._propagate(o)}}}}const Sde="0".charCodeAt(0);function*xde(n,e=","){const t=e.charCodeAt(0);let i=0;for(let s=0;s<n.length;s++){const o=n.charCodeAt(s);o==t?(yield i,i=0):i=i*10+o-Sde}yield i}class Lde extends pn{get behavior(){return ll}constructor(e){super();const t=_i(e.exons??"exons"),i=_i(e.start??"start"),[s,o]=e.as||["exonStart","exonEnd"];this.handle=r=>{let a=i(r),l=a,c=!0;const d=t(r);for(const u of xde(d)){if(c)l=a+u;else{a=l+u;const h=Object.assign({},r);h[s]=l,h[o]=a,this._propagate(h)}c=!c}}}}class Dde extends pn{get behavior(){return ll}constructor(e){super();const t=Ks(e.field).map(o=>_i(o)),i=Ks(e.separator),s=Ks(e.as||e.field);if(t.length!==i.length||t.length!==s.length)throw new Error(`Lengths of "separator" (${i.length}), "fields" (${t.length}), and "as" (${s.length}) do not match!`);this.handle=o=>{if(t.some(l=>!l(o)))return;const r=t.map((l,c)=>l(o).split(i[c]));kde(r,o);const a=r[0].length;for(let l=0;l<a;l++){const c=Object.assign({},o);for(let d=0;d<t.length;d++)c[s[d]]=r[d][l];this._propagate(c)}}}}function kde(n,e){const t=n.map(i=>i.length);if(!t.every(i=>i==t[0]))throw new Error("Mismatching number of elements in the fields to be split: "+JSON.stringify(e))}class Ede extends pn{get behavior(){return bu}constructor(e,t){super(t),this.params=e,this.as=e.as,this.fn=void 0}initialize(){this.fn=this.paramMediator.createExpression(this.params.expr),this.fn.addListener(()=>this.repropagate())}handle(e){e[this.as]=this.fn(e),this._propagate(e)}}class z$ extends pn{get behavior(){return bu}constructor(e,t){super();const i=e.channel??"x";if(!["x","y"].includes(i))throw new Error("Invalid channel: "+i);const s=t.getScaleResolution(i).getGenome();if(!s)throw new Error("LinearizeGenomicCoordinate transform requires a locus scale!");const o=_i(e.chrom),r=Ks(e.pos).map(g=>_i(g)),a=Ks(e.as);if(r.length!=a.length)throw new Error('The number of "pos" and "as" elements must be equal!');const l=Ks(e.offset);let c;if(l.length==0)c=new Array(r.length).fill(0);else if(l.length==1)c=new Array(r.length).fill(l[0]);else if(l.length==r.length)c=l;else throw new Error(`Invalid "offset" parameter: ${JSON.stringify(e.offset)}!`);const d=new Function("datum","chromOffset","posAccessors",a.map((g,p)=>`datum[${JSON.stringify(g)}] = chromOffset + +posAccessors[${p}](datum) - ${c[p]};`).join(`
`));let u,h=0;const f=g=>{if(g!==u){if(h=s.cumulativeChromPositions.get(g),h===void 0)throw new Error("Unknown chromosome/contig: "+g);u=g}return h};this.handle=g=>{d(g,f(o(g)),r),this._propagate(g)}}}const Ade=["Lato-Regular.png"],Ide=[{id:87,width:53,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:43.491,chnl:15,x:0,y:0,page:0},{id:124,width:17,height:50,xoffset:0,yoffset:-32.193000000000005,xadvance:10.521,chnl:15,x:0,y:42,page:0},{id:40,width:20,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:94,page:0},{id:41,width:19,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:145,page:0},{id:36,width:32,height:49,xoffset:0,yoffset:-34.419000000000004,xadvance:24.360000000000003,chnl:15,x:0,y:196,page:0},{id:125,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:247,page:0},{id:91,width:22,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:297,page:0},{id:93,width:19,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:347,page:0},{id:123,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:397,page:0},{id:106,width:19,height:48,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:0,y:447,page:0},{id:81,width:43,height:47,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:21,y:447,page:0},{id:77,width:45,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:38.997,chnl:15,x:66,y:447,page:0},{id:64,width:43,height:44,xoffset:0,yoffset:-28.539,xadvance:35.133,chnl:15,x:23,y:397,page:0},{id:92,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:68,y:397,page:0},{id:47,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:98,y:397,page:0},{id:109,width:42,height:32,xoffset:0,yoffset:-21.609,xadvance:34.545,chnl:15,x:113,y:447,page:0},{id:119,width:42,height:31,xoffset:0,yoffset:-21.315,xadvance:32.991,chnl:15,x:157,y:447,page:0},{id:42,width:25,height:42,xoffset:0,yoffset:-31.626,xadvance:17.85,chnl:15,x:128,y:397,page:0},{id:37,width:42,height:41,xoffset:0,yoffset:-30.387,xadvance:33.663000000000004,chnl:15,x:155,y:397,page:0},{id:79,width:42,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:199,y:397,page:0},{id:102,width:24,height:41,xoffset:0,yoffset:-30.534000000000002,xadvance:14.721,chnl:15,x:243,y:397,page:0},{id:100,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:269,y:397,page:0},{id:98,width:32,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:302,y:397,page:0},{id:56,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:336,y:397,page:0},{id:38,width:40,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:29.904000000000003,chnl:15,x:370,y:397,page:0},{id:108,width:17,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:9.912,chnl:15,x:412,y:397,page:0},{id:107,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:21.336000000000002,chnl:15,x:431,y:397,page:0},{id:48,width:33,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:464,y:397,page:0},{id:71,width:38,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:30.681,chnl:15,x:21,y:347,page:0},{id:83,width:31,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:22.785,chnl:15,x:61,y:347,page:0},{id:63,width:27,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:18.795,chnl:15,x:94,y:347,page:0},{id:105,width:18,height:41,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:123,y:347,page:0},{id:51,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:143,y:347,page:0},{id:104,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.436,chnl:15,x:177,y:347,page:0},{id:67,width:37,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:28.056,chnl:15,x:210,y:347,page:0},{id:88,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.258000000000003,chnl:15,x:249,y:347,page:0},{id:68,width:40,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:31.941000000000003,chnl:15,x:288,y:347,page:0},{id:70,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:23.751,chnl:15,x:330,y:347,page:0},{id:34,width:23,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:15.561000000000002,chnl:15,x:364,y:347,page:0},{id:72,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:389,y:347,page:0},{id:73,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.760000000000002,chnl:15,x:429,y:347,page:0},{id:74,width:24,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:17.745,chnl:15,x:449,y:347,page:0},{id:75,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.825000000000003,chnl:15,x:24,y:297,page:0},{id:76,width:31,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:21.567,chnl:15,x:475,y:347,page:0},{id:66,width:35,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.153000000000002,chnl:15,x:64,y:297,page:0},{id:78,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:101,y:297,page:0},{id:33,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.298,chnl:15,x:141,y:297,page:0},{id:80,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.221,chnl:15,x:161,y:297,page:0},{id:65,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:197,y:297,page:0},{id:82,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.313000000000002,chnl:15,x:237,y:297,page:0},{id:35,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:275,y:297,page:0},{id:84,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.801000000000002,chnl:15,x:310,y:297,page:0},{id:85,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:30.891000000000002,chnl:15,x:346,y:297,page:0},{id:86,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:385,y:297,page:0},{id:39,width:16,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:8.568000000000001,chnl:15,x:425,y:297,page:0},{id:69,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.255000000000003,chnl:15,x:443,y:297,page:0},{id:89,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.208000000000002,chnl:15,x:23,y:247,page:0},{id:90,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.284000000000002,chnl:15,x:477,y:297,page:0},{id:49,width:31,height:40,xoffset:0,yoffset:-30.156000000000002,xadvance:24.360000000000003,chnl:15,x:61,y:247,page:0},{id:50,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:94,y:247,page:0},{id:57,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:128,y:247,page:0},{id:94,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:162,y:247,page:0},{id:96,width:21,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:16.8,chnl:15,x:196,y:247,page:0},{id:55,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:219,y:247,page:0},{id:54,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:254,y:247,page:0},{id:53,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:289,y:247,page:0},{id:52,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:323,y:247,page:0},{id:103,width:31,height:39,xoffset:0,yoffset:-21.630000000000003,xadvance:21.84,chnl:15,x:358,y:247,page:0},{id:112,width:32,height:39,xoffset:0,yoffset:-21.651,xadvance:23.541,chnl:15,x:391,y:247,page:0},{id:113,width:31,height:39,xoffset:0,yoffset:-21.651,xadvance:23.520000000000003,chnl:15,x:425,y:247,page:0},{id:116,width:25,height:39,xoffset:0,yoffset:-28.182000000000002,xadvance:15.057,chnl:15,x:458,y:247,page:0},{id:121,width:31,height:38,xoffset:0,yoffset:-21.273,xadvance:21.651,chnl:15,x:34,y:196,page:0},{id:59,width:18,height:36,xoffset:0,yoffset:-20.706,xadvance:10.983,chnl:15,x:485,y:247,page:0},{id:43,width:32,height:34,xoffset:0,yoffset:-24.486,xadvance:24.360000000000003,chnl:15,x:67,y:196,page:0},{id:60,width:30,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:101,y:196,page:0},{id:62,width:31,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:133,y:196,page:0},{id:117,width:30,height:32,xoffset:0,yoffset:-21.273,xadvance:23.415000000000003,chnl:15,x:166,y:196,page:0},{id:99,width:29,height:32,xoffset:0,yoffset:-21.609,xadvance:20.055,chnl:15,x:198,y:196,page:0},{id:110,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:23.436,chnl:15,x:229,y:196,page:0},{id:111,width:32,height:32,xoffset:0,yoffset:-21.609,xadvance:23.814,chnl:15,x:262,y:196,page:0},{id:126,width:32,height:26,xoffset:0,yoffset:-16.128,xadvance:24.360000000000003,chnl:15,x:201,y:447,page:0},{id:101,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:22.176000000000002,chnl:15,x:296,y:196,page:0},{id:114,width:25,height:32,xoffset:0,yoffset:-21.651,xadvance:15.288,chnl:15,x:329,y:196,page:0},{id:115,width:27,height:32,xoffset:0,yoffset:-21.609,xadvance:18.186,chnl:15,x:356,y:196,page:0},{id:97,width:28,height:32,xoffset:0,yoffset:-21.651,xadvance:20.874000000000002,chnl:15,x:385,y:196,page:0},{id:118,width:31,height:31,xoffset:0,yoffset:-21.273,xadvance:21.672,chnl:15,x:415,y:196,page:0},{id:61,width:31,height:29,xoffset:0,yoffset:-19.089000000000002,xadvance:24.360000000000003,chnl:15,x:448,y:196,page:0},{id:120,width:30,height:31,xoffset:0,yoffset:-21.273,xadvance:20.916,chnl:15,x:21,y:145,page:0},{id:58,width:18,height:31,xoffset:0,yoffset:-20.706,xadvance:10.5,chnl:15,x:53,y:145,page:0},{id:122,width:28,height:31,xoffset:0,yoffset:-21.273,xadvance:18.984,chnl:15,x:73,y:145,page:0},{id:95,width:28,height:16,xoffset:0,yoffset:0,xadvance:19.278000000000002,chnl:15,x:235,y:447,page:0},{id:45,width:23,height:24,xoffset:0,yoffset:-14.175,xadvance:15.603000000000002,chnl:15,x:481,y:196,page:0},{id:44,width:17,height:21,xoffset:0,yoffset:-4.956,xadvance:9.534,chnl:15,x:103,y:145,page:0},{id:46,width:18,height:15,xoffset:0,yoffset:-4.956,xadvance:9.912,chnl:15,x:0,y:497,page:0},{id:32,width:0,height:0,xoffset:0,yoffset:0,xadvance:10.752,chnl:15,x:20,y:497,page:0}],Tde={face:"Lato Regular",size:42,bold:0,italic:0,charset:[" ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"],unicode:1,stretchH:100,smooth:1,aa:1,padding:[0,0,0,0],spacing:[2,2]},Nde={lineHeight:50.400000000000006,base:41.454,scaleW:512,scaleH:512,pages:1,packed:0,alphaChnl:0,redChnl:0,greenChnl:0,blueChnl:0},Rde=[],H$={pages:Ade,chars:Ide,info:Tde,common:Nde,kernings:Rde};class Mde extends pn{get behavior(){return bu}constructor(e){super();const t=zA(H$),i=_i(e.field),s=e.as,o=e.fontSize;this.handle=r=>{const a=i(r);a!==void 0?r[s]=t.measureWidth(a,o):r[s]=0,this._propagate(r)}}}const Pde=65536;class Ode extends pn{get behavior(){return bu}constructor(e){super(),this.params=e}reset(){super.reset(),this.initialize()}initialize(){const e=this.params,t=e.as||"lane",i=Js(e.spacing)?e.spacing:1,s=_i(e.start),o=_i(e.end);if(!e.preference!=!e.preferredOrder)throw new Error('Must specify both "preference" and "preferredOrder"');if(e.preference){const r=new Float64Array(Pde),a=_i(e.preference),l=e.preferredOrder;let c=1/0;this.handle=d=>{const u=s(d);u<c&&r.fill(-1/0),c=u;const h=l.indexOf(a(d));let f=-1;if(h>=0&&r[h]<u)f=h;else{const g=s(d);for(f=0;f<r.length&&!(r[f]<g);f++);if(f>=r.length)throw new Error("Out of lanes!")}r[f]=o(d)+i,d[t]=f,this._propagate(d)}}else{const r=new LS,a=new LS;let l=-1/0,c=0;this.handle=d=>{const u=s(d);for(;r.length&&(r.peekValue()<=u||u<l);){const f=r.pop();a.push(f,f)}l=u;let h=a.pop();h===void 0&&(h=c++),d[t]=h,this._propagate(d),r.push(h,o(d)+i)}}}}class Fde extends pn{get behavior(){return ll}constructor(e){if(super(),e.as&&e.as.length!=e.fields.length)throw new Error('"fields" and "as" have unequal lengths!');const t=e.fields.map(s=>_i(s)),i=e.as?e.as:t.map(SQ);this.handle=s=>{const o={};for(let r=0;r<t.length;r++)o[i[r]]=t[r](s);this._propagate(o)}}}class Bde extends pn{get behavior(){return bu}constructor(e){super();const t=new RegExp(e.regex),i=typeof e.as=="string"?[e.as]:e.as,s=_i(e.field);this.handle=o=>{const r=s(o);if(ci(r)){const a=r.match(t);if(a){if(a.length-1!=i.length)throw new Error('The number of RegEx groups and the length of "as" do not match!');for(let l=0;l<i.length;l++)o[i[l]]=a[l+1]}else if(e.skipInvalidInput)for(let l=0;l<i.length;l++)o[i[l]]=void 0;else throw new Error(`"${r}" does not match the given regex: ${t.toString()}`)}else if(!e.skipInvalidInput)throw new Error(`Trying to match a non-string field. Encountered type: ${typeof r}, field content: "${r}".`);this._propagate(o)}}}class Wde extends pn{get behavior(){return ll}constructor(e){super();const t=Ks(e.columnRegex).map(h=>new RegExp(h)),i=Ks(e.asValue);if(t.length!=i.length)throw new Error('Lengths of "columnRegex" and "as" are not equal!');const s=e.skipRegex?new RegExp(e.skipRegex):void 0,o=e.asKey||"sample";let r,a,l;const c=h=>{var _;const f=Object.keys(h);for(const v of t)if(!f.some(b=>v.test(b)))throw new Error(`No columns matching the regex ${v.toString()} found in the data!`);const g=new Map;for(const[v,b]of t.entries())for(const y of f){const w=(_=b.exec(y))==null?void 0:_[1];if(w!==void 0){let C=g.get(w);C||(C=[],g.set(w,C)),C[v]=y}}r=[...g.entries()],a=f.filter(v=>!t.some(b=>b.test(v))&&!(s&&s.test(v)));const p=[...a.map(v=>JSON.stringify(v)+": datum["+JSON.stringify(v)+"]"),JSON.stringify(o)+": sampleId",...i.map((v,b)=>JSON.stringify(v)+`: datum[attrs[${b}]]`)];l=new Function("datum","sampleId","attrs",`return {
`+p.join(`,
`)+`
};`)},d=h=>{r||c(h);for(let f=0;f<r.length;f++){const[g,p]=r[f],_=l(h,g,p);this._propagate(_)}},u=h=>{c(h),d(h),this.handle=d};this.handle=u,this.beginBatch=h=>{VH(h)&&(this.handle=u),super.beginBatch(h)}}}class Vde extends pn{get behavior(){return bu}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const e=this.params,t=e.as||["y0","y1"],i=e.sort?rV(e.sort.field,e.sort.order):void 0,s=e.field?_i(e.field):()=>1,o=e.groupby.map(d=>_i(d)),r=gJ(this.buffer,d=>o.map(u=>u(d)).join()).map(d=>d[1]);let a=d=>!0;if(e.baseField){const d=_i(e.baseField);a=u=>d(u)!==null}let l,c;switch(e.offset){case"normalize":l=(d,u)=>d/u,c=(d,u)=>zy(d,u);break;case"center":l=(d,u)=>d-u/2,c=(d,u)=>zy(d,u);break;case"information":{const d=Math.log2(e.cardinality??4);l=(u,h)=>u/h,c=(u,h)=>{const g=zy(u,b=>+!a(b)),p=zy(u,h),_=p-g;let v=0;for(let b=0;b<u.length;b++){const y=u[b];if(a(y)){const w=h(y)/_;v-=w*Math.log2(w)}}return _/(d-(v+0))*(_/p)}}break;default:l=(d,u)=>d,c=(d,u)=>1}for(const d of r){i&&d.sort(i);const u=c(d,s);let h=0;for(const f of d){const g=h+s(f);a(f)&&(f[t[0]]=l(h,u),f[t[1]]=l(g,u),this._propagate(f),h=g)}}super.complete()}}class zde extends pn{get behavior(){return ll}constructor(e){super();const t=_i(e.field??"sequence"),[i,s]=e.as??["pos","sequence"];this.handle=o=>{const r=Object.assign({},o,{[s]:"",[i]:0}),a=t(o);for(let l=0;l<a.length;l++){const c=Object.assign({},r);c[i]=l,c[s]=a.charAt(l),this._propagate(c)}}}}class Hde extends pn{get behavior(){return ll}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const t=this.params.groupby,i=t.map(o=>_i(o)),s=DL(this.buffer,...i);for(const[o,r]of P4(s)){const a={count:r.length};for(let l=0;l<t.length;l++)a[t[l]]=o[l];this._propagate(a)}super.complete()}}const $de={aggregate:Hde,collect:W$,coverage:pde,filterScoredLabels:bde,filter:vde,flatten:Cde,flattenCompressedExons:Lde,flattenDelimited:Dde,flattenSequence:zde,formula:Ede,identifier:FA,linearizeGenomicCoordinate:z$,measureText:Mde,pileup:Ode,project:Fde,regexExtract:Bde,regexFold:Wde,sample:f$,stack:Vde};function Ude(n,e){const t=$de[n.type];if(t)return new t(n,e);throw new Error("Unknown transform: "+n.type)}function $$(n){if(!j$(n)&&!OF(n))return;const e={...n.format};if(e.type??(e.type=OF(n)&&jde(Po(n.url))),e.parse??(e.parse="auto"),!e.type)throw new Error("Format for the data source was not defined and it could not be inferred: "+JSON.stringify(n));return e}function jde(n){var e;if(Array.isArray(n)&&(n=n[0]),n)return(e=n.match(/\.(csv|tsv|json)/))==null?void 0:e[1]}const U$=n=>typeof n!="object"?qde:Gde,qde=n=>({data:n}),Gde=n=>n;function OF(n){return"url"in n}let Ym=class extends pn{constructor(t){super();Ui(this,"view");this.view=t}get identifier(){}setLoadingStatus(t,i){this.view.context.setDataLoadingStatus(this.view,t,i)}get paramMediator(){return this.view.paramMediator}handle(t){throw new Error("Source does not handle incoming data!")}async load(){}repropagate(){this.load()}};function j$(n){return"values"in n}class Kde extends Ym{constructor(e,t){var i;if(super(t),this.params=e,typeof e.values=="string"&&!((i=e==null?void 0:e.format)!=null&&i.type))throw new Error("Data format type (csv, dsv, ...) must be specified if a string is provided!")}loadSynchronously(){const e=this.params.values;let t=[],i=s=>s;if(Array.isArray(e))e.length>0&&(t=e,i=U$(e[0]));else if(typeof e=="object")t=[e];else if(typeof e=="string")t=HM(e,$$(this.params));else throw new Error('"values" in data configuration is not an array, object, or a string!');this.reset(),this.beginBatch({type:"file"});for(const s of t)this._propagate(i(s));this.complete()}async load(){this.loadSynchronously()}}function Yde(n){return"url"in n}class Zde extends Ym{constructor(e,t){super(t),this.params=sD(t.paramMediator,e,()=>this.load()),this.baseUrl=t==null?void 0:t.getBaseUrl()}get identifier(){return JSON.stringify({params:this.params,baseUrl:this.baseUrl})}async load(){const e=Po(this.params.url),t=Array.isArray(e)?e:[e];if(t.length===0||!t[0]){this.reset(),this.complete();return}const i=async o=>{try{const r=Ab(this.baseUrl,o),a=await fetch(r);if(!a.ok)throw new Error(`${a.status} ${a.statusText}`);return a.text()}catch(r){throw new Error(`Could not load data: ${o}. Reason: ${r.message}`)}},s=(o,r)=>{try{const a=HM(o,$$(this.params));this.beginBatch({type:"file",url:r});for(const l of a)this._propagate(l)}catch(a){throw new Error(`Cannot parse: ${r}: ${a.message}`)}};this.setLoadingStatus("loading"),this.reset();try{await Promise.all(t.map(o=>i(o).then(s))),this.setLoadingStatus("complete")}catch(o){this.setLoadingStatus("error",o.message)}this.complete()}}function Xde(n){return"sequence"in n}class Qde extends Ym{constructor(e,t){if(super(t),this.sequence=sD(t.paramMediator,e.sequence,()=>this.loadSynchronously()),!("start"in this.sequence))throw new Error("'start' is missing from sequence parameters!");if(!("stop"in this.sequence))throw new Error("'stop' is missing from sequence parameters!")}loadSynchronously(){const e=Po(this.sequence.as)??"data",t=Po(this.sequence.start)??0,i=Po(this.sequence.step)??1,s=Po(this.sequence.stop);this.reset(),this.beginBatch({type:"file"});for(let o=t;o<s;o+=i)this._propagate({[e]:o});this.complete()}async load(){this.loadSynchronously()}}class O4 extends Ym{constructor(t,i){super(t);Ui(this,"initializedPromise",Promise.resolve());if(i){if(i!=="x"&&i!=="y")throw new Error(`Invalid channel specified for the lazy data source: ${i}. Must be either "x" or "y"`)}else throw new Error('No channel has been specified for the lazy data source. Must be either "x" or "y".');if(this.channel=i,this.scaleResolution=this.view.getScaleResolution(i),!this.scaleResolution){const o=[`The lazy data source cannot find a resolved scale for channel "${i}".`];throw this.view instanceof Oo||o.push('Make sure the view has a "shared" scale resolution as it is not a unit view.'),new Error(o.join(" "))}const s=()=>{this.view.isVisible()&&this.onDomainChanged(this.scaleResolution.getDomain(),this.scaleResolution.getComplexDomain())};this.scaleResolution.addEventListener("domain",s),this.view.context.addBroadcastListener("layoutComputed",s)}getAxisLength(){const t=this.scaleResolution.members.map(i=>{var s;return(s=i.view.coords)==null?void 0:s[this.channel==="x"?"width":"height"]}).filter(i=>i>0);return t.length?t.reduce((i,s)=>Math.min(i,s),1e4):0}get genome(){return this.scaleResolution.getGenome()}onDomainChanged(t,i){}requestRender(){this.view.context.animator.requestRender()}async load(){this.reset(),this.complete()}publishData(t){this.reset(),this.beginBatch({type:"file"});for(const i of t)for(const s of i)this._propagate(s);this.complete(),tI(this.view)}}class Jde extends O4{constructor(t,i){const s={axis:{},...t};super(i,s.channel);Ui(this,"ticks",[]);this.params=t}async load(){this.ticks=null,this.onDomainChanged()}onDomainChanged(){const t=this.scaleResolution.scale,i=this.params.axis,s=this.getAxisLength(),o=c=>25+60*WH(100,700,c),r=Js(i.tickCount)?i.tickCount:Math.round(s/o(s)),a=p$(t,r,i.tickMinStep),l=i.values?m$(t,i.values,a):pce(t,a);if(this.ticks==null||!gA(l,this.ticks)){this.ticks=l;const c=_ce(t,r,i.format);this.publishData([l.map(d=>({value:d,label:c(d)}))])}}}class eue extends O4{constructor(e,t){super(t,e.channel)}async load(){this.publishData([this.genome.chromosomes])}}const tue="modulepreload",iue=function(n,e){return new URL(n,e).href},FF={},Ys=function(e,t,i){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=iue(o,i),o in FF)return;FF[o]=!0;const r=o.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(!!i)for(let d=s.length-1;d>=0;d--){const u=s[d];if(u.href===o&&(!r||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const c=document.createElement("link");if(c.rel=r?"stylesheet":tue,r||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),r)return new Promise((d,u)=>{c.addEventListener("load",d),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=o,window.dispatchEvent(r),!r.defaultPrevented)throw o})};function Ib(n,e,t=!0){let i,s=r=>{};return function(...a){return new Promise((l,c)=>{const d=()=>{clearTimeout(i),s=u=>{},l(n(...a))};t&&s("debounced"),clearTimeout(i),s=c,i=window.setTimeout(d,typeof e=="function"?e():e)})}}var Wp,Vp,zp,u1;class Z1 extends O4{constructor(){super(...arguments);ve(this,Wp,new AbortController);ve(this,Vp,[0,0]);ve(this,zp,[0,0]);ve(this,u1,0);Ui(this,"params")}setupDebouncing(t){const i=()=>Po(t.debounce),s=t.debounceMode;if(s=="domain")this.onDomainChanged=Ib(this.onDomainChanged.bind(this),i,!1);else if(s=="window")this.loadInterval=Ib(this.loadInterval.bind(this),i,!1);else throw new Error("Invalid debounceMode: "+s)}onDomainChanged(t){var s;gt(this,zp,t);const i=Po((s=this.params)==null?void 0:s.windowSize)??-1;t[1]-t[0]>i||this.callIfWindowsChanged(t,i,async o=>{await this.initializedPromise,this.loadInterval(o)})}reloadLastDomain(){const t=J(this,zp);gt(this,zp,[0,0]),gt(this,Vp,[0,0]),this.onDomainChanged(t)}async loadInterval(t){}async discretizeAndLoad(t,i){J(this,Wp).abort(),this.setLoadingStatus("loading"),gt(this,Wp,new AbortController);const s=J(this,Wp).signal,o=this.genome.continuousToDiscreteChromosomeIntervals(t);try{const r=await Promise.all(o.map(async a=>i(a,s)));if(!s.aborted)return this.setLoadingStatus("complete"),r}catch(r){if(!s.aborted)throw this.setLoadingStatus("error",r.message),r}}callIfWindowsChanged(t,i,s){const o=[Math.max(Math.floor(t[0]/i)*i,0),Math.min(Math.ceil(t[1]/i)*i,this.genome.totalSize)],r=J(this,Vp);(i!==J(this,u1)||o[0]<r[0]||o[1]>r[1])&&(gt(this,Vp,o),gt(this,u1,i),s(o))}}Wp=new WeakMap,Vp=new WeakMap,zp=new WeakMap,u1=new WeakMap;class nue extends Z1{constructor(e,t){const i={channel:"x",windowSize:7e3,debounce:200,debounceMode:"window",...e};if(super(t,i.channel),this.params=i,!this.params.url)throw new Error("No URL provided for IndexedFastaSource");this.setupDebouncing(this.params),this.initializedPromise=new Promise(s=>{Promise.all([Ys(()=>import("./index-Bk-LtoET.js").then(o=>o.i),__vite__mapDeps([0,1]),import.meta.url),Ys(()=>import("./index-BBh4oK1e.js"),__vite__mapDeps([2,3,0,1,4]),import.meta.url),Ys(()=>import("./index-DjJdr7nk.js"),__vite__mapDeps([5,3,6,0,1]),import.meta.url)]).then(([{Buffer:o},{IndexedFasta:r},{RemoteFile:a}])=>{typeof window<"u"&&(window.Buffer??(window.Buffer=o));const l=c=>new a(Y1(c,this.view.getBaseUrl()));this.fasta=new r({fasta:l(this.params.url),fai:l(this.params.indexUrl??this.params.url+".fai")}),s()})})}async loadInterval(e){const t=await this.discretizeAndLoad(e,async(i,s)=>this.fasta.getSequence(i.chrom,i.startPos,i.endPos,{signal:s}).then(o=>({chrom:i.chrom,start:i.startPos,sequence:o})));t&&this.publishData([t])}}var Hp,$p,h1,lI;class sue extends Z1{constructor(t,i){const s={pixelsPerBin:2,channel:"x",debounce:200,debounceMode:"window",...t},o=sD(i.paramMediator,s,r=>{r.includes("url")?De(this,h1,lI).call(this).then(()=>this.reloadLastDomain()):r.includes("pixelsPerBin")&&this.reloadLastDomain()});super(i,o.channel);ve(this,h1);ve(this,Hp,[]);ve(this,$p,void 0);if(this.params=o,!this.params.url)throw new Error("No URL provided for BigWigSource");this.setupDebouncing(this.params),De(this,h1,lI).call(this)}async onDomainChanged(t){await this.initializedPromise;const i=this.getAxisLength()||700,s=oue(t,i,J(this,Hp)),o=Math.max(s*i,5e3);this.callIfWindowsChanged(t,o,r=>this.loadInterval(r,s))}async loadInterval(t,i){const s=.5/i/Po(this.params.pixelsPerBin),o=await this.discretizeAndLoad(t,(r,a)=>J(this,$p).getFeatures(r.chrom,r.startPos,r.endPos,{scale:s,signal:a}).then(l=>l.map(c=>({chrom:r.chrom,start:c.start,end:c.end,score:c.score}))));o&&this.publishData(o)}}Hp=new WeakMap,$p=new WeakMap,h1=new WeakSet,lI=function(){return this.initializedPromise=new Promise((t,i)=>{Promise.all([Ys(()=>import("./index-CyR2IQoV.js"),__vite__mapDeps([7,0,1,8,3,6]),import.meta.url),Ys(()=>import("./index-DjJdr7nk.js"),__vite__mapDeps([5,3,6,0,1]),import.meta.url)]).then(([{BigWig:s},{RemoteFile:o}])=>{gt(this,$p,new s({filehandle:new o(Y1(Po(this.params.url),this.view.getBaseUrl()))})),this.setLoadingStatus("loading"),J(this,$p).getHeader().then(r=>{gt(this,Hp,r.zoomLevels.map(a=>a.reductionLevel).reverse()),J(this,Hp).push(1),this.setLoadingStatus("complete"),t()}).catch(r=>{this.load(),this.setLoadingStatus("error",`${Po(this.params.url)}: ${r.message}`),i(r)})})}),this.initializedPromise};function oue(n,e,t){const i=(n[1]-n[0])/e;return t.find(s=>s<i)??t.at(-1)}var f1,cI;class rue extends Z1{constructor(t,i){const s={channel:"x",windowSize:1e6,debounce:200,debounceMode:"window",...t},o=sD(i.paramMediator,s,r=>{r.includes("url")?De(this,f1,cI).call(this).then(()=>this.reloadLastDomain()):r.includes("windowSize")&&this.reloadLastDomain()});super(i,o.channel);ve(this,f1);Ui(this,"parser");Ui(this,"bbi");Ui(this,"parseLine");if(this.params=o,!this.params.url)throw new Error("No URL provided for BigBedSource");this.setupDebouncing(this.params),De(this,f1,cI).call(this)}async loadInterval(t){const i=await this.discretizeAndLoad(t,async(s,o)=>this.bbi.getFeatures(s.chrom,s.startPos,s.endPos,{signal:o}).then(r=>r.map(a=>this.parseLine(s.chrom,a))));i&&this.publishData(i)}}f1=new WeakSet,cI=function(){return this.initializedPromise=new Promise((t,i)=>{Promise.all([Ys(()=>import("./index-BHxDtRx7.js"),__vite__mapDeps([9,1]),import.meta.url),Ys(()=>import("./index-CyR2IQoV.js"),__vite__mapDeps([7,0,1,8,3,6]),import.meta.url),Ys(()=>import("./index-DjJdr7nk.js"),__vite__mapDeps([5,3,6,0,1]),import.meta.url)]).then(([s,{BigBed:o},{RemoteFile:r}])=>{const a=s.default;this.bbi=new o({filehandle:new r(Y1(Po(this.params.url),this.view.getBaseUrl()))}),this.setLoadingStatus("loading"),this.bbi.getHeader().then(async l=>{this.parser=new a({autoSql:l.autoSql});try{const c=aue(this.parser);this.parseLine=(d,u)=>c(d,u.start,u.end,u.rest)}catch{this.parseLine=(d,u)=>this.parser.parseLine(`${d}	${u.start}	${u.end}	${u.rest}`)}this.setLoadingStatus("complete"),t()}).catch(l=>{this.load(),this.setLoadingStatus("error",`${Po(this.params.url)}: ${l.message}`),i(l)})})}),this.initializedPromise};function aue(n){const e=n.autoSql.fields.filter(b=>b.type).slice(3);let t=0,i="",s=0,o={};const r="	",a=r.charCodeAt(0),l="0".charCodeAt(0),c="-".charCodeAt(0);function d(){let b=i.indexOf(r,t);b<0&&(b=s);const y=i.substring(t,b);return t=b+1,y}function u(){let b=0,y=i.charCodeAt(t),w=1;y===c&&(w=-1,t++,y=i.charCodeAt(t));do{if(y===a){t++;break}b=b*10+y-l,y=i.charCodeAt(++t)}while(t<s);return b*w}const h=e.map(b=>`${JSON.stringify(b.name)}: ${b.isNumeric?"0":"emptyString"}`),f=new Function(`
        const emptyString = "";
        return function makeTemplate(chrom, chromStart, chromEnd) {
            return {
                chrom,
                chromStart,
                chromEnd,
                ${h.join(`,
`)}
            }
        };`)(),g=e.map(b=>{const y=b.type,w=JSON.stringify(b.name);if(["ubyte","int","uint"].includes(y))return`d[${w}] = parseInt();`;if(b.isNumeric)return`d[${w}] = Number(parseString());`;if(["char","string","lstring"].includes(y))return`d[${w}] = parseString();`;throw new Error("Unsupported type: "+y)}),p=lue(g,50).map((b,y)=>Function("parseInt","parseString",`return function parseFieldChunk${y}(d) {
            ${b.join(`
`)}
        }`)(u,d));function _(b){i=b,s=b.length,t=0}function v(b,y,w,C){_(C),o=f(b,y,w);for(const L of p)L(o);return o}return v}function lue(n,e){return Array.from({length:Math.ceil(n.length/e)},(t,i)=>n.slice(i*e,i*e+e))}var Rh;class cue extends Z1{constructor(t,i){const s={channel:"x",windowSize:2e4,debounce:200,debounceMode:"domain",...t};super(i,s.channel);ve(this,Rh,void 0);Ui(this,"chrPrefixFixer",t=>t);if(this.params=s,!this.params.url)throw new Error("No URL provided for BamSource");this.setupDebouncing(this.params),this.initializedPromise=new Promise(o=>{Promise.all([Ys(()=>import("./index-Cef--9Aq.js"),__vite__mapDeps([10,4,0,1,3,6,8]),import.meta.url),Ys(()=>import("./index-DjJdr7nk.js"),__vite__mapDeps([5,3,6,0,1]),import.meta.url)]).then(([{BamFile:r},{RemoteFile:a}])=>{const l=c=>new a(Y1(c,this.view.getBaseUrl()));gt(this,Rh,new r({bamFilehandle:l(this.params.url),baiFilehandle:l(this.params.indexUrl??this.params.url+".bai")})),J(this,Rh).getHeader().then(c=>{var h,f;const d=this.genome.hasChrPrefix(),u=(f=(h=J(this,Rh).indexToChr)==null?void 0:h[0])==null?void 0:f.refName.startsWith("chr");d&&!u?this.chrPrefixFixer=g=>g.replace("chr",""):!d&&u&&(this.chrPrefixFixer=g=>"chr"+g),o()})})})}async loadInterval(t){const i=await this.discretizeAndLoad(t,async(s,o)=>J(this,Rh).getRecordsForRange(this.chrPrefixFixer(s.chrom),s.startPos,s.endPos,{signal:o}).then(r=>r.map(a=>({chrom:s.chrom,start:a.get("start"),end:a.get("end"),name:a.get("name"),MD:a.get("MD"),cigar:a.get("cigar"),mapq:a.get("mq"),strand:a.get("strand")===1?"+":"-"}))));i&&this.publishData(i)}}Rh=new WeakMap;var g1;class due extends Z1{constructor(t,i){const s={channel:"x",windowSize:3e6,debounce:200,debounceMode:"domain",...t};super(i,s.channel);ve(this,g1,void 0);if(this.params=s,!this.params.url)throw new Error("No URL provided for TabixSource");this.setupDebouncing(this.params),this.initializedPromise=new Promise(o=>{Promise.all([Ys(()=>import("./index-Bk-LtoET.js").then(r=>r.i),__vite__mapDeps([0,1]),import.meta.url),Ys(()=>import("./index-BydEQ8c3.js"),__vite__mapDeps([11,8,1,0,3,4]),import.meta.url),Ys(()=>import("./index-DjJdr7nk.js"),__vite__mapDeps([5,3,6,0,1]),import.meta.url)]).then(([{Buffer:r},{TabixIndexedFile:a},{RemoteFile:l}])=>{typeof window<"u"&&(window.Buffer??(window.Buffer=r));const c=d=>new l(Y1(d,this.view.getBaseUrl()));gt(this,g1,new a({filehandle:c(this.params.url),tbiFilehandle:c(this.params.indexUrl??this.params.url+".tbi")})),o()})})}async loadInterval(t){const i=await this.discretizeAndLoad(t,async(s,o)=>{const r=[];return await J(this,g1).getLines(s.chrom,s.startPos,s.endPos,{lineCallback:a=>{r.push(a)},signal:o}),this._parseFeatures(r)});i&&this.publishData(i)}_parseFeatures(t){return[]}}g1=new WeakMap;var p1;class uue extends due{constructor(t,i){super(t,i);ve(this,p1,void 0);Ys(()=>import("./index-Bm-vzmU9.js"),__vite__mapDeps([12,0,1,3]),import.meta.url).then(s=>{gt(this,p1,s.default)})}_parseFeatures(t){var s;return(s=J(this,p1))==null?void 0:s.parseStringSync(t.join(`
`),{parseSequences:!1})}}p1=new WeakMap;function hue(n,e){if(j$(n))return new Kde(n,e);if(Yde(n))return new Zde(n,e);if(Xde(n))return new Qde(n,e);if(fue(n))return wue(n.lazy,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function fue(n){return"lazy"in n}function gue(n){return(n==null?void 0:n.type)=="axisTicks"}function pue(n){return(n==null?void 0:n.type)=="axisGenome"}function mue(n){return(n==null?void 0:n.type)=="indexedFasta"}function _ue(n){return(n==null?void 0:n.type)=="bigwig"}function bue(n){return(n==null?void 0:n.type)=="bigbed"}function vue(n){return(n==null?void 0:n.type)=="bam"}function yue(n){return(n==null?void 0:n.type)=="gff3"}function wue(n,e){if(gue(n))return new Jde(n,e);if(pue(n))return new eue(n,e);if(mue(n))return new nue(n,e);if(_ue(n))return new sue(n,e);if(bue(n))return new rue(n,e);if(vue(n))return new cue(n,e);if(yue(n))return new uue(n,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function Cue(n){const e=Object.keys(n).filter(i=>typeof i=="string"),t=new Function("source","return { "+e.map(i=>JSON.stringify(i)).map(i=>`${i}: source[${i}]`).join(`,
`)+" };");return t.properties=e,t}class DS extends pn{get behavior(){return ll}constructor(){super();const e=t=>{const i=Cue(t);this.handle=s=>this._propagate(i(s)),this.handle(t)};this.handle=e,this.beginBatch=t=>{VH(t)&&(this.handle=e),super.beginBatch(t)}}}function Sue(n){return"name"in n}var m1;class q$ extends Ym{constructor(t,i,s){super(i);ve(this,m1,void 0);this.provider=s,this.params=t}get identifier(){return this.params.name}updateDynamicData(t){gt(this,m1,t),this.loadSynchronously()}loadSynchronously(){const t=J(this,m1)??this.provider(this.params.name)??[];let i=s=>s;if(Array.isArray(t))t.length>0&&(i=U$(t[0]));else throw new Error(`Named data "${this.params.name}" is not an array!`);this.reset(),this.beginBatch({type:"file"});for(const s of t)this._propagate(i(s));this.complete()}async load(){this.loadSynchronously()}}m1=new WeakMap;class G${constructor(){this._dataSourcesByHost=new Map,this._collectorsByHost=new Map,this._observers=new Map}get dataSources(){return[...new Set(this._dataSourcesByHost.values()).values()]}get collectors(){return[...this._collectorsByHost.values()]}addObserver(e,t){let i=this._observers.get(t);i||(i=[],this._observers.set(t,i)),i.push(e)}_relayObserverCallback(e,t){const i=this._observers.get(t);if(i)for(const s of i)s(e)}addDataSource(e,t){this._dataSourcesByHost.set(t,e)}findDataSourceByKey(e){return this._dataSourcesByHost.get(e)}findNamedDataSource(e){let t,i=[];for(const[s,o]of this._dataSourcesByHost.entries())if(o instanceof q$&&e==o.identifier){if(t&&t!==o)throw new Error(`Found multiple instances of named data: ${e}. Data flow optimization is broken (it's a bug).`);t=o,i.push(s)}if(t)return{dataSource:t,hosts:i}}addCollector(e,t){this._collectorsByHost.set(t,e),e.observers.push(i=>this._relayObserverCallback(i,t))}findCollectorByKey(e){return this._collectorsByHost.get(e)}initialize(){for(const e of this.dataSources)e.visit(t=>t.initialize())}}function xue(n,e){const t=new Map,i=[];for(const s of n)t.set(s,{ref:s,children:[]});for(const s of t.values()){const o=t.get(e(s.ref));o?o.children.push(s):i.push(s)}return i}function K$(n,e,t){var s,o;const i=(s=e.preOrder)==null?void 0:s.call(e,n);if(i)return i;for(const r of t(n)){const a=K$(r,e,t);if(a==="stop")return a}return(o=e.postOrder)==null?void 0:o.call(e,n)}function Lue(n,e){return K$(n,e,t=>t.children)}function Due(n,e){const t=[],i=[];let s;const o=e??new G$,r=[];function a(f,g=()=>{}){if(!s)throw g()||new Error("Cannot append data flow node, no parent exist!");return s.addChild(f),s=f,t.push(f),f}function l(f,g){return a(f,()=>new Error(`Cannot append a transform because no (inherited) data are available! ${g?JSON.stringify(g):""}`))}function c(f,g){for(const p of f){let _;try{_=Ude(p,g)}catch(v){throw console.warn(v),new Error(`Cannot initialize "${p.type}" transform: ${v}`)}_.behavior&bu&&l(new DS),l(_)}}function d(){return t.findLastIndex(f=>f instanceof FA)>t.findLastIndex(f=>f instanceof Ym)}const u=f=>{if(f.spec.data){const g=Sue(f.spec.data)?new q$(f.spec.data,f,f.context.getNamedDataFromProvider):hue(f.spec.data,f);s=g,t.push(g),o.addDataSource(g,f)}if(f.spec.transform&&c(f.spec.transform,f),f instanceof Oo){if(!s)throw new Error(`A unit view (${f.getPathString()}) has no (inherited) data source`);const g=kue(f);if(g){r.push(g.rewrite);for(const _ of g.transforms)l(_)}f.mark.isPickingParticipant()&&!d()&&(l(new DS),l(new FA({type:"identifier"})));const p=new W$({type:"collect",groupby:f.getFacetFields(),sort:Eue(f,g==null?void 0:g.rewrittenEncoding)});a(p),o.addCollector(p,f)}},h=xue(n.getDescendants(),f=>f.dataParent);for(const f of h)Lue(f,{preOrder:g=>{i.push({view:g.ref,nodeStackDepth:t.length}),u(g.ref)},postOrder:()=>{const{nodeStackDepth:g}=i.pop();t.length=g,s=t.at(-1)}});return r.forEach(f=>f()),o}function kue(n){var o;const e=[],t={},i=[];for(const[r,a]of Object.entries(n.getEncoding())){const l=r;Db(l)&&jH(a)&&i.push({channel:l,chromPosDef:a})}const s=DL(i,r=>df(r.channel),r=>r.chromPosDef.chrom);for(const[r,a]of s.entries())for(const[l,c]of a.entries()){const d=[],u=[],h=[];for(const{channel:f,chromPosDef:g}of c){const p=b=>b.replace(/[^A-Za-z0-9_]/g,""),_=["_linearized_",p(g.chrom),"_",p(g.pos)].join(""),v={...((o=n.spec.encoding)==null?void 0:o[f])??n.getEncoding()[f]??{},field:_};delete v.chrom,delete v.pos,!v.type&&g.type&&(v.type=g.type),t[f]=v,d.push(g.pos),h.push(g.offset??0),u.push(_)}e.push(new DS),e.push(new z$({type:"linearizeGenomicCoordinate",channel:r,chrom:l,pos:d,offset:h,as:u},n))}return e.length?{transforms:e,rewrittenEncoding:t,rewrite:()=>{n.spec.encoding={...n.spec.encoding,...t},Rle(n.mark,"encoding")}}:void 0}function Eue(n,e){var i;const t={...n.getEncoding(),...e}.x;if(Wo(t)&&(i=n.getScaleResolution("x"))!=null&&i.isZoomable()){if(vu(t))return"buildIndex"in t&&t.buildIndex?{field:t.field}:null;if(!z1(t)){if(H1(t))throw new Error("A zoomable x channel must be mapped to a field.")}}}function Y$(n,e=void 0){if(n.parent!==e)return!1;for(const t of n.children)if(!Y$(t,n))return!1;return!0}function dI(n,e=!1){if(n.behavior&I4&&(e=!0),n instanceof DS)if(e)e=!1;else{const t=n.children[0];n.excise(),t&&dI(t,e);return}n.behavior&ll&&(e=!1);for(let t=0,i=n.children.length;t<i;t++)dI(n.children[t],e||i>1)}function Aue(n){const e=[...n._dataSourcesByHost.entries()],t=new Map;for(const i of e){const s=i[1];s.identifier&&!t.has(s.identifier)&&t.set(s.identifier,s)}n._dataSourcesByHost.clear();for(let[i,s]of e){const o=t.get(s.identifier);o&&(o.adoptChildrenOf(s),s=o),n.addDataSource(s,i)}}function Iue(n){if(dI(n),!Y$(n))throw new Error("Encountered a bug! There's a problem in the data flow structure.")}function Tue(n){Aue(n);for(const e of n.dataSources)Iue(e)}function Nue(n){const e=new Set;n.visit(t=>{for(const i of Object.values(t.resolutions.scale)){const s=i.name;if(s&&e.has(s))throw new Error(`The same scale name "${s}" occurs in multiple scale resolutions!`);e.add(s)}})}function Rue(n){for(const e of Km){const t=n.getScaleResolution(e);t&&!t.name&&t.isZoomable()&&(t.name=`${e}_at_root`)}}async function Mue(n,e,t){const i=n.import;if(!("url"in i))throw new Error("Not an url import: "+JSON.stringify(i));const s=Ab(e,i.url);let o;try{const r=await fetch(s);if(!r.ok)throw new Error(`${r.status} ${r.statusText}`);o=await r.json()}catch(r){throw new Error(`Could not load imported view spec: ${s}. Reason: ${r.message}`)}if(t.isViewSpec(o))return o.baseUrl=Ab(w$(i.url),o.baseUrl),o;throw new Error(`The imported spec "${s}" is not a view spec: ${JSON.stringify(n)}`)}function Pue(n){const e=n.getSize(),t=n.getPadding(),i=(s,o)=>s.grow>0?void 0:s.px+o;return{width:i(e.width,t.horizontalTotal),height:i(e.height,t.verticalTotal)}}function hl(n){return()=>n}const Fr=class Fr{static create(e,t,i,s){return new Fr(hl(e),hl(t),hl(i),hl(s))}_offset(e,t){const i=this["_"+e];if(t===0)return i;switch(typeof t){case"number":return()=>i()+t;case"function":return()=>i()+t();default:throw new Error("Not a number of function")}}_passThrough(e){return this._offset(e,0)}constructor(e,t,i,s){this._x=e,this._y=t,this._width=i,this._height=s}get x(){return this._x()}get y(){return this._y()}get width(){return this._width()}get height(){return this._height()}get x2(){return this._x()+this._width()}get y2(){return this._y()+this._height()}equals(e){return e?this===e||this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height:!1}modify(e){if(!Object.keys(e).length)return this;const t=i=>{const s=e[i];return typeof s=="number"?hl(s):typeof s=="function"?s:this._passThrough(i)};return new Fr(t("x"),t("y"),t("width"),t("height"))}translate(e,t){return e===0&&t===0?this:new Fr(this._offset("x",e),this._offset("y",t),this._passThrough("width"),this._passThrough("height"))}translateBy(e){return this.translate(e.x,e.y)}expand(e,t=1){return e.left==0&&e.top==0&&e.right==0&&e.bottom==0?this:new Fr(e.left?this._offset("x",-e.left*t):this._passThrough("x"),e.top?this._offset("y",-e.top*t):this._passThrough("y"),e.width?this._offset("width",e.width*t):this._passThrough("width"),e.height?this._offset("height",e.height*t):this._passThrough("height"))}shrink(e){return this.expand(e,-1)}intersect(e){return this===e||e==null?this:new Fr(()=>Math.max(this.x,e.x),()=>Math.max(this.y,e.y),()=>Math.min(this.x2,e.x2)-Math.max(this.x,e.x),()=>Math.min(this.y2,e.y2)-Math.max(this.y,e.y))}union(e){return this===e||e==null?this:new Fr(()=>Math.min(this.x,e.x),()=>Math.min(this.y,e.y),()=>Math.max(this.x2,e.x2)-Math.min(this.x,e.x),()=>Math.max(this.y2,e.y2)-Math.min(this.y,e.y))}isDefined(){return this.width>=0&&this.height>=0}flatten(){return new Fr(hl(this.x),hl(this.y),hl(this.width),hl(this.height))}containsPoint(e,t){return e>=this.x&&e<this.x2&&t>=this.y&&t<this.y2}normalizePoint(e,t){return{x:(e-this.x)/this.width,y:(t-this.y)/this.height}}toString(){return`Rectangle: x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height}`}toRoundedString(){return`Rectangle: x: ${Math.round(this.x)}, y: ${Math.round(this.y)}, width: ${Math.round(this.width)}, height: ${Math.round(this.height)}`}};Ui(Fr,"ZERO",Fr.create(0,0,0,0));let ec=Fr;class Z${constructor(e){this.globalOptions=e}pushView(e,t){}popView(e){}renderMark(e,t){}}class BF extends Z${constructor(e,t){super(e),this.webGLHelper=t,this.buffer=[],this.coords=void 0,this.views=new Set}pushView(e,t){this.views.add(e),this.coords=t}renderMark(e,t){if(this.globalOptions.picking&&!e.isPickingParticipant())return;const i=e.render(t);i&&this.buffer.push({mark:e,callback:i,coords:this.coords,clipRect:t.clipRect})}render(){if(this.batch||this._buildBatch(),this.batch.length==0)return;const e=this.webGLHelper.gl,t=this.globalOptions.picking;e.bindFramebuffer(e.FRAMEBUFFER,t?this.webGLHelper._pickingBufferInfo.framebuffer:null),this.webGLHelper.clearAll();for(const i of this.views)i.onBeforeRender();for(const i of this.batch)i();t&&e.bindFramebuffer(e.FRAMEBUFFER,null)}_buildBatch(){this.batch=[];let e=!0,t=!0;const i=r=>()=>{e&&r()},s=r=>()=>{e&&t&&r()},o=DL(this.buffer.reverse(),r=>r.mark);for(const[r,a]of[...o.entries()].reverse()){if(!r.isReady())continue;this.batch.push(()=>{e=r.unitView.getEffectiveOpacity()>0}),this.batch.push(...r.prepareRender(this.globalOptions).map(c=>i(c)));let l;for(const c of a){const d=c.coords;d.equals(l)||this.batch.push(i(()=>{t=r.setViewport(d,c.clipRect)})),this.batch.push(s(c.callback)),l=c.coords}}}}class Oue extends Z${constructor(...e){super({}),this.contexts=e}pushView(e,t){for(const i of this.contexts)i.pushView(e,t)}popView(e){for(const t of this.contexts)t.popView(e)}renderMark(e,t){for(const i of this.contexts)i.renderMark(e,t)}}class Fue{constructor(e,t){this.point=e,this.uiEvent=t,this.stopped=!1,this.target=void 0}stopPropagation(){this.stopped=!0}get type(){return this.uiEvent.type}}class Ma{static fromMouseEvent(e){return new Ma(e.clientX,e.clientY)}constructor(e,t){this.x=e,this.y=t}subtract(e){return new Ma(this.x-e.x,this.y-e.y)}add(e){return new Ma(this.x-e.x,this.y-e.y)}multiply(e){return new Ma(this.x*e,this.y*e)}get length(){return Math.sqrt(this.x**2+this.y**2)}equals(e){return e?e===this||e.x===this.x&&e.y===this.y:!1}}const Bue=n=>new Promise(e=>setTimeout(e,n));function Wue(n){const e=n.requestAnimationFrame||window.requestAnimationFrame,t=n.signal,i=()=>new Promise((s,o)=>{if(t!=null&&t.aborted)return o("aborted");const r=performance.now(),a=r+(n.duration||1e3),l=typeof n.from=="number"?n.from:0,c=typeof n.to=="number"?n.to:1,d=n.easingFunction||(p=>p),u=p=>(p-r)/(a-r),h=p=>p*(c-l)+l,f=p=>Math.max(0,Math.min(1,p)),g=p=>{t!=null&&t.aborted?o("aborted"):(n.onUpdate(h(d(f(u(p))))),p<a?e(g):(n.onUpdate(h(d(1))),s()))};e(g)});return n.delay?t!=null&&t.aborted?Promise.reject("aborted"):Bue(n.delay).then(i):i()}class Vue{constructor(e){this._renderCallback=e,this._renderRequested=!1,this._warn=!1,this.transitions=[]}requestTransition(e){this.cancelTransition(e),this.transitions.push(e),this.requestRender()}cancelTransition(e){const t=this.transitions.indexOf(e);t>=0&&this.transitions.splice(t,1)}requestRender(){this._renderRequested?this._warn&&console.warn("Render already requested!"):(this._renderRequested=!0,window.requestAnimationFrame(e=>{this._renderRequested=!1;const t=this.transitions;this.transitions=[];let i;for(;i=t.shift();)i(e);this._renderCallback(e)}))}transition(e){return Wue({requestAnimationFrame:t=>this.requestTransition(t),...e})}}function F4(n,e,t,i,s){let o=0,r=!0,a=structuredClone(s),l=a;function c(h,f,g,p){return f+(h-f)*Math.pow(2,-g/p)}function d(h){if(r)return;const f=h-o;o=h;for(const p of Object.keys(l))a[p]=c(a[p],l[p],f,t);e(a);let g=-1/0;for(const p of Object.keys(l))g=Math.max(g,Math.abs(l[p]-a[p]));g<i?(a=l,e(a),r=!0,g!=0&&n.requestRender()):n.requestTransition(p=>d(p))}function u(h){l=h,r&&(r=!1,o=+document.timeline.currentTime,d(o))}return u.stop=()=>{r=!0},u}class zue{constructor(e){this.genomes=new Map,this.baseUrl=e}async initialize(e){const t=new qce(e);return this.genomes.set(t.name,t),Promise.all([...this.genomes.values()].map(i=>i.load(this.baseUrl)))}getGenome(e){if(!this.genomes.size)throw new Error("No genomes have been configured!");if(e){const t=this.genomes.get(e);if(!t)throw new Error(`No genome with the name ${e} has been configured!`);return t}else{if(this.genomes.size>1)throw new Error("Cannot pick a default genome! More than one have been configured!");return this.genomes.values().next().value}}}const Hue=""+new URL("Lato-Regular-BEY4SZ9T.png",import.meta.url).href,$ue={thin:100,light:300,regular:400,normal:400,medium:500,bold:700,black:900};class Uue{constructor(e){this._webGLHelper=e,this.fontRepository="https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/",this._fonts=new uc([],JSON.stringify),this._metadataPromises=new Map,this._fontPromises=new Map,this._promises=[],this._defaultFontEntry={metrics:zA(H$),texture:e?this._createTextureNow(Hue):void 0}}async waitUntilReady(){await Promise.all(this._promises)}getFont(e,t="normal",i="regular"){if(ci(i)&&(i=$ue[i.toLowerCase()],!i))throw new Error("Unknown font weight: "+i);const s={family:e,style:t,weight:i};let o=this._fonts.get(s);return o||(o={metrics:void 0,texture:void 0},this._fonts.set(s,o),this._promises.push(this._loadFontEntry(o,s))),o}async _loadFontEntry(e,t){try{const i=await this._loadMetadata(t.family),s=que(i,t),o=this.fontRepository+WF(t.family)+"/"+s.replace(/\.\w+/,""),r=this._createTexture(o+".png"),a=this._loadFont(o+".json");e.texture=await r,e.metrics=await a}catch{console.warn(`Cannot load font: "${t.family}". Using the embedded default font.`),e.metrics=this._defaultFontEntry.metrics,e.texture=this._defaultFontEntry.texture}}_loadFont(e){let t=this._fontPromises.get(e);return t||(t=fetch(e).then(i=>{if(!i.ok)throw new Error("Could not load font: "+i.status);return i}).then(i=>i.json()).then(i=>zA(i)),this._fontPromises.set(e,t)),t}_loadMetadata(e){const t=WF(e);let i=this._metadataPromises.get(t);if(!i){const s=this.fontRepository+t+"/METADATA.pb";i=fetch(s).then(o=>{if(!o.ok)throw new Error("Could not load font metadata. Response status: "+o.status+", url: "+s);return o}).then(o=>o.text()).then(o=>jue(o)).catch(o=>{console.warn(o.message)}),this._metadataPromises.set(t,i)}return i}getDefaultFont(){return this._defaultFontEntry}_createTexture(e){const t=this._webGLHelper.gl;return new Promise((i,s)=>{yb(t,{src:e,min:t.LINEAR},(o,r,a)=>{o?s(o):i(r)})})}_createTextureNow(e){const t=this._webGLHelper.gl;let i;const s=new Promise((o,r)=>{i=yb(t,{src:e,min:t.LINEAR},(a,l,c)=>{a?r(a):o(l)})});return this._promises.push(s),i}}function WF(n){return n.toLowerCase().replaceAll(/[^\w]/g,"")}function jue(n){const e=n.split(`
`),t=[];let i;for(const s of e)if(s.startsWith("fonts {")&&(i={name:void 0,style:void 0,weight:void 0,filename:void 0,post_script_name:void 0,full_name:void 0,copyright:void 0}),s.startsWith("}")&&(t.push(i),i=void 0),i){let o=s.match(/^\s*([A-Za-z_]+):[ ]?"(.*)"$/);if(o){const r=o[1];i[r]=o[2]}if(o=s.match(/^\s*([A-Za-z_]+):[ ]?(\d+)$/),o){const r=o[1];i[r]=+o[2]}}return t}function que(n,e){let t,i=Number.POSITIVE_INFINITY;for(const s of n)if(e.family.localeCompare(s.name,void 0,{sensitivity:"accent"})==0&&e.style==s.style){const o=Math.abs(e.weight-s.weight);o<i&&(i=o,t=s)}return t==null?void 0:t.filename}function Gue(n,e){const t=[];let i;for(const s of n.split(`
`))if(s.startsWith(">"))i={identifier:s.match(/>(\S+)/)[1],sequence:""},t.push(i);else if(i)i.sequence+=s.trim();else throw new Error("Invalid fasta file!");return t}class Kue{constructor(e,t){this.animator=e,this.disabled=!!t,this.maxDistance=500,this.callback=null,this.targetValue=0,this.lastValue=0,this.smoother=F4(e,i=>{var o;const s=i.x-this.lastValue;this.lastValue=i.x,(o=this.callback)==null||o.call(this,s)},40,.1,{x:0})}cancel(){this.lastValue!==this.targetValue&&(this.targetValue=lV([this.lastValue,this.targetValue],.3),this.smoother({x:this.targetValue}))}setMomentum(e,t){if(this.disabled){t(e);return}this.callback=t;const i=cm(this.targetValue+e-this.lastValue,-this.maxDistance,this.maxDistance);this.targetValue=this.lastValue+i,this.smoother({x:this.targetValue})}}function Yue(n){const e={},t=["string","number","boolean"],i=["wheelDelta","wheelDeltaX","wheelDeltaY"];for(const s in n){const o=s;!i.includes(s)&&t.includes(typeof n[o])&&(e[o]=n[o])}return e}const VF=new Map;async function Zue(n,e,t){const i=n.symbol;let s=VF.get(i)??await Jue(n.symbol);return s?(VF.set(i,s),At`
            <div class="title">
                <strong>${s.name}</strong>
                ${s.description}
            </div>
            <p class="summary">${s.summary}</p>
            <p class="source">Source: NCBI RefSeq Gene</p>
        `):null}async function Xue(n){console.log("Searching: "+n);const e={mode:"cors"},i=(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=gene&term=${n}[GENE]&sort=relevance&retmode=json`,e).then(s=>s.json())).esearchresult.idlist[0];return i?(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&id=${i}&retmode=json`,e).then(r=>r.json())).result[i]:null}const Que=Ib(Xue,500);function Jue(n){return Que(n)}const ehe=ls(".4~r"),the=ls(".4~e");function X$(n){return n==null?At` <span class="na">NA</span> `:ci(n)?n.substring(0,30):Number.isInteger(n)?""+n:Js(n)?Math.abs(n)>Math.pow(10,8)||Math.abs(n)<Math.pow(10,-8)?the(n):ehe(n):L1(n)?n?"True":"False":Rs(n)?At`${n.map((e,t)=>[X$(e),t<n.length-1?", ":Vi])}`:"?"+typeof n+" "+n}async function ihe(n,e,t){const i=(l,c)=>{var d;for(const[u,h]of Object.entries(e.encoders))if((d=h==null?void 0:h.dataAccessor)!=null&&d.fields.includes(l))switch(u){case"color":case"fill":case"stroke":return At`
                            <span
                                class="color-legend"
                                style=${`background-color: ${h(c)}`}
                            ></span>
                        `}return""},s=Object.entries(n).filter(([l,c])=>!l.startsWith("_"));if(s.length===0)return;const o=At`
        <table class="attributes">
            ${s.map(([l,c])=>At`
                    <tr>
                        <th>${l}</th>
                        <td>${X$(c)} ${i(l,n)}</td>
                    </tr>
                `)}
        </table>
    `,r=e.unitView.getTitleText(),a=r?At`
              <div class="title">
                  <strong>${r}</strong>
              </div>
          `:"";return At`${a}${o}`}class X1 extends M${constructor(e,t,i,s,o,r){super(e,t,i,s,o,r),this.spec=e}async initializeChildren(){}*[Symbol.iterator](){}replaceChild(e,t){throw new Error("Not implemented")}visit(e){let t;try{t=e(this)}catch(i){throw i.view=this,i}if(t===D_)return t;if(t!==lde){e.beforeChildren&&e.beforeChildren(this);for(const i of this){const s=i.visit(e);if(s===D_)return s}e.afterChildren&&e.afterChildren(this),e.postOrder&&e.postOrder(this)}}findDescendantByPath(e){for(const t of this)if(t.name===e[0]){if(e.length==1)return t;if(t instanceof X1)return t.findDescendantByPath(e.slice(1))}}findChildByName(e){for(const t of this)if(t.name===e)return t}findDescendantByName(e){let t;return this.visit(i=>{if(i.name==e)return t=i,D_}),t}getDefaultResolution(e,t){return"shared"}}var Ml;class Q1 extends X1{constructor(t,i,s,o,r,a){super(t,i,s,o,r,{layersChildren:!0,...a});ve(this,Ml,[]);this.spec=t,this.needsAxes={x:!0,y:!0}}async initializeChildren(){gt(this,Ml,await Promise.all(this.spec.layer.map((t,i)=>this.context.createOrImportView(t,this,this,"grid"+i,s=>{if(!mI(s)&&!pI(s))throw new zh("LayerView accepts only unit or layer specs as children!",this)}))))}get children(){return J(this,Ml).slice()}*[Symbol.iterator](){for(const t of J(this,Ml))yield t}render(t,i,s={}){if(super.render(t,i,s),!!this.isConfiguredVisible()){t.pushView(this,i);for(const o of J(this,Ml))o.render(t,i,s);t.popView(this)}}propagateInteractionEvent(t){this.handleInteractionEvent(void 0,t,!0);for(let i=J(this,Ml).length-1;i>=0;i--)if(J(this,Ml)[i].propagateInteractionEvent(t),t.stopped)return;this.handleInteractionEvent(void 0,t,!1)}}Ml=new WeakMap;class zF{constructor(e,t){this.n=e,this.maxCols=t??1/0}get nRows(){return this.maxCols==1/0?1:Math.ceil(this.n/this.maxCols)}get nCols(){return Math.min(this.n,this.maxCols)}get rowIndices(){const e=[],t=this.nCols,i=this.nRows;for(let s=0;s<i;s++){const o=[];e.push(o);for(let r=0;r<t;r++){const a=s*t+r;a<this.n&&o.push(a)}}return e}get colIndices(){const e=[],t=this.nCols,i=this.nRows;for(let s=0;s<t;s++){const o=[];e.push(o);for(let r=0;r<i;r++){const a=r*t+s;a<this.n&&o.push(a)}}return e}getCellIndex(e,t){let i=0;if(this.maxCols==1/0)i=t==0?e:void 0;else{if(e>=this.maxCols)return;i=t*this.nCols+e}return i<this.n?i:void 0}getCellCoords(e){if(!(e<0||e>=this.n))return[e%this.nCols,Math.floor(e/this.nCols)]}}const nhe="chromosome_ticks_and_labels",she={x:"width",y:"height"};function uI(n){return n=="x"?"y":"x"}const kS={x:["bottom","top"],y:["left","right"]},B4=Object.fromEntries(Object.entries(kS).map(([n,e])=>e.map(t=>[t,n])).flat(1));function Zd(n){return B4[n]}class Q$ extends Q1{constructor(e,t,i,s,o,r){const a=t=="locus",l={...a?rhe:J$,...ohe(t,e),...e};super(a?ahe(l,t):eU(l,t),i,s,o,`axis_${e.orient}`,{blockEncodingInheritance:!0,contributesToScaleDomain:!1,...r}),this.axisProps=l}getSize(){const e={px:this.getPerpendicularSize()},t={grow:1};return B4[this.axisProps.orient]=="x"?new Yd(t,e):new Yd(e,t)}getPerpendicularSize(){return W4(this.axisProps)}isPickingSupported(){return!1}}function W4(n){const e=Zd(n.orient);let t=n.ticks&&n.tickSize||0;return n.labels&&(t+=n.labelPadding,e=="x"?t+=n.labelFontSize:t+=30),n.title&&(t+=n.titlePadding+n.titleFontSize),t=Math.min(n.maxExtent||1/0,Math.max(n.minExtent||0,t)),t}const J$={values:null,minExtent:20,maxExtent:1/0,offset:0,domain:!0,domainWidth:1,domainColor:"gray",domainDash:null,domainDashOffset:0,domainCap:"square",ticks:!0,tickSize:5,tickWidth:1,tickColor:"gray",tickDash:null,tickDashOffset:0,tickCap:"square",tickCount:null,tickMinStep:null,labels:!0,labelAlign:"center",labelBaseline:"middle",labelPadding:4,labelFontSize:10,labelLimit:180,labelColor:"black",format:null,titleColor:"black",titleFont:"sans-serif",titleFontSize:10,titlePadding:3};function ohe(n,e){const t=e.orient,i=n=="nominal"||n=="ordinal";let s="center",o="middle",r=e.labelAngle??((t=="top"||t=="bottom")&&i?-90:0);switch(t){case"left":s="right";break;case"right":s="left";break;case"top":case"bottom":Math.abs(r)>30?(s=r>0==(t=="bottom")?"left":"right",o="middle"):o=t=="top"?"alphabetic":"top";break}return{labelAlign:s,labelAngle:r,labelBaseline:o}}function eU(n,e){const t={...n,extent:W4(n)},i=Zd(t.orient),s=uI(i),o=t.orient=="bottom"||t.orient=="right"?1:-1,r=t.orient=="bottom"||t.orient=="left"?1:0,a=()=>({name:"domain",data:{values:[0]},mark:{type:"rule",clip:!1,strokeDash:t.domainDash,strokeCap:t.domainCap,color:t.domainColor,[s]:r,size:t.domainWidth}}),l=()=>({name:"labels",mark:{type:"text",clip:!1,align:t.labelAlign,angle:t.labelAngle,baseline:t.labelBaseline,[s+"Offset"]:(t.tickSize+t.labelPadding)*o,[s]:r,size:t.labelFontSize,color:t.labelColor,minBufferSize:1500},encoding:{[i]:{field:"value",type:e},text:{field:"label"}}}),c=()=>({name:"ticks",mark:{type:"rule",clip:!1,strokeDash:t.tickDash,strokeCap:t.tickCap,color:t.tickColor,size:t.tickWidth,minBufferSize:300},encoding:{[s]:{value:r},[s+"2"]:{value:r-t.tickSize/t.extent*(r?1:-1)}}}),d=()=>({name:"title",data:{values:[0]},mark:{type:"text",clip:!1,align:"center",baseline:t.orient=="bottom"?"bottom":"top",angle:[0,90,0,-90][["top","right","bottom","left"].indexOf(t.orient)],text:t.title,color:t.titleColor,[i]:.5,[s]:1-r}}),u=()=>{const f={name:"ticks_and_labels",encoding:{[i]:{field:"value",type:e}},layer:[]};return t.ticks&&f.layer.push(c()),t.labels&&f.layer.push(l()),f},h={resolve:{scale:{[i]:"forced"}},[she[uI(i)]]:t.extent,data:{lazy:{type:"axisTicks",channel:i,axis:n}},layer:[]};return t.domain&&h.layer.push(a()),(t.ticks||t.labels)&&h.layer.push(u()),t.title&&h.layer.push(d()),h}const rhe={...J$,chromTicks:!0,chromTickSize:18,chromTickWidth:1,chromTickColor:"#989898",chromTickDash:[4,2],chromTickDashOffset:1,chromLabels:!0,chromLabelFontSize:13,chromLabelFontWeight:"normal",chromLabelFontStyle:"normal",chromLabelColor:"black",chromLabelAlign:"left",chromLabelPadding:7};function ahe(n,e){const t={...n,extent:W4(n)},i=Zd(t.orient),s=uI(i),o=t.orient=="bottom"||t.orient=="left"?1:0,r=()=>({name:"chromosome_ticks",mark:{type:"rule",strokeDash:n.chromTickDash,strokeDashOffset:n.chromTickDashOffset,[s]:o,[s+"2"]:o-t.chromTickSize/t.extent*(o?1:-1),color:n.chromTickColor,size:t.chromTickWidth}}),a=()=>{let d;switch(t.orient){case"top":d={y:0,angle:0,paddingX:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"bottom":d={y:1,angle:0,paddingX:4,dy:t.chromLabelPadding+t.chromLabelFontSize*.73,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"left":d={x:1,angle:-90,paddingY:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthBottom:20,viewportEdgeFadeWidthTop:20,viewportEdgeFadeDistanceBottom:-20,viewportEdgeFadeDistanceTop:-10};break;case"right":d={x:0,angle:90,align:"right",paddingY:4,dy:-t.chromLabelPadding};break;default:d={}}return{name:"chromosome_labels",mark:{type:"text",size:t.chromLabelFontSize,font:t.chromLabelFont,fontWeight:t.chromLabelFontWeight,fontStyle:t.chromLabelFontStyle,color:t.chromLabelColor,align:n.chromLabelAlign,baseline:"alphabetic",clip:!1,...d},encoding:{[i+"2"]:{field:"continuousEnd",type:e},text:{field:"name"}}}};let l;switch(t.orient){case"bottom":case"top":l={};break;case"left":l={labelAngle:-90,labelAlign:"center",labelPadding:6};break;case"right":l={labelAngle:90,labelAlign:"center",labelPadding:6};break;default:l={}}const c=eU({...n,...l},e);if(n.chromTicks||n.chromLabels){const d={name:nhe,data:{lazy:{type:"axisGenome",channel:Zd(t.orient)}},encoding:{[i]:{field:"continuousStart",type:e,band:0}},layer:[]};if(n.chromTicks&&d.layer.push(r()),n.chromLabels){d.layer.push(a());let u;c.layer.filter(h=>h.name=="ticks_and_labels").forEach(h=>h.layer.filter(f=>f.name=="labels").forEach(f=>{u=f.mark})),u&&(t.orient=="top"||t.orient=="bottom"?(u.viewportEdgeFadeWidthLeft=30,u.viewportEdgeFadeDistanceLeft=40):(u.viewportEdgeFadeWidthBottom=30,u.viewportEdgeFadeDistanceBottom=40))}c.layer.push(d)}return c}class lhe extends Q1{constructor(e,t,i,s,o,r){const l={...t=="locus"?che:tU,...e};super(fhe(l,t),i,s,o,`axisGrid_${e.orient}`,{blockEncodingInheritance:!0,contributesToScaleDomain:!1,...r}),this.axisProps=l}getOrient(){return this.axisProps.orient}isPickingSupported(){return!1}}const tU={values:null,grid:!1,gridCap:"butt",gridColor:"lightgray",gridDash:null,gridOpacity:1,gridWidth:1,tickCount:null,tickMinStep:null},che={...tU,chromGrid:!1,chromGridCap:"butt",chromGridColor:"gray",chromGridDash:[1,5],chromGridOpacity:1,chromGridWidth:1};function dhe(n,e){const t=n,i=Zd(t.orient);return{name:"grid_lines",data:{lazy:{type:"axisTicks",channel:i,axis:n}},mark:{type:"rule",strokeDash:t.gridDash,strokeCap:t.gridCap,color:t.gridColor,size:t.gridWidth,opacity:t.gridOpacity,minBufferSize:300},encoding:{[i]:{field:"value",type:e}}}}function uhe(n,e){const t=n,i=Zd(t.orient);return{name:"chromosome_lines",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rule",strokeDash:t.chromGridDash,strokeCap:t.chromGridCap,color:t.chromGridColor,size:t.chromGridWidth,opacity:t.chromGridOpacity},encoding:{[i]:{field:"continuousStart",type:e,band:0}}}}function hhe(n,e){const t=n,i=Zd(t.orient);return{name:"chromosome_fill",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rect"},encoding:{[i]:{field:"continuousStart",type:e,band:0},[i+"2"]:{field:"continuousEnd",band:0},fill:{field:"odd",type:"nominal",scale:{domain:[!1,!0],range:[t.chromGridFillEven??"white",t.chromGridFillOdd??"white"]}},opacity:{field:"odd",type:"nominal",scale:{type:"ordinal",domain:[!1,!0],range:[t.chromGridFillEven?1:0,t.chromGridFillOdd?1:0]}}}}}function fhe(n,e){const t={...n},i=[];return t.chromGrid&&(t.chromGridFillOdd||t.chromGridFillEven)&&i.push(hhe(t,e)),t.chromGrid&&t.chromGridOpacity>0&&i.push(uhe(t,e)),t.grid&&t.gridOpacity>0&&i.push(dhe(t,e)),{name:"grid_layers",configurableVisibility:!1,resolve:{scale:{[Zd(n.orient)]:"forced",fill:"independent",opacity:"independent"}},layer:i}}const HF={anchor:"middle",frame:"group",offset:10,orient:"top",align:void 0,angle:0,baseline:"alphabetic",dx:0,dy:0,color:void 0,font:void 0,fontSize:12,fontStyle:"normal",fontWeight:"normal"},ghe={orient:"left",anchor:"middle",align:"right",baseline:"middle",angle:0,fontSize:12},phe={orient:"top",anchor:"start",align:"left",baseline:"top",offset:-10,dx:10,fontSize:12},mhe={start:0,middle:.5,end:1},_he={start:"left",middle:"center",end:"right"};function bhe(n){if(!n)return;const e=ci(n)?{text:n}:n;if(!e.text||e.orient=="none")return;const t={"track-title":ghe,overlay:phe}[e.style]??{},i={...HF,...t,...e};let s={},o={x:0,y:0};const r=mhe[i.anchor??"middle"];switch(i.orient){case"top":o={x:r,y:1},s={baseline:"alphabetic",angle:0};break;case"right":o={x:1,y:1-r},s={baseline:"alphabetic",angle:90};break;case"bottom":o={x:r,y:0},s={baseline:"top",angle:0};break;case"left":o={x:0,y:r},s={baseline:"alphabetic",angle:-90};break}const a={...HF,...s,...t,...e},l={xOffset:0,yOffset:0};switch(i.orient){case"top":l.yOffset=-a.offset;break;case"right":l.xOffset=a.offset;break;case"bottom":l.yOffset=a.offset;break;case"left":l.xOffset=-a.offset;break}return{configurableVisibility:!1,data:{values:[{}]},mark:{type:"text",tooltip:null,clip:!1,...o,...l,text:a.text,align:a.align??_he[a.anchor],angle:a.angle,baseline:a.baseline,dx:a.dx,dy:a.dy,color:a.color,font:a.font,size:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight}}}var Mh,ed,td;class vhe{constructor(e){ve(this,Mh,void 0);ve(this,ed,0);ve(this,td,0);gt(this,Mh,new Array(e))}push(e){J(this,Mh)[J(this,ed)]=e,gt(this,ed,(J(this,ed)+1)%this.size),gt(this,td,Math.min(J(this,td)+1,this.size))}get(){const e=J(this,Mh);return J(this,td)<this.size?e.slice(0,J(this,td)):e.slice(J(this,ed),this.size).concat(e.slice(0,J(this,ed)))}get size(){return J(this,Mh).length}get length(){return J(this,td)}}Mh=new WeakMap,ed=new WeakMap,td=new WeakMap;let zu,iU=0;function $F(){return performance.now()-iU<50}function yhe(n){return function(...e){iU=performance.now(),n(...e)}}function whe(n,e,t,i,s){if(t=yhe(t),n.type=="wheel"){n.uiEvent.preventDefault();const o=n.uiEvent,r=o.deltaMode?120:1;if(!o.deltaX&&!o.deltaY)return;zu==null||zu.stop();let{x:a,y:l}=n.point;if(i){const c=i.mark.encoders;c.x&&!c.x2&&!c.x.constant&&(a=+c.x(i.datum)*e.width+e.x),c.y&&!c.y2&&!c.y.constant&&(l=(1-+c.y(i.datum))*e.height+e.y)}Math.abs(o.deltaX)<Math.abs(o.deltaY)?t({x:a,y:l,xDelta:0,yDelta:0,zDelta:o.deltaY*r/300}):t({x:a,y:l,xDelta:-o.deltaX*r,yDelta:0,zDelta:0})}else if(n.type=="mousedown"&&n.uiEvent.button===0){zu&&zu.stop();const o=new vhe(30),r=n.uiEvent;r.preventDefault();let a=Ma.fromMouseEvent(r);const l=u=>{const h=Ma.fromMouseEvent(u);o.push({point:h,timestamp:performance.now()});const f=h.subtract(a);t({x:a.x,y:a.y,xDelta:f.x,yDelta:f.y,zDelta:0}),a=h},c=()=>{const h=performance.now(),f=o.get().filter(y=>h-y.timestamp<160);if(f.length<5||!s||Che(f))return;const g=f.at(-1),p=f[0],_=g.point.subtract(p.point).multiply(1/(g.timestamp-p.timestamp));let v=a.x,b=a.y;zu=F4(s,y=>{t({x:y.x,y:y.y,xDelta:v-y.x,yDelta:b-y.y,zDelta:0}),v=y.x,b=y.y},150,.5,{x:v,y:b}),zu({x:a.x-_.x*250,y:a.y-_.y*250})},d=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",d),c()};document.addEventListener("mouseup",d,!1),document.addEventListener("mousemove",l,!1)}}function Che(n){const e=n[Math.floor(n.length/2)],t=e.point.subtract(n[0].point).multiply(e.timestamp-n[0].timestamp),i=n.at(-1).point.subtract(e.point).multiply(n.at(-1).timestamp-e.timestamp),s=t.length,o=i.length,r=.4;return o/s<r}var Up,jp,To,Ph,qp,Pl,Yu,hL,nU,Oh,X0,_1,hI,b1,fI,v1,gI,fL,sU,Gp,bC,gL,oU;class She extends X1{constructor(t,i,s,o,r,a,l){super(t,i,s,o,r,l);ve(this,Pl);ve(this,hL);ve(this,Oh);ve(this,_1);ve(this,b1);ve(this,v1);ve(this,fL);ve(this,Gp);ve(this,gL);ve(this,Up,1/0);ve(this,jp,10);ve(this,To,[]);ve(this,Ph,{});ve(this,qp,0);this.spec=t,gt(this,jp,t.spacing??10),gt(this,Up,a),gt(this,To,[]),this.wrappingFacet=!1}appendChild(t){t.layoutParent??(t.layoutParent=this),J(this,To).push(new jF(t,this,J(this,qp))),y5(this,qp)._++}setChildren(t){gt(this,To,[]);for(const i of t)this.appendChild(i)}replaceChild(t,i){const s=J(this,To).findIndex(o=>o.view==t);if(s>=0)J(this,To)[s]=new jF(i,this,J(this,qp));else throw new Error("Not my child view!")}get children(){return J(this,To).map(t=>t.view)}get childCount(){return J(this,To).length}async createAxes(){const t=[];for(const i of Km){const s=this.resolutions.axis[i];if(s){const o=s.getAxisProps();if(o){const r={title:s.getTitle(),orient:kS[i][0],...o},a=new Q$(r,s.scaleResolution.type,this.context,this,this);t.push(a.initializeChildren()),J(this,Ph)[i]=a}}}return Promise.all([...t,...J(this,To).map(i=>i.createAxes())])}*[Symbol.iterator](){for(const t of J(this,To))yield*t.getChildren();for(const t of Object.values(J(this,Ph)))yield t}getOverhang(){return De(this,fL,sU).call(this).union(De(this,Gp,bC).call(this))}getSize(){return this._cache("size",()=>new Yd(De(this,b1,fI).call(this,"column"),De(this,b1,fI).call(this,"row")).addPadding(De(this,Gp,bC).call(this)))}render(t,i,s={}){if(super.render(t,i,s),!this.isConfiguredVisible())return;this.layoutParent||(i=i.shrink(this.getPadding())),i=i.shrink(De(this,Gp,bC).call(this)),t.pushView(this,i);const o={devicePixelRatio:this.context.devicePixelRatio},r=RF(De(this,_1,hI).call(this,"column"),i.width,o),a=RF(De(this,_1,hI).call(this,"row"),i.height,o),l=new zF(J(this,Pl,Yu).length,J(this,Up)??1/0),c=d=>Math.round(d*devicePixelRatio)/devicePixelRatio;for(const[d,u]of J(this,Pl,Yu).entries()){const{view:h,axes:f,gridLines:g,background:p,backgroundStroke:_,title:v}=u,[b,y]=l.getCellCoords(d),w=r[De(this,v1,gI).call(this,"column",b)],C=a[De(this,v1,gI).call(this,"row",y)],L=h.getViewportSize(),x=h.getSize(),D=h.getOverhang(),k=w.location-D.left,P=C.location-D.top,O=(Lt,Tt)=>(Lt[Tt].grow?(Tt=="width"?w:C).size:Lt[Tt].px)+D[Tt],M=O(L,"width"),R=O(L,"height"),$=O(x,"width"),G=O(x,"height"),ne=u.scrollbars.horizontal,ae=u.scrollbars.vertical,fe=ne?()=>c(ne.viewportOffset):()=>0,oe=ae?()=>c(ae.viewportOffset):()=>0,xe=new ec(()=>i.x+k,()=>i.y+P,()=>M,()=>R),Te=h.isScrollable(),me=Te?new ec(()=>i.x+k-fe(),()=>i.y+P-oe(),()=>$,()=>G):xe;u.coords=xe;const te=s.clipRect?xe.intersect(s.clipRect):xe;p==null||p.render(t,te,{...s,clipRect:void 0});for(const Lt of Object.values(g))Lt.render(t,xe,s);const Yt=khe(h)||Te;Yt&&h.render(t,me,{...s,clipRect:te}),_==null||_.render(t,te,{...s,clipRect:void 0});for(const[Lt,Tt]of Object.entries(f)){const Ge=Lt=="left"||Lt=="right"?"vertical":"horizontal",ii=u.scrollbars[Ge],Ee=ii?xe.modify(Ge=="vertical"?{y:()=>me.y,height:G}:{x:()=>me.x,width:$}):xe,Ve=UF(Ee,Lt,Tt);let ge=s.clipRect;ii&&(ge=Ve.intersect(ge).intersect(ii?xe.modify(Ge=="vertical"?{x:-1e5,width:2e5}:{y:-1e5,height:2e5}):void 0)),Tt.render(t,Ve,{...s,clipRect:ge})}for(const Lt of Object.values(J(this,Ph))){const Ge=Lt.axisProps.orient;(Ge=="left"&&b==0||Ge=="right"&&b==l.nCols-1||Ge=="top"&&y==0||Ge=="bottom"&&y==l.nRows-1)&&Lt.render(t,UF(xe.shrink(u.view.getOverhang()),Ge,Lt),s)}Yt||h.render(t,me,s);for(const Lt of Object.values(u.scrollbars))Lt.updateScrollbar(xe,me),Lt.render(t,i,s);v==null||v.render(t,xe,s)}t.popView(this)}propagateInteractionEvent(t){if(this.handleInteractionEvent(void 0,t,!0),t.stopped)return;const i=J(this,Pl,Yu).find(o=>o.coords.containsPoint(t.point.x,t.point.y));for(const o of Object.values((i==null?void 0:i.scrollbars)??{}))if(o.coords.containsPoint(t.point.x,t.point.y)&&(o.propagateInteractionEvent(t),t.stopped))return;const s=i==null?void 0:i.view;s&&(s.propagateInteractionEvent(t),(s instanceof Oo||s instanceof Q1)&&whe(t,i.coords,o=>De(this,gL,oU).call(this,i.coords,i.view,o),this.context.getCurrentHover(),this.context.animator)),!t.stopped&&this.handleInteractionEvent(void 0,t,!1)}getDefaultResolution(t,i){return"independent"}}Up=new WeakMap,jp=new WeakMap,To=new WeakMap,Ph=new WeakMap,qp=new WeakMap,Pl=new WeakSet,Yu=function(){return J(this,To).filter(t=>t.view.isConfiguredVisible())},hL=new WeakSet,nU=function(){return new zF(J(this,Pl,Yu).length,J(this,Up)??1/0)},Oh=new WeakSet,X0=function(t){const i=t=="column"?"width":"height",s=(o,r)=>o.map(a=>{const c=J(this,Pl,Yu)[a].getOverhangAndPadding();return t=="column"?r?c.right:c.left:r?c.bottom:c.top}).reduce((a,l)=>Math.max(a,l),0);return this._cache(`size/directionSizes/${t}`,()=>J(this,hL,nU)[t=="column"?"colIndices":"rowIndices"].map(o=>({axisBefore:s(o,0),axisAfter:s(o,1),view:ode(o.map(r=>J(this,Pl,Yu)[r].view.getViewportSize()[i]))})))},_1=new WeakSet,hI=function(t){const i=De(this,Oh,X0).call(this,t),s=[];s.push(L_);for(const[o,r]of i.entries())o>0&&s.push({px:J(this,jp),grow:0}),(o==0||this.wrappingFacet)&&s.push(L_),s.push({px:r.axisBefore,grow:0}),s.push(r.view),s.push({px:r.axisAfter,grow:0}),(o==i.length-1||this.wrappingFacet)&&s.push(L_);return s},b1=new WeakSet,fI=function(t){let i=0,s=0;const o=t=="row"?this.spec.height:this.spec.width;if(o||o===0)return R$(o);const r=De(this,Oh,X0).call(this,t);for(const[a,l]of r.entries())a>0&&(s+=J(this,jp)),(a==0||this.wrappingFacet)&&(s+=0),s+=l.axisBefore,s+=l.view.px??0,i+=l.view.grow??0,s+=l.axisAfter,(a==r.length-1||this.wrappingFacet)&&(s+=0);return{px:s,grow:i}},v1=new WeakSet,gI=function(t,i){return t=="row"&&this.wrappingFacet?1+6*i+2:2+4*i+1},fL=new WeakSet,sU=function(){const t=De(this,Oh,X0).call(this,"column"),i=De(this,Oh,X0).call(this,"row");return!t.length||!i.length?ws.zero():new ws(i.at(0).axisBefore,t.at(-1).axisAfter,i.at(-1).axisAfter,t.at(0).axisBefore)},Gp=new WeakSet,bC=function(){const t=i=>{const s=B4[i],o=J(this,Ph)[s];return(o==null?void 0:o.axisProps.orient)!==i?0:Math.max(o.getPerpendicularSize()+o.axisProps.offset,0)};return new ws(t("top"),t("right"),t("bottom"),t("left"))},gL=new WeakSet,oU=function(t,i,s){for(const[o,r]of Object.entries(Dhe(i))){if(r.size<=0)continue;const a=t.normalizePoint(s.x,s.y),l=t.normalizePoint(s.x+s.xDelta,s.y+s.yDelta),c={x:l.x-a.x,y:l.y-a.y};for(const d of r)d.zoom(2**s.zDelta,o=="y"?1-a[o]:a[o],o=="x"?c.x:-c.y)}this.context.animator.requestRender()};function xhe(n){if(!(!n||!n.fill||n.fillOpacity===0))return{configurableVisibility:!1,data:{values:[{}]},mark:{color:n.fill,opacity:n.fillOpacity??1,type:"rect",clip:!1,tooltip:null,minHeight:1,minOpacity:0}}}function Lhe(n){if(!(!n||!n.stroke||n.strokeWidth===0||n.strokeOpacity===0))return{configurableVisibility:!1,resolve:{scale:{x:"excluded",y:"excluded"},axis:{x:"excluded",y:"excluded"}},data:{values:[{x:0,y:0,x2:1,y2:0},{x:1,y:0,x2:1,y2:1},{x:1,y:1,x2:0,y2:1},{x:0,y:1,x2:0,y2:0}]},mark:{size:n.strokeWidth??1,color:n.stroke??"lightgray",strokeCap:"square",opacity:n.strokeOpacity??1,type:"rule",clip:!1,tooltip:null},encoding:{x:{field:"x",type:"quantitative",scale:null},y:{field:"y",type:"quantitative",scale:null},x2:{field:"x2"},y2:{field:"y2"}}}}function Dhe(n){const e={x:new Set,y:new Set};return n.visit(t=>{for(const[i,s]of Object.entries(e)){const o=t.getScaleResolution(i);o&&o.isZoomable()&&s.add(o)}}),e}function khe(n){let e=!0;return n.visit(t=>{t instanceof Oo&&e&&(e=t.mark.properties.clip===!0)}),e}function UF(n,e,t){const i=t.axisProps,s=t.getPerpendicularSize();if(e=="bottom")return n.translate(0,n.height+i.offset).modify({height:s});if(e=="top")return n.translate(0,-s-i.offset).modify({height:s});if(e=="left")return n.translate(-s-i.offset,0).modify({width:s});if(e=="right")return n.translate(n.width+i.offset,0).modify({width:s})}class jF{constructor(e,t,i){if(this.layoutParent=t,this.view=e,this.serial=i,this.background=void 0,this.backgroundStroke=void 0,this.axes={},this.gridLines={},this.scrollbars={},this.title=void 0,this.coords=ec.ZERO,e.needsAxes.x||e.needsAxes.y){const s=e.spec,o="view"in s?s==null?void 0:s.view:void 0,r=xhe(o);r&&(this.background=new Oo(r,t.context,t,e,"background"+i,{blockEncodingInheritance:!0}));const a=Lhe(o);a&&(this.backgroundStroke=new Oo(a,t.context,t,e,"backgroundStroke"+i,{blockEncodingInheritance:!0}));const l=bhe(e.spec.title);if(l){const c=new Oo(l,t.context,t,e,"title"+i,{blockEncodingInheritance:!0});this.title=c}}e.spec.viewportWidth!=null&&(this.scrollbars.horizontal=new qF(this,"horizontal")),e.spec.viewportHeight!=null&&(this.scrollbars.vertical=new qF(this,"vertical"))}*getChildren(){this.background&&(yield this.background),this.backgroundStroke&&(yield this.backgroundStroke),this.title&&(yield this.title),yield*Object.values(this.axes),yield*Object.values(this.gridLines),yield this.view,yield*Object.values(this.scrollbars)}async createAxes(){const{view:e,axes:t,gridLines:i}=this,s=(a,l)=>{const c=a.getAxisProps();if(c===null)return;const d=c?{...c}:{};if(!d.orient){for(const u of kS[l])if(!t[u]){d.orient=u;break}if(!d.orient)throw new Error("No slots available for an axis! Perhaps a LayerView has more than two children?")}if(d.title??(d.title=a.getTitle()),!kS[l].includes(d.orient))throw new Error(`Invalid axis orientation "${d.orient}" on channel "${l}"!`);return d},o=async(a,l,c)=>{const d=s(a,l);if(d){if(t[d.orient])throw new Error(`An axis with the orient "${d.orient}" already exists!`);const u=new Q$(d,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c);t[d.orient]=u,await u.initializeChildren()}},r=async(a,l,c)=>{const d=s(a,l);if(d&&(d.grid||d.chromGrid)){const u=new lhe(d,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c);i[d.orient]=u,await u.initializeChildren()}};for(const a of["x","y"])if(e.needsAxes[a]){const l=e.resolutions.axis[a];if(!l)continue;await o(l,a,e)}for(const a of["x","y"])if(e.needsAxes[a]){const l=e.getAxisResolution(a);if(!l)continue;await r(l,a,e)}if(e instanceof Q1){for(const a of e)for(const[l,c]of Object.entries(a.resolutions.axis)){const d=c.getAxisProps();d&&d.orient&&await o(c,l,a)}for(const a of e)for(const[l,c]of Object.entries(a.resolutions.axis)){const d=c.getAxisProps();d&&!d.orient&&await o(c,l,a)}}[...Object.values(t),...Object.values(i)].forEach(a=>a.visit(l=>{l instanceof Oo&&l.resolve("scale")}))}getOverhang(){const e=t=>{const i=this.axes[t];return i?Math.max(i.getPerpendicularSize()+i.axisProps.offset,0):0};return new ws(e("top"),e("right"),e("bottom"),e("left")).add(this.view.getOverhang())}getOverhangAndPadding(){return this.getOverhang().add(this.view.getPadding())}}var Kp,y1,id,Fh;class qF extends Oo{constructor(t,i){const s={scrollbarSize:8,scrollbarPadding:2};super({data:{values:[{}]},mark:{type:"rect",fill:"#b0b0b0",fillOpacity:.6,stroke:"white",strokeWidth:1,strokeOpacity:1,cornerRadius:5,clip:!1},configurableVisibility:!1},t.layoutParent.context,t.layoutParent,t.view,"scrollbar-"+i,{blockEncodingInheritance:!0});ve(this,Kp,void 0);ve(this,y1,ec.ZERO);ve(this,id,0);ve(this,Fh,0);Ui(this,"viewportOffset",0);this.config=s,gt(this,Kp,i),this.interpolateViewportOffset=F4(this.context.animator,o=>{this.viewportOffset=o.x},50,.4,{x:this.viewportOffset}),this.addInteractionEventListener("mousedown",(o,r)=>{if(r.stopPropagation(),J(this,id)<=0)return;const a=f=>i=="vertical"?f.clientY:f.clientX,l=r.uiEvent;l.preventDefault();const c=this.scrollOffset,d=a(l),u=f=>{const g=cm(a(f)-d+c,0,J(this,id));this.interpolateViewportOffset({x:g/J(this,id)*J(this,Fh)})},h=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",h)};document.addEventListener("mouseup",h,!1),document.addEventListener("mousemove",u,!1)})}get scrollOffset(){return this.viewportOffset/J(this,Fh)*J(this,id)}render(t,i,s){super.render(t,J(this,y1),s)}updateScrollbar(t,i){const s=this.config.scrollbarPadding,o=this.config.scrollbarSize,r=J(this,Kp)=="horizontal"?"width":"height",a=Math.min(1,t[r]/i[r]),l=t[r]-2*s,c=a*l;gt(this,id,l-c),gt(this,Fh,i[r]-t[r]),this.viewportOffset=cm(this.viewportOffset,0,J(this,Fh)),gt(this,y1,J(this,Kp)=="vertical"?new ec(()=>t.x+t.width-o-s,()=>t.y+s+this.scrollOffset,()=>o,()=>c):new ec(()=>t.x+s+this.scrollOffset,()=>t.y+t.height-o-s,()=>c,()=>o))}}Kp=new WeakMap,y1=new WeakMap,id=new WeakMap,Fh=new WeakMap;class m2 extends She{constructor(e,t,i,s,o){super(e,t,i,s,o,_I(e)?e.columns:vC(e)?1:1/0),this.spec=e}async initializeChildren(){const e=this.spec,t=_I(e)?e.concat:vC(e)?e.vconcat:e.hconcat;this.setChildren(await Promise.all(t.map((i,s)=>this.context.createOrImportView(i,this,this,"grid"+s)))),await this.createAxes()}getDefaultResolution(e,t){return t=="axis"?"independent":vC(this.spec)&&e==="x"||lU(this.spec)&&e==="y"?"shared":"independent"}}const rU="viewRoot";var Yp;class Ehe{constructor(e={}){ve(this,Yp,new Map);this.options={allowImport:!0,wrapRoot:!0,...e};const t=i=>(s,o,r,a,l)=>new i(s,o,r,a,s.name??l);this.addViewType(mI,t(Q1)),this.addViewType(pI,t(Oo)),this.addViewType(vC,t(m2)),this.addViewType(lU,t(m2)),this.addViewType(_I,t(m2)),this.addViewType(The,()=>{throw new Error("SampleView is not supported by the @genome-spy/core package. Use @genome-spy/app instead!")})}addViewType(e,t){J(this,Yp).set(e,t)}createView(e,t,i,s,o){for(const[r,a]of J(this,Yp))if(r(e))return a(e,t,i,s,o);throw new Error("Invalid spec, cannot figure out the view type from the properties: "+JSON.stringify([...Object.keys(e)]))}isViewSpec(e){const t=[...J(this,Yp).keys()].filter(i=>i(e));if(t.length>1)throw new Error("Ambiguous spec. Cannot create a view!");return t.length==1}async createOrImportView(e,t,i,s,o,r){let a;if(Ihe(e)){let c;if("url"in e.import)if(this.options.allowImport)c=await Mue(e,s.getBaseUrl(),t);else throw new zh("Importing views is not allowed!",i);else if("template"in e.import)c=aU(e.import.template,s);else throw new Error("Invalid import: "+JSON.stringify(e));r==null||r(c),Ahe(c,e),a=c}else a=e;!s&&this.options.wrapRoot&&(pI(a)||mI(a))&&o===rU&&(a={name:"implicitRoot",vconcat:[a]});const l=this.createView(a,t,i,s,o);return l instanceof X1&&await l.initializeChildren(),l}}Yp=new WeakMap;function aU(n,e){var i,s;const t=(s=(i=e.spec)==null?void 0:i.templates)==null?void 0:s[n];if(t)return structuredClone(t);if(e.dataParent)return aU(n,e.dataParent);throw new Error(`Cannot find template "${n}" in current view or its ancestors!`)}function Ahe(n,e){e.name!=null&&(n.name=e.name);const t=Rs(e.params)?e.params:Ms(e.params)?Object.entries(e.params).map(([i,s])=>({name:i,value:s})):[];if(t.length){n.params??(n.params=[]);for(const i of t){const s=n.params.findIndex(o=>o.name==i.name);s>=0&&(n.params[s]=i)}for(const i of t)n.params.some(s=>s.name==i.name)||n.params.push(i)}}function pI(n){return"mark"in n&&(ci(n.mark)||Ms(n.mark))}function mI(n){return"layer"in n&&Ms(n.layer)}function Ihe(n){return"import"in n}function vC(n){return"vconcat"in n&&Rs(n.vconcat)}function lU(n){return"hconcat"in n&&Rs(n.hconcat)}function _I(n){return"concat"in n&&Rs(n.concat)}function The(n){return"samples"in n&&Ms(n.samples)&&"spec"in n&&Ms(n.spec)}function Nhe(n){const e=Math.floor(Math.random()*16777215).toString(16),t=[];for(const i of n.paramConfigs.values()){if(!$ae(i))continue;const s=i.bind;if(!s||!("input"in s))continue;const o=i.name,r=n.getSetter(o),a=n.getValue(o),l=s.name??o,c=s.debounce?Ib(r,s.debounce,!1):r,d=`${e}-param-${o}`;if(s.input=="range")t.push(At`<label for=${d}>${l}</label>
                    <div>
                        <input
                            id=${d}
                            type="range"
                            min=${s.min??0}
                            max=${s.max??100}
                            step=${s.step??Vd(s.min,s.max,100)}
                            .value=${a}
                            @input=${u=>{c(u.target.valueAsNumber),u.target.nextElementSibling.textContent=u.target.valueAsNumber}}
                        /><span>${a}</span>
                    </div>`);else if(s.input=="checkbox")t.push(At`<label for=${d}>${l}</label>
                    <input
                        id=${d}
                        type="checkbox"
                        ?checked=${a}
                        @input=${u=>c(u.target.checked)}
                    />`);else if(s.input=="radio")t.push(At`<span class="label">${l}</span>
                    <div class="radio-group">
                        ${s.options.map((u,h)=>{var f;return At`<label>
                                <input
                                    type="radio"
                                    name=${o}
                                    value=${u}
                                    .checked=${a==u}
                                    @input=${g=>c(g.target.value)}
                                />${((f=s.labels)==null?void 0:f[h])??u}</label
                            >`})}
                    </div>`);else if(s.input=="select")t.push(At`<label for=${d}>${l}</label>
                    <select
                        id=${d}
                        @input=${u=>c(u.target.value)}
                    >
                        ${s.options.map((u,h)=>{var f;return At`<option
                                value=${u}
                                ?selected=${a==u}
                            >
                                ${((f=s.labels)==null?void 0:f[h])??u}
                            </option>`})}
                    </select> `);else if(s.input=="text"||s.input=="number"||s.input=="color")t.push(At`<label for=${d}>${l}</label>
                    <div>
                        <input
                            id=${d}
                            type=${s.input}
                            placeholder=${s.placeholder??""}
                            autocomplete=${s.autocomplete??"off"}
                            .value=${a}
                            @focus=${u=>u.target.select()}
                            @input=${u=>{c(s.input=="number"?u.target.valueAsNumber:u.target.value)}}
                        />
                    </div>`);else throw new Error("Unsupported input type: "+s.input);s.description&&t.push(At`<div class="description">${s.description}</div>`)}return t}NV("fasta",Gue);var Zp,yC,pL,cU,mL,dU,_L,uU;class Rhe{constructor(e,t,i={}){ve(this,Zp);ve(this,pL);ve(this,mL);ve(this,_L);this.container=e,this.options=i,i.inputBindingContainer??(i.inputBindingContainer="default"),this._destructionCallbacks=[],this.spec=t,this.viewFactory=new Ehe,this.namedDataProviders=[],this.animator=new Vue(()=>this.renderAll()),this.genomeStore=void 0,this.viewVisibilityPredicate=s=>s.isVisibleInSpec(),this._renderingContext=void 0,this._pickingContext=void 0,this._dirtyPickingBuffer=!1,this._currentHover=void 0,this._wheelInertia=new Kue(this.animator),this._keyboardListeners=new Map,this._eventListeners=new Map,this._extraBroadcastListeners=new Map,this.tooltipHandlers={default:ihe,refseqgene:Zue,...i.tooltipHandlers??{}},this.viewRoot=void 0,this._loadingViews=new Map,this._inputBindingContainer=void 0,this._mouseDownCoords=void 0}registerNamedDataProvider(e){this.namedDataProviders.unshift(e)}getNamedDataFromProvider(e){for(const t of this.namedDataProviders){const i=t(e);if(i)return i}}updateNamedData(e,t){const i=this.viewRoot.context.dataFlow.findNamedDataSource(e);if(!i)throw new Error("No such named data source: "+e);i.dataSource.updateDynamicData(t),tI(i.hosts),this.animator.requestRender()}broadcast(e,t){var s;const i={type:e,payload:t};this.viewRoot.visit(o=>o.handleBroadcast(i)),(s=this._extraBroadcastListeners.get(e))==null||s.forEach(o=>o(i))}_updateLoadingIndicators(){const e=[],t=()=>[...this._loadingViews.values()].some(i=>i.status=="loading"||i.status=="error");for(const[i,s]of this._loadingViews){const o=i.coords;if(o){const r={left:`${o.x}px`,top:`${o.y}px`,width:`${o.width}px`,height:`${o.height}px`};e.push(At`<div style=${lte(r)}>
                        <div class=${s.status}>
                            ${s.status=="error"?At`<span
                                      >Loading
                                      failed${s.detail?At`: ${s.detail}`:Vi}</span
                                  >`:At`
                                      <img src="${cte}" alt="" />
                                      <span>Loading...</span>
                                  `}
                        </div>
                    </div>`)}}t()?this.loadingIndicatorsElement.style.display="block":setTimeout(()=>{t()||(this.loadingIndicatorsElement.style.display="none")},3e3),Qp(e,this.loadingIndicatorsElement)}destroy(){var t;const e=J(this,Zp,yC);this.container.classList.remove("genome-spy"),e.classList.remove("loading");for(const[i,s]of this._keyboardListeners)for(const o of s)document.removeEventListener(i,o);for(this._destructionCallbacks.forEach(i=>i()),this._glHelper.finalize(),(t=this._inputBindingContainer)==null||t.remove();this.container.firstChild;)this.container.firstChild.remove()}async _prepareViewsAndData(){this.spec.genome&&(this.genomeStore=new zue(this.spec.baseUrl),await this.genomeStore.initialize(this.spec.genome));const e=this,t={dataFlow:new G$,glHelper:this._glHelper,animator:this.animator,genomeStore:this.genomeStore,fontManager:new Uue(this._glHelper),get devicePixelRatio(){return e._glHelper.dpr},requestLayoutReflow:()=>{},updateTooltip:this.updateTooltip.bind(this),getNamedDataFromProvider:this.getNamedDataFromProvider.bind(this),getCurrentHover:()=>this._currentHover,setDataLoadingStatus:(l,c,d)=>{this._loadingViews.set(l,{status:c,detail:d}),this._updateLoadingIndicators()},addKeyboardListener:(l,c)=>{document.addEventListener(l,c);let d=this._keyboardListeners.get(l);d||(d=[],this._keyboardListeners.set(l,d)),d.push(c)},addBroadcastListener(l,c){const d=e._extraBroadcastListeners;let u=d.get(l);u||(u=new Set,d.set(l,u)),u.add(c)},removeBroadcastListener(l,c){var u;(u=e._extraBroadcastListeners.get(l))==null||u.delete(c)},isViewConfiguredVisible:e.viewVisibilityPredicate,isViewSpec:l=>e.viewFactory.isViewSpec(l),createView:function(l,c,d,u){return e.viewFactory.createView(l,t,c,d,u)},createOrImportView:async function(l,c,d,u,h){return e.viewFactory.createOrImportView(l,t,c,d,u,h)}},i=this.spec;i.datasets&&this.registerNamedDataProvider(l=>i.datasets[l]),this.viewRoot=await t.createOrImportView(i,null,null,rU),J(this,Zp,yC).style.flexGrow=this.viewRoot.getSize().height.grow>0?"1":"0",De(this,pL,cU).call(this),Nue(this.viewRoot),Rue(this.viewRoot);const s=this.viewRoot.getDescendants();s.forEach(l=>l.configureViewOpacity()),this._glHelper.invalidateSize(),De(this,mL,dU).call(this);const o=s.filter(l=>l instanceof Oo),r=Due(this.viewRoot,t.dataFlow);Tue(r),this.broadcast("dataFlowBuilt",r),o.forEach(l=>l.mark.initializeEncoders());const a=Promise.all(o.map(l=>l.mark.initializeGraphics()));for(const l of o)r.addObserver(c=>{l.mark.initializeData(),l.mark.updateGraphicsData(),t.animator.requestRender()},l);await t.fontManager.waitUntilReady(),r.initialize(),await Promise.all(r.dataSources.map(l=>l.load())),tI(this.viewRoot),this.broadcast("dataLoaded"),await a;for(const l of o)l.mark.finalizeGraphicsInitialization();t.requestLayoutReflow=this.computeLayout.bind(this),this.viewRoot.visit(l=>mC(l,"size")),this._glHelper.invalidateSize()}async launch(){try{return De(this,_L,uU).call(this),await this._prepareViewsAndData(),this.registerMouseEvents(),this.computeLayout(),this.animator.requestRender(),!0}catch(e){const t=`${e.view?`At "${e.view.getPathString()}": `:""}${e.toString()}`;return console.error(e.stack),Mhe(this.container,t),!1}finally{J(this,Zp,yC).classList.remove("loading"),window.setTimeout(()=>{this.loadingMessageElement.style.display="none"},2e3)}}registerMouseEvents(){const e=this._glHelper.canvas;let t=performance.now();const i=s=>{var a,l;const o=performance.now(),r=o-t<200;if(s instanceof MouseEvent){const c=e.getBoundingClientRect(),d=new Ma(s.clientX-c.left-e.clientLeft,s.clientY-c.top-e.clientTop);s.type=="mousemove"&&!r&&(this.tooltip.handleMouseMove(s),this._tooltipUpdateRequested=!1,s.buttons==0&&!$F()&&(this.renderPickingFramebuffer(),this._handlePicking(d.x,d.y)));const u=h=>{this.viewRoot.propagateInteractionEvent(new Fue(d,h)),this._tooltipUpdateRequested||this.tooltip.clear()};if(s.type!="wheel"&&this._wheelInertia.cancel(),(s.type=="mousedown"||s.type=="mouseup")&&!$F())this.renderPickingFramebuffer();else if(s.type=="wheel"){t=o,this._tooltipUpdateRequested=!1;const h=s;if(Math.abs(h.deltaX)>Math.abs(h.deltaY))this._currentHover=null,this._wheelInertia.cancel();else{const f=Yue(h);this._wheelInertia.setMomentum(h.deltaY*(h.deltaMode?80:1),g=>{const p=new WheelEvent("wheel",{...f,deltaMode:0,deltaX:0,deltaY:g});u(p)}),h.preventDefault();return}}if(s.type=="click"){const h=this._currentHover?{type:s.type,viewPath:this._currentHover.mark.unitView.getLayoutAncestors().map(f=>f.name).reverse(),datum:this._currentHover.datum}:{type:s.type,viewPath:null,datum:null};(a=this._eventListeners.get("click"))==null||a.forEach(f=>f(h))}(s.type!="click"||((l=this._mouseDownCoords)==null?void 0:l.subtract(Ma.fromMouseEvent(s)).length)<3)&&u(s)}};["mousedown","mouseup","wheel","click","mousemove","gesturechange","contextmenu"].forEach(s=>e.addEventListener(s,i)),e.addEventListener("mousedown",s=>{this._mouseDownCoords=Ma.fromMouseEvent(s),document.addEventListener("mouseup",()=>this.tooltip.popEnabledState(),{once:!0}),this.tooltip.pushEnabledState(!1)}),e.addEventListener("dragstart",s=>s.stopPropagation())}_handlePicking(e,t){var o;const i=this._glHelper.readPickingPixel(e,t),s=i[0]|i[1]<<8|i[2]<<16|i[3]<<24;if(s==0){this._currentHover=null;return}if(s!==((o=this._currentHover)==null?void 0:o.uniqueId)&&(this._currentHover=null),this._currentHover||this.viewRoot.visit(r=>{if(r instanceof Oo){if(r.mark.isPickingParticipant()&&[...r.facetCoords.values()].some(a=>a.containsPoint(e,t))){const a=r.getCollector().findDatumByUniqueId(s);a&&(this._currentHover={mark:r.mark,datum:a,uniqueId:s})}if(this._currentHover)return D_}}),this._currentHover){const r=this._currentHover.mark;this.updateTooltip(this._currentHover.datum,async a=>{if(!r.isPickingParticipant())return;const l=r.properties.tooltip;if(l!==null){const c=(l==null?void 0:l.handler)??"default",d=this.tooltipHandlers[c];if(!d)throw new Error("No such tooltip handler: "+c);return d(a,r,l==null?void 0:l.params)}})}}updateTooltip(e,t){if(!this._tooltipUpdateRequested||!e)this.tooltip.updateWithDatum(e,t),this._tooltipUpdateRequested=!0;else throw new Error("Tooltip has already been updated! Duplicate event handler?")}computeLayout(){const e=this.viewRoot;if(!e)return;this.broadcast("layout");const t=this._glHelper.getLogicalCanvasSize();if(isNaN(t.width)||isNaN(t.height)){console.log(`NaN in canvas size: ${t.width}x${t.height}. Skipping computeLayout().`);return}this._renderingContext=new BF({picking:!1},this._glHelper),this._pickingContext=new BF({picking:!0},this._glHelper),e.render(new Oue(this._renderingContext,this._pickingContext),ec.create(0,0,t.width,t.height)),this._updateLoadingIndicators(),this.broadcast("layoutComputed")}renderAll(){var e;(e=this._renderingContext)==null||e.render(),this._dirtyPickingBuffer=!0}renderPickingFramebuffer(){this._dirtyPickingBuffer&&(this._pickingContext.render(),this._dirtyPickingBuffer=!1)}getSearchableViews(){const e=[];return this.viewRoot.visit(t=>{t instanceof Oo&&t.getDataAccessor("search")&&e.push(t)}),e}getNamedScaleResolutions(){const e=new Map;return this.viewRoot.visit(t=>{for(const i of Object.values(t.resolutions.scale))i.name&&e.set(i.name,i)}),e}}Zp=new WeakSet,yC=function(){return this.container.querySelector(".canvas-wrapper")},pL=new WeakSet,cU=function(){const e=[];this.viewRoot.visit(i=>{const s=i.paramMediator;e.push(...Nhe(s))});const t=this.options.inputBindingContainer;if(!(!t||t=="none"||!e.length)){if(this._inputBindingContainer=Jy("div",{className:"gs-input-bindings"}),t=="default")this.container.appendChild(this._inputBindingContainer);else if(t instanceof HTMLElement)t.appendChild(this._inputBindingContainer);else throw new Error("Invalid inputBindingContainer");e.length&&Qp(At`<div class="gs-input-binding">${e}</div>`,this._inputBindingContainer)}},mL=new WeakSet,dU=function(){const e=this.viewRoot.paramMediator.allocateSetter("devicePixelRatio",window.devicePixelRatio),t=()=>{this._glHelper.invalidateSize(),e(window.devicePixelRatio),this.computeLayout(),this.renderAll()};if(this.viewRoot.getSize().isGrowing()){const o=new ResizeObserver(t);o.observe(this.container),this._destructionCallbacks.push(()=>o.disconnect())}let i=null;const s=()=>{i!=null&&(i(),t());const o=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);o.addEventListener("change",s),i=()=>{o.removeEventListener("change",s)}};s(),i&&this._destructionCallbacks.push(i)},_L=new WeakSet,uU=function(){this.container.classList.add("genome-spy");const e=document.createElement("style");e.innerHTML=dte,this.container.appendChild(e);const t=Jy("div",{class:"canvas-wrapper"});this.container.appendChild(t),t.classList.add("loading"),this._glHelper=new Fle(t,()=>this.viewRoot?Pue(this.viewRoot):{width:void 0,height:void 0},this.spec.background,{powerPreference:this.options.powerPreference??"default"}),this.loadingMessageElement=Jy("div",{class:"loading-message",innerHTML:'<div class="message">Loading<span class="ellipsis">...</span></div>'}),t.appendChild(this.loadingMessageElement),this.loadingIndicatorsElement=Jy("div",{class:"loading-indicators"}),t.appendChild(this.loadingIndicatorsElement),this.tooltip=new hte(this.container),this.loadingMessageElement.querySelector(".message").addEventListener("transitionend",()=>{this.loadingMessageElement.style.display="none"})};function Mhe(n,e){const t=document.createElement("div");t.className="message-box";const i=document.createElement("div");i.textContent=e,t.appendChild(i),n.appendChild(t)}function Jy(n,e){const t=document.createElement(n);for(const[i,s]of Object.entries(e))["innerHTML","innerText","className"].includes(i)&&(t[i]=s),t.setAttribute(i,s);return t}const Phe="data:image/svg+xml,%3csvg%20viewBox='0%200%2032%2032'%20xmlns='http://www.w3.org/2000/svg'%20fill-rule='evenodd'%20clip-rule='evenodd'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-miterlimit='1.5'%3e%3cpath%20d='M4.7%2021.2s.4%202.3%201.3%203.6C7%2026%209.8%2028%209.8%2028s3.4-2.6%206.4-8.5c0%200%201%20.1%201.9-.4.9-.6.8-.4%201-1.2%200%200%202.9.5%206.6%200%202.1-.3%204.3-1%206.2-2.5%200%200-1.1-1.7-2.5-5.1-.5-1.3-2-1.8-4.6-4.6l-8.2%208.6-11.9%206.9z'%20fill-opacity='.1'/%3e%3cpath%20d='M12.7%2014.8s-4-1.8-12%202.7c0%200%201%203.7%202.5%205.3%201.4%201.5%202.3%203.6%204.6%204.6%200%200%204.7-3%206.9-9.2l3-2s4.7%202.8%2012.6-1.6c0%200-.6-3.3-3-6-2.6-3-3.8-4.7-3.8-4.7s-4.1%202.3-7.5%209.3l-3.3%201.6z'%20fill='%237fbbdd'/%3e%3cpath%20d='M12.4%2015.5c-.7-.5-2.4-.8-4.4-.4-2%20.4-4%201.3-4.8%201.8-.5.3-1.2%201-1.2%201.4%200%20.7.3%201.8.8%202.4.3.3.7.5%201.4.6.8%200%202.5-1.4%203.5-2%201-.6%201.6-.8%202.7-1.2l-2.9%202.4c-1.3%201.2-2.2%201.5-2.4%202.3%200%20.5%200%201.4.5%201.8.4.5.6.8%201.6.8.6%200%201%200%202.6-1.5.9-.9%202.3-3%202.7-3.7.6-1.1%201-2.2.7-3-.2-1-.4-1.4-.8-1.7zM17.4%2014.2c-.3-.5-.9-1.2-.2-2.5l1.9-3c.5-.8%202-2.3%202.6-2.6.6-.4%201.5-.6%202-.2.6.4%201%201%201.3%201.5.4.6.7%201.3.2%202-.7%201-1.6.9-2.8%201.7-1.2.8-1.9%201.2-2.5%201.9l3.8-1.8c1.3-.6%202.7-1.1%203.4-.7.8.5.8.7%201%201.4.3%201-.2%201.9-.8%202.4-.5.6-1.5.9-2.6%201.2-1.4.4-4.5%201-5.8.5-1.3-.5-1.3-1.4-1.5-1.8z'%20fill='%23fff'/%3e%3cpath%20d='M12.7%2014.8s-4-1.8-12%202.7c0%200%201%203.7%202.5%205.3%201.4%201.5%202.3%203.6%204.6%204.6%200%200%204.7-3%206.9-9.2l3-2s4.7%202.8%2012.6-1.6c0%200-.6-3.3-3-6-2.6-3-3.8-4.7-3.8-4.7s-4.1%202.3-7.5%209.3l-3.3%201.6z'%20fill='none'%20stroke='%23000'%20stroke-width='.5'/%3e%3cpath%20d='M12.4%2014.9s2.1-2%203-2c1.1%200%202.3%202.7%202.3%203.5%200%20.8-2.1%202.4-3.1%202.3%200%200%200-1.2-.7-2.6-.8-1.3-1.5-1.2-1.5-1.2z'%20fill='%237fbbdd'/%3e%3cpath%20d='M13.8%2015.3c.9.8.6%202%201.4%201.8%201-.2%201.4-.8%201.3-1.5%200-.7%200-.8-.4-1.6-.3-.7-1-1.1-2-.5-.7.5-1.4%201.3-1.4%201.3s.2-.3%201.1.5z'%20fill='%23fff'/%3e%3cpath%20d='M12.4%2014.9s2.1-2%203-2c1.1%200%202.3%202.7%202.3%203.5%200%20.8-2.1%202.4-3.1%202.3%200%200%200-1.2-.7-2.6-.8-1.3-1.5-1.2-1.5-1.2z'%20fill='none'%20stroke='%23000'%20stroke-width='.5'/%3e%3c/svg%3e";async function Ohe(n,e,t={}){let i;if(ci(n)){if(i=document.querySelector(n),!i)throw new Error(`No such element: ${n}`)}else if(n instanceof HTMLElement)i=n;else throw new Error(`Invalid element: ${n}`);let s;try{const o=Ms(e)?e:await Bhe(e);if(o.baseUrl??(o.baseUrl=""),o.width??(o.width="container"),o.padding??(o.padding=10),i==document.body){const r=document.createElement("div");r.style.position="fixed",r.style.inset="0",r.style.overflow="hidden",i.appendChild(r),i=r}s=new Rhe(i,o,t),Fhe(s,t),await s.launch()}catch(o){i.innerText=o.toString(),console.error(o)}return{finalize(){for(s.destroy();i.firstChild;)i.firstChild.remove()},addEventListener(o,r){const a=s._eventListeners;let l=a.get(o);l||(l=new Set,a.set(o,l)),l.add(r)},removeEventListener(o,r){var l;(l=s._eventListeners.get(o))==null||l.delete(r)},getScaleResolutionByName(o){return s.getNamedScaleResolutions().get(o)},updateNamedData:s.updateNamedData.bind(s)}}function Fhe(n,e){e.namedDataProvider&&n.registerNamedDataProvider(e.namedDataProvider)}async function Bhe(n){let e;try{const t=await fetch(n);if(!t.ok)throw new Error(`${t.status} ${t.statusText}`);e=await t.json()}catch(t){throw new Error(`Could not load or parse configuration: ${n}, reason: ${t.message}`)}if(!e.baseUrl){const t=n.match(/^[^?#]*\//);e.baseUrl=t&&t[0]||"./"}return e}const Whe=`{
  "data": {
    "sequence": { "start": 0, "stop": 60, "as": "x" }
  },
  "transform": [
    {
      "type": "formula",
      "expr": "sin((datum.x - 30) / 4) + (datum.x - 30) / 30",
      "as": "y"
    }
  ],
  "mark": "rect",
  "encoding": {
    "x": { "field": "x", "type": "index", "scale": { "padding": 0.1 } },
    "y": { "field": "y", "type": "quantitative" },
    "y2": { "datum": 0 },
    "color": {
      "field": "y",
      "type": "quantitative",
      "scale": {
        "type": "threshold",
        "domain": [0],
        "range": ["#ed553b", "#20639b"]
      }
    }
  }
}
`;function ko(n,e=0){return n[n.length-(1+e)]}function Vhe(n){if(n.length===0)throw new Error("Invalid tail call");return[n.slice(0,n.length-1),n[n.length-1]]}function Ki(n,e,t=(i,s)=>i===s){if(n===e)return!0;if(!n||!e||n.length!==e.length)return!1;for(let i=0,s=n.length;i<s;i++)if(!t(n[i],e[i]))return!1;return!0}function zhe(n,e){const t=n.length-1;e<t&&(n[e]=n[t]),n.pop()}function hU(n,e,t){return Hhe(n.length,i=>t(n[i],e))}function Hhe(n,e){let t=0,i=n-1;for(;t<=i;){const s=(t+i)/2|0,o=e(s);if(o<0)t=s+1;else if(o>0)i=s-1;else return s}return-(t+1)}function*fU(n,e){let t,i;for(const s of n)i!==void 0&&e(i,s)?t.push(s):(t&&(yield t),t=[s]),i=s;t&&(yield t)}function gU(n,e){for(let t=0;t<=n.length;t++)e(t===0?void 0:n[t-1],t===n.length?void 0:n[t])}function $he(n,e){for(let t=0;t<n.length;t++)e(t===0?void 0:n[t-1],n[t],t+1===n.length?void 0:n[t+1])}function cD(n){return n.filter(e=>!!e)}function GF(n){let e=0;for(let t=0;t<n.length;t++)n[t]&&(n[e]=n[t],e+=1);n.length=e}function Uhe(n){return!Array.isArray(n)||n.length===0}function tc(n){return Array.isArray(n)&&n.length>0}function uf(n,e=t=>t){const t=new Set;return n.filter(i=>{const s=e(i);return t.has(s)?!1:(t.add(s),!0)})}function pU(n,e){return n.length>0?n[0]:e}function es(n,e){let t=typeof e=="number"?n:0;typeof e=="number"?t=n:(t=0,e=n);const i=[];if(t<=e)for(let s=t;s<e;s++)i.push(s);else for(let s=t;s>e;s--)i.push(s);return i}function dD(n,e,t){const i=n.slice(0,e),s=n.slice(e);return i.concat(t,s)}function _2(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.unshift(e))}function ew(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.push(e))}function bI(n,e){for(const t of e)n.push(t)}function mU(n){return Array.isArray(n)?n:[n]}function jhe(n,e,t){const i=_U(n,e),s=n.length,o=t.length;n.length=s+o;for(let r=s-1;r>=i;r--)n[r+o]=n[r];for(let r=0;r<o;r++)n[r+i]=t[r]}function KF(n,e,t,i){const s=_U(n,e);let o=n.splice(s,t);return o===void 0&&(o=[]),jhe(n,s,i),o}function _U(n,e){return e<0?Math.max(e+n.length,0):Math.min(e,n.length)}var Tb;(function(n){function e(o){return o<0}n.isLessThan=e;function t(o){return o<=0}n.isLessThanOrEqual=t;function i(o){return o>0}n.isGreaterThan=i;function s(o){return o===0}n.isNeitherLessOrGreaterThan=s,n.greaterThan=1,n.lessThan=-1,n.neitherLessOrGreaterThan=0})(Tb||(Tb={}));function ur(n,e){return(t,i)=>e(n(t),n(i))}function qhe(...n){return(e,t)=>{for(const i of n){const s=i(e,t);if(!Tb.isNeitherLessOrGreaterThan(s))return s}return Tb.neitherLessOrGreaterThan}}const wd=(n,e)=>n-e,Ghe=(n,e)=>wd(n?1:0,e?1:0);function bU(n){return(e,t)=>-n(e,t)}class gc{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}class qa{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new qa(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new qa(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(s=>((i||Tb.isGreaterThan(e(s,t)))&&(i=!1,t=s),!0)),t}}qa.empty=new qa(n=>{});function Ns(n){return typeof n=="string"}function Ls(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function Khe(n){const e=Object.getPrototypeOf(Uint8Array);return typeof n=="object"&&n instanceof e}function Xd(n){return typeof n=="number"&&!isNaN(n)}function YF(n){return!!n&&typeof n[Symbol.iterator]=="function"}function vU(n){return n===!0||n===!1}function qs(n){return typeof n>"u"}function ES(n){return!mo(n)}function mo(n){return qs(n)||n===null}function xs(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function vI(n){if(mo(n))throw new Error("Assertion Failed: argument is undefined or null");return n}function AS(n){return typeof n=="function"}function Yhe(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)Zhe(n[i],e[i])}function Zhe(n,e){if(Ns(e)){if(typeof n!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(AS(e)){try{if(n instanceof e)return}catch{}if(!mo(n)&&n.constructor===e||e.length===1&&e.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function kl(n){if(!n||typeof n!="object"||n instanceof RegExp)return n;const e=Array.isArray(n)?[]:{};return Object.entries(n).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?kl(i):i}),e}function Xhe(n){if(!n||typeof n!="object")return n;const e=[n];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(yU.call(t,i)){const s=t[i];typeof s=="object"&&!Object.isFrozen(s)&&!Khe(s)&&e.push(s)}}return n}const yU=Object.prototype.hasOwnProperty;function wU(n,e){return yI(n,e,new Set)}function yI(n,e,t){if(mo(n))return n;const i=e(n);if(typeof i<"u")return i;if(Array.isArray(n)){const s=[];for(const o of n)s.push(yI(o,e,t));return s}if(Ls(n)){if(t.has(n))throw new Error("Cannot clone recursive data-structure");t.add(n);const s={};for(const o in n)yU.call(n,o)&&(s[o]=yI(n[o],e,t));return t.delete(n),s}return n}function uD(n,e,t=!0){return Ls(n)?(Ls(e)&&Object.keys(e).forEach(i=>{i in n?t&&(Ls(n[i])&&Ls(e[i])?uD(n[i],e[i],t):n[i]=e[i]):n[i]=e[i]}),n):e}function So(n,e){if(n===e)return!0;if(n==null||e===null||e===void 0||typeof n!=typeof e||typeof n!="object"||Array.isArray(n)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(n)){if(n.length!==e.length)return!1;for(t=0;t<n.length;t++)if(!So(n[t],e[t]))return!1}else{const s=[];for(i in n)s.push(i);s.sort();const o=[];for(i in e)o.push(i);if(o.sort(),!So(s,o))return!1;for(t=0;t<s.length;t++)if(!So(n[s[t]],e[s[t]]))return!1}return!0}function Qhe(n){let e=[];for(;Object.prototype!==n;)e=e.concat(Object.getOwnPropertyNames(n)),n=Object.getPrototypeOf(n);return e}function V4(n){const e=[];for(const t of Qhe(n))typeof n[t]=="function"&&e.push(t);return e}function Jhe(n,e){const t=s=>function(){const o=Array.prototype.slice.call(arguments,0);return e(s,o)},i={};for(const s of n)i[s]=t(s);return i}let efe=typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function tfe(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,(i,s)=>{const o=s[0],r=e[o];let a=i;return typeof r=="string"?a=r:(typeof r=="number"||typeof r=="boolean"||r===void 0||r===null)&&(a=String(r)),a}),efe&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function m(n,e,...t){return tfe(e,t)}var b2;const Ng="en";let IS=!1,TS=!1,wC=!1,CU=!1,z4=!1,H4=!1,SU=!1,tw,v2=Ng,ZF=Ng,ife,Rr;const hr=typeof self=="object"?self:typeof globalThis=="object"?globalThis:{};let ts;typeof hr.vscode<"u"&&typeof hr.vscode.process<"u"?ts=hr.vscode.process:typeof process<"u"&&(ts=process);const nfe=typeof((b2=ts==null?void 0:ts.versions)===null||b2===void 0?void 0:b2.electron)=="string",sfe=nfe&&(ts==null?void 0:ts.type)==="renderer";if(typeof navigator=="object"&&!sfe)Rr=navigator.userAgent,IS=Rr.indexOf("Windows")>=0,TS=Rr.indexOf("Macintosh")>=0,H4=(Rr.indexOf("Macintosh")>=0||Rr.indexOf("iPad")>=0||Rr.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,wC=Rr.indexOf("Linux")>=0,SU=(Rr==null?void 0:Rr.indexOf("Mobi"))>=0,z4=!0,m({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"),tw=Ng,v2=tw,ZF=navigator.language;else if(typeof ts=="object"){IS=ts.platform==="win32",TS=ts.platform==="darwin",wC=ts.platform==="linux",wC&&ts.env.SNAP&&ts.env.SNAP_REVISION,ts.env.CI||ts.env.BUILD_ARTIFACTSTAGINGDIRECTORY,tw=Ng,v2=Ng;const n=ts.env.VSCODE_NLS_CONFIG;if(n)try{const e=JSON.parse(n),t=e.availableLanguages["*"];tw=e.locale,ZF=e.osLocale,v2=t||Ng,ife=e._translationsConfigFile}catch{}CU=!0}else console.error("Unable to resolve platform.");const Ps=IS,pt=TS,Xn=wC,lp=CU,Zm=z4,ofe=z4&&typeof hr.importScripts=="function",Qd=H4,rfe=SU,Za=Rr,afe=typeof hr.postMessage=="function"&&!hr.importScripts,xU=(()=>{if(afe){const n=[];hr.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,s=n.length;i<s;i++){const o=n[i];if(o.id===t.data.vscodeScheduleAsyncWork){n.splice(i,1),o.callback();return}}});let e=0;return t=>{const i=++e;n.push({id:i,callback:t}),hr.postMessage({vscodeScheduleAsyncWork:i},"*")}}return n=>setTimeout(n)})(),vo=TS||H4?2:IS?1:3;let XF=!0,QF=!1;function lfe(){if(!QF){QF=!0;const n=new Uint8Array(2);n[0]=1,n[1]=2,XF=new Uint16Array(n.buffer)[0]===512+1}return XF}const LU=!!(Za&&Za.indexOf("Chrome")>=0),cfe=!!(Za&&Za.indexOf("Firefox")>=0),dfe=!!(!LU&&Za&&Za.indexOf("Safari")>=0),ufe=!!(Za&&Za.indexOf("Edg/")>=0);Za&&Za.indexOf("Android")>=0;const An={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var dt;(function(n){function e(b){return b&&typeof b=="object"&&typeof b[Symbol.iterator]=="function"}n.is=e;const t=Object.freeze([]);function i(){return t}n.empty=i;function*s(b){yield b}n.single=s;function o(b){return e(b)?b:s(b)}n.wrap=o;function r(b){return b||t}n.from=r;function*a(b){for(let y=b.length-1;y>=0;y--)yield b[y]}n.reverse=a;function l(b){return!b||b[Symbol.iterator]().next().done===!0}n.isEmpty=l;function c(b){return b[Symbol.iterator]().next().value}n.first=c;function d(b,y){for(const w of b)if(y(w))return!0;return!1}n.some=d;function u(b,y){for(const w of b)if(y(w))return w}n.find=u;function*h(b,y){for(const w of b)y(w)&&(yield w)}n.filter=h;function*f(b,y){let w=0;for(const C of b)yield y(C,w++)}n.map=f;function*g(...b){for(const y of b)for(const w of y)yield w}n.concat=g;function p(b,y,w){let C=w;for(const L of b)C=y(C,L);return C}n.reduce=p;function*_(b,y,w=b.length){for(y<0&&(y+=b.length),w<0?w+=b.length:w>b.length&&(w=b.length);y<w;y++)yield b[y]}n.slice=_;function v(b,y=Number.POSITIVE_INFINITY){const w=[];if(y===0)return[w,b];const C=b[Symbol.iterator]();for(let L=0;L<y;L++){const x=C.next();if(x.done)return[w,n.empty()];w.push(x.value)}return[w,{[Symbol.iterator](){return C}}]}n.consume=v})(dt||(dt={}));let Ii=class wI{constructor(e){this.element=e,this.next=wI.Undefined,this.prev=wI.Undefined}};Ii.Undefined=new Ii(void 0);class Ds{constructor(){this._first=Ii.Undefined,this._last=Ii.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Ii.Undefined}clear(){let e=this._first;for(;e!==Ii.Undefined;){const t=e.next;e.prev=Ii.Undefined,e.next=Ii.Undefined,e=t}this._first=Ii.Undefined,this._last=Ii.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Ii(e);if(this._first===Ii.Undefined)this._first=i,this._last=i;else if(t){const o=this._last;this._last=i,i.prev=o,o.next=i}else{const o=this._first;this._first=i,i.next=o,o.prev=i}this._size+=1;let s=!1;return()=>{s||(s=!0,this._remove(i))}}shift(){if(this._first!==Ii.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ii.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Ii.Undefined&&e.next!==Ii.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ii.Undefined&&e.next===Ii.Undefined?(this._first=Ii.Undefined,this._last=Ii.Undefined):e.next===Ii.Undefined?(this._last=this._last.prev,this._last.next=Ii.Undefined):e.prev===Ii.Undefined&&(this._first=this._first.next,this._first.prev=Ii.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ii.Undefined;)yield e.element,e=e.next}}const DU="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function hfe(n=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of DU)n.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const $4=hfe();function kU(n){let e=$4;if(n&&n instanceof RegExp)if(n.global)e=n;else{let t="g";n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.unicode&&(t+="u"),e=new RegExp(n.source,t)}return e.lastIndex=0,e}const EU=new Ds;EU.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Nb(n,e,t,i,s){if(s||(s=dt.first(EU)),t.length>s.maxLen){let c=n-s.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,n+s.maxLen/2),Nb(n,e,t,i,s)}const o=Date.now(),r=n-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-o>=s.timeBudget);c++){const d=r-s.windowSize*c;e.lastIndex=Math.max(0,d);const u=ffe(e,t,r,a);if(!u&&l||(l=u,d<=0))break;a=d}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function ffe(n,e,t,i){let s;for(;s=n.exec(e);){const o=s.index||0;if(o<=t&&n.lastIndex>=t)return s;if(i>0&&o>i)return null}return null}const Pc=8;class AU{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class IU{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Zt{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return hD(e,t)}compute(e,t,i){return i}}class k_{constructor(e,t){this.newValue=e,this.didChange=t}}function hD(n,e){if(typeof n!="object"||typeof e!="object"||!n||!e)return new k_(e,n!==e);if(Array.isArray(n)||Array.isArray(e)){const i=Array.isArray(n)&&Array.isArray(e)&&Ki(n,e);return new k_(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const s=hD(n[i],e[i]);s.didChange&&(n[i]=s.newValue,t=!0)}return new k_(n,t)}class J1{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return hD(e,t)}validate(e){return this.defaultValue}}class Xm{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return hD(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function ye(n,e){return typeof n>"u"?e:n==="false"?!1:!!n}class st extends Xm{constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="boolean",s.default=i),super(e,t,i,s)}validate(e){return ye(e,this.defaultValue)}}function Zu(n,e,t,i){if(typeof n>"u")return e;let s=parseInt(n,10);return isNaN(s)?e:(s=Math.max(t,s),s=Math.min(i,s),s|0)}class Et extends Xm{static clampedInt(e,t,i,s){return Zu(e,t,i,s)}constructor(e,t,i,s,o,r=void 0){typeof r<"u"&&(r.type="integer",r.default=i,r.minimum=s,r.maximum=o),super(e,t,i,r),this.minimum=s,this.maximum=o}validate(e){return Et.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function gfe(n,e,t,i){if(typeof n>"u")return e;const s=or.float(n,e);return or.clamp(s,t,i)}class or extends Xm{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,s,o){typeof o<"u"&&(o.type="number",o.default=i),super(e,t,i,o),this.validationFn=s}validate(e){return this.validationFn(or.float(e,this.defaultValue))}}class Hs extends Xm{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="string",s.default=i),super(e,t,i,s)}validate(e){return Hs.string(e,this.defaultValue)}}function xi(n,e,t,i){return typeof n!="string"?e:i&&n in i?i[n]:t.indexOf(n)===-1?e:n}class ni extends Xm{constructor(e,t,i,s,o=void 0){typeof o<"u"&&(o.type="string",o.enum=s,o.default=i),super(e,t,i,o),this._allowedValues=s}validate(e){return xi(e,this.defaultValue,this._allowedValues)}}class iw extends Zt{constructor(e,t,i,s,o,r,a=void 0){typeof a<"u"&&(a.type="string",a.enum=o,a.default=s),super(e,t,i,a),this._allowedValues=o,this._convert=r}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function pfe(n){switch(n){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class mfe extends Zt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[m("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached"),m("accessibilitySupport.on","Optimize for usage with a Screen Reader"),m("accessibilitySupport.off","Assume a screen reader is not attached")],default:"auto",tags:["accessibility"],description:m("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class _fe extends Zt{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:m("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:m("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:ye(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ye(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function bfe(n){switch(n){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var fn;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(fn||(fn={}));function vfe(n){switch(n){case"line":return fn.Line;case"block":return fn.Block;case"underline":return fn.Underline;case"line-thin":return fn.LineThin;case"block-outline":return fn.BlockOutline;case"underline-thin":return fn.UnderlineThin}}class yfe extends J1{constructor(){super(140)}compute(e,t,i){const s=["monaco-editor"];return t.get(39)&&s.push(t.get(39)),e.extraEditorClassName&&s.push(e.extraEditorClassName),t.get(73)==="default"?s.push("mouse-default"):t.get(73)==="copy"&&s.push("mouse-copy"),t.get(110)&&s.push("showUnused"),t.get(138)&&s.push("showDeprecated"),s.join(" ")}}class wfe extends st{constructor(){super(37,"emptySelectionClipboard",!0,{description:m("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class Cfe extends Zt{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:m("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[m("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),m("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),m("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:m("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[m("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),m("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),m("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:m("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:m("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:pt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:m("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:m("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:ye(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":xi(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":xi(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ye(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ye(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ye(t.loop,this.defaultValue.loop)}}}class No extends Zt{constructor(){super(51,"fontLigatures",No.OFF,{anyOf:[{type:"boolean",description:m("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:m("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:m("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?No.OFF:e==="true"?No.ON:e:e?No.ON:No.OFF}}No.OFF='"liga" off, "calt" off';No.ON='"liga" on, "calt" on';class Gr extends Zt{constructor(){super(54,"fontVariations",Gr.OFF,{anyOf:[{type:"boolean",description:m("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:m("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:m("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Gr.OFF:e==="true"?Gr.TRANSLATE:e:e?Gr.TRANSLATE:Gr.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}}Gr.OFF="normal";Gr.TRANSLATE="translate";class Sfe extends J1{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class xfe extends Xm{constructor(){super(52,"fontSize",Vo.fontSize,{type:"number",minimum:6,maximum:100,default:Vo.fontSize,description:m("fontSize","Controls the font size in pixels.")})}validate(e){const t=or.float(e,this.defaultValue);return t===0?Vo.fontSize:or.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class La extends Zt{constructor(){super(53,"fontWeight",Vo.fontWeight,{anyOf:[{type:"number",minimum:La.MINIMUM_VALUE,maximum:La.MAXIMUM_VALUE,errorMessage:m("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:La.SUGGESTION_VALUES}],default:Vo.fontWeight,description:m("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Et.clampedInt(e,Vo.fontWeight,La.MINIMUM_VALUE,La.MAXIMUM_VALUE))}}La.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];La.MINIMUM_VALUE=1;La.MAXIMUM_VALUE=1e3;class Lfe extends Zt{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[m("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),m("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),m("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:m("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:m("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:m("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleDeclarations":Object.assign({description:m("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleImplementations":Object.assign({description:m("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleReferences":Object.assign({description:m("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist.")},t),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:m("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:m("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:m("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:m("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:m("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){var t,i,s,o,r;if(!e||typeof e!="object")return this.defaultValue;const a=e;return{multiple:xi(a.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:(t=a.multipleDefinitions)!==null&&t!==void 0?t:xi(a.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:(i=a.multipleTypeDefinitions)!==null&&i!==void 0?i:xi(a.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:(s=a.multipleDeclarations)!==null&&s!==void 0?s:xi(a.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:(o=a.multipleImplementations)!==null&&o!==void 0?o:xi(a.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:(r=a.multipleReferences)!==null&&r!==void 0?r:xi(a.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Hs.string(a.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Hs.string(a.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Hs.string(a.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Hs.string(a.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Hs.string(a.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class Dfe extends Zt{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:m("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:m("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:m("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:m("hover.hidingDelay","Controls the delay in milliseconds after thich the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:m("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),delay:Et.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ye(t.sticky,this.defaultValue.sticky),hidingDelay:Et.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ye(t.above,this.defaultValue.above)}}}class cp extends J1{constructor(){super(143)}compute(e,t,i){return cp.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let s=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(s=Math.max(s,t-1));const o=(i+e.viewLineCount+s)/(e.pixelRatio*e.height),r=Math.floor(e.viewLineCount/o);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:s,desiredRatio:o,minimapLineCount:r}}static _computeMinimapLayout(e,t){const i=e.outerWidth,s=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s};const r=t.stableMinimapLayoutInput,a=r&&e.outerHeight===r.outerHeight&&e.lineHeight===r.lineHeight&&e.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&e.pixelRatio===r.pixelRatio&&e.scrollBeyondLastLine===r.scrollBeyondLastLine&&e.paddingTop===r.paddingTop&&e.paddingBottom===r.paddingBottom&&e.minimap.enabled===r.minimap.enabled&&e.minimap.side===r.minimap.side&&e.minimap.size===r.minimap.size&&e.minimap.showSlider===r.minimap.showSlider&&e.minimap.renderCharacters===r.minimap.renderCharacters&&e.minimap.maxColumn===r.minimap.maxColumn&&e.minimap.scale===r.minimap.scale&&e.verticalScrollbarWidth===r.verticalScrollbarWidth&&e.isViewportWrapping===r.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,u=e.minimap.renderCharacters;let h=o>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const f=e.minimap.maxColumn,g=e.minimap.size,p=e.minimap.side,_=e.verticalScrollbarWidth,v=e.viewLineCount,b=e.remainingWidth,y=e.isViewportWrapping,w=u?2:3;let C=Math.floor(o*s);const L=C/o;let x=!1,D=!1,k=w*h,P=h/o,O=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:fe,extraLinesBeforeFirstLine:oe,extraLinesBeyondLastLine:xe,desiredRatio:Te,minimapLineCount:me}=cp.computeContainedMinimapLineCount({viewLineCount:v,scrollBeyondLastLine:d,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:s,lineHeight:l,pixelRatio:o});if(v/me>1)x=!0,D=!0,h=1,k=1,P=h/o;else{let Yt=!1,Lt=h+1;if(g==="fit"){const Tt=Math.ceil((oe+v+xe)*k);y&&a&&b<=t.stableFitRemainingWidth?(Yt=!0,Lt=t.stableFitMaxMinimapScale):Yt=Tt>C}if(g==="fill"||Yt){x=!0;const Tt=h;k=Math.min(l*o,Math.max(1,Math.floor(1/Te))),y&&a&&b<=t.stableFitRemainingWidth&&(Lt=t.stableFitMaxMinimapScale),h=Math.min(Lt,Math.max(1,Math.floor(k/w))),h>Tt&&(O=Math.min(2,h/Tt)),P=h/o/O,C=Math.ceil(Math.max(fe,oe+v+xe)*k),y?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=b,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const M=Math.floor(f*P),R=Math.min(M,Math.max(0,Math.floor((b-_-2)*P/(c+P)))+Pc);let $=Math.floor(o*R);const G=$/o;$=Math.floor($*O);const ne=u?1:2,ae=p==="left"?0:i-R-_;return{renderMinimap:ne,minimapLeft:ae,minimapWidth:R,minimapHeightIsEditorHeight:x,minimapIsSampling:D,minimapScale:h,minimapLineHeight:k,minimapCanvasInnerWidth:$,minimapCanvasInnerHeight:C,minimapCanvasOuterWidth:G,minimapCanvasOuterHeight:L}}static computeLayout(e,t){const i=t.outerWidth|0,s=t.outerHeight|0,o=t.lineHeight|0,r=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,d=t.viewLineCount,u=e.get(135),h=u==="inherit"?e.get(134):u,f=h==="inherit"?e.get(130):h,g=e.get(133),p=t.isDominatedByLongLines,_=e.get(57),v=e.get(67).renderType!==0,b=e.get(68),y=e.get(104),w=e.get(83),C=e.get(72),L=e.get(102),x=L.verticalScrollbarSize,D=L.verticalHasArrows,k=L.arrowSize,P=L.horizontalScrollbarSize,O=e.get(43),M=e.get(109)!=="never";let R=e.get(65);O&&M&&(R+=16);let $=0;if(v){const ii=Math.max(r,b);$=Math.round(ii*l)}let G=0;_&&(G=o*t.glyphMarginDecorationLaneCount);let ne=0,ae=ne+G,fe=ae+$,oe=fe+R;const xe=i-G-$-R;let Te=!1,me=!1,te=-1;h==="inherit"&&p?(Te=!0,me=!0):f==="on"||f==="bounded"?me=!0:f==="wordWrapColumn"&&(te=g);const Yt=cp._computeMinimapLayout({outerWidth:i,outerHeight:s,lineHeight:o,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:y,paddingTop:w.top,paddingBottom:w.bottom,minimap:C,verticalScrollbarWidth:x,viewLineCount:d,remainingWidth:xe,isViewportWrapping:me},t.memory||new IU);Yt.renderMinimap!==0&&Yt.minimapLeft===0&&(ne+=Yt.minimapWidth,ae+=Yt.minimapWidth,fe+=Yt.minimapWidth,oe+=Yt.minimapWidth);const Lt=xe-Yt.minimapWidth,Tt=Math.max(1,Math.floor((Lt-x-2)/a)),Ge=D?k:0;return me&&(te=Math.max(1,Tt),f==="bounded"&&(te=Math.min(te,g))),{width:i,height:s,glyphMarginLeft:ne,glyphMarginWidth:G,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ae,lineNumbersWidth:$,decorationsLeft:fe,decorationsWidth:R,contentLeft:oe,contentWidth:Lt,minimap:Yt,viewportColumn:Tt,isWordWrapMinified:Te,isViewportWrapping:me,wrappingColumn:te,verticalScrollbarWidth:x,horizontalScrollbarHeight:P,overviewRuler:{top:Ge,width:x,height:s-2*Ge,right:0}}}}class kfe extends Zt{constructor(){super(137,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[m("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),m("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:m("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return xi(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}class Efe extends Zt{constructor(){const e={enabled:!0};super(64,"lightbulb",e,{"editor.lightbulb.enabled":{type:"boolean",default:e.enabled,description:m("codeActions","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:ye(e.enabled,this.defaultValue.enabled)}}}class Afe extends Zt{constructor(){const e={enabled:!1,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(114,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:m("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:10,description:m("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:m("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:m("editor.stickyScroll.scrollWithEditor","Enable scrolling of the sticky scroll widget with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),maxLineCount:Et.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,10),defaultModel:xi(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ye(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class Ife extends Zt{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(139,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:m("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[m("editor.inlayHints.on","Inlay hints are enabled"),m("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",pt?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",pt?"Ctrl+Option":"Ctrl+Alt"),m("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:m("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:m("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:m("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:xi(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Et.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Hs.string(t.fontFamily,this.defaultValue.fontFamily),padding:ye(t.padding,this.defaultValue.padding)}}}class Tfe extends Zt{constructor(){super(65,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Et.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Et.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class Nfe extends or{constructor(){super(66,"lineHeight",Vo.lineHeight,e=>or.clamp(e,0,150),{markdownDescription:m("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class Rfe extends Zt{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1};super(72,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:m("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:m("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[m("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),m("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),m("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:m("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:m("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:m("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:m("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:m("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:m("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),autohide:ye(t.autohide,this.defaultValue.autohide),size:xi(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:xi(t.side,this.defaultValue.side,["right","left"]),showSlider:xi(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ye(t.renderCharacters,this.defaultValue.renderCharacters),scale:Et.clampedInt(t.scale,1,1,3),maxColumn:Et.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function Mfe(n){return n==="ctrlCmd"?pt?"metaKey":"ctrlKey":"altKey"}class Pfe extends Zt{constructor(){super(83,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:m("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Et.clampedInt(t.top,0,0,1e3),bottom:Et.clampedInt(t.bottom,0,0,1e3)}}}class Ofe extends Zt{constructor(){const e={enabled:!0,cycle:!0};super(85,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:m("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:m("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),cycle:ye(t.cycle,this.defaultValue.cycle)}}}class Ffe extends J1{constructor(){super(141)}compute(e,t,i){return e.pixelRatio}}class Bfe extends Zt{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[m("on","Quick suggestions show inside the suggest widget"),m("inline","Quick suggestions show as ghost text"),m("off","Quick suggestions are disabled")]}];super(88,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:m("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:m("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:m("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:m("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.","#editor.suggestOnTriggerCharacters#")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:s}=e,o=["on","inline","off"];let r,a,l;return typeof t=="boolean"?r=t?"on":"off":r=xi(t,this.defaultValue.other,o),typeof i=="boolean"?a=i?"on":"off":a=xi(i,this.defaultValue.comments,o),typeof s=="boolean"?l=s?"on":"off":l=xi(s,this.defaultValue.strings,o),{other:r,comments:a,strings:l}}}class Wfe extends Zt{constructor(){super(67,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[m("lineNumbers.off","Line numbers are not rendered."),m("lineNumbers.on","Line numbers are rendered as absolute number."),m("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),m("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:m("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function NS(n){const e=n.get(97);return e==="editable"?n.get(90):e!=="on"}class Vfe extends Zt{constructor(){const e=[],t={type:"number",description:m("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(101,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:m("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:m("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Et.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const s=i;t.push({column:Et.clampedInt(s.column,0,0,1e4),color:s.color})}return t.sort((i,s)=>i.column-s.column),t}return this.defaultValue}}class zfe extends Zt{constructor(){super(91,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function JF(n,e){if(typeof n!="string")return e;switch(n){case"hidden":return 2;case"visible":return 3;default:return 1}}let Hfe=class extends Zt{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(102,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),m("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),m("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[m("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),m("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),m("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:m("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:m("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:m("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:m("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Et.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),s=Et.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Et.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:JF(t.vertical,this.defaultValue.vertical),horizontal:JF(t.horizontal,this.defaultValue.horizontal),useShadows:ye(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ye(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ye(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ye(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ye(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Et.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Et.clampedInt(t.verticalSliderSize,s,0,1e3),scrollByPage:ye(t.scrollByPage,this.defaultValue.scrollByPage)}}};const Ir="inUntrustedWorkspace",Hu={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class $fe extends Zt{constructor(){const e={nonBasicASCII:Ir,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Ir,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(124,"unicodeHighlight",e,{[Hu.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ir],default:e.nonBasicASCII,description:m("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Hu.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:m("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[Hu.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:m("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Hu.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ir],default:e.includeComments,description:m("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[Hu.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Ir],default:e.includeStrings,description:m("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[Hu.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:m("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Hu.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:m("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(So(e.allowedCharacters,t.allowedCharacters)||(e=Object.assign(Object.assign({},e),{allowedCharacters:t.allowedCharacters}),i=!0)),t.allowedLocales&&e&&(So(e.allowedLocales,t.allowedLocales)||(e=Object.assign(Object.assign({},e),{allowedLocales:t.allowedLocales}),i=!0));const s=super.applyUpdate(e,t);return i?new k_(s.newValue,!0):s}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:dp(t.nonBasicASCII,Ir,[!0,!1,Ir]),invisibleCharacters:ye(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ye(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:dp(t.includeComments,Ir,[!0,!1,Ir]),includeStrings:dp(t.includeStrings,Ir,[!0,!1,Ir]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[s,o]of Object.entries(e))o===!0&&(i[s]=!0);return i}}class Ufe extends Zt{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:m("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover"],enumDescriptions:[m("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),m("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion.")],description:m("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:m("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),mode:xi(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:xi(t.showToolbar,this.defaultValue.showToolbar,["always","onHover"]),suppressSuggestions:ye(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ye(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class jfe extends Zt{constructor(){const e={enabled:An.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:An.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:m("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ye(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class qfe extends Zt{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairs.true","Enables bracket pair guides."),m("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),m("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:m("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[m("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),m("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),m("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:m("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:m("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:m("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[m("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),m("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),m("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:m("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:dp(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:dp(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ye(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ye(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:dp(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function dp(n,e,t){const i=t.indexOf(n);return i===-1?e:t[i]}class Gfe extends Zt{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(117,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[m("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),m("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:m("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:m("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:m("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:m("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[m("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),m("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),m("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:m("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions (`#editor.quickSuggestions#` and `#editor.suggestOnTriggerCharacters#`) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:m("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:m("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:m("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:m("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:m("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:m("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:m("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:m("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:xi(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ye(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ye(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ye(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ye(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:xi(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ye(t.showIcons,this.defaultValue.showIcons),showStatusBar:ye(t.showStatusBar,this.defaultValue.showStatusBar),preview:ye(t.preview,this.defaultValue.preview),previewMode:xi(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ye(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ye(t.showMethods,this.defaultValue.showMethods),showFunctions:ye(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ye(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ye(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ye(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ye(t.showFields,this.defaultValue.showFields),showVariables:ye(t.showVariables,this.defaultValue.showVariables),showClasses:ye(t.showClasses,this.defaultValue.showClasses),showStructs:ye(t.showStructs,this.defaultValue.showStructs),showInterfaces:ye(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ye(t.showModules,this.defaultValue.showModules),showProperties:ye(t.showProperties,this.defaultValue.showProperties),showEvents:ye(t.showEvents,this.defaultValue.showEvents),showOperators:ye(t.showOperators,this.defaultValue.showOperators),showUnits:ye(t.showUnits,this.defaultValue.showUnits),showValues:ye(t.showValues,this.defaultValue.showValues),showConstants:ye(t.showConstants,this.defaultValue.showConstants),showEnums:ye(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ye(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ye(t.showKeywords,this.defaultValue.showKeywords),showWords:ye(t.showWords,this.defaultValue.showWords),showColors:ye(t.showColors,this.defaultValue.showColors),showFiles:ye(t.showFiles,this.defaultValue.showFiles),showReferences:ye(t.showReferences,this.defaultValue.showReferences),showFolders:ye(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ye(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ye(t.showSnippets,this.defaultValue.showSnippets),showUsers:ye(t.showUsers,this.defaultValue.showUsers),showIssues:ye(t.showIssues,this.defaultValue.showIssues)}}}class Kfe extends Zt{constructor(){super(112,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:m("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:m("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ye(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ye(e.selectSubwords,this.defaultValue.selectSubwords)}}}class Yfe extends Zt{constructor(){super(136,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[m("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),m("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),m("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),m("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:m("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class Zfe extends J1{constructor(){super(144)}compute(e,t,i){const s=t.get(143);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}}class Xfe extends Zt{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down `shift` (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:m("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[m("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),m("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),showDropSelector:xi(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class Qfe extends Zt{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(84,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:m("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:m("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[m("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),m("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ye(t.enabled,this.defaultValue.enabled),showPasteSelector:xi(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const Jfe="Consolas, 'Courier New', monospace",ege="Menlo, Monaco, 'Courier New', monospace",tge="'Droid Sans Mono', 'monospace', monospace",Vo={fontFamily:pt?ege:Xn?tge:Jfe,fontWeight:"normal",fontSize:pt?12:14,lineHeight:0,letterSpacing:0},Rg=[];function Q(n){return Rg[n.id]=n,n}const Nf={acceptSuggestionOnCommitCharacter:Q(new st(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:m("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:Q(new ni(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",m("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:m("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:Q(new mfe),accessibilityPageSize:Q(new Et(3,"accessibilityPageSize",10,1,1073741824,{description:m("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:Q(new Hs(4,"ariaLabel",m("editorViewAccessibleLabel","Editor content"))),ariaRequired:Q(new st(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:Q(new st(8,"screenReaderAnnounceInlineSuggestion",!0,{description:m("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:Q(new ni(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),m("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:m("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:Q(new ni(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),m("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:m("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:Q(new ni(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:Q(new ni(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",m("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:m("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:Q(new ni(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",m("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),m("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:m("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:Q(new iw(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],pfe,{enumDescriptions:[m("editor.autoIndent.none","The editor will not insert indentation automatically."),m("editor.autoIndent.keep","The editor will keep the current line's indentation."),m("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),m("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),m("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:m("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:Q(new st(13,"automaticLayout",!1)),autoSurround:Q(new ni(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[m("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),m("editor.autoSurround.quotes","Surround with quotes but not brackets."),m("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:m("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:Q(new jfe),bracketPairGuides:Q(new qfe),stickyTabStops:Q(new st(115,"stickyTabStops",!1,{description:m("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:Q(new st(17,"codeLens",!0,{description:m("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:Q(new Hs(18,"codeLensFontFamily","",{description:m("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:Q(new Et(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:m("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:Q(new st(20,"colorDecorators",!0,{description:m("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:Q(new ni(146,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[m("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),m("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),m("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:m("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:Q(new Et(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:m("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:Q(new st(22,"columnSelection",!1,{description:m("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:Q(new _fe),contextmenu:Q(new st(24,"contextmenu",!0)),copyWithSyntaxHighlighting:Q(new st(25,"copyWithSyntaxHighlighting",!0,{description:m("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:Q(new iw(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],bfe,{description:m("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:Q(new ni(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[m("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),m("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),m("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:m("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:Q(new iw(28,"cursorStyle",fn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],vfe,{description:m("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:Q(new Et(29,"cursorSurroundingLines",0,0,1073741824,{description:m("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:Q(new ni(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[m("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),m("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:m("cursorSurroundingLinesStyle","Controls when `#cursorSurroundingLines#` should be enforced.")})),cursorWidth:Q(new Et(31,"cursorWidth",0,0,1073741824,{markdownDescription:m("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:Q(new st(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:Q(new st(33,"disableMonospaceOptimizations",!1)),domReadOnly:Q(new st(34,"domReadOnly",!1)),dragAndDrop:Q(new st(35,"dragAndDrop",!0,{description:m("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:Q(new wfe),dropIntoEditor:Q(new Xfe),stickyScroll:Q(new Afe),experimentalWhitespaceRendering:Q(new ni(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[m("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),m("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),m("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:m("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:Q(new Hs(39,"extraEditorClassName","")),fastScrollSensitivity:Q(new or(40,"fastScrollSensitivity",5,n=>n<=0?5:n,{markdownDescription:m("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:Q(new Cfe),fixedOverflowWidgets:Q(new st(42,"fixedOverflowWidgets",!1)),folding:Q(new st(43,"folding",!0,{description:m("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:Q(new ni(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[m("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),m("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:m("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:Q(new st(45,"foldingHighlight",!0,{description:m("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:Q(new st(46,"foldingImportsByDefault",!1,{description:m("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:Q(new Et(47,"foldingMaximumRegions",5e3,10,65e3,{description:m("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:Q(new st(48,"unfoldOnClickAfterEndOfLine",!1,{description:m("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:Q(new Hs(49,"fontFamily",Vo.fontFamily,{description:m("fontFamily","Controls the font family.")})),fontInfo:Q(new Sfe),fontLigatures2:Q(new No),fontSize:Q(new xfe),fontWeight:Q(new La),fontVariations:Q(new Gr),formatOnPaste:Q(new st(55,"formatOnPaste",!1,{description:m("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:Q(new st(56,"formatOnType",!1,{description:m("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:Q(new st(57,"glyphMargin",!0,{description:m("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:Q(new Lfe),hideCursorInOverviewRuler:Q(new st(59,"hideCursorInOverviewRuler",!1,{description:m("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:Q(new Dfe),inDiffEditor:Q(new st(61,"inDiffEditor",!1)),letterSpacing:Q(new or(63,"letterSpacing",Vo.letterSpacing,n=>or.clamp(n,-5,20),{description:m("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:Q(new Efe),lineDecorationsWidth:Q(new Tfe),lineHeight:Q(new Nfe),lineNumbers:Q(new Wfe),lineNumbersMinChars:Q(new Et(68,"lineNumbersMinChars",5,1,300)),linkedEditing:Q(new st(69,"linkedEditing",!1,{description:m("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:Q(new st(70,"links",!0,{description:m("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:Q(new ni(71,"matchBrackets","always",["always","near","never"],{description:m("matchBrackets","Highlight matching brackets.")})),minimap:Q(new Rfe),mouseStyle:Q(new ni(73,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:Q(new or(74,"mouseWheelScrollSensitivity",1,n=>n===0?1:n,{markdownDescription:m("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:Q(new st(75,"mouseWheelZoom",!1,{markdownDescription:m("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:Q(new st(76,"multiCursorMergeOverlapping",!0,{description:m("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:Q(new iw(77,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Mfe,{markdownEnumDescriptions:[m("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:m({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:Q(new ni(78,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[m("multiCursorPaste.spread","Each cursor pastes a single line of the text."),m("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:m("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:Q(new Et(79,"multiCursorLimit",1e4,1,1e5,{markdownDescription:m("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:Q(new st(80,"occurrencesHighlight",!0,{description:m("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:Q(new st(81,"overviewRulerBorder",!0,{description:m("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:Q(new Et(82,"overviewRulerLanes",3,0,3)),padding:Q(new Pfe),pasteAs:Q(new Qfe),parameterHints:Q(new Ofe),peekWidgetDefaultFocus:Q(new ni(86,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[m("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),m("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:m("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:Q(new st(87,"definitionLinkOpensInPeek",!1,{description:m("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:Q(new Bfe),quickSuggestionsDelay:Q(new Et(89,"quickSuggestionsDelay",10,0,1073741824,{description:m("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:Q(new st(90,"readOnly",!1)),readOnlyMessage:Q(new zfe),renameOnType:Q(new st(92,"renameOnType",!1,{description:m("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:m("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:Q(new st(93,"renderControlCharacters",!0,{description:m("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:Q(new ni(94,"renderFinalNewline",Xn?"dimmed":"on",["off","on","dimmed"],{description:m("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:Q(new ni(95,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",m("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:m("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:Q(new st(96,"renderLineHighlightOnlyWhenFocus",!1,{description:m("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:Q(new ni(97,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:Q(new ni(98,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",m("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),m("renderWhitespace.selection","Render whitespace characters only on selected text."),m("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:m("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:Q(new Et(99,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:Q(new st(100,"roundedSelection",!0,{description:m("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:Q(new Vfe),scrollbar:Q(new Hfe),scrollBeyondLastColumn:Q(new Et(103,"scrollBeyondLastColumn",4,0,1073741824,{description:m("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:Q(new st(104,"scrollBeyondLastLine",!0,{description:m("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:Q(new st(105,"scrollPredominantAxis",!0,{description:m("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:Q(new st(106,"selectionClipboard",!0,{description:m("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:Xn})),selectionHighlight:Q(new st(107,"selectionHighlight",!0,{description:m("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:Q(new st(108,"selectOnLineNumbers",!0)),showFoldingControls:Q(new ni(109,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[m("showFoldingControls.always","Always show the folding controls."),m("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),m("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:m("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:Q(new st(110,"showUnused",!0,{description:m("showUnused","Controls fading out of unused code.")})),showDeprecated:Q(new st(138,"showDeprecated",!0,{description:m("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:Q(new Ife),snippetSuggestions:Q(new ni(111,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[m("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),m("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),m("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),m("snippetSuggestions.none","Do not show snippet suggestions.")],description:m("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:Q(new Kfe),smoothScrolling:Q(new st(113,"smoothScrolling",!1,{description:m("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:Q(new Et(116,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:Q(new Gfe),inlineSuggest:Q(new Ufe),inlineCompletionsAccessibilityVerbose:Q(new st(147,"inlineCompletionsAccessibilityVerbose",!1,{description:m("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:Q(new Et(118,"suggestFontSize",0,0,1e3,{markdownDescription:m("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:Q(new Et(119,"suggestLineHeight",0,0,1e3,{markdownDescription:m("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:Q(new st(120,"suggestOnTriggerCharacters",!0,{description:m("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:Q(new ni(121,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[m("suggestSelection.first","Always select the first suggestion."),m("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),m("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:m("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:Q(new ni(122,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[m("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),m("tabCompletion.off","Disable tab completions."),m("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:m("tabCompletion","Enables tab completions.")})),tabIndex:Q(new Et(123,"tabIndex",0,-1,1073741824)),unicodeHighlight:Q(new $fe),unusualLineTerminators:Q(new ni(125,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[m("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),m("unusualLineTerminators.off","Unusual line terminators are ignored."),m("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:m("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:Q(new st(126,"useShadowDOM",!0)),useTabStops:Q(new st(127,"useTabStops",!0,{description:m("useTabStops","Inserting and deleting whitespace follows tab stops.")})),wordBreak:Q(new ni(128,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[m("wordBreak.normal","Use the default line break rule."),m("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:m("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSeparators:Q(new Hs(129,"wordSeparators",DU,{description:m("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:Q(new ni(130,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[m("wordWrap.off","Lines will never wrap."),m("wordWrap.on","Lines will wrap at the viewport width."),m({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),m({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:m({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:Q(new Hs(131,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:Q(new Hs(132,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:Q(new Et(133,"wordWrapColumn",80,1,1073741824,{markdownDescription:m({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:Q(new ni(134,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:Q(new ni(135,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:Q(new yfe),defaultColorDecorators:Q(new st(145,"defaultColorDecorators",!1,{markdownDescription:m("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:Q(new Ffe),tabFocusMode:Q(new st(142,"tabFocusMode",!1,{markdownDescription:m("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:Q(new cp),wrappingInfo:Q(new Zfe),wrappingIndent:Q(new Yfe),wrappingStrategy:Q(new kfe)};class ige{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?dm.isErrorNoTelemetry(e)?new dm(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const TU=new ige;function mt(n){Rf(n)||TU.onUnexpectedError(n)}function bc(n){Rf(n)||TU.onUnexpectedExternalError(n)}function e9(n){if(n instanceof Error){const{name:e,message:t}=n,i=n.stacktrace||n.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:dm.isErrorNoTelemetry(n)}}return n}const RS="Canceled";function Rf(n){return n instanceof Qm?!0:n instanceof Error&&n.name===RS&&n.message===RS}class Qm extends Error{constructor(){super(RS),this.name=this.message}}function nge(){const n=new Error(RS);return n.name=n.message,n}function ic(n){return n?new Error(`Illegal argument: ${n}`):new Error("Illegal argument")}function U4(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}class sge extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class dm extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof dm)return e;const t=new dm;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class ji extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,ji.prototype)}}function um(n){const e=this;let t=!1,i;return function(){return t||(t=!0,i=n.apply(e,arguments)),i}}function oge(n){return typeof n.dispose=="function"&&n.dispose.length===0}function Ft(n){if(dt.is(n)){const e=[];for(const t of n)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function fr(...n){return Ze(()=>Ft(n))}function Ze(n){return{dispose:um(()=>{n()})}}class pe{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ft(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?pe.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}}pe.DISABLE_DISPOSED_WARNING=!1;class Y{constructor(){this._store=new pe,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}Y.None=Object.freeze({dispose(){}});class ta{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)===null||t===void 0||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)===null||e===void 0||e.dispose(),this._value=void 0}}class rge{constructor(e){this.object=e}dispose(){}}class j4{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ft(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){var s;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(s=this._store.get(e))===null||s===void 0||s.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))===null||t===void 0||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const age=globalThis.performance&&typeof globalThis.performance.now=="function";class yu{static create(e){return new yu(e)}constructor(e){this._now=age&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var ue;(function(n){n.None=()=>Y.None;function e(M,R){return u(M,()=>{},0,void 0,!0,void 0,R)}n.defer=e;function t(M){return(R,$=null,G)=>{let ne=!1,ae;return ae=M(fe=>{if(!ne)return ae?ae.dispose():ne=!0,R.call($,fe)},null,G),ne&&ae.dispose(),ae}}n.once=t;function i(M,R,$){return c((G,ne=null,ae)=>M(fe=>G.call(ne,R(fe)),null,ae),$)}n.map=i;function s(M,R,$){return c((G,ne=null,ae)=>M(fe=>{R(fe),G.call(ne,fe)},null,ae),$)}n.forEach=s;function o(M,R,$){return c((G,ne=null,ae)=>M(fe=>R(fe)&&G.call(ne,fe),null,ae),$)}n.filter=o;function r(M){return M}n.signal=r;function a(...M){return(R,$=null,G)=>{const ne=fr(...M.map(ae=>ae(fe=>R.call($,fe))));return d(ne,G)}}n.any=a;function l(M,R,$,G){let ne=$;return i(M,ae=>(ne=R(ne,ae),ne),G)}n.reduce=l;function c(M,R){let $;const G={onWillAddFirstListener(){$=M(ne.fire,ne)},onDidRemoveLastListener(){$==null||$.dispose()}},ne=new B(G);return R==null||R.add(ne),ne.event}function d(M,R){return R instanceof Array?R.push(M):R&&R.add(M),M}function u(M,R,$=100,G=!1,ne=!1,ae,fe){let oe,xe,Te,me=0,te;const Yt={leakWarningThreshold:ae,onWillAddFirstListener(){oe=M(Tt=>{me++,xe=R(xe,Tt),G&&!Te&&(Lt.fire(xe),xe=void 0),te=()=>{const Ge=xe;xe=void 0,Te=void 0,(!G||me>1)&&Lt.fire(Ge),me=0},typeof $=="number"?(clearTimeout(Te),Te=setTimeout(te,$)):Te===void 0&&(Te=0,queueMicrotask(te))})},onWillRemoveListener(){ne&&me>0&&(te==null||te())},onDidRemoveLastListener(){te=void 0,oe.dispose()}},Lt=new B(Yt);return fe==null||fe.add(Lt),Lt.event}n.debounce=u;function h(M,R=0,$){return n.debounce(M,(G,ne)=>G?(G.push(ne),G):[ne],R,void 0,!0,void 0,$)}n.accumulate=h;function f(M,R=(G,ne)=>G===ne,$){let G=!0,ne;return o(M,ae=>{const fe=G||!R(ae,ne);return G=!1,ne=ae,fe},$)}n.latch=f;function g(M,R,$){return[n.filter(M,R,$),n.filter(M,G=>!R(G),$)]}n.split=g;function p(M,R=!1,$=[],G){let ne=$.slice(),ae=M(xe=>{ne?ne.push(xe):oe.fire(xe)});G&&G.add(ae);const fe=()=>{ne==null||ne.forEach(xe=>oe.fire(xe)),ne=null},oe=new B({onWillAddFirstListener(){ae||(ae=M(xe=>oe.fire(xe)),G&&G.add(ae))},onDidAddFirstListener(){ne&&(R?setTimeout(fe):fe())},onDidRemoveLastListener(){ae&&ae.dispose(),ae=null}});return G&&G.add(oe),oe.event}n.buffer=p;function _(M,R){return(G,ne,ae)=>{const fe=R(new b);return M(function(oe){const xe=fe.evaluate(oe);xe!==v&&G.call(ne,xe)},void 0,ae)}}n.chain=_;const v=Symbol("HaltChainable");class b{constructor(){this.steps=[]}map(R){return this.steps.push(R),this}forEach(R){return this.steps.push($=>(R($),$)),this}filter(R){return this.steps.push($=>R($)?$:v),this}reduce(R,$){let G=$;return this.steps.push(ne=>(G=R(G,ne),G)),this}latch(R=($,G)=>$===G){let $=!0,G;return this.steps.push(ne=>{const ae=$||!R(ne,G);return $=!1,G=ne,ae?ne:v}),this}evaluate(R){for(const $ of this.steps)if(R=$(R),R===v)break;return R}}function y(M,R,$=G=>G){const G=(...oe)=>fe.fire($(...oe)),ne=()=>M.on(R,G),ae=()=>M.removeListener(R,G),fe=new B({onWillAddFirstListener:ne,onDidRemoveLastListener:ae});return fe.event}n.fromNodeEventEmitter=y;function w(M,R,$=G=>G){const G=(...oe)=>fe.fire($(...oe)),ne=()=>M.addEventListener(R,G),ae=()=>M.removeEventListener(R,G),fe=new B({onWillAddFirstListener:ne,onDidRemoveLastListener:ae});return fe.event}n.fromDOMEventEmitter=w;function C(M){return new Promise(R=>t(M)(R))}n.toPromise=C;function L(M){const R=new B;return M.then($=>{R.fire($)},()=>{R.fire(void 0)}).finally(()=>{R.dispose()}),R.event}n.fromPromise=L;function x(M,R){return R(void 0),M($=>R($))}n.runAndSubscribe=x;function D(M,R){let $=null;function G(ae){$==null||$.dispose(),$=new pe,R(ae,$)}G(void 0);const ne=M(ae=>G(ae));return Ze(()=>{ne.dispose(),$==null||$.dispose()})}n.runAndSubscribeWithStore=D;class k{constructor(R,$){this._observable=R,this._counter=0,this._hasChanged=!1;const G={onWillAddFirstListener:()=>{R.addObserver(this)},onDidRemoveLastListener:()=>{R.removeObserver(this)}};this.emitter=new B(G),$&&$.add(this.emitter)}beginUpdate(R){this._counter++}handlePossibleChange(R){}handleChange(R,$){this._hasChanged=!0}endUpdate(R){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function P(M,R){return new k(M,R).emitter.event}n.fromObservable=P;function O(M){return R=>{let $=0,G=!1;const ne={beginUpdate(){$++},endUpdate(){$--,$===0&&(M.reportChanges(),G&&(G=!1,R()))},handlePossibleChange(){},handleChange(){G=!0}};return M.addObserver(ne),M.reportChanges(),{dispose(){M.removeObserver(ne)}}}}n.fromObservableLight=O})(ue||(ue={}));class hm{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${hm._idPool++}`,hm.all.add(this)}start(e){this._stopWatch=new yu,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}}hm.all=new Set;hm._idPool=0;let lge=-1;class cge{constructor(e,t=Math.random().toString(18).slice(2,5)){this.threshold=e,this.name=t,this._warnCountdown=0}dispose(){var e;(e=this._stacks)===null||e===void 0||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const s=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,s+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;let o,r=0;for(const[a,l]of this._stacks)(!o||r<l)&&(o=a,r=l);console.warn(`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${r}):`),console.warn(o)}return()=>{const o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}}class q4{static create(){var e;return new q4((e=new Error().stack)!==null&&e!==void 0?e:"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class y2{constructor(e){this.value=e}}const dge=2;let B=class{constructor(e){var t,i,s,o,r;this._size=0,this._options=e,this._leakageMon=!((t=this._options)===null||t===void 0)&&t.leakWarningThreshold?new cge((s=(i=this._options)===null||i===void 0?void 0:i.leakWarningThreshold)!==null&&s!==void 0?s:lge):void 0,this._perfMon=!((o=this._options)===null||o===void 0)&&o._profName?new hm(this._options._profName):void 0,this._deliveryQueue=(r=this._options)===null||r===void 0?void 0:r.deliveryQueue}dispose(){var e,t,i,s;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)===null||e===void 0?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)===null||t===void 0?void 0:t.onDidRemoveLastListener)===null||i===void 0||i.call(t),(s=this._leakageMon)===null||s===void 0||s.dispose())}get event(){var e;return(e=this._event)!==null&&e!==void 0||(this._event=(t,i,s)=>{var o,r,a,l,c;if(this._leakageMon&&this._size>this._leakageMon.threshold*3)return console.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`),Y.None;if(this._disposed)return Y.None;i&&(t=t.bind(i));const d=new y2(t);let u;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(d.stack=q4.create(),u=this._leakageMon.check(d.stack,this._size+1)),this._listeners?this._listeners instanceof y2?((c=this._deliveryQueue)!==null&&c!==void 0||(this._deliveryQueue=new NU),this._listeners=[this._listeners,d]):this._listeners.push(d):((r=(o=this._options)===null||o===void 0?void 0:o.onWillAddFirstListener)===null||r===void 0||r.call(o,this),this._listeners=d,(l=(a=this._options)===null||a===void 0?void 0:a.onDidAddFirstListener)===null||l===void 0||l.call(a,this)),this._size++;const h=Ze(()=>{u==null||u(),this._removeListener(d)});return s instanceof pe?s.add(h):Array.isArray(s)&&s.push(h),h}),this._event}_removeListener(e){var t,i,s,o;if((i=(t=this._options)===null||t===void 0?void 0:t.onWillRemoveListener)===null||i===void 0||i.call(t,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(o=(s=this._options)===null||s===void 0?void 0:s.onDidRemoveLastListener)===null||o===void 0||o.call(s,this),this._size=0;return}const r=this._listeners,a=r.indexOf(e);if(a===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[a]=void 0;const l=this._deliveryQueue.current===this;if(this._size*dge<=r.length){let c=0;for(let d=0;d<r.length;d++)r[d]?r[c++]=r[d]:l&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=c}}_deliver(e,t){var i;if(!e)return;const s=((i=this._options)===null||i===void 0?void 0:i.onListenerError)||mt;if(!s){e.value(t);return}try{e.value(t)}catch(o){s(o)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,s,o;if(!((t=this._deliveryQueue)===null||t===void 0)&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)===null||i===void 0||i.stop()),(s=this._perfMon)===null||s===void 0||s.start(this._size),this._listeners)if(this._listeners instanceof y2)this._deliver(this._listeners,e);else{const r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}(o=this._perfMon)===null||o===void 0||o.stop()}hasListeners(){return this._size>0}};const uge=()=>new NU;class NU{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class Rb extends B{constructor(e){super(e),this._isPaused=0,this._eventQueue=new Ds,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class RU extends Rb{constructor(e){var t;super(e),this._delay=(t=e.delay)!==null&&t!==void 0?t:100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class hge extends B{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e==null?void 0:e.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class fge{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new B({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),Ze(um(()=>{this.hasListeners&&this.unhook(t);const s=this.events.indexOf(t);this.events.splice(s,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener&&e.listener.dispose(),e.listener=null}dispose(){this.emitter.dispose()}}class G4{constructor(){this.buffers=[]}wrapEvent(e){return(t,i,s)=>e(o=>{const r=this.buffers[this.buffers.length-1];r?r.push(()=>t.call(i,o)):t.call(i,o)},void 0,s)}bufferEvents(e){const t=[];this.buffers.push(t);const i=e();return this.buffers.pop(),t.forEach(s=>s()),i}}class t9{constructor(){this.listening=!1,this.inputEvent=ue.None,this.inputEventListener=Y.None,this.emitter=new B({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const MU=Object.freeze(function(n,e){const t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}});var rn;(function(n){function e(t){return t===n.None||t===n.Cancelled||t instanceof CC?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}n.isCancellationToken=e,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ue.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:MU})})(rn||(rn={}));class CC{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?MU:(this._emitter||(this._emitter=new B),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let xr=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new CC),this._token}cancel(){this._token?this._token instanceof CC&&this._token.cancel():this._token=rn.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)===null||t===void 0||t.dispose(),this._token?this._token instanceof CC&&this._token.dispose():this._token=rn.None}};class K4{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const SC=new K4,CI=new K4,SI=new K4,PU=new Array(230),gge=Object.create(null),pge=Object.create(null),Y4=[];for(let n=0;n<=193;n++)Y4[n]=-1;(function(){const n="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",n,n],[1,1,"Hyper",0,n,0,n,n,n],[1,2,"Super",0,n,0,n,n,n],[1,3,"Fn",0,n,0,n,n,n],[1,4,"FnLock",0,n,0,n,n,n],[1,5,"Suspend",0,n,0,n,n,n],[1,6,"Resume",0,n,0,n,n,n],[1,7,"Turbo",0,n,0,n,n,n],[1,8,"Sleep",0,n,0,"VK_SLEEP",n,n],[1,9,"WakeUp",0,n,0,n,n,n],[0,10,"KeyA",31,"A",65,"VK_A",n,n],[0,11,"KeyB",32,"B",66,"VK_B",n,n],[0,12,"KeyC",33,"C",67,"VK_C",n,n],[0,13,"KeyD",34,"D",68,"VK_D",n,n],[0,14,"KeyE",35,"E",69,"VK_E",n,n],[0,15,"KeyF",36,"F",70,"VK_F",n,n],[0,16,"KeyG",37,"G",71,"VK_G",n,n],[0,17,"KeyH",38,"H",72,"VK_H",n,n],[0,18,"KeyI",39,"I",73,"VK_I",n,n],[0,19,"KeyJ",40,"J",74,"VK_J",n,n],[0,20,"KeyK",41,"K",75,"VK_K",n,n],[0,21,"KeyL",42,"L",76,"VK_L",n,n],[0,22,"KeyM",43,"M",77,"VK_M",n,n],[0,23,"KeyN",44,"N",78,"VK_N",n,n],[0,24,"KeyO",45,"O",79,"VK_O",n,n],[0,25,"KeyP",46,"P",80,"VK_P",n,n],[0,26,"KeyQ",47,"Q",81,"VK_Q",n,n],[0,27,"KeyR",48,"R",82,"VK_R",n,n],[0,28,"KeyS",49,"S",83,"VK_S",n,n],[0,29,"KeyT",50,"T",84,"VK_T",n,n],[0,30,"KeyU",51,"U",85,"VK_U",n,n],[0,31,"KeyV",52,"V",86,"VK_V",n,n],[0,32,"KeyW",53,"W",87,"VK_W",n,n],[0,33,"KeyX",54,"X",88,"VK_X",n,n],[0,34,"KeyY",55,"Y",89,"VK_Y",n,n],[0,35,"KeyZ",56,"Z",90,"VK_Z",n,n],[0,36,"Digit1",22,"1",49,"VK_1",n,n],[0,37,"Digit2",23,"2",50,"VK_2",n,n],[0,38,"Digit3",24,"3",51,"VK_3",n,n],[0,39,"Digit4",25,"4",52,"VK_4",n,n],[0,40,"Digit5",26,"5",53,"VK_5",n,n],[0,41,"Digit6",27,"6",54,"VK_6",n,n],[0,42,"Digit7",28,"7",55,"VK_7",n,n],[0,43,"Digit8",29,"8",56,"VK_8",n,n],[0,44,"Digit9",30,"9",57,"VK_9",n,n],[0,45,"Digit0",21,"0",48,"VK_0",n,n],[1,46,"Enter",3,"Enter",13,"VK_RETURN",n,n],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",n,n],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",n,n],[1,49,"Tab",2,"Tab",9,"VK_TAB",n,n],[1,50,"Space",10,"Space",32,"VK_SPACE",n,n],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,n,0,n,n,n],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",n,n],[1,64,"F1",59,"F1",112,"VK_F1",n,n],[1,65,"F2",60,"F2",113,"VK_F2",n,n],[1,66,"F3",61,"F3",114,"VK_F3",n,n],[1,67,"F4",62,"F4",115,"VK_F4",n,n],[1,68,"F5",63,"F5",116,"VK_F5",n,n],[1,69,"F6",64,"F6",117,"VK_F6",n,n],[1,70,"F7",65,"F7",118,"VK_F7",n,n],[1,71,"F8",66,"F8",119,"VK_F8",n,n],[1,72,"F9",67,"F9",120,"VK_F9",n,n],[1,73,"F10",68,"F10",121,"VK_F10",n,n],[1,74,"F11",69,"F11",122,"VK_F11",n,n],[1,75,"F12",70,"F12",123,"VK_F12",n,n],[1,76,"PrintScreen",0,n,0,n,n,n],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",n,n],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",n,n],[1,79,"Insert",19,"Insert",45,"VK_INSERT",n,n],[1,80,"Home",14,"Home",36,"VK_HOME",n,n],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",n,n],[1,82,"Delete",20,"Delete",46,"VK_DELETE",n,n],[1,83,"End",13,"End",35,"VK_END",n,n],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",n,n],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",n],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",n],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",n],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",n],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",n,n],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",n,n],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",n,n],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",n,n],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",n,n],[1,94,"NumpadEnter",3,n,0,n,n,n],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",n,n],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",n,n],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",n,n],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",n,n],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",n,n],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",n,n],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",n,n],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",n,n],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",n,n],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",n,n],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",n,n],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",n,n],[1,107,"ContextMenu",58,"ContextMenu",93,n,n,n],[1,108,"Power",0,n,0,n,n,n],[1,109,"NumpadEqual",0,n,0,n,n,n],[1,110,"F13",71,"F13",124,"VK_F13",n,n],[1,111,"F14",72,"F14",125,"VK_F14",n,n],[1,112,"F15",73,"F15",126,"VK_F15",n,n],[1,113,"F16",74,"F16",127,"VK_F16",n,n],[1,114,"F17",75,"F17",128,"VK_F17",n,n],[1,115,"F18",76,"F18",129,"VK_F18",n,n],[1,116,"F19",77,"F19",130,"VK_F19",n,n],[1,117,"F20",78,"F20",131,"VK_F20",n,n],[1,118,"F21",79,"F21",132,"VK_F21",n,n],[1,119,"F22",80,"F22",133,"VK_F22",n,n],[1,120,"F23",81,"F23",134,"VK_F23",n,n],[1,121,"F24",82,"F24",135,"VK_F24",n,n],[1,122,"Open",0,n,0,n,n,n],[1,123,"Help",0,n,0,n,n,n],[1,124,"Select",0,n,0,n,n,n],[1,125,"Again",0,n,0,n,n,n],[1,126,"Undo",0,n,0,n,n,n],[1,127,"Cut",0,n,0,n,n,n],[1,128,"Copy",0,n,0,n,n,n],[1,129,"Paste",0,n,0,n,n,n],[1,130,"Find",0,n,0,n,n,n],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",n,n],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",n,n],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",n,n],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",n,n],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",n,n],[1,136,"KanaMode",0,n,0,n,n,n],[0,137,"IntlYen",0,n,0,n,n,n],[1,138,"Convert",0,n,0,n,n,n],[1,139,"NonConvert",0,n,0,n,n,n],[1,140,"Lang1",0,n,0,n,n,n],[1,141,"Lang2",0,n,0,n,n,n],[1,142,"Lang3",0,n,0,n,n,n],[1,143,"Lang4",0,n,0,n,n,n],[1,144,"Lang5",0,n,0,n,n,n],[1,145,"Abort",0,n,0,n,n,n],[1,146,"Props",0,n,0,n,n,n],[1,147,"NumpadParenLeft",0,n,0,n,n,n],[1,148,"NumpadParenRight",0,n,0,n,n,n],[1,149,"NumpadBackspace",0,n,0,n,n,n],[1,150,"NumpadMemoryStore",0,n,0,n,n,n],[1,151,"NumpadMemoryRecall",0,n,0,n,n,n],[1,152,"NumpadMemoryClear",0,n,0,n,n,n],[1,153,"NumpadMemoryAdd",0,n,0,n,n,n],[1,154,"NumpadMemorySubtract",0,n,0,n,n,n],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",n,n],[1,156,"NumpadClearEntry",0,n,0,n,n,n],[1,0,n,5,"Ctrl",17,"VK_CONTROL",n,n],[1,0,n,4,"Shift",16,"VK_SHIFT",n,n],[1,0,n,6,"Alt",18,"VK_MENU",n,n],[1,0,n,57,"Meta",91,"VK_COMMAND",n,n],[1,157,"ControlLeft",5,n,0,"VK_LCONTROL",n,n],[1,158,"ShiftLeft",4,n,0,"VK_LSHIFT",n,n],[1,159,"AltLeft",6,n,0,"VK_LMENU",n,n],[1,160,"MetaLeft",57,n,0,"VK_LWIN",n,n],[1,161,"ControlRight",5,n,0,"VK_RCONTROL",n,n],[1,162,"ShiftRight",4,n,0,"VK_RSHIFT",n,n],[1,163,"AltRight",6,n,0,"VK_RMENU",n,n],[1,164,"MetaRight",57,n,0,"VK_RWIN",n,n],[1,165,"BrightnessUp",0,n,0,n,n,n],[1,166,"BrightnessDown",0,n,0,n,n,n],[1,167,"MediaPlay",0,n,0,n,n,n],[1,168,"MediaRecord",0,n,0,n,n,n],[1,169,"MediaFastForward",0,n,0,n,n,n],[1,170,"MediaRewind",0,n,0,n,n,n],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",n,n],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",n,n],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",n,n],[1,174,"Eject",0,n,0,n,n,n],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",n,n],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",n,n],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",n,n],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",n,n],[1,179,"LaunchApp1",0,n,0,"VK_MEDIA_LAUNCH_APP1",n,n],[1,180,"SelectTask",0,n,0,n,n,n],[1,181,"LaunchScreenSaver",0,n,0,n,n,n],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",n,n],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",n,n],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",n,n],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",n,n],[1,186,"BrowserStop",0,n,0,"VK_BROWSER_STOP",n,n],[1,187,"BrowserRefresh",0,n,0,"VK_BROWSER_REFRESH",n,n],[1,188,"BrowserFavorites",0,n,0,"VK_BROWSER_FAVORITES",n,n],[1,189,"ZoomToggle",0,n,0,n,n,n],[1,190,"MailReply",0,n,0,n,n,n],[1,191,"MailForward",0,n,0,n,n,n],[1,192,"MailSend",0,n,0,n,n,n],[1,0,n,114,"KeyInComposition",229,n,n,n],[1,0,n,116,"ABNT_C2",194,"VK_ABNT_C2",n,n],[1,0,n,96,"OEM_8",223,"VK_OEM_8",n,n],[1,0,n,0,n,0,"VK_KANA",n,n],[1,0,n,0,n,0,"VK_HANGUL",n,n],[1,0,n,0,n,0,"VK_JUNJA",n,n],[1,0,n,0,n,0,"VK_FINAL",n,n],[1,0,n,0,n,0,"VK_HANJA",n,n],[1,0,n,0,n,0,"VK_KANJI",n,n],[1,0,n,0,n,0,"VK_CONVERT",n,n],[1,0,n,0,n,0,"VK_NONCONVERT",n,n],[1,0,n,0,n,0,"VK_ACCEPT",n,n],[1,0,n,0,n,0,"VK_MODECHANGE",n,n],[1,0,n,0,n,0,"VK_SELECT",n,n],[1,0,n,0,n,0,"VK_PRINT",n,n],[1,0,n,0,n,0,"VK_EXECUTE",n,n],[1,0,n,0,n,0,"VK_SNAPSHOT",n,n],[1,0,n,0,n,0,"VK_HELP",n,n],[1,0,n,0,n,0,"VK_APPS",n,n],[1,0,n,0,n,0,"VK_PROCESSKEY",n,n],[1,0,n,0,n,0,"VK_PACKET",n,n],[1,0,n,0,n,0,"VK_DBE_SBCSCHAR",n,n],[1,0,n,0,n,0,"VK_DBE_DBCSCHAR",n,n],[1,0,n,0,n,0,"VK_ATTN",n,n],[1,0,n,0,n,0,"VK_CRSEL",n,n],[1,0,n,0,n,0,"VK_EXSEL",n,n],[1,0,n,0,n,0,"VK_EREOF",n,n],[1,0,n,0,n,0,"VK_PLAY",n,n],[1,0,n,0,n,0,"VK_ZOOM",n,n],[1,0,n,0,n,0,"VK_NONAME",n,n],[1,0,n,0,n,0,"VK_PA1",n,n],[1,0,n,0,n,0,"VK_OEM_CLEAR",n,n]],t=[],i=[];for(const s of e){const[o,r,a,l,c,d,u,h,f]=s;if(i[r]||(i[r]=!0,gge[a]=r,pge[a.toLowerCase()]=r,o&&(Y4[r]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);SC.define(l,c),CI.define(l,h||c),SI.define(l,f||h||c)}d&&(PU[d]=l)}})();var Fl;(function(n){function e(a){return SC.keyCodeToStr(a)}n.toString=e;function t(a){return SC.strToKeyCode(a)}n.fromString=t;function i(a){return CI.keyCodeToStr(a)}n.toUserSettingsUS=i;function s(a){return SI.keyCodeToStr(a)}n.toUserSettingsGeneral=s;function o(a){return CI.strToKeyCode(a)||SI.strToKeyCode(a)}n.fromUserSettings=o;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return SC.keyCodeToStr(a)}n.toElectronAccelerator=r})(Fl||(Fl={}));function Fn(n,e){const t=(e&65535)<<16>>>0;return(n|t)>>>0}var i9={};let up;if(typeof hr.vscode<"u"&&typeof hr.vscode.process<"u"){const n=hr.vscode.process;up={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"?up={get platform(){return process.platform},get arch(){return process.arch},get env(){return i9},cwd(){return i9.VSCODE_CWD||process.cwd()}}:up={get platform(){return Ps?"win32":pt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const MS=up.cwd,OU=up.env,mge=up.platform,_ge=65,bge=97,vge=90,yge=122,Cd=46,jn=47,co=92,Ic=58,wge=63;class FU extends Error{constructor(e,t,i){let s;typeof t=="string"&&t.indexOf("not ")===0?(s="must not be",t=t.replace(/^not /,"")):s="must be";const o=e.indexOf(".")!==-1?"property":"argument";let r=`The "${e}" ${o} ${s} of type ${t}`;r+=`. Received type ${typeof i}`,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function Cge(n,e){if(n===null||typeof n!="object")throw new FU(e,"Object",n)}function Qi(n,e){if(typeof n!="string")throw new FU(e,"string",n)}const wu=mge==="win32";function Ct(n){return n===jn||n===co}function xI(n){return n===jn}function Tc(n){return n>=_ge&&n<=vge||n>=bge&&n<=yge}function PS(n,e,t,i){let s="",o=0,r=-1,a=0,l=0;for(let c=0;c<=n.length;++c){if(c<n.length)l=n.charCodeAt(c);else{if(i(l))break;l=jn}if(i(l)){if(!(r===c-1||a===1))if(a===2){if(s.length<2||o!==2||s.charCodeAt(s.length-1)!==Cd||s.charCodeAt(s.length-2)!==Cd){if(s.length>2){const d=s.lastIndexOf(t);d===-1?(s="",o=0):(s=s.slice(0,d),o=s.length-1-s.lastIndexOf(t)),r=c,a=0;continue}else if(s.length!==0){s="",o=0,r=c,a=0;continue}}e&&(s+=s.length>0?`${t}..`:"..",o=2)}else s.length>0?s+=`${t}${n.slice(r+1,c)}`:s=n.slice(r+1,c),o=c-r-1;r=c,a=0}else l===Cd&&a!==-1?++a:a=-1}return s}function BU(n,e){Cge(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${n}${i}`:i}const Gs={resolve(...n){let e="",t="",i=!1;for(let s=n.length-1;s>=-1;s--){let o;if(s>=0){if(o=n[s],Qi(o,"path"),o.length===0)continue}else e.length===0?o=MS():(o=OU[`=${e}`]||MS(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===co)&&(o=`${e}\\`));const r=o.length;let a=0,l="",c=!1;const d=o.charCodeAt(0);if(r===1)Ct(d)&&(a=1,c=!0);else if(Ct(d))if(c=!0,Ct(o.charCodeAt(1))){let u=2,h=u;for(;u<r&&!Ct(o.charCodeAt(u));)u++;if(u<r&&u!==h){const f=o.slice(h,u);for(h=u;u<r&&Ct(o.charCodeAt(u));)u++;if(u<r&&u!==h){for(h=u;u<r&&!Ct(o.charCodeAt(u));)u++;(u===r||u!==h)&&(l=`\\\\${f}\\${o.slice(h,u)}`,a=u)}}}else a=1;else Tc(d)&&o.charCodeAt(1)===Ic&&(l=o.slice(0,2),a=2,r>2&&Ct(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=PS(t,!i,"\\",Ct),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){Qi(n,"path");const e=n.length;if(e===0)return".";let t=0,i,s=!1;const o=n.charCodeAt(0);if(e===1)return xI(o)?"\\":n;if(Ct(o))if(s=!0,Ct(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Ct(n.charCodeAt(a));)a++;if(a<e&&a!==l){const c=n.slice(l,a);for(l=a;a<e&&Ct(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Ct(n.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${n.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${n.slice(l,a)}`,t=a)}}}else t=1;else Tc(o)&&n.charCodeAt(1)===Ic&&(i=n.slice(0,2),t=2,e>2&&Ct(n.charCodeAt(2))&&(s=!0,t=3));let r=t<e?PS(n.slice(t),!s,"\\",Ct):"";return r.length===0&&!s&&(r="."),r.length>0&&Ct(n.charCodeAt(e-1))&&(r+="\\"),i===void 0?s?`\\${r}`:r:s?`${i}\\${r}`:`${i}${r}`},isAbsolute(n){Qi(n,"path");const e=n.length;if(e===0)return!1;const t=n.charCodeAt(0);return Ct(t)||e>2&&Tc(t)&&n.charCodeAt(1)===Ic&&Ct(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let o=0;o<n.length;++o){const r=n[o];Qi(r,"path"),r.length>0&&(e===void 0?e=t=r:e+=`\\${r}`)}if(e===void 0)return".";let i=!0,s=0;if(typeof t=="string"&&Ct(t.charCodeAt(0))){++s;const o=t.length;o>1&&Ct(t.charCodeAt(1))&&(++s,o>2&&(Ct(t.charCodeAt(2))?++s:i=!1))}if(i){for(;s<e.length&&Ct(e.charCodeAt(s));)s++;s>=2&&(e=`\\${e.slice(s)}`)}return Gs.normalize(e)},relative(n,e){if(Qi(n,"from"),Qi(e,"to"),n===e)return"";const t=Gs.resolve(n),i=Gs.resolve(e);if(t===i||(n=t.toLowerCase(),e=i.toLowerCase(),n===e))return"";let s=0;for(;s<n.length&&n.charCodeAt(s)===co;)s++;let o=n.length;for(;o-1>s&&n.charCodeAt(o-1)===co;)o--;const r=o-s;let a=0;for(;a<e.length&&e.charCodeAt(a)===co;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===co;)l--;const c=l-a,d=r<c?r:c;let u=-1,h=0;for(;h<d;h++){const g=n.charCodeAt(s+h);if(g!==e.charCodeAt(a+h))break;g===co&&(u=h)}if(h!==d){if(u===-1)return i}else{if(c>d){if(e.charCodeAt(a+h)===co)return i.slice(a+h+1);if(h===2)return i.slice(a+h)}r>d&&(n.charCodeAt(s+h)===co?u=h:h===2&&(u=3)),u===-1&&(u=0)}let f="";for(h=s+u+1;h<=o;++h)(h===o||n.charCodeAt(h)===co)&&(f+=f.length===0?"..":"\\..");return a+=u,f.length>0?`${f}${i.slice(a,l)}`:(i.charCodeAt(a)===co&&++a,i.slice(a,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;const e=Gs.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===co){if(e.charCodeAt(1)===co){const t=e.charCodeAt(2);if(t!==wge&&t!==Cd)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Tc(e.charCodeAt(0))&&e.charCodeAt(1)===Ic&&e.charCodeAt(2)===co)return`\\\\?\\${e}`;return n},dirname(n){Qi(n,"path");const e=n.length;if(e===0)return".";let t=-1,i=0;const s=n.charCodeAt(0);if(e===1)return Ct(s)?n:".";if(Ct(s)){if(t=i=1,Ct(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Ct(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Ct(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Ct(n.charCodeAt(a));)a++;if(a===e)return n;a!==l&&(t=i=a+1)}}}}else Tc(s)&&n.charCodeAt(1)===Ic&&(t=e>2&&Ct(n.charCodeAt(2))?3:2,i=t);let o=-1,r=!0;for(let a=e-1;a>=i;--a)if(Ct(n.charCodeAt(a))){if(!r){o=a;break}}else r=!1;if(o===-1){if(t===-1)return".";o=t}return n.slice(0,o)},basename(n,e){e!==void 0&&Qi(e,"ext"),Qi(n,"path");let t=0,i=-1,s=!0,o;if(n.length>=2&&Tc(n.charCodeAt(0))&&n.charCodeAt(1)===Ic&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let r=e.length-1,a=-1;for(o=n.length-1;o>=t;--o){const l=n.charCodeAt(o);if(Ct(l)){if(!s){t=o+1;break}}else a===-1&&(s=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(o=n.length-1;o>=t;--o)if(Ct(n.charCodeAt(o))){if(!s){t=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":n.slice(t,i)},extname(n){Qi(n,"path");let e=0,t=-1,i=0,s=-1,o=!0,r=0;n.length>=2&&n.charCodeAt(1)===Ic&&Tc(n.charCodeAt(0))&&(e=i=2);for(let a=n.length-1;a>=e;--a){const l=n.charCodeAt(a);if(Ct(l)){if(!o){i=a+1;break}continue}s===-1&&(o=!1,s=a+1),l===Cd?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||s===-1||r===0||r===1&&t===s-1&&t===i+1?"":n.slice(t,s)},format:BU.bind(null,"\\"),parse(n){Qi(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.length;let i=0,s=n.charCodeAt(0);if(t===1)return Ct(s)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(Ct(s)){if(i=1,Ct(n.charCodeAt(1))){let u=2,h=u;for(;u<t&&!Ct(n.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&Ct(n.charCodeAt(u));)u++;if(u<t&&u!==h){for(h=u;u<t&&!Ct(n.charCodeAt(u));)u++;u===t?i=u:u!==h&&(i=u+1)}}}}else if(Tc(s)&&n.charCodeAt(1)===Ic){if(t<=2)return e.root=e.dir=n,e;if(i=2,Ct(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;i=3}}i>0&&(e.root=n.slice(0,i));let o=-1,r=i,a=-1,l=!0,c=n.length-1,d=0;for(;c>=i;--c){if(s=n.charCodeAt(c),Ct(s)){if(!l){r=c+1;break}continue}a===-1&&(l=!1,a=c+1),s===Cd?o===-1?o=c:d!==1&&(d=1):o!==-1&&(d=-1)}return a!==-1&&(o===-1||d===0||d===1&&o===a-1&&o===r+1?e.base=e.name=n.slice(r,a):(e.name=n.slice(r,o),e.base=n.slice(r,a),e.ext=n.slice(o,a))),r>0&&r!==i?e.dir=n.slice(0,r-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Sge=(()=>{if(wu){const n=/\\/g;return()=>{const e=MS().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>MS()})(),Mi={resolve(...n){let e="",t=!1;for(let i=n.length-1;i>=-1&&!t;i--){const s=i>=0?n[i]:Sge();Qi(s,"path"),s.length!==0&&(e=`${s}/${e}`,t=s.charCodeAt(0)===jn)}return e=PS(e,!t,"/",xI),t?`/${e}`:e.length>0?e:"."},normalize(n){if(Qi(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===jn,t=n.charCodeAt(n.length-1)===jn;return n=PS(n,!e,"/",xI),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return Qi(n,"path"),n.length>0&&n.charCodeAt(0)===jn},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];Qi(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Mi.normalize(e)},relative(n,e){if(Qi(n,"from"),Qi(e,"to"),n===e||(n=Mi.resolve(n),e=Mi.resolve(e),n===e))return"";const t=1,i=n.length,s=i-t,o=1,r=e.length-o,a=s<r?s:r;let l=-1,c=0;for(;c<a;c++){const u=n.charCodeAt(t+c);if(u!==e.charCodeAt(o+c))break;u===jn&&(l=c)}if(c===a)if(r>a){if(e.charCodeAt(o+c)===jn)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else s>a&&(n.charCodeAt(t+c)===jn?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=i;++c)(c===i||n.charCodeAt(c)===jn)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(o+l)}`},toNamespacedPath(n){return n},dirname(n){if(Qi(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===jn;let t=-1,i=!0;for(let s=n.length-1;s>=1;--s)if(n.charCodeAt(s)===jn){if(!i){t=s;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&Qi(e,"ext"),Qi(n,"path");let t=0,i=-1,s=!0,o;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let r=e.length-1,a=-1;for(o=n.length-1;o>=0;--o){const l=n.charCodeAt(o);if(l===jn){if(!s){t=o+1;break}}else a===-1&&(s=!1,a=o+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=o):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(o=n.length-1;o>=0;--o)if(n.charCodeAt(o)===jn){if(!s){t=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":n.slice(t,i)},extname(n){Qi(n,"path");let e=-1,t=0,i=-1,s=!0,o=0;for(let r=n.length-1;r>=0;--r){const a=n.charCodeAt(r);if(a===jn){if(!s){t=r+1;break}continue}i===-1&&(s=!1,i=r+1),a===Cd?e===-1?e=r:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===t+1?"":n.slice(e,i)},format:BU.bind(null,"/"),parse(n){Qi(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.charCodeAt(0)===jn;let i;t?(e.root="/",i=1):i=0;let s=-1,o=0,r=-1,a=!0,l=n.length-1,c=0;for(;l>=i;--l){const d=n.charCodeAt(l);if(d===jn){if(!a){o=l+1;break}continue}r===-1&&(a=!1,r=l+1),d===Cd?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(r!==-1){const d=o===0&&t?1:o;s===-1||c===0||c===1&&s===r-1&&s===o+1?e.base=e.name=n.slice(d,r):(e.name=n.slice(d,s),e.base=n.slice(d,r),e.ext=n.slice(s,r))}return o>0?e.dir=n.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Mi.win32=Gs.win32=Gs;Mi.posix=Gs.posix=Mi;const WU=wu?Gs.normalize:Mi.normalize,xge=wu?Gs.resolve:Mi.resolve,Lge=wu?Gs.relative:Mi.relative,Dge=wu?Gs.dirname:Mi.dirname,VU=wu?Gs.basename:Mi.basename,kge=wu?Gs.extname:Mi.extname,Sd=wu?Gs.sep:Mi.sep,Ege=/^\w[\w\d+.-]*$/,Age=/^\//,Ige=/^\/\//;function Tge(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!Ege.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!Age.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Ige.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function Nge(n,e){return!n&&!e?"file":n}function Rge(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==Ur&&(e=Ur+e):e=Ur;break}return e}const yi="",Ur="/",Mge=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class je{static isUri(e){return e instanceof je?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,s,o,r=!1){typeof e=="object"?(this.scheme=e.scheme||yi,this.authority=e.authority||yi,this.path=e.path||yi,this.query=e.query||yi,this.fragment=e.fragment||yi):(this.scheme=Nge(e,r),this.authority=t||yi,this.path=Rge(this.scheme,i||yi),this.query=s||yi,this.fragment=o||yi,Tge(this,r))}get fsPath(){return OS(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:s,query:o,fragment:r}=e;return t===void 0?t=this.scheme:t===null&&(t=yi),i===void 0?i=this.authority:i===null&&(i=yi),s===void 0?s=this.path:s===null&&(s=yi),o===void 0?o=this.query:o===null&&(o=yi),r===void 0?r=this.fragment:r===null&&(r=yi),t===this.scheme&&i===this.authority&&s===this.path&&o===this.query&&r===this.fragment?this:new lg(t,i,s,o,r)}static parse(e,t=!1){const i=Mge.exec(e);return i?new lg(i[2]||yi,nw(i[4]||yi),nw(i[5]||yi),nw(i[7]||yi),nw(i[9]||yi),t):new lg(yi,yi,yi,yi,yi)}static file(e){let t=yi;if(Ps&&(e=e.replace(/\\/g,Ur)),e[0]===Ur&&e[1]===Ur){const i=e.indexOf(Ur,2);i===-1?(t=e.substring(2),e=Ur):(t=e.substring(2,i),e=e.substring(i)||Ur)}return new lg("file",t,e,yi,yi)}static from(e,t){return new lg(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return Ps&&e.scheme==="file"?i=je.file(Gs.join(OS(e,!0),...t)).path:i=Mi.join(e.path,...t),e.with({path:i})}toString(e=!1){return LI(this,e)}toJSON(){return this}static revive(e){var t,i;if(e){if(e instanceof je)return e;{const s=new lg(e);return s._formatted=(t=e.external)!==null&&t!==void 0?t:null,s._fsPath=e._sep===zU&&(i=e.fsPath)!==null&&i!==void 0?i:null,s}}else return e}}const zU=Ps?1:void 0;let lg=class extends je{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=OS(this,!1)),this._fsPath}toString(e=!1){return e?LI(this,!0):(this._formatted||(this._formatted=LI(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=zU),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const HU={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function n9(n,e,t){let i,s=-1;for(let o=0;o<n.length;o++){const r=n.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===45||r===46||r===95||r===126||e&&r===47||t&&r===91||t&&r===93||t&&r===58)s!==-1&&(i+=encodeURIComponent(n.substring(s,o)),s=-1),i!==void 0&&(i+=n.charAt(o));else{i===void 0&&(i=n.substr(0,o));const a=HU[r];a!==void 0?(s!==-1&&(i+=encodeURIComponent(n.substring(s,o)),s=-1),i+=a):s===-1&&(s=o)}}return s!==-1&&(i+=encodeURIComponent(n.substring(s))),i!==void 0?i:n}function Pge(n){let e;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i===35||i===63?(e===void 0&&(e=n.substr(0,t)),e+=HU[i]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function OS(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,Ps&&(t=t.replace(/\//g,"\\")),t}function LI(n,e){const t=e?Pge:n9;let i="",{scheme:s,authority:o,path:r,query:a,fragment:l}=n;if(s&&(i+=s,i+=":"),(o||s==="file")&&(i+=Ur,i+=Ur),o){let c=o.indexOf("@");if(c!==-1){const d=o.substr(0,c);o=o.substr(c+1),c=d.lastIndexOf(":"),c===-1?i+=t(d,!1,!1):(i+=t(d.substr(0,c),!1,!1),i+=":",i+=t(d.substr(c+1),!1,!0)),i+="@"}o=o.toLowerCase(),c=o.lastIndexOf(":"),c===-1?i+=t(o,!1,!0):(i+=t(o.substr(0,c),!1,!0),i+=o.substr(c))}if(r){if(r.length>=3&&r.charCodeAt(0)===47&&r.charCodeAt(2)===58){const c=r.charCodeAt(1);c>=65&&c<=90&&(r=`/${String.fromCharCode(c+32)}:${r.substr(3)}`)}else if(r.length>=2&&r.charCodeAt(1)===58){const c=r.charCodeAt(0);c>=65&&c<=90&&(r=`${String.fromCharCode(c+32)}:${r.substr(2)}`)}i+=t(r,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:n9(l,!1,!1)),i}function $U(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+$U(n.substr(3)):n}}const s9=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function nw(n){return n.match(s9)?n.replace(s9,e=>$U(e)):n}let V=class Xu{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Xu(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Xu.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Xu.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return Xu.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,s=t.lineNumber|0;if(i===s){const o=e.column|0,r=t.column|0;return o-r}return i-s}clone(){return new Xu(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Xu(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}},N=class an{constructor(e,t,i,s){e>i||e===i&&t>s?(this.startLineNumber=i,this.startColumn=s,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=s)}isEmpty(){return an.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return an.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return an.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return an.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return an.plusRange(this,e)}static plusRange(e,t){let i,s,o,r;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,s=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,s=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,s=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,r=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,r=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,r=e.endColumn),new an(i,s,o,r)}intersectRanges(e){return an.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,s=e.startColumn,o=e.endLineNumber,r=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,d=t.endColumn;return i<a?(i=a,s=l):i===a&&(s=Math.max(s,l)),o>c?(o=c,r=d):o===c&&(r=Math.min(r,d)),i>o||i===o&&s>r?null:new an(i,s,o,r)}equalsRange(e){return an.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return an.getEndPosition(this)}static getEndPosition(e){return new V(e.endLineNumber,e.endColumn)}getStartPosition(){return an.getStartPosition(this)}static getStartPosition(e){return new V(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new an(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new an(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return an.collapseToStart(this)}static collapseToStart(e){return new an(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return an.collapseToEnd(this)}static collapseToEnd(e){return new an(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new an(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new an(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new an(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const o=e.startLineNumber|0,r=t.startLineNumber|0;if(o===r){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,d=t.endLineNumber|0;if(c===d){const u=e.endColumn|0,h=t.endColumn|0;return u-h}return c-d}return a-l}return o-r}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},lt=class tr extends N{constructor(e,t,i,s){super(e,t,i,s),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return tr.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new tr(this.startLineNumber,this.startColumn,e,t):new tr(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new V(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new V(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new tr(e,t,this.endLineNumber,this.endColumn):new tr(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new tr(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new tr(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new tr(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new tr(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,s=e.length;i<s;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,s,o){return o===0?new tr(e,t,i,s):new tr(i,s,e,t)}};const DI=Object.create(null);function S(n,e){if(Ns(e)){const t=DI[e];if(t===void 0)throw new Error(`${n} references an unknown codicon: ${e}`);e=t}return DI[n]=e,{id:n}}function UU(){return DI}const se={add:S("add",6e4),plus:S("plus",6e4),gistNew:S("gist-new",6e4),repoCreate:S("repo-create",6e4),lightbulb:S("lightbulb",60001),lightBulb:S("light-bulb",60001),repo:S("repo",60002),repoDelete:S("repo-delete",60002),gistFork:S("gist-fork",60003),repoForked:S("repo-forked",60003),gitPullRequest:S("git-pull-request",60004),gitPullRequestAbandoned:S("git-pull-request-abandoned",60004),recordKeys:S("record-keys",60005),keyboard:S("keyboard",60005),tag:S("tag",60006),tagAdd:S("tag-add",60006),tagRemove:S("tag-remove",60006),gitPullRequestLabel:S("git-pull-request-label",60006),person:S("person",60007),personFollow:S("person-follow",60007),personOutline:S("person-outline",60007),personFilled:S("person-filled",60007),gitBranch:S("git-branch",60008),gitBranchCreate:S("git-branch-create",60008),gitBranchDelete:S("git-branch-delete",60008),sourceControl:S("source-control",60008),mirror:S("mirror",60009),mirrorPublic:S("mirror-public",60009),star:S("star",60010),starAdd:S("star-add",60010),starDelete:S("star-delete",60010),starEmpty:S("star-empty",60010),comment:S("comment",60011),commentAdd:S("comment-add",60011),alert:S("alert",60012),warning:S("warning",60012),search:S("search",60013),searchSave:S("search-save",60013),logOut:S("log-out",60014),signOut:S("sign-out",60014),logIn:S("log-in",60015),signIn:S("sign-in",60015),eye:S("eye",60016),eyeUnwatch:S("eye-unwatch",60016),eyeWatch:S("eye-watch",60016),circleFilled:S("circle-filled",60017),primitiveDot:S("primitive-dot",60017),closeDirty:S("close-dirty",60017),debugBreakpoint:S("debug-breakpoint",60017),debugBreakpointDisabled:S("debug-breakpoint-disabled",60017),debugHint:S("debug-hint",60017),primitiveSquare:S("primitive-square",60018),edit:S("edit",60019),pencil:S("pencil",60019),info:S("info",60020),issueOpened:S("issue-opened",60020),gistPrivate:S("gist-private",60021),gitForkPrivate:S("git-fork-private",60021),lock:S("lock",60021),mirrorPrivate:S("mirror-private",60021),close:S("close",60022),removeClose:S("remove-close",60022),x:S("x",60022),repoSync:S("repo-sync",60023),sync:S("sync",60023),clone:S("clone",60024),desktopDownload:S("desktop-download",60024),beaker:S("beaker",60025),microscope:S("microscope",60025),vm:S("vm",60026),deviceDesktop:S("device-desktop",60026),file:S("file",60027),fileText:S("file-text",60027),more:S("more",60028),ellipsis:S("ellipsis",60028),kebabHorizontal:S("kebab-horizontal",60028),mailReply:S("mail-reply",60029),reply:S("reply",60029),organization:S("organization",60030),organizationFilled:S("organization-filled",60030),organizationOutline:S("organization-outline",60030),newFile:S("new-file",60031),fileAdd:S("file-add",60031),newFolder:S("new-folder",60032),fileDirectoryCreate:S("file-directory-create",60032),trash:S("trash",60033),trashcan:S("trashcan",60033),history:S("history",60034),clock:S("clock",60034),folder:S("folder",60035),fileDirectory:S("file-directory",60035),symbolFolder:S("symbol-folder",60035),logoGithub:S("logo-github",60036),markGithub:S("mark-github",60036),github:S("github",60036),terminal:S("terminal",60037),console:S("console",60037),repl:S("repl",60037),zap:S("zap",60038),symbolEvent:S("symbol-event",60038),error:S("error",60039),stop:S("stop",60039),variable:S("variable",60040),symbolVariable:S("symbol-variable",60040),array:S("array",60042),symbolArray:S("symbol-array",60042),symbolModule:S("symbol-module",60043),symbolPackage:S("symbol-package",60043),symbolNamespace:S("symbol-namespace",60043),symbolObject:S("symbol-object",60043),symbolMethod:S("symbol-method",60044),symbolFunction:S("symbol-function",60044),symbolConstructor:S("symbol-constructor",60044),symbolBoolean:S("symbol-boolean",60047),symbolNull:S("symbol-null",60047),symbolNumeric:S("symbol-numeric",60048),symbolNumber:S("symbol-number",60048),symbolStructure:S("symbol-structure",60049),symbolStruct:S("symbol-struct",60049),symbolParameter:S("symbol-parameter",60050),symbolTypeParameter:S("symbol-type-parameter",60050),symbolKey:S("symbol-key",60051),symbolText:S("symbol-text",60051),symbolReference:S("symbol-reference",60052),goToFile:S("go-to-file",60052),symbolEnum:S("symbol-enum",60053),symbolValue:S("symbol-value",60053),symbolRuler:S("symbol-ruler",60054),symbolUnit:S("symbol-unit",60054),activateBreakpoints:S("activate-breakpoints",60055),archive:S("archive",60056),arrowBoth:S("arrow-both",60057),arrowDown:S("arrow-down",60058),arrowLeft:S("arrow-left",60059),arrowRight:S("arrow-right",60060),arrowSmallDown:S("arrow-small-down",60061),arrowSmallLeft:S("arrow-small-left",60062),arrowSmallRight:S("arrow-small-right",60063),arrowSmallUp:S("arrow-small-up",60064),arrowUp:S("arrow-up",60065),bell:S("bell",60066),bold:S("bold",60067),book:S("book",60068),bookmark:S("bookmark",60069),debugBreakpointConditionalUnverified:S("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:S("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:S("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:S("debug-breakpoint-data-unverified",60072),debugBreakpointData:S("debug-breakpoint-data",60073),debugBreakpointDataDisabled:S("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:S("debug-breakpoint-log-unverified",60074),debugBreakpointLog:S("debug-breakpoint-log",60075),debugBreakpointLogDisabled:S("debug-breakpoint-log-disabled",60075),briefcase:S("briefcase",60076),broadcast:S("broadcast",60077),browser:S("browser",60078),bug:S("bug",60079),calendar:S("calendar",60080),caseSensitive:S("case-sensitive",60081),check:S("check",60082),checklist:S("checklist",60083),chevronDown:S("chevron-down",60084),dropDownButton:S("drop-down-button",60084),chevronLeft:S("chevron-left",60085),chevronRight:S("chevron-right",60086),chevronUp:S("chevron-up",60087),chromeClose:S("chrome-close",60088),chromeMaximize:S("chrome-maximize",60089),chromeMinimize:S("chrome-minimize",60090),chromeRestore:S("chrome-restore",60091),circle:S("circle",60092),circleOutline:S("circle-outline",60092),debugBreakpointUnverified:S("debug-breakpoint-unverified",60092),circleSlash:S("circle-slash",60093),circuitBoard:S("circuit-board",60094),clearAll:S("clear-all",60095),clippy:S("clippy",60096),closeAll:S("close-all",60097),cloudDownload:S("cloud-download",60098),cloudUpload:S("cloud-upload",60099),code:S("code",60100),collapseAll:S("collapse-all",60101),colorMode:S("color-mode",60102),commentDiscussion:S("comment-discussion",60103),compareChanges:S("compare-changes",60157),creditCard:S("credit-card",60105),dash:S("dash",60108),dashboard:S("dashboard",60109),database:S("database",60110),debugContinue:S("debug-continue",60111),debugDisconnect:S("debug-disconnect",60112),debugPause:S("debug-pause",60113),debugRestart:S("debug-restart",60114),debugStart:S("debug-start",60115),debugStepInto:S("debug-step-into",60116),debugStepOut:S("debug-step-out",60117),debugStepOver:S("debug-step-over",60118),debugStop:S("debug-stop",60119),debug:S("debug",60120),deviceCameraVideo:S("device-camera-video",60121),deviceCamera:S("device-camera",60122),deviceMobile:S("device-mobile",60123),diffAdded:S("diff-added",60124),diffIgnored:S("diff-ignored",60125),diffModified:S("diff-modified",60126),diffRemoved:S("diff-removed",60127),diffRenamed:S("diff-renamed",60128),diff:S("diff",60129),discard:S("discard",60130),editorLayout:S("editor-layout",60131),emptyWindow:S("empty-window",60132),exclude:S("exclude",60133),extensions:S("extensions",60134),eyeClosed:S("eye-closed",60135),fileBinary:S("file-binary",60136),fileCode:S("file-code",60137),fileMedia:S("file-media",60138),filePdf:S("file-pdf",60139),fileSubmodule:S("file-submodule",60140),fileSymlinkDirectory:S("file-symlink-directory",60141),fileSymlinkFile:S("file-symlink-file",60142),fileZip:S("file-zip",60143),files:S("files",60144),filter:S("filter",60145),flame:S("flame",60146),foldDown:S("fold-down",60147),foldUp:S("fold-up",60148),fold:S("fold",60149),folderActive:S("folder-active",60150),folderOpened:S("folder-opened",60151),gear:S("gear",60152),gift:S("gift",60153),gistSecret:S("gist-secret",60154),gist:S("gist",60155),gitCommit:S("git-commit",60156),gitCompare:S("git-compare",60157),gitMerge:S("git-merge",60158),githubAction:S("github-action",60159),githubAlt:S("github-alt",60160),globe:S("globe",60161),grabber:S("grabber",60162),graph:S("graph",60163),gripper:S("gripper",60164),heart:S("heart",60165),home:S("home",60166),horizontalRule:S("horizontal-rule",60167),hubot:S("hubot",60168),inbox:S("inbox",60169),issueClosed:S("issue-closed",60324),issueReopened:S("issue-reopened",60171),issues:S("issues",60172),italic:S("italic",60173),jersey:S("jersey",60174),json:S("json",60175),bracket:S("bracket",60175),kebabVertical:S("kebab-vertical",60176),key:S("key",60177),law:S("law",60178),lightbulbAutofix:S("lightbulb-autofix",60179),linkExternal:S("link-external",60180),link:S("link",60181),listOrdered:S("list-ordered",60182),listUnordered:S("list-unordered",60183),liveShare:S("live-share",60184),loading:S("loading",60185),location:S("location",60186),mailRead:S("mail-read",60187),mail:S("mail",60188),markdown:S("markdown",60189),megaphone:S("megaphone",60190),mention:S("mention",60191),milestone:S("milestone",60192),gitPullRequestMilestone:S("git-pull-request-milestone",60192),mortarBoard:S("mortar-board",60193),move:S("move",60194),multipleWindows:S("multiple-windows",60195),mute:S("mute",60196),noNewline:S("no-newline",60197),note:S("note",60198),octoface:S("octoface",60199),openPreview:S("open-preview",60200),package:S("package",60201),paintcan:S("paintcan",60202),pin:S("pin",60203),play:S("play",60204),run:S("run",60204),plug:S("plug",60205),preserveCase:S("preserve-case",60206),preview:S("preview",60207),project:S("project",60208),pulse:S("pulse",60209),question:S("question",60210),quote:S("quote",60211),radioTower:S("radio-tower",60212),reactions:S("reactions",60213),references:S("references",60214),refresh:S("refresh",60215),regex:S("regex",60216),remoteExplorer:S("remote-explorer",60217),remote:S("remote",60218),remove:S("remove",60219),replaceAll:S("replace-all",60220),replace:S("replace",60221),repoClone:S("repo-clone",60222),repoForcePush:S("repo-force-push",60223),repoPull:S("repo-pull",60224),repoPush:S("repo-push",60225),report:S("report",60226),requestChanges:S("request-changes",60227),rocket:S("rocket",60228),rootFolderOpened:S("root-folder-opened",60229),rootFolder:S("root-folder",60230),rss:S("rss",60231),ruby:S("ruby",60232),saveAll:S("save-all",60233),saveAs:S("save-as",60234),save:S("save",60235),screenFull:S("screen-full",60236),screenNormal:S("screen-normal",60237),searchStop:S("search-stop",60238),server:S("server",60240),settingsGear:S("settings-gear",60241),settings:S("settings",60242),shield:S("shield",60243),smiley:S("smiley",60244),sortPrecedence:S("sort-precedence",60245),splitHorizontal:S("split-horizontal",60246),splitVertical:S("split-vertical",60247),squirrel:S("squirrel",60248),starFull:S("star-full",60249),starHalf:S("star-half",60250),symbolClass:S("symbol-class",60251),symbolColor:S("symbol-color",60252),symbolCustomColor:S("symbol-customcolor",60252),symbolConstant:S("symbol-constant",60253),symbolEnumMember:S("symbol-enum-member",60254),symbolField:S("symbol-field",60255),symbolFile:S("symbol-file",60256),symbolInterface:S("symbol-interface",60257),symbolKeyword:S("symbol-keyword",60258),symbolMisc:S("symbol-misc",60259),symbolOperator:S("symbol-operator",60260),symbolProperty:S("symbol-property",60261),wrench:S("wrench",60261),wrenchSubaction:S("wrench-subaction",60261),symbolSnippet:S("symbol-snippet",60262),tasklist:S("tasklist",60263),telescope:S("telescope",60264),textSize:S("text-size",60265),threeBars:S("three-bars",60266),thumbsdown:S("thumbsdown",60267),thumbsup:S("thumbsup",60268),tools:S("tools",60269),triangleDown:S("triangle-down",60270),triangleLeft:S("triangle-left",60271),triangleRight:S("triangle-right",60272),triangleUp:S("triangle-up",60273),twitter:S("twitter",60274),unfold:S("unfold",60275),unlock:S("unlock",60276),unmute:S("unmute",60277),unverified:S("unverified",60278),verified:S("verified",60279),versions:S("versions",60280),vmActive:S("vm-active",60281),vmOutline:S("vm-outline",60282),vmRunning:S("vm-running",60283),watch:S("watch",60284),whitespace:S("whitespace",60285),wholeWord:S("whole-word",60286),window:S("window",60287),wordWrap:S("word-wrap",60288),zoomIn:S("zoom-in",60289),zoomOut:S("zoom-out",60290),listFilter:S("list-filter",60291),listFlat:S("list-flat",60292),listSelection:S("list-selection",60293),selection:S("selection",60293),listTree:S("list-tree",60294),debugBreakpointFunctionUnverified:S("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:S("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:S("debug-breakpoint-function-disabled",60296),debugStackframeActive:S("debug-stackframe-active",60297),circleSmallFilled:S("circle-small-filled",60298),debugStackframeDot:S("debug-stackframe-dot",60298),debugStackframe:S("debug-stackframe",60299),debugStackframeFocused:S("debug-stackframe-focused",60299),debugBreakpointUnsupported:S("debug-breakpoint-unsupported",60300),symbolString:S("symbol-string",60301),debugReverseContinue:S("debug-reverse-continue",60302),debugStepBack:S("debug-step-back",60303),debugRestartFrame:S("debug-restart-frame",60304),callIncoming:S("call-incoming",60306),callOutgoing:S("call-outgoing",60307),menu:S("menu",60308),expandAll:S("expand-all",60309),feedback:S("feedback",60310),gitPullRequestReviewer:S("git-pull-request-reviewer",60310),groupByRefType:S("group-by-ref-type",60311),ungroupByRefType:S("ungroup-by-ref-type",60312),account:S("account",60313),gitPullRequestAssignee:S("git-pull-request-assignee",60313),bellDot:S("bell-dot",60314),debugConsole:S("debug-console",60315),library:S("library",60316),output:S("output",60317),runAll:S("run-all",60318),syncIgnored:S("sync-ignored",60319),pinned:S("pinned",60320),githubInverted:S("github-inverted",60321),debugAlt:S("debug-alt",60305),serverProcess:S("server-process",60322),serverEnvironment:S("server-environment",60323),pass:S("pass",60324),stopCircle:S("stop-circle",60325),playCircle:S("play-circle",60326),record:S("record",60327),debugAltSmall:S("debug-alt-small",60328),vmConnect:S("vm-connect",60329),cloud:S("cloud",60330),merge:S("merge",60331),exportIcon:S("export",60332),graphLeft:S("graph-left",60333),magnet:S("magnet",60334),notebook:S("notebook",60335),redo:S("redo",60336),checkAll:S("check-all",60337),pinnedDirty:S("pinned-dirty",60338),passFilled:S("pass-filled",60339),circleLargeFilled:S("circle-large-filled",60340),circleLarge:S("circle-large",60341),circleLargeOutline:S("circle-large-outline",60341),combine:S("combine",60342),gather:S("gather",60342),table:S("table",60343),variableGroup:S("variable-group",60344),typeHierarchy:S("type-hierarchy",60345),typeHierarchySub:S("type-hierarchy-sub",60346),typeHierarchySuper:S("type-hierarchy-super",60347),gitPullRequestCreate:S("git-pull-request-create",60348),runAbove:S("run-above",60349),runBelow:S("run-below",60350),notebookTemplate:S("notebook-template",60351),debugRerun:S("debug-rerun",60352),workspaceTrusted:S("workspace-trusted",60353),workspaceUntrusted:S("workspace-untrusted",60354),workspaceUnspecified:S("workspace-unspecified",60355),terminalCmd:S("terminal-cmd",60356),terminalDebian:S("terminal-debian",60357),terminalLinux:S("terminal-linux",60358),terminalPowershell:S("terminal-powershell",60359),terminalTmux:S("terminal-tmux",60360),terminalUbuntu:S("terminal-ubuntu",60361),terminalBash:S("terminal-bash",60362),arrowSwap:S("arrow-swap",60363),copy:S("copy",60364),personAdd:S("person-add",60365),filterFilled:S("filter-filled",60366),wand:S("wand",60367),debugLineByLine:S("debug-line-by-line",60368),inspect:S("inspect",60369),layers:S("layers",60370),layersDot:S("layers-dot",60371),layersActive:S("layers-active",60372),compass:S("compass",60373),compassDot:S("compass-dot",60374),compassActive:S("compass-active",60375),azure:S("azure",60376),issueDraft:S("issue-draft",60377),gitPullRequestClosed:S("git-pull-request-closed",60378),gitPullRequestDraft:S("git-pull-request-draft",60379),debugAll:S("debug-all",60380),debugCoverage:S("debug-coverage",60381),runErrors:S("run-errors",60382),folderLibrary:S("folder-library",60383),debugContinueSmall:S("debug-continue-small",60384),beakerStop:S("beaker-stop",60385),graphLine:S("graph-line",60386),graphScatter:S("graph-scatter",60387),pieChart:S("pie-chart",60388),bracketDot:S("bracket-dot",60389),bracketError:S("bracket-error",60390),lockSmall:S("lock-small",60391),azureDevops:S("azure-devops",60392),verifiedFilled:S("verified-filled",60393),newLine:S("newline",60394),layout:S("layout",60395),layoutActivitybarLeft:S("layout-activitybar-left",60396),layoutActivitybarRight:S("layout-activitybar-right",60397),layoutPanelLeft:S("layout-panel-left",60398),layoutPanelCenter:S("layout-panel-center",60399),layoutPanelJustify:S("layout-panel-justify",60400),layoutPanelRight:S("layout-panel-right",60401),layoutPanel:S("layout-panel",60402),layoutSidebarLeft:S("layout-sidebar-left",60403),layoutSidebarRight:S("layout-sidebar-right",60404),layoutStatusbar:S("layout-statusbar",60405),layoutMenubar:S("layout-menubar",60406),layoutCentered:S("layout-centered",60407),layoutSidebarRightOff:S("layout-sidebar-right-off",60416),layoutPanelOff:S("layout-panel-off",60417),layoutSidebarLeftOff:S("layout-sidebar-left-off",60418),target:S("target",60408),indent:S("indent",60409),recordSmall:S("record-small",60410),errorSmall:S("error-small",60411),arrowCircleDown:S("arrow-circle-down",60412),arrowCircleLeft:S("arrow-circle-left",60413),arrowCircleRight:S("arrow-circle-right",60414),arrowCircleUp:S("arrow-circle-up",60415),heartFilled:S("heart-filled",60420),map:S("map",60421),mapFilled:S("map-filled",60422),circleSmall:S("circle-small",60423),bellSlash:S("bell-slash",60424),bellSlashDot:S("bell-slash-dot",60425),commentUnresolved:S("comment-unresolved",60426),gitPullRequestGoToChanges:S("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:S("git-pull-request-new-changes",60428),searchFuzzy:S("search-fuzzy",60429),commentDraft:S("comment-draft",60430),send:S("send",60431),sparkle:S("sparkle",60432),insert:S("insert",60433),mic:S("mic",60434),dialogError:S("dialog-error","error"),dialogWarning:S("dialog-warning","warning"),dialogInfo:S("dialog-info","info"),dialogClose:S("dialog-close","close"),treeItemExpanded:S("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:S("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:S("tree-filter-on-type-off","list-selection"),treeFilterClear:S("tree-filter-clear","close"),treeItemLoading:S("tree-item-loading","loading"),menuSelection:S("menu-selection","check"),menuSubmenu:S("menu-submenu","chevron-right"),menuBarMore:S("menubar-more","more"),scrollbarButtonLeft:S("scrollbar-button-left","triangle-left"),scrollbarButtonRight:S("scrollbar-button-right","triangle-right"),scrollbarButtonUp:S("scrollbar-button-up","triangle-up"),scrollbarButtonDown:S("scrollbar-button-down","triangle-down"),toolBarMore:S("toolbar-more","more"),quickInputBack:S("quick-input-back","arrow-left")};var kI=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let Oge=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Ze(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var i;(i=this._factories.get(e))===null||i===void 0||i.dispose();const s=new Fge(this,e,t);return this._factories.set(e,s),Ze(()=>{const o=this._factories.get(e);!o||o!==s||(this._factories.delete(e),o.dispose())})}getOrCreate(e){return kI(this,void 0,void 0,function*(){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(yield i.resolve(),this.get(e))})}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class Fge extends Y{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}resolve(){return kI(this,void 0,void 0,function*(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise})}_create(){return kI(this,void 0,void 0,function*(){const e=yield this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))})}}let Mb=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class Z4{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class fD{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var o9;(function(n){const e=new Map;e.set(0,se.symbolMethod),e.set(1,se.symbolFunction),e.set(2,se.symbolConstructor),e.set(3,se.symbolField),e.set(4,se.symbolVariable),e.set(5,se.symbolClass),e.set(6,se.symbolStruct),e.set(7,se.symbolInterface),e.set(8,se.symbolModule),e.set(9,se.symbolProperty),e.set(10,se.symbolEvent),e.set(11,se.symbolOperator),e.set(12,se.symbolUnit),e.set(13,se.symbolValue),e.set(15,se.symbolEnum),e.set(14,se.symbolConstant),e.set(15,se.symbolEnum),e.set(16,se.symbolEnumMember),e.set(17,se.symbolKeyword),e.set(27,se.symbolSnippet),e.set(18,se.symbolText),e.set(19,se.symbolColor),e.set(20,se.symbolFile),e.set(21,se.symbolReference),e.set(22,se.symbolCustomColor),e.set(23,se.symbolFolder),e.set(24,se.symbolTypeParameter),e.set(25,se.account),e.set(26,se.issues);function t(o){let r=e.get(o);return r||(console.info("No codicon found for CompletionItemKind "+o),r=se.symbolProperty),r}n.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function s(o,r){let a=i.get(o);return typeof a>"u"&&!r&&(a=9),a}n.fromString=s})(o9||(o9={}));var EI;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(EI||(EI={}));class Bge{constructor(e,t,i,s){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=s}equals(e){return N.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var r9;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(r9||(r9={}));var a9;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(a9||(a9={}));function Wge(n){return n&&je.isUri(n.uri)&&N.isIRange(n.range)&&(N.isIRange(n.originSelectionRange)||N.isIRange(n.targetSelectionRange))}m("Array","array"),m("Boolean","boolean"),m("Class","class"),m("Constant","constant"),m("Constructor","constructor"),m("Enum","enumeration"),m("EnumMember","enumeration member"),m("Event","event"),m("Field","field"),m("File","file"),m("Function","function"),m("Interface","interface"),m("Key","key"),m("Method","method"),m("Module","module"),m("Namespace","namespace"),m("Null","null"),m("Number","number"),m("Object","object"),m("Operator","operator"),m("Package","package"),m("Property","property"),m("String","string"),m("Struct","struct"),m("TypeParameter","type parameter"),m("Variable","variable");var AI;(function(n){const e=new Map;e.set(0,se.symbolFile),e.set(1,se.symbolModule),e.set(2,se.symbolNamespace),e.set(3,se.symbolPackage),e.set(4,se.symbolClass),e.set(5,se.symbolMethod),e.set(6,se.symbolProperty),e.set(7,se.symbolField),e.set(8,se.symbolConstructor),e.set(9,se.symbolEnum),e.set(10,se.symbolInterface),e.set(11,se.symbolFunction),e.set(12,se.symbolVariable),e.set(13,se.symbolConstant),e.set(14,se.symbolString),e.set(15,se.symbolNumber),e.set(16,se.symbolBoolean),e.set(17,se.symbolArray),e.set(18,se.symbolObject),e.set(19,se.symbolKey),e.set(20,se.symbolNull),e.set(21,se.symbolEnumMember),e.set(22,se.symbolStruct),e.set(23,se.symbolEvent),e.set(24,se.symbolOperator),e.set(25,se.symbolTypeParameter);function t(i){let s=e.get(i);return s||(console.info("No codicon found for SymbolKind "+i),s=se.symbolProperty),s}n.toIcon=t})(AI||(AI={}));class as{static fromValue(e){switch(e){case"comment":return as.Comment;case"imports":return as.Imports;case"region":return as.Region}return new as(e)}constructor(e){this.value=e}}as.Comment=new as("comment");as.Imports=new as("imports");as.Region=new as("region");var l9;(function(n){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}n.is=e})(l9||(l9={}));var c9;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(c9||(c9={}));class Vge{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const Si=new Oge;var II;(function(n){n[n.Unknown=0]="Unknown",n[n.Disabled=1]="Disabled",n[n.Enabled=2]="Enabled"})(II||(II={}));var TI;(function(n){n[n.Invoke=1]="Invoke",n[n.Auto=2]="Auto"})(TI||(TI={}));var NI;(function(n){n[n.None=0]="None",n[n.KeepWhitespace=1]="KeepWhitespace",n[n.InsertAsSnippet=4]="InsertAsSnippet"})(NI||(NI={}));var RI;(function(n){n[n.Method=0]="Method",n[n.Function=1]="Function",n[n.Constructor=2]="Constructor",n[n.Field=3]="Field",n[n.Variable=4]="Variable",n[n.Class=5]="Class",n[n.Struct=6]="Struct",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Event=10]="Event",n[n.Operator=11]="Operator",n[n.Unit=12]="Unit",n[n.Value=13]="Value",n[n.Constant=14]="Constant",n[n.Enum=15]="Enum",n[n.EnumMember=16]="EnumMember",n[n.Keyword=17]="Keyword",n[n.Text=18]="Text",n[n.Color=19]="Color",n[n.File=20]="File",n[n.Reference=21]="Reference",n[n.Customcolor=22]="Customcolor",n[n.Folder=23]="Folder",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue",n[n.Snippet=27]="Snippet"})(RI||(RI={}));var MI;(function(n){n[n.Deprecated=1]="Deprecated"})(MI||(MI={}));var PI;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(PI||(PI={}));var OI;(function(n){n[n.EXACT=0]="EXACT",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(OI||(OI={}));var FI;(function(n){n[n.NotSet=0]="NotSet",n[n.ContentFlush=1]="ContentFlush",n[n.RecoverFromMarkers=2]="RecoverFromMarkers",n[n.Explicit=3]="Explicit",n[n.Paste=4]="Paste",n[n.Undo=5]="Undo",n[n.Redo=6]="Redo"})(FI||(FI={}));var BI;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(BI||(BI={}));var WI;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(WI||(WI={}));var VI;(function(n){n[n.None=0]="None",n[n.Keep=1]="Keep",n[n.Brackets=2]="Brackets",n[n.Advanced=3]="Advanced",n[n.Full=4]="Full"})(VI||(VI={}));var zI;(function(n){n[n.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",n[n.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",n[n.accessibilitySupport=2]="accessibilitySupport",n[n.accessibilityPageSize=3]="accessibilityPageSize",n[n.ariaLabel=4]="ariaLabel",n[n.ariaRequired=5]="ariaRequired",n[n.autoClosingBrackets=6]="autoClosingBrackets",n[n.autoClosingComments=7]="autoClosingComments",n[n.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",n[n.autoClosingDelete=9]="autoClosingDelete",n[n.autoClosingOvertype=10]="autoClosingOvertype",n[n.autoClosingQuotes=11]="autoClosingQuotes",n[n.autoIndent=12]="autoIndent",n[n.automaticLayout=13]="automaticLayout",n[n.autoSurround=14]="autoSurround",n[n.bracketPairColorization=15]="bracketPairColorization",n[n.guides=16]="guides",n[n.codeLens=17]="codeLens",n[n.codeLensFontFamily=18]="codeLensFontFamily",n[n.codeLensFontSize=19]="codeLensFontSize",n[n.colorDecorators=20]="colorDecorators",n[n.colorDecoratorsLimit=21]="colorDecoratorsLimit",n[n.columnSelection=22]="columnSelection",n[n.comments=23]="comments",n[n.contextmenu=24]="contextmenu",n[n.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",n[n.cursorBlinking=26]="cursorBlinking",n[n.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",n[n.cursorStyle=28]="cursorStyle",n[n.cursorSurroundingLines=29]="cursorSurroundingLines",n[n.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",n[n.cursorWidth=31]="cursorWidth",n[n.disableLayerHinting=32]="disableLayerHinting",n[n.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",n[n.domReadOnly=34]="domReadOnly",n[n.dragAndDrop=35]="dragAndDrop",n[n.dropIntoEditor=36]="dropIntoEditor",n[n.emptySelectionClipboard=37]="emptySelectionClipboard",n[n.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",n[n.extraEditorClassName=39]="extraEditorClassName",n[n.fastScrollSensitivity=40]="fastScrollSensitivity",n[n.find=41]="find",n[n.fixedOverflowWidgets=42]="fixedOverflowWidgets",n[n.folding=43]="folding",n[n.foldingStrategy=44]="foldingStrategy",n[n.foldingHighlight=45]="foldingHighlight",n[n.foldingImportsByDefault=46]="foldingImportsByDefault",n[n.foldingMaximumRegions=47]="foldingMaximumRegions",n[n.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",n[n.fontFamily=49]="fontFamily",n[n.fontInfo=50]="fontInfo",n[n.fontLigatures=51]="fontLigatures",n[n.fontSize=52]="fontSize",n[n.fontWeight=53]="fontWeight",n[n.fontVariations=54]="fontVariations",n[n.formatOnPaste=55]="formatOnPaste",n[n.formatOnType=56]="formatOnType",n[n.glyphMargin=57]="glyphMargin",n[n.gotoLocation=58]="gotoLocation",n[n.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",n[n.hover=60]="hover",n[n.inDiffEditor=61]="inDiffEditor",n[n.inlineSuggest=62]="inlineSuggest",n[n.letterSpacing=63]="letterSpacing",n[n.lightbulb=64]="lightbulb",n[n.lineDecorationsWidth=65]="lineDecorationsWidth",n[n.lineHeight=66]="lineHeight",n[n.lineNumbers=67]="lineNumbers",n[n.lineNumbersMinChars=68]="lineNumbersMinChars",n[n.linkedEditing=69]="linkedEditing",n[n.links=70]="links",n[n.matchBrackets=71]="matchBrackets",n[n.minimap=72]="minimap",n[n.mouseStyle=73]="mouseStyle",n[n.mouseWheelScrollSensitivity=74]="mouseWheelScrollSensitivity",n[n.mouseWheelZoom=75]="mouseWheelZoom",n[n.multiCursorMergeOverlapping=76]="multiCursorMergeOverlapping",n[n.multiCursorModifier=77]="multiCursorModifier",n[n.multiCursorPaste=78]="multiCursorPaste",n[n.multiCursorLimit=79]="multiCursorLimit",n[n.occurrencesHighlight=80]="occurrencesHighlight",n[n.overviewRulerBorder=81]="overviewRulerBorder",n[n.overviewRulerLanes=82]="overviewRulerLanes",n[n.padding=83]="padding",n[n.pasteAs=84]="pasteAs",n[n.parameterHints=85]="parameterHints",n[n.peekWidgetDefaultFocus=86]="peekWidgetDefaultFocus",n[n.definitionLinkOpensInPeek=87]="definitionLinkOpensInPeek",n[n.quickSuggestions=88]="quickSuggestions",n[n.quickSuggestionsDelay=89]="quickSuggestionsDelay",n[n.readOnly=90]="readOnly",n[n.readOnlyMessage=91]="readOnlyMessage",n[n.renameOnType=92]="renameOnType",n[n.renderControlCharacters=93]="renderControlCharacters",n[n.renderFinalNewline=94]="renderFinalNewline",n[n.renderLineHighlight=95]="renderLineHighlight",n[n.renderLineHighlightOnlyWhenFocus=96]="renderLineHighlightOnlyWhenFocus",n[n.renderValidationDecorations=97]="renderValidationDecorations",n[n.renderWhitespace=98]="renderWhitespace",n[n.revealHorizontalRightPadding=99]="revealHorizontalRightPadding",n[n.roundedSelection=100]="roundedSelection",n[n.rulers=101]="rulers",n[n.scrollbar=102]="scrollbar",n[n.scrollBeyondLastColumn=103]="scrollBeyondLastColumn",n[n.scrollBeyondLastLine=104]="scrollBeyondLastLine",n[n.scrollPredominantAxis=105]="scrollPredominantAxis",n[n.selectionClipboard=106]="selectionClipboard",n[n.selectionHighlight=107]="selectionHighlight",n[n.selectOnLineNumbers=108]="selectOnLineNumbers",n[n.showFoldingControls=109]="showFoldingControls",n[n.showUnused=110]="showUnused",n[n.snippetSuggestions=111]="snippetSuggestions",n[n.smartSelect=112]="smartSelect",n[n.smoothScrolling=113]="smoothScrolling",n[n.stickyScroll=114]="stickyScroll",n[n.stickyTabStops=115]="stickyTabStops",n[n.stopRenderingLineAfter=116]="stopRenderingLineAfter",n[n.suggest=117]="suggest",n[n.suggestFontSize=118]="suggestFontSize",n[n.suggestLineHeight=119]="suggestLineHeight",n[n.suggestOnTriggerCharacters=120]="suggestOnTriggerCharacters",n[n.suggestSelection=121]="suggestSelection",n[n.tabCompletion=122]="tabCompletion",n[n.tabIndex=123]="tabIndex",n[n.unicodeHighlighting=124]="unicodeHighlighting",n[n.unusualLineTerminators=125]="unusualLineTerminators",n[n.useShadowDOM=126]="useShadowDOM",n[n.useTabStops=127]="useTabStops",n[n.wordBreak=128]="wordBreak",n[n.wordSeparators=129]="wordSeparators",n[n.wordWrap=130]="wordWrap",n[n.wordWrapBreakAfterCharacters=131]="wordWrapBreakAfterCharacters",n[n.wordWrapBreakBeforeCharacters=132]="wordWrapBreakBeforeCharacters",n[n.wordWrapColumn=133]="wordWrapColumn",n[n.wordWrapOverride1=134]="wordWrapOverride1",n[n.wordWrapOverride2=135]="wordWrapOverride2",n[n.wrappingIndent=136]="wrappingIndent",n[n.wrappingStrategy=137]="wrappingStrategy",n[n.showDeprecated=138]="showDeprecated",n[n.inlayHints=139]="inlayHints",n[n.editorClassName=140]="editorClassName",n[n.pixelRatio=141]="pixelRatio",n[n.tabFocusMode=142]="tabFocusMode",n[n.layoutInfo=143]="layoutInfo",n[n.wrappingInfo=144]="wrappingInfo",n[n.defaultColorDecorators=145]="defaultColorDecorators",n[n.colorDecoratorsActivatedOn=146]="colorDecoratorsActivatedOn",n[n.inlineCompletionsAccessibilityVerbose=147]="inlineCompletionsAccessibilityVerbose"})(zI||(zI={}));var HI;(function(n){n[n.TextDefined=0]="TextDefined",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(HI||(HI={}));var $I;(function(n){n[n.LF=0]="LF",n[n.CRLF=1]="CRLF"})($I||($I={}));var UI;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(UI||(UI={}));var jI;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(jI||(jI={}));var qI;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(qI||(qI={}));var GI;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(GI||(GI={}));var KI;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(KI||(KI={}));var YI;(function(n){n[n.DependsOnKbLayout=-1]="DependsOnKbLayout",n[n.Unknown=0]="Unknown",n[n.Backspace=1]="Backspace",n[n.Tab=2]="Tab",n[n.Enter=3]="Enter",n[n.Shift=4]="Shift",n[n.Ctrl=5]="Ctrl",n[n.Alt=6]="Alt",n[n.PauseBreak=7]="PauseBreak",n[n.CapsLock=8]="CapsLock",n[n.Escape=9]="Escape",n[n.Space=10]="Space",n[n.PageUp=11]="PageUp",n[n.PageDown=12]="PageDown",n[n.End=13]="End",n[n.Home=14]="Home",n[n.LeftArrow=15]="LeftArrow",n[n.UpArrow=16]="UpArrow",n[n.RightArrow=17]="RightArrow",n[n.DownArrow=18]="DownArrow",n[n.Insert=19]="Insert",n[n.Delete=20]="Delete",n[n.Digit0=21]="Digit0",n[n.Digit1=22]="Digit1",n[n.Digit2=23]="Digit2",n[n.Digit3=24]="Digit3",n[n.Digit4=25]="Digit4",n[n.Digit5=26]="Digit5",n[n.Digit6=27]="Digit6",n[n.Digit7=28]="Digit7",n[n.Digit8=29]="Digit8",n[n.Digit9=30]="Digit9",n[n.KeyA=31]="KeyA",n[n.KeyB=32]="KeyB",n[n.KeyC=33]="KeyC",n[n.KeyD=34]="KeyD",n[n.KeyE=35]="KeyE",n[n.KeyF=36]="KeyF",n[n.KeyG=37]="KeyG",n[n.KeyH=38]="KeyH",n[n.KeyI=39]="KeyI",n[n.KeyJ=40]="KeyJ",n[n.KeyK=41]="KeyK",n[n.KeyL=42]="KeyL",n[n.KeyM=43]="KeyM",n[n.KeyN=44]="KeyN",n[n.KeyO=45]="KeyO",n[n.KeyP=46]="KeyP",n[n.KeyQ=47]="KeyQ",n[n.KeyR=48]="KeyR",n[n.KeyS=49]="KeyS",n[n.KeyT=50]="KeyT",n[n.KeyU=51]="KeyU",n[n.KeyV=52]="KeyV",n[n.KeyW=53]="KeyW",n[n.KeyX=54]="KeyX",n[n.KeyY=55]="KeyY",n[n.KeyZ=56]="KeyZ",n[n.Meta=57]="Meta",n[n.ContextMenu=58]="ContextMenu",n[n.F1=59]="F1",n[n.F2=60]="F2",n[n.F3=61]="F3",n[n.F4=62]="F4",n[n.F5=63]="F5",n[n.F6=64]="F6",n[n.F7=65]="F7",n[n.F8=66]="F8",n[n.F9=67]="F9",n[n.F10=68]="F10",n[n.F11=69]="F11",n[n.F12=70]="F12",n[n.F13=71]="F13",n[n.F14=72]="F14",n[n.F15=73]="F15",n[n.F16=74]="F16",n[n.F17=75]="F17",n[n.F18=76]="F18",n[n.F19=77]="F19",n[n.F20=78]="F20",n[n.F21=79]="F21",n[n.F22=80]="F22",n[n.F23=81]="F23",n[n.F24=82]="F24",n[n.NumLock=83]="NumLock",n[n.ScrollLock=84]="ScrollLock",n[n.Semicolon=85]="Semicolon",n[n.Equal=86]="Equal",n[n.Comma=87]="Comma",n[n.Minus=88]="Minus",n[n.Period=89]="Period",n[n.Slash=90]="Slash",n[n.Backquote=91]="Backquote",n[n.BracketLeft=92]="BracketLeft",n[n.Backslash=93]="Backslash",n[n.BracketRight=94]="BracketRight",n[n.Quote=95]="Quote",n[n.OEM_8=96]="OEM_8",n[n.IntlBackslash=97]="IntlBackslash",n[n.Numpad0=98]="Numpad0",n[n.Numpad1=99]="Numpad1",n[n.Numpad2=100]="Numpad2",n[n.Numpad3=101]="Numpad3",n[n.Numpad4=102]="Numpad4",n[n.Numpad5=103]="Numpad5",n[n.Numpad6=104]="Numpad6",n[n.Numpad7=105]="Numpad7",n[n.Numpad8=106]="Numpad8",n[n.Numpad9=107]="Numpad9",n[n.NumpadMultiply=108]="NumpadMultiply",n[n.NumpadAdd=109]="NumpadAdd",n[n.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",n[n.NumpadSubtract=111]="NumpadSubtract",n[n.NumpadDecimal=112]="NumpadDecimal",n[n.NumpadDivide=113]="NumpadDivide",n[n.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",n[n.ABNT_C1=115]="ABNT_C1",n[n.ABNT_C2=116]="ABNT_C2",n[n.AudioVolumeMute=117]="AudioVolumeMute",n[n.AudioVolumeUp=118]="AudioVolumeUp",n[n.AudioVolumeDown=119]="AudioVolumeDown",n[n.BrowserSearch=120]="BrowserSearch",n[n.BrowserHome=121]="BrowserHome",n[n.BrowserBack=122]="BrowserBack",n[n.BrowserForward=123]="BrowserForward",n[n.MediaTrackNext=124]="MediaTrackNext",n[n.MediaTrackPrevious=125]="MediaTrackPrevious",n[n.MediaStop=126]="MediaStop",n[n.MediaPlayPause=127]="MediaPlayPause",n[n.LaunchMediaPlayer=128]="LaunchMediaPlayer",n[n.LaunchMail=129]="LaunchMail",n[n.LaunchApp2=130]="LaunchApp2",n[n.Clear=131]="Clear",n[n.MAX_VALUE=132]="MAX_VALUE"})(YI||(YI={}));var ZI;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(ZI||(ZI={}));var XI;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(XI||(XI={}));var QI;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(QI||(QI={}));var JI;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.TEXTAREA=1]="TEXTAREA",n[n.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",n[n.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",n[n.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",n[n.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",n[n.CONTENT_TEXT=6]="CONTENT_TEXT",n[n.CONTENT_EMPTY=7]="CONTENT_EMPTY",n[n.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",n[n.CONTENT_WIDGET=9]="CONTENT_WIDGET",n[n.OVERVIEW_RULER=10]="OVERVIEW_RULER",n[n.SCROLLBAR=11]="SCROLLBAR",n[n.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",n[n.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(JI||(JI={}));var eT;(function(n){n[n.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",n[n.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",n[n.TOP_CENTER=2]="TOP_CENTER"})(eT||(eT={}));var tT;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(tT||(tT={}));var iT;(function(n){n[n.Left=0]="Left",n[n.Right=1]="Right",n[n.None=2]="None",n[n.LeftOfInjectedText=3]="LeftOfInjectedText",n[n.RightOfInjectedText=4]="RightOfInjectedText"})(iT||(iT={}));var nT;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval",n[n.Custom=4]="Custom"})(nT||(nT={}));var sT;(function(n){n[n.None=0]="None",n[n.Text=1]="Text",n[n.Blocks=2]="Blocks"})(sT||(sT={}));var oT;(function(n){n[n.Smooth=0]="Smooth",n[n.Immediate=1]="Immediate"})(oT||(oT={}));var rT;(function(n){n[n.Auto=1]="Auto",n[n.Hidden=2]="Hidden",n[n.Visible=3]="Visible"})(rT||(rT={}));var aT;(function(n){n[n.LTR=0]="LTR",n[n.RTL=1]="RTL"})(aT||(aT={}));var lT;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(lT||(lT={}));var cT;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(cT||(cT={}));var dT;(function(n){n[n.Deprecated=1]="Deprecated"})(dT||(dT={}));var uT;(function(n){n[n.Hidden=0]="Hidden",n[n.Blink=1]="Blink",n[n.Smooth=2]="Smooth",n[n.Phase=3]="Phase",n[n.Expand=4]="Expand",n[n.Solid=5]="Solid"})(uT||(uT={}));var hT;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(hT||(hT={}));var fT;(function(n){n[n.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",n[n.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",n[n.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",n[n.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(fT||(fT={}));var gT;(function(n){n[n.None=0]="None",n[n.Same=1]="Same",n[n.Indent=2]="Indent",n[n.DeepIndent=3]="DeepIndent"})(gT||(gT={}));let ey=class{static chord(e,t){return Fn(e,t)}};ey.CtrlCmd=2048;ey.Shift=1024;ey.Alt=512;ey.WinCtrl=256;function jU(){return{editor:void 0,languages:void 0,CancellationTokenSource:xr,Emitter:B,KeyCode:YI,KeyMod:ey,Position:V,Range:N,Selection:lt,SelectionDirection:aT,MarkerSeverity:ZI,MarkerTag:XI,Uri:je,Token:Mb}}class zge{constructor(e){this.fn=e,this.lastCache=void 0,this.lastArgKey=void 0}get(e){const t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.fn(e)),this.lastCache}}class d9{get cachedValues(){return this._map}constructor(e){this.fn=e,this._map=new Map}get(e){if(this._map.has(e))return this._map.get(e);const t=this.fn(e);return this._map.set(e,t),t}}class Mf{constructor(e){this.executor=e,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var fm;function Hge(n){return!n||typeof n!="string"?!0:n.trim().length===0}const $ge=/{(\d+)}/g;function Pb(n,...e){return e.length===0?n:n.replace($ge,function(t,i){const s=parseInt(i,10);return isNaN(s)||s<0||s>=e.length?t:e[s]})}function FS(n){return n.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function br(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function gD(n,e){if(!n||!e)return n;const t=e.length;if(t===0||n.length===0)return n;let i=0;for(;n.indexOf(e,i)===i;)i=i+t;return n.substring(i)}function Uge(n,e){if(!n||!e)return n;const t=e.length,i=n.length;if(t===0||i===0)return n;let s=i,o=-1;for(;o=n.lastIndexOf(e,s-1),!(o===-1||o+t!==s);){if(o===0)return"";s=o}return n.substring(0,s)}function jge(n){return n.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function qU(n,e,t={}){if(!n)throw new Error("Cannot create regex from empty string");e||(n=br(n)),t.wholeWord&&(/\B/.test(n.charAt(0))||(n="\\b"+n),/\B/.test(n.charAt(n.length-1))||(n=n+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(n,i)}function qge(n){return n.source==="^"||n.source==="^$"||n.source==="$"||n.source==="^\\s*$"?!1:!!(n.exec("")&&n.lastIndex===0)}function Pf(n){return n.split(/\r\n|\r|\n/)}function Zs(n){for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function zs(n,e=0,t=n.length){for(let i=e;i<t;i++){const s=n.charCodeAt(i);if(s!==32&&s!==9)return n.substring(e,i)}return n.substring(e,t)}function Of(n,e=n.length-1){for(let t=e;t>=0;t--){const i=n.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function Ob(n,e){return n<e?-1:n>e?1:0}function X4(n,e,t=0,i=n.length,s=0,o=e.length){for(;t<i&&s<o;t++,s++){const l=n.charCodeAt(t),c=e.charCodeAt(s);if(l<c)return-1;if(l>c)return 1}const r=i-t,a=o-s;return r<a?-1:r>a?1:0}function u9(n,e){return ty(n,e,0,n.length,0,e.length)}function ty(n,e,t=0,i=n.length,s=0,o=e.length){for(;t<i&&s<o;t++,s++){let l=n.charCodeAt(t),c=e.charCodeAt(s);if(l===c)continue;if(l>=128||c>=128)return X4(n.toLowerCase(),e.toLowerCase(),t,i,s,o);Mg(l)&&(l-=32),Mg(c)&&(c-=32);const d=l-c;if(d!==0)return d}const r=i-t,a=o-s;return r<a?-1:r>a?1:0}function sw(n){return n>=48&&n<=57}function Mg(n){return n>=97&&n<=122}function Hc(n){return n>=65&&n<=90}function Pg(n,e){return n.length===e.length&&ty(n,e)===0}function Q4(n,e){const t=e.length;return e.length>n.length?!1:ty(n,e,0,t)===0}function BS(n,e){const t=Math.min(n.length,e.length);let i;for(i=0;i<t;i++)if(n.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function pT(n,e){const t=Math.min(n.length,e.length);let i;const s=n.length-1,o=e.length-1;for(i=0;i<t;i++)if(n.charCodeAt(s-i)!==e.charCodeAt(o-i))return i;return t}function tn(n){return 55296<=n&&n<=56319}function gm(n){return 56320<=n&&n<=57343}function J4(n,e){return(n-55296<<10)+(e-56320)+65536}function WS(n,e,t){const i=n.charCodeAt(t);if(tn(i)&&t+1<e){const s=n.charCodeAt(t+1);if(gm(s))return J4(i,s)}return i}function Gge(n,e){const t=n.charCodeAt(e-1);if(gm(t)&&e>1){const i=n.charCodeAt(e-2);if(tn(i))return J4(i,t)}return t}class eP{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=Gge(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=WS(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class VS{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new eP(e,t)}nextGraphemeLength(){const e=nd.getInstance(),t=this._iterator,i=t.offset;let s=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const o=t.offset,r=e.getGraphemeBreakType(t.nextCodePoint());if(h9(s,r)){t.setOffset(o);break}s=r}return t.offset-i}prevGraphemeLength(){const e=nd.getInstance(),t=this._iterator,i=t.offset;let s=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const o=t.offset,r=e.getGraphemeBreakType(t.prevCodePoint());if(h9(r,s)){t.setOffset(o);break}s=r}return i-t.offset}eol(){return this._iterator.eol()}}function tP(n,e){return new VS(n,e).nextGraphemeLength()}function GU(n,e){return new VS(n,e).prevGraphemeLength()}function Kge(n,e){e>0&&gm(n.charCodeAt(e))&&e--;const t=e+tP(n,e);return[t-GU(n,t),t]}let w2;function Yge(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function Fb(n){return w2||(w2=Yge()),w2.test(n)}const Zge=/^[\t\n\r\x20-\x7E]*$/;function iP(n){return Zge.test(n)}const KU=/[\u2028\u2029]/;function YU(n){return KU.test(n)}function Jd(n){return n>=11904&&n<=55215||n>=63744&&n<=64255||n>=65281&&n<=65374}function nP(n){return n>=127462&&n<=127487||n===8986||n===8987||n===9200||n===9203||n>=9728&&n<=10175||n===11088||n===11093||n>=127744&&n<=128591||n>=128640&&n<=128764||n>=128992&&n<=129008||n>=129280&&n<=129535||n>=129648&&n<=129782}const Xge=String.fromCharCode(65279);function sP(n){return!!(n&&n.length>0&&n.charCodeAt(0)===65279)}function Qge(n,e=!1){return n?(e&&(n=n.replace(/\\./g,"")),n.toLowerCase()!==n):!1}function ZU(n){return n=n%(2*26),n<26?String.fromCharCode(97+n):String.fromCharCode(65+n-26)}function h9(n,e){return n===0?e!==5&&e!==7:n===2&&e===3?!1:n===4||n===2||n===3||e===4||e===2||e===3?!0:!(n===8&&(e===8||e===9||e===11||e===12)||(n===11||n===9)&&(e===9||e===10)||(n===12||n===10)&&e===10||e===5||e===13||e===7||n===1||n===13&&e===14||n===6&&e===6)}class nd{static getInstance(){return nd._INSTANCE||(nd._INSTANCE=new nd),nd._INSTANCE}constructor(){this._data=Jge()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let s=1;for(;s<=i;)if(e<t[3*s])s=2*s;else if(e>t[3*s+1])s=2*s+1;else return t[3*s+2];return 0}}nd._INSTANCE=null;function Jge(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function epe(n,e){if(n===0)return 0;const t=tpe(n,e);if(t!==void 0)return t;const i=new eP(e,n);return i.prevCodePoint(),i.offset}function tpe(n,e){const t=new eP(e,n);let i=t.prevCodePoint();for(;ipe(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!nP(i))return;let s=t.offset;return s>0&&t.prevCodePoint()===8205&&(s=t.offset),s}function ipe(n){return 127995<=n&&n<=127999}class hf{static getInstance(e){return fm.cache.get(Array.from(e))}static getLocales(){return fm._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}fm=hf;hf.ambiguousCharacterData=new Mf(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'));hf.cache=new zge(n=>{function e(c){const d=new Map;for(let u=0;u<c.length;u+=2)d.set(c[u],c[u+1]);return d}function t(c,d){const u=new Map(c);for(const[h,f]of d)u.set(h,f);return u}function i(c,d){if(!c)return d;const u=new Map;for(const[h,f]of c)d.has(h)&&u.set(h,f);return u}const s=fm.ambiguousCharacterData.value;let o=n.filter(c=>!c.startsWith("_")&&c in s);o.length===0&&(o=["_default"]);let r;for(const c of o){const d=e(s[c]);r=i(r,d)}const a=e(s._common),l=t(a,r);return new fm(l)});hf._locales=new Mf(()=>Object.keys(fm.ambiguousCharacterData.value).filter(n=>!n.startsWith("_")));class xd{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(xd.getRawData())),this._data}static isInvisibleCharacter(e){return xd.getData().has(e)}static get codePoints(){return xd.getData()}}xd._data=void 0;class mT{constructor(){this._zoomFactor=1}getZoomFactor(){return this._zoomFactor}}mT.INSTANCE=new mT;class npe extends Y{constructor(){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(e){var t;(t=this._mediaQueryList)===null||t===void 0||t.removeEventListener("change",this._listener),this._mediaQueryList=window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),e&&this._onDidChange.fire()}}class spe extends Y{get value(){return this._value}constructor(){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const e=this._register(new npe);this._register(e.onDidChange(()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)}))}_getPixelRatio(){const e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}}class ope{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=new spe),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}}function XU(n,e){typeof n=="string"&&(n=window.matchMedia(n)),n.addEventListener("change",e)}const zS=new ope;function rpe(){return mT.INSTANCE.getZoomFactor()}const Jm=navigator.userAgent,vr=Jm.indexOf("Firefox")>=0,Hh=Jm.indexOf("AppleWebKit")>=0,oP=Jm.indexOf("Chrome")>=0,pc=!oP&&Jm.indexOf("Safari")>=0,QU=!oP&&!pc&&Hh;Jm.indexOf("Electron/")>=0;const f9=Jm.indexOf("Android")>=0;let xC=!1;if(window.matchMedia){const n=window.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=window.matchMedia("(display-mode: fullscreen)");xC=n.matches,XU(n,({matches:t})=>{xC&&e.matches||(xC=t)})}function ape(){return xC}class JU{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){const t=Tr(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Tr(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Tr(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Tr(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Tr(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Tr(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Tr(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Tr(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Tr(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Tr(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Tr(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Tr(n){return typeof n=="number"?`${n}px`:n}function bt(n){return new JU(n)}function Rn(n,e){n instanceof JU?(n.setFontFamily(e.getMassagedFontFamily()),n.setFontWeight(e.fontWeight),n.setFontSize(e.fontSize),n.setFontFeatureSettings(e.fontFeatureSettings),n.setFontVariationSettings(e.fontVariationSettings),n.setLineHeight(e.lineHeight),n.setLetterSpacing(e.letterSpacing)):(n.style.fontFamily=e.getMassagedFontFamily(),n.style.fontWeight=e.fontWeight,n.style.fontSize=e.fontSize+"px",n.style.fontFeatureSettings=e.fontFeatureSettings,n.style.fontVariationSettings=e.fontVariationSettings,n.style.lineHeight=e.lineHeight+"px",n.style.letterSpacing=e.letterSpacing+"px")}class lpe{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class rP{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");Rn(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");Rn(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const s=document.createElement("div");Rn(s,this._bareFontInfo),s.style.fontStyle="italic",e.appendChild(s);const o=[];for(const r of this._requests){let a;r.type===0&&(a=t),r.type===2&&(a=i),r.type===1&&(a=s),a.appendChild(document.createElement("br"));const l=document.createElement("span");rP._render(l,r),a.appendChild(l),o.push(l)}this._container=e,this._testElements=o}static _render(e,t){if(t.chr===" "){let i="";for(let s=0;s<8;s++)i+=i;e.innerText=i}else{let i=t.chr;for(let s=0;s<8;s++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],s=this._testElements[e];i.fulfill(s.offsetWidth/256)}}}function cpe(n,e){new rP(n,e).read()}const Gc=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new B,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(n){n=Math.min(Math.max(-5,n),20),this._zoomLevel!==n&&(this._zoomLevel=n,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},dpe=pt?1.5:1.35,C2=8;class $h{static createFromValidatedSettings(e,t,i){const s=e.get(49),o=e.get(53),r=e.get(52),a=e.get(51),l=e.get(54),c=e.get(66),d=e.get(63);return $h._create(s,o,r,a,l,c,d,t,i)}static _create(e,t,i,s,o,r,a,l,c){r===0?r=dpe*i:r<C2&&(r=r*i),r=Math.round(r),r<C2&&(r=C2);const d=1+(c?0:Gc.getZoomLevel()*.1);return i*=d,r*=d,o===Gr.TRANSLATE&&(t==="normal"||t==="bold"?o=Gr.OFF:(o=`'wght' ${parseInt(t,10)}`,t="normal")),new $h({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:s,fontVariationSettings:o,lineHeight:r,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=Vo.fontFamily,t=$h._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const upe=2;class _T extends $h{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=upe,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class hpe extends Y{constructor(){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._cache=new g9,this._evictUntrustedReadingsTimeout=-1}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(window.clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache=new g9,this._onDidChange.fire()}_writeToCache(e,t){this._cache.put(e,t),!t.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=window.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()},5e3))}_evictUntrustedReadings(){const e=this._cache.getValues();let t=!1;for(const i of e)i.isTrusted||(t=!0,this._cache.remove(i));t&&this._onDidChange.fire()}readFontInfo(e){if(!this._cache.has(e)){let t=this._actualReadFontInfo(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new _T({pixelRatio:zS.value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:t.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(t.spaceWidth,5),middotWidth:Math.max(t.middotWidth,5),wsmiddotWidth:Math.max(t.wsmiddotWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}_createRequest(e,t,i,s){const o=new lpe(e,t);return i.push(o),s==null||s.push(o),o}_actualReadFontInfo(e){const t=[],i=[],s=this._createRequest("n",0,t,i),o=this._createRequest("",0,t,null),r=this._createRequest(" ",0,t,i),a=this._createRequest("0",0,t,i),l=this._createRequest("1",0,t,i),c=this._createRequest("2",0,t,i),d=this._createRequest("3",0,t,i),u=this._createRequest("4",0,t,i),h=this._createRequest("5",0,t,i),f=this._createRequest("6",0,t,i),g=this._createRequest("7",0,t,i),p=this._createRequest("8",0,t,i),_=this._createRequest("9",0,t,i),v=this._createRequest("",0,t,i),b=this._createRequest("",0,t,null),y=this._createRequest("",0,t,i),w=this._createRequest(String.fromCharCode(11825),0,t,null),C="|/-_ilm%";for(let P=0,O=C.length;P<O;P++)this._createRequest(C.charAt(P),0,t,i),this._createRequest(C.charAt(P),1,t,i),this._createRequest(C.charAt(P),2,t,i);cpe(e,t);const L=Math.max(a.width,l.width,c.width,d.width,u.width,h.width,f.width,g.width,p.width,_.width);let x=e.fontFeatureSettings===No.OFF;const D=i[0].width;for(let P=1,O=i.length;x&&P<O;P++){const M=D-i[P].width;if(M<-.001||M>.001){x=!1;break}}let k=!0;return x&&b.width!==D&&(k=!1),b.width>v.width&&(k=!1),new _T({pixelRatio:zS.value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,fontVariationSettings:e.fontVariationSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:x,typicalHalfwidthCharacterWidth:s.width,typicalFullwidthCharacterWidth:o.width,canUseHalfwidthRightwardsArrow:k,spaceWidth:r.width,middotWidth:y.width,wsmiddotWidth:w.width,maxDigitWidth:L},!0)}}class g9{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const bT=new hpe;var Zr;(function(n){n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=e})(Zr||(Zr={}));const vt=at("instantiationService");function fpe(n,e,t){e[Zr.DI_TARGET]===e?e[Zr.DI_DEPENDENCIES].push({id:n,index:t}):(e[Zr.DI_DEPENDENCIES]=[{id:n,index:t}],e[Zr.DI_TARGET]=e)}function at(n){if(Zr.serviceIds.has(n))return Zr.serviceIds.get(n);const e=function(t,i,s){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");fpe(e,t,s)};return e.toString=()=>n,Zr.serviceIds.set(n,e),e}const Ut=at("codeEditorService"),hs=at("modelService"),Cu=at("textModelService");var pm=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class xo extends Y{constructor(e,t="",i="",s=!0,o){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=s,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}run(e,t){return pm(this,void 0,void 0,function*(){this._actionCallback&&(yield this._actionCallback(e))})}}class mm extends Y{constructor(){super(...arguments),this._onWillRun=this._register(new B),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new B),this.onDidRun=this._onDidRun.event}run(e,t){return pm(this,void 0,void 0,function*(){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{yield this.runAction(e,t)}catch(s){i=s}this._onDidRun.fire({action:e,error:i})})}runAction(e,t){return pm(this,void 0,void 0,function*(){yield e.run(t)})}}class Mn{constructor(){this.id=Mn.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new Mn,...i]:t=i);return t}run(){return pm(this,void 0,void 0,function*(){})}}Mn.ID="vs.actions.separator";class pD{get actions(){return this._actions}constructor(e,t,i,s){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=s,this._actions=i}run(){return pm(this,void 0,void 0,function*(){})}}class mD extends xo{constructor(){super(mD.ID,m("submenu.empty","(empty)"),void 0,!1)}}mD.ID="vs.actions.empty";function E_(n){var e,t;return{id:n.id,label:n.label,class:void 0,enabled:(e=n.enabled)!==null&&e!==void 0?e:!0,checked:(t=n.checked)!==null&&t!==void 0?t:!1,run:(...i)=>pm(this,void 0,void 0,function*(){return n.run(...i)}),tooltip:n.label}}var vT;(function(n){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}n.isThemeColor=e})(vT||(vT={}));var Ne;(function(n){n.iconNameSegment="[A-Za-z0-9]+",n.iconNameExpression="[A-Za-z0-9-]+",n.iconModifierExpression="~[A-Za-z]+",n.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${n.iconNameExpression})(${n.iconModifierExpression})?$`);function t(h){const f=e.exec(h.id);if(!f)return t(se.error);const[,g,p]=f,_=["codicon","codicon-"+g];return p&&_.push("codicon-modifier-"+p.substring(1)),_}n.asClassNameArray=t;function i(h){return t(h).join(" ")}n.asClassName=i;function s(h){return"."+t(h).join(".")}n.asCSSSelector=s;function o(h){return h&&typeof h=="object"&&typeof h.id=="string"&&(typeof h.color>"u"||vT.isThemeColor(h.color))}n.isThemeIcon=o;const r=new RegExp(`^\\$\\((${n.iconNameExpression}(?:${n.iconModifierExpression})?)\\)$`);function a(h){const f=r.exec(h);if(!f)return;const[,g]=f;return{id:g}}n.fromString=a;function l(h){return{id:h}}n.fromId=l;function c(h,f){let g=h.id;const p=g.lastIndexOf("~");return p!==-1&&(g=g.substring(0,p)),f&&(g=`${g}~${f}`),{id:g}}n.modify=c;function d(h){const f=h.id.lastIndexOf("~");if(f!==-1)return h.id.substring(f+1)}n.getModifier=d;function u(h,f){var g,p;return h.id===f.id&&((g=h.color)===null||g===void 0?void 0:g.id)===((p=f.color)===null||p===void 0?void 0:p.id)}n.isEqual=u})(Ne||(Ne={}));const fs=at("commandService"),Kt=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new B,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(n,e){if(!n)throw new Error("invalid command");if(typeof n=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:n,handler:e})}if(n.description){const r=[];for(const l of n.description.args)r.push(l.constraint);const a=n.handler;n.handler=function(l,...c){return Yhe(c,r),a(l,...c)}}const{id:t}=n;let i=this._commands.get(t);i||(i=new Ds,this._commands.set(t,i));const s=i.unshift(n),o=Ze(()=>{s();const r=this._commands.get(t);r!=null&&r.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),o}registerCommandAlias(n,e){return Kt.registerCommand(n,(t,...i)=>t.get(fs).executeCommand(e,...i))}getCommand(n){const e=this._commands.get(n);if(!(!e||e.isEmpty()))return dt.first(e)}getCommands(){const n=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&n.set(e,t)}return n}};Kt.registerCommand("noop",()=>{});function S2(...n){switch(n.length){case 1:return m("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",n[0]);case 2:return m("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",n[0],n[1]);case 3:return m("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",n[0],n[1],n[2]);default:return}}const gpe=m("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),ppe=m("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class Da{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw U4(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(S2("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(S2("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(S2("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),s={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(s)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Da._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(gpe);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(ppe);return}const o=this._input.charCodeAt(e);if(t)t=!1;else if(o===47&&!i){e++;break}else o===91?i=!0:o===92?t=!0:o===93&&(i=!1);e++}for(;e<this._input.length&&Da._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const s=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:s,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}Da._regexFlags=new Set(["i","g","s","m","y","u"].map(n=>n.charCodeAt(0)));Da._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]);const Bn=new Map;Bn.set("false",!1);Bn.set("true",!0);Bn.set("isMac",pt);Bn.set("isLinux",Xn);Bn.set("isWindows",Ps);Bn.set("isWeb",Zm);Bn.set("isMacNative",pt&&!Zm);Bn.set("isEdge",ufe);Bn.set("isFirefox",cfe);Bn.set("isChrome",LU);Bn.set("isSafari",dfe);const mpe=Object.prototype.hasOwnProperty,_pe={regexParsingWithErrorRecovery:!0},bpe=m("contextkey.parser.error.emptyString","Empty context key expression"),vpe=m("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),ype=m("contextkey.parser.error.noInAfterNot","'in' after 'not'."),p9=m("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),wpe=m("contextkey.parser.error.unexpectedToken","Unexpected token"),Cpe=m("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),Spe=m("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),xpe=m("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");let ej=class Q0{constructor(e=_pe){this._config=e,this._scanner=new Da,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:bpe,offset:0,lexeme:"",additionalInfo:vpe});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),s=i.type===17?Cpe:void 0;throw this._parsingErrors.push({message:wpe,offset:i.offset,lexeme:Da.getLexeme(i),additionalInfo:s}),Q0._parseError}return t}catch(t){if(t!==Q0._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:Le.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:Le.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),ds.INSTANCE;case 12:return this._advance(),Os.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,p9),t==null?void 0:t.negate()}case 17:return this._advance(),Bf.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),Le.true();case 12:return this._advance(),Le.false();case 0:{this._advance();const t=this._expr();return this._consume(1,p9),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const s=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),s.type!==10)throw this._errExpectedButGot("REGEX",s);const o=s.lexeme,r=o.lastIndexOf("/"),a=r===o.length-1?void 0:this._removeFlagsGY(o.substring(r+1));let l;try{l=new RegExp(o.substring(1,r),a)}catch{throw this._errExpectedButGot("REGEX",s)}return Bb.create(t,l)}switch(s.type){case 10:case 19:{const o=[s.lexeme];this._advance();let r=this._peek(),a=0;for(let h=0;h<s.lexeme.length;h++)s.lexeme.charCodeAt(h)===40?a++:s.lexeme.charCodeAt(h)===41&&a--;for(;!this._isAtEnd()&&r.type!==15&&r.type!==16;){switch(r.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let h=0;h<r.lexeme.length;h++)r.lexeme.charCodeAt(h)===40?a++:s.lexeme.charCodeAt(h)===41&&a--}if(a<0)break;o.push(Da.getLexeme(r)),this._advance(),r=this._peek()}const l=o.join(""),c=l.lastIndexOf("/"),d=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let u;try{u=new RegExp(l.substring(1,c),d)}catch{throw this._errExpectedButGot("REGEX",s)}return Le.regex(t,u)}case 18:{const o=s.lexeme;this._advance();let r=null;if(!Hge(o)){const a=o.indexOf("/"),l=o.lastIndexOf("/");if(a!==l&&a>=0){const c=o.slice(a+1,l),d=o[l+1]==="i"?"i":"";try{r=new RegExp(c,d)}catch{throw this._errExpectedButGot("REGEX",s)}}}if(r===null)throw this._errExpectedButGot("REGEX",s);return Bb.create(t,r)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,ype);const s=this._value();return Le.notIn(t,s)}switch(this._peek().type){case 3:{this._advance();const s=this._value();if(this._previous().type===18)return Le.equals(t,s);switch(s){case"true":return Le.has(t);case"false":return Le.not(t);default:return Le.equals(t,s)}}case 4:{this._advance();const s=this._value();if(this._previous().type===18)return Le.notEquals(t,s);switch(s){case"true":return Le.not(t);case"false":return Le.has(t);default:return Le.notEquals(t,s)}}case 5:return this._advance(),SD.create(t,this._value());case 6:return this._advance(),xD.create(t,this._value());case 7:return this._advance(),wD.create(t,this._value());case 8:return this._advance(),CD.create(t,this._value());case 13:return this._advance(),Le.in(t,this._value());default:return Le.has(t)}}case 20:throw this._parsingErrors.push({message:Spe,offset:e.offset,lexeme:"",additionalInfo:xpe}),Q0._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const s=m("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Da.getLexeme(t)),o=t.offset,r=Da.getLexeme(t);return this._parsingErrors.push({message:s,offset:o,lexeme:r,additionalInfo:i}),Q0._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}};ej._parseError=new Error;class Le{static false(){return ds.INSTANCE}static true(){return Os.INSTANCE}static has(e){return Ff.create(e)}static equals(e,t){return iy.create(e,t)}static notEquals(e,t){return vD.create(e,t)}static regex(e,t){return Bb.create(e,t)}static in(e,t){return _D.create(e,t)}static notIn(e,t){return bD.create(e,t)}static not(e){return Bf.create(e)}static and(...e){return yh.create(e,null,!0)}static or(...e){return Bl.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}}Le._parser=new ej({regexParsingWithErrorRecovery:!1});function Lpe(n,e){const t=n?n.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function A_(n,e){return n.cmp(e)}class ds{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return Os.INSTANCE}}ds.INSTANCE=new ds;class Os{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return ds.INSTANCE}}Os.INSTANCE=new Os;class Ff{static create(e,t=null){const i=Bn.get(e);return typeof i=="boolean"?i?Os.INSTANCE:ds.INSTANCE:new Ff(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:ij(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Bn.get(this.key);return typeof e=="boolean"?e?Os.INSTANCE:ds.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=Bf.create(this.key,this)),this.negated}}class iy{static create(e,t,i=null){if(typeof t=="boolean")return t?Ff.create(e,i):Bf.create(e,i);const s=Bn.get(e);return typeof s=="boolean"?t===(s?"true":"false")?Os.INSTANCE:ds.INSTANCE:new iy(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Bn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Os.INSTANCE:ds.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=vD.create(this.key,this.value,this)),this.negated}}class _D{static create(e,t){return new _D(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?mpe.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=bD.create(this.key,this.valueKey)),this.negated}}class bD{static create(e,t){return new bD(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=_D.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class vD{static create(e,t,i=null){if(typeof t=="boolean")return t?Bf.create(e,i):Ff.create(e,i);const s=Bn.get(e);return typeof s=="boolean"?t===(s?"true":"false")?ds.INSTANCE:Os.INSTANCE:new vD(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Bn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?ds.INSTANCE:Os.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=iy.create(this.key,this.value,this)),this.negated}}class Bf{static create(e,t=null){const i=Bn.get(e);return typeof i=="boolean"?i?ds.INSTANCE:Os.INSTANCE:new Bf(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:ij(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Bn.get(this.key);return typeof e=="boolean"?e?ds.INSTANCE:Os.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Ff.create(this.key,this)),this.negated}}function yD(n,e){if(typeof n=="string"){const t=parseFloat(n);isNaN(t)||(n=t)}return typeof n=="string"||typeof n=="number"?e(n):ds.INSTANCE}class wD{static create(e,t,i=null){return yD(t,s=>new wD(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=xD.create(this.key,this.value,this)),this.negated}}class CD{static create(e,t,i=null){return yD(t,s=>new CD(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=SD.create(this.key,this.value,this)),this.negated}}class SD{static create(e,t,i=null){return yD(t,s=>new SD(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=CD.create(this.key,this.value,this)),this.negated}}class xD{static create(e,t,i=null){return yD(t,s=>new xD(e,s,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:Wf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=wD.create(this.key,this.value,this)),this.negated}}class Bb{static create(e,t){return new Bb(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=aP.create(this)),this.negated}}class aP{static create(e){return new aP(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function tj(n){let e=null;for(let t=0,i=n.length;t<i;t++){const s=n[t].substituteConstants();if(n[t]!==s&&e===null){e=[];for(let o=0;o<t;o++)e[o]=n[o]}e!==null&&(e[t]=s)}return e===null?n:e}class yh{static create(e,t,i){return yh._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const s=A_(this.expr[t],e.expr[t]);if(s!==0)return s}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=tj(this.expr);return e===this.expr?this:yh.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const s=[];let o=!1;for(const r of e)if(r){if(r.type===1){o=!0;continue}if(r.type===0)return ds.INSTANCE;if(r.type===6){s.push(...r.expr);continue}s.push(r)}if(s.length===0&&o)return Os.INSTANCE;if(s.length!==0){if(s.length===1)return s[0];s.sort(A_);for(let r=1;r<s.length;r++)s[r-1].equals(s[r])&&(s.splice(r,1),r--);if(s.length===1)return s[0];for(;s.length>1;){const r=s[s.length-1];if(r.type!==9)break;s.pop();const a=s.pop(),l=s.length===0,c=Bl.create(r.expr.map(d=>yh.create([d,a],null,i)),null,l);c&&(s.push(c),s.sort(A_))}if(s.length===1)return s[0];if(i){for(let r=0;r<s.length;r++)for(let a=r+1;a<s.length;a++)if(s[r].negate().equals(s[a]))return ds.INSTANCE;if(s.length===1)return s[0]}return new yh(s,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Bl.create(e,this,!0)}return this.negated}}class Bl{static create(e,t,i){return Bl._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const s=A_(this.expr[t],e.expr[t]);if(s!==0)return s}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=tj(this.expr);return e===this.expr?this:Bl.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let s=[],o=!1;if(e){for(let r=0,a=e.length;r<a;r++){const l=e[r];if(l){if(l.type===0){o=!0;continue}if(l.type===1)return Os.INSTANCE;if(l.type===9){s=s.concat(l.expr);continue}s.push(l)}}if(s.length===0&&o)return ds.INSTANCE;s.sort(A_)}if(s.length!==0){if(s.length===1)return s[0];for(let r=1;r<s.length;r++)s[r-1].equals(s[r])&&(s.splice(r,1),r--);if(s.length===1)return s[0];if(i){for(let r=0;r<s.length;r++)for(let a=r+1;a<s.length;a++)if(s[r].negate().equals(s[a]))return Os.INSTANCE;if(s.length===1)return s[0]}return new Bl(s,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),s=[];for(const o of _9(t))for(const r of _9(i))s.push(yh.create([o,r],null,!1));e.unshift(Bl.create(s,null,!1))}this.negated=Bl.create(e,this,!0)}return this.negated}}class _e extends Ff{static all(){return _e._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?_e._info.push(Object.assign(Object.assign({},i),{key:e})):i!==!0&&_e._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return iy.create(this.key,e)}}_e._info=[];const tt=at("contextKeyService");function ij(n,e){return n<e?-1:n>e?1:0}function Wf(n,e,t,i){return n<t?-1:n>t?1:e<i?-1:e>i?1:0}function yT(n,e){if(n.type===0||e.type===1)return!0;if(n.type===9)return e.type===9?m9(n.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(yT(n,t))return!0;return!1}if(n.type===6){if(e.type===6)return m9(e.expr,n.expr);for(const t of n.expr)if(yT(t,e))return!0;return!1}return n.equals(e)}function m9(n,e){let t=0,i=0;for(;t<n.length&&i<e.length;){const s=n[t].cmp(e[i]);if(s<0)return!1;s===0&&t++,i++}return t===n.length}function _9(n){return n.type===9?n.expr:[n]}function wT(n,e){if(typeof n=="number"){if(n===0)return null;const t=(n&65535)>>>0,i=(n&4294901760)>>>16;return i!==0?new x2([ow(t,e),ow(i,e)]):new x2([ow(t,e)])}else{const t=[];for(let i=0;i<n.length;i++)t.push(ow(n[i],e));return new x2(t)}}function ow(n,e){const t=!!(n&2048),i=!!(n&256),s=e===2?i:t,o=!!(n&1024),r=!!(n&512),a=e===2?t:i,l=n&255;return new ff(s,o,r,a,l)}class ff{constructor(e,t,i,s,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=s,this.keyCode=o}equals(e){return e instanceof ff&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class x2{constructor(e){if(e.length===0)throw ic("chords");this.chords=e}}class Dpe{constructor(e,t,i,s,o,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=s,this.keyLabel=o,this.keyAriaLabel=r}}class kpe{}function L2(n,e){if(!n)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function lP(n,e="Unreachable"){throw new Error(e)}function Wb(n){if(!n()){debugger;n(),mt(new ji("Assertion Failed"))}}function nj(n,e){let t=0;for(;t<n.length-1;){const i=n[t],s=n[t+1];if(!e(i,s))return!1;t++}return!0}class Epe{constructor(){this.data=new Map}add(e,t){L2(Ns(e)),L2(Ls(t)),L2(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const mn=new Epe;class cP{constructor(){this._coreKeybindings=new Ds,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(vo===1){if(e&&e.win)return e.win}else if(vo===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=cP.bindToCurrentPlatform(e),i=new pe;if(t&&t.primary){const s=wT(t.primary,vo);s&&i.add(this._registerDefaultKeybinding(s,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let s=0,o=t.secondary.length;s<o;s++){const r=t.secondary[s],a=wT(r,vo);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-s-1,e.when))}return i}registerCommandAndKeybindingRule(e){return fr(this.registerKeybindingRule(e),Kt.registerCommand(e))}_registerDefaultKeybinding(e,t,i,s,o,r){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:r,weight1:s,weight2:o,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,Ze(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Ipe)),this._cachedMergedKeybindings.slice(0)}}const Fs=new cP,Ape={EditorModes:"platform.keybindingsRegistry"};mn.add(Ape.EditorModes,Fs);function Ipe(n,e){if(n.weight1!==e.weight1)return n.weight1-e.weight1;if(n.command&&e.command){if(n.command<e.command)return-1;if(n.command>e.command)return 1}return n.weight2-e.weight2}var Tpe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},b9=function(n,e){return function(t,i){e(t,i,n)}},Npe=function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t},LC;function J0(n){return n.command!==void 0}function Rpe(n){return n.submenu!==void 0}class I{constructor(e){if(I._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);I._instances.set(e,this),this.id=e}}I._instances=new Map;I.CommandPalette=new I("CommandPalette");I.DebugBreakpointsContext=new I("DebugBreakpointsContext");I.DebugCallStackContext=new I("DebugCallStackContext");I.DebugConsoleContext=new I("DebugConsoleContext");I.DebugVariablesContext=new I("DebugVariablesContext");I.DebugWatchContext=new I("DebugWatchContext");I.DebugToolBar=new I("DebugToolBar");I.DebugToolBarStop=new I("DebugToolBarStop");I.EditorContext=new I("EditorContext");I.SimpleEditorContext=new I("SimpleEditorContext");I.EditorContent=new I("EditorContent");I.EditorLineNumberContext=new I("EditorLineNumberContext");I.EditorContextCopy=new I("EditorContextCopy");I.EditorContextPeek=new I("EditorContextPeek");I.EditorContextShare=new I("EditorContextShare");I.EditorTitle=new I("EditorTitle");I.EditorTitleRun=new I("EditorTitleRun");I.EditorTitleContext=new I("EditorTitleContext");I.EditorTitleContextShare=new I("EditorTitleContextShare");I.EmptyEditorGroup=new I("EmptyEditorGroup");I.EmptyEditorGroupContext=new I("EmptyEditorGroupContext");I.EditorTabsBarContext=new I("EditorTabsBarContext");I.ExplorerContext=new I("ExplorerContext");I.ExplorerContextShare=new I("ExplorerContextShare");I.ExtensionContext=new I("ExtensionContext");I.GlobalActivity=new I("GlobalActivity");I.CommandCenter=new I("CommandCenter");I.CommandCenterCenter=new I("CommandCenterCenter");I.LayoutControlMenuSubmenu=new I("LayoutControlMenuSubmenu");I.LayoutControlMenu=new I("LayoutControlMenu");I.MenubarMainMenu=new I("MenubarMainMenu");I.MenubarAppearanceMenu=new I("MenubarAppearanceMenu");I.MenubarDebugMenu=new I("MenubarDebugMenu");I.MenubarEditMenu=new I("MenubarEditMenu");I.MenubarCopy=new I("MenubarCopy");I.MenubarFileMenu=new I("MenubarFileMenu");I.MenubarGoMenu=new I("MenubarGoMenu");I.MenubarHelpMenu=new I("MenubarHelpMenu");I.MenubarLayoutMenu=new I("MenubarLayoutMenu");I.MenubarNewBreakpointMenu=new I("MenubarNewBreakpointMenu");I.PanelAlignmentMenu=new I("PanelAlignmentMenu");I.PanelPositionMenu=new I("PanelPositionMenu");I.MenubarPreferencesMenu=new I("MenubarPreferencesMenu");I.MenubarRecentMenu=new I("MenubarRecentMenu");I.MenubarSelectionMenu=new I("MenubarSelectionMenu");I.MenubarShare=new I("MenubarShare");I.MenubarSwitchEditorMenu=new I("MenubarSwitchEditorMenu");I.MenubarSwitchGroupMenu=new I("MenubarSwitchGroupMenu");I.MenubarTerminalMenu=new I("MenubarTerminalMenu");I.MenubarViewMenu=new I("MenubarViewMenu");I.MenubarHomeMenu=new I("MenubarHomeMenu");I.OpenEditorsContext=new I("OpenEditorsContext");I.OpenEditorsContextShare=new I("OpenEditorsContextShare");I.ProblemsPanelContext=new I("ProblemsPanelContext");I.SCMChangeContext=new I("SCMChangeContext");I.SCMResourceContext=new I("SCMResourceContext");I.SCMResourceContextShare=new I("SCMResourceContextShare");I.SCMResourceFolderContext=new I("SCMResourceFolderContext");I.SCMResourceGroupContext=new I("SCMResourceGroupContext");I.SCMSourceControl=new I("SCMSourceControl");I.SCMTitle=new I("SCMTitle");I.SearchContext=new I("SearchContext");I.SearchActionMenu=new I("SearchActionContext");I.StatusBarWindowIndicatorMenu=new I("StatusBarWindowIndicatorMenu");I.StatusBarRemoteIndicatorMenu=new I("StatusBarRemoteIndicatorMenu");I.StickyScrollContext=new I("StickyScrollContext");I.TestItem=new I("TestItem");I.TestItemGutter=new I("TestItemGutter");I.TestMessageContext=new I("TestMessageContext");I.TestMessageContent=new I("TestMessageContent");I.TestPeekElement=new I("TestPeekElement");I.TestPeekTitle=new I("TestPeekTitle");I.TouchBarContext=new I("TouchBarContext");I.TitleBarContext=new I("TitleBarContext");I.TitleBarTitleContext=new I("TitleBarTitleContext");I.TunnelContext=new I("TunnelContext");I.TunnelPrivacy=new I("TunnelPrivacy");I.TunnelProtocol=new I("TunnelProtocol");I.TunnelPortInline=new I("TunnelInline");I.TunnelTitle=new I("TunnelTitle");I.TunnelLocalAddressInline=new I("TunnelLocalAddressInline");I.TunnelOriginInline=new I("TunnelOriginInline");I.ViewItemContext=new I("ViewItemContext");I.ViewContainerTitle=new I("ViewContainerTitle");I.ViewContainerTitleContext=new I("ViewContainerTitleContext");I.ViewTitle=new I("ViewTitle");I.ViewTitleContext=new I("ViewTitleContext");I.CommentEditorActions=new I("CommentEditorActions");I.CommentThreadTitle=new I("CommentThreadTitle");I.CommentThreadActions=new I("CommentThreadActions");I.CommentThreadAdditionalActions=new I("CommentThreadAdditionalActions");I.CommentThreadTitleContext=new I("CommentThreadTitleContext");I.CommentThreadCommentContext=new I("CommentThreadCommentContext");I.CommentTitle=new I("CommentTitle");I.CommentActions=new I("CommentActions");I.InteractiveToolbar=new I("InteractiveToolbar");I.InteractiveCellTitle=new I("InteractiveCellTitle");I.InteractiveCellDelete=new I("InteractiveCellDelete");I.InteractiveCellExecute=new I("InteractiveCellExecute");I.InteractiveInputExecute=new I("InteractiveInputExecute");I.NotebookToolbar=new I("NotebookToolbar");I.NotebookStickyScrollContext=new I("NotebookStickyScrollContext");I.NotebookCellTitle=new I("NotebookCellTitle");I.NotebookCellDelete=new I("NotebookCellDelete");I.NotebookCellInsert=new I("NotebookCellInsert");I.NotebookCellBetween=new I("NotebookCellBetween");I.NotebookCellListTop=new I("NotebookCellTop");I.NotebookCellExecute=new I("NotebookCellExecute");I.NotebookCellExecutePrimary=new I("NotebookCellExecutePrimary");I.NotebookDiffCellInputTitle=new I("NotebookDiffCellInputTitle");I.NotebookDiffCellMetadataTitle=new I("NotebookDiffCellMetadataTitle");I.NotebookDiffCellOutputsTitle=new I("NotebookDiffCellOutputsTitle");I.NotebookOutputToolbar=new I("NotebookOutputToolbar");I.NotebookEditorLayoutConfigure=new I("NotebookEditorLayoutConfigure");I.NotebookKernelSource=new I("NotebookKernelSource");I.BulkEditTitle=new I("BulkEditTitle");I.BulkEditContext=new I("BulkEditContext");I.TimelineItemContext=new I("TimelineItemContext");I.TimelineTitle=new I("TimelineTitle");I.TimelineTitleContext=new I("TimelineTitleContext");I.TimelineFilterSubMenu=new I("TimelineFilterSubMenu");I.AccountsContext=new I("AccountsContext");I.PanelTitle=new I("PanelTitle");I.AuxiliaryBarTitle=new I("AuxiliaryBarTitle");I.TerminalInstanceContext=new I("TerminalInstanceContext");I.TerminalEditorInstanceContext=new I("TerminalEditorInstanceContext");I.TerminalNewDropdownContext=new I("TerminalNewDropdownContext");I.TerminalTabContext=new I("TerminalTabContext");I.TerminalTabEmptyAreaContext=new I("TerminalTabEmptyAreaContext");I.WebviewContext=new I("WebviewContext");I.InlineCompletionsActions=new I("InlineCompletionsActions");I.NewFile=new I("NewFile");I.MergeInput1Toolbar=new I("MergeToolbar1Toolbar");I.MergeInput2Toolbar=new I("MergeToolbar2Toolbar");I.MergeBaseToolbar=new I("MergeBaseToolbar");I.MergeInputResultToolbar=new I("MergeToolbarResultToolbar");I.InlineSuggestionToolbar=new I("InlineSuggestionToolbar");I.ChatContext=new I("ChatContext");I.ChatCodeBlock=new I("ChatCodeblock");I.ChatMessageTitle=new I("ChatMessageTitle");I.ChatExecute=new I("ChatExecute");I.ChatInputSide=new I("ChatInputSide");I.AccessibleView=new I("AccessibleView");const Su=at("menuService");class Wl{static for(e){let t=this._all.get(e);return t||(t=new Wl(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof Wl&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}}Wl._all=new Map;const rr=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new hge({merge:Wl.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(n){return this._commands.set(n.id,n),this._onDidChangeMenu.fire(Wl.for(I.CommandPalette)),Ze(()=>{this._commands.delete(n.id)&&this._onDidChangeMenu.fire(Wl.for(I.CommandPalette))})}getCommand(n){return this._commands.get(n)}getCommands(){const n=new Map;return this._commands.forEach((e,t)=>n.set(t,e)),n}appendMenuItem(n,e){let t=this._menuItems.get(n);t||(t=new Ds,this._menuItems.set(n,t));const i=t.push(e);return this._onDidChangeMenu.fire(Wl.for(n)),Ze(()=>{i(),this._onDidChangeMenu.fire(Wl.for(n))})}appendMenuItems(n){const e=new pe;for(const{id:t,item:i}of n)e.add(this.appendMenuItem(t,i));return e}getMenuItems(n){let e;return this._menuItems.has(n)?e=[...this._menuItems.get(n)]:e=[],n===I.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(n){const e=new Set;for(const t of n)J0(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||n.push({command:t})})}};class HS extends pD{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let Xa=LC=class{static label(e,t){return t!=null&&t.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,s,o,r){var a,l;this.hideActions=s,this._commandService=r,this.id=e.id,this.label=LC.label(e,i),this.tooltip=(l=typeof e.tooltip=="string"?e.tooltip:(a=e.tooltip)===null||a===void 0?void 0:a.value)!==null&&l!==void 0?l:"",this.enabled=!e.precondition||o.contextMatchesRules(e.precondition),this.checked=void 0;let c;if(e.toggled){const d=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(d.condition),this.checked&&d.tooltip&&(this.tooltip=typeof d.tooltip=="string"?d.tooltip:d.tooltip.value),this.checked&&Ne.isThemeIcon(d.icon)&&(c=d.icon),this.checked&&d.title&&(this.label=typeof d.title=="string"?d.title:d.title.value)}c||(c=Ne.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new LC(t,void 0,i,s,o,r):void 0,this._options=i,this.class=c&&Ne.asClassName(c)}run(...e){var t,i;let s=[];return!((t=this._options)===null||t===void 0)&&t.arg&&(s=[...s,this._options.arg]),!((i=this._options)===null||i===void 0)&&i.shouldForwardArgs&&(s=[...s,...e]),this._commandService.executeCommand(this.id,...s)}};Xa=LC=Tpe([b9(4,tt),b9(5,fs)],Xa);class e0{constructor(e){this.desc=e}}function Bs(n){const e=new pe,t=new n,i=t.desc,{f1:s,menu:o,keybinding:r,description:a}=i,l=Npe(i,["f1","menu","keybinding","description"]);if(e.add(Kt.registerCommand({id:l.id,handler:(c,...d)=>t.run(c,...d),description:a})),Array.isArray(o))for(const c of o)e.add(rr.appendMenuItem(c.id,Object.assign({command:Object.assign(Object.assign({},l),{precondition:c.precondition===null?void 0:l.precondition})},c)));else o&&e.add(rr.appendMenuItem(o.id,Object.assign({command:Object.assign(Object.assign({},l),{precondition:o.precondition===null?void 0:l.precondition})},o)));if(s&&(e.add(rr.appendMenuItem(I.CommandPalette,{command:l,when:l.precondition})),e.add(rr.addCommand(l))),Array.isArray(r))for(const c of r)e.add(Fs.registerKeybindingRule(Object.assign(Object.assign({},c),{id:l.id,when:l.precondition?Le.and(l.precondition,c.when):c.when})));else r&&e.add(Fs.registerKeybindingRule(Object.assign(Object.assign({},r),{id:l.id,when:l.precondition?Le.and(l.precondition,r.when):r.when})));return e}const vc=at("telemetryService"),yc=at("logService");var wn;(function(n){n[n.Off=0]="Off",n[n.Trace=1]="Trace",n[n.Debug=2]="Debug",n[n.Info=3]="Info",n[n.Warning=4]="Warning",n[n.Error=5]="Error"})(wn||(wn={}));const sj=wn.Info;class oj extends Y{constructor(){super(...arguments),this.level=sj,this._onDidChangeLogLevel=this._register(new B),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==wn.Off&&this.level<=e}}class Mpe extends oj{constructor(e=sj,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.checkLogLevel(wn.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.checkLogLevel(wn.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.checkLogLevel(wn.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.checkLogLevel(wn.Warning)&&(this.useColors?console.log("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.checkLogLevel(wn.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...t):console.error(e,...t))}dispose(){}}class Ppe extends oj{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose()}}function Ope(n){switch(n){case wn.Trace:return"trace";case wn.Debug:return"debug";case wn.Info:return"info";case wn.Warning:return"warn";case wn.Error:return"error";case wn.Off:return"off"}}new _e("logLevel",Ope(wn.Info));const dP={clipboard:{writeText:lp||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:lp||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:(()=>lp||ape()?0:navigator.keyboard||pc?1:2)(),touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)};function Fpe(n){if(n.charCode){const t=String.fromCharCode(n.charCode).toUpperCase();return Fl.fromString(t)}const e=n.keyCode;if(e===3)return 7;if(vr)switch(e){case 59:return 85;case 60:if(Xn)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(pt)return 57;break}else if(Hh){if(pt&&e===93)return 57;if(!pt&&e===92)return 57}return PU[e]||0}const Bpe=pt?256:2048,Wpe=512,Vpe=1024,zpe=pt?2048:256;class zt{constructor(e){this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState("AltGraph"),this.keyCode=Fpe(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=Bpe),this.altKey&&(t|=Wpe),this.shiftKey&&(t|=Vpe),this.metaKey&&(t|=zpe),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new ff(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let v9=!1,v0=null;function Hpe(n){if(!n.parent||n.parent===n)return null;try{const e=n.location,t=n.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return v9=!0,null}catch{return v9=!0,null}return n.parent}class $pe{static getSameOriginWindowChain(){if(!v0){v0=[];let e=window,t;do t=Hpe(e),t?v0.push({window:e,iframeElement:e.frameElement||null}):v0.push({window:e,iframeElement:null}),e=t;while(e)}return v0.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,s=0;const o=this.getSameOriginWindowChain();for(const r of o){if(i+=r.window.scrollY,s+=r.window.scrollX,r.window===t||!r.iframeElement)break;const a=r.iframeElement.getBoundingClientRect();i+=a.top,s+=a.left}return{top:i,left:s}}}class ar{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=e.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const t=$pe.getPositionOfChildWindowRelativeToAncestorWindow(window,e.view);this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class gf{constructor(e,t=0,i=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t,e){const s=e,o=e;if(typeof s.wheelDeltaY<"u")this.deltaY=s.wheelDeltaY/120;else if(typeof o.VERTICAL_AXIS<"u"&&o.axis===o.VERTICAL_AXIS)this.deltaY=-o.detail/3;else if(e.type==="wheel"){const r=e;r.deltaMode===r.DOM_DELTA_LINE?vr&&!pt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof s.wheelDeltaX<"u")pc&&Ps?this.deltaX=-(s.wheelDeltaX/120):this.deltaX=s.wheelDeltaX/120;else if(typeof o.HORIZONTAL_AXIS<"u"&&o.axis===o.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const r=e;r.deltaMode===r.DOM_DELTA_LINE?vr&&!pt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){var e;(e=this.browserEvent)===null||e===void 0||e.preventDefault()}stopPropagation(){var e;(e=this.browserEvent)===null||e===void 0||e.stopPropagation()}}/*! @license DOMPurify 3.0.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.5/LICENSE */const{entries:rj,setPrototypeOf:y9,isFrozen:Upe,getPrototypeOf:jpe,getOwnPropertyDescriptor:qpe}=Object;let{freeze:eo,seal:ia,create:Gpe}=Object,{apply:CT,construct:ST}=typeof Reflect<"u"&&Reflect;CT||(CT=function(e,t,i){return e.apply(t,i)});eo||(eo=function(e){return e});ia||(ia=function(e){return e});ST||(ST=function(e,t){return new e(...t)});const Kpe=yr(Array.prototype.forEach),w9=yr(Array.prototype.pop),y0=yr(Array.prototype.push),DC=yr(String.prototype.toLowerCase),D2=yr(String.prototype.toString),Ype=yr(String.prototype.match),Nr=yr(String.prototype.replace),Zpe=yr(String.prototype.indexOf),Xpe=yr(String.prototype.trim),Eo=yr(RegExp.prototype.test),w0=Qpe(TypeError);function yr(n){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return CT(n,e,i)}}function Qpe(n){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return ST(n,t)}}function St(n,e,t){var i;t=(i=t)!==null&&i!==void 0?i:DC,y9&&y9(n,null);let s=e.length;for(;s--;){let o=e[s];if(typeof o=="string"){const r=t(o);r!==o&&(Upe(e)||(e[s]=r),o=r)}n[o]=!0}return n}function cg(n){const e=Gpe(null);for(const[t,i]of rj(n))e[t]=i;return e}function rw(n,e){for(;n!==null;){const i=qpe(n,e);if(i){if(i.get)return yr(i.get);if(typeof i.value=="function")return yr(i.value)}n=jpe(n)}function t(i){return console.warn("fallback value for",i),null}return t}const C9=eo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k2=eo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),E2=eo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Jpe=eo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),A2=eo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),eme=eo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),S9=eo(["#text"]),x9=eo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),I2=eo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),L9=eo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),aw=eo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),tme=ia(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ime=ia(/<%[\w\W]*|[\w\W]*%>/gm),nme=ia(/\${[\w\W]*}/gm),sme=ia(/^data-[\-\w.\u00B7-\uFFFF]/),ome=ia(/^aria-[\-\w]+$/),aj=ia(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),rme=ia(/^(?:\w+script|data):/i),ame=ia(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lj=ia(/^html$/i);var D9=Object.freeze({__proto__:null,MUSTACHE_EXPR:tme,ERB_EXPR:ime,TMPLIT_EXPR:nme,DATA_ATTR:sme,ARIA_ATTR:ome,IS_ALLOWED_URI:aj,IS_SCRIPT_OR_DATA:rme,ATTR_WHITESPACE:ame,DOCTYPE_NAME:lj});const lme=()=>typeof window>"u"?null:window,cme=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(i=t.getAttribute(s));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function cj(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lme();const e=Ke=>cj(Ke);if(e.version="3.0.5",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;const t=n.document,i=t.currentScript;let{document:s}=n;const{DocumentFragment:o,HTMLTemplateElement:r,Node:a,Element:l,NodeFilter:c,NamedNodeMap:d=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:u,DOMParser:h,trustedTypes:f}=n,g=l.prototype,p=rw(g,"cloneNode"),_=rw(g,"nextSibling"),v=rw(g,"childNodes"),b=rw(g,"parentNode");if(typeof r=="function"){const Ke=s.createElement("template");Ke.content&&Ke.content.ownerDocument&&(s=Ke.content.ownerDocument)}let y,w="";const{implementation:C,createNodeIterator:L,createDocumentFragment:x,getElementsByTagName:D}=s,{importNode:k}=t;let P={};e.isSupported=typeof rj=="function"&&typeof b=="function"&&C&&C.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:O,ERB_EXPR:M,TMPLIT_EXPR:R,DATA_ATTR:$,ARIA_ATTR:G,IS_SCRIPT_OR_DATA:ne,ATTR_WHITESPACE:ae}=D9;let{IS_ALLOWED_URI:fe}=D9,oe=null;const xe=St({},[...C9,...k2,...E2,...A2,...S9]);let Te=null;const me=St({},[...x9,...I2,...L9,...aw]);let te=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Yt=null,Lt=null,Tt=!0,Ge=!0,ii=!1,Ee=!0,Ve=!1,ge=!1,he=!1,ki=!1,Dt=!1,It=!1,vi=!1,Xo=!0,Nu=!1;const Nk="user-content-";let Z=!0,j=!1,U={},A=null;const T=St({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let W=null;const F=St({},["audio","video","img","source","image","track"]);let X=null;const ce=St({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",ke="http://www.w3.org/2000/svg",He="http://www.w3.org/1999/xhtml";let Fe=He,Nt=!1,kt=null;const Me=St({},[Se,ke,He],D2);let di;const ui=["application/xhtml+xml","text/html"],Qo="text/html";let wt,Fi=null;const Ru=s.createElement("form"),Mu=function(q){return q instanceof RegExp||q instanceof Function},Er=function(q){if(!(Fi&&Fi===q)){if((!q||typeof q!="object")&&(q={}),q=cg(q),di=ui.indexOf(q.PARSER_MEDIA_TYPE)===-1?di=Qo:di=q.PARSER_MEDIA_TYPE,wt=di==="application/xhtml+xml"?D2:DC,oe="ALLOWED_TAGS"in q?St({},q.ALLOWED_TAGS,wt):xe,Te="ALLOWED_ATTR"in q?St({},q.ALLOWED_ATTR,wt):me,kt="ALLOWED_NAMESPACES"in q?St({},q.ALLOWED_NAMESPACES,D2):Me,X="ADD_URI_SAFE_ATTR"in q?St(cg(ce),q.ADD_URI_SAFE_ATTR,wt):ce,W="ADD_DATA_URI_TAGS"in q?St(cg(F),q.ADD_DATA_URI_TAGS,wt):F,A="FORBID_CONTENTS"in q?St({},q.FORBID_CONTENTS,wt):T,Yt="FORBID_TAGS"in q?St({},q.FORBID_TAGS,wt):{},Lt="FORBID_ATTR"in q?St({},q.FORBID_ATTR,wt):{},U="USE_PROFILES"in q?q.USE_PROFILES:!1,Tt=q.ALLOW_ARIA_ATTR!==!1,Ge=q.ALLOW_DATA_ATTR!==!1,ii=q.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ve=q.SAFE_FOR_TEMPLATES||!1,ge=q.WHOLE_DOCUMENT||!1,Dt=q.RETURN_DOM||!1,It=q.RETURN_DOM_FRAGMENT||!1,vi=q.RETURN_TRUSTED_TYPE||!1,ki=q.FORCE_BODY||!1,Xo=q.SANITIZE_DOM!==!1,Nu=q.SANITIZE_NAMED_PROPS||!1,Z=q.KEEP_CONTENT!==!1,j=q.IN_PLACE||!1,fe=q.ALLOWED_URI_REGEXP||aj,Fe=q.NAMESPACE||He,te=q.CUSTOM_ELEMENT_HANDLING||{},q.CUSTOM_ELEMENT_HANDLING&&Mu(q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(te.tagNameCheck=q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),q.CUSTOM_ELEMENT_HANDLING&&Mu(q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(te.attributeNameCheck=q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),q.CUSTOM_ELEMENT_HANDLING&&typeof q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(te.allowCustomizedBuiltInElements=q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ve&&(Ge=!1),It&&(Dt=!0),U&&(oe=St({},[...S9]),Te=[],U.html===!0&&(St(oe,C9),St(Te,x9)),U.svg===!0&&(St(oe,k2),St(Te,I2),St(Te,aw)),U.svgFilters===!0&&(St(oe,E2),St(Te,I2),St(Te,aw)),U.mathMl===!0&&(St(oe,A2),St(Te,L9),St(Te,aw))),q.ADD_TAGS&&(oe===xe&&(oe=cg(oe)),St(oe,q.ADD_TAGS,wt)),q.ADD_ATTR&&(Te===me&&(Te=cg(Te)),St(Te,q.ADD_ATTR,wt)),q.ADD_URI_SAFE_ATTR&&St(X,q.ADD_URI_SAFE_ATTR,wt),q.FORBID_CONTENTS&&(A===T&&(A=cg(A)),St(A,q.FORBID_CONTENTS,wt)),Z&&(oe["#text"]=!0),ge&&St(oe,["html","head","body"]),oe.table&&(St(oe,["tbody"]),delete Yt.tbody),q.TRUSTED_TYPES_POLICY){if(typeof q.TRUSTED_TYPES_POLICY.createHTML!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=q.TRUSTED_TYPES_POLICY,w=y.createHTML("")}else y===void 0&&(y=cme(f,i)),y!==null&&typeof w=="string"&&(w=y.createHTML(""));eo&&eo(q),Fi=q}},kc=St({},["mi","mo","mn","ms","mtext"]),Pu=St({},["foreignobject","desc","title","annotation-xml"]),Ou=St({},["title","style","font","a","script"]),tg=St({},k2);St(tg,E2),St(tg,Jpe);const Fu=St({},A2);St(Fu,eme);const Rk=function(q){let be=b(q);(!be||!be.tagName)&&(be={namespaceURI:Fe,tagName:"template"});const Re=DC(q.tagName),hi=DC(be.tagName);return kt[q.namespaceURI]?q.namespaceURI===ke?be.namespaceURI===He?Re==="svg":be.namespaceURI===Se?Re==="svg"&&(hi==="annotation-xml"||kc[hi]):!!tg[Re]:q.namespaceURI===Se?be.namespaceURI===He?Re==="math":be.namespaceURI===ke?Re==="math"&&Pu[hi]:!!Fu[Re]:q.namespaceURI===He?be.namespaceURI===ke&&!Pu[hi]||be.namespaceURI===Se&&!kc[hi]?!1:!Fu[Re]&&(Ou[Re]||!tg[Re]):!!(di==="application/xhtml+xml"&&kt[q.namespaceURI]):!1},ua=function(q){y0(e.removed,{element:q});try{q.parentNode.removeChild(q)}catch{q.remove()}},d0=function(q,be){try{y0(e.removed,{attribute:be.getAttributeNode(q),from:be})}catch{y0(e.removed,{attribute:null,from:be})}if(be.removeAttribute(q),q==="is"&&!Te[q])if(Dt||It)try{ua(be)}catch{}else try{be.setAttribute(q,"")}catch{}},u0=function(q){let be,Re;if(ki)q="<remove></remove>"+q;else{const Jo=Ype(q,/^[\r\n\t ]+/);Re=Jo&&Jo[0]}di==="application/xhtml+xml"&&Fe===He&&(q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+q+"</body></html>");const hi=y?y.createHTML(q):q;if(Fe===He)try{be=new h().parseFromString(hi,di)}catch{}if(!be||!be.documentElement){be=C.createDocument(Fe,"template",null);try{be.documentElement.innerHTML=Nt?w:hi}catch{}}const Hn=be.body||be.documentElement;return q&&Re&&Hn.insertBefore(s.createTextNode(Re),Hn.childNodes[0]||null),Fe===He?D.call(be,ge?"html":"body")[0]:ge?be.documentElement:Hn},Iy=function(q){return L.call(q.ownerDocument||q,q,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},hZ=function(q){return q instanceof u&&(typeof q.nodeName!="string"||typeof q.textContent!="string"||typeof q.removeChild!="function"||!(q.attributes instanceof d)||typeof q.removeAttribute!="function"||typeof q.setAttribute!="function"||typeof q.namespaceURI!="string"||typeof q.insertBefore!="function"||typeof q.hasChildNodes!="function")},Ty=function(q){return typeof a=="object"?q instanceof a:q&&typeof q=="object"&&typeof q.nodeType=="number"&&typeof q.nodeName=="string"},ul=function(q,be,Re){P[q]&&Kpe(P[q],hi=>{hi.call(e,be,Re,Fi)})},p5=function(q){let be;if(ul("beforeSanitizeElements",q,null),hZ(q))return ua(q),!0;const Re=wt(q.nodeName);if(ul("uponSanitizeElement",q,{tagName:Re,allowedTags:oe}),q.hasChildNodes()&&!Ty(q.firstElementChild)&&(!Ty(q.content)||!Ty(q.content.firstElementChild))&&Eo(/<[/\w]/g,q.innerHTML)&&Eo(/<[/\w]/g,q.textContent))return ua(q),!0;if(!oe[Re]||Yt[Re]){if(!Yt[Re]&&_5(Re)&&(te.tagNameCheck instanceof RegExp&&Eo(te.tagNameCheck,Re)||te.tagNameCheck instanceof Function&&te.tagNameCheck(Re)))return!1;if(Z&&!A[Re]){const hi=b(q)||q.parentNode,Hn=v(q)||q.childNodes;if(Hn&&hi){const Jo=Hn.length;for(let $i=Jo-1;$i>=0;--$i)hi.insertBefore(p(Hn[$i],!0),_(q))}}return ua(q),!0}return q instanceof l&&!Rk(q)||(Re==="noscript"||Re==="noembed"||Re==="noframes")&&Eo(/<\/no(script|embed|frames)/i,q.innerHTML)?(ua(q),!0):(Ve&&q.nodeType===3&&(be=q.textContent,be=Nr(be,O," "),be=Nr(be,M," "),be=Nr(be,R," "),q.textContent!==be&&(y0(e.removed,{element:q.cloneNode()}),q.textContent=be)),ul("afterSanitizeElements",q,null),!1)},m5=function(q,be,Re){if(Xo&&(be==="id"||be==="name")&&(Re in s||Re in Ru))return!1;if(!(Ge&&!Lt[be]&&Eo($,be))){if(!(Tt&&Eo(G,be))){if(!Te[be]||Lt[be]){if(!(_5(q)&&(te.tagNameCheck instanceof RegExp&&Eo(te.tagNameCheck,q)||te.tagNameCheck instanceof Function&&te.tagNameCheck(q))&&(te.attributeNameCheck instanceof RegExp&&Eo(te.attributeNameCheck,be)||te.attributeNameCheck instanceof Function&&te.attributeNameCheck(be))||be==="is"&&te.allowCustomizedBuiltInElements&&(te.tagNameCheck instanceof RegExp&&Eo(te.tagNameCheck,Re)||te.tagNameCheck instanceof Function&&te.tagNameCheck(Re))))return!1}else if(!X[be]){if(!Eo(fe,Nr(Re,ae,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&q!=="script"&&Zpe(Re,"data:")===0&&W[q])){if(!(ii&&!Eo(ne,Nr(Re,ae,"")))){if(Re)return!1}}}}}}return!0},_5=function(q){return q.indexOf("-")>0},b5=function(q){let be,Re,hi,Hn;ul("beforeSanitizeAttributes",q,null);const{attributes:Jo}=q;if(!Jo)return;const $i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(Hn=Jo.length;Hn--;){be=Jo[Hn];const{name:ha,namespaceURI:Mk}=be;if(Re=ha==="value"?be.value:Xpe(be.value),hi=wt(ha),$i.attrName=hi,$i.attrValue=Re,$i.keepAttr=!0,$i.forceKeepAttr=void 0,ul("uponSanitizeAttribute",q,$i),Re=$i.attrValue,$i.forceKeepAttr||(d0(ha,q),!$i.keepAttr))continue;if(!Ee&&Eo(/\/>/i,Re)){d0(ha,q);continue}Ve&&(Re=Nr(Re,O," "),Re=Nr(Re,M," "),Re=Nr(Re,R," "));const v5=wt(q.nodeName);if(m5(v5,hi,Re)){if(Nu&&(hi==="id"||hi==="name")&&(d0(ha,q),Re=Nk+Re),y&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Mk)switch(f.getAttributeType(v5,hi)){case"TrustedHTML":{Re=y.createHTML(Re);break}case"TrustedScriptURL":{Re=y.createScriptURL(Re);break}}try{Mk?q.setAttributeNS(Mk,ha,Re):q.setAttribute(ha,Re),w9(e.removed)}catch{}}}ul("afterSanitizeAttributes",q,null)},fZ=function Ke(q){let be;const Re=Iy(q);for(ul("beforeSanitizeShadowDOM",q,null);be=Re.nextNode();)ul("uponSanitizeShadowNode",be,null),!p5(be)&&(be.content instanceof o&&Ke(be.content),b5(be));ul("afterSanitizeShadowDOM",q,null)};return e.sanitize=function(Ke){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be,Re,hi,Hn;if(Nt=!Ke,Nt&&(Ke="<!-->"),typeof Ke!="string"&&!Ty(Ke))if(typeof Ke.toString=="function"){if(Ke=Ke.toString(),typeof Ke!="string")throw w0("dirty is not a string, aborting")}else throw w0("toString is not a function");if(!e.isSupported)return Ke;if(he||Er(q),e.removed=[],typeof Ke=="string"&&(j=!1),j){if(Ke.nodeName){const ha=wt(Ke.nodeName);if(!oe[ha]||Yt[ha])throw w0("root node is forbidden and cannot be sanitized in-place")}}else if(Ke instanceof a)be=u0("<!---->"),Re=be.ownerDocument.importNode(Ke,!0),Re.nodeType===1&&Re.nodeName==="BODY"||Re.nodeName==="HTML"?be=Re:be.appendChild(Re);else{if(!Dt&&!Ve&&!ge&&Ke.indexOf("<")===-1)return y&&vi?y.createHTML(Ke):Ke;if(be=u0(Ke),!be)return Dt?null:vi?w:""}be&&ki&&ua(be.firstChild);const Jo=Iy(j?Ke:be);for(;hi=Jo.nextNode();)p5(hi)||(hi.content instanceof o&&fZ(hi.content),b5(hi));if(j)return Ke;if(Dt){if(It)for(Hn=x.call(be.ownerDocument);be.firstChild;)Hn.appendChild(be.firstChild);else Hn=be;return(Te.shadowroot||Te.shadowrootmode)&&(Hn=k.call(t,Hn,!0)),Hn}let $i=ge?be.outerHTML:be.innerHTML;return ge&&oe["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&Eo(lj,be.ownerDocument.doctype.name)&&($i="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+$i),Ve&&($i=Nr($i,O," "),$i=Nr($i,M," "),$i=Nr($i,R," ")),y&&vi?y.createHTML($i):$i},e.setConfig=function(Ke){Er(Ke),he=!0},e.clearConfig=function(){Fi=null,he=!1},e.isValidAttribute=function(Ke,q,be){Fi||Er({});const Re=wt(Ke),hi=wt(q);return m5(Re,hi,be)},e.addHook=function(Ke,q){typeof q=="function"&&(P[Ke]=P[Ke]||[],y0(P[Ke],q))},e.removeHook=function(Ke){if(P[Ke])return w9(P[Ke])},e.removeHooks=function(Ke){P[Ke]&&(P[Ke]=[])},e.removeAllHooks=function(){P={}},e}var cl=cj();cl.version;cl.isSupported;const dj=cl.sanitize;cl.setConfig;cl.clearConfig;cl.isValidAttribute;const uj=cl.addHook,hj=cl.removeHook;cl.removeHooks;cl.removeAllHooks;var it;(function(n){n.inMemory="inmemory",n.vscode="vscode",n.internal="private",n.walkThrough="walkThrough",n.walkThroughSnippet="walkThroughSnippet",n.http="http",n.https="https",n.file="file",n.mailto="mailto",n.untitled="untitled",n.data="data",n.command="command",n.vscodeRemote="vscode-remote",n.vscodeRemoteResource="vscode-remote-resource",n.vscodeManagedRemoteResource="vscode-managed-remote-resource",n.vscodeUserData="vscode-userdata",n.vscodeCustomEditor="vscode-custom-editor",n.vscodeNotebookCell="vscode-notebook-cell",n.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",n.vscodeNotebookCellOutput="vscode-notebook-cell-output",n.vscodeInteractiveInput="vscode-interactive-input",n.vscodeSettings="vscode-settings",n.vscodeWorkspaceTrust="vscode-workspace-trust",n.vscodeTerminal="vscode-terminal",n.vscodeChatSesssion="vscode-chat-editor",n.webviewPanel="webview-panel",n.vscodeWebview="vscode-webview",n.extension="extension",n.vscodeFileResource="vscode-file",n.tmp="tmp",n.vsls="vsls",n.vscodeSourceControl="vscode-scm"})(it||(it={}));const dme="tkn";class ume{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${it.vscodeRemoteResource}`}setPreferredWebSchema(e){this._preferredWebSchema=e}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return mt(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const s=this._ports[t],o=this._connectionTokens[t];let r=`path=${encodeURIComponent(e.path)}`;return typeof o=="string"&&(r+=`&${dme}=${encodeURIComponent(o)}`),je.from({scheme:Zm?this._preferredWebSchema:it.vscodeRemoteResource,authority:`${i}:${s}`,path:this._remoteResourcesPath,query:r})}}const fj=new ume;class Vb{uriToBrowserUri(e){return e.scheme===it.vscodeRemote?fj.rewrite(e):e.scheme===it.file&&(lp||ofe&&hr.origin===`${it.vscodeFileResource}://${Vb.FALLBACK_AUTHORITY}`)?e.with({scheme:it.vscodeFileResource,authority:e.authority||Vb.FALLBACK_AUTHORITY,query:null,fragment:null}):e}}Vb.FALLBACK_AUTHORITY="vscode-app";const gj=new Vb;var k9;(function(n){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);n.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(o){let r;typeof o=="string"?r=new URL(o).searchParams:o instanceof URL?r=o.searchParams:je.isUri(o)&&(r=new URL(o.toString(!0)).searchParams);const a=r==null?void 0:r.get(t);if(a)return e.get(a)}n.getHeadersFromQuery=i;function s(o,r,a){if(!globalThis.crossOriginIsolated)return;const l=r&&a?"3":a?"2":"1";o instanceof URLSearchParams?o.set(t,l):o[t]=l}n.addSearchParam=s})(k9||(k9={}));const{registerWindow:y3e,getWindows:hme,onDidCreateWindow:w3e}=function(){const n=[],e=new B;return{onDidCreateWindow:e.event,registerWindow(t){n.push(t);const i=new pe;return i.add(Ze(()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)})),e.fire({window:t,disposableStore:i}),i},getWindows(){return n}}}();function Lo(n){for(;n.firstChild;)n.firstChild.remove()}function uP(n){var e;return(e=n==null?void 0:n.isConnected)!==null&&e!==void 0?e:!1}class fme{constructor(e,t,i,s){this._node=e,this._type=t,this._handler=i,this._options=s||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function K(n,e,t,i){return new fme(n,e,t,i)}function pj(n){return function(e){return n(new ar(e))}}function gme(n){return function(e){return n(new zt(e))}}const Hi=function(e,t,i,s){let o=i;return t==="click"||t==="mousedown"?o=pj(i):(t==="keydown"||t==="keypress"||t==="keyup")&&(o=gme(i)),K(e,t,o,s)},pme=function(e,t,i){const s=pj(t);return mme(e,s,i)};function mme(n,e,t){return K(n,Qd&&dP.pointerEvents?de.POINTER_DOWN:de.MOUSE_DOWN,e,t)}let mj,Uo;class T2{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){mt(e)}}static sort(e,t){return t.priority-e.priority}}(function(){let n=[],e=null,t=!1,i=!1;const s=()=>{for(t=!1,e=n,n=[],i=!0;e.length>0;)e.sort(T2.sort),e.shift().execute();i=!1};Uo=(o,r=0)=>{const a=new T2(o,r);return n.push(a),t||(t=!0,requestAnimationFrame(s)),a},mj=(o,r)=>{if(i){const a=new T2(o,r);return e.push(a),a}else return Uo(o,r)}})();function LD(n){return n.ownerDocument.defaultView.getComputedStyle(n,null)}function DD(n){var e;const t=n.ownerDocument,i=(e=t.defaultView)===null||e===void 0?void 0:e.window;if(n!==t.body)return new Qt(n.clientWidth,n.clientHeight);if(Qd&&(i!=null&&i.visualViewport))return new Qt(i.visualViewport.width,i.visualViewport.height);if(i!=null&&i.innerWidth&&i.innerHeight)return new Qt(i.innerWidth,i.innerHeight);if(t.body&&t.body.clientWidth&&t.body.clientHeight)return new Qt(t.body.clientWidth,t.body.clientHeight);if(t.documentElement&&t.documentElement.clientWidth&&t.documentElement.clientHeight)return new Qt(t.documentElement.clientWidth,t.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class pi{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){const s=LD(e),o=s?s.getPropertyValue(t):"0";return pi.convertToPixels(e,o)}static getBorderLeftWidth(e){return pi.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return pi.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return pi.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return pi.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return pi.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return pi.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return pi.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return pi.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return pi.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return pi.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return pi.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return pi.getDimension(e,"margin-bottom","marginBottom")}}class Qt{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Qt(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Qt?e:new Qt(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}}Qt.None=new Qt(0,0);function _j(n){let e=n.offsetParent,t=n.offsetTop,i=n.offsetLeft;for(;(n=n.parentNode)!==null&&n!==n.ownerDocument.body&&n!==n.ownerDocument.documentElement;){t-=n.scrollTop;const s=bj(n)?null:LD(n);s&&(i-=s.direction!=="rtl"?n.scrollLeft:-n.scrollLeft),n===e&&(i+=pi.getBorderLeftWidth(n),t+=pi.getBorderTopWidth(n),t+=n.offsetTop,i+=n.offsetLeft,e=n.offsetParent)}return{left:i,top:t}}function Nn(n){var e,t,i,s;const o=n.getBoundingClientRect();return{left:o.left+((t=(e=n.ownerDocument.defaultView)===null||e===void 0?void 0:e.scrollX)!==null&&t!==void 0?t:0),top:o.top+((s=(i=n.ownerDocument.defaultView)===null||i===void 0?void 0:i.scrollY)!==null&&s!==void 0?s:0),width:o.width,height:o.height}}function _me(n){let e=n,t=1;do{const i=LD(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function ys(n){const e=pi.getMarginLeft(n)+pi.getMarginRight(n);return n.offsetWidth+e}function N2(n){const e=pi.getBorderLeftWidth(n)+pi.getBorderRightWidth(n),t=pi.getPaddingLeft(n)+pi.getPaddingRight(n);return n.offsetWidth-e-t}function bme(n){const e=pi.getBorderTopWidth(n)+pi.getBorderBottomWidth(n),t=pi.getPaddingTop(n)+pi.getPaddingBottom(n);return n.offsetHeight-e-t}function wh(n){const e=pi.getMarginTop(n)+pi.getMarginBottom(n);return n.offsetHeight+e}function Cn(n,e){for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function vme(n,e,t){for(;n&&n.nodeType===n.ELEMENT_NODE;){if(n.classList.contains(e))return n;if(t){if(typeof t=="string"){if(n.classList.contains(t))return null}else if(n===t)return null}n=n.parentNode}return null}function R2(n,e,t){return!!vme(n,e,t)}function bj(n){return n&&!!n.host&&!!n.mode}function xT(n){return!!_m(n)}function _m(n){for(var e;n.parentNode;){if(n===((e=n.ownerDocument)===null||e===void 0?void 0:e.body))return null;n=n.parentNode}return bj(n)?n:null}function Xr(){let n=yme().activeElement;for(;n!=null&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function yme(){var n;return(n=[document,...hme().map(t=>t.document)].find(t=>t.hasFocus()))!==null&&n!==void 0?n:document}function wr(n=document.getElementsByTagName("head")[0],e){const t=document.createElement("style");return t.type="text/css",t.media="screen",e==null||e(t),n.appendChild(t),t}let M2=null;function vj(){return M2||(M2=wr()),M2}function wme(n){var e,t;return!((e=n==null?void 0:n.sheet)===null||e===void 0)&&e.rules?n.sheet.rules:!((t=n==null?void 0:n.sheet)===null||t===void 0)&&t.cssRules?n.sheet.cssRules:[]}function LT(n,e,t=vj()){!t||!e||t.sheet.insertRule(n+"{"+e+"}",0)}function E9(n,e=vj()){if(!e)return;const t=wme(e),i=[];for(let s=0;s<t.length;s++)t[s].selectorText.indexOf(n)!==-1&&i.push(s);for(let s=i.length-1;s>=0;s--)e.sheet.deleteRule(i[s])}function hP(n){return typeof HTMLElement=="object"?n instanceof HTMLElement:n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}const de={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Hh?"webkitAnimationStart":"animationstart",ANIMATION_END:Hh?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Hh?"webkitAnimationIteration":"animationiteration"};function Cme(n){const e=n;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const Ue={stop:(n,e)=>(n.preventDefault(),e&&n.stopPropagation(),n)};function Sme(n){const e=[];for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)e[t]=n.scrollTop,n=n.parentNode;return e}function xme(n,e){for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)n.scrollTop!==e[t]&&(n.scrollTop=e[t]),n=n.parentNode}class $S extends Y{static hasFocusWithin(e){if(hP(e)){const t=_m(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Cn(i,e)}else return Cn(window.document.activeElement,window.document)}constructor(e){super(),this._onDidFocus=this._register(new B),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new B),this.onDidBlur=this._onDidBlur.event;let t=$S.hasFocusWithin(e),i=!1;const s=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(i=!0,window.setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{$S.hasFocusWithin(e)!==t&&(t?o():s())},this._register(K(e,de.FOCUS,s,!0)),this._register(K(e,de.BLUR,o,!0)),e instanceof HTMLElement&&(this._register(K(e,de.FOCUS_IN,()=>this._refreshStateHandler())),this._register(K(e,de.FOCUS_OUT,()=>this._refreshStateHandler())))}}function eu(n){return new $S(n)}function le(n,...e){if(n.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function yj(n,e){return n.insertBefore(e,n.firstChild),e}function cs(n,...e){n.innerText="",le(n,...e)}const Lme=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var zb;(function(n){n.HTML="http://www.w3.org/1999/xhtml",n.SVG="http://www.w3.org/2000/svg"})(zb||(zb={}));function wj(n,e,t,...i){const s=Lme.exec(e);if(!s)throw new Error("Bad use of emmet");const o=s[1]||"div";let r;return n!==zb.HTML?r=document.createElementNS(n,o):r=document.createElement(o),s[3]&&(r.id=s[3]),s[4]&&(r.className=s[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?r[a]=l:a==="selected"?l&&r.setAttribute(a,"true"):r.setAttribute(a,l))}),r.append(...i),r}function we(n,e,...t){return wj(zb.HTML,n,e,...t)}we.SVG=function(n,e,...t){return wj(zb.SVG,n,e,...t)};function Dme(n,...e){n?Uh(...e):sd(...e)}function Uh(...n){for(const e of n)e.style.display="",e.removeAttribute("aria-hidden")}function sd(...n){for(const e of n)e.style.display="none",e.setAttribute("aria-hidden","true")}function A9(n){const e=window.devicePixelRatio*n;return Math.max(1,Math.floor(e))/window.devicePixelRatio}function Cj(n){window.open(n,"_blank","noopener")}function kme(n){const e=()=>{n(),t=Uo(e)};let t=Uo(e);return Ze(()=>t.dispose())}fj.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");function tu(n){return n?`url('${gj.uriToBrowserUri(n).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function I9(n){return`'${n.replace(/'/g,"%27")}'`}function jh(n,e){if(n!==void 0){const t=n.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=jh(i[1].trim(),e)),`var(${i[0]}, ${e})`}return n}return e}function Eme(n,e=!1){const t=document.createElement("a");return uj("afterSanitizeAttributes",i=>{for(const s of["href","src"])if(i.hasAttribute(s)){const o=i.getAttribute(s);if(s==="href"&&o.startsWith("#"))continue;if(t.href=o,!n.includes(t.protocol.replace(/:$/,""))){if(e&&s==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(s)}}}),Ze(()=>{hj("afterSanitizeAttributes")})}const Ame=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class od extends B{constructor(){super(),this._subscriptions=new pe,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(K(window,"keydown",e=>{if(e.defaultPrevented)return;const t=new zt(e);if(!(t.keyCode===6&&e.repeat)){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(t.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}},!0)),this._subscriptions.add(K(window,"keyup",e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))},!0)),this._subscriptions.add(K(document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(K(document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(K(document.body,"mousemove",e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),this._subscriptions.add(K(window,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return od.instance||(od.instance=new od),od.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class Ime extends Y{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this._register(K(this.element,de.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter(e)})),this._register(K(this.element,de.DRAG_OVER,e=>{var t,i;e.preventDefault(),(i=(t=this.callbacks).onDragOver)===null||i===void 0||i.call(t,e,e.timeStamp-this.dragStartTime)})),this._register(K(this.element,de.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave(e))})),this._register(K(this.element,de.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd(e)})),this._register(K(this.element,de.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop(e)}))}}const Tme=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function dn(n,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const s=Tme.exec(n);if(!s||!s.groups)throw new Error("Bad use of h");const o=s.groups.tag||"div",r=document.createElement(o);s.groups.id&&(r.id=s.groups.id);const a=[];if(s.groups.class)for(const c of s.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(s.groups.name&&(l[s.groups.name]=r),i)for(const c of i)c instanceof HTMLElement?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[u,h]of Object.entries(d))r.style.setProperty(T9(u),typeof h=="number"?h+"px":""+h);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(T9(c),d.toString());return l.root=r,l}function T9(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class kD{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this._description=e.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=Le.and(i,this.precondition):i=this.precondition);const s={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};Fs.registerKeybindingRule(s)}}Kt.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),description:this._description})}_registerMenuItem(e){rr.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class fP extends kD{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,s){return this._implementations.push({priority:e,name:t,implementation:i,when:s}),this._implementations.sort((o,r)=>r.priority-o.priority),{dispose:()=>{for(let o=0;o<this._implementations.length;o++)if(this._implementations[o].implementation===i){this._implementations.splice(o,1);return}}}}runCommand(e,t){const i=e.get(yc),s=e.get(tt);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const o of this._implementations){if(o.when){const a=s.getContext(Xr());if(!o.when.evaluate(a))continue}const r=o.implementation(e,t);if(r)return i.trace(`Command '${this.id}' was handled by '${o.name}'.`),typeof r=="boolean"?void 0:r}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class Sj extends kD{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class Cr extends kD{static bindToContribution(e){return class extends Cr{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,s,o){const r=e(s);r&&this._callback(r,o)}}}static runEditorCommand(e,t,i,s){const o=e.get(Ut),r=o.getFocusedCodeEditor()||o.getActiveCodeEditor();if(r)return r.invokeWithinContext(a=>{if(a.get(tt).contextMatchesRules(i??void 0))return s(a,r,t)})}runCommand(e,t){return Cr.runEditorCommand(e,t,this.precondition,(i,s,o)=>this.runEditorCommand(i,s,o))}}class Xt extends Cr{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(s){return s.menuId||(s.menuId=I.EditorContext),s.title||(s.title=e.label),s.when=Le.and(e.precondition,s.when),s}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(Xt.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(vc).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class xj extends Xt{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,s)=>s[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const s of this._implementations){const o=s[1](e,t,i);if(o)return typeof o=="boolean"?void 0:o}}}class Nme extends e0{run(e,...t){const i=e.get(Ut),s=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(s)return s.invokeWithinContext(o=>{var r,a;const l=o.get(tt),c=o.get(yc);if(!l.contextMatchesRules((r=this.desc.precondition)!==null&&r!==void 0?r:void 0)){c.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,(a=this.desc.precondition)===null||a===void 0?void 0:a.serialize());return}return this.runEditorCommand(o,s,...t)})}}function t0(n,e){Kt.registerCommand(n,function(t,...i){const s=t.get(vt),[o,r]=i;xs(je.isUri(o)),xs(V.isIPosition(r));const a=t.get(hs).getModel(o);if(a){const l=V.lift(r);return s.invokeFunction(e,a,l,...i.slice(2))}return t.get(Cu).createModelReference(o).then(l=>new Promise((c,d)=>{try{const u=s.invokeFunction(e,l.object.textEditorModel,V.lift(r),i.slice(2));c(u)}catch(u){d(u)}}).finally(()=>{l.dispose()}))})}function Ae(n){return Ro.INSTANCE.registerEditorCommand(n),n}function Xe(n){const e=new n;return Ro.INSTANCE.registerEditorAction(e),e}function Lj(n){return Ro.INSTANCE.registerEditorAction(n),n}function Rme(n){Ro.INSTANCE.registerEditorAction(n)}function Lr(n,e,t){Ro.INSTANCE.registerEditorContribution(n,e,t)}var hp;(function(n){function e(r){return Ro.INSTANCE.getEditorCommand(r)}n.getEditorCommand=e;function t(){return Ro.INSTANCE.getEditorActions()}n.getEditorActions=t;function i(){return Ro.INSTANCE.getEditorContributions()}n.getEditorContributions=i;function s(r){return Ro.INSTANCE.getEditorContributions().filter(a=>r.indexOf(a.id)>=0)}n.getSomeEditorContributions=s;function o(){return Ro.INSTANCE.getDiffEditorContributions()}n.getDiffEditorContributions=o})(hp||(hp={}));const Mme={EditorCommonContributions:"editor.contributions"};class Ro{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}Ro.INSTANCE=new Ro;mn.add(Mme.EditorCommonContributions,Ro.INSTANCE);function ny(n){return n.register(),n}const Dj=ny(new fP({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:I.MenubarEditMenu,group:"1_do",title:m({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:I.CommandPalette,group:"",title:m("undo","Undo"),order:1}]}));ny(new Sj(Dj,{id:"default:undo",precondition:void 0}));const kj=ny(new fP({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:I.MenubarEditMenu,group:"1_do",title:m({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:I.CommandPalette,group:"",title:m("redo","Redo"),order:1}]}));ny(new Sj(kj,{id:"default:redo",precondition:void 0}));const Pme=ny(new fP({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:I.MenubarSelectionMenu,group:"1_basic",title:m({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:I.CommandPalette,group:"",title:m("selectAll","Select All"),order:1}]})),Ej=Symbol("MicrotaskDelay");var Ao=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},e_=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(r){return new Promise(function(a,l){r=n[o](r),s(a,l,r.done,r.value)})}}function s(o,r,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},r)}};function DT(n){return!!n&&typeof n.then=="function"}function wc(n){const e=new xr,t=n(e.token),i=new Promise((s,o)=>{const r=e.token.onCancellationRequested(()=>{r.dispose(),e.dispose(),o(new Qm)});Promise.resolve(t).then(a=>{r.dispose(),e.dispose(),s(a)},a=>{r.dispose(),e.dispose(),o(a)})});return new class{cancel(){e.cancel()}then(s,o){return i.then(s,o)}catch(s){return this.then(void 0,s)}finally(s){return i.finally(s)}}}function Ome(n,e,t){return new Promise((i,s)=>{const o=e.onCancellationRequested(()=>{o.dispose(),i(t)});n.then(i,s).finally(()=>o.dispose())})}class Fme{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(s=>{this.activePromise=null,t(s)},s=>{this.activePromise=null,i(s)})})}dispose(){this.isDisposed=!0}}const Bme=(n,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},n);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},Wme=n=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,n())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class xu{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((s,o)=>{this.doResolve=s,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const s=this.task;return this.task=null,s()}}));const i=()=>{var s;this.deferred=null,(s=this.doResolve)===null||s===void 0||s.call(this,null)};return this.deferred=t===Ej?Wme(i):Bme(t,i),this.completionPromise}isTriggered(){var e;return!!(!((e=this.deferred)===null||e===void 0)&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)===null||e===void 0||e.call(this,new Qm),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)===null||e===void 0||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class Aj{constructor(e){this.delayer=new xu(e),this.throttler=new Fme}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function Hb(n,e){return e?new Promise((t,i)=>{const s=setTimeout(()=>{o.dispose(),t()},n),o=e.onCancellationRequested(()=>{clearTimeout(s),o.dispose(),i(new Qm)})}):wc(t=>Hb(n,t))}function US(n,e=0,t){const i=setTimeout(()=>{n(),t&&s.dispose()},e),s=Ze(()=>{clearTimeout(i),t==null||t.deleteAndLeak(s)});return t==null||t.add(s),s}class Cc{constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class sy{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval(()=>{e()},t)}}class Li{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)===null||e===void 0||e.call(this)}}let rd;(function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?rd=n=>{xU(()=>{if(e)return;const t=Date.now()+15;n(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,t-Date.now())}}))});let e=!1;return{dispose(){e||(e=!0)}}}:rd=(n,e)=>{const t=requestIdleCallback(n,typeof e=="number"?{timeout:e}:void 0);let i=!1;return{dispose(){i||(i=!0,cancelIdleCallback(t))}}}})();class Vme{constructor(e){this._didRun=!1,this._executor=()=>{try{this._value=e()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=rd(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class Ij{get isRejected(){var e;return((e=this.outcome)===null||e===void 0?void 0:e.outcome)===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Qm)}}var kT;(function(n){function e(i){return Ao(this,void 0,void 0,function*(){let s;const o=yield Promise.all(i.map(r=>r.then(a=>a,a=>{s||(s=a)})));if(typeof s<"u")throw s;return o})}n.settled=e;function t(i){return new Promise((s,o)=>Ao(this,void 0,void 0,function*(){try{yield i(s,o)}catch(r){o(r)}}))}n.withAsyncBody=t})(kT||(kT={}));class ln{static fromArray(e){return new ln(t=>{t.emitMany(e)})}static fromPromise(e){return new ln(t=>Ao(this,void 0,void 0,function*(){t.emitMany(yield e)}))}static fromPromises(e){return new ln(t=>Ao(this,void 0,void 0,function*(){yield Promise.all(e.map(i=>Ao(this,void 0,void 0,function*(){return t.emitOne(yield i)})))}))}static merge(e){return new ln(t=>Ao(this,void 0,void 0,function*(){yield Promise.all(e.map(i=>{var s,o,r;return Ao(this,void 0,void 0,function*(){var a,l,c,d;try{for(s=!0,o=e_(i);r=yield o.next(),a=r.done,!a;s=!0){d=r.value,s=!1;const u=d;t.emitOne(u)}}catch(u){l={error:u}}finally{try{!s&&!a&&(c=o.return)&&(yield c.call(o))}finally{if(l)throw l.error}}})}))}))}constructor(e){this._state=0,this._results=[],this._error=null,this._onStateChanged=new B,queueMicrotask(()=>Ao(this,void 0,void 0,function*(){const t={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{yield Promise.resolve(e(t)),this.resolve()}catch(i){this.reject(i)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}}))}[Symbol.asyncIterator](){let e=0;return{next:()=>Ao(this,void 0,void 0,function*(){do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};yield ue.toPromise(this._onStateChanged.event)}while(!0)})}}static map(e,t){return new ln(i=>Ao(this,void 0,void 0,function*(){var s,o,r,a;try{for(var l=!0,c=e_(e),d;d=yield c.next(),s=d.done,!s;l=!0){a=d.value,l=!1;const u=a;i.emitOne(t(u))}}catch(u){o={error:u}}finally{try{!l&&!s&&(r=c.return)&&(yield r.call(c))}finally{if(o)throw o.error}}}))}map(e){return ln.map(this,e)}static filter(e,t){return new ln(i=>Ao(this,void 0,void 0,function*(){var s,o,r,a;try{for(var l=!0,c=e_(e),d;d=yield c.next(),s=d.done,!s;l=!0){a=d.value,l=!1;const u=a;t(u)&&i.emitOne(u)}}catch(u){o={error:u}}finally{try{!l&&!s&&(r=c.return)&&(yield r.call(c))}finally{if(o)throw o.error}}}))}filter(e){return ln.filter(this,e)}static coalesce(e){return ln.filter(e,t=>!!t)}coalesce(){return ln.coalesce(this)}static toPromise(e){var t,i,s,o,r,a,l;return Ao(this,void 0,void 0,function*(){const c=[];try{for(t=!0,i=e_(e);s=yield i.next(),o=s.done,!o;t=!0){l=s.value,t=!1;const d=l;c.push(d)}}catch(d){r={error:d}}finally{try{!t&&!o&&(a=i.return)&&(yield a.call(i))}finally{if(r)throw r.error}}return c})}toPromise(){return ln.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}}ln.EMPTY=ln.fromArray([]);class zme extends ln{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function Hme(n){const e=new xr,t=n(e.token);return new zme(e,i=>Ao(this,void 0,void 0,function*(){var s,o,r,a;const l=e.token.onCancellationRequested(()=>{l.dispose(),e.dispose(),i.reject(new Qm)});try{try{for(var c=!0,d=e_(t),u;u=yield d.next(),s=u.done,!s;c=!0){a=u.value,c=!1;const h=a;if(e.token.isCancellationRequested)return;i.emitOne(h)}}catch(h){o={error:h}}finally{try{!c&&!s&&(r=d.return)&&(yield r.call(d))}finally{if(o)throw o.error}}l.dispose(),e.dispose()}catch(h){l.dispose(),e.dispose(),i.reject(h)}}))}const $me="$initialize";let N9=!1;function ET(n){Zm&&(N9||(N9=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(n.message))}class Ume{constructor(e,t,i,s){this.vsWorker=e,this.req=t,this.method=i,this.args=s,this.type=0}}class R9{constructor(e,t,i,s){this.vsWorker=e,this.seq=t,this.res=i,this.err=s,this.type=1}}class jme{constructor(e,t,i,s){this.vsWorker=e,this.req=t,this.eventName=i,this.arg=s,this.type=2}}class qme{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Gme{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Kme{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const i=String(++this._lastSentReq);return new Promise((s,o)=>{this._pendingReplies[i]={resolve:s,reject:o},this._send(new Ume(this._workerId,i,e,t))})}listen(e,t){let i=null;const s=new B({onWillAddFirstListener:()=>{i=String(++this._lastSentReq),this._pendingEmitters.set(i,s),this._send(new jme(this._workerId,i,e,t))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(i),this._send(new Gme(this._workerId,i)),i=null}});return s.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.method,e.args).then(s=>{this._send(new R9(this._workerId,t,s,void 0))},s=>{s.detail instanceof Error&&(s.detail=e9(s.detail)),this._send(new R9(this._workerId,t,void 0,e9(s)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.eventName,e.arg)(s=>{this._send(new qme(this._workerId,t,s))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class Yme extends Y{constructor(e,t,i){super();let s=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",d=>{this._protocol.handleMessage(d)},d=>{s==null||s(d)})),this._protocol=new Kme({sendMessage:(d,u)=>{this._worker.postMessage(d,u)},handleMessage:(d,u)=>{if(typeof i[d]!="function")return Promise.reject(new Error("Missing method "+d+" on main thread host."));try{return Promise.resolve(i[d].apply(i,u))}catch(h){return Promise.reject(h)}},handleEvent:(d,u)=>{if(Nj(d)){const h=i[d].call(i,u);if(typeof h!="function")throw new Error(`Missing dynamic event ${d} on main thread host.`);return h}if(Tj(d)){const h=i[d];if(typeof h!="function")throw new Error(`Missing event ${d} on main thread host.`);return h}throw new Error(`Malformed event name ${d}`)}}),this._protocol.setWorkerId(this._worker.getId());let o=null;const r=globalThis.require;typeof r<"u"&&typeof r.getConfig=="function"?o=r.getConfig():typeof globalThis.requirejs<"u"&&(o=globalThis.requirejs.s.contexts._.config);const a=V4(i);this._onModuleLoaded=this._protocol.sendMessage($me,[this._worker.getId(),JSON.parse(JSON.stringify(o)),t,a]);const l=(d,u)=>this._request(d,u),c=(d,u)=>this._protocol.listen(d,u);this._lazyProxy=new Promise((d,u)=>{s=u,this._onModuleLoaded.then(h=>{d(Zme(h,l,c))},h=>{u(h),this._onError("Worker failed to load "+t,h)})})}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise((i,s)=>{this._onModuleLoaded.then(()=>{this._protocol.sendMessage(e,t).then(i,s)},s)})}_onError(e,t){console.error(e),console.info(t)}}function Tj(n){return n[0]==="o"&&n[1]==="n"&&Hc(n.charCodeAt(2))}function Nj(n){return/^onDynamic/.test(n)&&Hc(n.charCodeAt(9))}function Zme(n,e,t){const i=r=>function(){const a=Array.prototype.slice.call(arguments,0);return e(r,a)},s=r=>function(a){return t(r,a)},o={};for(const r of n){if(Nj(r)){o[r]=s(r);continue}if(Tj(r)){o[r]=t(r,void 0);continue}o[r]=i(r)}return o}function Vf(n,e){var t;const i=globalThis.MonacoEnvironment;if(i!=null&&i.createTrustedTypesPolicy)try{return i.createTrustedTypesPolicy(n,e)}catch(s){mt(s);return}try{return(t=window.trustedTypes)===null||t===void 0?void 0:t.createPolicy(n,e)}catch(s){mt(s);return}}const M9=Vf("defaultWorkerFactory",{createScriptURL:n=>n});function Xme(n){const e=globalThis.MonacoEnvironment;if(e){if(typeof e.getWorker=="function")return e.getWorker("workerMain.js",n);if(typeof e.getWorkerUrl=="function"){const t=e.getWorkerUrl("workerMain.js",n);return new Worker(M9?M9.createScriptURL(t):t,{name:n})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function Qme(n){return typeof n.then=="function"}class Jme{constructor(e,t,i,s,o){this.id=t,this.label=i;const r=Xme(i);Qme(r)?this.worker=r:this.worker=Promise.resolve(r),this.postMessage(e,[]),this.worker.then(a=>{a.onmessage=function(l){s(l.data)},a.onmessageerror=o,typeof a.addEventListener=="function"&&a.addEventListener("error",o)})}getId(){return this.id}postMessage(e,t){var i;(i=this.worker)===null||i===void 0||i.then(s=>{try{s.postMessage(e,t)}catch(o){mt(o),mt(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:o}))}})}dispose(){var e;(e=this.worker)===null||e===void 0||e.then(t=>t.terminate()),this.worker=null}}class ED{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){const s=++ED.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new Jme(e,s,this._label||"anonymous"+s,t,o=>{ET(o),this._webWorkerFailedBeforeError=o,i(o)})}}ED.LAST_WORKER_ID=0;var ns;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(ns||(ns={}));class P2{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),s=e.getStandardTokenType(i);return this.isOK(s)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const s=String.fromCharCode(i);if(!this.open.includes(s)&&!this.close.includes(s))return s}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class e0e{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)C0(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),C0(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),C0(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),C0(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&C0(this.autoClosingPairsCloseSingleChar,t.close,t)}}function C0(n,e,t){n.has(e)?n.get(e).push(t):n.set(e,[t])}function AD(n,e){const t=n.getCount(),i=n.findTokenIndexAtOffset(e),s=n.getLanguageId(i);let o=i;for(;o+1<t&&n.getLanguageId(o+1)===s;)o++;let r=i;for(;r>0&&n.getLanguageId(r-1)===s;)r--;return new t0e(n,s,r,o+1,n.getStartOffset(r),n.getEndOffset(o))}class t0e{constructor(e,t,i,s,o,r){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=s,this.firstCharOffset=o,this._lastCharOffset=r}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function ma(n){return(n&3)!==0}class bm{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new P2(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new P2({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new P2({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:bm.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:bm.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}}bm.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`;bm.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;const P9=typeof Buffer<"u";let O2;class gP{static wrap(e){return P9&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new gP(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return P9?this.buffer.toString():(O2||(O2=new TextDecoder),O2.decode(this.buffer))}}function i0e(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0}function n0e(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255}function Br(n,e){return n[e]*Math.pow(2,24)+n[e+1]*Math.pow(2,16)+n[e+2]*Math.pow(2,8)+n[e+3]}function Wr(n,e,t){n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e}function O9(n,e){return n[e]}function F9(n,e,t){n[t]=e}let F2;function Rj(){return F2||(F2=new TextDecoder("UTF-16LE")),F2}let B2;function s0e(){return B2||(B2=new TextDecoder("UTF-16BE")),B2}let W2;function Mj(){return W2||(W2=lfe()?Rj():s0e()),W2}function o0e(n,e,t){const i=new Uint16Array(n.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?r0e(n,e,t):Rj().decode(i)}function r0e(n,e,t){const i=[];let s=0;for(let o=0;o<t;o++){const r=i0e(n,e);e+=2,i[s++]=String.fromCharCode(r)}return i.join("")}class ID{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return Mj().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||tn(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class jS{constructor(e,t,i,s,o,r){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=s,this.forwardRegex=o,this.reversedRegex=r,this._openSet=jS._toSet(this.open),this._closeSet=jS._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function a0e(n){const e=n.length;n=n.map(r=>[r[0].toLowerCase(),r[1].toLowerCase()]);const t=[];for(let r=0;r<e;r++)t[r]=r;const i=(r,a)=>{const[l,c]=r,[d,u]=a;return l===d||l===u||c===d||c===u},s=(r,a)=>{const l=Math.min(r,a),c=Math.max(r,a);for(let d=0;d<e;d++)t[d]===c&&(t[d]=l)};for(let r=0;r<e;r++){const a=n[r];for(let l=r+1;l<e;l++){const c=n[l];i(a,c)&&s(t[r],t[l])}}const o=[];for(let r=0;r<e;r++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===r){const[d,u]=n[c];a.push(d),l.push(u)}a.length>0&&o.push({open:a,close:l})}return o}class l0e{constructor(e,t){this._richEditBracketsBrand=void 0;const i=a0e(t);this.brackets=i.map((s,o)=>new jS(e,o,s.open,s.close,c0e(s.open,s.close,i,o),d0e(s.open,s.close,i,o))),this.forwardRegex=u0e(this.brackets),this.reversedRegex=h0e(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const s of this.brackets){for(const o of s.open)this.textIsBracket[o]=s,this.textIsOpenBracket[o]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,o.length);for(const o of s.close)this.textIsBracket[o]=s,this.textIsOpenBracket[o]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,o.length)}}}function Pj(n,e,t,i){for(let s=0,o=e.length;s<o;s++){if(s===t)continue;const r=e[s];for(const a of r.open)a.indexOf(n)>=0&&i.push(a);for(const a of r.close)a.indexOf(n)>=0&&i.push(a)}}function Oj(n,e){return n.length-e.length}function TD(n){if(n.length<=1)return n;const e=[],t=new Set;for(const i of n)t.has(i)||(e.push(i),t.add(i));return e}function c0e(n,e,t,i){let s=[];s=s.concat(n),s=s.concat(e);for(let o=0,r=s.length;o<r;o++)Pj(s[o],t,i,s);return s=TD(s),s.sort(Oj),s.reverse(),ND(s)}function d0e(n,e,t,i){let s=[];s=s.concat(n),s=s.concat(e);for(let o=0,r=s.length;o<r;o++)Pj(s[o],t,i,s);return s=TD(s),s.sort(Oj),s.reverse(),ND(s.map(pP))}function u0e(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=TD(e),ND(e)}function h0e(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=TD(e),ND(e.map(pP))}function f0e(n){const e=/^[\w ]+$/.test(n);return n=br(n),e?`\\b${n}\\b`:n}function ND(n){const e=`(${n.map(f0e).join(")|(")})`;return qU(e,!0)}const pP=function(){function n(i){const s=new Uint16Array(i.length);let o=0;for(let r=i.length-1;r>=0;r--)s[o++]=i.charCodeAt(r);return Mj().decode(s)}let e=null,t=null;return function(s){return e!==s&&(e=s,t=n(e)),t}}();class ir{static _findPrevBracketInText(e,t,i,s){const o=i.match(e);if(!o)return null;const r=i.length-(o.index||0),a=o[0].length,l=s+r;return new N(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,s,o){const a=pP(i).substring(i.length-o,i.length-s);return this._findPrevBracketInText(e,t,a,s)}static findNextBracketInText(e,t,i,s){const o=i.match(e);if(!o)return null;const r=o.index||0,a=o[0].length;if(a===0)return null;const l=s+r;return new N(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,s,o){const r=i.substring(s,o);return this.findNextBracketInText(e,t,r,s)}}class g0e{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const s=i.charAt(i.length-1);e.push(s)}return uf(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const s=t.findTokenIndexAtOffset(i-1);if(ma(t.getStandardTokenType(s)))return null;const o=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,a=ir.findPrevBracketInRange(o,1,r,0,r.length);if(!a)return null;const l=r.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const d=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(d)?{matchOpenBracket:l}:null}}function lw(n){return n.global&&(n.lastIndex=0),!0}class p0e{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&lw(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&lw(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&lw(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&lw(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class Og{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=Og._createOpenBracketRegExp(t[0]),s=Og._createCloseBracketRegExp(t[1]);i&&s&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:s})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,s){if(e>=3)for(let o=0,r=this._regExpRules.length;o<r;o++){const a=this._regExpRules[o];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:s},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&s.length>0)for(let o=0,r=this._brackets.length;o<r;o++){const a=this._brackets[o];if(a.openRegExp.test(i)&&a.closeRegExp.test(s))return{indentAction:ns.IndentOutdent}}if(e>=2&&i.length>0){for(let o=0,r=this._brackets.length;o<r;o++)if(this._brackets[o].openRegExp.test(i))return{indentAction:ns.Indent}}return null}static _createOpenBracketRegExp(e){let t=br(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",Og._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=br(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,Og._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return mt(t),null}}}const ti=at("configurationService");function AT(n,e){const t=Object.create(null);for(const i in n)Fj(t,i,n[i],e);return t}function Fj(n,e,t,i){const s=e.split("."),o=s.pop();let r=n;for(let a=0;a<s.length;a++){const l=s[a];let c=r[l];switch(typeof c){case"undefined":c=r[l]=Object.create(null);break;case"object":break;default:i(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}r=c}if(typeof r=="object"&&r!==null)try{r[o]=t}catch{i(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(r)}`)}else i(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(r)}`)}function m0e(n,e){const t=e.split(".");Bj(n,t)}function Bj(n,e){const t=e.shift();if(e.length===0){delete n[t];return}if(Object.keys(n).indexOf(t)!==-1){const i=n[t];typeof i=="object"&&!Array.isArray(i)&&(Bj(i,e),Object.keys(i).length===0&&delete n[t])}}function B9(n,e,t){function i(r,a){let l=r;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const s=e.split("."),o=i(n,s);return typeof o>"u"?t:o}function _0e(n){return n.replace(/[\[\]]/g,"")}const Ai=at("languageService");class Sa{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const Wj=[];function ht(n,e,t){e instanceof Sa||(e=new Sa(e,[],!!t)),Wj.push([n,e])}function W9(){return Wj}const Vl=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),RD={JSONContribution:"base.contributions.json"};function b0e(n){return n.length>0&&n.charAt(n.length-1)==="#"?n.substring(0,n.length-1):n}class v0e{constructor(){this._onDidChangeSchema=new B,this.schemasById={}}registerSchema(e,t){this.schemasById[b0e(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const y0e=new v0e;mn.add(RD.JSONContribution,y0e);const zf={Configuration:"base.contributions.configuration"},S0="vscode://schemas/settings/resourceLanguage",V9=mn.as(RD.JSONContribution);class w0e{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new B,this._onDidUpdateConfiguration=new B,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:m("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},V9.registerSchema(S0,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),V9.registerSchema(S0,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){var i;const s=[];for(const{overrides:o,source:r}of e)for(const a in o)if(t.add(a),iu.test(a)){const l=this.configurationDefaultsOverrides.get(a),c=(i=l==null?void 0:l.valuesSources)!==null&&i!==void 0?i:new Map;if(r)for(const f of Object.keys(o[a]))c.set(f,r);const d=Object.assign(Object.assign({},(l==null?void 0:l.value)||{}),o[a]);this.configurationDefaultsOverrides.set(a,{source:r,value:d,valuesSources:c});const u=_0e(a),h={type:"object",default:d,description:m("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",u),$ref:S0,defaultDefaultValue:d,source:Ns(r)?void 0:r,defaultValueSource:r};s.push(...qS(a)),this.configurationProperties[a]=h,this.defaultLanguageConfigurationOverridesNode.properties[a]=h}else{this.configurationDefaultsOverrides.set(a,{value:o[a],source:r});const l=this.configurationProperties[a];l&&(this.updatePropertyDefaultValue(a,l),this.updateSchema(a,l))}this.doRegisterOverrideIdentifiers(s)}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(s=>{this.validateAndRegisterProperties(s,t,s.extensionInfo,s.restrictedProperties,void 0,i),this.configurationContributors.push(s),this.registerJSONConfiguration(s)})}validateAndRegisterProperties(e,t=!0,i,s,o=3,r){var a;o=mo(e.scope)?o:e.scope;const l=e.properties;if(l)for(const d in l){const u=l[d];if(t&&x0e(d,u)){delete l[d];continue}if(u.source=i,u.defaultDefaultValue=l[d].default,this.updatePropertyDefaultValue(d,u),iu.test(d)?u.scope=void 0:(u.scope=mo(u.scope)?o:u.scope,u.restricted=mo(u.restricted)?!!(s!=null&&s.includes(d)):u.restricted),l[d].hasOwnProperty("included")&&!l[d].included){this.excludedConfigurationProperties[d]=l[d],delete l[d];continue}else this.configurationProperties[d]=l[d],!((a=l[d].policy)===null||a===void 0)&&a.name&&this.policyConfigurations.set(l[d].policy.name,d);!l[d].deprecationMessage&&l[d].markdownDeprecationMessage&&(l[d].deprecationMessage=l[d].markdownDeprecationMessage),r.add(d)}const c=e.allOf;if(c)for(const d of c)this.validateAndRegisterProperties(d,t,i,s,o,r)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(e){const t=i=>{const s=i.properties;if(s)for(const r in s)this.updateSchema(r,s[r]);const o=i.allOf;o==null||o.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:m("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:S0};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){m("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),m("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let s=i==null?void 0:i.value,o=i==null?void 0:i.source;qs(s)&&(s=t.defaultDefaultValue,o=void 0),qs(s)&&(s=S0e(t.type)),t.default=s,t.defaultValueSource=o}}const Vj="\\[([^\\]]+)\\]",z9=new RegExp(Vj,"g"),C0e=`^(${Vj})+$`,iu=new RegExp(C0e);function qS(n){const e=[];if(iu.test(n)){let t=z9.exec(n);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=z9.exec(n)}}return uf(e)}function S0e(n){switch(Array.isArray(n)?n[0]:n){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const kC=new w0e;mn.add(zf.Configuration,kC);function x0e(n,e){var t,i,s,o;return n.trim()?iu.test(n)?m("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",n):kC.getConfigurationProperties()[n]!==void 0?m("config.property.duplicate","Cannot register '{0}'. This property is already registered.",n):!((t=e.policy)===null||t===void 0)&&t.name&&kC.getPolicyConfigurations().get((i=e.policy)===null||i===void 0?void 0:i.name)!==void 0?m("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",n,(s=e.policy)===null||s===void 0?void 0:s.name,kC.getPolicyConfigurations().get((o=e.policy)===null||o===void 0?void 0:o.name)):null:m("config.property.empty","Cannot register an empty property")}const L0e={ModesRegistry:"editor.modesRegistry"};class D0e{constructor(){this._onDidChangeLanguages=new B,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const vm=new D0e;mn.add(L0e.ModesRegistry,vm);const zo="plaintext",k0e=".txt";vm.registerLanguage({id:zo,extensions:[k0e],aliases:[m("plainText.alias","Plain Text"),"text"],mimetypes:[Vl.text]});mn.as(zf.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class E0e{constructor(e,t){this.languageId=e;const i=t.brackets?H9(t.brackets):[],s=new d9(a=>{const l=new Set;return{info:new A0e(this,a,l),closing:l}}),o=new d9(a=>{const l=new Set,c=new Set;return{info:new I0e(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=s.get(a),d=o.get(l);c.closing.add(d.info),d.opening.add(c.info)}const r=t.colorizedBracketPairs?H9(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of r){const c=s.get(a),d=o.get(l);c.closing.add(d.info),d.openingColorized.add(c.info),d.opening.add(c.info)}this._openingBrackets=new Map([...s.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...o.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}}function H9(n){return n.filter(([e,t])=>e!==""&&t!=="")}class zj{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class A0e extends zj{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class I0e extends zj{constructor(e,t,i,s){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=s,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var T0e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},$9=function(n,e){return function(t,i){e(t,i,n)}};class V2{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const oo=at("languageConfigurationService");let IT=class extends Y{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new P0e),this.onDidChangeEmitter=this._register(new B),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(TT));this._register(this.configurationService.onDidChangeConfiguration(s=>{const o=s.change.keys.some(a=>i.has(a)),r=s.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(o)this.configurations.clear(),this.onDidChangeEmitter.fire(new V2(void 0));else for(const a of r)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new V2(a)))})),this._register(this._registry.onDidChange(s=>{this.configurations.delete(s.languageId),this.onDidChangeEmitter.fire(new V2(s.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=N0e(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};IT=T0e([$9(0,ti),$9(1,Ai)],IT);function N0e(n,e,t,i){let s=e.getLanguageConfiguration(n);if(!s){if(!i.isRegisteredLanguageId(n))return new gp(n,{});s=new gp(n,{})}const o=R0e(s.languageId,t),r=$j([s.underlyingConfig,o]);return new gp(s.languageId,r)}const TT={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function R0e(n,e){const t=e.getValue(TT.brackets,{overrideIdentifier:n}),i=e.getValue(TT.colorizedBracketPairs,{overrideIdentifier:n});return{brackets:U9(t),colorizedBracketPairs:U9(i)}}function U9(n){if(Array.isArray(n))return n.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function Hj(n,e,t){const i=n.getLineContent(e);let s=zs(i);return s.length>t-1&&(s=s.substring(0,t-1)),s}function fp(n,e,t){n.tokenization.forceTokenization(e);const i=n.tokenization.getLineTokens(e),s=typeof t>"u"?n.getLineMaxColumn(e)-1:t-1;return AD(i,s)}class M0e{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new j9(e,t,++this._order);return this._entries.push(i),this._resolved=null,Ze(()=>{for(let s=0;s<this._entries.length;s++)if(this._entries[s]===i){this._entries.splice(s,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new gp(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(j9.cmp),$j(this._entries.map(e=>e.configuration)))}}function $j(n){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of n)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class j9{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class q9{constructor(e){this.languageId=e}}class P0e extends Y{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._register(this.register(zo,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let s=this._entries.get(e);s||(s=new M0e(e),this._entries.set(e,s));const o=s.register(t,i);return this._onDidChange.fire(new q9(e)),Ze(()=>{o.dispose(),this._onDidChange.fire(new q9(e))})}getLanguageConfiguration(e){const t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}}class gp{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Og(this.underlyingConfig):null,this.comments=gp._handleComments(this.underlyingConfig),this.characterPair=new bm(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||$4,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new p0e(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new E0e(e,this.underlyingConfig)}getWordDefinition(){return kU(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new l0e(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new g0e(this.brackets)),this._electricCharacter}onEnter(e,t,i,s){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,s):null}getAutoClosingPairs(){return new e0e(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[s,o]=t.blockComment;i.blockCommentStartToken=s,i.blockCommentEndToken=o}return i}}ht(oo,IT,1);class Oc{constructor(e,t,i,s){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=s}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}function O0e(n){return MD(n,0)}function MD(n,e){switch(typeof n){case"object":return n===null?Kl(349,e):Array.isArray(n)?B0e(n,e):W0e(n,e);case"string":return mP(n,e);case"boolean":return F0e(n,e);case"number":return Kl(n,e);case"undefined":return Kl(937,e);default:return Kl(617,e)}}function Kl(n,e){return(e<<5)-e+n|0}function F0e(n,e){return Kl(n?433:863,e)}function mP(n,e){e=Kl(149417,e);for(let t=0,i=n.length;t<i;t++)e=Kl(n.charCodeAt(t),e);return e}function B0e(n,e){return e=Kl(104579,e),n.reduce((t,i)=>MD(i,t),e)}function W0e(n,e){return e=Kl(181387,e),Object.keys(n).sort().reduce((t,i)=>(t=mP(i,t),MD(n[i],t)),e)}function z2(n,e,t=32){const i=t-e,s=~((1<<i)-1);return(n<<e|(s&n)>>>i)>>>0}function G9(n,e=0,t=n.byteLength,i=0){for(let s=0;s<t;s++)n[e+s]=i}function V0e(n,e,t="0"){for(;n.length<e;)n=t+n;return n}function x0(n,e=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join(""):V0e((n>>>0).toString(16),e/4)}class PD{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let s=this._buffLen,o=this._leftoverHighSurrogate,r,a;for(o!==0?(r=o,a=-1,o=0):(r=e.charCodeAt(0),a=0);;){let l=r;if(tn(r))if(a+1<t){const c=e.charCodeAt(a+1);gm(c)?(a++,l=J4(r,c)):l=65533}else{o=r;break}else gm(r)&&(l=65533);if(s=this._push(i,s,l),a++,a<t)r=e.charCodeAt(a);else break}this._buffLen=s,this._leftoverHighSurrogate=o}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64+0],e[1]=e[64+1],e[2]=e[64+2]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),x0(this._h0)+x0(this._h1)+x0(this._h2)+x0(this._h3)+x0(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,G9(this._buff,this._buffLen),this._buffLen>56&&(this._step(),G9(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=PD._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,z2(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let i=this._h0,s=this._h1,o=this._h2,r=this._h3,a=this._h4,l,c,d;for(let u=0;u<80;u++)u<20?(l=s&o|~s&r,c=1518500249):u<40?(l=s^o^r,c=1859775393):u<60?(l=s&o|s&r|o&r,c=2400959708):(l=s^o^r,c=3395469782),d=z2(i,5)+l+a+c+e.getUint32(u*4,!1)&4294967295,a=r,r=o,o=z2(s,30),s=i,i=d;this._h0=this._h0+i&4294967295,this._h1=this._h1+s&4294967295,this._h2=this._h2+o&4294967295,this._h3=this._h3+r&4294967295,this._h4=this._h4+a&4294967295}}PD._bigBlock32=new DataView(new ArrayBuffer(320));class K9{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,s=e.length;i<s;i++)t[i]=e.charCodeAt(i);return t}}function z0e(n,e,t){return new zl(new K9(n),new K9(e)).ComputeDiff(t).changes}class dg{static Assert(e,t){if(!e)throw new Error(t)}}class ug{static Copy(e,t,i,s,o){for(let r=0;r<o;r++)i[s+r]=e[t+r]}static Copy2(e,t,i,s,o){for(let r=0;r<o;r++)i[s+r]=e[t+r]}}class Y9{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Oc(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class zl{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[s,o,r]=zl._getElements(e),[a,l,c]=zl._getElements(t);this._hasStrings=r&&c,this._originalStringElements=s,this._originalElementsOrHash=o,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(zl._isStringArray(t)){const i=new Int32Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=mP(t[s],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=zl._getStrictElement(this._originalSequence,e),s=zl._getStrictElement(this._modifiedSequence,t);return i===s}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,s,o){const r=[!1];let a=this.ComputeDiffRecursive(e,t,i,s,r);return o&&(a=this.PrettifyChanges(a)),{quitEarly:r[0],changes:a}}ComputeDiffRecursive(e,t,i,s,o){for(o[0]=!1;e<=t&&i<=s&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&s>=i&&this.ElementsAreEqual(t,s);)t--,s--;if(e>t||i>s){let u;return i<=s?(dg.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new Oc(e,0,i,s-i+1)]):e<=t?(dg.Assert(i===s+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Oc(e,t-e+1,i,0)]):(dg.Assert(e===t+1,"originalStart should only be one more than originalEnd"),dg.Assert(i===s+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}const r=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,s,r,a,o),c=r[0],d=a[0];if(l!==null)return l;if(!o[0]){const u=this.ComputeDiffRecursive(e,c,i,d,o);let h=[];return o[0]?h=[new Oc(c+1,t-(c+1)+1,d+1,s-(d+1)+1)]:h=this.ComputeDiffRecursive(c+1,t,d+1,s,o),this.ConcatenateChanges(u,h)}return[new Oc(e,t-e+1,i,s-i+1)]}WALKTRACE(e,t,i,s,o,r,a,l,c,d,u,h,f,g,p,_,v,b){let y=null,w=null,C=new Y9,L=t,x=i,D=f[0]-_[0]-s,k=-1073741824,P=this.m_forwardHistory.length-1;do{const O=D+e;O===L||O<x&&c[O-1]<c[O+1]?(u=c[O+1],g=u-D-s,u<k&&C.MarkNextChange(),k=u,C.AddModifiedElement(u+1,g),D=O+1-e):(u=c[O-1]+1,g=u-D-s,u<k&&C.MarkNextChange(),k=u-1,C.AddOriginalElement(u,g+1),D=O-1-e),P>=0&&(c=this.m_forwardHistory[P],e=c[0],L=1,x=c.length-1)}while(--P>=-1);if(y=C.getReverseChanges(),b[0]){let O=f[0]+1,M=_[0]+1;if(y!==null&&y.length>0){const R=y[y.length-1];O=Math.max(O,R.getOriginalEnd()),M=Math.max(M,R.getModifiedEnd())}w=[new Oc(O,h-O+1,M,p-M+1)]}else{C=new Y9,L=r,x=a,D=f[0]-_[0]-l,k=1073741824,P=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const O=D+o;O===L||O<x&&d[O-1]>=d[O+1]?(u=d[O+1]-1,g=u-D-l,u>k&&C.MarkNextChange(),k=u+1,C.AddOriginalElement(u+1,g+1),D=O+1-o):(u=d[O-1],g=u-D-l,u>k&&C.MarkNextChange(),k=u,C.AddModifiedElement(u+1,g+1),D=O-1-o),P>=0&&(d=this.m_reverseHistory[P],o=d[0],L=1,x=d.length-1)}while(--P>=-1);w=C.getChanges()}return this.ConcatenateChanges(y,w)}ComputeRecursionPoint(e,t,i,s,o,r,a){let l=0,c=0,d=0,u=0,h=0,f=0;e--,i--,o[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const g=t-e+(s-i),p=g+1,_=new Int32Array(p),v=new Int32Array(p),b=s-i,y=t-e,w=e-i,C=t-s,x=(y-b)%2===0;_[b]=e,v[y]=t,a[0]=!1;for(let D=1;D<=g/2+1;D++){let k=0,P=0;d=this.ClipDiagonalBound(b-D,D,b,p),u=this.ClipDiagonalBound(b+D,D,b,p);for(let M=d;M<=u;M+=2){M===d||M<u&&_[M-1]<_[M+1]?l=_[M+1]:l=_[M-1]+1,c=l-(M-b)-w;const R=l;for(;l<t&&c<s&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(_[M]=l,l+c>k+P&&(k=l,P=c),!x&&Math.abs(M-y)<=D-1&&l>=v[M])return o[0]=l,r[0]=c,R<=v[M]&&1447>0&&D<=1447+1?this.WALKTRACE(b,d,u,w,y,h,f,C,_,v,l,t,o,c,s,r,x,a):null}const O=(k-e+(P-i)-D)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(k,O))return a[0]=!0,o[0]=k,r[0]=P,O>0&&1447>0&&D<=1447+1?this.WALKTRACE(b,d,u,w,y,h,f,C,_,v,l,t,o,c,s,r,x,a):(e++,i++,[new Oc(e,t-e+1,i,s-i+1)]);h=this.ClipDiagonalBound(y-D,D,y,p),f=this.ClipDiagonalBound(y+D,D,y,p);for(let M=h;M<=f;M+=2){M===h||M<f&&v[M-1]>=v[M+1]?l=v[M+1]-1:l=v[M-1],c=l-(M-y)-C;const R=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(v[M]=l,x&&Math.abs(M-b)<=D&&l<=_[M])return o[0]=l,r[0]=c,R>=_[M]&&1447>0&&D<=1447+1?this.WALKTRACE(b,d,u,w,y,h,f,C,_,v,l,t,o,c,s,r,x,a):null}if(D<=1447){let M=new Int32Array(u-d+2);M[0]=b-d+1,ug.Copy2(_,d,M,1,u-d+1),this.m_forwardHistory.push(M),M=new Int32Array(f-h+2),M[0]=y-h+1,ug.Copy2(v,h,M,1,f-h+1),this.m_reverseHistory.push(M)}}return this.WALKTRACE(b,d,u,w,y,h,f,C,_,v,l,t,o,c,s,r,x,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],s=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,r=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<s&&i.modifiedStart+i.modifiedLength<o&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let s=0,o=0;if(t>0){const u=e[t-1];s=u.originalStart+u.originalLength,o=u.modifiedStart+u.modifiedLength}const r=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let u=1;;u++){const h=i.originalStart-u,f=i.modifiedStart-u;if(h<s||f<o||r&&!this.OriginalElementsAreEqual(h,h+i.originalLength)||a&&!this.ModifiedElementsAreEqual(f,f+i.modifiedLength))break;const p=(h===s&&f===o?5:0)+this._boundaryScore(h,i.originalLength,f,i.modifiedLength);p>c&&(c=p,l=u)}i.originalStart-=l,i.modifiedStart-=l;const d=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],d)){e[t-1]=d[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const s=e[t-1],o=e[t],r=o.originalStart-s.originalStart-s.originalLength,a=s.originalStart,l=o.originalStart+o.originalLength,c=l-a,d=s.modifiedStart,u=o.modifiedStart+o.modifiedLength,h=u-d;if(r<5&&c<20&&h<20){const f=this._findBetterContiguousSequence(a,c,d,h,r);if(f){const[g,p]=f;(g!==s.originalStart+s.originalLength||p!==s.modifiedStart+s.modifiedLength)&&(s.originalLength=g-s.originalStart,s.modifiedLength=p-s.modifiedStart,o.originalStart=g+r,o.modifiedStart=p+r,o.originalLength=l-o.originalStart,o.modifiedLength=u-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,s,o){if(t<o||s<o)return null;const r=e+t-o+1,a=i+s-o+1;let l=0,c=0,d=0;for(let u=e;u<r;u++)for(let h=i;h<a;h++){const f=this._contiguousSequenceScore(u,h,o);f>0&&f>l&&(l=f,c=u,d=h)}return l>0?[c,d]:null}_contiguousSequenceScore(e,t,i){let s=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;s+=this._originalStringElements[e+o].length}return s}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,s){const o=this._OriginalRegionIsBoundary(e,t)?1:0,r=this._ModifiedRegionIsBoundary(i,s)?1:0;return o+r}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const s=new Array(e.length+t.length-1);return ug.Copy(e,0,s,0,e.length-1),s[e.length-1]=i[0],ug.Copy(t,1,s,e.length,t.length-1),s}else{const s=new Array(e.length+t.length);return ug.Copy(e,0,s,0,e.length),ug.Copy(t,0,s,e.length,t.length),s}}ChangesOverlap(e,t,i){if(dg.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),dg.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const s=e.originalStart;let o=e.originalLength;const r=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new Oc(s,o,r,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,s){if(e>=0&&e<s)return e;const o=i,r=s-i-1,a=t%2===0;if(e<0){const l=o%2===0;return a===l?0:1}else{const l=r%2===0;return a===l?s-1:s-2}}}function GS(n){return n<0?0:n>255?255:n|0}function hg(n){return n<0?0:n>4294967295?4294967295:n|0}class H0e{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=hg(e);const i=this.values,s=this.prefixSum,o=t.length;return o===0?!1:(this.values=new Uint32Array(i.length+o),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+o),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=hg(e),t=hg(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=hg(e),t=hg(t);const i=this.values,s=this.prefixSum;if(e>=i.length)return!1;const o=i.length-e;return t>=o&&(t=o),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=hg(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,s=0,o=0,r=0;for(;t<=i;)if(s=t+(i-t)/2|0,o=this.prefixSum[s],r=o-this.values[s],e<r)i=s-1;else if(e>=o)t=s+1;else break;return new Uj(s,e-r)}}class $0e{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new Uj(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=dD(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],s=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=s+i;for(let o=0;o<i;o++)this._indexBySum[s+o]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class Uj{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class U0e{constructor(e,t,i,s){this._uri=e,this._lines=t,this._eol=i,this._versionId=s,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new V(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let s=0;s<t;s++)i[s]=this._lines[s].length+e;this._lineStarts=new H0e(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Pf(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const s=new Uint32Array(i.length-1);for(let o=1;o<i.length;o++)this._lines.splice(e.lineNumber+o-1,0,i[o]),s[o-1]=i[o].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,s)}}class oy{constructor(e){const t=GS(e);this._defaultValue=t,this._asciiMap=oy._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=GS(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class j0e{constructor(e,t,i){const s=new Uint8Array(e*t);for(let o=0,r=e*t;o<r;o++)s[o]=i;this._data=s,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class q0e{constructor(e){let t=0,i=0;for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const s=new j0e(i,t,0);for(let o=0,r=e.length;o<r;o++){const[a,l,c]=e[o];s.set(a,l,c)}this._states=s,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let H2=null;function G0e(){return H2===null&&(H2=new q0e([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),H2}let L0=null;function K0e(){if(L0===null){L0=new oy(0);const n=` 	<>'"`;for(let t=0;t<n.length;t++)L0.set(n.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)L0.set(e.charCodeAt(t),2)}return L0}class KS{static _createLink(e,t,i,s,o){let r=o-1;do{const a=t.charCodeAt(r);if(e.get(a)!==2)break;r--}while(r>s);if(s>0){const a=t.charCodeAt(s-1),l=t.charCodeAt(r);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&r--}return{range:{startLineNumber:i,startColumn:s+1,endLineNumber:i,endColumn:r+2},url:t.substring(s,r+1)}}static computeLinks(e,t=G0e()){const i=K0e(),s=[];for(let o=1,r=e.getLineCount();o<=r;o++){const a=e.getLineContent(o),l=a.length;let c=0,d=0,u=0,h=1,f=!1,g=!1,p=!1,_=!1;for(;c<l;){let v=!1;const b=a.charCodeAt(c);if(h===13){let y;switch(b){case 40:f=!0,y=0;break;case 41:y=f?0:1;break;case 91:p=!0,g=!0,y=0;break;case 93:p=!1,y=g?0:1;break;case 123:_=!0,y=0;break;case 125:y=_?0:1;break;case 39:case 34:case 96:u===b?y=1:u===39||u===34||u===96?y=0:y=1;break;case 42:y=u===42?1:0;break;case 124:y=u===124?1:0;break;case 32:y=p?0:1;break;default:y=i.get(b)}y===1&&(s.push(KS._createLink(i,a,o,d,c)),v=!0)}else if(h===12){let y;b===91?(g=!0,y=0):y=i.get(b),y===1?v=!0:h=13}else h=t.nextState(h,b),h===0&&(v=!0);v&&(h=1,f=!1,g=!1,_=!1,d=c+1,u=b),c++}h===13&&s.push(KS._createLink(i,a,o,d,l))}return s}}function Y0e(n){return!n||typeof n.getLineCount!="function"||typeof n.getLineContent!="function"?[]:KS.computeLinks(n)}class NT{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,s,o){if(e&&t){const r=this.doNavigateValueSet(t,o);if(r)return{range:e,value:r}}if(i&&s){const r=this.doNavigateValueSet(s,o);if(r)return{range:i,value:r}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let s=Number(e);const o=parseFloat(e);return!isNaN(s)&&!isNaN(o)&&s===o?s===0&&!t?null:(s=Math.floor(s*i),s+=t?i:-i,String(s/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let s=null;for(let o=0,r=e.length;s===null&&o<r;o++)s=this.valueSetReplace(e[o],t,i);return s}valueSetReplace(e,t,i){let s=e.indexOf(t);return s>=0?(s+=i?1:-1,s<0?s=e.length-1:s%=e.length,e[s]):null}}NT.INSTANCE=new NT;class Z0e extends oy{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function X0e(n){const e={};return t=>(e.hasOwnProperty(t)||(e[t]=n(t)),e[t])}const ym=X0e(n=>new Z0e(n));var jo;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(jo||(jo={}));var pp;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(pp||(pp={}));var Xs;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(Xs||(Xs={}));var wm;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(wm||(wm={}));class EC{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&So(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class $b{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function Q0e(n){return n&&typeof n.read=="function"}class $2{constructor(e,t,i,s,o,r){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=s,this.isAutoWhitespaceEdit=o,this._isTracked=r}}class J0e{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class e_e{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function t_e(n){return!n.isTooLargeForSyncing()&&!n.isForSimpleWidget}const i_e=999;class Qu{constructor(e,t,i,s){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=s}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=n_e(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=qU(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new J0e(t,this.wordSeparators?ym(this.wordSeparators):null,i?this.searchString:null)}}function n_e(n){if(!n||n.length===0)return!1;for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const s=n.charCodeAt(e);if(s===110||s===114||s===87)return!0}}return!1}function nh(n,e,t){if(!t)return new $b(n,null);const i=[];for(let s=0,o=e.length;s<o;s++)i[s]=e[s];return new $b(n,i)}class Z9{constructor(e){const t=[];let i=0;for(let s=0,o=e.length;s<o;s++)e.charCodeAt(s)===10&&(t[i++]=s);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,s=t.length-1;if(s===-1||e<=t[0])return 0;for(;i<s;){const o=i+((s-i)/2>>0);t[o]>=e?s=o-1:t[o+1]>=e?(i=o,s=o):i=o+1}return i+1}}class cw{static findMatches(e,t,i,s,o){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new Fg(r.wordSeparators,r.regex),s,o):this._doFindMatchesLineByLine(e,i,r,s,o):[]}static _getMultilineMatchRange(e,t,i,s,o,r){let a,l=0;s?(l=s.findLineFeedCountBeforeOffset(o),a=t+o+l):a=t+o;let c;if(s){const f=s.findLineFeedCountBeforeOffset(o+r.length)-l;c=a+r.length+f}else c=a+r.length;const d=e.getPositionAt(a),u=e.getPositionAt(c);return new N(d.lineNumber,d.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,i,s,o){const r=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new Z9(a):null,c=[];let d=0,u;for(i.reset(0);u=i.next(a);)if(c[d++]=nh(this._getMultilineMatchRange(e,r,a,l,u.index,u[0]),u,s),d>=o)return c;return c}static _doFindMatchesLineByLine(e,t,i,s,o){const r=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,r,s,o),r}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,r,s,o);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<o;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,r,s,o);if(a<o){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,r,s,o)}return r}static _findMatchesInLine(e,t,i,s,o,r,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const h=e.simpleSearch,f=h.length,g=t.length;let p=-f;for(;(p=t.indexOf(h,p+f))!==-1;)if((!c||_P(c,t,g,p,f))&&(r[o++]=new $b(new N(i,p+1+s,i,p+1+f+s),null),o>=l))return o;return o}const d=new Fg(e.wordSeparators,e.regex);let u;d.reset(0);do if(u=d.next(t),u&&(r[o++]=nh(new N(i,u.index+1+s,i,u.index+1+u[0].length+s),u,a),o>=l))return o;while(u);return o}static findNextMatch(e,t,i,s){const o=t.parseSearchRequest();if(!o)return null;const r=new Fg(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,i,r,s):this._doFindNextMatchLineByLine(e,i,r,s)}static _doFindNextMatchMultiline(e,t,i,s){const o=new V(t.lineNumber,1),r=e.getOffsetAt(o),a=e.getLineCount(),l=e.getValueInRange(new N(o.lineNumber,o.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new Z9(l):null;i.reset(t.column-1);const d=i.next(l);return d?nh(this._getMultilineMatchRange(e,r,l,c,d.index,d[0]),d,s):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new V(1,1),i,s):null}static _doFindNextMatchLineByLine(e,t,i,s){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r),l=this._findFirstMatchInLine(i,a,r,t.column,s);if(l)return l;for(let c=1;c<=o;c++){const d=(r+c-1)%o,u=e.getLineContent(d+1),h=this._findFirstMatchInLine(i,u,d+1,1,s);if(h)return h}return null}static _findFirstMatchInLine(e,t,i,s,o){e.reset(s-1);const r=e.next(t);return r?nh(new N(i,r.index+1,i,r.index+1+r[0].length),r,o):null}static findPreviousMatch(e,t,i,s){const o=t.parseSearchRequest();if(!o)return null;const r=new Fg(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,s):this._doFindPreviousMatchLineByLine(e,i,r,s)}static _doFindPreviousMatchMultiline(e,t,i,s){const o=this._doFindMatchesMultiline(e,new N(1,1,t.lineNumber,t.column),i,s,10*i_e);if(o.length>0)return o[o.length-1];const r=e.getLineCount();return t.lineNumber!==r||t.column!==e.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(e,new V(r,e.getLineMaxColumn(r)),i,s):null}static _doFindPreviousMatchLineByLine(e,t,i,s){const o=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,r,s);if(l)return l;for(let c=1;c<=o;c++){const d=(o+r-c-1)%o,u=e.getLineContent(d+1),h=this._findLastMatchInLine(i,u,d+1,s);if(h)return h}return null}static _findLastMatchInLine(e,t,i,s){let o=null,r;for(e.reset(0);r=e.next(t);)o=nh(new N(i,r.index+1,i,r.index+1+r[0].length),r,s);return o}}function s_e(n,e,t,i,s){if(i===0)return!0;const o=e.charCodeAt(i-1);if(n.get(o)!==0||o===13||o===10)return!0;if(s>0){const r=e.charCodeAt(i);if(n.get(r)!==0)return!0}return!1}function o_e(n,e,t,i,s){if(i+s===t)return!0;const o=e.charCodeAt(i+s);if(n.get(o)!==0||o===13||o===10)return!0;if(s>0){const r=e.charCodeAt(i+s-1);if(n.get(r)!==0)return!0}return!1}function _P(n,e,t,i,s){return s_e(n,e,t,i,s)&&o_e(n,e,t,i,s)}class Fg{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const s=i.index,o=i[0].length;if(s===this._prevMatchStartIndex&&o===this._prevMatchLength){if(o===0){WS(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=s,this._prevMatchLength=o,!this._wordSeparators||_P(this._wordSeparators,e,t,s,o))return i}while(i);return null}}class r_e{static computeUnicodeHighlights(e,t,i){const s=i?i.startLineNumber:1,o=i?i.endLineNumber:e.getLineCount(),r=new X9(t),a=r.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${a_e(Array.from(a))}`,"g");const c=new Fg(null,l),d=[];let u=!1,h,f=0,g=0,p=0;e:for(let _=s,v=o;_<=v;_++){const b=e.getLineContent(_),y=b.length;c.reset(0);do if(h=c.next(b),h){let w=h.index,C=h.index+h[0].length;if(w>0){const k=b.charCodeAt(w-1);tn(k)&&w--}if(C+1<y){const k=b.charCodeAt(C-1);tn(k)&&C++}const L=b.substring(w,C);let x=Nb(w+1,$4,b,0);x&&x.endColumn<=w+1&&(x=null);const D=r.shouldHighlightNonBasicASCII(L,x?x.word:null);if(D!==0){D===3?f++:D===2?g++:D===1?p++:lP();const k=1e3;if(d.length>=k){u=!0;break e}d.push(new N(_,w+1,_,C+1))}}while(h)}return{ranges:d,hasMore:u,ambiguousCharacterCount:f,invisibleCharacterCount:g,nonBasicAsciiCharacterCount:p}}static computeUnicodeHighlightReason(e,t){const i=new X9(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const o=e.codePointAt(0),r=i.ambiguousCharacters.getPrimaryConfusable(o),a=hf.getLocales().filter(l=>!hf.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(o));return{kind:0,confusableWith:String.fromCodePoint(r),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function a_e(n,e){return`[${br(n.map(i=>String.fromCodePoint(i)).join(""))}]`}class X9{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=hf.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of xd.codePoints)Q9(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let s=!1,o=!1;if(t)for(const r of t){const a=r.codePointAt(0),l=iP(r);s=s||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!xd.isInvisibleCharacter(a)&&(o=!0)}return!s&&o?0:this.options.invisibleCharacters&&!Q9(e)&&xd.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function Q9(n){return n===" "||n===`
`||n==="	"}class AC{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class jj{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class Ye{static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let s=i;for(;s<t.length&&t[s].start<=e.endExclusive;)s++;if(i===s)t.splice(i,0,e);else{const o=Math.min(e.start,t[i].start),r=Math.max(e.endExclusive,t[s-1].endExclusive);t.splice(i,s-i,new Ye(o,r))}}static tryCreate(e,t){if(!(e>t))return new Ye(e,t)}static ofLength(e){return new Ye(0,e)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new ji(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new Ye(this.start+e,this.endExclusive+e)}deltaStart(e){return new Ye(this.start+e,this.endExclusive)}deltaEnd(e){return new Ye(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new Ye(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new Ye(t,i)}slice(e){return e.slice(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new ji(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new ji(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}}class bP{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const s=Math.min(e.start,this._sortedRanges[t].start),o=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new Ye(s,o))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new bP;for(const i of this._sortedRanges){const s=i.intersect(e);s&&t.addRange(s)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function RT(n,e,t){const i=l_e(n,e);if(i!==-1)return n[i]}function l_e(n,e,t=n.length-1){for(let i=t;i>=0;i--){const s=n[i];if(e(s))return i}return-1}function Ub(n,e){const t=jb(n,e);return t===-1?void 0:n[t]}function jb(n,e,t=0,i=n.length){let s=t,o=i;for(;s<o;){const r=Math.floor((s+o)/2);e(n[r])?s=r+1:o=r}return s-1}function c_e(n,e){const t=qb(n,e);return t===n.length?void 0:n[t]}function qb(n,e,t=0,i=n.length){let s=t,o=i;for(;s<o;){const r=Math.floor((s+o)/2);e(n[r])?o=r:s=r+1}return s}class ry{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(ry.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=jb(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}}ry.assertInvariants=!1;function d_e(n,e){if(n.length===0)return;let t=n[0];for(let i=1;i<n.length;i++){const s=n[i];e(s,t)>0&&(t=s)}return t}function u_e(n,e){if(n.length===0)return;let t=n[0];for(let i=1;i<n.length;i++){const s=n[i];e(s,t)>=0&&(t=s)}return t}function h_e(n,e){return d_e(n,(t,i)=>-e(t,i))}function f_e(n,e){if(n.length===0)return-1;let t=0;for(let i=1;i<n.length;i++){const s=n[i];e(s,n[t])>0&&(t=i)}return t}let Qe=class Fc{static fromRange(e){return new Fc(e.startLineNumber,e.endLineNumber)}static joinMany(e){if(e.length===0)return[];let t=new ka(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new ka(e[i].slice()));return t.ranges}static ofLength(e,t){return new Fc(e,e+t)}static deserialize(e){return new Fc(e[0],e[1])}constructor(e,t){if(e>t)throw new ji(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new Fc(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new Fc(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new Fc(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new Fc(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new N(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new N(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new Ye(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class ka{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=qb(this._normalizedRanges,s=>s.endLineNumberExclusive>=e.startLineNumber),i=jb(this._normalizedRanges,s=>s.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const s=this._normalizedRanges[t];this._normalizedRanges[t]=s.join(e)}else{const s=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,s)}}contains(e){const t=Ub(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,s=0,o=null;for(;i<this._normalizedRanges.length||s<e._normalizedRanges.length;){let r=null;if(i<this._normalizedRanges.length&&s<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[s];a.startLineNumber<l.startLineNumber?(r=a,i++):(r=l,s++)}else i<this._normalizedRanges.length?(r=this._normalizedRanges[i],i++):(r=e._normalizedRanges[s],s++);o===null?o=r:o.endLineNumberExclusive>=r.startLineNumber?o=new Qe(o.startLineNumber,Math.max(o.endLineNumberExclusive,r.endLineNumberExclusive)):(t.push(o),o=r)}return o!==null&&t.push(o),new ka(t)}subtractFrom(e){const t=qb(this._normalizedRanges,r=>r.endLineNumberExclusive>=e.startLineNumber),i=jb(this._normalizedRanges,r=>r.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new ka([e]);const s=[];let o=e.startLineNumber;for(let r=t;r<i;r++){const a=this._normalizedRanges[r];a.startLineNumber>o&&s.push(new Qe(o,a.startLineNumber)),o=a.endLineNumberExclusive}return o<e.endLineNumberExclusive&&s.push(new Qe(o,e.endLineNumberExclusive)),new ka(s)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,s=0;for(;i<this._normalizedRanges.length&&s<e._normalizedRanges.length;){const o=this._normalizedRanges[i],r=e._normalizedRanges[s],a=o.intersect(r);a&&!a.isEmpty&&t.push(a),o.endLineNumberExclusive<r.endLineNumberExclusive?i++:s++}return new ka(t)}getWithDelta(e){return new ka(this._normalizedRanges.map(t=>t.delta(e)))}}class Qa{static inverse(e,t,i){const s=[];let o=1,r=1;for(const l of e){const c=new qo(new Qe(o,l.original.startLineNumber),new Qe(r,l.modified.startLineNumber),void 0);c.modified.isEmpty||s.push(c),o=l.original.endLineNumberExclusive,r=l.modified.endLineNumberExclusive}const a=new qo(new Qe(o,t+1),new Qe(r,i+1),void 0);return a.modified.isEmpty||s.push(a),s}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new Qa(this.modified,this.original)}join(e){return new Qa(this.original.join(e.original),this.modified.join(e.modified))}}class qo extends Qa{constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){var e;return new qo(this.modified,this.original,(e=this.innerChanges)===null||e===void 0?void 0:e.map(t=>t.flip()))}}class nu{constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new nu(this.modifiedRange,this.originalRange)}}const g_e=3;class p_e{computeDiff(e,t,i){var s;const r=new b_e(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),a=[];let l=null;for(const c of r.changes){let d;c.originalEndLineNumber===0?d=new Qe(c.originalStartLineNumber+1,c.originalStartLineNumber+1):d=new Qe(c.originalStartLineNumber,c.originalEndLineNumber+1);let u;c.modifiedEndLineNumber===0?u=new Qe(c.modifiedStartLineNumber+1,c.modifiedStartLineNumber+1):u=new Qe(c.modifiedStartLineNumber,c.modifiedEndLineNumber+1);let h=new qo(d,u,(s=c.charChanges)===null||s===void 0?void 0:s.map(f=>new nu(new N(f.originalStartLineNumber,f.originalStartColumn,f.originalEndLineNumber,f.originalEndColumn),new N(f.modifiedStartLineNumber,f.modifiedStartColumn,f.modifiedEndLineNumber,f.modifiedEndColumn))));l&&(l.modified.endLineNumberExclusive===h.modified.startLineNumber||l.original.endLineNumberExclusive===h.original.startLineNumber)&&(h=new qo(l.original.join(h.original),l.modified.join(h.modified),l.innerChanges&&h.innerChanges?l.innerChanges.concat(h.innerChanges):void 0),a.pop()),a.push(h),l=h}return Wb(()=>nj(a,(c,d)=>d.original.startLineNumber-c.original.endLineNumberExclusive===d.modified.startLineNumber-c.modified.endLineNumberExclusive&&c.original.endLineNumberExclusive<d.original.startLineNumber&&c.modified.endLineNumberExclusive<d.modified.startLineNumber)),new AC(a,[],r.quitEarly)}}function qj(n,e,t,i){return new zl(n,e,t).ComputeDiff(i)}let J9=class{constructor(e){const t=[],i=[];for(let s=0,o=e.length;s<o;s++)t[s]=MT(e[s],1),i[s]=PT(e[s],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const s=[],o=[],r=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,u=e?this._endColumns[l]:c.length+1;for(let h=d;h<u;h++)s[a]=c.charCodeAt(h-1),o[a]=l+1,r[a]=h,a++;!e&&l<i&&(s[a]=10,o[a]=l+1,r[a]=c.length+1,a++)}return new m_e(s,o,r)}};class m_e{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class mp{constructor(e,t,i,s,o,r,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=s,this.modifiedStartLineNumber=o,this.modifiedStartColumn=r,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const s=t.getStartLineNumber(e.originalStart),o=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),u=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new mp(s,o,r,a,l,c,d,u)}}function __e(n){if(n.length<=1)return n;const e=[n[0]];let t=e[0];for(let i=1,s=n.length;i<s;i++){const o=n[i],r=o.originalStart-(t.originalStart+t.originalLength),a=o.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(r,a)<g_e?(t.originalLength=o.originalStart+o.originalLength-t.originalStart,t.modifiedLength=o.modifiedStart+o.modifiedLength-t.modifiedStart):(e.push(o),t=o)}return e}class I_{constructor(e,t,i,s,o){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=s,this.charChanges=o}static createFromDiffResult(e,t,i,s,o,r,a){let l,c,d,u,h;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=s.getStartLineNumber(t.modifiedStart)-1,u=0):(d=s.getStartLineNumber(t.modifiedStart),u=s.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),r&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&o()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=s.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(f.getElements().length>0&&g.getElements().length>0){let p=qj(f,g,o,!0).changes;a&&(p=__e(p)),h=[];for(let _=0,v=p.length;_<v;_++)h.push(mp.createFromDiffChange(p[_],f,g))}}return new I_(l,c,d,u,h)}}class b_e{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new J9(e),this.modified=new J9(t),this.continueLineDiff=e7(i.maxComputationTime),this.continueCharDiff=e7(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=qj(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(I_.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const s=[];let o=0,r=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,u=c?c.modifiedStart:this.modifiedLines.length;for(;o<d&&r<u;){const h=this.originalLines[o],f=this.modifiedLines[r];if(h!==f){{let g=MT(h,1),p=MT(f,1);for(;g>1&&p>1;){const _=h.charCodeAt(g-2),v=f.charCodeAt(p-2);if(_!==v)break;g--,p--}(g>1||p>1)&&this._pushTrimWhitespaceCharChange(s,o+1,1,g,r+1,1,p)}{let g=PT(h,1),p=PT(f,1);const _=h.length+1,v=f.length+1;for(;g<_&&p<v;){const b=h.charCodeAt(g-1),y=h.charCodeAt(p-1);if(b!==y)break;g++,p++}(g<_||p<v)&&this._pushTrimWhitespaceCharChange(s,o+1,g,_,r+1,p,v)}}o++,r++}c&&(s.push(I_.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),o+=c.originalLength,r+=c.modifiedLength)}return{quitEarly:i,changes:s}}_pushTrimWhitespaceCharChange(e,t,i,s,o,r,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,s,o,r,a))return;let l;this.shouldComputeCharChanges&&(l=[new mp(t,i,t,s,o,r,o,a)]),e.push(new I_(t,t,o,o,l))}_mergeTrimWhitespaceCharChange(e,t,i,s,o,r,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===o?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new mp(t,i,t,s,o,r,o,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===o?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=o,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new mp(t,i,t,s,o,r,o,a)),!0):!1}}function MT(n,e){const t=Zs(n);return t===-1?e:t+1}function PT(n,e){const t=Of(n);return t===-1?e:t+2}function e7(n){if(n===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<n}class nc{static trivial(e,t){return new nc([new un(Ye.ofLength(e.length),Ye.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new nc([new un(Ye.ofLength(e.length),Ye.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class un{static invert(e,t){const i=[];return gU(e,(s,o)=>{i.push(un.fromOffsetPairs(s?s.getEndExclusives():Pa.zero,o?o.getStarts():new Pa(t,(s?s.seq2Range.endExclusive-s.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new un(new Ye(e.offset1,t.offset1),new Ye(e.offset2,t.offset2))}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new un(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new un(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new un(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new un(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new un(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new un(t,i)}getStarts(){return new Pa(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new Pa(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}class Pa{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}}Pa.zero=new Pa(0,0);Pa.max=new Pa(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);class Gb{isValid(){return!0}}Gb.instance=new Gb;class v_e{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new ji("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class U2{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function OT(n){return n===32||n===9}class Cm{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let s=0;for(let o=e.startLineNumber-1;o<e.endLineNumberExclusive-1;o++){const r=t[o];for(let l=0;l<r.length;l++){s++;const c=r[l],d=Cm.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}s++;const a=Cm.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=s}computeSimilarity(e){var t,i;let s=0;const o=Math.max(this.histogram.length,e.histogram.length);for(let r=0;r<o;r++)s+=Math.abs(((t=this.histogram[r])!==null&&t!==void 0?t:0)-((i=e.histogram[r])!==null&&i!==void 0?i:0));return 1-s/(this.totalCount+e.totalCount)}}Cm.chrKeys=new Map;class y_e{compute(e,t,i=Gb.instance,s){if(e.length===0||t.length===0)return nc.trivial(e,t);const o=new U2(e.length,t.length),r=new U2(e.length,t.length),a=new U2(e.length,t.length);for(let g=0;g<e.length;g++)for(let p=0;p<t.length;p++){if(!i.isValid())return nc.trivialTimedOut(e,t);const _=g===0?0:o.get(g-1,p),v=p===0?0:o.get(g,p-1);let b;e.getElement(g)===t.getElement(p)?(g===0||p===0?b=0:b=o.get(g-1,p-1),g>0&&p>0&&r.get(g-1,p-1)===3&&(b+=a.get(g-1,p-1)),b+=s?s(g,p):1):b=-1;const y=Math.max(_,v,b);if(y===b){const w=g>0&&p>0?a.get(g-1,p-1):0;a.set(g,p,w+1),r.set(g,p,3)}else y===_?(a.set(g,p,0),r.set(g,p,1)):y===v&&(a.set(g,p,0),r.set(g,p,2));o.set(g,p,y)}const l=[];let c=e.length,d=t.length;function u(g,p){(g+1!==c||p+1!==d)&&l.push(new un(new Ye(g+1,c),new Ye(p+1,d))),c=g,d=p}let h=e.length-1,f=t.length-1;for(;h>=0&&f>=0;)r.get(h,f)===3?(u(h,f),h--,f--):r.get(h,f)===1?h--:f--;return u(-1,-1),l.reverse(),new nc(l,!1)}}class Gj{compute(e,t,i=Gb.instance){if(e.length===0||t.length===0)return nc.trivial(e,t);const s=e,o=t;function r(p,_){for(;p<s.length&&_<o.length&&s.getElement(p)===o.getElement(_);)p++,_++;return p}let a=0;const l=new w_e;l.set(0,r(0,0));const c=new C_e;c.set(0,l.get(0)===0?null:new t7(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return nc.trivialTimedOut(s,o);const p=-Math.min(a,o.length+a%2),_=Math.min(a,s.length+a%2);for(d=p;d<=_;d+=2){const v=d===_?-1:l.get(d+1),b=d===p?-1:l.get(d-1)+1,y=Math.min(Math.max(v,b),s.length),w=y-d;if(y>s.length||w>o.length)continue;const C=r(y,w);l.set(d,C);const L=y===v?c.get(d+1):c.get(d-1);if(c.set(d,C!==y?new t7(L,y,w,C-y):L),l.get(d)===s.length&&l.get(d)-d===o.length)break e}}let u=c.get(d);const h=[];let f=s.length,g=o.length;for(;;){const p=u?u.x+u.length:0,_=u?u.y+u.length:0;if((p!==f||_!==g)&&h.push(new un(new Ye(p,f),new Ye(_,g))),!u)break;f=u.x,g=u.y,u=u.prev}return h.reverse(),new nc(h,!1)}}class t7{constructor(e,t,i,s){this.prev=e,this.x=t,this.y=i,this.length=s}}class w_e{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class C_e{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}var i7,n7;class S_e{constructor(e,t){this.uri=e,this.value=t}}function x_e(n){return Array.isArray(n)}class In{constructor(e,t){if(this[i7]="ResourceMap",e instanceof In)this.map=new Map(e.map),this.toKey=t??In.defaultToKey;else if(x_e(e)){this.map=new Map,this.toKey=t??In.defaultToKey;for(const[i,s]of e)this.set(i,s)}else this.map=new Map,this.toKey=e??In.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new S_e(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))===null||t===void 0?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,s]of this.map)e(s.value,s.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(i7=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}}In.defaultToKey=n=>n.toString();class L_e{constructor(){this[n7]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)===null||e===void 0?void 0:e.value}get last(){var e;return(e=this._tail)===null||e===void 0?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let s=this._map.get(e);if(s)s.value=t,i!==0&&this.touch(s,i);else{switch(s={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(s);break;case 1:this.addItemFirst(s);break;case 2:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let s=this._head;for(;s;){if(t?e.bind(t)(s.value,s.key,this):e(s.value,s.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.key,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return s}values(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:i.value,done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return s}entries(){const e=this,t=this._state;let i=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const o={value:[i.key,i.value],done:!1};return i=i.next,o}else return{value:void 0,done:!0}}};return s}[(n7=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,s=e.previous;e===this._tail?(s.next=void 0,this._tail=s):(i.previous=s,s.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,s=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=s,s.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class vP extends L_e{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}class D_e{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Kj{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}class YS{constructor(e,t,i){this.lines=e,this.considerWhitespaceChanges=i,this.elements=[],this.firstCharOffsetByLine=[],this.additionalOffsetByLine=[];let s=!1;t.start>0&&t.endExclusive>=e.length&&(t=new Ye(t.start-1,t.endExclusive),s=!0),this.lineRange=t,this.firstCharOffsetByLine[0]=0;for(let o=this.lineRange.start;o<this.lineRange.endExclusive;o++){let r=e[o],a=0;if(s)a=r.length,r="",s=!1;else if(!i){const l=r.trimStart();a=r.length-l.length,r=l.trimEnd()}this.additionalOffsetByLine.push(a);for(let l=0;l<r.length;l++)this.elements.push(r.charCodeAt(l));o<e.length-1&&(this.elements.push(`
`.charCodeAt(0)),this.firstCharOffsetByLine[o-this.lineRange.start+1]=this.elements.length)}this.additionalOffsetByLine.push(0)}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new Ye(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=o7(e>0?this.elements[e-1]:-1),i=o7(e<this.elements.length?this.elements[e]:-1);if(t===6&&i===7)return 0;let s=0;return t!==i&&(s+=10,t===0&&i===1&&(s+=1)),s+=s7(t),s+=s7(i),s}translateOffset(e){if(this.lineRange.isEmpty)return new V(this.lineRange.start+1,1);const t=jb(this.firstCharOffsetByLine,i=>i<=e);return new V(this.lineRange.start+t+1,e-this.firstCharOffsetByLine[t]+this.additionalOffsetByLine[t]+1)}translateRange(e){return N.fromPositions(this.translateOffset(e.start),this.translateOffset(e.endExclusive))}findWordContaining(e){if(e<0||e>=this.elements.length||!j2(this.elements[e]))return;let t=e;for(;t>0&&j2(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&j2(this.elements[i]);)i++;return new Ye(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){var t,i;const s=(t=Ub(this.firstCharOffsetByLine,r=>r<=e.start))!==null&&t!==void 0?t:0,o=(i=c_e(this.firstCharOffsetByLine,r=>e.endExclusive<=r))!==null&&i!==void 0?i:this.elements.length;return new Ye(s,o)}}function j2(n){return n>=97&&n<=122||n>=65&&n<=90||n>=48&&n<=57}const k_e={0:0,1:0,2:0,3:10,4:2,5:3,6:10,7:10};function s7(n){return k_e[n]}function o7(n){return n===10?7:n===13?6:OT(n)?5:n>=97&&n<=122?0:n>=65&&n<=90?1:n>=48&&n<=57?2:n===-1?3:4}function E_e(n,e,t,i,s,o){let{moves:r,excludedChanges:a}=A_e(n,e,t,o);if(!o.isValid())return[];const l=n.filter(d=>!a.has(d)),c=I_e(l,i,s,e,t,o);return bI(r,c),r=T_e(r),r=r.filter(d=>d.original.toOffsetRange().slice(e).map(h=>h.trim()).join(`
`).length>=10),r=N_e(n,r),r}function A_e(n,e,t,i){const s=[],o=n.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new Cm(l.original,e,l)),r=new Set(n.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new Cm(l.modified,t,l))),a=new Set;for(const l of o){let c=-1,d;for(const u of r){const h=l.computeSimilarity(u);h>c&&(c=h,d=u)}if(c>.9&&d&&(r.delete(d),s.push(new Qa(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:s,excludedChanges:a}}return{moves:s,excludedChanges:a}}function I_e(n,e,t,i,s,o){const r=[],a=new Kj;for(const h of n)for(let f=h.original.startLineNumber;f<h.original.endLineNumberExclusive-2;f++){const g=`${e[f-1]}:${e[f+1-1]}:${e[f+2-1]}`;a.add(g,{range:new Qe(f,f+3)})}const l=[];n.sort(ur(h=>h.modified.startLineNumber,wd));for(const h of n){let f=[];for(let g=h.modified.startLineNumber;g<h.modified.endLineNumberExclusive-2;g++){const p=`${t[g-1]}:${t[g+1-1]}:${t[g+2-1]}`,_=new Qe(g,g+3),v=[];a.forEach(p,({range:b})=>{for(const w of f)if(w.originalLineRange.endLineNumberExclusive+1===b.endLineNumberExclusive&&w.modifiedLineRange.endLineNumberExclusive+1===_.endLineNumberExclusive){w.originalLineRange=new Qe(w.originalLineRange.startLineNumber,b.endLineNumberExclusive),w.modifiedLineRange=new Qe(w.modifiedLineRange.startLineNumber,_.endLineNumberExclusive),v.push(w);return}const y={modifiedLineRange:_,originalLineRange:b};l.push(y),v.push(y)}),f=v}if(!o.isValid())return[]}l.sort(bU(ur(h=>h.modifiedLineRange.length,wd)));const c=new ka,d=new ka;for(const h of l){const f=h.modifiedLineRange.startLineNumber-h.originalLineRange.startLineNumber,g=c.subtractFrom(h.modifiedLineRange),p=d.subtractFrom(h.originalLineRange).getWithDelta(f),_=g.getIntersection(p);for(const v of _.ranges){if(v.length<3)continue;const b=v,y=v.delta(-f);r.push(new Qa(y,b)),c.addRange(b),d.addRange(y)}}r.sort(ur(h=>h.original.startLineNumber,wd));const u=new ry(n);for(let h=0;h<r.length;h++){const f=r[h],g=u.findLastMonotonous(L=>L.original.startLineNumber<=f.original.startLineNumber),p=Ub(n,L=>L.modified.startLineNumber<=f.modified.startLineNumber),_=Math.max(f.original.startLineNumber-g.original.startLineNumber,f.modified.startLineNumber-p.modified.startLineNumber),v=u.findLastMonotonous(L=>L.original.startLineNumber<f.original.endLineNumberExclusive),b=Ub(n,L=>L.modified.startLineNumber<f.modified.endLineNumberExclusive),y=Math.max(v.original.endLineNumberExclusive-f.original.endLineNumberExclusive,b.modified.endLineNumberExclusive-f.modified.endLineNumberExclusive);let w;for(w=0;w<_;w++){const L=f.original.startLineNumber-w-1,x=f.modified.startLineNumber-w-1;if(L>i.length||x>s.length||c.contains(x)||d.contains(L)||!r7(i[L-1],s[x-1],o))break}w>0&&(d.addRange(new Qe(f.original.startLineNumber-w,f.original.startLineNumber)),c.addRange(new Qe(f.modified.startLineNumber-w,f.modified.startLineNumber)));let C;for(C=0;C<y;C++){const L=f.original.endLineNumberExclusive+C,x=f.modified.endLineNumberExclusive+C;if(L>i.length||x>s.length||c.contains(x)||d.contains(L)||!r7(i[L-1],s[x-1],o))break}C>0&&(d.addRange(new Qe(f.original.endLineNumberExclusive,f.original.endLineNumberExclusive+C)),c.addRange(new Qe(f.modified.endLineNumberExclusive,f.modified.endLineNumberExclusive+C))),(w>0||C>0)&&(r[h]=new Qa(new Qe(f.original.startLineNumber-w,f.original.endLineNumberExclusive+C),new Qe(f.modified.startLineNumber-w,f.modified.endLineNumberExclusive+C)))}return r}function r7(n,e,t){if(n.trim()===e.trim())return!0;if(n.length>300&&e.length>300)return!1;const s=new Gj().compute(new YS([n],new Ye(0,1),!1),new YS([e],new Ye(0,1),!1),t);let o=0;const r=un.invert(s.diffs,n.length);for(const d of r)d.seq1Range.forEach(u=>{OT(n.charCodeAt(u))||o++});function a(d){let u=0;for(let h=0;h<n.length;h++)OT(d.charCodeAt(h))||u++;return u}const l=a(n.length>e.length?n:e);return o/l>.6&&l>10}function T_e(n){if(n.length===0)return n;n.sort(ur(t=>t.original.startLineNumber,wd));const e=[n[0]];for(let t=1;t<n.length;t++){const i=e[e.length-1],s=n[t],o=s.original.startLineNumber-i.original.endLineNumberExclusive,r=s.modified.startLineNumber-i.modified.endLineNumberExclusive;if(o>=0&&r>=0&&o+r<=2){e[e.length-1]=i.join(s);continue}e.push(s)}return e}function N_e(n,e){const t=new ry(n);return e=e.filter(i=>{const s=t.findLastMonotonous(a=>a.original.endLineNumberExclusive<i.original.endLineNumberExclusive)||new Qa(new Qe(1,1),new Qe(1,1)),o=Ub(n,a=>a.modified.endLineNumberExclusive<i.modified.endLineNumberExclusive);return s!==o}),e}function FT(n,e,t){let i=t;return i=R_e(n,e,i),i=M_e(n,e,i),i}function R_e(n,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let o=1;o<t.length;o++){const r=i[i.length-1];let a=t[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-r.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(n.getElement(a.seq1Range.start-c)!==n.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new un(new Ye(r.seq1Range.start,a.seq1Range.endExclusive-l),new Ye(r.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const s=[];for(let o=0;o<i.length-1;o++){const r=i[o+1];let a=i[o];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=r.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!n.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[o+1]=new un(new Ye(a.seq1Range.start+l,r.seq1Range.endExclusive),new Ye(a.seq2Range.start+l,r.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}s.push(a)}return i.length>0&&s.push(i[i.length-1]),s}function M_e(n,e,t){if(!n.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const s=i>0?t[i-1]:void 0,o=t[i],r=i+1<t.length?t[i+1]:void 0,a=new Ye(s?s.seq1Range.start+1:0,r?r.seq1Range.endExclusive-1:n.length),l=new Ye(s?s.seq2Range.start+1:0,r?r.seq2Range.endExclusive-1:e.length);o.seq1Range.isEmpty?t[i]=a7(o,n,e,a,l):o.seq2Range.isEmpty&&(t[i]=a7(o.swap(),e,n,l,a).swap())}return t}function a7(n,e,t,i,s){let r=1;for(;n.seq1Range.start-r>=i.start&&n.seq2Range.start-r>=s.start&&t.isStronglyEqual(n.seq2Range.start-r,n.seq2Range.endExclusive-r)&&r<100;)r++;r--;let a=0;for(;n.seq1Range.start+a<i.endExclusive&&n.seq2Range.endExclusive+a<s.endExclusive&&t.isStronglyEqual(n.seq2Range.start+a,n.seq2Range.endExclusive+a)&&a<100;)a++;if(r===0&&a===0)return n;let l=0,c=-1;for(let d=-r;d<=a;d++){const u=n.seq2Range.start+d,h=n.seq2Range.endExclusive+d,f=n.seq1Range.start+d,g=e.getBoundaryScore(f)+t.getBoundaryScore(u)+t.getBoundaryScore(h);g>c&&(c=g,l=d)}return n.delta(l)}function P_e(n,e,t){const i=[];for(const s of t){const o=i[i.length-1];if(!o){i.push(s);continue}s.seq1Range.start-o.seq1Range.endExclusive<=2||s.seq2Range.start-o.seq2Range.endExclusive<=2?i[i.length-1]=new un(o.seq1Range.join(s.seq1Range),o.seq2Range.join(s.seq2Range)):i.push(s)}return i}function O_e(n,e,t){const i=[];let s;function o(){if(!s)return;const a=s.s1Range.length-s.deleted;s.s2Range.length-s.added,Math.max(s.deleted,s.added)+(s.count-1)>a&&i.push(new un(s.s1Range,s.s2Range)),s=void 0}for(const a of t){let l=function(f,g){var p,_,v,b;if(!s||!s.s1Range.containsRange(f)||!s.s2Range.containsRange(g))if(s&&!(s.s1Range.endExclusive<f.start&&s.s2Range.endExclusive<g.start)){const C=Ye.tryCreate(s.s1Range.endExclusive,f.start),L=Ye.tryCreate(s.s2Range.endExclusive,g.start);s.deleted+=(p=C==null?void 0:C.length)!==null&&p!==void 0?p:0,s.added+=(_=L==null?void 0:L.length)!==null&&_!==void 0?_:0,s.s1Range=s.s1Range.join(f),s.s2Range=s.s2Range.join(g)}else o(),s={added:0,deleted:0,count:0,s1Range:f,s2Range:g};const y=f.intersect(a.seq1Range),w=g.intersect(a.seq2Range);s.count++,s.deleted+=(v=y==null?void 0:y.length)!==null&&v!==void 0?v:0,s.added+=(b=w==null?void 0:w.length)!==null&&b!==void 0?b:0};const c=n.findWordContaining(a.seq1Range.start-1),d=e.findWordContaining(a.seq2Range.start-1),u=n.findWordContaining(a.seq1Range.endExclusive),h=e.findWordContaining(a.seq2Range.endExclusive);c&&u&&d&&h&&c.equals(u)&&d.equals(h)?l(c,d):(c&&d&&l(c,d),u&&h&&l(u,h))}return o(),F_e(t,i)}function F_e(n,e){const t=[];for(;n.length>0||e.length>0;){const i=n[0],s=e[0];let o;i&&(!s||i.seq1Range.start<s.seq1Range.start)?o=n.shift():o=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=o.seq1Range.start?t[t.length-1]=t[t.length-1].join(o):t.push(o)}return t}function B_e(n,e,t){let i=t;if(i.length===0)return i;let s=0,o;do{o=!1;const r=[i[0]];for(let a=1;a<i.length;a++){let d=function(h,f){const g=new Ye(c.seq1Range.endExclusive,l.seq1Range.start);return n.getText(g).replace(/\s/g,"").length<=4&&(h.seq1Range.length+h.seq2Range.length>5||f.seq1Range.length+f.seq2Range.length>5)};const l=i[a],c=r[r.length-1];d(c,l)?(o=!0,r[r.length-1]=r[r.length-1].join(l)):r.push(l)}i=r}while(s++<10&&o);return i}function W_e(n,e,t){let i=t;if(i.length===0)return i;let s=0,o;do{o=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let u=function(f,g){const p=new Ye(d.seq1Range.endExclusive,c.seq1Range.start);if(n.countLinesIn(p)>5||p.length>500)return!1;const v=n.getText(p).trim();if(v.length>20||v.split(/\r\n|\r|\n/).length>1)return!1;const b=n.countLinesIn(f.seq1Range),y=f.seq1Range.length,w=e.countLinesIn(f.seq2Range),C=f.seq2Range.length,L=n.countLinesIn(g.seq1Range),x=g.seq1Range.length,D=e.countLinesIn(g.seq2Range),k=g.seq2Range.length,P=2*40+50;function O(M){return Math.min(M,P)}return Math.pow(Math.pow(O(b*40+y),1.5)+Math.pow(O(w*40+C),1.5),1.5)+Math.pow(Math.pow(O(L*40+x),1.5)+Math.pow(O(D*40+k),1.5),1.5)>Math.pow(Math.pow(P,1.5),1.5)*1.3};const c=i[l],d=a[a.length-1];u(d,c)?(o=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(s++<10&&o);const r=[];return $he(i,(a,l,c)=>{let d=l;function u(v){return v.length>0&&v.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const h=n.extendToFullLines(l.seq1Range),f=n.getText(new Ye(h.start,l.seq1Range.start));u(f)&&(d=d.deltaStart(-f.length));const g=n.getText(new Ye(l.seq1Range.endExclusive,h.endExclusive));u(g)&&(d=d.deltaEnd(g.length));const p=un.fromOffsetPairs(a?a.getEndExclusives():Pa.zero,c?c.getStarts():Pa.max),_=d.intersect(p);r.push(_)}),r}class l7{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:c7(this.lines[e-1]),i=e===this.lines.length?0:c7(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function c7(n){let e=0;for(;e<n.length&&(n.charCodeAt(e)===32||n.charCodeAt(e)===9);)e++;return e}class Yj{constructor(){this.dynamicProgrammingDiffing=new y_e,this.myersDiffingAlgorithm=new Gj}computeDiff(e,t,i){if(e.length<=1&&Ki(e,t,(C,L)=>C===L))return new AC([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new AC([new qo(new Qe(1,e.length+1),new Qe(1,t.length+1),[new nu(new N(1,1,e.length,e[0].length+1),new N(1,1,t.length,t[0].length+1))])],[],!1);const s=i.maxComputationTimeMs===0?Gb.instance:new v_e(i.maxComputationTimeMs),o=!i.ignoreTrimWhitespace,r=new Map;function a(C){let L=r.get(C);return L===void 0&&(L=r.size,r.set(C,L)),L}const l=e.map(C=>a(C.trim())),c=t.map(C=>a(C.trim())),d=new l7(l,e),u=new l7(c,t),h=(()=>d.length+u.length<1700?this.dynamicProgrammingDiffing.compute(d,u,s,(C,L)=>e[C]===t[L]?t[L].length===0?.1:1+Math.log(1+t[L].length):.99):this.myersDiffingAlgorithm.compute(d,u))();let f=h.diffs,g=h.hitTimeout;f=FT(d,u,f),f=B_e(d,u,f);const p=[],_=C=>{if(o)for(let L=0;L<C;L++){const x=v+L,D=b+L;if(e[x]!==t[D]){const k=this.refineDiff(e,t,new un(new Ye(x,x+1),new Ye(D,D+1)),s,o);for(const P of k.mappings)p.push(P);k.hitTimeout&&(g=!0)}}};let v=0,b=0;for(const C of f){Wb(()=>C.seq1Range.start-v===C.seq2Range.start-b);const L=C.seq1Range.start-v;_(L),v=C.seq1Range.endExclusive,b=C.seq2Range.endExclusive;const x=this.refineDiff(e,t,C,s,o);x.hitTimeout&&(g=!0);for(const D of x.mappings)p.push(D)}_(e.length-v);const y=d7(p,e,t);let w=[];return i.computeMoves&&(w=this.computeMoves(y,e,t,l,c,s,o)),Wb(()=>{function C(x,D){if(x.lineNumber<1||x.lineNumber>D.length)return!1;const k=D[x.lineNumber-1];return!(x.column<1||x.column>k.length+1)}function L(x,D){return!(x.startLineNumber<1||x.startLineNumber>D.length+1||x.endLineNumberExclusive<1||x.endLineNumberExclusive>D.length+1)}for(const x of y){if(!x.innerChanges)return!1;for(const D of x.innerChanges)if(!(C(D.modifiedRange.getStartPosition(),t)&&C(D.modifiedRange.getEndPosition(),t)&&C(D.originalRange.getStartPosition(),e)&&C(D.originalRange.getEndPosition(),e)))return!1;if(!L(x.modified,t)||!L(x.original,e))return!1}return!0}),new AC(y,w,g)}computeMoves(e,t,i,s,o,r,a){return E_e(e,t,i,s,o,r).map(d=>{const u=this.refineDiff(t,i,new un(d.original.toOffsetRange(),d.modified.toOffsetRange()),r,a),h=d7(u.mappings,t,i,!0);return new jj(d,h)})}refineDiff(e,t,i,s,o){const r=new YS(e,i.seq1Range,o),a=new YS(t,i.seq2Range,o),l=r.length+a.length<500?this.dynamicProgrammingDiffing.compute(r,a,s):this.myersDiffingAlgorithm.compute(r,a,s);let c=l.diffs;return c=FT(r,a,c),c=O_e(r,a,c),c=P_e(r,a,c),c=W_e(r,a,c),{mappings:c.map(u=>new nu(r.translateRange(u.seq1Range),a.translateRange(u.seq2Range))),hitTimeout:l.hitTimeout}}}function d7(n,e,t,i=!1){const s=[];for(const o of fU(n.map(r=>V_e(r,e,t)),(r,a)=>r.original.overlapOrTouch(a.original)||r.modified.overlapOrTouch(a.modified))){const r=o[0],a=o[o.length-1];s.push(new qo(r.original.join(a.original),r.modified.join(a.modified),o.map(l=>l.innerChanges[0])))}return Wb(()=>!i&&s.length>0&&s[0].original.startLineNumber!==s[0].modified.startLineNumber?!1:nj(s,(o,r)=>r.original.startLineNumber-o.original.endLineNumberExclusive===r.modified.startLineNumber-o.modified.endLineNumberExclusive&&o.original.endLineNumberExclusive<r.original.startLineNumber&&o.modified.endLineNumberExclusive<r.modified.startLineNumber)),s}function V_e(n,e,t){let i=0,s=0;n.modifiedRange.endColumn===1&&n.originalRange.endColumn===1&&n.originalRange.startLineNumber+i<=n.originalRange.endLineNumber&&n.modifiedRange.startLineNumber+i<=n.modifiedRange.endLineNumber&&(s=-1),n.modifiedRange.startColumn-1>=t[n.modifiedRange.startLineNumber-1].length&&n.originalRange.startColumn-1>=e[n.originalRange.startLineNumber-1].length&&n.originalRange.startLineNumber<=n.originalRange.endLineNumber+s&&n.modifiedRange.startLineNumber<=n.modifiedRange.endLineNumber+s&&(i=1);const o=new Qe(n.originalRange.startLineNumber+i,n.originalRange.endLineNumber+1+s),r=new Qe(n.modifiedRange.startLineNumber+i,n.modifiedRange.endLineNumber+1+s);return new qo(o,r,[n])}const u7={getLegacy:()=>new p_e,getDefault:()=>new Yj};function Ld(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}class ut{constructor(e,t,i,s=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Ld(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class nr{constructor(e,t,i,s){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Ld(Math.max(Math.min(1,t),0),3),this.l=Ld(Math.max(Math.min(1,i),0),3),this.a=Ld(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,s=e.b/255,o=e.a,r=Math.max(t,i,s),a=Math.min(t,i,s);let l=0,c=0;const d=(a+r)/2,u=r-a;if(u>0){switch(c=Math.min(d<=.5?u/(2*d):u/(2-2*d),1),r){case t:l=(i-s)/u+(i<s?6:0);break;case i:l=(s-t)/u+2;break;case s:l=(t-i)/u+4;break}l*=60,l=Math.round(l)}return new nr(l,c,d,o)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:s,a:o}=e;let r,a,l;if(i===0)r=a=l=s;else{const c=s<.5?s*(1+i):s+i-s*i,d=2*s-c;r=nr._hue2rgb(d,c,t+1/3),a=nr._hue2rgb(d,c,t),l=nr._hue2rgb(d,c,t-1/3)}return new ut(Math.round(r*255),Math.round(a*255),Math.round(l*255),o)}}class Bg{constructor(e,t,i,s){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Ld(Math.max(Math.min(1,t),0),3),this.v=Ld(Math.max(Math.min(1,i),0),3),this.a=Ld(Math.max(Math.min(1,s),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,s=e.b/255,o=Math.max(t,i,s),r=Math.min(t,i,s),a=o-r,l=o===0?0:a/o;let c;return a===0?c=0:o===t?c=((i-s)/a%6+6)%6:o===i?c=(s-t)/a+2:c=(t-i)/a+4,new Bg(Math.round(c*60),l,o,e.a)}static toRGBA(e){const{h:t,s:i,v:s,a:o}=e,r=s*i,a=r*(1-Math.abs(t/60%2-1)),l=s-r;let[c,d,u]=[0,0,0];return t<60?(c=r,d=a):t<120?(c=a,d=r):t<180?(d=r,u=a):t<240?(d=a,u=r):t<300?(c=a,u=r):t<=360&&(c=r,u=a),c=Math.round((c+l)*255),d=Math.round((d+l)*255),u=Math.round((u+l)*255),new ut(c,d,u,o)}}class z{static fromHex(e){return z.Format.CSS.parseHex(e)||z.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:nr.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:Bg.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof ut)this.rgba=e;else if(e instanceof nr)this._hsla=e,this.rgba=nr.toRGBA(e);else if(e instanceof Bg)this._hsva=e,this.rgba=Bg.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&ut.equals(this.rgba,e.rgba)&&nr.equals(this.hsla,e.hsla)&&Bg.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=z._relativeLuminanceForComponent(this.rgba.r),t=z._relativeLuminanceForComponent(this.rgba.g),i=z._relativeLuminanceForComponent(this.rgba.b),s=.2126*e+.7152*t+.0722*i;return Ld(s,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new z(new nr(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new z(new nr(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:s,a:o}=this.rgba;return new z(new ut(t,i,s,o*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new z(new ut(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:s,a:o}=this.rgba;return new z(new ut(e.rgba.r-o*(e.rgba.r-t),e.rgba.g-o*(e.rgba.g-i),e.rgba.b-o*(e.rgba.b-s),1))}toString(){return this._toString||(this._toString=z.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const s=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(o-s)/o,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const s=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(s-o)/s,e.darken(i)}}z.white=new z(new ut(255,255,255,1));z.black=new z(new ut(0,0,0,1));z.red=new z(new ut(255,0,0,1));z.blue=new z(new ut(0,0,255,1));z.green=new z(new ut(0,255,0,1));z.cyan=new z(new ut(0,255,255,1));z.lightgrey=new z(new ut(211,211,211,1));z.transparent=new z(new ut(0,0,0,0));(function(n){(function(e){(function(t){function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:n.Format.CSS.formatRGBA(f)}t.formatRGB=i;function s(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}t.formatRGBA=s;function o(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:n.Format.CSS.formatHSLA(f)}t.formatHSL=o;function r(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}t.formatHSLA=r;function a(f){const g=f.toString(16);return g.length!==2?"0"+g:g}function l(f){return`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}`}t.formatHex=l;function c(f,g=!1){return g&&f.rgba.a===1?n.Format.CSS.formatHex(f):`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}${a(Math.round(f.rgba.a*255))}`}t.formatHexA=c;function d(f){return f.isOpaque()?n.Format.CSS.formatHex(f):n.Format.CSS.formatRGBA(f)}t.format=d;function u(f){const g=f.length;if(g===0||f.charCodeAt(0)!==35)return null;if(g===7){const p=16*h(f.charCodeAt(1))+h(f.charCodeAt(2)),_=16*h(f.charCodeAt(3))+h(f.charCodeAt(4)),v=16*h(f.charCodeAt(5))+h(f.charCodeAt(6));return new n(new ut(p,_,v,1))}if(g===9){const p=16*h(f.charCodeAt(1))+h(f.charCodeAt(2)),_=16*h(f.charCodeAt(3))+h(f.charCodeAt(4)),v=16*h(f.charCodeAt(5))+h(f.charCodeAt(6)),b=16*h(f.charCodeAt(7))+h(f.charCodeAt(8));return new n(new ut(p,_,v,b/255))}if(g===4){const p=h(f.charCodeAt(1)),_=h(f.charCodeAt(2)),v=h(f.charCodeAt(3));return new n(new ut(16*p+p,16*_+_,16*v+v))}if(g===5){const p=h(f.charCodeAt(1)),_=h(f.charCodeAt(2)),v=h(f.charCodeAt(3)),b=h(f.charCodeAt(4));return new n(new ut(16*p+p,16*_+_,16*v+v,(16*b+b)/255))}return null}t.parseHex=u;function h(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(n.Format||(n.Format={}))})(z||(z={}));function Zj(n){const e=[];for(const t of n){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function yP(n,e,t,i){return{red:n/255,blue:t/255,green:e/255,alpha:i}}function D0(n,e){const t=e.index,i=e[0].length;if(!t)return;const s=n.positionAt(t);return{startLineNumber:s.lineNumber,startColumn:s.column,endLineNumber:s.lineNumber,endColumn:s.column+i}}function z_e(n,e){if(!n)return;const t=z.Format.CSS.parseHex(e);if(t)return{range:n,color:yP(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function h7(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),o=Zj(s);return{range:n,color:yP(o[0],o[1],o[2],t?o[3]:1)}}function f7(n,e,t){if(!n||e.length!==1)return;const s=e[0].values(),o=Zj(s),r=new z(new nr(o[0],o[1]/100,o[2]/100,t?o[3]:1));return{range:n,color:yP(r.rgba.r,r.rgba.g,r.rgba.b,r.rgba.a)}}function k0(n,e){return typeof n=="string"?[...n.matchAll(e)]:n.findMatches(e)}function H_e(n){const e=[],i=k0(n,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const s of i){const o=s.filter(c=>c!==void 0),r=o[1],a=o[2];if(!a)continue;let l;if(r==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=h7(D0(n,s),k0(a,c),!1)}else if(r==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=h7(D0(n,s),k0(a,c),!0)}else if(r==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=f7(D0(n,s),k0(a,c),!1)}else if(r==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=f7(D0(n,s),k0(a,c),!0)}else r==="#"&&(l=z_e(D0(n,s),r+a));l&&e.push(l)}return e}function $_e(n){return!n||typeof n.getValue!="function"||typeof n.positionAt!="function"?[]:H_e(n)}var Nc=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class U_e extends U0e{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const s=this._lines[i],o=this.offsetAt(new V(i+1,1)),r=s.matchAll(e);for(const a of r)(a.index||a.index===0)&&(a.index=a.index+o),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=Nb(e.column,kU(t),this._lines[e.lineNumber-1],0);return i?new N(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let s=0,o="",r=0,a=[];return{*[Symbol.iterator](){for(;;)if(r<a.length){const l=o.substring(a[r].start,a[r].end);r+=1,yield l}else if(s<t.length)o=t[s],a=i(o,e),r=0,s+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],s=this._wordenize(i,t),o=[];for(const r of s)o.push({word:i.substring(r.start,r.end),startColumn:r.start+1,endColumn:r.end+1});return o}_wordenize(e,t){const i=[];let s;for(t.lastIndex=0;(s=t.exec(e))&&s[0].length!==0;)i.push({start:s.index,end:s.index+s[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,s=e.endLineNumber-1,o=[];o.push(this._lines[i].substring(e.startColumn-1));for(let r=i+1;r<s;r++)o.push(this._lines[r]);return o.push(this._lines[s].substring(0,e.endColumn-1)),o.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!V.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,s=!1;if(t<1)t=1,i=1,s=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,s=!0;else{const o=this._lines[t-1].length+1;i<1?(i=1,s=!0):i>o&&(i=o,s=!0)}return s?{lineNumber:t,column:i}:e}}class Dd{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}acceptNewModel(e){this._models[e.url]=new U_e(je.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeUnicodeHighlights(e,t,i){return Nc(this,void 0,void 0,function*(){const s=this._getModel(e);return s?r_e.computeUnicodeHighlights(s,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}})}computeDiff(e,t,i,s){return Nc(this,void 0,void 0,function*(){const o=this._getModel(e),r=this._getModel(t);return!o||!r?null:Dd.computeDiff(o,r,i,s)})}static computeDiff(e,t,i,s){const o=s==="advanced"?u7.getDefault():u7.getLegacy(),r=e.getLinesContent(),a=t.getLinesContent(),l=o.computeDiff(r,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(u){return u.map(h=>{var f;return[h.original.startLineNumber,h.original.endLineNumberExclusive,h.modified.startLineNumber,h.modified.endLineNumberExclusive,(f=h.innerChanges)===null||f===void 0?void 0:f.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])]})}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(u=>[u.lineRangeMapping.original.startLineNumber,u.lineRangeMapping.original.endLineNumberExclusive,u.lineRangeMapping.modified.startLineNumber,u.lineRangeMapping.modified.endLineNumberExclusive,d(u.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),s=t.getLineCount();if(i!==s)return!1;for(let o=1;o<=i;o++){const r=e.getLineContent(o),a=t.getLineContent(o);if(r!==a)return!1}return!0}computeMoreMinimalEdits(e,t,i){return Nc(this,void 0,void 0,function*(){const s=this._getModel(e);if(!s)return t;const o=[];let r;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return N.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,u=c.range?0:1;return d-u});let a=0;for(let l=1;l<t.length;l++)N.getEndPosition(t[a].range).equals(N.getStartPosition(t[l].range))?(t[a].range=N.fromPositions(N.getStartPosition(t[a].range),N.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(r=d),N.isEmpty(l)&&!c)continue;const u=s.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,s.eol),u===c)continue;if(Math.max(c.length,u.length)>Dd._diffLimit){o.push({range:l,text:c});continue}const h=z0e(u,c,i),f=s.offsetAt(N.lift(l).getStartPosition());for(const g of h){const p=s.positionAt(f+g.originalStart),_=s.positionAt(f+g.originalStart+g.originalLength),v={text:c.substr(g.modifiedStart,g.modifiedLength),range:{startLineNumber:p.lineNumber,startColumn:p.column,endLineNumber:_.lineNumber,endColumn:_.column}};s.getValueInRange(v.range)!==v.text&&o.push(v)}}return typeof r=="number"&&o.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),o})}computeLinks(e){return Nc(this,void 0,void 0,function*(){const t=this._getModel(e);return t?Y0e(t):null})}computeDefaultDocumentColors(e){return Nc(this,void 0,void 0,function*(){const t=this._getModel(e);return t?$_e(t):null})}textualSuggest(e,t,i,s){return Nc(this,void 0,void 0,function*(){const o=new yu,r=new RegExp(i,s),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(r))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>Dd._suggestionsLimit))break e}}return{words:Array.from(a),duration:o.elapsed()}})}computeWordRanges(e,t,i,s){return Nc(this,void 0,void 0,function*(){const o=this._getModel(e);if(!o)return Object.create(null);const r=new RegExp(i,s),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=o.getLineWords(l,r);for(const d of c){if(!isNaN(Number(d.word)))continue;let u=a[d.word];u||(u=[],a[d.word]=u),u.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a})}navigateValueSet(e,t,i,s,o){return Nc(this,void 0,void 0,function*(){const r=this._getModel(e);if(!r)return null;const a=new RegExp(s,o);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=r.getValueInRange(t),c=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=r.getValueInRange(c);return NT.INSTANCE.navigateValueSet(t,l,c,d,i)})}loadForeignModule(e,t,i){const r={host:Jhe(i,(a,l)=>this._host.fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(r,t),Promise.resolve(V4(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}Dd._diffLimit=1e5;Dd._suggestionsLimit=1e4;typeof importScripts=="function"&&(globalThis.monaco=jU());const Xj=at("textResourceConfigurationService"),Qj=at("textResourcePropertiesService"),nt=at("ILanguageFeaturesService");var j_e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},E0=function(n,e){return function(t,i){e(t,i,n)}},ZS=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const g7=60*1e3,p7=5*60*1e3;function sh(n,e){const t=n.getModel(e);return!(!t||t.isTooLargeForSyncing())}let BT=class extends Y{constructor(e,t,i,s,o){super(),this._modelService=e,this._workerManager=this._register(new G_e(this._modelService,s)),this._logService=i,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(r,a)=>sh(this._modelService,r.uri)?this._workerManager.withWorker().then(l=>l.computeLinks(r.uri)).then(l=>l&&{links:l}):Promise.resolve({links:[]})})),this._register(o.completionProvider.register("*",new q_e(this._workerManager,t,this._modelService,s)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return sh(this._modelService,e)}computedUnicodeHighlights(e,t,i){return this._workerManager.withWorker().then(s=>s.computedUnicodeHighlights(e,t,i))}computeDiff(e,t,i,s){return ZS(this,void 0,void 0,function*(){const o=yield this._workerManager.withWorker().then(l=>l.computeDiff(e,t,i,s));if(!o)return null;return{identical:o.identical,quitEarly:o.quitEarly,changes:a(o.changes),moves:o.moves.map(l=>new jj(new Qa(new Qe(l[0],l[1]),new Qe(l[2],l[3])),a(l[4])))};function a(l){return l.map(c=>{var d;return new qo(new Qe(c[0],c[1]),new Qe(c[2],c[3]),(d=c[4])===null||d===void 0?void 0:d.map(u=>new nu(new N(u[0],u[1],u[2],u[3]),new N(u[4],u[5],u[6],u[7]))))})}})}computeMoreMinimalEdits(e,t,i=!1){if(tc(t)){if(!sh(this._modelService,e))return Promise.resolve(t);const s=yu.create(),o=this._workerManager.withWorker().then(r=>r.computeMoreMinimalEdits(e,t,i));return o.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),s.elapsed())),Promise.race([o,Hb(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return sh(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then(s=>s.navigateValueSet(e,t,i))}canComputeWordRanges(e){return sh(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then(i=>i.computeWordRanges(e,t))}};BT=j_e([E0(0,hs),E0(1,Xj),E0(2,yc),E0(3,oo),E0(4,nt)],BT);class q_e{constructor(e,t,i,s){this.languageConfigurationService=s,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}provideCompletionItems(e,t){return ZS(this,void 0,void 0,function*(){const i=this._configurationService.getValue(e.uri,t,"editor");if(!i.wordBasedSuggestions)return;const s=[];if(i.wordBasedSuggestionsMode==="currentDocument")sh(this._modelService,e.uri)&&s.push(e.uri);else for(const u of this._modelService.getModels())sh(this._modelService,u.uri)&&(u===e?s.unshift(u.uri):(i.wordBasedSuggestionsMode==="allDocuments"||u.getLanguageId()===e.getLanguageId())&&s.push(u.uri));if(s.length===0)return;const o=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),r=e.getWordAtPosition(t),a=r?new N(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):N.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),d=yield(yield this._workerManager.withWorker()).textualSuggest(s,r==null?void 0:r.word,o);if(d)return{duration:d.duration,suggestions:d.words.map(u=>({kind:18,label:u,insertText:u,range:{insert:l,replace:a}}))}})}}class G_e extends Y{constructor(e,t){super(),this.languageConfigurationService=t,this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new sy).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(p7/2)),this._register(this._modelService.onModelRemoved(s=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>p7&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new Jj(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class K_e extends Y{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const s=new sy;s.cancelAndSet(()=>this._checkStopModelSync(),Math.round(g7/2)),this._register(s)}}dispose(){for(const e in this._syncedModels)Ft(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t){for(const i of e){const s=i.toString();this._syncedModels[s]||this._beginModelSync(i,t),this._syncedModels[s]&&(this._syncedModelsLastUsedTime[s]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>g7&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const s=e.toString();this._proxy.acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const o=new pe;o.add(i.onDidChangeContent(r=>{this._proxy.acceptModelChanged(s.toString(),r)})),o.add(i.onWillDispose(()=>{this._stopModelSync(s)})),o.add(Ze(()=>{this._proxy.acceptRemovedModel(s)})),this._syncedModels[s]=o}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],Ft(t)}}class m7{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class q2{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class Jj extends Y{constructor(e,t,i,s){super(),this.languageConfigurationService=s,this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new ED(i),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new Yme(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new q2(this)))}catch(e){ET(e),this._worker=new m7(new Dd(new q2(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,e=>(ET(e),this._worker=new m7(new Dd(new q2(this),null)),this._getOrCreateWorker().getProxyObject()))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new K_e(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e,t=!1){return ZS(this,void 0,void 0,function*(){return this._disposed?Promise.reject(nge()):this._getProxy().then(i=>(this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i))})}computedUnicodeHighlights(e,t,i){return this._withSyncedResources([e]).then(s=>s.computeUnicodeHighlights(e.toString(),t,i))}computeDiff(e,t,i,s){return this._withSyncedResources([e,t],!0).then(o=>o.computeDiff(e.toString(),t.toString(),i,s))}computeMoreMinimalEdits(e,t,i){return this._withSyncedResources([e]).then(s=>s.computeMoreMinimalEdits(e.toString(),t,i))}computeLinks(e){return this._withSyncedResources([e]).then(t=>t.computeLinks(e.toString()))}computeDefaultDocumentColors(e){return this._withSyncedResources([e]).then(t=>t.computeDefaultDocumentColors(e.toString()))}textualSuggest(e,t,i){return ZS(this,void 0,void 0,function*(){const s=yield this._withSyncedResources(e),o=i.source,r=i.flags;return s.textualSuggest(e.map(a=>a.toString()),t,o,r)})}computeWordRanges(e,t){return this._withSyncedResources([e]).then(i=>{const s=this._modelService.getModel(e);if(!s)return Promise.resolve(null);const o=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId()).getWordDefinition(),r=o.source,a=o.flags;return i.computeWordRanges(e.toString(),t,r,a)})}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then(s=>{const o=this._modelService.getModel(e);if(!o)return null;const r=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId()).getWordDefinition(),a=r.source,l=r.flags;return s.navigateValueSet(e.toString(),t,i,a,l)})}dispose(){super.dispose(),this._disposed=!0}}function Y_e(n,e,t){return new Z_e(n,e,t)}class Z_e extends Jj{constructor(e,t,i){super(e,i.keepIdleModels||!1,i.label,t),this._foreignModuleId=i.moduleId,this._foreignModuleCreateData=i.createData||null,this._foreignModuleHost=i.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?V4(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const s=(a,l)=>e.fmr(a,l),o=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},r={};for(const a of i)r[a]=o(a,s);return r})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then(t=>this.getProxy())}}const OD={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},Kb=new class{clone(){return this}equals(n){return this===n}};function eq(n,e){return new Z4([new Mb(0,"",n)],e)}function wP(n,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(n<<0|0|0|32768|2<<24)>>>0,new fD(t,e===null?Kb:e)}class Us{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const s=this.getFontStyle(e);return s&1&&(i+=" mtki"),s&2&&(i+=" mtkb"),s&4&&(i+=" mtku"),s&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),s=this.getFontStyle(e);let o=`color: ${t[i]};`;s&1&&(o+="font-style: italic;"),s&2&&(o+="font-weight: bold;");let r="";return s&4&&(r+=" underline"),s&8&&(r+=" line-through"),r&&(o+=`text-decoration:${r};`),o}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}class on{static createEmpty(e,t){const i=on.defaultTokenMetadata,s=new Uint32Array(2);return s[0]=e.length,s[1]=i,new on(s,e,t)}constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._languageIdCodec=i}equals(e){return e instanceof on?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const s=t<<1,o=s+(i<<1);for(let r=s;r<o;r++)if(this._tokens[r]!==e._tokens[r])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Us.getLanguageId(t);return this._languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Us.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Us.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Us.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Us.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return Us.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return on.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new CP(this,e,t,i)}static convertToEndOffset(e,t){const s=(e.length>>>1)-1;for(let o=0;o<s;o++)e[o<<1]=e[o+1<<1];e[s<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,s=(e.length>>>1)-1;for(;i<s;){const o=i+Math.floor((s-i)/2),r=e[o<<1];if(r===t)return o+1;r<t?i=o+1:r>t&&(s=o)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,s="";const o=new Array;let r=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){s+=this._text.substring(r,a);const c=this._tokens[(t<<1)+1];o.push(s.length,c),t++,r=a}else if(l){if(l.offset>r){s+=this._text.substring(r,l.offset);const c=this._tokens[(t<<1)+1];o.push(s.length,c),r=l.offset}s+=l.text,o.push(s.length,l.tokenMetadata),i++}else break}return new on(new Uint32Array(o),s,this._languageIdCodec)}}on.defaultTokenMetadata=(32768|2<<24)>>>0;class CP{constructor(e,t,i,s){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=s,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let o=this._firstTokenIndex,r=e.getCount();o<r&&!(e.getStartOffset(o)>=i);o++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof CP?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class lr{constructor(e,t,i,s){this.startColumn=e,this.endColumn=t,this.className=i,this.type=s,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,s=t.length;if(i!==s)return!1;for(let o=0;o<i;o++)if(!lr._equals(e[o],t[o]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const s=t+1,o=i+1,r=i-t,a=[];let l=0;for(const c of e)c.endColumn<=s||c.startColumn>=o||(a[l++]=new lr(Math.max(1,c.startColumn-s+1),Math.min(r+1,c.endColumn-s+1),c.className,c.type));return a}static filter(e,t,i,s){if(e.length===0)return[];const o=[];let r=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.range;if(d.endLineNumber<t||d.startLineNumber>t||d.isEmpty()&&(c.type===0||c.type===3))continue;const u=d.startLineNumber===t?d.startColumn:i,h=d.endLineNumber===t?d.endColumn:s;o[r++]=new lr(u,h,c.inlineClassName,c.type)}return o}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=lr._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class _7{constructor(e,t,i,s){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=s}}class XS{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,s=e.length;i<s;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let s=0;for(;s+1<this.count&&this.stopOffsets[s]===this.stopOffsets[s+1];)s++;i.push(new _7(t,this.stopOffsets[s],this.classNames.join(" "),XS._metadata(this.metadata))),t=this.stopOffsets[s]+1,this.stopOffsets.splice(0,s+1),this.classNames.splice(0,s+1),this.metadata.splice(0,s+1),this.count-=s+1}return this.count>0&&t<e&&(i.push(new _7(t,e-1,this.classNames.join(" "),XS._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let s=0;s<this.count;s++)if(this.stopOffsets[s]>=e){this.stopOffsets.splice(s,0,e),this.classNames.splice(s,0,t),this.metadata.splice(s,0,i);break}this.count++}}class X_e{static normalize(e,t){if(t.length===0)return[];const i=[],s=new XS;let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];let c=l.startColumn,d=l.endColumn;const u=l.className,h=l.type===1?2:l.type===2?4:0;if(c>1){const p=e.charCodeAt(c-2);tn(p)&&c--}if(d>1){const p=e.charCodeAt(d-2);tn(p)&&d--}const f=c-1,g=d-2;o=s.consumeLowerThan(f,o,i),s.count===0&&(o=f),s.insert(g,u,h)}return s.consumeLowerThan(1073741824,o,i),i}}class nn{constructor(e,t,i,s){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=s,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class tq{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class i0{constructor(e,t,i,s,o,r,a,l,c,d,u,h,f,g,p,_,v,b,y){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=s,this.isBasicASCII=o,this.containsRTL=r,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(lr.compare),this.tabSize=d,this.startVisibleColumn=u,this.spaceWidth=h,this.stopRenderingLineAfter=p,this.renderWhitespace=_==="all"?4:_==="boundary"?1:_==="selection"?2:_==="trailing"?3:0,this.renderControlCharacters=v,this.fontLigatures=b,this.selectionsOnLine=y&&y.sort((L,x)=>L.startOffset<x.startOffset?-1:1);const w=Math.abs(g-h),C=Math.abs(f-h);w<C?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=f,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&lr.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class iq{constructor(e,t){this.partIndex=e,this.charIndex=t}}class xa{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,s){const o=(t<<16|i<<0)>>>0;this._data[e-1]=o,this._horizontalOffset[e-1]=s}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=xa.getPartIndex(t),s=xa.getCharIndex(t);return new iq(i,s)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const s=(e<<16|i<<0)>>>0;let o=0,r=this.length-1;for(;o+1<r;){const p=o+r>>>1,_=this._data[p];if(_===s)return p;_>s?r=p:o=p}if(o===r)return o;const a=this._data[o],l=this._data[r];if(a===s)return o;if(l===s)return r;const c=xa.getPartIndex(a),d=xa.getCharIndex(a),u=xa.getPartIndex(l);let h;c!==u?h=t:h=xa.getCharIndex(l);const f=i-d,g=h-i;return f<=g?o:r}}class WT{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function SP(n,e){if(n.lineContent.length===0){if(n.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,s=0;for(const r of n.lineDecorations)(r.type===1||r.type===2)&&(e.appendString('<span class="'),e.appendString(r.className),e.appendString('"></span>'),r.type===1&&(s|=1,t++),r.type===2&&(s|=2,i++));e.appendString("</span>");const o=new xa(1,t+i);return o.setColumnInfo(1,t,0,0),new WT(o,!1,s)}return e.appendString("<span><span></span></span>"),new WT(new xa(0,0),!1,0)}return rbe(ebe(n),e)}class Q_e{constructor(e,t,i,s){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=s}}function FD(n){const e=new ID(1e4),t=SP(n,e);return new Q_e(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class J_e{constructor(e,t,i,s,o,r,a,l,c,d,u,h,f,g,p,_){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=s,this.isOverflowing=o,this.overflowingCharCount=r,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=d,this.startVisibleColumn=u,this.containsRTL=h,this.spaceWidth=f,this.renderSpaceCharCode=g,this.renderWhitespace=p,this.renderControlCharacters=_}}function ebe(n){const e=n.lineContent;let t,i,s;n.stopRenderingLineAfter!==-1&&n.stopRenderingLineAfter<e.length?(t=!0,i=e.length-n.stopRenderingLineAfter,s=n.stopRenderingLineAfter):(t=!1,i=0,s=e.length);let o=tbe(e,n.containsRTL,n.lineTokens,n.fauxIndentLength,s);n.renderControlCharacters&&!n.isBasicASCII&&(o=nbe(e,o)),(n.renderWhitespace===4||n.renderWhitespace===1||n.renderWhitespace===2&&n.selectionsOnLine||n.renderWhitespace===3&&!n.continuesWithWrappedLine)&&(o=sbe(n,e,s,o));let r=0;if(n.lineDecorations.length>0){for(let a=0,l=n.lineDecorations.length;a<l;a++){const c=n.lineDecorations[a];c.type===3||c.type===1?r|=1:c.type===2&&(r|=2)}o=obe(e,s,o,n.lineDecorations)}return n.containsRTL||(o=ibe(e,o,!n.isBasicASCII||n.fontLigatures)),new J_e(n.useMonospaceOptimizations,n.canUseHalfwidthRightwardsArrow,e,s,t,i,o,r,n.fauxIndentLength,n.tabSize,n.startVisibleColumn,n.containsRTL,n.spaceWidth,n.renderSpaceCharCode,n.renderWhitespace,n.renderControlCharacters)}function tbe(n,e,t,i,s){const o=[];let r=0;i>0&&(o[r++]=new nn(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const d=t.getEndOffset(l);if(d<=i)continue;const u=t.getClassName(l);if(d>=s){const f=e?Fb(n.substring(a,s)):!1;o[r++]=new nn(s,u,0,f);break}const h=e?Fb(n.substring(a,d)):!1;o[r++]=new nn(d,u,0,h),a=d}return o}function ibe(n,e,t){let i=0;const s=[];let o=0;if(t)for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex;if(i+50<c){const d=l.type,u=l.metadata,h=l.containsRTL;let f=-1,g=i;for(let p=i;p<c;p++)n.charCodeAt(p)===32&&(f=p),f!==-1&&p-g>=50&&(s[o++]=new nn(f+1,d,u,h),g=f+1,f=-1);g!==c&&(s[o++]=new nn(c,d,u,h))}else s[o++]=l;i=c}else for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex,d=c-i;if(d>50){const u=l.type,h=l.metadata,f=l.containsRTL,g=Math.ceil(d/50);for(let p=1;p<g;p++){const _=i+p*50;s[o++]=new nn(_,u,h,f)}s[o++]=new nn(c,u,h,f)}else s[o++]=l;i=c}return s}function nq(n){return n<32?n!==9:n===127||n>=8234&&n<=8238||n>=8294&&n<=8297||n>=8206&&n<=8207||n===1564}function nbe(n,e){const t=[];let i=new nn(0,"",0,!1),s=0;for(const o of e){const r=o.endIndex;for(;s<r;s++){const a=n.charCodeAt(s);nq(a)&&(s>i.endIndex&&(i=new nn(s,o.type,o.metadata,o.containsRTL),t.push(i)),i=new nn(s+1,"mtkcontrol",o.metadata,!1),t.push(i))}s>i.endIndex&&(i=new nn(r,o.type,o.metadata,o.containsRTL),t.push(i))}return t}function sbe(n,e,t,i){const s=n.continuesWithWrappedLine,o=n.fauxIndentLength,r=n.tabSize,a=n.startVisibleColumn,l=n.useMonospaceOptimizations,c=n.selectionsOnLine,d=n.renderWhitespace===1,u=n.renderWhitespace===3,h=n.renderSpaceWidth!==n.spaceWidth,f=[];let g=0,p=0,_=i[p].type,v=i[p].containsRTL,b=i[p].endIndex;const y=i.length;let w=!1,C=Zs(e),L;C===-1?(w=!0,C=t,L=t):L=Of(e);let x=!1,D=0,k=c&&c[D],P=a%r;for(let M=o;M<t;M++){const R=e.charCodeAt(M);k&&M>=k.endOffset&&(D++,k=c&&c[D]);let $;if(M<C||M>L)$=!0;else if(R===9)$=!0;else if(R===32)if(d)if(x)$=!0;else{const G=M+1<t?e.charCodeAt(M+1):0;$=G===32||G===9}else $=!0;else $=!1;if($&&c&&($=!!k&&k.startOffset<=M&&k.endOffset>M),$&&u&&($=w||M>L),$&&v&&M>=C&&M<=L&&($=!1),x){if(!$||!l&&P>=r){if(h){const G=g>0?f[g-1].endIndex:o;for(let ne=G+1;ne<=M;ne++)f[g++]=new nn(ne,"mtkw",1,!1)}else f[g++]=new nn(M,"mtkw",1,!1);P=P%r}}else(M===b||$&&M>o)&&(f[g++]=new nn(M,_,0,v),P=P%r);for(R===9?P=r:Jd(R)?P+=2:P++,x=$;M===b&&(p++,p<y);)_=i[p].type,v=i[p].containsRTL,b=i[p].endIndex}let O=!1;if(x)if(s&&d){const M=t>0?e.charCodeAt(t-1):0,R=t>1?e.charCodeAt(t-2):0;M===32&&R!==32&&R!==9||(O=!0)}else O=!0;if(O)if(h){const M=g>0?f[g-1].endIndex:o;for(let R=M+1;R<=t;R++)f[g++]=new nn(R,"mtkw",1,!1)}else f[g++]=new nn(t,"mtkw",1,!1);else f[g++]=new nn(t,_,0,v);return f}function obe(n,e,t,i){i.sort(lr.compare);const s=X_e.normalize(n,i),o=s.length;let r=0;const a=[];let l=0,c=0;for(let u=0,h=t.length;u<h;u++){const f=t[u],g=f.endIndex,p=f.type,_=f.metadata,v=f.containsRTL;for(;r<o&&s[r].startOffset<g;){const b=s[r];if(b.startOffset>c&&(c=b.startOffset,a[l++]=new nn(c,p,_,v)),b.endOffset+1<=g)c=b.endOffset+1,a[l++]=new nn(c,p+" "+b.className,_|b.metadata,v),r++;else{c=g,a[l++]=new nn(c,p+" "+b.className,_|b.metadata,v);break}}g>c&&(c=g,a[l++]=new nn(c,p,_,v))}const d=t[t.length-1].endIndex;if(r<o&&s[r].startOffset===d)for(;r<o&&s[r].startOffset===d;){const u=s[r];a[l++]=new nn(c,u.className,u.metadata,!1),r++}return a}function rbe(n,e){const t=n.fontIsMonospace,i=n.canUseHalfwidthRightwardsArrow,s=n.containsForeignElements,o=n.lineContent,r=n.len,a=n.isOverflowing,l=n.overflowingCharCount,c=n.parts,d=n.fauxIndentLength,u=n.tabSize,h=n.startVisibleColumn,f=n.containsRTL,g=n.spaceWidth,p=n.renderSpaceCharCode,_=n.renderWhitespace,v=n.renderControlCharacters,b=new xa(r+1,c.length);let y=!1,w=0,C=h,L=0,x=0,D=0;f?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let k=0,P=c.length;k<P;k++){const O=c[k],M=O.endIndex,R=O.type,$=O.containsRTL,G=_!==0&&O.isWhitespace(),ne=G&&!t&&(R==="mtkw"||!s),ae=w===M&&O.isPseudoAfter();if(L=0,e.appendString("<span "),$&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(ne?"mtkz":R),e.appendASCIICharCode(34),G){let fe=0;{let oe=w,xe=C;for(;oe<M;oe++){const me=(o.charCodeAt(oe)===9?u-xe%u:1)|0;fe+=me,oe>=d&&(xe+=me)}}for(ne&&(e.appendString(' style="width:'),e.appendString(String(g*fe)),e.appendString('px"')),e.appendASCIICharCode(62);w<M;w++){b.setColumnInfo(w+1,k-D,L,x),D=0;const oe=o.charCodeAt(w);let xe,Te;if(oe===9){xe=u-C%u|0,Te=xe,!i||Te>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let me=2;me<=Te;me++)e.appendCharCode(160)}else xe=2,Te=1,e.appendCharCode(p),e.appendCharCode(8204);L+=xe,x+=Te,w>=d&&(C+=Te)}}else for(e.appendASCIICharCode(62);w<M;w++){b.setColumnInfo(w+1,k-D,L,x),D=0;const fe=o.charCodeAt(w);let oe=1,xe=1;switch(fe){case 9:oe=u-C%u,xe=oe;for(let Te=1;Te<=oe;Te++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:v?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Jd(fe)&&xe++,v&&fe<32?e.appendCharCode(9216+fe):v&&fe===127?e.appendCharCode(9249):v&&nq(fe)?(e.appendString("[U+"),e.appendString(abe(fe)),e.appendString("]"),oe=8,xe=oe):e.appendCharCode(fe)}L+=oe,x+=xe,w>=d&&(C+=xe)}ae?D++:D=0,w>=r&&!y&&O.isPseudoAfter()&&(y=!0,b.setColumnInfo(w+1,k,L,x)),e.appendString("</span>")}return y||b.setColumnInfo(r+1,c.length-1,L,x),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(m("showMore","Show more ({0})",lbe(l))),e.appendString("</span>")),e.appendString("</span>"),new WT(b,f,s)}function abe(n){return n.toString(16).toUpperCase().padStart(4,"0")}function lbe(n){return n<1024?m("overflow.chars","{0} chars",n):n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/1024/1024).toFixed(1)} MB`}class b7{constructor(e,t,i,s){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=s|0}}class cbe{constructor(e,t){this.tabSize=e,this.data=t}}class xP{constructor(e,t,i,s,o,r,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=s,this.startVisibleColumn=o,this.tokens=r,this.inlineDecorations=a}}class Do{constructor(e,t,i,s,o,r,a,l,c,d){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=s,this.isBasicASCII=Do.isBasicASCII(i,r),this.containsRTL=Do.containsRTL(i,this.isBasicASCII,o),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=d}static isBasicASCII(e,t){return t?iP(e):!0}static containsRTL(e,t,i){return!t&&i?Fb(e):!1}}class T_{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class dbe{constructor(e,t,i,s){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=s}toInlineDecoration(e){return new T_(new N(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class sq{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class Yb{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&Ki(e.data,t.data)}static equalsArr(e,t){return Ki(e,t,Yb.equals)}}function ube(n){return Array.isArray(n)}function hbe(n){return!ube(n)}function oq(n){return typeof n=="string"}function v7(n){return!oq(n)}function xg(n){return!n}function kd(n,e){return n.ignoreCase&&e?e.toLowerCase():e}function y7(n){return n.replace(/[&<>'"_]/g,"-")}function fbe(n,e){console.log(`${n.languageId}: ${e}`)}function Vt(n,e){return new Error(`${n.languageId}: ${e}`)}function Kc(n,e,t,i,s){const o=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let r=null;return e.replace(o,function(a,l,c,d,u,h,f,g,p){return xg(c)?xg(d)?!xg(u)&&u<i.length?kd(n,i[u]):!xg(f)&&n&&typeof n[f]=="string"?n[f]:(r===null&&(r=s.split("."),r.unshift(s)),!xg(h)&&h<r.length?kd(n,r[h]):""):kd(n,t):"$"})}function dw(n,e){let t=e;for(;t&&t.length>0;){const i=n.tokenizer[t];if(i)return i;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return null}function gbe(n,e){let t=e;for(;t&&t.length>0;){if(n.stateNames[t])return!0;const s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return!1}var pbe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},mbe=function(n,e){return function(t,i){e(t,i,n)}},VT;const rq=5;class Zb{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new _p(e,t);let i=_p.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let s=this._entries[i];return s||(s=new _p(e,t),this._entries[i]=s,s)}}Zb._INSTANCE=new Zb(rq);class _p{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return _p._equals(this,e)}push(e){return Zb.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Zb.create(this.parent,e)}}class Wg{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new Wg(this.languageId,this.state)}}class Yc{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new N_(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new N_(e,t);const i=_p.getStackElementId(e);let s=this._entries[i];return s||(s=new N_(e,null),this._entries[i]=s,s)}}Yc._INSTANCE=new Yc(rq);class N_{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Yc.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof N_)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class _be{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new Mb(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,s){const o=i.languageId,r=i.state,a=Si.get(o);if(!a)return this.enterLanguage(o),this.emit(s,""),r;const l=a.tokenize(e,t,r);if(s!==0)for(const c of l.tokens)this._tokens.push(new Mb(c.offset+s,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new Z4(this._tokens,e)}}class QS{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const s=e!==null?e.length:0,o=t.length,r=i!==null?i.length:0;if(s===0&&o===0&&r===0)return new Uint32Array(0);if(s===0&&o===0)return i;if(o===0&&r===0)return e;const a=new Uint32Array(s+o+r);e!==null&&a.set(e);for(let l=0;l<o;l++)a[s+l]=t[l];return i!==null&&a.set(i,s+o),a}nestedLanguageTokenize(e,t,i,s){const o=i.languageId,r=i.state,a=Si.get(o);if(!a)return this.enterLanguage(o),this.emit(s,""),r;const l=a.tokenizeEncoded(e,t,r);if(s!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=s;return this._prependTokens=QS._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new fD(QS._merge(this._prependTokens,this._tokens,null),e)}}let Xb=VT=class extends Y{constructor(e,t,i,s,o){super(),this._configurationService=o,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=s,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._register(Si.onDidChange(a=>{if(r)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const u=a.changedLanguages[c];if(this._embeddedLanguages[u]){l=!0;break}}l&&(r=!0,Si.handleChange([this._languageId]),r=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=Si.get(t);if(i){if(i instanceof VT){const s=i.getLoadStatus();s.loaded===!1&&e.push(s.promise)}continue}Si.isResolved(t)||e.push(Si.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Zb.create(null,this._lexer.start);return Yc.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return eq(this._languageId,i);const s=new _be,o=this._tokenize(e,t,i,s);return s.finalize(o)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return wP(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const s=new QS(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,i,s);return s.finalize(o)}_tokenize(e,t,i,s){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,s):this._myTokenize(e,t,i,0,s)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=dw(this._lexer,t.stack.state),!i))throw Vt(this._lexer,"tokenizer state is not defined: "+t.stack.state);let s=-1,o=!1;for(const r of i){if(!v7(r.action)||r.action.nextEmbedded!=="@pop")continue;o=!0;let a=r.regex;const l=r.regex.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&r.matchOnlyAtLineStart||(s===-1||c<s)&&(s=c)}if(!o)throw Vt(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return s}_nestedTokenize(e,t,i,s,o){const r=this._findLeavingNestedLanguageOffset(e,i);if(r===-1){const c=o.nestedLanguageTokenize(e,t,i.embeddedLanguageData,s);return Yc.create(i.stack,new Wg(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,r);a.length>0&&o.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,s);const l=e.substring(r);return this._myTokenize(l,t,i,s+r,o)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,s,o){o.enterLanguage(this._languageId);const r=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,u=0,h=null,f=!0;for(;f||u<l;){const g=u,p=d.depth,_=h?h.groups.length:0,v=d.state;let b=null,y=null,w=null,C=null,L=null;if(h){b=h.matches;const k=h.groups.shift();y=k.matched,w=k.action,C=h.rule,h.groups.length===0&&(h=null)}else{if(!f&&u>=l)break;f=!1;let k=this._lexer.tokenizer[v];if(!k&&(k=dw(this._lexer,v),!k))throw Vt(this._lexer,"tokenizer state is not defined: "+v);const P=a.substr(u);for(const O of k)if((u===0||!O.matchOnlyAtLineStart)&&(b=P.match(O.regex),b)){y=b[0],w=O.action;break}}if(b||(b=[""],y=""),w||(u<l&&(b=[a.charAt(u)],y=b[0]),w=this._lexer.defaultToken),y===null)break;for(u+=y.length;hbe(w)&&v7(w)&&w.test;)w=w.test(y,b,v,u===l);let x=null;if(typeof w=="string"||Array.isArray(w))x=w;else if(w.group)x=w.group;else if(w.token!==null&&w.token!==void 0){if(w.tokenSubst?x=Kc(this._lexer,w.token,y,b,v):x=w.token,w.nextEmbedded)if(w.nextEmbedded==="@pop"){if(!c)throw Vt(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw Vt(this._lexer,"cannot enter embedded language from within an embedded language");L=Kc(this._lexer,w.nextEmbedded,y,b,v)}if(w.goBack&&(u=Math.max(0,u-w.goBack)),w.switchTo&&typeof w.switchTo=="string"){let k=Kc(this._lexer,w.switchTo,y,b,v);if(k[0]==="@"&&(k=k.substr(1)),dw(this._lexer,k))d=d.switchTo(k);else throw Vt(this._lexer,"trying to switch to a state '"+k+"' that is undefined in rule: "+this._safeRuleName(C))}else{if(w.transform&&typeof w.transform=="function")throw Vt(this._lexer,"action.transform not supported");if(w.next)if(w.next==="@push"){if(d.depth>=this._lexer.maxStack)throw Vt(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(v)}else if(w.next==="@pop"){if(d.depth<=1)throw Vt(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(C));d=d.pop()}else if(w.next==="@popall")d=d.popall();else{let k=Kc(this._lexer,w.next,y,b,v);if(k[0]==="@"&&(k=k.substr(1)),dw(this._lexer,k))d=d.push(k);else throw Vt(this._lexer,"trying to set a next state '"+k+"' that is undefined in rule: "+this._safeRuleName(C))}}w.log&&typeof w.log=="string"&&fbe(this._lexer,this._lexer.languageId+": "+Kc(this._lexer,w.log,y,b,v))}if(x===null)throw Vt(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(C));const D=k=>{const P=this._languageService.getLanguageIdByLanguageName(k)||this._languageService.getLanguageIdByMimeType(k)||k,O=this._getNestedEmbeddedLanguageData(P);if(u<l){const M=e.substr(u);return this._nestedTokenize(M,t,Yc.create(d,O),s+u,o)}else return Yc.create(d,O)};if(Array.isArray(x)){if(h&&h.groups.length>0)throw Vt(this._lexer,"groups cannot be nested: "+this._safeRuleName(C));if(b.length!==x.length+1)throw Vt(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(C));let k=0;for(let P=1;P<b.length;P++)k+=b[P].length;if(k!==y.length)throw Vt(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(C));h={rule:C,matches:b,groups:[]};for(let P=0;P<x.length;P++)h.groups[P]={action:x[P],matched:b[P+1]};u-=y.length;continue}else{if(x==="@rematch"&&(u-=y.length,y="",b=null,x="",L!==null))return D(L);if(y.length===0){if(l===0||p!==d.depth||v!==d.state||(h?h.groups.length:0)!==_)continue;throw Vt(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(C))}let k=null;if(oq(x)&&x.indexOf("@brackets")===0){const P=x.substr(9),O=bbe(this._lexer,y);if(!O)throw Vt(this._lexer,"@brackets token returned but no bracket defined as: "+y);k=y7(O.token+P)}else{const P=x===""?"":x+this._lexer.tokenPostfix;k=y7(P)}g<r&&o.emit(g+s,k)}if(L!==null)return D(L)}return Yc.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new Wg(e,Kb);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),Si.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=Si.get(e);return t?new Wg(e,t.getInitialState()):new Wg(e,Kb)}};Xb=VT=pbe([mbe(4,ti)],Xb);function bbe(n,e){if(!e)return null;e=kd(n,e);const t=n.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}var vbe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const G2=Vf("standaloneColorizer",{createHTML:n=>n});class LP{static colorizeElement(e,t,i,s){s=s||{};const o=s.theme||"vs",r=s.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!r)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(r)||r;e.setTheme(o);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+o;const c=d=>{var u;const h=(u=G2==null?void 0:G2.createHTML(d))!==null&&u!==void 0?u:d;i.innerHTML=h};return this.colorize(t,l||"",a,s).then(c,d=>console.error(d))}static colorize(e,t,i,s){return vbe(this,void 0,void 0,function*(){const o=e.languageIdCodec;let r=4;s&&typeof s.tabSize=="number"&&(r=s.tabSize),sP(t)&&(t=t.substr(1));const a=Pf(t);if(!e.isRegisteredLanguageId(i))return w7(a,r,o);const l=yield Si.getOrCreate(i);return l?ybe(a,r,l,o):w7(a,r,o)})}static colorizeLine(e,t,i,s,o=4){const r=Do.isBasicASCII(e,t),a=Do.containsRTL(e,r,i);return FD(new i0(!1,!0,e,!1,r,a,0,s,[],o,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const s=e.getLineContent(t);e.tokenization.forceTokenization(t);const r=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(s,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,i)}}function ybe(n,e,t,i){return new Promise((s,o)=>{const r=()=>{const a=wbe(n,e,t,i);if(t instanceof Xb){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(r,o);return}}s(a)};r()})}function w7(n,e,t){let i=[];const o=new Uint32Array(2);o[0]=0,o[1]=33587200;for(let r=0,a=n.length;r<a;r++){const l=n[r];o[0]=l.length;const c=new on(o,l,t),d=Do.isBasicASCII(l,!0),u=Do.containsRTL(l,d,!0),h=FD(new i0(!1,!0,l,!1,d,u,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(h.html),i.push("<br/>")}return i.join("")}function wbe(n,e,t,i){let s=[],o=t.getInitialState();for(let r=0,a=n.length;r<a;r++){const l=n[r],c=t.tokenizeEncoded(l,!0,o);on.convertToEndOffset(c.tokens,l.length);const d=new on(c.tokens,l,i),u=Do.isBasicASCII(l,!0),h=Do.containsRTL(l,u,!0),f=FD(new i0(!1,!0,l,!1,u,h,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));s=s.concat(f.html),s.push("<br/>"),o=c.endState}return s.join("")}const C7=2e4;let oh,IC,zT,TC,HT;function Cbe(n){oh=document.createElement("div"),oh.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),oh.appendChild(i),i};IC=e(),zT=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),oh.appendChild(i),i};TC=t(),HT=t(),n.appendChild(oh)}function ay(n){oh&&(IC.textContent!==n?(Lo(zT),JS(IC,n)):(Lo(IC),JS(zT,n)))}function Qb(n){oh&&(TC.textContent!==n?(Lo(HT),JS(TC,n)):(Lo(TC),JS(HT,n)))}function JS(n,e){Lo(n),e.length>C7&&(e=e.substr(0,C7)),n.textContent=e,n.style.visibility="hidden",n.style.visibility="visible"}const DP=at("markerDecorationsService");var Sbe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},xbe=function(n,e){return function(t,i){e(t,i,n)}};let Jb=class{constructor(e,t){}dispose(){}};Jb.ID="editor.contrib.markerDecorations";Jb=Sbe([xbe(1,DP)],Jb);Lr(Jb.ID,Jb,0);class aq extends Y{constructor(e,t){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,s=!1;const o=()=>{if(i&&!s)try{i=!1,s=!0,t()}finally{requestAnimationFrame(()=>{s=!1,o()})}};this._resizeObserver=new ResizeObserver(r=>{e=r&&r[0]&&r[0].contentRect?r[0].contentRect:null,i=!0,o()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,s=0;t?(i=t.width,s=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,s=this._referenceDomElement.clientHeight),i=Math.max(5,i),s=Math.max(5,s),(this._width!==i||this._height!==s)&&(this._width=i,this._height=s,e&&this._onDidChange.fire())}}class Ed{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=Ed._read(e,this.key),i=o=>Ed._read(e,o),s=(o,r)=>Ed._write(e,o,r);this.migrate(t,i,s)}static _read(e,t){if(typeof e>"u")return;const i=t.indexOf(".");if(i>=0){const s=t.substring(0,i);return this._read(e[s],t.substring(i+1))}return e[t]}static _write(e,t,i){const s=t.indexOf(".");if(s>=0){const o=t.substring(0,s);e[o]=e[o]||{},this._write(e[o],t.substring(s+1),i);return}e[t]=i}}Ed.items=[];function Lu(n,e){Ed.items.push(new Ed(n,e))}function Ko(n,e){Lu(n,(t,i,s)=>{if(typeof t<"u"){for(const[o,r]of e)if(t===o){s(n,r);return}}})}function Lbe(n){Ed.items.forEach(e=>e.apply(n))}Ko("wordWrap",[[!0,"on"],[!1,"off"]]);Ko("lineNumbers",[[!0,"on"],[!1,"off"]]);Ko("cursorBlinking",[["visible","solid"]]);Ko("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);Ko("renderLineHighlight",[[!0,"line"],[!1,"none"]]);Ko("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);Ko("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);Ko("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ko("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);Ko("autoIndent",[[!1,"advanced"],[!0,"full"]]);Ko("matchBrackets",[[!0,"always"],[!1,"never"]]);Ko("renderFinalNewline",[[!0,"on"],[!1,"off"]]);Ko("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);Lu("autoClosingBrackets",(n,e,t)=>{n===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Lu("renderIndentGuides",(n,e,t)=>{typeof n<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!n))});Lu("highlightActiveIndentGuide",(n,e,t)=>{typeof n<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!n))});const Dbe={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Lu("suggest.filteredTypes",(n,e,t)=>{if(n&&typeof n=="object"){for(const i of Object.entries(Dbe))n[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});Lu("quickSuggestions",(n,e,t)=>{if(typeof n=="boolean"){const i=n?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});Lu("experimental.stickyScroll.enabled",(n,e,t)=>{typeof n=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",n))});Lu("experimental.stickyScroll.maxLineCount",(n,e,t)=>{typeof n=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",n))});class kbe{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new B,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const ex=new kbe,Du=at("accessibilityService"),Ebe=new _e("accessibilityModeEnabled",!1);var Abe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Ibe=function(n,e){return function(t,i){e(t,i,n)}};let $T=class extends Y{constructor(e,t,i,s){super(),this._accessibilityService=s,this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new B),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new IU,this.isSimpleWidget=e,this._containerObserver=this._register(new aq(i,t.dimension)),this._rawOptions=S7(t),this._validatedOptions=Zc.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(Gc.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(ex.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(bT.onDidChange(()=>this._recomputeOptions())),this._register(zS.onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Zc.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=$h.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),s={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:ex.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Zc.computeOptions(this._validatedOptions,s)}_readEnvConfiguration(){return{extraEditorClassName:Nbe(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:Hh||vr,pixelRatio:zS.value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return bT.readFontInfo(e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=S7(e);Zc.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Zc.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=Tbe(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};$T=Abe([Ibe(3,Du)],$T);function Tbe(n){let e=0;for(;n;)n=Math.floor(n/10),e++;return e||1}function Nbe(){let n="";return!pc&&!QU&&(n+="no-user-select "),pc&&(n+="no-minimap-shadow ",n+="enable-user-select "),pt&&(n+="mac "),n}class Rbe{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class Mbe{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Zc{static validateOptions(e){const t=new Rbe;for(const i of Rg){const s=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(s))}return t}static computeOptions(e,t){const i=new Mbe;for(const s of Rg)i._write(s.id,s.compute(t,i,e._read(s.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?Ki(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Zc._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let s=!1;for(const o of Rg){const r=!Zc._deepEquals(e._read(o.id),t._read(o.id));i[o.id]=r,r&&(s=!0)}return s?new AU(i):null}static applyUpdate(e,t){let i=!1;for(const s of Rg)if(t.hasOwnProperty(s.name)){const o=s.applyUpdate(e[s.name],t[s.name]);e[s.name]=o.newValue,i=i||o.didChange}return i}}function S7(n){const e=kl(n);return Lbe(e),e}function Di(n,e,t){let i=null,s=null;if(typeof t.value=="function"?(i="value",s=t.value,s.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",s=t.get),!s)throw new Error("not supported");const o=`$memoize$${e}`;t[i]=function(...r){return this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:s.apply(this,r)}),this[o]}}var Pbe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Pt;(function(n){n.Tap="-monaco-gesturetap",n.Change="-monaco-gesturechange",n.Start="-monaco-gesturestart",n.End="-monaco-gesturesend",n.Contextmenu="-monaco-gesturecontextmenu"})(Pt||(Pt={}));class Rt extends Y{constructor(){super(),this.dispatched=!1,this.targets=new Ds,this.ignoreTargets=new Ds,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(K(document,"touchstart",e=>this.onTouchStart(e),{passive:!1})),this._register(K(document,"touchend",e=>this.onTouchEnd(e))),this._register(K(document,"touchmove",e=>this.onTouchMove(e),{passive:!1}))}static addTarget(e){if(!Rt.isTouchDevice())return Y.None;Rt.INSTANCE||(Rt.INSTANCE=new Rt);const t=Rt.INSTANCE.targets.push(e);return Ze(t)}static ignoreTarget(e){if(!Rt.isTouchDevice())return Y.None;Rt.INSTANCE||(Rt.INSTANCE=new Rt);const t=Rt.INSTANCE.ignoreTargets.push(e);return Ze(t)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,s=e.targetTouches.length;i<s;i++){const o=e.targetTouches.item(i);this.activeTouches[o.identifier]={id:o.identifier,initialTarget:o.target,initialTimeStamp:t,initialPageX:o.pageX,initialPageY:o.pageY,rollingTimestamps:[t],rollingPageX:[o.pageX],rollingPageY:[o.pageY]};const r=this.newGestureEvent(Pt.Start,o.target);r.pageX=o.pageX,r.pageY=o.pageY,this.dispatchEvent(r)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){const t=Date.now(),i=Object.keys(this.activeTouches).length;for(let s=0,o=e.changedTouches.length;s<o;s++){const r=e.changedTouches.item(s);if(!this.activeTouches.hasOwnProperty(String(r.identifier))){console.warn("move of an UNKNOWN touch",r);continue}const a=this.activeTouches[r.identifier],l=Date.now()-a.initialTimeStamp;if(l<Rt.HOLD_DELAY&&Math.abs(a.initialPageX-ko(a.rollingPageX))<30&&Math.abs(a.initialPageY-ko(a.rollingPageY))<30){const c=this.newGestureEvent(Pt.Tap,a.initialTarget);c.pageX=ko(a.rollingPageX),c.pageY=ko(a.rollingPageY),this.dispatchEvent(c)}else if(l>=Rt.HOLD_DELAY&&Math.abs(a.initialPageX-ko(a.rollingPageX))<30&&Math.abs(a.initialPageY-ko(a.rollingPageY))<30){const c=this.newGestureEvent(Pt.Contextmenu,a.initialTarget);c.pageX=ko(a.rollingPageX),c.pageY=ko(a.rollingPageY),this.dispatchEvent(c)}else if(i===1){const c=ko(a.rollingPageX),d=ko(a.rollingPageY),u=ko(a.rollingTimestamps)-a.rollingTimestamps[0],h=c-a.rollingPageX[0],f=d-a.rollingPageY[0],g=[...this.targets].filter(p=>a.initialTarget instanceof Node&&p.contains(a.initialTarget));this.inertia(g,t,Math.abs(h)/u,h>0?1:-1,c,Math.abs(f)/u,f>0?1:-1,d)}this.dispatchEvent(this.newGestureEvent(Pt.End,a.initialTarget)),delete this.activeTouches[r.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Pt.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>Rt.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Pt.Change||e.type===Pt.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const t of this.ignoreTargets)if(t.contains(e.initialTarget))return;for(const t of this.targets)t.contains(e.initialTarget)&&(t.dispatchEvent(e),this.dispatched=!0)}}inertia(e,t,i,s,o,r,a,l){this.handle=Uo(()=>{const c=Date.now(),d=c-t;let u=0,h=0,f=!0;i+=Rt.SCROLL_FRICTION*d,r+=Rt.SCROLL_FRICTION*d,i>0&&(f=!1,u=s*i*d),r>0&&(f=!1,h=a*r*d);const g=this.newGestureEvent(Pt.Change);g.translationX=u,g.translationY=h,e.forEach(p=>p.dispatchEvent(g)),f||this.inertia(e,c,i,s,o+u,r,a,l+h)})}onTouchMove(e){const t=Date.now();for(let i=0,s=e.changedTouches.length;i<s;i++){const o=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("end of an UNKNOWN touch",o);continue}const r=this.activeTouches[o.identifier],a=this.newGestureEvent(Pt.Change,r.initialTarget);a.translationX=o.pageX-ko(r.rollingPageX),a.translationY=o.pageY-ko(r.rollingPageY),a.pageX=o.pageX,a.pageY=o.pageY,this.dispatchEvent(a),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(o.pageX),r.rollingPageY.push(o.pageY),r.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}Rt.SCROLL_FRICTION=-.005;Rt.HOLD_DELAY=700;Rt.CLEAR_TAP_COUNT_TIME=400;Pbe([Di],Rt,"isTouchDevice",null);class BD{constructor(){this._hooks=new pe,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,s,o){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=s,this._onStopCallback=o;let r=e;try{e.setPointerCapture(t),this._hooks.add(Ze(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{r=window}this._hooks.add(K(r,de.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(K(r,de.POINTER_UP,a=>this.stopMonitoring(!0)))}}function kP(n){return`--vscode-${n.replace(/\./g,"-")}`}function re(n){return`var(${kP(n)})`}function Obe(n,e){return`var(${kP(n)}, ${e})`}const lq={ColorContribution:"base.contributions.colors"};class Fbe{constructor(){this._onDidChangeSchema=new B,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,s=!1,o){const r={id:e,description:i,defaults:t,needsTransparency:s,deprecationMessage:o};this.colorsById[e]=r;const a={type:"string",description:i,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(a.deprecationMessage=o),this.colorSchema.properties[e]=a,this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i&&i.defaults){const s=i.defaults[t.type];return Mr(s,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const s=t.indexOf(".")===-1?0:1,o=i.indexOf(".")===-1?0:1;return s!==o?s-o:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const WD=new Fbe;mn.add(lq.ColorContribution,WD);function E(n,e,t,i,s){return WD.registerColor(n,e,t,i,s)}const ee=E("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},m("foreground","Overall foreground color. This color is only used if not overridden by a component."));E("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},m("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));const Bbe=E("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},m("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));E("descriptionForeground",{light:"#717171",dark:Ce(ee,.7),hcDark:Ce(ee,.7),hcLight:Ce(ee,.7)},m("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const ad=E("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},m("iconForeground","The default color for icons in the workbench.")),yo=E("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},m("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Je=E("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},m("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),jt=E("contrastActiveBorder",{light:null,dark:null,hcDark:yo,hcLight:yo},m("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));E("selection.background",{light:null,dark:null,hcDark:null,hcLight:null},m("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));E("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:z.black,hcLight:"#292929"},m("textSeparatorForeground","Color for text separators."));const Wbe=E("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},m("textLinkForeground","Foreground color for links in text."));E("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#3794FF",hcLight:"#0F4A85"},m("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));E("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#D7BA7D",hcLight:"#292929"},m("textPreformatForeground","Foreground color for preformatted text segments."));E("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hcDark:null,hcLight:"#F2F2F2"},m("textBlockQuoteBackground","Background color for block quotes in text."));E("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:z.white,hcLight:"#292929"},m("textBlockQuoteBorder","Border color for block quotes in text."));E("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:z.black,hcLight:"#F2F2F2"},m("textCodeBlockBackground","Background color for code blocks in text."));const Yl=E("widget.shadow",{dark:Ce(z.black,.36),light:Ce(z.black,.16),hcDark:null,hcLight:null},m("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),cq=E("widget.border",{dark:null,light:null,hcDark:Je,hcLight:Je},m("widgetBorder","Border color of widgets such as find/replace inside the editor.")),Vbe=E("input.background",{dark:"#3C3C3C",light:z.white,hcDark:z.black,hcLight:z.white},m("inputBoxBackground","Input box background.")),zbe=E("input.foreground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("inputBoxForeground","Input box foreground.")),Hbe=E("input.border",{dark:null,light:null,hcDark:Je,hcLight:Je},m("inputBoxBorder","Input box border.")),EP=E("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:Je,hcLight:Je},m("inputBoxActiveOptionBorder","Border color of activated options in input fields."));E("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},m("inputOption.hoverBackground","Background color of activated options in input fields."));const Ch=E("inputOption.activeBackground",{dark:Ce(yo,.4),light:Ce(yo,.2),hcDark:z.transparent,hcLight:z.transparent},m("inputOption.activeBackground","Background hover color of options in input fields.")),AP=E("inputOption.activeForeground",{dark:z.white,light:z.black,hcDark:ee,hcLight:ee},m("inputOption.activeForeground","Foreground color of activated options in input fields."));E("input.placeholderForeground",{light:Ce(ee,.5),dark:Ce(ee,.5),hcDark:Ce(ee,.7),hcLight:Ce(ee,.7)},m("inputPlaceholderForeground","Input box foreground color for placeholder text."));const $be=E("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:z.black,hcLight:z.white},m("inputValidationInfoBackground","Input validation background color for information severity.")),Ube=E("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:ee},m("inputValidationInfoForeground","Input validation foreground color for information severity.")),jbe=E("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:Je,hcLight:Je},m("inputValidationInfoBorder","Input validation border color for information severity.")),qbe=E("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:z.black,hcLight:z.white},m("inputValidationWarningBackground","Input validation background color for warning severity.")),Gbe=E("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:ee},m("inputValidationWarningForeground","Input validation foreground color for warning severity.")),Kbe=E("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:Je,hcLight:Je},m("inputValidationWarningBorder","Input validation border color for warning severity.")),Ybe=E("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:z.black,hcLight:z.white},m("inputValidationErrorBackground","Input validation background color for error severity.")),Zbe=E("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:ee},m("inputValidationErrorForeground","Input validation foreground color for error severity.")),Xbe=E("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:Je,hcLight:Je},m("inputValidationErrorBorder","Input validation border color for error severity.")),Oa=E("dropdown.background",{dark:"#3C3C3C",light:z.white,hcDark:z.black,hcLight:z.white},m("dropdownBackground","Dropdown background.")),Qbe=E("dropdown.listBackground",{dark:null,light:null,hcDark:z.black,hcLight:z.white},m("dropdownListBackground","Dropdown list background.")),Zl=E("dropdown.foreground",{dark:"#F0F0F0",light:ee,hcDark:z.white,hcLight:ee},m("dropdownForeground","Dropdown foreground.")),Vg=E("dropdown.border",{dark:Oa,light:"#CECECE",hcDark:Je,hcLight:Je},m("dropdownBorder","Dropdown border.")),t_=E("button.foreground",{dark:z.white,light:z.white,hcDark:z.white,hcLight:z.white},m("buttonForeground","Button foreground color.")),Jbe=E("button.separator",{dark:Ce(t_,.4),light:Ce(t_,.4),hcDark:Ce(t_,.4),hcLight:Ce(t_,.4)},m("buttonSeparator","Button separator color.")),i_=E("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},m("buttonBackground","Button background color.")),eve=E("button.hoverBackground",{dark:Qr(i_,.2),light:Hf(i_,.2),hcDark:i_,hcLight:i_},m("buttonHoverBackground","Button background color when hovering.")),tve=E("button.border",{dark:Je,light:Je,hcDark:Je,hcLight:Je},m("buttonBorder","Button border color.")),ive=E("button.secondaryForeground",{dark:z.white,light:z.white,hcDark:z.white,hcLight:ee},m("buttonSecondaryForeground","Secondary button foreground color.")),UT=E("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:z.white},m("buttonSecondaryBackground","Secondary button background color.")),nve=E("button.secondaryHoverBackground",{dark:Qr(UT,.2),light:Hf(UT,.2),hcDark:null,hcLight:null},m("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),NC=E("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:z.black,hcLight:"#0F4A85"},m("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),sve=E("badge.foreground",{dark:z.white,light:"#333",hcDark:z.white,hcLight:z.white},m("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),ove=E("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},m("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),n_=E("scrollbarSlider.background",{dark:z.fromHex("#797979").transparent(.4),light:z.fromHex("#646464").transparent(.4),hcDark:Ce(Je,.6),hcLight:Ce(Je,.4)},m("scrollbarSliderBackground","Scrollbar slider background color.")),s_=E("scrollbarSlider.hoverBackground",{dark:z.fromHex("#646464").transparent(.7),light:z.fromHex("#646464").transparent(.7),hcDark:Ce(Je,.8),hcLight:Ce(Je,.8)},m("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),o_=E("scrollbarSlider.activeBackground",{dark:z.fromHex("#BFBFBF").transparent(.4),light:z.fromHex("#000000").transparent(.6),hcDark:Je,hcLight:Je},m("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),rve=E("progressBar.background",{dark:z.fromHex("#0E70C0"),light:z.fromHex("#0E70C0"),hcDark:Je,hcLight:Je},m("progressBarBackground","Background color of the progress bar that can show for long running operations."));E("editorError.background",{dark:null,light:null,hcDark:null,hcLight:null},m("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const Fa=E("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},m("editorError.foreground","Foreground color of error squigglies in the editor.")),ave=E("editorError.border",{dark:null,light:null,hcDark:z.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},m("errorBorder","If set, color of double underlines for errors in the editor."));E("editorWarning.background",{dark:null,light:null,hcDark:null,hcLight:null},m("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const wo=E("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},m("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),ev=E("editorWarning.border",{dark:null,light:null,hcDark:z.fromHex("#FFCC00").transparent(.8),hcLight:z.fromHex("#FFCC00").transparent(.8)},m("warningBorder","If set, color of double underlines for warnings in the editor."));E("editorInfo.background",{dark:null,light:null,hcDark:null,hcLight:null},m("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const ks=E("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},m("editorInfo.foreground","Foreground color of info squigglies in the editor.")),tv=E("editorInfo.border",{dark:null,light:null,hcDark:z.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},m("infoBorder","If set, color of double underlines for infos in the editor.")),lve=E("editorHint.foreground",{dark:z.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},m("editorHint.foreground","Foreground color of hint squigglies in the editor."));E("editorHint.border",{dark:null,light:null,hcDark:z.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},m("hintBorder","If set, color of double underlines for hints in the editor."));E("sash.hoverBorder",{dark:yo,light:yo,hcDark:yo,hcLight:yo},m("sashActiveBorder","Border color of active sashes."));const Gi=E("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:z.black,hcLight:z.white},m("editorBackground","Editor background color.")),ku=E("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:z.white,hcLight:ee},m("editorForeground","Editor default foreground color."));E("editorStickyScroll.background",{light:Gi,dark:Gi,hcDark:Gi,hcLight:Gi},m("editorStickyScrollBackground","Sticky scroll background color for the editor"));E("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:z.fromHex("#0F4A85").transparent(.1)},m("editorStickyScrollHoverBackground","Sticky scroll on hover background color for the editor"));const zi=E("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:z.white},m("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Ba=E("editorWidget.foreground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),zg=E("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:Je,hcLight:Je},m("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),cve=E("editorWidget.resizeBorder",{light:null,dark:null,hcDark:null,hcLight:null},m("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),x7=E("quickInput.background",{dark:zi,light:zi,hcDark:zi,hcLight:zi},m("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),dve=E("quickInput.foreground",{dark:Ba,light:Ba,hcDark:Ba,hcLight:Ba},m("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),uve=E("quickInputTitle.background",{dark:new z(new ut(255,255,255,.105)),light:new z(new ut(0,0,0,.06)),hcDark:"#000000",hcLight:z.white},m("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),dq=E("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:z.white,hcLight:"#0F4A85"},m("pickerGroupForeground","Quick picker color for grouping labels.")),hve=E("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:z.white,hcLight:"#0F4A85"},m("pickerGroupBorder","Quick picker color for grouping borders.")),fve=E("keybindingLabel.background",{dark:new z(new ut(128,128,128,.17)),light:new z(new ut(221,221,221,.4)),hcDark:z.transparent,hcLight:z.transparent},m("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),gve=E("keybindingLabel.foreground",{dark:z.fromHex("#CCCCCC"),light:z.fromHex("#555555"),hcDark:z.white,hcLight:ee},m("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),pve=E("keybindingLabel.border",{dark:new z(new ut(51,51,51,.6)),light:new z(new ut(204,204,204,.4)),hcDark:new z(new ut(111,195,223)),hcLight:Je},m("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),mve=E("keybindingLabel.bottomBorder",{dark:new z(new ut(68,68,68,.6)),light:new z(new ut(187,187,187,.4)),hcDark:new z(new ut(111,195,223)),hcLight:ee},m("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),ld=E("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},m("editorSelectionBackground","Color of the editor selection.")),_ve=E("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:z.white},m("editorSelectionForeground","Color of the selected text for high contrast.")),uq=E("editor.inactiveSelectionBackground",{light:Ce(ld,.5),dark:Ce(ld,.5),hcDark:Ce(ld,.7),hcLight:Ce(ld,.5)},m("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),IP=E("editor.selectionHighlightBackground",{light:N7(ld,Gi,.3,.6),dark:N7(ld,Gi,.3,.6),hcDark:null,hcLight:null},m("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:jt,hcLight:jt},m("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));const bve=E("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},m("editorFindMatch","Color of the current search match.")),Wa=E("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},m("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),vve=E("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},m("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),yve=E("editor.findMatchBorder",{light:null,dark:null,hcDark:jt,hcLight:jt},m("editorFindMatchBorder","Border color of the current search match.")),cd=E("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:jt,hcLight:jt},m("findMatchHighlightBorder","Border color of the other search matches.")),wve=E("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Ce(jt,.4),hcLight:Ce(jt,.4)},m("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);E("searchEditor.findMatchBackground",{light:Ce(Wa,.66),dark:Ce(Wa,.66),hcDark:Wa,hcLight:Wa},m("searchEditor.queryMatch","Color of the Search Editor query matches."));E("searchEditor.findMatchBorder",{light:Ce(cd,.66),dark:Ce(cd,.66),hcDark:cd,hcLight:cd},m("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));E("search.resultsInfoForeground",{light:ee,dark:Ce(ee,.65),hcDark:ee,hcLight:ee},m("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));E("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},m("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const L7=E("editorHoverWidget.background",{light:zi,dark:zi,hcDark:zi,hcLight:zi},m("hoverBackground","Background color of the editor hover."));E("editorHoverWidget.foreground",{light:Ba,dark:Ba,hcDark:Ba,hcLight:Ba},m("hoverForeground","Foreground color of the editor hover."));const Cve=E("editorHoverWidget.border",{light:zg,dark:zg,hcDark:zg,hcLight:zg},m("hoverBorder","Border color of the editor hover."));E("editorHoverWidget.statusBarBackground",{dark:Qr(L7,.2),light:Hf(L7,.05),hcDark:zi,hcLight:zi},m("statusBarBackground","Background color of the editor hover status bar."));E("editorLink.activeForeground",{dark:"#4E94CE",light:z.blue,hcDark:z.cyan,hcLight:"#292929"},m("activeLinkForeground","Color of active links."));const dd=E("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:z.white,hcLight:z.black},m("editorInlayHintForeground","Foreground color of inline hints")),ud=E("editorInlayHint.background",{dark:Ce(NC,.1),light:Ce(NC,.1),hcDark:Ce(z.white,.1),hcLight:Ce(NC,.1)},m("editorInlayHintBackground","Background color of inline hints"));E("editorInlayHint.typeForeground",{dark:dd,light:dd,hcDark:dd,hcLight:dd},m("editorInlayHintForegroundTypes","Foreground color of inline hints for types"));E("editorInlayHint.typeBackground",{dark:ud,light:ud,hcDark:ud,hcLight:ud},m("editorInlayHintBackgroundTypes","Background color of inline hints for types"));E("editorInlayHint.parameterForeground",{dark:dd,light:dd,hcDark:dd,hcLight:dd},m("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters"));E("editorInlayHint.parameterBackground",{dark:ud,light:ud,hcDark:ud,hcLight:ud},m("editorInlayHintBackgroundParameter","Background color of inline hints for parameters"));E("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},m("editorLightBulbForeground","The color used for the lightbulb actions icon."));E("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));const jT=new z(new ut(155,185,85,.2)),qT=new z(new ut(255,0,0,.2)),Sve=E("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},m("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),xve=E("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},m("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditor.insertedLineBackground",{dark:jT,light:jT,hcDark:null,hcLight:null},m("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditor.removedLineBackground",{dark:qT,light:qT,hcDark:null,hcLight:null},m("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);E("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));E("diffEditorGutter.removedLineBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const Lve=E("diffEditorOverview.insertedForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),Dve=E("diffEditorOverview.removedForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));E("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},m("diffEditorInsertedOutline","Outline color for the text that got inserted."));E("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},m("diffEditorRemovedOutline","Outline color for text that got removed."));E("diffEditor.border",{dark:null,light:null,hcDark:Je,hcLight:Je},m("diffEditorBorder","Border color between the two text editors."));E("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},m("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));E("diffEditor.unchangedRegionBackground",{dark:"#3e3e3e",light:"#e4e4e4",hcDark:null,hcLight:null},m("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));E("diffEditor.unchangedRegionForeground",{dark:"#a3a2a2",light:"#4d4c4c",hcDark:null,hcLight:null},m("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));E("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},m("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const kve=E("list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Eve=E("list.focusForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ave=E("list.focusOutline",{dark:yo,light:yo,hcDark:jt,hcLight:jt},m("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Ive=E("list.focusAndSelectionOutline",{dark:null,light:null,hcDark:null,hcLight:null},m("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),Xl=E("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:z.fromHex("#0F4A85").transparent(.1)},m("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Va=E("list.activeSelectionForeground",{dark:z.white,light:z.white,hcDark:null,hcLight:null},m("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),r_=E("list.activeSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Tve=E("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:z.fromHex("#0F4A85").transparent(.1)},m("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Nve=E("list.inactiveSelectionForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Rve=E("list.inactiveSelectionIconForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Mve=E("list.inactiveFocusBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),Pve=E("list.inactiveFocusOutline",{dark:null,light:null,hcDark:null,hcLight:null},m("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),hq=E("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:z.white.transparent(.1),hcLight:z.fromHex("#0F4A85").transparent(.1)},m("listHoverBackground","List/Tree background when hovering over items using the mouse.")),fq=E("list.hoverForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),Ove=E("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},m("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),uw=E("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:yo,hcLight:yo},m("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree."));E("list.focusHighlightForeground",{dark:uw,light:h1e(Xl,uw,"#BBE7FF"),hcDark:uw,hcLight:uw},m("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));E("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},m("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));E("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},m("listErrorForeground","Foreground color of list items containing errors."));E("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},m("listWarningForeground","Foreground color of list items containing warnings."));const Fve=E("listFilterWidget.background",{light:Hf(zi,0),dark:Qr(zi,0),hcDark:zi,hcLight:zi},m("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),Bve=E("listFilterWidget.outline",{dark:z.transparent,light:z.transparent,hcDark:"#f38518",hcLight:"#007ACC"},m("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),Wve=E("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:Je,hcLight:Je},m("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),Vve=E("listFilterWidget.shadow",{dark:Yl,light:Yl,hcDark:Yl,hcLight:Yl},m("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));E("list.filterMatchBackground",{dark:Wa,light:Wa,hcDark:null,hcLight:null},m("listFilterMatchHighlight","Background color of the filtered match."));E("list.filterMatchBorder",{dark:cd,light:cd,hcDark:Je,hcLight:jt},m("listFilterMatchHighlightBorder","Border color of the filtered match."));const a_=E("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},m("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),zve=E("tree.inactiveIndentGuidesStroke",{dark:Ce(a_,.4),light:Ce(a_,.4),hcDark:Ce(a_,.4),hcLight:Ce(a_,.4)},m("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),Hve=E("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},m("tableColumnsBorder","Table border color between columns.")),$ve=E("tree.tableOddRowsBackground",{dark:Ce(ee,.04),light:Ce(ee,.04),hcDark:null,hcLight:null},m("tableOddRowsBackgroundColor","Background color for odd table rows."));E("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},m("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized. "));const Uve=E("checkbox.background",{dark:Oa,light:Oa,hcDark:Oa,hcLight:Oa},m("checkbox.background","Background color of checkbox widget."));E("checkbox.selectBackground",{dark:zi,light:zi,hcDark:zi,hcLight:zi},m("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const jve=E("checkbox.foreground",{dark:Zl,light:Zl,hcDark:Zl,hcLight:Zl},m("checkbox.foreground","Foreground color of checkbox widget.")),qve=E("checkbox.border",{dark:Vg,light:Vg,hcDark:Vg,hcLight:Vg},m("checkbox.border","Border color of checkbox widget."));E("checkbox.selectBorder",{dark:ad,light:ad,hcDark:ad,hcLight:ad},m("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const D7=E("quickInput.list.focusBackground",{dark:null,light:null,hcDark:null,hcLight:null},"",void 0,m("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),GT=E("quickInputList.focusForeground",{dark:Va,light:Va,hcDark:Va,hcLight:Va},m("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),gq=E("quickInputList.focusIconForeground",{dark:r_,light:r_,hcDark:r_,hcLight:r_},m("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),KT=E("quickInputList.focusBackground",{dark:iv(D7,Xl),light:iv(D7,Xl),hcDark:null,hcLight:null},m("quickInput.listFocusBackground","Quick picker background color for the focused item.")),Gve=E("menu.border",{dark:null,light:null,hcDark:Je,hcLight:Je},m("menuBorder","Border color of menus.")),Kve=E("menu.foreground",{dark:Zl,light:Zl,hcDark:Zl,hcLight:Zl},m("menuForeground","Foreground color of menu items.")),Yve=E("menu.background",{dark:Oa,light:Oa,hcDark:Oa,hcLight:Oa},m("menuBackground","Background color of menu items.")),Zve=E("menu.selectionForeground",{dark:Va,light:Va,hcDark:Va,hcLight:Va},m("menuSelectionForeground","Foreground color of the selected menu item in menus.")),Xve=E("menu.selectionBackground",{dark:Xl,light:Xl,hcDark:Xl,hcLight:Xl},m("menuSelectionBackground","Background color of the selected menu item in menus.")),Qve=E("menu.selectionBorder",{dark:null,light:null,hcDark:jt,hcLight:jt},m("menuSelectionBorder","Border color of the selected menu item in menus.")),Jve=E("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:Je,hcLight:Je},m("menuSeparatorBackground","Color of a separator menu item in menus.")),YT=E("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},m("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));E("toolbar.hoverOutline",{dark:null,light:null,hcDark:jt,hcLight:jt},m("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));E("toolbar.activeBackground",{dark:Qr(YT,.1),light:Hf(YT,.1),hcDark:null,hcLight:null},m("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));E("editor.snippetTabstopHighlightBackground",{dark:new z(new ut(124,124,124,.3)),light:new z(new ut(10,50,100,.2)),hcDark:new z(new ut(124,124,124,.3)),hcLight:new z(new ut(10,50,100,.2))},m("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));E("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hcDark:null,hcLight:null},m("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));E("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));E("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new z(new ut(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},m("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const e1e=E("breadcrumb.foreground",{light:Ce(ee,.8),dark:Ce(ee,.8),hcDark:Ce(ee,.8),hcLight:Ce(ee,.8)},m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),t1e=E("breadcrumb.background",{light:Gi,dark:Gi,hcDark:Gi,hcLight:Gi},m("breadcrumbsBackground","Background color of breadcrumb items.")),k7=E("breadcrumb.focusForeground",{light:Hf(ee,.2),dark:Qr(ee,.1),hcDark:Qr(ee,.1),hcLight:Qr(ee,.1)},m("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),i1e=E("breadcrumb.activeSelectionForeground",{light:Hf(ee,.2),dark:Qr(ee,.1),hcDark:Qr(ee,.1),hcLight:Qr(ee,.1)},m("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));E("breadcrumbPicker.background",{light:zi,dark:zi,hcDark:zi,hcLight:zi},m("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const pq=.5,E7=z.fromHex("#40C8AE").transparent(pq),A7=z.fromHex("#40A6FF").transparent(pq),I7=z.fromHex("#606060").transparent(.4),cr=.4,Sm=1,Hg=E("merge.currentHeaderBackground",{dark:E7,light:E7,hcDark:null,hcLight:null},m("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.currentContentBackground",{dark:Ce(Hg,cr),light:Ce(Hg,cr),hcDark:Ce(Hg,cr),hcLight:Ce(Hg,cr)},m("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const $g=E("merge.incomingHeaderBackground",{dark:A7,light:A7,hcDark:null,hcLight:null},m("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.incomingContentBackground",{dark:Ce($g,cr),light:Ce($g,cr),hcDark:Ce($g,cr),hcLight:Ce($g,cr)},m("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const Ug=E("merge.commonHeaderBackground",{dark:I7,light:I7,hcDark:null,hcLight:null},m("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);E("merge.commonContentBackground",{dark:Ce(Ug,cr),light:Ce(Ug,cr),hcDark:Ce(Ug,cr),hcLight:Ce(Ug,cr)},m("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const xm=E("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},m("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));E("editorOverviewRuler.currentContentForeground",{dark:Ce(Hg,Sm),light:Ce(Hg,Sm),hcDark:xm,hcLight:xm},m("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));E("editorOverviewRuler.incomingContentForeground",{dark:Ce($g,Sm),light:Ce($g,Sm),hcDark:xm,hcLight:xm},m("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));E("editorOverviewRuler.commonContentForeground",{dark:Ce(Ug,Sm),light:Ce(Ug,Sm),hcDark:xm,hcLight:xm},m("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const TP=E("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:""},m("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),l_=E("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},m("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),jg=E("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},m("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),VD=E("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),T7=E("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},m("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),n1e=E("minimap.infoHighlight",{dark:ks,light:ks,hcDark:tv,hcLight:tv},m("minimapInfo","Minimap marker color for infos.")),s1e=E("minimap.warningHighlight",{dark:wo,light:wo,hcDark:ev,hcLight:ev},m("overviewRuleWarning","Minimap marker color for warnings.")),o1e=E("minimap.errorHighlight",{dark:new z(new ut(255,18,18,.7)),light:new z(new ut(255,18,18,.7)),hcDark:new z(new ut(255,50,50,1)),hcLight:"#B5200D"},m("minimapError","Minimap marker color for errors.")),r1e=E("minimap.background",{dark:null,light:null,hcDark:null,hcLight:null},m("minimapBackground","Minimap background color.")),a1e=E("minimap.foregroundOpacity",{dark:z.fromHex("#000f"),light:z.fromHex("#000f"),hcDark:z.fromHex("#000f"),hcLight:z.fromHex("#000f")},m("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));E("minimapSlider.background",{light:Ce(n_,.5),dark:Ce(n_,.5),hcDark:Ce(n_,.5),hcLight:Ce(n_,.5)},m("minimapSliderBackground","Minimap slider background color."));E("minimapSlider.hoverBackground",{light:Ce(s_,.5),dark:Ce(s_,.5),hcDark:Ce(s_,.5),hcLight:Ce(s_,.5)},m("minimapSliderHoverBackground","Minimap slider background color when hovering."));E("minimapSlider.activeBackground",{light:Ce(o_,.5),dark:Ce(o_,.5),hcDark:Ce(o_,.5),hcLight:Ce(o_,.5)},m("minimapSliderActiveBackground","Minimap slider background color when clicked on."));const l1e=E("problemsErrorIcon.foreground",{dark:Fa,light:Fa,hcDark:Fa,hcLight:Fa},m("problemsErrorIconForeground","The color used for the problems error icon.")),c1e=E("problemsWarningIcon.foreground",{dark:wo,light:wo,hcDark:wo,hcLight:wo},m("problemsWarningIconForeground","The color used for the problems warning icon.")),d1e=E("problemsInfoIcon.foreground",{dark:ks,light:ks,hcDark:ks,hcLight:ks},m("problemsInfoIconForeground","The color used for the problems info icon."));E("charts.foreground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("chartsForeground","The foreground color used in charts."));E("charts.lines",{dark:Ce(ee,.5),light:Ce(ee,.5),hcDark:Ce(ee,.5),hcLight:Ce(ee,.5)},m("chartsLines","The color used for horizontal lines in charts."));E("charts.red",{dark:Fa,light:Fa,hcDark:Fa,hcLight:Fa},m("chartsRed","The red color used in chart visualizations."));E("charts.blue",{dark:ks,light:ks,hcDark:ks,hcLight:ks},m("chartsBlue","The blue color used in chart visualizations."));E("charts.yellow",{dark:wo,light:wo,hcDark:wo,hcLight:wo},m("chartsYellow","The yellow color used in chart visualizations."));E("charts.orange",{dark:jg,light:jg,hcDark:jg,hcLight:jg},m("chartsOrange","The orange color used in chart visualizations."));E("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},m("chartsGreen","The green color used in chart visualizations."));E("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("chartsPurple","The purple color used in chart visualizations."));function u1e(n,e){var t,i,s,o;switch(n.op){case 0:return(t=Mr(n.value,e))===null||t===void 0?void 0:t.darken(n.factor);case 1:return(i=Mr(n.value,e))===null||i===void 0?void 0:i.lighten(n.factor);case 2:return(s=Mr(n.value,e))===null||s===void 0?void 0:s.transparent(n.factor);case 3:{const r=Mr(n.background,e);return r?(o=Mr(n.value,e))===null||o===void 0?void 0:o.makeOpaque(r):Mr(n.value,e)}case 4:for(const r of n.values){const a=Mr(r,e);if(a)return a}return;case 6:return Mr(e.defines(n.if)?n.then:n.else,e);case 5:{const r=Mr(n.value,e);if(!r)return;const a=Mr(n.background,e);return a?r.isDarkerThan(a)?z.getLighterColor(r,a,n.factor).transparent(n.transparency):z.getDarkerColor(r,a,n.factor).transparent(n.transparency):r.transparent(n.factor*n.transparency)}default:throw lP()}}function Hf(n,e){return{op:0,value:n,factor:e}}function Qr(n,e){return{op:1,value:n,factor:e}}function Ce(n,e){return{op:2,value:n,factor:e}}function iv(...n){return{op:4,values:n}}function h1e(n,e,t){return{op:6,if:n,then:e,else:t}}function N7(n,e,t,i){return{op:5,value:n,background:e,factor:t,transparency:i}}function Mr(n,e){if(n!==null){if(typeof n=="string")return n[0]==="#"?z.fromHex(n):e.getColor(n);if(n instanceof z)return n;if(typeof n=="object")return u1e(n,e)}}const mq="vscode://schemas/workbench-colors",_q=mn.as(RD.JSONContribution);_q.registerSchema(mq,WD.getColorSchema());const R7=new Li(()=>_q.notifySchemaChanged(mq),200);WD.onDidChangeSchema(()=>{R7.isScheduled()||R7.schedule()});class zD{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new bq(this.x-window.scrollX,this.y-window.scrollY)}}class bq{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new zD(this.clientX+window.scrollX,this.clientY+window.scrollY)}}class f1e{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s,this._editorPagePositionBrand=void 0}}class g1e{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function NP(n){const e=Nn(n);return new f1e(e.left,e.top,e.width,e.height)}function RP(n,e,t){const i=e.width/n.offsetWidth,s=e.height/n.offsetHeight,o=(t.x-e.x)/i,r=(t.y-e.y)/s;return new g1e(o,r)}class su extends ar{constructor(e,t,i){super(e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new zD(this.posx,this.posy),this.editorPos=NP(i),this.relativePos=RP(i,this.editorPos,this.pos)}}class p1e{constructor(e){this._editorViewDomNode=e}_create(e){return new su(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return K(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return K(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return K(e,de.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return K(e,de.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return K(e,de.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return K(e,"mousemove",i=>t(this._create(i)))}}class m1e{constructor(e){this._editorViewDomNode=e}_create(e){return new su(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return K(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return K(e,de.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return K(e,de.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return K(e,"pointermove",i=>t(this._create(i)))}}class _1e extends Y{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new BD),this._keydownListener=null}startMonitoring(e,t,i,s,o){this._keydownListener=Hi(e.ownerDocument,"keydown",r=>{r.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,r.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,r=>{s(new su(r,!0,this._editorViewDomNode))},r=>{this._keydownListener.dispose(),o(r)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}class ly extends Y{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,s=e.length;i<s;i++){const o=e[i];switch(o.type){case 0:this.onCompositionStart(o)&&(t=!0);break;case 1:this.onCompositionEnd(o)&&(t=!0);break;case 2:this.onConfigurationChanged(o)&&(t=!0);break;case 3:this.onCursorStateChanged(o)&&(t=!0);break;case 4:this.onDecorationsChanged(o)&&(t=!0);break;case 5:this.onFlushed(o)&&(t=!0);break;case 6:this.onFocusChanged(o)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(o)&&(t=!0);break;case 8:this.onLineMappingChanged(o)&&(t=!0);break;case 9:this.onLinesChanged(o)&&(t=!0);break;case 10:this.onLinesDeleted(o)&&(t=!0);break;case 11:this.onLinesInserted(o)&&(t=!0);break;case 12:this.onRevealRangeRequest(o)&&(t=!0);break;case 13:this.onScrollChanged(o)&&(t=!0);break;case 15:this.onTokensChanged(o)&&(t=!0);break;case 14:this.onThemeChanged(o)&&(t=!0);break;case 16:this.onTokensColorsChanged(o)&&(t=!0);break;case 17:this.onZonesChanged(o)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(o)}}t&&(this._shouldRender=!0)}}class ro extends ly{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Ja{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let s=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[s++]=this.read(e)),e=e.parentElement;const o=new Uint8Array(s);for(let r=0;r<s;r++)o[r]=i[s-r-1];return o}}class b1e{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class v1e extends b1e{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class y1e{constructor(e,t,i,s){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=s}}class HD{static from(e){const t=new Array(e.length);for(let i=0,s=e.length;i<s;i++){const o=e[i];t[i]=new HD(o.left,o.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class qh{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class w1e{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class M7{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class RC{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,s,o){const r=this._createRange();try{return r.setStart(e,t),r.setEnd(i,s),r.getClientRects()}catch{return null}finally{this._detachRange(r,o)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(qh.compare);const t=[];let i=0,s=e[0];for(let o=1,r=e.length;o<r;o++){const a=e[o];s.left+s.width+.9>=a.left?s.width=Math.max(s.width,a.left+a.width-s.left):(t[i++]=s,s=a)}return t[i++]=s,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];s[o]=new qh(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(s)}static readHorizontalRanges(e,t,i,s,o,r){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),s=Math.min(l,Math.max(0,s)),t===s&&i===o&&i===0&&!e.children[t].firstChild){const h=e.children[t].getClientRects();return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,r.clientRectDeltaLeft,r.clientRectScale)}t!==s&&s>0&&o===0&&(s--,o=1073741824);let c=e.children[t].firstChild,d=e.children[s].firstChild;if((!c||!d)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!d&&o===0&&s>0&&(d=e.children[s-1].firstChild,o=1073741824)),!c||!d)return null;i=Math.min(c.textContent.length,Math.max(0,i)),o=Math.min(d.textContent.length,Math.max(0,o));const u=this._readClientRects(c,i,d,o,r.endNode);return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,r.clientRectDeltaLeft,r.clientRectScale)}}var Fo;(function(n){n.DARK="dark",n.LIGHT="light",n.HIGH_CONTRAST_DARK="hcDark",n.HIGH_CONTRAST_LIGHT="hcLight"})(Fo||(Fo={}));function sc(n){return n===Fo.HIGH_CONTRAST_DARK||n===Fo.HIGH_CONTRAST_LIGHT}function $D(n){return n===Fo.DARK||n===Fo.HIGH_CONTRAST_DARK}const C1e=function(){return lp?!0:!(Xn||vr||pc)}();let bp=!0;class P7{constructor(e,t){this.themeType=t;const i=e.options,s=i.get(50);i.get(38)==="off"?this.renderWhitespace=i.get(98):this.renderWhitespace="none",this.renderControlCharacters=i.get(93),this.spaceWidth=s.spaceWidth,this.middotWidth=s.middotWidth,this.wsmiddotWidth=s.wsmiddotWidth,this.useMonospaceOptimizations=s.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=s.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(66),this.stopRenderingLineAfter=i.get(116),this.fontLigatures=i.get(51)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class Ea{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=bt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return sc(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,s){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const o=i.getViewLineRenderingData(e),r=this._options,a=lr.filter(o.inlineDecorations,e,o.minColumn,o.maxColumn);let l=null;if(sc(r.themeType)||this._options.renderWhitespace==="selection"){const h=i.selections;for(const f of h){if(f.endLineNumber<e||f.startLineNumber>e)continue;const g=f.startLineNumber===e?f.startColumn:o.minColumn,p=f.endLineNumber===e?f.endColumn:o.maxColumn;g<p&&(sc(r.themeType)&&a.push(new lr(g,p,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(l||(l=[]),l.push(new tq(g-1,p-1))))}}const c=new i0(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,o.minColumn-1,o.tokens,a,o.tabSize,o.startVisibleColumn,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==No.OFF,l);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;s.appendString('<div style="top:'),s.appendString(String(t)),s.appendString("px;height:"),s.appendString(String(this._options.lineHeight)),s.appendString('px;" class="'),s.appendString(Ea.CLASS_NAME),s.appendString('">');const d=SP(c,s);s.appendString("</div>");let u=null;return bp&&C1e&&o.isBasicASCII&&r.useMonospaceOptimizations&&d.containsForeignElements===0&&(u=new hw(this._renderedViewLine?this._renderedViewLine.domNode:null,c,d.characterMapping)),u||(u=yq(this._renderedViewLine?this._renderedViewLine.domNode:null,c,d.characterMapping,d.containsRTL,d.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof hw:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof hw?this._renderedViewLine.monospaceAssumptionsAreValid():bp}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof hw&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,s){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const o=this._renderedViewLine.input.stopRenderingLineAfter;if(o!==-1&&t>o+1&&i>o+1)return new M7(!0,[new qh(this.getWidth(s),0)]);o!==-1&&t>o+1&&(t=o+1),o!==-1&&i>o+1&&(i=o+1);const r=this._renderedViewLine.getVisibleRangesForRange(e,t,i,s);return r&&r.length>0?new M7(!1,r):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}}Ea.CLASS_NAME="view-line";class hw{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const s=Math.floor(t.lineContent.length/300);if(s>0){this._keyColumnPixelOffsetCache=new Float32Array(s);for(let o=0;o<s;o++)this._keyColumnPixelOffsetCache[o]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return bp;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),bp=!1)}return bp}toSlowRenderedLine(){return yq(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,s){const o=this._getColumnPixelOffset(e,t,s),r=this._getColumnPixelOffset(e,i,s);return[new qh(o,r-o)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const s=Math.floor((t-1)/300)-1,o=(s+1)*300+1;let r=-1;if(this._keyColumnPixelOffsetCache&&(r=this._keyColumnPixelOffsetCache[s],r===-1&&(r=this._actualReadPixelOffset(e,o,i),this._keyColumnPixelOffsetCache[s]=r)),r===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(o),l=this._characterMapping.getHorizontalOffset(t);return r+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const s=this._characterMapping.getDomPosition(t),o=RC.readHorizontalRanges(this._getReadingTarget(this.domNode),s.partIndex,s.charIndex,s.partIndex,s.charIndex,i);return!o||o.length===0?-1:o[0].left}getColumnOfNodeOffset(e,t){return wq(this._characterMapping,e,t)}}class vq{constructor(e,t,i,s,o){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!s||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let r=0,a=this._characterMapping.length;r<=a;r++)this._pixelOffsetCache[r]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e==null||e.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,s){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const o=this._readPixelOffset(this.domNode,e,t,s);if(o===-1)return null;const r=this._readPixelOffset(this.domNode,e,i,s);return r===-1?null:[new qh(o,r-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,s)}_readVisibleRangesForRange(e,t,i,s,o){if(i===s){const r=this._readPixelOffset(e,t,i,o);return r===-1?null:[new qh(r,0)]}else return this._readRawVisibleRangesForRange(e,i,s,o)}_readPixelOffset(e,t,i,s){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(s);const o=this._getReadingTarget(e);return o.firstChild?(s.markDidDomLayout(),o.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const o=this._pixelOffsetCache[i];if(o!==-1)return o;const r=this._actualReadPixelOffset(e,t,i,s);return this._pixelOffsetCache[i]=r,r}return this._actualReadPixelOffset(e,t,i,s)}_actualReadPixelOffset(e,t,i,s){if(this._characterMapping.length===0){const l=RC.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,s);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(s);const o=this._characterMapping.getDomPosition(i),r=RC.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,s);if(!r||r.length===0)return-1;const a=r[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,s){if(t===1&&i===this._characterMapping.length)return[new qh(0,this.getWidth(s))];const o=this._characterMapping.getDomPosition(t),r=this._characterMapping.getDomPosition(i);return RC.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,r.partIndex,r.charIndex,s)}getColumnOfNodeOffset(e,t){return wq(this._characterMapping,e,t)}}class S1e extends vq{_readVisibleRangesForRange(e,t,i,s,o){const r=super._readVisibleRangesForRange(e,t,i,s,o);if(!r||r.length===0||i===s||i===1&&s===this._characterMapping.length)return r;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,s,o);if(a!==-1){const l=r[r.length-1];l.left<a&&(l.width=a-l.left)}}return r}}const yq=function(){return Hh?x1e:L1e}();function x1e(n,e,t,i,s){return new S1e(n,e,t,i,s)}function L1e(n,e,t,i,s){return new vq(n,e,t,i,s)}function wq(n,e,t){const i=e.textContent.length;let s=-1;for(;e;)e=e.previousSibling,s++;return n.getColumn(new iq(s,t),i)}class qi{static _nextVisibleColumn(e,t,i){return e===9?qi.nextRenderTabStop(t,i):Jd(e)||nP(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const s=Math.min(t-1,e.length),o=e.substring(0,s),r=new VS(o);let a=0;for(;!r.eol();){const l=WS(o,s,r.offset);r.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const s=e.length,o=new VS(e);let r=0,a=1;for(;!o.eol();){const l=WS(e,s,o.offset);o.nextGraphemeLength();const c=this._nextVisibleColumn(l,r,i),d=o.offset+1;if(c>=t){const u=t-r;return c-t<u?d:a}r=c,a=d}return s+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}class nv{static whitespaceVisibleColumn(e,t,i){const s=e.length;let o=0,r=-1,a=-1;for(let l=0;l<s;l++){if(l===t)return[r,a,o];switch(o%i===0&&(r=l,a=o),e.charCodeAt(l)){case 32:o+=1;break;case 9:o=qi.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return t===s?[r,a,o]:[-1,-1,-1]}static atomicPosition(e,t,i,s){const o=e.length,[r,a,l]=nv.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(s){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(r===-1)return-1;let h=a;for(let f=r;f<o;++f){if(h===a+i)return r;switch(e.charCodeAt(f)){case 32:h+=1;break;case 9:h=qi.nextRenderTabStop(h,i);break;default:return-1}}return h===a+i?r:-1}const d=qi.nextRenderTabStop(l,i);let u=l;for(let h=t;h<o;h++){if(u===d)return h;switch(e.charCodeAt(h)){case 32:u+=1;break;case 9:u=qi.nextRenderTabStop(u,i);break;default:return-1}}return u===d?o:-1}}class Bc{constructor(e=null){this.hitTarget=e,this.type=0}}class Cq{constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var rh;(function(n){function e(t,i,s){const o=t.getPositionFromDOMInfo(i,s);return o?new Cq(o,i,null):new Bc(i)}n.createFromDOMInfo=e})(rh||(rh={}));class D1e{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class Gn{static _deduceRage(e,t=null){return!t&&e?new N(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,s,o,r){return{type:e,element:t,mouseColumn:i,position:s,range:o,detail:r}}static createViewZone(e,t,i,s,o){return{type:e,element:t,mouseColumn:i,position:s,range:this._deduceRage(s),detail:o}}static createContentText(e,t,i,s,o){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,s),detail:o}}static createContentEmpty(e,t,i,s){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:s}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,s){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:s}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class lo{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===6}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===7}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===7}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===5}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===8}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}}class Lm{constructor(e,t,i){this.viewModel=e.viewModel;const s=e.configuration.options;this.layoutInfo=s.get(143),this.viewDomNode=t.viewDomNode,this.lineHeight=s.get(66),this.stickyTabStops=s.get(115),this.typicalHalfwidthCharacterWidth=s.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return Lm.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const s=i.verticalOffset+i.height/2,o=e.viewModel.getLineCount();let r=null,a,l=null;return i.afterLineNumber!==o&&(l=new V(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(r=new V(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=r:r===null?a=l:t<s?a=r:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:r,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const s=this._context.viewModel.getLineCount(),o=this._context.viewModel.getLineMaxColumn(s);return{range:new N(s,o,s,o),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new N(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return Lm._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class k1e{constructor(e,t,i,s){this.editorPos=t,this.pos=i,this.relativePos=s,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,vn._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class MP extends k1e{constructor(e,t,i,s,o){super(e,t,i,s),this._ctx=e,o?(this.target=o,this.targetPath=Ja.collect(o,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?qi.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Gn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Gn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,s){return Gn.createMargin(e,this.target,this._getMouseColumn(t),t,i,s)}fulfillViewZone(e,t,i){return Gn.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return Gn.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return Gn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Gn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Gn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Gn.createOverlayWidget(this.target,this._getMouseColumn(),e)}withTarget(e){return new MP(this._ctx,this.editorPos,this.pos,this.relativePos,e)}}const O7={isAfterLines:!0};function K2(n){return{isAfterLines:!1,horizontalDistanceToText:n}}class vn{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=Ja.collect(t,this._viewHelper.viewDomNode);return!!(lo.isChildOfContentWidgets(i)||lo.isChildOfOverflowingContentWidgets(i)||lo.isChildOfOverlayWidgets(i))}createMouseTarget(e,t,i,s,o){const r=new Lm(this._context,this._viewHelper,e),a=new MP(r,t,i,s,o);try{const l=vn._createMouseTarget(r,a,!1);if(l.type===6&&r.stickyTabStops&&l.position!==null){const c=vn._snapToSoftTabBoundary(l.position,r.viewModel),d=N.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,d,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t,i){if(t.target===null){if(i)return t.fulfillUnknown();const r=vn._doHitTest(e,t);return r.type===1?vn.createMouseTargetFromHitTestPosition(e,t,r.spanNode,r.position,r.injectedText):this._createMouseTarget(e,t.withTarget(r.hitTarget),!0)}const s=t;let o=null;return!lo.isChildOfOverflowGuard(t.targetPath)&&!lo.isChildOfOverflowingContentWidgets(t.targetPath)&&(o=o||t.fulfillUnknown()),o=o||vn._hitTestContentWidget(e,s),o=o||vn._hitTestOverlayWidget(e,s),o=o||vn._hitTestMinimap(e,s),o=o||vn._hitTestScrollbarSlider(e,s),o=o||vn._hitTestViewZone(e,s),o=o||vn._hitTestMargin(e,s),o=o||vn._hitTestViewCursor(e,s),o=o||vn._hitTestTextArea(e,s),o=o||vn._hitTestViewLines(e,s,i),o=o||vn._hitTestScrollbar(e,s),o||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(lo.isChildOfContentWidgets(t.targetPath)||lo.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(lo.isChildOfOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const s of i)if(t.target===s.domNode)return t.fulfillContentText(s.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,s=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(const r of i){if(s<r.contentLeft||s>r.contentLeft+r.width)continue;const a=e.getVerticalOffsetForLineNumber(r.position.lineNumber);if(a<=o&&o<=a+r.height)return t.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const s=t.isInContentArea?8:5;return t.fulfillViewZone(s,i.position,i)}return null}static _hitTestTextArea(e,t){return lo.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),s=i.range.getStartPosition();let o=Math.abs(t.relativePos.x);const r={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};return o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth?t.fulfillMargin(2,s,i.range,r):(o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,s,i.range,r):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,s,i.range,r)))}return null}static _hitTestViewLines(e,t,i){if(!lo.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new V(1,1),O7);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const o=e.viewModel.getLineCount(),r=e.viewModel.getLineMaxColumn(o);return t.fulfillContentEmpty(new V(o,r),O7)}if(i){if(lo.isStrictChildOfViewLines(t.targetPath)){const o=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(o)===0){const a=e.getLineWidth(o),l=K2(t.mouseContentHorizontalOffset-a);return t.fulfillContentEmpty(new V(o,1),l)}const r=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>=r){const a=K2(t.mouseContentHorizontalOffset-r),l=new V(o,e.viewModel.getLineMaxColumn(o));return t.fulfillContentEmpty(l,a)}}return t.fulfillUnknown()}const s=vn._doHitTest(e,t);return s.type===1?vn.createMouseTargetFromHitTestPosition(e,t,s.spanNode,s.position,s.injectedText):this._createMouseTarget(e,t.withTarget(s.hitTarget),!0)}static _hitTestMinimap(e,t){if(lo.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new V(i,s))}return null}static _hitTestScrollbarSlider(e,t){if(lo.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const s=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),o=e.viewModel.getLineMaxColumn(s);return t.fulfillScrollbar(new V(s,o))}}return null}static _hitTestScrollbar(e,t){if(lo.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new V(i,s))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(143),s=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return vn._getMouseColumn(s,t.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,s,o){const r=s.lineNumber,a=s.column,l=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>l){const v=K2(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(s,v)}const c=e.visibleRangeForPosition(r,a);if(!c)return t.fulfillUnknown(s);const d=c.left;if(Math.abs(t.mouseContentHorizontalOffset-d)<1)return t.fulfillContentText(s,null,{mightBeForeignElement:!!o,injectedText:o});const u=[];if(u.push({offset:c.left,column:a}),a>1){const v=e.visibleRangeForPosition(r,a-1);v&&u.push({offset:v.left,column:a-1})}const h=e.viewModel.getLineMaxColumn(r);if(a<h){const v=e.visibleRangeForPosition(r,a+1);v&&u.push({offset:v.left,column:a+1})}u.sort((v,b)=>v.offset-b.offset);const f=t.pos.toClientCoordinates(),g=i.getBoundingClientRect(),p=g.left<=f.clientX&&f.clientX<=g.right;let _=null;for(let v=1;v<u.length;v++){const b=u[v-1],y=u[v];if(b.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=y.offset){_=new N(r,b.column,r,y.column);const w=Math.abs(b.offset-t.mouseContentHorizontalOffset),C=Math.abs(y.offset-t.mouseContentHorizontalOffset);s=w<C?new V(r,b.column):new V(r,y.column);break}}return t.fulfillContentText(s,_,{mightBeForeignElement:!p||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.getVerticalOffsetForLineNumber(i),o=s+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>o)){const a=Math.floor((s+o)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new zD(t.pos.x,l),d=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates());if(d.type===1)return d}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=_m(e.viewDomNode);let s;if(i?typeof i.caretRangeFromPoint>"u"?s=E1e(i,t.clientX,t.clientY):s=i.caretRangeFromPoint(t.clientX,t.clientY):s=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!s||!s.startContainer)return new Bc;const o=s.startContainer;if(o.nodeType===o.TEXT_NODE){const r=o.parentNode,a=r?r.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Ea.CLASS_NAME?rh.createFromDOMInfo(e,r,s.startOffset):new Bc(o.parentNode)}else if(o.nodeType===o.ELEMENT_NODE){const r=o.parentNode,a=r?r.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Ea.CLASS_NAME?rh.createFromDOMInfo(e,o,o.textContent.length):new Bc(o)}return new Bc}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const s=i.offsetNode.parentNode,o=s?s.parentNode:null,r=o?o.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===Ea.CLASS_NAME?rh.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new Bc(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const s=i.offsetNode.parentNode,o=s&&s.nodeType===s.ELEMENT_NODE?s.className:null,r=s?s.parentNode:null,a=r&&r.nodeType===r.ELEMENT_NODE?r.className:null;if(o===Ea.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return rh.createFromDOMInfo(e,l,0)}else if(a===Ea.CLASS_NAME)return rh.createFromDOMInfo(e,i.offsetNode,0)}return new Bc(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:s}=t.model.getOptions(),o=nv.atomicPosition(i,e.column-1,s,2);return o!==-1?new V(e.lineNumber,o+1):e}static _doHitTest(e,t){let i=new Bc;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates())),i.type===1){const s=e.viewModel.getInjectedTextAt(i.position),o=e.viewModel.normalizePosition(i.position,2);(s||!o.equals(i.position))&&(i=new Cq(o,i.spanNode,s))}return i}}function E1e(n,e,t){const i=document.createRange();let s=n.elementFromPoint(e,t);if(s!==null){for(;s&&s.firstChild&&s.firstChild.nodeType!==s.firstChild.TEXT_NODE&&s.lastChild&&s.lastChild.firstChild;)s=s.lastChild;const o=s.getBoundingClientRect(),r=window.getComputedStyle(s,null).getPropertyValue("font-style"),a=window.getComputedStyle(s,null).getPropertyValue("font-variant"),l=window.getComputedStyle(s,null).getPropertyValue("font-weight"),c=window.getComputedStyle(s,null).getPropertyValue("font-size"),d=window.getComputedStyle(s,null).getPropertyValue("line-height"),u=window.getComputedStyle(s,null).getPropertyValue("font-family"),h=`${r} ${a} ${l} ${c}/${d} ${u}`,f=s.innerText;let g=o.left,p=0,_;if(e>o.left+o.width)p=f.length;else{const v=Sh.getInstance();for(let b=0;b<f.length+1;b++){if(_=v.getCharWidth(f.charAt(b),h)/2,g+=_,e<g){p=b;break}g+=_}}i.setStart(s.firstChild,p),i.setEnd(s.firstChild,p)}return i}class Sh{static getInstance(){return Sh._INSTANCE||(Sh._INSTANCE=new Sh),Sh._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const s=this._canvas.getContext("2d");s.font=t;const r=s.measureText(e).width;return this._cache[i]=r,r}}Sh._INSTANCE=null;let la=class extends Y{onclick(e,t){this._register(K(e,de.CLICK,i=>t(new ar(i))))}onmousedown(e,t){this._register(K(e,de.MOUSE_DOWN,i=>t(new ar(i))))}onmouseover(e,t){this._register(K(e,de.MOUSE_OVER,i=>t(new ar(i))))}onmouseleave(e,t){this._register(K(e,de.MOUSE_LEAVE,i=>t(new ar(i))))}onkeydown(e,t){this._register(K(e,de.KEY_DOWN,i=>t(new zt(i))))}onkeyup(e,t){this._register(K(e,de.KEY_UP,i=>t(new zt(i))))}oninput(e,t){this._register(K(e,de.INPUT,t))}onblur(e,t){this._register(K(e,de.BLUR,t))}onfocus(e,t){this._register(K(e,de.FOCUS,t))}ignoreGesture(e){return Rt.ignoreTarget(e)}};const Dm=11;class A1e extends la{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...Ne.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=Dm+"px",this.domNode.style.height=Dm+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new BD),this._register(Hi(this.bgDomNode,de.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(Hi(this.domNode,de.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new sy),this._pointerdownScheduleRepeatTimer=this._register(new Cc)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24)};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class I1e extends Y{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Cc)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{var e;(e=this._domNode)===null||e===void 0||e.setClassName(this._visibleClassName)},0))}_hide(e){var t;this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,(t=this._domNode)===null||t===void 0||t.setClassName(this._invisibleClassName+(e?" fade":"")))}}const T1e=140;class Sq extends la{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new I1e(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new BD),this._shouldRender=!0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(K(this.domNode.domNode,de.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new A1e(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,s){this.slider=bt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof s=="number"&&this.slider.setHeight(s),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(K(this.slider.domNode,de.POINTER_DOWN,o=>{o.button===0&&(o.preventDefault(),this._sliderPointerDown(o))})),this.onclick(this.slider.domNode,o=>{o.leftButton&&o.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),s=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderPointerPosition(e);i<=o&&o<=s?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const o=Nn(this.domNode.domNode);t=e.pageX-o.left,i=e.pageY-o.top}const s=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(s):this._scrollbarState.getDesiredScrollPositionFromOffset(s)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),s=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,o=>{const r=this._sliderOrthogonalPointerPosition(o),a=Math.abs(r-i);if(Ps&&a>T1e){this._setDesiredScrollPositionNow(s.getScrollPosition());return}const c=this._sliderPointerPosition(o)-t;this._setDesiredScrollPositionNow(s.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const N1e=20;class km{constructor(e,t,i,s,o,r){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=s,this._scrollSize=o,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new km(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,s,o){const r=Math.max(0,i-e),a=Math.max(0,r-2*t),l=s>0&&s>i;if(!l)return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(N1e,Math.floor(i*a/s))),d=(a-c)/(s-i),u=o*d;return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:d,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){const e=km._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class R1e extends Sq{constructor(e,t,i){const s=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new km(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,s.width,s.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const r=(t.arrowSize-Dm)/2,a=(t.horizontalScrollbarSize-Dm)/2;this._createArrow({className:"scra",icon:se.scrollbarButtonLeft,top:a,left:r,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new gf(null,1,0))}),this._createArrow({className:"scra",icon:se.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:r,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new gf(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class M1e extends Sq{constructor(e,t,i){const s=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new km(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,s.height,s.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const r=(t.arrowSize-Dm)/2,a=(t.verticalScrollbarSize-Dm)/2;this._createArrow({className:"scra",icon:se.scrollbarButtonUp,top:r,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new gf(null,0,1))}),this._createArrow({className:"scra",icon:se.scrollbarButtonDown,top:void 0,left:a,bottom:r,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new gf(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class tx{constructor(e,t,i,s,o,r,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,s=s|0,o=o|0,r=r|0,a=a|0),this.rawScrollLeft=s,this.rawScrollTop=a,t<0&&(t=0),s+t>i&&(s=i-t),s<0&&(s=0),o<0&&(o=0),a+o>r&&(a=r-o),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=s,this.height=o,this.scrollHeight=r,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new tx(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new tx(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,s=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,r=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:s,scrollLeftChanged:o,heightChanged:r,scrollHeightChanged:a,scrollTopChanged:l}}}class cy extends Y{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new B),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new tx(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){var i;const s=this._state.withScrollDimensions(e,t);this._setState(s,!!this._smoothScrolling),(i=this._smoothScrolling)===null||i===void 0||i.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let s;t?s=new sv(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):s=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=s}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=sv.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class F7{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function Y2(n,e){const t=e-n;return function(i){return n+t*F1e(i)}}function P1e(n,e,t){return function(i){return i<t?n(i/t):e((i-t)/(1-t))}}class sv{constructor(e,t,i,s){this.from=e,this.to=t,this.duration=s,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let o,r;return e<t?(o=e+.75*i,r=t-.75*i):(o=e-.75*i,r=t+.75*i),P1e(Y2(e,o),Y2(r,t),.33)}return Y2(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),s=this.scrollTop(t);return new F7(i,s,!1)}return new F7(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return sv.start(e,t,i)}static start(e,t,i){i=i+10;const s=Date.now()-10;return new sv(e,t,s,i)}}function O1e(n){return Math.pow(n,3)}function F1e(n){return 1-O1e(1-n)}const B1e=500,B7=50;class W1e{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class ix{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,s=this._rear;do{const o=s===this._front?e:Math.pow(2,-i);if(e-=o,t+=this._memory[s].score*o,s===this._front)break;s=(this._capacity+s-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){const t=window.devicePixelRatio/rpe();Ps||Xn?this.accept(Date.now(),e.deltaX/t,e.deltaY/t):this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){const s=new W1e(e,t,i);s.score=this._computeScore(s),this._front===-1&&this._rear===-1?(this._memory[0]=s,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=s)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let t=.5;return this._front===-1&&this._rear===-1||this._memory[this._rear],(!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(t+=.25),Math.min(Math.max(t,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}ix.INSTANCE=new ix;class PP extends la{get options(){return this._options}constructor(e,t,i){super(),this._onScroll=this._register(new B),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new B),e.style.overflow="hidden",this._options=V1e(t),this._scrollable=i,this._register(this._scrollable.onScroll(o=>{this._onWillScroll.fire(o),this._onDidScroll(o),this._onScroll.fire(o)}));const s={onMouseWheel:o=>this._onMouseWheel(o),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new M1e(this._scrollable,this._options,s)),this._horizontalScrollbar=this._register(new R1e(this._scrollable,this._options,s)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=bt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=bt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=bt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,o=>this._onMouseOver(o)),this.onmouseleave(this._listenOnDomNode,o=>this._onMouseLeave(o)),this._hideTimeout=this._register(new Cc),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Ft(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,pt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new gf(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Ft(this._mouseWheelToDispose),e)){const i=s=>{this._onMouseWheel(new gf(s))};this._mouseWheelToDispose.push(K(this._listenOnDomNode,de.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){var t;if(!((t=e.browserEvent)===null||t===void 0)&&t.defaultPrevented)return;const i=ix.INSTANCE;i.acceptStandardWheelEvent(e);let s=!1;if(e.deltaY||e.deltaX){let r=e.deltaY*this._options.mouseWheelScrollSensitivity,a=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&a+r===0?a=r=0:Math.abs(r)>=Math.abs(a)?a=0:r=0),this._options.flipAxes&&([r,a]=[a,r]);const l=!pt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||l)&&!a&&(a=r,r=0),e.browserEvent&&e.browserEvent.altKey&&(a=a*this._options.fastScrollSensitivity,r=r*this._options.fastScrollSensitivity);const c=this._scrollable.getFutureScrollPosition();let d={};if(r){const u=B7*r,h=c.scrollTop-(u<0?Math.floor(u):Math.ceil(u));this._verticalScrollbar.writeScrollPosition(d,h)}if(a){const u=B7*a,h=c.scrollLeft-(u<0?Math.floor(u):Math.ceil(u));this._horizontalScrollbar.writeScrollPosition(d,h)}d=this._scrollable.validateScrollPosition(d),(c.scrollLeft!==d.scrollLeft||c.scrollTop!==d.scrollTop)&&(this._options.mouseWheelSmoothScroll&&i.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(d):this._scrollable.setScrollPositionNow(d),s=!0)}let o=s;!o&&this._options.alwaysConsumeMouseWheel&&(o=!0),!o&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(o=!0),o&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,s=i?" left":"",o=t?" top":"",r=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${s}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${o}${s}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),B1e)}}class xq extends PP{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new cy({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:s=>Uo(s)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class OP extends PP{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class FP extends PP{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new cy({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:s=>Uo(s)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(s=>{s.scrollTopChanged&&(this._element.scrollTop=s.scrollTop),s.scrollLeftChanged&&(this._element.scrollLeft=s.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function V1e(n){const e={lazyRender:typeof n.lazyRender<"u"?n.lazyRender:!1,className:typeof n.className<"u"?n.className:"",useShadows:typeof n.useShadows<"u"?n.useShadows:!0,handleMouseWheel:typeof n.handleMouseWheel<"u"?n.handleMouseWheel:!0,flipAxes:typeof n.flipAxes<"u"?n.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof n.consumeMouseWheelIfScrollbarIsNeeded<"u"?n.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof n.alwaysConsumeMouseWheel<"u"?n.alwaysConsumeMouseWheel:!1,scrollYToX:typeof n.scrollYToX<"u"?n.scrollYToX:!1,mouseWheelScrollSensitivity:typeof n.mouseWheelScrollSensitivity<"u"?n.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof n.fastScrollSensitivity<"u"?n.fastScrollSensitivity:5,scrollPredominantAxis:typeof n.scrollPredominantAxis<"u"?n.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof n.mouseWheelSmoothScroll<"u"?n.mouseWheelSmoothScroll:!0,arrowSize:typeof n.arrowSize<"u"?n.arrowSize:11,listenOnDomNode:typeof n.listenOnDomNode<"u"?n.listenOnDomNode:null,horizontal:typeof n.horizontal<"u"?n.horizontal:1,horizontalScrollbarSize:typeof n.horizontalScrollbarSize<"u"?n.horizontalScrollbarSize:10,horizontalSliderSize:typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:0,horizontalHasArrows:typeof n.horizontalHasArrows<"u"?n.horizontalHasArrows:!1,vertical:typeof n.vertical<"u"?n.vertical:1,verticalScrollbarSize:typeof n.verticalScrollbarSize<"u"?n.verticalScrollbarSize:10,verticalHasArrows:typeof n.verticalHasArrows<"u"?n.verticalHasArrows:!1,verticalSliderSize:typeof n.verticalSliderSize<"u"?n.verticalSliderSize:0,scrollByPage:typeof n.scrollByPage<"u"?n.scrollByPage:!1};return e.horizontalSliderSize=typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof n.verticalSliderSize<"u"?n.verticalSliderSize:e.verticalScrollbarSize,pt&&(e.className+=" mac"),e}class BP extends ly{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new vn(this._context,i),this._mouseDownOperation=this._register(new z1e(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(r,a)=>this._createMouseTarget(r,a),r=>this._getMouseColumn(r))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(143).height;const s=new p1e(this.viewHelper.viewDomNode);this._register(s.onContextMenu(this.viewHelper.viewDomNode,r=>this._onContextMenu(r,!0))),this._register(s.onMouseMove(this.viewHelper.viewDomNode,r=>{this._onMouseMove(r),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=K(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new su(a,!1,this.viewHelper.viewDomNode))}))})),this._register(s.onMouseUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(s.onMouseLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r)));let o=0;this._register(s.onPointerDown(this.viewHelper.viewDomNode,(r,a)=>{o=a})),this._register(K(this.viewHelper.viewDomNode,de.POINTER_UP,r=>{this._mouseDownOperation.onPointerUp()})),this._register(s.onMouseDown(this.viewHelper.viewDomNode,r=>this._onMouseDown(r,o))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=ix.INSTANCE;let t=0,i=Gc.getZoomLevel(),s=!1,o=0;const r=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(75))return;const c=new gf(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const d=Gc.getZoomLevel(),u=c.deltaY>0?1:-1;Gc.setZoomLevel(d+u),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=Gc.getZoomLevel(),s=a(l),o=0),t=Date.now(),o+=c.deltaY,s&&(Gc.setZoomLevel(i+o/5),c.preventDefault(),c.stopPropagation())};this._register(K(this.viewHelper.viewDomNode,de.MOUSE_WHEEL,r,{capture:!0,passive:!1}));function a(l){return pt?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(143)){const t=this._context.configuration.options.get(143).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const s=new bq(e,t).toPageCoordinates(),o=NP(this.viewHelper.viewDomNode);if(s.y<o.y||s.y>o.y+o.height||s.x<o.x||s.x>o.x+o.width)return null;const r=RP(this.viewHelper.viewDomNode,o,s);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),o,s,r,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const s=_m(this.viewHelper.viewDomNode);s&&(i=s.elementsFromPoint(e.posx,e.posy).find(o=>this.viewHelper.viewDomNode.contains(o)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),s=i.type===6||i.type===7,o=i.type===2||i.type===3||i.type===4,r=i.type===3,a=this._context.configuration.options.get(108),l=i.type===8||i.type===5,c=i.type===9;let d=e.leftButton||e.middleButton;pt&&e.leftButton&&e.ctrlKey&&(d=!1);const u=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(d&&(s||r&&a))u(),this._mouseDownOperation.start(i.type,e,t);else if(o)e.preventDefault();else if(l){const h=i.detail;d&&this.viewHelper.shouldSuppressMouseDownOnViewZone(h.viewZoneId)&&(u(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(u(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class z1e extends Y{constructor(e,t,i,s,o,r){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=s,this._createMouseTarget=o,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new _1e(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new H1e(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new UD,this._currentSelection=new lt(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13&&(t.outsidePosition==="above"||t.outsidePosition==="below")?this._topBottomDragScrolling.start(t,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const s=this._findMousePosition(t,!0);if(!s||!s.position)return;this._mouseState.trySetCount(t.detail,s.position),t.detail=this._mouseState.count;const o=this._context.configuration.options;if(!o.get(90)&&o.get(35)&&!o.get(22)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&s.type===6&&s.position&&this._currentSelection.containsPosition(s.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),r=>{const a=this._findMousePosition(this._lastMouseEvent,!1);r&&r instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(s,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,s=this._context.viewLayout,o=this._getMouseColumn(e);if(e.posy<t.y){const a=t.y-e.posy,l=Math.max(s.getCurrentScrollTop()-a,0),c=Lm.getZoneAtCoord(this._context,l);if(c){const u=this._helpPositionJumpOverViewZone(c);if(u)return Gn.createOutsideEditor(o,u,"above",a)}const d=s.getLineNumberAtVerticalOffset(l);return Gn.createOutsideEditor(o,new V(d,1),"above",a)}if(e.posy>t.y+t.height){const a=e.posy-t.y-t.height,l=s.getCurrentScrollTop()+e.relativePos.y,c=Lm.getZoneAtCoord(this._context,l);if(c){const u=this._helpPositionJumpOverViewZone(c);if(u)return Gn.createOutsideEditor(o,u,"below",a)}const d=s.getLineNumberAtVerticalOffset(l);return Gn.createOutsideEditor(o,new V(d,i.getLineMaxColumn(d)),"below",a)}const r=s.getLineNumberAtVerticalOffset(s.getCurrentScrollTop()+e.relativePos.y);if(e.posx<t.x){const a=t.x-e.posx;return Gn.createOutsideEditor(o,new V(r,1),"left",a)}if(e.posx>t.x+t.width){const a=e.posx-t.x-t.width;return Gn.createOutsideEditor(o,new V(r,i.getLineMaxColumn(r)),"right",a)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const s=this._createMouseTarget(e,t);if(!s.position)return null;if(s.type===8||s.type===5){const r=this._helpPositionJumpOverViewZone(s.detail);if(r)return Gn.createViewZone(s.type,s.element,s.mouseColumn,r,s.detail)}return s}_helpPositionJumpOverViewZone(e){const t=new V(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,s=e.positionAfter;return i&&s?i.isBefore(t)?i:s:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}class H1e extends Y{constructor(e,t,i,s){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=s,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=new $1e(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class $1e extends Y{constructor(e,t,i,s,o,r){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=s,this._position=o,this._mouseEvent=r,this._lastTime=Date.now(),this._animationFrameDisposable=Uo(()=>this._execute())}dispose(){this._animationFrameDisposable.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}_getScrollSpeed(){const e=this._context.configuration.options.get(66),t=this._context.configuration.options.get(143).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(66),t=this._getScrollSpeed(),i=this._tick(),s=t*(i/1e3)*e,o=this._position.outsidePosition==="above"?-s:s;this._context.viewModel.viewLayout.deltaScrollNow(0,o),this._viewHelper.renderNow();const r=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?r.startLineNumber:r.endLineNumber;let l;{const c=NP(this._viewHelper.viewDomNode),d=this._context.configuration.options.get(143).horizontalScrollbarHeight,u=new zD(this._mouseEvent.pos.x,c.y+c.height-d-.1),h=RP(this._viewHelper.viewDomNode,c,u);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,u,h,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=Gn.createOutsideEditor(this._position.mouseColumn,new V(a,1),"above",this._position.outsideDistance):l=Gn.createOutsideEditor(this._position.mouseColumn,new V(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=Uo(()=>this._execute())}}class UD{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>UD.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}UD.CLEAR_MOUSE_DOWN_COUNT_TIME=400;class rt{get event(){return this.emitter.event}constructor(e,t,i){const s=o=>this.emitter.fire(o);this.emitter=new B({onWillAddFirstListener:()=>e.addEventListener(t,s,i),onDidRemoveLastListener:()=>e.removeEventListener(t,s,i)})}dispose(){this.emitter.dispose()}}var hd;(function(n){const e={total:0,min:Number.MAX_VALUE,max:0},t=Object.assign({},e),i=Object.assign({},e),s=Object.assign({},e);let o=0;const r={keydown:0,input:0,render:0};function a(){v(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),r.keydown=1,queueMicrotask(l)}n.onKeyDown=a;function l(){r.keydown===1&&(performance.mark("keydown/end"),r.keydown=2)}function c(){performance.mark("input/start"),r.input=1,_()}n.onBeforeInput=c;function d(){r.input===0&&c(),queueMicrotask(u)}n.onInput=d;function u(){r.input===1&&(performance.mark("input/end"),r.input=2)}function h(){v()}n.onKeyUp=h;function f(){v()}n.onSelectionChange=f;function g(){r.keydown===2&&r.input===2&&r.render===0&&(performance.mark("render/start"),r.render=1,queueMicrotask(p),_())}n.onRenderStart=g;function p(){r.render===1&&(performance.mark("render/end"),r.render=2)}function _(){setTimeout(v)}function v(){r.keydown===2&&r.input===2&&r.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),b("keydown",e),b("input",t),b("render",i),b("inputlatency",s),o++,y())}function b(x,D){const k=performance.getEntriesByName(x)[0].duration;D.total+=k,D.min=Math.min(D.min,k),D.max=Math.max(D.max,k)}function y(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),r.keydown=0,r.input=0,r.render=0}function w(){if(o===0)return;const x={keydown:C(e),input:C(t),render:C(i),total:C(s),sampleCount:o};return L(e),L(t),L(i),L(s),o=0,x}n.getAndClearMeasurements=w;function C(x){return{average:x.total/o,max:x.max,min:x.min}}function L(x){x.total=0,x.min=Number.MAX_VALUE,x.max=0}})(hd||(hd={}));class cn{constructor(e,t,i,s,o){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=s,this.newlineCountBeforeSelection=o}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),s=e.getSelectionStart(),o=e.getSelectionEnd();let r;if(t){const a=i.substring(0,s),l=t.value.substring(0,t.selectionStart);a===l&&(r=t.newlineCountBeforeSelection)}return new cn(i,s,o,null,r)}collapseSelection(){return this.selectionStart===this.value.length?this:new cn(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){var t,i,s,o,r,a,l,c;if(e<=this.selectionStart){const h=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition((i=(t=this.selection)===null||t===void 0?void 0:t.getStartPosition())!==null&&i!==void 0?i:null,h,-1)}if(e>=this.selectionEnd){const h=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition((o=(s=this.selection)===null||s===void 0?void 0:s.getEndPosition())!==null&&o!==void 0?o:null,h,1)}const d=this.value.substring(this.selectionStart,e);if(d.indexOf(String.fromCharCode(8230))===-1)return this._finishDeduceEditorPosition((a=(r=this.selection)===null||r===void 0?void 0:r.getStartPosition())!==null&&a!==void 0?a:null,d,1);const u=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition((c=(l=this.selection)===null||l===void 0?void 0:l.getEndPosition())!==null&&c!==void 0?c:null,u,-1)}_finishDeduceEditorPosition(e,t,i){let s=0,o=-1;for(;(o=t.indexOf(`
`,o+1))!==-1;)s++;return[e,i*t.length,s]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const s=Math.min(BS(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(pT(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(s,e.value.length-o);const r=t.value.substring(s,t.value.length-o),a=e.selectionStart-s,l=e.selectionEnd-s,c=t.selectionStart-s,d=t.selectionEnd-s;if(c===d){const h=e.selectionStart-s;return{text:r,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}const u=l-a;return{text:r,replacePrevCharCnt:u,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(BS(e.value,t.value),e.selectionEnd),s=Math.min(pT(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(i,e.value.length-s),r=t.value.substring(i,t.value.length-s);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:r,replacePrevCharCnt:a,replaceNextCharCnt:o.length-a,positionDelta:l-r.length}}}cn.EMPTY=new cn("",0,0,null,void 0);class qg{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,s=i+1,o=i+t;return new N(s,1,o+1,1)}static fromEditorSelection(e,t,i,s){const r=qg._getPageOfLine(t.startLineNumber,i),a=qg._getRangeForPage(r,i),l=qg._getPageOfLine(t.endLineNumber,i),c=qg._getRangeForPage(l,i);let d=a.intersectRanges(new N(1,1,t.startLineNumber,t.startColumn));if(s&&e.getValueLengthInRange(d,1)>500){const v=e.modifyPosition(d.getEndPosition(),-500);d=N.fromPositions(v,d.getEndPosition())}const u=e.getValueInRange(d,1),h=e.getLineCount(),f=e.getLineMaxColumn(h);let g=c.intersectRanges(new N(t.endLineNumber,t.endColumn,h,f));if(s&&e.getValueLengthInRange(g,1)>500){const v=e.modifyPosition(g.getStartPosition(),500);g=N.fromPositions(g.getStartPosition(),v)}const p=e.getValueInRange(g,1);let _;if(r===l||r+1===l)_=e.getValueInRange(t,1);else{const v=a.intersectRanges(t),b=c.intersectRanges(t);_=e.getValueInRange(v,1)+String.fromCharCode(8230)+e.getValueInRange(b,1)}return s&&_.length>2*500&&(_=_.substring(0,500)+String.fromCharCode(8230)+_.substring(_.length-500,_.length)),new cn(u+_+p,u.length,u.length+_.length,t,d.endLineNumber-d.startLineNumber)}}var nx;(function(n){n.Tap="-monaco-textarea-synthetic-tap"})(nx||(nx={}));class sx{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}sx.INSTANCE=new sx;class U1e{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}class j1e extends Y{get textAreaState(){return this._textAreaState}constructor(e,t,i,s){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=s,this._onFocus=this._register(new B),this.onFocus=this._onFocus.event,this._onBlur=this._register(new B),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new B),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new B),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new B),this.onCut=this._onCut.event,this._onPaste=this._register(new B),this.onPaste=this._onPaste.event,this._onType=this._register(new B),this.onType=this._onType.event,this._onCompositionStart=this._register(new B),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new B),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new B),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new B),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncTriggerCut=this._register(new Li(()=>this._onCut.fire(),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new Li(()=>this.writeScreenReaderContent("asyncFocusGain"),0)),this._textAreaState=cn.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._currentComposition=null;let o=null;this._register(this._textArea.onKeyDown(r=>{const a=new zt(r);(a.keyCode===114||this._currentComposition&&a.keyCode===1)&&a.stopPropagation(),a.equals(9)&&a.preventDefault(),o=a,this._onKeyDown.fire(a)})),this._register(this._textArea.onKeyUp(r=>{const a=new zt(r);this._onKeyUp.fire(a)})),this._register(this._textArea.onCompositionStart(r=>{const a=new U1e;if(this._currentComposition){this._currentComposition=a;return}if(this._currentComposition=a,this._OS===2&&o&&o.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===r.data&&(o.code==="ArrowRight"||o.code==="ArrowLeft")){a.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:r.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:r.data});return}this._onCompositionStart.fire({data:r.data})})),this._register(this._textArea.onCompositionUpdate(r=>{const a=this._currentComposition;if(!a)return;if(this._browser.isAndroid){const c=cn.readFromTextArea(this._textArea,this._textAreaState),d=cn.deduceAndroidCompositionInput(this._textAreaState,c);this._textAreaState=c,this._onType.fire(d),this._onCompositionUpdate.fire(r);return}const l=a.handleCompositionUpdate(r.data);this._textAreaState=cn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(l),this._onCompositionUpdate.fire(r)})),this._register(this._textArea.onCompositionEnd(r=>{const a=this._currentComposition;if(!a)return;if(this._currentComposition=null,this._browser.isAndroid){const c=cn.readFromTextArea(this._textArea,this._textAreaState),d=cn.deduceAndroidCompositionInput(this._textAreaState,c);this._textAreaState=c,this._onType.fire(d),this._onCompositionEnd.fire();return}const l=a.handleCompositionUpdate(r.data);this._textAreaState=cn.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(l),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(r=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const a=cn.readFromTextArea(this._textArea,this._textAreaState),l=cn.deduceInput(this._textAreaState,a,this._OS===2);l.replacePrevCharCnt===0&&l.text.length===1&&(tn(l.text.charCodeAt(0))||l.text.charCodeAt(0)===127)||(this._textAreaState=a,(l.text!==""||l.replacePrevCharCnt!==0||l.replaceNextCharCnt!==0||l.positionDelta!==0)&&this._onType.fire(l))})),this._register(this._textArea.onCut(r=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(r),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(r=>{this._ensureClipboardGetsEditorSelection(r)})),this._register(this._textArea.onPaste(r=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),r.preventDefault(),!r.clipboardData)return;let[a,l]=W7.getTextData(r.clipboardData);a&&(l=l||sx.INSTANCE.get(a),this._onPaste.fire({text:a,metadata:l}))})),this._register(this._textArea.onFocus(()=>{const r=this._hasFocus;this._setHasFocus(!0),this._browser.isSafari&&!r&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return K(this._textArea.ownerDocument,"selectionchange",t=>{if(hd.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),s=i-e;if(e=i,s<5)return;const o=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),o<100||!this._textAreaState.selection)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),d=this._host.deduceModelPosition(c[0],c[1],c[2]),u=this._textAreaState.deduceEditorPosition(l),h=this._host.deduceModelPosition(u[0],u[1],u[2]),f=new lt(d.lineNumber,d.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent())}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};sx.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,i),e.preventDefault(),e.clipboardData&&W7.setTextData(e.clipboardData,t.text,t.html,i)}}const W7={getTextData(n){const e=n.getData(Vl.text);let t=null;const i=n.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&n.files.length>0?[Array.prototype.slice.call(n.files,0).map(o=>o.name).join(`
`),null]:[e,t]},setTextData(n,e,t,i){n.setData(Vl.text,e),typeof t=="string"&&n.setData("text/html",t),n.setData("vscode-editor-data",JSON.stringify(i))}};class q1e extends Y{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this.onKeyDown=this._register(new rt(this._actual,"keydown")).event,this.onKeyUp=this._register(new rt(this._actual,"keyup")).event,this.onCompositionStart=this._register(new rt(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new rt(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new rt(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new rt(this._actual,"beforeinput")).event,this.onInput=this._register(new rt(this._actual,"input")).event,this.onCut=this._register(new rt(this._actual,"cut")).event,this.onCopy=this._register(new rt(this._actual,"copy")).event,this.onPaste=this._register(new rt(this._actual,"paste")).event,this.onFocus=this._register(new rt(this._actual,"focus")).event,this.onBlur=this._register(new rt(this._actual,"blur")).event,this._onSyntheticTap=this._register(new B),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>hd.onKeyDown())),this._register(this.onBeforeInput(()=>hd.onBeforeInput())),this._register(this.onInput(()=>hd.onInput())),this._register(this.onKeyUp(()=>hd.onKeyUp())),this._register(K(this._actual,nx.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=_m(this._actual);return e?e.activeElement===this._actual:uP(this._actual)?this._actual.ownerDocument.activeElement===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const s=this._actual;let o=null;const r=_m(s);r?o=r.activeElement:o=s.ownerDocument.activeElement;const a=o===s,l=s.selectionStart,c=s.selectionEnd;if(a&&l===t&&c===i){vr&&window.parent!==window&&s.focus();return}if(a){this.setIgnoreSelectionChangeTime("setSelectionRange"),s.setSelectionRange(t,i),vr&&window.parent!==window&&s.focus();return}try{const d=Sme(s);this.setIgnoreSelectionChangeTime("setSelectionRange"),s.focus(),s.setSelectionRange(t,i),xme(s,d)}catch{}}}class G1e extends BP{constructor(e,t,i){super(e,t,i),this._register(Rt.addTarget(this.viewHelper.linesContentDomNode)),this._register(K(this.viewHelper.linesContentDomNode,Pt.Tap,o=>this.onTap(o))),this._register(K(this.viewHelper.linesContentDomNode,Pt.Change,o=>this.onChange(o))),this._register(K(this.viewHelper.linesContentDomNode,Pt.Contextmenu,o=>this._onContextMenu(new su(o,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(K(this.viewHelper.linesContentDomNode,"pointerdown",o=>{const r=o.pointerType;if(r==="mouse"){this._lastPointerType="mouse";return}else r==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const s=new m1e(this.viewHelper.viewDomNode);this._register(s.onPointerMove(this.viewHelper.viewDomNode,o=>this._onMouseMove(o))),this._register(s.onPointerUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(s.onPointerLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(s.onPointerDown(this.viewHelper.viewDomNode,(o,r)=>this._onMouseDown(o,r)))}onTap(e){if(!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget))return;e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new su(e,!1,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.dispatchMouse({position:t.position,mouseColumn:t.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:t.type===6&&t.detail.injectedText!==null})}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class K1e extends BP{constructor(e,t,i){super(e,t,i),this._register(Rt.addTarget(this.viewHelper.linesContentDomNode)),this._register(K(this.viewHelper.linesContentDomNode,Pt.Tap,s=>this.onTap(s))),this._register(K(this.viewHelper.linesContentDomNode,Pt.Change,s=>this.onChange(s))),this._register(K(this.viewHelper.linesContentDomNode,Pt.Contextmenu,s=>this._onContextMenu(new su(s,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new su(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(nx.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class Y1e extends Y{constructor(e,t,i){super(),Qd&&dP.pointerEvents?this.handler=this._register(new G1e(e,t,i)):window.TouchEvent?this.handler=this._register(new K1e(e,t,i)):this.handler=this._register(new BP(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class $f extends ly{}const ao=at("themeService");function sn(n){return{id:n}}function ZT(n){switch(n){case Fo.DARK:return"vs-dark";case Fo.HIGH_CONTRAST_DARK:return"hc-black";case Fo.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const Lq={ThemingContribution:"base.contributions.theming"};class Z1e{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new B}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Ze(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const Dq=new Z1e;mn.add(Lq.ThemingContribution,Dq);function Dr(n){return Dq.onColorThemeChange(n)}class X1e extends Y{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}const kq=E("editor.lineHighlightBackground",{dark:null,light:null,hcDark:null,hcLight:null},m("lineHighlight","Background color for the highlight of line at the cursor position.")),V7=E("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:Je},m("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));E("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},m("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:jt,hcLight:jt},m("rangeHighlightBorder","Background color of the border around highlighted ranges."),!0);E("editor.symbolHighlightBackground",{dark:Wa,light:Wa,hcDark:null,hcLight:null},m("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:jt,hcLight:jt},m("symbolHighlightBorder","Background color of the border around highlighted symbols."),!0);const Eq=E("editorCursor.foreground",{dark:"#AEAFAD",light:z.black,hcDark:z.white,hcLight:"#0F4A85"},m("caret","Color of the editor cursor.")),Q1e=E("editorCursor.background",null,m("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Ql=E("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},m("editorWhitespaces","Color of whitespace characters in the editor.")),J1e=E("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:z.white,hcLight:"#292929"},m("editorLineNumbers","Color of editor line numbers.")),fw=E("editorIndentGuide.background",{dark:Ql,light:Ql,hcDark:Ql,hcLight:Ql},m("editorIndentGuides","Color of the editor indentation guides."),!1,m("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),gw=E("editorIndentGuide.activeBackground",{dark:Ql,light:Ql,hcDark:Ql,hcLight:Ql},m("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,m("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),dy=E("editorIndentGuide.background1",{dark:fw,light:fw,hcDark:fw,hcLight:fw},m("editorIndentGuides1","Color of the editor indentation guides (1).")),eye=E("editorIndentGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorIndentGuides2","Color of the editor indentation guides (2).")),tye=E("editorIndentGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorIndentGuides3","Color of the editor indentation guides (3).")),iye=E("editorIndentGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorIndentGuides4","Color of the editor indentation guides (4).")),nye=E("editorIndentGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorIndentGuides5","Color of the editor indentation guides (5).")),sye=E("editorIndentGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorIndentGuides6","Color of the editor indentation guides (6).")),uy=E("editorIndentGuide.activeBackground1",{dark:gw,light:gw,hcDark:gw,hcLight:gw},m("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),oye=E("editorIndentGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),rye=E("editorIndentGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),aye=E("editorIndentGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),lye=E("editorIndentGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),cye=E("editorIndentGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),pw=E("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:jt,hcLight:jt},m("editorActiveLineNumber","Color of editor active line number"),!1,m("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));E("editorLineNumber.activeForeground",{dark:pw,light:pw,hcDark:pw,hcLight:pw},m("editorActiveLineNumber","Color of editor active line number"));const dye=E("editorLineNumber.dimmedForeground",{dark:null,light:null,hcDark:null,hcLight:null},m("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));E("editorRuler.foreground",{dark:"#5A5A5A",light:z.lightgrey,hcDark:z.white,hcLight:"#292929"},m("editorRuler","Color of the editor rulers."));E("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},m("editorCodeLensForeground","Foreground color of editor CodeLens"));E("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},m("editorBracketMatchBackground","Background color behind matching brackets"));E("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:Je,hcLight:Je},m("editorBracketMatchBorder","Color for matching brackets boxes"));const uye=E("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},m("editorOverviewRulerBorder","Color of the overview ruler border.")),hye=E("editorOverviewRuler.background",null,m("editorOverviewRulerBackground","Background color of the editor overview ruler."));E("editorGutter.background",{dark:Gi,light:Gi,hcDark:Gi,hcLight:Gi},m("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));E("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:z.fromHex("#fff").transparent(.8),hcLight:Je},m("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const fye=E("editorUnnecessaryCode.opacity",{dark:z.fromHex("#000a"),light:z.fromHex("#0007"),hcDark:null,hcLight:null},m("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));E("editorGhostText.border",{dark:null,light:null,hcDark:z.fromHex("#fff").transparent(.8),hcLight:z.fromHex("#292929").transparent(.8)},m("editorGhostTextBorder","Border color of ghost text in the editor."));E("editorGhostText.foreground",{dark:z.fromHex("#ffffff56"),light:z.fromHex("#0007"),hcDark:null,hcLight:null},m("editorGhostTextForeground","Foreground color of the ghost text in the editor."));E("editorGhostText.background",{dark:null,light:null,hcDark:null,hcLight:null},m("editorGhostTextBackground","Background color of the ghost text in the editor."));const mw=new z(new ut(0,122,204,.6)),gye=E("editorOverviewRuler.rangeHighlightForeground",{dark:mw,light:mw,hcDark:mw,hcLight:mw},m("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),pye=E("editorOverviewRuler.errorForeground",{dark:new z(new ut(255,18,18,.7)),light:new z(new ut(255,18,18,.7)),hcDark:new z(new ut(255,50,50,1)),hcLight:"#B5200D"},m("overviewRuleError","Overview ruler marker color for errors.")),mye=E("editorOverviewRuler.warningForeground",{dark:wo,light:wo,hcDark:ev,hcLight:ev},m("overviewRuleWarning","Overview ruler marker color for warnings.")),_ye=E("editorOverviewRuler.infoForeground",{dark:ks,light:ks,hcDark:tv,hcLight:tv},m("overviewRuleInfo","Overview ruler marker color for infos.")),Aq=E("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},m("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),Iq=E("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},m("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),Tq=E("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},m("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),Nq=E("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),Rq=E("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),Mq=E("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),bye=E("editorBracketHighlight.unexpectedBracket.foreground",{dark:new z(new ut(255,18,18,.8)),light:new z(new ut(255,18,18,.8)),hcDark:new z(new ut(255,50,50,1)),hcLight:""},m("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),vye=E("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),yye=E("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),wye=E("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),Cye=E("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),Sye=E("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),xye=E("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),Lye=E("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),Dye=E("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),kye=E("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),Eye=E("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),Aye=E("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),Iye=E("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hcDark:"#00000000",hcLight:"#00000000"},m("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));E("editorUnicodeHighlight.border",{dark:"#BD9B03",light:"#CEA33D",hcDark:"#ff0000",hcLight:"#CEA33D"},m("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));E("editorUnicodeHighlight.background",{dark:"#bd9b0326",light:"#cea33d14",hcDark:"#00000000",hcLight:"#cea33d14"},m("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));Dr((n,e)=>{const t=n.getColor(Gi),i=n.getColor(kq),s=i&&!i.isTransparent()?i:t;s&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${s}; }`)});class hy extends $f{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new V(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(66);const t=e.get(67);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(94);const i=e.get(143);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const s=Math.abs(this._lastCursorModelPosition.lineNumber-i);return s===0?'<span class="relative-current-line-number">'+i+"</span>":String(s)}return this._renderLineNumbers===3?this._lastCursorModelPosition.lineNumber===i||i%10===0?String(i):"":String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=Xn?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,o=this._context.viewModel.getLineCount(),r=[];for(let a=i;a<=s;a++){const l=a-i,c=this._getLineRenderLineNumber(a);if(!c){r[l]="";continue}let d="";if(a===o&&this._context.viewModel.getLineLength(a)===0){if(this._renderFinalNewline==="off"){r[l]="";continue}this._renderFinalNewline==="dimmed"&&(d=" dimmed-line-number")}a===this._activeLineNumber&&(d=" active-line-number"),r[l]=`<div class="${hy.CLASS_NAME}${t}${d}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${c}</div>`}this._renderResult=r}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}hy.CLASS_NAME="line-numbers";Dr((n,e)=>{const t=n.getColor(J1e),i=n.getColor(dye);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});class pf extends ro{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(pf.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=bt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(pf.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}pf.CLASS_NAME="glyph-margin";pf.OUTER_CLASS_NAME="margin";const vp="monaco-mouse-cursor-text";class Tye{constructor(){this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const R_=new Tye,bi=at("keybindingService");var Nye=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Rye=function(n,e){return function(t,i){e(t,i,n)}};class Mye{constructor(e,t,i,s,o){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=s,this.distanceToModelLineEnd=o,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new V(this.modelLineNumber,this.distanceToModelLineStart+1),i=new V(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const Z2=vr;let XT=class extends ro{constructor(e,t,i,s){super(e),this._keybindingService=s,this._primaryCursorPosition=new V(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const o=this._context.configuration.options,r=o.get(143);this._setAccessibilityOptions(o),this._contentLeft=r.contentLeft,this._contentWidth=r.contentWidth,this._contentHeight=r.height,this._fontInfo=o.get(50),this._lineHeight=o.get(66),this._emptySelectionClipboard=o.get(37),this._copyWithSyntaxHighlighting=o.get(25),this._visibleTextArea=null,this._selections=[new lt(1,1,1,1)],this._modelSelections=[new lt(1,1,1,1)],this._lastRenderPosition=null,this.textArea=bt(document.createElement("textarea")),Ja.write(this.textArea,6),this.textArea.setClassName(`inputarea ${vp}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:a}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${a*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(o)),this.textArea.setAttribute("aria-required",o.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(o.get(123))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",m("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",o.get(90)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=bt(document.createElement("div")),this.textAreaCover.setPosition("absolute");const l={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:u=>this._context.viewModel.getLineMaxColumn(u),getValueInRange:(u,h)=>this._context.viewModel.getValueInRange(u,h),getValueLengthInRange:(u,h)=>this._context.viewModel.getValueLengthInRange(u,h),modifyPosition:(u,h)=>this._context.viewModel.modifyPosition(u,h)},c={getDataToCopy:()=>{const u=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,Ps),h=this._context.viewModel.model.getEOL(),f=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),g=Array.isArray(u)?u:null,p=Array.isArray(u)?u.join(h):u;let _,v=null;if(this._copyWithSyntaxHighlighting&&p.length<65536){const b=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);b&&(_=b.html,v=b.mode)}return{isFromEmptySelection:f,multicursorText:g,text:p,html:_,mode:v}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const u=this._selections[0];if(pt&&u.isEmpty()){const f=u.getStartPosition();let g=this._getWordBeforePosition(f);if(g.length===0&&(g=this._getCharacterBeforePosition(f)),g.length>0)return new cn(g,g.length,g.length,N.fromPositions(f),0)}const h=500;if(pt&&!u.isEmpty()&&l.getValueLengthInRange(u,0)<h){const f=l.getValueInRange(u,0);return new cn(f,0,f.length,u,0)}if(pc&&!u.isEmpty()){const f="vscode-placeholder";return new cn(f,0,f.length,null,void 0)}return cn.EMPTY}if(f9){const u=this._selections[0];if(u.isEmpty()){const h=u.getStartPosition(),[f,g]=this._getAndroidWordAtPosition(h);if(f.length>0)return new cn(f,g,g,N.fromPositions(h),0)}return cn.EMPTY}return qg.fromEditorSelection(l,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(u,h,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(u,h,f)},d=this._register(new q1e(this.textArea.domNode));this._textAreaInput=this._register(new j1e(c,d,vo,{isAndroid:f9,isChrome:oP,isFirefox:vr,isSafari:pc})),this._register(this._textAreaInput.onKeyDown(u=>{this._viewController.emitKeyDown(u)})),this._register(this._textAreaInput.onKeyUp(u=>{this._viewController.emitKeyUp(u)})),this._register(this._textAreaInput.onPaste(u=>{let h=!1,f=null,g=null;u.metadata&&(h=this._emptySelectionClipboard&&!!u.metadata.isFromEmptySelection,f=typeof u.metadata.multicursorText<"u"?u.metadata.multicursorText:null,g=u.metadata.mode),this._viewController.paste(u.text,h,f,g)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(u=>{u.replacePrevCharCnt||u.replaceNextCharCnt||u.positionDelta?this._viewController.compositionType(u.text,u.replacePrevCharCnt,u.replaceNextCharCnt,u.positionDelta):this._viewController.type(u.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(u=>{this._viewController.setSelection(u)})),this._register(this._textAreaInput.onCompositionStart(u=>{const h=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:g,widthOfHiddenTextBefore:p}=(()=>{const v=h.value.substring(0,Math.min(h.selectionStart,h.selectionEnd)),b=v.lastIndexOf(`
`),y=v.substring(b+1),w=y.lastIndexOf("	"),C=y.length-w-1,L=f.getStartPosition(),x=Math.min(L.column-1,C),D=L.column-1-x,k=y.substring(0,y.length-x),{tabSize:P}=this._context.viewModel.model.getOptions(),O=Pye(this.textArea.domNode.ownerDocument,k,this._fontInfo,P);return{distanceToModelLineStart:D,widthOfHiddenTextBefore:O}})(),{distanceToModelLineEnd:_}=(()=>{const v=h.value.substring(Math.max(h.selectionStart,h.selectionEnd)),b=v.indexOf(`
`),y=b===-1?v:v.substring(0,b),w=y.indexOf("	"),C=w===-1?y.length:y.length-w-1,L=f.getEndPosition(),x=Math.min(this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column,C);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(L.lineNumber)-L.column-x}})();this._context.viewModel.revealRange("keyboard",!0,N.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new Mye(this._context,f.startLineNumber,g,p,_),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${vp} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(u=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${vp}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(R_.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(e){this._textAreaInput.writeScreenReaderContent(e)}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),s=ym(t);let o=!0,r=e.column,a=!0,l=e.column,c=0;for(;c<50&&(o||a);){if(o&&r<=1&&(o=!1),o){const d=i.charCodeAt(r-2);s.get(d)!==0?o=!1:r--}if(a&&l>i.length&&(a=!1),a){const d=i.charCodeAt(l-1);s.get(d)!==0?a=!1:l++}c++}return[i.substring(r-1,l-1),e.column-r]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=ym(this._context.configuration.options.get(129));let s=e.column,o=0;for(;s>1;){const r=t.charCodeAt(s-2);if(i.get(r)!==0||o>50)return t.substring(s-1,e.column-1);o++,s--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!tn(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){var t,i,s;if(e.get(2)===1){const r=(t=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode"))===null||t===void 0?void 0:t.getAriaLabel(),a=(i=this._keybindingService.lookupKeybinding("workbench.action.showCommands"))===null||i===void 0?void 0:i.getAriaLabel(),l=(s=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings"))===null||s===void 0?void 0:s.getAriaLabel(),c=m("accessibilityModeOff","The editor is not accessible at this time.");return r?m("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",c,r):a?m("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",c,a):l?m("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",c,l):c}return e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Nf.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const s=e.get(143).wrappingColumn;if(s!==-1&&this._accessibilitySupport!==1){const o=e.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(s*o.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=Z2?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(50),this._lineHeight=t.get(66),this._emptySelectionClipboard=t.get(37),this._copyWithSyntaxHighlighting=t.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:s}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${s*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("aria-required",t.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(123))),(e.hasChanged(34)||e.hasChanged(90))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!R_.enabled||e.get(34)&&e.get(90)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){var t;this._primaryCursorPosition=new V(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),(t=this._visibleTextArea)===null||t===void 0||t.prepareRender(e)}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){var e;if(this._visibleTextArea){const s=this._visibleTextArea.visibleTextareaStart,o=this._visibleTextArea.visibleTextareaEnd,r=this._visibleTextArea.startPosition,a=this._visibleTextArea.endPosition;if(r&&a&&s&&o&&o.left>=this._scrollLeft&&s.left<=this._scrollLeft+this._contentWidth){const l=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,c=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let d=this._visibleTextArea.widthOfHiddenLineTextBefore,u=this._contentLeft+s.left-this._scrollLeft,h=o.left-s.left+1;if(u<this._contentLeft){const b=this._contentLeft-u;u+=b,d+=b,h-=b}h>this._contentWidth&&(h=this._contentWidth);const f=this._context.viewModel.getViewLineData(r.lineNumber),g=f.tokens.findTokenIndexAtOffset(r.column-1),p=f.tokens.findTokenIndexAtOffset(a.column-1),_=g===p,v=this._visibleTextArea.definePresentation(_?f.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=c*this._lineHeight,this.textArea.domNode.scrollLeft=d,this._doRender({lastRenderPosition:null,top:l,left:u,width:h,height:this._lineHeight,useCover:!1,color:(Si.getColorMap()||[])[v.foreground],italic:v.italic,bold:v.bold,underline:v.underline,strikethrough:v.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const i=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(i<0||i>this._contentHeight){this._renderAtTopLeft();return}if(pt){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const s=(e=this._textAreaInput.textAreaState.newlineCountBeforeSelection)!==null&&e!==void 0?e:this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=s*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:i,left:this._textAreaWrapping?this._contentLeft:t,width:this._textAreaWidth,height:Z2?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;do{if(i=e.indexOf(`
`,i+1),i===-1)break;t++}while(!0);return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:Z2?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;Rn(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?z.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const s=this._context.configuration.options;s.get(57)?i.setClassName("monaco-editor-background textAreaCover "+pf.OUTER_CLASS_NAME):s.get(67).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+hy.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};XT=Nye([Rye(3,bi)],XT);function Pye(n,e,t,i){if(e.length===0)return 0;const s=n.createElement("div");s.style.position="absolute",s.style.top="-50000px",s.style.width="50000px";const o=n.createElement("span");Rn(o,t),o.style.whiteSpace="pre",o.style.tabSize=`${i*t.spaceWidth}px`,o.append(e),s.appendChild(o),n.body.appendChild(s);const r=o.offsetWidth;return n.body.removeChild(s),r}function Oye(n,e,t){let i=0;for(let o=0;o<n.length;o++)n.charAt(o)==="	"?i=qi.nextIndentTabStop(i,e):i++;let s="";if(!t){const o=Math.floor(i/e);i=i%e;for(let r=0;r<o;r++)s+="	"}for(let o=0;o<i;o++)s+=" ";return s}function Pq(n,e,t){let i=Zs(n);return i===-1&&(i=n.length),Oye(n.substring(0,i),e,t)+n.substring(i)}const Fye=()=>!0,Bye=()=>!1,Wye=n=>n===" "||n==="	";class fg{static shouldRecreate(e){return e.hasChanged(143)||e.hasChanged(129)||e.hasChanged(37)||e.hasChanged(76)||e.hasChanged(78)||e.hasChanged(79)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(127)||e.hasChanged(50)||e.hasChanged(90)}constructor(e,t,i,s){var o;this.languageConfigurationService=s,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const r=i.options,a=r.get(143),l=r.get(50);this.readOnly=r.get(90),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(115),this.lineHeight=l.lineHeight,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(a.height/this.lineHeight)-2),this.useTabStops=r.get(127),this.wordSeparators=r.get(129),this.emptySelectionClipboard=r.get(37),this.copyWithSyntaxHighlighting=r.get(25),this.multiCursorMergeOverlapping=r.get(76),this.multiCursorPaste=r.get(78),this.multiCursorLimit=r.get(79),this.autoClosingBrackets=r.get(6),this.autoClosingComments=r.get(7),this.autoClosingQuotes=r.get(11),this.autoClosingDelete=r.get(9),this.autoClosingOvertype=r.get(10),this.autoSurround=r.get(14),this.autoIndent=r.get(12),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const c=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(c)for(const u of c)this.surroundingPairs[u.open]=u.close;const d=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=(o=d==null?void 0:d.blockCommentStartToken)!==null&&o!==void 0?o:null}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)===null||e===void 0?void 0:e.getElectricCharacters();if(t)for(const i of t)this._electricChars[i]=!0}return this._electricChars}onElectricCharacter(e,t,i){const s=AD(t,i-1),o=this.languageConfigurationService.getLanguageConfiguration(s.languageId).electricCharacter;return o?o.onElectricCharacter(e,s,i-s.firstCharOffset):null}normalizeIndentation(e){return Pq(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return Wye;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return Fye;case"never":return Bye}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return s=>i.indexOf(s)!==-1}visibleColumnFromColumn(e,t){return qi.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const s=qi.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),o=e.getLineMinColumn(t);if(s<o)return o;const r=e.getLineMaxColumn(t);return s>r?r:s}}class ot{static fromModelState(e){return new Vye(e)}static fromViewState(e){return new zye(e)}static fromModelSelection(e){const t=lt.liftSelection(e),i=new hn(N.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return ot.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,s=e.length;i<s;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class Vye{constructor(e){this.modelState=e,this.viewState=null}}class zye{constructor(e){this.modelState=null,this.viewState=e}}class hn{constructor(e,t,i,s,o){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=s,this.leftoverVisibleColumns=o,this._singleCursorStateBrand=void 0,this.selection=hn._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,s){return e?new hn(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new V(t,i),s):new hn(new N(t,i,t,i),0,s,new V(t,i),s)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?lt.fromPositions(e.getStartPosition(),t):lt.fromPositions(e.getEndPosition(),t)}}class _s{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function Wc(n){return n==="'"||n==='"'||n==="`"}class ah{static columnSelect(e,t,i,s,o,r){const a=Math.abs(o-i)+1,l=i>o,c=s>r,d=s<r,u=[];for(let h=0;h<a;h++){const f=i+(l?-h:h),g=e.columnFromVisibleColumn(t,f,s),p=e.columnFromVisibleColumn(t,f,r),_=e.visibleColumnFromColumn(t,new V(f,g)),v=e.visibleColumnFromColumn(t,new V(f,p));d&&(_>r||v<s)||c&&(v>s||_<r)||u.push(new hn(new N(f,g,f,g),0,0,new V(f,p),0))}if(u.length===0)for(let h=0;h<a;h++){const f=i+(l?-h:h),g=t.getLineMaxColumn(f);u.push(new hn(new N(f,g,f,g),0,0,new V(f,g),0))}return{viewStates:u,reversed:l,fromLineNumber:i,fromVisualColumn:s,toLineNumber:o,toVisualColumn:r}}static columnSelectLeft(e,t,i){let s=i.toViewVisualColumn;return s>0&&s--,ah.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,s)}static columnSelectRight(e,t,i){let s=0;const o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),r=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=o;l<=r;l++){const c=t.getLineMaxColumn(l),d=e.visibleColumnFromColumn(t,new V(l,c));s=Math.max(s,d)}let a=i.toViewVisualColumn;return a<s&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,s){const o=s?e.pageSize:1,r=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}static columnSelectDown(e,t,i,s){const o=s?e.pageSize:1,r=Math.min(t.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}}class vs{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return lt.fromPositions(s.getEndPosition())}}class _w{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return lt.fromPositions(s.getStartPosition())}}class MC{constructor(e,t,i,s,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=s,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return lt.fromPositions(s.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class Oq{constructor(e,t,i,s=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=s,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class X2{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class xt{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-GU(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new V(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const s=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),r=nv.atomicPosition(o,t.column-1,i,0);if(r!==-1&&r+1>=s)return new V(t.lineNumber,r+1)}return this.leftPosition(e,t)}static left(e,t,i){const s=e.stickyTabStops?xt.leftPositionAtomicSoftTabs(t,i,e.tabSize):xt.leftPosition(t,i);return new X2(s.lineNumber,s.column,0)}static moveLeft(e,t,i,s,o){let r,a;if(i.hasSelection()&&!s)r=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(o-1)),c=t.normalizePosition(xt.clipPositionColumn(l,t),0),d=xt.left(e,t,c);r=d.lineNumber,a=d.column}return i.move(s,r,a,0)}static clipPositionColumn(e,t){return new V(e.lineNumber,xt.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+tP(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new V(t,i)}static rightPositionAtomicSoftTabs(e,t,i,s,o){if(i<e.getLineIndentColumn(t)){const r=e.getLineContent(t),a=nv.atomicPosition(r,i-1,s,1);if(a!==-1)return new V(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const s=e.stickyTabStops?xt.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):xt.rightPosition(t,i.lineNumber,i.column);return new X2(s.lineNumber,s.column,0)}static moveRight(e,t,i,s,o){let r,a;if(i.hasSelection()&&!s)r=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,o-1),c=t.normalizePosition(xt.clipPositionColumn(l,t),1),d=xt.right(e,t,c);r=d.lineNumber,a=d.column}return i.move(s,r,a,0)}static vertical(e,t,i,s,o,r,a,l){const c=qi.visibleColumnFromColumn(t.getLineContent(i),s,e.tabSize)+o,d=t.getLineCount(),u=i===1&&s===1,h=i===d&&s===t.getLineMaxColumn(i),f=r<i?u:h;if(i=r,i<1?(i=1,a?s=t.getLineMinColumn(i):s=Math.min(t.getLineMaxColumn(i),s)):i>d?(i=d,a?s=t.getLineMaxColumn(i):s=Math.min(t.getLineMaxColumn(i),s)):s=e.columnFromVisibleColumn(t,i,c),f?o=0:o=c-qi.visibleColumnFromColumn(t.getLineContent(i),s,e.tabSize),l!==void 0){const g=new V(i,s),p=t.normalizePosition(g,l);o=o+(s-p.column),i=p.lineNumber,s=p.column}return new X2(i,s,o)}static down(e,t,i,s,o,r,a){return this.vertical(e,t,i,s,o,i+r,a,4)}static moveDown(e,t,i,s,o){let r,a;i.hasSelection()&&!s?(r=i.selection.endLineNumber,a=i.selection.endColumn):(r=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=xt.down(e,t,r+l,a,i.leftoverVisibleColumns,o,!0),t.normalizePosition(new V(c.lineNumber,c.column),2).lineNumber>r)break;while(l++<10&&r+l<t.getLineCount());return i.move(s,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const s=i.selection,o=xt.down(e,t,s.selectionStartLineNumber,s.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=xt.down(e,t,s.positionLineNumber,s.positionColumn,i.leftoverVisibleColumns,1,!1);return new hn(new N(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new V(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(e,t,i,s,o,r,a){return this.vertical(e,t,i,s,o,i-r,a,3)}static moveUp(e,t,i,s,o){let r,a;i.hasSelection()&&!s?(r=i.selection.startLineNumber,a=i.selection.startColumn):(r=i.position.lineNumber,a=i.position.column);const l=xt.up(e,t,r,a,i.leftoverVisibleColumns,o,!0);return i.move(s,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const s=i.selection,o=xt.up(e,t,s.selectionStartLineNumber,s.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=xt.up(e,t,s.positionLineNumber,s.positionColumn,i.leftoverVisibleColumns,1,!1);return new hn(new N(o.lineNumber,o.column,o.lineNumber,o.column),0,o.leftoverVisibleColumns,new V(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,s){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return i.move(s,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,i,s){const o=t.getLineCount();let r=i.position.lineNumber;for(;r<o&&this._isBlankLine(t,r);)r++;for(;r<o&&!this._isBlankLine(t,r);)r++;return i.move(s,r,t.getLineMinColumn(r),0)}static moveToBeginningOfLine(e,t,i,s){const o=i.position.lineNumber,r=t.getLineMinColumn(o),a=t.getLineFirstNonWhitespaceColumn(o)||r;let l;return i.position.column===a?l=r:l=a,i.move(s,o,l,0)}static moveToEndOfLine(e,t,i,s,o){const r=i.position.lineNumber,a=t.getLineMaxColumn(r);return i.move(s,r,a,o?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,s){return i.move(s,1,1,0)}static moveToEndOfBuffer(e,t,i,s){const o=t.getLineCount(),r=t.getLineMaxColumn(o);return i.move(s,o,r,0)}}class mf{static deleteRight(e,t,i,s){const o=[];let r=e!==3;for(let a=0,l=s.length;a<l;a++){const c=s[a];let d=c;if(d.isEmpty()){const u=c.getPosition(),h=xt.right(t,i,u);d=new N(h.lineNumber,h.column,u.lineNumber,u.column)}if(d.isEmpty()){o[a]=null;continue}d.startLineNumber!==d.endLineNumber&&(r=!0),o[a]=new vs(d,"")}return[r,o]}static isAutoClosingPairDelete(e,t,i,s,o,r,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=r.length;l<c;l++){const d=r[l],u=d.getPosition();if(!d.isEmpty())return!1;const h=o.getLineContent(u.lineNumber);if(u.column<2||u.column>=h.length+1)return!1;const f=h.charAt(u.column-2),g=s.get(f);if(!g)return!1;if(Wc(f)){if(i==="never")return!1}else if(t==="never")return!1;const p=h.charAt(u.column-1);let _=!1;for(const v of g)v.open===f&&v.close===p&&(_=!0);if(!_)return!1;if(e==="auto"){let v=!1;for(let b=0,y=a.length;b<y;b++){const w=a[b];if(u.lineNumber===w.startLineNumber&&u.column===w.startColumn){v=!0;break}}if(!v)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const s=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].getPosition(),l=new N(a.lineNumber,a.column-1,a.lineNumber,a.column+1);s[o]=new vs(l,"")}return[!0,s]}static deleteLeft(e,t,i,s,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,s,o))return this._runAutoClosingPairDelete(t,i,s);const r=[];let a=e!==2;for(let l=0,c=s.length;l<c;l++){const d=mf.getDeleteRange(s[l],i,t);if(d.isEmpty()){r[l]=null;continue}d.startLineNumber!==d.endLineNumber&&(a=!0),r[l]=new vs(d,"")}return[a,r]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const s=e.getPosition();if(i.useTabStops&&s.column>1){const o=t.getLineContent(s.lineNumber),r=Zs(o),a=r===-1?o.length+1:r+1;if(s.column<=a){const l=i.visibleColumnFromColumn(t,s),c=qi.prevIndentTabStop(l,i.indentSize),d=i.columnFromVisibleColumn(t,s.lineNumber,c);return new N(s.lineNumber,d,s.lineNumber,s.column)}}return N.fromPositions(mf.getPositionAfterDeleteLeft(s,t),s)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=epe(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new V(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const s=[];let o=null;i.sort((r,a)=>V.compare(r.getStartPosition(),a.getEndPosition()));for(let r=0,a=i.length;r<a;r++){const l=i[r];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let d,u,h,f;c.lineNumber<t.getLineCount()?(d=c.lineNumber,u=1,h=c.lineNumber+1,f=1):c.lineNumber>1&&(o==null?void 0:o.endLineNumber)!==c.lineNumber?(d=c.lineNumber-1,u=t.getLineMaxColumn(c.lineNumber-1),h=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber)):(d=c.lineNumber,u=1,h=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber));const g=new N(d,u,h,f);o=g,g.isEmpty()?s[r]=null:s[r]=new vs(g,"")}else s[r]=null;else s[r]=new vs(l,"")}return new _s(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class wi{static _createWord(e,t,i,s,o){return{start:s,end:o,wordType:t,nextCharClass:i}}static _findPreviousWordOnLine(e,t,i){const s=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(s,e,i)}static _doFindPreviousWordOnLine(e,t,i){let s=0;for(let o=i.column-2;o>=0;o--){const r=e.charCodeAt(o),a=t.get(r);if(a===0){if(s===2)return this._createWord(e,s,a,o+1,this._findEndOfWord(e,t,s,o+1));s=1}else if(a===2){if(s===1)return this._createWord(e,s,a,o+1,this._findEndOfWord(e,t,s,o+1));s=2}else if(a===1&&s!==0)return this._createWord(e,s,a,o+1,this._findEndOfWord(e,t,s,o+1))}return s!==0?this._createWord(e,s,1,0,this._findEndOfWord(e,t,s,0)):null}static _findEndOfWord(e,t,i,s){const o=e.length;for(let r=s;r<o;r++){const a=e.charCodeAt(r),l=t.get(a);if(l===1||i===1&&l===2||i===2&&l===0)return r}return o}static _findNextWordOnLine(e,t,i){const s=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(s,e,i)}static _doFindNextWordOnLine(e,t,i){let s=0;const o=e.length;for(let r=i.column-1;r<o;r++){const a=e.charCodeAt(r),l=t.get(a);if(l===0){if(s===2)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,r-1),r);s=1}else if(l===2){if(s===1)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,r-1),r);s=2}else if(l===1&&s!==0)return this._createWord(e,s,l,this._findStartOfWord(e,t,s,r-1),r)}return s!==0?this._createWord(e,s,1,this._findStartOfWord(e,t,s,o-1),o):null}static _findStartOfWord(e,t,i,s){for(let o=s;o>=0;o--){const r=e.charCodeAt(o),a=t.get(r);if(a===1||i===1&&a===2||i===2&&a===0)return o+1}return 0}static moveWordLeft(e,t,i,s){let o=i.lineNumber,r=i.column;r===1&&o>1&&(o=o-1,r=t.getLineMaxColumn(o));let a=wi._findPreviousWordOnLine(e,t,new V(o,r));if(s===0)return new V(o,a?a.start+1:1);if(s===1)return a&&a.wordType===2&&a.end-a.start===1&&a.nextCharClass===0&&(a=wi._findPreviousWordOnLine(e,t,new V(o,a.start+1))),new V(o,a?a.start+1:1);if(s===3){for(;a&&a.wordType===2;)a=wi._findPreviousWordOnLine(e,t,new V(o,a.start+1));return new V(o,a?a.start+1:1)}return a&&r<=a.end+1&&(a=wi._findPreviousWordOnLine(e,t,new V(o,a.start+1))),new V(o,a?a.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,s=e.getLineMaxColumn(i);if(t.column===1)return i>1?new V(i-1,e.getLineMaxColumn(i-1)):t;const o=e.getLineContent(i);for(let r=t.column-1;r>1;r--){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a===95&&l!==95)return new V(i,r);if(a===45&&l!==45)return new V(i,r);if((Mg(a)||sw(a))&&Hc(l))return new V(i,r);if(Hc(a)&&Hc(l)&&r+1<s){const c=o.charCodeAt(r);if(Mg(c)||sw(c))return new V(i,r)}}return new V(i,1)}static moveWordRight(e,t,i,s){let o=i.lineNumber,r=i.column,a=!1;r===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(a=!0,o=o+1,r=1);let l=wi._findNextWordOnLine(e,t,new V(o,r));if(s===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=wi._findNextWordOnLine(e,t,new V(o,l.end+1))),l?r=l.end+1:r=t.getLineMaxColumn(o);else if(s===3){for(a&&(r=0);l&&(l.wordType===2||l.start+1<=r);)l=wi._findNextWordOnLine(e,t,new V(o,l.end+1));l?r=l.start+1:r=t.getLineMaxColumn(o)}else l&&!a&&r>=l.start+1&&(l=wi._findNextWordOnLine(e,t,new V(o,l.end+1))),l?r=l.start+1:r=t.getLineMaxColumn(o);return new V(o,r)}static _moveWordPartRight(e,t){const i=t.lineNumber,s=e.getLineMaxColumn(i);if(t.column===s)return i<e.getLineCount()?new V(i+1,1):t;const o=e.getLineContent(i);for(let r=t.column+1;r<s;r++){const a=o.charCodeAt(r-2),l=o.charCodeAt(r-1);if(a!==95&&l===95)return new V(i,r);if(a!==45&&l===45)return new V(i,r);if((Mg(a)||sw(a))&&Hc(l))return new V(i,r);if(Hc(a)&&Hc(l)&&r+1<s){const c=o.charCodeAt(r);if(Mg(c)||sw(c))return new V(i,r)}}return new V(i,s)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=t.column-2,o=Of(i,s);return o+1<s?new N(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,s=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(mf.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const u=e.selection.getPosition();return new N(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}const a=new V(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(r){const u=this._deleteWordLeftWhitespace(s,a);if(u)return u}let d=wi._findPreviousWordOnLine(i,s,a);return t===0?d?c=d.start+1:c>1?c=1:(l--,c=s.getLineMaxColumn(l)):(d&&c<=d.end+1&&(d=wi._findPreviousWordOnLine(i,s,new V(l,d.start+1))),d?c=d.end+1:c>1?c=1:(l--,c=s.getLineMaxColumn(l))),new N(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const s=new V(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(t,s);return o||this._deleteInsideWordDetermineDeleteRange(e,t,s)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=i.length;if(s===0)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let r=Math.min(t.column-1,s-1);if(!this._charAtIsWhitespace(i,r))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;r+1<s&&this._charAtIsWhitespace(i,r+1);)r++;return new N(t.lineNumber,o+1,t.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const s=t.getLineContent(i.lineNumber),o=s.length;if(o===0)return i.lineNumber>1?new N(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new N(i.lineNumber,1,i.lineNumber+1,1):new N(i.lineNumber,1,i.lineNumber,1);const r=u=>u.start+1<=i.column&&i.column<=u.end+1,a=(u,h)=>(u=Math.min(u,i.column),h=Math.max(h,i.column),new N(i.lineNumber,u,i.lineNumber,h)),l=u=>{let h=u.start+1,f=u.end+1,g=!1;for(;f-1<o&&this._charAtIsWhitespace(s,f-1);)g=!0,f++;if(!g)for(;h>1&&this._charAtIsWhitespace(s,h-2);)h--;return a(h,f)},c=wi._findPreviousWordOnLine(e,t,i);if(c&&r(c))return l(c);const d=wi._findNextWordOnLine(e,t,i);return d&&r(d)?l(d):c&&d?a(c.end+1,d.start+1):c?a(c.start+1,c.end+1):d?a(d.start+1,d.end+1):a(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),s=wi._moveWordPartLeft(e,i);return new N(i.lineNumber,i.column,s.lineNumber,s.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let s=t;s<i;s++){const o=e.charAt(s);if(o!==" "&&o!=="	")return s}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),s=t.column-1,o=this._findFirstNonWhitespaceChar(i,s);return s+1<o?new N(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,s=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;const a=new V(o.positionLineNumber,o.positionColumn);let l=a.lineNumber,c=a.column;const d=s.getLineCount(),u=s.getLineMaxColumn(l);if(l===d&&c===u)return null;if(r){const f=this._deleteWordRightWhitespace(s,a);if(f)return f}let h=wi._findNextWordOnLine(i,s,a);return t===2?h?c=h.end+1:c<u||l===d?c=u:(l++,h=wi._findNextWordOnLine(i,s,new V(l,1)),h?c=h.start+1:c=s.getLineMaxColumn(l)):(h&&c>=h.start+1&&(h=wi._findNextWordOnLine(i,s,new V(l,h.end+1))),h?c=h.start+1:c<u||l===d?c=u:(l++,h=wi._findNextWordOnLine(i,s,new V(l,1)),h?c=h.start+1:c=s.getLineMaxColumn(l))),new N(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),s=wi._moveWordPartRight(e,i);return new N(i.lineNumber,i.column,s.lineNumber,s.column)}static _createWordAtPosition(e,t,i){const s=new N(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(s),startColumn:s.startColumn,endColumn:s.endColumn}}static getWordAtPosition(e,t,i){const s=ym(t),o=wi._findPreviousWordOnLine(s,e,i);if(o&&o.wordType===1&&o.start<=i.column-1&&i.column-1<=o.end)return wi._createWordAtPosition(e,i.lineNumber,o);const r=wi._findNextWordOnLine(s,e,i);return r&&r.wordType===1&&r.start<=i.column-1&&i.column-1<=r.end?wi._createWordAtPosition(e,i.lineNumber,r):null}static word(e,t,i,s,o){const r=ym(e.wordSeparators),a=wi._findPreviousWordOnLine(r,t,o),l=wi._findNextWordOnLine(r,t,o);if(!s){let f,g;return a&&a.wordType===1&&a.start<=o.column-1&&o.column-1<=a.end?(f=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=o.column-1&&o.column-1<=l.end?(f=l.start+1,g=l.end+1):(a?f=a.end+1:f=1,l?g=l.start+1:g=t.getLineMaxColumn(o.lineNumber)),new hn(new N(o.lineNumber,f,o.lineNumber,g),1,0,new V(o.lineNumber,g),0)}let c,d;a&&a.wordType===1&&a.start<o.column-1&&o.column-1<a.end?(c=a.start+1,d=a.end+1):l&&l.wordType===1&&l.start<o.column-1&&o.column-1<l.end?(c=l.start+1,d=l.end+1):(c=o.column,d=o.column);const u=o.lineNumber;let h;if(i.selectionStart.containsPosition(o))h=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){h=c;const f=new V(u,h);i.selectionStart.containsPosition(f)&&(h=i.selectionStart.endColumn)}else{h=d;const f=new V(u,h);i.selectionStart.containsPosition(f)&&(h=i.selectionStart.startColumn)}return i.move(!0,u,h,0)}}class _n{static addCursorDown(e,t,i){const s=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];s[o++]=new ot(l.modelState,l.viewState),i?s[o++]=ot.fromModelState(xt.translateDown(e.cursorConfig,e.model,l.modelState)):s[o++]=ot.fromViewState(xt.translateDown(e.cursorConfig,e,l.viewState))}return s}static addCursorUp(e,t,i){const s=[];let o=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];s[o++]=new ot(l.modelState,l.viewState),i?s[o++]=ot.fromModelState(xt.translateUp(e.cursorConfig,e.model,l.modelState)):s[o++]=ot.fromViewState(xt.translateUp(e.cursorConfig,e,l.viewState))}return s}static moveToBeginningOfLine(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];s[o]=this._moveToLineStart(e,a,i)}return s}static _moveToLineStart(e,t,i){const s=t.viewState.position.column,o=t.modelState.position.column,r=s===o,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!r&&!(s===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return ot.fromViewState(xt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return ot.fromModelState(xt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,s){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=this._moveToLineEnd(e,l,i,s)}return o}static _moveToLineEnd(e,t,i,s){const o=t.viewState.position,r=e.getLineMaxColumn(o.lineNumber),a=o.column===r,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),d=r-o.column===c-l.column;return a||d?this._moveToLineEndByModel(e,t,i,s):this._moveToLineEndByView(e,t,i,s)}static _moveToLineEndByView(e,t,i,s){return ot.fromViewState(xt.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,s))}static _moveToLineEndByModel(e,t,i,s){return ot.fromModelState(xt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,s))}static expandLineSelection(e,t){const i=[];for(let s=0,o=t.length;s<o;s++){const r=t[s],a=r.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=r.modelState.selection.endLineNumber,d;c===l?d=e.model.getLineMaxColumn(l):(c++,d=1),i[s]=ot.fromModelState(new hn(new N(a,1,a,1),0,0,new V(c,d),0))}return i}static moveToBeginningOfBuffer(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];s[o]=ot.fromModelState(xt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return s}static moveToEndOfBuffer(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o];s[o]=ot.fromModelState(xt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return s}static selectAll(e,t){const i=e.model.getLineCount(),s=e.model.getLineMaxColumn(i);return ot.fromModelState(new hn(new N(1,1,1,1),0,0,new V(i,s),0))}static line(e,t,i,s,o){const r=e.model.validatePosition(s),a=o?e.coordinatesConverter.validateViewPosition(new V(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);if(!i){const c=e.model.getLineCount();let d=r.lineNumber+1,u=1;return d>c&&(d=c,u=e.model.getLineMaxColumn(d)),ot.fromModelState(new hn(new N(r.lineNumber,1,d,u),2,0,new V(d,u),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<l)return ot.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(r.lineNumber>l){const c=e.getLineCount();let d=a.lineNumber+1,u=1;return d>c&&(d=c,u=e.getLineMaxColumn(d)),ot.fromViewState(t.viewState.move(!0,d,u,0))}else{const c=t.modelState.selectionStart.getEndPosition();return ot.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,s){const o=e.model.validatePosition(s);return ot.fromModelState(wi.word(e.cursorConfig,e.model,t.modelState,i,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ot(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,s=t.viewState.position.column;return ot.fromViewState(new hn(new N(i,s,i,s),0,0,new V(i,s),0))}static moveTo(e,t,i,s,o){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,s);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,s,o)}const r=e.model.validatePosition(s),a=o?e.coordinatesConverter.validateViewPosition(new V(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);return ot.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,s,o,r){switch(i){case 0:return r===4?this._moveHalfLineLeft(e,t,s):this._moveLeft(e,t,s,o);case 1:return r===4?this._moveHalfLineRight(e,t,s):this._moveRight(e,t,s,o);case 2:return r===2?this._moveUpByViewLines(e,t,s,o):this._moveUpByModelLines(e,t,s,o);case 3:return r===2?this._moveDownByViewLines(e,t,s,o):this._moveDownByModelLines(e,t,s,o);case 4:return r===2?t.map(a=>ot.fromViewState(xt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,s))):t.map(a=>ot.fromModelState(xt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,s)));case 5:return r===2?t.map(a=>ot.fromViewState(xt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,s))):t.map(a=>ot.fromModelState(xt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,s)));case 6:return this._moveToViewMinColumn(e,t,s);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,s);case 8:return this._moveToViewCenterColumn(e,t,s);case 9:return this._moveToViewMaxColumn(e,t,s);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,s);default:return null}}static viewportMove(e,t,i,s,o){const r=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(r);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,o),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],s,l,c)]}case 14:{const l=[];for(let c=0,d=t.length;c<d;c++){const u=t[c];l[c]=this.findPositionInViewportIfOutside(e,u,r,s)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,s){const o=t.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new ot(t.modelState,t.viewState);{let r;o>i.endLineNumber-1?r=i.endLineNumber-1:o<i.startLineNumber?r=i.startLineNumber:r=o;const a=xt.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,r,!1);return ot.fromViewState(t.viewState.move(s,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let s=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(s)&&s++,Math.min(t.endLineNumber,s+i-1)}static _lastLineNumberInRange(e,t,i){let s=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(s)&&s++,Math.max(s,t.endLineNumber-i+1)}static _moveLeft(e,t,i,s){return t.map(o=>ot.fromViewState(xt.moveLeft(e.cursorConfig,e,o.viewState,i,s)))}static _moveHalfLineLeft(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);s[o]=ot.fromViewState(xt.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return s}static _moveRight(e,t,i,s){return t.map(o=>ot.fromViewState(xt.moveRight(e.cursorConfig,e,o.viewState,i,s)))}static _moveHalfLineRight(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);s[o]=ot.fromViewState(xt.moveRight(e.cursorConfig,e,a.viewState,i,c))}return s}static _moveDownByViewLines(e,t,i,s){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ot.fromViewState(xt.moveDown(e.cursorConfig,e,l.viewState,i,s))}return o}static _moveDownByModelLines(e,t,i,s){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ot.fromModelState(xt.moveDown(e.cursorConfig,e.model,l.modelState,i,s))}return o}static _moveUpByViewLines(e,t,i,s){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ot.fromViewState(xt.moveUp(e.cursorConfig,e,l.viewState,i,s))}return o}static _moveUpByModelLines(e,t,i,s){const o=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];o[r]=ot.fromModelState(xt.moveUp(e.cursorConfig,e.model,l.modelState,i,s))}return o}static _moveToViewPosition(e,t,i,s,o){return ot.fromViewState(t.viewState.move(i,s,o,0))}static _moveToModelPosition(e,t,i,s,o){return ot.fromModelState(t.modelState.move(i,s,o,0))}static _moveToViewMinColumn(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);s[o]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);s[o]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewCenterColumn(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);s[o]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewMaxColumn(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);s[o]=this._moveToViewPosition(e,a,i,l,c)}return s}static _moveToViewLastNonWhitespaceColumn(e,t,i){const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);s[o]=this._moveToViewPosition(e,a,i,l,c)}return s}}var ox;(function(n){const e=function(i){if(!Ls(i))return!1;const s=i;return!(!Ns(s.to)||!qs(s.select)&&!vU(s.select)||!qs(s.by)&&!Ns(s.by)||!qs(s.value)&&!Xd(s.value))};n.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},n.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let s;switch(i.to){case n.RawDirection.Left:s=0;break;case n.RawDirection.Right:s=1;break;case n.RawDirection.Up:s=2;break;case n.RawDirection.Down:s=3;break;case n.RawDirection.PrevBlankLine:s=4;break;case n.RawDirection.NextBlankLine:s=5;break;case n.RawDirection.WrappedLineStart:s=6;break;case n.RawDirection.WrappedLineFirstNonWhitespaceCharacter:s=7;break;case n.RawDirection.WrappedLineColumnCenter:s=8;break;case n.RawDirection.WrappedLineEnd:s=9;break;case n.RawDirection.WrappedLineLastNonWhitespaceCharacter:s=10;break;case n.RawDirection.ViewPortTop:s=11;break;case n.RawDirection.ViewPortBottom:s=13;break;case n.RawDirection.ViewPortCenter:s=12;break;case n.RawDirection.ViewPortIfOutside:s=14;break;default:return null}let o=0;switch(i.by){case n.RawUnit.Line:o=1;break;case n.RawUnit.WrappedLine:o=2;break;case n.RawUnit.Character:o=3;break;case n.RawUnit.HalfLine:o=4;break}return{direction:s,unit:o,select:!!i.select,value:i.value||1}}n.parse=t})(ox||(ox={}));function QT(n,e,t,i){const s=fp(e,t.startLineNumber,t.startColumn),o=i.getLanguageConfiguration(s.languageId);if(!o)return null;const r=s.getLineContent(),a=r.substr(0,t.startColumn-1-s.firstCharOffset);let l;t.isEmpty()?l=r.substr(t.startColumn-1-s.firstCharOffset):l=fp(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-s.firstCharOffset);let c="";if(t.startLineNumber>1&&s.firstCharOffset===0){const p=fp(e,t.startLineNumber-1);p.languageId===s.languageId&&(c=p.getLineContent())}const d=o.onEnter(n,c,a,l);if(!d)return null;const u=d.indentAction;let h=d.appendText;const f=d.removeText||0;h?u===ns.Indent&&(h="	"+h):u===ns.Indent||u===ns.IndentOutdent?h="	":h="";let g=Hj(e,t.startLineNumber,t.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:u,appendText:h,removeText:f,indentation:g}}var Hye=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},$ye=function(n,e){return function(t,i){e(t,i,n)}},PC;const Q2=Object.create(null);function $u(n,e){if(e<=0)return"";Q2[n]||(Q2[n]=["",n]);const t=Q2[n];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+n;return t[e]}let lh=PC=class{static unshiftIndent(e,t,i,s,o){const r=qi.visibleColumnFromColumn(e,t,i);if(o){const a=$u(" ",s),c=qi.prevIndentTabStop(r,s)/s;return $u(a,c)}else{const a="	",c=qi.prevRenderTabStop(r,i)/i;return $u(a,c)}}static shiftIndent(e,t,i,s,o){const r=qi.visibleColumnFromColumn(e,t,i);if(o){const a=$u(" ",s),c=qi.nextIndentTabStop(r,s)/s;return $u(a,c)}else{const a="	",c=qi.nextRenderTabStop(r,i)/i;return $u(a,c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let s=this._selection.endLineNumber;this._selection.endColumn===1&&i!==s&&(s=s-1);const{tabSize:o,indentSize:r,insertSpaces:a}=this._opts,l=i===s;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,d=0;for(let u=i;u<=s;u++,c=d){d=0;const h=e.getLineContent(u);let f=Zs(h);if(this._opts.isUnshift&&(h.length===0||f===0)||!l&&!this._opts.isUnshift&&h.length===0)continue;if(f===-1&&(f=h.length),u>1&&qi.visibleColumnFromColumn(h,f+1,o)%r!==0&&e.tokenization.isCheapToTokenize(u-1)){const _=QT(this._opts.autoIndent,e,new N(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)),this._languageConfigurationService);if(_){if(d=c,_.appendText)for(let v=0,b=_.appendText.length;v<b&&d<r&&_.appendText.charCodeAt(v)===32;v++)d++;_.removeText&&(d=Math.max(0,d-_.removeText));for(let v=0;v<d&&!(f===0||h.charCodeAt(f-1)!==32);v++)f--}}if(this._opts.isUnshift&&f===0)continue;let g;this._opts.isUnshift?g=PC.unshiftIndent(h,f+1,o,r,a):g=PC.shiftIndent(h,f+1,o,r,a),this._addEditOperation(t,new N(u,1,u,f+1),g),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=f+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?$u(" ",r):"	";for(let d=i;d<=s;d++){const u=e.getLineContent(d);let h=Zs(u);if(!(this._opts.isUnshift&&(u.length===0||h===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(h===-1&&(h=u.length),!(this._opts.isUnshift&&h===0)))if(this._opts.isUnshift){h=Math.min(h,r);for(let f=0;f<h;f++)if(u.charCodeAt(f)===9){h=f+1;break}this._addEditOperation(t,new N(d,1,d,h+1),"")}else this._addEditOperation(t,new N(d,1,d,1),c),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const s=t.getInverseEditOperations()[0];return new lt(s.range.endLineNumber,s.range.endColumn,s.range.endLineNumber,s.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const s=this._selection.startColumn;return i.startColumn<=s?i:i.getDirection()===0?new lt(i.startLineNumber,s,i.endLineNumber,i.endColumn):new lt(i.endLineNumber,i.endColumn,i.startLineNumber,s)}return i}};lh=PC=Hye([$ye(2,oo)],lh);class Uye{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new N(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new N(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),s=i[0].range,o=i[1].range;return new lt(s.endLineNumber,s.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}}class jye{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new N(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return new lt(s.endLineNumber,s.startColumn,s.endLineNumber,s.endColumn-this._charAfter.length)}}function qye(n,e,t){const i=n.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let s,o=-1;for(s=e-1;s>=1;s--){if(n.tokenization.getLanguageIdAtPosition(s,0)!==i)return o;const r=n.getLineContent(s);if(t.shouldIgnore(r)||/^\s+$/.test(r)||r===""){o=s;continue}return s}}return-1}function WP(n,e,t,i=!0,s){if(n<4)return null;const o=s.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!o)return null;if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const r=qye(e,t,o);if(r<0)return null;if(r<1)return{indentation:"",action:null};const a=e.getLineContent(r);if(o.shouldIncrease(a)||o.shouldIndentNextLine(a))return{indentation:zs(a),action:ns.Indent,line:r};if(o.shouldDecrease(a))return{indentation:zs(a),action:null,line:r};{if(r===1)return{indentation:zs(e.getLineContent(r)),action:null,line:r};const l=r-1,c=o.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let d=0;for(let u=l-1;u>0;u--)if(!o.shouldIndentNextLine(e.getLineContent(u))){d=u;break}return{indentation:zs(e.getLineContent(d+1)),action:null,line:d+1}}if(i)return{indentation:zs(e.getLineContent(r)),action:null,line:r};for(let d=r;d>0;d--){const u=e.getLineContent(d);if(o.shouldIncrease(u))return{indentation:zs(u),action:ns.Indent,line:d};if(o.shouldIndentNextLine(u)){let h=0;for(let f=d-1;f>0;f--)if(!o.shouldIndentNextLine(e.getLineContent(d))){h=f;break}return{indentation:zs(e.getLineContent(h+1)),action:null,line:h+1}}else if(o.shouldDecrease(u))return{indentation:zs(u),action:null,line:d}}return{indentation:zs(e.getLineContent(1)),action:null,line:1}}}function Gye(n,e,t,i,s){if(n<4)return null;e.tokenization.forceTokenization(t.startLineNumber);const o=e.tokenization.getLineTokens(t.startLineNumber),r=AD(o,t.startColumn-1),a=r.getLineContent();let l=!1,c;r.firstCharOffset>0&&o.getLanguageId(0)!==r.languageId?(l=!0,c=a.substr(0,t.startColumn-1-r.firstCharOffset)):c=o.getLineContent().substring(0,t.startColumn-1);let d;t.isEmpty()?d=a.substr(t.startColumn-1-r.firstCharOffset):d=fp(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-r.firstCharOffset);const u=s.getLanguageConfiguration(r.languageId).indentRulesSupport;if(!u)return null;const h=c,f=zs(c),g={tokenization:{getLineTokens:b=>e.tokenization.getLineTokens(b),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(b,y)=>e.getLanguageIdAtPosition(b,y)},getLineContent:b=>b===t.startLineNumber?h:e.getLineContent(b)},p=zs(o.getLineContent()),_=WP(n,g,t.startLineNumber+1,void 0,s);if(!_){const b=l?p:f;return{beforeEnter:b,afterEnter:b}}let v=l?p:_.indentation;return _.action===ns.Indent&&(v=i.shiftIndent(v)),u.shouldDecrease(d)&&(v=i.unshiftIndent(v)),{beforeEnter:l?p:f,afterEnter:v}}function Kye(n,e,t,i,s,o){if(n<4)return null;const r=fp(e,t.startLineNumber,t.startColumn);if(r.firstCharOffset)return null;const a=o.getLanguageConfiguration(r.languageId).indentRulesSupport;if(!a)return null;const l=r.getLineContent(),c=l.substr(0,t.startColumn-1-r.firstCharOffset);let d;if(t.isEmpty()?d=l.substr(t.startColumn-1-r.firstCharOffset):d=fp(e,t.endLineNumber,t.endColumn).getLineContent().substr(t.endColumn-1-r.firstCharOffset),!a.shouldDecrease(c+d)&&a.shouldDecrease(c+i+d)){const u=WP(n,e,t.startLineNumber,!1,o);if(!u)return null;let h=u.indentation;return u.action!==ns.Indent&&(h=s.unshiftIndent(h)),h}return null}class fi{static indent(e,t,i){if(t===null||i===null)return[];const s=[];for(let o=0,r=i.length;o<r;o++)s[o]=new lh(i[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return s}static outdent(e,t,i){const s=[];for(let o=0,r=i.length;o<r;o++)s[o]=new lh(i[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return s}static shiftIndent(e,t,i){return i=i||1,lh.shiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,i){return i=i||1,lh.unshiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,i,s){const o=[];for(let r=0,a=i.length;r<a;r++)o[r]=new vs(i[r],s[r]);return new _s(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,s,o){const r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.getPosition();if(o&&!c.isEmpty()&&(o=!1),o&&s.indexOf(`
`)!==s.length-1&&(o=!1),o){const u=new N(d.lineNumber,1,d.lineNumber,1);r[a]=new Oq(u,s,c,!0)}else r[a]=new vs(c,s)}return new _s(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,i,s,o){if(s||t.length===1)return null;if(o&&o.length===t.length)return o;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substr(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substr(0,i.length-1));const r=Pf(i);if(r.length===t.length)return r}return null}static paste(e,t,i,s,o,r){const a=this._distributePasteToCursors(e,i,s,o,r);return a?(i=i.sort(N.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,s,o)}static _goodIndentForLine(e,t,i){let s=null,o="";const r=WP(e.autoIndent,t,i,!1,e.languageConfigurationService);if(r)s=r.action,o=r.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const d=t.getLineContent(a);if(Of(d)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=QT(e.autoIndent,t,new N(a,l,a,l),e.languageConfigurationService);c&&(o=c.indentation+c.appendText)}return s&&(s===ns.Indent&&(o=fi.shiftIndent(e,o)),s===ns.Outdent&&(o=fi.unshiftIndent(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,i,s){let o="";const r=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,r),l=e.indentSize,c=l-a%l;for(let d=0;d<c;d++)o+=" "}else o="	";return new vs(i,o,s)}static tab(e,t,i){const s=[];for(let o=0,r=i.length;o<r;o++){const a=i[o];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const d=e.normalizeIndentation(c);if(!l.startsWith(d)){s[o]=new vs(new N(a.startLineNumber,1,a.startLineNumber,l.length+1),d,!0);continue}}s[o]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){s[o]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}s[o]=new lh(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return s}static compositionType(e,t,i,s,o,r,a,l){const c=s.map(d=>this._compositionType(i,d,o,r,a,l));return new _s(4,c,{shouldPushStackElementBefore:bw(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,s,o,r){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-s),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+o),d=new N(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(d)===i&&r===0?null:new MC(d,i,0,r)}static _typeCommand(e,t,i){return i?new _w(e,t,!0):new vs(e,t,!0)}static _enter(e,t,i,s){if(e.autoIndent===0)return fi._typeCommand(s,`
`,i);if(!t.tokenization.isCheapToTokenize(s.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(s.startLineNumber),c=zs(l).substring(0,s.startColumn-1);return fi._typeCommand(s,`
`+e.normalizeIndentation(c),i)}const o=QT(e.autoIndent,t,s,e.languageConfigurationService);if(o){if(o.indentAction===ns.None)return fi._typeCommand(s,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===ns.Indent)return fi._typeCommand(s,`
`+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===ns.IndentOutdent){const l=e.normalizeIndentation(o.indentation),c=e.normalizeIndentation(o.indentation+o.appendText),d=`
`+c+`
`+l;return i?new _w(s,d,!0):new MC(s,d,-1,c.length-l.length,!0)}else if(o.indentAction===ns.Outdent){const l=fi.unshiftIndent(e,o.indentation);return fi._typeCommand(s,`
`+e.normalizeIndentation(l+o.appendText),i)}}const r=t.getLineContent(s.startLineNumber),a=zs(r).substring(0,s.startColumn-1);if(e.autoIndent>=4){const l=Gye(e.autoIndent,t,s,{unshiftIndent:c=>fi.unshiftIndent(e,c),shiftIndent:c=>fi.shiftIndent(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,s.getEndPosition());const d=s.endColumn,u=t.getLineContent(s.endLineNumber),h=Zs(u);if(h>=0?s=s.setEndPosition(s.endLineNumber,Math.max(s.endColumn,h+1)):s=s.setEndPosition(s.endLineNumber,t.getLineMaxColumn(s.endLineNumber)),i)return new _w(s,`
`+e.normalizeIndentation(l.afterEnter),!0);{let f=0;return d<=h+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),f=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new MC(s,`
`+e.normalizeIndentation(l.afterEnter),0,f,!0)}}}return fi._typeCommand(s,`
`+e.normalizeIndentation(a),i)}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let s=0,o=i.length;s<o;s++)if(!t.tokenization.isCheapToTokenize(i[s].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,i,s){const o=Hj(t,i.startLineNumber,i.startColumn),r=Kye(e.autoIndent,t,i,s,{shiftIndent:a=>fi.shiftIndent(e,a),unshiftIndent:a=>fi.unshiftIndent(e,a)},e.languageConfigurationService);if(r===null)return null;if(r!==e.normalizeIndentation(o)){const a=t.getLineFirstNonWhitespaceColumn(i.startLineNumber);return a===0?fi._typeCommand(new N(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(r)+s,!1):fi._typeCommand(new N(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(r)+t.getLineContent(i.startLineNumber).substring(a-1,i.startColumn-1)+s,!1)}return null}static _isAutoClosingOvertype(e,t,i,s,o){if(e.autoClosingOvertype==="never"||!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(o))return!1;for(let r=0,a=i.length;r<a;r++){const l=i[r];if(!l.isEmpty())return!1;const c=l.getPosition(),d=t.getLineContent(c.lineNumber);if(d.charAt(c.column-1)!==o)return!1;const h=Wc(o);if((c.column>2?d.charCodeAt(c.column-2):0)===92&&h)return!1;if(e.autoClosingOvertype==="auto"){let g=!1;for(let p=0,_=s.length;p<_;p++){const v=s[p];if(c.lineNumber===v.startLineNumber&&c.column===v.startColumn){g=!0;break}}if(!g)return!1}}return!0}static _runAutoClosingOvertype(e,t,i,s,o){const r=[];for(let a=0,l=s.length;a<l;a++){const d=s[a].getPosition(),u=new N(d.lineNumber,d.column,d.lineNumber,d.column+1);r[a]=new vs(u,o)}return new _s(4,r,{shouldPushStackElementBefore:bw(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),s=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],r=s.some(l=>t.startsWith(l.open)),a=o.some(l=>t.startsWith(l.close));return!r&&a}static _findAutoClosingPairOpen(e,t,i,s){const o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(s);if(!o)return null;let r=null;for(const a of o)if(r===null||a.open.length>r.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new N(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+s!==a.open){l=!1;break}l&&(r=a)}return r}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),s=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let o=null;for(const r of s)r.open!==t.open&&t.open.includes(r.open)&&t.close.endsWith(r.close)&&(!o||r.open.length>o.open.length)&&(o=r);return o}static _getAutoClosingPairClose(e,t,i,s,o){for(const g of i)if(!g.isEmpty())return null;const r=i.map(g=>{const p=g.getPosition();return o?{lineNumber:p.lineNumber,beforeColumn:p.column-s.length,afterColumn:p.column}:{lineNumber:p.lineNumber,beforeColumn:p.column,afterColumn:p.column}}),a=this._findAutoClosingPairOpen(e,t,r.map(g=>new V(g.lineNumber,g.beforeColumn)),s);if(!a)return null;let l,c;if(Wc(s)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const u=this._findContainedAutoClosingPair(e,a),h=u?u.close:"";let f=!0;for(const g of r){const{lineNumber:p,beforeColumn:_,afterColumn:v}=g,b=t.getLineContent(p),y=b.substring(0,_-1),w=b.substring(v-1);if(w.startsWith(h)||(f=!1),w.length>0){const D=w.charAt(0);if(!fi._isBeforeClosingBrace(e,w)&&!c(D))return null}if(a.open.length===1&&(s==="'"||s==='"')&&l!=="always"){const D=ym(e.wordSeparators);if(y.length>0){const k=y.charCodeAt(y.length-1);if(D.get(k)===0)return null}}if(!t.tokenization.isCheapToTokenize(p))return null;t.tokenization.forceTokenization(p);const C=t.tokenization.getLineTokens(p),L=AD(C,_-1);if(!a.shouldAutoClose(L,_-L.firstCharOffset))return null;const x=a.findNeutralCharacter();if(x){const D=t.tokenization.getTokenTypeIfInsertingCharacter(p,_,x);if(!a.isOK(D))return null}}return f?a.close.substring(0,a.close.length-h.length):a.close}static _runAutoClosingOpenCharType(e,t,i,s,o,r,a){const l=[];for(let c=0,d=s.length;c<d;c++){const u=s[c];l[c]=new Fq(u,o,!r,a)}return new _s(4,l,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return Wc(t)?e.autoSurround==="quotes"||e.autoSurround==="languageDefined":e.autoSurround==="brackets"||e.autoSurround==="languageDefined"}static _isSurroundSelectionType(e,t,i,s){if(!fi._shouldSurroundChar(e,s)||!e.surroundingPairs.hasOwnProperty(s))return!1;const o=Wc(s);for(const r of i){if(r.isEmpty())return!1;let a=!0;for(let l=r.startLineNumber;l<=r.endLineNumber;l++){const c=t.getLineContent(l),d=l===r.startLineNumber?r.startColumn-1:0,u=l===r.endLineNumber?r.endColumn-1:c.length,h=c.substring(d,u);if(/[^ \t]/.test(h)){a=!1;break}}if(a)return!1;if(o&&r.startLineNumber===r.endLineNumber&&r.startColumn+1===r.endColumn){const l=t.getValueInRange(r);if(Wc(l))return!1}}return!0}static _runSurroundSelectionType(e,t,i,s,o){const r=[];for(let a=0,l=s.length;a<l;a++){const c=s[a],d=t.surroundingPairs[o];r[a]=new Uye(c,o,d)}return new _s(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,s,o){if(!t.electricChars.hasOwnProperty(o)||!s.isEmpty())return null;const r=s.getPosition();i.tokenization.forceTokenization(r.lineNumber);const a=i.tokenization.getLineTokens(r.lineNumber);let l;try{l=t.onElectricCharacter(o,a,r.column)}catch(c){return mt(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+o).lastIndexOf(l.matchOpenBracket)+1,d=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:r.lineNumber,column:c},500);if(d){if(d.startLineNumber===r.lineNumber)return null;const u=i.getLineContent(d.startLineNumber),h=zs(u),f=t.normalizeIndentation(h),g=i.getLineContent(r.lineNumber),p=i.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,_=g.substring(p-1,r.column-1),v=f+_+o,b=new N(r.lineNumber,1,r.lineNumber,r.column),y=new vs(b,v);return new _s(J2(v,e),[y],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,i,s,o,r){if(!s)return null;let a=null;for(const u of s)if(a===null)a=u.insertedText;else if(a!==u.insertedText)return null;if(!a||a.length!==1)return null;const l=a;let c=!1;for(const u of s)if(u.deletedText.length!==0){c=!0;break}if(c){if(!fi._shouldSurroundChar(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const u=Wc(l);for(const g of s)if(g.deletedSelectionStart!==0||g.deletedSelectionEnd!==g.deletedText.length||/^[ \t]+$/.test(g.deletedText)||u&&Wc(g.deletedText))return null;const h=[];for(const g of o){if(!g.isEmpty())return null;h.push(g.getPosition())}if(h.length!==s.length)return null;const f=[];for(let g=0,p=h.length;g<p;g++)f.push(new jye(h[g],s[g].deletedText,t.surroundingPairs[l]));return new _s(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(t,i,o,r,l)){const u=o.map(h=>new vs(new N(h.positionLineNumber,h.positionColumn,h.positionLineNumber,h.positionColumn+1),"",!1));return new _s(4,u,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const d=this._getAutoClosingPairClose(t,i,o,l,!0);return d!==null?this._runAutoClosingOpenCharType(e,t,i,o,l,!0,d):null}static typeWithInterceptors(e,t,i,s,o,r,a){if(!e&&a===`
`){const d=[];for(let u=0,h=o.length;u<h;u++)d[u]=fi._enter(i,s,!1,o[u]);return new _s(4,d,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(i,s,o)){const d=[];let u=!1;for(let h=0,f=o.length;h<f;h++)if(d[h]=this._runAutoIndentType(i,s,o[h],a),!d[h]){u=!0;break}if(!u)return new _s(4,d,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(this._isAutoClosingOvertype(i,s,o,r,a))return this._runAutoClosingOvertype(t,i,s,o,a);if(!e){const d=this._getAutoClosingPairClose(i,s,o,a,!1);if(d)return this._runAutoClosingOpenCharType(t,i,s,o,a,!1,d)}if(!e&&this._isSurroundSelectionType(i,s,o,a))return this._runSurroundSelectionType(t,i,s,o,a);if(!e&&this._isTypeInterceptorElectricChar(i,s,o)){const d=this._typeInterceptorElectricChar(t,i,s,o[0],a);if(d)return d}const l=[];for(let d=0,u=o.length;d<u;d++)l[d]=new vs(o[d],a);const c=J2(a,t);return new _s(c,l,{shouldPushStackElementBefore:bw(t,c),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,i,s,o){const r=[];for(let l=0,c=s.length;l<c;l++)r[l]=new vs(s[l],o);const a=J2(o,e);return new _s(a,r,{shouldPushStackElementBefore:bw(e,a),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const s=[];for(let o=0,r=i.length;o<r;o++){let a=i[o].positionLineNumber;if(a===1)s[o]=new _w(new N(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);s[o]=this._enter(e,t,!1,new N(a,l,a,l))}}return s}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const s=[];for(let o=0,r=i.length;o<r;o++){const a=i[o].positionLineNumber,l=t.getLineMaxColumn(a);s[o]=this._enter(e,t,!1,new N(a,l,a,l))}return s}static lineBreakInsert(e,t,i){const s=[];for(let o=0,r=i.length;o<r;o++)s[o]=this._enter(e,t,!0,i[o]);return s}}class Fq extends MC{constructor(e,t,i,s){super(e,(i?t:"")+s,0,-s.length),this._openCharacter=t,this._closeCharacter=s,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){const s=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new N(s.startLineNumber,s.endColumn-this._closeCharacter.length,s.endLineNumber,s.endColumn),this.enclosingRange=new N(s.startLineNumber,s.endColumn-this._openCharacter.length-this._closeCharacter.length,s.endLineNumber,s.endColumn),super.computeCursorState(e,t)}}class Yye{constructor(e,t,i,s,o,r){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=s,this.insertedSelectionStart=o,this.insertedSelectionEnd=r}}function J2(n,e){return n===" "?e===5||e===6?6:5:4}function bw(n,e){return H7(n)&&!H7(e)?!0:n===5?!1:z7(n)!==z7(e)}function z7(n){return n===6||n===5?"space":n}function H7(n){return n===4||n===5||n===6}var H;(function(n){n.editorSimpleInput=new _e("editorSimpleInput",!1,!0),n.editorTextFocus=new _e("editorTextFocus",!1,m("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),n.focus=new _e("editorFocus",!1,m("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),n.textInputFocus=new _e("textInputFocus",!1,m("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),n.readOnly=new _e("editorReadonly",!1,m("editorReadonly","Whether the editor is read-only")),n.inDiffEditor=new _e("inDiffEditor",!1,m("inDiffEditor","Whether the context is a diff editor")),n.isEmbeddedDiffEditor=new _e("isEmbeddedDiffEditor",!1,m("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),n.comparingMovedCode=new _e("comparingMovedCode",!1,m("comparingMovedCode","Whether a moved code block is selected for comparison")),n.accessibleDiffViewerVisible=new _e("accessibleDiffViewerVisible",!1,m("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),n.diffEditorRenderSideBySideInlineBreakpointReached=new _e("diffEditorRenderSideBySideInlineBreakpointReached",!1,m("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),n.columnSelection=new _e("editorColumnSelection",!1,m("editorColumnSelection","Whether `editor.columnSelection` is enabled")),n.writable=n.readOnly.toNegated(),n.hasNonEmptySelection=new _e("editorHasSelection",!1,m("editorHasSelection","Whether the editor has text selected")),n.hasOnlyEmptySelection=n.hasNonEmptySelection.toNegated(),n.hasMultipleSelections=new _e("editorHasMultipleSelections",!1,m("editorHasMultipleSelections","Whether the editor has multiple selections")),n.hasSingleSelection=n.hasMultipleSelections.toNegated(),n.tabMovesFocus=new _e("editorTabMovesFocus",!1,m("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),n.tabDoesNotMoveFocus=n.tabMovesFocus.toNegated(),n.isInWalkThroughSnippet=new _e("isInEmbeddedEditor",!1,!0),n.canUndo=new _e("canUndo",!1,!0),n.canRedo=new _e("canRedo",!1,!0),n.hoverVisible=new _e("editorHoverVisible",!1,m("editorHoverVisible","Whether the editor hover is visible")),n.hoverFocused=new _e("editorHoverFocused",!1,m("editorHoverFocused","Whether the editor hover is focused")),n.stickyScrollFocused=new _e("stickyScrollFocused",!1,m("stickyScrollFocused","Whether the sticky scroll is focused")),n.stickyScrollVisible=new _e("stickyScrollVisible",!1,m("stickyScrollVisible","Whether the sticky scroll is visible")),n.standaloneColorPickerVisible=new _e("standaloneColorPickerVisible",!1,m("standaloneColorPickerVisible","Whether the standalone color picker is visible")),n.standaloneColorPickerFocused=new _e("standaloneColorPickerFocused",!1,m("standaloneColorPickerFocused","Whether the standalone color picker is focused")),n.inCompositeEditor=new _e("inCompositeEditor",void 0,m("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),n.notInCompositeEditor=n.inCompositeEditor.toNegated(),n.languageId=new _e("editorLangId","",m("editorLangId","The language identifier of the editor")),n.hasCompletionItemProvider=new _e("editorHasCompletionItemProvider",!1,m("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),n.hasCodeActionsProvider=new _e("editorHasCodeActionsProvider",!1,m("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),n.hasCodeLensProvider=new _e("editorHasCodeLensProvider",!1,m("editorHasCodeLensProvider","Whether the editor has a code lens provider")),n.hasDefinitionProvider=new _e("editorHasDefinitionProvider",!1,m("editorHasDefinitionProvider","Whether the editor has a definition provider")),n.hasDeclarationProvider=new _e("editorHasDeclarationProvider",!1,m("editorHasDeclarationProvider","Whether the editor has a declaration provider")),n.hasImplementationProvider=new _e("editorHasImplementationProvider",!1,m("editorHasImplementationProvider","Whether the editor has an implementation provider")),n.hasTypeDefinitionProvider=new _e("editorHasTypeDefinitionProvider",!1,m("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),n.hasHoverProvider=new _e("editorHasHoverProvider",!1,m("editorHasHoverProvider","Whether the editor has a hover provider")),n.hasDocumentHighlightProvider=new _e("editorHasDocumentHighlightProvider",!1,m("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),n.hasDocumentSymbolProvider=new _e("editorHasDocumentSymbolProvider",!1,m("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),n.hasReferenceProvider=new _e("editorHasReferenceProvider",!1,m("editorHasReferenceProvider","Whether the editor has a reference provider")),n.hasRenameProvider=new _e("editorHasRenameProvider",!1,m("editorHasRenameProvider","Whether the editor has a rename provider")),n.hasSignatureHelpProvider=new _e("editorHasSignatureHelpProvider",!1,m("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),n.hasInlayHintsProvider=new _e("editorHasInlayHintsProvider",!1,m("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),n.hasDocumentFormattingProvider=new _e("editorHasDocumentFormattingProvider",!1,m("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),n.hasDocumentSelectionFormattingProvider=new _e("editorHasDocumentSelectionFormattingProvider",!1,m("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),n.hasMultipleDocumentFormattingProvider=new _e("editorHasMultipleDocumentFormattingProvider",!1,m("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),n.hasMultipleDocumentSelectionFormattingProvider=new _e("editorHasMultipleDocumentSelectionFormattingProvider",!1,m("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(H||(H={}));const ft=0;class si extends Cr{runEditorCommand(e,t,i){const s=t._getViewModel();s&&this.runCoreEditorCommand(s,i||{})}}var bn;(function(n){const e=function(i){if(!Ls(i))return!1;const s=i;return!(!Ns(s.to)||!qs(s.by)&&!Ns(s.by)||!qs(s.value)&&!Xd(s.value)||!qs(s.revealCursor)&&!vU(s.revealCursor))};n.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},n.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let s;switch(i.to){case n.RawDirection.Up:s=1;break;case n.RawDirection.Right:s=2;break;case n.RawDirection.Down:s=3;break;case n.RawDirection.Left:s=4;break;default:return null}let o;switch(i.by){case n.RawUnit.Line:o=1;break;case n.RawUnit.WrappedLine:o=2;break;case n.RawUnit.Page:o=3;break;case n.RawUnit.HalfPage:o=4;break;case n.RawUnit.Editor:o=5;break;case n.RawUnit.Column:o=6;break;default:o=2}const r=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:s,unit:o,value:r,revealCursor:a,select:!!i.select}}n.parse=t})(bn||(bn={}));var Gg;(function(n){const e=function(t){if(!Ls(t))return!1;const i=t;return!(!Xd(i.lineNumber)&&!Ns(i.lineNumber)||!qs(i.at)&&!Ns(i.at))};n.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(Gg||(Gg={}));class JT{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const s=t.get(Ut).getFocusedCodeEditor();return s&&s.hasTextFocus()?this._runEditorCommand(t,s,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const s=Xr();return s&&["input","textarea"].indexOf(s.tagName.toLowerCase())>=0?(this.runDOMCommand(s),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const s=t.get(Ut).getActiveCodeEditor();return s?(s.focus(),this._runEditorCommand(t,s,i)):!1})}_runEditorCommand(e,t,i){const s=this.runEditorCommand(e,t,i);return s||!0}}var Zi;(function(n){class e extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){if(!y.position)return;b.model.pushStackElement(),b.setCursorStates(y.source,3,[_n.moveTo(b,b.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)])&&y.revealType!==2&&b.revealPrimaryCursor(y.source,!0,!0)}}n.MoveTo=Ae(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),n.MoveToSelect=Ae(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends si{runCoreEditorCommand(b,y){b.model.pushStackElement();const w=this._getColumnSelectResult(b,b.getPrimaryCursorState(),b.getCursorColumnSelectData(),y);w!==null&&(b.setCursorStates(y.source,3,w.viewStates.map(C=>ot.fromViewState(C))),b.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:w.fromLineNumber,fromViewVisualColumn:w.fromVisualColumn,toViewLineNumber:w.toLineNumber,toViewVisualColumn:w.toVisualColumn}),w.reversed?b.revealTopMostCursor(y.source):b.revealBottomMostCursor(y.source))}}n.ColumnSelect=Ae(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(v,b,y,w){if(typeof w.position>"u"||typeof w.viewPosition>"u"||typeof w.mouseColumn>"u")return null;const C=v.model.validatePosition(w.position),L=v.coordinatesConverter.validateViewPosition(new V(w.viewPosition.lineNumber,w.viewPosition.column),C),x=w.doColumnSelect?y.fromViewLineNumber:L.lineNumber,D=w.doColumnSelect?y.fromViewVisualColumn:w.mouseColumn-1;return ah.columnSelect(v.cursorConfig,v,x,D,L.lineNumber,w.mouseColumn-1)}}),n.CursorColumnSelectLeft=Ae(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(v,b,y,w){return ah.columnSelectLeft(v.cursorConfig,v,y)}}),n.CursorColumnSelectRight=Ae(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(v,b,y,w){return ah.columnSelectRight(v.cursorConfig,v,y)}});class i extends t{constructor(b){super(b),this._isPaged=b.isPaged}_getColumnSelectResult(b,y,w,C){return ah.columnSelectUp(b.cursorConfig,b,w,this._isPaged)}}n.CursorColumnSelectUp=Ae(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3600,linux:{primary:0}}})),n.CursorColumnSelectPageUp=Ae(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3595,linux:{primary:0}}}));class s extends t{constructor(b){super(b),this._isPaged=b.isPaged}_getColumnSelectResult(b,y,w,C){return ah.columnSelectDown(b.cursorConfig,b,w,this._isPaged)}}n.CursorColumnSelectDown=Ae(new s({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3602,linux:{primary:0}}})),n.CursorColumnSelectPageDown=Ae(new s({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3596,linux:{primary:0}}}));class o extends si{constructor(){super({id:"cursorMove",precondition:void 0,description:ox.description})}runCoreEditorCommand(b,y){const w=ox.parse(y);w&&this._runCursorMove(b,y.source,w)}_runCursorMove(b,y,w){b.model.pushStackElement(),b.setCursorStates(y,3,o._move(b,b.getCursorStates(),w)),b.revealPrimaryCursor(y,!0)}static _move(b,y,w){const C=w.select,L=w.value;switch(w.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return _n.simpleMove(b,y,w.direction,C,L,w.unit);case 11:case 13:case 12:case 14:return _n.viewportMove(b,y,w.direction,C,L);default:return null}}}n.CursorMoveImpl=o,n.CursorMove=Ae(new o);class r extends si{constructor(b){super(b),this._staticArgs=b.args}runCoreEditorCommand(b,y){let w=this._staticArgs;this._staticArgs.value===-1&&(w={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:y.pageSize||b.cursorConfig.pageSize}),b.model.pushStackElement(),b.setCursorStates(y.source,3,_n.simpleMove(b,b.getCursorStates(),w.direction,w.select,w.value,w.unit)),b.revealPrimaryCursor(y.source,!0)}}n.CursorLeft=Ae(new r({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),n.CursorLeftSelect=Ae(new r({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1039}})),n.CursorRight=Ae(new r({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),n.CursorRightSelect=Ae(new r({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1041}})),n.CursorUp=Ae(new r({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),n.CursorUpSelect=Ae(new r({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),n.CursorPageUp=Ae(new r({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:11}})),n.CursorPageUpSelect=Ae(new r({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1035}})),n.CursorDown=Ae(new r({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),n.CursorDownSelect=Ae(new r({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),n.CursorPageDown=Ae(new r({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:12}})),n.CursorPageDownSelect=Ae(new r({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1036}})),n.CreateCursor=Ae(new class extends si{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;let y;b.wholeLine?y=_n.line(v,v.getPrimaryCursorState(),!1,b.position,b.viewPosition):y=_n.moveTo(v,v.getPrimaryCursorState(),!1,b.position,b.viewPosition);const w=v.getCursorStates();if(w.length>1){const C=y.modelState?y.modelState.position:null,L=y.viewState?y.viewState.position:null;for(let x=0,D=w.length;x<D;x++){const k=w[x];if(!(C&&!k.modelState.selection.containsPosition(C))&&!(L&&!k.viewState.selection.containsPosition(L))){w.splice(x,1),v.model.pushStackElement(),v.setCursorStates(b.source,3,w);return}}}w.push(y),v.model.pushStackElement(),v.setCursorStates(b.source,3,w)}}),n.LastCursorMoveToSelect=Ae(new class extends si{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;const y=v.getLastAddedCursorIndex(),w=v.getCursorStates(),C=w.slice(0);C[y]=_n.moveTo(v,w[y],!0,b.position,b.viewPosition),v.model.pushStackElement(),v.setCursorStates(b.source,3,C)}});class a extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,_n.moveToBeginningOfLine(b,b.getCursorStates(),this._inSelectionMode)),b.revealPrimaryCursor(y.source,!0)}}n.CursorHome=Ae(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),n.CursorHomeSelect=Ae(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,this._exec(b.getCursorStates())),b.revealPrimaryCursor(y.source,!0)}_exec(b){const y=[];for(let w=0,C=b.length;w<C;w++){const L=b[w],x=L.modelState.position.lineNumber;y[w]=ot.fromModelState(L.modelState.move(this._inSelectionMode,x,1,0))}return y}}n.CursorLineStart=Ae(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:0,mac:{primary:287}}})),n.CursorLineStartSelect=Ae(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,_n.moveToEndOfLine(b,b.getCursorStates(),this._inSelectionMode,y.sticky||!1)),b.revealPrimaryCursor(y.source,!0)}}n.CursorEnd=Ae(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ft,kbExpr:H.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),n.CursorEndSelect=Ae(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:ft,kbExpr:H.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:m("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class d extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,this._exec(b,b.getCursorStates())),b.revealPrimaryCursor(y.source,!0)}_exec(b,y){const w=[];for(let C=0,L=y.length;C<L;C++){const x=y[C],D=x.modelState.position.lineNumber,k=b.model.getLineMaxColumn(D);w[C]=ot.fromModelState(x.modelState.move(this._inSelectionMode,D,k,0))}return w}}n.CursorLineEnd=Ae(new d({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:0,mac:{primary:291}}})),n.CursorLineEndSelect=Ae(new d({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:0,mac:{primary:1315}}}));class u extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,_n.moveToBeginningOfBuffer(b,b.getCursorStates(),this._inSelectionMode)),b.revealPrimaryCursor(y.source,!0)}}n.CursorTop=Ae(new u({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2062,mac:{primary:2064}}})),n.CursorTopSelect=Ae(new u({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3086,mac:{primary:3088}}}));class h extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){b.model.pushStackElement(),b.setCursorStates(y.source,3,_n.moveToEndOfBuffer(b,b.getCursorStates(),this._inSelectionMode)),b.revealPrimaryCursor(y.source,!0)}}n.CursorBottom=Ae(new h({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2061,mac:{primary:2066}}})),n.CursorBottomSelect=Ae(new h({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends si{constructor(){super({id:"editorScroll",precondition:void 0,description:bn.description})}determineScrollMethod(b){const y=[6],w=[1,2,3,4,5,6],C=[4,2],L=[1,3];return y.includes(b.unit)&&C.includes(b.direction)?this._runHorizontalEditorScroll.bind(this):w.includes(b.unit)&&L.includes(b.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(b,y){const w=bn.parse(y);if(!w)return;const C=this.determineScrollMethod(w);C&&C(b,y.source,w)}_runVerticalEditorScroll(b,y,w){const C=this._computeDesiredScrollTop(b,w);if(w.revealCursor){const L=b.getCompletelyVisibleViewRangeAtScrollTop(C);b.setCursorStates(y,3,[_n.findPositionInViewportIfOutside(b,b.getPrimaryCursorState(),L,w.select)])}b.viewLayout.setScrollPosition({scrollTop:C},0)}_computeDesiredScrollTop(b,y){if(y.unit===1){const L=b.viewLayout.getFutureViewport(),x=b.getCompletelyVisibleViewRangeAtScrollTop(L.top),D=b.coordinatesConverter.convertViewRangeToModelRange(x);let k;y.direction===1?k=Math.max(1,D.startLineNumber-y.value):k=Math.min(b.model.getLineCount(),D.startLineNumber+y.value);const P=b.coordinatesConverter.convertModelPositionToViewPosition(new V(k,1));return b.viewLayout.getVerticalOffsetForLineNumber(P.lineNumber)}if(y.unit===5){let L=0;return y.direction===3&&(L=b.model.getLineCount()-b.cursorConfig.pageSize),b.viewLayout.getVerticalOffsetForLineNumber(L)}let w;y.unit===3?w=b.cursorConfig.pageSize*y.value:y.unit===4?w=Math.round(b.cursorConfig.pageSize/2)*y.value:w=y.value;const C=(y.direction===1?-1:1)*w;return b.viewLayout.getCurrentScrollTop()+C*b.cursorConfig.lineHeight}_runHorizontalEditorScroll(b,y,w){const C=this._computeDesiredScrollLeft(b,w);b.viewLayout.setScrollPosition({scrollLeft:C},0)}_computeDesiredScrollLeft(b,y){const w=(y.direction===4?-1:1)*y.value;return b.viewLayout.getCurrentScrollLeft()+w*b.cursorConfig.typicalHalfwidthCharacterWidth}}n.EditorScrollImpl=f,n.EditorScroll=Ae(new f),n.ScrollLineUp=Ae(new class extends si{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Up,by:bn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollPageUp=Ae(new class extends si{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Up,by:bn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollEditorTop=Ae(new class extends si{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Up,by:bn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollLineDown=Ae(new class extends si{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Down,by:bn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollPageDown=Ae(new class extends si{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Down,by:bn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollEditorBottom=Ae(new class extends si{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Down,by:bn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollLeft=Ae(new class extends si{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Left,by:bn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:b.source})}}),n.ScrollRight=Ae(new class extends si{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus}})}runCoreEditorCommand(v,b){n.EditorScroll.runCoreEditorCommand(v,{to:bn.RawDirection.Right,by:bn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:b.source})}});class g extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){y.position&&(b.model.pushStackElement(),b.setCursorStates(y.source,3,[_n.word(b,b.getPrimaryCursorState(),this._inSelectionMode,y.position)]),y.revealType!==2&&b.revealPrimaryCursor(y.source,!0,!0))}}n.WordSelect=Ae(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),n.WordSelectDrag=Ae(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),n.LastCursorWordSelect=Ae(new class extends si{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(v,b){if(!b.position)return;const y=v.getLastAddedCursorIndex(),w=v.getCursorStates(),C=w.slice(0),L=w[y];C[y]=_n.word(v,L,L.modelState.hasSelection(),b.position),v.model.pushStackElement(),v.setCursorStates(b.source,3,C)}});class p extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){y.position&&(b.model.pushStackElement(),b.setCursorStates(y.source,3,[_n.line(b,b.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)]),y.revealType!==2&&b.revealPrimaryCursor(y.source,!1,!0))}}n.LineSelect=Ae(new p({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),n.LineSelectDrag=Ae(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class _ extends si{constructor(b){super(b),this._inSelectionMode=b.inSelectionMode}runCoreEditorCommand(b,y){if(!y.position)return;const w=b.getLastAddedCursorIndex(),C=b.getCursorStates(),L=C.slice(0);L[w]=_n.line(b,C[w],this._inSelectionMode,y.position,y.viewPosition),b.model.pushStackElement(),b.setCursorStates(y.source,3,L)}}n.LastCursorLineSelect=Ae(new _({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),n.LastCursorLineSelectDrag=Ae(new _({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),n.CancelSelection=Ae(new class extends si{constructor(){super({id:"cancelSelection",precondition:H.hasNonEmptySelection,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates(b.source,3,[_n.cancelSelection(v,v.getPrimaryCursorState())]),v.revealPrimaryCursor(b.source,!0)}}),n.RemoveSecondaryCursors=Ae(new class extends si{constructor(){super({id:"removeSecondaryCursors",precondition:H.hasMultipleSelections,kbOpts:{weight:ft+1,kbExpr:H.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates(b.source,3,[v.getPrimaryCursorState()]),v.revealPrimaryCursor(b.source,!0),Qb(m("removedCursor","Removed secondary cursors"))}}),n.RevealLine=Ae(new class extends si{constructor(){super({id:"revealLine",precondition:void 0,description:Gg.description})}runCoreEditorCommand(v,b){const y=b,w=y.lineNumber||0;let C=typeof w=="number"?w+1:parseInt(w)+1;C<1&&(C=1);const L=v.model.getLineCount();C>L&&(C=L);const x=new N(C,1,C,v.model.getLineMaxColumn(C));let D=0;if(y.at)switch(y.at){case Gg.RawAtArgument.Top:D=3;break;case Gg.RawAtArgument.Center:D=1;break;case Gg.RawAtArgument.Bottom:D=4;break}const k=v.coordinatesConverter.convertModelRangeToViewRange(x);v.revealRange(b.source,!1,k,D,0)}}),n.SelectAll=new class extends JT{constructor(){super(Pme)}runDOMCommand(v){vr&&(v.focus(),v.select()),v.ownerDocument.execCommand("selectAll")}runEditorCommand(v,b,y){const w=b._getViewModel();w&&this.runCoreEditorCommand(w,y)}runCoreEditorCommand(v,b){v.model.pushStackElement(),v.setCursorStates("keyboard",3,[_n.selectAll(v,v.getPrimaryCursorState())])}},n.SetSelection=Ae(new class extends si{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(v,b){b.selection&&(v.model.pushStackElement(),v.setCursorStates(b.source,3,[ot.fromModelSelection(b.selection)]))}})})(Zi||(Zi={}));const Zye=Le.and(H.textInputFocus,H.columnSelection);function n0(n,e){Fs.registerKeybindingRule({id:n,primary:e,when:Zye,weight:ft+1})}n0(Zi.CursorColumnSelectLeft.id,1039);n0(Zi.CursorColumnSelectRight.id,1041);n0(Zi.CursorColumnSelectUp.id,1040);n0(Zi.CursorColumnSelectPageUp.id,1035);n0(Zi.CursorColumnSelectDown.id,1042);n0(Zi.CursorColumnSelectPageDown.id,1036);function $7(n){return n.register(),n}var U7;(function(n){class e extends Cr{runEditorCommand(i,s,o){const r=s._getViewModel();r&&this.runCoreEditingCommand(s,r,o||{})}}n.CoreEditingCommand=e,n.LineBreakInsert=Ae(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:H.writable,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,fi.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection)))}}),n.Outdent=Ae(new class extends e{constructor(){super({id:"outdent",precondition:H.writable,kbOpts:{weight:ft,kbExpr:Le.and(H.editorTextFocus,H.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,fi.outdent(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),n.Tab=Ae(new class extends e{constructor(){super({id:"tab",precondition:H.writable,kbOpts:{weight:ft,kbExpr:Le.and(H.editorTextFocus,H.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,s){t.pushUndoStop(),t.executeCommands(this.id,fi.tab(i.cursorConfig,i.model,i.getCursorStates().map(o=>o.modelState.selection))),t.pushUndoStop()}}),n.DeleteLeft=Ae(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,s){const[o,r]=mf.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(2)}}),n.DeleteRight=Ae(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:ft,kbExpr:H.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,s){const[o,r]=mf.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));o&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(3)}}),n.Undo=new class extends JT{constructor(){super(Dj)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,s){if(!(!i.hasModel()||i.getOption(90)===!0))return i.getModel().undo()}},n.Redo=new class extends JT{constructor(){super(kj)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,s){if(!(!i.hasModel()||i.getOption(90)===!0))return i.getModel().redo()}}})(U7||(U7={}));class j7 extends kD{constructor(e,t,i){super({id:e,precondition:void 0,description:i}),this._handlerId=t}runCommand(e,t){const i=e.get(Ut).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function Uf(n,e){$7(new j7("default:"+n,n)),$7(new j7(n,n,e))}Uf("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});Uf("replacePreviousChar");Uf("compositionType");Uf("compositionStart");Uf("compositionEnd");Uf("paste");Uf("cut");class Xye{constructor(e,t,i,s){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=s}paste(e,t,i,s){this.commandDelegate.paste(e,t,i,s)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,s){this.commandDelegate.compositionType(e,t,i,s)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Zi.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new V(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(77)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=Xn&&t.get(106),s=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):s?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Zi.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Zi.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Zi.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Zi.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Zi.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Zi.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Zi.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Zi.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Zi.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Zi.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Zi.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Zi.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Zi.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class jD{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var t;(t=this.onKeyDown)===null||t===void 0||t.call(this,e)}emitKeyUp(e){var t;(t=this.onKeyUp)===null||t===void 0||t.call(this,e)}emitContextMenu(e){var t;(t=this.onContextMenu)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var t;(t=this.onMouseMove)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var t;(t=this.onMouseLeave)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var t;(t=this.onMouseDown)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var t;(t=this.onMouseUp)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var t;(t=this.onMouseDrag)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var t;(t=this.onMouseDrop)===null||t===void 0||t.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;(e=this.onMouseDropCanceled)===null||e===void 0||e.call(this)}emitMouseWheel(e){var t;(t=this.onMouseWheel)===null||t===void 0||t.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return jD.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new V(e.afterLineNumber,1)).lineNumber}}}class Bq{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new ji("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),s=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>s)return null;let o=0,r=0;for(let l=i;l<=s;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(r===0?(o=c,r=1):r++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(o,r)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const s=this.getStartLineNumber(),o=this.getEndLineNumber();let r=!1;for(let a=e;a<=i;a++)a>=s&&a<=o&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,s=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=s)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o)return this._lines.splice(e-this._rendLineNumberStart,o-e+1);const r=[];for(let u=0;u<i;u++)r[u]=this._createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(r).concat(c),d}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let s=!1;for(let o=0,r=e.length;o<r;o++){const a=e[o];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let d=l;d<=c;d++){const u=d-this._rendLineNumberStart;this._lines[u].onTokensChanged(),s=!0}}return s}}class Wq{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new Bq(()=>this._host.createVisibleLine())}_createDomNode(){const e=bt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(143)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,s=t.length;i<s;i++){const o=t[i].getDomNode();o&&this.domNode.domNode.removeChild(o)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,s=t.length;i<s;i++){const o=t[i].getDomNode();o&&this.domNode.domNode.removeChild(o)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new Hl(this.domNode.domNode,this._host,e),s={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(s,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}class Hl{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,s){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let r=t;r<=i;r++)o.lines[r-t]=this.host.createVisibleLine();return this._finishRendering(o,!0,s),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),s,t),o.rendLineNumberStart>t){const r=t,a=Math.min(i,o.rendLineNumberStart-1);r<=a&&(this._insertLinesBefore(o,r,a,s,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart<t){const r=Math.min(o.linesLength,t-o.rendLineNumberStart);r>0&&(this._removeLinesBefore(o,r),o.linesLength-=r)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){const r=o.rendLineNumberStart+o.linesLength,a=i;r<=a&&(this._insertLinesAfter(o,r,a,s,t),o.linesLength+=a-r+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){const r=Math.max(0,i-o.rendLineNumberStart+1),l=o.linesLength-1-r+1;l>0&&(this._removeLinesAfter(o,l),o.linesLength-=l)}return this._finishRendering(o,!1,s),o}_renderUntouchedLines(e,t,i,s,o){const r=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=r+l;a[l].layoutLine(c,s[c-o])}}_insertLinesBefore(e,t,i,s,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this.host.createVisibleLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const s=e.lines[i].getDomNode();s&&this.domNode.removeChild(s)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,s,o){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this.host.createVisibleLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let s=0;s<t;s++){const o=e.lines[i+s].getDomNode();o&&this.domNode.removeChild(o)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,s){Hl._ttPolicy&&(i=Hl._ttPolicy.createHTML(i));const o=this.domNode.lastChild;t||!o?this.domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let r=this.domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];s[a]&&(l.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const s=document.createElement("div");Hl._ttPolicy&&(t=Hl._ttPolicy.createHTML(t)),s.innerHTML=t;for(let o=0;o<e.linesLength;o++){const r=e.lines[o];if(i[o]){const a=s.firstChild,l=r.getDomNode();l.parentNode.replaceChild(a,l),r.setDomNode(a)}}}_finishRendering(e,t,i){const s=Hl._sb,o=e.linesLength,r=e.lines,a=e.rendLineNumberStart,l=[];{s.reset();let c=!1;for(let d=0;d<o;d++){const u=r[d];l[d]=!1,!(u.getDomNode()||!u.renderLine(d+a,i[d],this.viewportData,s))&&(l[d]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,s.build(),l)}{s.reset();let c=!1;const d=[];for(let u=0;u<o;u++){const h=r[u];d[u]=!1,!(l[u]||!h.renderLine(u+a,i[u],this.viewportData,s))&&(d[u]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,s.build(),d)}}}Hl._ttPolicy=Vf("editorViewLayer",{createHTML:n=>n});Hl._sb=new ID(1e5);class Vq extends ro{constructor(e){super(e),this._visibleLines=new Wq(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);Rn(this.domNode,i),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new Qye(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=t;r<=i;r++)this._visibleLines.getVisibleLine(r).onConfigurationChanged(e);const o=this._context.configuration.options.get(50);return Rn(this.domNode,o),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,s=t.length;i<s;i++){const o=t[i];o.prepareRender(e),o.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class Qye{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(66),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=bt(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(66)}renderLine(e,t,i,s){let o="";for(let r=0,a=this._dynamicOverlays.length;r<a;r++){const l=this._dynamicOverlays[r];o+=l.render(i.startLineNumber,e)}return this._renderedContent===o?!1:(this._renderedContent=o,s.appendString('<div style="position:absolute;top:'),s.appendString(String(t)),s.appendString("px;width:100%;height:"),s.appendString(String(this._lineHeight)),s.appendString('px;">'),s.appendString(o),s.appendString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class Jye extends Vq{constructor(e){super(e);const i=this._context.configuration.options.get(143);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class ewe extends Vq{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Rn(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;Rn(this.domNode,t.get(50));const i=t.get(143);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class twe extends ro{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=bt(document.createElement("div")),Ja.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=bt(document.createElement("div")),Ja.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new iwe(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,s,o){this._widgets[e.getId()].setPosition(t,i,s,o),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const s=i.domNode.domNode;s.parentNode.removeChild(s),s.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class iwe{constructor(e,t,i){this._primaryAnchor=new A0(null,null),this._secondaryAnchor=new A0(null,null),this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=bt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const s=this._context.configuration.options,o=s.get(143);this._fixedOverflowWidgets=s.get(42),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=s.get(66),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(66),e.hasChanged(143)){const i=t.get(143);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=s(t,this._context.viewModel,this._affinity),this._secondaryAnchor=s(i,this._context.viewModel,this._affinity);function s(o,r,a){if(!o)return new A0(null,null);const l=r.model.validatePosition(o);if(r.coordinatesConverter.modelPositionIsVisible(l)){const c=r.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new A0(o,c)}return new A0(o,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?(t==null?void 0:t.innerWidth)||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,s){this._setPosition(s,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,s){const o=e.top,r=o,a=e.top+e.height,l=s.viewportHeight-a,c=o-i,d=r>=i,u=a,h=l>=i;let f=e.left;return f+t>s.scrollLeft+s.viewportWidth&&(f=s.scrollLeft+s.viewportWidth-t),f<s.scrollLeft&&(f=s.scrollLeft),{fitsAbove:d,aboveTop:c,fitsBelow:h,belowTop:u,left:f}}_layoutHorizontalSegmentInPage(e,t,i,s){var o;const l=Math.max(15,t.left-s),c=Math.min(t.left+t.width+s,e.width-15),u=this._viewDomNode.domNode.ownerDocument.defaultView;let h=t.left+i-((o=u==null?void 0:u.scrollX)!==null&&o!==void 0?o:0);if(h+s>c){const f=h-(c-s);h-=f,i-=f}if(h<l){const f=h-l;h-=f,i-=f}return[i,h]}_layoutBoxInPage(e,t,i,s){var o,r;const a=e.top-i,l=e.top+e.height,c=Nn(this._viewDomNode.domNode),d=this._viewDomNode.domNode.ownerDocument,u=d.defaultView,h=c.top+a-((o=u==null?void 0:u.scrollY)!==null&&o!==void 0?o:0),f=c.top+l-((r=u==null?void 0:u.scrollY)!==null&&r!==void 0?r:0),g=DD(d.body),[p,_]=this._layoutHorizontalSegmentInPage(g,c,e.left-s.scrollLeft+this._contentLeft,t),v=22,b=22,y=h>=v,w=f+i<=g.height-b;return this._fixedOverflowWidgets?{fitsAbove:y,aboveTop:Math.max(h,v),fitsBelow:w,belowTop:f,left:_}:{fitsAbove:y,aboveTop:a,fitsBelow:w,belowTop:l,left:p}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new I0(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){var t,i;const s=a(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),o=((t=this._secondaryAnchor.viewPosition)===null||t===void 0?void 0:t.lineNumber)===((i=this._primaryAnchor.viewPosition)===null||i===void 0?void 0:i.lineNumber)?this._secondaryAnchor.viewPosition:null,r=a(o,this._affinity,this._lineHeight);return{primary:s,secondary:r};function a(l,c,d){if(!l)return null;const u=e.visibleRangeForPosition(l);if(!u)return null;const h=l.column===1&&c===3?0:u.left,f=e.getVerticalOffsetForLineNumber(l.lineNumber)-e.scrollTop;return new q7(f,h,d)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const s=this._context.configuration.options.get(50);let o=t.left;return o<e.left?o=Math.max(o,e.left-i+s.typicalFullwidthCharacterWidth):o=Math.min(o,e.left+i-s.typicalFullwidthCharacterWidth),new q7(e.top,o,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return null;if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let r=null;if(typeof this._actual.beforeRender=="function"&&(r=eE(this._actual.beforeRender,this._actual)),r)this._cachedDomNodeOffsetWidth=r.width,this._cachedDomNodeOffsetHeight=r.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const s=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let o;this.allowEditorOverflow?o=this._layoutBoxInPage(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):o=this._layoutBoxInViewport(s,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let r=1;r<=2;r++)for(const a of this._preference)if(a===1){if(!o)return null;if(r===2||o.fitsAbove)return{coordinate:new I0(o.aboveTop,o.left),position:1}}else if(a===2){if(!o)return null;if(r===2||o.fitsBelow)return{coordinate:new I0(o.belowTop,o.left),position:2}}else return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new I0(s.top,s.left)),position:0}:{coordinate:new I0(s.top,s.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&eE(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&eE(this._actual.afterRender,this._actual,this._renderData.position)}}class A0{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class I0{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class q7{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function eE(n,e,...t){try{return n.call(e,...t)}catch{return null}}class zq extends $f{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(143);this._lineHeight=t.get(66),this._renderLineHighlight=t.get(95),this._renderLineHighlightOnlyWhenFocus=t.get(96),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new lt(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=this._selections.map(s=>s.positionLineNumber);t.sort((s,o)=>s-o),Ki(this._cursorLineNumbers,t)||(this._cursorLineNumbers=t,e=!0);const i=this._selections.every(s=>s.isEmpty());return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._renderLineHighlight=t.get(95),this._renderLineHighlightOnlyWhenFocus=t.get(96),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=this._renderOne(e),i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,o=this._cursorLineNumbers.length;let r=0;const a=[];for(let l=i;l<=s;l++){const c=l-i;for(;r<o&&this._cursorLineNumbers[r]<l;)r++;r<o&&this._cursorLineNumbers[r]===l?a[c]=t:a[c]=""}this._renderData=a}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class nwe extends zq{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class swe extends zq{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}Dr((n,e)=>{const t=n.getColor(kq);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||n.defines(V7)){const i=n.getColor(V7);i&&(e.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${i}; }`),sc(n.type)&&(e.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}});class owe extends $f{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],s=0;for(let l=0,c=t.length;l<c;l++){const d=t[l];d.options.className&&(i[s++]=d)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const d=l.options.className,u=c.options.className;return d<u?-1:d>u?1:N.compareRangesUsingStarts(l.range,c.range)});const o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,a=[];for(let l=o;l<=r;l++){const c=l-o;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const s=String(this._lineHeight),o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let a=0,l=t.length;a<l;a++){const c=t[a];if(!c.options.isWholeLine)continue;const d='<div class="cdr '+c.options.className+'" style="left:0;width:100%;height:'+s+'px;"></div>',u=Math.max(c.range.startLineNumber,o),h=Math.min(c.range.endLineNumber,r);for(let f=u;f<=h;f++){const g=f-o;i[g]+=d}}}_renderNormalDecorations(e,t,i){var s;const o=String(this._lineHeight),r=e.visibleRange.startLineNumber;let a=null,l=!1,c=null,d=!1;for(let u=0,h=t.length;u<h;u++){const f=t[u];if(f.options.isWholeLine)continue;const g=f.options.className,p=!!f.options.showIfCollapsed;let _=f.range;if(p&&_.endColumn===1&&_.endLineNumber!==_.startLineNumber&&(_=new N(_.startLineNumber,_.startColumn,_.endLineNumber-1,this._context.viewModel.getLineMaxColumn(_.endLineNumber-1))),a===g&&l===p&&N.areIntersectingOrTouching(c,_)){c=N.plusRange(c,_);continue}a!==null&&this._renderNormalDecoration(e,c,a,d,l,o,r,i),a=g,l=p,c=_,d=(s=f.options.shouldFillLineOnLineBreak)!==null&&s!==void 0?s:!1}a!==null&&this._renderNormalDecoration(e,c,a,d,l,o,r,i)}_renderNormalDecoration(e,t,i,s,o,r,a,l){const c=e.linesVisibleRangesForRange(t,i==="findMatch");if(c)for(let d=0,u=c.length;d<u;d++){const h=c[d];if(h.outsideRenderedLine)continue;const f=h.lineNumber-a;if(o&&h.ranges.length===1){const g=h.ranges[0];if(g.width<this._typicalHalfwidthCharacterWidth){const p=Math.round(g.left+g.width/2),_=Math.max(0,Math.round(p-this._typicalHalfwidthCharacterWidth/2));h.ranges[0]=new HD(_,this._typicalHalfwidthCharacterWidth)}}for(let g=0,p=h.ranges.length;g<p;g++){const _=s&&h.continuesOnNextLine&&p===1,v=h.ranges[g],b='<div class="cdr '+i+'" style="left:'+String(v.left)+(_?"px;width:100%;height:":"px;width:"+String(v.width)+"px;height:")+r+'px;"></div>';l[f]+=b}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class rwe extends ro{constructor(e,t,i,s){super(e);const o=this._context.configuration.options,r=o.get(102),a=o.get(74),l=o.get(40),c=o.get(105),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+ZT(e.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:r.scrollByPage};this.scrollbar=this._register(new OP(t.domNode,d,this._context.viewLayout.getScrollable())),Ja.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=bt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const u=(h,f,g)=>{const p={};if(f){const _=h.scrollTop;_&&(p.scrollTop=this._context.viewLayout.getCurrentScrollTop()+_,h.scrollTop=0)}if(g){const _=h.scrollLeft;_&&(p.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+_,h.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(p,1)};this._register(K(i.domNode,"scroll",h=>u(i.domNode,!0,!0))),this._register(K(t.domNode,"scroll",h=>u(t.domNode,!0,!1))),this._register(K(s.domNode,"scroll",h=>u(s.domNode,!0,!1))),this._register(K(this.scrollbarDomNode.domNode,"scroll",h=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(143);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(72).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(102)||e.hasChanged(74)||e.hasChanged(40)){const t=this._context.configuration.options,i=t.get(102),s=t.get(74),o=t.get(40),r=t.get(105),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:s,fastScrollSensitivity:o,scrollPredominantAxis:r};this.scrollbar.updateOptions(a)}return e.hasChanged(143)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+ZT(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class Hq extends Y{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function qD(n,e){let t=0,i=0;const s=n.length;for(;i<s;){const o=n.charCodeAt(i);if(o===32)t++;else if(o===9)t=t-t%e+e;else break;i++}return i===s?-1:t}var Gh;(function(n){n[n.Disabled=0]="Disabled",n[n.EnabledForActive=1]="EnabledForActive",n[n.Enabled=2]="Enabled"})(Gh||(Gh={}));class xh{constructor(e,t,i,s,o,r){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=s,this.forWrappedLinesAfterColumn=o,this.forWrappedLinesBeforeOrAtColumn=r,e!==-1==(t!==-1))throw new Error}}class M_{constructor(e,t){this.top=e,this.endColumn=t}}class awe extends Hq{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return qD(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const s=this.textModel.getLineCount();if(e<1||e>s)throw new ji("Illegal value for lineNumber");const o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide);let a=-2,l=-1,c=-2,d=-1;const u=x=>{if(a!==-1&&(a===-2||a>x-1)){a=-1,l=-1;for(let D=x-2;D>=0;D--){const k=this._computeIndentLevel(D);if(k>=0){a=D,l=k;break}}}if(c===-2){c=-1,d=-1;for(let D=x;D<s;D++){const k=this._computeIndentLevel(D);if(k>=0){c=D,d=k;break}}}};let h=-2,f=-1,g=-2,p=-1;const _=x=>{if(h===-2){h=-1,f=-1;for(let D=x-2;D>=0;D--){const k=this._computeIndentLevel(D);if(k>=0){h=D,f=k;break}}}if(g!==-1&&(g===-2||g<x-1)){g=-1,p=-1;for(let D=x;D<s;D++){const k=this._computeIndentLevel(D);if(k>=0){g=D,p=k;break}}}};let v=0,b=!0,y=0,w=!0,C=0,L=0;for(let x=0;b||w;x++){const D=e-x,k=e+x;x>1&&(D<1||D<t)&&(b=!1),x>1&&(k>s||k>i)&&(w=!1),x>5e4&&(b=!1,w=!1);let P=-1;if(b&&D>=1){const M=this._computeIndentLevel(D-1);M>=0?(c=D-1,d=M,P=Math.ceil(M/this.textModel.getOptions().indentSize)):(u(D),P=this._getIndentLevelForWhitespaceLine(r,l,d))}let O=-1;if(w&&k<=s){const M=this._computeIndentLevel(k-1);M>=0?(h=k-1,f=M,O=Math.ceil(M/this.textModel.getOptions().indentSize)):(_(k),O=this._getIndentLevelForWhitespaceLine(r,f,p))}if(x===0){L=P;continue}if(x===1){if(k<=s&&O>=0&&L+1===O){b=!1,v=k,y=k,C=O;continue}if(D>=1&&P>=0&&P-1===L){w=!1,v=D,y=D,C=P;continue}if(v=e,y=e,C=L,C===0)return{startLineNumber:v,endLineNumber:y,indent:C}}b&&(P>=C?v=D:b=!1),w&&(O>=C?y=k:w=!1)}return{startLineNumber:v,endLineNumber:y,indent:C}}getLinesBracketGuides(e,t,i,s){var o;const r=[];for(let h=e;h<=t;h++)r.push([]);const a=!0,l=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new N(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let c;if(i&&l.length>0){const h=(e<=i.lineNumber&&i.lineNumber<=t?l:this.textModel.bracketPairs.getBracketPairsInRange(N.fromPositions(i)).toArray()).filter(f=>N.strictContainsPosition(f.range,i));c=(o=RT(h,f=>a))===null||o===void 0?void 0:o.range}const d=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,u=new $q;for(const h of l){if(!h.closingBracketRange)continue;const f=c&&h.range.equalsRange(c);if(!f&&!s.includeInactive)continue;const g=u.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,d)+(s.highlightActive&&f?" "+u.activeClassName:""),p=h.openingBracketRange.getStartPosition(),_=h.closingBracketRange.getStartPosition(),v=s.horizontalGuides===Gh.Enabled||s.horizontalGuides===Gh.EnabledForActive&&f;if(h.range.startLineNumber===h.range.endLineNumber){v&&r[h.range.startLineNumber-e].push(new xh(-1,h.openingBracketRange.getEndPosition().column,g,new M_(!1,_.column),-1,-1));continue}const b=this.getVisibleColumnFromPosition(_),y=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),w=Math.min(y,b,h.minVisibleColumnIndentation+1);let C=!1;Zs(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(C=!0);const D=Math.max(p.lineNumber,e),k=Math.min(_.lineNumber,t),P=C?1:0;for(let O=D;O<k+P;O++)r[O-e].push(new xh(w,-1,g,null,O===p.lineNumber?p.column:-1,O===_.lineNumber?_.column:-1));v&&(p.lineNumber>=e&&y>w&&r[p.lineNumber-e].push(new xh(w,-1,g,new M_(!1,p.column),-1,-1)),_.lineNumber<=t&&b>w&&r[_.lineNumber-e].push(new xh(w,-1,g,new M_(!C,_.column),-1,-1)))}for(const h of r)h.sort((f,g)=>f.visibleColumn-g.visibleColumn);return r}getVisibleColumnFromPosition(e){return qi.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const s=this.textModel.getOptions(),o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(o&&o.offSide),a=new Array(t-e+1);let l=-2,c=-1,d=-2,u=-1;for(let h=e;h<=t;h++){const f=h-e,g=this._computeIndentLevel(h-1);if(g>=0){l=h-1,c=g,a[f]=Math.ceil(g/s.indentSize);continue}if(l===-2){l=-1,c=-1;for(let p=h-2;p>=0;p--){const _=this._computeIndentLevel(p);if(_>=0){l=p,c=_;break}}}if(d!==-1&&(d===-2||d<h-1)){d=-1,u=-1;for(let p=h;p<i;p++){const _=this._computeIndentLevel(p);if(_>=0){d=p,u=_;break}}}a[f]=this._getIndentLevelForWhitespaceLine(r,c,u)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const s=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/s.indentSize):t===i||e?Math.ceil(i/s.indentSize):1+Math.floor(i/s.indentSize)}}class $q{constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class lwe extends $f{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(144),s=t.get(50);this._lineHeight=t.get(66),this._spaceWidth=s.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(144),s=t.get(50);return this._lineHeight=t.get(66),this._spaceWidth=s.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*s.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){var t;const s=e.selections[0].getPosition();return!((t=this._primaryPosition)===null||t===void 0)&&t.equals(s)?!1:(this._primaryPosition=s,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var t,i,s,o;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const r=e.visibleRange.startLineNumber,a=e.visibleRange.endLineNumber,l=e.scrollWidth,c=this._lineHeight,d=this._primaryPosition,u=this.getGuidesByLine(r,Math.min(a+1,this._context.viewModel.getLineCount()),d),h=[];for(let f=r;f<=a;f++){const g=f-r,p=u[g];let _="";const v=(i=(t=e.visibleRangeForPosition(new V(f,1)))===null||t===void 0?void 0:t.left)!==null&&i!==void 0?i:0;for(const b of p){const y=b.column===-1?v+(b.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new V(f,b.column)).left;if(y>l||this._maxIndentLeft>0&&y>this._maxIndentLeft)break;const w=b.horizontalLine?b.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",C=b.horizontalLine?((o=(s=e.visibleRangeForPosition(new V(f,b.horizontalLine.endColumn)))===null||s===void 0?void 0:s.left)!==null&&o!==void 0?o:y+this._spaceWidth)-y:this._spaceWidth;_+=`<div class="core-guide ${b.className} ${w}" style="left:${y}px;height:${c}px;width:${C}px"></div>`}h[g]=_}this._renderResult=h}getGuidesByLine(e,t,i){const s=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Gh.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Gh.EnabledForActive:Gh.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let r=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const u=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);r=u.startLineNumber,a=u.endLineNumber,l=u.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),d=[];for(let u=e;u<=t;u++){const h=new Array;d.push(h);const f=s?s[u-e]:[],g=new gc(f),p=o?o[u-e]:0;for(let _=1;_<=p;_++){const v=(_-1)*c+1,b=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||f.length===0)&&r<=u&&u<=a&&_===l;h.push(...g.takeWhile(w=>w.visibleColumn<v)||[]);const y=g.peek();(!y||y.visibleColumn!==v||y.horizontalLine)&&h.push(new xh(v,-1,`core-guide-indent lvl-${(_-1)%30}`+(b?" indent-active":""),null,-1,-1))}h.push(...g.takeWhile(_=>!0)||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function gg(n){if(!(n&&n.isTransparent()))return n}Dr((n,e)=>{const t=[{bracketColor:Aq,guideColor:vye,guideColorActive:Lye},{bracketColor:Iq,guideColor:yye,guideColorActive:Dye},{bracketColor:Tq,guideColor:wye,guideColorActive:kye},{bracketColor:Nq,guideColor:Cye,guideColorActive:Eye},{bracketColor:Rq,guideColor:Sye,guideColorActive:Aye},{bracketColor:Mq,guideColor:xye,guideColorActive:Iye}],i=new $q,s=[{indentColor:dy,indentColorActive:uy},{indentColor:eye,indentColorActive:oye},{indentColor:tye,indentColorActive:rye},{indentColor:iye,indentColorActive:aye},{indentColor:nye,indentColorActive:lye},{indentColor:sye,indentColorActive:cye}],o=t.map(a=>{var l,c;const d=n.getColor(a.bracketColor),u=n.getColor(a.guideColor),h=n.getColor(a.guideColorActive),f=gg((l=gg(u))!==null&&l!==void 0?l:d==null?void 0:d.transparent(.3)),g=gg((c=gg(h))!==null&&c!==void 0?c:d);if(!(!f||!g))return{guideColor:f,guideColorActive:g}}).filter(ES),r=s.map(a=>{const l=n.getColor(a.indentColor),c=n.getColor(a.indentColorActive),d=gg(l),u=gg(c);if(!(!d||!u))return{indentColor:d,indentColorActive:u}}).filter(ES);if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class tE{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class cwe{constructor(){this._currentVisibleRange=new N(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class dwe{constructor(e,t,i,s,o,r,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=s,this.startScrollTop=o,this.stopScrollTop=r,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class uwe{constructor(e,t,i,s,o){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=s,this.scrollType=o,this.type="selections";let r=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const d=t[l];r=Math.min(r,d.startLineNumber),a=Math.max(a,d.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=a}}class GD extends ro{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Wq(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration,s=this._context.configuration.options,o=s.get(50),r=s.get(144);this._lineHeight=s.get(66),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=s.get(99),this._cursorSurroundingLines=s.get(29),this._cursorSurroundingLinesStyle=s.get(30),this._canUseLayerHinting=!s.get(32),this._viewLineOptions=new P7(i,this._context.theme.type),Ja.write(this.domNode,7),this.domNode.setClassName(`view-lines ${vp}`),Rn(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new Li(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new Li(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new cwe,this._horizontalRevealRequest=null,this._stickyScrollEnabled=s.get(114).enabled,this._maxNumberStickyLines=s.get(114).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new Ea(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(144)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(50),s=t.get(144);return this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=s.isViewportWrapping,this._revealHorizontalRightPadding=t.get(99),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(114).enabled,this._maxNumberStickyLines=t.get(114).maxLineCount,Rn(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(143)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new P7(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let o=i;o<=s;o++)this._visibleLines.getVisibleLine(o).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let s=!1;for(let o=t;o<=i;o++)s=this._visibleLines.getVisibleLine(o).onSelectionChanged()||s;return s}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++)this._visibleLines.getVisibleLine(s).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new dwe(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new uwe(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const o=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,o),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const s=this._getLineNumberFor(i);if(s===-1||s<1||s>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(s)===1)return new V(s,1);const o=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(s<o||s>r)return null;let a=this._visibleLines.getVisibleLine(s).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(s);return a<l&&(a=l),new V(s,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Ea.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let s=t;s<=i;s++){const o=this._visibleLines.getVisibleLine(s);if(e===o.getDomNode())return s}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const s=new tE(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getWidth(s);return this._updateLineWidthsSlowIfDomDidLayout(s),o}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,s=N.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!s)return null;const o=[];let r=0;const a=new tE(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(s.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let u=s.startLineNumber;u<=s.endLineNumber;u++){if(u<c||u>d)continue;const h=u===s.startLineNumber?s.startColumn:1,f=u!==s.endLineNumber,g=f?this._context.viewModel.getLineMaxColumn(u):s.endColumn,p=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,h,g,a);if(p){if(t&&u<i){const _=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new V(u+1,1)).lineNumber,_!==l&&(p.ranges[p.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[r++]=new y1e(p.outsideRenderedLine,u,HD.from(p.ranges),f)}}return this._updateLineWidthsSlowIfDomDidLayout(a),r===0?null:o}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const s=new tE(this.domNode.domNode,this._textRangeRestingSpot),o=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,s);return this._updateLineWidthsSlowIfDomDidLayout(s),o}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new w1e(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let s=1,o=!0;for(let r=t;r<=i;r++){const a=this._visibleLines.getVisibleLine(r);if(e&&!a.getWidthIsFast()){o=!1;continue}s=Math.max(s,a.getWidth(null))}return o&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(s),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let o=i;o<=s;o++){const r=this._visibleLines.getVisibleLine(o);if(r.needsMonospaceFontCheck()){const a=r.getWidth(null);a>t&&(t=a,e=o)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=i;o<=s;o++)this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const s=this._computeScrollLeftToReveal(i);s&&(this._isViewportWrapping||this._ensureMaxLineWidth(s.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:s.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),Xn&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),s=this._visibleLines.getEndLineNumber();for(let o=i;o<=s;o++)if(this._visibleLines.getVisibleLine(o).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,s,o,r){const a=e.top,l=e.height,c=a+l;let d,u,h;if(o&&o.length>0){let v=o[0].startLineNumber,b=o[0].endLineNumber;for(let y=1,w=o.length;y<w;y++){const C=o[y];v=Math.min(v,C.startLineNumber),b=Math.max(b,C.endLineNumber)}d=!1,u=this._context.viewLayout.getVerticalOffsetForLineNumber(v),h=this._context.viewLayout.getVerticalOffsetForLineNumber(b)+this._lineHeight}else if(s)d=!0,u=this._context.viewLayout.getVerticalOffsetForLineNumber(s.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(s.endLineNumber)+this._lineHeight;else return-1;const f=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let g=0,p=0;if(f)i||(g=this._lineHeight);else{const v=Math.min(l/this._lineHeight/2,this._cursorSurroundingLines);this._stickyScrollEnabled?g=Math.max(v,this._maxNumberStickyLines)*this._lineHeight:g=v*this._lineHeight,p=Math.max(0,v-1)*this._lineHeight}i||(r===0||r===4)&&(p+=this._lineHeight),u-=g,h+=p;let _;if(h-u>l){if(!d)return-1;_=u}else if(r===5||r===6)if(r===6&&a<=u&&h<=c)_=a;else{const v=Math.max(5*this._lineHeight,l*.2),b=u-v,y=h-l;_=Math.max(y,b)}else if(r===1||r===2)if(r===2&&a<=u&&h<=c)_=a;else{const v=(u+h)/2;_=Math.max(0,v-l/2)}else _=this._computeMinimumScrolling(a,c,u,h,r===3,r===4);return _}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(143),s=t.left,o=s+t.width-i.verticalScrollbarWidth;let r=1073741824,a=0;if(e.type==="range"){const c=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!c)return null;for(const d of c.ranges)r=Math.min(r,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const c of e.selections){if(c.startLineNumber!==c.endLineNumber)return null;const d=this._visibleRangesForLineRange(c.startLineNumber,c.startColumn,c.endColumn);if(!d)return null;for(const u of d.ranges)r=Math.min(r,Math.round(u.left)),a=Math.max(a,Math.round(u.left+u.width))}return e.minimalReveal||(r=Math.max(0,r-GD.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-r>t.width?null:{scrollLeft:this._computeMinimumScrolling(s,o,r,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,s,o,r){e=e|0,t=t|0,i=i|0,s=s|0,o=!!o,r=!!r;const a=t-e;if(s-i<a){if(o)return i;if(r)return Math.max(0,s-a);if(i<e)return i;if(s>t)return Math.max(0,s-a)}else return i;return e}}GD.HORIZONTAL_EXTRA_PX=30;class eN{constructor(e,t,i,s){this._decorationToRenderBrand=void 0,this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(i),this.zIndex=s??0}}class hwe{constructor(e,t){this.className=e,this.zIndex=t}}class fwe{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class Uq extends $f{_render(e,t,i){const s=[];for(let a=e;a<=t;a++){const l=a-e;s[l]=new fwe}if(i.length===0)return s;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let o=null,r=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.className,u=c.zIndex;let h=Math.max(c.startLineNumber,e)-e;const f=Math.min(c.endLineNumber,t)-e;o===d?(h=Math.max(r+1,h),r=Math.max(r,f)):(o=d,r=f);for(let g=h;g<=r;g++)s[g].add(new hwe(d,u))}return s}}class gwe extends ro{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(143);this.domNode=bt(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(66),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&N.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){var t;const i=e.getId();if(this._widgets[i]){const o=this._widgets[i].domNode.domNode;delete this._widgets[i],(t=o.parentNode)===null||t===void 0||t.removeChild(o),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){var i,s,o;const r=e.visibleRange.startLineNumber,a=e.visibleRange.endLineNumber,l=e.getDecorationsInViewport();for(const c of l){const d=c.options.glyphMarginClassName;if(!d)continue;const u=Math.max(c.range.startLineNumber,r),h=Math.min(c.range.endLineNumber,a),f=Math.min((s=(i=c.options.glyphMargin)===null||i===void 0?void 0:i.position)!==null&&s!==void 0?s:1,this._glyphMarginDecorationLaneCount),g=(o=c.options.zIndex)!==null&&o!==void 0?o:0;for(let p=u;p<=h;p++)t.push(new pwe(p,f,g,d))}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber;for(const o of Object.values(this._widgets)){const r=o.preference.range;if(r.endLineNumber<i||r.startLineNumber>s)continue;const a=Math.max(r.startLineNumber,i),l=Math.min(o.preference.lane,this._glyphMarginDecorationLaneCount);t.push(new mwe(a,l,o.preference.zIndex,o))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,s)=>i.lineNumber===s.lineNumber?i.lane===s.lane?i.zIndex===s.zIndex?s.type===i.type?i.type===0&&s.type===0?i.className<s.className?-1:1:0:s.type-i.type:s.zIndex-i.zIndex:i.lane-s.lane:i.lineNumber-s.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const s of Object.values(this._widgets))s.renderInfo=null;const t=new gc(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const s=t.peek();if(!s)break;const o=t.takeWhile(a=>a.lineNumber===s.lineNumber&&a.lane===s.lane);if(!o||o.length===0)break;const r=o[0];if(r.type===0){const a=[];for(const l of o){if(l.zIndex!==r.zIndex||l.type!==r.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(r.accept(a.join(" ")))}else r.widget.renderInfo={lineNumber:r.lineNumber,lane:r.lane}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const s=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],o=this._glyphMarginLeft+(i.renderInfo.lane-1)*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(s),i.domNode.setLeft(o),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const s=this._decorationGlyphsToRender[i],o=e.viewportData.relativeVerticalOffset[s.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+(s.lane-1)*this._lineHeight;let a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=bt(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+s.combinedClassName),a.setPosition("absolute"),a.setTop(o),a.setLeft(r),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;){const i=this._managedDomNodes.pop();i==null||i.domNode.remove()}}}class pwe{constructor(e,t,i,s){this.lineNumber=e,this.lane=t,this.zIndex=i,this.className=s,this.type=0}accept(e){return new _we(this.lineNumber,this.lane,e)}}class mwe{constructor(e,t,i,s){this.lineNumber=e,this.lane=t,this.zIndex=i,this.widget=s,this.type=1}}class _we{constructor(e,t,i){this.lineNumber=e,this.lane=t,this.combinedClassName=i}}class bwe extends Uq{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(143);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let s=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[s++]=new eN(a.range.startLineNumber,a.range.endLineNumber,l,c));const d=a.options.firstLineDecorationClassName;d&&(i[s++]=new eN(a.range.startLineNumber,a.range.startLineNumber,d,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,s=this._render(t,i,this._getDecorations(e)),o=this._decorationsLeft.toString(),r=this._decorationsWidth.toString(),a='" style="left:'+o+"px;width:"+r+'px;"></div>',l=[];for(let c=t;c<=i;c++){const d=c-t,u=s[d].getDecorations();let h="";for(const f of u)h+='<div class="cldr '+f.className+a;l[d]=h}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class vwe extends Uq{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let s=0;for(let o=0,r=t.length;o<r;o++){const a=t[o],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[s++]=new eN(a.range.startLineNumber,a.range.endLineNumber,l,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,s=this._render(t,i,this._getDecorations(e)),o=[];for(let r=t;r<=i;r++){const a=r-t,l=s[a].getDecorations();let c="";for(const d of l)c+='<div class="cmdr '+d.className+'" style=""></div>';o[a]=c}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Bo{constructor(e,t,i,s){this._rgba8Brand=void 0,this.r=Bo._clamp(e),this.g=Bo._clamp(t),this.b=Bo._clamp(i),this.a=Bo._clamp(s)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}}Bo.Empty=new Bo(0,0,0,0);class fy extends Y{static getInstance(){return this._INSTANCE||(this._INSTANCE=new fy),this._INSTANCE}constructor(){super(),this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(Si.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=Si.getColorMap();if(!e){this._colors=[Bo.Empty],this._backgroundIsLight=!0;return}this._colors=[Bo.Empty];for(let i=1;i<e.length;i++){const s=e[i].rgba;this._colors[i]=new Bo(s.r,s.g,s.b,Math.round(s.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}fy._INSTANCE=null;const ywe=(()=>{const n=[];for(let e=32;e<=126;e++)n.push(e);return n.push(65533),n})(),wwe=(n,e)=>(n-=32,n<0||n>96?e<=2?(n+96)%96:96-1:n);class ov{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=ov.soften(e,12/15),this.charDataLight=ov.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let s=0,o=e.length;s<o;s++)i[s]=GS(e[s]*t);return i}renderChar(e,t,i,s,o,r,a,l,c,d,u){const h=1*this.scale,f=2*this.scale,g=u?1:f;if(t+h>e.width||i+g>e.height){console.warn("bad render request outside image data");return}const p=d?this.charDataLight:this.charDataNormal,_=wwe(s,c),v=e.width*4,b=a.r,y=a.g,w=a.b,C=o.r-b,L=o.g-y,x=o.b-w,D=Math.max(r,l),k=e.data;let P=_*h*f,O=i*v+t*4;for(let M=0;M<g;M++){let R=O;for(let $=0;$<h;$++){const G=p[P++]/255*(r/255);k[R++]=b+C*G,k[R++]=y+L*G,k[R++]=w+x*G,k[R++]=D}O+=v}}blockRenderChar(e,t,i,s,o,r,a,l){const c=1*this.scale,d=2*this.scale,u=l?1:d;if(t+c>e.width||i+u>e.height){console.warn("bad render request outside image data");return}const h=e.width*4,f=.5*(o/255),g=r.r,p=r.g,_=r.b,v=s.r-g,b=s.g-p,y=s.b-_,w=g+v*f,C=p+b*f,L=_+y*f,x=Math.max(o,a),D=e.data;let k=i*h+t*4;for(let P=0;P<u;P++){let O=k;for(let M=0;M<c;M++)D[O++]=w,D[O++]=C,D[O++]=L,D[O++]=x;k+=h}}}const G7={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},K7=n=>{const e=new Uint8ClampedArray(n.length/2);for(let t=0;t<n.length;t+=2)e[t>>1]=G7[n[t]]<<4|G7[n[t+1]]&15;return e},Y7={1:um(()=>K7("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:um(()=>K7("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class P_{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return Y7[e]?i=new ov(Y7[e](),e):i=P_.createFromSampleData(P_.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let s=0;for(const o of ywe)i.fillText(String.fromCharCode(o),s,16/2),s+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const s=P_._downsample(e,t);return new ov(s,t)}static _downsampleChar(e,t,i,s,o){const r=1*o,a=2*o;let l=s,c=0;for(let d=0;d<a;d++){const u=d/a*16,h=(d+1)/a*16;for(let f=0;f<r;f++){const g=f/r*10,p=(f+1)/r*10;let _=0,v=0;for(let y=u;y<h;y++){const w=t+Math.floor(y)*3840,C=1-(y-Math.floor(y));for(let L=g;L<p;L++){const x=1-(L-Math.floor(L)),D=w+Math.floor(L)*4,k=x*C;v+=k,_+=e[D]*e[D+3]/255*k}}const b=_/v;c=Math.max(c,b),i[l++]=GS(b)}}return c}static _downsample(e,t){const i=2*t*1*t,s=i*96,o=new Uint8ClampedArray(s);let r=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,o,r,t)),r+=i,a+=10*4;if(l>0){const c=255/l;for(let d=0;d<s;d++)o[d]*=c}return o}}const Cwe=140,Swe=2;class rv{constructor(e,t,i){const s=e.options,o=s.get(141),r=s.get(143),a=r.minimap,l=s.get(50),c=s.get(72);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=s.get(104),this.paddingTop=s.get(83).top,this.paddingBottom=s.get(83).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=s.get(66),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=r.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=um(()=>P_.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=rv._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=rv._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(r1e);return i?new Bo(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(a1e);return t?Bo._clamp(Math.round(255*t.rgba.a)):255}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class O_{constructor(e,t,i,s,o,r,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=s,this.sliderTop=o,this.sliderHeight=r,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,s,o,r,a,l,c,d,u){const h=e.pixelRatio,f=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/f),p=e.lineHeight;if(e.minimapHeightIsEditorHeight){let L=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(L+=Math.max(0,o-e.lineHeight-e.paddingBottom));const x=Math.max(1,Math.floor(o*o/L)),D=Math.max(0,e.minimapHeight-x),k=D/(d-o),P=c*k,O=D>0,M=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),R=Math.floor(e.paddingTop/e.lineHeight);return new O_(c,d,O,k,P,x,R,1,Math.min(a,M))}let _;if(r&&i!==a){const L=i-t+1;_=Math.floor(L*f/h)}else{const L=o/p;_=Math.floor(L*f/h)}const v=Math.floor(e.paddingTop/p);let b=Math.floor(e.paddingBottom/p);if(e.scrollBeyondLastLine){const L=o/p;b=Math.max(b,L-1)}let y;if(b>0){const L=o/p;y=(v+a+b-L-1)*f/h}else y=Math.max(0,(v+a)*f/h-_);y=Math.min(e.minimapHeight-_,y);const w=y/(d-o),C=c*w;if(g>=v+a+b){const L=y>0;return new O_(c,d,L,w,C,_,v,1,a)}else{let L;t>1?L=t+v:L=Math.max(1,c/p);let x,D=Math.max(1,Math.floor(L-C*h/f));D<v?(x=v-D+1,D=1):(x=0,D=Math.max(1,D-v)),u&&u.scrollHeight===d&&(u.scrollTop>c&&(D=Math.min(D,u.startLineNumber),x=Math.max(x,u.topPaddingLineCount)),u.scrollTop<c&&(D=Math.max(D,u.startLineNumber),x=Math.min(x,u.topPaddingLineCount)));const k=Math.min(a,D-x+g-1),P=(c-s)/p;let O;return c>=e.paddingTop?O=(t-D+x+P)*f/h:O=c/e.paddingTop*(x+P)*f/h,new O_(c,d,!0,w,O,_,x,D,k)}}}class rx{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}rx.INVALID=new rx(-1);class Z7{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Bq(()=>rx.INVALID),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let s=0,o=i.length;s<o;s++)if(i[s].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class VP{constructor(e,t,i,s){this._backgroundFillData=VP._createBackgroundFillData(t,i,s),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const s=i.r,o=i.g,r=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let d=0;d<t;d++)for(let u=0;u<e;u++)l[c]=s,l[c+1]=o,l[c+2]=r,l[c+3]=a,c+=4;return l}}class av{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:s}=cp.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),o=t/s,r=o/2;if(!i||i.minimapLines.length===0){const _=[];if(_[0]=1,s>1){for(let v=0,b=s-1;v<b;v++)_[v]=Math.round(v*o+r);_[s-1]=t}return[new av(o,_),[]]}const a=i.minimapLines,l=a.length,c=[];let d=0,u=0,h=1;const f=10;let g=[],p=null;for(let _=0;_<s;_++){const v=Math.max(h,Math.round(_*o)),b=Math.max(v,Math.round((_+1)*o));for(;d<l&&a[d]<v;){if(g.length<f){const w=d+1+u;p&&p.type==="deleted"&&p._oldIndex===d-1?p.deleteToLineNumber++:(p={type:"deleted",_oldIndex:d,deleteFromLineNumber:w,deleteToLineNumber:w},g.push(p)),u--}d++}let y;if(d<l&&a[d]<=b)y=a[d],d++;else if(_===0?y=1:_+1===s?y=t:y=Math.round(_*o+r),g.length<f){const w=d+1+u;p&&p.type==="inserted"&&p._i===_-1?p.insertToLineNumber++:(p={type:"inserted",_i:_,insertFromLineNumber:w,insertToLineNumber:w},g.push(p)),u++}c[_]=y,h=y}if(g.length<f)for(;d<l;){const _=d+1+u;p&&p.type==="deleted"&&p._oldIndex===d-1?p.deleteToLineNumber++:(p={type:"deleted",_oldIndex:d,deleteFromLineNumber:_,deleteToLineNumber:_},g.push(p)),u--,d++}else g=[{type:"flush"}];return[new av(o,c),g]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let s=this.modelLineToMinimapLine(t)-1;for(;s+1<this.minimapLines.length&&this.minimapLines[s+1]<=t;)s++;if(i===s){const o=this.minimapLines[i];if(o<e||o>t)return null}return[i+1,s+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),s=this.modelLineToMinimapLine(t);return e!==t&&s===i&&(s===this.minimapLines.length?i>1&&i--:s++),[i,s]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,s=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,o),s=Math.max(s,o)):this.minimapLines[o]-=t;return[i,s]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class xwe extends ro{constructor(e){super(e),this.tokensColorTracker=fy.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new rv(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=av.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new ax(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new rv(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const s=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);s&&t.push({fromLineNumber:s[0],toLineNumber:s[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const s={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(s)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=av.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const s of i)switch(s.type){case"deleted":this._actual.onLinesDeleted(s.deleteFromLineNumber,s.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(s.insertFromLineNumber,s.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const s=[];for(let o=0,r=t-e+1;o<r;o++)i[o]?s[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):s[o]=null;return s}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new lt(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const o=this._samplingState.minimapLines[e-1],r=this._samplingState.minimapLines[t-1];i=new N(o,1,r,this._context.viewModel.getLineMaxColumn(r))}else i=new N(e,1,t,this._context.viewModel.getLineMaxColumn(t));const s=this._context.viewModel.getMinimapDecorationsInRange(i);if(this._samplingState){const o=[];for(const r of s){if(!r.options.minimap)continue;const a=r.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);o.push(new sq(new N(l,a.startColumn,c,a.endColumn),r.options))}return o}return s}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new N(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class ax extends Y{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(T7),this._domNode=bt(document.createElement("div")),Ja.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=bt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=bt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=bt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=bt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=bt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=Hi(this._domNode.domNode,de.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){const c=Nn(this._slider.domNode),d=c.top+c.height/2;this._startSliderDragging(i,d,this._lastRenderData.renderedLayout)}return}const o=this._model.options.minimapLineHeight,r=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let l=Math.floor(r/o)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new BD,this._sliderPointerDownListener=Hi(this._slider.domNode,de.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Rt.addTarget(this._domNode.domNode),this._sliderTouchStartListener=K(this._domNode.domNode,Pt.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=K(this._domNode.domNode,Pt.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=Hi(this._domNode.domNode,Pt.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const s=e.pageX;this._slider.toggleClassName("active",!0);const o=(r,a)=>{const l=Nn(this._domNode.domNode),c=Math.min(Math.abs(a-s),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(Ps&&c>Cwe){this._model.setScrollTop(i.scrollTop);return}const d=r-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(d))};e.pageY!==t&&o(e.pageY,s),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>o(r.pageY,r.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new VP(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){var i;return(i=this._lastRenderData)===null||i===void 0||i.onLinesDeleted(e,t),!0}onLinesInserted(e,t){var i;return(i=this._lastRenderData)===null||i===void 0||i.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(T7),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=O_.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(N.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((h,f)=>(h.options.zIndex||0)-(f.options.zIndex||0));const{canvasInnerWidth:s,canvasInnerHeight:o}=this._model.options,r=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,s,o);const d=new X7(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,d,e,r),this._renderDecorationsLineHighlights(c,i,d,e,r);const u=new X7(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,u,e,r,l,a,s),this._renderDecorationsHighlights(c,i,u,e,r,l,a,s)}}_renderSelectionLineHighlights(e,t,i,s,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,a=0;for(const l of t){const c=s.intersectWithViewport(l);if(!c)continue;const[d,u]=c;for(let g=d;g<=u;g++)i.set(g,!0);const h=s.getYForLineNumber(d,o),f=s.getYForLineNumber(u,o);a>=h||(a>r&&e.fillRect(Pc,r,e.canvas.width,a-r),r=h),a=f}a>r&&e.fillRect(Pc,r,e.canvas.width,a-r)}_renderDecorationsLineHighlights(e,t,i,s,o){const r=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==Xs.Inline)continue;const d=s.intersectWithViewport(l.range);if(!d)continue;const[u,h]=d,f=c.getColor(this._theme.value);if(!f||f.isTransparent())continue;let g=r.get(f.toString());g||(g=f.transparent(.5).toString(),r.set(f.toString(),g)),e.fillStyle=g;for(let p=u;p<=h;p++){if(i.has(p))continue;i.set(p,!0);const _=s.getYForLineNumber(u,o);e.fillRect(Pc,_,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,i,s,o,r,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const d=s.intersectWithViewport(c);if(!d)continue;const[u,h]=d;for(let f=u;f<=h;f++)this.renderDecorationOnLine(e,i,c,this._selectionColor,s,f,o,o,r,a,l)}}_renderDecorationsHighlights(e,t,i,s,o,r,a,l){for(const c of t){const d=c.options.minimap;if(!d)continue;const u=s.intersectWithViewport(c.range);if(!u)continue;const[h,f]=u,g=d.getColor(this._theme.value);if(!(!g||g.isTransparent()))for(let p=h;p<=f;p++)switch(d.position){case Xs.Inline:this.renderDecorationOnLine(e,i,c.range,g,s,p,o,o,r,a,l);continue;case Xs.Gutter:{const _=s.getYForLineNumber(p,o),v=2;this.renderDecoration(e,g,v,_,Swe,o);continue}}}}renderDecorationOnLine(e,t,i,s,o,r,a,l,c,d,u){const h=o.getYForLineNumber(r,l);if(h+a<0||h>this._model.options.canvasInnerHeight)return;const{startLineNumber:f,endLineNumber:g}=i,p=f===r?i.startColumn:1,_=g===r?i.endColumn:this._model.getLineMaxColumn(r),v=this.getXOffsetForPosition(t,r,p,c,d,u),b=this.getXOffsetForPosition(t,r,_,c,d,u);this.renderDecoration(e,s,v,h,b-v,a)}getXOffsetForPosition(e,t,i,s,o,r){if(i===1)return Pc;if((i-1)*o>=r)return r;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Pc];let d=Pc;for(let u=1;u<c.length+1;u++){const h=c.charCodeAt(u-1),f=h===9?s*o:Jd(h)?2*o:o,g=d+f;if(g>=r){l[u]=r;break}l[u]=g,d=g}e.set(t,l)}return i-1<l.length?l[i-1]:r}renderDecoration(e,t,i,s,o,r){e.fillStyle=t&&t.toString()||"",e.fillRect(i,s,o,r)}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,s=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const G=this._lastRenderData._get();return new Z7(e,G.imageData,G.lines)}const o=this._getBuffer();if(!o)return null;const[r,a,l]=ax._renderUntouchedLines(o,e.topPaddingLineCount,t,i,s,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),d=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,f=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,p=g.backgroundIsLight(),_=this._model.options.renderMinimap,v=this._model.options.charRenderer(),b=this._model.options.fontScale,y=this._model.options.minimapCharWidth,C=(_===1?2:2+1)*b,L=s>C?Math.floor((s-C)/2):0,x=h.a/255,D=new Bo(Math.round((h.r-u.r)*x+u.r),Math.round((h.g-u.g)*x+u.g),Math.round((h.b-u.b)*x+u.b),255);let k=e.topPaddingLineCount*s;const P=[];for(let G=0,ne=i-t+1;G<ne;G++)l[G]&&ax._renderLine(o,D,h.a,p,_,y,g,f,v,k,L,d,c[G],b,s),P[G]=new rx(k),k+=s;const O=r===-1?0:r,R=(a===-1?o.height:a)-O;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,O,o.width,R),new Z7(e,o,P)}static _renderUntouchedLines(e,t,i,s,o,r){const a=[];if(!r){for(let k=0,P=s-i+1;k<P;k++)a[k]=!0;return[-1,-1,a]}const l=r._get(),c=l.imageData.data,d=l.rendLineNumberStart,u=l.lines,h=u.length,f=e.width,g=e.data,p=(s-i+1)*o*f*4;let _=-1,v=-1,b=-1,y=-1,w=-1,C=-1,L=t*o;for(let k=i;k<=s;k++){const P=k-i,O=k-d,M=O>=0&&O<h?u[O].dy:-1;if(M===-1){a[P]=!0,L+=o;continue}const R=M*f*4,$=(M+o)*f*4,G=L*f*4,ne=(L+o)*f*4;y===R&&C===G?(y=$,C=ne):(b!==-1&&(g.set(c.subarray(b,y),w),_===-1&&b===0&&b===w&&(_=y),v===-1&&y===p&&b===w&&(v=b)),b=R,y=$,w=G,C=ne),a[P]=!1,L+=o}b!==-1&&(g.set(c.subarray(b,y),w),_===-1&&b===0&&b===w&&(_=y),v===-1&&y===p&&b===w&&(v=b));const x=_===-1?-1:_/(f*4),D=v===-1?-1:v/(f*4);return[x,D,a]}static _renderLine(e,t,i,s,o,r,a,l,c,d,u,h,f,g,p){const _=f.content,v=f.tokens,b=e.width-r,y=p===1;let w=Pc,C=0,L=0;for(let x=0,D=v.getCount();x<D;x++){const k=v.getEndOffset(x),P=v.getForeground(x),O=a.getColor(P);for(;C<k;C++){if(w>b)return;const M=_.charCodeAt(C);if(M===9){const R=h-(C+L)%h;L+=R-1,w+=R*r}else if(M===32)w+=r;else{const R=Jd(M)?2:1;for(let $=0;$<R;$++)if(o===2?c.blockRenderChar(e,w,d+u,O,l,t,i,y):c.renderChar(e,w,d+u,M,O,l,t,i,g,s,y),w+=r,w>b)return}}}}}class X7{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let s=0,o=this._endLineNumber-this._startLineNumber+1;s<o;s++)this._values[s]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class Lwe extends ro{constructor(e){super(e);const i=this._context.configuration.options.get(143);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._domNode=bt(document.createElement("div")),Ja.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(143);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference===t?(this._updateMaxMinWidth(),!1):(i.preference=t,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const s=this._widgets[t].domNode.domNode;delete this._widgets[t],s.parentNode.removeChild(s),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){var e,t;let i=0;const s=Object.keys(this._widgets);for(let o=0,r=s.length;o<r;o++){const a=s[o],c=(t=(e=this._widgets[a].widget).getMinContentWidthInPx)===null||t===void 0?void 0:t.call(e);typeof c<"u"&&(i=Math.max(i,c))}this._context.viewLayout.setOverlayWidgetsMinWidth(i)}_renderWidget(e){const t=e.domNode;if(e.preference===null){t.setTop("");return}if(e.preference===0)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(e.preference===1){const i=t.domNode.clientHeight;t.setTop(this._editorHeight-i-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else e.preference===2&&(t.setTop(0),t.domNode.style.right="50%")}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets);for(let i=0,s=t.length;i<s;i++){const o=t[i];this._renderWidget(this._widgets[o])}}}class Dwe{constructor(e,t){const i=e.options;this.lineHeight=i.get(66),this.pixelRatio=i.get(141),this.overviewRulerLanes=i.get(82),this.renderBorder=i.get(81);const s=t.getColor(uye);this.borderColor=s?s.toString():null,this.hideCursor=i.get(59);const o=t.getColor(Eq);this.cursorColor=o?o.transparent(.7).toString():null,this.themeType=t.type;const r=i.get(72),a=r.enabled,l=r.side,c=t.getColor(hye),d=Si.getDefaultBackground();c?this.backgroundColor=c:a&&l==="right"?this.backgroundColor=d:this.backgroundColor=null;const h=i.get(143).overviewRuler;this.top=h.top,this.right=h.right,this.domWidth=h.width,this.domHeight=h.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[f,g]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=f,this.w=g}_initLanes(e,t,i){const s=t-e;if(i>=3){const o=Math.floor(s/3),r=Math.floor(s/3),a=s-o-r,l=e,c=l+o,d=l+o+a;return[[0,l,c,l,d,l,c,l],[0,o,a,o+a,r,o+a+r,a+r,o+a+r]]}else if(i===2){const o=Math.floor(s/2),r=s-o,a=e,l=a+o;return[[0,a,a,a,l,a,a,a],[0,o,o,o,r,o+r,o+r,o+r]]}else{const o=e,r=s;return[[0,o,o,o,o,o,o,o],[0,r,r,r,r,r,r,r]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&z.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class kwe extends ro{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Si.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Dwe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++)this._cursorPositions[t]=e.selections[t].getPosition();return this._cursorPositions.sort(V.compare),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?z.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Yb.compareByRenderingProps),this._actualShouldRender===1&&!Yb.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!Ki(this._renderedCursorPositions,this._cursorPositions,(g,p)=>g.lineNumber===p.lineNumber)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,s=this._settings.canvasHeight,o=this._settings.lineHeight,r=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=s/a,c=6*this._settings.pixelRatio|0,d=c/2|0,u=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(u.fillStyle=z.Format.CSS.formatHexA(e),u.fillRect(0,0,i,s)):(u.clearRect(0,0,i,s),u.fillStyle=z.Format.CSS.formatHexA(e),u.fillRect(0,0,i,s)):u.clearRect(0,0,i,s);const h=this._settings.x,f=this._settings.w;for(const g of t){const p=g.color,_=g.data;u.fillStyle=p;let v=0,b=0,y=0;for(let w=0,C=_.length/3;w<C;w++){const L=_[3*w],x=_[3*w+1],D=_[3*w+2];let k=r.getVerticalOffsetForLineNumber(x)*l|0,P=(r.getVerticalOffsetForLineNumber(D)+o)*l|0;if(P-k<c){let M=(k+P)/2|0;M<d?M=d:M+d>s&&(M=s-d),k=M-d,P=M+d}k>y+1||L!==v?(w!==0&&u.fillRect(h[v],b,f[v],y-b),v=L,b=k,y=P):P>y&&(y=P)}u.fillRect(h[v],b,f[v],y-b)}if(!this._settings.hideCursor&&this._settings.cursorColor){const g=2*this._settings.pixelRatio|0,p=g/2|0,_=this._settings.x[7],v=this._settings.w[7];u.fillStyle=this._settings.cursorColor;let b=-100,y=-100;for(let w=0,C=this._cursorPositions.length;w<C;w++){const L=this._cursorPositions[w];let x=r.getVerticalOffsetForLineNumber(L.lineNumber)*l|0;x<p?x=p:x+p>s&&(x=s-p);const D=x-p,k=D+g;D>y+1?(w!==0&&u.fillRect(_,b,v,y-b),b=D,y=k):k>y&&(y=k)}u.fillRect(_,b,v,y-b)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(u.beginPath(),u.lineWidth=1,u.strokeStyle=this._settings.borderColor,u.moveTo(0,0),u.lineTo(0,s),u.stroke(),u.moveTo(0,0),u.lineTo(i,0),u.stroke())}}class Q7{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class jq{constructor(e,t,i,s){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=s,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class Ewe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(jq.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),s=Math.floor(this._outerHeight),o=i/s,r=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const d=this._zones[l];if(!e){const w=d.getColorZones();if(w){a.push(w);continue}}const u=this._getVerticalOffsetForLine(d.startLineNumber),h=d.heightInLines===0?this._getVerticalOffsetForLine(d.endLineNumber)+t:u+d.heightInLines*t,f=Math.floor(o*u),g=Math.floor(o*h);let p=Math.floor((f+g)/2),_=g-p;_<r&&(_=r),p-_<0&&(p=_),p+_>i&&(p=i-_);const v=d.color;let b=this._color2Id[v];b||(b=++this._lastAssignedId,this._color2Id[v]=b,this._id2Color[b]=v);const y=new Q7(p-_,p+_,b);d.setColorZone(y),a.push(y)}return this._colorZonesInvalid=!1,a.sort(Q7.compare),a}}class Awe extends ly{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Ewe(s=>this._context.viewLayout.getVerticalOffsetForLineNumber(s)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(66)),this._zoneManager.setPixelRatio(i.get(141)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(66)&&(this._zoneManager.setLineHeight(t.get(66)),this._render()),e.hasChanged(141)&&(this._zoneManager.setPixelRatio(t.get(141)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),s=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(o,i,s,e),!0}_renderOneLane(e,t,i,s){let o=0,r=0,a=0;for(const l of t){const c=l.colorId,d=l.from,u=l.to;c!==o?(e.fillRect(0,r,s,a-r),o=c,e.fillStyle=i[o],r=d,a=u):a>=d?a=Math.max(a,u):(e.fillRect(0,r,s,a-r),r=d,a=u)}e.fillRect(0,r,s,a-r)}}class Iwe extends ro{constructor(e){super(e),this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(101),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(101),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:s}=this._context.viewModel.model.getOptions(),o=s;let r=t-e;for(;r>0;){const a=bt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(o),this.domNode.appendChild(a),this._renderedRulers.push(a),r--}return}let i=e-t;for(;i>0;){const s=this._renderedRulers.pop();this.domNode.removeChild(s),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const s=this._renderedRulers[t],o=this._rulers[t];s.setBoxShadow(o.color?`1px 0 0 0 ${o.color} inset`:""),s.setHeight(Math.min(e.scrollHeight,1e6)),s.setLeft(o.column*this._typicalHalfwidthCharacterWidth)}}}class Twe extends ro{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(102);this._useShadows=i.useShadows,this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(143);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(102);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class Nwe{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class Rwe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function Mwe(n){return new Nwe(n)}function Pwe(n){return new Rwe(n.lineNumber,n.ranges.map(Mwe))}class gi extends $f{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(66),this._roundedSelection=t.get(100),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(66),this._roundedSelection=t.get(100),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const s=this._typicalHalfwidthCharacterWidth/4;let o=null,r=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!o&&c<i.length;c++)i[c].lineNumber===a&&(o=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!r&&c>=0;c--)i[c].lineNumber===l&&(r=i[c].ranges[0]);o&&!o.startStyle&&(o=null),r&&!r.startStyle&&(r=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],d=c.left,u=c.left+c.width,h={top:0,bottom:0},f={top:0,bottom:0};if(a>0){const g=t[a-1].ranges[0].left,p=t[a-1].ranges[0].left+t[a-1].ranges[0].width;vw(d-g)<s?h.top=2:d>g&&(h.top=1),vw(u-p)<s?f.top=2:g<u&&u<p&&(f.top=1)}else o&&(h.top=o.startStyle.top,f.top=o.endStyle.top);if(a+1<l){const g=t[a+1].ranges[0].left,p=t[a+1].ranges[0].left+t[a+1].ranges[0].width;vw(d-g)<s?h.bottom=2:g<d&&d<p&&(h.bottom=1),vw(u-p)<s?f.bottom=2:u<p&&(f.bottom=1)}else r&&(h.bottom=r.startStyle.bottom,f.bottom=r.endStyle.bottom);c.startStyle=h,c.endStyle=f}}_getVisibleRangesWithStyle(e,t,i){const o=(t.linesVisibleRangesForRange(e,!0)||[]).map(Pwe);return!this._visibleRangesHaveGaps(o)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,o,i),o}_createSelectionPiece(e,t,i,s,o){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;left:"+s.toString()+"px;width:"+o.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,i,s){if(s.length===0)return;const o=!!s[0].ranges[0].startStyle,r=this._lineHeight.toString(),a=(this._lineHeight-1).toString(),l=s[0].lineNumber,c=s[s.length-1].lineNumber;for(let d=0,u=s.length;d<u;d++){const h=s[d],f=h.lineNumber,g=f-t,p=i&&(f===c||f===l)?a:r,_=i&&f===l?1:0;let v="",b="";for(let y=0,w=h.ranges.length;y<w;y++){const C=h.ranges[y];if(o){const x=C.startStyle,D=C.endStyle;if(x.top===1||x.bottom===1){v+=this._createSelectionPiece(_,p,gi.SELECTION_CLASS_NAME,C.left-gi.ROUNDED_PIECE_WIDTH,gi.ROUNDED_PIECE_WIDTH);let k=gi.EDITOR_BACKGROUND_CLASS_NAME;x.top===1&&(k+=" "+gi.SELECTION_TOP_RIGHT),x.bottom===1&&(k+=" "+gi.SELECTION_BOTTOM_RIGHT),v+=this._createSelectionPiece(_,p,k,C.left-gi.ROUNDED_PIECE_WIDTH,gi.ROUNDED_PIECE_WIDTH)}if(D.top===1||D.bottom===1){v+=this._createSelectionPiece(_,p,gi.SELECTION_CLASS_NAME,C.left+C.width,gi.ROUNDED_PIECE_WIDTH);let k=gi.EDITOR_BACKGROUND_CLASS_NAME;D.top===1&&(k+=" "+gi.SELECTION_TOP_LEFT),D.bottom===1&&(k+=" "+gi.SELECTION_BOTTOM_LEFT),v+=this._createSelectionPiece(_,p,k,C.left+C.width,gi.ROUNDED_PIECE_WIDTH)}}let L=gi.SELECTION_CLASS_NAME;if(o){const x=C.startStyle,D=C.endStyle;x.top===0&&(L+=" "+gi.SELECTION_TOP_LEFT),x.bottom===0&&(L+=" "+gi.SELECTION_BOTTOM_LEFT),D.top===0&&(L+=" "+gi.SELECTION_TOP_RIGHT),D.bottom===0&&(L+=" "+gi.SELECTION_BOTTOM_RIGHT)}b+=this._createSelectionPiece(_,p,L,C.left,C.width)}e[g][0]+=v,e[g][1]+=b}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber;for(let r=i;r<=s;r++){const a=r-i;t[a]=["",""]}const o=[];for(let r=0,a=this._selections.length;r<a;r++){const l=this._selections[r];if(l.isEmpty()){o[r]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[r]);o[r]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map(([r,a])=>r+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}gi.SELECTION_CLASS_NAME="selected-text";gi.SELECTION_TOP_LEFT="top-left-radius";gi.SELECTION_BOTTOM_LEFT="bottom-left-radius";gi.SELECTION_TOP_RIGHT="top-right-radius";gi.SELECTION_BOTTOM_RIGHT="bottom-right-radius";gi.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";gi.ROUNDED_PIECE_WIDTH=10;Dr((n,e)=>{const t=n.getColor(_ve);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function vw(n){return n<0?-n:n}class J7{constructor(e,t,i,s,o,r,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=s,this.height=o,this.textContent=r,this.textContentClassName=a}}class e8{constructor(e){this._context=e;const t=this._context.configuration.options,i=t.get(50);this._cursorStyle=t.get(28),this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(`cursor ${vp}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Rn(this._domNode,i),this._domNode.setDisplay("none"),this._position=new V(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(50);return this._cursorStyle=t.get(28),this._lineHeight=t.get(66),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),Rn(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[s,o]=Kge(i,t-1);return[new V(e,s+1),i.substring(s,o)]}_prepareRender(e){let t="",i="";const[s,o]=this._getGraphemeAwarePosition();if(this._cursorStyle===fn.Line||this._cursorStyle===fn.LineThin){const h=e.visibleRangeForPosition(s);if(!h||h.outsideRenderedLine)return null;let f;this._cursorStyle===fn.Line?(f=A9(this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=o,i=this._getTokenClassName(s))):f=A9(1);let g=h.left,p=0;f>=2&&g>=1&&(p=1,g-=p);const _=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.bigNumbersDelta;return new J7(_,g,p,f,this._lineHeight,t,i)}const r=e.linesVisibleRangesForRange(new N(s.lineNumber,s.column,s.lineNumber,s.column+o.length),!1);if(!r||r.length===0)return null;const a=r[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;const l=a.ranges[0],c=o==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===fn.Block&&(t=o,i=this._getTokenClassName(s));let d=e.getVerticalOffsetForLineNumber(s.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===fn.Underline||this._cursorStyle===fn.UnderlineThin)&&(d+=this._lineHeight-2,u=2),new J7(d,l.left,0,c,u,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${vp} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class lv extends ro{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(90),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new e8(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Cc,this._cursorFlatBlinkInterval=new sy,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(90),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,s=this._secondaryCursors.length;i<s;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const s=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.onCursorPositionChanged(e,s),this._updateBlinking(),this._secondaryCursors.length<t.length){const o=t.length-this._secondaryCursors.length;for(let r=0;r<o;r++){const a=new e8(this._context);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const o=this._secondaryCursors.length-t.length;for(let r=0;r<o;r++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let o=0;o<t.length;o++)this._secondaryCursors[o].onCursorPositionChanged(t[o],s)}onCursorStateChanged(e){const t=[];for(let s=0,o=e.selections.length;s<o;s++)t[s]=e.selections[s].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let s=0,o=e.ranges.length;s<o;s++)if(e.ranges[s].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[s].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},lv.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},lv.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case fn.Line:e+=" cursor-line-style";break;case fn.Block:e+=" cursor-block-style";break;case fn.Underline:e+=" cursor-underline-style";break;case fn.LineThin:e+=" cursor-line-thin-style";break;case fn.BlockOutline:e+=" cursor-block-outline-style";break;case fn.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const s=this._primaryCursor.render(e);s&&(t[i++]=s);for(let o=0,r=this._secondaryCursors.length;o<r;o++){const a=this._secondaryCursors[o].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}}lv.BLINK_INTERVAL=500;Dr((n,e)=>{const t=n.getColor(Eq);if(t){let i=n.getColor(Q1e);i||(i=t.opposite()),e.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${t}; border-color: ${t}; color: ${i}; }`),sc(n.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${i}; border-right: 1px solid ${i}; }`)}});const iE=()=>{throw new Error("Invalid change accessor")};class Owe extends ro{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(143);this._lineHeight=t.get(66),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=bt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=bt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const s of e)t.set(s.id,s);let i=!1;return this._context.viewModel.changeWhitespace(s=>{const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l],d=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=d.isInHiddenArea;const u=t.get(l);u&&(u.afterLineNumber!==d.afterViewLineNumber||u.height!==d.heightInPx)&&(s.changeOneWhitespace(l,d.afterViewLineNumber,d.heightInPx),this._safeCallOnComputedHeight(c.delegate,d.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(143);return this._lineHeight=t.get(66),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(66)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){var t,i;return(i=(t=e.ordinal)!==null&&t!==void 0?t:e.afterColumn)!==null&&i!==void 0?i:1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const r=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new V(r,this._context.viewModel.model.getLineMaxColumn(r))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),o=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:s.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const s={addZone:o=>(t=!0,this._addZone(i,o)),removeZone:o=>{o&&(t=this._removeZone(i,o)||t)},layoutZone:o=>{o&&(t=this._layoutZone(i,o)||t)}};Fwe(e,s),s.addZone=iE,s.removeZone=iE,s.layoutZone=iE}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),o={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:bt(t.domNode),marginDomNode:t.marginDomNode?bt(t.marginDomNode):null};return this._safeCallOnComputedHeight(o.delegate,i.heightInPx),o.domNode.setPosition("absolute"),o.domNode.domNode.style.width="100%",o.domNode.setDisplay("none"),o.domNode.setAttribute("monaco-view-zone",o.whitespaceId),this.domNode.appendChild(o.domNode),o.marginDomNode&&(o.marginDomNode.setPosition("absolute"),o.marginDomNode.domNode.style.width="100%",o.marginDomNode.setDisplay("none"),o.marginDomNode.setAttribute("monaco-view-zone",o.whitespaceId),this.marginDomNode.appendChild(o.marginDomNode)),this._zones[o.whitespaceId]=o,this.setShouldRender(),o.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.parentNode.removeChild(i.domNode.domNode),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.parentNode.removeChild(i.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],s=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=s.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,s.afterViewLineNumber,s.heightInPx),this._safeCallOnComputedHeight(i.delegate,s.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){mt(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){mt(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let s=!1;for(const r of t)this._zones[r.id].isInHiddenArea||(i[r.id]=r,s=!0);const o=Object.keys(this._zones);for(let r=0,a=o.length;r<a;r++){const l=o[r],c=this._zones[l];let d=0,u=0,h="none";i.hasOwnProperty(l)?(d=i[l].verticalOffset-e.bigNumbersDelta,u=i[l].height,h="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(d),c.domNode.setHeight(u),c.domNode.setDisplay(h),c.marginDomNode&&(c.marginDomNode.setTop(d),c.marginDomNode.setHeight(u),c.marginDomNode.setDisplay(h))}s&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function Fwe(n,e){try{return n(e)}catch(t){mt(t)}}class Bwe{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class Wwe{constructor(e,t,i){this.configuration=e,this.theme=new Bwe(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}class Vwe{constructor(e,t,i,s){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.whitespaceViewportData=i,this._model=s,this.visibleRange=new N(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class zwe extends ro{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(143),s=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==s&&(this.contentWidth=s,e=!0);const o=i.contentLeft;return this.contentLeft!==o&&(this.contentLeft=o,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){var t;let i=0;const s=e.getDecorationsInViewport();for(const o of s){if(!o.options.blockClassName)continue;let r=this.blocks[i];r||(r=this.blocks[i]=bt(document.createElement("div")),this.domNode.appendChild(r));let a,l;o.options.blockIsAfterEnd?(a=e.getVerticalOffsetAfterLineNumber(o.range.endLineNumber,!1),l=e.getVerticalOffsetAfterLineNumber(o.range.endLineNumber,!0)):(a=e.getVerticalOffsetForLineNumber(o.range.startLineNumber,!0),l=o.range.isEmpty()&&!o.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(o.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(o.range.endLineNumber,!0));const[c,d,u,h]=(t=o.options.blockPadding)!==null&&t!==void 0?t:[0,0,0,0];r.setClassName("blockDecorations-block "+o.options.blockClassName),r.setLeft(this.contentLeft-h),r.setWidth(this.contentWidth+h+d),r.setTop(a-e.scrollTop-c),r.setHeight(l-a+c+u),i++}for(let o=i;o<this.blocks.length;o++)this.blocks[o].domNode.remove();this.blocks.length=i}}class Hwe extends $f{constructor(e){super(),this._context=e,this._options=new t8(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new t8(this._context.configuration);return this._options.equals(t)?e.hasChanged(143):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber-t+1,o=new Array(s);for(let a=0;a<s;a++)o[a]=!0;const r=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,o);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){const l=a-e.viewportData.startLineNumber,c=r.data[l];let d=null;if(this._options.renderWhitespace==="selection"){const u=this._selection;for(const h of u){if(h.endLineNumber<a||h.startLineNumber>a)continue;const f=h.startLineNumber===a?h.startColumn:c.minColumn,g=h.endLineNumber===a?h.endColumn:c.maxColumn;f<g&&(d||(d=[]),d.push(new tq(f-1,g-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,d,c)}}_applyRenderWhitespace(e,t,i,s){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&s.continuesWithWrappedLine)return"";const o=this._context.theme.getColor(Ql),r=this._options.renderWithSVG,a=s.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=s.continuesWithWrappedLine,d=s.minColumn-1,u=this._options.renderWhitespace==="boundary",h=this._options.renderWhitespace==="trailing",f=this._options.lineHeight,g=this._options.middotWidth,p=this._options.wsmiddotWidth,_=this._options.spaceWidth,v=Math.abs(p-_),b=Math.abs(g-_),y=v<b?11825:183,w=this._options.canUseHalfwidthRightwardsArrow;let C="",L=!1,x=Zs(a),D;x===-1?(L=!0,x=l,D=l):D=Of(a);let k=0,P=i&&i[k],O=0;for(let M=d;M<l;M++){const R=a.charCodeAt(M);if(P&&M>=P.endOffset&&(k++,P=i&&i[k]),R!==9&&R!==32||h&&!L&&M<=D)continue;if(u&&M>=x&&M<=D&&R===32){const G=M-1>=0?a.charCodeAt(M-1):0,ne=M+1<l?a.charCodeAt(M+1):0;if(G!==32&&ne!==32)continue}if(u&&c&&M===l-1){const G=M-1>=0?a.charCodeAt(M-1):0;if(R===32&&G!==32&&G!==9)continue}if(i&&(!P||P.startOffset>M||P.endOffset<=M))continue;const $=e.visibleRangeForPosition(new V(t,M+1));$&&(r?(O=Math.max(O,$.left),R===9?C+=this._renderArrow(f,_,$.left):C+=`<circle cx="${($.left+_/2).toFixed(2)}" cy="${(f/2).toFixed(2)}" r="${(_/7).toFixed(2)}" />`):R===9?C+=`<div class="mwh" style="left:${$.left}px;height:${f}px;">${w?String.fromCharCode(65515):String.fromCharCode(8594)}</div>`:C+=`<div class="mwh" style="left:${$.left}px;height:${f}px;">${String.fromCharCode(y)}</div>`)}return r?(O=Math.round(O+_),`<svg style="position:absolute;width:${O}px;height:${f}px" viewBox="0 0 ${O} ${f}" xmlns="http://www.w3.org/2000/svg" fill="${o}">`+C+"</svg>"):C}_renderArrow(e,t,i){const s=t/7,o=t,r=e/2,a=i,l={x:0,y:s/2},c={x:100/125*o,y:l.y},d={x:c.x-.2*c.x,y:c.y+.2*c.x},u={x:d.x+.1*c.x,y:d.y+.1*c.x},h={x:u.x+.35*c.x,y:u.y-.35*c.x},f={x:h.x,y:-h.y},g={x:u.x,y:-u.y},p={x:d.x,y:-d.y},_={x:c.x,y:-c.y},v={x:l.x,y:-l.y};return`<path d="M ${[l,c,d,u,h,f,g,p,_,v].map(w=>`${(a+w.x).toFixed(2)} ${(r+w.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class t8{constructor(e){const t=e.options,i=t.get(50),s=t.get(38);s==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):s==="svg"?(this.renderWhitespace=t.get(98),this.renderWithSVG=!0):(this.renderWhitespace=t.get(98),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(66),this.stopRenderingLineAfter=t.get(116)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}var $we=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Uwe=function(n,e){return function(t,i){e(t,i,n)}};let tN=class extends ly{constructor(e,t,i,s,o,r,a){super(),this._instantiationService=a,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new lt(1,1,1,1)],this._renderAnimationFrame=null;const l=new Xye(t,s,o,e);this._context=new Wwe(t,i,s),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(XT,this._context,l,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=bt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=bt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=bt(document.createElement("div")),Ja.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new rwe(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new GD(this._context,this._linesContent),this._viewZones=new Owe(this._context),this._viewParts.push(this._viewZones);const c=new kwe(this._context);this._viewParts.push(c);const d=new Twe(this._context);this._viewParts.push(d);const u=new Jye(this._context);this._viewParts.push(u),u.addDynamicOverlay(new nwe(this._context)),u.addDynamicOverlay(new gi(this._context)),u.addDynamicOverlay(new lwe(this._context)),u.addDynamicOverlay(new owe(this._context)),u.addDynamicOverlay(new Hwe(this._context));const h=new ewe(this._context);this._viewParts.push(h),h.addDynamicOverlay(new swe(this._context)),h.addDynamicOverlay(new vwe(this._context)),h.addDynamicOverlay(new bwe(this._context)),h.addDynamicOverlay(new hy(this._context)),this._glyphMarginWidgets=new gwe(this._context),this._viewParts.push(this._glyphMarginWidgets);const f=new pf(this._context);f.getDomNode().appendChild(this._viewZones.marginDomNode),f.getDomNode().appendChild(h.getDomNode()),f.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(f),this._contentWidgets=new twe(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new lv(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Lwe(this._context),this._viewParts.push(this._overlayWidgets);const g=new Iwe(this._context);this._viewParts.push(g);const p=new zwe(this._context);this._viewParts.push(p);const _=new xwe(this._context);if(this._viewParts.push(_),c){const v=this._scrollbar.getOverviewRulerLayoutInfo();v.parent.insertBefore(c.getDomNode(),v.insertBefore)}this._linesContent.appendChild(u.getDomNode()),this._linesContent.appendChild(g.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(f.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(_.getDomNode()),this._overflowGuardContainer.appendChild(p.domNode),this.domNode.appendChild(this._overflowGuardContainer),r?r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new Y1e(this._context,l,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._shouldRecomputeGlyphMarginLanes&&(this._shouldRecomputeGlyphMarginLanes=!1,this._context.configuration.setGlyphMarginDecorationLaneCount(this._computeGlyphMarginLaneCount())),hd.onRenderStart(),this._renderNow()}_computeGlyphMarginLaneCount(){const e=this._context.viewModel.model;let t=[];t=t.concat(e.getAllMarginDecorations().map(o=>{var r,a;const l=(a=(r=o.options.glyphMargin)===null||r===void 0?void 0:r.position)!==null&&a!==void 0?a:pp.Left;return{range:o.range,lane:l}})),t=t.concat(this._glyphMarginWidgets.getWidgets().map(o=>({range:e.validateRange(o.preference.range),lane:o.preference.lane}))),t.sort((o,r)=>N.compareRangesUsingStarts(o.range,r.range));let i=null,s=null;for(const o of t)if(o.lane===pp.Left&&(!i||N.compareRangesUsingEnds(i,o.range)<0)&&(i=o.range),o.lane===pp.Right&&(!s||N.compareRangesUsingEnds(s,o.range)<0)&&(s=o.range),i&&s){if(i.endLineNumber<s.startLineNumber){i=null;continue}if(s.endLineNumber<i.startLineNumber){s=null;continue}return 2}return 1}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new D1e(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new V(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const t=this._context.configuration.options.get(143);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(140)+" "+ZT(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){this._renderAnimationFrame===null&&(this._renderAnimationFrame=mj(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){jwe(()=>this._actualRender())}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!uP(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new Vwe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const s=new v1e(this._context.viewLayout,i,this._viewLines);for(const o of e)o.prepareRender(s);for(const o of e)o.render(s),o.onDidRender()}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),s=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const o=this._viewLines.visibleRangeForPosition(new V(s.lineNumber,s.column));return o?o.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?jD.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new Awe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){var t,i,s,o,r,a,l,c;this._contentWidgets.setWidgetPosition(e.widget,(i=(t=e.position)===null||t===void 0?void 0:t.position)!==null&&i!==void 0?i:null,(o=(s=e.position)===null||s===void 0?void 0:s.secondaryPosition)!==null&&o!==void 0?o:null,(a=(r=e.position)===null||r===void 0?void 0:r.preference)!==null&&a!==void 0?a:null,(c=(l=e.position)===null||l===void 0?void 0:l.positionAffinity)!==null&&c!==void 0?c:null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};tN=$we([Uwe(6,vt)],tN);function jwe(n){try{return n()}catch(e){mt(e)}}class qq{constructor(e,t,i,s,o,r){this.id=e,this.label=t,this.alias=i,this._precondition=s,this._run=o,this._contextKeyService=r}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}function _f(n){let e=0,t=0,i=0,s=0;for(let o=0,r=n.length;o<r;o++){const a=n.charCodeAt(o);a===13?(e===0&&(t=o),e++,o+1<r&&n.charCodeAt(o+1)===10?(s|=2,o++):s|=3,i=o+1):a===10&&(s|=1,e===0&&(t=o),e++,i=o+1)}return e===0&&(t=n.length),[e,t,n.length-i,s]}class i8{constructor(e,t,i,s){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=s}}class qwe{constructor(e,t,i,s,o,r){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=s,this.nestingLevelOfEqualBracketType=o,this.bracketPairNode=r}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class Gwe extends qwe{constructor(e,t,i,s,o,r,a){super(e,t,i,s,o,r),this.minVisibleColumnIndentation=a}}class cv{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}cv.zero=new cv(0,0);function Kwe(n,e,t,i){return n!==t?Ci(t-n,i):Ci(0,i-e)}const Es=0;function lx(n){return n===0}const Co=Math.pow(2,26);function Ci(n,e){return n*Co+e}function Ho(n){const e=n,t=Math.floor(e/Co),i=e-t*Co;return new cv(t,i)}function Ywe(n){return Math.floor(n/Co)}function Oi(n,e){let t=n+e;return e>=Co&&(t=t-n%Co),t}function Zwe(n,e){return n.reduce((t,i)=>Oi(t,e(i)),Es)}function Gq(n,e){return n===e}function dv(n,e){const t=n,i=e;if(i-t<=0)return Es;const o=Math.floor(t/Co),r=Math.floor(i/Co),a=i-r*Co;if(o===r){const l=t-o*Co;return Ci(0,a-l)}else return Ci(r-o,a)}function yp(n,e){return n<e}function wp(n,e){return n<=e}function c_(n,e){return n>=e}function Kg(n){return Ci(n.lineNumber-1,n.column-1)}function Kh(n,e){const t=n,i=Math.floor(t/Co),s=t-i*Co,o=e,r=Math.floor(o/Co),a=o-r*Co;return new N(i+1,s+1,r+1,a+1)}function Xwe(n){const e=Pf(n);return Ci(e.length-1,e[e.length-1].length)}class Jl{static fromModelContentChanges(e){return e.map(i=>{const s=N.lift(i.range);return new Jl(Kg(s.getStartPosition()),Kg(s.getEndPosition()),Xwe(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${Ho(this.startOffset)}...${Ho(this.endOffset)}) -> ${Ho(this.newLength)}`}}class Qwe{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>zP.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:dv(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ci(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ci(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Ho(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ci(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ci(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(wp(i,e)){this.nextEditIdx++;const s=Ho(i),o=Ho(this.translateOldToCur(t.endOffsetBeforeObj)),r=s.lineCount-o.lineCount;this.deltaOldToNewLineCount+=r;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=s.columnCount-o.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class zP{static from(e){return new zP(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=Ho(t),this.endOffsetAfterObj=Ho(Oi(e,i)),this.offsetObj=Ho(e)}}const OC=[];class Ti{static create(e,t){if(e<=128&&t.length===0){let i=Ti.cache[e];return i||(i=new Ti(e,t),Ti.cache[e]=i),i}return new Ti(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let s=i>>5;if(s===0){const r=1<<i|this.items;return r===this.items?this:Ti.create(r,this.additionalItems)}s--;const o=this.additionalItems.slice(0);for(;o.length<s;)o.push(0);return o[s]|=1<<(i&31),Ti.create(this.items,o)}merge(e){const t=this.items|e.items;if(this.additionalItems===OC&&e.additionalItems===OC)return t===this.items?this:t===e.items?e:Ti.create(t,OC);const i=[];for(let s=0;s<Math.max(this.additionalItems.length,e.additionalItems.length);s++){const o=this.additionalItems[s]||0,r=e.additionalItems[s]||0;i.push(o|r)}return Ti.create(t,i)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}}Ti.cache=new Array(129);Ti.empty=Ti.create(0,OC);const n8={getKey(n){return n}};class Jwe{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class HP{get length(){return this._length}constructor(e){this._length=e}}class uv extends HP{static create(e,t,i){let s=e.length;return t&&(s=Oi(s,t.length)),i&&(s=Oi(s,i.length)),new uv(s,e,t,i,t?t.missingOpeningBracketIds:Ti.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,s,o){super(e),this.openingBracket=t,this.child=i,this.closingBracket=s,this.missingOpeningBracketIds=o}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new uv(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(Oi(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class el extends HP{static create23(e,t,i,s=!1){let o=e.length,r=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(o=Oi(o,t.length),r=r.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");o=Oi(o,i.length),r=r.merge(i.missingOpeningBracketIds)}return s?new eCe(o,e.listHeight+1,e,t,i,r):new hv(o,e.listHeight+1,e,t,i,r)}static getEmpty(){return new tCe(Es,0,[],Ti.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new ji;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let s=1;s<e;s++){const o=this.getChild(s);t=Oi(t,o.length),i=i.merge(o.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,s=e;for(let o=0;o<this.childrenLength;o++){const r=this.getChild(o);r&&(i=Math.min(i,r.computeMinIndentation(s,t)),s=Oi(s,r.length))}return this.cachedMinIndentation=i,i}}class hv extends el{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,s,o,r){super(e,t,r),this._item1=i,this._item2=s,this._item3=o}deepClone(){return new hv(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class eCe extends hv{toMutable(){return new hv(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class cx extends el{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,s){super(e,t,s),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new cx(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class tCe extends cx{toMutable(){return new cx(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const iCe=[];class $P extends HP{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return iCe}deepClone(){return this}}class ch extends $P{get kind(){return 0}get missingOpeningBracketIds(){return Ti.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=Ho(e),s=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,o=Ywe(Oi(e,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let a=s;a<=o;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const d=qi.visibleColumnFromColumn(c,l,t.getOptions().tabSize);r=Math.min(r,d)}return r}}class dx extends $P{static create(e,t,i){return new dx(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return Ti.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class nCe extends $P{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Xc=class{constructor(e,t,i,s,o){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=s,this.astNode=o}};class sCe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new oCe(this.textModel,this.bracketTokens),this._offset=Es,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Ci(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=Oi(this._offset,e);const t=Ho(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Oi(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class oCe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const o=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=o.length,o}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const o=this.lineTokens,r=o.getCount();let a=null;if(this.lineTokenOffset<r){const l=o.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<r&&l===o.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Us.getTokenType(l)===0,d=Us.containsBalancedBrackets(l),u=o.getEndOffset(this.lineTokenOffset);if(d&&c&&this.lineCharOffset<u){const h=o.getLanguageId(this.lineTokenOffset),f=this.line.substring(this.lineCharOffset,u),g=this.bracketTokens.getSingleLanguageBracketTokens(h),p=g.regExpGlobal;if(p){p.lastIndex=0;const _=p.exec(f);_&&(a=g.getToken(_[0]),a&&(this.lineCharOffset+=_.index))}}if(i+=u-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=u}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const s=Kwe(e,t,this.lineIdx,this.lineCharOffset);return new Xc(s,0,-1,Ti.getEmpty(),new ch(s))}}class rCe{constructor(e,t){this.text=e,this._offset=Es,this.idx=0;const i=t.getRegExpStr(),s=i?new RegExp(i+`|
`,"gi"):null,o=[];let r,a=0,l=0,c=0,d=0;const u=[];for(let g=0;g<60;g++)u.push(new Xc(Ci(0,g),0,-1,Ti.getEmpty(),new ch(Ci(0,g))));const h=[];for(let g=0;g<60;g++)h.push(new Xc(Ci(1,g),0,-1,Ti.getEmpty(),new ch(Ci(1,g))));if(s)for(s.lastIndex=0;(r=s.exec(e))!==null;){const g=r.index,p=r[0];if(p===`
`)a++,l=g+1;else{if(c!==g){let _;if(d===a){const v=g-c;if(v<u.length)_=u[v];else{const b=Ci(0,v);_=new Xc(b,0,-1,Ti.getEmpty(),new ch(b))}}else{const v=a-d,b=g-l;if(v===1&&b<h.length)_=h[b];else{const y=Ci(v,b);_=new Xc(y,0,-1,Ti.getEmpty(),new ch(y))}}o.push(_)}o.push(t.getToken(p)),c=g+p.length,d=a}}const f=e.length;if(c!==f){const g=d===a?Ci(0,f-c):Ci(a-d,f-l);o.push(new Xc(g,0,-1,Ti.getEmpty(),new ch(g)))}this.length=Ci(a,f-l),this.tokens=o}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new sge}}class UP{static createFromLanguage(e,t){function i(o){return t.getKey(`${o.languageId}:::${o.bracketText}`)}const s=new Map;for(const o of e.bracketsNew.openingBrackets){const r=Ci(0,o.bracketText.length),a=i(o),l=Ti.getEmpty().add(a,n8);s.set(o.bracketText,new Xc(r,1,a,l,dx.create(r,o,l)))}for(const o of e.bracketsNew.closingBrackets){const r=Ci(0,o.bracketText.length);let a=Ti.getEmpty();const l=o.getOpeningBrackets();for(const c of l)a=a.add(i(c),n8);s.set(o.bracketText,new Xc(r,2,i(l[0]),a,dx.create(r,o,a)))}return new UP(s)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>aCe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function aCe(n){let e=br(n);return/^[\w ]+/.test(n)&&(e=`\\b${e}`),/[\w ]+$/.test(n)&&(e=`${e}\\b`),e}class lCe{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=UP.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function cCe(n){if(n.length===0)return null;if(n.length===1)return n[0];let e=0;function t(){if(e>=n.length)return null;const r=e,a=n[r].listHeight;for(e++;e<n.length&&n[e].listHeight===a;)e++;return e-r>=2?Kq(r===0&&e===n.length?n:n.slice(r,e),!1):n[r]}let i=t(),s=t();if(!s)return i;for(let r=t();r;r=t())s8(i,s)<=s8(s,r)?(i=nE(i,s),s=r):s=nE(s,r);return nE(i,s)}function Kq(n,e=!1){if(n.length===0)return null;if(n.length===1)return n[0];let t=n.length;for(;t>3;){const i=t>>1;for(let s=0;s<i;s++){const o=s<<1;n[s]=el.create23(n[o],n[o+1],o+3===t?n[o+2]:null,e)}t=i}return el.create23(n[0],n[1],t>=3?n[2]:null,e)}function s8(n,e){return Math.abs(n.listHeight-e.listHeight)}function nE(n,e){return n.listHeight===e.listHeight?el.create23(n,e,null,!1):n.listHeight>e.listHeight?dCe(n,e):uCe(e,n)}function dCe(n,e){n=n.toMutable();let t=n;const i=[];let s;for(;;){if(e.listHeight===t.listHeight){s=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let o=i.length-1;o>=0;o--){const r=i[o];s?r.childrenLength>=3?s=el.create23(r.unappendChild(),s,null,!1):(r.appendChildOfSameHeight(s),s=void 0):r.handleChildrenChanged()}return s?el.create23(n,s,null,!1):n}function uCe(n,e){n=n.toMutable();let t=n;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let s=e;for(let o=i.length-1;o>=0;o--){const r=i[o];s?r.childrenLength>=3?s=el.create23(s,r.unprependChild(),null,!1):(r.prependChildOfSameHeight(s),s=void 0):r.handleChildrenChanged()}return s?el.create23(s,n,null,!1):n}class hCe{constructor(e){this.lastOffset=Es,this.nextNodes=[e],this.offsets=[Es],this.idxs=[]}readLongestNodeAt(e,t){if(yp(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=T0(this.nextNodes);if(!i)return;const s=T0(this.offsets);if(yp(e,s))return;if(yp(s,e))if(Oi(s,i.length)<=e)this.nextNodeAfterCurrent();else{const o=sE(i);o!==-1?(this.nextNodes.push(i.getChild(o)),this.offsets.push(s),this.idxs.push(o)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const o=sE(i);if(o===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(o)),this.offsets.push(s),this.idxs.push(o)}}}}nextNodeAfterCurrent(){for(;;){const e=T0(this.offsets),t=T0(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=T0(this.nextNodes),s=sE(i,this.idxs[this.idxs.length-1]);if(s!==-1){this.nextNodes.push(i.getChild(s)),this.offsets.push(Oi(e,t.length)),this.idxs[this.idxs.length-1]=s;break}else this.idxs.pop()}}}function sE(n,e=-1){for(;;){if(e++,e>=n.childrenLength)return-1;if(n.getChild(e))return e}}function T0(n){return n.length>0?n[n.length-1]:void 0}function o8(n,e,t,i){return new fCe(n,e,t,i).parseDocument()}class fCe{constructor(e,t,i,s){if(this.tokenizer=e,this.createImmutableLists=s,this._itemsConstructed=0,this._itemsFromCache=0,i&&s)throw new Error("Not supported");this.oldNodeReader=i?new hCe(i):void 0,this.positionMapper=new Qwe(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Ti.getEmpty(),0);return e||(e=el.getEmpty()),e}parseList(e,t){const i=[];for(;;){let o=this.tryReadChildFromCache(e);if(!o){const r=this.tokenizer.peek();if(!r||r.kind===2&&r.bracketIds.intersects(e))break;o=this.parseChild(e,t+1)}o.kind===4&&o.childrenLength===0||i.push(o)}return this.oldNodeReader?cCe(i):Kq(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!lx(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),s=>t!==null&&!yp(s.length,t)?!1:s.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new nCe(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new ch(i.length);const s=e.merge(i.bracketIds),o=this.parseList(s,t+1),r=this.tokenizer.peek();return r&&r.kind===2&&(r.bracketId===i.bracketId||r.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),uv.create(i.astNode,o,r.astNode)):uv.create(i.astNode,o,null)}default:throw new Error("unexpected")}}}function ux(n,e){if(n.length===0)return e;if(e.length===0)return n;const t=new gc(r8(n)),i=r8(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let s=t.dequeue();function o(c){if(c===void 0){const u=t.takeWhile(h=>!0)||[];return s&&u.unshift(s),u}const d=[];for(;s&&!lx(c);){const[u,h]=s.splitAt(c);d.push(u),c=dv(u.lengthAfter,c),s=h??t.dequeue()}return lx(c)||d.push(new fd(!1,c,c)),d}const r=[];function a(c,d,u){if(r.length>0&&Gq(r[r.length-1].endOffset,c)){const h=r[r.length-1];r[r.length-1]=new Jl(h.startOffset,d,Oi(h.newLength,u))}else r.push({startOffset:c,endOffset:d,newLength:u})}let l=Es;for(const c of i){const d=o(c.lengthBefore);if(c.modified){const u=Zwe(d,f=>f.lengthBefore),h=Oi(l,u);a(l,h,c.lengthAfter),l=h}else for(const u of d){const h=l;l=Oi(l,u.lengthBefore),u.modified&&a(h,l,u.lengthAfter)}}return r}class fd{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=dv(e,this.lengthAfter);return Gq(t,Es)?[this,void 0]:this.modified?[new fd(this.modified,this.lengthBefore,e),new fd(this.modified,Es,t)]:[new fd(this.modified,e,e),new fd(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Ho(this.lengthBefore)} -> ${Ho(this.lengthAfter)}`}}function r8(n){const e=[];let t=Es;for(const i of n){const s=dv(t,i.startOffset);lx(s)||e.push(new fd(!1,s,s));const o=dv(i.startOffset,i.endOffset);e.push(new fd(!0,o,i.newLength)),t=i.endOffset}return e}class gCe extends Y{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new B,this.denseKeyProvider=new Jwe,this.brackets=new lCe(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),s=new rCe(this.textModel.getValue(),i);this.initialAstWithoutTokens=o8(s,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Jl(Ci(i.fromLineNumber-1,0),Ci(i.toLineNumber,0),Ci(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Jl.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=ux(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=ux(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const s=t,o=new sCe(this.textModel,this.brackets);return o8(o,e,s,i)}getBracketsInRange(e,t){this.flushQueue();const i=Ci(e.startLineNumber-1,e.startColumn-1),s=Ci(e.endLineNumber-1,e.endColumn-1);return new qa(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens;iN(r,Es,r.length,i,s,o,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=Kg(e.getStartPosition()),s=Kg(e.getEndPosition());return new qa(o=>{const r=this.initialAstWithoutTokens||this.astWithTokens,a=new pCe(o,t,this.textModel);nN(r,Es,r.length,i,s,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Zq(t,Es,t.length,Kg(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return Yq(t,Es,t.length,Kg(e))}}function Yq(n,e,t,i){if(n.kind===4||n.kind===2){const s=[];for(const o of n.children)t=Oi(e,o.length),s.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let o=s.length-1;o>=0;o--){const{nodeOffsetStart:r,nodeOffsetEnd:a}=s[o];if(yp(r,i)){const l=Yq(n.children[o],r,a,i);if(l)return l}}return null}else{if(n.kind===3)return null;if(n.kind===1){const s=Kh(e,t);return{bracketInfo:n.bracketInfo,range:s}}}return null}function Zq(n,e,t,i){if(n.kind===4||n.kind===2){for(const s of n.children){if(t=Oi(e,s.length),yp(i,t)){const o=Zq(s,e,t,i);if(o)return o}e=t}return null}else{if(n.kind===3)return null;if(n.kind===1){const s=Kh(e,t);return{bracketInfo:n.bracketInfo,range:s}}}return null}function iN(n,e,t,i,s,o,r,a,l,c,d=!1){if(r>200)return!0;e:for(;;)switch(n.kind){case 4:{const u=n.childrenLength;for(let h=0;h<u;h++){const f=n.getChild(h);if(f){if(t=Oi(e,f.length),wp(e,s)&&c_(t,i)){if(c_(t,s)){n=f;continue e}if(!iN(f,e,t,i,s,o,r,0,l,c))return!1}e=t}}return!0}case 2:{const u=!c||!n.closingBracket||n.closingBracket.bracketInfo.closesColorized(n.openingBracket.bracketInfo);let h=0;if(l){let g=l.get(n.openingBracket.text);g===void 0&&(g=0),h=g,u&&(g++,l.set(n.openingBracket.text,g))}const f=n.childrenLength;for(let g=0;g<f;g++){const p=n.getChild(g);if(p){if(t=Oi(e,p.length),wp(e,s)&&c_(t,i)){if(c_(t,s)&&p.kind!==1){n=p,u?(r++,a=h+1):a=h;continue e}if((u||p.kind!==1||!n.closingBracket)&&!iN(p,e,t,i,s,o,u?r+1:r,u?h+1:h,l,c,!n.closingBracket))return!1}e=t}}return l==null||l.set(n.openingBracket.text,h),!0}case 3:{const u=Kh(e,t);return o(new i8(u,r-1,0,!0))}case 1:{const u=Kh(e,t);return o(new i8(u,r-1,a-1,d))}case 0:return!0}}class pCe{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function nN(n,e,t,i,s,o,r,a){var l;if(r>200)return!0;let c=!0;if(n.kind===2){let d=0;if(a){let f=a.get(n.openingBracket.text);f===void 0&&(f=0),d=f,f++,a.set(n.openingBracket.text,f)}const u=Oi(e,n.openingBracket.length);let h=-1;if(o.includeMinIndentation&&(h=n.computeMinIndentation(e,o.textModel)),c=o.push(new Gwe(Kh(e,t),Kh(e,u),n.closingBracket?Kh(Oi(u,((l=n.child)===null||l===void 0?void 0:l.length)||Es),t):void 0,r,d,n,h)),e=u,c&&n.child){const f=n.child;if(t=Oi(e,f.length),wp(e,s)&&c_(t,i)&&(c=nN(f,e,t,i,s,o,r+1,a),!c))return!1}a==null||a.set(n.openingBracket.text,d)}else{let d=e;for(const u of n.children){const h=d;if(d=Oi(d,u.length),wp(h,s)&&wp(i,d)&&(c=nN(u,h,d,i,s,o,r,a),!c))return!1}}return c}class mCe extends Y{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new ta),this.onDidChangeEmitter=new B,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange(i=>{var s;(!i.languageId||!((s=this.bracketPairsTree.value)===null||s===void 0)&&s.object.didLanguageChange(i.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}))}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;(t=this.bracketPairsTree.value)===null||t===void 0||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;(e=this.bracketPairsTree.value)===null||e===void 0||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;(t=this.bracketPairsTree.value)===null||t===void 0||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new pe;this.bracketPairsTree.value=_Ce(e.add(new gCe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!1))||qa.empty}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!0))||qa.empty}getBracketsInRange(e,t=!1){var i;return this.bracketsRequested=!0,this.updateBracketPairsTree(),((i=this.bracketPairsTree.value)===null||i===void 0?void 0:i.object.getBracketsInRange(e,t))||qa.empty}findMatchingBracketUp(e,t,i){const s=this.textModel.validatePosition(t),o=this.textModel.getLanguageIdAtPosition(s.lineNumber,s.column);if(this.canBuildAST){const r=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew.getClosingBracketInfo(e);if(!r)return null;const a=this.getBracketPairsInRange(N.fromPositions(t,t)).findLast(l=>r.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const r=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(o).brackets;if(!a)return null;const l=a.textIsBracket[r];return l?yw(this._findMatchingBracketUp(l,s,oE(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(N.fromPositions(e,e)).filter(s=>s.closingBracketRange!==void 0&&(s.openingBracketRange.containsPosition(e)||s.closingBracketRange.containsPosition(e))).findLastMaxBy(ur(s=>s.openingBracketRange.containsPosition(e)?s.openingBracketRange:s.closingBracketRange,N.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=oE(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,s){const o=t.getCount(),r=t.getLanguageId(s);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=s-1;c>=0;c--){const d=t.getEndOffset(c);if(d<=a)break;if(ma(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){a=d;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=s+1;c<o;c++){const d=t.getStartOffset(c);if(d>=l)break;if(ma(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){l=d;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,s=this.textModel.tokenization.getLineTokens(i),o=this.textModel.getLineContent(i),r=s.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(r)).brackets;if(a&&!ma(s.getStandardTokenType(r))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,s,a,r),d=null;for(;;){const u=ir.findNextBracketInRange(a.forwardRegex,i,o,l,c);if(!u)break;if(u.startColumn<=e.column&&e.column<=u.endColumn){const h=o.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),f=this._matchFoundBracket(u,a.textIsBracket[h],a.textIsOpenBracket[h],t);if(f){if(f instanceof El)return null;d=f}}l=u.endColumn-1}if(d)return d}if(r>0&&s.getStartOffset(r)===e.column-1){const l=r-1,c=this.languageConfigurationService.getLanguageConfiguration(s.getLanguageId(l)).brackets;if(c&&!ma(s.getStandardTokenType(l))){const{searchStartOffset:d,searchEndOffset:u}=this._establishBracketSearchOffsets(e,s,c,l),h=ir.findPrevBracketInRange(c.reversedRegex,i,o,d,u);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn){const f=o.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,c.textIsBracket[f],c.textIsOpenBracket[f],t);if(g)return g instanceof El?null:g}}}return null}_matchFoundBracket(e,t,i,s){if(!t)return null;const o=i?this._findMatchingBracketDown(t,e.getEndPosition(),s):this._findMatchingBracketUp(t,e.getStartPosition(),s);return o?o instanceof El?o:[e,o]:null}_findMatchingBracketUp(e,t,i){const s=e.languageId,o=e.reversedRegex;let r=-1,a=0;const l=(c,d,u,h)=>{for(;;){if(i&&++a%100===0&&!i())return El.INSTANCE;const f=ir.findPrevBracketInRange(o,c,d,u,h);if(!f)break;const g=d.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(g)?r++:e.isClose(g)&&r--,r===0)return f;h=f.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const d=this.textModel.tokenization.getLineTokens(c),u=d.getCount(),h=this.textModel.getLineContent(c);let f=u-1,g=h.length,p=h.length;c===t.lineNumber&&(f=d.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1);let _=!0;for(;f>=0;f--){const v=d.getLanguageId(f)===s&&!ma(d.getStandardTokenType(f));if(v)_?g=d.getStartOffset(f):(g=d.getStartOffset(f),p=d.getEndOffset(f));else if(_&&g!==p){const b=l(c,h,g,p);if(b)return b}_=v}if(_&&g!==p){const v=l(c,h,g,p);if(v)return v}}return null}_findMatchingBracketDown(e,t,i){const s=e.languageId,o=e.forwardRegex;let r=1,a=0;const l=(d,u,h,f)=>{for(;;){if(i&&++a%100===0&&!i())return El.INSTANCE;const g=ir.findNextBracketInRange(o,d,u,h,f);if(!g)break;const p=u.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(p)?r++:e.isClose(p)&&r--,r===0)return g;h=g.endColumn-1}return null},c=this.textModel.getLineCount();for(let d=t.lineNumber;d<=c;d++){const u=this.textModel.tokenization.getLineTokens(d),h=u.getCount(),f=this.textModel.getLineContent(d);let g=0,p=0,_=0;d===t.lineNumber&&(g=u.findTokenIndexAtOffset(t.column-1),p=t.column-1,_=t.column-1);let v=!0;for(;g<h;g++){const b=u.getLanguageId(g)===s&&!ma(u.getStandardTokenType(g));if(b)v||(p=u.getStartOffset(g)),_=u.getEndOffset(g);else if(v&&p!==_){const y=l(d,f,p,_);if(y)return y}v=b}if(v&&p!==_){const b=l(d,f,p,_);if(b)return b}}return null}findPrevBracket(e){var t;const i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getFirstBracketBefore(i))||null;let s=null,o=null,r=null;for(let a=i.lineNumber;a>=1;a--){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),d=this.textModel.getLineContent(a);let u=c-1,h=d.length,f=d.length;if(a===i.lineNumber){u=l.findTokenIndexAtOffset(i.column-1),h=i.column-1,f=i.column-1;const p=l.getLanguageId(u);s!==p&&(s=p,o=this.languageConfigurationService.getLanguageConfiguration(s).brackets,r=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew)}let g=!0;for(;u>=0;u--){const p=l.getLanguageId(u);if(s!==p){if(o&&r&&g&&h!==f){const v=ir.findPrevBracketInRange(o.reversedRegex,a,d,h,f);if(v)return this._toFoundBracket(r,v);g=!1}s=p,o=this.languageConfigurationService.getLanguageConfiguration(s).brackets,r=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew}const _=!!o&&!ma(l.getStandardTokenType(u));if(_)g?h=l.getStartOffset(u):(h=l.getStartOffset(u),f=l.getEndOffset(u));else if(r&&o&&g&&h!==f){const v=ir.findPrevBracketInRange(o.reversedRegex,a,d,h,f);if(v)return this._toFoundBracket(r,v)}g=_}if(r&&o&&g&&h!==f){const p=ir.findPrevBracketInRange(o.reversedRegex,a,d,h,f);if(p)return this._toFoundBracket(r,p)}}return null}findNextBracket(e){var t;const i=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),((t=this.bracketPairsTree.value)===null||t===void 0?void 0:t.object.getFirstBracketAfter(i))||null;const s=this.textModel.getLineCount();let o=null,r=null,a=null;for(let l=i.lineNumber;l<=s;l++){const c=this.textModel.tokenization.getLineTokens(l),d=c.getCount(),u=this.textModel.getLineContent(l);let h=0,f=0,g=0;if(l===i.lineNumber){h=c.findTokenIndexAtOffset(i.column-1),f=i.column-1,g=i.column-1;const _=c.getLanguageId(h);o!==_&&(o=_,r=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew)}let p=!0;for(;h<d;h++){const _=c.getLanguageId(h);if(o!==_){if(a&&r&&p&&f!==g){const b=ir.findNextBracketInRange(r.forwardRegex,l,u,f,g);if(b)return this._toFoundBracket(a,b);p=!1}o=_,r=this.languageConfigurationService.getLanguageConfiguration(o).brackets,a=this.languageConfigurationService.getLanguageConfiguration(o).bracketsNew}const v=!!r&&!ma(c.getStandardTokenType(h));if(v)p||(f=c.getStartOffset(h)),g=c.getEndOffset(h);else if(a&&r&&p&&f!==g){const b=ir.findNextBracketInRange(r.forwardRegex,l,u,f,g);if(b)return this._toFoundBracket(a,b)}p=v}if(a&&r&&p&&f!==g){const _=ir.findNextBracketInRange(r.forwardRegex,l,u,f,g);if(_)return this._toFoundBracket(a,_)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const f=N.fromPositions(i),g=this.getBracketPairsInRange(N.fromPositions(i,i)).findLast(p=>p.closingBracketRange!==void 0&&p.range.strictContainsRange(f));return g?[g.openingBracketRange,g.closingBracketRange]:null}const s=oE(t),o=this.textModel.getLineCount(),r=new Map;let a=[];const l=(f,g)=>{if(!r.has(f)){const p=[];for(let _=0,v=g?g.brackets.length:0;_<v;_++)p[_]=0;r.set(f,p)}a=r.get(f)};let c=0;const d=(f,g,p,_,v)=>{for(;;){if(s&&++c%100===0&&!s())return El.INSTANCE;const b=ir.findNextBracketInRange(f.forwardRegex,g,p,_,v);if(!b)break;const y=p.substring(b.startColumn-1,b.endColumn-1).toLowerCase(),w=f.textIsBracket[y];if(w&&(w.isOpen(y)?a[w.index]++:w.isClose(y)&&a[w.index]--,a[w.index]===-1))return this._matchFoundBracket(b,w,!1,s);_=b.endColumn-1}return null};let u=null,h=null;for(let f=i.lineNumber;f<=o;f++){const g=this.textModel.tokenization.getLineTokens(f),p=g.getCount(),_=this.textModel.getLineContent(f);let v=0,b=0,y=0;if(f===i.lineNumber){v=g.findTokenIndexAtOffset(i.column-1),b=i.column-1,y=i.column-1;const C=g.getLanguageId(v);u!==C&&(u=C,h=this.languageConfigurationService.getLanguageConfiguration(u).brackets,l(u,h))}let w=!0;for(;v<p;v++){const C=g.getLanguageId(v);if(u!==C){if(h&&w&&b!==y){const x=d(h,f,_,b,y);if(x)return yw(x);w=!1}u=C,h=this.languageConfigurationService.getLanguageConfiguration(u).brackets,l(u,h)}const L=!!h&&!ma(g.getStandardTokenType(v));if(L)w||(b=g.getStartOffset(v)),y=g.getEndOffset(v);else if(h&&w&&b!==y){const x=d(h,f,_,b,y);if(x)return yw(x)}w=L}if(h&&w&&b!==y){const C=d(h,f,_,b,y);if(C)return yw(C)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const s=e.getBracketInfo(i);return s?{range:t,bracketInfo:s}:null}}function _Ce(n,e){return{object:n,dispose:()=>e==null?void 0:e.dispose()}}function oE(n){if(typeof n>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=n}}class El{constructor(){this._searchCanceledBrand=void 0}}El.INSTANCE=new El;function yw(n){return n instanceof El?null:n}class bCe extends Y{constructor(e){super(),this.textModel=e,this.colorProvider=new Xq,this.onDidChangeEmitter=new B,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,s){return s?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(r=>({id:`bracket${r.range.toString()}-${r.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:r.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new N(1,1,this.textModel.getLineCount(),1),e,t):[]}}class Xq{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}Dr((n,e)=>{const t=[Aq,Iq,Tq,Nq,Rq,Mq],i=new Xq;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${n.getColor(bye)}; }`);const s=t.map(o=>n.getColor(o)).filter(o=>!!o).filter(o=>!o.isTransparent());for(let o=0;o<30;o++){const r=s[o%s.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(o)} { color: ${r}; }`)}});function ww(n){return n.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class yn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,s){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=s}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${ww(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${ww(this.oldText)}")`:`(replace@${this.oldPosition} "${ww(this.oldText)}" with "${ww(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const s=t.length;Wr(e,s,i),i+=4;for(let o=0;o<s;o++)n0e(e,t.charCodeAt(o),i),i+=2;return i}static _readString(e,t){const i=Br(e,t);return t+=4,o0e(e,t,i)}writeSize(){return 4+4+yn._writeStringSize(this.oldText)+yn._writeStringSize(this.newText)}write(e,t){return Wr(e,this.oldPosition,t),t+=4,Wr(e,this.newPosition,t),t+=4,t=yn._writeString(e,this.oldText,t),t=yn._writeString(e,this.newText,t),t}static read(e,t,i){const s=Br(e,t);t+=4;const o=Br(e,t);t+=4;const r=yn._readString(e,t);t+=yn._writeStringSize(r);const a=yn._readString(e,t);return t+=yn._writeStringSize(a),i.push(new yn(s,r,o,a)),t}}function vCe(n,e){return n===null||n.length===0?e:new ba(n,e).compress()}class ba{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),s=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(s),s=this._getCurr(++t);continue}if(s===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(s.oldEnd<=i.newPosition){this._acceptCurr(s),s=this._getCurr(++t);continue}if(i.newEnd<=s.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(s.oldPosition<i.newPosition){const[c,d]=ba._splitCurr(s,i.newPosition-s.oldPosition);this._acceptCurr(c),s=d;continue}if(i.newPosition<s.oldPosition){const[c,d]=ba._splitPrev(i,s.oldPosition-i.newPosition);this._acceptPrev(c),i=d;continue}let a,l;if(s.oldEnd===i.newEnd)a=i,l=s,i=this._getPrev(++e),s=this._getCurr(++t);else if(s.oldEnd<i.newEnd){const[c,d]=ba._splitPrev(i,s.oldLength);a=c,l=s,i=d,s=this._getCurr(++t)}else{const[c,d]=ba._splitCurr(s,i.newLength);a=i,l=c,i=this._getPrev(++e),s=d}this._result[this._resultLen++]=new yn(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const o=ba._merge(this._result);return ba._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=ba._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=ba._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new yn(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new yn(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),s=e.newText.substr(t);return[new yn(e.oldPosition,e.oldText,e.newPosition,i),new yn(e.oldEnd,"",e.newPosition+t,s)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),s=e.oldText.substr(t);return[new yn(e.oldPosition,i,e.newPosition,e.newText),new yn(e.oldPosition+t,s,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,s=e[0];for(let o=1;o<e.length;o++){const r=e[o];s.oldEnd===r.oldPosition?s=new yn(s.oldPosition,s.oldText+r.oldText,s.newPosition,s.newText+r.newText):(t[i++]=s,s=r)}return t[i++]=s,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let s=0;s<e.length;s++){const o=e[s];o.oldText!==o.newText&&(t[i++]=o)}return t}}function Rc(n){return n===47||n===92}function Qq(n){return n.replace(/[\\/]/g,Mi.sep)}function yCe(n){return n.indexOf("/")===-1&&(n=Qq(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function a8(n,e=Mi.sep){if(!n)return"";const t=n.length,i=n.charCodeAt(0);if(Rc(i)){if(Rc(n.charCodeAt(1))&&!Rc(n.charCodeAt(2))){let o=3;const r=o;for(;o<t&&!Rc(n.charCodeAt(o));o++);if(r!==o&&!Rc(n.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Rc(n.charCodeAt(o)))return n.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(wCe(i)&&n.charCodeAt(1)===58)return Rc(n.charCodeAt(2))?n.slice(0,2)+e:n.slice(0,2);let s=n.indexOf("://");if(s!==-1){for(s+=3;s<t;s++)if(Rc(n.charCodeAt(s)))return n.slice(0,s+1)}return""}function sN(n,e,t,i=Sd){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!Q4(n,e))return!1;if(e.length===n.length)return!0;let o=e.length;return e.charAt(e.length-1)===i&&o--,n.charAt(o)===i}return e.charAt(e.length-1)!==i&&(e+=i),n.indexOf(e)===0}function wCe(n){return n>=65&&n<=90||n>=97&&n<=122}function fl(n){return OS(n,!0)}class CCe{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:Ob(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===it.file)return sN(fl(e),fl(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(c8(e.authority,t.authority))return sN(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return je.joinPath(e,...t)}basenameOrAuthority(e){return na(e)||e.authority}basename(e){return Mi.basename(e.path)}extname(e){return Mi.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===it.file?t=je.file(Dge(fl(e))).path:(t=Mi.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===it.file?t=je.file(WU(fl(e))).path:t=Mi.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!c8(e.authority,t.authority))return;if(e.scheme===it.file){const o=Lge(fl(e),fl(t));return Ps?Qq(o):o}let i=e.path||"/";const s=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(const r=Math.min(i.length,s.length);o<r&&!(i.charCodeAt(o)!==s.charCodeAt(o)&&i.charAt(o).toLowerCase()!==s.charAt(o).toLowerCase());o++);i=s.substr(0,o)+i.substr(o)}return Mi.relative(i,s)}resolvePath(e,t){if(e.scheme===it.file){const i=je.file(xge(fl(e),t));return e.with({authority:i.authority,path:i.path})}return t=yCe(t),e.with({path:Mi.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Pg(e,t)}hasTrailingPathSeparator(e,t=Sd){if(e.scheme===it.file){const i=fl(e);return i.length>a8(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Sd){return d8(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Sd){let i=!1;if(e.scheme===it.file){const s=fl(e);i=s!==void 0&&s.length===a8(s).length&&s[s.length-1]===t}else{t="/";const s=e.path;i=s.length===1&&s.charCodeAt(s.length-1)===47}return!i&&!d8(e,t)?e.with({path:e.path+"/"}):e}}const Ht=new CCe(()=>!1),jP=Ht.isEqual.bind(Ht);Ht.isEqualOrParent.bind(Ht);Ht.getComparisonKey.bind(Ht);const SCe=Ht.basenameOrAuthority.bind(Ht),na=Ht.basename.bind(Ht);Ht.extname.bind(Ht);const qP=Ht.dirname.bind(Ht);Ht.joinPath.bind(Ht);const xCe=Ht.normalizePath.bind(Ht);Ht.relativePath.bind(Ht);const l8=Ht.resolvePath.bind(Ht);Ht.isAbsolutePath.bind(Ht);const c8=Ht.isEqualAuthority.bind(Ht),d8=Ht.hasTrailingPathSeparator.bind(Ht);Ht.removeTrailingPathSeparator.bind(Ht);Ht.addTrailingPathSeparator.bind(Ht);var hx;(function(n){n.META_DATA_LABEL="label",n.META_DATA_DESCRIPTION="description",n.META_DATA_SIZE="size",n.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(r=>{const[a,l]=r.split(":");a&&l&&i.set(a,l)});const o=t.path.substring(0,t.path.indexOf(";"));return o&&i.set(n.META_DATA_MIME,o),i}n.parseMetaData=e})(hx||(hx={}));function pg(n){return n.toString()}class Xi{static create(e,t){const i=e.getAlternativeVersionId(),s=oN(e);return new Xi(i,i,s,s,t,t,[])}constructor(e,t,i,s,o,r,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=s,this.beforeCursorState=o,this.afterCursorState=r,this.changes=a}append(e,t,i,s,o){t.length>0&&(this.changes=vCe(this.changes,t)),this.afterEOL=i,this.afterVersionId=s,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(Wr(e,t?t.length:0,i),i+=4,t)for(const s of t)Wr(e,s.selectionStartLineNumber,i),i+=4,Wr(e,s.selectionStartColumn,i),i+=4,Wr(e,s.positionLineNumber,i),i+=4,Wr(e,s.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const s=Br(e,t);t+=4;for(let o=0;o<s;o++){const r=Br(e,t);t+=4;const a=Br(e,t);t+=4;const l=Br(e,t);t+=4;const c=Br(e,t);t+=4,i.push(new lt(r,a,l,c))}return t}serialize(){let e=10+Xi._writeSelectionsSize(this.beforeCursorState)+Xi._writeSelectionsSize(this.afterCursorState)+4;for(const s of this.changes)e+=s.writeSize();const t=new Uint8Array(e);let i=0;Wr(t,this.beforeVersionId,i),i+=4,Wr(t,this.afterVersionId,i),i+=4,F9(t,this.beforeEOL,i),i+=1,F9(t,this.afterEOL,i),i+=1,i=Xi._writeSelections(t,this.beforeCursorState,i),i=Xi._writeSelections(t,this.afterCursorState,i),Wr(t,this.changes.length,i),i+=4;for(const s of this.changes)i=s.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const s=Br(t,i);i+=4;const o=Br(t,i);i+=4;const r=O9(t,i);i+=1;const a=O9(t,i);i+=1;const l=[];i=Xi._readSelections(t,i,l);const c=[];i=Xi._readSelections(t,i,c);const d=Br(t,i);i+=4;const u=[];for(let h=0;h<d;h++)i=yn.read(t,i,u);return new Xi(s,o,r,a,l,c,u)}}class Jq{get type(){return 0}get resource(){return je.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,s){this.label=e,this.code=t,this.model=i,this._data=Xi.create(i,s)}toString(){return(this._data instanceof Xi?this._data:Xi.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(je.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Xi}append(e,t,i,s,o){this._data instanceof Xi&&this._data.append(e,t,i,s,o)}close(){this._data instanceof Xi&&(this._data=this._data.serialize())}open(){this._data instanceof Xi||(this._data=Xi.deserialize(this._data))}undo(){if(je.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Xi&&(this._data=this._data.serialize());const e=Xi.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(je.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Xi&&(this._data=this._data.serialize());const e=Xi.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Xi&&(this._data=this._data.serialize()),this._data.byteLength+168}}class LCe{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const s of this._editStackElementsArr){const o=pg(s.resource);this._editStackElementsMap.set(o,s)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=pg(e);return this._editStackElementsMap.has(t)}setModel(e){const t=pg(je.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=pg(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,s,o){const r=pg(e.uri);this._editStackElementsMap.get(r).append(e,t,i,s,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=pg(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${na(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function oN(n){return n.getEOL()===`
`?0:1}function Al(n){return n?n instanceof Jq||n instanceof LCe:!1}class GP{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Al(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Al(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(Al(i)&&i.canAppend(this._model))return i;const s=new Jq(m("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(s,t),s}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],oN(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,s){const o=this._getOrCreateEditStackElement(e,s),r=this._model.applyEdits(t,!0),a=GP._computeCursorState(i,r),l=r.map((c,d)=>({index:d,textChange:c.textChange}));return l.sort((c,d)=>c.textChange.oldPosition===d.textChange.oldPosition?c.index-d.index:c.textChange.oldPosition-d.textChange.oldPosition),o.append(this._model,l.map(c=>c.textChange),oN(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return mt(i),null}}}class DCe{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function kCe(n,e,t,i,s){s.spacesDiff=0,s.looksLikeAlignment=!1;let o;for(o=0;o<e&&o<i;o++){const h=n.charCodeAt(o),f=t.charCodeAt(o);if(h!==f)break}let r=0,a=0;for(let h=o;h<e;h++)n.charCodeAt(h)===32?r++:a++;let l=0,c=0;for(let h=o;h<i;h++)t.charCodeAt(h)===32?l++:c++;if(r>0&&a>0||l>0&&c>0)return;const d=Math.abs(a-c),u=Math.abs(r-l);if(d===0){s.spacesDiff=u,u>0&&0<=l-1&&l-1<n.length&&l<t.length&&t.charCodeAt(l)!==32&&n.charCodeAt(l-1)===32&&n.charCodeAt(n.length-1)===44&&(s.looksLikeAlignment=!0);return}if(u%d===0){s.spacesDiff=u/d;return}}function u8(n,e,t){const i=Math.min(n.getLineCount(),1e4);let s=0,o=0,r="",a=0;const l=[2,4,6,8,3,5,7],c=8,d=[0,0,0,0,0,0,0,0,0],u=new DCe;for(let g=1;g<=i;g++){const p=n.getLineLength(g),_=n.getLineContent(g),v=p<=65536;let b=!1,y=0,w=0,C=0;for(let x=0,D=p;x<D;x++){const k=v?_.charCodeAt(x):n.getLineCharCode(g,x);if(k===9)C++;else if(k===32)w++;else{b=!0,y=x;break}}if(!b||(C>0?s++:w>1&&o++,kCe(r,a,_,y,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;const L=u.spacesDiff;L<=c&&d[L]++,r=_,a=y}let h=t;s!==o&&(h=s<o);let f=e;if(h){let g=h?0:.1*i;l.forEach(p=>{const _=d[p];_>g&&(g=_,f=p)}),f===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(f=2)}return{insertSpaces:h,tabSize:f}}function bs(n){return(n.metadata&1)>>>0}function Wt(n,e){n.metadata=n.metadata&254|e<<0}function Sn(n){return(n.metadata&2)>>>1===1}function Ot(n,e){n.metadata=n.metadata&253|(e?1:0)<<1}function eG(n){return(n.metadata&4)>>>2===1}function h8(n,e){n.metadata=n.metadata&251|(e?1:0)<<2}function tG(n){return(n.metadata&64)>>>6===1}function f8(n,e){n.metadata=n.metadata&191|(e?1:0)<<6}function ECe(n){return(n.metadata&24)>>>3}function g8(n,e){n.metadata=n.metadata&231|e<<3}function ACe(n){return(n.metadata&32)>>>5===1}function p8(n,e){n.metadata=n.metadata&223|(e?1:0)<<5}class iG{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,Wt(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,h8(this,!1),f8(this,!1),g8(this,1),p8(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,Ot(this,!1)}reset(e,t,i,s){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=s}setOptions(e){this.options=e;const t=this.options.className;h8(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),f8(this,this.options.glyphMarginClassName!==null),g8(this,this.options.stickiness),p8(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const qe=new iG(null,0,0);qe.parent=qe;qe.left=qe;qe.right=qe;Wt(qe,0);class rE{constructor(){this.root=qe,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,s,o,r){return this.root===qe?[]:FCe(this,e,t,i,s,o,r)}search(e,t,i,s){return this.root===qe?[]:OCe(this,e,t,i,s)}collectNodesFromOwner(e){return MCe(this,e)}collectNodesPostOrder(){return PCe(this)}insert(e){m8(this,e),this._normalizeDeltaIfNecessary()}delete(e){_8(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let s=0;for(;e!==this.root;)e===e.parent.right&&(s+=e.parent.delta),e=e.parent;const o=i.start+s,r=i.end+s;i.setCachedOffsets(o,r,t)}acceptReplace(e,t,i,s){const o=NCe(this,e,e+t);for(let r=0,a=o.length;r<a;r++){const l=o[r];_8(this,l)}this._normalizeDeltaIfNecessary(),RCe(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let r=0,a=o.length;r<a;r++){const l=o[r];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,TCe(l,e,e+t,i,s),l.maxEnd=l.end,m8(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,ICe(this))}}function ICe(n){let e=n.root,t=0;for(;e!==qe;){if(e.left!==qe&&!Sn(e.left)){e=e.left;continue}if(e.right!==qe&&!Sn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,ou(e),Ot(e,!0),Ot(e.left,!1),Ot(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}Ot(n.root,!1)}function mg(n,e,t,i){return n<t?!0:n>t||i===1?!1:i===2?!0:e}function TCe(n,e,t,i,s){const o=ECe(n),r=o===0||o===2,a=o===1||o===2,l=t-e,c=i,d=Math.min(l,c),u=n.start;let h=!1;const f=n.end;let g=!1;e<=u&&f<=t&&ACe(n)&&(n.start=e,h=!0,n.end=e,g=!0);{const _=s?1:l>0?2:0;!h&&mg(u,r,e,_)&&(h=!0),!g&&mg(f,a,e,_)&&(g=!0)}if(d>0&&!s){const _=l>c?2:0;!h&&mg(u,r,e+d,_)&&(h=!0),!g&&mg(f,a,e+d,_)&&(g=!0)}{const _=s?1:0;!h&&mg(u,r,t,_)&&(n.start=e+c,h=!0),!g&&mg(f,a,t,_)&&(n.end=e+c,g=!0)}const p=c-l;h||(n.start=Math.max(0,u+p)),g||(n.end=Math.max(0,f+p)),n.start>n.end&&(n.end=n.start)}function NCe(n,e,t){let i=n.root,s=0,o=0,r=0,a=0;const l=[];let c=0;for(;i!==qe;){if(Sn(i)){Ot(i.left,!1),Ot(i.right,!1),i===i.parent.right&&(s-=i.parent.delta),i=i.parent;continue}if(!Sn(i.left)){if(o=s+i.maxEnd,o<e){Ot(i,!0);continue}if(i.left!==qe){i=i.left;continue}}if(r=s+i.start,r>t){Ot(i,!0);continue}if(a=s+i.end,a>=e&&(i.setCachedOffsets(r,a,0),l[c++]=i),Ot(i,!0),i.right!==qe&&!Sn(i.right)){s+=i.delta,i=i.right;continue}}return Ot(n.root,!1),l}function RCe(n,e,t,i){let s=n.root,o=0,r=0,a=0;const l=i-(t-e);for(;s!==qe;){if(Sn(s)){Ot(s.left,!1),Ot(s.right,!1),s===s.parent.right&&(o-=s.parent.delta),ou(s),s=s.parent;continue}if(!Sn(s.left)){if(r=o+s.maxEnd,r<e){Ot(s,!0);continue}if(s.left!==qe){s=s.left;continue}}if(a=o+s.start,a>t){s.start+=l,s.end+=l,s.delta+=l,(s.delta<-1073741824||s.delta>1073741824)&&(n.requestNormalizeDelta=!0),Ot(s,!0);continue}if(Ot(s,!0),s.right!==qe&&!Sn(s.right)){o+=s.delta,s=s.right;continue}}Ot(n.root,!1)}function MCe(n,e){let t=n.root;const i=[];let s=0;for(;t!==qe;){if(Sn(t)){Ot(t.left,!1),Ot(t.right,!1),t=t.parent;continue}if(t.left!==qe&&!Sn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[s++]=t),Ot(t,!0),t.right!==qe&&!Sn(t.right)){t=t.right;continue}}return Ot(n.root,!1),i}function PCe(n){let e=n.root;const t=[];let i=0;for(;e!==qe;){if(Sn(e)){Ot(e.left,!1),Ot(e.right,!1),e=e.parent;continue}if(e.left!==qe&&!Sn(e.left)){e=e.left;continue}if(e.right!==qe&&!Sn(e.right)){e=e.right;continue}t[i++]=e,Ot(e,!0)}return Ot(n.root,!1),t}function OCe(n,e,t,i,s){let o=n.root,r=0,a=0,l=0;const c=[];let d=0;for(;o!==qe;){if(Sn(o)){Ot(o.left,!1),Ot(o.right,!1),o===o.parent.right&&(r-=o.parent.delta),o=o.parent;continue}if(o.left!==qe&&!Sn(o.left)){o=o.left;continue}a=r+o.start,l=r+o.end,o.setCachedOffsets(a,l,i);let u=!0;if(e&&o.ownerId&&o.ownerId!==e&&(u=!1),t&&eG(o)&&(u=!1),s&&!tG(o)&&(u=!1),u&&(c[d++]=o),Ot(o,!0),o.right!==qe&&!Sn(o.right)){r+=o.delta,o=o.right;continue}}return Ot(n.root,!1),c}function FCe(n,e,t,i,s,o,r){let a=n.root,l=0,c=0,d=0,u=0;const h=[];let f=0;for(;a!==qe;){if(Sn(a)){Ot(a.left,!1),Ot(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!Sn(a.left)){if(c=l+a.maxEnd,c<e){Ot(a,!0);continue}if(a.left!==qe){a=a.left;continue}}if(d=l+a.start,d>t){Ot(a,!0);continue}if(u=l+a.end,u>=e){a.setCachedOffsets(d,u,o);let g=!0;i&&a.ownerId&&a.ownerId!==i&&(g=!1),s&&eG(a)&&(g=!1),r&&!tG(a)&&(g=!1),g&&(h[f++]=a)}if(Ot(a,!0),a.right!==qe&&!Sn(a.right)){l+=a.delta,a=a.right;continue}}return Ot(n.root,!1),h}function m8(n,e){if(n.root===qe)return e.parent=qe,e.left=qe,e.right=qe,Wt(e,0),n.root=e,n.root;BCe(n,e),Vc(e.parent);let t=e;for(;t!==n.root&&bs(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;bs(i)===1?(Wt(t.parent,0),Wt(i,0),Wt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,F_(n,t)),Wt(t.parent,0),Wt(t.parent.parent,1),B_(n,t.parent.parent))}else{const i=t.parent.parent.left;bs(i)===1?(Wt(t.parent,0),Wt(i,0),Wt(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,B_(n,t)),Wt(t.parent,0),Wt(t.parent.parent,1),F_(n,t.parent.parent))}return Wt(n.root,0),e}function BCe(n,e){let t=0,i=n.root;const s=e.start,o=e.end;for(;;)if(VCe(s,o,i.start+t,i.end+t)<0)if(i.left===qe){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===qe){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=qe,e.right=qe,Wt(e,1)}function _8(n,e){let t,i;if(e.left===qe?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===qe?(t=e.left,i=e):(i=WCe(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(n.requestNormalizeDelta=!0)),i===n.root){n.root=t,Wt(t,0),e.detach(),aE(),ou(t),n.root.parent=qe;return}const s=bs(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,Wt(i,bs(e)),e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==qe&&(i.left.parent=i),i.right!==qe&&(i.right.parent=i)),e.detach(),s){Vc(t.parent),i!==e&&(Vc(i),Vc(i.parent)),aE();return}Vc(t),Vc(t.parent),i!==e&&(Vc(i),Vc(i.parent));let o;for(;t!==n.root&&bs(t)===0;)t===t.parent.left?(o=t.parent.right,bs(o)===1&&(Wt(o,0),Wt(t.parent,1),F_(n,t.parent),o=t.parent.right),bs(o.left)===0&&bs(o.right)===0?(Wt(o,1),t=t.parent):(bs(o.right)===0&&(Wt(o.left,0),Wt(o,1),B_(n,o),o=t.parent.right),Wt(o,bs(t.parent)),Wt(t.parent,0),Wt(o.right,0),F_(n,t.parent),t=n.root)):(o=t.parent.left,bs(o)===1&&(Wt(o,0),Wt(t.parent,1),B_(n,t.parent),o=t.parent.left),bs(o.left)===0&&bs(o.right)===0?(Wt(o,1),t=t.parent):(bs(o.left)===0&&(Wt(o.right,0),Wt(o,1),F_(n,o),o=t.parent.left),Wt(o,bs(t.parent)),Wt(t.parent,0),Wt(o.left,0),B_(n,t.parent),t=n.root));Wt(t,0),aE()}function WCe(n){for(;n.left!==qe;)n=n.left;return n}function aE(){qe.parent=qe,qe.delta=0,qe.start=0,qe.end=0}function F_(n,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==qe&&(t.left.parent=e),t.parent=e.parent,e.parent===qe?n.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,ou(e),ou(t)}function B_(n,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(n.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==qe&&(t.right.parent=e),t.parent=e.parent,e.parent===qe?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,ou(e),ou(t)}function nG(n){let e=n.end;if(n.left!==qe){const t=n.left.maxEnd;t>e&&(e=t)}if(n.right!==qe){const t=n.right.maxEnd+n.delta;t>e&&(e=t)}return e}function ou(n){n.maxEnd=nG(n)}function Vc(n){for(;n!==qe;){const e=nG(n);if(n.maxEnd===e)return;n.maxEnd=e,n=n.parent}}function VCe(n,e,t,i){return n===t?e-i:n-t}class rN{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Oe)return KP(this.right);let e=this;for(;e.parent!==Oe&&e.parent.left!==e;)e=e.parent;return e.parent===Oe?Oe:e.parent}prev(){if(this.left!==Oe)return sG(this.left);let e=this;for(;e.parent!==Oe&&e.parent.right!==e;)e=e.parent;return e.parent===Oe?Oe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Oe=new rN(null,0);Oe.parent=Oe;Oe.left=Oe;Oe.right=Oe;Oe.color=0;function KP(n){for(;n.left!==Oe;)n=n.left;return n}function sG(n){for(;n.right!==Oe;)n=n.right;return n}function YP(n){return n===Oe?0:n.size_left+n.piece.length+YP(n.right)}function ZP(n){return n===Oe?0:n.lf_left+n.piece.lineFeedCnt+ZP(n.right)}function lE(){Oe.parent=Oe}function W_(n,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==Oe&&(t.left.parent=e),t.parent=e.parent,e.parent===Oe?n.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function V_(n,e){const t=e.left;e.left=t.right,t.right!==Oe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===Oe?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function Cw(n,e){let t,i;if(e.left===Oe?(i=e,t=i.right):e.right===Oe?(i=e,t=i.left):(i=KP(e.right),t=i.right),i===n.root){n.root=t,t.color=0,e.detach(),lE(),n.root.parent=Oe;return}const s=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,d_(n,t)):(i.parent===e?t.parent=i:t.parent=i.parent,d_(n,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Oe&&(i.left.parent=i),i.right!==Oe&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,d_(n,i)),e.detach(),t.parent.left===t){const r=YP(t),a=ZP(t);if(r!==t.parent.size_left||a!==t.parent.lf_left){const l=r-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=r,t.parent.lf_left=a,Cl(n,t.parent,l,c)}}if(d_(n,t.parent),s){lE();return}let o;for(;t!==n.root&&t.color===0;)t===t.parent.left?(o=t.parent.right,o.color===1&&(o.color=0,t.parent.color=1,W_(n,t.parent),o=t.parent.right),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.right.color===0&&(o.left.color=0,o.color=1,V_(n,o),o=t.parent.right),o.color=t.parent.color,t.parent.color=0,o.right.color=0,W_(n,t.parent),t=n.root)):(o=t.parent.left,o.color===1&&(o.color=0,t.parent.color=1,V_(n,t.parent),o=t.parent.left),o.left.color===0&&o.right.color===0?(o.color=1,t=t.parent):(o.left.color===0&&(o.right.color=0,o.color=1,W_(n,o),o=t.parent.left),o.color=t.parent.color,t.parent.color=0,o.left.color=0,V_(n,t.parent),t=n.root));t.color=0,lE()}function b8(n,e){for(d_(n,e);e!==n.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,W_(n,e)),e.parent.color=0,e.parent.parent.color=1,V_(n,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,V_(n,e)),e.parent.color=0,e.parent.parent.color=1,W_(n,e.parent.parent))}n.root.color=0}function Cl(n,e,t,i){for(;e!==n.root&&e!==Oe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function d_(n,e){let t=0,i=0;if(e!==n.root){for(;e!==n.root&&e===e.parent.right;)e=e.parent;if(e!==n.root)for(e=e.parent,t=YP(e.left)-e.size_left,i=ZP(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==n.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const gl=65535;function oG(n){let e;return n[n.length-1]<65536?e=new Uint16Array(n.length):e=new Uint32Array(n.length),e.set(n,0),e}class zCe{constructor(e,t,i,s,o){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=s,this.isBasicASCII=o}}function Sl(n,e=!0){const t=[0];let i=1;for(let s=0,o=n.length;s<o;s++){const r=n.charCodeAt(s);r===13?s+1<o&&n.charCodeAt(s+1)===10?(t[i++]=s+2,s++):t[i++]=s+1:r===10&&(t[i++]=s+1)}return e?oG(t):t}function HCe(n,e){n.length=0,n[0]=0;let t=1,i=0,s=0,o=0,r=!0;for(let l=0,c=e.length;l<c;l++){const d=e.charCodeAt(l);d===13?l+1<c&&e.charCodeAt(l+1)===10?(o++,n[t++]=l+2,l++):(i++,n[t++]=l+1):d===10?(s++,n[t++]=l+1):r&&d!==9&&(d<32||d>126)&&(r=!1)}const a=new zCe(oG(n),i,s,o,r);return n.length=0,a}class Ws{constructor(e,t,i,s,o){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=s,this.length=o}}class dh{constructor(e,t){this.buffer=e,this.lineStarts=t}}class $Ce{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Oe&&e.iterate(e.root,i=>(i!==Oe&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class UCe{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let s=0;s<i.length;s++){const o=i[s];if(o.node.parent===null||o.nodeStartOffset>=e){i[s]=null,t=!0;continue}}if(t){const s=[];for(const o of i)o!==null&&s.push(o);this._cache=s}}}class jCe{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new dh("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Oe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let s=null;for(let o=0,r=e.length;o<r;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=Sl(e[o].buffer));const a=new Ws(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),s=this.rbInsertRight(s,a)}this._searchCache=new UCe(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=gl,i=t-Math.floor(t/3),s=i*2;let o="",r=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),d=c.length;if(r<=i||r+d<s)return o+=c,r+=d,!0;const u=o.replace(/\r\n|\r|\n/g,e);return a.push(new dh(u,Sl(u))),o=c,r=d,!0}),r>0){const l=o.replace(/\r\n|\r|\n/g,e);a.push(new dh(l,Sl(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new $Ce(this,e)}getOffsetAt(e,t){let i=0,s=this.root;for(;s!==Oe;)if(s.left!==Oe&&s.lf_left+1>=e)s=s.left;else if(s.lf_left+s.piece.lineFeedCnt+1>=e){i+=s.size_left;const o=this.getAccumulatedValue(s,e-s.lf_left-2);return i+=o+t-1}else e-=s.lf_left+s.piece.lineFeedCnt,i+=s.size_left+s.piece.length,s=s.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const s=e;for(;t!==Oe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const o=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+o.index,o.index===0){const r=this.getOffsetAt(i+1,1),a=s-r;return new V(i+1,a+1)}return new V(i+1,o.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===Oe){const o=this.getOffsetAt(i+1,1),r=s-e-o;return new V(i+1,r+1)}else t=t.right;return new V(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),s=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(i,s);return t?t!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const s=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let r=s.substring(o+e.remainder,o+i.piece.length);for(i=i.next();i!==Oe;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){r+=a.substring(l,l+t.remainder);break}else r+=a.substr(l,i.piece.length);i=i.next()}return r}getLinesContent(){const e=[];let t=0,i="",s=!1;return this.iterate(this.root,o=>{if(o===Oe)return!0;const r=o.piece;let a=r.length;if(a===0)return!0;const l=this._buffers[r.bufferIndex].buffer,c=this._buffers[r.bufferIndex].lineStarts,d=r.start.line,u=r.end.line;let h=c[d]+r.start.column;if(s&&(l.charCodeAt(h)===10&&(h++,a--),e[t++]=i,i="",s=!1,a===0))return!0;if(d===u)return!this._EOLNormalized&&l.charCodeAt(h+a-1)===13?(s=!0,i+=l.substr(h,a-1)):i+=l.substr(h,a),!0;i+=this._EOLNormalized?l.substring(h,Math.max(h,c[d+1]-this._EOLLength)):l.substring(h,c[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=d+1;f<u;f++)i=this._EOLNormalized?l.substring(c[f],c[f+1]-this._EOLLength):l.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[u]+r.end.column-1)===13?(s=!0,r.end.column===0?t--:i=l.substr(c[u],r.end.column-1)):i=l.substr(c[u],r.end.column),!0}),s&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],s=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(s)}else{const t=this._buffers[e.node.piece.bufferIndex],s=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(s)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,s,o,r,a,l,c,d,u){const h=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,o),p=this.offsetInBuffer(e.piece.bufferIndex,r);let _;const v={line:0,column:0};let b,y;t._wordSeparators?(b=h.buffer.substring(g,p),y=w=>w+g,t.reset(0)):(b=h.buffer,y=w=>w,t.reset(g));do if(_=t.next(b),_){if(y(_.index)>=p)return d;this.positionInBuffer(e,y(_.index)-f,v);const w=this.getLineFeedCnt(e.piece.bufferIndex,o,v),C=v.line===o.line?v.column-o.column+s:v.column+1,L=C+_[0].length;if(u[d++]=nh(new N(i+w,C,i+w,L),_,l),y(_.index)+_[0].length>=p||d>=c)return d}while(_);return d}findMatchesLineByLine(e,t,i,s){const o=[];let r=0;const a=new Fg(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let d=this.positionInBuffer(l.node,l.remainder);const u=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,d,u,t,i,s,r,o),o;let h=e.startLineNumber,f=l.node;for(;f!==c.node;){const p=this.getLineFeedCnt(f.piece.bufferIndex,d,f.piece.end);if(p>=1){const v=this._buffers[f.piece.bufferIndex].lineStarts,b=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),y=v[d.line+p],w=h===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(f,a,h,w,d,this.positionInBuffer(f,y-b),t,i,s,r,o),r>=s)return o;h+=p}const _=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const v=this.getLineContent(h).substring(_,e.endColumn-1);return r=this._findMatchesInLine(t,a,v,e.endLineNumber,_,r,o,i,s),o}if(r=this._findMatchesInLine(t,a,this.getLineContent(h).substr(_),h,_,r,o,i,s),r>=s)return o;h++,l=this.nodeAt2(h,1),f=l.node,d=this.positionInBuffer(l.node,l.remainder)}if(h===e.endLineNumber){const p=h===e.startLineNumber?e.startColumn-1:0,_=this.getLineContent(h).substring(p,e.endColumn-1);return r=this._findMatchesInLine(t,a,_,e.endLineNumber,p,r,o,i,s),o}const g=h===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(c.node,a,h,g,d,u,t,i,s,r,o),o}_findMatchesInLine(e,t,i,s,o,r,a,l,c){const d=e.wordSeparators;if(!l&&e.simpleSearch){const h=e.simpleSearch,f=h.length,g=i.length;let p=-f;for(;(p=i.indexOf(h,p+f))!==-1;)if((!d||_P(d,i,g,p,f))&&(a[r++]=new $b(new N(s,p+1+o,s,p+1+f+o),null),r>=c))return r;return r}let u;t.reset(0);do if(u=t.next(i),u&&(a[r++]=nh(new N(s,u.index+1+o,s,u.index+1+u[0].length+o),u,l),r>=c))return r;while(u);return r}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Oe){const{node:s,remainder:o,nodeStartOffset:r}=this.nodeAt(e),a=s.piece,l=a.bufferIndex,c=this.positionInBuffer(s,o);if(s.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&r+a.length===e&&t.length<gl){this.appendToNode(s,t),this.computeBufferMetadata();return}if(r===e)this.insertContentToNodeLeft(t,s),this._searchCache.validate(e);else if(r+s.piece.length>e){const d=[];let u=new Ws(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(s,o)===10){const p={line:u.start.line+1,column:0};u=new Ws(u.bufferIndex,p,u.end,this.getLineFeedCnt(u.bufferIndex,p,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(s,o-1)===13){const p=this.positionInBuffer(s,o-1);this.deleteNodeTail(s,p),t="\r"+t,s.piece.length===0&&d.push(s)}else this.deleteNodeTail(s,c);else this.deleteNodeTail(s,c);const h=this.createNewPieces(t);u.length>0&&this.rbInsertRight(s,u);let f=s;for(let g=0;g<h.length;g++)f=this.rbInsertRight(f,h[g]);this.deleteNodes(d)}else this.insertContentToNodeRight(t,s)}else{const s=this.createNewPieces(t);let o=this.rbInsertLeft(null,s[0]);for(let r=1;r<s.length;r++)o=this.rbInsertRight(o,s[r])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Oe)return;const i=this.nodeAt(e),s=this.nodeAt(e+t),o=i.node,r=s.node;if(o===r){const h=this.positionInBuffer(o,i.remainder),f=this.positionInBuffer(o,s.remainder);if(i.nodeStartOffset===e){if(t===o.piece.length){const g=o.next();Cw(this,o),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(o,f),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(i.nodeStartOffset+o.piece.length===e+t){this.deleteNodeTail(o,h),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,h,f),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,l),this._searchCache.validate(e),o.piece.length===0&&a.push(o);const c=this.positionInBuffer(r,s.remainder);this.deleteNodeHead(r,c),r.piece.length===0&&a.push(r);const d=o.next();for(let h=d;h!==Oe&&h!==r;h=h.next())a.push(h);const u=o.piece.length===0?o.prev():o;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const r=t.piece,a={line:r.start.line+1,column:0},l=new Ws(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),r.length-1);t.piece=l,e+=`
`,Cl(this,t,-1,-1),t.piece.length===0&&i.push(t)}const s=this.createNewPieces(e);let o=this.rbInsertLeft(t,s[s.length-1]);for(let r=s.length-2;r>=0;r--)o=this.rbInsertLeft(o,s[r]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),s=this.rbInsertRight(t,i[0]);let o=s;for(let r=1;r<i.length;r++)o=this.rbInsertRight(o,i[r]);this.validateCRLFWithPrevNode(s)}positionInBuffer(e,t,i){const s=e.piece,o=e.piece.bufferIndex,r=this._buffers[o].lineStarts,l=r[s.start.line]+s.start.column+t;let c=s.start.line,d=s.end.line,u=0,h=0,f=0;for(;c<=d&&(u=c+(d-c)/2|0,f=r[u],u!==d);)if(h=r[u+1],l<f)d=u-1;else if(l>=h)c=u+1;else break;return i?(i.line=u,i.column=l-f,null):{line:u,column:l-f}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const s=this._buffers[e].lineStarts;if(i.line===s.length-1)return i.line-t.line;const o=s[i.line+1],r=s[i.line]+i.column;if(o>r+1)return i.line-t.line;const a=r-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)Cw(this,e[t])}createNewPieces(e){if(e.length>gl){const d=[];for(;e.length>gl;){const h=e.charCodeAt(gl-1);let f;h===13||h>=55296&&h<=56319?(f=e.substring(0,gl-1),e=e.substring(gl-1)):(f=e.substring(0,gl),e=e.substring(gl));const g=Sl(f);d.push(new Ws(this._buffers.length,{line:0,column:0},{line:g.length-1,column:f.length-g[g.length-1]},g.length-1,f.length)),this._buffers.push(new dh(f,g))}const u=Sl(e);return d.push(new Ws(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new dh(e,u)),d}let t=this._buffers[0].buffer.length;const i=Sl(e,!1);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},s=this._lastChangeBufferPos;for(let d=0;d<i.length;d++)i[d]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let d=0;d<i.length;d++)i[d]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const o=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,a=o-this._buffers[0].lineStarts[r],l={line:r,column:a},c=new Ws(0,s,l,this.getLineFeedCnt(0,s,l),o-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,s="";const o=this._searchCache.get2(e);if(o){i=o.node;const r=this.getAccumulatedValue(i,e-o.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt===e)s=a.substring(l+r,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-o.nodeStartLineNumber);return a.substring(l+r,l+c-t)}}else{let r=0;const a=e;for(;i!==Oe;)if(i.left!==Oe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),d=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:r,nodeStartLineNumber:a-(e-1-i.lf_left)}),d.substring(u+l,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);s=c.substring(d+l,d+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==Oe;){const r=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return s+=r.substring(l,l+a-t),s}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);s+=r.substr(a,i.piece.length)}i=i.next()}return s}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==Oe;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,s=this.positionInBuffer(e,t),o=s.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const r=this.getLineFeedCnt(e.piece.bufferIndex,i.start,s);if(r!==o)return{index:r,remainder:0}}return{index:o,remainder:s.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,s=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+t+1;return o>i.end.line?s[i.end.line]+i.end.column-s[i.start.line]-i.start.column:s[o]-s[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,s=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),r=t,a=this.offsetInBuffer(i.bufferIndex,r),l=this.getLineFeedCnt(i.bufferIndex,i.start,r),c=l-s,d=a-o,u=i.length+d;e.piece=new Ws(i.bufferIndex,i.start,r,l,u),Cl(this,e,d,c)}deleteNodeHead(e,t){const i=e.piece,s=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),r=t,a=this.getLineFeedCnt(i.bufferIndex,r,i.end),l=this.offsetInBuffer(i.bufferIndex,r),c=a-s,d=o-l,u=i.length+d;e.piece=new Ws(i.bufferIndex,r,i.end,a,u),Cl(this,e,d,c)}shrinkNode(e,t,i){const s=e.piece,o=s.start,r=s.end,a=s.length,l=s.lineFeedCnt,c=t,d=this.getLineFeedCnt(s.bufferIndex,s.start,c),u=this.offsetInBuffer(s.bufferIndex,t)-this.offsetInBuffer(s.bufferIndex,o);e.piece=new Ws(s.bufferIndex,s.start,c,d,u),Cl(this,e,u-a,d-l);const h=new Ws(s.bufferIndex,i,r,this.getLineFeedCnt(s.bufferIndex,i,r),this.offsetInBuffer(s.bufferIndex,r)-this.offsetInBuffer(s.bufferIndex,i)),f=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),s=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const o=Sl(t,!1);for(let f=0;f<o.length;f++)o[f]+=s;if(i){const f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));const r=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[r],l={line:r,column:a},c=e.piece.length+t.length,d=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),h=u-d;e.piece=new Ws(e.piece.bufferIndex,e.piece.start,l,u,c),this._lastChangeBufferPos=l,Cl(this,e,t.length,h)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let s=0;for(;t!==Oe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){s+=t.size_left;const o={node:t,remainder:e-t.size_left,nodeStartOffset:s};return this._searchCache.set(o),o}else e-=t.size_left+t.piece.length,s+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,s=0;for(;i!==Oe;)if(i.left!==Oe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2),r=this.getAccumulatedValue(i,e-i.lf_left-1);return s+=i.size_left,{node:i,remainder:Math.min(o+t-1,r),nodeStartOffset:s}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2);if(o+t-1<=i.piece.length)return{node:i,remainder:o+t-1,nodeStartOffset:s};t-=i.piece.length-o;break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==Oe;){if(i.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(i,0),r=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,o),nodeStartOffset:r}}else if(i.piece.length>=t-1){const o=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:o}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],s=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(s)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===Oe||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,s=t.start.line,o=i[s]+t.start.column;return s===i.length-1||i[s+1]>o+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===Oe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],s=this._buffers[e.piece.bufferIndex].lineStarts;let o;e.piece.end.column===0?o={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}:o={line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Ws(e.piece.bufferIndex,e.piece.start,o,a,r),Cl(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Ws(t.piece.bufferIndex,l,t.piece.end,d,c),Cl(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let h=0;h<i.length;h++)Cw(this,i[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)Cw(this,i);else{const s=i.piece,o={line:s.start.line+1,column:0},r=s.length-1,a=this.getLineFeedCnt(s.bufferIndex,o,s.end);i.piece=new Ws(s.bufferIndex,o,s.end,a,r),Cl(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Oe)return t(Oe);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===Oe)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,s=this.offsetInBuffer(i.bufferIndex,i.start),o=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(s,o)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),s=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,s)}rbInsertRight(e,t){const i=new rN(t,1);if(i.left=Oe,i.right=Oe,i.parent=Oe,i.size_left=0,i.lf_left=0,this.root===Oe)this.root=i,i.color=0;else if(e.right===Oe)e.right=i,i.parent=e;else{const o=KP(e.right);o.left=i,i.parent=o}return b8(this,i),i}rbInsertLeft(e,t){const i=new rN(t,1);if(i.left=Oe,i.right=Oe,i.parent=Oe,i.size_left=0,i.lf_left=0,this.root===Oe)this.root=i,i.color=0;else if(e.left===Oe)e.left=i,i.parent=e;else{const s=sG(e.left);s.right=i,i.parent=s}return b8(this,i),i}}class Cp extends Y{constructor(e,t,i,s,o,r,a){super(),this._onDidChangeContent=this._register(new B),this._BOM=t,this._mightContainNonBasicASCII=!r,this._mightContainRTL=s,this._mightContainUnusualLineTerminators=o,this._pieceTree=new jCe(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,s=this.getPositionAt(e),o=this.getPositionAt(i);return new N(s.lineNumber,s.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),s=this.getOffsetAt(e.endLineNumber,e.endColumn);let o=0;const r=this._getEndOfLine(t),a=this.getEOL();if(r.length!==a.length){const l=r.length-a.length,c=e.endLineNumber-e.startLineNumber;o=l*c}return s-i+o}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const s=e.startLineNumber,o=e.endLineNumber;for(let r=s;r<=o;r++){const a=this.getLineContent(r),l=r===s?e.startColumn-1:0,c=r===o?e.endColumn-1:a.length;for(let d=l;d<c;d++)tn(a.charCodeAt(d))?(i=i+1,d=d+1):i=i+1}return i+=this._getEndOfLine(t).length*(o-s),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Zs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Of(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let s=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,a=!0,l=[];for(let p=0;p<e.length;p++){const _=e[p];a&&_._isTracked&&(a=!1);const v=_.range;if(_.text){let L=!0;r||(L=!iP(_.text),r=L),!s&&L&&(s=Fb(_.text)),!o&&L&&(o=YU(_.text))}let b="",y=0,w=0,C=0;if(_.text){let L;[y,w,C,L]=_f(_.text);const x=this.getEOL();L===0||L===(x===`\r
`?2:1)?b=_.text:b=_.text.replace(/\r\n|\r|\n/g,x)}l[p]={sortIndex:p,identifier:_.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:b,eolCount:y,firstLineLength:w,lastLineLength:C,forceMoveMarkers:!!_.forceMoveMarkers,isAutoWhitespaceEdit:_.isAutoWhitespaceEdit||!1}}l.sort(Cp._sortOpsAscending);let c=!1;for(let p=0,_=l.length-1;p<_;p++){const v=l[p].range.getEndPosition(),b=l[p+1].range.getStartPosition();if(b.isBeforeOrEqual(v)){if(b.isBefore(v))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const d=i||t?Cp._getInverseEditRanges(l):[],u=[];if(t)for(let p=0;p<l.length;p++){const _=l[p],v=d[p];if(_.isAutoWhitespaceEdit&&_.range.isEmpty())for(let b=v.startLineNumber;b<=v.endLineNumber;b++){let y="";b===v.startLineNumber&&(y=this.getLineContent(_.range.startLineNumber),Zs(y)!==-1)||u.push({lineNumber:b,oldContent:y})}}let h=null;if(i){let p=0;h=[];for(let _=0;_<l.length;_++){const v=l[_],b=d[_],y=this.getValueInRange(v.range),w=v.rangeOffset+p;p+=v.text.length-y.length,h[_]={sortIndex:v.sortIndex,identifier:v.identifier,range:b,text:y,textChange:new yn(v.rangeOffset,y,w,v.text)}}c||h.sort((_,v)=>_.sortIndex-v.sortIndex)}this._mightContainRTL=s,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=r;const f=this._doApplyEdits(l);let g=null;if(t&&u.length>0){u.sort((p,_)=>_.lineNumber-p.lineNumber),g=[];for(let p=0,_=u.length;p<_;p++){const v=u[p].lineNumber;if(p>0&&u[p-1].lineNumber===v)continue;const b=u[p].oldContent,y=this.getLineContent(v);y.length===0||y===b||Zs(y)!==-1||g.push(v)}}return this._onDidChangeContent.fire(),new e_e(h,f,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,s=e[e.length-1].range,o=new N(i.startLineNumber,i.startColumn,s.endLineNumber,s.endColumn);let r=i.startLineNumber,a=i.startColumn;const l=[];for(let f=0,g=e.length;f<g;f++){const p=e[f],_=p.range;t=t||p.forceMoveMarkers,l.push(this.getValueInRange(new N(r,a,_.startLineNumber,_.startColumn))),p.text.length>0&&l.push(p.text),r=_.endLineNumber,a=_.endColumn}const c=l.join(""),[d,u,h]=_f(c);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:c,eolCount:d,firstLineLength:u,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(Cp._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const s=e[i],o=s.range.startLineNumber,r=s.range.startColumn,a=s.range.endLineNumber,l=s.range.endColumn;if(o===a&&r===l&&s.text.length===0)continue;s.text?(this._pieceTree.delete(s.rangeOffset,s.rangeLength),this._pieceTree.insert(s.rangeOffset,s.text,!0)):this._pieceTree.delete(s.rangeOffset,s.rangeLength);const c=new N(o,r,a,l);t.push({range:c,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,s){return this._pieceTree.findMatchesLineByLine(e,t,i,s)}static _getInverseEditRanges(e){const t=[];let i=0,s=0,o=null;for(let r=0,a=e.length;r<a;r++){const l=e[r];let c,d;o?o.range.endLineNumber===l.range.startLineNumber?(c=i,d=s+(l.range.startColumn-o.range.endColumn)):(c=i+(l.range.startLineNumber-o.range.endLineNumber),d=l.range.startColumn):(c=l.range.startLineNumber,d=l.range.startColumn);let u;if(l.text.length>0){const h=l.eolCount+1;h===1?u=new N(c,d,c,d+l.firstLineLength):u=new N(c,d,c+h-1,l.lastLineLength+1)}else u=new N(c,d,c,d);i=u.endLineNumber,s=u.endColumn,t.push(u),o=l}return t}static _sortOpsAscending(e,t){const i=N.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=N.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class qCe{constructor(e,t,i,s,o,r,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=s,this._crlf=o,this._containsRTL=r,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let o=0,r=i.length;o<r;o++){const a=i[o].buffer.replace(/\r\n|\r|\n/g,t),l=Sl(a);i[o]=new dh(a,l)}const s=new Cp(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:s,disposable:s}}}class rG{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&sP(e)&&(this.BOM=Xge,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=HCe(this._tmpLineStarts,e);this.chunks.push(new dh(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=Fb(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=YU(e)))}finish(e=!0){return this._finish(),new qCe(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=Sl(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class GCe{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const s=this._store.slice(0,e),o=this._store.slice(e+t),r=KCe(i,this._default);this._store=s.concat(r,o)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let s=0;s<t;s++)i[s]=this._default;this._store=dD(this._store,e,i)}}function KCe(n,e){const t=[];for(let i=0;i<n;i++)t[i]=e;return t}class YCe{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class aN{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new YCe(e,[t]))}finalize(){return this._tokens}}class ZCe{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new lN(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class XCe extends ZCe{constructor(e,t,i,s){super(e,t),this._textModel=i,this._languageIdCodec=s}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const s=this.getFirstInvalidLine();if(!s||s.lineNumber>t)break;const o=this._textModel.getLineContent(s.lineNumber),r=N0(this._languageIdCodec,i,this.tokenizationSupport,o,!0,s.startState);e.add(s.lineNumber,r.tokens),this.store.setEndState(s.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const s=this._textModel.getLanguageId(),o=this._textModel.getLineContent(e.lineNumber),r=o.substring(0,e.column-1)+t+o.substring(e.column-1),a=N0(this._languageIdCodec,s,this.tokenizationSupport,r,!0,i),l=new on(a.tokens,r,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLineWithEdit(e,t,i){const s=e.lineNumber,o=e.column,r=this.getStartState(s);if(!r)return null;const a=this._textModel.getLineContent(s),l=a.substring(0,o-1)+i+a.substring(o-1+t),c=this._textModel.getLanguageIdAtPosition(s,0),d=N0(this._languageIdCodec,c,this.tokenizationSupport,l,!0,r);return new on(d.tokens,l,this._languageIdCodec)}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let s=this.guessStartState(t);const o=this._textModel.getLanguageId();for(let r=t;r<=i;r++){const a=this._textModel.getLineContent(r),l=N0(this._languageIdCodec,o,this.tokenizationSupport,a,!0,s);e.add(r,l.tokens),s=l.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e);const i=[];let s=null;for(let a=e-1;t>1&&a>=1;a--){const l=this._textModel.getLineFirstNonWhitespaceColumn(a);if(l!==0&&l<t&&(i.push(this._textModel.getLineContent(a)),t=l,s=this.getStartState(a),s))break}s||(s=this.tokenizationSupport.getInitialState()),i.reverse();const o=this._textModel.getLanguageId();let r=s;for(const a of i)r=N0(this._languageIdCodec,o,this.tokenizationSupport,a,!1,r).endState;return r}}class lN{constructor(e){this.lineCount=e,this._tokenizationStateStore=new QCe,this._invalidEndStatesLineNumbers=new JCe,this._invalidEndStatesLineNumbers.addRange(new Ye(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new ji("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new Ye(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new Ye(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=_f(t.text);this.acceptChange(new Qe(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new Ye(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new ji("Start state must be defined");return{lineNumber:t,startState:i}}}class QCe{constructor(){this._lineEndStates=new GCe(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class JCe{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new Ye(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new Ye(i.start,e):this._ranges.splice(t,1,new Ye(i.start,e),new Ye(e+1,i.endExclusive))}}addRange(e){Ye.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let s=i;for(;!(s>=this._ranges.length||e.endExclusive<this._ranges[s].start);)s++;const o=t-e.length;for(let r=s;r<this._ranges.length;r++)this._ranges[r]=this._ranges[r].delta(o);if(i===s){const r=new Ye(e.start,e.start+t);r.isEmpty||this._ranges.splice(i,0,r)}else{const r=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[s-1].endExclusive),l=new Ye(r,a+o);l.isEmpty?this._ranges.splice(i,s-i):this._ranges.splice(i,s-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function N0(n,e,t,i,s,o){let r=null;if(t)try{r=t.tokenizeEncoded(i,s,o.clone())}catch(a){mt(a)}return r||(r=wP(n.encodeLanguageId(e),o)),on.convertToEndOffset(r.tokens,i.length),r}class eSe{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,rd(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?xU(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new aN,i=yu.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){var t;const i=(t=this._tokenizerWithStateStore)===null||t===void 0?void 0:t.getFirstInvalidLine();return i?(this._tokenizerWithStateStore.updateTokensUntilLine(e,i.lineNumber),i.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Qe(e,t))}}const xl=new Uint32Array(0).buffer;class ya{static deleteBeginning(e,t){return e===null||e===xl?e:ya.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===xl)return e;const i=$l(e),s=i[i.length-2];return ya.delete(e,t,s)}static delete(e,t,i){if(e===null||e===xl||t===i)return e;const s=$l(e),o=s.length>>>1;if(t===0&&s[s.length-2]===i)return xl;const r=on.findIndexInTokensArray(s,t),a=r>0?s[r-1<<1]:0,l=s[r<<1];if(i<l){const f=i-t;for(let g=r;g<o;g++)s[g<<1]-=f;return e}let c,d;a!==t?(s[r<<1]=t,c=r+1<<1,d=t):(c=r<<1,d=a);const u=i-t;for(let f=r+1;f<o;f++){const g=s[f<<1]-u;g>d&&(s[c++]=g,s[c++]=s[(f<<1)+1],d=g)}if(c===s.length)return e;const h=new Uint32Array(c);return h.set(s.subarray(0,c),0),h.buffer}static append(e,t){if(t===xl)return e;if(e===xl)return t;if(e===null)return e;if(t===null)return null;const i=$l(e),s=$l(t),o=s.length>>>1,r=new Uint32Array(i.length+s.length);r.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<o;c++)r[a++]=s[c<<1]+l,r[a++]=s[(c<<1)+1];return r.buffer}static insert(e,t,i){if(e===null||e===xl)return e;const s=$l(e),o=s.length>>>1;let r=on.findIndexInTokensArray(s,t);r>0&&s[r-1<<1]===t&&r--;for(let a=r;a<o;a++)s[a<<1]+=i;return e}}function $l(n){return n instanceof Uint32Array?n:new Uint32Array(n)}class fv{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let s=null;if(t<this._len&&(s=this._lineTokens[t]),s!==null&&s!==xl)return new on($l(s),i,this._languageIdCodec);const o=new Uint32Array(2);return o[0]=i.length,o[1]=v8(this._languageIdCodec.encodeLanguageId(e)),new on(o,i,this._languageIdCodec)}static _massageTokens(e,t,i){const s=i?$l(i):null;if(t===0){let o=!1;if(s&&s.length>1&&(o=Us.getLanguageId(s[1])!==e),!o)return xl}if(!s||s.length===0){const o=new Uint32Array(2);return o[0]=t,o[1]=v8(e),o.buffer}return s[s.length-2]=t,s.byteOffset===0&&s.byteLength===s.buffer.byteLength?s.buffer:s}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let s=0;s<t;s++)i[s]=null;this._lineTokens=dD(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,s,o){const r=fv._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,s);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=r,o?!fv._equals(a,r):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=$l(e),s=$l(t);if(i.length!==s.length)return!1;for(let o=0,r=i.length;o<r;o++)if(i[o]!==s[o])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new V(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=ya.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=ya.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let s=null;i<this._len&&(s=ya.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=ya.append(this._lineTokens[t],s),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const s=e.lineNumber-1;if(!(s>=this._len)){if(t===0){this._lineTokens[s]=ya.insert(this._lineTokens[s],e.column-1,i);return}this._lineTokens[s]=ya.deleteEnding(this._lineTokens[s],e.column-1),this._lineTokens[s]=ya.insert(this._lineTokens[s],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];let a=0,l=0,c=!1;for(let d=r.startLineNumber;d<=r.endLineNumber;d++)c?(this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!1),l=d):this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!0)&&(c=!0,a=d,l=d);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function v8(n){return(n<<0|0|0|32768|2<<24|1024)>>>0}class XP{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const o=t[0].getRange(),r=t[t.length-1].getRange();if(!o||!r)return e;i=e.plusRange(o).plusRange(r)}let s=null;for(let o=0,r=this._pieces.length;o<r;o++){const a=this._pieces[o];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){s=s||{index:o};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(o,1),o--,r--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){s=s||{index:o};continue}const[l,c]=a.split(i);if(l.isEmpty()){s=s||{index:o};continue}c.isEmpty()||(this._pieces.splice(o,1,l,c),o++,r++,s=s||{index:o})}return s=s||{index:this._pieces.length},t.length>0&&(this._pieces=dD(this._pieces,s.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;const i=this._pieces;if(i.length===0)return t;const s=XP._findFirstPieceWithLine(i,e),o=i[s].getLineTokens(e);if(!o)return t;const r=t.getCount(),a=o.getCount();let l=0;const c=[];let d=0,u=0;const h=(f,g)=>{f!==u&&(u=f,c[d++]=f,c[d++]=g)};for(let f=0;f<a;f++){const g=o.getStartCharacter(f),p=o.getEndCharacter(f),_=o.getMetadata(f),v=((_&1?2048:0)|(_&2?4096:0)|(_&4?8192:0)|(_&8?16384:0)|(_&16?16744448:0)|(_&32?4278190080:0))>>>0,b=~v>>>0;for(;l<r&&t.getEndOffset(l)<=g;)h(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<r&&t.getStartOffset(l)<g&&h(g,t.getMetadata(l));l<r&&t.getEndOffset(l)<p;)h(t.getEndOffset(l),t.getMetadata(l)&b|_&v),l++;if(l<r)h(p,t.getMetadata(l)&b|_&v),t.getEndOffset(l)===p&&l++;else{const y=Math.min(Math.max(0,l-1),r-1);h(p,t.getMetadata(y)&b|_&v)}}for(;l<r;)h(t.getEndOffset(l),t.getMetadata(l)),l++;return new on(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,s=e.length-1;for(;i<s;){let o=i+Math.floor((s-i)/2);if(e[o].endLineNumber<t)i=o+1;else if(e[o].startLineNumber>t)s=o-1;else{for(;o>i&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}}return i}acceptEdit(e,t,i,s,o){for(const r of this._pieces)r.acceptEdit(e,t,i,s,o)}}class fx extends Hq{constructor(e,t,i,s,o,r){super(),this._languageService=e,this._languageConfigurationService=t,this._textModel=i,this._bracketPairsTextModelPart=s,this._languageId=o,this._attachedViews=r,this._semanticTokens=new XP(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new B),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new B),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new B),this.onDidChangeTokens=this._onDidChangeTokens.event,this.grammarTokens=this._register(new tSe(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews)),this._register(this._languageConfigurationService.onDidChange(a=>{a.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(this.grammarTokens.onDidChangeTokens(a=>{this._emitModelTokensChangedEvent(a)})),this._register(this.grammarTokens.onDidChangeBackgroundTokenizationState(a=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()}))}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,s,o]=_f(t.text);this._semanticTokens.acceptEdit(t.range,i,s,o,t.text.length>0?t.text.charCodeAt(0):0)}this.grammarTokens.handleDidChangeContent(e)}handleDidChangeAttached(){this.grammarTokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this.grammarTokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new ji("Illegal value for lineNumber")}get hasTokens(){return this.grammarTokens.hasTokens}resetTokenization(){this.grammarTokens.resetTokenization()}get backgroundTokenizationState(){return this.grammarTokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this.grammarTokens.forceTokenization(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this.grammarTokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this.grammarTokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this.grammarTokens.getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLineWithEdit(e,t,i){return this.grammarTokens.tokenizeLineWithEdit(e,t,i)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),s=this.getLineTokens(t.lineNumber),o=s.findTokenIndexAtOffset(t.column-1),[r,a]=fx._findLanguageBoundaries(s,o),l=Nb(t.column,this.getLanguageConfiguration(s.getLanguageId(o)).getWordDefinition(),i.substring(r,a),r);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(o>0&&r===t.column-1){const[c,d]=fx._findLanguageBoundaries(s,o-1),u=Nb(t.column,this.getLanguageConfiguration(s.getLanguageId(o-1)).getWordDefinition(),i.substring(c,d),c);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn)return u}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let s=0;for(let r=t;r>=0&&e.getLanguageId(r)===i;r--)s=e.getStartOffset(r);let o=e.getLineContent().length;for(let r=t,a=e.getCount();r<a&&e.getLanguageId(r)===i;r++)o=e.getEndOffset(r);return[s,o]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new V(e,t)),s=this.getLineTokens(i.lineNumber);return s.getLanguageId(s.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this.grammarTokens.resetTokenization(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}}class tSe extends Y{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t,i,s){super(),this._languageIdCodec=e,this._textModel=t,this.getLanguageId=i,this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new ta),this._tokens=new fv(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new ta),this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new B),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new B),this.onDidChangeTokens=this._onDidChangeTokens.event,this._attachedViewStates=this._register(new j4),this._register(Si.onDidChange(o=>{const r=this.getLanguageId();o.changedLanguages.indexOf(r)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(s.onDidChangeVisibleRanges(({view:o,state:r})=>{if(r){let a=this._attachedViewStates.get(o);a||(a=new iSe(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(o,a)),a.handleStateChange(r)}else this._attachedViewStates.deleteAndDispose(o)}))}resetTokenization(e=!0){var t;this._tokens.flush(),(t=this._debugBackgroundTokens)===null||t===void 0||t.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new lN(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const i=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const r=Si.get(this.getLanguageId());if(!r)return[null,null];let a;try{a=r.getInitialState()}catch(l){return mt(l),[null,null]}return[r,a]},[s,o]=i();if(s&&o?this._tokenizer=new XCe(this._textModel.getLineCount(),s,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const r={setTokens:a=>{this.setTokens(a)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const a=2;this._backgroundTokenizationState=a,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(a,l)=>{var c;if(!this._tokenizer)return;const d=this._tokenizer.store.getFirstInvalidEndStateLineNumber();d!==null&&a>=d&&((c=this._tokenizer)===null||c===void 0||c.store.setEndState(a,l))}};s&&s.createBackgroundTokenizer&&!s.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=s.createBackgroundTokenizer(this._textModel,r)),this._backgroundTokenizer.value||(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new eSe(this._tokenizer,r),this._defaultBackgroundTokenizer.handleChanges()),s!=null&&s.backgroundTokenizerShouldOnlyVerifyTokens&&s.createBackgroundTokenizer?(this._debugBackgroundTokens=new fv(this._languageIdCodec),this._debugBackgroundStates=new lN(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=s.createBackgroundTokenizer(this._textModel,{setTokens:a=>{var l;(l=this._debugBackgroundTokens)===null||l===void 0||l.setMultilineTokens(a,this._textModel)},backgroundTokenizationFinished(){},setEndState:(a,l)=>{var c;(c=this._debugBackgroundStates)===null||c===void 0||c.setEndState(a,l)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){var e;(e=this._defaultBackgroundTokenizer)===null||e===void 0||e.handleChanges()}handleDidChangeContent(e){var t,i,s;if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(const o of e.changes){const[r,a]=_f(o.text);this._tokens.acceptEdit(o.range,r,a),(t=this._debugBackgroundTokens)===null||t===void 0||t.acceptEdit(o.range,r,a)}(i=this._debugBackgroundStates)===null||i===void 0||i.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=Qe.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){var i,s;if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const o=new aN,{heuristicTokens:r}=this._tokenizer.tokenizeHeuristically(o,e,t),a=this.setTokens(o.finalize());if(r)for(const l of a.changes)(i=this._backgroundTokenizer.value)===null||i===void 0||i.requestTokens(l.fromLineNumber,l.toLineNumber+1);(s=this._defaultBackgroundTokenizer)===null||s===void 0||s.checkFinished()}forceTokenization(e){var t,i;const s=new aN;(t=this._tokenizer)===null||t===void 0||t.updateTokensUntilLine(s,e),this.setTokens(s.finalize()),(i=this._defaultBackgroundTokenizer)===null||i===void 0||i.checkFinished()}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){var t;const i=this._textModel.getLineContent(e),s=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,i);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const o=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,i);!s.equals(o)&&(!((t=this._debugBackgroundTokenizer.value)===null||t===void 0)&&t.reportMismatchingTokens)&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return s}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const s=this._textModel.validatePosition(new V(e,t));return this.forceTokenization(s.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(s,i)}tokenizeLineWithEdit(e,t,i){if(!this._tokenizer)return null;const s=this._textModel.validatePosition(e);return this.forceTokenization(s.lineNumber),this._tokenizer.tokenizeLineWithEdit(s,t,i)}get hasTokens(){return this._tokens.hasTokens}}class iSe extends Y{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new Li(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){Ki(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class nSe{constructor(){this.changeType=1}}class sa{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",s=0;for(const o of t)i+=e.substring(s,o.column-1),s=o.column-1,i+=o.options.content;return i+=e.substring(s),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new sa(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new sa(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,s)=>i.lineNumber===s.lineNumber?i.column===s.column?i.order-s.order:i.column-s.column:i.lineNumber-s.lineNumber),t}constructor(e,t,i,s,o){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=s,this.order=o}}class y8{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class sSe{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class oSe{constructor(e,t,i,s){this.changeType=4,this.injectedTexts=s,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class rSe{constructor(){this.changeType=5}}class Sp{constructor(e,t,i,s){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=s,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),s=t.versionId,o=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new Sp(i,s,o,r)}}class aG{constructor(e){this.changes=e}}class Yh{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=Sp.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=Yh._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new Yh(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),s=t.eol,o=t.versionId,r=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:s,isEolChange:c,versionId:o,isUndoing:r,isRedoing:a,isFlush:l}}}const KD=at("undoRedoService");class lG{constructor(e,t){this.resource=e,this.elements=t}}class Em{constructor(){this.id=Em._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}Em._ID=0;Em.None=new Em;class Aa{constructor(){this.id=Aa._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}Aa._ID=0;Aa.None=new Aa;var aSe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},cE=function(n,e){return function(t,i){e(t,i,n)}},Ju;function lSe(n){const e=new rG;return e.acceptChunk(n),e.finish()}function cSe(n){const e=new rG;let t;for(;typeof(t=n.read())=="string";)e.acceptChunk(t);return e.finish()}function w8(n,e){let t;return typeof n=="string"?t=lSe(n):Q0e(n)?t=cSe(n):t=n,t.create(e)}let Sw=0;const dSe=999,uSe=1e4;class hSe{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const s=this._source.read();if(s===null)return this._eos=!0,t===0?null:e.join("");if(s.length>0&&(e[t++]=s,i+=s.length),i>=64*1024)return e.join("")}while(!0)}}const R0=()=>{throw new Error("Invalid change accessor")};let tl=Ju=class extends Y{static resolveOptions(e,t){if(t.detectIndentation){const i=u8(e,t.tabSize,t.insertSpaces);return new EC({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new EC(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return fr(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,s=null,o,r,a){super(),this._undoRedoService=o,this._languageService=r,this._languageConfigurationService=a,this._onWillDispose=this._register(new B),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new _Se(f=>this.handleBeforeFireDecorationsChangedEvent(f))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new B),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new B),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new B),this._eventEmitter=this._register(new bSe),this._languageSelectionListener=this._register(new ta),this._deltaDecorationCallCnt=0,this._attachedViews=new vSe,Sw++,this.id="$model"+Sw,this.isForSimpleWidget=i.isForSimpleWidget,typeof s>"u"||s===null?this._associatedResource=je.parse("inmemory://model/"+Sw):this._associatedResource=s,this._attachedEditorCount=0;const{textBuffer:l,disposable:c}=w8(e,i.defaultEOL);this._buffer=l,this._bufferDisposable=c,this._options=Ju.resolveOptions(this._buffer,i);const d=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new mCe(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new awe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new bCe(this)),this._tokenizationTextModelPart=new fx(this._languageService,this._languageConfigurationService,this,this._bracketPairs,d,this._attachedViews);const u=this._buffer.getLineCount(),h=this._buffer.getValueLengthInRange(new N(1,1,u,this._buffer.getLineLength(u)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=h>Ju.LARGE_FILE_SIZE_THRESHOLD||u>Ju.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=h>Ju.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=h>Ju._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=ZU(Sw),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new C8,this._commandManager=new GP(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(d)}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new Cp([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=Y.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new Yh(e,t)))}setValue(e){if(this._assertNotDisposed(),e==null)throw ic();const{textBuffer:t,disposable:i}=w8(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,s,o,r,a,l){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:s}],eol:this._buffer.getEOL(),isEolChange:l,versionId:this.getVersionId(),isUndoing:o,isRedoing:r,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),s=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new C8,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Sp([new nSe],this._versionId,!1,!1),this._createContentChanged2(new N(1,1,o,r),0,s,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),s=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Sp([new rSe],this._versionId,!1,!1),this._createContentChanged2(new N(1,1,o,r),0,s,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,s=t.length;i<s;i++){const o=t[i],r=o.range,a=o.cachedAbsoluteStart-o.start,l=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),c=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);o.cachedAbsoluteStart=l,o.cachedAbsoluteEnd=c,o.cachedVersionId=e,o.start=l-a,o.end=c-a,ou(o)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let s=1;s<=i;s++){const o=this._buffer.getLineLength(s);o>=uSe?t+=o:e+=o}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,s=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,o=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new EC({tabSize:t,indentSize:i,insertSpaces:s,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:o,bracketPairColorizationOptions:r});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=u8(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),Pq(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(KU.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new ji("Operation would exceed heap memory limits");const i=this.getFullModelRange(),s=this.getValueInRange(i,e);return t?this._buffer.getBOM()+s:s}createSnapshot(e=!1){return new hSe(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),s=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+s:s}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new ji("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new ji("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new ji("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new ji("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new ji("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new ji("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,s=e.startColumn;let o=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),r=Math.floor(typeof s=="number"&&!isNaN(s)?s:1);if(o<1)o=1,r=1;else if(o>t)o=t,r=this.getLineMaxColumn(o);else if(r<=1)r=1;else{const u=this.getLineMaxColumn(o);r>=u&&(r=u)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),d=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,d=1;else if(c>t)c=t,d=this.getLineMaxColumn(c);else if(d<=1)d=1;else{const u=this.getLineMaxColumn(c);d>=u&&(d=u)}return i===o&&s===r&&a===c&&l===d&&e instanceof N&&!(e instanceof lt)?e:new N(o,r,c,d)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const s=this._buffer.getLineCount();if(e>s)return!1;if(t===1)return!0;const o=this.getLineMaxColumn(e);if(t>o)return!1;if(i===1){const r=this._buffer.getLineCharCode(e,t-2);if(tn(r))return!1}return!0}_validatePosition(e,t,i){const s=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),o=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),r=this._buffer.getLineCount();if(s<1)return new V(1,1);if(s>r)return new V(r,this.getLineMaxColumn(r));if(o<=1)return new V(s,1);const a=this.getLineMaxColumn(s);if(o>=a)return new V(s,a);if(i===1){const l=this._buffer.getLineCharCode(s,o-2);if(tn(l))return new V(s,o-1)}return new V(s,o)}validatePosition(e){return this._assertNotDisposed(),e instanceof V&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,s=e.startColumn,o=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(i,s,0)||!this._isValidPosition(o,r,0))return!1;if(t===1){const a=s>1?this._buffer.getLineCharCode(i,s-2):0,l=r>1&&r<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,r-2):0,c=tn(a),d=tn(l);return!c&&!d}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof N&&!(e instanceof lt)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),s=this._validatePosition(e.endLineNumber,e.endColumn,0),o=i.lineNumber,r=i.column,a=s.lineNumber,l=s.column;{const c=r>1?this._buffer.getLineCharCode(o,r-2):0,d=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,u=tn(c),h=tn(d);return!u&&!h?new N(o,r,a,l):o===a&&r===l?new N(o,r-1,a,l-1):u&&h?new N(o,r-1,a,l+1):u?new N(o,r-1,a,l):new N(o,r,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new N(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,s){return this._buffer.findMatchesLineByLine(e,t,i,s)}findMatches(e,t,i,s,o,r,a=dSe){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(u=>N.isIRange(u))&&(l=t.map(u=>this.validateRange(u)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((u,h)=>u.startLineNumber-h.startLineNumber||u.startColumn-h.startColumn);const c=[];c.push(l.reduce((u,h)=>N.areIntersecting(u,h)?u.plusRange(h):(c.push(u),h)));let d;if(!i&&e.indexOf(`
`)<0){const h=new Qu(e,i,s,o).parseSearchRequest();if(!h)return[];d=f=>this.findMatchesLineByLine(f,h,r,a)}else d=u=>cw.findMatches(this,new Qu(e,i,s,o),u,r,a);return c.map(d).reduce((u,h)=>u.concat(h),[])}findNextMatch(e,t,i,s,o,r){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Qu(e,i,s,o).parseSearchRequest();if(!c)return null;const d=this.getLineCount();let u=new N(a.lineNumber,a.column,d,this.getLineMaxColumn(d)),h=this.findMatchesLineByLine(u,c,r,1);return cw.findNextMatch(this,new Qu(e,i,s,o),a,r),h.length>0||(u=new N(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),h=this.findMatchesLineByLine(u,c,r,1),h.length>0)?h[0]:null}return cw.findNextMatch(this,new Qu(e,i,s,o),a,r)}findPreviousMatch(e,t,i,s,o,r){this._assertNotDisposed();const a=this.validatePosition(t);return cw.findPreviousMatch(this,new Qu(e,i,s,o),a,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof $2?e:new $2(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,s=e.length;i<s;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,s){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,s)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,s){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const o=t.map(a=>({range:this.validateRange(a.range),text:a.text}));let r=!0;if(e)for(let a=0,l=e.length;a<l;a++){const c=e[a];let d=!1;for(let u=0,h=o.length;u<h;u++){const f=o[u].range,g=f.startLineNumber>c.endLineNumber,p=c.startLineNumber>f.endLineNumber;if(!g&&!p){d=!0;break}}if(!d){r=!1;break}}if(r)for(let a=0,l=this._trimAutoWhitespaceLines.length;a<l;a++){const c=this._trimAutoWhitespaceLines[a],d=this.getLineMaxColumn(c);let u=!0;for(let h=0,f=o.length;h<f;h++){const g=o[h].range,p=o[h].text;if(!(c<g.startLineNumber||c>g.endLineNumber)&&!(c===g.startLineNumber&&g.startColumn===d&&g.isEmpty()&&p&&p.length>0&&p.charAt(0)===`
`)&&!(c===g.startLineNumber&&g.startColumn===1&&g.isEmpty()&&p&&p.length>0&&p.charAt(p.length-1)===`
`)){u=!1;break}}if(u){const h=new N(c,1,c,d);t.push(new $2(null,h,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,s)}_applyUndo(e,t,i,s){const o=e.map(r=>{const a=this.getPositionAt(r.newPosition),l=this.getPositionAt(r.newEnd);return{range:new N(a.lineNumber,a.column,l.lineNumber,l.column),text:r.oldText}});this._applyUndoRedoEdits(o,t,!0,!1,i,s)}_applyRedo(e,t,i,s){const o=e.map(r=>{const a=this.getPositionAt(r.oldPosition),l=this.getPositionAt(r.oldEnd);return{range:new N(a.lineNumber,a.column,l.lineNumber,l.column),text:r.newText}});this._applyUndoRedoEdits(o,t,!1,!0,i,s)}_applyUndoRedoEdits(e,t,i,s,o,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=s,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(o)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),s=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),r=s.changes;if(this._trimAutoWhitespaceLines=s.trimAutoWhitespaceLineNumbers,r.length!==0){for(let c=0,d=r.length;c<d;c++){const u=r[c];this._decorationsTree.acceptReplace(u.rangeOffset,u.rangeLength,u.text.length,u.forceMoveMarkers)}const a=[];this._increaseVersionId();let l=i;for(let c=0,d=r.length;c<d;c++){const u=r[c],[h]=_f(u.text);this._onDidChangeDecorations.fire();const f=u.range.startLineNumber,g=u.range.endLineNumber,p=g-f,_=h,v=Math.min(p,_),b=_-p,y=o-l-b+f,w=y,C=y+_,L=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new V(w,1)),this.getOffsetAt(new V(C,this.getLineMaxColumn(C))),0),x=sa.fromDecorations(L),D=new gc(x);for(let k=v;k>=0;k--){const P=f+k,O=y+k;D.takeFromEndWhile(R=>R.lineNumber>O);const M=D.takeFromEndWhile(R=>R.lineNumber===O);a.push(new y8(P,this.getLineContent(O),M))}if(v<p){const k=f+v;a.push(new sSe(k+1,g))}if(v<_){const k=new gc(x),P=f+v,O=_-v,M=o-l-O+P+1,R=[],$=[];for(let G=0;G<O;G++){const ne=M+G;$[G]=this.getLineContent(ne),k.takeWhile(ae=>ae.lineNumber<ne),R[G]=k.takeWhile(ae=>ae.lineNumber===ne)}a.push(new oSe(P+1,f+_,$,R))}l+=b}this._emitContentChangedEvent(new Sp(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return s.reverseEdits===null?void 0:s.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=Array.from(e).map(s=>new y8(s,this.getLineContent(s),this._getInjectedTextInLine(s)));this._onDidChangeInjectedText.fire(new aG(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(o,r)=>this._deltaDecorationsImpl(e,[],[{range:o,options:r}])[0],changeDecoration:(o,r)=>{this._changeDecorationImpl(o,r)},changeDecorationOptions:(o,r)=>{this._changeDecorationOptionsImpl(o,x8(r))},removeDecoration:o=>{this._deltaDecorationsImpl(e,[o],[])},deltaDecorations:(o,r)=>o.length===0&&r.length===0?[]:this._deltaDecorationsImpl(e,o,r)};let s=null;try{s=t(i)}catch(o){mt(o)}return i.addDecoration=R0,i.changeDecoration=R0,i.changeDecorationOptions=R0,i.removeDecoration=R0,i.deltaDecorations=R0,s}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),mt(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const s=e?this._decorations[e]:null;if(!s)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:S8[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(s),delete this._decorations[s.id],null;const o=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);return this._decorationsTree.delete(s),s.reset(this.getVersionId(),r,a,o),s.setOptions(S8[i]),this._decorationsTree.insert(s),s.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,s=t.length;i<s;i++){const o=t[i];this._decorationsTree.delete(o),delete this._decorations[o.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,s=!1,o=!1){const r=this.getLineCount(),a=Math.min(r,Math.max(1,e)),l=Math.min(r,Math.max(1,t)),c=this.getLineMaxColumn(l),d=new N(a,1,l,c),u=this._getDecorationsInRange(d,i,s,o);return bI(u,this._decorationProvider.getDecorationsInRange(d,i,s)),u}getDecorationsInRange(e,t=0,i=!1,s=!1,o=!1){const r=this.validateRange(e),a=this._getDecorationsInRange(r,t,i,o);return bI(a,this._decorationProvider.getDecorationsInRange(r,t,i,s)),a}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),s=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return sa.fromDecorations(s).filter(o=>o.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,t,i,s){const o=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),r=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,o,r,t,i,s)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const s=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),r=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),o,r,s),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const s=!!(i.options.overviewRuler&&i.options.overviewRuler.color),o=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const r=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber)}if(i.options.before||t.before){const r=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}s!==o?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i,s=!1){const o=this.getVersionId(),r=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const d=new Array(l);for(;a<r||c<l;){let u=null;if(a<r){do u=this._decorations[t[a++]];while(!u&&a<r);if(u){if(u.options.after){const h=this._decorationsTree.getNodeRange(this,u);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.endLineNumber)}if(u.options.before){const h=this._decorationsTree.getNodeRange(this,u);this._onDidChangeDecorations.recordLineAffectedByInjectedText(h.startLineNumber)}this._decorationsTree.delete(u),s||this._onDidChangeDecorations.checkAffectedAndFire(u.options)}}if(c<l){if(!u){const v=++this._lastDecorationId,b=`${this._instanceId};${v}`;u=new iG(b,0,0),this._decorations[b]=u}const h=i[c],f=this._validateRangeRelaxedNoAllocations(h.range),g=x8(h.options),p=this._buffer.getOffsetAt(f.startLineNumber,f.startColumn),_=this._buffer.getOffsetAt(f.endLineNumber,f.endColumn);u.ownerId=e,u.reset(o,p,_,f),u.setOptions(g),u.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.endLineNumber),u.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(f.startLineNumber),s||this._onDidChangeDecorations.checkAffectedAndFire(g),this._decorationsTree.insert(u),d[c]=u.id,c++}else u&&delete this._decorations[u.id]}return d}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return fSe(this.getLineContent(e))+1}};tl._MODEL_SYNC_LIMIT=50*1024*1024;tl.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;tl.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;tl.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024;tl.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:An.tabSize,indentSize:An.indentSize,insertSpaces:An.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:An.trimAutoWhitespace,largeFileOptimizations:An.largeFileOptimizations,bracketPairColorizationOptions:An.bracketPairColorizationOptions};tl=Ju=aSe([cE(4,KD),cE(5,Ai),cE(6,oo)],tl);function fSe(n){let e=0;for(const t of n)if(t===" "||t==="	")e++;else break;return e}function dE(n){return!!(n.options.overviewRuler&&n.options.overviewRuler.color)}function uE(n){return!!n.options.after||!!n.options.before}class C8{constructor(){this._decorationsTree0=new rE,this._decorationsTree1=new rE,this._injectedTextDecorationsTree=new rE}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,s,o,r){const a=e.getVersionId(),l=this._intervalSearch(t,i,s,o,a,r);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,s,o,r){const a=this._decorationsTree0.intervalSearch(e,t,i,s,o,r),l=this._decorationsTree1.intervalSearch(e,t,i,s,o,r),c=this._injectedTextDecorationsTree.intervalSearch(e,t,i,s,o,r);return a.concat(l).concat(c)}getInjectedTextInInterval(e,t,i,s){const o=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,i,s,!1,o,!1);return this._ensureNodesHaveRanges(e,r).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),s=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,s).filter(o=>o.options.showIfCollapsed||!o.range.isEmpty())}getAll(e,t,i,s,o){const r=e.getVersionId(),a=this._search(t,i,s,r,o);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,s,o){if(i)return this._decorationsTree1.search(e,t,s,o);{const r=this._decorationsTree0.search(e,t,s,o),a=this._decorationsTree1.search(e,t,s,o),l=this._injectedTextDecorationsTree.search(e,t,s,o);return r.concat(a).concat(l)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),s=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(s)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){uE(e)?this._injectedTextDecorationsTree.insert(e):dE(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){uE(e)?this._injectedTextDecorationsTree.delete(e):dE(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){uE(e)?this._injectedTextDecorationsTree.resolveNode(e,t):dE(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,s){this._decorationsTree0.acceptReplace(e,t,i,s),this._decorationsTree1.acceptReplace(e,t,i,s),this._injectedTextDecorationsTree.acceptReplace(e,t,i,s)}}function pl(n){return n.replace(/[^a-z0-9\-_]/gi," ")}class cG{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class gSe extends cG{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:jo.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class pSe{constructor(e){var t;this.position=(t=e==null?void 0:e.position)!==null&&t!==void 0?t:pp.Left}}class mSe extends cG{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?z.fromHex(e):t.getColor(e.id)}}class Am{static from(e){return e instanceof Am?e:new Am(e)}constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class et{static register(e){return new et(e)}static createDynamic(e){return new et(e)}constructor(e){var t,i,s,o,r,a;this.description=e.description,this.blockClassName=e.blockClassName?pl(e.blockClassName):null,this.blockDoesNotCollapse=(t=e.blockDoesNotCollapse)!==null&&t!==void 0?t:null,this.blockIsAfterEnd=(i=e.blockIsAfterEnd)!==null&&i!==void 0?i:null,this.blockPadding=(s=e.blockPadding)!==null&&s!==void 0?s:null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?pl(e.className):null,this.shouldFillLineOnLineBreak=(o=e.shouldFillLineOnLineBreak)!==null&&o!==void 0?o:null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new gSe(e.overviewRuler):null,this.minimap=e.minimap?new mSe(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new pSe(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?pl(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?pl(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?pl(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?pl(e.marginClassName):null,this.inlineClassName=e.inlineClassName?pl(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?pl(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?pl(e.afterContentClassName):null,this.after=e.after?Am.from(e.after):null,this.before=e.before?Am.from(e.before):null,this.hideInCommentTokens=(r=e.hideInCommentTokens)!==null&&r!==void 0?r:!1,this.hideInStringTokens=(a=e.hideInStringTokens)!==null&&a!==void 0?a:!1}}et.EMPTY=et.register({description:"empty"});const S8=[et.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),et.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),et.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),et.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function x8(n){return n instanceof et?n:et.createDynamic(n)}class _Se extends Y{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new B),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),(e=this._affectedInjectedTextLines)===null||e===void 0||e.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!!(e.minimap&&e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!(e.overviewRuler&&e.overviewRuler.color)),this._affectsGlyphMargin||(this._affectsGlyphMargin=!!e.glyphMarginClassName),this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class bSe extends Y{constructor(){super(),this._fastEmitter=this._register(new B),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new B),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}class vSe{constructor(){this._onDidChangeVisibleRanges=new B,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const e=new ySe(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}}class ySe{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){const i=e.map(s=>new Qe(s.startLineNumber,s.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}}class gx{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new hn(new N(1,1,1,1),0,0,new V(1,1),0),new hn(new N(1,1,1,1),0,0,new V(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ot(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?lt.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):lt.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,s){return t.equals(i)?s:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,s=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),r=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,s,i,r),l=this._validatePositionWithCache(e,o,s,a);return i.equals(r)&&s.equals(a)&&o.equals(l)?t:new hn(N.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+s.column-a.column,r,t.leftoverVisibleColumns+i.column-r.column)}_setState(e,t,i){if(i&&(i=gx._validateViewState(e.viewModel,i)),t){const s=e.model.validateRange(t.selectionStart),o=t.selectionStart.equalsRange(s)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),a=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new hn(s,t.selectionStartKind,o,r,a)}else{if(!i)return;const s=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new hn(s,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){const s=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new hn(s,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{const s=e.coordinatesConverter.convertModelPositionToViewPosition(new V(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new V(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),r=new N(s.lineNumber,s.column,o.lineNumber,o.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new hn(r,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class L8{constructor(e){this.context=e,this.cursors=[new gx(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return h_e(this.cursors,ur(e=>e.viewState.position,V.compare)).viewState.position}getBottomMostViewPosition(){return u_e(this.cursors,ur(e=>e.viewState.position,V.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ot.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const s=i-t;for(let o=0;o<s;o++)this._addSecondaryCursor()}else if(t>i){const s=t-i;for(let o=0;o<s;o++)this._removeSecondaryCursor(this.cursors.length-2)}for(let s=0;s<i;s++)this.cursors[s+1].setState(this.context,e[s].modelState,e[s].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new gx(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,s=e.length;i<s;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(ur(i=>i.selection,N.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const s=t[i],o=t[i+1],r=s.selection,a=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||r.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(r.getEndPosition()):l=a.getStartPosition().isBefore(r.getEndPosition()),l){const c=s.index<o.index?i:i+1,d=s.index<o.index?i+1:i,u=t[d].index,h=t[c].index,f=t[d].selection,g=t[c].selection;if(!f.equalsSelection(g)){const p=f.plusRange(g),_=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,v=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn;let b;u===this.lastAddedCursorIndex?(b=_,this.lastAddedCursorIndex=h):b=v;let y;b?y=new lt(p.startLineNumber,p.startColumn,p.endLineNumber,p.endColumn):y=new lt(p.endLineNumber,p.endColumn,p.startLineNumber,p.startColumn),t[c].selection=y;const w=ot.fromModelSelection(y);e[h].setState(this.context,w.modelState,w.viewState)}for(const p of t)p.index>u&&p.index--;e.splice(u,1),t.splice(d,1),this._removeSecondaryCursor(u-1),i--}}}}class D8{constructor(e,t,i,s){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=s}}class wSe{constructor(){this.type=0}}class CSe{constructor(){this.type=1}}class SSe{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class xSe{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class _g{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0)}}class xw{constructor(){this.type=5}}class LSe{constructor(e){this.type=6,this.isFocused=e}}class DSe{constructor(){this.type=7}}class Lw{constructor(){this.type=8}}class dG{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class cN{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class dN{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class FC{constructor(e,t,i,s,o,r,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=s,this.verticalType=o,this.revealHorizontal=r,this.scrollType=a,this.type=12}}class kSe{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class ESe{constructor(e){this.theme=e,this.type=14}}class ASe{constructor(e){this.type=15,this.ranges=e}}class ISe{constructor(){this.type=16}}let TSe=class{constructor(){this.type=17}};class NSe extends Y{constructor(){super(),this._onEvent=this._register(new B),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const s=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(s){this._outgoingEvents[t]=s;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new RSe),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class RSe{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class QP{constructor(e,t,i,s){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=s,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new QP(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class JP{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new JP(this.oldHasFocus,e.hasFocus)}}class e3{constructor(e,t,i,s,o,r,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=s,this.scrollWidth=o,this.scrollLeft=r,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new e3(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class MSe{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class PSe{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class px{constructor(e,t,i,s,o,r,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=s,this.source=o,this.reason=r,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,s=t.length;if(i!==s)return!1;for(let o=0;o<i;o++)if(!e[o].equalsSelection(t[o]))return!1;return!0}isNoOp(){return px._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new px(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class OSe{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class FSe{constructor(e){this.event=e,this.kind=7}isNoOp(){return!1}attemptToMerge(e){return null}}class BSe{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class WSe{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class VSe{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class zSe{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class HSe{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class $Se extends Y{constructor(e,t,i,s){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new D8(this._model,this._viewModel,this._coordinatesConverter,s),this._cursors=new L8(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Ft(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new D8(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,s){let o=!1;const r=this.context.cursorConfig.multiCursorLimit;s!==null&&s.length>r&&(s=s.slice(0,r),o=!0);const a=z_.from(this._model,this);return this._cursors.setStates(s),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,i,s,o,r){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=N.fromPositions(a[0],a[0]),e.emitViewEvent(new FC(t,i,l,c,s,o,r))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,s=t.length;i<s;i++){const o=t[i];e.push({inSelectionMode:!o.isEmpty(),selectionStart:{lineNumber:o.selectionStartLineNumber,column:o.selectionStartColumn},position:{lineNumber:o.positionLineNumber,column:o.positionColumn}})}return e}restoreState(e,t){const i=[];for(let s=0,o=t.length;s<o;s++){const r=t[s];let a=1,l=1;r.position&&r.position.lineNumber&&(a=r.position.lineNumber),r.position&&r.position.column&&(l=r.position.column);let c=a,d=l;r.selectionStart&&r.selectionStart.lineNumber&&(c=r.selectionStart.lineNumber),r.selectionStart&&r.selectionStart.column&&(d=r.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:d,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ot.fromModelSelections(i)),this.revealPrimary(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof aG){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const s=i.containsEvent(1);if(this._prevEditOperationType=0,s)this._cursors.dispose(),this._cursors=new L8(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const o=ot.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,o)&&this.revealPrimary(e,"modelChange",!1,0,!0,0)}else{const o=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ot.fromModelSelections(o))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,s){this.setStates(e,t,s,ot.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],s=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),s.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const o=this._model.deltaDecorations([],i),r=this._model.deltaDecorations([],s);this._autoClosedActions.push(new k8(this._model,o,r))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=USe.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],s=[];for(let o=0;o<e.commands.length;o++){const r=e.commands[o];r instanceof Fq&&r.enclosingRange&&r.closeCharacterRange&&(i.push(r.closeCharacterRange),s.push(r.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,s),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,s,o){const r=z_.from(this._model,this);if(r.equals(s))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new xSe(l,a,i)),!s||s.cursorState.length!==r.cursorState.length||r.cursorState.some((c,d)=>!c.modelState.equals(s.cursorState[d].modelState))){const c=s?s.cursorState.map(u=>u.modelState.selection):null,d=s?s.modelVersionId:0;e.emitOutgoingEvent(new px(c,a,d,r.modelVersionId,t||"keyboard",i,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];if(!o.text||o.text.indexOf(`
`)>=0)return null;const r=o.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const a=r[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,d=o.text.length-r[2].length-1,u=o.text.lastIndexOf(c,d-1);if(u===-1)return null;t.push([u,d])}return t}executeEdits(e,t,i,s){let o=null;t==="snippet"&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);const r=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(o)for(let u=0,h=o.length;u<h;u++){const[f,g]=o[u],p=c[u],_=p.range.startLineNumber,v=p.range.startColumn-1+f,b=p.range.startColumn-1+g;r.push(new N(_,b+1,_,b+2)),a.push(new N(_,v+1,_,b+2))}const d=s(c);return d&&(this._isHandling=!0),d});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),r.length>0&&this._pushAutoClosedAction(r,a)}_executeEdit(e,t,i,s=0){if(this.context.cursorConfig.readOnly)return;const o=z_.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(r){mt(r)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,s,o,!1)&&this.revealPrimary(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return k8.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new H_(this._model,this.getSelections())}endComposition(e,t){const i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(fi.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const s=t.length;let o=0;for(;o<s;){const r=tP(t,o),a=t.substr(o,r);this._executeEditOperation(fi.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),o+=r}}else this._executeEditOperation(fi.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,s,o,r){if(t.length===0&&i===0&&s===0){if(o!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new lt(c.lineNumber,c.column+o,c.lineNumber,c.column+o)});this.setSelections(e,r,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(fi.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,s,o))},e,r)}paste(e,t,i,s,o){this._executeEdit(()=>{this._executeEditOperation(fi.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,s||[]))},e,o,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(mf.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new _s(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new _s(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}class z_{static from(e,t){return new z_(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class k8{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const s=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(s&&(t.push(s),s.startLineNumber!==s.endLineNumber))return!1}t.sort(N.compareRangesUsingStarts),e.sort(N.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class USe{static executeCommands(e,t,i){const s={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(s,i);for(let r=0,a=s.trackedRanges.length;r<a;r++)s.model._setTrackedRange(s.trackedRanges[r],null,0);return o}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const s=i.operations,o=this._getLoserCursorMap(s);if(o.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const r=[];for(let c=0,d=s.length;c<d;c++)o.hasOwnProperty(s[c].identifier.major.toString())||r.push(s[c]);i.hadTrackedEditOperation&&r.length>0&&(r[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,r,c=>{const d=[];for(let f=0;f<e.selectionsBefore.length;f++)d[f]=[];for(const f of c)f.identifier&&d[f.identifier.major].push(f);const u=(f,g)=>f.identifier.minor-g.identifier.minor,h=[];for(let f=0;f<e.selectionsBefore.length;f++)d[f].length>0?(d[f].sort(u),h[f]=t[f].computeCursorState(e.model,{getInverseEditOperations:()=>d[f],getTrackedSelection:g=>{const p=parseInt(g,10),_=e.model._getTrackedRange(e.trackedRanges[p]);return e.trackedRangesDirection[p]===0?new lt(_.startLineNumber,_.startColumn,_.endLineNumber,_.endColumn):new lt(_.endLineNumber,_.endColumn,_.startLineNumber,_.startColumn)}})):h[f]=e.selectionsBefore[f];return h});a||(a=e.selectionsBefore);const l=[];for(const c in o)o.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,d)=>d-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],s=!1;for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a){const l=this._getEditOperationsFromCommand(e,o,a);i=i.concat(l.operations),s=s||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:s}}static _getEditOperationsFromCommand(e,t,i){const s=[];let o=0;const r=(u,h,f=!1)=>{N.isEmpty(u)&&h===""||s.push({identifier:{major:t,minor:o++},range:u,text:h,forceMoveMarkers:f,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const d={addEditOperation:r,addTrackedEditOperation:(u,h,f)=>{a=!0,r(u,h,f)},trackSelection:(u,h)=>{const f=lt.liftSelection(u);let g;if(f.isEmpty())if(typeof h=="boolean")h?g=2:g=3;else{const v=e.model.getLineMaxColumn(f.startLineNumber);f.startColumn===v?g=2:g=3}else g=1;const p=e.trackedRanges.length,_=e.model._setTrackedRange(null,f,g);return e.trackedRanges[p]=_,e.trackedRangesDirection[p]=f.getDirection(),p.toString()}};try{i.getEditOperations(e.model,d)}catch(u){return mt(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:s,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,s)=>-N.compareRangesUsingEnds(i.range,s.range));const t={};for(let i=1;i<e.length;i++){const s=e[i-1],o=e[i];if(N.getStartPosition(s.range).isBefore(N.getEndPosition(o.range))){let r;s.identifier.major>o.identifier.major?r=s.identifier.major:r=o.identifier.major,t[r.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===r&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class jSe{constructor(e,t,i){this.text=e,this.startSelection=t,this.endSelection=i}}class H_{static _capture(e,t){const i=[];for(const s of t){if(s.startLineNumber!==s.endLineNumber)return null;i.push(new jSe(e.getLineContent(s.startLineNumber),s.startColumn-1,s.endColumn-1))}return i}constructor(e,t){this._original=H_._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=H_._capture(e,t);if(!i||this._original.length!==i.length)return null;const s=[];for(let o=0,r=this._original.length;o<r;o++)s.push(H_._deduceOutcome(this._original[o],i[o]));return s}static _deduceOutcome(e,t){const i=Math.min(e.startSelection,t.startSelection,BS(e.text,t.text)),s=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,pT(e.text,t.text)),o=e.text.substring(i,e.text.length-s),r=t.text.substring(i,t.text.length-s);return new Yye(o,e.startSelection-i,e.endSelection-i,r,t.startSelection-i,t.endSelection-i)}}var qSe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const E8={getInitialState:()=>Kb,tokenizeEncoded:(n,e,t)=>wP(0,t)};function GSe(n,e,t){return qSe(this,void 0,void 0,function*(){if(!t)return A8(e,n.languageIdCodec,E8);const i=yield Si.getOrCreate(t);return A8(e,n.languageIdCodec,i||E8)})}function KSe(n,e,t,i,s,o,r){let a="<div>",l=i,c=0,d=!0;for(let u=0,h=e.getCount();u<h;u++){const f=e.getEndOffset(u);if(f<=i)continue;let g="";for(;l<f&&l<s;l++){const p=n.charCodeAt(l);switch(p){case 9:{let _=o-(l+c)%o;for(c+=_-1;_>0;)r&&d?(g+="&#160;",d=!1):(g+=" ",d=!0),_--;break}case 60:g+="&lt;",d=!1;break;case 62:g+="&gt;",d=!1;break;case 38:g+="&amp;",d=!1;break;case 0:g+="&#00;",d=!1;break;case 65279:case 8232:case 8233:case 133:g+="",d=!1;break;case 13:g+="&#8203",d=!1;break;case 32:r&&d?(g+="&#160;",d=!1):(g+=" ",d=!0);break;default:g+=String.fromCharCode(p),d=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${g}</span>`,f>s||l>=s)break}return a+="</div>",a}function A8(n,e,t){let i='<div class="monaco-tokenized-source">';const s=Pf(n);let o=t.getInitialState();for(let r=0,a=s.length;r<a;r++){const l=s[r];r>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,o);on.convertToEndOffset(c.tokens,l.length);const u=new on(c.tokens,l,e).inflate();let h=0;for(let f=0,g=u.getCount();f<g;f++){const p=u.getClassName(f),_=u.getEndOffset(f);i+=`<span class="${p}">${FS(l.substring(h,_))}</span>`,h=_}o=c.endState}return i+="</div>",i}class YSe{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,s=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,s)}}class ZSe{constructor(e,t,i,s,o){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=s,this.minWidth=o,this.prefixSum=0}}let uG=class uN{constructor(e,t,i,s){this._instanceId=ZU(++uN.INSTANCE_COUNT),this._pendingChanges=new YSe,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=s}static findInsertionIndex(e,t,i){let s=0,o=e.length;for(;s<o;){const r=s+o>>>1;t===e[r].afterLineNumber?i<e[r].ordinal?o=r:s=r+1:t<e[r].afterLineNumber?o=r:s=r+1}return s}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(s,o,r,a)=>{t=!0,s=s|0,o=o|0,r=r|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new ZSe(l,s,o,r,a)),l},changeOneWhitespace:(s,o,r)=>{t=!0,o=o|0,r=r|0,this._pendingChanges.change({id:s,newAfterLineNumber:o,newHeight:r})},removeWhitespace:s=>{t=!0,this._pendingChanges.remove({id:s})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const s=new Set;for(const l of i)s.add(l.id);const o=new Map;for(const l of t)o.set(l.id,l);const r=l=>{const c=[];for(const d of l)if(!s.has(d.id)){if(o.has(d.id)){const u=o.get(d.id);d.afterLineNumber=u.newAfterLineNumber,d.height=u.newHeight}c.push(d)}return c},a=r(this._arr).concat(r(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=uN.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,s=t.length;i<s;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const s=this._findWhitespaceIndex(e);if(s!==-1&&(this._arr[s].height!==i&&(this._arr[s].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,s-1)),this._arr[s].afterLineNumber!==t)){const o=this._arr[s];this._removeWhitespace(s),o.afterLineNumber=t,this._insertWhitespace(o)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,s=this._arr.length;i<s;i++){const o=this._arr[i].afterLineNumber;e<=o&&o<=t?this._arr[i].afterLineNumber=e-1:o>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,s=this._arr.length;i<s;i++){const o=this._arr[i].afterLineNumber;e<=o&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,s=t.length-1;for(;i<=s;){const r=(s-i|0)/2|0,a=i+r|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else s=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;const s=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+s+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;const i=this._lineHeight*e,s=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+s+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let s=1,o=t;for(;s<o;){const r=(s+o)/2|0,a=this.getVerticalOffsetForLineNumber(r)|0;if(e>=a+i)s=r+1;else{if(e>=a)return r;o=r}}return s>t?t:s}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,s=this.getLineNumberAtOrAfterVerticalOffset(e)|0,o=this.getVerticalOffsetForLineNumber(s)|0;let r=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(s)|0;const l=this.getWhitespacesCount()|0;let c,d;a===-1?(a=l,d=r+1,c=0):(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let u=o,h=u;const f=5e5;let g=0;o>=f&&(g=Math.floor(o/f)*f,g=Math.floor(g/i)*i,h-=g);const p=[],_=e+(t-e)/2;let v=-1;for(let C=s;C<=r;C++){if(v===-1){const L=u,x=u+i;(L<=_&&_<x||L>_)&&(v=C)}for(u+=i,p[C-s]=h,h+=i;d===C;)h+=c,u+=c,a++,a>=l?d=r+1:(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){r=C;break}}v===-1&&(v=r);const b=this.getVerticalOffsetForLineNumber(r)|0;let y=s,w=r;return y<w&&o<e&&y++,y<w&&b+i>t&&w--,{bigNumbersDelta:g,startLineNumber:s,endLineNumber:r,relativeVerticalOffset:p,centeredLineNumber:v,completelyVisibleStartLineNumber:y,completelyVisibleEndLineNumber:w}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let s;return e>0?s=this.getWhitespacesAccumulatedHeight(e-1):s=0,i+s+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const s=this.getVerticalOffsetForWhitespaceIndex(i),o=this.getHeightForWhitespaceIndex(i);if(e>=s+o)return-1;for(;t<i;){const r=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(e>=a+l)t=r+1;else{if(e>=a)return r;i=r}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const s=this.getHeightForWhitespaceIndex(t),o=this.getIdForWhitespaceIndex(t),r=this.getAfterLineNumberForWhitespaceIndex(t);return{id:o,afterLineNumber:r,verticalOffset:i,height:s}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),s=this.getWhitespacesCount()-1;if(i<0)return[];const o=[];for(let r=i;r<=s;r++){const a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(a>=t)break;o.push({id:this.getIdForWhitespaceIndex(r),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(r),verticalOffset:a,height:l})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}};uG.INSTANCE_COUNT=0;const XSe=125;class u_{constructor(e,t,i,s){e=e|0,t=t|0,i=i|0,s=s|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),s<0&&(s=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=s,this.scrollHeight=Math.max(i,s)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class QSe extends Y{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new B),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new u_(0,0,0,0),this._scrollable=this._register(new cy({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,s=t.contentHeight!==e.contentHeight;(i||s)&&this._onDidContentSizeChange.fire(new QP(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class JSe extends Y{constructor(e,t,i){super(),this._configuration=e;const s=this._configuration.options,o=s.get(143),r=s.get(83);this._linesLayout=new uG(t,s.get(66),r.top,r.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new QSe(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new u_(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(113)?XSe:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(66)&&this._linesLayout.setLineHeight(t.get(66)),e.hasChanged(83)){const i=t.get(83);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(143)){const i=t.get(143),s=i.contentWidth,o=i.height,r=this._scrollable.getScrollDimensions(),a=r.contentWidth;this._scrollable.setScrollDimensions(new u_(s,r.contentWidth,o,this._getContentHeight(s,o,a)))}else this._updateHeight();e.hasChanged(113)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const s=this._configuration.options.get(102);return s.horizontal===2||e>=t?0:s.horizontalScrollbarSize}_getContentHeight(e,t,i){const s=this._configuration.options;let o=this._linesLayout.getLinesTotalHeight();return s.get(104)?o+=Math.max(0,t-s.get(66)-s.get(83).bottom):o+=this._getHorizontalScrollbarHeight(e,i),o}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,s=e.contentWidth;this._scrollable.setScrollDimensions(new u_(t,e.contentWidth,i,this._getContentHeight(t,i,s)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new b7(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new b7(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(144),s=e.get(50),o=e.get(143);if(i.isViewportWrapping){const r=e.get(72);return t>o.contentWidth+s.typicalHalfwidthCharacterWidth&&r.enabled&&r.side==="right"?t+o.verticalScrollbarWidth:t}else{const r=e.get(103)*s.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+r+o.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new u_(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),s=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-s,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class exe{constructor(e,t,i,s,o){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=s,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const s=e.range,o=e.options;let r;if(o.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new V(s.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new V(s.endLineNumber,this.model.getLineMaxColumn(s.endLineNumber)),1);r=new N(a.lineNumber,a.column,l.lineNumber,l.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(s,1);i=new sq(r,o),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){const s=new N(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(s,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){const s=this._linesCollection.getDecorationsInRange(e,this.editorId,NS(this.configuration.options),t,i),o=e.startLineNumber,r=e.endLineNumber,a=[];let l=0;const c=[];for(let d=o;d<=r;d++)c[d-o]=[];for(let d=0,u=s.length;d<u;d++){const h=s[d],f=h.options;if(!txe(this.model,h))continue;const g=this._getOrCreateViewModelDecoration(h),p=g.range;if(a[l++]=g,f.inlineClassName){const _=new T_(p,f.inlineClassName,f.inlineClassNameAffectsLetterSpacing?3:0),v=Math.max(o,p.startLineNumber),b=Math.min(r,p.endLineNumber);for(let y=v;y<=b;y++)c[y-o].push(_)}if(f.beforeContentClassName&&o<=p.startLineNumber&&p.startLineNumber<=r){const _=new T_(new N(p.startLineNumber,p.startColumn,p.startLineNumber,p.startColumn),f.beforeContentClassName,1);c[p.startLineNumber-o].push(_)}if(f.afterContentClassName&&o<=p.endLineNumber&&p.endLineNumber<=r){const _=new T_(new N(p.endLineNumber,p.endColumn,p.endLineNumber,p.endColumn),f.afterContentClassName,2);c[p.endLineNumber-o].push(_)}}return{decorations:a,inlineDecorations:c}}}function txe(n,e){return!(e.options.hideInCommentTokens&&ixe(n,e)||e.options.hideInStringTokens&&nxe(n,e))}function ixe(n,e){return hG(n,e.range,t=>t===1)}function nxe(n,e){return hG(n,e.range,t=>t===2)}function hG(n,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const s=n.tokenization.getLineTokens(i),o=i===e.startLineNumber,r=i===e.endLineNumber;let a=o?s.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<s.getCount()&&!(r&&s.getStartOffset(a)>e.endColumn-1);){if(!t(s.getStandardTokenType(a)))return!1;a++}}return!0}function hE(n,e){return n===null?e?mx.INSTANCE:_x.INSTANCE:new sxe(n,e)}class sxe{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const s=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i];let r;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,d)=>new sa(0,0,c+1,this._projectionData.injectionOptions[d],0));r=sa.applyInjectedText(e.getLineContent(t),a).substring(s,o)}else r=e.getValueInRange({startLineNumber:t,startColumn:s+1,endLineNumber:t,endColumn:o+1});return i>0&&(r=I8(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const s=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],s),s[0]}getViewLinesData(e,t,i,s,o,r,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,d=l.injectionOptions;let u=null;if(c){u=[];let f=0,g=0;for(let p=0;p<l.getOutputLineCount();p++){const _=new Array;u[p]=_;const v=p>0?l.breakOffsets[p-1]:0,b=l.breakOffsets[p];for(;g<c.length;){const y=d[g].content.length,w=c[g]+f,C=w+y;if(w>b)break;if(v<C){const L=d[g];if(L.inlineClassName){const x=p>0?l.wrappedTextIndentLength:0,D=x+Math.max(w-v,0),k=x+Math.min(C-v,b-v);D!==k&&_.push(new dbe(D,k,L.inlineClassName,L.inlineClassNameAffectsLetterSpacing))}}if(C<=b)f+=y,g++;else break}}}let h;c?h=e.tokenization.getLineTokens(t).withInserted(c.map((f,g)=>({offset:f,text:d[g].content,tokenMetadata:on.defaultTokenMetadata}))):h=e.tokenization.getLineTokens(t);for(let f=i;f<i+s;f++){const g=o+f-i;if(!r[g]){a[g]=null;continue}a[g]=this._getViewLineData(h,u?u[f]:null,f)}}_getViewLineData(e,t,i){this._assertVisible();const s=this._projectionData,o=i>0?s.wrappedTextIndentLength:0,r=i>0?s.breakOffsets[i-1]:0,a=s.breakOffsets[i],l=e.sliceAndInflate(r,a,o);let c=l.getLineContent();i>0&&(c=I8(s.wrappedTextIndentLength)+c);const d=this._projectionData.getMinOutputOffset(i)+1,u=c.length+1,h=i+1<this.getViewLineCount(),f=i===0?0:s.breakOffsetsVisibleColumn[i-1];return new xP(c,h,d,u,f,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const s=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(s)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class mx{constructor(){}isVisible(){return!0}setVisible(e){return e?this:_x.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const s=e.tokenization.getLineTokens(t),o=s.getLineContent();return new xP(o,!1,1,o.length+1,0,s.inflate(),null)}getViewLinesData(e,t,i,s,o,r,a){if(!r[o]){a[o]=null;return}a[o]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new V(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}}mx.INSTANCE=new mx;class _x{constructor(){}isVisible(){return!1}setVisible(e){return e?mx.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,s,o,r,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}}_x.INSTANCE=new _x;const fE=[""];function I8(n){if(n>=fE.length)for(let e=1;e<=n;e++)fE[e]=oxe(e);return fE[n]}function oxe(n){return new Array(n+1).join(" ")}class rxe{constructor(e,t,i,s,o,r,a,l,c,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=s,this.fontInfo=o,this.tabSize=r,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new lxe(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),s=this.model.getInjectedTextDecorations(this._editorId),o=i.length,r=this.createLineBreaksComputer(),a=new gc(sa.fromDecorations(s));for(let p=0;p<o;p++){const _=a.takeWhile(v=>v.lineNumber===p+1);r.addRequest(i[p],_,t?t[p]:null)}const l=r.finalize(),c=[],d=this.hiddenAreasDecorationIds.map(p=>this.model.getDecorationRange(p)).sort(N.compareRangesUsingStarts);let u=1,h=0,f=-1,g=f+1<d.length?h+1:o+2;for(let p=0;p<o;p++){const _=p+1;_===g&&(f++,u=d[f].startLineNumber,h=d[f].endLineNumber,g=f+1<d.length?h+1:o+2);const v=_>=u&&_<=h,b=hE(l[p],!v);c[p]=b.getViewLineCount(),this.modelLineProjections[p]=b}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new $0e(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(h=>this.model.validateRange(h)),i=axe(t),s=this.hiddenAreasDecorationIds.map(h=>this.model.getDecorationRange(h)).sort(N.compareRangesUsingStarts);if(i.length===s.length){let h=!1;for(let f=0;f<i.length;f++)if(!i[f].equalsRange(s[f])){h=!0;break}if(!h)return!1}const o=i.map(h=>({range:h,options:et.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,o);const r=i;let a=1,l=0,c=-1,d=c+1<r.length?l+1:this.modelLineProjections.length+2,u=!1;for(let h=0;h<this.modelLineProjections.length;h++){const f=h+1;f===d&&(c++,a=r[c].startLineNumber,l=r[c].endLineNumber,d=c+1<r.length?l+1:this.modelLineProjections.length+2);let g=!1;if(f>=a&&f<=l?this.modelLineProjections[h].isVisible()&&(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!1),g=!0):(u=!0,this.modelLineProjections[h].isVisible()||(this.modelLineProjections[h]=this.modelLineProjections[h].setVisible(!0),g=!0)),g){const p=this.modelLineProjections[h].getViewLineCount();this.projectedModelLineLineCounts.setValue(h,p)}}return u||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,s,o){const r=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===s,d=this.wordBreak===o;if(r&&a&&l&&c&&d)return!1;const u=r&&a&&!l&&c&&d;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=s,this.wordBreak=o;let h=null;if(u){h=[];for(let f=0,g=this.modelLineProjections.length;f<g;f++)h[f]=this.modelLineProjections[f].getProjectionData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const s=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new cN(s,o)}onModelLinesInserted(e,t,i,s){if(!e||e<=this._validModelVersionId)return null;const o=t>2&&!this.modelLineProjections[t-2].isVisible(),r=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let d=0,u=s.length;d<u;d++){const h=hE(s[d],!o);l.push(h);const f=h.getViewLineCount();a+=f,c[d]=f}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new dN(r,r+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const s=t-1,o=this.modelLineProjections[s].getViewLineCount(),r=this.modelLineProjections[s].isVisible(),a=hE(i,r);this.modelLineProjections[s]=a;const l=this.modelLineProjections[s].getViewLineCount();let c=!1,d=0,u=-1,h=0,f=-1,g=0,p=-1;o>l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+l-1,g=u+1,p=g+(o-l)-1,c=!0):o<l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+o-1,h=u+1,f=h+(l-o)-1,c=!0):(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,u=d+l-1),this.projectedModelLineLineCounts.setValue(s,l);const _=d<=u?new dG(d,u-d+1):null,v=h<=f?new dN(h,f):null,b=g<=p?new cN(g,p):null;return[c,_,v,b]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const s=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),r=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(s.lineNumber,o.lineNumber,r.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,s=t.remainder;return new T8(i+1,s)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),s=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new V(e.modelLineNumber,s)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),s=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new V(e.modelLineNumber,s)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),s=this.getViewLineInfo(t),o=new Array;let r=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=s.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const d=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,u=l===s.modelLineNumber?s.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let h=d;h<u;h++)a.push(new T8(l,h))}if(!c.isVisible()&&r){const d=new V(l-1,this.model.getLineMaxColumn(l-1)+1),u=N.fromPositions(r,d);o.push(new N8(u,a)),a=[],r=null}else c.isVisible()&&!r&&(r=new V(l,1))}if(r){const l=N.fromPositions(r,this.getModelEndPositionOfViewLine(s));o.push(new N8(l,a))}return o}getViewLinesBracketGuides(e,t,i,s){const o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,r=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,o,s);for(const d of a.viewLines){const h=c[d.modelLineNumber-l].map(f=>{if(f.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesAfterColumn).lineNumber>=d.modelLineWrappedLineIdx||f.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.forWrappedLinesBeforeOrAtColumn).lineNumber<d.modelLineWrappedLineIdx)return;if(!f.horizontalLine)return f;let g=-1;if(f.column!==-1){const v=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.column);if(v.lineNumber===d.modelLineWrappedLineIdx)g=v.column;else if(v.lineNumber<d.modelLineWrappedLineIdx)g=this.getMinColumnOfViewLine(d);else if(v.lineNumber>d.modelLineWrappedLineIdx)return}const p=this.convertModelPositionToViewPosition(d.modelLineNumber,f.horizontalLine.endColumn),_=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,f.horizontalLine.endColumn);return _.lineNumber===d.modelLineWrappedLineIdx?new xh(f.visibleColumn,g,f.className,new M_(f.horizontalLine.top,p.column),-1,-1):_.lineNumber<d.modelLineWrappedLineIdx||f.visibleColumn!==-1?void 0:new xh(f.visibleColumn,g,f.className,new M_(f.horizontalLine.top,this.getMaxColumnOfViewLine(d)),-1,-1)});r.push(h.filter(f=>!!f))}}return r}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let o=[];const r=[],a=[],l=i.lineNumber-1,c=s.lineNumber-1;let d=null;for(let g=l;g<=c;g++){const p=this.modelLineProjections[g];if(p.isVisible()){const _=p.getViewLineNumberOfModelPosition(0,g===l?i.column:1),v=p.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),b=v-_+1;let y=0;b>1&&p.getViewLineMinColumn(this.model,g+1,v)===1&&(y=_===0?1:2),r.push(b),a.push(y),d===null&&(d=new V(g+1,0))}else d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,g)),d=null)}d!==null&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,s.lineNumber)),d=null);const u=t-e+1,h=new Array(u);let f=0;for(let g=0,p=o.length;g<p;g++){let _=o[g];const v=Math.min(u-f,r[g]),b=a[g];let y;b===2?y=0:b===1?y=1:y=v;for(let w=0;w<v;w++)w===y&&(_=0),h[f++]=_}return h}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const s=this.projectedModelLineLineCounts.getIndexOf(e-1);let o=e;const r=s.index,a=s.remainder,l=[];for(let c=r,d=this.model.getLineCount();c<d;c++){const u=this.modelLineProjections[c];if(!u.isVisible())continue;const h=c===r?a:0;let f=u.getViewLineCount()-h,g=!1;if(o+f>t&&(g=!0,f=t-o+1),u.getViewLinesData(this.model,c+1,h,f,o-e,i,l),o+=f,g)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const s=this.projectedModelLineLineCounts.getIndexOf(e-1),o=s.index,r=s.remainder,a=this.modelLineProjections[o],l=a.getViewLineMinColumn(this.model,o+1,r),c=a.getViewLineMaxColumn(this.model,o+1,r);t<l&&(t=l),t>c&&(t=c);const d=a.getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new V(o+1,d)).equals(i)?new V(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),s=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new N(i.lineNumber,i.column,s.lineNumber,s.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),s=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new V(i.modelLineNumber,s))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new N(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,s=!1,o=!1){const r=this.model.validatePosition(new V(e,t)),a=r.lineNumber,l=r.column;let c=a-1,d=!1;if(o)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,d=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,d=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new V(s?0:1,1);const u=1+this.projectedModelLineLineCounts.getPrefixSum(c);let h;return d?o?h=this.modelLineProjections[c].getViewPositionOfModelPosition(u,1,i):h=this.modelLineProjections[c].getViewPositionOfModelPosition(u,this.model.getLineMaxColumn(c+1),i):h=this.modelLineProjections[a-1].getViewPositionOfModelPosition(u,l,i),h}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return N.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),s=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new N(i.lineNumber,i.column,s.lineNumber,s.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const o=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(o,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const s=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(s,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,s,o){const r=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-r.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new N(r.lineNumber,1,a.lineNumber,a.column),t,i,s,o);let l=[];const c=r.lineNumber-1,d=a.lineNumber-1;let u=null;for(let p=c;p<=d;p++)if(this.modelLineProjections[p].isVisible())u===null&&(u=new V(p+1,p===c?r.column:1));else if(u!==null){const v=this.model.getLineMaxColumn(p);l=l.concat(this.model.getDecorationsInRange(new N(u.lineNumber,u.column,p,v),t,i,s)),u=null}u!==null&&(l=l.concat(this.model.getDecorationsInRange(new N(u.lineNumber,u.column,a.lineNumber,a.column),t,i,s)),u=null),l.sort((p,_)=>{const v=N.compareRangesUsingStarts(p.range,_.range);return v===0?p.id<_.id?-1:p.id>_.id?1:0:v});const h=[];let f=0,g=null;for(const p of l){const _=p.id;g!==_&&(g=_,h[f++]=p)}return h}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function axe(n){if(n.length===0)return[];const e=n.slice();e.sort(N.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,s=e[0].endLineNumber;for(let o=1,r=e.length;o<r;o++){const a=e[o];a.startLineNumber>s+1?(t.push(new N(i,1,s,1)),i=a.startLineNumber,s=a.endLineNumber):a.endLineNumber>s&&(s=a.endLineNumber)}return t.push(new N(i,1,s,1)),t}class T8{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class N8{constructor(e,t){this.modelRange=e,this.viewLines=t}}class lxe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,s){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,s)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class cxe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new dxe(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,s){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,s)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new cN(t,i)}onModelLinesInserted(e,t,i,s){return new dN(t,i)}onModelLineChanged(e,t,i){return[!1,new dG(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,s=new Array(i);for(let o=0;o<i;o++)s[o]=0;return s}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new xP(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const s=this.model.getLineCount();e=Math.min(Math.max(1,e),s),t=Math.min(Math.max(1,t),s);const o=[];for(let r=e;r<=t;r++){const a=r-e;o[a]=i[a]?this.getViewLineData(r):null}return o}getDecorationsInRange(e,t,i,s,o){return this.model.getDecorationsInRange(e,t,i,s,o)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class dxe{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}let uxe=class extends Y{constructor(e,t,i,s,o,r,a,l,c){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this.hiddenAreasModel=new fxe,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new NSe,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new fg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new Li(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=t3.create(this.model),this.model.isTooLargeForTokenization())this._lines=new cxe(this.model);else{const d=this._configuration.options,u=d.get(50),h=d.get(137),f=d.get(144),g=d.get(136),p=d.get(128);this._lines=new rxe(this._editorId,this.model,s,o,u,this.model.getOptions().tabSize,h,f.wrappingColumn,g,p)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new $Se(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new JSe(this._configuration,this.getLineCount(),r)),this._register(this.viewLayout.onDidScroll(d=>{d.scrollTopChanged&&this._handleVisibleLinesChanged(),d.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new kSe(d)),this._eventDispatcher.emitOutgoingEvent(new e3(d.oldScrollWidth,d.oldScrollLeft,d.oldScrollHeight,d.oldScrollTop,d.scrollWidth,d.scrollLeft,d.scrollHeight,d.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(d=>{this._eventDispatcher.emitOutgoingEvent(d)})),this._decorations=new exe(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(d=>{try{const u=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(u,d)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(fy.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new ISe)})),this._register(this._themeService.onDidColorThemeChange(d=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new ESe(d))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new N(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new LSe(e)),this._eventDispatcher.emitOutgoingEvent(new JP(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new wSe)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new CSe)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new V(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new M8(t,this._viewportStart.startLineDelta)}return new M8(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),s=this._configuration.options,o=s.get(50),r=s.get(137),a=s.get(144),l=s.get(136),c=s.get(128);this._lines.setWrappingSettings(o,r,a.wrappingColumn,l,c)&&(e.emitViewEvent(new xw),e.emitViewEvent(new Lw),e.emitViewEvent(new _g(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(90)&&(this._decorations.reset(),e.emitViewEvent(new _g(null))),e.emitViewEvent(new SSe(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),fg.shouldRecreate(t)&&(this.cursorConfig=new fg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let s=!1,o=!1;const r=e instanceof Yh?e.rawContentChangedEvent.changes:e.changes,a=e instanceof Yh?e.rawContentChangedEvent.versionId:null,l=this._lines.createLineBreaksComputer();for(const u of r)switch(u.changeType){case 4:{for(let h=0;h<u.detail.length;h++){const f=u.detail[h];let g=u.injectedTexts[h];g&&(g=g.filter(p=>!p.ownerId||p.ownerId===this._editorId)),l.addRequest(f,g,null)}break}case 2:{let h=null;u.injectedText&&(h=u.injectedText.filter(f=>!f.ownerId||f.ownerId===this._editorId)),l.addRequest(u.detail,h,null);break}}const c=l.finalize(),d=new gc(c);for(const u of r)switch(u.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new xw),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),s=!0;break}case 3:{const h=this._lines.onModelLinesDeleted(a,u.fromLineNumber,u.toLineNumber);h!==null&&(i.emitViewEvent(h),this.viewLayout.onLinesDeleted(h.fromLineNumber,h.toLineNumber)),s=!0;break}case 4:{const h=d.takeCount(u.detail.length),f=this._lines.onModelLinesInserted(a,u.fromLineNumber,u.toLineNumber,h);f!==null&&(i.emitViewEvent(f),this.viewLayout.onLinesInserted(f.fromLineNumber,f.toLineNumber)),s=!0;break}case 2:{const h=d.dequeue(),[f,g,p,_]=this._lines.onModelLineChanged(a,u.lineNumber,h);o=f,g&&i.emitViewEvent(g),p&&(i.emitViewEvent(p),this.viewLayout.onLinesInserted(p.fromLineNumber,p.toLineNumber)),_&&(i.emitViewEvent(_),this.viewLayout.onLinesDeleted(_.fromLineNumber,_.toLineNumber));break}case 5:break}a!==null&&this._lines.acceptVersionId(a),this.viewLayout.onHeightMaybeChanged(),!s&&o&&(i.emitViewEvent(new Lw),i.emitViewEvent(new _g(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const t=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&t){const i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){const s=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),o=this.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber);this.viewLayout.setScrollPosition({scrollTop:o+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();e instanceof Yh&&i.emitOutgoingEvent(new VSe(e.contentChangedEvent)),this._cursor.onModelContentChanged(i,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{const t=[];for(let i=0,s=e.ranges.length;i<s;i++){const o=e.ranges[i],r=this.coordinatesConverter.convertModelPositionToViewPosition(new V(o.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new V(o.toLineNumber,this.model.getLineMaxColumn(o.toLineNumber))).lineNumber;t[i]={fromLineNumber:r,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new ASe(t)),this._eventDispatcher.emitOutgoingEvent(new HSe(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new DSe),this.cursorConfig=new fg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new WSe(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new fg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new BSe(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new xw),t.emitViewEvent(new Lw),t.emitViewEvent(new _g(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new fg(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new zSe(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new _g(e)),this._eventDispatcher.emitOutgoingEvent(new FSe(e))}))}setHiddenAreas(e,t){this.hiddenAreasModel.setHiddenAreas(t,e);const i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;const s=this._captureStableViewport();let o=!1;try{const r=this._eventDispatcher.beginEmitViewEvents();o=this._lines.setHiddenAreas(i),o&&(r.emitViewEvent(new xw),r.emitViewEvent(new Lw),r.emitViewEvent(new _g(null)),this._cursor.onLineMappingChanged(r),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged()),s.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),o&&this._eventDispatcher.emitOutgoingEvent(new PSe)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(143),t=this._configuration.options.get(66),i=Math.max(20,Math.round(e.height/t)),s=this.viewLayout.getLinesViewportData(),o=Math.max(1,s.completelyVisibleStartLineNumber-i),r=Math.min(this.getLineCount(),s.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new N(o,this.getLineMinColumn(o),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const s=[];let o=0,r=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let d=0,u=i.length;d<u;d++){const h=i[d].startLineNumber,f=i[d].endLineNumber;f<r||h>l||(r<h&&(s[o++]=new N(r,a,h-1,this.model.getLineMaxColumn(h-1))),r=f+1,a=1)}return(r<l||r===l&&a<c)&&(s[o++]=new N(r,a,l,c)),s}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new N(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,s=t.completelyVisibleEndLineNumber;return new N(i,this.getLineMinColumn(i),s,this.getLineMaxColumn(s))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),s=this.coordinatesConverter.convertViewPositionToModelPosition(new V(i,this.getLineMinColumn(i))),o=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:s,firstPositionDeltaTop:o}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),s=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:s}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,s){return this._lines.getViewLinesBracketGuides(e,t,i,s)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Zs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Of(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,t){const s=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,s)}getViewLineRenderingData(e){const t=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,t)}_getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),s=this.model.mightContainNonBasicASCII(),o=this.getTabSize(),r=this._lines.getViewLineData(e);return r.inlineDecorations&&(t=[...t,...r.inlineDecorations.map(a=>a.toInlineDecoration(e))]),new Do(r.minColumn,r.maxColumn,r.content,r.continuesWithWrappedLine,i,s,r.tokens,t,o,r.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const s=this._lines.getViewLinesData(e,t,i);return new cbe(this.getTabSize(),s)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,NS(this._configuration.options)),i=new hxe;for(const s of t){const o=s.options,r=o.overviewRuler;if(!r)continue;const a=r.position;if(a===0)continue;const l=r.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.startLineNumber,s.range.startColumn),d=this.coordinatesConverter.getViewLineNumberOfModelPosition(s.range.endLineNumber,s.range.endColumn);i.accept(l,o.zIndex,c,d,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i==null||i.invalidateCachedColor();const s=t.options.minimap;s==null||s.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e);return this.model.modifyPosition(i,t)}deduceModelPositionRelativeToViewPosition(e,t,i){const s=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const r=this.model.getOffsetAt(s)+t;return this.model.getPositionAt(r)}getPlainTextToCopy(e,t,i){const s=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(N.compareRangesUsingStarts);let o=!1,r=!1;for(const l of e)l.isEmpty()?o=!0:r=!0;if(!r){if(!t)return"";const l=e.map(d=>d.startLineNumber);let c="";for(let d=0;d<l.length;d++)d>0&&l[d-1]===l[d]||(c+=this.model.getLineContent(l[d])+s);return c}if(o&&t){const l=[];let c=0;for(const d of e){const u=d.startLineNumber;d.isEmpty()?u!==c&&l.push(this.model.getLineContent(u)):l.push(this.model.getValueInRange(d,i?2:0)),c=u}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===zo||e.length!==1)return null;let s=e[0];if(s.isEmpty()){if(!t)return null;const d=s.startLineNumber;s=new N(d,this.model.getLineMinColumn(d),d,this.model.getLineMaxColumn(d))}const o=this._configuration.options.get(50),r=this._getColorMap(),l=/[:;\\\/<>]/.test(o.fontFamily)||o.fontFamily===Vo.fontFamily;let c;return l?c=Vo.fontFamily:(c=o.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Vo.fontFamily}`),{mode:i,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${c};font-weight: ${o.fontWeight};font-size: ${o.fontSize}px;line-height: ${o.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(s,r)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,s=e.startColumn,o=e.endLineNumber,r=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=o;c++){const d=this.model.tokenization.getLineTokens(c),u=d.getLineContent(),h=c===i?s-1:0,f=c===o?r-1:u.length;u===""?l+="<br>":l+=KSe(u,d.inflate(),t,h,f,a,Ps)}return l}_getColorMap(){const e=Si.getColorMap(),t=["#000000"];if(e)for(let i=1,s=e.length;i<s;i++)t[i]=z.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(s=>this._cursor.setStates(s,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(s=>this._cursor.setSelections(s,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new OSe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(s=>this._cursor.executeEdits(s,e,t,i))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,s,o){this._executeCursorEdit(r=>this._cursor.compositionType(r,e,t,i,s,o))}paste(e,t,i,s){this._executeCursorEdit(o=>this._cursor.paste(o,e,t,i,s))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(s=>this._cursor.revealPrimary(s,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new N(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(s=>s.emitViewEvent(new FC(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new N(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(s=>s.emitViewEvent(new FC(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,s,o){this._withViewEventsCollector(r=>r.emitViewEvent(new FC(e,!1,i,null,s,t,o)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new TSe),this._eventDispatcher.emitOutgoingEvent(new MSe))}_withViewEventsCollector(e){try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class t3{static create(e){const t=e._setTrackedRange(null,new N(1,1,1,1),1);return new t3(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,s,o){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=s,this._startLineDelta=o}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new V(t,e.getLineMinColumn(t))),s=e.model._setTrackedRange(this._modelTrackedRange,new N(i.lineNumber,i.column,i.lineNumber,i.column),1),o=e.viewLayout.getVerticalOffsetForLineNumber(t),r=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=s,this._startLineDelta=r-o}invalidate(){this._isValid=!1}}class hxe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,s,o){const r=this._asMap[e];if(r){const a=r.data,l=a[a.length-3],c=a[a.length-1];if(l===o&&c+1>=i){s>c&&(a[a.length-1]=s);return}a.push(o,i,s)}else{const a=new Yb(e,t,[o,i,s]);this._asMap[e]=a,this.asArray.push(a)}}}class fxe{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&R8(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>gxe(t,i),[]);return R8(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function gxe(n,e){const t=[];let i=0,s=0;for(;i<n.length&&s<e.length;){const o=n[i],r=e[s];if(o.endLineNumber<r.startLineNumber-1)t.push(n[i++]);else if(r.endLineNumber<o.startLineNumber-1)t.push(e[s++]);else{const a=Math.min(o.startLineNumber,r.startLineNumber),l=Math.max(o.endLineNumber,r.endLineNumber);t.push(new N(a,1,l,1)),i++,s++}}for(;i<n.length;)t.push(n[i++]);for(;s<e.length;)t.push(e[s++]);return t}function R8(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].equalsRange(e[t]))return!1;return!0}class M8{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),s=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:s+this.startLineDelta},1)}}class YD{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var gv;(function(n){n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})(gv||(gv={}));(function(n){const e="error",t="warning",i="warn",s="info",o="ignore";function r(l){return l?Pg(e,l)?n.Error:Pg(t,l)||Pg(i,l)?n.Warning:Pg(s,l)?n.Info:n.Ignore:n.Ignore}n.fromValue=r;function a(l){switch(l){case n.Error:return e;case n.Warning:return t;case n.Info:return s;default:return o}}n.toString=a})(gv||(gv={}));const mi=gv;var fG=mi;const Ln=at("notificationService");class pxe{}class $_{constructor(e,t,i,s,o){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=s,this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let s=this.breakOffsets[e]-t;return e>0&&(s+=this.wrappedTextIndentLength),s}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let s=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let o=0;o<this.injectionOffsets.length&&s>this.injectionOffsets[o];o++)s<this.injectionOffsets[o]+this.injectionOptions[o].content.length?s=this.injectionOffsets[o]:s-=this.injectionOptions[o].content.length;return s}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let s=0;s<this.injectionOffsets.length&&!(e<this.injectionOffsets[s]||t!==1&&e===this.injectionOffsets[s]);s++)i+=this.injectionOptions[s].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,s=this.breakOffsets.length-1,o=0,r=0;for(;i<=s;){o=i+(s-i)/2|0;const l=this.breakOffsets[o];if(r=o>0?this.breakOffsets[o-1]:0,t===0)if(e<=r)s=o-1;else if(e>l)i=o+1;else break;else if(e<r)s=o-1;else if(e>=l)i=o+1;else break}let a=e-r;return o>0&&(a+=this.wrappedTextIndentLength),new Dw(o,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const s=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(s,i);if(o!==s)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new Dw(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const s=this.getOutputLineCount()-1;if(e<s&&t===this.getMaxOutputOffset(e))return new Dw(e+1,this.getMinOutputOffset(e+1))}return new Dw(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&P8(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let s=i.offsetInInputWithInjections;if(O8(this.injectionOptions[i.injectedTextIndex].cursorStops))return s;let o=i.injectedTextIndex-1;for(;o>=0&&this.injectionOffsets[o]===this.injectionOffsets[i.injectedTextIndex]&&!(P8(this.injectionOptions[o].cursorStops)||(s-=this.injectionOptions[o].content.length,O8(this.injectionOptions[o].cursorStops)));)o--;return s}}else if(t===1||t===4){let s=i.offsetInInputWithInjections+i.length,o=i.injectedTextIndex;for(;o+1<this.injectionOffsets.length&&this.injectionOffsets[o+1]===this.injectionOffsets[o];)s+=this.injectionOptions[o+1].content.length,o++;return s}else if(t===0||t===3){let s=i.offsetInInputWithInjections,o=i.injectedTextIndex;for(;o-1>=0&&this.injectionOffsets[o-1]===this.injectionOffsets[o];)s-=this.injectionOptions[o-1].content.length,o--;return s}lP()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),s=this.getInjectedTextAtOffset(i);return s?{options:this.injectionOptions[s.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let s=0;for(let o=0;o<t.length;o++){const r=i[o].content.length,a=t[o]+s,l=t[o]+s+r;if(a>e)break;if(e<=l)return{injectedTextIndex:o,offsetInInputWithInjections:a,length:r};s+=r}}}}function P8(n){return n==null?!0:n===wm.Right||n===wm.Both}function O8(n){return n==null?!0:n===wm.Left||n===wm.Both}class Dw{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new V(e+this.outputLineIndex,this.outputOffset+1)}}class i3{static create(e){return new i3(e.get(132),e.get(131))}constructor(e,t){this.classifier=new mxe(e,t)}createLineBreaksComputer(e,t,i,s,o){const r=[],a=[],l=[];return{addRequest:(c,d,u)=>{r.push(c),a.push(d),l.push(u)},finalize:()=>{const c=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let u=0,h=r.length;u<h;u++){const f=a[u],g=l[u];g&&!g.injectionOptions&&!f?d[u]=_xe(this.classifier,g,r[u],t,i,c,s,o):d[u]=bxe(this.classifier,r[u],f,t,i,c,s,o)}return hN.length=0,fN.length=0,d}}}}class mxe extends oy{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let hN=[],fN=[];function _xe(n,e,t,i,s,o,r,a){if(s===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",d=e.breakOffsets,u=e.breakOffsetsVisibleColumn,h=gG(t,i,s,o,r),f=s-h,g=hN,p=fN;let _=0,v=0,b=0,y=s;const w=d.length;let C=0;if(C>=0){let L=Math.abs(u[C]-y);for(;C+1<w;){const x=Math.abs(u[C+1]-y);if(x>=L)break;L=x,C++}}for(;C<w;){let L=C<0?0:d[C],x=C<0?0:u[C];v>L&&(L=v,x=b);let D=0,k=0,P=0,O=0;if(x<=y){let R=x,$=L===0?0:t.charCodeAt(L-1),G=L===0?0:n.get($),ne=!0;for(let ae=L;ae<l;ae++){const fe=ae,oe=t.charCodeAt(ae);let xe,Te;if(tn(oe)?(ae++,xe=0,Te=2):(xe=n.get(oe),Te=U_(oe,R,i,o)),fe>v&&gN($,G,oe,xe,c)&&(D=fe,k=R),R+=Te,R>y){fe>v?(P=fe,O=R-Te):(P=ae+1,O=R),R-k>f&&(D=0),ne=!1;break}$=oe,G=xe}if(ne){_>0&&(g[_]=d[d.length-1],p[_]=u[d.length-1],_++);break}}if(D===0){let R=x,$=t.charCodeAt(L),G=n.get($),ne=!1;for(let ae=L-1;ae>=v;ae--){const fe=ae+1,oe=t.charCodeAt(ae);if(oe===9){ne=!0;break}let xe,Te;if(gm(oe)?(ae--,xe=0,Te=2):(xe=n.get(oe),Te=Jd(oe)?o:1),R<=y){if(P===0&&(P=fe,O=R),R<=y-f)break;if(gN(oe,xe,$,G,c)){D=fe,k=R;break}}R-=Te,$=oe,G=xe}if(D!==0){const ae=f-(O-k);if(ae<=i){const fe=t.charCodeAt(P);let oe;tn(fe)?oe=2:oe=U_(fe,O,i,o),ae-oe<0&&(D=0)}}if(ne){C--;continue}}if(D===0&&(D=P,k=O),D<=v){const R=t.charCodeAt(v);tn(R)?(D=v+2,k=b+2):(D=v+1,k=b+U_(R,b,i,o))}for(v=D,g[_]=D,b=k,p[_]=k,_++,y=k+f;C<0||C<w&&u[C]<k;)C++;let M=Math.abs(u[C]-y);for(;C+1<w;){const R=Math.abs(u[C+1]-y);if(R>=M)break;M=R,C++}}return _===0?null:(g.length=_,p.length=_,hN=e.breakOffsets,fN=e.breakOffsetsVisibleColumn,e.breakOffsets=g,e.breakOffsetsVisibleColumn=p,e.wrappedTextIndentLength=h,e)}function bxe(n,e,t,i,s,o,r,a){const l=sa.applyInjectedText(e,t);let c,d;if(t&&t.length>0?(c=t.map(k=>k.options),d=t.map(k=>k.column-1)):(c=null,d=null),s===-1)return c?new $_(d,c,[l.length],[],0):null;const u=l.length;if(u<=1)return c?new $_(d,c,[l.length],[],0):null;const h=a==="keepAll",f=gG(l,i,s,o,r),g=s-f,p=[],_=[];let v=0,b=0,y=0,w=s,C=l.charCodeAt(0),L=n.get(C),x=U_(C,0,i,o),D=1;tn(C)&&(x+=1,C=l.charCodeAt(1),L=n.get(C),D++);for(let k=D;k<u;k++){const P=k,O=l.charCodeAt(k);let M,R;tn(O)?(k++,M=0,R=2):(M=n.get(O),R=U_(O,x,i,o)),gN(C,L,O,M,h)&&(b=P,y=x),x+=R,x>w&&((b===0||x-y>g)&&(b=P,y=x-R),p[v]=b,_[v]=y,v++,w=y+g,b=0),C=O,L=M}return v===0&&(!t||t.length===0)?null:(p[v]=u,_[v]=x,new $_(d,c,p,_,f))}function U_(n,e,t,i){return n===9?t-e%t:Jd(n)||n<32?i:1}function F8(n,e){return e-n%e}function gN(n,e,t,i,s){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!s&&e===3&&i!==2||!s&&i===3&&e!==1)}function gG(n,e,t,i,s){let o=0;if(s!==0){const r=Zs(n);if(r!==-1){for(let l=0;l<r;l++){const c=n.charCodeAt(l)===9?F8(o,e):1;o+=c}const a=s===3?2:s===2?1:0;for(let l=0;l<a;l++){const c=F8(o,e);o+=c}o+i>t&&(o=0)}}return o}const gE=Vf("domLineBreaksComputer",{createHTML:n=>n});class n3{static create(){return new n3}constructor(){}createLineBreaksComputer(e,t,i,s,o){const r=[],a=[];return{addRequest:(l,c,d)=>{r.push(l),a.push(c)},finalize:()=>vxe(r,e,t,i,s,o,a)}}}function vxe(n,e,t,i,s,o,r){var a;function l(k){const P=r[k];if(P){const O=sa.applyInjectedText(n[k],P),M=P.map($=>$.options),R=P.map($=>$.column-1);return new $_(R,M,[O.length],[],0)}else return null}if(i===-1){const k=[];for(let P=0,O=n.length;P<O;P++)k[P]=l(P);return k}const c=Math.round(i*e.typicalHalfwidthCharacterWidth),u=Math.round(t*(s===3?2:s===2?1:0)),h=Math.ceil(e.spaceWidth*u),f=document.createElement("div");Rn(f,e);const g=new ID(1e4),p=[],_=[],v=[],b=[],y=[];for(let k=0;k<n.length;k++){const P=sa.applyInjectedText(n[k],r[k]);let O=0,M=0,R=c;if(s!==0)if(O=Zs(P),O===-1)O=0;else{for(let ae=0;ae<O;ae++){const fe=P.charCodeAt(ae)===9?t-M%t:1;M+=fe}const ne=Math.ceil(e.spaceWidth*M);ne+e.typicalFullwidthCharacterWidth>c?(O=0,M=0):R=c-ne}const $=P.substr(O),G=yxe($,M,t,R,g,h);p[k]=O,_[k]=M,v[k]=$,b[k]=G[0],y[k]=G[1]}const w=g.build(),C=(a=gE==null?void 0:gE.createHTML(w))!==null&&a!==void 0?a:w;f.innerHTML=C,f.style.position="absolute",f.style.top="10000",o==="keepAll"?(f.style.wordBreak="keep-all",f.style.overflowWrap="anywhere"):(f.style.wordBreak="inherit",f.style.overflowWrap="break-word"),document.body.appendChild(f);const L=document.createRange(),x=Array.prototype.slice.call(f.children,0),D=[];for(let k=0;k<n.length;k++){const P=x[k],O=wxe(L,P,v[k],b[k]);if(O===null){D[k]=l(k);continue}const M=p[k],R=_[k]+u,$=y[k],G=[];for(let oe=0,xe=O.length;oe<xe;oe++)G[oe]=$[O[oe]];if(M!==0)for(let oe=0,xe=O.length;oe<xe;oe++)O[oe]+=M;let ne,ae;const fe=r[k];fe?(ne=fe.map(oe=>oe.options),ae=fe.map(oe=>oe.column-1)):(ne=null,ae=null),D[k]=new $_(ae,ne,O,G,R)}return document.body.removeChild(f),D}function yxe(n,e,t,i,s,o){if(o!==0){const h=String(o);s.appendString('<div style="text-indent: -'),s.appendString(h),s.appendString("px; padding-left: "),s.appendString(h),s.appendString("px; box-sizing: border-box; width:")}else s.appendString('<div style="width:');s.appendString(String(i)),s.appendString('px;">');const r=n.length;let a=e,l=0;const c=[],d=[];let u=0<r?n.charCodeAt(0):0;s.appendString("<span>");for(let h=0;h<r;h++){h!==0&&h%16384===0&&s.appendString("</span><span>"),c[h]=l,d[h]=a;const f=u;u=h+1<r?n.charCodeAt(h+1):0;let g=1,p=1;switch(f){case 9:g=t-a%t,p=g;for(let _=1;_<=g;_++)_<g?s.appendCharCode(160):s.appendASCIICharCode(32);break;case 32:u===32?s.appendCharCode(160):s.appendASCIICharCode(32);break;case 60:s.appendString("&lt;");break;case 62:s.appendString("&gt;");break;case 38:s.appendString("&amp;");break;case 0:s.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:s.appendCharCode(65533);break;default:Jd(f)&&p++,f<32?s.appendCharCode(9216+f):s.appendCharCode(f)}l+=g,a+=p}return s.appendString("</span>"),c[n.length]=l,d[n.length]=a,s.appendString("</div>"),[c,d]}function wxe(n,e,t,i){if(t.length<=1)return null;const s=Array.prototype.slice.call(e.children,0),o=[];try{pN(n,s,i,0,null,t.length-1,null,o)}catch(r){return console.log(r),null}return o.length===0?null:(o.push(t.length),o)}function pN(n,e,t,i,s,o,r,a){if(i===o||(s=s||pE(n,e,t[i],t[i+1]),r=r||pE(n,e,t[o],t[o+1]),Math.abs(s[0].top-r[0].top)<=.1))return;if(i+1===o){a.push(o);return}const l=i+(o-i)/2|0,c=pE(n,e,t[l],t[l+1]);pN(n,e,t,i,s,l,c,a),pN(n,e,t,l,c,o,r,a)}function pE(n,e,t,i){return n.setStart(e[t/16384|0].firstChild,t%16384),n.setEnd(e[i/16384|0].firstChild,i%16384),n.getClientRects()}class Cxe extends Y{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new j4),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const s of t){if(this._pending.has(s.id)){mt(new Error(`Cannot have two contributions with the same id ${s.id}`));continue}this._pending.set(s.id,s)}this._instantiateSome(0),this._register(rd(()=>{this._instantiateSome(1)})),this._register(rd(()=>{this._instantiateSome(2)})),this._register(rd(()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register(rd(()=>{this._instantiateSome(1)},50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){mt(i)}}}}var Sxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},ml=function(n,e){return function(t,i){e(t,i,n)}},xxe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},eh;let Lxe=0,Dxe=class{constructor(e,t,i,s,o,r){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=s,this.listenersToRemove=o,this.attachedView=r}dispose(){Ft(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}},Im=eh=class extends Y{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,t,i,s,o,r,a,l,c,d,u,h){var f;super(),this.languageConfigurationService=u,this._deliveryQueue=uge(),this._contributions=this._register(new Cxe),this._onDidDispose=this._register(new B),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new B8({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new B8({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new $n(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new $n(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new $n(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new $n(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new $n(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new $n(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new B({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),o.willCreateCodeEditor();const g=Object.assign({},t);this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++Lxe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,g,d)),this._register(this._configuration.onDidChange(v=>{this._onDidChangeConfiguration.fire(v);const b=this._configuration.options;if(v.hasChanged(143)){const y=b.get(143);this._onDidLayoutChange.fire(y)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=o,this._commandService=r,this._themeService=l,this._register(new kxe(this,this._contextKeyService)),this._register(new Exe(this,this._contextKeyService,h)),this._instantiationService=s.createChild(new YD([tt,this._contextKeyService])),this._modelData=null,this._focusTracker=new Axe(e),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let p;Array.isArray(i.contributions)?p=i.contributions:p=hp.getEditorContributions(),this._contributions.initialize(this,p,this._instantiationService);for(const v of hp.getEditorActions()){if(this._actions.has(v.id)){mt(new Error(`Cannot have two actions with the same id ${v.id}`));continue}const b=new qq(v.id,v.label,v.alias,(f=v.precondition)!==null&&f!==void 0?f:void 0,()=>this._instantiationService.invokeFunction(y=>Promise.resolve(v.runEditorCommand(y,this,null))),this._contextKeyService);this._actions.set(b.id,b)}const _=()=>!this._configuration.options.get(90)&&this._configuration.options.get(36).enabled;this._register(new Ime(this._domElement,{onDragEnter:()=>{},onDragOver:v=>{if(!_())return;const b=this.getTargetAtClientPoint(v.clientX,v.clientY);b!=null&&b.position&&this.showDropIndicatorAt(b.position)},onDrop:v=>xxe(this,void 0,void 0,function*(){if(!_()||(this.removeDropIndicator(),!v.dataTransfer))return;const b=this.getTargetAtClientPoint(v.clientX,v.clientY);b!=null&&b.position&&this._onDropIntoEditor.fire({position:b.position,event:v})}),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var t;(t=this._modelData)===null||t===void 0||t.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i){return new $T(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return OD.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?wi.getWordAtPosition(this._modelData.model,this._configuration.options.get(129),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(this._modelData===null&&t===null||this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),s=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const o={oldModelUrl:s?s.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(o),this._postDetachModelCleanup(s),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,s){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,s)}getTopForLineNumber(e,t=!1){return this._modelData?eh._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?eh._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,s=!1){const o=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,s)}getBottomForLineNumber(e,t=!1){return this._modelData?eh._getVerticalOffsetAfterPosition(this._modelData,e,1,t):-1}setHiddenAreas(e,t){var i;(i=this._modelData)===null||i===void 0||i.viewModel.setHiddenAreas(e.map(s=>N.lift(s)),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return qi.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!V.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,s){if(!this._modelData)return;if(!N.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",i,r,t,s)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new N(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,s){if(!V.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new N(e.lineNumber,e.column,e.lineNumber,e.column),t,i,s)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=lt.isISelection(e),s=N.isIRange(e);if(!i&&!s)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(s){const o={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(o,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new lt(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,s){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new N(e,1,t,1),i,!1,s)}revealRange(e,t=0,i=!1,s=!0){this._revealRange(e,i?1:0,s,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,s){if(!N.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(N.lift(e),t,i,s)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let s=0,o=e.length;s<o;s++)if(!lt.isISelection(e[s]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const s=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(s)}}handleInitialized(){var e;(e=this._getViewModel())===null||e===void 0||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const o=i;this._type(e,o.text||"");return}case"replacePreviousChar":{const o=i;this._compositionType(e,o.text||"",o.replaceCharCnt||0,0,0);return}case"compositionType":{const o=i;this._compositionType(e,o.text||"",o.replacePrevCharCnt||0,o.replaceNextCharCnt||0,o.positionDelta||0);return}case"paste":{const o=i;this._paste(e,o.text||"",o.pasteOnNewLine||!1,o.multicursorText||null,o.mode||null);return}case"cut":this._cut(e);return}const s=this.getAction(t);if(s){Promise.resolve(s.run(i)).then(void 0,mt);return}this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,s,o){this._modelData&&this._modelData.viewModel.compositionType(t,i,s,o,e)}_paste(e,t,i,s,o){if(!this._modelData||t.length===0)return;const r=this._modelData.viewModel,a=r.getSelection().getStartPosition();r.paste(t,i,s,e);const l=r.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({range:new N(a.lineNumber,a.column,l.lineNumber,l.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const s=hp.getEditorCommand(t);return s?(i=i||{},i.source=e,this._instantiationService.invokeFunction(o=>{Promise.resolve(s.runEditorCommand(o,this,i)).then(void 0,mt)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(90)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(90)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(90))return!1;let s;return i?Array.isArray(i)?s=()=>i:s=i:s=()=>null,this._modelData.viewModel.executeEdits(e,t,s),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new Ixe(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,NS(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,NS(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(143)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,s=i.get(143),o=eh._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+s.glyphMarginWidth+s.lineNumbersWidth+s.decorationsWidth-this.getScrollLeft();return{top:o,left:r,height:i.get(66)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.view.render(!0,e)}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){Rn(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),s=new uxe(this._id,this._configuration,e,n3.create(),i3.create(this._configuration.options),a=>Uo(a),this.languageConfigurationService,this._themeService,i);t.push(e.onWillDispose(()=>this.setModel(null))),t.push(s.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._onDidScrollChange.fire(a);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(a.reachedMaxCursorCount){const u=this.getOption(79),h=m("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",u);this._notificationService.prompt(fG.Warning,h,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:m("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let u=0,h=a.selections.length;u<h;u++)l[u]=a.selections[u].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const d={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(d);break}case 7:this._onDidChangeModelDecorations.fire(a.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 10:this._onDidChangeModelContent.fire(a.event);break;case 11:this._onDidChangeModelOptions.fire(a.event);break;case 12:this._onDidChangeModelTokens.fire(a.event);break}}));const[o,r]=this._createView(s);if(r){this._domElement.appendChild(o.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addContentWidget(this._contentWidgets[d])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addOverlayWidget(this._overlayWidgets[d])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];o.addGlyphMarginWidget(this._glyphMarginWidgets[d])}o.render(!1,!0),o.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Dxe(e,s,o,r,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(o,r,a,l)=>{this._paste("keyboard",o,r,a,l)},type:o=>{this._type("keyboard",o)},compositionType:(o,r,a,l)=>{this._compositionType("keyboard",o,r,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(o,r,a,l)=>{const c={text:o,pasteOnNewLine:r,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:o=>{const r={text:o};this._commandService.executeCommand("type",r)},compositionType:(o,r,a,l)=>{if(a||l){const c={text:o,replacePrevCharCnt:r,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:o,replaceCharCnt:r};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new jD(e.coordinatesConverter);return i.onKeyDown=o=>this._onKeyDown.fire(o),i.onKeyUp=o=>this._onKeyUp.fire(o),i.onContextMenu=o=>this._onContextMenu.fire(o),i.onMouseMove=o=>this._onMouseMove.fire(o),i.onMouseLeave=o=>this._onMouseLeave.fire(o),i.onMouseDown=o=>this._onMouseDown.fire(o),i.onMouseUp=o=>this._onMouseUp.fire(o),i.onMouseDrag=o=>this._onMouseDrag.fire(o),i.onMouseDrop=o=>this._onMouseDrop.fire(o),i.onMouseDropCanceled=o=>this._onMouseDropCanceled.fire(o),i.onMouseWheel=o=>this._onMouseWheel.fire(o),[new tN(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e==null||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new N(e.lineNumber,e.column,e.lineNumber,e.column),options:eh.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}};Im.dropIntoEditorDecorationOptions=et.register({description:"workbench-dnd-target",className:"dnd-target"});Im=eh=Sxe([ml(3,vt),ml(4,Ut),ml(5,fs),ml(6,tt),ml(7,ao),ml(8,Ln),ml(9,Du),ml(10,oo),ml(11,nt)],Im);class B8 extends Y{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new B(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new B(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class $n extends B{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class kxe extends Y{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=H.editorSimpleInput.bindTo(t),this._editorFocus=H.focus.bindTo(t),this._textInputFocus=H.textInputFocus.bindTo(t),this._editorTextFocus=H.editorTextFocus.bindTo(t),this._tabMovesFocus=H.tabMovesFocus.bindTo(t),this._editorReadonly=H.readOnly.bindTo(t),this._inDiffEditor=H.inDiffEditor.bindTo(t),this._editorColumnSelection=H.columnSelection.bindTo(t),this._hasMultipleSelections=H.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=H.hasNonEmptySelection.bindTo(t),this._canUndo=H.canUndo.bindTo(t),this._canRedo=H.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(ex.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(ex.getTabFocusMode()),this._editorReadonly.set(e.get(90)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class Exe extends Y{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=H.languageId.bindTo(t),this._hasCompletionItemProvider=H.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=H.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=H.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=H.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=H.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=H.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=H.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=H.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=H.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=H.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=H.hasReferenceProvider.bindTo(t),this._hasRenameProvider=H.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=H.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=H.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=H.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=H.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=H.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=H.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=H.isInWalkThroughSnippet.bindTo(t);const s=()=>this._update();this._register(e.onDidChangeModel(s)),this._register(e.onDidChangeModelLanguage(s)),this._register(i.completionProvider.onDidChange(s)),this._register(i.codeActionProvider.onDidChange(s)),this._register(i.codeLensProvider.onDidChange(s)),this._register(i.definitionProvider.onDidChange(s)),this._register(i.declarationProvider.onDidChange(s)),this._register(i.implementationProvider.onDidChange(s)),this._register(i.typeDefinitionProvider.onDidChange(s)),this._register(i.hoverProvider.onDidChange(s)),this._register(i.documentHighlightProvider.onDidChange(s)),this._register(i.documentSymbolProvider.onDidChange(s)),this._register(i.referenceProvider.onDidChange(s)),this._register(i.renameProvider.onDidChange(s)),this._register(i.documentFormattingEditProvider.onDidChange(s)),this._register(i.documentRangeFormattingEditProvider.onDidChange(s)),this._register(i.signatureHelpProvider.onDidChange(s)),this._register(i.inlayHintsProvider.onDidChange(s)),s()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===it.walkThroughSnippet)})}}class Axe extends Y{constructor(e){super(),this._onChange=this._register(new B),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(eu(e)),this._register(this._domFocusTracker.onDidFocus(()=>{this._hasFocus=!0,this._onChange.fire(void 0)})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasFocus=!1,this._onChange.fire(void 0)}))}hasFocus(){return this._hasFocus}}class Ixe{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(s=>{this._isChangingDecorations||e.call(t,s)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const s=e.getDecorationRange(i);s&&t.push(s)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}}const Txe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),Nxe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function mE(n){return Txe+encodeURIComponent(n.toString())+Nxe}const Rxe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),Mxe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function Pxe(n){return Rxe+encodeURIComponent(n.toString())+Mxe}Dr((n,e)=>{const t=n.getColor(Fa);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${mE(t)}") repeat-x bottom left; }`);const i=n.getColor(wo);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${mE(i)}") repeat-x bottom left; }`);const s=n.getColor(ks);s&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${mE(s)}") repeat-x bottom left; }`);const o=n.getColor(lve);o&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${Pxe(o)}") no-repeat bottom left; }`);const r=n.getColor(fye);r&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)});var Oxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Fxe=function(n,e){return function(t,i){e(t,i,n)}},Bxe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let mN=class extends Y{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new B),this._onCodeEditorAdd=this._register(new B),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new B),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new B),this._onDiffEditorAdd=this._register(new B),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new B),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new Ds,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const s=e.toString();let o;this._modelProperties.has(s)?o=this._modelProperties.get(s):(o=new Map,this._modelProperties.set(s,o)),o.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}openCodeEditor(e,t,i){return Bxe(this,void 0,void 0,function*(){for(const s of this._codeEditorOpenHandlers){const o=yield s(e,t,i);if(o!==null)return o}return null})}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return Ze(t)}};mN=Oxe([Fxe(0,ao)],mN);var Wxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},W8=function(n,e){return function(t,i){e(t,i,n)}},Vxe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let bx=class extends mN{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler((i,s,o)=>Vxe(this,void 0,void 0,function*(){return s?this.doOpenEditor(s,i):null})))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const o=t.resource.scheme;if(o===it.http||o===it.https)return Cj(t.resource.toString()),e}return null}const s=t.options?t.options.selection:null;if(s)if(typeof s.endLineNumber=="number"&&typeof s.endColumn=="number")e.setSelection(s),e.revealRangeInCenter(s,1);else{const o={lineNumber:s.startLineNumber,column:s.startColumn};e.setPosition(o),e.revealPositionInCenter(o,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};bx=Wxe([W8(0,tt),W8(1,ao)],bx);ht(Ut,bx,0);const s0=at("layoutService");var pG=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},mG=function(n,e){return function(t,i){e(t,i,n)}};let vx=class{get dimension(){return this._dimension||(this._dimension=DD(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())===null||e===void 0||e.focus()}constructor(e){this._codeEditorService=e,this.onDidLayout=ue.None,this.offset={top:0,quickPickTop:0}}};vx=pG([mG(0,Ut)],vx);let _N=class extends vx{get hasContainer(){return!1}get container(){return this._container}constructor(e,t){super(t),this._container=e}};_N=pG([mG(1,Ut)],_N);ht(s0,vx,1);const _G=at("dialogService");var zxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},V8=function(n,e){return function(t,i){e(t,i,n)}},kw=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function Ew(n){return n.scheme===it.file?n.fsPath:n.path}let bG=0;class Aw{constructor(e,t,i,s,o,r,a){this.id=++bG,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=s,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class z8{constructor(e,t){this.resourceLabel=e,this.reason=t}}class H8{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,s]of this.elements)(s.reason===0?e:t).push(s.resourceLabel);const i=[];return e.length>0&&i.push(m({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(m({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class Hxe{constructor(e,t,i,s,o,r,a){this.id=++bG,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=s,this.groupOrder=o,this.sourceId=r,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new H8),this.removedResources.has(t)||this.removedResources.set(t,new z8(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new H8),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new z8(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class vG{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,s=this._past.length;i<s;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new lG(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,s=0,o=-1;for(let a=0,l=this._past.length;a<l;a++,s++){const c=this._past[a];i&&(s>=t||c.id!==e.elements[s])&&(i=!1,o=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let a=this._future.length-1;a>=0;a--,s++){const l=this._future[a];i&&(s>=t||l.id!==e.elements[s])&&(i=!1,r=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}o!==-1&&(this._past=this._past.slice(0,o)),r!==-1&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class _E{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const yG=new vG("","");yG.locked=!0;let bN=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=Em.None,i=Aa.None){if(e.type===0){const s=Ew(e.resource),o=this.getUriComparisonKey(e.resource);this._pushElement(new Aw(e,s,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const s=new Set,o=[],r=[];for(const a of e.resources){const l=Ew(a),c=this.getUriComparisonKey(a);s.has(c)||(s.add(c),o.push(l),r.push(c))}o.length===1?this._pushElement(new Aw(e,o[0],r[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new Hxe(e,o,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const s=e.resourceLabels[t],o=e.strResources[t];let r;this._editStacks.has(o)?r=this._editStacks.get(o):(r=new vG(s,o),this._editStacks.set(o,r)),r.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const s=i.getClosestPastElement();return s?s.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const o of i){const r=Ew(o.resource),a=this.getUriComparisonKey(o.resource),l=new Aw(o,r,a,0,0,0,0);s.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitPastWorkspaceElement(e,s)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),s=new Map;for(const o of i){const r=Ew(o.resource),a=this.getUriComparisonKey(o.resource),l=new Aw(o,r,a,0,0,0,0);s.set(l.strResource,l)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitFutureWorkspaceElement(e,s)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const s=this.getUriComparisonKey(e);this._editStacks.has(s)&&this._editStacks.get(s).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new lG(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.sourceId===e&&(!t||r.sourceOrder>t.sourceOrder)&&(t=r,i=s)}return[t,i]}canUndo(e){if(e instanceof Aa){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){mt(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,s,o){const r=this._acquireLocks(i);let a;try{a=t()}catch(l){return r(),s.dispose(),this._onError(l,e)}return a?a.then(()=>(r(),s.dispose(),o()),l=>(r(),s.dispose(),this._onError(l,e))):(r(),s.dispose(),o())}_invokeWorkspacePrepare(e){return kw(this,void 0,void 0,function*(){if(typeof e.actual.prepareUndoRedo>"u")return Y.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?Y.None:t})}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(Y.None);const i=e.actual.prepareUndoRedo();return i?oge(i)?t(i):i.then(s=>t(s)):t(Y.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||yG);return new _E(t)}_tryToSplitAndUndo(e,t,i,s){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(s),new Iw(this._undo(e,0,!0));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(s),new Iw}_checkWorkspaceUndo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,m({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,m({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndUndo(e,t,null,m({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndUndo(e,t,null,m({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,m({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const s=this._getAffectedEditStacks(t),o=this._checkWorkspaceUndo(e,t,s,!1);return o?o.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,s,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const s=t.getSecondClosestPastElement();if(s&&s.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,i,s){return kw(this,void 0,void 0,function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=yield this._dialogService.prompt({type:mi.Info,message:m("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:m({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:m({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;s=!0}let o;try{o=yield this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const r=this._checkWorkspaceUndo(e,t,i,!0);if(r)return o.dispose(),r.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,o,()=>this._continueUndoInGroup(t.groupId,s))})}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const s=m({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(s);return}return this._invokeResourcePrepare(t,s=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new _E([e]),s,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,o]of this._editStacks){const r=o.getClosestPastElement();r&&r.groupId===e&&(!t||r.groupOrder>t.groupOrder)&&(t=r,i=s)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof Aa){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const s=this._editStacks.get(e),o=s.getClosestPastElement();if(!o)return;if(o.groupId){const[a,l]=this._findClosestUndoElementInGroup(o.groupId);if(o!==a&&l)return this._undo(l,t,i)}if((o.sourceId!==t||o.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,o);try{return o.type===1?this._workspaceUndo(e,o,i):this._resourceUndo(s,o,i)}finally{}}_confirmAndContinueUndo(e,t,i){return kw(this,void 0,void 0,function*(){if((yield this._dialogService.confirm({message:m("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:m({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:m("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)})}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[s,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.sourceId===e&&(!t||r.sourceOrder<t.sourceOrder)&&(t=r,i=s)}return[t,i]}canRedo(e){if(e instanceof Aa){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,s){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(s),new Iw(this._redo(e));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(s),new Iw}_checkWorkspaceRedo(e,t,i,s){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,m({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(s&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,m({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&o.push(a.resourceLabel);if(o.length>0)return this._tryToSplitAndRedo(e,t,null,m({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndRedo(e,t,null,m({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,m({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),s=this._checkWorkspaceRedo(e,t,i,!1);return s?s.returnValue:this._executeWorkspaceRedo(e,t,i)}_executeWorkspaceRedo(e,t,i){return kw(this,void 0,void 0,function*(){let s;try{s=yield this._invokeWorkspacePrepare(t)}catch(r){return this._onError(r,t)}const o=this._checkWorkspaceRedo(e,t,i,!0);if(o)return s.dispose(),o.returnValue;for(const r of i.editStacks)r.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,s,()=>this._continueRedoInGroup(t.groupId))})}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=m({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new _E([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[s,o]of this._editStacks){const r=o.getClosestFutureElement();r&&r.groupId===e&&(!t||r.groupOrder<t.groupOrder)&&(t=r,i=s)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof Aa){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[s,o]=this._findClosestRedoElementInGroup(i.groupId);if(i!==s&&o)return this._redo(o)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};bN=zxe([V8(0,_G),V8(1,Ln)],bN);class Iw{constructor(e){this.returnValue=e}}ht(KD,bN,1);function ho(n,e,t){return Math.min(Math.max(n,e),t)}class wG{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class $xe{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const CG=at("environmentService"),Sc=at("openerService");function s3(n,e){return je.isUri(n)?Pg(n.scheme,e):Q4(n,e+":")}function $8(n,...e){return e.some(t=>s3(n,t))}function Uxe(n){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(n.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},n=n.with({fragment:""})),{selection:e,uri:n}}var jxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},U8=function(n,e){return function(t,i){e(t,i,n)}};const SG=at("ILanguageFeatureDebounceService");var yx;(function(n){const e=new WeakMap;let t=0;function i(s){let o=e.get(s);return o===void 0&&(o=++t,e.set(s,o)),o}n.of=i})(yx||(yx={}));class qxe{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class Gxe{constructor(e,t,i,s,o,r){this._logService=e,this._name=t,this._registry=i,this._default=s,this._min=o,this._max=r,this._cache=new vP(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>MD(yx.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?ho(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let s=this._cache.get(i);s||(s=new $xe(6),this._cache.set(i,s));const o=ho(s.update(t),this._min,this._max);return s3(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${o}ms`),o}_overall(){const e=new wG;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return ho(e,this._min,this._max)}}let vN=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){var s,o,r;const a=(s=i==null?void 0:i.min)!==null&&s!==void 0?s:50,l=(o=i==null?void 0:i.max)!==null&&o!==void 0?o:Math.pow(a,2),c=(r=i==null?void 0:i.key)!==null&&r!==void 0?r:void 0,d=`${yx.of(e)},${a}${c?","+c:""}`;let u=this._data.get(d);return u||(this._isDev?u=new Gxe(this._logService,t,e,this._overallAverage()|0||a*1.5,a,l):(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),u=new qxe(a*1.5)),this._data.set(d,u)),u}_overallAverage(){const e=new wG;for(const t of this._data.values())e.update(t.default());return e.value}};vN=jxe([U8(0,yc),U8(1,CG)],vN);ht(SG,vN,1);var Kxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},bE=function(n,e){return function(t,i){e(t,i,n)}};let yN=class{constructor(e,t,i,s){this._legend=e,this._themeService=t,this._languageService=i,this._logService=s,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new Il}getMetadata(e,t,i){const s=this._languageService.languageIdCodec.encodeLanguageId(i),o=this._hashTable.get(e,t,s);let r;if(o)r=o.metadata,this._logService.getLevel()===wn.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${e} / ${t}: foreground ${Us.getForeground(r)}, fontStyle ${Us.getFontStyle(r).toString(2)}`);else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let u=0;c>0&&u<this._legend.tokenModifiers.length;u++)c&1&&l.push(this._legend.tokenModifiers[u]),c=c>>1;c>0&&this._logService.getLevel()===wn.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${t.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),l.push("not-in-legend"));const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")r=2147483647;else{if(r=0,typeof d.italic<"u"){const u=(d.italic?1:0)<<11;r|=u|1}if(typeof d.bold<"u"){const u=(d.bold?2:0)<<11;r|=u|2}if(typeof d.underline<"u"){const u=(d.underline?4:0)<<11;r|=u|4}if(typeof d.strikethrough<"u"){const u=(d.strikethrough?8:0)<<11;r|=u|8}if(d.foreground){const u=d.foreground<<15;r|=u|16}r===0&&(r=2147483647)}}else this._logService.getLevel()===wn.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${e} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),r=2147483647,a="not-in-legend";this._hashTable.add(e,t,s,r),this._logService.getLevel()===wn.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${e} (${a}) / ${t} (${l.join(" ")}): foreground ${Us.getForeground(r)}, fontStyle ${Us.getFontStyle(r).toString(2)}`)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,console.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,s,o){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,console.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${s} is outside the previous data (length ${o}).`))}};yN=Kxe([bE(1,ao),bE(2,Ai),bE(3,yc)],yN);class Yxe{constructor(e,t,i,s){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=s,this.next=null}}class Il{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=Il._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Il._SIZES.length?2/3*this._currentLength:0),this._elements=[],Il._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const s=this._hashFunc(e,t,i);let o=this._elements[s];for(;o;){if(o.tokenTypeIndex===e&&o.tokenModifierSet===t&&o.languageId===i)return o;o=o.next}return null}add(e,t,i,s){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const o=this._elements;this._currentLengthIndex++,this._currentLength=Il._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Il._SIZES.length?2/3*this._currentLength:0),this._elements=[],Il._nullOutEntries(this._elements,this._currentLength);for(const r of o){let a=r;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new Yxe(e,t,i,s))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}Il._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];const Zxe=at("semanticTokensStylingService");var Xxe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},vE=function(n,e){return function(t,i){e(t,i,n)}};let wN=class extends Y{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new yN(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};wN=Xxe([vE(0,ao),vE(1,yc),vE(2,Ai)],wN);ht(Zxe,wN,1);var j8=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Tw="**",q8="/",BC="[/\\\\]",WC="[^/\\\\]",Qxe=/\//g;function G8(n,e){switch(n){case 0:return"";case 1:return`${WC}*?`;default:return`(?:${BC}|${WC}+${BC}${e?`|${BC}${WC}+`:""})*?`}}function K8(n,e){if(!n)return[];const t=[];let i=!1,s=!1,o="";for(const r of n){switch(r){case e:if(!i&&!s){t.push(o),o="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":s=!0;break;case"]":s=!1;break}o+=r}return o&&t.push(o),t}function xG(n){if(!n)return"";let e="";const t=K8(n,q8);if(t.every(i=>i===Tw))e=".*";else{let i=!1;t.forEach((s,o)=>{if(s===Tw){if(i)return;e+=G8(2,o===t.length-1)}else{let r=!1,a="",l=!1,c="";for(const d of s){if(d!=="}"&&r){a+=d;continue}if(l&&(d!=="]"||!c)){let u;d==="-"?u=d:(d==="^"||d==="!")&&!c?u="^":d===q8?u="":u=br(d),c+=u;continue}switch(d){case"{":r=!0;continue;case"[":l=!0;continue;case"}":{const h=`(?:${K8(a,",").map(f=>xG(f)).join("|")})`;e+=h,r=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=WC;continue;case"*":e+=G8(1);continue;default:e+=br(d)}}o<t.length-1&&(t[o+1]!==Tw||o+2<t.length)&&(e+=BC)}i=s===Tw})}return e}const Jxe=/^\*\*\/\*\.[\w\.-]+$/,eLe=/^\*\*\/([\w\.-]+)\/?$/,tLe=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,iLe=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,nLe=/^\*\*((\/[\w\.-]+)+)\/?$/,sLe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,Y8=new vP(1e4),Z8=function(){return!1},Ga=function(){return null};function o3(n,e){if(!n)return Ga;let t;typeof n!="string"?t=n.pattern:t=n,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let s=Y8.get(i);if(s)return X8(s,n);let o;return Jxe.test(t)?s=oLe(t.substr(4),t):(o=eLe.exec(yE(t,e)))?s=rLe(o[1],t):(e.trimForExclusions?iLe:tLe).test(t)?s=aLe(t,e):(o=nLe.exec(yE(t,e)))?s=Q8(o[1].substr(1),t,!0):(o=sLe.exec(yE(t,e)))?s=Q8(o[1],t,!1):s=lLe(t),Y8.set(i,s),X8(s,n)}function X8(n,e){if(typeof e=="string")return n;const t=function(i,s){return sN(i,e.base,!Xn)?n(gD(i.substr(e.base.length),Sd),s):null};return t.allBasenames=n.allBasenames,t.allPaths=n.allPaths,t.basenames=n.basenames,t.patterns=n.patterns,t}function yE(n,e){return e.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function oLe(n,e){return function(t,i){return typeof t=="string"&&t.endsWith(n)?e:null}}function rLe(n,e){const t=`/${n}`,i=`\\${n}`,s=function(r,a){return typeof r!="string"?null:a?a===n?e:null:r===n||r.endsWith(t)||r.endsWith(i)?e:null},o=[n];return s.basenames=o,s.patterns=[e],s.allBasenames=o,s}function aLe(n,e){const t=DG(n.slice(1,-1).split(",").map(a=>o3(a,e)).filter(a=>a!==Ga),n),i=t.length;if(!i)return Ga;if(i===1)return t[0];const s=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return n;return null},o=t.find(a=>!!a.allBasenames);o&&(s.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(s.allPaths=r),s}function Q8(n,e,t){const i=Sd===Mi.sep,s=i?n:n.replace(Qxe,Sd),o=Sd+s,r=Mi.sep+n;let a;return t?a=function(l,c){return typeof l=="string"&&(l===s||l.endsWith(o)||!i&&(l===n||l.endsWith(r)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===s||!i&&l===n)?e:null},a.allPaths=[(t?"*/":"./")+n],a}function lLe(n){try{const e=new RegExp(`^${xG(n)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?n:null}}catch{return Ga}}function cLe(n,e,t){return!n||typeof e!="string"?!1:LG(n)(e,void 0,t)}function LG(n,e={}){if(!n)return Z8;if(typeof n=="string"||dLe(n)){const t=o3(n,e);if(t===Ga)return Z8;const i=function(s,o){return!!t(s,o)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return uLe(n,e)}function dLe(n){const e=n;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function uLe(n,e){const t=DG(Object.getOwnPropertyNames(n).map(a=>hLe(a,n[a],e)).filter(a=>a!==Ga)),i=t.length;if(!i)return Ga;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,u){let h;for(let f=0,g=t.length;f<g;f++){const p=t[f](d,u);if(typeof p=="string")return p;DT(p)&&(h||(h=[]),h.push(p))}return h?(()=>j8(this,void 0,void 0,function*(){for(const f of h){const g=yield f;if(typeof g=="string")return g}return null}))():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,u)=>u.allPaths?d.concat(u.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const s=function(a,l,c){let d,u;for(let h=0,f=t.length;h<f;h++){const g=t[h];g.requiresSiblings&&c&&(l||(l=VU(a)),d||(d=l.substr(0,l.length-kge(a).length)));const p=g(a,l,d,c);if(typeof p=="string")return p;DT(p)&&(u||(u=[]),u.push(p))}return u?(()=>j8(this,void 0,void 0,function*(){for(const h of u){const f=yield h;if(typeof f=="string")return f}return null}))():null},o=t.find(a=>!!a.allBasenames);o&&(s.allBasenames=o.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(s.allPaths=r),s}function hLe(n,e,t){if(e===!1)return Ga;const i=o3(n,t);if(i===Ga)return Ga;if(typeof e=="boolean")return i;if(e){const s=e.when;if(typeof s=="string"){const o=(r,a,l,c)=>{if(!c||!i(r,a))return null;const d=s.replace("$(basename)",()=>l),u=c(d);return DT(u)?u.then(h=>h?n:null):u?n:null};return o.requiresSiblings=!0,o}}return i}function DG(n,e){const t=n.filter(a=>!!a.basenames);if(t.length<2)return n;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let s;if(e){s=[];for(let a=0,l=i.length;a<l;a++)s.push(e)}else s=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const o=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const u=a.charCodeAt(d-1);if(u===47||u===92)break}l=a.substr(d)}const c=i.indexOf(l);return c!==-1?s[c]:null};o.basenames=i,o.patterns=s,o.allBasenames=i;const r=n.filter(a=>!a.basenames);return r.push(o),r}function kG(n,e,t,i,s,o){if(Array.isArray(n)){let r=0;for(const a of n){const l=kG(a,e,t,i,s,o);if(l===10)return l;l>r&&(r=l)}return r}else{if(typeof n=="string")return i?n==="*"?5:n===t?10:0:0;if(n){const{language:r,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=n;if(!i&&!c)return 0;d&&s&&(e=s);let u=0;if(l)if(l===e.scheme)u=10;else if(l==="*")u=5;else return 0;if(r)if(r===t)u=10;else if(r==="*")u=Math.max(u,5);else return 0;if(d)if(d===o)u=10;else if(d==="*"&&o!==void 0)u=Math.max(u,5);else return 0;if(a){let h;if(typeof a=="string"?h=a:h=Object.assign(Object.assign({},a),{base:WU(a.base)}),h===e.fsPath||cLe(h,e.fsPath))u=10;else return 0}return u}else return 0}}function EG(n){return typeof n=="string"?!1:Array.isArray(n)?n.every(EG):!!n.exclusive}class J8{constructor(e,t,i,s){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=s}equals(e){var t,i;return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&((t=this.notebookUri)===null||t===void 0?void 0:t.toString())===((i=e.notebookUri)===null||i===void 0?void 0:i.toString())}}class oi{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new B,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Ze(()=>{if(i){const s=this._entries.indexOf(i);s>=0&&(this._entries.splice(s,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,i=>t.push(i.provider)),t}orderedGroups(e){const t=[];let i,s;return this._orderedForEach(e,o=>{i&&s===o._score?i.push(o.provider):(s=o._score,i=[o.provider],t.push(i))}),t}_orderedForEach(e,t){this._updateScores(e);for(const i of this._entries)i._score>0&&t(i)}_updateScores(e){var t,i;const s=(t=this._notebookInfoResolver)===null||t===void 0?void 0:t.call(this,e.uri),o=s?new J8(e.uri,e.getLanguageId(),s.uri,s.type):new J8(e.uri,e.getLanguageId(),void 0,void 0);if(!(!((i=this._lastCandidate)===null||i===void 0)&&i.equals(o))){this._lastCandidate=o;for(const r of this._entries)if(r._score=kG(r.selector,o.uri,o.languageId,t_e(e),o.notebookUri,o.notebookType),EG(r.selector)&&r._score>0){for(const a of this._entries)a._score=0;r._score=1e3;break}this._entries.sort(oi._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:h_(e.selector)&&!h_(t.selector)?1:!h_(e.selector)&&h_(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function h_(n){return typeof n=="string"?!1:Array.isArray(n)?n.some(h_):!!n.isBuiltin}class fLe{constructor(){this.referenceProvider=new oi(this._score.bind(this)),this.renameProvider=new oi(this._score.bind(this)),this.codeActionProvider=new oi(this._score.bind(this)),this.definitionProvider=new oi(this._score.bind(this)),this.typeDefinitionProvider=new oi(this._score.bind(this)),this.declarationProvider=new oi(this._score.bind(this)),this.implementationProvider=new oi(this._score.bind(this)),this.documentSymbolProvider=new oi(this._score.bind(this)),this.inlayHintsProvider=new oi(this._score.bind(this)),this.colorProvider=new oi(this._score.bind(this)),this.codeLensProvider=new oi(this._score.bind(this)),this.documentFormattingEditProvider=new oi(this._score.bind(this)),this.documentRangeFormattingEditProvider=new oi(this._score.bind(this)),this.onTypeFormattingEditProvider=new oi(this._score.bind(this)),this.signatureHelpProvider=new oi(this._score.bind(this)),this.hoverProvider=new oi(this._score.bind(this)),this.documentHighlightProvider=new oi(this._score.bind(this)),this.selectionRangeProvider=new oi(this._score.bind(this)),this.foldingRangeProvider=new oi(this._score.bind(this)),this.linkProvider=new oi(this._score.bind(this)),this.inlineCompletionsProvider=new oi(this._score.bind(this)),this.completionProvider=new oi(this._score.bind(this)),this.linkedEditingRangeProvider=new oi(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new oi(this._score.bind(this)),this.documentSemanticTokensProvider=new oi(this._score.bind(this)),this.documentOnDropEditProvider=new oi(this._score.bind(this)),this.documentPasteEditProvider=new oi(this._score.bind(this))}_score(e){var t;return(t=this._notebookTypeResolver)===null||t===void 0?void 0:t.call(this,e)}}ht(nt,fLe,1);const AG=at("IWorkspaceEditService");class r3{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(Zh.is(t))return Zh.lift(t);if(xp.is(t))return xp.lift(t);throw new Error("Unsupported edit")})}}class Zh extends r3{static is(e){return e instanceof Zh?!0:Ls(e)&&je.isUri(e.resource)&&Ls(e.textEdit)}static lift(e){return e instanceof Zh?e:new Zh(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,s){super(s),this.resource=e,this.textEdit=t,this.versionId=i}}class xp extends r3{static is(e){return e instanceof xp?!0:Ls(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof xp?e:new xp(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},s){super(s),this.oldResource=e,this.newResource=t,this.options=i}}const Un={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0},gLe=Object.freeze({id:"editor",order:5,type:"object",title:m("editorConfigurationTitle","Editor"),scope:5}),wx=Object.assign(Object.assign({},gLe),{properties:{"editor.tabSize":{type:"number",default:An.tabSize,minimum:1,markdownDescription:m("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:m("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:An.insertSpaces,markdownDescription:m("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:An.detectIndentation,markdownDescription:m("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:An.trimAutoWhitespace,description:m("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:An.largeFileOptimizations,description:m("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:m("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[m("wordBasedSuggestionsMode.currentDocument","Only suggest words from the active document."),m("wordBasedSuggestionsMode.matchingDocuments","Suggest words from all open documents of the same language."),m("wordBasedSuggestionsMode.allDocuments","Suggest words from all open documents.")],description:m("wordBasedSuggestionsMode","Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[m("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),m("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),m("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:m("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:m("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:m("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!1,description:m("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:m("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:m("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:m("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:m("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:m("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:m("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:m("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:m("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:Un.maxComputationTime,description:m("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:Un.maxFileSize,description:m("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:Un.renderSideBySide,description:m("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:Un.renderSideBySideInlineBreakpoint,description:m("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:Un.useInlineViewWhenSpaceIsLimited,description:m("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:Un.renderMarginRevertIcon,description:m("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:Un.ignoreTrimWhitespace,description:m("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:Un.renderIndicators,description:m("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:Un.diffCodeLens,description:m("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:Un.diffWordWrap,markdownEnumDescriptions:[m("wordWrap.off","Lines will never wrap."),m("wordWrap.on","Lines will wrap at the viewport width."),m("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:Un.diffAlgorithm,markdownEnumDescriptions:[m("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),m("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:Un.hideUnchangedRegions.enabled,markdownDescription:m("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:Un.hideUnchangedRegions.revealLineCount,markdownDescription:m("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:Un.hideUnchangedRegions.minimumLineCount,markdownDescription:m("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:Un.hideUnchangedRegions.contextLineCount,markdownDescription:m("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:Un.experimental.showMoves,markdownDescription:m("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:Un.experimental.showEmptyDecorations,description:m("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")}}});function pLe(n){return typeof n.type<"u"||typeof n.anyOf<"u"}for(const n of Rg){const e=n.schema;if(typeof e<"u")if(pLe(e))wx.properties[`editor.${n.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(wx.properties[t]=e[t])}let Nw=null;function IG(){return Nw===null&&(Nw=Object.create(null),Object.keys(wx.properties).forEach(n=>{Nw[n]=!0})),Nw}function mLe(n){return IG()[`editor.${n}`]||!1}function _Le(n){return IG()[`diffEditor.${n}`]||!1}const bLe=mn.as(zf.Configuration);bLe.registerConfiguration(wx);class vLe{static insert(e,t){return{range:new N(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function wE(n){return Object.isFrozen(n)?n:Xhe(n)}class En{constructor(e={},t=[],i=[],s){this._contents=e,this._keys=t,this._overrides=i,this.raw=s,this.overrideConfigurations=new Map}get rawConfiguration(){var e;if(!this._rawConfiguration)if(!((e=this.raw)===null||e===void 0)&&e.length){const t=this.raw.map(i=>{if(i instanceof En)return i;const s=new yLe("");return s.parseRaw(i),s.configurationModel});this._rawConfiguration=t.reduce((i,s)=>s===i?s:i.merge(s),t[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?B9(this.contents,e):this.contents}inspect(e,t){const i=this.rawConfiguration.getValue(e),s=t?this.rawConfiguration.getOverrideValue(e,t):void 0,o=t?this.rawConfiguration.override(t).getValue(e):i;return{value:i,override:s,merged:o}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?B9(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){var t,i;const s=kl(this.contents),o=kl(this.overrides),r=[...this.keys],a=!((t=this.raw)===null||t===void 0)&&t.length?[...this.raw]:[this];for(const l of e)if(a.push(...!((i=l.raw)===null||i===void 0)&&i.length?l.raw:[l]),!l.isEmpty()){this.mergeContents(s,l.contents);for(const c of l.overrides){const[d]=o.filter(u=>Ki(u.identifiers,c.identifiers));d?(this.mergeContents(d.contents,c.contents),d.keys.push(...c.keys),d.keys=uf(d.keys)):o.push(kl(c))}for(const c of l.keys)r.indexOf(c)===-1&&r.push(c)}return new En(s,r,o,a.every(l=>l instanceof En)?void 0:a)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const s of uf([...Object.keys(this.contents),...Object.keys(t)])){let o=this.contents[s];const r=t[s];r&&(typeof o=="object"&&typeof r=="object"?(o=kl(o),this.mergeContents(o,r)):o=r),i[s]=o}return new En(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Ls(e[i])&&Ls(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=kl(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const s=o=>{o&&(i?this.mergeContents(i,o):i=kl(o))};for(const o of this.overrides)o.identifiers.length===1&&o.identifiers[0]===e?t=o.contents:o.identifiers.includes(e)&&s(o.contents);return s(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),m0e(this.contents,e),iu.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>Ki(i.identifiers,qS(e))),1))}updateValue(e,t,i){Fj(this.contents,e,t,s=>console.error(s)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),iu.test(e)&&this.overrides.push({identifiers:qS(e),keys:Object.keys(this.contents[e]),contents:AT(this.contents[e],s=>console.error(s))})}}class yLe{constructor(e){this._name=e,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||new En}parseRaw(e,t){this._raw=e;const{contents:i,keys:s,overrides:o,restricted:r,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new En(i,s,o,a?[e]:void 0),this._restrictedConfigurations=r||[]}doParseRaw(e,t){const i=mn.as(zf.Configuration).getConfigurationProperties(),s=this.filter(e,i,!0,t);e=s.raw;const o=AT(e,l=>console.error(`Conflict in settings file ${this._name}: ${l}`)),r=Object.keys(e),a=this.toOverrides(e,l=>console.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:o,keys:r,overrides:a,restricted:s.restricted,hasExcludedProperties:s.hasExcludedProperties}}filter(e,t,i,s){var o,r,a;let l=!1;if(!(s!=null&&s.scopes)&&!(s!=null&&s.skipRestricted)&&!(!((o=s==null?void 0:s.exclude)===null||o===void 0)&&o.length))return{raw:e,restricted:[],hasExcludedProperties:l};const c={},d=[];for(const u in e)if(iu.test(u)&&i){const h=this.filter(e[u],t,!1,s);c[u]=h.raw,l=l||h.hasExcludedProperties,d.push(...h.restricted)}else{const h=t[u],f=h?typeof h.scope<"u"?h.scope:3:void 0;h!=null&&h.restricted&&d.push(u),!(!((r=s.exclude)===null||r===void 0)&&r.includes(u))&&(!((a=s.include)===null||a===void 0)&&a.includes(u)||(f===void 0||s.scopes===void 0||s.scopes.includes(f))&&!(s.skipRestricted&&(h!=null&&h.restricted)))?c[u]=e[u]:l=!0}return{raw:c,restricted:d,hasExcludedProperties:l}}toOverrides(e,t){const i=[];for(const s of Object.keys(e))if(iu.test(s)){const o={};for(const r in e[s])o[r]=e[s][r];i.push({identifiers:qS(s),keys:Object.keys(o),contents:AT(o,t)})}return i}}class wLe{constructor(e,t,i,s,o,r,a,l,c,d,u,h,f){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=s,this.defaultConfiguration=o,this.policyConfiguration=r,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=u,this.folderConfigurationModel=h,this.memoryConfigurationModel=f}inspect(e,t,i){const s=e.inspect(t,i);return{get value(){return wE(s.value)},get override(){return wE(s.override)},get merged(){return wE(s.merged)}}}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.inspect(this.userConfiguration,this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.userInspectValue.value!==void 0||this.userInspectValue.override!==void 0?{value:this.userInspectValue.value,override:this.userInspectValue.override}:void 0}}class ZD{constructor(e,t,i,s,o=new En,r=new En,a=new In,l=new En,c=new In){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=s,this._remoteUserConfiguration=o,this._workspaceConfiguration=r,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new In,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let s;i.resource?(s=this._memoryConfigurationByResource.get(i.resource),s||(s=new En,this._memoryConfigurationByResource.set(i.resource,s))):s=this._memoryConfiguration,t===void 0?s.removeValue(e):s.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const s=this.getConsolidatedConfigurationModel(e,t,i),o=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of s.overrides)for(const c of l.identifiers)s.getOverrideValue(e,c)!==void 0&&a.add(c);return new wLe(e,t,s.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,o||void 0,r)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let s=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(s=s.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(s=s.merge(this._policyConfiguration)),s}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const s=t.getFolder(e);s&&(i=this.getFolderConsolidatedConfiguration(s.uri)||i);const o=this._memoryConfigurationByResource.get(e);o&&(i=i.merge(o))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),s=this._folderConfigurations.get(e);s?(t=i.merge(s),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:s,keys:o}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:s,keys:o}]),e},[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.policy),s=this.parseConfigurationModel(e.application),o=this.parseConfigurationModel(e.user),r=this.parseConfigurationModel(e.workspace),a=e.folders.reduce((l,c)=>(l.set(je.revive(c[0]),this.parseConfigurationModel(c[1])),l),new In);return new ZD(t,i,s,o,new En,r,a,new En,new In)}static parseConfigurationModel(e){return new En(e.contents,e.keys,e.overrides)}}class CLe{constructor(e,t,i,s){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=".".charCodeAt(0),this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const r of o)this.affectedKeys.add(r);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=ZD.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var i;const s=this._marker+e,o=this._affectsConfigStr.indexOf(s);if(o<0)return!1;const r=o+s.length;if(r>=this._affectsConfigStr.length)return!1;const a=this._affectsConfigStr.charCodeAt(r);if(a!==this._markerCode1&&a!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(i=this.previous)===null||i===void 0?void 0:i.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!So(l,c)}return!0}}const Cx={kind:0},SLe={kind:1};function xLe(n,e,t){return{kind:2,commandId:n,commandArgs:e,isBubble:t}}class j_{constructor(e,t,i){var s;this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const o of e){const r=o.command;r&&r.charAt(0)!=="-"&&this._defaultBoundCommands.set(r,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=j_.handleRemovals([].concat(e).concat(t));for(let o=0,r=this._keybindings.length;o<r;o++){const a=this._keybindings[o];if(a.chords.length===0)continue;const l=(s=a.when)===null||s===void 0?void 0:s.substituteConstants();l&&l.type===0||this._addKeyPress(a.chords[0],a)}}static _isTargetedForRemoval(e,t,i){if(t){for(let s=0;s<t.length;s++)if(t[s]!==e.chords[s])return!1}return!(i&&i.type!==1&&(!e.when||!Lpe(i,e.when)))}static handleRemovals(e){const t=new Map;for(let s=0,o=e.length;s<o;s++){const r=e[s];if(r.command&&r.command.charAt(0)==="-"){const a=r.command.substring(1);t.has(a)?t.get(a).push(r):t.set(a,[r])}}if(t.size===0)return e;const i=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];if(!r.command||r.command.length===0){i.push(r);continue}if(r.command.charAt(0)==="-")continue;const a=t.get(r.command);if(!a||!r.isDefault){i.push(r);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(r,c.chords,d)){l=!0;break}}if(!l){i.push(r);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.command===t.command)continue;let r=!0;for(let a=1;a<o.chords.length&&a<t.chords.length;a++)if(o.chords[a]!==t.chords[a]){r=!1;break}r&&j_.whenIsEntirelyIncluded(o.when,t.when)&&this._removeFromLookupMap(o)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,s=t.length;i<s;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:yT(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let s=i.length-1;s>=0;s--){const o=i[s];if(t.contextMatchesRules(o.when))return o}return i[i.length-1]}resolve(e,t,i){const s=[...t,i];this._log(`| Resolving ${s}`);const o=this._map.get(s[0]);if(o===void 0)return this._log("\\ No keybinding entries."),Cx;let r=null;if(s.length<2)r=o;else{r=[];for(let l=0,c=o.length;l<c;l++){const d=o[l];if(s.length>d.chords.length)continue;let u=!0;for(let h=1;h<s.length;h++)if(d.chords[h]!==s[h]){u=!1;break}u&&r.push(d)}}const a=this._findCommand(e,r);return a?s.length<a.chords.length?(this._log(`\\ From ${r.length} keybinding entries, awaiting ${a.chords.length-s.length} more chord(s), when: ${e6(a.when)}, source: ${t6(a)}.`),SLe):(this._log(`\\ From ${r.length} keybinding entries, matched ${a.command}, when: ${e6(a.when)}, source: ${t6(a)}.`),xLe(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),Cx)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const s=t[i];if(j_._contextMatchesRules(e,s.when))return s}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function e6(n){return n?`${n.serialize()}`:"no when condition"}function t6(n){return n.extensionId?n.isBuiltinExtension?`built-in extension ${n.extensionId}`:`user extension ${n.extensionId}`:n.isDefault?"built-in":"user"}const LLe=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class DLe extends Y{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:ue.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,s,o){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=s,this._logService=o,this._onDidUpdateKeybindings=this._register(new B),this._currentChords=[],this._currentChordChecker=new sy,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=Yg.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new Cc,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),Cx;const[s]=i.getDispatchChords();if(s===null)return this._log("\\ Keyboard event cannot be dispatched"),Cx;const o=this._contextKeyService.getContext(t),r=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(o,r,s)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw U4("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(m("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:s})=>s).join(", ");this._currentChordStatusMessage=this._notificationService.status(m("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),R_.enabled&&R_.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],R_.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[s]=i.getSingleModifierDispatchChords();if(s)return this._ignoreSingleModifiers.has(s)?(this._log(`+ Ignoring single modifier ${s} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=Yg.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=Yg.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${s}.`),this._currentSingleModifier=s,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):s===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${s} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${s}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[o]=i.getChords();return this._ignoreSingleModifiers=new Yg(o),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){var s;let o=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let r=null,a=null;if(i){const[u]=e.getSingleModifierDispatchChords();r=u,a=u?[u]:[]}else[r]=e.getDispatchChords(),a=this._currentChords.map(({keypress:u})=>u);if(r===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),o;const l=this._contextKeyService.getContext(t),c=e.getLabel(),d=this._getResolver().resolve(l,a,r);switch(d.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",c,"[ No matching keybinding ]"),this.inChordMode){const u=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${u}, ${c}".`),this._notificationService.status(m("missing.chord","The key combination ({0}, {1}) is not a command.",u,c),{hideAfter:10*1e3}),this._leaveChordMode(),o=!0}return o}case 1:return this._logService.trace("KeybindingService#dispatch",c,"[ Several keybindings match - more chords needed ]"),o=!0,this._expectAnotherChord(r,c),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),o;case 2:{if(this._logService.trace("KeybindingService#dispatch",c,`[ Will dispatch command ${d.commandId} ]`),d.commandId===null||d.commandId===""){if(this.inChordMode){const u=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${u}, ${c}".`),this._notificationService.status(m("missing.chord","The key combination ({0}, {1}) is not a command.",u,c),{hideAfter:10*1e3}),this._leaveChordMode(),o=!0}}else this.inChordMode&&this._leaveChordMode(),d.isBubble||(o=!0),this._log(`+ Invoking command ${d.commandId}.`),typeof d.commandArgs>"u"?this._commandService.executeCommand(d.commandId).then(void 0,u=>this._notificationService.warn(u)):this._commandService.executeCommand(d.commandId,d.commandArgs).then(void 0,u=>this._notificationService.warn(u)),LLe.test(d.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:d.commandId,from:"keybinding",detail:(s=e.getUserSettingsLabel())!==null&&s!==void 0?s:void 0});return o}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}class Yg{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}Yg.EMPTY=new Yg(null);class i6{constructor(e,t,i,s,o,r,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?CN(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=CN(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=s,this.isDefault=o,this.extensionId=r,this.isBuiltinExtension=a}}function CN(n){const e=[];for(let t=0,i=n.length;t<i;t++){const s=n[t];if(!s)return[];e.push(s)}return e}class XD{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const s=[];for(let o=0,r=t.length;o<r;o++){const a=t[o],l=i(a);if(l===null)return null;s[o]=ILe(a,l,this.modifierLabels[e])}return s.join(" ")}}const a3=new XD({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:m({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),kLe=new XD({ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:m({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:m({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:m({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:m({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:m({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),ELe=new XD({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),ALe=new XD({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function ILe(n,e,t){if(e===null)return"";const i=[];return n.ctrlKey&&i.push(t.ctrlKey),n.shiftKey&&i.push(t.shiftKey),n.altKey&&i.push(t.altKey),n.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class TLe extends kpe{constructor(e,t){if(super(),t.length===0)throw ic("chords");this._os=e,this._chords=t}getLabel(){return a3.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return kLe.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:ELe.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return ALe.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new Dpe(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class pv extends TLe{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return Fl.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":Fl.toString(e.keyCode)}_getElectronAccelerator(e){return Fl.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=Fl.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return pv.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Fl.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=Y4[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof ff)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new ff(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=CN(e.chords.map(s=>this._toKeyCodeChord(s)));return i.length>0?[new pv(i,t)]:[]}}const QD=at("labelService"),NLe=at("progressService");class Lp{constructor(e,t){this.callback=e,this.report=t!=null&&t.async?this._reportAsync.bind(this):this._reportSync.bind(this)}_reportSync(e){this._value=e,this.callback(this._value)}_reportAsync(e){Promise.resolve(this._lastTask).finally(()=>{this._value=e;const t=this.callback(this._value);this._lastTask=Promise.resolve(t).finally(()=>this._lastTask=void 0)})}}Lp.None=Object.freeze({report(){}});const gy=at("editorProgressService");class RLe{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class MLe{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?X4(e,this._value,0,e.length,this._from,this._to):ty(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class PLe{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?X4(e,this._value,0,e.length,this._from,this._to):ty(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class OLe{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new PLe(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return u9(e,this._value.scheme);if(this._states[this._stateIdx]===2)return u9(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return Ob(e,this._value.query);if(this._states[this._stateIdx]===5)return Ob(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class Rw{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e,t;return(t=(e=this.left)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get heightRight(){var e,t;return(t=(e=this.right)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}}class q_{static forUris(e=()=>!1,t=()=>!1){return new q_(new OLe(e,t))}static forStrings(){return new q_(new RLe)}static forConfigKeys(){return new q_(new MLe)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let s;this._root||(this._root=new Rw,this._root.segment=i.value());const o=[];for(s=this._root;;){const a=i.cmp(s.segment);if(a>0)s.left||(s.left=new Rw,s.left.segment=i.value()),o.push([-1,s]),s=s.left;else if(a<0)s.right||(s.right=new Rw,s.right.segment=i.value()),o.push([1,s]),s=s.right;else if(i.hasNext())i.next(),s.mid||(s.mid=new Rw,s.mid.segment=i.value()),o.push([0,s]),s=s.mid;else break}const r=s.value;s.value=t,s.key=e;for(let a=o.length-1;a>=0;a--){const l=o[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const d=o[a][0],u=o[a+1][0];if(d===1&&u===1)o[a][1]=l.rotateLeft();else if(d===-1&&u===-1)o[a][1]=l.rotateRight();else if(d===1&&u===-1)l.right=o[a+1][1]=o[a+1][1].rotateRight(),o[a][1]=l.rotateLeft();else if(d===-1&&u===1)l.left=o[a+1][1]=o[a+1][1].rotateLeft(),o[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}return r}get(e){var t;return(t=this._getNode(e))===null||t===void 0?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){var i;const s=this._iter.reset(e),o=[];let r=this._root;for(;r;){const a=s.cmp(r.segment);if(a>0)o.push([-1,r]),r=r.left;else if(a<0)o.push([1,r]),r=r.right;else if(s.hasNext())s.next(),o.push([0,r]),r=r.mid;else break}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const a=this._min(r.right);if(a.key){const{key:l,value:c,segment:d}=a;this._delete(a.key,!1),r.key=l,r.value=c,r.segment=d}}else{const a=(i=r.left)!==null&&i!==void 0?i:r.right;if(o.length>0){const[l,c]=o[o.length-1];switch(l){case-1:c.left=a;break;case 0:c.mid=a;break;case 1:c.right=a;break}}else this._root=a}for(let a=o.length-1;a>=0;a--){const l=o[a][1];l.updateHeight();const c=l.balanceFactor();if(c>1?(l.right.balanceFactor()>=0||(l.right=l.right.rotateRight()),o[a][1]=l.rotateLeft()):c<-1&&(l.left.balanceFactor()<=0||(l.left=l.left.rotateLeft()),o[a][1]=l.rotateRight()),a>0)switch(o[a-1][0]){case-1:o[a-1][1].left=o[a][1];break;case 1:o[a-1][1].right=o[a][1];break;case 0:o[a-1][1].mid=o[a][1];break}else this._root=o[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,s;for(;i;){const o=t.cmp(i.segment);if(o>0)i=i.left;else if(o<0)i=i.right;else if(t.hasNext())t.next(),s=i.value||s,i=i.mid;else break}return i&&i.value||s}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let s=this._root;for(;s;){const o=i.cmp(s.segment);if(o>0)s=s.left;else if(o<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else return s.mid?this._entries(s.mid):t?s.value:void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const FLe=at("contextService");class BLe{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const WLe="code-workspace";m("codeWorkspace","Code Workspace");const VLe="4064f6ec-cb38-4ad0-af64-ee6467e63c82";var n6;(function(n){n.inspectTokensAction=m("inspectTokens","Developer: Inspect Tokens")})(n6||(n6={}));var s6;(function(n){n.gotoLineActionLabel=m("gotoLineActionLabel","Go to Line/Column...")})(s6||(s6={}));var o6;(function(n){n.helpQuickAccessActionLabel=m("helpQuickAccess","Show all Quick Access Providers")})(o6||(o6={}));var r6;(function(n){n.quickCommandActionLabel=m("quickCommandActionLabel","Command Palette"),n.quickCommandHelp=m("quickCommandActionHelp","Show And Run Commands")})(r6||(r6={}));var a6;(function(n){n.quickOutlineActionLabel=m("quickOutlineActionLabel","Go to Symbol..."),n.quickOutlineByCategoryActionLabel=m("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(a6||(a6={}));var Sx;(function(n){n.editorViewAccessibleLabel=m("editorViewAccessibleLabel","Editor content"),n.accessibilityHelpMessage=m("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options.")})(Sx||(Sx={}));var l6;(function(n){n.toggleHighContrast=m("toggleHighContrast","Toggle High Contrast Theme")})(l6||(l6={}));var SN;(function(n){n.bulkEditServiceSummary=m("bulkEditServiceSummary","Made {0} edits in {1} files")})(SN||(SN={}));const zLe=at("workspaceTrustManagementService"),Eu=at("contextViewService"),Au=at("contextMenuService");var Dn;(function(n){function e(o,r){if(o.start>=r.end||r.start>=o.end)return{start:0,end:0};const a=Math.max(o.start,r.start),l=Math.min(o.end,r.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=e;function t(o){return o.end-o.start<=0}n.isEmpty=t;function i(o,r){return!t(e(o,r))}n.intersects=i;function s(o,r){const a=[],l={start:o.start,end:Math.min(r.start,o.end)},c={start:Math.max(r.end,o.start),end:o.end};return t(l)||a.push(l),t(c)||a.push(c),a}n.relativeComplement=s})(Dn||(Dn={}));function HLe(n){const e=n;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var gd;(function(n){n[n.AVOID=0]="AVOID",n[n.ALIGN=1]="ALIGN"})(gd||(gd={}));function Zg(n,e,t){const i=t.mode===gd.ALIGN?t.offset:t.offset+t.size,s=t.mode===gd.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=n-i?i:e<=s?s-e:Math.max(n-e,0):e<=s?s-e:e<=n-i?i:0}class Tm extends Y{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=Y.None,this.toDisposeOnSetContainer=Y.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=we(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,sd(this.view),this.setContainer(e,t),this._register(Ze(()=>this.setContainer(null,1)))}setContainer(e,t){var i;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(i=this.shadowRootHostElement)===null||i===void 0||i.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=t!==1,this.useShadowDOM=t===3,this.useShadowDOM){this.shadowRootHostElement=we(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const o=document.createElement("style");o.textContent=$Le,this.shadowRoot.appendChild(o),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(we("slot"))}else this.container.appendChild(this.view);const s=new pe;Tm.BUBBLE_UP_EVENTS.forEach(o=>{s.add(Hi(this.container,o,r=>{this.onDOMEvent(r,!1)}))}),Tm.BUBBLE_DOWN_EVENTS.forEach(o=>{s.add(Hi(this.container,o,r=>{this.onDOMEvent(r,!0)},!0))}),this.toDisposeOnSetContainer=s}}show(e){var t,i;this.isVisible()&&this.hide(),Lo(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2575",this.view.style.position=this.useFixedPosition?"fixed":"absolute",Uh(this.view),this.toDisposeOnClean=e.render(this.view)||Y.None,this.delegate=e,this.doLayout(),(i=(t=this.delegate).focus)===null||i===void 0||i.call(t)}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Qd&&dP.pointerEvents)){this.hide();return}this.delegate.layout&&this.delegate.layout(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(hP(e)){const u=Nn(e),h=_me(e);t={top:u.top*h,left:u.left*h,width:u.width*h,height:u.height*h}}else HLe(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=ys(this.view),s=wh(this.view),o=this.delegate.anchorPosition||0,r=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;if(a===0){const u={offset:t.top-window.pageYOffset,size:t.height,position:o===0?0:1},h={offset:t.left,size:t.width,position:r===0?0:1,mode:gd.ALIGN};l=Zg(window.innerHeight,s,u)+window.pageYOffset,Dn.intersects({start:l,end:l+s},{start:u.offset,end:u.offset+u.size})&&(h.mode=gd.AVOID),c=Zg(window.innerWidth,i,h)}else{const u={offset:t.left,size:t.width,position:r===0?0:1},h={offset:t.top,size:t.height,position:o===0?0:1,mode:gd.ALIGN};c=Zg(window.innerWidth,i,u),Dn.intersects({start:c,end:c+i},{start:u.offset,end:u.offset+u.size})&&(h.mode=gd.AVOID),l=Zg(window.innerHeight,s,h)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(o===0?"bottom":"top"),this.view.classList.add(r===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const d=Nn(this.container);this.view.style.top=`${l-(this.useFixedPosition?Nn(this.view).top:d.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?Nn(this.view).left:d.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),sd(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!Cn(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}Tm.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"];Tm.BUBBLE_DOWN_EVENTS=["click"];const $Le=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var ULe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},jLe=function(n,e){return function(t,i){e(t,i,n)}};let xN=class extends Y{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=Y.None,this.container=e.hasContainer?e.container:null,this.contextView=this._register(new Tm(this.container,1)),this.layout(),this._register(e.onDidLayout(()=>this.layout()))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,i){t?(t!==this.container||this.shadowRoot!==i)&&(this.container=t,this.setContainer(t,i?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.shadowRoot=i,this.contextView.show(e);const s=Ze(()=>{this.currentViewDisposable===s&&this.hideContextView()});return this.currentViewDisposable=s,s}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};xN=ULe([jLe(0,s0)],xN);let Nm=[],l3=[],TG=[];function Mw(n,e=!1){qLe(n,!1,e)}function qLe(n,e,t){const i=GLe(n,e);Nm.push(i),i.userConfigured?TG.push(i):l3.push(i),t&&!i.userConfigured&&Nm.forEach(s=>{s.mime===i.mime||s.userConfigured||(i.extension&&s.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&s.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&s.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&s.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function GLe(n,e){return{id:n.id,mime:n.mime,filename:n.filename,extension:n.extension,filepattern:n.filepattern,firstline:n.firstline,userConfigured:e,filenameLowercase:n.filename?n.filename.toLowerCase():void 0,extensionLowercase:n.extension?n.extension.toLowerCase():void 0,filepatternLowercase:n.filepattern?LG(n.filepattern.toLowerCase()):void 0,filepatternOnPath:n.filepattern?n.filepattern.indexOf(Mi.sep)>=0:!1}}function KLe(){Nm=Nm.filter(n=>n.userConfigured),l3=[]}function YLe(n,e){return ZLe(n,e).map(t=>t.id)}function ZLe(n,e){let t;if(n)switch(n.scheme){case it.file:t=n.fsPath;break;case it.data:{t=hx.parseMetaData(n).get(hx.META_DATA_LABEL);break}case it.vscodeNotebookCell:t=void 0;break;default:t=n.path}if(!t)return[{id:"unknown",mime:Vl.unknown}];t=t.toLowerCase();const i=VU(t),s=c6(t,i,TG);if(s)return[s,{id:zo,mime:Vl.text}];const o=c6(t,i,l3);if(o)return[o,{id:zo,mime:Vl.text}];if(e){const r=XLe(e);if(r)return[r,{id:zo,mime:Vl.text}]}return[{id:"unknown",mime:Vl.unknown}]}function c6(n,e,t){var i;let s,o,r;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){s=l;break}if(l.filepattern&&(!o||l.filepattern.length>o.filepattern.length)){const c=l.filepatternOnPath?n:e;!((i=l.filepatternLowercase)===null||i===void 0)&&i.call(l,c)&&(o=l)}l.extension&&(!r||l.extension.length>r.extension.length)&&e.endsWith(l.extensionLowercase)&&(r=l)}if(s)return s;if(o)return o;if(r)return r}function XLe(n){if(sP(n)&&(n=n.substr(1)),n.length>0)for(let e=Nm.length-1;e>=0;e--){const t=Nm[e];if(!t.firstline)continue;const i=n.match(t.firstline);if(i&&i.length>0)return t}}const Pw=Object.prototype.hasOwnProperty,d6="vs.editor.nullLanguage";class QLe{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(d6,0),this._register(zo,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||d6}}class mv extends Y{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,mv.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new QLe,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(vm.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){mv.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},KLe();const e=[].concat(vm.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(s=>{this._lowercaseNameMap[s.toLowerCase()]=i.identifier}),i.mimetypes.forEach(s=>{this._mimeTypesMap[s]=i.identifier})}),mn.as(zf.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;Pw.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let s=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),s=t.mimetypes[0]),s||(s=`text/x-${i}`,e.mimetypes.push(s)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)Mw({id:i,mime:s,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)Mw({id:i,mime:s,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)Mw({id:i,mime:s,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);qge(l)||Mw({id:i,mime:s,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let o=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?o=[null]:o=t.aliases),o!==null)for(const a of o)!a||a.length===0||e.aliases.push(a);const r=o!==null&&o.length>0;if(!(r&&o[0]===null)){const a=(r?o[0]:null)||i;(r||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?Pw.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return Pw.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&Pw.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:YLe(e,t)}}mv.instanceCount=0;class _v extends Y{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new B),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new B),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new B({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,_v.instanceCount++,this._registry=this._register(new mv(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){_v.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return pU(i,null)}createById(e){return new u6(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new u6(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=zo),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),Si.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}}_v.instanceCount=0;class u6{constructor(e,t){this._onDidChangeLanguages=e,this._selector=t,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages(()=>this._evaluate())),this._emitter||(this._emitter=new B({onDidRemoveLastListener:()=>{this._dispose()}})),this._emitter.event}_evaluate(){var e;const t=this._selector();t!==this.languageId&&(this.languageId=t,(e=this._emitter)===null||e===void 0||e.fire(this.languageId))}}const NG={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Vl.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"};function RG(...n){return function(e,t){for(let i=0,s=n.length;i<s;i++){const o=n[i](e,t);if(o)return o}return null}}MG.bind(void 0,!1);const xx=MG.bind(void 0,!0);function MG(n,e,t){if(!t||t.length<e.length)return null;let i;return n?i=Q4(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function JLe(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t===-1?null:[{start:t,end:t+n.length}]}function eDe(n,e){return LN(n.toLowerCase(),e.toLowerCase(),0,0)}function LN(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]===e[i]){let s=null;return(s=LN(n,e,t+1,i+1))?OG({start:i,end:i+1},s):null}return LN(n,e,t,i+1)}function c3(n){return 97<=n&&n<=122}function JD(n){return 65<=n&&n<=90}function d3(n){return 48<=n&&n<=57}function tDe(n){return n===32||n===9||n===10||n===13}const iDe=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(n=>iDe.add(n.charCodeAt(0)));function PG(n){return c3(n)||JD(n)||d3(n)}function OG(n,e){return e.length===0?e=[n]:n.end===e[0].start?e[0].start=n.start:e.unshift(n),e}function FG(n,e){for(let t=e;t<n.length;t++){const i=n.charCodeAt(t);if(JD(i)||d3(i)||t>0&&!PG(n.charCodeAt(t-1)))return t}return n.length}function DN(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]!==e[i].toLowerCase())return null;{let s=null,o=i+1;for(s=DN(n,e,t+1,i+1);!s&&(o=FG(e,o))<e.length;)s=DN(n,e,t+1,o),o++;return s===null?null:OG({start:i,end:i+1},s)}}function nDe(n){let e=0,t=0,i=0,s=0,o=0;for(let d=0;d<n.length;d++)o=n.charCodeAt(d),JD(o)&&e++,c3(o)&&t++,PG(o)&&i++,d3(o)&&s++;const r=e/n.length,a=t/n.length,l=i/n.length,c=s/n.length;return{upperPercent:r,lowerPercent:a,alphaPercent:l,numericPercent:c}}function sDe(n){const{upperPercent:e,lowerPercent:t}=n;return t===0&&e>.6}function oDe(n){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:s}=n;return t>.2&&e<.8&&i>.6&&s<.2}function rDe(n){let e=0,t=0,i=0,s=0;for(let o=0;o<n.length;o++)i=n.charCodeAt(o),JD(i)&&e++,c3(i)&&t++,tDe(i)&&s++;return(e===0||t===0)&&s===0?n.length<=30:e<=5}function BG(n,e){if(!e||(e=e.trim(),e.length===0)||!rDe(n)||e.length>60)return null;const t=nDe(e);if(!oDe(t)){if(!sDe(t))return null;e=e.toLowerCase()}let i=null,s=0;for(n=n.toLowerCase();s<e.length&&(i=DN(n,e,0,s))===null;)s=FG(e,s+1);return i}const aDe=RG(xx,BG,JLe),lDe=RG(xx,BG,eDe),h6=new vP(1e4);function f6(n,e,t=!1){if(typeof n!="string"||typeof e!="string")return null;let i=h6.get(n);i||(i=new RegExp(jge(n),"i"),h6.set(n,i));const s=i.exec(e);return s?[{start:s.index,end:s.index+s[0].length}]:t?lDe(n,e):aDe(n,e)}function cDe(n,e){const t=HG(n,n.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?u3(t):null}function u3(n){if(typeof n>"u")return[];const e=[],t=n[1];for(let i=n.length-1;i>1;i--){const s=n[i]+t,o=e[e.length-1];o&&o.end===s?o.end=s+1:e.push({start:s,end:s+1})}return e}const pd=128;function h3(){const n=[],e=[];for(let t=0;t<=pd;t++)e[t]=0;for(let t=0;t<=pd;t++)n.push(e.slice(0));return n}function WG(n){const e=[];for(let t=0;t<=n;t++)e[t]=0;return e}const VG=WG(2*pd),kN=WG(2*pd),_l=h3(),Uu=h3(),Ow=h3();function Fw(n,e){if(e<0||e>=n.length)return!1;const t=n.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!nP(t)}}function g6(n,e){if(e<0||e>=n.length)return!1;switch(n.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function VC(n,e,t){return e[n]!==t[n]}function dDe(n,e,t,i,s,o,r=!1){for(;e<t&&s<o;)n[e]===i[s]&&(r&&(VG[e]=s),e+=1),s+=1;return e===t}var Xh;(function(n){n.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}n.isDefault=e})(Xh||(Xh={}));class zG{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}}zG.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};function HG(n,e,t,i,s,o,r=zG.default){const a=n.length>pd?pd:n.length,l=i.length>pd?pd:i.length;if(t>=a||o>=l||a-t>l-o||!dDe(e,t,a,s,o,l,!0))return;uDe(a,l,t,o,e,s);let c=1,d=1,u=t,h=o;const f=[!1];for(c=1,u=t;u<a;c++,u++){const b=VG[u],y=kN[u],w=u+1<a?kN[u+1]:l;for(d=b-o+1,h=b;h<w;d++,h++){let C=Number.MIN_SAFE_INTEGER,L=!1;h<=y&&(C=hDe(n,e,u,t,i,s,h,l,o,_l[c-1][d-1]===0,f));let x=0;C!==Number.MAX_SAFE_INTEGER&&(L=!0,x=C+Uu[c-1][d-1]);const D=h>b,k=D?Uu[c][d-1]+(_l[c][d-1]>0?-5:0):0,P=h>b+1&&_l[c][d-1]>0,O=P?Uu[c][d-2]+(_l[c][d-2]>0?-5:0):0;if(P&&(!D||O>=k)&&(!L||O>=x))Uu[c][d]=O,Ow[c][d]=3,_l[c][d]=0;else if(D&&(!L||k>=x))Uu[c][d]=k,Ow[c][d]=2,_l[c][d]=0;else if(L)Uu[c][d]=x,Ow[c][d]=1,_l[c][d]=_l[c-1][d-1]+1;else throw new Error("not possible")}}if(!f[0]&&!r.firstMatchCanBeWeak)return;c--,d--;const g=[Uu[c][d],o];let p=0,_=0;for(;c>=1;){let b=d;do{const y=Ow[c][b];if(y===3)b=b-2;else if(y===2)b=b-1;else break}while(b>=1);p>1&&e[t+c-1]===s[o+d-1]&&!VC(b+o-1,i,s)&&p+1>_l[c][b]&&(b=d),b===d?p++:p=1,_||(_=b),c--,d=b-1,g.push(d)}l===a&&r.boostFullMatch&&(g[0]+=2);const v=_-a;return g[0]-=v,g}function uDe(n,e,t,i,s,o){let r=n-1,a=e-1;for(;r>=t&&a>=i;)s[r]===o[a]&&(kN[r]=a,r--),a--}function hDe(n,e,t,i,s,o,r,a,l,c,d){if(e[t]!==o[r])return Number.MIN_SAFE_INTEGER;let u=1,h=!1;return r===t-i?u=n[t]===s[r]?7:5:VC(r,s,o)&&(r===0||!VC(r-1,s,o))?(u=n[t]===s[r]?7:5,h=!0):Fw(o,r)&&(r===0||!Fw(o,r-1))?u=5:(Fw(o,r-1)||g6(o,r-1))&&(u=5,h=!0),u>1&&t===i&&(d[0]=!0),h||(h=VC(r,s,o)||Fw(o,r-1)||g6(o,r-1)),t===i?r>l&&(u-=h?3:5):c?u+=h?2:0:u+=h?0:1,r+1===a&&(u-=h?3:5),u}const fDe="$(",f3=new RegExp(`\\$\\(${Ne.iconNameExpression}(?:${Ne.iconModifierExpression})?\\)`,"g"),gDe=new RegExp(`(\\\\)?${f3.source}`,"g");function pDe(n){return n.replace(gDe,(e,t)=>t?e:`\\${e}`)}const mDe=new RegExp(`\\\\${f3.source}`,"g");function _De(n){return n.replace(mDe,e=>`\\${e}`)}const bDe=new RegExp(`(\\s)?(\\\\)?${f3.source}(\\s)?`,"g");function $G(n){return n.indexOf(fDe)===-1?n:n.replace(bDe,(e,t,i,s)=>i?e:t||s||"")}function vDe(n){return n?n.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const CE=new RegExp(`\\$\\(${Ne.iconNameCharacter}+\\)`,"g");function f_(n){CE.lastIndex=0;let e="";const t=[];let i=0;for(;;){const s=CE.lastIndex,o=CE.exec(n),r=n.substring(s,o==null?void 0:o.index);if(r.length>0){e+=r;for(let a=0;a<r.length;a++)t.push(i)}if(!o)break;i+=o[0].length}return{text:e,iconOffsets:t}}function SE(n,e,t=!1){const{text:i,iconOffsets:s}=e;if(!s||s.length===0)return f6(n,i,t);const o=gD(i," "),r=i.length-o.length,a=f6(n,o,t);if(a)for(const l of a){const c=s[l.start+r]+r;l.start+=c,l.end+=c}return a}class Rm{constructor(e="",t=!1){var i,s,o;if(this.value=e,typeof this.value!="string")throw ic("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=(i=t.isTrusted)!==null&&i!==void 0?i:void 0,this.supportThemeIcons=(s=t.supportThemeIcons)!==null&&s!==void 0?s:!1,this.supportHtml=(o=t.supportHtml)!==null&&o!==void 0?o:!1)}appendText(e,t=0){return this.value+=wDe(this.supportThemeIcons?pDe(e):e).replace(/([ \t]+)/g,(i,s)=>"&nbsp;".repeat(s.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+=`
`,this.value+=t,this.value+="\n```\n",this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(br(t),"g");return e.replace(i,(s,o)=>e.charAt(o-1)!=="\\"?`\\${s}`:s)}}function bv(n){return Ad(n)?!n.value:Array.isArray(n)?n.every(bv):!0}function Ad(n){return n instanceof Rm?!0:n&&typeof n=="object"?typeof n.value=="string"&&(typeof n.isTrusted=="boolean"||typeof n.isTrusted=="object"||n.isTrusted===void 0)&&(typeof n.supportThemeIcons=="boolean"||n.supportThemeIcons===void 0):!1}function yDe(n,e){return n===e?!0:!n||!e?!1:n.value===e.value&&n.isTrusted===e.isTrusted&&n.supportThemeIcons===e.supportThemeIcons&&n.supportHtml===e.supportHtml&&(n.baseUri===e.baseUri||!!n.baseUri&&!!e.baseUri&&jP(je.from(n.baseUri),je.from(e.baseUri)))}function wDe(n){return n.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function Bw(n){return n.replace(/"/g,"&quot;")}function xE(n){return n&&n.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function CDe(n){const e=[],t=n.split("|").map(s=>s.trim());n=t[0];const i=t[1];if(i){const s=/height=(\d+)/.exec(i),o=/width=(\d+)/.exec(i),r=s?s[1]:"",a=o?o[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(r));l&&e.push(`width="${a}"`),c&&e.push(`height="${r}"`)}return{href:n,dimensions:e}}var EN=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function SDe(n,e){Ns(e)?n.title=$G(e):e!=null&&e.markdownNotSupportedFallback?n.title=e.markdownNotSupportedFallback:n.removeAttribute("title")}class xDe{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}update(e,t,i){var s;return EN(this,void 0,void 0,function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let o;if(e===void 0||Ns(e)||e instanceof HTMLElement)o=e;else if(!AS(e.markdown))o=(s=e.markdown)!==null&&s!==void 0?s:e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(m("iconLabel.loading","Loading..."),t),this._cancellationTokenSource=new xr;const r=this._cancellationTokenSource.token;if(o=yield e.markdown(r),o===void 0&&(o=e.markdownNotSupportedFallback),this.isDisposed||r.isCancellationRequested)return}this.show(o,t,i)})}show(e,t,i){const s=this._hoverWidget;if(this.hasContent(e)){const o=Object.assign({content:e,target:this.target,showPointer:this.hoverDelegate.placement==="element",hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!s},i);this._hoverWidget=this.hoverDelegate.showHover(o,t)}s==null||s.dispose()}hasContent(e){return e?Ad(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)===null||e===void 0?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)===null||e===void 0||e.dispose(),(t=this._cancellationTokenSource)===null||t===void 0||t.dispose(!0),this._cancellationTokenSource=void 0}}function UG(n,e,t,i){let s,o;const r=(u,h)=>{var f;const g=o!==void 0;u&&(o==null||o.dispose(),o=void 0),h&&(s==null||s.dispose(),s=void 0),g&&((f=n.onDidHideHover)===null||f===void 0||f.call(n))},a=(u,h,f)=>new Cc(()=>EN(this,void 0,void 0,function*(){(!o||o.isDisposed)&&(o=new xDe(n,f||e,u>0),yield o.update(t,h,i))}),u),l=()=>{if(s)return;const u=new pe,h=p=>r(!1,p.fromElement===e);u.add(K(e,de.MOUSE_LEAVE,h,!0));const f=()=>r(!0,!0);u.add(K(e,de.MOUSE_DOWN,f,!0));const g={targetElements:[e],dispose:()=>{}};if(n.placement===void 0||n.placement==="mouse"){const p=_=>{g.x=_.x+10,_.target instanceof HTMLElement&&_.target.classList.contains("action-label")&&r(!0,!0)};u.add(K(e,de.MOUSE_MOVE,p,!0))}u.add(a(n.delay,!1,g)),s=u},c=K(e,de.MOUSE_OVER,l,!0);return{show:u=>{r(!1,!0),a(0,u)},hide:()=>{r(!0,!0)},update:(u,h)=>EN(this,void 0,void 0,function*(){t=u,yield o==null?void 0:o.update(t,void 0,h)}),dispose:()=>{c.dispose(),r(!0,!0)}}}function LDe(n,e={}){const t=g3(e);return t.textContent=n,t}function DDe(n,e={}){const t=g3(e);return jG(t,EDe(n,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function g3(n){const e=n.inline?"span":"div",t=document.createElement(e);return n.className&&(t.className=n.className),t}class kDe{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function jG(n,e,t,i){let s;if(e.type===2)s=document.createTextNode(e.content||"");else if(e.type===3)s=document.createElement("b");else if(e.type===4)s=document.createElement("i");else if(e.type===7&&i)s=document.createElement("code");else if(e.type===5&&t){const o=document.createElement("a");t.disposables.add(Hi(o,"click",r=>{t.callback(String(e.index),r)})),s=o}else e.type===8?s=document.createElement("br"):e.type===1&&(s=n);s&&n!==s&&n.appendChild(s),s&&Array.isArray(e.children)&&e.children.forEach(o=>{jG(s,o,t,i)})}function EDe(n,e){const t={type:1,children:[]};let i=0,s=t;const o=[],r=new kDe(n);for(;!r.eos();){let a=r.next();const l=a==="\\"&&AN(r.peek(),e)!==0;if(l&&(a=r.next()),!l&&ADe(a,e)&&a===r.peek()){r.advance(),s.type===2&&(s=o.pop());const c=AN(a,e);if(s.type===c||s.type===5&&c===6)s=o.pop();else{const d={type:c,children:[]};c===5&&(d.index=i,i++),s.children.push(d),o.push(s),s=d}}else if(a===`
`)s.type===2&&(s=o.pop()),s.children.push({type:8});else if(s.type!==2){const c={type:2,content:a};s.children.push(c),o.push(s),s=c}else s.content+=a}return s.type===2&&(s=o.pop()),t}function ADe(n,e){return AN(n,e)!==0}function AN(n,e){switch(n){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}const IDe=new RegExp(`(\\\\)?\\$\\((${Ne.iconNameExpression}(?:${Ne.iconModifierExpression})?)\\)`,"g");function Qh(n){const e=new Array;let t,i=0,s=0;for(;(t=IDe.exec(n))!==null;){s=t.index||0,i<s&&e.push(n.substring(i,s)),i=(t.index||0)+t[0].length;const[,o,r]=t;e.push(o?`$(${r})`:IN({id:r}))}return i<n.length&&e.push(n.substring(i)),e}function IN(n){const e=we("span");return e.classList.add(...Ne.asClassNameArray(n)),e}class p3{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const TN=new p3("id#");let gs={};(function(){function n(e,t){t(gs)}n.amd=!0,function(e,t){typeof n=="function"&&n.amd?n(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){function t(Z,j){for(var U=0;U<j.length;U++){var A=j[U];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(Z,A.key,A)}}function i(Z,j,U){return j&&t(Z.prototype,j),U&&t(Z,U),Object.defineProperty(Z,"prototype",{writable:!1}),Z}function s(Z,j){if(Z){if(typeof Z=="string")return o(Z,j);var U=Object.prototype.toString.call(Z).slice(8,-1);if(U==="Object"&&Z.constructor&&(U=Z.constructor.name),U==="Map"||U==="Set")return Array.from(Z);if(U==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(U))return o(Z,j)}}function o(Z,j){(j==null||j>Z.length)&&(j=Z.length);for(var U=0,A=new Array(j);U<j;U++)A[U]=Z[U];return A}function r(Z,j){var U=typeof Symbol<"u"&&Z[Symbol.iterator]||Z["@@iterator"];if(U)return(U=U.call(Z)).next.bind(U);if(Array.isArray(Z)||(U=s(Z))||j&&Z&&typeof Z.length=="number"){U&&(Z=U);var A=0;return function(){return A>=Z.length?{done:!0}:{done:!1,value:Z[A++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}e.defaults=a();function l(Z){e.defaults=Z}var c=/[&<>"']/,d=/[&<>"']/g,u=/[<>"']|&(?!#?\w+;)/,h=/[<>"']|&(?!#?\w+;)/g,f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},g=function(j){return f[j]};function p(Z,j){if(j){if(c.test(Z))return Z.replace(d,g)}else if(u.test(Z))return Z.replace(h,g);return Z}var _=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function v(Z){return Z.replace(_,function(j,U){return U=U.toLowerCase(),U==="colon"?":":U.charAt(0)==="#"?U.charAt(1)==="x"?String.fromCharCode(parseInt(U.substring(2),16)):String.fromCharCode(+U.substring(1)):""})}var b=/(^|[^\[])\^/g;function y(Z,j){Z=typeof Z=="string"?Z:Z.source,j=j||"";var U={replace:function(T,W){return W=W.source||W,W=W.replace(b,"$1"),Z=Z.replace(T,W),U},getRegex:function(){return new RegExp(Z,j)}};return U}var w=/[^\w:]/g,C=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function L(Z,j,U){if(Z){var A;try{A=decodeURIComponent(v(U)).replace(w,"").toLowerCase()}catch{return null}if(A.indexOf("javascript:")===0||A.indexOf("vbscript:")===0||A.indexOf("data:")===0)return null}j&&!C.test(U)&&(U=O(j,U));try{U=encodeURI(U).replace(/%25/g,"%")}catch{return null}return U}var x={},D=/^[^:]+:\/*[^/]*$/,k=/^([^:]+:)[\s\S]*$/,P=/^([^:]+:\/*[^/]*)[\s\S]*$/;function O(Z,j){x[" "+Z]||(D.test(Z)?x[" "+Z]=Z+"/":x[" "+Z]=G(Z,"/",!0)),Z=x[" "+Z];var U=Z.indexOf(":")===-1;return j.substring(0,2)==="//"?U?j:Z.replace(k,"$1")+j:j.charAt(0)==="/"?U?j:Z.replace(P,"$1")+j:Z+j}var M={exec:function(){}};function R(Z){for(var j=1,U,A;j<arguments.length;j++){U=arguments[j];for(A in U)Object.prototype.hasOwnProperty.call(U,A)&&(Z[A]=U[A])}return Z}function $(Z,j){var U=Z.replace(/\|/g,function(W,F,X){for(var ce=!1,Se=F;--Se>=0&&X[Se]==="\\";)ce=!ce;return ce?"|":" |"}),A=U.split(/ \|/),T=0;if(A[0].trim()||A.shift(),A.length>0&&!A[A.length-1].trim()&&A.pop(),A.length>j)A.splice(j);else for(;A.length<j;)A.push("");for(;T<A.length;T++)A[T]=A[T].trim().replace(/\\\|/g,"|");return A}function G(Z,j,U){var A=Z.length;if(A===0)return"";for(var T=0;T<A;){var W=Z.charAt(A-T-1);if(W===j&&!U)T++;else if(W!==j&&U)T++;else break}return Z.slice(0,A-T)}function ne(Z,j){if(Z.indexOf(j[1])===-1)return-1;for(var U=Z.length,A=0,T=0;T<U;T++)if(Z[T]==="\\")T++;else if(Z[T]===j[0])A++;else if(Z[T]===j[1]&&(A--,A<0))return T;return-1}function ae(Z){Z&&Z.sanitize&&!Z.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function fe(Z,j){if(j<1)return"";for(var U="";j>1;)j&1&&(U+=Z),j>>=1,Z+=Z;return U+Z}function oe(Z,j,U,A){var T=j.href,W=j.title?p(j.title):null,F=Z[1].replace(/\\([\[\]])/g,"$1");if(Z[0].charAt(0)!=="!"){A.state.inLink=!0;var X={type:"link",raw:U,href:T,title:W,text:F,tokens:A.inlineTokens(F)};return A.state.inLink=!1,X}return{type:"image",raw:U,href:T,title:W,text:p(F)}}function xe(Z,j){var U=Z.match(/^(\s+)(?:```)/);if(U===null)return j;var A=U[1];return j.split(`
`).map(function(T){var W=T.match(/^\s+/);if(W===null)return T;var F=W[0];return F.length>=A.length?T.slice(A.length):T}).join(`
`)}var Te=function(){function Z(U){this.options=U||e.defaults}var j=Z.prototype;return j.space=function(A){var T=this.rules.block.newline.exec(A);if(T&&T[0].length>0)return{type:"space",raw:T[0]}},j.code=function(A){var T=this.rules.block.code.exec(A);if(T){var W=T[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:T[0],codeBlockStyle:"indented",text:this.options.pedantic?W:G(W,`
`)}}},j.fences=function(A){var T=this.rules.block.fences.exec(A);if(T){var W=T[0],F=xe(W,T[3]||"");return{type:"code",raw:W,lang:T[2]?T[2].trim():T[2],text:F}}},j.heading=function(A){var T=this.rules.block.heading.exec(A);if(T){var W=T[2].trim();if(/#$/.test(W)){var F=G(W,"#");(this.options.pedantic||!F||/ $/.test(F))&&(W=F.trim())}return{type:"heading",raw:T[0],depth:T[1].length,text:W,tokens:this.lexer.inline(W)}}},j.hr=function(A){var T=this.rules.block.hr.exec(A);if(T)return{type:"hr",raw:T[0]}},j.blockquote=function(A){var T=this.rules.block.blockquote.exec(A);if(T){var W=T[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:T[0],tokens:this.lexer.blockTokens(W,[]),text:W}}},j.list=function(A){var T=this.rules.block.list.exec(A);if(T){var W,F,X,ce,Se,ke,He,Fe,Nt,kt,Me,di,ui=T[1].trim(),Qo=ui.length>1,wt={type:"list",raw:"",ordered:Qo,start:Qo?+ui.slice(0,-1):"",loose:!1,items:[]};ui=Qo?"\\d{1,9}\\"+ui.slice(-1):"\\"+ui,this.options.pedantic&&(ui=Qo?ui:"[*+-]");for(var Fi=new RegExp("^( {0,3}"+ui+")((?:[	 ][^\\n]*)?(?:\\n|$))");A&&(di=!1,!(!(T=Fi.exec(A))||this.rules.block.hr.test(A)));){if(W=T[0],A=A.substring(W.length),Fe=T[2].split(`
`,1)[0],Nt=A.split(`
`,1)[0],this.options.pedantic?(ce=2,Me=Fe.trimLeft()):(ce=T[2].search(/[^ ]/),ce=ce>4?1:ce,Me=Fe.slice(ce),ce+=T[1].length),ke=!1,!Fe&&/^ *$/.test(Nt)&&(W+=Nt+`
`,A=A.substring(Nt.length+1),di=!0),!di)for(var Ru=new RegExp("^ {0,"+Math.min(3,ce-1)+"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))"),Mu=new RegExp("^ {0,"+Math.min(3,ce-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),Er=new RegExp("^ {0,"+Math.min(3,ce-1)+"}(?:```|~~~)"),kc=new RegExp("^ {0,"+Math.min(3,ce-1)+"}#");A&&(kt=A.split(`
`,1)[0],Fe=kt,this.options.pedantic&&(Fe=Fe.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(Er.test(Fe)||kc.test(Fe)||Ru.test(Fe)||Mu.test(A)));){if(Fe.search(/[^ ]/)>=ce||!Fe.trim())Me+=`
`+Fe.slice(ce);else if(!ke)Me+=`
`+Fe;else break;!ke&&!Fe.trim()&&(ke=!0),W+=kt+`
`,A=A.substring(kt.length+1)}wt.loose||(He?wt.loose=!0:/\n *\n *$/.test(W)&&(He=!0)),this.options.gfm&&(F=/^\[[ xX]\] /.exec(Me),F&&(X=F[0]!=="[ ] ",Me=Me.replace(/^\[[ xX]\] +/,""))),wt.items.push({type:"list_item",raw:W,task:!!F,checked:X,loose:!1,text:Me}),wt.raw+=W}wt.items[wt.items.length-1].raw=W.trimRight(),wt.items[wt.items.length-1].text=Me.trimRight(),wt.raw=wt.raw.trimRight();var Pu=wt.items.length;for(Se=0;Se<Pu;Se++){this.lexer.state.top=!1,wt.items[Se].tokens=this.lexer.blockTokens(wt.items[Se].text,[]);var Ou=wt.items[Se].tokens.filter(function(Fu){return Fu.type==="space"}),tg=Ou.every(function(Fu){for(var Rk=Fu.raw.split(""),ua=0,d0=r(Rk),u0;!(u0=d0()).done;){var Iy=u0.value;if(Iy===`
`&&(ua+=1),ua>1)return!0}return!1});!wt.loose&&Ou.length&&tg&&(wt.loose=!0,wt.items[Se].loose=!0)}return wt}},j.html=function(A){var T=this.rules.block.html.exec(A);if(T){var W={type:"html",raw:T[0],pre:!this.options.sanitizer&&(T[1]==="pre"||T[1]==="script"||T[1]==="style"),text:T[0]};if(this.options.sanitize){var F=this.options.sanitizer?this.options.sanitizer(T[0]):p(T[0]);W.type="paragraph",W.text=F,W.tokens=this.lexer.inline(F)}return W}},j.def=function(A){var T=this.rules.block.def.exec(A);if(T){T[3]&&(T[3]=T[3].substring(1,T[3].length-1));var W=T[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:W,raw:T[0],href:T[2],title:T[3]}}},j.table=function(A){var T=this.rules.block.table.exec(A);if(T){var W={type:"table",header:$(T[1]).map(function(He){return{text:He}}),align:T[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:T[3]&&T[3].trim()?T[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(W.header.length===W.align.length){W.raw=T[0];var F=W.align.length,X,ce,Se,ke;for(X=0;X<F;X++)/^ *-+: *$/.test(W.align[X])?W.align[X]="right":/^ *:-+: *$/.test(W.align[X])?W.align[X]="center":/^ *:-+ *$/.test(W.align[X])?W.align[X]="left":W.align[X]=null;for(F=W.rows.length,X=0;X<F;X++)W.rows[X]=$(W.rows[X],W.header.length).map(function(He){return{text:He}});for(F=W.header.length,ce=0;ce<F;ce++)W.header[ce].tokens=this.lexer.inline(W.header[ce].text);for(F=W.rows.length,ce=0;ce<F;ce++)for(ke=W.rows[ce],Se=0;Se<ke.length;Se++)ke[Se].tokens=this.lexer.inline(ke[Se].text);return W}}},j.lheading=function(A){var T=this.rules.block.lheading.exec(A);if(T)return{type:"heading",raw:T[0],depth:T[2].charAt(0)==="="?1:2,text:T[1],tokens:this.lexer.inline(T[1])}},j.paragraph=function(A){var T=this.rules.block.paragraph.exec(A);if(T){var W=T[1].charAt(T[1].length-1)===`
`?T[1].slice(0,-1):T[1];return{type:"paragraph",raw:T[0],text:W,tokens:this.lexer.inline(W)}}},j.text=function(A){var T=this.rules.block.text.exec(A);if(T)return{type:"text",raw:T[0],text:T[0],tokens:this.lexer.inline(T[0])}},j.escape=function(A){var T=this.rules.inline.escape.exec(A);if(T)return{type:"escape",raw:T[0],text:p(T[1])}},j.tag=function(A){var T=this.rules.inline.tag.exec(A);if(T)return!this.lexer.state.inLink&&/^<a /i.test(T[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(T[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(T[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(T[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:T[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(T[0]):p(T[0]):T[0]}},j.link=function(A){var T=this.rules.inline.link.exec(A);if(T){var W=T[2].trim();if(!this.options.pedantic&&/^</.test(W)){if(!/>$/.test(W))return;var F=G(W.slice(0,-1),"\\");if((W.length-F.length)%2===0)return}else{var X=ne(T[2],"()");if(X>-1){var ce=T[0].indexOf("!")===0?5:4,Se=ce+T[1].length+X;T[2]=T[2].substring(0,X),T[0]=T[0].substring(0,Se).trim(),T[3]=""}}var ke=T[2],He="";if(this.options.pedantic){var Fe=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(ke);Fe&&(ke=Fe[1],He=Fe[3])}else He=T[3]?T[3].slice(1,-1):"";return ke=ke.trim(),/^</.test(ke)&&(this.options.pedantic&&!/>$/.test(W)?ke=ke.slice(1):ke=ke.slice(1,-1)),oe(T,{href:ke&&ke.replace(this.rules.inline._escapes,"$1"),title:He&&He.replace(this.rules.inline._escapes,"$1")},T[0],this.lexer)}},j.reflink=function(A,T){var W;if((W=this.rules.inline.reflink.exec(A))||(W=this.rules.inline.nolink.exec(A))){var F=(W[2]||W[1]).replace(/\s+/g," ");if(F=T[F.toLowerCase()],!F||!F.href){var X=W[0].charAt(0);return{type:"text",raw:X,text:X}}return oe(W,F,W[0],this.lexer)}},j.emStrong=function(A,T,W){W===void 0&&(W="");var F=this.rules.inline.emStrong.lDelim.exec(A);if(F&&!(F[3]&&W.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var X=F[1]||F[2]||"";if(!X||X&&(W===""||this.rules.inline.punctuation.exec(W))){var ce=F[0].length-1,Se,ke,He=ce,Fe=0,Nt=F[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(Nt.lastIndex=0,T=T.slice(-1*A.length+ce);(F=Nt.exec(T))!=null;)if(Se=F[1]||F[2]||F[3]||F[4]||F[5]||F[6],!!Se){if(ke=Se.length,F[3]||F[4]){He+=ke;continue}else if((F[5]||F[6])&&ce%3&&!((ce+ke)%3)){Fe+=ke;continue}if(He-=ke,!(He>0)){if(ke=Math.min(ke,ke+He+Fe),Math.min(ce,ke)%2){var kt=A.slice(1,ce+F.index+ke);return{type:"em",raw:A.slice(0,ce+F.index+ke+1),text:kt,tokens:this.lexer.inlineTokens(kt)}}var Me=A.slice(2,ce+F.index+ke-1);return{type:"strong",raw:A.slice(0,ce+F.index+ke+1),text:Me,tokens:this.lexer.inlineTokens(Me)}}}}}},j.codespan=function(A){var T=this.rules.inline.code.exec(A);if(T){var W=T[2].replace(/\n/g," "),F=/[^ ]/.test(W),X=/^ /.test(W)&&/ $/.test(W);return F&&X&&(W=W.substring(1,W.length-1)),W=p(W,!0),{type:"codespan",raw:T[0],text:W}}},j.br=function(A){var T=this.rules.inline.br.exec(A);if(T)return{type:"br",raw:T[0]}},j.del=function(A){var T=this.rules.inline.del.exec(A);if(T)return{type:"del",raw:T[0],text:T[2],tokens:this.lexer.inlineTokens(T[2])}},j.autolink=function(A,T){var W=this.rules.inline.autolink.exec(A);if(W){var F,X;return W[2]==="@"?(F=p(this.options.mangle?T(W[1]):W[1]),X="mailto:"+F):(F=p(W[1]),X=F),{type:"link",raw:W[0],text:F,href:X,tokens:[{type:"text",raw:F,text:F}]}}},j.url=function(A,T){var W;if(W=this.rules.inline.url.exec(A)){var F,X;if(W[2]==="@")F=p(this.options.mangle?T(W[0]):W[0]),X="mailto:"+F;else{var ce;do ce=W[0],W[0]=this.rules.inline._backpedal.exec(W[0])[0];while(ce!==W[0]);F=p(W[0]),W[1]==="www."?X="http://"+F:X=F}return{type:"link",raw:W[0],text:F,href:X,tokens:[{type:"text",raw:F,text:F}]}}},j.inlineText=function(A,T){var W=this.rules.inline.text.exec(A);if(W){var F;return this.lexer.state.inRawBlock?F=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(W[0]):p(W[0]):W[0]:F=p(this.options.smartypants?T(W[0]):W[0]),{type:"text",raw:W[0],text:F}}},Z}(),me={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:M,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};me._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,me._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,me.def=y(me.def).replace("label",me._label).replace("title",me._title).getRegex(),me.bullet=/(?:[*+-]|\d{1,9}[.)])/,me.listItemStart=y(/^( *)(bull) */).replace("bull",me.bullet).getRegex(),me.list=y(me.list).replace(/bull/g,me.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+me.def.source+")").getRegex(),me._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",me._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,me.html=y(me.html,"i").replace("comment",me._comment).replace("tag",me._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),me.paragraph=y(me._paragraph).replace("hr",me.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",me._tag).getRegex(),me.blockquote=y(me.blockquote).replace("paragraph",me.paragraph).getRegex(),me.normal=R({},me),me.gfm=R({},me.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),me.gfm.table=y(me.gfm.table).replace("hr",me.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",me._tag).getRegex(),me.gfm.paragraph=y(me._paragraph).replace("hr",me.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",me.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",me._tag).getRegex(),me.pedantic=R({},me.normal,{html:y(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",me._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:M,paragraph:y(me.normal._paragraph).replace("hr",me.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",me.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var te={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:M,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:M,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};te._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",te.punctuation=y(te.punctuation).replace(/punctuation/g,te._punctuation).getRegex(),te.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,te.escapedEmSt=/\\\*|\\_/g,te._comment=y(me._comment).replace("(?:-->|$)","-->").getRegex(),te.emStrong.lDelim=y(te.emStrong.lDelim).replace(/punct/g,te._punctuation).getRegex(),te.emStrong.rDelimAst=y(te.emStrong.rDelimAst,"g").replace(/punct/g,te._punctuation).getRegex(),te.emStrong.rDelimUnd=y(te.emStrong.rDelimUnd,"g").replace(/punct/g,te._punctuation).getRegex(),te._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,te._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,te._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,te.autolink=y(te.autolink).replace("scheme",te._scheme).replace("email",te._email).getRegex(),te._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,te.tag=y(te.tag).replace("comment",te._comment).replace("attribute",te._attribute).getRegex(),te._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,te._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,te._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,te.link=y(te.link).replace("label",te._label).replace("href",te._href).replace("title",te._title).getRegex(),te.reflink=y(te.reflink).replace("label",te._label).replace("ref",me._label).getRegex(),te.nolink=y(te.nolink).replace("ref",me._label).getRegex(),te.reflinkSearch=y(te.reflinkSearch,"g").replace("reflink",te.reflink).replace("nolink",te.nolink).getRegex(),te.normal=R({},te),te.pedantic=R({},te.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:y(/^!?\[(label)\]\((.*?)\)/).replace("label",te._label).getRegex(),reflink:y(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",te._label).getRegex()}),te.gfm=R({},te.normal,{escape:y(te.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),te.gfm.url=y(te.gfm.url,"i").replace("email",te.gfm._extended_email).getRegex(),te.breaks=R({},te.gfm,{br:y(te.br).replace("{2,}","*").getRegex(),text:y(te.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function Yt(Z){return Z.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Lt(Z){var j="",U,A,T=Z.length;for(U=0;U<T;U++)A=Z.charCodeAt(U),Math.random()>.5&&(A="x"+A.toString(16)),j+="&#"+A+";";return j}var Tt=function(){function Z(U){this.tokens=[],this.tokens.links=Object.create(null),this.options=U||e.defaults,this.options.tokenizer=this.options.tokenizer||new Te,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var A={block:me.normal,inline:te.normal};this.options.pedantic?(A.block=me.pedantic,A.inline=te.pedantic):this.options.gfm&&(A.block=me.gfm,this.options.breaks?A.inline=te.breaks:A.inline=te.gfm),this.tokenizer.rules=A}Z.lex=function(A,T){var W=new Z(T);return W.lex(A)},Z.lexInline=function(A,T){var W=new Z(T);return W.inlineTokens(A)};var j=Z.prototype;return j.lex=function(A){A=A.replace(/\r\n|\r/g,`
`),this.blockTokens(A,this.tokens);for(var T;T=this.inlineQueue.shift();)this.inlineTokens(T.src,T.tokens);return this.tokens},j.blockTokens=function(A,T){var W=this;T===void 0&&(T=[]),this.options.pedantic?A=A.replace(/\t/g,"    ").replace(/^ +$/gm,""):A=A.replace(/^( *)(\t+)/gm,function(He,Fe,Nt){return Fe+"    ".repeat(Nt.length)});for(var F,X,ce,Se;A;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(He){return(F=He.call({lexer:W},A,T))?(A=A.substring(F.raw.length),T.push(F),!0):!1}))){if(F=this.tokenizer.space(A)){A=A.substring(F.raw.length),F.raw.length===1&&T.length>0?T[T.length-1].raw+=`
`:T.push(F);continue}if(F=this.tokenizer.code(A)){A=A.substring(F.raw.length),X=T[T.length-1],X&&(X.type==="paragraph"||X.type==="text")?(X.raw+=`
`+F.raw,X.text+=`
`+F.text,this.inlineQueue[this.inlineQueue.length-1].src=X.text):T.push(F);continue}if(F=this.tokenizer.fences(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.heading(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.hr(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.blockquote(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.list(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.html(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.def(A)){A=A.substring(F.raw.length),X=T[T.length-1],X&&(X.type==="paragraph"||X.type==="text")?(X.raw+=`
`+F.raw,X.text+=`
`+F.raw,this.inlineQueue[this.inlineQueue.length-1].src=X.text):this.tokens.links[F.tag]||(this.tokens.links[F.tag]={href:F.href,title:F.title});continue}if(F=this.tokenizer.table(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.lheading(A)){A=A.substring(F.raw.length),T.push(F);continue}if(ce=A,this.options.extensions&&this.options.extensions.startBlock&&function(){var He=1/0,Fe=A.slice(1),Nt=void 0;W.options.extensions.startBlock.forEach(function(kt){Nt=kt.call({lexer:this},Fe),typeof Nt=="number"&&Nt>=0&&(He=Math.min(He,Nt))}),He<1/0&&He>=0&&(ce=A.substring(0,He+1))}(),this.state.top&&(F=this.tokenizer.paragraph(ce))){X=T[T.length-1],Se&&X.type==="paragraph"?(X.raw+=`
`+F.raw,X.text+=`
`+F.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=X.text):T.push(F),Se=ce.length!==A.length,A=A.substring(F.raw.length);continue}if(F=this.tokenizer.text(A)){A=A.substring(F.raw.length),X=T[T.length-1],X&&X.type==="text"?(X.raw+=`
`+F.raw,X.text+=`
`+F.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=X.text):T.push(F);continue}if(A){var ke="Infinite loop on byte: "+A.charCodeAt(0);if(this.options.silent){console.error(ke);break}else throw new Error(ke)}}return this.state.top=!0,T},j.inline=function(A,T){return T===void 0&&(T=[]),this.inlineQueue.push({src:A,tokens:T}),T},j.inlineTokens=function(A,T){var W=this;T===void 0&&(T=[]);var F,X,ce,Se=A,ke,He,Fe;if(this.tokens.links){var Nt=Object.keys(this.tokens.links);if(Nt.length>0)for(;(ke=this.tokenizer.rules.inline.reflinkSearch.exec(Se))!=null;)Nt.includes(ke[0].slice(ke[0].lastIndexOf("[")+1,-1))&&(Se=Se.slice(0,ke.index)+"["+fe("a",ke[0].length-2)+"]"+Se.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(ke=this.tokenizer.rules.inline.blockSkip.exec(Se))!=null;)Se=Se.slice(0,ke.index)+"["+fe("a",ke[0].length-2)+"]"+Se.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(ke=this.tokenizer.rules.inline.escapedEmSt.exec(Se))!=null;)Se=Se.slice(0,ke.index)+"++"+Se.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;A;)if(He||(Fe=""),He=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Me){return(F=Me.call({lexer:W},A,T))?(A=A.substring(F.raw.length),T.push(F),!0):!1}))){if(F=this.tokenizer.escape(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.tag(A)){A=A.substring(F.raw.length),X=T[T.length-1],X&&F.type==="text"&&X.type==="text"?(X.raw+=F.raw,X.text+=F.text):T.push(F);continue}if(F=this.tokenizer.link(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.reflink(A,this.tokens.links)){A=A.substring(F.raw.length),X=T[T.length-1],X&&F.type==="text"&&X.type==="text"?(X.raw+=F.raw,X.text+=F.text):T.push(F);continue}if(F=this.tokenizer.emStrong(A,Se,Fe)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.codespan(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.br(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.del(A)){A=A.substring(F.raw.length),T.push(F);continue}if(F=this.tokenizer.autolink(A,Lt)){A=A.substring(F.raw.length),T.push(F);continue}if(!this.state.inLink&&(F=this.tokenizer.url(A,Lt))){A=A.substring(F.raw.length),T.push(F);continue}if(ce=A,this.options.extensions&&this.options.extensions.startInline&&function(){var Me=1/0,di=A.slice(1),ui=void 0;W.options.extensions.startInline.forEach(function(Qo){ui=Qo.call({lexer:this},di),typeof ui=="number"&&ui>=0&&(Me=Math.min(Me,ui))}),Me<1/0&&Me>=0&&(ce=A.substring(0,Me+1))}(),F=this.tokenizer.inlineText(ce,Yt)){A=A.substring(F.raw.length),F.raw.slice(-1)!=="_"&&(Fe=F.raw.slice(-1)),He=!0,X=T[T.length-1],X&&X.type==="text"?(X.raw+=F.raw,X.text+=F.text):T.push(F);continue}if(A){var kt="Infinite loop on byte: "+A.charCodeAt(0);if(this.options.silent){console.error(kt);break}else throw new Error(kt)}}return T},i(Z,null,[{key:"rules",get:function(){return{block:me,inline:te}}}]),Z}(),Ge=function(){function Z(U){this.options=U||e.defaults}var j=Z.prototype;return j.code=function(A,T,W){var F=(T||"").match(/\S*/)[0];if(this.options.highlight){var X=this.options.highlight(A,F);X!=null&&X!==A&&(W=!0,A=X)}return A=A.replace(/\n$/,"")+`
`,F?'<pre><code class="'+this.options.langPrefix+p(F,!0)+'">'+(W?A:p(A,!0))+`</code></pre>
`:"<pre><code>"+(W?A:p(A,!0))+`</code></pre>
`},j.blockquote=function(A){return`<blockquote>
`+A+`</blockquote>
`},j.html=function(A){return A},j.heading=function(A,T,W,F){if(this.options.headerIds){var X=this.options.headerPrefix+F.slug(W);return"<h"+T+' id="'+X+'">'+A+"</h"+T+`>
`}return"<h"+T+">"+A+"</h"+T+`>
`},j.hr=function(){return this.options.xhtml?`<hr/>
`:`<hr>
`},j.list=function(A,T,W){var F=T?"ol":"ul",X=T&&W!==1?' start="'+W+'"':"";return"<"+F+X+`>
`+A+"</"+F+`>
`},j.listitem=function(A){return"<li>"+A+`</li>
`},j.checkbox=function(A){return"<input "+(A?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},j.paragraph=function(A){return"<p>"+A+`</p>
`},j.table=function(A,T){return T&&(T="<tbody>"+T+"</tbody>"),`<table>
<thead>
`+A+`</thead>
`+T+`</table>
`},j.tablerow=function(A){return`<tr>
`+A+`</tr>
`},j.tablecell=function(A,T){var W=T.header?"th":"td",F=T.align?"<"+W+' align="'+T.align+'">':"<"+W+">";return F+A+("</"+W+`>
`)},j.strong=function(A){return"<strong>"+A+"</strong>"},j.em=function(A){return"<em>"+A+"</em>"},j.codespan=function(A){return"<code>"+A+"</code>"},j.br=function(){return this.options.xhtml?"<br/>":"<br>"},j.del=function(A){return"<del>"+A+"</del>"},j.link=function(A,T,W){if(A=L(this.options.sanitize,this.options.baseUrl,A),A===null)return W;var F='<a href="'+p(A)+'"';return T&&(F+=' title="'+T+'"'),F+=">"+W+"</a>",F},j.image=function(A,T,W){if(A=L(this.options.sanitize,this.options.baseUrl,A),A===null)return W;var F='<img src="'+A+'" alt="'+W+'"';return T&&(F+=' title="'+T+'"'),F+=this.options.xhtml?"/>":">",F},j.text=function(A){return A},Z}(),ii=function(){function Z(){}var j=Z.prototype;return j.strong=function(A){return A},j.em=function(A){return A},j.codespan=function(A){return A},j.del=function(A){return A},j.html=function(A){return A},j.text=function(A){return A},j.link=function(A,T,W){return""+W},j.image=function(A,T,W){return""+W},j.br=function(){return""},Z}(),Ee=function(){function Z(){this.seen={}}var j=Z.prototype;return j.serialize=function(A){return A.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},j.getNextSafeSlug=function(A,T){var W=A,F=0;if(this.seen.hasOwnProperty(W)){F=this.seen[A];do F++,W=A+"-"+F;while(this.seen.hasOwnProperty(W))}return T||(this.seen[A]=F,this.seen[W]=0),W},j.slug=function(A,T){T===void 0&&(T={});var W=this.serialize(A);return this.getNextSafeSlug(W,T.dryrun)},Z}(),Ve=function(){function Z(U){this.options=U||e.defaults,this.options.renderer=this.options.renderer||new Ge,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ii,this.slugger=new Ee}Z.parse=function(A,T){var W=new Z(T);return W.parse(A)},Z.parseInline=function(A,T){var W=new Z(T);return W.parseInline(A)};var j=Z.prototype;return j.parse=function(A,T){T===void 0&&(T=!0);var W="",F,X,ce,Se,ke,He,Fe,Nt,kt,Me,di,ui,Qo,wt,Fi,Ru,Mu,Er,kc,Pu=A.length;for(F=0;F<Pu;F++){if(Me=A[F],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Me.type]&&(kc=this.options.extensions.renderers[Me.type].call({parser:this},Me),kc!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Me.type))){W+=kc||"";continue}switch(Me.type){case"space":continue;case"hr":{W+=this.renderer.hr();continue}case"heading":{W+=this.renderer.heading(this.parseInline(Me.tokens),Me.depth,v(this.parseInline(Me.tokens,this.textRenderer)),this.slugger);continue}case"code":{W+=this.renderer.code(Me.text,Me.lang,Me.escaped);continue}case"table":{for(Nt="",Fe="",Se=Me.header.length,X=0;X<Se;X++)Fe+=this.renderer.tablecell(this.parseInline(Me.header[X].tokens),{header:!0,align:Me.align[X]});for(Nt+=this.renderer.tablerow(Fe),kt="",Se=Me.rows.length,X=0;X<Se;X++){for(He=Me.rows[X],Fe="",ke=He.length,ce=0;ce<ke;ce++)Fe+=this.renderer.tablecell(this.parseInline(He[ce].tokens),{header:!1,align:Me.align[ce]});kt+=this.renderer.tablerow(Fe)}W+=this.renderer.table(Nt,kt);continue}case"blockquote":{kt=this.parse(Me.tokens),W+=this.renderer.blockquote(kt);continue}case"list":{for(di=Me.ordered,ui=Me.start,Qo=Me.loose,Se=Me.items.length,kt="",X=0;X<Se;X++)Fi=Me.items[X],Ru=Fi.checked,Mu=Fi.task,wt="",Fi.task&&(Er=this.renderer.checkbox(Ru),Qo?Fi.tokens.length>0&&Fi.tokens[0].type==="paragraph"?(Fi.tokens[0].text=Er+" "+Fi.tokens[0].text,Fi.tokens[0].tokens&&Fi.tokens[0].tokens.length>0&&Fi.tokens[0].tokens[0].type==="text"&&(Fi.tokens[0].tokens[0].text=Er+" "+Fi.tokens[0].tokens[0].text)):Fi.tokens.unshift({type:"text",text:Er}):wt+=Er),wt+=this.parse(Fi.tokens,Qo),kt+=this.renderer.listitem(wt,Mu,Ru);W+=this.renderer.list(kt,di,ui);continue}case"html":{W+=this.renderer.html(Me.text);continue}case"paragraph":{W+=this.renderer.paragraph(this.parseInline(Me.tokens));continue}case"text":{for(kt=Me.tokens?this.parseInline(Me.tokens):Me.text;F+1<Pu&&A[F+1].type==="text";)Me=A[++F],kt+=`
`+(Me.tokens?this.parseInline(Me.tokens):Me.text);W+=T?this.renderer.paragraph(kt):kt;continue}default:{var Ou='Token with "'+Me.type+'" type was not found.';if(this.options.silent){console.error(Ou);return}else throw new Error(Ou)}}}return W},j.parseInline=function(A,T){T=T||this.renderer;var W="",F,X,ce,Se=A.length;for(F=0;F<Se;F++){if(X=A[F],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[X.type]&&(ce=this.options.extensions.renderers[X.type].call({parser:this},X),ce!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(X.type))){W+=ce||"";continue}switch(X.type){case"escape":{W+=T.text(X.text);break}case"html":{W+=T.html(X.text);break}case"link":{W+=T.link(X.href,X.title,this.parseInline(X.tokens,T));break}case"image":{W+=T.image(X.href,X.title,X.text);break}case"strong":{W+=T.strong(this.parseInline(X.tokens,T));break}case"em":{W+=T.em(this.parseInline(X.tokens,T));break}case"codespan":{W+=T.codespan(X.text);break}case"br":{W+=T.br();break}case"del":{W+=T.del(this.parseInline(X.tokens,T));break}case"text":{W+=T.text(X.text);break}default:{var ke='Token with "'+X.type+'" type was not found.';if(this.options.silent){console.error(ke);return}else throw new Error(ke)}}}return W},Z}();function ge(Z,j,U){if(typeof Z>"u"||Z===null)throw new Error("marked(): input parameter is undefined or null");if(typeof Z!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(Z)+", string expected");if(typeof j=="function"&&(U=j,j=null),j=R({},ge.defaults,j||{}),ae(j),U){var A=j.highlight,T;try{T=Tt.lex(Z,j)}catch(Se){return U(Se)}var W=function(ke){var He;if(!ke)try{j.walkTokens&&ge.walkTokens(T,j.walkTokens),He=Ve.parse(T,j)}catch(Fe){ke=Fe}return j.highlight=A,ke?U(ke):U(null,He)};if(!A||A.length<3||(delete j.highlight,!T.length))return W();var F=0;ge.walkTokens(T,function(Se){Se.type==="code"&&(F++,setTimeout(function(){A(Se.text,Se.lang,function(ke,He){if(ke)return W(ke);He!=null&&He!==Se.text&&(Se.text=He,Se.escaped=!0),F--,F===0&&W()})},0))}),F===0&&W();return}function X(Se){if(Se.message+=`
Please report this to https://github.com/markedjs/marked.`,j.silent)return"<p>An error occurred:</p><pre>"+p(Se.message+"",!0)+"</pre>";throw Se}try{var ce=Tt.lex(Z,j);if(j.walkTokens){if(j.async)return Promise.all(ge.walkTokens(ce,j.walkTokens)).then(function(){return Ve.parse(ce,j)}).catch(X);ge.walkTokens(ce,j.walkTokens)}return Ve.parse(ce,j)}catch(Se){X(Se)}}ge.options=ge.setOptions=function(Z){return R(ge.defaults,Z),l(ge.defaults),ge},ge.getDefaults=a,ge.defaults=e.defaults,ge.use=function(){for(var Z=arguments.length,j=new Array(Z),U=0;U<Z;U++)j[U]=arguments[U];var A=R.apply(void 0,[{}].concat(j)),T=ge.defaults.extensions||{renderers:{},childTokens:{}},W;j.forEach(function(F){if(F.extensions&&(W=!0,F.extensions.forEach(function(ce){if(!ce.name)throw new Error("extension name required");if(ce.renderer){var Se=T.renderers?T.renderers[ce.name]:null;Se?T.renderers[ce.name]=function(){for(var ke=arguments.length,He=new Array(ke),Fe=0;Fe<ke;Fe++)He[Fe]=arguments[Fe];var Nt=ce.renderer.apply(this,He);return Nt===!1&&(Nt=Se.apply(this,He)),Nt}:T.renderers[ce.name]=ce.renderer}if(ce.tokenizer){if(!ce.level||ce.level!=="block"&&ce.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");T[ce.level]?T[ce.level].unshift(ce.tokenizer):T[ce.level]=[ce.tokenizer],ce.start&&(ce.level==="block"?T.startBlock?T.startBlock.push(ce.start):T.startBlock=[ce.start]:ce.level==="inline"&&(T.startInline?T.startInline.push(ce.start):T.startInline=[ce.start]))}ce.childTokens&&(T.childTokens[ce.name]=ce.childTokens)})),F.renderer&&function(){var ce=ge.defaults.renderer||new Ge,Se=function(Fe){var Nt=ce[Fe];ce[Fe]=function(){for(var kt=arguments.length,Me=new Array(kt),di=0;di<kt;di++)Me[di]=arguments[di];var ui=F.renderer[Fe].apply(ce,Me);return ui===!1&&(ui=Nt.apply(ce,Me)),ui}};for(var ke in F.renderer)Se(ke);A.renderer=ce}(),F.tokenizer&&function(){var ce=ge.defaults.tokenizer||new Te,Se=function(Fe){var Nt=ce[Fe];ce[Fe]=function(){for(var kt=arguments.length,Me=new Array(kt),di=0;di<kt;di++)Me[di]=arguments[di];var ui=F.tokenizer[Fe].apply(ce,Me);return ui===!1&&(ui=Nt.apply(ce,Me)),ui}};for(var ke in F.tokenizer)Se(ke);A.tokenizer=ce}(),F.walkTokens){var X=ge.defaults.walkTokens;A.walkTokens=function(ce){var Se=[];return Se.push(F.walkTokens.call(this,ce)),X&&(Se=Se.concat(X.call(this,ce))),Se}}W&&(A.extensions=T),ge.setOptions(A)})},ge.walkTokens=function(Z,j){for(var U=[],A=function(){var X=W.value;switch(U=U.concat(j.call(ge,X)),X.type){case"table":{for(var ce=r(X.header),Se;!(Se=ce()).done;){var ke=Se.value;U=U.concat(ge.walkTokens(ke.tokens,j))}for(var He=r(X.rows),Fe;!(Fe=He()).done;)for(var Nt=Fe.value,kt=r(Nt),Me;!(Me=kt()).done;){var di=Me.value;U=U.concat(ge.walkTokens(di.tokens,j))}break}case"list":{U=U.concat(ge.walkTokens(X.items,j));break}default:ge.defaults.extensions&&ge.defaults.extensions.childTokens&&ge.defaults.extensions.childTokens[X.type]?ge.defaults.extensions.childTokens[X.type].forEach(function(ui){U=U.concat(ge.walkTokens(X[ui],j))}):X.tokens&&(U=U.concat(ge.walkTokens(X.tokens,j)))}},T=r(Z),W;!(W=T()).done;)A();return U},ge.parseInline=function(Z,j){if(typeof Z>"u"||Z===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof Z!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(Z)+", string expected");j=R({},ge.defaults,j||{}),ae(j);try{var U=Tt.lexInline(Z,j);return j.walkTokens&&ge.walkTokens(U,j.walkTokens),Ve.parseInline(U,j)}catch(A){if(A.message+=`
Please report this to https://github.com/markedjs/marked.`,j.silent)return"<p>An error occurred:</p><pre>"+p(A.message+"",!0)+"</pre>";throw A}},ge.Parser=Ve,ge.parser=Ve.parse,ge.Renderer=Ge,ge.TextRenderer=ii,ge.Lexer=Tt,ge.lexer=Tt.lex,ge.Tokenizer=Te,ge.Slugger=Ee,ge.parse=ge;var he=ge.options,ki=ge.setOptions,Dt=ge.use,It=ge.walkTokens,vi=ge.parseInline,Xo=ge,Nu=Ve.parse,Nk=Tt.lex;e.Lexer=Tt,e.Parser=Ve,e.Renderer=Ge,e.Slugger=Ee,e.TextRenderer=ii,e.Tokenizer=Te,e.getDefaults=a,e.lexer=Nk,e.marked=ge,e.options=he,e.parse=Xo,e.parseInline=vi,e.parser=Nu,e.setOptions=ki,e.use=Dt,e.walkTokens=It,Object.defineProperty(e,"__esModule",{value:!0})})})();gs.Lexer||exports.Lexer;gs.Parser||exports.Parser;gs.Renderer||exports.Renderer;gs.Slugger||exports.Slugger;gs.TextRenderer||exports.TextRenderer;gs.Tokenizer||exports.Tokenizer;gs.getDefaults||exports.getDefaults;gs.lexer||exports.lexer;var Ia=gs.marked||exports.marked;gs.options||exports.options;gs.parse||exports.parse;gs.parseInline||exports.parseInline;gs.parser||exports.parser;gs.setOptions||exports.setOptions;gs.use||exports.use;gs.walkTokens||exports.walkTokens;function TDe(n){return JSON.stringify(n,NDe)}function NN(n){let e=JSON.parse(n);return e=RN(e),e}function NDe(n,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function RN(n,e=0){if(!n||e>200)return n;if(typeof n=="object"){switch(n.$mid){case 1:return je.revive(n);case 2:return new RegExp(n.source,n.flags);case 17:return new Date(n.source)}if(n instanceof gP||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let t=0;t<n.length;++t)n[t]=RN(n[t],e+1);else for(const t in n)Object.hasOwnProperty.call(n,t)&&(n[t]=RN(n[t],e+1))}return n}const LE=Object.freeze({image:(n,e,t)=>{let i=[],s=[];return n&&({href:n,dimensions:i}=CDe(n),s.push(`src="${Bw(n)}"`)),t&&s.push(`alt="${Bw(t)}"`),e&&s.push(`title="${Bw(e)}"`),i.length&&(s=s.concat(i)),"<img "+s.join(" ")+">"},paragraph:n=>`<p>${n}</p>`,link:(n,e,t)=>typeof n!="string"?"":(n===t&&(t=xE(t)),e=typeof e=="string"?Bw(xE(e)):"",n=xE(n),n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${n}" title="${e||n}">${t}</a>`)});function ek(n,e={},t={}){var i,s;const o=new pe;let r=!1;const a=g3(e),l=function(v){let b;try{b=NN(decodeURIComponent(v))}catch{}return b?(b=wU(b,y=>{if(n.uris&&n.uris[y])return je.revive(n.uris[y])}),encodeURIComponent(JSON.stringify(b))):v},c=function(v,b){const y=n.uris&&n.uris[v];let w=je.revive(y);return b?v.startsWith(it.data+":")?v:(w||(w=je.parse(v)),gj.uriToBrowserUri(w).toString(!0)):!w||je.parse(v).toString()===w.toString()?v:(w.query&&(w=w.with({query:l(w.query)})),w.toString())},d=new Ia.Renderer;d.image=LE.image,d.link=LE.link,d.paragraph=LE.paragraph;const u=[],h=[];if(e.codeBlockRendererSync?d.code=(v,b)=>{const y=TN.nextId(),w=e.codeBlockRendererSync(p6(b),v);return h.push([y,w]),`<div class="code" data-code="${y}">${FS(v)}</div>`}:e.codeBlockRenderer&&(d.code=(v,b)=>{const y=TN.nextId(),w=e.codeBlockRenderer(p6(b),v);return u.push(w.then(C=>[y,C])),`<div class="code" data-code="${y}">${FS(v)}</div>`}),e.actionHandler){const v=function(w){let C=w.target;if(!(C.tagName!=="A"&&(C=C.parentElement,!C||C.tagName!=="A")))try{let L=C.dataset.href;L&&(n.baseUri&&(L=DE(je.from(n.baseUri),L)),e.actionHandler.callback(L,w))}catch(L){mt(L)}finally{w.preventDefault()}},b=e.actionHandler.disposables.add(new rt(a,"click")),y=e.actionHandler.disposables.add(new rt(a,"auxclick"));e.actionHandler.disposables.add(ue.any(b.event,y.event)(w=>{const C=new ar(w);!C.leftButton&&!C.middleButton||v(C)})),e.actionHandler.disposables.add(K(a,"keydown",w=>{const C=new zt(w);!C.equals(10)&&!C.equals(3)||v(C)}))}n.supportHtml||(t.sanitizer=v=>(n.isTrusted?v.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?v:"",t.sanitize=!0,t.silent=!0),t.renderer=d;let f=(i=n.value)!==null&&i!==void 0?i:"";f.length>1e5&&(f=`${f.substr(0,1e5)}`),n.supportThemeIcons&&(f=_De(f));let g;if(e.fillInIncompleteTokens){const v=Object.assign(Object.assign({},Ia.defaults),t),b=Ia.lexer(f,v),y=VDe(b);g=Ia.parser(y,v)}else g=Ia.parse(f,t);n.supportThemeIcons&&(g=Qh(g).map(b=>typeof b=="string"?b:b.outerHTML).join(""));const _=new DOMParser().parseFromString(MN(n,g),"text/html");if(_.body.querySelectorAll("img").forEach(v=>{const b=v.getAttribute("src");if(b){let y=b;try{n.baseUri&&(y=DE(je.from(n.baseUri),y))}catch{}v.src=c(y,!0)}}),_.body.querySelectorAll("a").forEach(v=>{const b=v.getAttribute("href");if(v.setAttribute("href",""),!b||/^data:|javascript:/i.test(b)||/^command:/i.test(b)&&!n.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(b))v.replaceWith(...v.childNodes);else{let y=c(b,!1);n.baseUri&&(y=DE(je.from(n.baseUri),b)),v.dataset.href=y}}),a.innerHTML=MN(n,_.body.innerHTML),u.length>0)Promise.all(u).then(v=>{var b,y;if(r)return;const w=new Map(v),C=a.querySelectorAll("div[data-code]");for(const L of C){const x=w.get((b=L.dataset.code)!==null&&b!==void 0?b:"");x&&cs(L,x)}(y=e.asyncRenderCallback)===null||y===void 0||y.call(e)});else if(h.length>0){const v=new Map(h),b=a.querySelectorAll("div[data-code]");for(const y of b){const w=v.get((s=y.dataset.code)!==null&&s!==void 0?s:"");w&&cs(y,w)}}if(e.asyncRenderCallback)for(const v of a.getElementsByTagName("img")){const b=o.add(K(v,"load",()=>{b.dispose(),e.asyncRenderCallback()}))}return{element:a,dispose:()=>{r=!0,o.dispose()}}}function p6(n){if(!n)return"";const e=n.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:n}function DE(n,e){return/^\w[\w\d+.-]*:/.test(e)?e:n.path.endsWith("/")?l8(n,e).toString():l8(qP(n),e).toString()}function MN(n,e){const{config:t,allowedSchemes:i}=MDe(n);uj("uponSanitizeAttribute",(o,r)=>{if(r.attrName==="style"||r.attrName==="class"){if(o.tagName==="SPAN"){if(r.attrName==="style"){r.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?$/.test(r.attrValue);return}else if(r.attrName==="class"){r.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(r.attrValue);return}}r.keepAttr=!1;return}});const s=Eme(i);try{return dj(e,Object.assign(Object.assign({},t),{RETURN_TRUSTED_TYPE:!0}))}finally{hj("uponSanitizeAttribute"),s.dispose()}}const RDe=["align","autoplay","alt","class","controls","data-code","data-href","height","href","loop","muted","playsinline","poster","src","style","target","title","width","start"];function MDe(n){const e=[it.http,it.https,it.mailto,it.data,it.file,it.vscodeFileResource,it.vscodeRemote,it.vscodeRemoteResource];return n.isTrusted&&e.push(it.command),{config:{ALLOWED_TAGS:[...Ame],ALLOWED_ATTR:RDe,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function PDe(n){return typeof n=="string"?n:ODe(n)}function ODe(n){var e;let t=(e=n.value)!==null&&e!==void 0?e:"";t.length>1e5&&(t=`${t.substr(0,1e5)}`);const i=Ia.parse(t,{renderer:BDe.value}).replace(/&(#\d+|[a-zA-Z]+);/g,s=>{var o;return(o=FDe.get(s))!==null&&o!==void 0?o:s});return MN({isTrusted:!1},i).toString()}const FDe=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]),BDe=new Mf(()=>{const n=new Ia.Renderer;return n.code=e=>e,n.blockquote=e=>e,n.html=e=>"",n.heading=(e,t,i)=>e+`
`,n.hr=()=>"",n.list=(e,t)=>e,n.listitem=e=>e+`
`,n.paragraph=e=>e+`
`,n.table=(e,t)=>e+t+`
`,n.tablerow=e=>e,n.tablecell=(e,t)=>e+" ",n.strong=e=>e,n.em=e=>e,n.codespan=e=>e,n.br=()=>`
`,n.del=e=>e,n.image=(e,t,i)=>"",n.text=e=>e,n.link=(e,t,i)=>i,n});function m3(n){let e="";return n.forEach(t=>{e+=t.raw}),e}function WDe(n){for(const e of n.tokens)if(e.type==="text"){const t=e.raw.split(`
`),i=t[t.length-1];if(i.includes("`"))return HDe(n);if(i.includes("**"))return GDe(n);if(i.match(/\*\w/))return $De(n);if(i.match(/(^|\s)__\w/))return KDe(n);if(i.match(/(^|\s)_\w/))return UDe(n);if(i.match(/(^|\s)\[.*\]\(\w*/))return jDe(n);if(i.match(/(^|\s)\[\w/))return qDe(n)}}function VDe(n){let e,t;for(e=0;e<n.length;e++){const i=n[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)```/)){t=zDe(n.slice(e));break}if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=YDe(n.slice(e));break}if(e===n.length-1&&i.type==="paragraph"){const s=WDe(i);if(s){t=[s];break}}}if(t){const i=[...n.slice(0,e),...t];return i.links=n.links,i}return n}function zDe(n){const e=m3(n);return Ia.lexer(e+"\n```")}function HDe(n){return jf(n,"`")}function $De(n){return jf(n,"*")}function UDe(n){return jf(n,"_")}function jDe(n){return jf(n,")")}function qDe(n){return jf(n,"](about:blank)")}function GDe(n){return jf(n,"**")}function KDe(n){return jf(n,"__")}function jf(n,e){const t=m3(Array.isArray(n)?n:[n]);return Ia.lexer(t+e)[0]}function YDe(n){const e=m3(n),t=e.split(`
`);let i,s=!1;for(let o=0;o<t.length;o++){const r=t[o].trim();if(typeof i>"u"&&r.match(/^\s*\|/)){const a=r.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(r.match(/^\s*\|/)){if(o!==t.length-1)return;s=!0}else return}if(typeof i=="number"&&i>0){const o=s?t.slice(0,-1).join(`
`):e,r=!!o.match(/\|\s*$/),a=o+(r?"":"|")+`
|${" --- |".repeat(i)}`;return Ia.lexer(a)}}class ZDe{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(s=>s.splice(e,t,i))}}class bg extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function m6(n,e){const t=[];for(const i of e){if(n.start>=i.range.end)continue;if(n.end<i.range.start)break;const s=Dn.intersect(n,i.range);Dn.isEmpty(s)||t.push({range:s,size:i.size})}return t}function PN({start:n,end:e},t){return{start:n+t,end:e+t}}function XDe(n){const e=[];let t=null;for(const i of n){const s=i.range.start,o=i.range.end,r=i.size;if(t&&r===t.size){t.range.end=o;continue}t={range:{start:s,end:o},size:r},e.push(t)}return e}function QDe(...n){return XDe(n.reduce((e,t)=>e.concat(t),[]))}class _6{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const s=i.length-t,o=m6({start:0,end:e},this.groups),r=m6({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:PN(l.range,s),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=QDe(o,a,r),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const s of this.groups){const o=s.range.end-s.range.start,r=i+o*s.size;if(e<r)return t+Math.floor((e-i)/s.size);t+=o,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const s of this.groups){const o=s.range.end-s.range.start,r=i+o;if(e<r)return this._paddingTop+t+(e-i)*s.size;t+=o*s.size,i=r}return-1}}function JDe(n){var e;try{(e=n.parentElement)===null||e===void 0||e.removeChild(n)}catch{}}class eke{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const s=we(".monaco-list-row"),r=this.getRenderer(e).renderTemplate(s);t={domNode:s,templateId:e,templateData:r}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),JDe(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var xc=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o};const ju={CurrentDragAndDropData:void 0},ga={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(n){return[n]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class py{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class tke{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class ike{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function nke(n,e){return Array.isArray(n)&&Array.isArray(e)?Ki(n,e):n===e}class ske{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,s)=>s,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}class Yo{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:N2(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,s=ga){var o,r,a,l,c,d,u,h,f,g,p,_,v;if(this.virtualDelegate=t,this.domId=`list_id_${++Yo.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new xu(50),this.splicing=!1,this.dragOverAnimationStopDisposable=Y.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=Y.None,this.onDragLeaveTimeout=Y.None,this.disposables=new pe,this._onDidChangeContentHeight=new B,this._onDidChangeContentWidth=new B,this._horizontalScrolling=!1,s.horizontalScrolling&&s.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new _6((o=s.paddingTop)!==null&&o!==void 0?o:0);for(const y of i)this.renderers.set(y.templateId,y);this.cache=this.disposables.add(new eke(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof s.mouseSupport=="boolean"?s.mouseSupport:!0),this._horizontalScrolling=(r=s.horizontalScrolling)!==null&&r!==void 0?r:ga.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof s.paddingBottom>"u"?0:s.paddingBottom,this.accessibilityProvider=new ske(s.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",((a=s.transformOptimization)!==null&&a!==void 0?a:ga.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Rt.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new cy({forceIntegerValues:!0,smoothScrollDuration:(l=s.smoothScrolling)!==null&&l!==void 0&&l?125:0,scheduleAtNextAnimationFrame:y=>Uo(y)})),this.scrollableElement=this.disposables.add(new OP(this.rowsContainer,{alwaysConsumeMouseWheel:(c=s.alwaysConsumeMouseWheel)!==null&&c!==void 0?c:ga.alwaysConsumeMouseWheel,horizontal:1,vertical:(d=s.verticalScrollMode)!==null&&d!==void 0?d:ga.verticalScrollMode,useShadows:(u=s.useShadows)!==null&&u!==void 0?u:ga.useShadows,mouseWheelScrollSensitivity:s.mouseWheelScrollSensitivity,fastScrollSensitivity:s.fastScrollSensitivity,scrollByPage:s.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(K(this.rowsContainer,Pt.Change,y=>this.onTouchChange(y))),this.disposables.add(K(this.scrollableElement.getDomNode(),"scroll",y=>y.target.scrollTop=0)),this.disposables.add(K(this.domNode,"dragover",y=>this.onDragOver(this.toDragEvent(y)))),this.disposables.add(K(this.domNode,"drop",y=>this.onDrop(this.toDragEvent(y)))),this.disposables.add(K(this.domNode,"dragleave",y=>this.onDragLeave(this.toDragEvent(y)))),this.disposables.add(K(this.domNode,"dragend",y=>this.onDragEnd(y))),this.setRowLineHeight=(h=s.setRowLineHeight)!==null&&h!==void 0?h:ga.setRowLineHeight,this.setRowHeight=(f=s.setRowHeight)!==null&&f!==void 0?f:ga.setRowHeight,this.supportDynamicHeights=(g=s.supportDynamicHeights)!==null&&g!==void 0?g:ga.supportDynamicHeights,this.dnd=(p=s.dnd)!==null&&p!==void 0?p:this.disposables.add(ga.dnd),this.layout((_=s.initialSize)===null||_===void 0?void 0:_.height,(v=s.initialSize)===null||v===void 0?void 0:v.width)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t=Object.assign(Object.assign({},t??{}),{scrollByPage:e.scrollByPage})),e.mouseWheelScrollSensitivity!==void 0&&(t=Object.assign(Object.assign({},t??{}),{mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity})),e.fastScrollSensitivity!==void 0&&(t=Object.assign(Object.assign({},t??{}),{fastScrollSensitivity:e.fastScrollSensitivity})),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+s),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const s=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:e,end:e+t},r=Dn.intersect(s,o),a=new Map;for(let L=r.end-1;L>=r.start;L--){const x=this.items[L];if(x.dragStartDisposable.dispose(),x.checkedDisposable.dispose(),x.row){let D=a.get(x.templateId);D||(D=[],a.set(x.templateId,D));const k=this.renderers.get(x.templateId);k&&k.disposeElement&&k.disposeElement(x.element,L,x.row.templateData,x.size),D.push(x.row)}x.row=null}const l={start:e+t,end:this.items.length},c=Dn.intersect(l,s),d=Dn.relativeComplement(l,s),u=i.map(L=>({id:String(this.itemId++),element:L,templateId:this.virtualDelegate.getTemplateId(L),size:this.virtualDelegate.getHeight(L),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(L),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:Y.None,checkedDisposable:Y.None}));let h;e===0&&t>=this.items.length?(this.rangeMap=new _6(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,u),h=this.items,this.items=u):(this.rangeMap.splice(e,t,u),h=this.items.splice(e,t,...u));const f=i.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),p=PN(c,f),_=Dn.intersect(g,p);for(let L=_.start;L<_.end;L++)this.updateItemInDOM(this.items[L],L);const v=Dn.relativeComplement(p,g);for(const L of v)for(let x=L.start;x<L.end;x++)this.removeItemFromDOM(x);const b=d.map(L=>PN(L,f)),w=[{start:e,end:e+i.length},...b].map(L=>Dn.intersect(g,L)),C=this.getNextToLastElement(w);for(const L of w)for(let x=L.start;x<L.end;x++){const D=this.items[x],k=a.get(D.templateId),P=k==null?void 0:k.pop();this.insertItemInDOM(x,C,P)}for(const L of a.values())for(const x of L)this.cache.release(x);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map(L=>L.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=Uo(()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){const e=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),t=this.rangeMap.positionAt(e.start),i=this.rangeMap.positionAt(e.start+1);return i!==-1&&(i-t)/2+t<this.scrollTop?e.start+1:e.start}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:bme(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:N2(this.domNode)})}render(e,t,i,s,o,r=!1){const a=this.getRenderRange(t,i),l=Dn.relativeComplement(a,e),c=Dn.relativeComplement(e,a),d=this.getNextToLastElement(l);if(r){const u=Dn.intersect(e,a);for(let h=u.start;h<u.end;h++)this.updateItemInDOM(this.items[h],h)}this.cache.transact(()=>{for(const u of c)for(let h=u.start;h<u.end;h++)this.removeItemFromDOM(h);for(const u of l)for(let h=u.start;h<u.end;h++)this.insertItemInDOM(h,d)}),s!==void 0&&(this.rowsContainer.style.left=`-${s}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&o!==void 0&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t,i){const s=this.items[e];let o=!1;if(!s.row)if(i)s.row=i;else{const d=this.cache.alloc(s.templateId);s.row=d.row,o=d.isReusingConnectedDomNode}const r=this.accessibilityProvider.getRole(s.element)||"listitem";s.row.domNode.setAttribute("role",r);const a=this.accessibilityProvider.isChecked(s.element);if(typeof a=="boolean")s.row.domNode.setAttribute("aria-checked",String(!!a));else if(a){const d=u=>s.row.domNode.setAttribute("aria-checked",String(!!u));d(a.value),s.checkedDisposable=a.onDidChange(d)}(o||!s.row.domNode.parentElement)&&(t?this.rowsContainer.insertBefore(s.row.domNode,t):this.rowsContainer.appendChild(s.row.domNode)),this.updateItemInDOM(s,e);const l=this.renderers.get(s.templateId);if(!l)throw new Error(`No renderer found for template id ${s.templateId}`);l==null||l.renderElement(s.element,e,s.row.templateData,s.size);const c=this.dnd.getDragURI(s.element);s.dragStartDisposable.dispose(),s.row.domNode.draggable=!!c,c&&(s.dragStartDisposable=K(s.row.domNode,"dragstart",d=>this.onDragStart(s.element,c,d))),this.horizontalScrolling&&(this.measureItemWidth(s),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=N2(e.row.domNode);const t=window.getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return ue.map(this.disposables.add(new rt(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return ue.map(this.disposables.add(new rt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return ue.filter(ue.map(this.disposables.add(new rt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return ue.map(this.disposables.add(new rt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return ue.map(this.disposables.add(new rt(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return ue.map(this.disposables.add(new rt(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return ue.any(ue.map(this.disposables.add(new rt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),ue.map(this.disposables.add(new rt(this.domNode,Pt.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return ue.map(this.disposables.add(new rt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return ue.map(this.disposables.add(new rt(this.rowsContainer,Pt.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],s=i&&i.element;return{browserEvent:e,index:t,element:s}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){var s,o;if(!i.dataTransfer)return;const r=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(NG.TEXT,t),i.dataTransfer.setDragImage){let a;this.dnd.getDragLabel&&(a=this.dnd.getDragLabel(r,i)),typeof a>"u"&&(a=String(r.length));const l=we(".monaco-drag-image");l.textContent=a;const d=(u=>{for(;u&&!u.classList.contains("monaco-workbench");)u=u.parentElement;return u||document.body})(this.domNode);d.appendChild(l),i.dataTransfer.setDragImage(l,-10,-10),setTimeout(()=>d.removeChild(l),0)}this.domNode.classList.add("dragging"),this.currentDragData=new py(r),ju.CurrentDragAndDropData=new tke(r),(o=(s=this.dnd).onDragStart)===null||o===void 0||o.call(s,this.currentDragData,i)}onDragOver(e){var t;if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),ju.CurrentDragAndDropData&&ju.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(ju.CurrentDragAndDropData)this.currentDragData=ju.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new ike}const i=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.browserEvent);if(this.canDrop=typeof i=="boolean"?i:i.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof i!="boolean"&&i.effect===0?"copy":"move";let s;if(typeof i!="boolean"&&i.feedback?s=i.feedback:typeof e.index>"u"?s=[-1]:s=[e.index],s=uf(s).filter(o=>o>=-1&&o<this.length).sort((o,r)=>o-r),s=s[0]===-1?[-1]:s,nke(this.currentDragFeedback,s))return!0;if(this.currentDragFeedback=s,this.currentDragFeedbackDisposable.dispose(),s[0]===-1)this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=Ze(()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")});else{for(const o of s){const r=this.items[o];r.dropTarget=!0,(t=r.row)===null||t===void 0||t.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=Ze(()=>{var o;for(const r of s){const a=this.items[r];a.dropTarget=!1,(o=a.row)===null||o===void 0||o.domNode.classList.remove("drop-target")}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=US(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&((i=(t=this.dnd).onDragLeave)===null||i===void 0||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,ju.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.browserEvent))}onDragEnd(e){var t,i;this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,ju.CurrentDragAndDropData=void 0,(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=Y.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=_j(this.domNode).top;this.dragOverAnimationDisposable=kme(this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=US(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;i instanceof HTMLElement&&i!==this.rowsContainer&&t.contains(i);){const s=i.getAttribute("data-index");if(s){const o=Number(s);if(!isNaN(o))return o}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const s=this.getRenderRange(e,t);let o,r;e===this.elementTop(s.start)?(o=s.start,r=0):s.end-s.start>1&&(o=s.start+1,r=this.elementTop(o)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let d=l.start;d<l.end;d++){const u=this.probeDynamicHeight(d);u!==0&&this.rangeMap.splice(d,1,[this.items[d]]),a+=u,c=c||u!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const d=Dn.relativeComplement(s,l);for(const h of d)for(let f=h.start;f<h.end;f++)this.items[f].row&&this.removeItemFromDOM(f);const u=Dn.relativeComplement(l,s);for(const h of u)for(let f=h.start;f<h.end;f++){const g=f+1,p=g<this.items.length?this.items[g].row:null,_=p?p.domNode:null;this.insertItemInDOM(f,_)}for(let h=l.start;h<l.end;h++)this.items[h].row&&this.updateItemInDOM(this.items[h],h);if(typeof o=="number"){const h=this.scrollable.getFutureScrollPosition().scrollTop-e,f=this.elementTop(o)-r+h;this.setScrollTop(f,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){var t,i,s;const o=this.items[e];if(this.virtualDelegate.getDynamicHeight){const c=this.virtualDelegate.getDynamicHeight(o.element);if(c!==null){const d=o.size;return o.size=c,o.lastDynamicHeightWidth=this.renderWidth,c-d}}if(!o.hasDynamicHeight||o.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(o.element))return 0;const r=o.size;if(o.row)return o.row.domNode.style.height="",o.size=o.row.domNode.offsetHeight,o.lastDynamicHeightWidth=this.renderWidth,o.size-r;const{row:a}=this.cache.alloc(o.templateId);a.domNode.style.height="",this.rowsContainer.appendChild(a.domNode);const l=this.renderers.get(o.templateId);if(!l)throw new ji("Missing renderer for templateId: "+o.templateId);return l.renderElement(o.element,e,a.templateData,void 0),o.size=a.domNode.offsetHeight,(t=l.disposeElement)===null||t===void 0||t.call(l,o.element,e,a.templateData,void 0),(s=(i=this.virtualDelegate).setDynamicHeight)===null||s===void 0||s.call(i,o.element,o.size),o.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(a.domNode),this.cache.release(a),o.size-r}getNextToLastElement(e){const t=e[e.length-1];if(!t)return null;const i=this.items[t.end];return!i||!i.row?null:i.row.domNode}getElementDomId(e){return`${this.domId}_${e}`}dispose(){var e,t;for(const i of this.items)if(i.dragStartDisposable.dispose(),i.checkedDisposable.dispose(),i.row){const s=this.renderers.get(i.row.templateId);s&&((e=s.disposeElement)===null||e===void 0||e.call(s,i.element,-1,i.row.templateData,void 0),s.disposeTemplate(i.row.templateData))}this.items=[],this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),(t=this.dragOverAnimationDisposable)===null||t===void 0||t.dispose(),this.disposables.dispose()}}Yo.InstanceCount=0;xc([Di],Yo.prototype,"onMouseClick",null);xc([Di],Yo.prototype,"onMouseDblClick",null);xc([Di],Yo.prototype,"onMouseMiddleClick",null);xc([Di],Yo.prototype,"onMouseDown",null);xc([Di],Yo.prototype,"onMouseOver",null);xc([Di],Yo.prototype,"onMouseOut",null);xc([Di],Yo.prototype,"onContextMenu",null);xc([Di],Yo.prototype,"onTouchStart",null);xc([Di],Yo.prototype,"onTap",null);var qf=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},b6=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class oke{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const s=this.renderedElements.findIndex(o=>o.templateData===i);if(s>=0){const o=this.renderedElements[s];this.trait.unrender(i),o.index=t}else{const o={index:t,templateData:i};this.renderedElements.push(o)}this.trait.renderIndex(t,i)}splice(e,t,i){const s=[];for(const o of this.renderedElements)o.index<e?s.push(o):o.index>=e+t&&s.push({index:o.index+i-t,templateData:o.templateData});this.renderedElements=s}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let Lx=class{get name(){return this._trait}get renderer(){return new oke(this)}constructor(e){this._trait=e,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new B,this.onChange=this._onChange.event}splice(e,t,i){var s;t=Math.max(0,Math.min(t,this.length-e));const o=i.length-t,r=e+t,a=[];let l=0;for(;l<this.sortedIndexes.length&&this.sortedIndexes[l]<e;)a.push(this.sortedIndexes[l++]);for(let d=0;d<i.length;d++)i[d]&&a.push(d+e);for(;l<this.sortedIndexes.length&&this.sortedIndexes[l]>=r;)a.push(this.sortedIndexes[l++]+o);const c=this.length+o;if(this.sortedIndexes.length>0&&a.length===0&&c>0){const d=(s=this.sortedIndexes.find(u=>u>=e))!==null&&s!==void 0?s:c-1;a.push(Math.min(d,c-1))}this.renderer.splice(e,t,i.length),this._set(a,a),this.length=c}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(y6),t)}_set(e,t,i){const s=this.indexes,o=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const r=ON(o,e);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:e,browserEvent:i}),s}get(){return this.indexes}contains(e){return hU(this.sortedIndexes,e,y6)>=0}dispose(){Ft(this._onChange)}};qf([Di],Lx.prototype,"renderer",null);class rke extends Lx{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class kE{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const s=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(s.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const o=new Set(s),r=i.map(a=>o.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,r)}}function Id(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"}function Xg(n){return n.classList.contains("monaco-editor")?!0:n.classList.contains("monaco-list")||!n.parentElement?!1:Xg(n.parentElement)}function qG(n){return n.tagName==="A"&&n.classList.contains("monaco-button")||n.tagName==="DIV"&&n.classList.contains("monaco-button-dropdown")?!0:n.classList.contains("monaco-list")||!n.parentElement?!1:qG(n.parentElement)}class GG{get onKeyDown(){return ue.chain(this.disposables.add(new rt(this.view.domNode,"keydown")).event,e=>e.filter(t=>!Id(t.target)).map(t=>new zt(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new pe,this.multipleSelectionDisposables=new pe,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(s=>{switch(s.keyCode){case 3:return this.onEnter(s);case 16:return this.onUpArrow(s);case 18:return this.onDownArrow(s);case 11:return this.onPageUpArrow(s);case 12:return this.onPageDownArrow(s);case 9:return this.onEscape(s);case 31:this.multipleSelectionSupport&&(pt?s.metaKey:s.ctrlKey)&&this.onCtrlA(s)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(es(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}qf([Di],GG.prototype,"onKeyDown",null);var Ta;(function(n){n[n.Automatic=0]="Automatic",n[n.Trigger=1]="Trigger"})(Ta||(Ta={}));var Qg;(function(n){n[n.Idle=0]="Idle",n[n.Typing=1]="Typing"})(Qg||(Qg={}));const ake=new class{mightProducePrintableCharacter(n){return n.ctrlKey||n.metaKey||n.altKey?!1:n.keyCode>=31&&n.keyCode<=56||n.keyCode>=21&&n.keyCode<=30||n.keyCode>=98&&n.keyCode<=107||n.keyCode>=85&&n.keyCode<=95}};class lke{constructor(e,t,i,s,o){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=s,this.delegate=o,this.enabled=!1,this.state=Qg.Idle,this.mode=Ta.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new pe,this.disposables=new pe,this.updateOptions(e.options)}updateOptions(e){var t,i;!((t=e.typeNavigationEnabled)!==null&&t!==void 0)||t?this.enable():this.disable(),this.mode=(i=e.typeNavigationMode)!==null&&i!==void 0?i:Ta.Automatic}enable(){if(this.enabled)return;let e=!1;const t=ue.chain(this.enabledDisposables.add(new rt(this.view.domNode,"keydown")).event,o=>o.filter(r=>!Id(r.target)).filter(()=>this.mode===Ta.Automatic||this.triggered).map(r=>new zt(r)).filter(r=>e||this.keyboardNavigationEventFilter(r)).filter(r=>this.delegate.mightProducePrintableCharacter(r)).forEach(r=>Ue.stop(r,!0)).map(r=>r.browserEvent.key)),i=ue.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);ue.reduce(ue.any(t,i),(o,r)=>r===null?null:(o||"")+r,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var e;const t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){const i=(e=this.list.options.accessibilityProvider)===null||e===void 0?void 0:e.getAriaLabel(this.list.element(t[0]));i&&ay(i)}this.previouslyFocused=-1}onInput(e){if(!e){this.state=Qg.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,s=this.state===Qg.Idle?1:0;this.state=Qg.Typing;for(let o=0;o<this.list.length;o++){const r=(i+o+s)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(r)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(xx(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}const c=cDe(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}else if(typeof l>"u"||xx(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class cke{constructor(e,t){this.list=e,this.view=t,this.disposables=new pe;const i=ue.chain(this.disposables.add(new rt(t.domNode,"keydown")).event,o=>o.filter(r=>!Id(r.target)).map(r=>new zt(r)));ue.chain(i,o=>o.filter(r=>r.keyCode===2&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const s=i.querySelector("[tabIndex]");if(!s||!(s instanceof HTMLElement)||s.tabIndex===-1)return;const o=window.getComputedStyle(s);o.visibility==="hidden"||o.display==="none"||(e.preventDefault(),e.stopPropagation(),s.focus())}dispose(){this.disposables.dispose()}}function KG(n){return pt?n.browserEvent.metaKey:n.browserEvent.ctrlKey}function YG(n){return n.browserEvent.shiftKey}function dke(n){return n instanceof MouseEvent&&n.button===2}const v6={isSelectionSingleChangeEvent:KG,isSelectionRangeChangeEvent:YG};class ZG{constructor(e){this.list=e,this.disposables=new pe,this._onPointer=new B,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||v6),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Rt.addTarget(e.getHTMLElement()))),ue.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||v6))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){Xg(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(Id(e.browserEvent.target)||Xg(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Id(e.browserEvent.target)||Xg(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),dke(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Id(e.browserEvent.target)||Xg(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(typeof i>"u"){const d=this.list.getFocus()[0];i=d??t,this.list.setAnchor(i)}const s=Math.min(i,t),o=Math.max(i,t),r=es(s,o+1),a=this.list.getSelection(),l=fke(ON(a,[i]),i);if(l.length===0)return;const c=ON(r,gke(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const s=this.list.getSelection(),o=s.filter(r=>r!==t);this.list.setFocus([t]),this.list.setAnchor(t),s.length===o.length?this.list.setSelection([...o,t],e.browserEvent):this.list.setSelection(o,e.browserEvent)}}dispose(){this.disposables.dispose()}}class XG{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){var t,i;const s=this.selectorSuffix&&`.${this.selectorSuffix}`,o=[];e.listBackground&&o.push(`.monaco-list${s} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(o.push(`.monaco-list${s}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),o.push(`.monaco-list${s}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&o.push(`.monaco-list${s}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(o.push(`.monaco-list${s}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),o.push(`.monaco-list${s}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&o.push(`.monaco-list${s}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&o.push(`.monaco-list${s}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&o.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&o.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(o.push(`.monaco-list${s} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),o.push(`.monaco-list${s} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&o.push(`.monaco-list${s} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(o.push(`.monaco-list${s} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),o.push(`.monaco-list${s} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(o.push(`.monaco-list${s} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),o.push(`.monaco-list${s} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&o.push(`.monaco-list${s} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&o.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&o.push(`.monaco-list${s}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const r=jh(e.listFocusAndSelectionOutline,jh(e.listSelectionOutline,(t=e.listFocusOutline)!==null&&t!==void 0?t:""));r&&o.push(`.monaco-list${s}:focus .monaco-list-row.focused.selected { outline: 1px solid ${r}; outline-offset: -1px;}`),e.listFocusOutline&&o.push(`
				.monaco-drag-image,
				.monaco-list${s}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const a=jh(e.listSelectionOutline,(i=e.listInactiveFocusOutline)!==null&&i!==void 0?i:"");a&&o.push(`.monaco-list${s} .monaco-list-row.focused.selected { outline: 1px dotted ${a}; outline-offset: -1px; }`),e.listSelectionOutline&&o.push(`.monaco-list${s} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&o.push(`.monaco-list${s} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&o.push(`.monaco-list${s} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropBackground&&o.push(`
				.monaco-list${s}.drop-target,
				.monaco-list${s} .monaco-list-rows.drop-target,
				.monaco-list${s} .monaco-list-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }
			`),e.tableColumnsBorder&&o.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&o.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=o.join(`
`)}}const uke={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropBackground:"#383B3D",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:z.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:z.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:z.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0},hke={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function fke(n,e){const t=n.indexOf(e);if(t===-1)return[];const i=[];let s=t-1;for(;s>=0&&n[s]===e-(t-s);)i.push(n[s--]);for(i.reverse(),s=t;s<n.length&&n[s]===e+(s-t);)i.push(n[s++]);return i}function ON(n,e){const t=[];let i=0,s=0;for(;i<n.length||s<e.length;)if(i>=n.length)t.push(e[s++]);else if(s>=e.length)t.push(n[i++]);else if(n[i]===e[s]){t.push(n[i]),i++,s++;continue}else n[i]<e[s]?t.push(n[i++]):t.push(e[s++]);return t}function gke(n,e){const t=[];let i=0,s=0;for(;i<n.length||s<e.length;)if(i>=n.length)t.push(e[s++]);else if(s>=e.length)t.push(n[i++]);else if(n[i]===e[s]){i++,s++;continue}else n[i]<e[s]?t.push(n[i++]):s++;return t}const y6=(n,e)=>n-e;class pke{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,s){let o=0;for(const r of this.renderers)r.renderElement(e,t,i[o++],s)}disposeElement(e,t,i,s){var o;let r=0;for(const a of this.renderers)(o=a.disposeElement)===null||o===void 0||o.call(a,e,t,i[r],s),r+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class mke{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return e}renderElement(e,t,i){const s=this.accessibilityProvider.getAriaLabel(e);s?i.setAttribute("aria-label",s):i.removeAttribute("aria-label");const o=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof o=="number"?i.setAttribute("aria-level",`${o}`):i.removeAttribute("aria-level")}disposeTemplate(e){}}class _ke{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,e,t)}onDragOver(e,t,i,s){return this.dnd.onDragOver(e,t,i,s)}onDragLeave(e,t,i,s){var o,r;(r=(o=this.dnd).onDragLeave)===null||r===void 0||r.call(o,e,t,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}drop(e,t,i,s){this.dnd.drop(e,t,i,s)}dispose(){this.dnd.dispose()}}class ca{get onDidChangeFocus(){return ue.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return ue.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=ue.chain(this.disposables.add(new rt(this.view.domNode,"keydown")).event,o=>o.map(r=>new zt(r)).filter(r=>e=r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>Ue.stop(r,!0)).filter(()=>!1)),i=ue.chain(this.disposables.add(new rt(this.view.domNode,"keyup")).event,o=>o.forEach(()=>e=!1).map(r=>new zt(r)).filter(r=>r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>Ue.stop(r,!0)).map(({browserEvent:r})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,d=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:d,browserEvent:r}})),s=ue.chain(this.view.onContextMenu,o=>o.filter(r=>!e).map(({element:r,index:a,browserEvent:l})=>({element:r,index:a,anchor:new ar(l),browserEvent:l})));return ue.any(t,i,s)}get onKeyDown(){return this.disposables.add(new rt(this.view.domNode,"keydown")).event}get onDidFocus(){return ue.signal(this.disposables.add(new rt(this.view.domNode,"focus",!0)).event)}constructor(e,t,i,s,o=hke){var r,a,l,c;this.user=e,this._options=o,this.focus=new Lx("focused"),this.anchor=new Lx("anchor"),this.eventBufferer=new G4,this._ariaLabel="",this.disposables=new pe,this._onDidDispose=new B,this.onDidDispose=this._onDidDispose.event;const d=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(r=this._options.accessibilityProvider)===null||r===void 0?void 0:r.getWidgetRole():"list";this.selection=new rke(d!=="listbox");const u=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(u.push(new mke(this.accessibilityProvider)),(l=(a=this.accessibilityProvider).onDidChangeActiveDescendant)===null||l===void 0||l.call(a,this.onDidChangeActiveDescendant,this,this.disposables)),s=s.map(f=>new pke(f.templateId,[...u,f]));const h=Object.assign(Object.assign({},o),{dnd:o.dnd&&new _ke(this,o.dnd)});if(this.view=this.createListView(t,i,s,h),this.view.domNode.setAttribute("role",d),o.styleController)this.styleController=o.styleController(this.view.domId);else{const f=wr(this.view.domNode);this.styleController=new XG(f,this.view.domId)}if(this.spliceable=new ZDe([new kE(this.focus,this.view,o.identityProvider),new kE(this.selection,this.view,o.identityProvider),new kE(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new cke(this,this.view)),(typeof o.keyboardSupport!="boolean"||o.keyboardSupport)&&(this.keyboardController=new GG(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){const f=o.keyboardNavigationDelegate||ake;this.typeNavigationController=new lke(this,this.view,o.keyboardNavigationLabelProvider,(c=o.keyboardNavigationEventFilter)!==null&&c!==void 0?c:()=>!0,f),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,s){return new Yo(e,t,i,s)}createMouseController(e){return new ZG(this)}updateOptions(e={}){var t,i;this._options=Object.assign(Object.assign({},this._options),e),(t=this.typeNavigationController)===null||t===void 0||t.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(i=this.keyboardController)===null||i===void 0||i.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new bg(this.user,`Invalid start index: ${e}`);if(t<0)throw new bg(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new bg(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new bg(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return pU(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new bg(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,s){if(this.length===0)return;const o=this.focus.get(),r=this.findNextIndex(o.length>0?o[0]+e:0,t,s);r>-1&&this.setFocus([r],i)}focusPrevious(e=1,t=!1,i,s){if(this.length===0)return;const o=this.focus.get(),r=this.findPreviousIndex(o.length>0?o[0]-e:0,t,s);r>-1&&this.setFocus([r],i)}focusNextPage(e,t){return b6(this,void 0,void 0,function*(){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const s=this.getFocus()[0];if(s!==i&&(s===void 0||i>s)){const o=this.findPreviousIndex(i,!1,t);o>-1&&s!==o?this.setFocus([o],e):this.setFocus([i],e)}else{const o=this.view.getScrollTop();let r=o+this.view.renderHeight;i>s&&(r-=this.view.elementHeight(i)),this.view.setScrollTop(r),this.view.getScrollTop()!==o&&(this.setFocus([]),yield Hb(0),yield this.focusNextPage(e,t))}})}focusPreviousPage(e,t){return b6(this,void 0,void 0,function*(){let i;const s=this.view.getScrollTop();s===0?i=this.view.indexAt(s):i=this.view.indexAfter(s-1);const o=this.getFocus()[0];if(o!==i&&(o===void 0||o>=i)){const r=this.findNextIndex(i,!1,t);r>-1&&o!==r?this.setFocus([r],e):this.setFocus([i],e)}else{const r=s;this.view.setScrollTop(s-this.view.renderHeight),this.view.getScrollTop()!==r&&(this.setFocus([]),yield Hb(0),yield this.focusPreviousPage(e,t))}})}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const s=this.findNextIndex(e,!1,i);s>-1&&this.setFocus([s],t)}findNextIndex(e,t=!1,i){for(let s=0;s<this.length;s++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let s=0;s<this.length;s++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t){if(e<0||e>=this.length)throw new bg(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),s=this.view.elementTop(e),o=this.view.elementHeight(e);if(Xd(t)){const r=o-this.view.renderHeight;this.view.setScrollTop(r*ho(t,0,1)+s)}else{const r=s+o,a=i+this.view.renderHeight;s<i&&r>=a||(s<i||r>=a&&o>=this.view.renderHeight?this.view.setScrollTop(s):r>=a&&this.view.setScrollTop(r-this.view.renderHeight))}}getHTMLElement(){return this.view.domNode}getElementID(e){return this.view.getElementDomId(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var e;const t=this.focus.get();if(t.length>0){let i;!((e=this.accessibilityProvider)===null||e===void 0)&&e.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}qf([Di],ca.prototype,"onDidChangeFocus",null);qf([Di],ca.prototype,"onDidChangeSelection",null);qf([Di],ca.prototype,"onContextMenu",null);qf([Di],ca.prototype,"onKeyDown",null);qf([Di],ca.prototype,"onDidFocus",null);const Lh=we,QG="selectOption.entry.template";class bke{get templateId(){return QG}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=le(e,Lh(".option-text")),t.detail=le(e,Lh(".option-detail")),t.decoratorRight=le(e,Lh(".option-decorator-right")),t}renderElement(e,t,i){const s=i,o=e.text,r=e.detail,a=e.decoratorRight,l=e.isDisabled;s.text.textContent=o,s.detail.textContent=r||"",s.decoratorRight.innerText=a||"",l?s.root.classList.add("option-disabled"):s.root.classList.remove("option-disabled")}disposeTemplate(e){}}class Na extends Y{constructor(e,t,i,s,o){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=s,this.selectBoxOptions=o||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=Na.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new B,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}getHeight(){return 22}getTemplateId(){return QG}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=we(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=le(this.selectDropDownContainer,Lh(".select-box-details-pane"));const t=le(this.selectDropDownContainer,Lh(".select-box-dropdown-container-width-control")),i=le(t,Lh(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",le(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=wr(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(K(this.selectDropDownContainer,de.DRAG_START,s=>{Ue.stop(s,!0)}))}registerListeners(){this._register(Hi(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)})),this._register(K(this.selectElement,de.CLICK,t=>{Ue.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(K(this.selectElement,de.MOUSE_DOWN,t=>{Ue.stop(t)}));let e;this._register(K(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(K(this.selectElement,"touchend",t=>{Ue.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(K(this.selectElement,de.KEY_DOWN,t=>{const i=new zt(t);let s=!1;pt?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(s=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(s=!0),s&&(this.showSelectDropDown(),Ue.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){Ki(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,s)=>{this.selectElement.add(this.createOption(i.text,s,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){var e;(e=this.selectList)===null||e===void 0||e.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){var e,t,i;const s=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",o=(t=this.styles.selectForeground)!==null&&t!==void 0?t:"",r=(i=this.styles.selectBorder)!==null&&i!==void 0?i:"";this.selectElement.style.backgroundColor=s,this.selectElement.style.color=o,this.selectElement.style.borderColor=r}styleList(){var e,t;const i=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",s=jh(this.styles.selectListBackground,i);this.selectDropDownListContainer.style.backgroundColor=s,this.selectionDetailsPane.style.backgroundColor=s;const o=(t=this.styles.focusBorder)!==null&&t!==void 0?t:"";this.selectDropDownContainer.style.outlineColor=o,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const s=document.createElement("option");return s.value=e,s.text=e,s.disabled=!!i,s}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{try{e.removeChild(this.selectDropDownContainer)}catch{}}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=Nn(this.selectElement),i=getComputedStyle(this.selectElement),s=parseFloat(i.getPropertyValue("--dropdown-padding-top"))+parseFloat(i.getPropertyValue("--dropdown-padding-bottom")),o=window.innerHeight-t.top-t.height-(this.selectBoxOptions.minBottomMargin||0),r=t.top-Na.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,a=this.selectElement.offsetWidth,l=this.setWidthControlElement(this.widthControlElement),c=Math.max(l,Math.round(a)).toString()+"px";this.selectDropDownContainer.style.width=c,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let d=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const u=this._hasDetails?this._cachedMaxDetailsHeight:0,h=d+s+u,f=Math.floor((o-s-u)/this.getHeight()),g=Math.floor((r-s-u)/this.getHeight());if(e)return t.top+t.height>window.innerHeight-22||t.top<Na.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&g<1?!1:(f<Na.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&g>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownContainer.removeChild(this.selectDropDownListContainer),this.selectDropDownContainer.removeChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(t.top+t.height>window.innerHeight-22||t.top<Na.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&g<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+g<1)return this.hideSelectDropDown(!0),!1;h>o&&(d=f*this.getHeight())}else h>r&&(d=g*this.getHeight());return this.selectList.layout(d),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=d+s+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=d+s+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=c,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,s=0;this.options.forEach((o,r)=>{const a=o.detail?o.detail.length:0,l=o.decoratorRight?o.decoratorRight.length:0,c=o.text.length+a+l;c>s&&(i=r,s=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=ys(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=le(e,Lh(".select-box-dropdown-list-container")),this.listRenderer=new bke,this.selectList=new ca("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:s=>{let o=s.text;return s.detail&&(o+=`. ${s.detail}`),s.decoratorRight&&(o+=`. ${s.decoratorRight}`),s.description&&(o+=`. ${s.description}`),o},getWidgetAriaLabel:()=>m({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>pt?"":"option",getWidgetRole:()=>"listbox"}}),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new rt(this.selectDropDownListContainer,"keydown")),i=ue.chain(t.event,s=>s.filter(()=>this.selectList.length>0).map(o=>new zt(o)));this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===3))(this.onEnter,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===2))(this.onEnter,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===9))(this.onEscape,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===16))(this.onUpArrow,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===18))(this.onDownArrow,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===12))(this.onPageDown,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===11))(this.onPageUp,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===14))(this.onHome,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode===13))(this.onEnd,this)),this._register(ue.chain(i,s=>s.filter(o=>o.keyCode>=21&&o.keyCode<=56||o.keyCode>=85&&o.keyCode<=113))(this.onCharacter,this)),this._register(K(this.selectList.getHTMLElement(),de.POINTER_UP,s=>this.onPointerUp(s))),this._register(this.selectList.onMouseOver(s=>typeof s.index<"u"&&this.selectList.setFocus([s.index]))),this._register(this.selectList.onDidChangeFocus(s=>this.onListFocus(s))),this._register(K(this.selectDropDownContainer,de.FOCUS_OUT,s=>{!this._isVisible||Cn(s.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;Ue.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const s=Number(i.getAttribute("data-index")),o=i.classList.contains("option-disabled");s>=0&&s<this.options.length&&!o&&(this.selected=s,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=o=>{for(let r=0;r<o.childNodes.length;r++){const a=o.childNodes.item(r);(a.tagName&&a.tagName.toLowerCase())==="img"?o.removeChild(a):i(a)}},s=ek({value:e,supportThemeIcons:!0},{actionHandler:t});return s.element.classList.add("select-box-description-markdown"),i(s.element),s.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){var t,i;this.selectionDetailsPane.innerText="";const s=this.options[e],o=(t=s==null?void 0:s.description)!==null&&t!==void 0?t:"",r=(i=s==null?void 0:s.descriptionIsMarkdown)!==null&&i!==void 0?i:!1;if(o){if(r){const a=s.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(o,a))}else this.selectionDetailsPane.innerText=o;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){Ue.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){Ue.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&(this.selectElement.title=this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){Ue.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(Ue.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){Ue.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){Ue.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){Ue.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){Ue.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=Fl.toString(e.keyCode);let i=-1;for(let s=0;s<this.options.length-1;s++)if(i=(s+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),Ue.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}}Na.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32;Na.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2;Na.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;class vke extends Y{constructor(e,t,i,s){super(),this.selected=0,this.selectBoxOptions=s||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new B),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Rt.addTarget(this.selectElement)),[Pt.Tap].forEach(e=>{this._register(K(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(Hi(this.selectElement,"click",e=>{Ue.stop(e,!0)})),this._register(Hi(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(Hi(this.selectElement,"keydown",e=>{let t=!1;pt?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!Ki(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,s)=>{this.selectElement.add(this.createOption(i.text,s,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){var e,t,i;this.selectElement&&(this.selectElement.style.backgroundColor=(e=this.styles.selectBackground)!==null&&e!==void 0?e:"",this.selectElement.style.color=(t=this.styles.selectForeground)!==null&&t!==void 0?t:"",this.selectElement.style.borderColor=(i=this.styles.selectBorder)!==null&&i!==void 0?i:"")}createOption(e,t,i){const s=document.createElement("option");return s.value=e,s.text=e,s.disabled=!!i,s}}class yke extends la{constructor(e,t,i,s,o){super(),pt&&!(o!=null&&o.useCustomDrawn)?this.selectBoxDelegate=new vke(e,t,s,o):this.selectBoxDelegate=new Na(e,t,i,s,o),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class jr extends Y{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof xo&&this._register(t.onDidChange(s=>{this.element&&this.handleActionChangeEvent(s)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new mm)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Rt.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,vr&&this._register(K(e,de.DRAG_START,s=>{var o;return(o=s.dataTransfer)===null||o===void 0?void 0:o.setData(NG.TEXT,this._action.label)}))),this._register(K(t,Pt.Tap,s=>this.onClick(s,!0))),this._register(K(t,de.MOUSE_DOWN,s=>{i||Ue.stop(s,!0),this._action.enabled&&s.button===0&&t.classList.add("active")})),pt&&this._register(K(t,de.CONTEXT_MENU,s=>{s.button===0&&s.ctrlKey===!0&&this.onClick(s)})),this._register(K(t,de.CLICK,s=>{Ue.stop(s,!0),this.options&&this.options.isMenu||this.onClick(s)})),this._register(K(t,de.DBLCLICK,s=>{Ue.stop(s,!0)})),[de.MOUSE_UP,de.MOUSE_OUT].forEach(s=>{this._register(K(t,s,o=>{Ue.stop(o),t.classList.remove("active")}))})}onClick(e,t=!1){var i;Ue.stop(e,!0);const s=mo(this._context)?!((i=this.options)===null||i===void 0)&&i.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,s)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getTooltip(){return this.action.tooltip}updateTooltip(){var e;if(!this.element)return;const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.updateAriaLabel(),this.options.hoverDelegate?(this.element.title="",this.customHover?this.customHover.update(t):(this.customHover=UG(this.options.hoverDelegate,this.element,t),this._store.add(this.customHover))):this.element.title=t}updateAriaLabel(){var e;if(this.element){const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.element.setAttribute("aria-label",t)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class tk extends jr{constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),this.element&&(this.label=le(this.element,we("a.action-label"))),this.label&&this.label.setAttribute("role",this.getDefaultAriaRole()),this.options.label&&this.options.keybinding&&this.element&&(le(this.element,we("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Mn.ID?"presentation":this.options.isMenu?"menuitem":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=m({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){var e;this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.action.class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):(e=this.label)===null||e===void 0||e.classList.remove("codicon")}updateEnabled(){var e,t;this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),(e=this.element)===null||e===void 0||e.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),(t=this.element)===null||t===void 0||t.classList.add("disabled"))}updateAriaLabel(){var e;if(this.label){const t=(e=this.getTooltip())!==null&&e!==void 0?e:"";this.label.setAttribute("aria-label",t)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox")):(this.label.classList.remove("checked"),this.label.setAttribute("aria-checked",""),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class wke extends jr{constructor(e,t,i,s,o,r,a){super(e,t),this.selectBox=new yke(i,s,o,r,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){var e;(e=this.selectBox)===null||e===void 0||e.focus()}blur(){var e;(e=this.selectBox)===null||e===void 0||e.blur()}render(e){this.selectBox.render(e)}}class Cke extends mm{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new B),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=le(e,we(".monaco-dropdown")),this._label=le(this._element,we(".dropdown-label"));let i=t.labelRenderer;i||(i=o=>(o.textContent=t.label||"",null));for(const o of[de.CLICK,de.MOUSE_DOWN,Pt.Tap])this._register(K(this.element,o,r=>Ue.stop(r,!0)));for(const o of[de.MOUSE_DOWN,Pt.Tap])this._register(K(this._label,o,r=>{r instanceof MouseEvent&&(r.detail>1||r.button!==0)||(this.visible?this.hide():this.show())}));this._register(K(this._label,de.KEY_UP,o=>{const r=new zt(o);(r.equals(3)||r.equals(10))&&(Ue.stop(o,!0),this.visible?this.hide():this.show())}));const s=i(this._label);s&&this._register(s),this._register(Rt.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class Ske extends Cke{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class Dx extends jr{constructor(e,t,i,s=Object.create(null)){super(null,e,s),this.actionItem=null,this._onDidChangeVisibility=this._register(new B),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=s,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=o=>{this.element=le(o,we("a.action-label"));let r=[];return typeof this.options.classNames=="string"?r=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(r=this.options.classNames),r.find(a=>a==="icon")||r.push("codicon"),this.element.classList.add(...r),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),s={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Ske(e,s)),this._register(this.dropdownMenu.onDidChangeVisibility(o=>{var r;(r=this.element)===null||r===void 0||r.setAttribute("aria-expanded",`${o}`),this._onDidChangeVisibility.fire(o)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const o=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return o.options.anchorAlignmentProvider()}})}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){var e;(e=this.dropdownMenu)===null||e===void 0||e.show()}updateEnabled(){var e,t;const i=!this.action.enabled;(e=this.actionItem)===null||e===void 0||e.classList.toggle("disabled",i),(t=this.element)===null||t===void 0||t.classList.toggle("disabled",i)}}function xke(n){return n?n.condition!==void 0:!1}var g_=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},Dp;(function(n){n[n.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",n[n.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Dp||(Dp={}));var Jg;(function(n){n[n.None=0]="None",n[n.Initialized=1]="Initialized",n[n.Closed=2]="Closed"})(Jg||(Jg={}));class kp extends Y{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new Rb),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=Jg.None,this.cache=new Map,this.flushDelayer=this._register(new Aj(kp.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)===null||t===void 0||t.forEach((s,o)=>this.acceptExternal(o,s)),(i=e.deleted)===null||i===void 0||i.forEach(s=>this.acceptExternal(s,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===Jg.Closed)return;let i=!1;mo(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return mo(i)?t:i}getBoolean(e,t){const i=this.get(e);return mo(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return mo(i)?t:parseInt(i,10)}set(e,t,i=!1){return g_(this,void 0,void 0,function*(){if(this.state===Jg.Closed)return;if(mo(t))return this.delete(e,i);const s=Ls(t)||Array.isArray(t)?TDe(t):String(t);if(this.cache.get(e)!==s)return this.cache.set(e,s),this.pendingInserts.set(e,s),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()})}delete(e,t=!1){return g_(this,void 0,void 0,function*(){if(!(this.state===Jg.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()})}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return g_(this,void 0,void 0,function*(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())===null||t===void 0||t()})})}doFlush(e){return g_(this,void 0,void 0,function*(){return this.options.hint===Dp.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)})}}kp.DEFAULT_FLUSH_DELAY=100;class EE{constructor(){this.onDidChangeItemsExternal=ue.None,this.items=new Map}updateItems(e){var t,i;return g_(this,void 0,void 0,function*(){(t=e.insert)===null||t===void 0||t.forEach((s,o)=>this.items.set(o,s)),(i=e.delete)===null||i===void 0||i.forEach(s=>this.items.delete(s))})}}const zC="__$__targetStorageMarker",Gf=at("storageService");var w6;(function(n){n[n.NONE=0]="NONE",n[n.SHUTDOWN=1]="SHUTDOWN"})(w6||(w6={}));function Lke(n){const e=n.get(zC);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}class ik extends Y{constructor(e={flushInterval:ik.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new Rb),this._onDidChangeTarget=this._register(new Rb),this._onWillSaveState=this._register(new B),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,i){return ue.filter(this._onDidChangeValue.event,s=>s.scope===e&&(t===void 0||s.key===t),i)}emitDidChangeValue(e,t){const{key:i,external:s}=t;if(i===zC){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:s})}get(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.get(e,i)}getBoolean(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.getBoolean(e,i)}getNumber(e,t,i){var s;return(s=this.getStorage(t))===null||s===void 0?void 0:s.getNumber(e,i)}store(e,t,i,s,o=!1){if(mo(t)){this.remove(e,i,o);return}this.withPausedEmitters(()=>{var r;this.updateKeyTarget(e,i,s),(r=this.getStorage(i))===null||r===void 0||r.set(e,t,o)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var s;this.updateKeyTarget(e,t,void 0),(s=this.getStorage(t))===null||s===void 0||s.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,s=!1){var o,r;const a=this.getKeyTargets(t);typeof i=="number"?a[e]!==i&&(a[e]=i,(o=this.getStorage(t))===null||o===void 0||o.set(zC,JSON.stringify(a),s)):typeof a[e]=="number"&&(delete a[e],(r=this.getStorage(t))===null||r===void 0||r.set(zC,JSON.stringify(a),s))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?Lke(t):Object.create(null)}}ik.DEFAULT_FLUSH_INTERVAL=60*1e3;class Dke extends ik{constructor(){super(),this.applicationStorage=this._register(new kp(new EE,{hint:Dp.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new kp(new EE,{hint:Dp.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new kp(new EE,{hint:Dp.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function kke(n,e){const t=Object.assign({},e);for(const i in n){const s=n[i];t[i]=s!==void 0?re(s):void 0}return t}const Eke={keybindingLabelBackground:re(fve),keybindingLabelForeground:re(gve),keybindingLabelBorder:re(pve),keybindingLabelBottomBorder:re(mve),keybindingLabelShadow:re(Yl)},Ake={buttonForeground:re(t_),buttonSeparator:re(Jbe),buttonBackground:re(i_),buttonHoverBackground:re(eve),buttonSecondaryForeground:re(ive),buttonSecondaryBackground:re(UT),buttonSecondaryHoverBackground:re(nve),buttonBorder:re(tve)},Ike={progressBarBackground:re(rve)},kx={inputActiveOptionBorder:re(EP),inputActiveOptionForeground:re(AP),inputActiveOptionBackground:re(Ch)};re(Uve),re(qve),re(jve);re(zi),re(Ba),re(Yl),re(Je),re(l1e),re(c1e),re(d1e),re(Wbe);const Ex={inputBackground:re(Vbe),inputForeground:re(zbe),inputBorder:re(Hbe),inputValidationInfoBorder:re(jbe),inputValidationInfoBackground:re($be),inputValidationInfoForeground:re(Ube),inputValidationWarningBorder:re(Kbe),inputValidationWarningBackground:re(qbe),inputValidationWarningForeground:re(Gbe),inputValidationErrorBorder:re(Xbe),inputValidationErrorBackground:re(Ybe),inputValidationErrorForeground:re(Zbe)},Tke={listFilterWidgetBackground:re(Fve),listFilterWidgetOutline:re(Bve),listFilterWidgetNoMatchesOutline:re(Wve),listFilterWidgetShadow:re(Vve),inputBoxStyles:Ex,toggleStyles:kx},JG={badgeBackground:re(NC),badgeForeground:re(sve),badgeBorder:re(Je)};re(t1e),re(e1e),re(k7),re(k7),re(i1e);const Kf={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:re(kve),listFocusForeground:re(Eve),listFocusOutline:re(Ave),listActiveSelectionBackground:re(Xl),listActiveSelectionForeground:re(Va),listActiveSelectionIconForeground:re(r_),listFocusAndSelectionOutline:re(Ive),listFocusAndSelectionBackground:re(Xl),listFocusAndSelectionForeground:re(Va),listInactiveSelectionBackground:re(Tve),listInactiveSelectionIconForeground:re(Rve),listInactiveSelectionForeground:re(Nve),listInactiveFocusBackground:re(Mve),listInactiveFocusOutline:re(Pve),listHoverBackground:re(hq),listHoverForeground:re(fq),listDropBackground:re(Ove),listSelectionOutline:re(jt),listHoverOutline:re(jt),treeIndentGuidesStroke:re(a_),treeInactiveIndentGuidesStroke:re(zve),tableColumnsBorder:re(Hve),tableOddRowsBackgroundColor:re($ve)};function my(n){return kke(n,Kf)}const Nke={selectBackground:re(Oa),selectListBackground:re(Qbe),selectForeground:re(Zl),decoratorRightForeground:re(dq),selectBorder:re(Vg),focusBorder:re(yo),listFocusBackground:re(KT),listInactiveSelectionIconForeground:re(gq),listFocusForeground:re(GT),listFocusOutline:Obe(jt,z.transparent.toString()),listHoverBackground:re(hq),listHoverForeground:re(fq),listHoverOutline:re(jt),selectListBorder:re(zg),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0},Rke={shadowColor:re(Yl),borderColor:re(Gve),foregroundColor:re(Kve),backgroundColor:re(Yve),selectionForegroundColor:re(Zve),selectionBackgroundColor:re(Xve),selectionBorderColor:re(Qve),separatorColor:re(Jve),scrollbarShadow:re(ove),scrollbarSliderBackground:re(n_),scrollbarSliderHoverBackground:re(s_),scrollbarSliderActiveBackground:re(o_)};var nk=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Ss=function(n,e){return function(t,i){e(t,i,n)}},eK=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function Mke(n,e,t,i){const s=n.getActions(e),o=od.getInstance(),r=o.keyStatus.altKey||(Ps||Xn)&&o.keyStatus.shiftKey;iK(s,t,r,i?a=>a===i:a=>a==="navigation")}function tK(n,e,t,i,s,o){const r=n.getActions(e);iK(r,t,!1,typeof i=="string"?l=>l===i:i,s,o)}function iK(n,e,t,i=r=>r==="navigation",s=()=>!1,o=!1){let r,a;Array.isArray(e)?(r=e,a=e):(r=e.primary,a=e.secondary);const l=new Set;for(const[c,d]of n){let u;i(c)?(u=r,u.length>0&&o&&u.push(new Mn)):(u=a,u.length>0&&u.push(new Mn));for(let h of d){t&&(h=h instanceof Xa&&h.alt?h.alt:h);const f=u.push(h);h instanceof pD&&l.add({group:c,action:h,index:f-1})}}for(const{group:c,action:d,index:u}of l){const h=i(c)?r:a,f=d.actions;s(d,c,h.length)&&h.splice(u,1,...f)}}let Mm=class extends tk{constructor(e,t,i,s,o,r,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable,keybinding:t==null?void 0:t.keybinding,hoverDelegate:t==null?void 0:t.hoverDelegate}),this._keybindingService=i,this._notificationService=s,this._contextKeyService=o,this._themeService=r,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new ta),this._altKey=od.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return eK(this,void 0,void 0,function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}})}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{var s;const o=!!(!((s=this._menuItemAction.alt)===null||s===void 0)&&s.enabled)&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);o!==this._wantsAltCommand&&(this._wantsAltCommand=o,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(K(e,"mouseleave",s=>{t=!1,i()})),this._register(K(e,"mouseenter",s=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){var e;const t=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),i=t&&t.getLabel(),s=this._commandAction.tooltip||this._commandAction.label;let o=i?m("titleAndKb","{0} ({1})",s,i):s;if(!this._wantsAltCommand&&(!((e=this._menuItemAction.alt)===null||e===void 0)&&e.enabled)){const r=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,a=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),l=a&&a.getLabel(),c=l?m("titleAndKb","{0} ({1})",r,l):r;o=m("titleAndKbAndAlt",`{0}
[{1}] {2}`,o,a3.modifierLabels[vo].altKey,c)}return o}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const s=this._commandAction.checked&&xke(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(s)if(Ne.isThemeIcon(s)){const o=Ne.asClassNameArray(s);i.classList.add(...o),this._itemClassDispose.value=Ze(()=>{i.classList.remove(...o)})}else{const o=$D(this._themeService.getColorTheme().type)?tu(s.dark):tu(s.light),r=we("span");r.style.webkitMask=r.style.mask=`${o} no-repeat 50% 50%`,r.style.background="var(--vscode-icon-foreground)",r.style.display="inline-block",r.style.width="100%",r.style.height="100%",i.appendChild(r),i.classList.add("icon"),this._itemClassDispose.value=fr(Ze(()=>{i.classList.remove("icon"),cs(i)}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}}};Mm=nk([Ss(2,bi),Ss(3,Ln),Ss(4,tt),Ss(5,ao),Ss(6,Au),Ss(7,Du)],Mm);let FN=class extends Dx{constructor(e,t,i,s,o){var r,a,l;const c=Object.assign(Object.assign({},t),{menuAsChild:(r=t==null?void 0:t.menuAsChild)!==null&&r!==void 0?r:!1,classNames:(a=t==null?void 0:t.classNames)!==null&&a!==void 0?a:Ne.isThemeIcon(e.item.icon)?Ne.asClassName(e.item.icon):void 0,keybindingProvider:(l=t==null?void 0:t.keybindingProvider)!==null&&l!==void 0?l:d=>i.lookupKeybinding(d.id)});super(e,{getActions:()=>e.actions},s,c),this._keybindingService=i,this._contextMenuService=s,this._themeService=o}render(e){super.render(e),xs(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!Ne.isThemeIcon(i)){this.element.classList.add("icon");const s=()=>{this.element&&(this.element.style.backgroundImage=$D(this._themeService.getColorTheme().type)?tu(i.dark):tu(i.light))};s(),this._register(this._themeService.onDidColorThemeChange(()=>{s()}))}}};FN=nk([Ss(2,bi),Ss(3,Au),Ss(4,ao)],FN);let BN=class extends jr{constructor(e,t,i,s,o,r,a,l){var c,d,u;super(null,e),this._keybindingService=i,this._notificationService=s,this._contextMenuService=o,this._menuService=r,this._instaService=a,this._storageService=l,this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let h;const f=t!=null&&t.persistLastActionId?l.get(this._storageKey,1):void 0;f&&(h=e.actions.find(p=>f===p.id)),h||(h=e.actions[0]),this._defaultAction=this._instaService.createInstance(Mm,h,{keybinding:this._getDefaultActionKeybindingLabel(h)});const g=Object.assign(Object.assign({keybindingProvider:p=>this._keybindingService.lookupKeybinding(p.id)},t),{menuAsChild:(c=t==null?void 0:t.menuAsChild)!==null&&c!==void 0?c:!0,classNames:(d=t==null?void 0:t.classNames)!==null&&d!==void 0?d:["codicon","codicon-chevron-down"],actionRunner:(u=t==null?void 0:t.actionRunner)!==null&&u!==void 0?u:new mm});this._dropdown=new Dx(e,e.actions,this._contextMenuService,g),this._dropdown.actionRunner.onDidRun(p=>{p.action instanceof Xa&&this.update(p.action)})}update(e){var t;!((t=this._options)===null||t===void 0)&&t.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Mm,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends mm{runAction(i,s){return eK(this,void 0,void 0,function*(){yield i.run(void 0)})}},this._container&&this._defaultAction.render(yj(this._container,we(".action-container")))}_getDefaultActionKeybindingLabel(e){var t;let i;if(!((t=this._options)===null||t===void 0)&&t.renderKeybindingWithDefaultActionLabel){const s=this._keybindingService.lookupKeybinding(e.id);s&&(i=`(${s.getLabel()})`)}return i}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=we(".action-container");this._defaultAction.render(le(this._container,t)),this._register(K(t,de.KEY_DOWN,s=>{const o=new zt(s);o.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),o.stopPropagation())}));const i=we(".dropdown-action-container");this._dropdown.render(le(this._container,i)),this._register(K(i,de.KEY_DOWN,s=>{var o;const r=new zt(s);r.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(o=this._defaultAction.element)===null||o===void 0||o.focus(),r.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};BN=nk([Ss(2,bi),Ss(3,Ln),Ss(4,Au),Ss(5,Su),Ss(6,vt),Ss(7,Gf)],BN);let WN=class extends wke{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===Mn.ID?"":i.label,isDisabled:!i.enabled})),0,t,Nke,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=re(Vg)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};WN=nk([Ss(1,Eu)],WN);function Pke(n,e,t){return e instanceof Xa?n.createInstance(Mm,e,t):e instanceof HS?e.item.isSelection?n.createInstance(WN,e):e.item.rememberDefaultAction?n.createInstance(BN,e,Object.assign(Object.assign({},t),{persistLastActionId:!0})):n.createInstance(FN,e,t):void 0}var Oke=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class il extends Y{constructor(e,t={}){var i,s,o,r,a,l;super(),this._actionRunnerDisposables=this._register(new pe),this.viewItemDisposables=this._register(new j4),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new B),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new B({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new B),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new B),this.onWillRun=this._onWillRun.event,this.options=t,this._context=(i=t.context)!==null&&i!==void 0?i:null,this._orientation=(s=this.options.orientation)!==null&&s!==void 0?s:0,this._triggerKeys={keyDown:(r=(o=this.options.triggerKeys)===null||o===void 0?void 0:o.keyDown)!==null&&r!==void 0?r:!1,keys:(l=(a=this.options.triggerKeys)===null||a===void 0?void 0:a.keys)!==null&&l!==void 0?l:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new mm,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(u=>this._onDidRun.fire(u))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(u=>this._onWillRun.fire(u))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",t.animated!==!1&&this.domNode.classList.add("animated");let c,d;switch(this._orientation){case 0:c=[15],d=[17];break;case 1:c=[16],d=[18],this.domNode.className+=" vertical";break}this._register(K(this.domNode,de.KEY_DOWN,u=>{const h=new zt(u);let f=!0;const g=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;c&&(h.equals(c[0])||h.equals(c[1]))?f=this.focusPrevious():d&&(h.equals(d[0])||h.equals(d[1]))?f=this.focusNext():h.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():h.equals(14)?f=this.focusFirst():h.equals(13)?f=this.focusLast():h.equals(2)&&g instanceof jr&&g.trapsArrowNavigation?f=this.focusNext():this.isTriggerKeyEvent(h)?this._triggerKeys.keyDown?this.doTrigger(h):this.triggerKeyDown=!0:f=!1,f&&(h.preventDefault(),h.stopPropagation())})),this._register(K(this.domNode,de.KEY_UP,u=>{const h=new zt(u);this.isTriggerKeyEvent(h)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(h)),h.preventDefault(),h.stopPropagation()):(h.equals(2)||h.equals(1026))&&this.updateFocusedItem()})),this.focusTracker=this._register(eu(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Xr()===this.domNode||!Cn(Xr(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=2?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof jr&&i.isEnabled());t instanceof jr&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof jr&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(Cn(Xr(),t)){this.focusedItem=e;break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){var t;if(typeof e=="number")return(t=this.viewItems[e])===null||t===void 0?void 0:t.action;if(e instanceof HTMLElement){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let i=0;i<this.actionsList.childNodes.length;i++)if(this.actionsList.childNodes[i]===e)return this.viewItems[i].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let s=Xd(t.index)?t.index:null;i.forEach(o=>{const r=document.createElement("li");r.className="action-item",r.setAttribute("role","presentation");let a;const l=Object.assign({hoverDelegate:this.options.hoverDelegate},t);this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(o,l)),a||(a=new tk(this.context,o,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,K(r,de.CONTEXT_MENU,c=>{Ue.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(r),this.focusable&&a instanceof jr&&this.viewItems.length===0&&a.setFocusable(!0),s===null||s<0||s>=this.actionsList.children.length?(this.actionsList.appendChild(r),this.viewItems.push(a)):(this.actionsList.insertBefore(r,this.actionsList.children[s]),this.viewItems.splice(s,0,a),s++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=Ft(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),Lo(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const s=this.viewItems.findIndex(o=>o.isEnabled());this.focusedItem=s===-1?void 0:s,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=t,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Mn.ID));return this.updateFocus(),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Mn.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var s;typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&((s=this.viewItems[this.previouslyFocusedItem])===null||s===void 0||s.blur());const o=this.focusedItem!==void 0&&this.viewItems[this.focusedItem];if(o){let r=!0;AS(o.focus)||(r=!1),this.options.focusOnlyEnabledItems&&AS(o.isEnabled)&&!o.isEnabled()&&(r=!1),o.action.id===Mn.ID&&(r=!1),r?(i||this.previouslyFocusedItem!==this.focusedItem)&&(o.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0)}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof jr){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}run(e,t){return Oke(this,void 0,void 0,function*(){yield this._actionRunner.run(e,t)})}dispose(){this._context=void 0,this.viewItems=Ft(this.viewItems),this.getContainer().remove(),super.dispose()}}const VN=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,AE=/(&amp;)?(&amp;)([^\s&])/g;var Ax;(function(n){n[n.Right=0]="Right",n[n.Left=1]="Left"})(Ax||(Ax={}));class Ep extends il{constructor(e,t,i,s){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const o=document.createElement("div");o.classList.add("monaco-menu"),o.setAttribute("role","presentation"),super(o,{orientation:1,actionViewItemProvider:l=>this.doGetActionViewItem(l,i,r),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...pt||Xn?[10]:[]],keyDown:!0}}),this.menuStyles=s,this.menuElement=o,this.actionsList.tabIndex=0,this.menuDisposables=this._register(new pe),this.initializeOrUpdateStyleSheet(e,s),this._register(Rt.addTarget(o)),K(o,de.KEY_DOWN,l=>{new zt(l).equals(2)&&l.preventDefault()}),i.enableMnemonics&&this.menuDisposables.add(K(o,de.KEY_DOWN,l=>{const c=l.key.toLocaleLowerCase();if(this.mnemonics.has(c)){Ue.stop(l,!0);const d=this.mnemonics.get(c);if(d.length===1&&(d[0]instanceof C6&&d[0].container&&this.focusItemByElement(d[0].container),d[0].onClick(l)),d.length>1){const u=d.shift();u&&u.container&&(this.focusItemByElement(u.container),d.push(u)),this.mnemonics.set(c,d)}}})),Xn&&this._register(K(o,de.KEY_DOWN,l=>{const c=new zt(l);c.equals(14)||c.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Ue.stop(l,!0)):(c.equals(13)||c.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Ue.stop(l,!0))})),this._register(K(this.domNode,de.MOUSE_OUT,l=>{const c=l.relatedTarget;Cn(c,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),l.stopPropagation())})),this._register(K(this.actionsList,de.MOUSE_OVER,l=>{let c=l.target;if(!(!c||!Cn(c,this.actionsList)||c===this.actionsList)){for(;c.parentElement!==this.actionsList&&c.parentElement!==null;)c=c.parentElement;if(c.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(c),d!==this.focusedItem&&this.updateFocus()}}})),this._register(Rt.addTarget(this.actionsList)),this._register(K(this.actionsList,Pt.Tap,l=>{let c=l.initialTarget;if(!(!c||!Cn(c,this.actionsList)||c===this.actionsList)){for(;c.parentElement!==this.actionsList&&c.parentElement!==null;)c=c.parentElement;if(c.classList.contains("action-item")){const d=this.focusedItem;this.setFocusedItem(c),d!==this.focusedItem&&this.updateFocus()}}}));const r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new FP(o,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,s),this._register(K(o,Pt.Change,l=>{Ue.stop(l,!0);const c=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:c-l.translationY})})),this._register(K(a,de.MOUSE_UP,l=>{l.preventDefault()})),o.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter(l=>{var c;return!((c=i.submenuIds)===null||c===void 0)&&c.has(l.id)?(console.warn(`Found submenu cycle: ${l.id}`),!1):!0}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(l=>!(l instanceof S6)).forEach((l,c,d)=>{l.updatePositionInSet(c+1,d.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(xT(e)?this.styleSheet=wr(e):(Ep.globalStyleSheet||(Ep.globalStyleSheet=wr()),this.styleSheet=Ep.globalStyleSheet)),this.styleSheet.textContent=Bke(t,xT(e))}styleScrollElement(e,t){var i,s;const o=(i=t.foregroundColor)!==null&&i!==void 0?i:"",r=(s=t.backgroundColor)!==null&&s!==void 0?s:"",a=t.borderColor?`1px solid ${t.borderColor}`:"",l="5px",c=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=a,e.style.borderRadius=l,e.style.color=o,e.style.backgroundColor=r,e.style.boxShadow=c}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof Mn)return new S6(t.context,e,{icon:!0},this.menuStyles);if(e instanceof pD){const s=new C6(e,e.actions,i,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}),this.menuStyles);if(t.enableMnemonics){const o=s.getMnemonic();if(o&&s.isEnabled()){let r=[];this.mnemonics.has(o)&&(r=this.mnemonics.get(o)),r.push(s),this.mnemonics.set(o,r)}}return s}else{const s={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const r=t.getKeyBinding(e);if(r){const a=r.getLabel();a&&(s.keybinding=a)}}const o=new nK(t.context,e,s,this.menuStyles);if(t.enableMnemonics){const r=o.getMnemonic();if(r&&o.isEnabled()){let a=[];this.mnemonics.has(r)&&(a=this.mnemonics.get(r)),a.push(o),this.mnemonics.set(r,a)}}return o}}}class nK extends jr{constructor(e,t,i,s){if(i.isMenu=!0,super(t,t,i),this.menuStyle=s,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const o=this.action.label;if(o){const r=VN.exec(o);r&&(this.mnemonic=(r[1]?r[1]:r[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new Li(()=>{this.element&&(this._register(K(this.element,de.MOUSE_UP,o=>{if(Ue.stop(o,!0),vr){if(new ar(o).rightButton)return;this.onClick(o)}else setTimeout(()=>{this.onClick(o)},0)})),this._register(K(this.element,de.CONTEXT_MENU,o=>{Ue.stop(o,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=le(this.element,we("a.action-menu-item")),this._action.id===Mn.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=le(this.item,we("span.menu-item-check"+Ne.asCSSSelector(se.menuSelection))),this.check.setAttribute("role","none"),this.label=le(this.item,we("span.action-label")),this.options.label&&this.options.keybinding&&(le(this.item,we("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){var e;super.focus(),(e=this.item)===null||e===void 0||e.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){var e;if(this.label&&this.options.label){Lo(this.label);let t=$G(this.action.label);if(t){const i=Fke(t);this.options.enableMnemonics||(t=i),this.label.setAttribute("aria-label",i.replace(/&&/g,"&"));const s=VN.exec(t);if(s){t=FS(t),AE.lastIndex=0;let o=AE.exec(t);for(;o&&o[1];)o=AE.exec(t);const r=a=>a.replace(/&amp;&amp;/g,"&amp;");o?this.label.append(gD(r(t.substr(0,o.index))," "),we("u",{"aria-hidden":"true"},o[3]),Uge(r(t.substr(o.index+o[0].length))," ")):this.label.innerText=r(t).trim(),(e=this.item)===null||e===void 0||e.setAttribute("aria-keyshortcuts",(s[1]?s[1]:s[3]).toLocaleLowerCase())}else this.label.innerText=t.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,s=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",o=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=s,this.item.style.outlineOffset=o),this.check&&(this.check.style.color=t??"")}}class C6 extends nK{constructor(e,t,i,s,o){super(e,e,s,o),this.submenuActions=t,this.parentData=i,this.submenuOptions=s,this.mysubmenu=null,this.submenuDisposables=this._register(new pe),this.mouseOver=!1,this.expandDirection=s&&s.expandDirection!==void 0?s.expandDirection:Ax.Right,this.showScheduler=new Li(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new Li(()=>{this.element&&!Cn(Xr(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=le(this.item,we("span.submenu-indicator"+Ne.asCSSSelector(se.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(K(this.element,de.KEY_UP,t=>{const i=new zt(t);(i.equals(17)||i.equals(3))&&(Ue.stop(t,!0),this.createSubmenu(!0))})),this._register(K(this.element,de.KEY_DOWN,t=>{const i=new zt(t);Xr()===this.item&&(i.equals(17)||i.equals(3))&&Ue.stop(t,!0)})),this._register(K(this.element,de.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(K(this.element,de.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(K(this.element,de.FOCUS_OUT,t=>{this.element&&!Cn(Xr(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){Ue.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,s){const o={top:0,left:0};return o.left=Zg(e.width,t.width,{position:s===Ax.Right?0:1,offset:i.left,size:i.width}),o.left>=i.left&&o.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(o.left=i.left+10),i.top+=10,i.height=0),o.top=Zg(e.height,t.height,{position:0,offset:i.top,size:0}),o.top+t.height===i.top&&o.top+i.height+t.height<=e.height&&(o.top+=i.height),o}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=le(this.element,we("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Ep(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new mD],this.submenuOptions,this.menuStyle);const s=this.element.getBoundingClientRect(),o={top:s.top-i,left:s.left,height:s.height+2*i,width:s.width},r=this.submenuContainer.getBoundingClientRect(),{top:a,left:l}=this.calculateSubmenuMenuLayout(new Qt(window.innerWidth,window.innerHeight),Qt.lift(r),o,this.expandDirection);this.submenuContainer.style.left=`${l-r.left}px`,this.submenuContainer.style.top=`${a-r.top}px`,this.submenuDisposables.add(K(this.submenuContainer,de.KEY_UP,c=>{new zt(c).equals(15)&&(Ue.stop(c,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(K(this.submenuContainer,de.KEY_DOWN,c=>{new zt(c).equals(15)&&Ue.stop(c,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)===null||t===void 0||t.setAttribute("aria-expanded",e))}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class S6 extends tk{constructor(e,t,i,s){super(e,t,i),this.menuStyles=s}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function Fke(n){const e=VN,t=e.exec(n);if(!t)return n;const i=!t[1];return n.replace(e,i?"$2$3":"").trim()}function x6(n){const e=UU()[n.id];return`.codicon-${n.id}:before { content: '\\${e.toString(16)}'; }`}function Bke(n,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${x6(se.menuSelection)}
${x6(se.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar.animated .action-item.active {
	transform: scale(1.272019649, 1.272019649); /* 1.272019649 =  */
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=n.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const s=n.scrollbarSliderBackground;s&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${s};
				}
			`);const o=n.scrollbarSliderHoverBackground;o&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${o};
				}
			`);const r=n.scrollbarSliderActiveBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${r};
				}
			`)}return t}class Wke{constructor(e,t,i,s){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=s,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=document.activeElement;let i;const s=hP(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:o=>{var r;this.lastContainer=o;const a=e.getMenuClassName?e.getMenuClassName():"";a&&(o.className+=" "+a),this.options.blockMouse&&(this.block=o.appendChild(we(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",(r=this.blockDisposable)===null||r===void 0||r.dispose(),this.blockDisposable=K(this.block,de.MOUSE_DOWN,d=>d.stopPropagation()));const l=new pe,c=e.actionRunner||new mm;return c.onWillRun(d=>this.onActionRun(d,!e.skipTelemetry),this,l),c.onDidRun(this.onDidActionRun,this,l),i=new Ep(o,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:c,getKeyBinding:e.getKeyBinding?e.getKeyBinding:d=>this.keybindingService.lookupKeybinding(d.id)},Rke),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,l),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,l),l.add(K(window,de.BLUR,()=>this.contextViewService.hideContextView(!0))),l.add(K(window,de.MOUSE_DOWN,d=>{if(d.defaultPrevented)return;const u=new ar(d);let h=u.target;if(!u.rightButton){for(;h;){if(h===o)return;h=h.parentElement}this.contextViewService.hideContextView(!0)}})),fr(l,i)},focus:()=>{i==null||i.focus(!!e.autoSelectFirstItem)},onHide:o=>{var r,a,l;(r=e.onHide)===null||r===void 0||r.call(e,!!o),this.block&&(this.block.remove(),this.block=null),(a=this.blockDisposable)===null||a===void 0||a.dispose(),this.blockDisposable=null,this.lastContainer&&(Xr()===this.lastContainer||Cn(Xr(),this.lastContainer))&&((l=this.focusToReturn)===null||l===void 0||l.focus()),this.lastContainer=null}},s,!!s)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!Rf(e.error)&&this.notificationService.error(e.error)}}var Vke=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},vg=function(n,e){return function(t,i){e(t,i,n)}};let zN=class extends Y{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new Wke(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,s,o,r){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=s,this.menuService=o,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new B),this._onDidHideContextMenu=this._store.add(new B)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=HN.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},e),{onHide:t=>{var i;(i=e.onHide)===null||i===void 0||i.call(e,t),this._onDidHideContextMenu.fire()}})),od.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};zN=Vke([vg(0,vc),vg(1,Ln),vg(2,Eu),vg(3,bi),vg(4,Su),vg(5,tt)],zN);var HN;(function(n){function e(i){return i&&i.menuId instanceof I}function t(i,s,o){if(!e(i))return i;const{menuId:r,menuActionOptions:a,contextKeyService:l}=i;return Object.assign(Object.assign({},i),{getActions:()=>{const c=[];if(r){const d=s.createMenu(r,l??o);Mke(d,a,c),d.dispose()}return i.getActions?Mn.join(i.getActions(),c):c}})}n.transform=t})(HN||(HN={}));var Ix;(function(n){n[n.API=0]="API",n[n.USER=1]="USER"})(Ix||(Ix={}));var _3=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Tx=function(n,e){return function(t,i){e(t,i,n)}},uh=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let $N=class{constructor(e){this._commandService=e}open(e,t){return uh(this,void 0,void 0,function*(){if(!s3(e,it.command))return!1;if(!(t!=null&&t.allowCommands)||(typeof e=="string"&&(e=je.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=NN(decodeURIComponent(e.query))}catch{try{i=NN(e.query)}catch{}}return Array.isArray(i)||(i=[i]),yield this._commandService.executeCommand(e.path,...i),!0})}};$N=_3([Tx(0,fs)],$N);let UN=class{constructor(e){this._editorService=e}open(e,t){return uh(this,void 0,void 0,function*(){typeof e=="string"&&(e=je.parse(e));const{selection:i,uri:s}=Uxe(e);return e=s,e.scheme===it.file&&(e=xCe(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:i,source:t!=null&&t.fromUserGesture?Ix.USER:Ix.API},t==null?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0})}};UN=_3([Tx(0,Ut)],UN);let jN=class{constructor(e,t){this._openers=new Ds,this._validators=new Ds,this._resolvers=new Ds,this._resolvedUriTargets=new In(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new Ds,this._defaultExternalOpener={openExternal:i=>uh(this,void 0,void 0,function*(){return $8(i,it.http,it.https)?Cj(i):window.location.href=i,!0})},this._openers.push({open:(i,s)=>uh(this,void 0,void 0,function*(){return s!=null&&s.openExternal||$8(i,it.mailto,it.http,it.https,it.vsls)?(yield this._doOpenExternal(i,s),!0):!1})}),this._openers.push(new $N(t)),this._openers.push(new UN(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}open(e,t){var i;return uh(this,void 0,void 0,function*(){const s=typeof e=="string"?je.parse(e):e,o=(i=this._resolvedUriTargets.get(s))!==null&&i!==void 0?i:e;for(const r of this._validators)if(!(yield r.shouldOpen(o,t)))return!1;for(const r of this._openers)if(yield r.open(e,t))return!0;return!1})}resolveExternalUri(e,t){return uh(this,void 0,void 0,function*(){for(const i of this._resolvers)try{const s=yield i.resolveExternalUri(e,t);if(s)return this._resolvedUriTargets.has(s.resolved)||this._resolvedUriTargets.set(s.resolved,e),s}catch{}throw new Error("Could not resolve external URI: "+e.toString())})}_doOpenExternal(e,t){return uh(this,void 0,void 0,function*(){const i=typeof e=="string"?je.parse(e):e;let s;try{s=(yield this.resolveExternalUri(i,t)).resolved}catch{s=i}let o;if(typeof e=="string"&&i.toString()===s.toString()?o=e:o=encodeURI(s.toString(!0)),t!=null&&t.allowContributedOpeners){const r=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(yield a.openExternal(o,{sourceUri:i,preferredOpenerId:r},rn.None))return!0}return this._defaultExternalOpener.openExternal(o,{sourceUri:i},rn.None)})}dispose(){this._validators.clear()}};jN=_3([Tx(0,Ut),Tx(1,fs)],jN);const _y=at("editorWorkerService");var Jt;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(Jt||(Jt={}));(function(n){function e(r,a){return a-r}n.compare=e;const t=Object.create(null);t[n.Error]=m("sev.error","Error"),t[n.Warning]=m("sev.warning","Warning"),t[n.Info]=m("sev.info","Info");function i(r){return t[r]||""}n.toString=i;function s(r){switch(r){case mi.Error:return n.Error;case mi.Warning:return n.Warning;case mi.Info:return n.Info;case mi.Ignore:return n.Hint}}n.fromSeverity=s;function o(r){switch(r){case n.Error:return mi.Error;case n.Warning:return mi.Warning;case n.Info:return mi.Info;case n.Hint:return mi.Ignore}}n.toSeverity=o})(Jt||(Jt={}));var Nx;(function(n){const e="";function t(s){return i(s,!0)}n.makeKey=t;function i(s,o){const r=[e];return s.source?r.push(s.source.replace("","\\")):r.push(e),s.code?typeof s.code=="string"?r.push(s.code.replace("","\\")):r.push(s.code.value.replace("","\\")):r.push(e),s.severity!==void 0&&s.severity!==null?r.push(Jt.toString(s.severity)):r.push(e),s.message&&o?r.push(s.message.replace("","\\")):r.push(e),s.startLineNumber!==void 0&&s.startLineNumber!==null?r.push(s.startLineNumber.toString()):r.push(e),s.startColumn!==void 0&&s.startColumn!==null?r.push(s.startColumn.toString()):r.push(e),s.endLineNumber!==void 0&&s.endLineNumber!==null?r.push(s.endLineNumber.toString()):r.push(e),s.endColumn!==void 0&&s.endColumn!==null?r.push(s.endColumn.toString()):r.push(e),r.push(e),r.join("")}n.makeKeyOptionalMessage=i})(Nx||(Nx={}));const dl=at("markerService");function zke(n,e){const t=[],i=[];for(const s of n)e.has(s)||t.push(s);for(const s of e)n.has(s)||i.push(s);return{removed:t,added:i}}function Hke(n,e){const t=new Set;for(const i of e)n.has(i)&&t.add(i);return t}var $ke=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},L6=function(n,e){return function(t,i){e(t,i,n)}};let qN=class extends Y{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new B),this._markerDecorations=new In,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new Uke(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){var t;const i=this._markerDecorations.get(e.uri);i&&(i.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===it.inMemory||e.uri.scheme===it.internal||e.uri.scheme===it.vscode)&&((t=this._markerService)===null||t===void 0||t.read({resource:e.uri}).map(s=>s.owner).forEach(s=>this._markerService.remove(s,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};qN=$ke([L6(0,hs),L6(1,dl)],qN);class Uke extends Y{constructor(e){super(),this.model=e,this._map=new D_e,this._register(Ze(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=zke(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const s=i.map(a=>this._map.get(a)),o=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),r=this.model.deltaDecorations(s,o);for(const a of i)this._map.delete(a);for(let a=0;a<r.length;a++)this._map.set(t[a],r[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=N.lift(t);if(t.severity===Jt.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const s=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(s===1||i.endColumn>=s)return i;const o=e.getWordAtPosition(i.getStartPosition());o&&(i=new N(i.startLineNumber,o.startColumn,i.endLineNumber,o.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const s=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);s<i.endColumn&&(i=new N(i.startLineNumber,s,i.endLineNumber,i.endColumn),t.startColumn=s)}return i}_createDecorationOption(e){let t,i,s,o,r;switch(e.severity){case Jt.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",s=0;break;case Jt.Info:t="squiggly-info",i=sn(_ye),s=10,r={color:sn(n1e),position:Xs.Inline};break;case Jt.Warning:t="squiggly-warning",i=sn(mye),s=20,r={color:sn(s1e),position:Xs.Inline};break;case Jt.Error:default:t="squiggly-error",i=sn(pye),s=30,r={color:sn(o1e),position:Xs.Inline};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(o="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(o="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:jo.Right},minimap:r,zIndex:s,inlineClassName:o}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}var jke=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},M0=function(n,e){return function(t,i){e(t,i,n)}},Lg;function qu(n){return n.toString()}class qke{constructor(e,t,i){this.model=e,this._modelEventListeners=new pe,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(s=>i(e,s)))}dispose(){this._modelEventListeners.dispose()}}const Gke=Xn||pt?1:2;class Kke{constructor(e,t,i,s,o,r,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=s,this.heapSize=o,this.sha1=r,this.versionId=a,this.alternativeVersionId=l}}let Rx=Lg=class extends Y{constructor(e,t,i,s,o){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._languageService=s,this._languageConfigurationService=o,this._onModelAdded=this._register(new B),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new B),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new B),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(r=>this._updateModelOptions(r))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){var i;let s=An.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const f=parseInt(e.editor.tabSize,10);isNaN(f)||(s=f),s<1&&(s=1)}let o="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const f=parseInt(e.editor.indentSize,10);isNaN(f)||(o=Math.max(f,1))}let r=An.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(r=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let a=Gke;const l=e.eol;l===`\r
`?a=2:l===`
`&&(a=1);let c=An.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(c=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let d=An.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(d=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let u=An.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(u=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let h=An.bracketPairColorizationOptions;return!((i=e.editor)===null||i===void 0)&&i.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(h={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:s,indentSize:o,insertSpaces:r,detectIndentation:d,defaultEOL:a,trimAutoWhitespace:c,largeFileOptimizations:u,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:vo===3||vo===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const s=typeof e=="string"?e:e.languageId;let o=this._modelCreationOptionsByLanguageAndResource[s+t];if(!o){const r=this._configurationService.getValue("editor",{overrideIdentifier:s,resource:t}),a=this._getEOL(t,s);o=Lg._readModelOptions({editor:r,eol:a},i),this._modelCreationOptionsByLanguageAndResource[s+t]=o}return o}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let s=0,o=i.length;s<o;s++){const r=i[s],a=this._models[r],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],u=this.getCreationOptions(l,c,a.model.isForSimpleWidget);Lg._setModelOptionsForModel(a.model,u,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&So(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(qu(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(qu(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(qu(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,s)=>i.time-s.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,s){const o=this.getCreationOptions(t,i,s),r=new tl(e,t,o,i,this._undoRedoService,this._languageService,this._languageConfigurationService);if(i&&this._disposedModels.has(qu(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),u=this._getSHA1Computer(),h=u.canComputeSHA1(r)?u.computeSHA1(r)===c.sha1:!1;if(h||c.sharesUndoRedoStack){for(const f of d.past)Al(f)&&f.matchesResource(i)&&f.setModel(r);for(const f of d.future)Al(f)&&f.matchesResource(i)&&f.setModel(r);this._undoRedoService.setElementsValidFlag(i,!0,f=>Al(f)&&f.matchesResource(i)),h&&(r._overwriteVersionId(c.versionId),r._overwriteAlternativeVersionId(c.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=qu(r.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new qke(r,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,s=!1){let o;return t?o=this._createModelData(e,t,i,s):o=this._createModelData(e,zo,i,s),this._onModelAdded.fire(o.model),o.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,s=t.length;i<s;i++){const o=t[i];e.push(this._models[o].model)}return e}getModel(e){const t=qu(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===it.file||e.scheme===it.vscodeRemote||e.scheme===it.vscodeUserData||e.scheme===it.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=qu(e.uri),i=this._models[t],s=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let o=!1,r=0;if(s||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)Al(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)Al(d)&&d.matchesResource(e.uri)&&(o=!0,r+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=Lg.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(o)if(!s&&(r>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-r),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>Al(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new Kke(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),s,r,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!s){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,s=e.getLanguageId(),o=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),r=this.getCreationOptions(s,e.uri,e.isForSimpleWidget);Lg._setModelOptionsForModel(e,r,o),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new sk}};Rx.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024;Rx=Lg=jke([M0(0,ti),M0(1,Qj),M0(2,KD),M0(3,Ai),M0(4,oo)],Rx);class sk{canComputeSHA1(e){return e.getValueLength()<=sk.MAX_MODEL_SIZE}computeSHA1(e){const t=new PD,i=e.createSnapshot();let s;for(;s=i.read();)t.update(s);return t.digest()}}sk.MAX_MODEL_SIZE=10*1024*1024;class Yke{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:Y.None}}renderElement(e,t,i,s){var o;if((o=i.disposable)===null||o===void 0||o.dispose(),!i.data)return;const r=this.modelProvider();if(r.isResolved(e))return this.renderer.renderElement(r.get(e),e,i.data,s);const a=new xr,l=r.resolve(e,a.token);i.disposable={dispose:()=>a.cancel()},this.renderer.renderPlaceholder(e,i.data),l.then(c=>this.renderer.renderElement(c,e,i.data,s))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class Zke{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function Xke(n,e){return Object.assign(Object.assign({},e),{accessibilityProvider:e.accessibilityProvider&&new Zke(n,e.accessibilityProvider)})}class Qke{constructor(e,t,i,s,o={}){const r=()=>this.model,a=s.map(l=>new Yke(l,r));this.list=new ca(e,t,i,a,Xke(r,o))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return ue.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return ue.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return ue.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(s=>this._model.get(s)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,es(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var o0=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o};const Jke=!1;var Mx;(function(n){n.North="north",n.South="south",n.East="east",n.West="west"})(Mx||(Mx={}));let e2e=4;const t2e=new B;let i2e=300;const n2e=new B;class b3{constructor(){this.disposables=new pe}get onPointerMove(){return this.disposables.add(new rt(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new rt(window,"mouseup")).event}dispose(){this.disposables.dispose()}}o0([Di],b3.prototype,"onPointerMove",null);o0([Di],b3.prototype,"onPointerUp",null);class v3{get onPointerMove(){return this.disposables.add(new rt(this.el,Pt.Change)).event}get onPointerUp(){return this.disposables.add(new rt(this.el,Pt.End)).event}constructor(e){this.el=e,this.disposables=new pe}dispose(){this.disposables.dispose()}}o0([Di],v3.prototype,"onPointerMove",null);o0([Di],v3.prototype,"onPointerUp",null);class Px{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}o0([Di],Px.prototype,"onPointerMove",null);o0([Di],Px.prototype,"onPointerUp",null);const D6="pointer-events-disabled";class kn extends Y{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=le(this.el,we(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Ze(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new rt(this._orthogonalStartDragHandle,"mouseenter")).event(()=>kn.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new rt(this._orthogonalStartDragHandle,"mouseleave")).event(()=>kn.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=le(this.el,we(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Ze(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new rt(this._orthogonalEndDragHandle,"mouseenter")).event(()=>kn.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new rt(this._orthogonalEndDragHandle,"mouseleave")).event(()=>kn.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=i2e,this.hoverDelayer=this._register(new xu(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new B),this._onDidStart=this._register(new B),this._onDidChange=this._register(new B),this._onDidReset=this._register(new B),this._onDidEnd=this._register(new B),this.orthogonalStartSashDisposables=this._register(new pe),this.orthogonalStartDragHandleDisposables=this._register(new pe),this.orthogonalEndSashDisposables=this._register(new pe),this.orthogonalEndDragHandleDisposables=this._register(new pe),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=le(e,we(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),pt&&this.el.classList.add("mac");const s=this._register(new rt(this.el,"mousedown")).event;this._register(s(u=>this.onPointerStart(u,new b3),this));const o=this._register(new rt(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));const r=this._register(new rt(this.el,"mouseenter")).event;this._register(r(()=>kn.onMouseEnter(this)));const a=this._register(new rt(this.el,"mouseleave")).event;this._register(a(()=>kn.onMouseLeave(this))),this._register(Rt.addTarget(this.el));const l=this._register(new rt(this.el,Pt.Start)).event;this._register(l(u=>this.onPointerStart(u,new v3(this.el)),this));const c=this._register(new rt(this.el,Pt.Tap)).event;let d;this._register(c(u=>{if(d){clearTimeout(d),d=void 0,this.onPointerDoublePress(u);return}clearTimeout(d),d=setTimeout(()=>d=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=e2e,this._register(t2e.event(u=>{this.size=u,this.layout()}))),this._register(n2e.event(u=>this.hoverDelay=u)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",Jke),this.layout()}onPointerStart(e,t){Ue.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const g=this.getOrthogonalSash(e);g&&(i=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new Px(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Px(t))),!this.state)return;const s=document.getElementsByTagName("iframe");for(const g of s)g.classList.add(D6);const o=e.pageX,r=e.pageY,a=e.altKey,l={startX:o,currentX:o,startY:r,currentY:r,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=wr(this.el),d=()=>{let g="";i?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=pt?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=pt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${g} !important; }`},u=new pe;d(),i||this.onDidEnablementChange.event(d,null,u);const h=g=>{Ue.stop(g,!1);const p={startX:o,currentX:g.pageX,startY:r,currentY:g.pageY,altKey:a};this._onDidChange.fire(p)},f=g=>{Ue.stop(g,!1),this.el.removeChild(c),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(const p of s)p.classList.remove(D6)};t.onPointerMove(h,null,u),t.onPointerUp(f,null,u),u.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&kn.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&kn.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){kn.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){var t;const i=(t=e.initialTarget)!==null&&t!==void 0?t:e.target;if(!(!i||!(i instanceof HTMLElement))&&i.classList.contains("orthogonal-drag-handle"))return i.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const s2e={separatorBorder:z.transparent};class sK{set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){var i,s;e!==this.visible&&(e?(this.size=ho(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e),(s=(i=this.view).setVisible)===null||s===void 0||s.call(i,e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){var e;return(e=this.view.proportionalLayout)!==null&&e!==void 0?e:!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,s){this.container=e,this.view=t,this.disposable=s,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e),this.view.layout(this.size,e,t)}dispose(){this.disposable.dispose()}}class o2e extends sK{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class r2e extends sK{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var Ll;(function(n){n[n.Idle=0]="Idle",n[n.Busy=1]="Busy"})(Ll||(Ll={}));var Ox;(function(n){n.Distribute={type:"distribute"};function e(s){return{type:"split",index:s}}n.Split=e;function t(s){return{type:"auto",index:s}}n.Auto=t;function i(s){return{type:"invisible",cachedVisibleSize:s}}n.Invisible=i})(Ox||(Ox={}));class oK extends Y{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){var i,s,o,r,a;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=Ll.Idle,this._onDidSashChange=this._register(new B),this._onDidSashReset=this._register(new B),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=(i=t.orientation)!==null&&i!==void 0?i:0,this.inverseAltBehavior=(s=t.inverseAltBehavior)!==null&&s!==void 0?s:!1,this.proportionalLayout=(o=t.proportionalLayout)!==null&&o!==void 0?o:!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=le(this.el,we(".sash-container")),this.viewContainer=we(".split-view-container"),this.scrollable=this._register(new cy({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:Uo})),this.scrollableElement=this._register(new OP(this.viewContainer,{vertical:this.orientation===0?(r=t.scrollbarVisibility)!==null&&r!==void 0?r:1:2,horizontal:this.orientation===1?(a=t.scrollbarVisibility)!==null&&a!==void 0?a:1:2},this.scrollable));const l=this._register(new rt(this.viewContainer,"scroll")).event;this._register(l(c=>{const d=this.scrollableElement.getScrollPosition(),u=Math.abs(this.viewContainer.scrollLeft-d.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,h=Math.abs(this.viewContainer.scrollTop-d.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(u!==void 0||h!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:u,scrollTop:h})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(c=>{c.scrollTopChanged&&(this.viewContainer.scrollTop=c.scrollTop),c.scrollLeftChanged&&(this.viewContainer.scrollLeft=c.scrollLeft)})),le(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||s2e),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((c,d)=>{const u=qs(c.visible)||c.visible?c.size:{type:"invisible",cachedVisibleSize:c.size},h=c.view;this.doAddView(h,u,d,!0)}),this.contentSize=this.viewItems.reduce((c,d)=>c+d.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,s){this.doAddView(e,t,i,s)}layout(e,t){const i=Math.max(this.size,this.contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let s=0;for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"?s+=a:e-=r.size}for(let o=0;o<this.viewItems.length;o++){const r=this.viewItems[o],a=this.proportions[o];typeof a=="number"&&(r.size=ho(Math.round(a*e/s),r.minimumSize,r.maximumSize))}}else{const s=es(this.viewItems.length),o=s.filter(a=>this.viewItems[a].priority===1),r=s.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,o,r)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout?e.size/this.contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const s=this.sashItems.findIndex(a=>a.sash===e),o=fr(K(document.body,"keydown",a=>r(this.sashDragState.current,a.altKey)),K(document.body,"keyup",()=>r(this.sashDragState.current,!1))),r=(a,l)=>{const c=this.viewItems.map(g=>g.size);let d=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(s===this.sashItems.length-1){const p=this.viewItems[s];d=(p.minimumSize-p.size)/2,u=(p.maximumSize-p.size)/2}else{const p=this.viewItems[s+1];d=(p.size-p.maximumSize)/2,u=(p.size-p.minimumSize)/2}let h,f;if(!l){const g=es(s,-1),p=es(s+1,this.viewItems.length),_=g.reduce((D,k)=>D+(this.viewItems[k].minimumSize-c[k]),0),v=g.reduce((D,k)=>D+(this.viewItems[k].viewMaximumSize-c[k]),0),b=p.length===0?Number.POSITIVE_INFINITY:p.reduce((D,k)=>D+(c[k]-this.viewItems[k].minimumSize),0),y=p.length===0?Number.NEGATIVE_INFINITY:p.reduce((D,k)=>D+(c[k]-this.viewItems[k].viewMaximumSize),0),w=Math.max(_,y),C=Math.min(b,v),L=this.findFirstSnapIndex(g),x=this.findFirstSnapIndex(p);if(typeof L=="number"){const D=this.viewItems[L],k=Math.floor(D.viewMinimumSize/2);h={index:L,limitDelta:D.visible?w-k:w+k,size:D.size}}if(typeof x=="number"){const D=this.viewItems[x],k=Math.floor(D.viewMinimumSize/2);f={index:x,limitDelta:D.visible?C+k:C-k,size:D.size}}}this.sashDragState={start:a,current:a,index:s,sizes:c,minDelta:d,maxDelta:u,alt:l,snapBefore:h,snapAfter:f,disposable:o}};r(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:s,alt:o,minDelta:r,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const d=e-i,u=this.resize(t,d,s,void 0,void 0,r,a,l,c);if(o){const h=t===this.sashItems.length-1,f=this.viewItems.map(y=>y.size),g=h?t:t+1,p=this.viewItems[g],_=p.size-p.maximumSize,v=p.size-p.minimumSize,b=h?t-1:t+1;this.resize(b,-u,f,void 0,void 0,_,v)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=ho(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(this.state!==Ll.Idle)throw new Error("Cant modify splitview");if(this.state=Ll.Busy,e<0||e>=this.viewItems.length)return;const i=es(this.viewItems.length).filter(a=>a!==e),s=[...i.filter(a=>this.viewItems[a].priority===1),e],o=i.filter(a=>this.viewItems[a].priority===2),r=this.viewItems[e];t=Math.round(t),t=ho(t,r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=t,this.relayout(s,o),this.state=Ll.Idle}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=ho(i,a.minimumSize,a.maximumSize);const s=es(this.viewItems.length),o=s.filter(a=>this.viewItems[a].priority===1),r=s.filter(a=>this.viewItems[a].priority===2);this.relayout(o,r)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,s){if(this.state!==Ll.Idle)throw new Error("Cant modify splitview");this.state=Ll.Busy;const o=we(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));const r=e.onDidChange(h=>this.onViewChange(d,h)),a=Ze(()=>this.viewContainer.removeChild(o)),l=fr(r,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const d=this.orientation===0?new o2e(o,e,c,l):new r2e(o,e,c,l);if(this.viewItems.splice(i,0,d),this.viewItems.length>1){const h={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},f=this.orientation===0?new kn(this.sashContainer,{getHorizontalSashTop:D=>this.getSashPosition(D),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},h),{orientation:1})):new kn(this.sashContainer,{getVerticalSashLeft:D=>this.getSashPosition(D),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},h),{orientation:0})),g=this.orientation===0?D=>({sash:f,start:D.startY,current:D.currentY,alt:D.altKey}):D=>({sash:f,start:D.startX,current:D.currentX,alt:D.altKey}),_=ue.map(f.onDidStart,g)(this.onSashStart,this),b=ue.map(f.onDidChange,g)(this.onSashChange,this),w=ue.map(f.onDidEnd,()=>this.sashItems.findIndex(D=>D.sash===f))(this.onSashEnd,this),C=f.onDidReset(()=>{const D=this.sashItems.findIndex(R=>R.sash===f),k=es(D,-1),P=es(D+1,this.viewItems.length),O=this.findFirstSnapIndex(k),M=this.findFirstSnapIndex(P);typeof O=="number"&&!this.viewItems[O].visible||typeof M=="number"&&!this.viewItems[M].visible||this._onDidSashReset.fire(D)}),L=fr(_,b,w,C,f),x={sash:f,disposable:L};this.sashItems.splice(i-1,0,x)}o.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),s||this.relayout([i],u),this.state=Ll.Idle,!s&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}relayout(e,t){const i=this.viewItems.reduce((s,o)=>s+o.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(d=>d.size),s,o,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const d=es(e,-1),u=es(e+1,this.viewItems.length);if(o)for(const x of o)_2(d,x),_2(u,x);if(s)for(const x of s)ew(d,x),ew(u,x);const h=d.map(x=>this.viewItems[x]),f=d.map(x=>i[x]),g=u.map(x=>this.viewItems[x]),p=u.map(x=>i[x]),_=d.reduce((x,D)=>x+(this.viewItems[D].minimumSize-i[D]),0),v=d.reduce((x,D)=>x+(this.viewItems[D].maximumSize-i[D]),0),b=u.length===0?Number.POSITIVE_INFINITY:u.reduce((x,D)=>x+(i[D]-this.viewItems[D].minimumSize),0),y=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((x,D)=>x+(i[D]-this.viewItems[D].maximumSize),0),w=Math.max(_,y,r),C=Math.min(b,v,a);let L=!1;if(l){const x=this.viewItems[l.index],D=t>=l.limitDelta;L=D!==x.visible,x.setVisible(D,l.size)}if(!L&&c){const x=this.viewItems[c.index],D=t<c.limitDelta;L=D!==x.visible,x.setVisible(D,c.size)}if(L)return this.resize(e,t,i,s,o,r,a);t=ho(t,w,C);for(let x=0,D=t;x<h.length;x++){const k=h[x],P=ho(f[x]+D,k.minimumSize,k.maximumSize),O=P-f[x];D-=O,k.size=P}for(let x=0,D=t;x<g.length;x++){const k=g[x],P=ho(p[x]-D,k.minimumSize,k.maximumSize),O=P-p[x];D+=O,k.size=P}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const s=es(this.viewItems.length-1,-1),o=s.filter(a=>this.viewItems[a].priority===1),r=s.filter(a=>this.viewItems[a].priority===2);for(const a of r)_2(s,a);for(const a of o)ew(s,a);typeof e=="number"&&ew(s,e);for(let a=0;i!==0&&a<s.length;a++){const l=this.viewItems[s[a]],c=ho(l.size+i,l.minimumSize,l.maximumSize),d=c-l.size;i-=d,l.size=c}}layoutViews(){this.contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),s=[...this.viewItems].reverse();e=!1;const o=s.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const r=s.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],d=this.viewItems[l];a+=d.size;const u=!(t[l]&&r[l+1]),h=!(i[l]&&o[l+1]);if(u&&h){const f=es(l,-1),g=es(l+1,this.viewItems.length),p=this.findFirstSnapIndex(f),_=this.findFirstSnapIndex(g),v=typeof p=="number"&&!this.viewItems[p].visible,b=typeof _=="number"&&!this.viewItems[_].visible;v&&o[l]&&(a>0||this.startSnappingEnabled)?c.state=1:b&&t[l]&&(a<this.contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else u&&!h?c.state=1:!u&&h?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){var e;(e=this.sashDragState)===null||e===void 0||e.disposable.dispose(),Ft(this.viewItems),this.viewItems=[],this.sashItems.forEach(t=>t.disposable.dispose()),this.sashItems=[],super.dispose()}}class by{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=by.TemplateId,this.renderedTemplates=new Set;const s=new Map(t.map(o=>[o.templateId,o]));this.renderers=[];for(const o of e){const r=s.get(o.templateId);if(!r)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(r)}}renderTemplate(e){const t=le(e,we(".monaco-table-tr")),i=[],s=[];for(let r=0;r<this.columns.length;r++){const a=this.renderers[r],l=le(t,we(".monaco-table-td",{"data-col-index":r}));l.style.width=`${this.getColumnSize(r)}px`,i.push(l),s.push(a.renderTemplate(l))}const o={container:e,cellContainers:i,cellTemplateData:s};return this.renderedTemplates.add(o),o}renderElement(e,t,i,s){for(let o=0;o<this.columns.length;o++){const a=this.columns[o].project(e);this.renderers[o].renderElement(a,t,i.cellTemplateData[o],s)}}disposeElement(e,t,i,s){for(let o=0;o<this.columns.length;o++){const r=this.renderers[o];if(r.disposeElement){const l=this.columns[o].project(e);r.disposeElement(l,t,i.cellTemplateData[o],s)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Lo(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}by.TemplateId="row";function a2e(n){return{getHeight(e){return n.getHeight(e)},getTemplateId(){return by.TemplateId}}}class l2e{get minimumSize(){var e;return(e=this.column.minimumWidth)!==null&&e!==void 0?e:120}get maximumSize(){var e;return(e=this.column.maximumWidth)!==null&&e!==void 0?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return(e=this.column.onDidChangeWidthConstraints)!==null&&e!==void 0?e:ue.None}constructor(e,t){this.column=e,this.index=t,this._onDidLayout=new B,this.onDidLayout=this._onDidLayout.event,this.element=we(".monaco-table-th",{"data-col-index":t,title:e.tooltip},e.label)}layout(e){this._onDidLayout.fire([this.index,e])}}class ok{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,s,o,r){this.virtualDelegate=i,this.domId=`table_id_${++ok.InstanceCount}`,this.disposables=new pe,this.cachedWidth=0,this.cachedHeight=0,this.domNode=le(t,we(`.monaco-table.${this.domId}`));const a=s.map((d,u)=>new l2e(d,u)),l={size:a.reduce((d,u)=>d+u.column.weight,0),views:a.map(d=>({size:d.column.weight,view:d}))};this.splitview=this.disposables.add(new oK(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new by(s,o,d=>this.splitview.getViewSize(d));this.list=this.disposables.add(new ca(e,this.domNode,a2e(i),[c],r)),ue.any(...a.map(d=>d.onDidLayout))(([d,u])=>c.layoutColumn(d,u),null,this.disposables),this.splitview.onDidSashReset(d=>{const u=s.reduce((f,g)=>f+g.weight,0),h=s[d].weight/u*this.cachedWidth;this.splitview.resizeView(d,h)},null,this.disposables),this.styleElement=wr(this.domNode),this.style(uke)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}ok.InstanceCount=0;class r0 extends la{constructor(e){super(),this._onChange=this._register(new B),this.onChange=this._onChange.event,this._onKeyDown=this._register(new B),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...Ne.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 2+2+2+16}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const c2e=m("caseDescription","Match Case"),d2e=m("wordsDescription","Match Whole Word"),u2e=m("regexDescription","Use Regular Expression");class rK extends r0{constructor(e){super({icon:se.caseSensitive,title:c2e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class aK extends r0{constructor(e){super({icon:se.wholeWord,title:d2e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class lK extends r0{constructor(e){super({icon:se.regex,title:u2e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class h2e{constructor(e,t=0,i=e.length,s=t-1){this.items=e,this.start=t,this.end=i,this.index=s}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class f2e{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new h2e(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const P0=we;let g2e=class extends la{constructor(e,t,i){var s;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new B),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new B),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=(s=this.options.tooltip)!==null&&s!==void 0?s:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=le(e,P0(".monaco-inputbox.idle"));const o=this.options.flexibleHeight?"textarea":"input",r=le(this.element,P0(".ibwrapper"));if(this.input=le(r,P0(o+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=le(r,P0("div.mirror")),this.mirror.innerText="",this.scrollableElement=new xq(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),le(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(c=>this.input.scrollTop=c.scrollTop));const a=this._register(new rt(document,"selectionchange")),l=ue.filter(a.event,()=>{const c=document.getSelection();return(c==null?void 0:c.anchorNode)===r});this._register(l(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new il(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.input.title=e}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:wh(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&So(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${jh(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=ys(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:s=>{var o,r;if(!this.message)return null;e=le(s,P0(".monaco-inputbox-container")),t();const a={inline:!0,className:"monaco-inputbox-message"},l=this.message.formatContent?DDe(this.message.content,a):LDe(this.message.content,a);l.classList.add(this.classForType(this.message.type));const c=this.stylesForType(this.message.type);return l.style.backgroundColor=(o=c.background)!==null&&o!==void 0?o:"",l.style.color=(r=c.foreground)!==null&&r!==void 0?r:"",l.style.border=c.border?`1px solid ${c.border}`:"",le(e,l),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=m("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=m("alertWarningMessage","Warning: {0}",this.message.content):i=m("alertInfoMessage","Info: {0}",this.message.content),ay(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="",this.layout()}applyStyles(){var e,t,i;const s=this.options.inputBoxStyles,o=(e=s.inputBackground)!==null&&e!==void 0?e:"",r=(t=s.inputForeground)!==null&&t!==void 0?t:"",a=(i=s.inputBorder)!==null&&i!==void 0?i:"";this.element.style.backgroundColor=o,this.element.style.color=r,this.input.style.backgroundColor="inherit",this.input.style.color=r,this.element.style.border=`1px solid ${jh(a,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=wh(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,s=t.selectionEnd,o=t.value;i!==null&&s!==null&&(this.value=o.substr(0,i)+e+o.substr(s),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){var e;this._hideMessage(),this.message=null,(e=this.actionbar)===null||e===void 0||e.dispose(),super.dispose()}};class cK extends g2e{constructor(e,t,i){const s=m({key:"history.inputbox.hint",comment:["Text will be prefixed with  plus a single space, then used as a hint where input field keeps history"]},"for history"),o=` or  ${s}`,r=` ( ${s})`;super(e,t,i),this._onDidFocus=this._register(new B),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new B),this.onDidBlur=this._onDidBlur.event,this.history=new f2e(i.history,100);const a=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(o)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){const l=this.placeholder.endsWith(")")?o:r,c=this.placeholder+l;i.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=c:this.setPlaceHolder(c)}};this.observer=new MutationObserver((l,c)=>{l.forEach(d=>{d.target.textContent||a()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>a()),this.onblur(this.input,()=>{const l=c=>{if(this.placeholder.endsWith(c)){const d=this.placeholder.slice(0,this.placeholder.length-c.length);return i.showPlaceholderOnFocus?this.placeholder=d:this.setPlaceHolder(d),!0}else return!1};l(r)||l(o)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Qb(this.value?this.value:m("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Qb(this.value))}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const p2e=m("defaultLabel","input");class dK extends la{constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new ta),this.additionalToggles=[],this._onDidOptionChange=this._register(new B),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new B),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new B),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new B),this._onKeyUp=this._register(new B),this._onCaseSensitiveKeyDown=this._register(new B),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new B),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||p2e,this.showCommonFindToggles=!!i.showCommonFindToggles;const s=i.appendCaseSensitiveLabel||"",o=i.appendWholeWordsLabel||"",r=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,d=i.flexibleMaxHeight;if(this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new cK(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:d,inputBoxStyles:i.inputBoxStyles})),this.showCommonFindToggles){this.regex=this._register(new lK(Object.assign({appendTitle:r,isChecked:!1},i.toggleStyles))),this._register(this.regex.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(h=>{this._onRegexKeyDown.fire(h)})),this.wholeWords=this._register(new aK(Object.assign({appendTitle:o,isChecked:!1},i.toggleStyles))),this._register(this.wholeWords.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new rK(Object.assign({appendTitle:s,isChecked:!1},i.toggleStyles))),this._register(this.caseSensitive.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(h=>{this._onCaseSensitiveKeyDown.fire(h)}));const u=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,h=>{if(h.equals(15)||h.equals(17)||h.equals(9)){const f=u.indexOf(document.activeElement);if(f>=0){let g=-1;h.equals(17)?g=(f+1)%u.length:h.equals(15)&&(f===0?g=u.length-1:g=f-1),h.equals(9)?(u[f].blur(),this.inputBox.focus()):g>=0&&u[g].focus(),Ue.stop(h,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i==null?void 0:i.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e==null||e.appendChild(this.domNode),this._register(K(this.inputBox.inputElement,"compositionstart",u=>{this.imeSessionInProgress=!0})),this._register(K(this.inputBox.inputElement,"compositionend",u=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){var e,t,i;this.domNode.classList.remove("disabled"),this.inputBox.enable(),(e=this.regex)===null||e===void 0||e.enable(),(t=this.wholeWords)===null||t===void 0||t.enable(),(i=this.caseSensitive)===null||i===void 0||i.enable();for(const s of this.additionalToggles)s.enable()}disable(){var e,t,i;this.domNode.classList.add("disabled"),this.inputBox.disable(),(e=this.regex)===null||e===void 0||e.disable(),(t=this.wholeWords)===null||t===void 0||t.disable(),(i=this.caseSensitive)===null||i===void 0||i.disable();for(const s of this.additionalToggles)s.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new pe;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){var t,i,s,o,r,a;e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=((i=(t=this.caseSensitive)===null||t===void 0?void 0:t.width())!==null&&i!==void 0?i:0)+((o=(s=this.wholeWords)===null||s===void 0?void 0:s.width())!==null&&o!==void 0?o:0)+((a=(r=this.regex)===null||r===void 0?void 0:r.width())!==null&&a!==void 0?a:0)+this.additionalToggles.reduce((l,c)=>l+c.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){var e,t;return(t=(e=this.caseSensitive)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){var e,t;return(t=(e=this.wholeWords)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){var e,t;return(t=(e=this.regex)===null||e===void 0?void 0:e.checked)!==null&&t!==void 0?t:!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){var e;(e=this.caseSensitive)===null||e===void 0||e.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}var va;(function(n){n[n.Expanded=0]="Expanded",n[n.Collapsed=1]="Collapsed",n[n.PreserveOrExpanded=2]="PreserveOrExpanded",n[n.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(va||(va={}));var Dh;(function(n){n[n.Unknown=0]="Unknown",n[n.Twistie=1]="Twistie",n[n.Element=2]="Element",n[n.Filter=3]="Filter"})(Dh||(Dh={}));class _o extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class y3{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function w3(n){return typeof n=="object"&&"visibility"in n&&"data"in n}function vv(n){switch(n){case!0:return 1;case!1:return 0;default:return n}}function IE(n){return typeof n.collapsible=="boolean"}class m2e{constructor(e,t,i,s={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new G4,this._onDidChangeCollapseState=new B,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new B,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new B,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new xu(Ej),this.collapseByDefault=typeof s.collapseByDefault>"u"?!1:s.collapseByDefault,this.filter=s.filter,this.autoExpandSingleChildren=typeof s.autoExpandSingleChildren>"u"?!1:s.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=dt.empty(),s={}){if(e.length===0)throw new _o(this.user,"Invalid tree location");s.diffIdentityProvider?this.spliceSmart(s.diffIdentityProvider,e,t,i,s):this.spliceSimple(e,t,i,s)}spliceSmart(e,t,i,s,o,r){var a;s===void 0&&(s=dt.empty()),r===void 0&&(r=(a=o.diffDepth)!==null&&a!==void 0?a:0);const{parentNode:l}=this.getParentNodeWithListIndex(t);if(!l.lastDiffIds)return this.spliceSimple(t,i,s,o);const c=[...s],d=t[t.length-1],u=new zl({getElements:()=>l.lastDiffIds},{getElements:()=>[...l.children.slice(0,d),...c,...l.children.slice(d+i)].map(_=>e.getId(_.element).toString())}).ComputeDiff(!1);if(u.quitEarly)return l.lastDiffIds=void 0,this.spliceSimple(t,i,c,o);const h=t.slice(0,-1),f=(_,v,b)=>{if(r>0)for(let y=0;y<b;y++)_--,v--,this.spliceSmart(e,[...h,_,0],Number.MAX_SAFE_INTEGER,c[v].children,o,r-1)};let g=Math.min(l.children.length,d+i),p=c.length;for(const _ of u.changes.sort((v,b)=>b.originalStart-v.originalStart))f(g,p,g-(_.originalStart+_.originalLength)),g=_.originalStart,p=_.modifiedStart-d,this.spliceSimple([...h,g],_.originalLength,dt.slice(c,p,p+_.modifiedLength),o);f(g,p,g)}spliceSimple(e,t,i=dt.empty(),{onDidCreateNode:s,onDidDeleteNode:o,diffIdentityProvider:r}){const{parentNode:a,listIndex:l,revealed:c,visible:d}=this.getParentNodeWithListIndex(e),u=[],h=dt.map(i,x=>this.createTreeNode(x,a,a.visible?1:0,c,u,s)),f=e[e.length-1],g=a.children.length>0;let p=0;for(let x=f;x>=0&&x<a.children.length;x--){const D=a.children[x];if(D.visible){p=D.visibleChildIndex;break}}const _=[];let v=0,b=0;for(const x of h)_.push(x),b+=x.renderNodeCount,x.visible&&(x.visibleChildIndex=p+v++);const y=KF(a.children,f,t,_);r?a.lastDiffIds?KF(a.lastDiffIds,f,t,_.map(x=>r.getId(x.element).toString())):a.lastDiffIds=a.children.map(x=>r.getId(x.element).toString()):a.lastDiffIds=void 0;let w=0;for(const x of y)x.visible&&w++;if(w!==0)for(let x=f+_.length;x<a.children.length;x++){const D=a.children[x];D.visible&&(D.visibleChildIndex-=w)}if(a.visibleChildrenCount+=v-w,c&&d){const x=y.reduce((D,k)=>D+(k.visible?k.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,b-x),this.list.splice(l,x,u)}if(y.length>0&&o){const x=D=>{o(D),D.children.forEach(x)};y.forEach(x)}this._onDidSplice.fire({insertedNodes:_,deletedNodes:y});const C=a.children.length>0;g!==C&&this.setCollapsible(e.slice(0,-1),C);let L=a;for(;L;){if(L.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}L=L.parent}}rerender(e){if(e.length===0)throw new _o(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:s}=this.getTreeNodeWithListIndex(e);t.visible&&s&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:s}=this.getTreeNodeWithListIndex(e);return i&&s?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const s={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,s))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const s=this.getTreeNode(e);typeof t>"u"&&(t=!s.collapsed);const o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,o))}_setCollapseState(e,t){const{node:i,listIndex:s,revealed:o}=this.getTreeNodeWithListIndex(e),r=this._setListNodeCollapseState(i,s,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&r&&!IE(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return r}_setListNodeCollapseState(e,t,i,s){const o=this._setNodeCollapseState(e,s,!1);if(!i||!e.visible||!o)return o;const r=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=r-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),o}_setNodeCollapseState(e,t,i){let s;if(e===this.root?s=!1:(IE(t)?(s=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(s=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):s=!1,s&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!IE(t)&&t.recursive)for(const o of e.children)s=this._setNodeCollapseState(o,t,!0)||s;return s}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,s,o,r){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,s&&o.push(a);const c=e.children||dt.empty(),d=s&&l!==0&&!a.collapsed;let u=0,h=1;for(const f of c){const g=this.createTreeNode(f,a,l,d,o,r);a.children.push(g),h+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=u++)}return a.collapsible=a.collapsible||a.children.length>0,a.visibleChildrenCount=u,a.visible=l===2?u>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=h):(a.renderNodeCount=0,s&&o.pop()),r==null||r(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,s=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),o===0)return e.visible=!1,e.renderNodeCount=0,!1;s&&i.push(e)}const r=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||o!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,o,i,s&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=o===2?a:o===1,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-r):(e.renderNodeCount=0,s&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):w3(i)?(e.filterData=i.data,vv(i.visibility)):(e.filterData=void 0,vv(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...s]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(s,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...s]=e;if(i<0||i>t.children.length)throw new _o(this.user,"Invalid tree location");return this.getTreeNode(s,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:s,visible:o}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new _o(this.user,"Invalid tree location");const a=t.children[r];return{node:a,listIndex:i,revealed:s,visible:o&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,s=!0,o=!0){const[r,...a]=e;if(r<0||r>t.children.length)throw new _o(this.user,"Invalid tree location");for(let l=0;l<r;l++)i+=t.children[l].renderNodeCount;return s=s&&!t.collapsed,o=o&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:s,visible:o}:this.getParentNodeWithListIndex(a,t.children[r],i+1,s,o)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:Vhe(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class _2e extends py{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function TE(n){return n instanceof py?new _2e(n):n}class b2e{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=Y.None,this.disposables=new pe}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,TE(e),t)}onDragOver(e,t,i,s,o=!0){const r=this.dnd.onDragOver(TE(e),t&&t.element,i,s),a=this.autoExpandNode!==t;if(a&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return r;if(a&&typeof r!="boolean"&&r.autoExpand&&(this.autoExpandDisposable=US(()=>{const h=this.modelProvider(),f=h.getNodeLocation(t);h.isCollapsed(f)&&h.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof r=="boolean"||!r.accept||typeof r.bubble>"u"||r.feedback){if(!o){const h=typeof r=="boolean"?r:r.accept,f=typeof r=="boolean"?void 0:r.effect;return{accept:h,effect:f,feedback:[i]}}return r}if(r.bubble===1){const h=this.modelProvider(),f=h.getNodeLocation(t),g=h.getParentNodeLocation(f),p=h.getNode(g),_=g&&h.getListIndex(g);return this.onDragOver(e,p,_,s,!1)}const l=this.modelProvider(),c=l.getNodeLocation(t),d=l.getListIndex(c),u=l.getListRenderCount(c);return Object.assign(Object.assign({},r),{feedback:es(d,d+u)})}drop(e,t,i,s){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(TE(e),t&&t.element,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function v2e(n,e){return e&&Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new b2e(n,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))}},accessibilityProvider:e.accessibilityProvider&&Object.assign(Object.assign({},e.accessibilityProvider),{getSetSize(t){const i=n(),s=i.getNodeLocation(t),o=i.getParentNodeLocation(s);return i.getNode(o).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))}),keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}})})}class C3{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,s;(s=(i=this.delegate).setDynamicHeight)===null||s===void 0||s.call(i,e.element,t)}}var yv;(function(n){n.None="none",n.OnHover="onHover",n.Always="always"})(yv||(yv={}));class y2e{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new pe,this.onDidChange=ue.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}class wv{constructor(e,t,i,s,o,r={}){var a;this.renderer=e,this.modelProvider=t,this.activeNodes=s,this.renderedIndentGuides=o,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=wv.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=Y.None,this.disposables=new pe,this.templateId=e.templateId,this.updateOptions(r),ue.map(i,l=>l.node)(this.onDidChangeNodeTwistieState,this,this.disposables),(a=e.onDidChangeTwistieState)===null||a===void 0||a.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=ho(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,s]of this.renderedNodes)this.renderTreeElement(i,s)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==yv.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,s]of this.renderedNodes)this._renderIndentGuides(i,s);if(this.indentGuidesDisposable.dispose(),t){const i=new pe;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=le(e,we(".monaco-tl-row")),i=le(t,we(".monaco-tl-indent")),s=le(t,we(".monaco-tl-twistie")),o=le(t,we(".monaco-tl-contents")),r=this.renderer.renderTemplate(o);return{container:e,indent:i,twistie:s,indentGuidesDisposable:Y.None,templateData:r}}renderElement(e,t,i,s){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,s)}disposeElement(e,t,i,s){var o,r;i.indentGuidesDisposable.dispose(),(r=(o=this.renderer).disposeElement)===null||r===void 0||r.call(o,e,t,i.templateData,s),typeof s=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=wv.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...Ne.asClassNameArray(se.treeItemExpanded));let s=!1;this.renderer.renderTwistie&&(s=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(s||t.twistie.classList.add(...Ne.asClassNameArray(se.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(Lo(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new pe,s=this.modelProvider();for(;;){const o=s.getNodeLocation(e),r=s.getParentNodeLocation(o);if(!r)break;const a=s.getNode(r),l=we(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(a)&&l.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(l):t.indent.insertBefore(l,t.indent.firstElementChild),this.renderedIndentGuides.add(a,l),i.add(Ze(()=>this.renderedIndentGuides.delete(a,l))),e=a}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(s=>{const o=i.getNodeLocation(s);try{const r=i.getParentNodeLocation(o);s.collapsible&&s.children.length>0&&!s.collapsed?t.add(s):r&&t.add(i.getNode(r))}catch{}}),this.activeIndentNodes.forEach(s=>{t.has(s)||this.renderedIndentGuides.forEach(s,o=>o.classList.remove("active"))}),t.forEach(s=>{this.activeIndentNodes.has(s)||this.renderedIndentGuides.forEach(s,o=>o.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),Ft(this.disposables)}}wv.DefaultIndent=8;class w2e{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new pe,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const r=this._filter.filter(e,t);if(typeof r=="boolean"?i=r?1:0:w3(r)?i=vv(r.visibility):i=r,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:Xh.Default,visibility:i};const s=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),o=Array.isArray(s)?s:[s];for(const r of o){const a=r&&r.toString();if(typeof a>"u")return{data:Xh.Default,visibility:i};let l;if(this.tree.findMatchType===bf.Contiguous){const c=a.toLowerCase().indexOf(this._lowercasePattern);if(c>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let d=this._lowercasePattern.length;d>0;d--)l.push(c+d-1)}}else l=HG(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,o.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===za.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:Xh.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){Ft(this.disposables)}}var za;(function(n){n[n.Highlight=0]="Highlight",n[n.Filter=1]="Filter"})(za||(za={}));var bf;(function(n){n[n.Fuzzy=0]="Fuzzy",n[n.Contiguous=1]="Contiguous"})(bf||(bf={}));let C2e=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,s,o,r={}){var a,l;this.tree=e,this.view=i,this.filter=s,this.contextViewProvider=o,this.options=r,this._pattern="",this.width=0,this._onDidChangeMode=new B,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new B,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new B,this._onDidChangeOpenState=new B,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new pe,this.disposables=new pe,this._mode=(a=e.options.defaultFindMode)!==null&&a!==void 0?a:za.Highlight,this._matchType=(l=e.options.defaultFindMatchType)!==null&&l!==void 0?l:bf.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){var e,t,i,s;const o=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&o?!((e=this.tree.options.showNotFoundMessage)!==null&&e!==void 0)||e?(t=this.widget)===null||t===void 0||t.showMessage({type:2,content:m("not found","No elements found.")}):(i=this.widget)===null||i===void 0||i.showMessage({type:2}):(s=this.widget)===null||s===void 0||s.clearMessage()}shouldAllowFocus(e){return!this.widget||!this.pattern||this._mode===za.Filter||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Xh.isDefault(e.filterData)}layout(e){var t;this.width=e,(t=this.widget)===null||t===void 0||t.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function k6(n){let e=Dh.Unknown;return R2(n.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=Dh.Twistie:R2(n.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=Dh.Element:R2(n.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=Dh.Filter),{browserEvent:n.browserEvent,element:n.element?n.element.element:null,target:e}}function HC(n,e){e(n),n.children.forEach(t=>HC(t,e))}class NE{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new B,this.onDidChange=this._onDidChange.event}set(e,t){!(t!=null&&t.__forceEvent)&&Ki(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const s=this;this._onDidChange.fire({get elements(){return s.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=d=>l.delete(d);t.forEach(d=>HC(d,c)),this.set([...l.values()]);return}const i=new Set,s=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>HC(l,s));const o=new Map,r=l=>o.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>HC(l,r));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const u=o.get(c);u&&u.visible&&a.push(u)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class S2e extends ZG{constructor(e,t){super(e),this.tree=t}onViewPointer(e){if(qG(e.browserEvent.target)||Id(e.browserEvent.target)||Xg(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,s=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let o=!1;if(typeof this.tree.expandOnlyOnTwistieClick=="function"?o=this.tree.expandOnlyOnTwistieClick(t.element):o=!!this.tree.expandOnlyOnTwistieClick,o&&!s&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e);if(t.collapsible){const r=this.tree.getNodeLocation(t),a=e.browserEvent.altKey;if(this.tree.setFocus([r]),this.tree.toggleCollapsed(r,a),o&&s){e.browserEvent.isHandledByList=!0;return}}super.onViewPointer(e)}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}}class x2e extends ca{constructor(e,t,i,s,o,r,a,l){super(e,t,i,s,l),this.focusTrait=o,this.selectionTrait=r,this.anchorTrait=a}createMouseController(e){return new S2e(this,e.tree)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const s=[],o=[];let r;i.forEach((a,l)=>{this.focusTrait.has(a)&&s.push(e+l),this.selectionTrait.has(a)&&o.push(e+l),this.anchorTrait.has(a)&&(r=e+l)}),s.length>0&&super.setFocus(uf([...super.getFocus(),...s])),o.length>0&&super.setSelection(uf([...super.getSelection(),...o])),typeof r=="number"&&super.setAnchor(r)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(s=>this.element(s)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(s=>this.element(s)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class uK{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return ue.filter(ue.map(this.view.onMouseDblClick,k6),e=>e.target!==Dh.Filter)}get onPointer(){return ue.map(this.view.onPointer,k6)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return ue.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var e,t;return(t=(e=this.findController)===null||e===void 0?void 0:e.mode)!==null&&t!==void 0?t:za.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){var e,t;return(t=(e=this.findController)===null||e===void 0?void 0:e.matchType)!==null&&t!==void 0?t:bf.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,s,o={}){var r;this._user=e,this._options=o,this.eventBufferer=new G4,this.onDidChangeFindOpenState=ue.None,this.disposables=new pe,this._onWillRefilter=new B,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new B;const a=new C3(i),l=new t9,c=new t9,d=this.disposables.add(new y2e(c.event)),u=new Kj;this.renderers=s.map(_=>new wv(_,()=>this.model,l.event,d,u,o));for(const _ of this.renderers)this.disposables.add(_);let h;o.keyboardNavigationLabelProvider&&(h=new w2e(this,o.keyboardNavigationLabelProvider,o.filter),o=Object.assign(Object.assign({},o),{filter:h}),this.disposables.add(h)),this.focus=new NE(()=>this.view.getFocusedElements()[0],o.identityProvider),this.selection=new NE(()=>this.view.getSelectedElements()[0],o.identityProvider),this.anchor=new NE(()=>this.view.getAnchorElement(),o.identityProvider),this.view=new x2e(e,t,a,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},v2e(()=>this.model,o)),{tree:this})),this.model=this.createModel(e,this.view,o),l.input=this.model.onDidChangeCollapseState;const f=ue.forEach(this.model.onDidSplice,_=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(_),this.selection.onDidModelSplice(_)})},this.disposables);f(()=>null,null,this.disposables);const g=this.disposables.add(new B),p=this.disposables.add(new xu(0));if(this.disposables.add(ue.any(f,this.focus.onDidChange,this.selection.onDidChange)(()=>{p.trigger(()=>{const _=new Set;for(const v of this.focus.getNodes())_.add(v);for(const v of this.selection.getNodes())_.add(v);g.fire([..._.values()])})})),c.input=g.event,o.keyboardSupport!==!1){const _=ue.chain(this.view.onKeyDown,v=>v.filter(b=>!Id(b.target)).map(b=>new zt(b)));ue.chain(_,v=>v.filter(b=>b.keyCode===15))(this.onLeftArrow,this,this.disposables),ue.chain(_,v=>v.filter(b=>b.keyCode===17))(this.onRightArrow,this,this.disposables),ue.chain(_,v=>v.filter(b=>b.keyCode===10))(this.onSpace,this,this.disposables)}if((!((r=o.findWidgetEnabled)!==null&&r!==void 0)||r)&&o.keyboardNavigationLabelProvider&&o.contextViewProvider){const _=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new C2e(this,this.model,this.view,h,o.contextViewProvider,_),this.focusNavigationFilter=v=>this.findController.shouldAllowFocus(v),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=ue.None,this.onDidChangeFindMatchType=ue.None;this.styleElement=wr(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===yv.Always)}updateOptions(e={}){var t;this._options=Object.assign(Object.assign({},this._options),e);for(const i of this.renderers)i.updateOptions(e);this.view.updateOptions(this._options),(t=this.findController)===null||t===void 0||t.updateOptions(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===yv.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}domFocus(){this.view.domFocus()}layout(e,t){var i;this.view.layout(e,t),Xd(t)&&((i=this.findController)===null||i===void 0||i.layout(t))}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){const i=e.map(o=>this.model.getNode(o));this.selection.set(i,t);const s=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setSelection(s,t,!0)}getSelection(){return this.selection.get()}setFocus(e,t){const i=e.map(o=>this.model.getNode(o));this.focus.set(i,t);const s=e.map(o=>this.model.getListIndex(o)).filter(o=>o>-1);this.view.setFocus(s,t,!0)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);i!==-1&&this.view.reveal(i,t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!0)){const r=this.model.getParentNodeLocation(s);if(!r)return;const a=this.model.getListIndex(r);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!1)){if(!i.children.some(l=>l.visible))return;const[r]=this.view.getFocus(),a=r+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],s=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(s,void 0,o)}dispose(){Ft(this.disposables),this.view.dispose()}}class S3{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new m2e(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(s,o){return i.sorter.compare(s.element,o.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=dt.empty(),i={}){const s=this.getElementLocation(e);this._setChildren(s,this.preserveCollapseState(t),i)}_setChildren(e,t=dt.empty(),i){const s=new Set,o=new Set,r=l=>{var c;if(l.element===null)return;const d=l;if(s.add(d.element),this.nodes.set(d.element,d),this.identityProvider){const u=this.identityProvider.getId(d.element).toString();o.add(u),this.nodesByIdentity.set(u,d)}(c=i.onDidCreateNode)===null||c===void 0||c.call(i,d)},a=l=>{var c;if(l.element===null)return;const d=l;if(s.has(d.element)||this.nodes.delete(d.element),this.identityProvider){const u=this.identityProvider.getId(d.element).toString();o.has(u)||this.nodesByIdentity.delete(u)}(c=i.onDidDeleteNode)===null||c===void 0||c.call(i,d)};this.model.splice([...e,0],Number.MAX_VALUE,t,Object.assign(Object.assign({},i),{onDidCreateNode:r,onDidDeleteNode:a}))}preserveCollapseState(e=dt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),dt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const r=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(r)}if(!i){let r;return typeof t.collapsed>"u"?r=void 0:t.collapsed===va.Collapsed||t.collapsed===va.PreserveOrCollapsed?r=!0:t.collapsed===va.Expanded||t.collapsed===va.PreserveOrExpanded?r=!1:r=!!t.collapsed,Object.assign(Object.assign({},t),{children:this.preserveCollapseState(t.children),collapsed:r})}const s=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let o;return typeof t.collapsed>"u"||t.collapsed===va.PreserveOrCollapsed||t.collapsed===va.PreserveOrExpanded?o=i.collapsed:t.collapsed===va.Collapsed?o=!0:t.collapsed===va.Expanded?o=!1:o=!!t.collapsed,Object.assign(Object.assign({},t),{collapsible:s,collapsed:o,children:this.preserveCollapseState(t.children)})})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const s=this.getElementLocation(e);return this.model.setCollapsed(s,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new _o(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new _o(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new _o(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),s=this.model.getParentNodeLocation(i);return this.model.getNode(s).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new _o(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function $C(n){const e=[n.element],t=n.incompressible||!1;return{element:{elements:e,incompressible:t},children:dt.map(dt.from(n.children),$C),collapsible:n.collapsible,collapsed:n.collapsed}}function UC(n){const e=[n.element],t=n.incompressible||!1;let i,s;for(;[s,i]=dt.consume(dt.from(n.children),2),!(s.length!==1||s[0].incompressible);)n=s[0],e.push(n.element);return{element:{elements:e,incompressible:t},children:dt.map(dt.concat(s,i),UC),collapsible:n.collapsible,collapsed:n.collapsed}}function GN(n,e=0){let t;return e<n.element.elements.length-1?t=[GN(n,e+1)]:t=dt.map(dt.from(n.children),i=>GN(i,0)),e===0&&n.element.incompressible?{element:n.element.elements[e],children:t,incompressible:!0,collapsible:n.collapsible,collapsed:n.collapsed}:{element:n.element.elements[e],children:t,collapsible:n.collapsible,collapsed:n.collapsed}}function E6(n){return GN(n,0)}function hK(n,e,t){return n.element===e?Object.assign(Object.assign({},n),{children:t}):Object.assign(Object.assign({},n),{children:dt.map(dt.from(n.children),i=>hK(i,e,t))})}const L2e=n=>({getId(e){return e.elements.map(t=>n.getId(t).toString()).join("\0")}});class D2e{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new S3(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=dt.empty(),i){const s=i.diffIdentityProvider&&L2e(i.diffIdentityProvider);if(e===null){const g=dt.map(t,this.enabled?UC:$C);this._setChildren(null,g,{diffIdentityProvider:s,diffDepth:1/0});return}const o=this.nodes.get(e);if(!o)throw new _o(this.user,"Unknown compressed tree node");const r=this.model.getNode(o),a=this.model.getParentNodeLocation(o),l=this.model.getNode(a),c=E6(r),d=hK(c,e,t),u=(this.enabled?UC:$C)(d),h=i.diffIdentityProvider?(g,p)=>i.diffIdentityProvider.getId(g)===i.diffIdentityProvider.getId(p):void 0;if(Ki(u.element.elements,r.element.elements,h)){this._setChildren(o,u.children||dt.empty(),{diffIdentityProvider:s,diffDepth:1});return}const f=l.children.map(g=>g===r?u:g);this._setChildren(l.element,f,{diffIdentityProvider:s,diffDepth:r.depth-l.depth})}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,s=dt.map(i,E6),o=dt.map(s,e?UC:$C);this._setChildren(null,o,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const s=new Set,o=a=>{for(const l of a.element.elements)s.add(l),this.nodes.set(l,a.element)},r=a=>{for(const l of a.element.elements)s.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,Object.assign(Object.assign({},i),{onDidCreateNode:o,onDidDeleteNode:r}))}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const s=this.getCompressedNode(e);return this.model.setCollapsed(s,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new _o(this.user,`Tree element not found: ${e}`);return t}}const k2e=n=>n[n.length-1];class x3{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new x3(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function E2e(n,e){return{splice(t,i,s){e.splice(t,i,s.map(o=>n.map(o)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function A2e(n,e){return Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(n(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(n(t),i)}}})}class I2e{get onDidSplice(){return ue.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return ue.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return ue.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||k2e;const s=o=>this.elementMapper(o.elements);this.nodeMapper=new y3(o=>new x3(s,o)),this.model=new D2e(e,E2e(this.nodeMapper,t),A2e(s,i))}setChildren(e,t=dt.empty(),i={}){this.model.setChildren(e,t,i)}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var T2e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o};class L3 extends uK{get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,s,o={}){super(e,t,i,s,o),this.user=e}setChildren(e,t=dt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new S3(e,t,i)}}class fK{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t){this._compressedTreeNodeProvider=e,this.renderer=t,this.templateId=t.templateId,t.onDidChangeTwistieState&&(this.onDidChangeTwistieState=t.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){const o=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element);o.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,s)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,t,i.data,s))}disposeElement(e,t,i,s){var o,r,a,l;i.compressedTreeNode?(r=(o=this.renderer).disposeCompressedElements)===null||r===void 0||r.call(o,i.compressedTreeNode,t,i.data,s):(l=(a=this.renderer).disposeElement)===null||l===void 0||l.call(a,e,t,i.data,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}T2e([Di],fK.prototype,"compressedTreeNodeProvider",null);function N2e(n,e){return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=n().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}})}class gK extends L3{constructor(e,t,i,s,o={}){const r=()=>this,a=s.map(l=>new fK(r,l));super(e,t,i,a,N2e(r,o))}setChildren(e,t=dt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new I2e(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}var Mc=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function RE(n){return Object.assign(Object.assign({},n),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function KN(n,e){return e.parent?e.parent===n?!0:KN(n,e.parent):!1}function R2e(n,e){return n===e||KN(n,e)||KN(e,n)}class D3{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new D3(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class M2e{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ne.asClassNameArray(se.treeItemLoading)),!0):(t.classList.remove(...Ne.asClassNameArray(se.treeItemLoading)),!1)}disposeElement(e,t,i,s){var o,r;(r=(o=this.renderer).disposeElement)===null||r===void 0||r.call(o,this.nodeMapper.map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function A6(n){return{browserEvent:n.browserEvent,elements:n.elements.map(e=>e.element)}}function I6(n){return{browserEvent:n.browserEvent,element:n.element&&n.element.element,target:n.target}}class P2e extends py{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function ME(n){return n instanceof py?new P2e(n):n}class O2e{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){var i,s;(s=(i=this.dnd).onDragStart)===null||s===void 0||s.call(i,ME(e),t)}onDragOver(e,t,i,s,o=!0){return this.dnd.onDragOver(ME(e),t&&t.element,i,s)}drop(e,t,i,s){this.dnd.drop(ME(e),t&&t.element,i,s)}onDragEnd(e){var t,i;(i=(t=this.dnd).onDragEnd)===null||i===void 0||i.call(t,e)}dispose(){this.dnd.dispose()}}function pK(n){return n&&Object.assign(Object.assign({},n),{collapseByDefault:!0,identityProvider:n.identityProvider&&{getId(e){return n.identityProvider.getId(e.element)}},dnd:n.dnd&&new O2e(n.dnd),multipleSelectionController:n.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return n.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},isSelectionRangeChangeEvent(e){return n.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))}},accessibilityProvider:n.accessibilityProvider&&Object.assign(Object.assign({},n.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:n.accessibilityProvider.getRole?e=>n.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:n.accessibilityProvider.isChecked?e=>{var t;return!!(!((t=n.accessibilityProvider)===null||t===void 0)&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return n.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return n.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:n.accessibilityProvider.getWidgetRole?()=>n.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:n.accessibilityProvider.getAriaLevel&&(e=>n.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:n.accessibilityProvider.getActiveDescendantId&&(e=>n.accessibilityProvider.getActiveDescendantId(e.element))}),filter:n.filter&&{filter(e,t){return n.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:n.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},n.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(e){return n.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}),sorter:void 0,expandOnlyOnTwistieClick:typeof n.expandOnlyOnTwistieClick>"u"?void 0:typeof n.expandOnlyOnTwistieClick!="function"?n.expandOnlyOnTwistieClick:e=>n.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof n.defaultFindVisibility=="number"?n.defaultFindVisibility:typeof n.defaultFindVisibility>"u"?2:n.defaultFindVisibility(e.element)})}function YN(n,e){e(n),n.children.forEach(t=>YN(t,e))}class mK{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return ue.map(this.tree.onDidChangeFocus,A6)}get onDidChangeSelection(){return ue.map(this.tree.onDidChangeSelection,A6)}get onMouseDblClick(){return ue.map(this.tree.onMouseDblClick,I6)}get onPointer(){return ue.map(this.tree.onPointer,I6)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,s,o,r={}){this.user=e,this.dataSource=o,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new B,this._onDidChangeNodeSlowState=new B,this.nodeMapper=new y3(a=>new D3(a)),this.disposables=new pe,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=typeof r.autoExpandSingleChildren>"u"?!1:r.autoExpandSingleChildren,this.sorter=r.sorter,this.collapseByDefault=r.collapseByDefault,this.tree=this.createTree(e,t,i,s,r),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.root=RE({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,s,o){const r=new C3(i),a=s.map(c=>new M2e(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=pK(o)||{};return new L3(e,t,r,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}setInput(e,t){return Mc(this,void 0,void 0,function*(){this.refreshPromises.forEach(s=>s.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};yield this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)})}_updateChildren(e=this.root.element,t=!0,i=!1,s,o){return Mc(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new _o(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield ue.toPromise(this._onDidRender.event));const r=this.getDataNode(e);if(yield this.refreshAndRenderNode(r,t,s,o),i)try{this.tree.rerender(r)}catch{}})}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}expand(e,t=!1){return Mc(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new _o(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield ue.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(yield this.root.refreshPromise,yield ue.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const s=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(yield this.root.refreshPromise,yield ue.toPromise(this._onDidRender.event)),s})}setSelection(e,t){const i=e.map(s=>this.getDataNode(s));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(s=>this.getDataNode(s));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new _o(this.user,`Data tree node not found: ${e}`);return t}refreshAndRenderNode(e,t,i,s){return Mc(this,void 0,void 0,function*(){yield this.refreshNode(e,t,i),this.render(e,i,s)})}refreshNode(e,t,i){return Mc(this,void 0,void 0,function*(){let s;if(this.subTreeRefreshPromises.forEach((o,r)=>{!s&&R2e(r,e)&&(s=o.then(()=>this.refreshNode(e,t,i)))}),s)return s;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0;return}return this.doRefreshSubTree(e,t,i)})}doRefreshSubTree(e,t,i){return Mc(this,void 0,void 0,function*(){let s;e.refreshPromise=new Promise(o=>s=o),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const o=yield this.doRefreshNode(e,t,i);e.stale=!1,yield kT.settled(o.map(r=>this.doRefreshSubTree(r,t,i)))}finally{s()}})}doRefreshNode(e,t,i){return Mc(this,void 0,void 0,function*(){e.hasChildren=!!this.dataSource.hasChildren(e.element);let s;if(!e.hasChildren)s=Promise.resolve(dt.empty());else{const o=this.doGetChildren(e);if(YF(o))s=Promise.resolve(o);else{const r=Hb(800);r.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),s=o.finally(()=>r.cancel())}}try{const o=yield s;return this.setChildren(e,o,t,i)}catch(o){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),Rf(o))return[];throw o}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}})}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return YF(i)?this.processChildren(i):(t=wc(()=>Mc(this,void 0,void 0,function*(){return this.processChildren(yield i)})),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(mt))}setChildren(e,t,i,s){const o=[...t];if(e.children.length===0&&o.length===0)return[];const r=new Map,a=new Map;for(const d of e.children)if(r.set(d.element,d),this.identityProvider){const u=this.tree.isCollapsed(d);a.set(d.id,{node:d,collapsed:u})}const l=[],c=o.map(d=>{const u=!!this.dataSource.hasChildren(d);if(!this.identityProvider){const p=RE({element:d,parent:e,hasChildren:u});return u&&this.collapseByDefault&&!this.collapseByDefault(d)&&(p.collapsedByDefault=!1,l.push(p)),p}const h=this.identityProvider.getId(d).toString(),f=a.get(h);if(f){const p=f.node;return r.delete(p.element),this.nodes.delete(p.element),this.nodes.set(d,p),p.element=d,p.hasChildren=u,i?f.collapsed?(p.children.forEach(_=>YN(_,v=>this.nodes.delete(v.element))),p.children.splice(0,p.children.length),p.stale=!0):l.push(p):u&&this.collapseByDefault&&!this.collapseByDefault(d)&&(p.collapsedByDefault=!1,l.push(p)),p}const g=RE({element:d,parent:e,id:h,hasChildren:u});return s&&s.viewState.focus&&s.viewState.focus.indexOf(h)>-1&&s.focus.push(g),s&&s.viewState.selection&&s.viewState.selection.indexOf(h)>-1&&s.selection.push(g),s&&s.viewState.expanded&&s.viewState.expanded.indexOf(h)>-1?l.push(g):u&&this.collapseByDefault&&!this.collapseByDefault(d)&&(g.collapsedByDefault=!1,l.push(g)),g});for(const d of r.values())YN(d,u=>this.nodes.delete(u.element));for(const d of c)this.nodes.set(d.element,d);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].collapsedByDefault=!1,l.push(c[0])),l}render(e,t,i){const s=e.children.map(r=>this.asTreeElement(r,t)),o=i&&Object.assign(Object.assign({},i),{diffIdentityProvider:i.diffIdentityProvider&&{getId(r){return i.diffIdentityProvider.getId(r.element)}}});this.tree.setChildren(e===this.root?null:e,s,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:i=e.collapsedByDefault,e.collapsedByDefault=void 0,{element:e,children:e.hasChildren?dt.map(e.children,s=>this.asTreeElement(s,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class k3{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new k3(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class F2e{constructor(e,t,i,s){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=s,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderCompressedElements(e,t,i,s){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...Ne.asClassNameArray(se.treeItemLoading)),!0):(t.classList.remove(...Ne.asClassNameArray(se.treeItemLoading)),!1)}disposeElement(e,t,i,s){var o,r;(r=(o=this.renderer).disposeElement)===null||r===void 0||r.call(o,this.nodeMapper.map(e),t,i.templateData,s)}disposeCompressedElements(e,t,i,s){var o,r;(r=(o=this.renderer).disposeCompressedElements)===null||r===void 0||r.call(o,this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=Ft(this.disposables)}}function B2e(n){const e=n&&pK(n);return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel(t){return n.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}})})}class W2e extends mK{constructor(e,t,i,s,o,r,a={}){super(e,t,i,o,r,a),this.compressionDelegate=s,this.compressibleNodeMapper=new y3(l=>new k3(l)),this.filter=a.filter}createTree(e,t,i,s,o){const r=new C3(i),a=s.map(c=>new F2e(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=B2e(o)||{};return new gK(e,t,r,a,l)}asTreeElement(e,t){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(e.element)},super.asTreeElement(e,t))}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t){if(!this.identityProvider)return super.render(e,t);const i=h=>this.identityProvider.getId(h).toString(),s=h=>{const f=new Set;for(const g of h){const p=this.tree.getCompressedTreeNode(g===this.root?null:g);if(p.element)for(const _ of p.element.elements)f.add(i(_.element))}return f},o=s(this.tree.getSelection()),r=s(this.tree.getFocus());super.render(e,t);const a=this.getSelection();let l=!1;const c=this.getFocus();let d=!1;const u=h=>{const f=h.element;if(f)for(let g=0;g<f.elements.length;g++){const p=i(f.elements[g].element),_=f.elements[f.elements.length-1].element;o.has(p)&&a.indexOf(_)===-1&&(a.push(_),l=!0),r.has(p)&&c.indexOf(_)===-1&&(c.push(_),d=!0)}h.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),l&&this.setSelection(a),d&&this.setFocus(c)}processChildren(e){return this.filter&&(e=dt.filter(e,t=>{const i=this.filter.filter(t,1),s=V2e(i);if(s===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return s===1})),super.processChildren(e)}}function V2e(n){return typeof n=="boolean"?n?1:0:w3(n)?vv(n.visibility):vv(n)}class z2e extends uK{constructor(e,t,i,s,o,r={}){super(e,t,i,s,r),this.user=e,this.dataSource=o,this.identityProvider=r.identityProvider}createModel(e,t,i){return new S3(e,t,i)}}new _e("isMac",pt,m("isMac","Whether the operating system is macOS"));new _e("isLinux",Xn,m("isLinux","Whether the operating system is Linux"));new _e("isWindows",Ps,m("isWindows","Whether the operating system is Windows"));const _K=new _e("isWeb",Zm,m("isWeb","Whether the platform is a web browser"));new _e("isMacNative",pt&&!Zm,m("isMacNative","Whether the operating system is macOS on a non-browser platform"));new _e("isIOS",Qd,m("isIOS","Whether the operating system is iOS"));new _e("isMobile",rfe,m("isMobile","Whether the platform is a mobile web browser"));new _e("isDevelopment",!1,!0);new _e("productQualityType","",m("productQualityType","Quality type of VS Code"));const bK="inputFocus";new _e(bK,!1,m("inputFocus","Whether keyboard focus is inside an input box"));var Lc=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Bt=function(n,e){return function(t,i){e(t,i,n)}};const Zo=at("listService");class H2e{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new pe,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&((t=this._lastFocusedWidget)===null||t===void 0||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,(i=this._lastFocusedWidget)===null||i===void 0||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new XG(wr(),"").style(Kf)),this.lists.some(s=>s.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),e.getHTMLElement()===document.activeElement&&this.setLastFocusedList(e),fr(e.onDidFocus(()=>this.setLastFocusedList(e)),Ze(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(s=>s!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const Cv=new _e("listScrollAtBoundary","none");Le.or(Cv.isEqualTo("top"),Cv.isEqualTo("both"));Le.or(Cv.isEqualTo("bottom"),Cv.isEqualTo("both"));const vK=new _e("listFocus",!0),rk=new _e("listSupportsMultiselect",!0),yK=Le.and(vK,Le.not(bK)),E3=new _e("listHasSelectionOrFocus",!1),A3=new _e("listDoubleSelection",!1),I3=new _e("listMultiSelection",!1),ak=new _e("listSelectionNavigation",!1),$2e=new _e("listSupportsFind",!0),T3=new _e("treeElementCanCollapse",!1),U2e=new _e("treeElementHasParent",!1),N3=new _e("treeElementCanExpand",!1),j2e=new _e("treeElementHasChild",!1),q2e=new _e("treeFindOpen",!1),wK="listTypeNavigationMode",CK="listAutomaticKeyboardNavigation";function lk(n,e){const t=n.createScoped(e.getHTMLElement());return vK.bindTo(t),t}function ck(n,e){const t=Cv.bindTo(n),i=()=>{const s=e.scrollTop===0,o=e.scrollHeight-e.renderHeight-e.scrollTop<1;s&&o?t.set("both"):s?t.set("top"):o?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Yf="workbench.list.multiSelectModifier",jC="workbench.list.openMode",$o="workbench.list.horizontalScrolling",R3="workbench.list.defaultFindMode",M3="workbench.list.typeNavigationMode",Fx="workbench.list.keyboardNavigation",oa="workbench.list.scrollByPage",P3="workbench.list.defaultFindMatchType",Sv="workbench.tree.indent",Bx="workbench.tree.renderIndentGuides",ra="workbench.list.smoothScrolling",nl="workbench.list.mouseWheelScrollSensitivity",sl="workbench.list.fastScrollSensitivity",Wx="workbench.tree.expandMode";function ol(n){return n.getValue(Yf)==="alt"}class G2e extends Y{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=ol(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Yf)&&(this.useAltAsMultipleSelectionModifier=ol(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:KG(e)}isSelectionRangeChangeEvent(e){return YG(e)}}function dk(n,e){var t;const i=n.get(ti),s=n.get(bi),o=new pe;return[Object.assign(Object.assign({},e),{keyboardNavigationDelegate:{mightProducePrintableCharacter(a){return s.mightProducePrintableCharacter(a)}},smoothScrolling:!!i.getValue(ra),mouseWheelScrollSensitivity:i.getValue(nl),fastScrollSensitivity:i.getValue(sl),multipleSelectionController:(t=e.multipleSelectionController)!==null&&t!==void 0?t:o.add(new G2e(i)),keyboardNavigationEventFilter:Z2e(s),scrollByPage:!!i.getValue(oa)}),o]}let ZN=class extends ca{constructor(e,t,i,s,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue($o),[u,h]=c.invokeFunction(dk,o);super(e,t,i,s,Object.assign(Object.assign({keyboardSupport:!1},u),{horizontalScrolling:d})),this.disposables.add(h),this.contextKeyService=lk(r,this),this.disposables.add(ck(this.contextKeyService,this)),this.listSupportsMultiSelect=rk.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),ak.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=E3.bindTo(this.contextKeyService),this.listDoubleSelection=A3.bindTo(this.contextKeyService),this.listMultiSelection=I3.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ol(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const g=this.getSelection(),p=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(g.length>0||p.length>0),this.listMultiSelection.set(g.length>1),this.listDoubleSelection.set(g.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const g=this.getSelection(),p=this.getFocus();this.listHasSelectionOrFocus.set(g.length>0||p.length>0)})),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Yf)&&(this._useAltAsMultipleSelectionModifier=ol(l));let p={};if(g.affectsConfiguration($o)&&this.horizontalScrolling===void 0){const _=!!l.getValue($o);p=Object.assign(Object.assign({},p),{horizontalScrolling:_})}if(g.affectsConfiguration(oa)){const _=!!l.getValue(oa);p=Object.assign(Object.assign({},p),{scrollByPage:_})}if(g.affectsConfiguration(ra)){const _=!!l.getValue(ra);p=Object.assign(Object.assign({},p),{smoothScrolling:_})}if(g.affectsConfiguration(nl)){const _=l.getValue(nl);p=Object.assign(Object.assign({},p),{mouseWheelScrollSensitivity:_})}if(g.affectsConfiguration(sl)){const _=l.getValue(sl);p=Object.assign(Object.assign({},p),{fastScrollSensitivity:_})}Object.keys(p).length>0&&this.updateOptions(p)})),this.navigator=new SK(this,Object.assign({configurationService:l},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?my(e):Kf)}};ZN=Lc([Bt(5,tt),Bt(6,Zo),Bt(7,ti),Bt(8,vt)],ZN);let T6=class extends Qke{constructor(e,t,i,s,o,r,a,l,c){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!l.getValue($o),[u,h]=c.invokeFunction(dk,o);super(e,t,i,s,Object.assign(Object.assign({keyboardSupport:!1},u),{horizontalScrolling:d})),this.disposables=new pe,this.disposables.add(h),this.contextKeyService=lk(r,this),this.disposables.add(ck(this.contextKeyService,this.widget)),this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=rk.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),ak.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this._useAltAsMultipleSelectionModifier=ol(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(o.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(g=>{g.affectsConfiguration(Yf)&&(this._useAltAsMultipleSelectionModifier=ol(l));let p={};if(g.affectsConfiguration($o)&&this.horizontalScrolling===void 0){const _=!!l.getValue($o);p=Object.assign(Object.assign({},p),{horizontalScrolling:_})}if(g.affectsConfiguration(oa)){const _=!!l.getValue(oa);p=Object.assign(Object.assign({},p),{scrollByPage:_})}if(g.affectsConfiguration(ra)){const _=!!l.getValue(ra);p=Object.assign(Object.assign({},p),{smoothScrolling:_})}if(g.affectsConfiguration(nl)){const _=l.getValue(nl);p=Object.assign(Object.assign({},p),{mouseWheelScrollSensitivity:_})}if(g.affectsConfiguration(sl)){const _=l.getValue(sl);p=Object.assign(Object.assign({},p),{fastScrollSensitivity:_})}Object.keys(p).length>0&&this.updateOptions(p)})),this.navigator=new SK(this,Object.assign({configurationService:l},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?my(e):Kf)}dispose(){this.disposables.dispose(),super.dispose()}};T6=Lc([Bt(5,tt),Bt(6,Zo),Bt(7,ti),Bt(8,vt)],T6);let N6=class extends ok{constructor(e,t,i,s,o,r,a,l,c,d){const u=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!c.getValue($o),[h,f]=d.invokeFunction(dk,r);super(e,t,i,s,o,Object.assign(Object.assign({keyboardSupport:!1},h),{horizontalScrolling:u})),this.disposables.add(f),this.contextKeyService=lk(a,this),this.disposables.add(ck(this.contextKeyService,this)),this.listSupportsMultiSelect=rk.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),ak.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=E3.bindTo(this.contextKeyService),this.listDoubleSelection=A3.bindTo(this.contextKeyService),this.listMultiSelection=I3.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=ol(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const p=this.getSelection(),_=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(p.length>0||_.length>0),this.listMultiSelection.set(p.length>1),this.listDoubleSelection.set(p.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const p=this.getSelection(),_=this.getFocus();this.listHasSelectionOrFocus.set(p.length>0||_.length>0)})),this.disposables.add(c.onDidChangeConfiguration(p=>{p.affectsConfiguration(Yf)&&(this._useAltAsMultipleSelectionModifier=ol(c));let _={};if(p.affectsConfiguration($o)&&this.horizontalScrolling===void 0){const v=!!c.getValue($o);_=Object.assign(Object.assign({},_),{horizontalScrolling:v})}if(p.affectsConfiguration(oa)){const v=!!c.getValue(oa);_=Object.assign(Object.assign({},_),{scrollByPage:v})}if(p.affectsConfiguration(ra)){const v=!!c.getValue(ra);_=Object.assign(Object.assign({},_),{smoothScrolling:v})}if(p.affectsConfiguration(nl)){const v=c.getValue(nl);_=Object.assign(Object.assign({},_),{mouseWheelScrollSensitivity:v})}if(p.affectsConfiguration(sl)){const v=c.getValue(sl);_=Object.assign(Object.assign({},_),{fastScrollSensitivity:v})}Object.keys(_).length>0&&this.updateOptions(_)})),this.navigator=new K2e(this,Object.assign({configurationService:c},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?my(e):Kf)}dispose(){this.disposables.dispose(),super.dispose()}};N6=Lc([Bt(6,tt),Bt(7,Zo),Bt(8,ti),Bt(9,vt)],N6);class O3 extends Y{constructor(e,t){var i;super(),this.widget=e,this._onDidOpen=this._register(new B),this.onDidOpen=this._onDidOpen.event,this._register(ue.filter(this.widget.onDidChangeSelection,s=>s.browserEvent instanceof KeyboardEvent)(s=>this.onSelectionFromKeyboard(s))),this._register(this.widget.onPointer(s=>this.onPointer(s.element,s.browserEvent))),this._register(this.widget.onMouseDblClick(s=>this.onMouseDblClick(s.element,s.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(jC))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(s=>{s.affectsConfiguration(jC)&&(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(jC))!=="doubleClick")}))):this.openOnSingleClick=(i=t==null?void 0:t.openOnSingleClick)!==null&&i!==void 0?i:!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,s=typeof t.pinned=="boolean"?t.pinned:!i,o=!1;this._open(this.getSelectedElement(),i,s,o,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const s=t.button===1,o=!0,r=s,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const o=!1,r=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,o,r,a,t)}_open(e,t,i,s,o){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:s,element:e,browserEvent:o})}}class SK extends O3{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class K2e extends O3{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Y2e extends O3{constructor(e,t){super(e,t)}getSelectedElement(){var e;return(e=this.widget.getSelection()[0])!==null&&e!==void 0?e:void 0}}function Z2e(n){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=n.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let R6=class extends L3{constructor(e,t,i,s,o,r,a,l,c){const{options:d,getTypeNavigationMode:u,disposable:h}=r.invokeFunction(vy,o);super(e,t,i,s,d),this.disposables.add(h),this.internals=new vf(this,o,u,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};R6=Lc([Bt(5,vt),Bt(6,tt),Bt(7,Zo),Bt(8,ti)],R6);let M6=class extends gK{constructor(e,t,i,s,o,r,a,l,c){const{options:d,getTypeNavigationMode:u,disposable:h}=r.invokeFunction(vy,o);super(e,t,i,s,d),this.disposables.add(h),this.internals=new vf(this,o,u,o.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};M6=Lc([Bt(5,vt),Bt(6,tt),Bt(7,Zo),Bt(8,ti)],M6);let P6=class extends z2e{constructor(e,t,i,s,o,r,a,l,c,d){const{options:u,getTypeNavigationMode:h,disposable:f}=a.invokeFunction(vy,r);super(e,t,i,s,o,u),this.disposables.add(f),this.internals=new vf(this,r,h,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};P6=Lc([Bt(6,vt),Bt(7,tt),Bt(8,Zo),Bt(9,ti)],P6);let XN=class extends mK{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,s,o,r,a,l,c,d){const{options:u,getTypeNavigationMode:h,disposable:f}=a.invokeFunction(vy,r);super(e,t,i,s,o,u),this.disposables.add(f),this.internals=new vf(this,r,h,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};XN=Lc([Bt(6,vt),Bt(7,tt),Bt(8,Zo),Bt(9,ti)],XN);let O6=class extends W2e{constructor(e,t,i,s,o,r,a,l,c,d,u){const{options:h,getTypeNavigationMode:f,disposable:g}=l.invokeFunction(vy,a);super(e,t,i,s,o,r,h),this.disposables.add(g),this.internals=new vf(this,a,f,a.overrideStyles,c,d,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};O6=Lc([Bt(7,vt),Bt(8,tt),Bt(9,Zo),Bt(10,ti)],O6);function xK(n){const e=n.getValue(R3);if(e==="highlight")return za.Highlight;if(e==="filter")return za.Filter;const t=n.getValue(Fx);if(t==="simple"||t==="highlight")return za.Highlight;if(t==="filter")return za.Filter}function LK(n){const e=n.getValue(P3);if(e==="fuzzy")return bf.Fuzzy;if(e==="contiguous")return bf.Contiguous}function vy(n,e){var t;const i=n.get(ti),s=n.get(Eu),o=n.get(tt),r=n.get(vt),a=()=>{const f=o.getContextKeyValue(wK);if(f==="automatic")return Ta.Automatic;if(f==="trigger"||o.getContextKeyValue(CK)===!1)return Ta.Trigger;const p=i.getValue(M3);if(p==="automatic")return Ta.Automatic;if(p==="trigger")return Ta.Trigger},l=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!i.getValue($o),[c,d]=r.invokeFunction(dk,e),u=e.paddingBottom,h=e.renderIndentGuides!==void 0?e.renderIndentGuides:i.getValue(Bx);return{getTypeNavigationMode:a,disposable:d,options:Object.assign(Object.assign({keyboardSupport:!1},c),{indent:typeof i.getValue(Sv)=="number"?i.getValue(Sv):void 0,renderIndentGuides:h,smoothScrolling:!!i.getValue(ra),defaultFindMode:xK(i),defaultFindMatchType:LK(i),horizontalScrolling:l,scrollByPage:!!i.getValue(oa),paddingBottom:u,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:(t=e.expandOnlyOnTwistieClick)!==null&&t!==void 0?t:i.getValue(Wx)==="doubleClick",contextViewProvider:s,findWidgetStyles:Tke})}}let vf=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,s,o,r,a){var l;this.tree=e,this.disposables=[],this.contextKeyService=lk(o,e),this.disposables.push(ck(this.contextKeyService,e)),this.listSupportsMultiSelect=rk.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),ak.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=$2e.bindTo(this.contextKeyService),this.listSupportFindWidget.set((l=t.findWidgetEnabled)!==null&&l!==void 0?l:!0),this.hasSelectionOrFocus=E3.bindTo(this.contextKeyService),this.hasDoubleSelection=A3.bindTo(this.contextKeyService),this.hasMultiSelection=I3.bindTo(this.contextKeyService),this.treeElementCanCollapse=T3.bindTo(this.contextKeyService),this.treeElementHasParent=U2e.bindTo(this.contextKeyService),this.treeElementCanExpand=N3.bindTo(this.contextKeyService),this.treeElementHasChild=j2e.bindTo(this.contextKeyService),this.treeFindOpen=q2e.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=ol(a),this.updateStyleOverrides(s);const d=()=>{const h=e.getFocus()[0];if(!h)return;const f=e.getNode(h);this.treeElementCanCollapse.set(f.collapsible&&!f.collapsed),this.treeElementHasParent.set(!!e.getParentElement(h)),this.treeElementCanExpand.set(f.collapsible&&f.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(h))},u=new Set;u.add(wK),u.add(CK),this.disposables.push(this.contextKeyService,r.register(e),e.onDidChangeSelection(()=>{const h=e.getSelection(),f=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(h.length>0||f.length>0),this.hasMultiSelection.set(h.length>1),this.hasDoubleSelection.set(h.length===2)})}),e.onDidChangeFocus(()=>{const h=e.getSelection(),f=e.getFocus();this.hasSelectionOrFocus.set(h.length>0||f.length>0),d()}),e.onDidChangeCollapseState(d),e.onDidChangeModel(d),e.onDidChangeFindOpenState(h=>this.treeFindOpen.set(h)),a.onDidChangeConfiguration(h=>{let f={};if(h.affectsConfiguration(Yf)&&(this._useAltAsMultipleSelectionModifier=ol(a)),h.affectsConfiguration(Sv)){const g=a.getValue(Sv);f=Object.assign(Object.assign({},f),{indent:g})}if(h.affectsConfiguration(Bx)&&t.renderIndentGuides===void 0){const g=a.getValue(Bx);f=Object.assign(Object.assign({},f),{renderIndentGuides:g})}if(h.affectsConfiguration(ra)){const g=!!a.getValue(ra);f=Object.assign(Object.assign({},f),{smoothScrolling:g})}if(h.affectsConfiguration(R3)||h.affectsConfiguration(Fx)){const g=xK(a);f=Object.assign(Object.assign({},f),{defaultFindMode:g})}if(h.affectsConfiguration(M3)||h.affectsConfiguration(Fx)){const g=i();f=Object.assign(Object.assign({},f),{typeNavigationMode:g})}if(h.affectsConfiguration(P3)){const g=LK(a);f=Object.assign(Object.assign({},f),{defaultFindMatchType:g})}if(h.affectsConfiguration($o)&&t.horizontalScrolling===void 0){const g=!!a.getValue($o);f=Object.assign(Object.assign({},f),{horizontalScrolling:g})}if(h.affectsConfiguration(oa)){const g=!!a.getValue(oa);f=Object.assign(Object.assign({},f),{scrollByPage:g})}if(h.affectsConfiguration(Wx)&&t.expandOnlyOnTwistieClick===void 0&&(f=Object.assign(Object.assign({},f),{expandOnlyOnTwistieClick:a.getValue(Wx)==="doubleClick"})),h.affectsConfiguration(nl)){const g=a.getValue(nl);f=Object.assign(Object.assign({},f),{mouseWheelScrollSensitivity:g})}if(h.affectsConfiguration(sl)){const g=a.getValue(sl);f=Object.assign(Object.assign({},f),{fastScrollSensitivity:g})}Object.keys(f).length>0&&e.updateOptions(f)}),this.contextKeyService.onDidChangeContext(h=>{h.affectsSome(u)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new Y2e(e,Object.assign({configurationService:a},t)),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?my(e):Kf)}dispose(){this.disposables=Ft(this.disposables)}};vf=Lc([Bt(4,tt),Bt(5,Zo),Bt(6,ti)],vf);const X2e=mn.as(zf.Configuration);X2e.registerConfiguration({id:"workbench",order:7,title:m("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Yf]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[m("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),m("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:m({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[jC]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[$o]:{type:"boolean",default:!1,description:m("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[oa]:{type:"boolean",default:!1,description:m("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[Sv]:{type:"number",default:8,minimum:4,maximum:40,description:m("tree indent setting","Controls tree indentation in pixels.")},[Bx]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:m("render tree indent guides","Controls whether the tree should render indent guides.")},[ra]:{type:"boolean",default:!1,description:m("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[nl]:{type:"number",default:1,markdownDescription:m("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[sl]:{type:"number",default:5,markdownDescription:m("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[R3]:{type:"string",enum:["highlight","filter"],enumDescriptions:[m("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),m("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:m("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[Fx]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[m("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),m("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),m("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:m("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:m("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[P3]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[m("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),m("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:m("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[Wx]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:m("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[M3]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:m("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});var QN;(function(n){n[n.PRESERVE=0]="PRESERVE",n[n.LAST=1]="LAST"})(QN||(QN={}));const DK={Quickaccess:"workbench.contributions.quickaccess"};class Q2e{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Ze(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return cD([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}mn.add(DK.Quickaccess,new Q2e);const J2e={ctrlCmd:!1,alt:!1};var xv;(function(n){n[n.Blur=1]="Blur",n[n.Gesture=2]="Gesture",n[n.Other=3]="Other"})(xv||(xv={}));var wa;(function(n){n[n.NONE=0]="NONE",n[n.FIRST=1]="FIRST",n[n.SECOND=2]="SECOND",n[n.LAST=3]="LAST"})(wa||(wa={}));const F3=at("quickInputService");var eEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},F6=function(n,e){return function(t,i){e(t,i,n)}};let JN=class extends Y{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=mn.as(DK.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var s;const[o,r]=this.getOrInstantiateProvider(e),a=this.visibleQuickAccess,l=a==null?void 0:a.descriptor;if(a&&r&&l===r){e!==r.prefix&&!(i!=null&&i.preserveValue)&&(a.picker.value=e),this.adjustValueSelection(a.picker,r,i);return}if(r&&!(i!=null&&i.preserveValue)){let f;if(a&&l&&l!==r){const g=a.value.substr(l.prefix.length);g&&(f=`${r.prefix}${g}`)}if(!f){const g=o==null?void 0:o.defaultFilterValue;g===QN.LAST?f=this.lastAcceptedPickerValues.get(r):typeof g=="string"&&(f=`${r.prefix}${g}`)}typeof f=="string"&&(e=f)}const c=new pe,d=c.add(this.quickInputService.createQuickPick());d.value=e,this.adjustValueSelection(d,r,i),d.placeholder=r==null?void 0:r.placeholder,d.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,d.hideInput=!!d.quickNavigate&&!a,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(d.itemActivation=(s=i==null?void 0:i.itemActivation)!==null&&s!==void 0?s:wa.SECOND),d.contextKey=r==null?void 0:r.contextKey,d.filterValue=f=>f.substring(r?r.prefix.length:0);let u;t&&(u=new Ij,c.add(ue.once(d.onWillAccept)(f=>{f.veto(),d.hide()}))),c.add(this.registerPickerListeners(d,o,r,e,i==null?void 0:i.providerOptions));const h=c.add(new xr);if(o&&c.add(o.provide(d,h.token,i==null?void 0:i.providerOptions)),ue.once(d.onDidHide)(()=>{d.selectedItems.length===0&&h.cancel(),c.dispose(),u==null||u.complete(d.selectedItems.slice(0))}),d.show(),t)return u==null?void 0:u.p}adjustValueSelection(e,t,i){var s;let o;i!=null&&i.preserveValue?o=[e.value.length,e.value.length]:o=[(s=t==null?void 0:t.prefix.length)!==null&&s!==void 0?s:0,e.value.length],e.valueSelection=o}registerPickerListeners(e,t,i,s,o){const r=new pe,a=this.visibleQuickAccess={picker:e,descriptor:i,value:s};return r.add(Ze(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),r.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l);c!==t?this.show(l,{preserveValue:!0,providerOptions:o}):a.value=l})),i&&r.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),r}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let i=this.mapProviderToDescriptor.get(t);return i||(i=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,i)),[i,t]}};JN=eEe([F6(0,F3),F6(1,vt)],JN);z.white.toString(),z.white.toString();class B6 extends Y{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new B),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,s=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=s||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),e.appendChild(this._element),this._register(Rt.addTarget(this._element)),[de.CLICK,Pt.Tap].forEach(o=>{this._register(K(this._element,o,r=>{if(!this.enabled){Ue.stop(r);return}this._onDidClick.fire(r)}))}),this._register(K(this._element,de.KEY_DOWN,o=>{const r=new zt(o);let a=!1;this.enabled&&(r.equals(3)||r.equals(10))?(this._onDidClick.fire(o),a=!0):r.equals(9)&&(this._element.blur(),a=!0),a&&Ue.stop(r,!0)})),this._register(K(this._element,de.MOUSE_OVER,o=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(K(this._element,de.MOUSE_OUT,o=>{this.updateBackground(!1)})),this.focusTracker=this._register(eu(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of Qh(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const s=document.createElement("span");s.textContent=i,t.push(s)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){var t;if(this._label===e||Ad(this._label)&&Ad(e)&&yDe(this._label,e))return;this._element.classList.add("monaco-text-button");const i=this.options.supportShortLabel?this._labelElement:this._element;if(Ad(e)){const s=ek(e,{inline:!0});s.dispose();const o=(t=s.element.querySelector("p"))===null||t===void 0?void 0:t.innerHTML;if(o){const r=dj(o,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});i.innerHTML=r}else cs(i)}else this.options.supportIcons?cs(i,...this.getContentElements(e)):i.textContent=e;typeof this.options.title=="string"?this._element.title=this.options.title:this.options.title&&(this._element.title=PDe(e)),this._label=e}get label(){return this._label}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}class eR{constructor(e,t,i){this.options=t,this.styles=i,this.count=0,this.element=le(e,we(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){var e,t;this.element.textContent=Pb(this.countFormat,this.count),this.element.title=Pb(this.titleFormat,this.count),this.element.style.backgroundColor=(e=this.styles.badgeBackground)!==null&&e!==void 0?e:"",this.element.style.color=(t=this.styles.badgeForeground)!==null&&t!==void 0?t:"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const W6="done",V6="active",PE="infinite",OE="infinite-long-running",z6="discrete";class uk extends Y{constructor(e,t){super(),this.workedVal=0,this.showDelayedScheduler=this._register(new Li(()=>Uh(this.element),0)),this.longRunningScheduler=this._register(new Li(()=>this.infiniteLongRunning(),uk.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=(t==null?void 0:t.progressBarBackground)||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(V6,PE,OE,z6),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(W6),this.element.classList.contains(PE)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(z6,W6,OE),this.element.classList.add(V6,PE),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(OE)}getContainer(){return this.element}}uk.LONG_RUNNING_INFINITE_THRESHOLD=1e4;const tEe=we;class iEe extends Y{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=o=>K(this.findInput.inputBox.inputElement,de.KEY_DOWN,r=>{o(new zt(r))}),this.onMouseDown=o=>K(this.findInput.inputBox.inputElement,de.MOUSE_DOWN,r=>{o(new ar(r))}),this.onDidChange=o=>this.findInput.onDidChange(o),this.container=le(this.parent,tEe(".quick-input-box")),this.findInput=this._register(new dK(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const s=this.findInput.inputBox.inputElement;s.role="combobox",s.ariaHasPopup="menu",s.ariaAutoComplete="list",s.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===mi.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===mi.Info?1:e===mi.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===mi.Info?1:e===mi.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Td{constructor(e,t){var i;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=(i=t==null?void 0:t.supportIcons)!==null&&i!==void 0?i:!1,this.domNode=le(e,we("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",s){e||(e=""),s&&(e=Td.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&So(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const r=this.text.substring(t,i.start);this.supportIcons?e.push(...Qh(r)):e.push(r),t=i.start}const s=this.text.substring(t,i.end),o=we("span.highlight",void 0,...this.supportIcons?Qh(s):[s]);i.extraClasses&&o.classList.add(...i.extraClasses),e.push(o),t=i.end}if(t<this.text.length){const i=this.text.substring(t);this.supportIcons?e.push(...Qh(i)):e.push(i)}cs(this.domNode,...e),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(e,t){let i=0,s=0;return e.replace(/\r\n|\r|\n/g,(o,r)=>{s=o===`\r
`?-1:0,r+=i;for(const a of t)a.end<=r||(a.start>=r&&(a.start+=s),a.end>=r&&(a.end+=s));return i+=s,""})}}class FE{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class tR extends Y{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new FE(le(e,we(".monaco-icon-label")))),this.labelContainer=le(this.domNode.element,we(".monaco-icon-label-container"));const i=le(this.labelContainer,we("span.monaco-icon-name-container"));t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=new oEe(i,!!t.supportIcons):this.nameNode=new nEe(i),this.hoverDelegate=t==null?void 0:t.hoverDelegate}get element(){return this.domNode.element}setLabel(e,t,i){const s=["monaco-icon-label"],o=["monaco-icon-label-container"];let r="";if(i&&(i.extraClasses&&s.push(...i.extraClasses),i.italic&&s.push("italic"),i.strikethrough&&s.push("strikethrough"),i.disabledCommand&&o.push("disabled"),i.title&&(r+=i.title)),this.domNode.className=s.join(" "),this.domNode.element.setAttribute("aria-label",r),this.labelContainer.className=o.join(" "),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const a=this.getOrCreateDescriptionNode();a instanceof Td?(a.set(t||"",i?i.descriptionMatches:void 0,void 0,i==null?void 0:i.labelEscapeNewLines),this.setupHover(a.element,i==null?void 0:i.descriptionTitle)):(a.textContent=t&&(i!=null&&i.labelEscapeNewLines)?Td.escapeNewLines(t,[]):t||"",this.setupHover(a.element,(i==null?void 0:i.descriptionTitle)||""),a.empty=!t)}}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(!this.hoverDelegate)SDe(e,t);else{const s=UG(this.hoverDelegate,e,t);s&&this.customHovers.set(e,s)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateDescriptionNode(){var e;if(!this.descriptionNode){const t=this._register(new FE(le(this.labelContainer,we("span.monaco-icon-description-container"))));!((e=this.creationOptions)===null||e===void 0)&&e.supportDescriptionHighlights?this.descriptionNode=new Td(le(t.element,we("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons}):this.descriptionNode=this._register(new FE(le(t.element,we("span.label-description"))))}return this.descriptionNode}}class nEe{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&So(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=le(this.container,we("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const s=e[i],o=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;le(this.container,we("a.label-name",{id:o,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},s)),i<e.length-1&&le(this.container,we("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function sEe(n,e,t){if(!t)return;let i=0;return n.map(s=>{const o={start:i,end:i+s.length},r=t.map(a=>Dn.intersect(o,a)).filter(a=>!Dn.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=o.end+e.length,r})}class oEe{constructor(e,t){this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&So(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new Td(le(this.container,we("a.label-name",{id:t==null?void 0:t.domId})),{supportIcons:this.supportIcons})),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=(t==null?void 0:t.separator)||"/",s=sEe(e,i,t==null?void 0:t.matches);for(let o=0;o<e.length;o++){const r=e[o],a=s?s[o]:void 0,l=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${o}`,c=we("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":o,role:"treeitem"});new Td(le(this.container,c),{supportIcons:this.supportIcons}).set(r,a,void 0,t==null?void 0:t.labelEscapeNewLines),o<e.length-1&&le(c,we("span.label-separator",void 0,i))}}}}const Ww=we,rEe={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class yy{constructor(e,t,i){this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const s=this.options.keybindingLabelForeground;this.domNode=le(e,Ww(".monaco-keybinding")),s&&(this.domNode.style.color=s),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&yy.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){var e;if(this.clear(),this.keybinding){const t=this.keybinding.getChords();t[0]&&this.renderChord(this.domNode,t[0],this.matches?this.matches.firstPart:null);for(let s=1;s<t.length;s++)le(this.domNode,Ww("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,t[s],this.matches?this.matches.chordPart:null);const i=(e=this.options.disableTitle)!==null&&e!==void 0&&e?void 0:this.keybinding.getAriaLabel()||void 0;i!==void 0?this.domNode.title=i:this.domNode.removeAttribute("title")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){Lo(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const s=a3.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,s.ctrlKey,!!(i!=null&&i.ctrlKey),s.separator),t.shiftKey&&this.renderKey(e,s.shiftKey,!!(i!=null&&i.shiftKey),s.separator),t.altKey&&this.renderKey(e,s.altKey,!!(i!=null&&i.altKey),s.separator),t.metaKey&&this.renderKey(e,s.metaKey,!!(i!=null&&i.metaKey),s.separator);const o=t.keyLabel;o&&this.renderKey(e,o,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,s){le(e,this.createKeyElement(t,i?".highlight":"")),s&&le(e,Ww("span.monaco-keybinding-key-separator",void 0,s))}renderUnbound(e){le(e,this.createKeyElement(m("unbound","Unbound")))}createKeyElement(e,t=""){const i=Ww("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&So(e.firstPart,t.firstPart)&&So(e.chordPart,t.chordPart)}}const H6=new Mf(()=>{const n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}});function aEe(n,e,t=!1){const i=n||"",s=e||"",o=H6.value.collator.compare(i,s);return H6.value.collatorIsNumeric&&o===0&&i!==s?i<s?-1:1:o}function lEe(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),o=cEe(n,e,t);if(o)return o;const r=i.endsWith(t),a=s.endsWith(t);if(r!==a)return r?-1:1;const l=aEe(i,s);return l!==0?l:i.localeCompare(s)}function cEe(n,e,t){const i=n.toLowerCase(),s=e.toLowerCase(),o=i.startsWith(t),r=s.startsWith(t);if(o!==r)return o?-1:1;if(o&&r){if(i.length<s.length)return-1;if(i.length>s.length)return 1}return 0}var dEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o};class kK{constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}dEe([Di],kK.prototype,"toString",null);const uEe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function hEe(n){const e=[];let t=0,i;for(;i=uEe.exec(n);){i.index-t>0&&e.push(n.substring(t,i.index));const[,s,o,,r]=i;r?e.push({label:s,href:o,title:r}):e.push({label:s,href:o}),t=i.index+i[0].length}return t<n.length&&e.push(n.substring(t)),new kK(e)}const BE={},fEe=new p3("quick-input-button-icon-");function iR(n){if(!n)return;let e;const t=n.dark.toString();return BE[t]?e=BE[t]:(e=fEe.nextId(),LT(`.${e}, .hc-light .${e}`,`background-image: ${tu(n.light||n.dark)}`),LT(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${tu(n.dark)}`),BE[t]=e),e}function gEe(n,e,t){cs(e);const i=hEe(n);let s=0;for(const o of i.nodes)if(typeof o=="string")e.append(...Qh(o));else{let r=o.title;!r&&o.href.startsWith("command:")?r=m("executeCommand","Click to execute command '{0}'",o.href.substring(8)):r||(r=o.href);const a=we("a",{href:o.href,title:r,tabIndex:s++},o.label);a.style.textDecoration="underline";const l=f=>{Cme(f)&&Ue.stop(f,!0),t.callback(o.href)},c=t.disposables.add(new rt(a,de.CLICK)).event,d=t.disposables.add(new rt(a,de.KEY_DOWN)).event,u=ue.chain(d,f=>f.filter(g=>{const p=new zt(g);return p.equals(10)||p.equals(3)}));t.disposables.add(Rt.addTarget(a));const h=t.disposables.add(new rt(a,Pt.Tap)).event;ue.any(c,h,u)(l,null,t.disposables),e.appendChild(a)}}var EK=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},$6=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Pr=we;class pEe{constructor(e,t,i,s,o,r,a){var l,c,d;this._checked=!1,this._hidden=!1,this.hasCheckbox=s,this.index=i,this.fireButtonTriggered=o,this.fireSeparatorButtonTriggered=r,this._onChecked=a,this.onChecked=s?ue.map(ue.filter(this._onChecked.event,u=>u.listElement===this),u=>u.checked):ue.None,e.type==="separator"?this._separator=e:(this.item=e,t&&t.type==="separator"&&!t.buttons&&(this._separator=t),this.saneDescription=this.item.description,this.saneDetail=this.item.detail,this._labelHighlights=(l=this.item.highlights)===null||l===void 0?void 0:l.label,this._descriptionHighlights=(c=this.item.highlights)===null||c===void 0?void 0:c.description,this._detailHighlights=(d=this.item.highlights)===null||d===void 0?void 0:d.detail,this.saneTooltip=this.item.tooltip),this._init=new Mf(()=>{var u;const h=(u=e.label)!==null&&u!==void 0?u:"",f=f_(h).text.trim(),g=e.ariaLabel||[h,this.saneDescription,this.saneDetail].map(p=>vDe(p)).filter(p=>!!p).join(", ");return{saneLabel:h,saneSortLabel:f,saneAriaLabel:g}})}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({listElement:this,checked:e}))}get separator(){return this._separator}set separator(e){this._separator=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class wy{constructor(e){this.themeService=e}get templateId(){return wy.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=le(e,Pr(".quick-input-list-entry"));const i=le(t.entry,Pr("label.quick-input-list-label"));t.toDisposeTemplate.push(Hi(i,de.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=le(i,Pr("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(Hi(t.checkbox,de.CHANGE,c=>{t.element.checked=t.checkbox.checked}));const s=le(i,Pr(".quick-input-list-rows")),o=le(s,Pr(".quick-input-list-row")),r=le(s,Pr(".quick-input-list-row"));t.label=new tR(o,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0}),t.toDisposeTemplate.push(t.label),t.icon=yj(t.label.element,Pr(".quick-input-list-icon"));const a=le(o,Pr(".quick-input-list-entry-keybinding"));t.keybinding=new yy(a,vo);const l=le(r,Pr(".quick-input-list-label-meta"));return t.detail=new tR(l,{supportHighlights:!0,supportIcons:!0}),t.toDisposeTemplate.push(t.detail),t.separator=le(t.entry,Pr(".quick-input-list-separator")),t.actionBar=new il(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,i){var s,o,r,a;i.element=e,e.element=(s=i.entry)!==null&&s!==void 0?s:void 0;const l=e.item?e.item:e.separator;i.checkbox.checked=e.checked,i.toDisposeElement.push(e.onChecked(g=>i.checkbox.checked=g));const{labelHighlights:c,descriptionHighlights:d,detailHighlights:u}=e;if(!((o=e.item)===null||o===void 0)&&o.iconPath){const g=$D(this.themeService.getColorTheme().type)?e.item.iconPath.dark:(r=e.item.iconPath.light)!==null&&r!==void 0?r:e.item.iconPath.dark,p=je.revive(g);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=tu(p)}else i.icon.style.backgroundImage="",i.icon.className=!((a=e.item)===null||a===void 0)&&a.iconClass?`quick-input-list-icon ${e.item.iconClass}`:"";const h={matches:c||[],descriptionTitle:e.saneDescription,descriptionMatches:d||[],labelEscapeNewLines:!0};l.type!=="separator"?(h.extraClasses=l.iconClasses,h.italic=l.italic,h.strikethrough=l.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item")):i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(e.saneLabel,e.saneDescription,h),i.keybinding.set(l.type==="separator"?void 0:l.keybinding),e.saneDetail?(i.detail.element.style.display="",i.detail.setLabel(e.saneDetail,void 0,{matches:u,title:e.saneDetail,labelEscapeNewLines:!0})):i.detail.element.style.display="none",e.item&&e.separator&&e.separator.label?(i.separator.textContent=e.separator.label,i.separator.style.display=""):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!e.separator);const f=l.buttons;f&&f.length?(i.actionBar.push(f.map((g,p)=>{let _=g.iconClass||(g.iconPath?iR(g.iconPath):void 0);return g.alwaysVisible&&(_=_?`${_} always-visible`:"always-visible"),{id:`id-${p}`,class:_,enabled:!0,label:"",tooltip:g.tooltip||"",run:()=>{l.type!=="separator"?e.fireButtonTriggered({button:g,item:l}):e.fireSeparatorButtonTriggered({button:g,separator:l})}}}),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){i.toDisposeElement=Ft(i.toDisposeElement),i.actionBar.clear()}disposeTemplate(e){e.toDisposeElement=Ft(e.toDisposeElement),e.toDisposeTemplate=Ft(e.toDisposeTemplate)}}wy.ID="listelement";class mEe{getHeight(e){return e.item?e.saneDetail?44:22:24}getTemplateId(e){return wy.ID}}var Ji;(function(n){n[n.First=1]="First",n[n.Second=2]="Second",n[n.Last=3]="Last",n[n.Next=4]="Next",n[n.Previous=5]="Previous",n[n.NextPage=6]="NextPage",n[n.PreviousPage=7]="PreviousPage"})(Ji||(Ji={}));class B3{constructor(e,t,i,s){this.parent=e,this.options=i,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnLabelMode="fuzzy",this.sortByLabel=!0,this._onChangedAllVisibleChecked=new B,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new B,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new B,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new B,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new B,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new B,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._onKeyDown=new B,this.onKeyDown=this._onKeyDown.event,this._onLeave=new B,this.onLeave=this._onLeave.event,this._listElementChecked=new B,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=le(this.parent,Pr(".quick-input-list"));const o=new mEe,r=new vEe;if(this.list=i.createList("QuickInput",this.container,o,[new wy(s)],{identityProvider:{getId:a=>{var l,c,d,u,h,f,g,p;return(p=(f=(u=(c=(l=a.item)===null||l===void 0?void 0:l.id)!==null&&c!==void 0?c:(d=a.item)===null||d===void 0?void 0:d.label)!==null&&u!==void 0?u:(h=a.separator)===null||h===void 0?void 0:h.id)!==null&&f!==void 0?f:(g=a.separator)===null||g===void 0?void 0:g.label)!==null&&p!==void 0?p:""}},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:r}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown(a=>{const l=new zt(a);switch(l.keyCode){case 10:this.toggleCheckbox();break;case 31:(pt?a.metaKey:a.ctrlKey)&&this.list.setFocus(es(this.list.length));break;case 16:{const c=this.list.getFocus();c.length===1&&c[0]===0&&this._onLeave.fire();break}case 18:{const c=this.list.getFocus();c.length===1&&c[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(l)})),this.disposables.push(this.list.onMouseDown(a=>{a.browserEvent.button!==2&&a.browserEvent.preventDefault()})),this.disposables.push(K(this.container,de.CLICK,a=>{(a.x||a.y)&&this._onLeave.fire()})),this.disposables.push(this.list.onMouseMiddleClick(a=>{this._onLeave.fire()})),this.disposables.push(this.list.onContextMenu(a=>{typeof a.index=="number"&&(a.browserEvent.preventDefault(),this.list.setSelection([a.index]))})),i.hoverDelegate){const a=new Aj(i.hoverDelegate.delay);this.disposables.push(this.list.onMouseOver(l=>$6(this,void 0,void 0,function*(){var c;if(l.browserEvent.target instanceof HTMLAnchorElement){a.cancel();return}if(!(!(l.browserEvent.relatedTarget instanceof HTMLAnchorElement)&&Cn(l.browserEvent.relatedTarget,(c=l.element)===null||c===void 0?void 0:c.element)))try{yield a.trigger(()=>$6(this,void 0,void 0,function*(){l.element&&this.showHover(l.element)}))}catch(d){if(!Rf(d))throw d}}))),this.disposables.push(this.list.onMouseOut(l=>{var c;Cn(l.browserEvent.relatedTarget,(c=l.element)===null||c===void 0?void 0:c.element)||a.cancel()})),this.disposables.push(a)}this.disposables.push(this._listElementChecked.event(a=>this.fireCheckedEvents())),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onSeparatorButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return ue.map(this.list.onDidChangeFocus,e=>e.elements.map(t=>t.item))}get onDidChangeSelection(){return ue.map(this.list.onDidChangeSelection,e=>({items:e.elements.map(t=>t.item),event:e.browserEvent}))}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get ariaLabel(){return this.list.getHTMLElement().ariaLabel}set ariaLabel(e){this.list.getHTMLElement().ariaLabel=e}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let i=0,s=e.length;i<s;i++){const o=e[i];if(!o.hidden)if(o.checked)t=!0;else return!1}return t}getCheckedCount(){let e=0;const t=this.elements;for(let i=0,s=t.length;i<s;i++)t[i].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let i=0,s=t.length;i<s;i++)t[i].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach(t=>{t.hidden||(t.checked=e)})}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=Ft(this.elementDisposables);const t=r=>this.fireButtonTriggered(r),i=r=>this.fireSeparatorButtonTriggered(r);this.inputElements=e;const s=new Map,o=this.parent.classList.contains("show-checkboxes");this.elements=e.reduce((r,a,l)=>{var c;const d=l>0?e[l-1]:void 0;if(a.type==="separator"&&!a.buttons)return r;const u=new pEe(a,d,l,o,t,i,this._listElementChecked),h=r.length;return r.push(u),s.set((c=u.item)!==null&&c!==void 0?c:u.separator,h),r},[]),this.elementsToIndexes=s,this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map(e=>e.item)}setFocusedElements(e){if(this.list.setFocus(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t))),e.length>0){const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t)))}getCheckedElements(){return this.elements.filter(e=>e.checked).map(e=>e.item).filter(e=>!!e)}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const i of e)t.add(i);for(const i of this.elements)i.checked=t.has(i.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===Ji.Second&&this.list.length<2&&(e=Ji.First),e){case Ji.First:this.list.scrollTop=0,this.list.focusFirst(void 0,i=>!!i.item);break;case Ji.Second:this.list.scrollTop=0,this.list.focusNth(1,void 0,i=>!!i.item);break;case Ji.Last:this.list.scrollTop=this.list.scrollHeight,this.list.focusLast(void 0,i=>!!i.item);break;case Ji.Next:{this.list.focusNext(void 0,!0,void 0,s=>!!s.item);const i=this.list.getFocus()[0];i!==0&&!this.elements[i-1].item&&this.list.firstVisibleIndex>i-1&&this.list.reveal(i-1);break}case Ji.Previous:{this.list.focusPrevious(void 0,!0,void 0,s=>!!s.item);const i=this.list.getFocus()[0];i!==0&&!this.elements[i-1].item&&this.list.firstVisibleIndex>i-1&&this.list.reveal(i-1);break}case Ji.NextPage:this.list.focusNextPage(void 0,i=>!!i.item);break;case Ji.PreviousPage:this.list.focusPreviousPage(void 0,i=>!!i.item);break}const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}showHover(e){var t,i,s;this.options.hoverDelegate!==void 0&&(this._lastHover&&!this._lastHover.isDisposed&&((i=(t=this.options.hoverDelegate).onDidHideHover)===null||i===void 0||i.call(t),(s=this._lastHover)===null||s===void 0||s.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.options.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:o=>{this.options.linkOpenerDelegate(o)},showPointer:!0,container:this.container,hoverPosition:1},!1)))}layout(e){this.list.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this.elements.forEach(s=>{s.labelHighlights=void 0,s.descriptionHighlights=void 0,s.detailHighlights=void 0,s.hidden=!1;const o=s.index&&this.inputElements[s.index-1];s.item&&(s.separator=o&&o.type==="separator"&&!o.buttons?o:void 0)});else{let s;this.elements.forEach(o=>{var r,a,l,c;let d;this.matchOnLabelMode==="fuzzy"?d=this.matchOnLabel&&(r=SE(e,f_(o.saneLabel)))!==null&&r!==void 0?r:void 0:d=this.matchOnLabel&&(a=_Ee(t,f_(o.saneLabel)))!==null&&a!==void 0?a:void 0;const u=this.matchOnDescription&&(l=SE(e,f_(o.saneDescription||"")))!==null&&l!==void 0?l:void 0,h=this.matchOnDetail&&(c=SE(e,f_(o.saneDetail||"")))!==null&&c!==void 0?c:void 0;if(d||u||h?(o.labelHighlights=d,o.descriptionHighlights=u,o.detailHighlights=h,o.hidden=!1):(o.labelHighlights=void 0,o.descriptionHighlights=void 0,o.detailHighlights=void 0,o.hidden=o.item?!o.item.alwaysShow:!0),o.item?o.separator=void 0:o.separator&&(o.hidden=!0),!this.sortByLabel){const f=o.index&&this.inputElements[o.index-1];s=f&&f.type==="separator"?f:s,s&&!o.hidden&&(o.separator=s,s=void 0)}})}const i=this.elements.filter(s=>!s.hidden);if(this.sortByLabel&&e){const s=e.toLowerCase();i.sort((o,r)=>bEe(o,r,s))}return this.elementsToIndexes=i.reduce((s,o,r)=>{var a;return s.set((a=o.item)!==null&&a!==void 0?a:o.separator,r),s},new Map),this.list.splice(0,this.list.length,i),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(i.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const i of e)i.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return this.container.style.display!=="none"}dispose(){this.elementDisposables=Ft(this.elementDisposables),this.disposables=Ft(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}fireSeparatorButtonTriggered(e){this._onSeparatorButtonTriggered.fire(e)}style(e){this.list.style(e)}toggleHover(){const e=this.list.getFocusedElements()[0];if(!(e!=null&&e.saneTooltip))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}const t=this.list.getFocusedElements()[0];if(!t)return;this.showHover(t);const i=new pe;i.add(this.list.onDidChangeFocus(s=>{s.indexes.length&&this.showHover(s.elements[0])})),this._lastHover&&i.add(this._lastHover),this._toggleHover=i,this.elementDisposables.push(this._toggleHover)}}EK([Di],B3.prototype,"onDidChangeFocus",null);EK([Di],B3.prototype,"onDidChangeSelection",null);function _Ee(n,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return U6(n,t);const s=gD(t," "),o=t.length-s.length,r=U6(n,s);if(r)for(const a of r){const l=i[a.start+o]+o;a.start+=l,a.end+=l}return r}function U6(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t!==-1?[{start:t,end:t+n.length}]:null}function bEe(n,e,t){const i=n.labelHighlights||[],s=e.labelHighlights||[];return i.length&&!s.length?-1:!i.length&&s.length?1:i.length===0&&s.length===0?0:lEe(n.saneSortLabel,e.saneSortLabel,t)}class vEe{getWidgetAriaLabel(){return m("quickInput","Quick Input")}getAriaLabel(e){var t;return!((t=e.separator)===null||t===void 0)&&t.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(e.hasCheckbox)return{value:e.checked,onDidChange:e.onChecked}}}var j6=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const nR={iconClass:Ne.asClassName(se.quickInputBack),tooltip:m("quickInput.back","Back"),handle:-1};class Cy extends Y{constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=Cy.noPromptMessage,this._severity=mi.Ignore,this.onDidTriggerButtonEmitter=this._register(new B),this.onDidHideEmitter=this._register(new B),this.onDisposeEmitter=this._register(new B),this.visibleDisposables=this._register(new pe),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Qd;this._ignoreFocusOut=e&&!Qd,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=xv.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){var e,t;if(!this.visible)return;const i=this.getTitle();i&&this.ui.title.textContent!==i?this.ui.title.textContent=i:!i&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const s=this.getDescription();if(this.ui.description1.textContent!==s&&(this.ui.description1.textContent=s),this.ui.description2.textContent!==s&&(this.ui.description2.textContent=s),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?cs(this.ui.widget,this._widget):cs(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new Cc,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this.buttons.filter(l=>l===nR);this.ui.leftActionBar.push(r.map((l,c)=>{const d=new xo(`id-${c}`,"",l.iconClass||iR(l.iconPath),!0,()=>j6(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(l)}));return d.tooltip=l.tooltip||"",d}),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const a=this.buttons.filter(l=>l!==nR);this.ui.rightActionBar.push(a.map((l,c)=>{const d=new xo(`id-${c}`,"",l.iconClass||iR(l.iconPath),!0,()=>j6(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(l)}));return d.tooltip=l.tooltip||"",d}),{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const r=(t=(e=this.toggles)===null||e===void 0?void 0:e.filter(a=>a instanceof r0))!==null&&t!==void 0?t:[];this.ui.inputBox.toggles=r}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const o=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==o&&(this._lastValidationMessage=o,cs(this.ui.message),gEe(o,this.ui.message,{callback:r=>{this.ui.linkOpenerDelegate(r)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?m("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==mi.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}Cy.noPromptMessage=m("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class Lv extends Cy{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new B),this.onWillAcceptEmitter=this._register(new B),this.onDidAcceptEmitter=this._register(new B),this.onDidCustomEmitter=this._register(new B),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=wa.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new B),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new B),this.onDidTriggerItemButtonEmitter=this._register(new B),this.onDidTriggerSeparatorButtonEmitter=this._register(new B),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?J2e:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(Ji.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.inputBox.onMouseDown(e=>{this.autoFocusOnList||this.ui.list.clearFocus()})),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown(e=>{switch(e.keyCode){case 18:this.ui.list.focus(Ji.Next),this.canSelectMany&&this.ui.list.domFocus(),Ue.stop(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(Ji.Previous):this.ui.list.focus(Ji.Last),this.canSelectMany&&this.ui.list.domFocus(),Ue.stop(e,!0);break;case 12:this.ui.list.focus(Ji.NextPage),this.canSelectMany&&this.ui.list.domFocus(),Ue.stop(e,!0);break;case 11:this.ui.list.focus(Ji.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),Ue.stop(e,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Ji.First),Ue.stop(e,!0));break;case 13:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Ji.Last),Ue.stop(e,!0));break}})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this.ui.list.onDidChangeFocus(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&Ki(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&Ki(e,this._selectedItems,(i,s)=>i===s)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&Ki(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return K(this.ui.container,de.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new zt(e),i=t.keyCode;this._quickNavigate.keybindings.some(r=>{const a=r.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.buttons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let s=this.ariaLabel;if(!s&&i.inputBox&&(s=this.placeholder||Lv.DEFAULT_ARIA_LABEL,this.title&&(s+=` - ${this.title}`)),this.ui.list.ariaLabel!==s&&(this.ui.list.ariaLabel=s??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case wa.NONE:this._itemActivation=wa.FIRST;break;case wa.SECOND:this.ui.list.focus(Ji.Second),this._itemActivation=wa.FIRST;break;case wa.LAST:this.ui.list.focus(Ji.Last),this._itemActivation=wa.FIRST;break;default:this.trySelectFirst();break}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Ji.First)),this.keepScrollPosition&&(this.scrollTop=e)}}Lv.DEFAULT_ARIA_LABEL=m("quickInputBox.ariaLabel","Type to narrow down results.");class yEe extends Cy{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new B),this.onDidAcceptEmitter=this._register(new B),this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}}const Vs=we;class hk extends Y{constructor(e,t){super(),this.options=e,this.themeService=t,this.enabled=!0,this.onDidAcceptEmitter=this._register(new B),this.onDidCustomEmitter=this._register(new B),this.onDidTriggerButtonEmitter=this._register(new B),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new B),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new B),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=t=>{this.keyMods.ctrlCmd=t.ctrlKey||t.metaKey,this.keyMods.alt=t.altKey};this._register(K(window,de.KEY_DOWN,e,!0)),this._register(K(window,de.KEY_UP,e,!0)),this._register(K(window,de.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=le(this.parentElement,Vs(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=wr(e),i=le(e,Vs(".quick-input-titlebar")),s=this.options.hoverDelegate?{hoverDelegate:this.options.hoverDelegate}:void 0,o=this._register(new il(i,s));o.domNode.classList.add("quick-input-left-action-bar");const r=le(i,Vs(".quick-input-title")),a=this._register(new il(i,s));a.domNode.classList.add("quick-input-right-action-bar");const l=le(e,Vs(".quick-input-header")),c=le(l,Vs("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",m("quickInput.checkAll","Toggle all checkboxes")),this._register(Hi(c,de.CHANGE,R=>{const $=c.checked;O.setAllVisibleChecked($)})),this._register(K(c,de.CLICK,R=>{(R.x||R.y)&&f.setFocus()}));const d=le(l,Vs(".quick-input-description")),u=le(l,Vs(".quick-input-and-message")),h=le(u,Vs(".quick-input-filter")),f=this._register(new iEe(h,this.styles.inputBox,this.styles.toggle));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=le(h,Vs(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new eR(g,{countFormat:m({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),_=le(h,Vs(".quick-input-count"));_.setAttribute("aria-live","polite");const v=new eR(_,{countFormat:m({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),b=le(l,Vs(".quick-input-action")),y=this._register(new B6(b,this.styles.button));y.label=m("ok","OK"),this._register(y.onDidClick(R=>{this.onDidAcceptEmitter.fire()}));const w=le(l,Vs(".quick-input-action")),C=this._register(new B6(w,this.styles.button));C.label=m("custom","Custom"),this._register(C.onDidClick(R=>{this.onDidCustomEmitter.fire()}));const L=le(u,Vs(`#${this.idPrefix}message.quick-input-message`)),x=this._register(new uk(e,this.styles.progressBar));x.getContainer().classList.add("quick-input-progress");const D=le(e,Vs(".quick-input-html-widget"));D.tabIndex=-1;const k=le(e,Vs(".quick-input-description")),P=this.idPrefix+"list",O=this._register(new B3(e,P,this.options,this.themeService));f.setAttribute("aria-controls",P),this._register(O.onDidChangeFocus(()=>{var R;f.setAttribute("aria-activedescendant",(R=O.getActiveDescendant())!==null&&R!==void 0?R:"")})),this._register(O.onChangedAllVisibleChecked(R=>{c.checked=R})),this._register(O.onChangedVisibleCount(R=>{p.setCount(R)})),this._register(O.onChangedCheckedCount(R=>{v.setCount(R)})),this._register(O.onLeave(()=>{setTimeout(()=>{f.setFocus(),this.controller instanceof Lv&&this.controller.canSelectMany&&O.clearFocus()},0)}));const M=eu(e);return this._register(M),this._register(K(e,de.FOCUS,R=>{Cn(R.relatedTarget,e)||(this.previousFocusElement=R.relatedTarget instanceof HTMLElement?R.relatedTarget:void 0)},!0)),this._register(M.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(xv.Blur),this.previousFocusElement=void 0})),this._register(K(e,de.FOCUS,R=>{f.setFocus()})),this._register(Hi(e,de.KEY_DOWN,R=>{if(!Cn(R.target,D))switch(R.keyCode){case 3:Ue.stop(R,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:Ue.stop(R,!0),this.hide(xv.Gesture);break;case 2:if(!R.altKey&&!R.ctrlKey&&!R.metaKey){const $=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(e.classList.contains("show-checkboxes")?$.push("input"):$.push("input[type=text]"),this.getUI().list.isDisplayed()&&$.push(".monaco-list"),this.getUI().message&&$.push(".quick-input-message a"),this.getUI().widget){if(Cn(R.target,this.getUI().widget))break;$.push(".quick-input-html-widget")}const G=e.querySelectorAll($.join(", "));R.shiftKey&&R.target===G[0]?(Ue.stop(R,!0),O.clearFocus()):!R.shiftKey&&Cn(R.target,G[G.length-1])&&(Ue.stop(R,!0),G[0].focus())}break;case 10:R.ctrlKey&&(Ue.stop(R,!0),this.getUI().list.toggleHover());break}})),this.ui={container:e,styleSheet:t,leftActionBar:o,titleBar:i,title:r,description1:k,description2:d,widget:D,rightActionBar:a,checkAll:c,inputContainer:u,filterContainer:h,inputBox:f,visibleCountContainer:g,visibleCount:p,countContainer:_,count:v,okContainer:b,ok:y,message:L,customButtonContainer:w,customButton:C,list:O,progressBar:x,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:R=>this.show(R),hide:()=>this.hide(),setVisibilities:R=>this.setVisibilities(R),setEnabled:R=>this.setEnabled(R),setContextKey:R=>this.options.setContextKey(R),linkOpenerDelegate:R=>this.options.linkOpenerDelegate(R)},this.updateStyles(),this.ui}pick(e,t={},i=rn.None){return new Promise((s,o)=>{let r=d=>{var u;r=s,(u=t.onKeyMods)===null||u===void 0||u.call(t,a.keyMods),s(d)};if(i.isCancellationRequested){r(void 0);return}const a=this.createQuickPick();let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)r(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(r(d),a.hide())}}),a.onDidChangeActive(d=>{const u=d[0];u&&t.onDidFocus&&t.onDidFocus(u)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const u=d[0];u&&(r(u),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},d),{removeItem:()=>{const u=a.items.indexOf(d.item);if(u!==-1){const h=a.items.slice(),f=h.splice(u,1),g=a.activeItems.filter(_=>_!==f[0]),p=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=h,g&&(a.activeItems=g),a.keepScrollPosition=p}}}))),a.onDidTriggerSeparatorButton(d=>{var u;return(u=t.onDidTriggerSeparatorButton)===null||u===void 0?void 0:u.call(t,d)}),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{Ft(c),r(void 0)})];a.title=t.title,a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.autoFocusOnList=t.autoFocusOnList===void 0||t.autoFocusOnList,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,u])=>{l=u,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(h=>h.type!=="separator"&&h.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{o(d),a.hide()})})}createQuickPick(){const e=this.getUI();return new Lv(e)}createInputBox(){const e=this.getUI();return new yEe(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const i=this.controller;this.controller=e,i==null||i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",cs(t.widget),t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(mi.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),cs(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const s=this.options.backKeybindingLabel();nR.tooltip=s?m("quickInput.backWithKeybinding","Back ({0})",s):m("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t,i,s;const o=this.controller;if(!o)return;const r=!Cn(document.activeElement,(i=(t=this.ui)===null||t===void 0?void 0:t.container)!==null&&i!==void 0?i:null);if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!r){let a=this.previousFocusElement;for(;a&&!a.offsetParent;)a=(s=a.parentElement)!==null&&s!==void 0?s:void 0;a!=null&&a.offsetParent?(a.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}o.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isDisplayed()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,hk.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:s,widgetShadow:o}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=s?`1px solid ${s}`:"",this.ui.container.style.boxShadow=o?`0 0 8px 2px ${o}`:"",this.ui.list.style(this.styles.list);const r=[];this.styles.pickerGroup.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const a=r.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}isDisplayed(){return this.ui&&this.ui.container.style.display!=="none"}}hk.MAX_WIDTH=600;var wEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Vw=function(n,e){return function(t,i){e(t,i,n)}};let sR=class extends X1e{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(JN))),this._quickAccess}constructor(e,t,i,s){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=s,this._onShow=this._register(new B),this._onHide=this._register(new B),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:o=>this.setContextKey(o),linkOpenerDelegate:o=>{this.instantiationService.invokeFunction(r=>{r.get(Sc).open(o,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),createList:(o,r,a,l,c)=>this.instantiationService.createInstance(ZN,o,r,a,l,c),styles:this.computeStyles()},s=this._register(new hk(Object.assign(Object.assign({},i),t),this.themeService));return s.layout(e.dimension,e.offset.quickPickTop),this._register(e.onDidLayout(o=>s.layout(o,e.offset.quickPickTop))),this._register(s.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(s.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),s}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new _e(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t==null||t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t={},i=rn.None){return this.controller.pick(e,t,i)}createQuickPick(){return this.controller.createQuickPick()}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:re(x7),quickInputForeground:re(dve),quickInputTitleBackground:re(uve),widgetBorder:re(cq),widgetShadow:re(Yl)},inputBox:Ex,toggle:kx,countBadge:JG,button:Ake,progressBar:Ike,keybindingLabel:Eke,list:my({listBackground:x7,listFocusBackground:KT,listFocusForeground:GT,listInactiveFocusForeground:GT,listInactiveSelectionIconForeground:gq,listInactiveFocusBackground:KT,listFocusOutline:jt,listInactiveFocusOutline:jt}),pickerGroup:{pickerGroupBorder:re(hve),pickerGroupForeground:re(dq)}}}};sR=wEe([Vw(0,vt),Vw(1,tt),Vw(2,ao),Vw(3,s0)],sR);var AK=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},ep=function(n,e){return function(t,i){e(t,i,n)}};let oR=class extends sR{constructor(e,t,i,s,o){super(t,i,s,new _N(e.getContainerDomNode(),o)),this.host=void 0;const r=Pm.get(e);if(r){const a=r.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return a.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus(),offset:{top:0,quickPickTop:0}}}else this.host=void 0}createController(){return super.createController(this.host)}};oR=AK([ep(1,vt),ep(2,tt),ep(3,ao),ep(4,Ut)],oR);let rR=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(oR,e);this.mapEditorToService.set(e,t),um(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t={},i=rn.None){return this.activeService.pick(e,t,i)}createQuickPick(){return this.activeService.createQuickPick()}createInputBox(){return this.activeService.createInputBox()}};rR=AK([ep(0,vt),ep(1,Ut)],rR);class Pm{static get(e){return e.getContribution(Pm.ID)}constructor(e){this.editor=e,this.widget=new fk(this.editor)}dispose(){this.widget.dispose()}}Pm.ID="editor.controller.quickInput";class fk{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return fk.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}fk.ID="editor.contrib.quickInputWidget";Lr(Pm.ID,Pm,4);class CEe{constructor(e,t,i,s,o){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=s,this.background=o}}function SEe(n){if(!n||!Array.isArray(n))return[];const e=[];let t=0;for(let i=0,s=n.length;i<s;i++){const o=n[i];let r=-1;if(typeof o.fontStyle=="string"){r=0;const c=o.fontStyle.split(" ");for(let d=0,u=c.length;d<u;d++)switch(c[d]){case"italic":r=r|1;break;case"bold":r=r|2;break;case"underline":r=r|4;break;case"strikethrough":r=r|8;break}}let a=null;typeof o.foreground=="string"&&(a=o.foreground);let l=null;typeof o.background=="string"&&(l=o.background),e[t++]=new CEe(o.token||"",i,r,a,l)}return e}function xEe(n,e){n.sort((d,u)=>{const h=AEe(d.token,u.token);return h!==0?h:d.index-u.index});let t=0,i="000000",s="ffffff";for(;n.length>=1&&n[0].token==="";){const d=n.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(s=d.background)}const o=new DEe;for(const d of e)o.getId(d);const r=o.getId(i),a=o.getId(s),l=new W3(t,r,a),c=new V3(l);for(let d=0,u=n.length;d<u;d++){const h=n[d];c.insert(h.token,h.fontStyle,o.getId(h.foreground),o.getId(h.background))}return new IK(o,c)}const LEe=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class DEe{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(LEe);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=z.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class IK{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(SEe(e),t)}static createFromParsedTokenTheme(e,t){return xEe(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const s=this._match(t),o=EEe(t);i=(s.metadata|o<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const kEe=/\b(comment|string|regex|regexp)\b/;function EEe(n){const e=n.match(kEe);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function AEe(n,e){return n<e?-1:n>e?1:0}class W3{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new W3(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class V3{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,s;t===-1?(i=e,s=""):(i=e.substring(0,t),s=e.substring(t+1));const o=this._children.get(i);return typeof o<"u"?o.match(s):this._mainRule}insert(e,t,i,s){if(e===""){this._mainRule.acceptOverwrite(t,i,s);return}const o=e.indexOf(".");let r,a;o===-1?(r=e,a=""):(r=e.substring(0,o),a=e.substring(o+1));let l=this._children.get(r);typeof l>"u"&&(l=new V3(this._mainRule.clone()),this._children.set(r,l)),l.insert(a,t,i,s)}}function IEe(n){const e=[];for(let t=1,i=n.length;t<i;t++){const s=n[t];e[t]=`.mtk${t} { color: ${s}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const TEe={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Gi]:"#FFFFFE",[ku]:"#000000",[uq]:"#E5EBF1",[dy]:"#D3D3D3",[uy]:"#939393",[IP]:"#ADD6FF4D"}},NEe={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Gi]:"#1E1E1E",[ku]:"#D4D4D4",[uq]:"#3A3D41",[dy]:"#404040",[uy]:"#707070",[IP]:"#ADD6FF26"}},REe={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[Gi]:"#000000",[ku]:"#FFFFFF",[dy]:"#FFFFFF",[uy]:"#FFFFFF"}},MEe={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[Gi]:"#FFFFFF",[ku]:"#292929",[dy]:"#292929",[uy]:"#292929"}},PEe={IconContribution:"base.contributions.icons"};var q6;(function(n){function e(t,i){let s=t.defaults;for(;Ne.isThemeIcon(s);){const o=Zf.getIcon(s.id);if(!o)return;s=o.defaults}return s}n.getDefinition=e})(q6||(q6={}));var G6;(function(n){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(s=>({format:s.format,location:s.location.toString()}))}}n.toJSONObject=e;function t(i){const s=o=>Ns(o)?o:void 0;if(i&&Array.isArray(i.src)&&i.src.every(o=>Ns(o.format)&&Ns(o.location)))return{weight:s(i.weight),style:s(i.style),src:i.src.map(o=>({format:o.format,location:je.parse(o.location)}))}}n.fromJSONObject=t})(G6||(G6={}));class OEe{constructor(){this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:m("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:m("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${Ne.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,s){const o=this.iconsById[e];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return o}const r={id:e,description:i,defaults:t,deprecationMessage:s};this.iconsById[e]=r;const a={$ref:"#/definitions/icons"};return s&&(a.deprecationMessage=s),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(o,r)=>o.id.localeCompare(r.id),t=o=>{for(;Ne.isThemeIcon(o.defaults);)o=this.iconsById[o.defaults.id];return`codicon codicon-${o?o.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const s=Object.keys(this.iconsById).map(o=>this.iconsById[o]);for(const o of s.filter(r=>!!r.description).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|${Ne.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const o of s.filter(r=>!Ne.isThemeIcon(r.defaults)).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|`);return i.join(`
`)}}const Zf=new OEe;mn.add(PEe.IconContribution,Zf);function Yi(n,e,t,i){return Zf.registerIcon(n,e,t,i)}function TK(){return Zf}function FEe(){const n=UU();for(const e in n){const t="\\"+n[e].toString(16);Zf.registerIcon(e,{fontCharacter:t})}}FEe();const NK="vscode://schemas/icons",RK=mn.as(RD.JSONContribution);RK.registerSchema(NK,Zf.getIconSchema());const K6=new Li(()=>RK.notifySchemaChanged(NK),200);Zf.onDidChange(()=>{K6.isScheduled()||K6.schedule()});const BEe=Yi("widget-close",se.close,m("widgetClose","Icon for the close action in widgets."));Yi("goto-previous-location",se.arrowUp,m("previousChangeIcon","Icon for goto previous editor location."));Yi("goto-next-location",se.arrowDown,m("nextChangeIcon","Icon for goto next editor location."));Ne.modify(se.sync,"spin");Ne.modify(se.loading,"spin");function WEe(n){const e=new pe,t=e.add(new B),i=TK();return e.add(i.onDidChange(()=>t.fire())),n&&e.add(n.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const s=n?n.getProductIconTheme():new MK,o={},r=l=>{const c=s.getIcon(l);if(!c)return;const d=c.font;return d?(o[d.id]=d.definition,`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${I9(d.id)}; }`):`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`},a=[];for(const l of i.getIcons()){const c=r(l);c&&a.push(c)}for(const l in o){const c=o[l],d=c.weight?`font-weight: ${c.weight};`:"",u=c.style?`font-style: ${c.style};`:"",h=c.src.map(f=>`${tu(f.location)} format('${f.format}')`).join(", ");a.push(`@font-face { src: ${h}; font-family: ${I9(l)};${d}${u} font-display: block; }`)}return a.join(`
`)}}}class MK{getIcon(e){const t=TK();let i=e.defaults;for(;Ne.isThemeIcon(i);){const s=t.getIcon(i.id);if(!s)return;i=s.defaults}return i}}const Qc="vs",G_="vs-dark",Ap="hc-black",Ip="hc-light",PK=mn.as(lq.ColorContribution),VEe=mn.as(Lq.ThemingContribution);class OK{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(qC(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,z.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=aR(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,z.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=PK.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case Qc:return Fo.LIGHT;case Ap:return Fo.HIGH_CONTRAST_DARK;case Ip:return Fo.HIGH_CONTRAST_LIGHT;default:return Fo.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const o=aR(this.themeData.base);e=o.rules,o.encodedTokensColors&&(t=o.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],s=this.themeData.colors["editor.background"];if(i||s){const o={token:""};i&&(o.foreground=i),s&&(o.background=s),e.push(o)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=IK.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const o=this.tokenTheme._match([e].concat(t).join(".")).metadata,r=Us.getForeground(o),a=Us.getFontStyle(o);return{foreground:r,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function qC(n){return n===Qc||n===G_||n===Ap||n===Ip}function aR(n){switch(n){case Qc:return TEe;case G_:return NEe;case Ap:return REe;case Ip:return MEe}}function zw(n){const e=aR(n);return new OK(n,e)}class zEe extends Y{constructor(){super(),this._onColorThemeChange=this._register(new B),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new B),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new MK,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(Qc,zw(Qc)),this._knownThemes.set(G_,zw(G_)),this._knownThemes.set(Ap,zw(Ap)),this._knownThemes.set(Ip,zw(Ip));const e=this._register(WEe(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(Qc),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),XU("(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return xT(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=wr(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),Y.None}_registerShadowDomContainer(e){const t=wr(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!qC(t.base)&&!qC(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new OK(e,t)),qC(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(Qc),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=window.matchMedia("(forced-colors: active)").matches;if(e!==sc(this._theme.type)){let t;$D(this._theme.type)?t=e?Ap:G_:t=e?Ip:Qc,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:r=>{t[r]||(e.push(r),t[r]=!0)}};VEe.getThemingParticipants().forEach(r=>r(this._theme,i,this._environment));const s=[];for(const r of PK.getColors()){const a=this._theme.getColor(r.id,!0);a&&s.push(`${kP(r.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor { ${s.join(`
`)} }`);const o=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(IEe(o)),this._themeCSS=e.join(`
`),this._updateCSS(),Si.setColorMap(o),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const kr=at("themeService");var HEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},WE=function(n,e){return function(t,i){e(t,i,n)}};let lR=class extends Y{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new B,this._onDidChangeReducedMotion=new B,this._accessibilityModeEnabledContext=Ebe.bindTo(this._contextKeyService);const s=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("editor.accessibilitySupport")&&(s(),this._onDidChangeScreenReaderOptimized.fire()),r.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),s(),this._register(this.onDidChangeScreenReaderOptimized(()=>s()));const o=window.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=o.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(o)}initReducedMotionListeners(e){if(!this._layoutService.hasContainer)return;this._register(K(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.container.classList.toggle("reduce-motion",i),this._layoutService.container.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};lR=HEe([WE(0,tt),WE(1,s0),WE(2,ti)],lR);var gk=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},yf=function(n,e){return function(t,i){e(t,i,n)}},Dg,zc;let cR=class{constructor(e,t){this._commandService=e,this._hiddenStates=new Vx(t)}createMenu(e,t,i){return new uR(e,this._hiddenStates,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},i),this._commandService,t)}resetHiddenStates(e){this._hiddenStates.reset(e)}};cR=gk([yf(0,fs),yf(1,Gf)],cR);let Vx=Dg=class{constructor(e){this._storageService=e,this._disposables=new pe,this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(Dg._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Dg._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(Dg._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){var i;return(i=this._hiddenByDefaultCache.get(`${e.id}/${t}`))!==null&&i!==void 0?i:!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){var i,s;const o=this._isHiddenByDefault(e,t),r=(s=(i=this._data[e.id])===null||i===void 0?void 0:i.includes(t))!==null&&s!==void 0?s:!1;return o?!r:r}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const o=this._data[e.id];if(i)o?o.indexOf(t)<0&&o.push(t):this._data[e.id]=[t];else if(o){const r=o.indexOf(t);r>=0&&zhe(o,r),o.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(Dg._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}};Vx._key="menu.hiddenCommands";Vx=Dg=gk([yf(0,Gf)],Vx);let dR=zc=class{constructor(e,t,i,s,o){this._id=e,this._hiddenStates=t,this._collectContextKeysForSubmenus=i,this._commandService=s,this._contextKeyService=o,this._menuGroups=[],this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=rr.getMenuItems(this._id);let t;e.sort(zc._compareMenuItems);for(const i of e){const s=i.group||"";(!t||t[0]!==s)&&(t=[s,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeys(i)}}_collectContextKeys(e){if(zc._fillInKbExprKeys(e.when,this._structureContextKeys),J0(e)){if(e.command.precondition&&zc._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;zc._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&rr.getMenuItems(e.submenu).forEach(this._collectContextKeys,this)}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[s,o]=i,r=[];for(const a of o)if(this._contextKeyService.contextMatchesRules(a.when)){const l=J0(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=$Ee(this._id,l?a.command:a,this._hiddenStates);if(l)r.push(new Xa(a.command,a.alt,e,c,this._contextKeyService,this._commandService));else{const d=new zc(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._contextKeyService).createActionGroups(e),u=Mn.join(...d.map(h=>h[1]));u.length>0&&r.push(new HS(a,c,u))}}r.length>0&&t.push([s,r])}return t}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}static _compareMenuItems(e,t){const i=e.group,s=t.group;if(i!==s){if(i){if(!s)return-1}else return 1;if(i==="navigation")return-1;if(s==="navigation")return 1;const a=i.localeCompare(s);if(a!==0)return a}const o=e.order||0,r=t.order||0;return o<r?-1:o>r?1:zc._compareTitles(J0(e)?e.command.title:e.title,J0(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,s=typeof t=="string"?t:t.original;return i.localeCompare(s)}};dR=zc=gk([yf(3,fs),yf(4,tt)],dR);let uR=class{constructor(e,t,i,s,o){this._disposables=new pe,this._menuInfo=new dR(e,t,i.emitEventsForSubmenuChanges,s,o);const r=new Li(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(r),this._disposables.add(rr.onDidChangeMenu(d=>{d.has(e)&&r.schedule()}));const a=this._disposables.add(new pe),l=d=>{let u=!1,h=!1,f=!1;for(const g of d)if(u=u||g.isStructuralChange,h=h||g.isEnablementChange,f=f||g.isToggleChange,u&&h&&f)break;return{menu:this,isStructuralChange:u,isEnablementChange:h,isToggleChange:f}},c=()=>{a.add(o.onDidChangeContext(d=>{const u=d.affectsSome(this._menuInfo.structureContextKeys),h=d.affectsSome(this._menuInfo.preconditionContextKeys),f=d.affectsSome(this._menuInfo.toggledContextKeys);(u||h||f)&&this._onDidChange.fire({menu:this,isStructuralChange:u,isEnablementChange:h,isToggleChange:f})})),a.add(t.onDidChange(d=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new RU({onWillAddFirstListener:c,onDidRemoveLastListener:a.clear.bind(a),delay:i.eventDebounceDelay,merge:l}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};uR=gk([yf(3,fs),yf(4,tt)],uR);function $Ee(n,e,t){const i=Rpe(e)?e.submenu.id:e.id,s=typeof e.title=="string"?e.title:e.title.value,o=E_({id:`hide/${n.id}/${i}`,label:m("hide.label","Hide '{0}'",s),run(){t.updateHidden(n,i,!0)}}),r=E_({id:`toggle/${n.id}/${i}`,label:s,get checked(){return!t.isHidden(n,i)},run(){t.updateHidden(n,i,!!this.checked)}});return{hide:o,toggle:r,get isHidden(){return!r.checked}}}var UEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Y6=function(n,e){return function(t,i){e(t,i,n)}},Gu=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let hR=class extends Y{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],(pc||QU)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const e=()=>{const t=new Ij;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(i=>Gu(this,void 0,void 0,function*(){(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)}))};this.layoutService.hasContainer&&(this._register(K(this.layoutService.container,"click",e)),this._register(K(this.layoutService.container,"keydown",e)))}writeText(e,t){return Gu(this,void 0,void 0,function*(){if(t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return yield navigator.clipboard.writeText(e)}catch(o){console.error(o)}const i=document.activeElement,s=document.body.appendChild(we("textarea",{"aria-hidden":!0}));s.style.height="1px",s.style.width="1px",s.style.position="absolute",s.value=e,s.focus(),s.select(),document.execCommand("copy"),i instanceof HTMLElement&&i.focus(),document.body.removeChild(s)})}readText(e){return Gu(this,void 0,void 0,function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return console.error(t),""}})}readFindText(){return Gu(this,void 0,void 0,function*(){return this.findText})}writeFindText(e){return Gu(this,void 0,void 0,function*(){this.findText=e})}writeResources(e){return Gu(this,void 0,void 0,function*(){this.resources=e})}readResources(){return Gu(this,void 0,void 0,function*(){return this.resources})}};hR=UEe([Y6(0,s0),Y6(1,yc)],hR);const Sy=at("clipboardService");var jEe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},qEe=function(n,e){return function(t,i){e(t,i,n)}};const K_="data-keybinding-context";class z3{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return Object.assign({},this._value)}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}}class Om extends z3{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}Om.INSTANCE=new Om;class Dv extends z3{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=q_.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(s=>{if(s.source===7){const o=Array.from(this._values,([r])=>r);this._values.clear(),i.fire(new X6(o))}else{const o=[];for(const r of s.affectedKeys){const a=`config.${r}`,l=this._values.findSuperstr(a);l!==void 0&&(o.push(...dt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(o.push(a),this._values.delete(a))}i.fire(new X6(o))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(Dv._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(Dv._keyPrefix.length),i=this._configurationService.getValue(t);let s;switch(typeof i){case"number":case"boolean":case"string":s=i;break;default:Array.isArray(i)?s=JSON.stringify(i):s=i}return this._values.set(e,s),s}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}Dv._keyPrefix="config.";class GEe{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class Z6{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class X6{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class KEe{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function YEe(n,e){return n.allKeysContainedIn(new Set(Object.keys(e)))}class FK extends Y{constructor(e){super(),this._onDidChangeContext=this._register(new Rb({merge:t=>new KEe(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new GEe(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ZEe(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new Z6(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new Z6(e))}getContext(e){return this._isDisposed?Om.INSTANCE:this.getContextValuesContainer(XEe(e))}dispose(){super.dispose(),this._isDisposed=!0}}let fR=class extends FK{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new Dv(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?Om.INSTANCE:this._contexts.get(e)||Om.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new z3(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};fR=jEe([qEe(0,ti)],fR);class ZEe extends FK{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new ta),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(K_)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(K_,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;YEe(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(K_),super.dispose())}getContextValuesContainer(e){return this._isDisposed?Om.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function XEe(n){for(;n;){if(n.hasAttribute(K_)){const e=n.getAttribute(K_);return e?parseInt(e,10):NaN}n=n.parentElement}return 0}function QEe(n,e,t){n.get(tt).createKey(String(e),JEe(t))}function JEe(n){return wU(n,e=>{if(typeof e=="object"&&e.$mid===1)return je.revive(e).toString();if(e instanceof je)return e.toString()})}Kt.registerCommand("_setContext",QEe);Kt.registerCommand({id:"getContextKeyInfo",handler(){return[..._e.all()].sort((n,e)=>n.key.localeCompare(e.key))},description:{description:m("getContextKeyInfo","A command that returns information about context keys"),args:[]}});Kt.registerCommand("_generateContextKeyInfo",function(){const n=[],e=new Set;for(const t of _e.all())e.has(t.key)||(e.add(t.key),n.push(t));n.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(n,void 0,2))});let eAe=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class Q6{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),s=this.lookupOrInsertNode(t);i.outgoing.set(s.key,s),s.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new eAe(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),s=this._findCycle(t,i);if(s)return s}}_findCycle(e,t){for(const[i,s]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const o=this._findCycle(s,t);if(o)return o;t.delete(i)}}}const tAe=!1;class J6 extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=(t=e.findCycleSlow())!==null&&t!==void 0?t:`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class zx{constructor(e=new YD,t=!1,i,s=tAe){var o;this._services=e,this._strict=t,this._parent=i,this._enableTracing=s,this._activeInstantiations=new Set,this._services.set(vt,this),this._globalGraph=s?(o=i==null?void 0:i._globalGraph)!==null&&o!==void 0?o:new Q6(r=>r):void 0}createChild(e){return new zx(e,this._strict,this,this._enableTracing)}invokeFunction(e,...t){const i=Cs.traceInvocation(this._enableTracing,e);let s=!1;try{return e({get:r=>{if(s)throw U4("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(r,i);if(!a)throw new Error(`[invokeFunction] unknown service '${r}'`);return a}},...t)}finally{s=!0,i.stop()}}createInstance(e,...t){let i,s;return e instanceof Sa?(i=Cs.traceCreation(this._enableTracing,e.ctor),s=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Cs.traceCreation(this._enableTracing,e),s=this._createInstance(e,t,i)),i.stop(),s}_createInstance(e,t=[],i){const s=Zr.getServiceDependencies(e).sort((a,l)=>a.index-l.index),o=[];for(const a of s){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),o.push(l)}const r=s.length>0?s[0].index:t.length;if(t.length!==r){console.trace(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);const a=r-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,r)}return Reflect.construct(e,t.concat(o))}_setServiceInstance(e,t){if(this._services.get(e)instanceof Sa)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof Sa?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var s;const o=new Q6(l=>l.id.toString());let r=0;const a=[{id:e,desc:t,_trace:i}];for(;a.length;){const l=a.pop();if(o.lookupOrInsertNode(l),r++>1e3)throw new J6(o);for(const c of Zr.getServiceDependencies(l.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(c.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,!0),(s=this._globalGraph)===null||s===void 0||s.insertEdge(String(l.id),String(c.id)),d instanceof Sa){const u={id:c.id,desc:d,_trace:l._trace.branch(c.id,!0)};o.insertEdge(l,u),a.push(u)}}}for(;;){const l=o.roots();if(l.length===0){if(!o.isEmpty())throw new J6(o);break}for(const{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof Sa){const u=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setServiceInstance(c.id,u)}o.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],s,o){if(this._services.get(e)instanceof Sa)return this._createServiceInstance(e,t,i,s,o);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,s,o);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],s,o){if(s){const r=new zx(void 0,this._strict,this,this._enableTracing);r._globalGraphImplicitDependency=String(e);const a=new Map,l=new Vme(()=>{const c=r._createInstance(t,i,o);for(const[d,u]of a){const h=c[d];if(typeof h=="function")for(const f of u)h.apply(c,f)}return a.clear(),c});return new Proxy(Object.create(null),{get(c,d){if(!l.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let f=a.get(d);return f||(f=new Ds,a.set(d,f)),(p,_,v)=>{const b=f.push([p,_,v]);return Ze(b)}}if(d in c)return c[d];const u=l.value;let h=u[d];return typeof h!="function"||(h=h.bind(u),c[d]=h),h},set(c,d,u){return l.value[d]=u,!0},getPrototypeOf(c){return t.prototype}})}else return this._createInstance(t,i,o)}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}class Cs{static traceInvocation(e,t){return e?new Cs(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Cs._None}static traceCreation(e,t){return e?new Cs(1,t.name):Cs._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new Cs(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;Cs._totals+=e;let t=!1;function i(o,r){const a=[],l=new Array(o+1).join("	");for(const[c,d,u]of r._dep)if(d&&u){t=!0,a.push(`${l}CREATES -> ${c}`);const h=i(o+1,u);h&&a.push(h)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const s=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Cs._totals.toFixed(2)}ms)`];(e>2||t)&&Cs.all.add(s.join(`
`))}}Cs.all=new Set;Cs._None=new class extends Cs{constructor(){super(0,null)}stop(){}branch(){return this}};Cs._totals=0;const iAe=new Set([it.inMemory,it.vscodeSourceControl,it.walkThrough,it.walkThroughSnippet]);class nAe{constructor(){this._byResource=new In,this._byOwner=new Map}set(e,t,i){let s=this._byResource.get(e);s||(s=new Map,this._byResource.set(e,s)),s.set(t,i);let o=this._byOwner.get(t);o||(o=new In,this._byOwner.set(t,o)),o.set(e,i)}get(e,t){const i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,s=!1;const o=this._byResource.get(e);o&&(i=o.delete(t));const r=this._byOwner.get(t);if(r&&(s=r.delete(e)),i!==s)throw new Error("illegal state");return i&&s}values(e){var t,i,s,o;return typeof e=="string"?(i=(t=this._byOwner.get(e))===null||t===void 0?void 0:t.values())!==null&&i!==void 0?i:dt.empty():je.isUri(e)?(o=(s=this._byResource.get(e))===null||s===void 0?void 0:s.values())!==null&&o!==void 0?o:dt.empty():dt.map(dt.concat(...this._byOwner.values()),r=>r[1])}}class sAe{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new In,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const s=this._resourceStats(t);this._add(s),this._data.set(t,s)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(iAe.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===Jt.Error?t.errors+=1:i===Jt.Warning?t.warnings+=1:i===Jt.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class $c{constructor(){this._onMarkerChanged=new RU({delay:0,merge:$c._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new nAe,this._stats=new sAe(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(Uhe(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const s=[];for(const o of i){const r=$c._toMarker(e,t,o);r&&s.push(r)}this._data.set(t,e,s),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:s,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:u,relatedInformation:h,tags:f}=i;if(r)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,u=u>0?u:c,{resource:t,owner:e,code:s,severity:o,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:u,relatedInformation:h,tags:f}}changeAll(e,t){const i=[],s=this._data.values(e);if(s)for(const o of s){const r=dt.first(o);r&&(i.push(r.resource),this._data.delete(r.resource,e))}if(tc(t)){const o=new In;for(const{resource:r,marker:a}of t){const l=$c._toMarker(e,r,a);if(!l)continue;const c=o.get(r);c?c.push(l):(o.set(r,[l]),i.push(r))}for(const[r,a]of o)this._data.set(r,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:s,take:o}=e;if((!o||o<0)&&(o=-1),t&&i){const r=this._data.get(i,t);if(r){const a=[];for(const l of r)if($c._accept(l,s)){const c=a.push(l);if(o>0&&c===o)break}return a}else return[]}else if(!t&&!i){const r=[];for(const a of this._data.values())for(const l of a)if($c._accept(l,s)){const c=r.push(l);if(o>0&&c===o)return r}return r}else{const r=this._data.values(i??t),a=[];for(const l of r)for(const c of l)if($c._accept(c,s)){const d=a.push(c);if(o>0&&d===o)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new In;for(const i of e)for(const s of i)t.set(s,!0);return Array.from(t.keys())}}class oAe extends Y{constructor(){super(...arguments),this._configurationModel=new En}get configurationModel(){return this._configurationModel}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=new En;const e=mn.as(zf.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const s of e){const o=i[s],r=t[s];o!==void 0?this._configurationModel.addValue(s,o):r?this._configurationModel.addValue(s,r.default):this._configurationModel.removeValue(s)}}}const pk=at("audioCue");class $e{static register(e){return new $e(e.fileName)}constructor(e){this.fileName=e}}$e.error=$e.register({fileName:"error.mp3"});$e.warning=$e.register({fileName:"warning.mp3"});$e.foldedArea=$e.register({fileName:"foldedAreas.mp3"});$e.break=$e.register({fileName:"break.mp3"});$e.quickFixes=$e.register({fileName:"quickFixes.mp3"});$e.taskCompleted=$e.register({fileName:"taskCompleted.mp3"});$e.taskFailed=$e.register({fileName:"taskFailed.mp3"});$e.terminalBell=$e.register({fileName:"terminalBell.mp3"});$e.diffLineInserted=$e.register({fileName:"diffLineInserted.mp3"});$e.diffLineDeleted=$e.register({fileName:"diffLineDeleted.mp3"});$e.diffLineModified=$e.register({fileName:"diffLineModified.mp3"});$e.chatRequestSent=$e.register({fileName:"chatRequestSent.mp3"});$e.chatResponsePending=$e.register({fileName:"chatResponsePending.mp3"});$e.chatResponseReceived1=$e.register({fileName:"chatResponseReceived1.mp3"});$e.chatResponseReceived2=$e.register({fileName:"chatResponseReceived2.mp3"});$e.chatResponseReceived3=$e.register({fileName:"chatResponseReceived3.mp3"});$e.chatResponseReceived4=$e.register({fileName:"chatResponseReceived4.mp3"});class rAe{constructor(e){this.randomOneOf=e}}class ct{static register(e){const t=new rAe("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new ct(t,e.name,e.settingsKey);return ct._audioCues.add(i),i}constructor(e,t,i){this.sound=e,this.name=t,this.settingsKey=i}}ct._audioCues=new Set;ct.error=ct.register({name:m("audioCues.lineHasError.name","Error on Line"),sound:$e.error,settingsKey:"audioCues.lineHasError"});ct.warning=ct.register({name:m("audioCues.lineHasWarning.name","Warning on Line"),sound:$e.warning,settingsKey:"audioCues.lineHasWarning"});ct.foldedArea=ct.register({name:m("audioCues.lineHasFoldedArea.name","Folded Area on Line"),sound:$e.foldedArea,settingsKey:"audioCues.lineHasFoldedArea"});ct.break=ct.register({name:m("audioCues.lineHasBreakpoint.name","Breakpoint on Line"),sound:$e.break,settingsKey:"audioCues.lineHasBreakpoint"});ct.inlineSuggestion=ct.register({name:m("audioCues.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:$e.quickFixes,settingsKey:"audioCues.lineHasInlineSuggestion"});ct.terminalQuickFix=ct.register({name:m("audioCues.terminalQuickFix.name","Terminal Quick Fix"),sound:$e.quickFixes,settingsKey:"audioCues.terminalQuickFix"});ct.onDebugBreak=ct.register({name:m("audioCues.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:$e.break,settingsKey:"audioCues.onDebugBreak"});ct.noInlayHints=ct.register({name:m("audioCues.noInlayHints","No Inlay Hints on Line"),sound:$e.error,settingsKey:"audioCues.noInlayHints"});ct.taskCompleted=ct.register({name:m("audioCues.taskCompleted","Task Completed"),sound:$e.taskCompleted,settingsKey:"audioCues.taskCompleted"});ct.taskFailed=ct.register({name:m("audioCues.taskFailed","Task Failed"),sound:$e.taskFailed,settingsKey:"audioCues.taskFailed"});ct.terminalCommandFailed=ct.register({name:m("audioCues.terminalCommandFailed","Terminal Command Failed"),sound:$e.error,settingsKey:"audioCues.terminalCommandFailed"});ct.terminalBell=ct.register({name:m("audioCues.terminalBell","Terminal Bell"),sound:$e.terminalBell,settingsKey:"audioCues.terminalBell"});ct.notebookCellCompleted=ct.register({name:m("audioCues.notebookCellCompleted","Notebook Cell Completed"),sound:$e.taskCompleted,settingsKey:"audioCues.notebookCellCompleted"});ct.notebookCellFailed=ct.register({name:m("audioCues.notebookCellFailed","Notebook Cell Failed"),sound:$e.taskFailed,settingsKey:"audioCues.notebookCellFailed"});ct.diffLineInserted=ct.register({name:m("audioCues.diffLineInserted","Diff Line Inserted"),sound:$e.diffLineInserted,settingsKey:"audioCues.diffLineInserted"});ct.diffLineDeleted=ct.register({name:m("audioCues.diffLineDeleted","Diff Line Deleted"),sound:$e.diffLineDeleted,settingsKey:"audioCues.diffLineDeleted"});ct.diffLineModified=ct.register({name:m("audioCues.diffLineModified","Diff Line Modified"),sound:$e.diffLineModified,settingsKey:"audioCues.diffLineModified"});ct.chatRequestSent=ct.register({name:m("audioCues.chatRequestSent","Chat Request Sent"),sound:$e.chatRequestSent,settingsKey:"audioCues.chatRequestSent"});ct.chatResponseReceived=ct.register({name:m("audioCues.chatResponseReceived","Chat Response Received"),settingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[$e.chatResponseReceived1,$e.chatResponseReceived2,$e.chatResponseReceived3,$e.chatResponseReceived4]}});ct.chatResponsePending=ct.register({name:m("audioCues.chatResponsePending","Chat Response Pending"),sound:$e.chatResponsePending,settingsKey:"audioCues.chatResponsePending"});class aAe extends Y{constructor(e,t=[]){super(),this.logger=new Ppe([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const lAe=[];function cAe(){return lAe.slice(0)}var Iu=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},gn=function(n,e){return function(t,i){e(t,i,n)}},Tp=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class dAe{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new B}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let gR=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new rge(new dAe(t))):Promise.reject(new Error("Model not found"))}};gR=Iu([gn(0,hs)],gR);class mk{show(){return mk.NULL_PROGRESS_RUNNER}showWhile(e,t){return Tp(this,void 0,void 0,function*(){yield e})}}mk.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class uAe{withProgress(e,t,i){return t({report:()=>{}})}}class hAe{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class fAe{confirm(e){return Tp(this,void 0,void 0,function*(){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}})}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),window.confirm(i)}prompt(e){var t,i;return Tp(this,void 0,void 0,function*(){let s;if(this.doConfirm(e.message,e.detail)){const r=[...(t=e.buttons)!==null&&t!==void 0?t:[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&r.push(e.cancelButton),s=yield(i=r[0])===null||i===void 0?void 0:i.run({checkboxChecked:!1})}return{result:s}})}error(e,t){return Tp(this,void 0,void 0,function*(){yield this.prompt({type:mi.Error,message:e,detail:t})})}}class kv{info(e){return this.notify({severity:mi.Info,message:e})}warn(e){return this.notify({severity:mi.Warning,message:e})}error(e){return this.notify({severity:mi.Error,message:e})}notify(e){switch(e.severity){case mi.Error:console.error(e.message);break;case mi.Warning:console.warn(e.message);break;default:console.log(e.message);break}return kv.NO_OP}prompt(e,t,i,s){return kv.NO_OP}status(e,t){return Y.None}}kv.NO_OP=new pxe;let pR=class{constructor(e){this._onWillExecuteCommand=new B,this._onDidExecuteCommand=new B,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Kt.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const s=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(s)}catch(s){return Promise.reject(s)}}};pR=Iu([gn(0,vt)],pR);let Fm=class extends DLe{constructor(e,t,i,s,o,r){super(e,t,i,s,o),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=f=>{const g=new pe;g.add(K(f,de.KEY_DOWN,p=>{const _=new zt(p);this._dispatch(_,_.target)&&(_.preventDefault(),_.stopPropagation())})),g.add(K(f,de.KEY_UP,p=>{const _=new zt(p);this._singleModifierDispatch(_,_.target)&&_.preventDefault()})),this._domNodeListeners.push(new gAe(f,g))},l=f=>{for(let g=0;g<this._domNodeListeners.length;g++){const p=this._domNodeListeners[g];p.domNode===f&&(this._domNodeListeners.splice(g,1),p.dispose())}},c=f=>{f.getOption(61)||a(f.getContainerDomNode())},d=f=>{f.getOption(61)||l(f.getContainerDomNode())};this._register(r.onCodeEditorAdd(c)),this._register(r.onCodeEditorRemove(d)),r.listCodeEditors().forEach(c);const u=f=>{a(f.getContainerDomNode())},h=f=>{l(f.getContainerDomNode())};this._register(r.onDiffEditorAdd(u)),this._register(r.onDiffEditorRemove(h)),r.listDiffEditors().forEach(u)}addDynamicKeybinding(e,t,i,s){return fr(Kt.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:s}]))}addDynamicKeybindings(e){const t=e.map(i=>{var s;return{keybinding:wT(i.keybinding,vo),command:(s=i.command)!==null&&s!==void 0?s:null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}});return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),Ze(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(Fs.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new j_(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let s=0;for(const o of e){const r=o.when||void 0,a=o.keybinding;if(!a)i[s++]=new i6(void 0,o.command,o.commandArgs,r,t,null,!1);else{const l=pv.resolveKeybinding(a,vo);for(const c of l)i[s++]=new i6(c,o.command,o.commandArgs,r,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new ff(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new pv([t],vo)}};Fm=Iu([gn(0,tt),gn(1,fs),gn(2,vc),gn(3,Ln),gn(4,yc),gn(5,Ut)],Fm);class gAe extends Y{constructor(e,t){super(),this.domNode=e,this._register(t)}}function eB(n){return n&&typeof n=="object"&&(!n.overrideIdentifier||typeof n.overrideIdentifier=="string")&&(!n.resource||n.resource instanceof je)}class BK{constructor(){this._onDidChangeConfiguration=new B,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const e=new oAe;this._configuration=new ZD(e.reload(),new En,new En,new En),e.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,s=eB(e)?e:eB(t)?t:{};return this._configuration.getValue(i,s,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const s of e){const[o,r]=s;this.getValue(o)!==r&&(this._configuration.updateValue(o,r),i.push(o))}if(i.length>0){const s=new CLe({keys:i,overrides:[]},t,this._configuration);s.source=8,s.sourceConfig=null,this._onDidChangeConfiguration.fire(s)}return Promise.resolve()}updateValue(e,t,i,s){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}}let mR=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new B,this.configurationService.onDidChangeConfiguration(s=>{this._onDidChangeConfiguration.fire({affectedKeys:s.affectedKeys,affectsConfiguration:(o,r)=>s.affectsConfiguration(r)})})}getValue(e,t,i){const s=V.isIPosition(t)?t:null,o=s?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,r=e?this.getLanguage(e,s):void 0;return typeof o>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:r}):this.configurationService.getValue(o,{resource:e,overrideIdentifier:r})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};mR=Iu([gn(0,ti),gn(1,hs),gn(2,Ai)],mR);let _R=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:Xn||pt?`
`:`\r
`}};_R=Iu([gn(0,ti)],_R);class pAe{publicLog2(){}}class Ev{constructor(){const e=je.from({scheme:Ev.SCHEME,authority:"model",path:"/"});this.workspace={id:VLe,folders:[new BLe({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===Ev.SCHEME?this.workspace.folders[0]:null}}Ev.SCHEME="inmemory";function Hx(n,e,t){if(!e||!(n instanceof BK))return;const i=[];Object.keys(e).forEach(s=>{mLe(s)&&i.push([`editor.${s}`,e[s]]),t&&_Le(s)&&i.push([`diffEditor.${s}`,e[s]])}),i.length>0&&n.updateValues(i)}let bR=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return Tp(this,void 0,void 0,function*(){const i=Array.isArray(e)?e:r3.convert(e),s=new Map;for(const a of i){if(!(a instanceof Zh))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=s.get(l);c||(c=[],s.set(l,c)),c.push(vLe.replaceMove(N.lift(a.textEdit.range),a.textEdit.text))}let o=0,r=0;for(const[a,l]of s)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),r+=1,o+=l.length;return{ariaSummary:Pb(SN.bulkEditServiceSummary,o,r),isApplied:o>0}})}};bR=Iu([gn(0,hs)],bR);class mAe{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return na(e)}}let vR=class extends xN{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const s=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();s&&(t=s.getContainerDomNode())}return super.showContextView(e,t,i)}};vR=Iu([gn(0,s0),gn(1,Ut)],vR);class _Ae{constructor(){this._neverEmitter=new B,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class bAe extends _v{constructor(){super()}}class vAe extends aAe{constructor(){super(new Mpe)}}let yR=class extends zN{constructor(e,t,i,s,o,r){super(e,t,i,s,o,r),this.configure({blockMouse:!1})}};yR=Iu([gn(0,vc),gn(1,Ln),gn(2,Eu),gn(3,bi),gn(4,Su),gn(5,tt)],yR);class yAe{playAudioCue(e,t){return Tp(this,void 0,void 0,function*(){})}}ht(ti,BK,0);ht(Xj,mR,0);ht(Qj,_R,0);ht(FLe,Ev,0);ht(QD,mAe,0);ht(vc,pAe,0);ht(_G,fAe,0);ht(CG,hAe,0);ht(Ln,kv,0);ht(dl,$c,0);ht(Ai,bAe,0);ht(kr,zEe,0);ht(yc,vAe,0);ht(hs,Rx,0);ht(DP,qN,0);ht(tt,fR,0);ht(NLe,uAe,0);ht(gy,mk,0);ht(Gf,Dke,0);ht(_y,BT,0);ht(AG,bR,0);ht(zLe,_Ae,0);ht(Cu,gR,0);ht(Du,lR,0);ht(Zo,H2e,0);ht(fs,pR,0);ht(bi,Fm,0);ht(F3,rR,0);ht(Eu,vR,0);ht(Sc,jN,0);ht(Sy,hR,0);ht(Au,yR,0);ht(Su,cR,0);ht(pk,yAe,0);var Ie;(function(n){const e=new YD;for(const[l,c]of W9())e.set(l,c);const t=new zx(e,!0);e.set(vt,t);function i(l){s||r({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof Sa?t.invokeFunction(d=>d.get(l)):c}n.get=i;let s=!1;const o=new B;function r(l){if(s)return t;s=!0;for(const[d,u]of W9())e.get(d)||e.set(d,u);for(const d in l)if(l.hasOwnProperty(d)){const u=at(d);e.get(u)instanceof Sa&&e.set(u,l[d])}const c=cAe();for(const d of c)try{t.createInstance(d)}catch(u){mt(u)}return o.fire(),t}n.initialize=r;function a(l){if(s)return l();const c=new pe,d=c.add(o.event(()=>{d.dispose(),c.add(l())}));return c}n.withServices=a})(Ie||(Ie={}));let wAe;function oc(){return wAe}let WK;function CAe(n){WK=n}class VK{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,s=t===void 0?e:t;return WK({owner:i,debugName:()=>{const o=Xf(s);if(o!==void 0)return o;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(s.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`}},o=>s(this.read(o),o))}}class xy extends VK{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function Pn(n,e){const t=new zK(n,e);try{n(t)}finally{t.finish()}}function SAe(n,e,t){n?e(n):Pn(e,t)}class zK{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this.updatingObservers=[],(i=oc())===null||i===void 0||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():Xf(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var e;const t=this.updatingObservers;this.updatingObservers=null;for(const{observer:i,observable:s}of t)i.endUpdate(s);(e=oc())===null||e===void 0||e.handleEndTransaction()}}function H3(n,e,t,i){let s;if(n!==void 0)if(typeof n=="function"){if(s=n(),s!==void 0)return s}else return n;if(e!==void 0&&(s=Xf(e),s!==void 0))return s;if(t!==void 0){for(const o in t)if(t[o]===i)return o}}function Xf(n){const e=n.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),s=i?i[1]:void 0;return s==null?void 0:s.trim()}function ri(n,e){return typeof n=="string"?new wR(void 0,n,e):new wR(n,void 0,e)}class wR extends xy{get debugName(){var e;return(e=H3(this._debugName,void 0,this._owner,this))!==null&&e!==void 0?e:"ObservableValue"}constructor(e,t,i){super(),this._owner=e,this._debugName=t,this._value=i}get(){return this._value}set(e,t,i){var s;if(this._value===e)return;let o;t||(t=o=new zK(()=>{},()=>`Setting ${this.debugName}`));try{const r=this._value;this._setValue(e),(s=oc())===null||s===void 0||s.handleObservableChanged(this,{oldValue:r,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this.observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function xAe(n,e){return typeof n=="string"?new tB(void 0,n,e):new tB(n,void 0,e)}class tB extends wR{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){var e;(e=this._value)===null||e===void 0||e.dispose()}}const CR=(n,e)=>n===e;function _t(n,e){return e!==void 0?new SR(n,void 0,e,void 0,void 0,void 0,CR):new SR(void 0,void 0,n,void 0,void 0,void 0,CR)}function Av(n,e){let t,i;e===void 0?(t=n,i=void 0):(i=n,t=e);const s=new pe;return new SR(i,()=>{var o;return(o=Xf(t))!==null&&o!==void 0?o:"(anonymous)"},o=>(s.clear(),t(o,s)),void 0,void 0,()=>s.dispose(),CR)}CAe(_t);class SR extends xy{get debugName(){var e;return(e=H3(this._debugName,this._computeFn,this._owner,this))!==null&&e!==void 0?e:"(anonymous)"}constructor(e,t,i,s,o,r=void 0,a){var l,c;super(),this._owner=e,this._debugName=t,this._computeFn=i,this.createChangeSummary=s,this._handleChange=o,this._handleLastObserverRemoved=r,this._equalityComparator=a,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=(l=this.createChangeSummary)===null||l===void 0?void 0:l.call(this),(c=oc())===null||c===void 0||c.handleDerivedCreated(this)}onLastObserverRemoved(){var e;this.state=0,this.value=void 0;for(const t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),(e=this._handleLastObserverRemoved)===null||e===void 0||e.call(this)}get(){var e;if(this.observers.size===0){const t=this._computeFn(this,(e=this.createChangeSummary)===null||e===void 0?void 0:e.call(this));return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(const t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){var e,t;if(this.state===3)return;const i=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=i;const s=this.state!==0,o=this.value;this.state=3;const r=this.changeSummary;this.changeSummary=(e=this.createChangeSummary)===null||e===void 0?void 0:e.call(this);try{this.value=this._computeFn(this,r)}finally{for(const l of this.dependenciesToBeRemoved)l.removeObserver(this);this.dependenciesToBeRemoved.clear()}const a=s&&!this._equalityComparator(o,this.value);if((t=oc())===null||t===void 0||t.handleDerivedRecomputed(this,{oldValue:o,newValue:this.value,change:void 0,didChange:a,hadValue:s}),a)for(const l of this.observers)l.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;const t=this.updateCount===1;if(this.state===3&&(this.state=1,!t))for(const i of this.observers)i.handlePossibleChange(this);if(t)for(const i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}if(this.updateCount<0)throw new ji}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){const i=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:o=>o===e},this.changeSummary):!0,s=this.state===3;if(i&&(this.state===1||s)&&(this.state=2,s))for(const o of this.observers)o.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}function HK(n,e){return new bk(n.debugName,e,void 0,void 0)}function li(n){return new bk(void 0,n,void 0,void 0)}function _k(n,e){return new bk(n.debugName,e,n.createEmptyChangeSummary,n.handleChange)}function $s(n){const e=new pe,t=HK({debugName:()=>Xf(n)||"(anonymous)"},i=>{e.clear(),n(i,e)});return Ze(()=>{t.dispose(),e.dispose()})}class bk{get debugName(){if(typeof this._debugName=="string")return this._debugName;if(typeof this._debugName=="function"){const t=this._debugName();if(t!==void 0)return t}const e=Xf(this._runFn);return e!==void 0?e:"(anonymous)"}constructor(e,t,i,s){var o,r;this._debugName=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=s,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=(o=this.createChangeSummary)===null||o===void 0?void 0:o.call(this),(r=oc())===null||r===void 0||r.handleAutorunCreated(this),this._runIfNeeded()}dispose(){this.disposed=!0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){var e,t,i;if(this.state===3)return;const s=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=s,this.state=3;try{if(!this.disposed){(e=oc())===null||e===void 0||e.handleAutorunTriggered(this);const o=this.changeSummary;this.changeSummary=(t=this.createChangeSummary)===null||t===void 0?void 0:t.call(this),this._runFn(this,o)}}finally{(i=oc())===null||i===void 0||i.handleAutorunFinished(this);for(const o of this.dependenciesToBeRemoved)o.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,Wb(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}(function(n){n.Observer=bk})(li||(li={}));function iB(n){return new LAe(n)}class LAe extends VK{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function DAe(n,e){return new Promise(t=>{let i=!1,s=!1;const o=li(r=>{const a=n.read(r);e(a)&&(i?o.dispose():s=!0,t(a))});i=!0,s&&o.dispose()})}function As(n,e){return new $K(n,e)}class $K extends xy{constructor(e,t){super(),this.event=e,this._getValue=t,this.hasValue=!1,this.handleEvent=i=>{var s;const o=this._getValue(i),r=!this.hasValue||this.value!==o;(s=oc())===null||s===void 0||s.handleFromEventObservableTriggered(this,{oldValue:this.value,newValue:o,change:void 0,didChange:r,hadValue:this.hasValue}),r&&(this.value=o,this.hasValue&&Pn(a=>{for(const l of this.observers)a.updateObserver(l,this),l.handleChange(this,void 0)},()=>{const a=this.getDebugName();return"Event fired"+(a?`: ${a}`:"")}),this.hasValue=!0)}}getDebugName(){return Xf(this._getValue)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(n){n.Observer=$K})(As||(As={}));function Mo(n,e){return new kAe(n,e)}class kAe extends xy{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{Pn(i=>{for(const s of this.observers)i.updateObserver(s,this),s.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function EAe(n){return typeof n=="string"?new nB(n):new nB(void 0,n)}class nB extends xy{get debugName(){var e;return(e=H3(this._debugName,void 0,this._owner,this))!==null&&e!==void 0?e:"Observable Signal"}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e){Pn(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this.observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}function $x(n){const e=new AAe(!0);return n.addObserver(e),n.reportChanges(),Ze(()=>{n.removeObserver(e)})}class AAe{constructor(e){this.forceRecompute=e,this.counter=0}beginUpdate(e){this.counter++}endUpdate(e){this.counter--,this.counter===0&&this.forceRecompute&&e.reportChanges()}handlePossibleChange(e){}handleChange(e,t){}}function UK(){return!!OU.VSCODE_DEV}function IAe(n){if(UK()){const e=TAe();return e.add(n),{dispose(){e.delete(n)}}}else return{dispose(){}}}function TAe(){Hw||(Hw=new Set);const n=globalThis;return n.$hotReload_applyNewExports||(n.$hotReload_applyNewExports=e=>{for(const t of Hw){const i=t(e);if(i)return i}}),Hw}let Hw;function NAe(n,e,t,i){if(n.length===0)return e;if(e.length===0)return n;const s=[];let o=0,r=0;for(;o<n.length&&r<e.length;){const a=n[o],l=e[r],c=t(a),d=t(l);c<d?(s.push(a),o++):c>d?(s.push(l),r++):(s.push(i(a,l)),o++,r++)}for(;o<n.length;)s.push(n[o]),o++;for(;r<e.length;)s.push(e[r]),r++;return s}function Ux(n,e){const t=new pe,i=n.createDecorationsCollection();return t.add(HK({debugName:()=>`Apply decorations from ${e.debugName}`},s=>{const o=e.read(s);i.set(o)})),t.add({dispose:()=>{i.clear()}}),t}function $w(n,e){return n.appendChild(e),Ze(()=>{n.removeChild(e)})}class RAe extends Y{get width(){return this._width}get height(){return this._height}constructor(e,t){super(),this.elementSizeObserver=this._register(new aq(e,t)),this._width=ri(this,this.elementSizeObserver.getWidth()),this._height=ri(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>Pn(s=>{this._width.set(this.elementSizeObserver.getWidth(),s),this._height.set(this.elementSizeObserver.getHeight(),s)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function sB(n,e){let t=n.get(),i=t,s=t;const o=ri("animatedValue",t);let r=-1;const a=300;let l;e.add(_k({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(d,u)=>(d.didChange(n)&&(u.animate=u.animate||d.change),!0)},(d,u)=>{l!==void 0&&(cancelAnimationFrame(l),l=void 0),i=s,t=n.read(d),r=Date.now()-(u.animate?0:a),c()}));function c(){const d=Date.now()-r;s=Math.floor(MAe(d,i,t-i,a)),d<a?l=requestAnimationFrame(c):s=t,o.set(s,void 0)}return o}function MAe(n,e,t,i){return n===i?e+t:t*(-Math.pow(2,-10*n/i)+1)+e}class jK extends Y{constructor(e,t,i){super(),this._register(new vk(e,i)),this._register(Nd(i,{height:t.actualHeight,top:t.actualTop}))}}class jx{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=ri(this,void 0),this._actualHeight=ri(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}class vk{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${vk._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}vk._counter=0;function Nd(n,e){return li(t=>{for(let[i,s]of Object.entries(e))s&&typeof s=="object"&&"read"in s&&(s=s.read(t)),typeof s=="number"&&(s=`${s}px`),i=i.replace(/[A-Z]/g,o=>"-"+o.toLowerCase()),n.style[i]=s})}function Uc(n,e){return PAe([n],e),n}function PAe(n,e){UK()&&Mo("reload",i=>IAe(s=>{if([...Object.values(s)].some(o=>n.includes(o)))return o=>(i(void 0),!0)})).read(e)}function qx(n,e,t){const i=new pe,s=[];return i.add(li(o=>{const r=e.read(o),a=new Map,l=new Map;t&&t(!0),n.changeViewZones(c=>{for(const d of s)c.removeZone(d);s.length=0;for(const d of r){const u=c.addZone(d);s.push(u),a.set(d,u)}}),t&&t(!1),i.add(_k({createEmptyChangeSummary(){return[]},handleChange(c,d){const u=l.get(c.changedObservable);return u!==void 0&&d.push(u),!0}},(c,d)=>{for(const u of r)u.onChange&&(l.set(u.onChange,a.get(u)),u.onChange.read(c));t&&t(!0),n.changeViewZones(u=>{for(const h of d)u.layoutZone(h)}),t&&t(!1)}))})),i.add({dispose(){t&&t(!0),n.changeViewZones(o=>{for(const r of s)o.removeZone(r)}),t&&t(!1)}}),i}class OAe extends xr{dispose(){super.dispose(!0)}}var $3=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},U3=function(n,e){return function(t,i){e(t,i,n)}},FAe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const BAe=Yi("diff-review-insert",se.add,m("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),WAe=Yi("diff-review-remove",se.remove,m("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),VAe=Yi("diff-review-close",se.close,m("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let md=class extends Y{constructor(e,t,i,s,o,r,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=s,this._width=o,this._height=r,this._diffs=a,this._editors=l,this._instantiationService=c,this.model=Av(this,(d,u)=>{const h=this._visible.read(d);if(this._parentNode.style.visibility=h?"visible":"hidden",!h)return null;const f=u.add(this._instantiationService.createInstance(xR,this._diffs,this._editors,this._setVisible,this._canClose)),g=u.add(this._instantiationService.createInstance(LR,this._parentNode,f,this._width,this._height,this._editors));return{model:f,view:g}}),this._register($x(this.model))}next(){Pn(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this.model.get().model.nextGroup(e)})}prev(){Pn(e=>{this._setVisible(!0,e),this.model.get().model.previousGroup(e)})}close(){Pn(e=>{this._setVisible(!1,e)})}};md._ttPolicy=Vf("diffReview",{createHTML:n=>n});md=$3([U3(8,vt)],md);let xR=class extends Y{constructor(e,t,i,s,o){super(),this._diffs=e,this._editors=t,this._setVisible=i,this.canClose=s,this._audioCueService=o,this._groups=ri(this,[]),this._currentGroupIdx=ri(this,0),this._currentElementIdx=ri(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((r,a)=>this._groups.read(a)[r]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((r,a)=>{var l;return(l=this.currentGroup.read(a))===null||l===void 0?void 0:l.lines[r]}),this._register(li(r=>{const a=this._diffs.read(r);if(!a){this._groups.set([],void 0);return}const l=zAe(a,this._editors.original.getModel().getLineCount(),this._editors.modified.getModel().getLineCount());Pn(c=>{const d=this._editors.modified.getPosition();if(d){const u=l.findIndex(h=>(d==null?void 0:d.lineNumber)<h.range.modified.endLineNumberExclusive);u!==-1&&this._currentGroupIdx.set(u,c)}this._groups.set(l,c)})})),this._register(li(r=>{const a=this.currentElement.read(r);(a==null?void 0:a.type)===ss.Deleted?this._audioCueService.playAudioCue(ct.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):(a==null?void 0:a.type)===ss.Added&&this._audioCueService.playAudioCue(ct.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(li(r=>{var a;const l=this.currentElement.read(r);if(l&&l.type!==ss.Header){const c=(a=l.modifiedLineNumber)!==null&&a!==void 0?a:l.diff.modified.startLineNumber;this._editors.modified.setSelection(N.fromPositions(new V(c,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||SAe(t,s=>{this._currentGroupIdx.set(Ye.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),s),this._currentElementIdx.set(0,s)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||Pn(i=>{this._currentElementIdx.set(Ye.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&Pn(s=>{this._currentElementIdx.set(i,s)})}revealCurrentElementInEditor(){this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===ss.Deleted?(this._editors.original.setSelection(N.fromPositions(new V(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==ss.Header&&(this._editors.modified.setSelection(N.fromPositions(new V(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}close(){this._setVisible(!1,void 0),this._editors.modified.focus()}};xR=$3([U3(4,pk)],xR);const O0=3;function zAe(n,e,t){const i=[];for(const s of fU(n,(o,r)=>r.modified.startLineNumber-o.modified.endLineNumberExclusive<2*O0)){const o=[];o.push(new $Ae);const r=new Qe(Math.max(1,s[0].original.startLineNumber-O0),Math.min(s[s.length-1].original.endLineNumberExclusive+O0,e+1)),a=new Qe(Math.max(1,s[0].modified.startLineNumber-O0),Math.min(s[s.length-1].modified.endLineNumberExclusive+O0,t+1));gU(s,(d,u)=>{const h=new Qe(d?d.original.endLineNumberExclusive:r.startLineNumber,u?u.original.startLineNumber:r.endLineNumberExclusive),f=new Qe(d?d.modified.endLineNumberExclusive:a.startLineNumber,u?u.modified.startLineNumber:a.endLineNumberExclusive);h.forEach(g=>{o.push(new qAe(g,f.startLineNumber+(g-h.startLineNumber)))}),u&&(u.original.forEach(g=>{o.push(new UAe(u,g))}),u.modified.forEach(g=>{o.push(new jAe(u,g))}))});const l=s[0].modified.join(s[s.length-1].modified),c=s[0].original.join(s[s.length-1].original);i.push(new HAe(new Qa(l,c),o))}return i}var ss;(function(n){n[n.Header=0]="Header",n[n.Unchanged=1]="Unchanged",n[n.Deleted=2]="Deleted",n[n.Added=3]="Added"})(ss||(ss={}));class HAe{constructor(e,t){this.range=e,this.lines=t}}class $Ae{constructor(){this.type=ss.Header}}class UAe{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=ss.Deleted,this.modifiedLineNumber=void 0}}class jAe{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=ss.Added,this.originalLineNumber=void 0}}class qAe{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=ss.Unchanged}}let LR=class extends Y{constructor(e,t,i,s,o,r){super(),this._element=e,this._model=t,this._width=i,this._height=s,this._editors=o,this._languageService=r,this.domNode=this._element,this.domNode.className="diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new il(a)),this._register(li(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new xo("diffreview.close",m("label.close","Close"),"close-diff-review "+Ne.asClassName(VAe),!0,()=>FAe(this,void 0,void 0,function*(){return t.close()})),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new FP(this._content,{})),cs(this.domNode,this._scrollbar.getDomNode(),a),this._register(Ze(()=>{cs(this.domNode)})),this._register(Nd(this.domNode,{width:this._width,height:this._height})),this._register(Nd(this._content,{width:this._width,height:this._height})),this._register($s((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(Hi(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._editors.original.getOptions(),i=this._editors.modified.getOptions(),s=document.createElement("div");s.className="diff-review-table",s.setAttribute("role","list"),s.setAttribute("aria-label",m("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),Rn(s,i.get(50)),cs(this._content,s);const o=this._editors.original.getModel(),r=this._editors.modified.getModel();if(!o||!r)return;const a=o.getOptions(),l=r.getOptions(),c=i.get(66),d=this._model.currentGroup.get();for(const u of(d==null?void 0:d.lines)||[]){if(!d)break;let h;if(u.type===ss.Header){const g=document.createElement("div");g.className="diff-review-row",g.setAttribute("role","listitem");const p=d.range,_=this._model.currentGroupIndex.get(),v=this._model.groups.get().length,b=L=>L===0?m("no_lines_changed","no lines changed"):L===1?m("one_line_changed","1 line changed"):m("more_lines_changed","{0} lines changed",L),y=b(p.original.length),w=b(p.modified.length);g.setAttribute("aria-label",m({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",_+1,v,p.original.startLineNumber,y,p.modified.startLineNumber,w));const C=document.createElement("div");C.className="diff-review-cell diff-review-summary",C.appendChild(document.createTextNode(`${_+1}/${v}: @@ -${p.original.startLineNumber},${p.original.length} +${p.modified.startLineNumber},${p.modified.length} @@`)),g.appendChild(C),h=g}else h=this._createRow(u,c,this._width.get(),t,o,a,i,r,l);s.appendChild(h);const f=_t(g=>this._model.currentElement.read(g)===u);e.add(li(g=>{const p=f.read(g);h.tabIndex=p?0:-1,p&&h.focus()})),e.add(K(h,"focus",()=>{this._model.goToLine(u)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,s,o,r,a,l,c){const d=s.get(143),u=d.glyphMarginWidth+d.lineNumbersWidth,h=a.get(143),f=10+h.glyphMarginWidth+h.lineNumbersWidth;let g="diff-review-row",p="";const _="diff-review-spacer";let v=null;switch(e.type){case ss.Added:g="diff-review-row line-insert",p=" char-insert",v=BAe;break;case ss.Deleted:g="diff-review-row line-delete",p=" char-delete",v=WAe;break}const b=document.createElement("div");b.style.minWidth=i+"px",b.className=g,b.setAttribute("role","listitem"),b.ariaLevel="";const y=document.createElement("div");y.className="diff-review-cell",y.style.height=`${t}px`,b.appendChild(y);const w=document.createElement("span");w.style.width=u+"px",w.style.minWidth=u+"px",w.className="diff-review-line-number"+p,e.originalLineNumber!==void 0?w.appendChild(document.createTextNode(String(e.originalLineNumber))):w.innerText="",y.appendChild(w);const C=document.createElement("span");C.style.width=f+"px",C.style.minWidth=f+"px",C.style.paddingRight="10px",C.className="diff-review-line-number"+p,e.modifiedLineNumber!==void 0?C.appendChild(document.createTextNode(String(e.modifiedLineNumber))):C.innerText="",y.appendChild(C);const L=document.createElement("span");if(L.className=_,v){const k=document.createElement("span");k.className=Ne.asClassName(v),k.innerText="",L.appendChild(k)}else L.innerText="";y.appendChild(L);let x;if(e.modifiedLineNumber!==void 0){let k=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);md._ttPolicy&&(k=md._ttPolicy.createHTML(k)),y.insertAdjacentHTML("beforeend",k),x=l.getLineContent(e.modifiedLineNumber)}else{let k=this._getLineHtml(o,s,r.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);md._ttPolicy&&(k=md._ttPolicy.createHTML(k)),y.insertAdjacentHTML("beforeend",k),x=o.getLineContent(e.originalLineNumber)}x.length===0&&(x=m("blankLine","blank"));let D="";switch(e.type){case ss.Unchanged:e.originalLineNumber===e.modifiedLineNumber?D=m({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",x,e.originalLineNumber):D=m("equalLine","{0} original line {1} modified line {2}",x,e.originalLineNumber,e.modifiedLineNumber);break;case ss.Added:D=m("insertLine","+ {0} modified line {1}",x,e.modifiedLineNumber);break;case ss.Deleted:D=m("deleteLine","- {0} original line {1}",x,e.originalLineNumber);break}return b.setAttribute("aria-label",D),b}_getLineHtml(e,t,i,s,o){const r=e.getLineContent(s),a=t.get(50),l=on.createEmpty(r,o),c=Do.isBasicASCII(r,e.mightContainNonBasicASCII()),d=Do.containsRTL(r,c,e.mightContainRTL());return FD(new i0(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,r,!1,c,d,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(116),t.get(98),t.get(93),t.get(51)!==No.OFF,null)).html}};LR=$3([U3(5,Ai)],LR);const GAe=Yi("diff-insert",se.add,m("diffInsertIcon","Line decoration for inserts in the diff editor.")),qK=Yi("diff-remove",se.remove,m("diffRemoveIcon","Line decoration for removals in the diff editor.")),oB=et.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+Ne.asClassName(GAe),marginClassName:"gutter-insert"}),rB=et.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+Ne.asClassName(qK),marginClassName:"gutter-delete"}),aB=et.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),lB=et.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),cB=et.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),KAe=et.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),YAe=et.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),DR=et.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),ZAe=et.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),XAe=et.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),QAe=et.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new Rm(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(m("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+Ne.asClassName(se.arrowRight),zIndex:10001});class Rd extends Y{constructor(e,t,i,s,o){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=s,this._editors=o,this._originalScrollTop=As(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=As(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=Mo("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=ri(this,0),this._modifiedViewZonesChangedSignal=Mo("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=Mo("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=Av((h,f)=>{var g;this._element.replaceChildren();const p=this._diffModel.read(h),_=(g=p==null?void 0:p.diff.read(h))===null||g===void 0?void 0:g.movedTexts;if(!_||_.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(h);const v=this._originalEditorLayoutInfo.read(h),b=this._modifiedEditorLayoutInfo.read(h);if(!v||!b){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(h),this._originalViewZonesChangedSignal.read(h);const y=_.map(P=>{function O(xe,Te){const me=Te.getTopForLineNumber(xe.startLineNumber,!0),te=Te.getTopForLineNumber(xe.endLineNumberExclusive,!0);return(me+te)/2}const M=O(P.lineRangeMapping.original,this._editors.original),R=this._originalScrollTop.read(h),$=O(P.lineRangeMapping.modified,this._editors.modified),G=this._modifiedScrollTop.read(h),ne=M-R,ae=$-G,fe=Math.min(M,$),oe=Math.max(M,$);return{range:new Ye(fe,oe),from:ne,to:ae,fromWithoutScroll:M,toWithoutScroll:$,move:P}});y.sort(qhe(ur(P=>P.fromWithoutScroll>P.toWithoutScroll,Ghe),ur(P=>P.fromWithoutScroll>P.toWithoutScroll?P.fromWithoutScroll:-P.toWithoutScroll,wd)));const w=j3.compute(y.map(P=>P.range)),C=10,L=v.verticalScrollbarWidth,x=(w.getTrackCount()-1)*10+C*2,D=L+x+(b.contentLeft-Rd.movedCodeBlockPadding);let k=0;for(const P of y){const O=w.getTrack(k),M=L+C+O*10,R=15,$=15,G=D,ne=b.glyphMarginWidth+b.lineNumbersWidth,ae=18,fe=document.createElementNS("http://www.w3.org/2000/svg","rect");fe.classList.add("arrow-rectangle"),fe.setAttribute("x",`${G-ne}`),fe.setAttribute("y",`${P.to-ae/2}`),fe.setAttribute("width",`${ne}`),fe.setAttribute("height",`${ae}`),this._element.appendChild(fe);const oe=document.createElementNS("http://www.w3.org/2000/svg","g"),xe=document.createElementNS("http://www.w3.org/2000/svg","path");xe.setAttribute("d",`M 0 ${P.from} L ${M} ${P.from} L ${M} ${P.to} L ${G-$} ${P.to}`),xe.setAttribute("fill","none"),oe.appendChild(xe);const Te=document.createElementNS("http://www.w3.org/2000/svg","polygon");Te.classList.add("arrow"),f.add(li(me=>{xe.classList.toggle("currentMove",P.move===p.activeMovedText.read(me)),Te.classList.toggle("currentMove",P.move===p.activeMovedText.read(me))})),Te.setAttribute("points",`${G-$},${P.to-R/2} ${G},${P.to} ${G-$},${P.to+R/2}`),oe.appendChild(Te),this._element.appendChild(oe),k++}this.width.set(x,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(Ze(()=>this._element.remove())),this._register(li(h=>{const f=this._originalEditorLayoutInfo.read(h),g=this._modifiedEditorLayoutInfo.read(h);!f||!g||(this._element.style.left=`${f.width-f.verticalScrollbarWidth}px`,this._element.style.height=`${f.height}px`,this._element.style.width=`${f.verticalScrollbarWidth+f.contentLeft-Rd.movedCodeBlockPadding+this.width.read(h)}px`)})),this._register($x(this._state));const r=_t(h=>{const f=this._diffModel.read(h),g=f==null?void 0:f.diff.read(h);return g?g.movedTexts.map(p=>({move:p,original:new jx(iB(p.lineRangeMapping.original.startLineNumber-1),18),modified:new jx(iB(p.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(qx(this._editors.original,r.map(h=>h.map(f=>f.original)))),this._register(qx(this._editors.modified,r.map(h=>h.map(f=>f.modified)))),this._register($s((h,f)=>{const g=r.read(h);for(const p of g)f.add(new dB(this._editors.original,p.original,p.move,"original",this._diffModel.get())),f.add(new dB(this._editors.modified,p.modified,p.move,"modified",this._diffModel.get()))}));const a=As(this._editors.original.onDidChangeCursorPosition,()=>this._editors.original.getPosition()),l=As(this._editors.modified.onDidChangeCursorPosition,()=>this._editors.modified.getPosition()),c=Mo("original.onDidFocusEditorWidget",h=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>h(void 0),0))),d=Mo("modified.onDidFocusEditorWidget",h=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>h(void 0),0)));let u="modified";this._register(_k({createEmptyChangeSummary:()=>{},handleChange:(h,f)=>(h.didChange(c)&&(u="original"),h.didChange(d)&&(u="modified"),!0)},h=>{c.read(h),d.read(h);const f=this._diffModel.read(h);if(!f)return;const g=f.diff.read(h);let p;if(g&&u==="original"){const _=a.read(h);_&&(p=g.movedTexts.find(v=>v.lineRangeMapping.original.contains(_.lineNumber)))}if(g&&u==="modified"){const _=l.read(h);_&&(p=g.movedTexts.find(v=>v.lineRangeMapping.modified.contains(_.lineNumber)))}p!==f.movedTextToCompare.get()&&f.movedTextToCompare.set(void 0,void 0),f.setActiveMovedText(p)}))}}Rd.movedCodeBlockPadding=4;class j3{static compute(e){const t=[],i=[];for(const s of e){let o=t.findIndex(r=>!r.intersectsStrict(s));o===-1&&(t.length>=6?o=f_e(t,ur(a=>a.intersectWithRangeLength(s),wd)):(o=t.length,t.push(new bP))),t[o].addRange(s),i.push(o)}return new j3(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class dB extends jK{constructor(e,t,i,s,o){const r=dn("div.diff-hidden-lines-widget");super(e,t,r.root),this._editor=e,this._move=i,this._kind=s,this._diffModel=o,this._nodes=dn("div.diff-moved-code-block",{style:{marginRight:"4px"}},[dn("div.text-content@textContent"),dn("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const a=As(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Nd(this._nodes.root,{paddingRight:a.map(h=>h.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?m("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?m("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):m("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new il(this._nodes.actionBar,{highlightToggledItems:!0})),d=new xo("",l,"",!1);c.push(d,{icon:!1,label:!0});const u=new xo("","Compare",Ne.asClassName(se.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(li(h=>{const f=this._diffModel.movedTextToCompare.read(h)===i;u.checked=f})),c.push(u,{icon:!1,label:!0})}}class JAe extends Y{constructor(e,t,i){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=_t(this,s=>{var o;const r=(o=this._diffModel.read(s))===null||o===void 0?void 0:o.diff.read(s);if(!r)return null;const a=this._diffModel.read(s).movedTextToCompare.read(s),l=this._options.renderIndicators.read(s),c=this._options.showEmptyDecorations.read(s),d=[],u=[];if(!a)for(const f of r.mappings){if(f.lineRangeMapping.original.isEmpty||d.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:l?rB:lB}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:l?oB:aB}),f.lineRangeMapping.modified.isEmpty||f.lineRangeMapping.original.isEmpty)f.lineRangeMapping.original.isEmpty||d.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:ZAe}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:KAe});else for(const g of f.lineRangeMapping.innerChanges||[])f.lineRangeMapping.original.contains(g.originalRange.startLineNumber)&&d.push({range:g.originalRange,options:g.originalRange.isEmpty()&&c?XAe:DR}),f.lineRangeMapping.modified.contains(g.modifiedRange.startLineNumber)&&u.push({range:g.modifiedRange,options:g.modifiedRange.isEmpty()&&c?YAe:cB});!f.lineRangeMapping.modified.isEmpty&&this._options.shouldRenderRevertArrows.read(s)&&!a&&u.push({range:N.fromPositions(new V(f.lineRangeMapping.modified.startLineNumber,1)),options:QAe})}if(a)for(const f of a.changes){const g=f.original.toInclusiveRange();g&&d.push({range:g,options:l?rB:lB});const p=f.modified.toInclusiveRange();p&&u.push({range:p,options:l?oB:aB});for(const _ of f.innerChanges||[])d.push({range:_.originalRange,options:DR}),u.push({range:_.modifiedRange,options:cB})}const h=this._diffModel.read(s).activeMovedText.read(s);for(const f of r.movedTexts)d.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(f===h?" currentMove":""),blockPadding:[Rd.movedCodeBlockPadding,0,Rd.movedCodeBlockPadding,Rd.movedCodeBlockPadding]}}),u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(f===h?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:d,modifiedDecorations:u}}),this._register(Ux(this._editors.original,this._decorations.map(s=>(s==null?void 0:s.originalDecorations)||[]))),this._register(Ux(this._editors.modified,this._decorations.map(s=>(s==null?void 0:s.modifiedDecorations)||[])))}}class eIe extends Y{constructor(e,t,i){super(),this._options=e,this._domNode=t,this._dimensions=i,this._sashRatio=ri(this,void 0),this.sashLeft=_t(this,s=>{var o;const r=(o=this._sashRatio.read(s))!==null&&o!==void 0?o:this._options.splitViewDefaultRatio.read(s);return this._computeSashLeft(r,s)}),this._sash=this._register(new kn(this._domNode,{getVerticalSashTop:s=>0,getVerticalSashLeft:s=>this.sashLeft.get(),getVerticalSashHeight:s=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(s=>{const o=this._dimensions.width.get(),r=this._computeSashLeft((this._startSashPosition+(s.currentX-s.startX))/o,void 0);this._sashRatio.set(r/o,void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._sashRatio.set(void 0,void 0))),this._register(li(s=>{const o=this._options.enableSplitViewResizing.read(s);this._sash.state=o?3:0,this.sashLeft.read(s),this._dimensions.height.read(s),this._sash.layout()}))}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_computeSashLeft(e,t){const i=this._dimensions.width.read(t),s=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),o=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):s,r=100;return i<=r*2?s:o<r?r:o>i-r?i-r:o}}class tp{remove(){var e;(e=this.parent)===null||e===void 0||e.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let s=i;for(let o=0;t.children.get(s)!==void 0;o++)s=`${i}_${o}`;return s}static empty(e){return e.children.size===0}}class uB extends tp{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class tIe extends tp{constructor(e,t,i,s){super(),this.id=e,this.parent=t,this.label=i,this.order=s,this.children=new Map}}class jc extends tp{static create(e,t,i){const s=new xr(i),o=new jc(t.uri),r=e.ordered(t),a=r.map((c,d)=>{var u;const h=tp.findId(`provider_${d}`,o),f=new tIe(h,o,(u=c.displayName)!==null&&u!==void 0?u:"Unknown Outline Provider",d);return Promise.resolve(c.provideDocumentSymbols(t,s.token)).then(g=>{for(const p of g||[])jc._makeOutlineElement(p,f);return f},g=>(bc(g),f)).then(g=>{tp.empty(g)?g.remove():o._groups.set(h,g)})}),l=e.onDidChange(()=>{const c=e.ordered(t);Ki(c,r)||s.cancel()});return Promise.all(a).then(()=>s.token.isCancellationRequested&&!i.isCancellationRequested?jc.create(e,t,i):o._compact()).finally(()=>{s.dispose(),l.dispose()})}static _makeOutlineElement(e,t){const i=tp.findId(e,t),s=new uB(i,t,e);if(e.children)for(const o of e.children)jc._makeOutlineElement(o,s);t.children.set(s.id,s)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=dt.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof uB?e.push(t.symbol):e.push(...dt.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>N.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return jc._flattenDocumentSymbols(t,e,""),t.sort((i,s)=>V.compare(N.getStartPosition(i.range),N.getStartPosition(s.range))||V.compare(N.getEndPosition(s.range),N.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const s of t)e.push({kind:s.kind,tags:s.tags,name:s.name,detail:s.detail,containerName:s.containerName||i,range:s.range,selectionRange:s.selectionRange,children:void 0}),s.children&&jc._flattenDocumentSymbols(e,s.children,s.name)}}var GK=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},KK=function(n,e){return function(t,i){e(t,i,n)}},iIe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let kR=class extends Y{get isUpdatingViewZones(){return this._isUpdatingViewZones}constructor(e,t,i,s){super(),this._editors=e,this._diffModel=t,this._options=i,this._languageFeaturesService=s,this._isUpdatingViewZones=!1,this._modifiedOutlineSource=Av(this,(c,d)=>{const u=this._editors.modifiedModel.read(c);if(u)return d.add(new ER(this._languageFeaturesService,u))}),this._register(this._editors.original.onDidChangeCursorPosition(c=>{if(c.reason===3){const d=this._diffModel.get();Pn(u=>{for(const h of this._editors.original.getSelections()||[])d==null||d.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,u),d==null||d.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,u)})}})),this._register(this._editors.modified.onDidChangeCursorPosition(c=>{if(c.reason===3){const d=this._diffModel.get();Pn(u=>{for(const h of this._editors.modified.getSelections()||[])d==null||d.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,u),d==null||d.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,u)})}}));const o=this._diffModel.map((c,d)=>{var u,h;return((u=c==null?void 0:c.diff.read(d))===null||u===void 0?void 0:u.mappings.length)===0?[]:(h=c==null?void 0:c.unchangedRegions.read(d))!==null&&h!==void 0?h:[]}),r=Av(this,(c,d)=>{const u=this._modifiedOutlineSource.read(c);if(!u)return{origViewZones:[],modViewZones:[]};const h=[],f=[],g=this._options.renderSideBySide.read(c),p=o.read(c);for(const _ of p)if(!_.shouldHideControls(c)){{const v=_t(y=>_.getHiddenOriginalRange(y).startLineNumber-1),b=new jx(v,24);h.push(b),d.add(new hB(this._editors.original,b,_,_.originalUnchangedRange,!g,u,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,void 0),this._options))}{const v=_t(y=>_.getHiddenModifiedRange(y).startLineNumber-1),b=new jx(v,24);f.push(b),d.add(new hB(this._editors.modified,b,_,_.modifiedUnchangedRange,!1,u,y=>this._diffModel.get().ensureModifiedLineIsVisible(y,void 0),this._options))}}return{origViewZones:h,modViewZones:f}}),a={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},l={description:"Fold Unchanged",glyphMarginHoverMessage:new Rm(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(m("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+Ne.asClassName(se.fold),zIndex:10001};this._register(Ux(this._editors.original,_t(c=>{const d=o.read(c),u=d.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:a}));for(const h of d)h.shouldHideControls(c)&&u.push({range:N.fromPositions(new V(h.originalLineNumber,1)),options:l});return u}))),this._register(Ux(this._editors.modified,_t(c=>{const d=o.read(c),u=d.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:a}));for(const h of d)h.shouldHideControls(c)&&u.push({range:Qe.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:l});return u}))),this._register(qx(this._editors.original,r.map(c=>c.origViewZones),c=>this._isUpdatingViewZones=c)),this._register(qx(this._editors.modified,r.map(c=>c.modViewZones),c=>this._isUpdatingViewZones=c)),this._register(li(c=>{const d=o.read(c);this._editors.original.setHiddenAreas(d.map(u=>u.getHiddenOriginalRange(c).toInclusiveRange()).filter(ES)),this._editors.modified.setHiddenAreas(d.map(u=>u.getHiddenModifiedRange(c).toInclusiveRange()).filter(ES))})),this._register(this._editors.modified.onMouseUp(c=>{var d;if(!c.event.rightButton&&c.target.position&&(!((d=c.target.element)===null||d===void 0)&&d.className.includes("fold-unchanged"))){const u=c.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const f=h.unchangedRegions.get().find(g=>g.modifiedUnchangedRange.includes(u));if(!f)return;f.collapseAll(void 0),c.event.stopPropagation(),c.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(c=>{var d;if(!c.event.rightButton&&c.target.position&&(!((d=c.target.element)===null||d===void 0)&&d.className.includes("fold-unchanged"))){const u=c.target.position.lineNumber,h=this._diffModel.get();if(!h)return;const f=h.unchangedRegions.get().find(g=>g.originalUnchangedRange.includes(u));if(!f)return;f.collapseAll(void 0),c.event.stopPropagation(),c.event.preventDefault()}}))}};kR=GK([KK(3,nt)],kR);let ER=class extends Y{constructor(e,t){super(),this._languageFeaturesService=e,this._textModel=t,this._currentModel=ri(this,void 0);const i=Mo("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),s=Mo("_textModel.onDidChangeContent",ue.debounce(o=>this._textModel.onDidChangeContent(o),()=>{},100));this._register($s((o,r)=>iIe(this,void 0,void 0,function*(){i.read(o),s.read(o);const a=r.add(new OAe),l=yield jc.create(this._languageFeaturesService.documentSymbolProvider,this._textModel,a.token);r.isDisposed||this._currentModel.set(l,void 0)})))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const s=i.asListOfDocumentSymbols().filter(o=>e.contains(o.range.startLineNumber)&&!e.contains(o.range.endLineNumber));return s.sort(bU(ur(o=>o.range.endLineNumber-o.range.startLineNumber,wd))),s.map(o=>({name:o.name,kind:o.kind,startLineNumber:o.range.startLineNumber}))}};ER=GK([KK(0,nt)],ER);class hB extends jK{constructor(e,t,i,s,o,r,a,l){const c=dn("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=s,this.hide=o,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=dn("div.diff-hidden-lines",[dn("div.top@top",{title:m("diff.hiddenLines.top","Click or drag to show more above")}),dn("div.center@content",{style:{display:"flex"}},[dn("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[we("a",{title:m("showAll","Show all"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...Qh("$(unfold)"))]),dn("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),dn("div.bottom@bottom",{title:m("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root);const d=As(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this.hide?cs(this._nodes.first):this._register(Nd(this._nodes.first,{width:d.map(h=>h.contentLeft)}));const u=this._editor;this._register(K(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const f=h.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set(!0,void 0);const _=K(window,"mousemove",b=>{const w=b.clientY-f;g=g||Math.abs(w)>2;const C=Math.round(w/u.getOption(66)),L=Math.max(0,Math.min(p+C,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(L,void 0)}),v=K(window,"mouseup",b=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(!1,void 0),_.dispose(),v.dispose()})})),this._register(K(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const f=h.clientY;let g=!1;const p=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set(!0,void 0);const _=K(window,"mousemove",b=>{const w=b.clientY-f;g=g||Math.abs(w)>2;const C=Math.round(w/u.getOption(66)),L=Math.max(0,Math.min(p-C,this._unchangedRegion.getMaxVisibleLineCountBottom())),x=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(L,void 0);const D=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(D-x))}),v=K(window,"mouseup",b=>{if(this._unchangedRegion.isDragged.set(!1,void 0),!g){const y=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const w=u.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);u.setScrollTop(u.getScrollTop()+(w-y))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),_.dispose(),v.dispose()})})),this._register(li(h=>{const f=[];if(!this.hide){const g=i.getHiddenModifiedRange(h).length,p=m("hiddenLines","{0} hidden lines",g),_=we("span",{title:m("diff.hiddenLines.expandAll","Double click to unfold")},p);_.addEventListener("dblclick",y=>{y.button===0&&(y.preventDefault(),this._unchangedRegion.showAll(void 0))}),f.push(_);const v=this._unchangedRegion.getHiddenModifiedRange(h),b=this._modifiedOutlineSource.getBreadcrumbItems(v,h);if(b.length>0){f.push(we("span",void 0,"|"));for(let y=0;y<b.length;y++){const w=b[y],C=AI.toIcon(w.kind),L=dn("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[IN(C),"",w.name,...y===b.length-1?[]:[IN(se.chevronRight)]]).root;f.push(L),L.onclick=()=>{this._revealModifiedHiddenLine(w.startLineNumber)}}}}cs(this._nodes.others,...f)}))}}class Iv{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new Iv(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const s=e.getVisibleRanges();if(s.length>0){t=s[0].getStartPosition();const o=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-o}return new Iv(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,s,o){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=s,this._cursorPosition=o}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i)}}var nIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},fB=function(n,e){return function(t,i){e(t,i,n)}},sIe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},th;let Gx=th=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new B,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;(e=this.diffAlgorithmOnDidChangeSubscription)===null||e===void 0||e.dispose()}computeDiff(e,t,i,s){var o,r;return sIe(this,void 0,void 0,function*(){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,s);if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new qo(new Qe(1,2),new Qe(1,t.getLineCount()+1),[new nu(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const a=JSON.stringify([e.uri.toString(),t.uri.toString()]),l=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),c=th.diffCache.get(a);if(c&&c.context===l)return c.result;const d=yu.create(),u=yield this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),h=d.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:h,timedOut:(o=u==null?void 0:u.quitEarly)!==null&&o!==void 0?o:!0,detectedMoves:i.computeMoves?(r=u==null?void 0:u.moves.length)!==null&&r!==void 0?r:0:-1}),s.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!u)throw new Error("no diff result available");return th.diffCache.size>10&&th.diffCache.delete(th.diffCache.keys().next().value),th.diffCache.set(a,{result:u,context:l}),u})}setOptions(e){var t;let i=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&((t=this.diffAlgorithmOnDidChangeSubscription)===null||t===void 0||t.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),i=!0),i&&this.onDidChangeEventEmitter.fire()}};Gx.diffCache=new Map;Gx=th=nIe([fB(1,_y),fB(2,vc)],Gx);var oIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},rIe=function(n,e){return function(t,i){e(t,i,n)}};const YK=at("diffProviderFactoryService");let AR=class{constructor(e){this.instantiationService=e}createDiffProvider(e,t){return this.instantiationService.createInstance(Gx,t)}};AR=oIe([rIe(0,vt)],AR);ht(YK,AR,1);var aIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},lIe=function(n,e){return function(t,i){e(t,i,n)}},gB=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let IR=class extends Y{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i,s){super(),this.model=e,this._options=t,this._editor=i,this._diffProviderFactoryService=s,this._isDiffUpToDate=ri(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=ri(this,void 0),this.diff=this._diff,this._unchangedRegions=ri(this,{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),this.unchangedRegions=_t(this,l=>this._options.hideUnchangedRegions.read(l)?this._unchangedRegions.read(l).regions:(Pn(c=>{for(const d of this._unchangedRegions.get().regions)d.collapseAll(c)}),[])),this.movedTextToCompare=ri(this,void 0),this._activeMovedText=ri(this,void 0),this._hoveredMovedText=ri(this,void 0),this.activeMovedText=_t(this,l=>{var c,d;return(d=(c=this.movedTextToCompare.read(l))!==null&&c!==void 0?c:this._hoveredMovedText.read(l))!==null&&d!==void 0?d:this._activeMovedText.read(l)}),this._cancellationTokenSource=new xr,this._diffProvider=_t(this,l=>{const c=this._diffProviderFactoryService.createDiffProvider(this._editor,{diffAlgorithm:this._options.diffAlgorithm.read(l)}),d=Mo("onDidChange",c.onDidChange);return{diffProvider:c,onChangeSignal:d}}),this._register(Ze(()=>this._cancellationTokenSource.cancel()));const o=EAe("contentChangedSignal"),r=this._register(new Li(()=>o.trigger(void 0),200)),a=(l,c,d)=>{const u=Kx.fromDiffs(l.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(d),this._options.hideUnchangedRegionsContextLineCount.read(d)),h=this._unchangedRegions.get(),f=h.originalDecorationIds.map(v=>e.original.getDecorationRange(v)).filter(v=>!!v).map(v=>Qe.fromRange(v)),g=h.modifiedDecorationIds.map(v=>e.modified.getDecorationRange(v)).filter(v=>!!v).map(v=>Qe.fromRange(v)),p=e.original.deltaDecorations(h.originalDecorationIds,u.map(v=>({range:v.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),_=e.modified.deltaDecorations(h.modifiedDecorationIds,u.map(v=>({range:v.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));for(const v of u)for(let b=0;b<h.regions.length;b++)if(v.originalUnchangedRange.intersectsStrict(f[b])&&v.modifiedUnchangedRange.intersectsStrict(g[b])){v.setHiddenModifiedRange(h.regions[b].getHiddenModifiedRange(void 0),c);break}this._unchangedRegions.set({regions:u,originalDecorationIds:p,modifiedDecorationIds:_},c)};this._register(e.modified.onDidChangeContent(l=>{if(this._diff.get()){const d=Jl.fromModelContentChanges(l.changes);this._lastDiff,e.original,e.modified}r.schedule()})),this._register(e.original.onDidChangeContent(l=>{if(this._diff.get()){const d=Jl.fromModelContentChanges(l.changes);this._lastDiff,e.original,e.modified}r.schedule()})),this._register($s((l,c)=>gB(this,void 0,void 0,function*(){var d,u;this._options.hideUnchangedRegionsMinimumLineCount.read(l),this._options.hideUnchangedRegionsContextLineCount.read(l),r.cancel(),o.read(l);const h=this._diffProvider.read(l);h.onChangeSignal.read(l),Uc(Yj,l),Uc(FT,l),this._isDiffUpToDate.set(!1,void 0);let f=[];c.add(e.original.onDidChangeContent(_=>{const v=Jl.fromModelContentChanges(_.changes);f=ux(f,v)}));let g=[];c.add(e.modified.onDidChangeContent(_=>{const v=Jl.fromModelContentChanges(_.changes);g=ux(g,v)}));let p=yield h.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(l),maxComputationTimeMs:this._options.maxComputationTimeMs.read(l),computeMoves:this._options.showMoves.read(l)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||(p=cIe(p,e.original,e.modified),p=(d=(e.original,e.modified,void 0))!==null&&d!==void 0?d:p,p=(u=(e.original,e.modified,void 0))!==null&&u!==void 0?u:p,Pn(_=>{a(p,_),this._lastDiff=p;const v=q3.fromDiffResult(p);this._diff.set(v,_),this._isDiffUpToDate.set(!0,_);const b=this.movedTextToCompare.get();this.movedTextToCompare.set(b?this._lastDiff.moves.find(y=>y.lineRangeMapping.modified.intersect(b.lineRangeMapping.modified)):void 0,_)}))})))}ensureModifiedLineIsVisible(e,t){var i;if(((i=this.diff.get())===null||i===void 0?void 0:i.mappings.length)===0)return;const s=this._unchangedRegions.get().regions;for(const o of s)if(o.getHiddenModifiedRange(void 0).contains(e)){o.showModifiedLine(e,t);return}}ensureOriginalLineIsVisible(e,t){var i;if(((i=this.diff.get())===null||i===void 0?void 0:i.mappings.length)===0)return;const s=this._unchangedRegions.get().regions;for(const o of s)if(o.getHiddenOriginalRange(void 0).contains(e)){o.showOriginalLine(e,t);return}}waitForDiff(){return gB(this,void 0,void 0,function*(){yield DAe(this.isDiffUpToDate,e=>e)})}serializeState(){return{collapsedRegions:this._unchangedRegions.get().regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){const t=e.collapsedRegions.map(s=>Qe.deserialize(s.range)),i=this._unchangedRegions.get();Pn(s=>{for(const o of i.regions)for(const r of t)if(o.modifiedUnchangedRange.intersect(r)){o.setHiddenModifiedRange(r,s);break}})}};IR=aIe([lIe(3,YK)],IR);function cIe(n,e,t){return{changes:n.changes.map(i=>new qo(i.original,i.modified,i.innerChanges?i.innerChanges.map(s=>dIe(s,e,t)):void 0)),moves:n.moves,identical:n.identical,quitEarly:n.quitEarly}}function dIe(n,e,t){let i=n.originalRange,s=n.modifiedRange;return(i.endColumn!==1||s.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&s.endColumn===t.getLineMaxColumn(s.endLineNumber)&&i.endLineNumber<e.getLineCount()&&s.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),s=s.setEndPosition(s.endLineNumber+1,1)),new nu(i,s)}class q3{static fromDiffResult(e){return new q3(e.changes.map(t=>new ZK(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,s){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=s}}class ZK{constructor(e){this.lineRangeMapping=e}}class Kx{static fromDiffs(e,t,i,s,o){const r=qo.inverse(e,t,i),a=[];for(const l of r){let c=l.original.startLineNumber,d=l.modified.startLineNumber,u=l.original.length;const h=c===1&&d===1,f=c+u===t+1&&d+u===i+1;(h||f)&&u>=o+s?(h&&!f&&(u-=o),f&&!h&&(c+=o,d+=o,u-=o),a.push(new Kx(c,d,u,0,0))):u>=o*2+s&&(c+=o,d+=o,u-=o*2,a.push(new Kx(c,d,u,0,0)))}return a}get originalUnchangedRange(){return Qe.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Qe.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,s,o){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=ri(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=ri(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=_t(this,r=>this.visibleLineCountTop.read(r)+this.visibleLineCountBottom.read(r)===this.lineCount&&!this.isDragged.read(r)),this.isDragged=ri(this,!1),this._visibleLineCountTop.set(s,void 0),this._visibleLineCountBottom.set(o,void 0)}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Qe.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Qe.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,s=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,s,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t){const i=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),s=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;i<s?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+i,t):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+s,t)}showOriginalLine(e,t){const i=e-this.originalLineNumber,s=this.originalLineNumber+this.lineCount-e;i<s?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+s-i,this.getMaxVisibleLineCountTop()),t):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+i-s,this.getMaxVisibleLineCountBottom()),t)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}var VE=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class uIe extends Y{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,s,o,r,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=s,this._editor=o,this._viewLineCounts=r,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ne.asClassName(se.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(66);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let u=0;const h=i.getOption(126)&&!Qd,f=(g,p)=>{var _;this._contextMenuService.showContextMenu({domForShadowRoot:h&&(_=i.getDomNode())!==null&&_!==void 0?_:void 0,getAnchor:()=>({x:g,y:p}),getActions:()=>{const v=[],b=s.modified.isEmpty;return v.push(new xo("diff.clipboard.copyDeletedContent",b?s.original.length>1?m("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):m("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):s.original.length>1?m("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):m("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,()=>VE(this,void 0,void 0,function*(){const w=this._originalTextModel.getValueInRange(s.original.toExclusiveRange());yield this._clipboardService.writeText(w)}))),s.original.length>1&&v.push(new xo("diff.clipboard.copyDeletedLineContent",b?m("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",s.original.startLineNumber+u):m("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",s.original.startLineNumber+u),void 0,!0,()=>VE(this,void 0,void 0,function*(){let w=this._originalTextModel.getLineContent(s.original.startLineNumber+u);w===""&&(w=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),yield this._clipboardService.writeText(w)}))),i.getOption(90)||v.push(new xo("diff.inline.revertChange",m("diff.inline.revertChange.label","Revert this change"),void 0,!0,()=>VE(this,void 0,void 0,function*(){this._editor.revert(this._diff)}))),v},autoSelectFirstItem:!0})};this._register(Hi(this._diffActions,"mousedown",g=>{const{top:p,height:_}=Nn(this._diffActions),v=Math.floor(d/3);g.preventDefault(),f(g.posx,p+_+v)})),this._register(i.onMouseMove(g=>{(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()?(u=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(g=>{g.event.rightButton&&(g.target.type===8||g.target.type===5)&&g.target.detail.viewZoneId===this._getViewZoneId()&&(g.event.preventDefault(),u=this._updateLightBulbPosition(this._marginDomNode,g.event.browserEvent.y,d),f(g.event.posx,g.event.posy+d))}))}_updateLightBulbPosition(e,t,i){const{top:s}=Nn(e),o=t-s,r=Math.floor(o/i),a=r*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],r<l)return c}return r}}const pB=Vf("diffEditorWidget",{createHTML:n=>n});function hIe(n,e,t,i){Rn(i,e.fontInfo);const s=t.length>0,o=new ID(1e4);let r=0,a=0;const l=[];for(let h=0;h<n.lineTokens.length;h++){const f=h+1,g=n.lineTokens[h],p=n.lineBreakData[h],_=lr.filter(t,f,1,Number.MAX_SAFE_INTEGER);if(p){let v=0;for(const b of p.breakOffsets){const y=g.sliceAndInflate(v,b,0);r=Math.max(r,mB(a,y,lr.extractWrapped(_,v,b),s,n.mightContainNonBasicASCII,n.mightContainRTL,e,o)),a++,v=b}l.push(p.breakOffsets.length)}else l.push(1),r=Math.max(r,mB(a,g,_,s,n.mightContainNonBasicASCII,n.mightContainRTL,e,o)),a++}r+=e.scrollBeyondLastColumn;const c=o.build(),d=pB?pB.createHTML(c):c;i.innerHTML=d;const u=r*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:u,viewLineCounts:l}}class fIe{constructor(e,t,i,s){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=s}}class G3{static fromEditor(e){var t;const i=e.getOptions(),s=i.get(50),o=i.get(143);return new G3(((t=e.getModel())===null||t===void 0?void 0:t.getOptions().tabSize)||0,s,i.get(33),s.typicalHalfwidthCharacterWidth,i.get(103),i.get(66),o.decorationsWidth,i.get(116),i.get(98),i.get(93),i.get(51))}constructor(e,t,i,s,o,r,a,l,c,d,u){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=s,this.scrollBeyondLastColumn=o,this.lineHeight=r,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=u}}function mB(n,e,t,i,s,o,r,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(n*r.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=Do.isBasicASCII(l,s),d=Do.containsRTL(l,c,o),u=SP(new i0(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,d,0,e,t,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==No.OFF,null),a);return a.appendString("</div>"),u.characterMapping.getHorizontalOffset(u.characterMapping.length)}var gIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},_B=function(n,e){return function(t,i){e(t,i,n)}};let TR=class extends Y{constructor(e,t,i,s,o,r,a){super(),this._editors=e,this._diffModel=t,this._options=i,this._diffEditorWidget=s,this._canIgnoreViewZoneUpdateEvent=o,this._clipboardService=r,this._contextMenuService=a,this._originalTopPadding=ri(this,0),this._originalScrollOffset=ri(this,0),this._originalScrollOffsetAnimated=sB(this._originalScrollOffset,this._store),this._modifiedTopPadding=ri(this,0),this._modifiedScrollOffset=ri(this,0),this._modifiedScrollOffsetAnimated=sB(this._modifiedScrollOffset,this._store);let l=!1;const c=ri("state",0),d=this._register(new Li(()=>{c.set(c.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(w=>{!l&&!this._canIgnoreViewZoneUpdateEvent()&&d.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(w=>{!l&&!this._canIgnoreViewZoneUpdateEvent()&&d.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(w=>{(w.hasChanged(144)||w.hasChanged(66))&&d.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(w=>{(w.hasChanged(144)||w.hasChanged(66))&&d.schedule()}));const u=this._diffModel.map(w=>w?As(w.model.original.onDidChangeTokens,()=>w.model.original.tokenization.backgroundTokenizationState===2):void 0).map((w,C)=>w==null?void 0:w.read(C)),h=new Set,f=new Set,g=_t(w=>{const C=this._diffModel.read(w),L=C==null?void 0:C.diff.read(w);if(!C||!L)return null;c.read(w);const D=this._options.renderSideBySide.read(w);return bB(this._editors.original,this._editors.modified,L.mappings,h,f,D)}),p=_t(w=>{var C;const L=(C=this._diffModel.read(w))===null||C===void 0?void 0:C.movedTextToCompare.read(w);if(!L)return null;c.read(w);const x=L.changes.map(D=>new ZK(D));return bB(this._editors.original,this._editors.modified,x,h,f,!0)});function _(){const w=document.createElement("div");return w.className="diagonal-fill",w}const v=this._register(new pe),b=_t(w=>{var C,L,x,D,k,P,O,M;v.clear();const R=g.read(w)||[],$=[],G=[],ne=this._modifiedTopPadding.read(w);ne>0&&G.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:ne,showInHiddenAreas:!0,suppressMouseDown:!0});const ae=this._originalTopPadding.read(w);ae>0&&$.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:ae,showInHiddenAreas:!0,suppressMouseDown:!0});const fe=this._options.renderSideBySide.read(w),oe=fe||(C=this._editors.modified._getViewModel())===null||C===void 0?void 0:C.createLineBreaksComputer();if(oe){for(const Ge of R)if(Ge.diff)for(let ii=Ge.originalRange.startLineNumber;ii<Ge.originalRange.endLineNumberExclusive;ii++)oe==null||oe.addRequest(this._editors.original.getModel().getLineContent(ii),null,null)}const xe=(L=oe==null?void 0:oe.finalize())!==null&&L!==void 0?L:[];let Te=0;const me=this._editors.modified.getOption(66),te=(x=this._diffModel.read(w))===null||x===void 0?void 0:x.movedTextToCompare.read(w),Yt=(k=(D=this._editors.original.getModel())===null||D===void 0?void 0:D.mightContainNonBasicASCII())!==null&&k!==void 0?k:!1,Lt=(O=(P=this._editors.original.getModel())===null||P===void 0?void 0:P.mightContainRTL())!==null&&O!==void 0?O:!1,Tt=G3.fromEditor(this._editors.modified);for(const Ge of R)if(Ge.diff&&!fe){if(!Ge.originalRange.isEmpty){u.read(w);const Ee=document.createElement("div");Ee.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const Ve=new fIe(Ge.originalRange.mapToLineArray(It=>this._editors.original.getModel().tokenization.getLineTokens(It)),Ge.originalRange.mapToLineArray(It=>xe[Te++]),Yt,Lt),ge=[];for(const It of Ge.diff.innerChanges||[])ge.push(new T_(It.originalRange.delta(-(Ge.diff.original.startLineNumber-1)),DR.className,0));const he=hIe(Ve,Tt,ge,Ee),ki=document.createElement("div");if(ki.className="inline-deleted-margin-view-zone",Rn(ki,Tt.fontInfo),this._options.renderIndicators.read(w))for(let It=0;It<he.heightInLines;It++){const vi=document.createElement("div");vi.className=`delete-sign ${Ne.asClassName(qK)}`,vi.setAttribute("style",`position:absolute;top:${It*me}px;width:${Tt.lineDecorationsWidth}px;height:${me}px;right:0;`),ki.appendChild(vi)}let Dt;v.add(new uIe(()=>vI(Dt),ki,this._editors.modified,Ge.diff,this._diffEditorWidget,he.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let It=0;It<he.viewLineCounts.length;It++){const vi=he.viewLineCounts[It];vi>1&&$.push({afterLineNumber:Ge.originalRange.startLineNumber+It,domNode:_(),heightInPx:(vi-1)*me,showInHiddenAreas:!0,suppressMouseDown:!0})}G.push({afterLineNumber:Ge.modifiedRange.startLineNumber-1,domNode:Ee,heightInPx:he.heightInLines*me,minWidthInPx:he.minWidthInPx,marginDomNode:ki,setZoneId(It){Dt=It},showInHiddenAreas:!0,suppressMouseDown:!0})}const ii=document.createElement("div");ii.className="gutter-delete",$.push({afterLineNumber:Ge.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:Ge.modifiedHeightInPx,marginDomNode:ii,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const ii=Ge.modifiedHeightInPx-Ge.originalHeightInPx;if(ii>0){if(te!=null&&te.lineRangeMapping.original.delta(-1).deltaLength(2).contains(Ge.originalRange.endLineNumberExclusive-1))continue;$.push({afterLineNumber:Ge.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:ii,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Ee=function(){const ge=document.createElement("div");return ge.className="arrow-revert-change "+Ne.asClassName(se.arrowRight),we("div",{},ge)};if(te!=null&&te.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(Ge.modifiedRange.endLineNumberExclusive-1))continue;let Ve;Ge.diff&&Ge.diff.modified.isEmpty&&this._options.shouldRenderRevertArrows.read(w)&&(Ve=Ee()),G.push({afterLineNumber:Ge.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-ii,marginDomNode:Ve,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const Ge of(M=p.read(w))!==null&&M!==void 0?M:[]){if(!(te!=null&&te.lineRangeMapping.original.intersect(Ge.originalRange))||!(te!=null&&te.lineRangeMapping.modified.intersect(Ge.modifiedRange)))continue;const ii=Ge.modifiedHeightInPx-Ge.originalHeightInPx;ii>0?$.push({afterLineNumber:Ge.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:ii,showInHiddenAreas:!0,suppressMouseDown:!0}):G.push({afterLineNumber:Ge.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-ii,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:$,mod:G}});this._register($s(w=>{const C=Iv.capture(this._editors.modified),L=b.read(w);l=!0,this._editors.original.changeViewZones(x=>{for(const D of h)x.removeZone(D);h.clear();for(const D of L.orig){const k=x.addZone(D);D.setZoneId&&D.setZoneId(k),h.add(k)}}),this._editors.modified.changeViewZones(x=>{for(const D of f)x.removeZone(D);f.clear();for(const D of L.mod){const k=x.addZone(D);D.setZoneId&&D.setZoneId(k),f.add(k)}}),l=!1,C.restore(this._editors.modified)})),this._register(Ze(()=>{this._editors.original.changeViewZones(w=>{for(const C of h)w.removeZone(C);h.clear()}),this._editors.modified.changeViewZones(w=>{for(const C of f)w.removeZone(C);f.clear()})}));let y=!1;this._register(this._editors.original.onDidScrollChange(w=>{w.scrollLeftChanged&&!y&&(y=!0,this._editors.modified.setScrollLeft(w.scrollLeft),y=!1)})),this._register(this._editors.modified.onDidScrollChange(w=>{w.scrollLeftChanged&&!y&&(y=!0,this._editors.original.setScrollLeft(w.scrollLeft),y=!1)})),this._originalScrollTop=As(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=As(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(li(w=>{const C=this._originalScrollTop.read(w)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(w))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(w));C!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(C,1)})),this._register(li(w=>{const C=this._modifiedScrollTop.read(w)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(w))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(w));C!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(C,1)})),this._register(li(w=>{var C;const L=(C=this._diffModel.read(w))===null||C===void 0?void 0:C.movedTextToCompare.read(w);let x=0;if(L){const D=this._editors.original.getTopForLineNumber(L.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();x=this._editors.modified.getTopForLineNumber(L.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-D}x>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(x,void 0)):x<0?(this._modifiedTopPadding.set(-x,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-x,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+x,void 0,!0)}))}};TR=gIe([_B(5,Sy),_B(6,Au)],TR);function bB(n,e,t,i,s,o){const r=new gc(vB(n,i)),a=new gc(vB(e,s)),l=n.getOption(66),c=e.getOption(66),d=[];let u=0,h=0;function f(g,p){for(;;){let _=r.peek(),v=a.peek();if(_&&_.lineNumber>=g&&(_=void 0),v&&v.lineNumber>=p&&(v=void 0),!_&&!v)break;const b=_?_.lineNumber-u:Number.MAX_VALUE,y=v?v.lineNumber-h:Number.MAX_VALUE;b<y?(r.dequeue(),v={lineNumber:_.lineNumber-u+h,heightInPx:0}):b>y?(a.dequeue(),_={lineNumber:v.lineNumber-h+u,heightInPx:0}):(r.dequeue(),a.dequeue()),d.push({originalRange:Qe.ofLength(_.lineNumber,1),modifiedRange:Qe.ofLength(v.lineNumber,1),originalHeightInPx:l+_.heightInPx,modifiedHeightInPx:c+v.heightInPx,diff:void 0})}}for(const g of t){let y=function(w,C){var L,x,D,k;if(w<b||C<v)return;if(_)_=!1;else if(w===b||C===v)return;const P=new Qe(b,w),O=new Qe(v,C);if(P.isEmpty&&O.isEmpty)return;const M=(x=(L=r.takeWhile($=>$.lineNumber<w))===null||L===void 0?void 0:L.reduce(($,G)=>$+G.heightInPx,0))!==null&&x!==void 0?x:0,R=(k=(D=a.takeWhile($=>$.lineNumber<C))===null||D===void 0?void 0:D.reduce(($,G)=>$+G.heightInPx,0))!==null&&k!==void 0?k:0;d.push({originalRange:P,modifiedRange:O,originalHeightInPx:P.length*l+M,modifiedHeightInPx:O.length*c+R,diff:g.lineRangeMapping}),b=w,v=C};const p=g.lineRangeMapping;f(p.original.startLineNumber,p.modified.startLineNumber);let _=!0,v=p.modified.startLineNumber,b=p.original.startLineNumber;if(o)for(const w of p.innerChanges||[])w.originalRange.startColumn>1&&w.modifiedRange.startColumn>1&&y(w.originalRange.startLineNumber,w.modifiedRange.startLineNumber),w.originalRange.endColumn<n.getModel().getLineMaxColumn(w.originalRange.endLineNumber)&&y(w.originalRange.endLineNumber,w.modifiedRange.endLineNumber);y(p.original.endLineNumberExclusive,p.modified.endLineNumberExclusive),u=p.original.endLineNumberExclusive,h=p.modified.endLineNumberExclusive}return f(Number.MAX_VALUE,Number.MAX_VALUE),d}function vB(n,e){const t=[],i=[],s=n.getOption(144).wrappingColumn!==-1,o=n._getViewModel().coordinatesConverter,r=n.getOption(66);if(s)for(let l=1;l<=n.getModel().getLineCount();l++){const c=o.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:r*(c-1)})}for(const l of n.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:o.convertViewPositionToModelPosition(new V(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return NAe(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}var pIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},mIe=function(n,e){return function(t,i){e(t,i,n)}},Or;let rc=Or=class extends Y{constructor(e,t,i,s,o,r,a,l){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=s,this._rootHeight=o,this._modifiedEditorLayoutInfo=r,this._options=a,this._themeService=l;const c=As(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),d=_t(f=>{const g=c.read(f),p=g.getColor(Lve)||(g.getColor(Sve)||jT).transparent(2),_=g.getColor(Dve)||(g.getColor(xve)||qT).transparent(2);return{insertColor:p,removeColor:_}}),u=As(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),h=As(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollHeight());this._register($s((f,g)=>{if(!this._options.renderOverviewRuler.read(f))return;const p=bt(document.createElement("div"));p.setClassName("diffViewport"),p.setPosition("absolute");const _=dn("div.diffOverview",{style:{position:"absolute",top:"0px",width:Or.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;g.add($w(_,p.domNode)),g.add(Hi(_,de.POINTER_DOWN,v=>{this._editors.modified.delegateVerticalScrollbarPointerDown(v)})),g.add(K(_,de.MOUSE_WHEEL,v=>{this._editors.modified.delegateScrollFromMouseWheelEvent(v)},{passive:!1})),g.add($w(this._rootElement,_)),g.add($s((v,b)=>{const y=this._diffModel.read(v),w=this._editors.original.createOverviewRuler("original diffOverviewRuler");w&&(b.add(w),b.add($w(_,w.getDomNode())));const C=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(C&&(b.add(C),b.add($w(_,C.getDomNode()))),!w||!C)return;const L=Mo("viewZoneChanged",this._editors.original.onDidChangeViewZones),x=Mo("viewZoneChanged",this._editors.modified.onDidChangeViewZones),D=Mo("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),k=Mo("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);b.add(li(P=>{var O;L.read(P),x.read(P),D.read(P),k.read(P);const M=d.read(P),R=(O=y==null?void 0:y.diff.read(P))===null||O===void 0?void 0:O.mappings;function $(ae,fe,oe){const xe=oe._getViewModel();return xe?ae.filter(Te=>Te.length>0).map(Te=>{const me=xe.coordinatesConverter.convertModelPositionToViewPosition(new V(Te.startLineNumber,1)),te=xe.coordinatesConverter.convertModelPositionToViewPosition(new V(Te.endLineNumberExclusive,1)),Yt=te.lineNumber-me.lineNumber;return new jq(me.lineNumber,te.lineNumber,Yt,fe.toString())}):[]}const G=$((R||[]).map(ae=>ae.lineRangeMapping.original),M.removeColor,this._editors.original),ne=$((R||[]).map(ae=>ae.lineRangeMapping.modified),M.insertColor,this._editors.modified);w==null||w.setZones(G),C==null||C.setZones(ne)})),b.add(li(P=>{const O=this._rootHeight.read(P),M=this._rootWidth.read(P),R=this._modifiedEditorLayoutInfo.read(P);if(R){const $=Or.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Or.ONE_OVERVIEW_WIDTH;w.setLayout({top:0,height:O,right:$+Or.ONE_OVERVIEW_WIDTH,width:Or.ONE_OVERVIEW_WIDTH}),C.setLayout({top:0,height:O,right:0,width:Or.ONE_OVERVIEW_WIDTH});const G=u.read(P),ne=h.read(P),ae=this._editors.modified.getOption(102),fe=new km(ae.verticalHasArrows?ae.arrowSize:0,ae.verticalScrollbarSize,0,R.height,ne,G);p.setTop(fe.getSliderPosition()),p.setHeight(fe.getSliderSize())}else p.setTop(0),p.setHeight(0);_.style.height=O+"px",_.style.left=M-Or.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",p.setWidth(Or.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}))}};rc.ONE_OVERVIEW_WIDTH=15;rc.ENTIRE_DIFF_OVERVIEW_WIDTH=Or.ONE_OVERVIEW_WIDTH*2;rc=Or=pIe([mIe(7,ao)],rc);E("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},m("diffEditor.move.border","The border color for text that got moved in the diff editor."));E("diffEditor.moveActive.border",{dark:"#FFA500",light:"#FFA500",hcDark:"#FFA500",hcLight:"#FFA500"},m("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));class yk extends Y{constructor(){super(...arguments),this._id=++yk.idCounter,this._onDidDispose=this._register(new B),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,s=!0){this._targetEditor.revealRange(e,t,i,s)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}yk.idCounter=0;var _Ie=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},yB=function(n,e){return function(t,i){e(t,i,n)}};let NR=class extends Y{constructor(e,t,i,s,o,r,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._createInnerEditor=o,this._instantiationService=r,this._keybindingService=a,this._onDidContentSizeChange=this._register(new B),this.original=this._register(this._createLeftHandSideEditor(i.editorOptions.get(),s.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(i.editorOptions.get(),s.modifiedEditor||{})),this.modifiedModel=As(this.modified.onDidChangeModel,()=>this.modified.getModel()),this._register(_k({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return s.setContextValue("isInDiffLeftEditor",!0),s}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),s=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return s.setContextValue("isInDiffRightEditor",!0),s}_constructInnerEditor(e,t,i,s){const o=this._createInnerEditor(e,t,i,s);return this._register(o.onDidContentSizeChange(r=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+rc.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:r.contentHeightChanged,contentWidthChanged:r.contentWidthChanged})})),o}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Nf.revealHorizontalRightPadding.defaultValue+rc.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){var t;e||(e="");const i=m("diff-aria-navigation-tip"," use {0} to open the accessibility help.",(t=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))===null||t===void 0?void 0:t.getAriaLabel());return this._options.accessibilityVerbose.get()?e+i:e?e.replaceAll(i,""):""}};NR=_Ie([yB(5,vt),yB(6,bi)],NR);class bIe{get editorOptions(){return this._options}constructor(e,t){this.diffEditorWidth=t,this.couldShowInlineViewBecauseOfSize=_t(this,s=>this._options.read(s).renderSideBySide&&this.diffEditorWidth.read(s)<=this._options.read(s).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=_t(this,s=>this._options.read(s).renderOverviewRuler),this.renderSideBySide=_t(this,s=>this._options.read(s).renderSideBySide&&!(this._options.read(s).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(s))),this.readOnly=_t(this,s=>this._options.read(s).readOnly),this.shouldRenderRevertArrows=_t(this,s=>!(!this._options.read(s).renderMarginRevertIcon||!this.renderSideBySide.read(s)||this.readOnly.read(s))),this.renderIndicators=_t(this,s=>this._options.read(s).renderIndicators),this.enableSplitViewResizing=_t(this,s=>this._options.read(s).enableSplitViewResizing),this.splitViewDefaultRatio=_t(this,s=>this._options.read(s).splitViewDefaultRatio),this.ignoreTrimWhitespace=_t(this,s=>this._options.read(s).ignoreTrimWhitespace),this.maxComputationTimeMs=_t(this,s=>this._options.read(s).maxComputationTime),this.showMoves=_t(this,s=>this._options.read(s).experimental.showMoves&&this.renderSideBySide.read(s)),this.isInEmbeddedEditor=_t(this,s=>this._options.read(s).isInEmbeddedEditor),this.diffWordWrap=_t(this,s=>this._options.read(s).diffWordWrap),this.originalEditable=_t(this,s=>this._options.read(s).originalEditable),this.diffCodeLens=_t(this,s=>this._options.read(s).diffCodeLens),this.accessibilityVerbose=_t(this,s=>this._options.read(s).accessibilityVerbose),this.diffAlgorithm=_t(this,s=>this._options.read(s).diffAlgorithm),this.showEmptyDecorations=_t(this,s=>this._options.read(s).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=_t(this,s=>this._options.read(s).onlyShowAccessibleDiffViewer),this.hideUnchangedRegions=_t(this,s=>this._options.read(s).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=_t(this,s=>this._options.read(s).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=_t(this,s=>this._options.read(s).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=_t(this,s=>this._options.read(s).hideUnchangedRegions.minimumLineCount);const i=Object.assign(Object.assign({},e),wB(e,Un));this._options=ri(this,i)}updateOptions(e){const t=wB(e,this._options.get()),i=Object.assign(Object.assign(Object.assign({},this._options.get()),e),t);this._options.set(i,void 0,{changedOptions:e})}}function wB(n,e){var t,i,s,o,r,a,l,c;return{enableSplitViewResizing:ye(n.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:gfe(n.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:ye(n.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:ye(n.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:Zu(n.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:Zu(n.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:ye(n.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:ye(n.renderIndicators,e.renderIndicators),originalEditable:ye(n.originalEditable,e.originalEditable),diffCodeLens:ye(n.diffCodeLens,e.diffCodeLens),renderOverviewRuler:ye(n.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:xi(n.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:xi(n.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:ye(n.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:ye((t=n.experimental)===null||t===void 0?void 0:t.showMoves,e.experimental.showMoves),showEmptyDecorations:ye((i=n.experimental)===null||i===void 0?void 0:i.showEmptyDecorations,e.experimental.showEmptyDecorations)},hideUnchangedRegions:{enabled:ye((o=(s=n.hideUnchangedRegions)===null||s===void 0?void 0:s.enabled)!==null&&o!==void 0?o:(r=n.experimental)===null||r===void 0?void 0:r.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:Zu((a=n.hideUnchangedRegions)===null||a===void 0?void 0:a.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Zu((l=n.hideUnchangedRegions)===null||l===void 0?void 0:l.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Zu((c=n.hideUnchangedRegions)===null||c===void 0?void 0:c.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:ye(n.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:ye(n.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Zu(n.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:ye(n.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited)}}var vIe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},F0=function(n,e){return function(t,i){e(t,i,n)}};let RR=class extends yk{constructor(e,t,i,s,o,r,a,l){var c;super(),this._domElement=e,this._parentContextKeyService=s,this._parentInstantiationService=o,this._audioCueService=a,this._editorProgressService=l,this.elements=dn("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[dn("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[we("span",{},"No Changes")]),dn("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),dn("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),dn("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=this._register(xAe("diffModel",void 0)),this.onDidChangeModel=ue.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new YD([tt,this._contextKeyService])),this._boundarySashes=ri(this,void 0),this._accessibleDiffViewerShouldBeVisible=ri(this,!1),this._accessibleDiffViewerVisible=_t(this,p=>this._options.onlyShowAccessibleDiffViewer.read(p)?!0:this._accessibleDiffViewerShouldBeVisible.read(p)),this.movedBlocksLinesPart=ri(this,void 0),this._layoutInfo=_t(this,p=>{var _,v,b;const y=this._rootSizeObserver.width.read(p),w=this._rootSizeObserver.height.read(p),C=(_=this._sash.read(p))===null||_===void 0?void 0:_.sashLeft.read(p),L=C??Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),x=y-L-(this._options.renderOverviewRuler.read(p)?rc.ENTIRE_DIFF_OVERVIEW_WIDTH:0),D=(b=(v=this.movedBlocksLinesPart.read(p))===null||v===void 0?void 0:v.width.read(p))!==null&&b!==void 0?b:0,k=L-D;return this.elements.original.style.width=k+"px",this.elements.original.style.left="0px",this.elements.modified.style.width=x+"px",this.elements.modified.style.left=L+"px",this._editors.original.layout({width:k,height:w}),this._editors.modified.layout({width:x,height:w}),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((p,_)=>p==null?void 0:p.diff.read(_)),this.onDidUpdateDiff=ue.fromObservableLight(this._diffValue),r.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(Ze(()=>this._domElement.removeChild(this.elements.root))),this._rootSizeObserver=this._register(new RAe(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout((c=t.automaticLayout)!==null&&c!==void 0?c:!1),this._options=new bIe(t,this._rootSizeObserver.width),this._contextKeyService.createKey(H.isEmbeddedDiffEditor.key,!1);const d=H.isEmbeddedDiffEditor.bindTo(this._contextKeyService);this._register(li(p=>{d.set(this._options.isInEmbeddedEditor.read(p))}));const u=H.comparingMovedCode.bindTo(this._contextKeyService);this._register(li(p=>{var _;u.set(!!(!((_=this._diffModel.read(p))===null||_===void 0)&&_.movedTextToCompare.read(p)))}));const h=H.diffEditorRenderSideBySideInlineBreakpointReached.bindTo(this._contextKeyService);this._register(li(p=>{h.set(this._options.couldShowInlineViewBecauseOfSize.read(p))})),this._editors=this._register(this._instantiationService.createInstance(NR,this.elements.original,this.elements.modified,this._options,i,(p,_,v,b)=>this._createInnerEditor(p,_,v,b))),this._sash=Av(this,(p,_)=>{const v=this._options.renderSideBySide.read(p);if(this.elements.root.classList.toggle("side-by-side",v),!v)return;const b=_.add(new eIe(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((y,w)=>y-(this._options.renderOverviewRuler.read(w)?rc.ENTIRE_DIFF_OVERVIEW_WIDTH:0))}));return _.add(li(y=>{const w=this._boundarySashes.read(y);w&&b.setBoundarySashes(w)})),b}),this._register($x(this._sash)),this._register($s((p,_)=>{this.unchangedRangesFeature=_.add(this._instantiationService.createInstance(Uc(kR,p),this._editors,this._diffModel,this._options))})),this._register($s((p,_)=>{_.add(new(Uc(JAe,p))(this._editors,this._diffModel,this._options))})),this._register($s((p,_)=>{_.add(this._instantiationService.createInstance(Uc(TR,p),this._editors,this._diffModel,this._options,this,()=>this.unchangedRangesFeature.isUpdatingViewZones))})),this._register($s((p,_)=>{_.add(this._instantiationService.createInstance(Uc(rc,p),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(v=>v.modifiedEditor),this._options))})),this._register($s((p,_)=>{this._accessibleDiffViewer=_.add(this._register(this._instantiationService.createInstance(Uc(md,p),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(v,b)=>this._accessibleDiffViewerShouldBeVisible.set(v,b),this._options.onlyShowAccessibleDiffViewer.map(v=>!v),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((v,b)=>{var y;return(y=v==null?void 0:v.diff.read(b))===null||y===void 0?void 0:y.mappings.map(w=>w.lineRangeMapping)}),this._editors)))}));const f=this._accessibleDiffViewerVisible.map(p=>p?"hidden":"visible");this._register(Nd(this.elements.modified,{visibility:f})),this._register(Nd(this.elements.original,{visibility:f})),this._createDiffEditorContributions(),r.addDiffEditor(this),this._register($x(this._layoutInfo)),this._register($s((p,_)=>{this.movedBlocksLinesPart.set(_.add(new(Uc(Rd,p))(this.elements.root,this._diffModel,this._layoutInfo.map(v=>v.originalEditor),this._layoutInfo.map(v=>v.modifiedEditor),this._editors)),void 0)})),this._register(Nd(this.elements.overlay,{width:this._layoutInfo.map((p,_)=>p.originalEditor.width+(this._options.renderSideBySide.read(_)?0:p.modifiedEditor.width)),visibility:_t(p=>{var _,v;return this._options.hideUnchangedRegions.read(p)&&((v=(_=this._diffModel.read(p))===null||_===void 0?void 0:_.diff.read(p))===null||v===void 0?void 0:v.mappings.length)===0?"visible":"hidden"})})),this._register(this._editors.modified.onMouseDown(p=>{var _,v;if(!p.event.rightButton&&p.target.position&&(!((_=p.target.element)===null||_===void 0)&&_.className.includes("arrow-revert-change"))){const b=p.target.position.lineNumber,y=p.target,w=this._diffModel.get();if(!w)return;const C=(v=w.diff.get())===null||v===void 0?void 0:v.mappings;if(!C)return;const L=C.find(x=>(y==null?void 0:y.detail.afterLineNumber)===x.lineRangeMapping.modified.startLineNumber-1||x.lineRangeMapping.modified.startLineNumber===b);if(!L)return;this.revert(L.lineRangeMapping),p.event.stopPropagation()}})),this._register(ue.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,p=>{var _,v;if((p==null?void 0:p.reason)===3){const b=(v=(_=this._diffModel.get())===null||_===void 0?void 0:_.diff.get())===null||v===void 0?void 0:v.mappings.find(y=>y.lineRangeMapping.modified.contains(p.position.lineNumber));b!=null&&b.lineRangeMapping.modified.isEmpty?this._audioCueService.playAudioCue(ct.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):b!=null&&b.lineRangeMapping.original.isEmpty?this._audioCueService.playAudioCue(ct.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):b&&this._audioCueService.playAudioCue(ct.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}));const g=this._diffModel.map((p,_)=>p==null?void 0:p.isDiffUpToDate.read(_));this._register($s((p,_)=>{if(g.read(p)===!1){const v=this._editorProgressService.show(!0,1e3);_.add(Ze(()=>v.done()))}}))}_createInnerEditor(e,t,i,s){return e.createInstance(Im,t,i,s)}_createDiffEditorContributions(){const e=hp.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){mt(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return OD.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var e;const t=this._editors.original.saveViewState(),i=this._editors.modified.saveViewState();return{original:t,modified:i,modelState:(e=this._diffModel.get())===null||e===void 0?void 0:e.serializeState()}}restoreViewState(e){var t;if(e&&e.original&&e.modified){const i=e;this._editors.original.restoreViewState(i.original),this._editors.modified.restoreViewState(i.modified),i.modelState&&((t=this._diffModel.get())===null||t===void 0||t.restoreSerializedState(i.modelState))}}createViewModel(e){return this._instantiationService.createInstance(IR,e,this._options,this)}getModel(){var e,t;return(t=(e=this._diffModel.get())===null||e===void 0?void 0:e.model)!==null&&t!==void 0?t:null}setModel(e){!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();const t=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(t?t.model.original:null),this._editors.modified.setModel(t?t.model.modified:null),Pn(i=>{this._diffModel.set(t,i)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.diff.get();return t?CIe(t):null}revert(e){var t;const i=(t=this._diffModel.get())===null||t===void 0?void 0:t.model;if(!i)return;const s=e.innerChanges?e.innerChanges.map(o=>({range:o.modifiedRange,text:i.original.getValueInRange(o.originalRange)})):[{range:e.modified.toExclusiveRange(),text:i.original.getValueInRange(e.original.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",s)}accessibleDiffViewerNext(){this._accessibleDiffViewer.next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.prev()}mapToOtherSide(){var e,t;const i=this._editors.modified.hasWidgetFocus(),s=i?this._editors.modified:this._editors.original,o=i?this._editors.original:this._editors.modified;let r;const a=s.getSelection();if(a){const l=(t=(e=this._diffModel.get())===null||e===void 0?void 0:e.diff.get())===null||t===void 0?void 0:t.mappings.map(c=>i?c.lineRangeMapping.flip():c.lineRangeMapping);if(l){const c=CB(a.getStartPosition(),l),d=CB(a.getEndPosition(),l);r=N.plusRange(c,d)}}return{destination:o,destinationSelection:r}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.unchangedRegions.get();t&&Pn(i=>{for(const s of t)s.collapseAll(i)})}showAllUnchangedRegions(){var e;const t=(e=this._diffModel.get())===null||e===void 0?void 0:e.unchangedRegions.get();t&&Pn(i=>{for(const s of t)s.showAll(i)})}};RR=vIe([F0(3,tt),F0(4,vt),F0(5,Ut),F0(6,pk),F0(7,gy)],RR);function CB(n,e){const t=RT(e,s=>s.original.startLineNumber<=n.lineNumber);if(!t)return N.fromPositions(n);if(t.original.endLineNumberExclusive<=n.lineNumber){const s=n.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return N.fromPositions(new V(s,n.column))}if(!t.innerChanges)return N.fromPositions(new V(t.modified.startLineNumber,1));const i=RT(t.innerChanges,s=>s.originalRange.getStartPosition().isBeforeOrEqual(n));if(!i){const s=n.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return N.fromPositions(new V(s,n.column))}if(i.originalRange.containsPosition(n))return i.modifiedRange;{const s=yIe(i.originalRange.getEndPosition(),n);return N.fromPositions(wIe(i.modifiedRange.getEndPosition(),s))}}function yIe(n,e){return n.lineNumber===e.lineNumber?new cv(0,e.column-n.column):new cv(e.lineNumber-n.lineNumber,e.column-1)}function wIe(n,e){return e.lineCount===0?new V(n.lineNumber,n.column+e.columnCount):new V(n.lineNumber+e.lineCount,e.columnCount+1)}function CIe(n){return n.mappings.map(e=>{const t=e.lineRangeMapping;let i,s,o,r,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,s=0,a=void 0):(i=t.original.startLineNumber,s=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(o=t.modified.startLineNumber-1,r=0,a=void 0):(o=t.modified.startLineNumber,r=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:s,modifiedStartLineNumber:o,modifiedEndLineNumber:r,charChanges:a==null?void 0:a.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var K3=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},$t=function(n,e){return function(t,i){e(t,i,n)}};let SIe=0,SB=!1;function xIe(n){if(!n){if(SB)return;SB=!0}Cbe(n||document.body)}let Yx=class extends Im{constructor(e,t,i,s,o,r,a,l,c,d,u,h){const f=Object.assign({},t);f.ariaLabel=f.ariaLabel||Sx.editorViewAccessibleLabel,f.ariaLabel=f.ariaLabel+";"+Sx.accessibilityHelpMessage,super(e,f,{},i,s,o,r,l,c,d,u,h),a instanceof Fm?this._standaloneKeybindingService=a:this._standaloneKeybindingService=null,xIe(f.ariaContainerElement)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const s="DYNAMIC_"+ ++SIe,o=Le.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(s,e,t,o),s}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Y.None;const t=e.id,i=e.label,s=Le.and(Le.equals("editorId",this.getId()),Le.deserialize(e.precondition)),o=e.keybindings,r=Le.and(s,Le.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),d=new pe,u=this.getId()+":"+t;if(d.add(Kt.registerCommand(u,c)),a){const f={command:{id:u,title:i},when:s,group:a,order:l};d.add(rr.appendMenuItem(I.EditorContext,f))}if(Array.isArray(o))for(const f of o)d.add(this._standaloneKeybindingService.addDynamicKeybinding(u,f,c,r));const h=new qq(u,i,i,s,(...f)=>Promise.resolve(e.run(this,...f)),this._contextKeyService);return this._actions.set(t,h),d.add(Ze(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof bx)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};Yx=K3([$t(2,vt),$t(3,Ut),$t(4,fs),$t(5,tt),$t(6,bi),$t(7,ao),$t(8,Ln),$t(9,Du),$t(10,oo),$t(11,nt)],Yx);let MR=class extends Yx{constructor(e,t,i,s,o,r,a,l,c,d,u,h,f,g,p){const _=Object.assign({},t);Hx(d,_,!1);const v=l.registerEditorContainer(e);typeof _.theme=="string"&&l.setTheme(_.theme),typeof _.autoDetectHighContrast<"u"&&l.setAutoDetectHighContrast(!!_.autoDetectHighContrast);const b=_.model;delete _.model,super(e,_,i,s,o,r,a,l,c,u,g,p),this._configurationService=d,this._standaloneThemeService=l,this._register(v);let y;if(typeof b>"u"){const w=f.getLanguageIdByMimeType(_.language)||_.language||zo;y=XK(h,f,_.value||"",w,void 0),this._ownsModel=!0}else y=b,this._ownsModel=!1;if(this._attachModel(y),y){const w={oldModelUrl:null,newModelUrl:y.uri};this._onDidChangeModel.fire(w)}}dispose(){super.dispose()}updateOptions(e){Hx(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};MR=K3([$t(2,vt),$t(3,Ut),$t(4,fs),$t(5,tt),$t(6,bi),$t(7,kr),$t(8,Ln),$t(9,ti),$t(10,Du),$t(11,hs),$t(12,Ai),$t(13,oo),$t(14,nt)],MR);let PR=class extends RR{constructor(e,t,i,s,o,r,a,l,c,d,u,h){const f=Object.assign({},t);Hx(l,f,!0);const g=r.registerEditorContainer(e);typeof f.theme=="string"&&r.setTheme(f.theme),typeof f.autoDetectHighContrast<"u"&&r.setAutoDetectHighContrast(!!f.autoDetectHighContrast),super(e,f,{},s,i,o,h,d),this._configurationService=l,this._standaloneThemeService=r,this._register(g)}dispose(){super.dispose()}updateOptions(e){Hx(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(Yx,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};PR=K3([$t(2,vt),$t(3,tt),$t(4,Ut),$t(5,kr),$t(6,Ln),$t(7,ti),$t(8,Au),$t(9,gy),$t(10,Sy),$t(11,pk)],PR);function XK(n,e,t,i,s){if(t=t||"",!i){const o=t.indexOf(`
`);let r=t;return o!==-1&&(r=t.substring(0,o)),xB(n,t,e.createByFilepathOrFirstLine(s||null,r),s)}return xB(n,t,e.createById(i),s)}function xB(n,e,t,i){return n.createModel(e,t,i)}var QK=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function LIe(n,e,t){return Ie.initialize(t||{}).createInstance(MR,n,e)}function DIe(n){return Ie.get(Ut).onCodeEditorAdd(t=>{n(t)})}function kIe(n){return Ie.get(Ut).onDiffEditorAdd(t=>{n(t)})}function EIe(){return Ie.get(Ut).listCodeEditors()}function AIe(){return Ie.get(Ut).listDiffEditors()}function IIe(n,e,t){return Ie.initialize(t||{}).createInstance(PR,n,e)}function TIe(n){if(typeof n.id!="string"||typeof n.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return Kt.registerCommand(n.id,n.run)}function NIe(n){if(typeof n.id!="string"||typeof n.label!="string"||typeof n.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=Le.deserialize(n.precondition),t=(s,...o)=>Cr.runEditorCommand(s,o,e,(r,a,l)=>Promise.resolve(n.run(a,...l))),i=new pe;if(i.add(Kt.registerCommand(n.id,t)),n.contextMenuGroupId){const s={command:{id:n.id,title:n.label},when:e,group:n.contextMenuGroupId,order:n.contextMenuOrder||0};i.add(rr.appendMenuItem(I.EditorContext,s))}if(Array.isArray(n.keybindings)){const s=Ie.get(bi);if(!(s instanceof Fm))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const o=Le.and(e,Le.deserialize(n.keybindingContext));i.add(s.addDynamicKeybindings(n.keybindings.map(r=>({keybinding:r,command:n.id,when:o}))))}}return i}function RIe(n){return JK([n])}function JK(n){const e=Ie.get(bi);return e instanceof Fm?e.addDynamicKeybindings(n.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:Le.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),Y.None)}function MIe(n,e,t){const i=Ie.get(Ai),s=i.getLanguageIdByMimeType(e)||e;return XK(Ie.get(hs),i,n,s,t)}function PIe(n,e){const t=Ie.get(Ai),i=t.getLanguageIdByMimeType(e)||e||zo;n.setLanguage(t.createById(i))}function OIe(n,e,t){n&&Ie.get(dl).changeOne(e,n.uri,t)}function FIe(n){Ie.get(dl).changeAll(n,[])}function BIe(n){return Ie.get(dl).read(n)}function WIe(n){return Ie.get(dl).onMarkerChanged(n)}function VIe(n){return Ie.get(hs).getModel(n)}function zIe(){return Ie.get(hs).getModels()}function HIe(n){return Ie.get(hs).onModelAdded(n)}function $Ie(n){return Ie.get(hs).onModelRemoved(n)}function UIe(n){return Ie.get(hs).onModelLanguageChanged(t=>{n({model:t.model,oldLanguage:t.oldLanguageId})})}function jIe(n){return Y_e(Ie.get(hs),Ie.get(oo),n)}function qIe(n,e){const t=Ie.get(Ai),i=Ie.get(kr);return LP.colorizeElement(i,t,n,e).then(()=>{i.registerEditorContainer(n)})}function GIe(n,e,t){const i=Ie.get(Ai);return Ie.get(kr).registerEditorContainer(document.body),LP.colorize(i,n,e,t)}function KIe(n,e,t=4){return Ie.get(kr).registerEditorContainer(document.body),LP.colorizeModelLine(n,e,t)}function YIe(n){const e=Si.get(n);return e||{getInitialState:()=>Kb,tokenize:(t,i,s)=>eq(n,s)}}function ZIe(n,e){Si.getOrCreate(e);const t=YIe(e),i=Pf(n),s=[];let o=t.getInitialState();for(let r=0,a=i.length;r<a;r++){const l=i[r],c=t.tokenize(l,!0,o);s[r]=c.tokens,o=c.endState}return s}function XIe(n,e){Ie.get(kr).defineTheme(n,e)}function QIe(n){Ie.get(kr).setTheme(n)}function JIe(){bT.clearAllFontInfos()}function eTe(n,e){return Kt.registerCommand({id:n,handler:e})}function tTe(n){return Ie.get(Sc).registerOpener({open(t){return QK(this,void 0,void 0,function*(){return typeof t=="string"&&(t=je.parse(t)),n.open(t)})}})}function iTe(n){return Ie.get(Ut).registerCodeEditorOpenHandler((t,i,s)=>QK(this,void 0,void 0,function*(){var o;if(!i)return null;const r=(o=t.options)===null||o===void 0?void 0:o.selection;let a;return r&&typeof r.endLineNumber=="number"&&typeof r.endColumn=="number"?a=r:r&&(a={lineNumber:r.startLineNumber,column:r.startColumn}),(yield n.openCodeEditor(i,t.resource,a))?i:null}))}function nTe(){return{create:LIe,getEditors:EIe,getDiffEditors:AIe,onDidCreateEditor:DIe,onDidCreateDiffEditor:kIe,createDiffEditor:IIe,addCommand:TIe,addEditorAction:NIe,addKeybindingRule:RIe,addKeybindingRules:JK,createModel:MIe,setModelLanguage:PIe,setModelMarkers:OIe,getModelMarkers:BIe,removeAllMarkers:FIe,onDidChangeMarkers:WIe,getModels:zIe,getModel:VIe,onDidCreateModel:HIe,onWillDisposeModel:$Ie,onDidChangeModelLanguage:UIe,createWebWorker:jIe,colorizeElement:qIe,colorize:GIe,colorizeModelLine:KIe,tokenize:ZIe,defineTheme:XIe,setTheme:QIe,remeasureFonts:JIe,registerCommand:eTe,registerLinkOpener:tTe,registerEditorOpener:iTe,AccessibilitySupport:II,ContentWidgetPositionPreference:OI,CursorChangeReason:FI,DefaultEndOfLine:BI,EditorAutoIndentStrategy:VI,EditorOption:zI,EndOfLinePreference:HI,EndOfLineSequence:$I,MinimapPosition:QI,MouseTargetType:JI,OverlayWidgetPositionPreference:eT,OverviewRulerLane:tT,GlyphMarginLane:UI,RenderLineNumbersType:nT,RenderMinimap:sT,ScrollbarVisibility:rT,ScrollType:oT,TextEditorCursorBlinkingStyle:uT,TextEditorCursorStyle:hT,TrackedRangeStickiness:fT,WrappingIndent:gT,InjectedTextCursorStops:qI,PositionAffinity:iT,ConfigurationChangedEvent:AU,BareFontInfo:$h,FontInfo:_T,TextModelResolvedOptions:EC,FindMatch:$b,ApplyUpdateResult:k_,EditorZoom:Gc,EditorType:OD,EditorOptions:Nf}}function sTe(n,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!n(t))return!1;return!0}function Uw(n,e){return typeof n=="boolean"?n:e}function LB(n,e){return typeof n=="string"?n:e}function oTe(n){const e={};for(const t of n)e[t]=!0;return e}function DB(n,e=!1){e&&(n=n.map(function(i){return i.toLowerCase()}));const t=oTe(n);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function OR(n,e){e=e.replace(/@@/g,"");let t=0,i;do i=!1,e=e.replace(/@(\w+)/g,function(o,r){i=!0;let a="";if(typeof n[r]=="string")a=n[r];else if(n[r]&&n[r]instanceof RegExp)a=n[r].source;else throw n[r]===void 0?Vt(n,"language definition does not contain attribute '"+r+"', used at: "+e):Vt(n,"attribute reference '"+r+"' must be a string, used at: "+e);return xg(a)?"":"(?:"+a+")"}),t++;while(i&&t<5);e=e.replace(/\x01/g,"@");const s=(n.ignoreCase?"i":"")+(n.unicode?"u":"");return new RegExp(e,s)}function rTe(n,e,t,i){if(i<0)return n;if(i<e.length)return e[i];if(i>=100){i=i-100;const s=t.split(".");if(s.unshift(t),i<s.length)return s[i]}return null}function aTe(n,e,t,i){let s=-1,o=t,r=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);r&&(r[3]&&(s=parseInt(r[3]),r[2]&&(s=s+100)),o=r[4]);let a="~",l=o;!o||o.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(r=o.match(/^(@|!@|~|!~|==|!=)(.*)$/),r&&(a=r[1],l=r[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=DB(l.split("|"),n.ignoreCase);c=function(u){return a==="~"?d(u):!d(u)}}else if(a==="@"||a==="!@"){const d=n[l];if(!d)throw Vt(n,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!sTe(function(h){return typeof h=="string"},d))throw Vt(n,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const u=DB(d,n.ignoreCase);c=function(h){return a==="@"?u(h):!u(h)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=OR(n,"^"+l+"$");c=function(u){return a==="~"?d.test(u):!d.test(u)}}else c=function(d,u,h,f){return OR(n,"^"+Kc(n,l,u,h,f)+"$").test(d)};else if(l.indexOf("$")<0){const d=kd(n,l);c=function(u){return a==="=="?u===d:u!==d}}else{const d=kd(n,l);c=function(u,h,f,g,p){const _=Kc(n,d,h,f,g);return a==="=="?u===_:u!==_}}return s===-1?{name:t,value:i,test:function(d,u,h,f){return c(d,d,u,h,f)}}:{name:t,value:i,test:function(d,u,h,f){const g=rTe(d,u,h,s);return c(g||"",d,u,h,f)}}}function FR(n,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw Vt(n,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw Vt(n,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw Vt(n,"the next state must be a string value in rule: "+e);{let s=t.next;if(!/^(@pop|@push|@popall)$/.test(s)&&(s[0]==="@"&&(s=s.substr(1)),s.indexOf("$")<0&&!gbe(n,Kc(n,s,"",[],""))))throw Vt(n,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=s}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,n.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let s=0,o=t.length;s<o;s++)i[s]=FR(n,e,t[s]);return{group:i}}else if(t.cases){const i=[];for(const o in t.cases)if(t.cases.hasOwnProperty(o)){const r=FR(n,e,t.cases[o]);o==="@default"||o==="@"||o===""?i.push({test:void 0,value:r,name:o}):o==="@eos"?i.push({test:function(a,l,c,d){return d},value:r,name:o}):i.push(aTe(n,e,o,r))}const s=n.defaultToken;return{test:function(o,r,a,l){for(const c of i)if(!c.test||c.test(o,r,a,l))return c.value;return s}}}else throw Vt(n,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class lTe{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw Vt(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=OR(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=FR(e,this.name,t)}}function eY(n,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={};t.languageId=n,t.includeLF=Uw(e.includeLF,!1),t.noThrow=!1,t.maxStack=100,t.start=typeof e.start=="string"?e.start:null,t.ignoreCase=Uw(e.ignoreCase,!1),t.unicode=Uw(e.unicode,!1),t.tokenPostfix=LB(e.tokenPostfix,"."+t.languageId),t.defaultToken=LB(e.defaultToken,"source"),t.usesEmbedded=!1;const i=e;i.languageId=n,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function s(r,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw Vt(t,"an 'include' attribute must be a string at: "+r);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw Vt(t,"include target '"+d+"' is not defined at: "+r);s(r+"."+d,a,e.tokenizer[d])}else{const u=new lTe(r);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(u.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")u.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const h=c[1];h.next=c[2],u.setAction(i,h)}else throw Vt(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+r);else u.setAction(i,c[1]);else{if(!c.regex)throw Vt(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+r);c.name&&typeof c.name=="string"&&(u.name=c.name),c.matchOnlyAtStart&&(u.matchOnlyAtLineStart=Uw(c.matchOnlyAtLineStart,!1)),u.setRegex(i,c.regex),u.setAction(i,c.action)}a.push(u)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw Vt(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const r in e.tokenizer)if(e.tokenizer.hasOwnProperty(r)){t.start||(t.start=r);const a=e.tokenizer[r];t.tokenizer[r]=new Array,s("tokenizer."+r,t.tokenizer[r],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw Vt(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const o=[];for(const r of e.brackets){let a=r;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw Vt(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")o.push({token:a.token+t.tokenPostfix,open:kd(t,a.open),close:kd(t,a.close)});else throw Vt(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=o,t.noThrow=!0,t}var cTe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function dTe(n){vm.registerLanguage(n)}function uTe(){let n=[];return n=n.concat(vm.getLanguages()),n}function hTe(n){return Ie.get(Ai).languageIdCodec.encodeLanguageId(n)}function fTe(n,e){return Ie.withServices(()=>{const i=Ie.get(Ai).onDidRequestRichLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function gTe(n,e){return Ie.withServices(()=>{const i=Ie.get(Ai).onDidRequestBasicLanguageFeatures(s=>{s===n&&(i.dispose(),e())});return i})}function pTe(n,e){if(!Ie.get(Ai).isRegisteredLanguageId(n))throw new Error(`Cannot set configuration for unknown language ${n}`);return Ie.get(oo).register(n,e,100)}class mTe{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return Tv.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const s=this._actual.tokenizeEncoded(e,i);return new fD(s.tokens,s.endState)}}class Tv{constructor(e,t,i,s){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=s}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let s=0;for(let o=0,r=e.length;o<r;o++){const a=e[o];let l=a.startIndex;o===0?l=0:l<s&&(l=s),i[o]=new Mb(l,a.scopes,t),s=l}return i}static adaptTokenize(e,t,i,s){const o=t.tokenize(i,s),r=Tv._toClassicTokens(o.tokens,e);let a;return o.endState.equals(s)?a=s:a=o.endState,new Z4(r,a)}tokenize(e,t,i){return Tv.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),s=this._standaloneThemeService.getColorTheme().tokenTheme,o=[];let r=0,a=0;for(let c=0,d=t.length;c<d;c++){const u=t[c],h=s.match(i,u.scopes)|1024;if(r>0&&o[r-1]===h)continue;let f=u.startIndex;c===0?f=0:f<a&&(f=a),o[r++]=f,o[r++]=h,a=f}const l=new Uint32Array(r);for(let c=0;c<r;c++)l[c]=o[c];return l}tokenizeEncoded(e,t,i){const s=this._actual.tokenize(e,i),o=this._toBinaryTokens(this._languageService.languageIdCodec,s.tokens);let r;return s.endState.equals(i)?r=i:r=s.endState,new fD(o,r)}}function _Te(n){return typeof n.getInitialState=="function"}function bTe(n){return"tokenizeEncoded"in n}function tY(n){return n&&typeof n.then=="function"}function vTe(n){const e=Ie.get(kr);if(n){const t=[null];for(let i=1,s=n.length;i<s;i++)t[i]=z.fromHex(n[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function iY(n,e){return bTe(e)?new mTe(n,e):new Tv(n,e,Ie.get(Ai),Ie.get(kr))}function Y3(n,e){const t=new Vge(()=>cTe(this,void 0,void 0,function*(){const i=yield Promise.resolve(e.create());return i?_Te(i)?iY(n,i):new Xb(Ie.get(Ai),Ie.get(kr),n,eY(n,i),Ie.get(ti)):null}));return Si.registerFactory(n,t)}function yTe(n,e){if(!Ie.get(Ai).isRegisteredLanguageId(n))throw new Error(`Cannot set tokens provider for unknown language ${n}`);return tY(e)?Y3(n,{create:()=>e}):Si.register(n,iY(n,e))}function wTe(n,e){const t=i=>new Xb(Ie.get(Ai),Ie.get(kr),n,eY(n,i),Ie.get(ti));return tY(e)?Y3(n,{create:()=>e}):Si.register(n,t(e))}function CTe(n,e){return Ie.get(nt).referenceProvider.register(n,e)}function STe(n,e){return Ie.get(nt).renameProvider.register(n,e)}function xTe(n,e){return Ie.get(nt).signatureHelpProvider.register(n,e)}function LTe(n,e){return Ie.get(nt).hoverProvider.register(n,{provideHover:(i,s,o)=>{const r=i.getWordAtPosition(s);return Promise.resolve(e.provideHover(i,s,o)).then(a=>{if(a)return!a.range&&r&&(a.range=new N(s.lineNumber,r.startColumn,s.lineNumber,r.endColumn)),a.range||(a.range=new N(s.lineNumber,s.column,s.lineNumber,s.column)),a})}})}function DTe(n,e){return Ie.get(nt).documentSymbolProvider.register(n,e)}function kTe(n,e){return Ie.get(nt).documentHighlightProvider.register(n,e)}function ETe(n,e){return Ie.get(nt).linkedEditingRangeProvider.register(n,e)}function ATe(n,e){return Ie.get(nt).definitionProvider.register(n,e)}function ITe(n,e){return Ie.get(nt).implementationProvider.register(n,e)}function TTe(n,e){return Ie.get(nt).typeDefinitionProvider.register(n,e)}function NTe(n,e){return Ie.get(nt).codeLensProvider.register(n,e)}function RTe(n,e,t){return Ie.get(nt).codeActionProvider.register(n,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,documentation:t==null?void 0:t.documentation,provideCodeActions:(s,o,r,a)=>{const c=Ie.get(dl).read({resource:s.uri}).filter(d=>N.areIntersectingOrTouching(d,o));return e.provideCodeActions(s,o,{markers:c,only:r.only,trigger:r.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function MTe(n,e){return Ie.get(nt).documentFormattingEditProvider.register(n,e)}function PTe(n,e){return Ie.get(nt).documentRangeFormattingEditProvider.register(n,e)}function OTe(n,e){return Ie.get(nt).onTypeFormattingEditProvider.register(n,e)}function FTe(n,e){return Ie.get(nt).linkProvider.register(n,e)}function BTe(n,e){return Ie.get(nt).completionProvider.register(n,e)}function WTe(n,e){return Ie.get(nt).colorProvider.register(n,e)}function VTe(n,e){return Ie.get(nt).foldingRangeProvider.register(n,e)}function zTe(n,e){return Ie.get(nt).declarationProvider.register(n,e)}function HTe(n,e){return Ie.get(nt).selectionRangeProvider.register(n,e)}function $Te(n,e){return Ie.get(nt).documentSemanticTokensProvider.register(n,e)}function UTe(n,e){return Ie.get(nt).documentRangeSemanticTokensProvider.register(n,e)}function jTe(n,e){return Ie.get(nt).inlineCompletionsProvider.register(n,e)}function qTe(n,e){return Ie.get(nt).inlayHintsProvider.register(n,e)}function GTe(){return{register:dTe,getLanguages:uTe,onLanguage:fTe,onLanguageEncountered:gTe,getEncodedLanguageId:hTe,setLanguageConfiguration:pTe,setColorMap:vTe,registerTokensProviderFactory:Y3,setTokensProvider:yTe,setMonarchTokensProvider:wTe,registerReferenceProvider:CTe,registerRenameProvider:STe,registerCompletionItemProvider:BTe,registerSignatureHelpProvider:xTe,registerHoverProvider:LTe,registerDocumentSymbolProvider:DTe,registerDocumentHighlightProvider:kTe,registerLinkedEditingRangeProvider:ETe,registerDefinitionProvider:ATe,registerImplementationProvider:ITe,registerTypeDefinitionProvider:TTe,registerCodeLensProvider:NTe,registerCodeActionProvider:RTe,registerDocumentFormattingEditProvider:MTe,registerDocumentRangeFormattingEditProvider:PTe,registerOnTypeFormattingEditProvider:OTe,registerLinkProvider:FTe,registerColorProvider:WTe,registerFoldingRangeProvider:VTe,registerDeclarationProvider:zTe,registerSelectionRangeProvider:HTe,registerDocumentSemanticTokensProvider:$Te,registerDocumentRangeSemanticTokensProvider:UTe,registerInlineCompletionsProvider:jTe,registerInlayHintsProvider:qTe,DocumentHighlightKind:WI,CompletionItemKind:RI,CompletionItemTag:MI,CompletionItemInsertTextRule:NI,SymbolKind:cT,SymbolTag:dT,IndentAction:jI,CompletionTriggerKind:PI,SignatureHelpTriggerKind:lT,InlayHintKind:GI,InlineCompletionTriggerKind:KI,CodeActionTriggerType:TI,FoldingRangeKind:as,SelectedSuggestionInfo:Bge}}const Z3=at("IEditorCancelService"),nY=new _e("cancellableOperation",!1,m("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));ht(Z3,class{constructor(){this._tokens=new WeakMap}add(n,e){let t=this._tokens.get(n);t||(t=n.invokeWithinContext(s=>{const o=nY.bindTo(s.get(tt)),r=new Ds;return{key:o,tokens:r}}),this._tokens.set(n,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(n){const e=this._tokens.get(n);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class KTe extends xr{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(Z3).add(e,this))}dispose(){this._unregister(),super.dispose()}}Ae(new class extends Cr{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:nY})}runEditorCommand(n,e){n.get(Z3).cancel(e)}});let YTe=class BR{constructor(e,t){if(this.flags=t,this.flags&1){const i=e.getModel();this.modelVersionId=i?Pb("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=e.getPosition():this.position=null,this.flags&2?this.selection=e.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof BR))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new BR(e,this.flags))}};class ZTe extends KTe{constructor(e,t,i,s){super(e,s),this._listener=new pe,t&4&&this._listener.add(e.onDidChangeCursorPosition(o=>{(!i||!N.containsPosition(i,o.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(o=>{(!i||!N.containsRange(i,o.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(o=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(o=>this.cancel())),this._listener.add(e.onDidChangeModelContent(o=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class XTe extends xr{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function sY(n){return n&&typeof n.getEditorType=="function"?n.getEditorType()===OD.ICodeEditor:!1}class kB{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class QTe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(kB.toKey(e))}has(e){return this._set.has(kB.toKey(e))}}var a0=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function JTe(n,e,t){const i=[],s=new QTe,o=n.ordered(t);for(const a of o)i.push(a),a.extensionId&&s.add(a.extensionId);const r=e.ordered(t);for(const a of r){if(a.extensionId){if(s.has(a.extensionId))continue;s.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,d){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,d)}})}return i}class Nv{static setFormatterSelector(e){return{dispose:Nv._selectors.unshift(e)}}static select(e,t,i){return a0(this,void 0,void 0,function*(){if(e.length===0)return;const s=dt.first(Nv._selectors);if(s)return yield s(e,t,i)})}}Nv._selectors=new Ds;function eNe(n,e,t,i,s,o){return a0(this,void 0,void 0,function*(){const r=e.documentRangeFormattingEditProvider.ordered(t);for(const a of r){const l=yield Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,s,o)).catch(bc);if(tc(l))return yield n.computeMoreMinimalEdits(t.uri,l)}})}function tNe(n,e,t,i,s){return a0(this,void 0,void 0,function*(){const o=JTe(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const r of o){const a=yield Promise.resolve(r.provideDocumentFormattingEdits(t,i,s)).catch(bc);if(tc(a))return yield n.computeMoreMinimalEdits(t.uri,a)}})}function iNe(n,e,t,i,s,o,r){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(s)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,s,o,r)).catch(bc).then(l=>n.computeMoreMinimalEdits(t.uri,l))}Kt.registerCommand("_executeFormatRangeProvider",function(n,...e){return a0(this,void 0,void 0,function*(){const[t,i,s]=e;xs(je.isUri(t)),xs(N.isIRange(i));const o=n.get(Cu),r=n.get(_y),a=n.get(nt),l=yield o.createModelReference(t);try{return eNe(r,a,l.object.textEditorModel,N.lift(i),s,rn.None)}finally{l.dispose()}})});Kt.registerCommand("_executeFormatDocumentProvider",function(n,...e){return a0(this,void 0,void 0,function*(){const[t,i]=e;xs(je.isUri(t));const s=n.get(Cu),o=n.get(_y),r=n.get(nt),a=yield s.createModelReference(t);try{return tNe(o,r,a.object.textEditorModel,i,rn.None)}finally{a.dispose()}})});Kt.registerCommand("_executeFormatOnTypeProvider",function(n,...e){return a0(this,void 0,void 0,function*(){const[t,i,s,o]=e;xs(je.isUri(t)),xs(V.isIPosition(i)),xs(typeof s=="string");const r=n.get(Cu),a=n.get(_y),l=n.get(nt),c=yield r.createModelReference(t);try{return iNe(a,l,c.object.textEditorModel,V.lift(i),s,o,rn.None)}finally{c.dispose()}})});Nf.wrappingIndent.defaultValue=0;Nf.glyphMargin.defaultValue=!1;Nf.autoIndent.defaultValue=3;Nf.overviewRulerLanes.defaultValue=2;Nv.setFormatterSelector((n,e,t)=>Promise.resolve(n[0]));const ps=jU();ps.editor=nTe();ps.languages=GTe();const nNe=ps.CancellationTokenSource,sNe=ps.Emitter,oNe=ps.KeyCode,rNe=ps.KeyMod,aNe=ps.Position,lNe=ps.Range,cNe=ps.Selection,dNe=ps.SelectionDirection,uNe=ps.MarkerSeverity,hNe=ps.MarkerTag,fNe=ps.Uri,gNe=ps.Token,oY=ps.editor,rY=ps.languages,zE=globalThis.MonacoEnvironment;(zE!=null&&zE.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=ps);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const pNe=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:nNe,Emitter:sNe,KeyCode:oNe,KeyMod:rNe,MarkerSeverity:uNe,MarkerTag:hNe,Position:aNe,Range:lNe,Selection:cNe,SelectionDirection:dNe,Token:gNe,Uri:fNe,editor:oY,languages:rY},Symbol.toStringTag,{value:"Module"})),mNe="#/definitions/RootSpec",_Ne="http://json-schema.org/draft-07/schema#",bNe={AggregateParams:{additionalProperties:!1,properties:{groupby:{description:"Which fields to use for grouping. Missing `groupby` results in a single group that includes all the data items.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"aggregate",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},Align:{enum:["left","center","right"],type:"string"},Axis:{additionalProperties:!1,properties:{domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},AxisGenomeData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to use"},type:{const:"axisGenome",type:"string"}},required:["type","channel"],type:"object"},AxisOrient:{enum:["top","bottom","left","right"],type:"string"},AxisTicksData:{additionalProperties:!1,properties:{axis:{$ref:"#/definitions/Axis",description:"Optional axis properties"},channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to listen to"},type:{const:"axisTicks",type:"string"}},required:["type","channel"],type:"object"},BamData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounce:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Debounce time for data updates, in milliseconds. Debouncing prevents excessive data updates when the user is zooming or panning around.\n\n__Default value:__ `200`"},debounceMode:{description:'The debounce mode for data updates. If set to `"domain"`, domain change events (panning and zooming) will be debounced. If set to `"window"`, the data fetches initiated by the changes to the visible window (or tile) will be debounced.  If your data is small, the `"window"` is better as it will start fetching data while the user is still panning around, resulting in a shorter perceived latency.\n\n__Default value:__ `"window"`',enum:["domain","window"],type:"string"},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".bai"`.',type:"string"},type:{const:"bam",type:"string"},url:{description:"URL of the BigBed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `10000`",type:"number"}},required:["type","url"],type:"object"},Baseline:{enum:["top","middle","bottom","alphabetic"],type:"string"},BigBedData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounce:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Debounce time for data updates, in milliseconds. Debouncing prevents excessive data updates when the user is zooming or panning around.\n\n__Default value:__ `200`"},debounceMode:{description:'The debounce mode for data updates. If set to `"domain"`, domain change events (panning and zooming) will be debounced. If set to `"window"`, the data fetches initiated by the changes to the visible window (or tile) will be debounced.  If your data is small, the `"window"` is better as it will start fetching data while the user is still panning around, resulting in a shorter perceived latency.\n\n__Default value:__ `"window"`',enum:["domain","window"],type:"string"},type:{const:"bigbed",type:"string"},url:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"URL of the BigBed file."},windowSize:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `1000000`"}},required:["type","url"],type:"object"},BigWigData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounce:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Debounce time for data updates, in milliseconds. Debouncing prevents excessive data updates when the user is zooming or panning around.\n\n__Default value:__ `200`"},debounceMode:{description:'The debounce mode for data updates. If set to `"domain"`, domain change events (panning and zooming) will be debounced. If set to `"window"`, the data fetches initiated by the changes to the visible window (or tile) will be debounced.  If your data is small, the `"window"` is better as it will start fetching data while the user is still panning around, resulting in a shorter perceived latency.\n\n__Default value:__ `"window"`',enum:["domain","window"],type:"string"},pixelsPerBin:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The approximate minimum width of each data bin, in pixels.\n\n__Default value:__ `2`"},type:{const:"bigwig",type:"string"},url:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"URL of the BigWig file."}},required:["type","url"],type:"object"},BindCheckbox:{additionalProperties:!1,properties:{debounce:{description:"If defined, delays event handling until the specified milliseconds have elapsed since the last event was fired.",type:"number"},description:{description:"An optional description or help text that is shown below the input element.",type:"string"},input:{const:"checkbox",type:"string"},name:{description:"By default, the parameter name is used to label input elements. This `name` property can be used instead to specify a custom label for the bound parameter.",type:"string"}},required:["input"],type:"object"},BindInput:{additionalProperties:!1,properties:{autocomplete:{description:"A hint for form autofill. See the [HTML autocomplete attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete) for additional information.",type:"string"},debounce:{description:"If defined, delays event handling until the specified milliseconds have elapsed since the last event was fired.",type:"number"},description:{description:"An optional description or help text that is shown below the input element.",type:"string"},input:{description:'The type of input element to use. The valid values are `"checkbox"`, `"radio"`, `"range"`, `"select"`, `"text"`, `"number"`, and `"color"`.',enum:["text","number","color"],type:"string"},name:{description:"By default, the parameter name is used to label input elements. This `name` property can be used instead to specify a custom label for the bound parameter.",type:"string"},placeholder:{description:"Text that appears in the form control when it has no value set.",type:"string"}},type:"object"},BindRadioSelect:{additionalProperties:!1,properties:{debounce:{description:"If defined, delays event handling until the specified milliseconds have elapsed since the last event was fired.",type:"number"},description:{description:"An optional description or help text that is shown below the input element.",type:"string"},input:{enum:["radio","select"],type:"string"},labels:{description:"An array of label strings to represent the `options` values. If unspecified, the `options` value will be coerced to a string and used as the label.",items:{type:"string"},type:"array"},name:{description:"By default, the parameter name is used to label input elements. This `name` property can be used instead to specify a custom label for the bound parameter.",type:"string"},options:{description:"An array of options to select from.",items:{},type:"array"}},required:["input","options"],type:"object"},BindRange:{additionalProperties:!1,properties:{debounce:{description:"If defined, delays event handling until the specified milliseconds have elapsed since the last event was fired.",type:"number"},description:{description:"An optional description or help text that is shown below the input element.",type:"string"},input:{const:"range",type:"string"},max:{description:"Sets the maximum slider value. Defaults to the larger of the signal value and `100`.",type:"number"},min:{description:"Sets the minimum slider value. Defaults to the smaller of the signal value and `0`.",type:"number"},name:{description:"By default, the parameter name is used to label input elements. This `name` property can be used instead to specify a custom label for the bound parameter.",type:"string"},step:{description:"Sets the minimum slider increment. If undefined, the step size will be automatically determined based on the `min` and `max` values.",type:"number"}},required:["input"],type:"object"},Binding:{anyOf:[{$ref:"#/definitions/BindCheckbox"},{$ref:"#/definitions/BindRadioSelect"},{$ref:"#/definitions/BindRange"},{$ref:"#/definitions/BindInput"}]},ChannelWithScale:{anyOf:[{$ref:"#/definitions/PositionalChannel"},{const:"color",type:"string"},{const:"fill",type:"string"},{const:"stroke",type:"string"},{const:"opacity",type:"string"},{const:"fillOpacity",type:"string"},{const:"strokeOpacity",type:"string"},{const:"strokeWidth",type:"string"},{const:"size",type:"string"},{const:"shape",type:"string"},{const:"angle",type:"string"},{const:"dx",type:"string"},{const:"dy",type:"string"}]},ChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{const:"locus",type:"string"}},required:["chrom","type"],type:"object"},ChromosomalLocus:{additionalProperties:!1,properties:{chrom:{description:'The name of the chromosome. For example: `"chr1"`, `"CHR1"`, or `"1"`.',type:"string"},pos:{description:"The zero-based position inside the chromosome or contig.",type:"number"}},required:["chrom"],type:"object"},CollectParams:{additionalProperties:!1,properties:{groupby:{description:"Arranges the data into consecutive batches based on the groups. This is mainly intended for internal use so that faceted data can be handled as batches.",items:{$ref:"#/definitions/Field"},type:"array"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order."},type:{const:"collect",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},ColorDef:{$ref:"#/definitions/MarkPropDef%3C(string%7Cnull)%3E"},CompareParams:{additionalProperties:!1,properties:{field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to sort by"},order:{anyOf:[{items:{$ref:"#/definitions/SortOrder"},type:"array"},{$ref:"#/definitions/SortOrder"}],description:'The order(s) to use: `"ascending"` (default), `"descending"`.'}},required:["field"],type:"object"},ComplexDomain:{description:"A complex domain that needs to be converted into a scalar domain before it is assigned to a scale.",items:{$ref:"#/definitions/ChromosomalLocus"},type:"array"},ConcatSpec:{additionalProperties:!1,properties:{baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},columns:{description:"The number of columns in the grid.",type:"number"},concat:{description:"Specifies views that will be concatenated into a grid that wraps when the specified number of columns are used.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["concat","columns"],type:"object"},"Conditional<DatumDef>":{$ref:"#/definitions/ConditionalParameter%3CDatumDef%3E"},"Conditional<FieldDef>":{$ref:"#/definitions/ConditionalParameter%3CFieldDef%3E"},"Conditional<ValueDef<(number|ExprRef)>>":{$ref:"#/definitions/ConditionalParameter%3CValueDef%3C(number%7CExprRef)%3E%3E"},"Conditional<ValueDef<(string|null|ExprRef)>>":{$ref:"#/definitions/ConditionalParameter%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},"ConditionalParameter<DatumDef>":{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},empty:{description:"For selection parameters, the predicate of empty selections returns true by default. Override this behavior, by setting this property `empty: false`.",type:"boolean"},param:{description:"Filter using a parameter name.",type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["param"],type:"object"},"ConditionalParameter<FieldDef>":{anyOf:[{additionalProperties:!1,properties:{empty:{description:"For selection parameters, the predicate of empty selections returns true by default. Override this behavior, by setting this property `empty: false`.",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},param:{description:"Filter using a parameter name.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},required:["param"],type:"object"},{additionalProperties:!1,properties:{empty:{description:"For selection parameters, the predicate of empty selections returns true by default. Override this behavior, by setting this property `empty: false`.",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},param:{description:"Filter using a parameter name.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["param","type"],type:"object"}]},"ConditionalParameter<ValueDef<(number|ExprRef)>>":{additionalProperties:!1,properties:{empty:{description:"For selection parameters, the predicate of empty selections returns true by default. Override this behavior, by setting this property `empty: false`.",type:"boolean"},param:{description:"Filter using a parameter name.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},required:["param","value"],type:"object"},"ConditionalParameter<ValueDef<(string|null|ExprRef)>>":{additionalProperties:!1,properties:{empty:{description:"For selection parameters, the predicate of empty selections returns true by default. Override this behavior, by setting this property `empty: false`.",type:"boolean"},param:{description:"Filter using a parameter name.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"string"},{type:"null"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},required:["param","value"],type:"object"},Contig:{additionalProperties:!1,properties:{name:{type:"string"},size:{type:"number"}},required:["name","size"],type:"object"},CoverageParams:{additionalProperties:!1,properties:{as:{description:"The output field for the computed coverage.",type:"string"},asChrom:{description:"The output field for the chromosome.\n\n**Default:** Same as `chrom`",type:"string"},asEnd:{description:"The output field for the end coordinate.\n\n**Default:** Same as `end`",type:"string"},asStart:{description:"The output field for the start coordinate.\n\n**Default:** Same as `start`",type:"string"},chrom:{$ref:"#/definitions/Field",description:"An optional chromosome field that is passed through. TODO: groupby"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"coverage",description:"The type of the transform to be applied",type:"string"},weight:{$ref:"#/definitions/Field",description:"A field representing an optional weight for the segment. Can be used with copy ratios, for example."}},required:["end","start","type"],type:"object"},CsvDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',enum:["csv","tsv"],type:"string"}},type:"object"},Data:{anyOf:[{$ref:"#/definitions/DataSource"},{$ref:"#/definitions/Generator"}]},DataFormat:{anyOf:[{$ref:"#/definitions/CsvDataFormat"},{$ref:"#/definitions/DsvDataFormat"},{$ref:"#/definitions/JsonDataFormat"},{$ref:"#/definitions/OtherDataFormat"}]},DataSource:{anyOf:[{$ref:"#/definitions/UrlData"},{$ref:"#/definitions/InlineData"},{$ref:"#/definitions/NamedData"},{$ref:"#/definitions/DynamicCallbackData"},{$ref:"#/definitions/LazyData"}]},DsvDataFormat:{additionalProperties:!1,properties:{delimiter:{description:"The delimiter between records. The delimiter must be a single character (i.e., a single 16-bit code unit); so, ASCII delimiters are fine, but emoji delimiters are not.",maxLength:1,minLength:1,type:"string"},parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{const:"dsv",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},required:["delimiter"],type:"object"},DynamicCallbackData:{additionalProperties:!1,properties:{dynamicCallbackSource:{description:"The View class has `getDynamicData()` methods that provides the data. This is intended for internal use.",type:"boolean"},format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["dynamicCallbackSource"],type:"object"},DynamicOpacity:{additionalProperties:!1,description:"DynamicOpacity specifies a zoom-dependent behavior for view opacity. The opacity is interpolated between the specified stops.",properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel"},unitsPerPixel:{description:"Stops expressed as units (base pairs, for example) per pixel.",items:{type:"number"},type:"array"},values:{description:"Opacity values that match the given stops.",items:{type:"number"},type:"array"}},required:["unitsPerPixel","values"],type:"object"},Encoding:{additionalProperties:!1,properties:{angle:{$ref:"#/definitions/NumericMarkPropDef",description:"Rotation angle of point and text marks."},color:{$ref:"#/definitions/ColorDef",description:"Color of the marks  either fill or stroke color based on  the `filled` property of mark definition.\n\n_Note:_ 1) For fine-grained control over both fill and stroke colors of the marks, please use the `fill` and `stroke` channels. The `fill` or `stroke` encodings have higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified. 2) See the scale documentation for more information about customizing [color scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme)."},dx:{$ref:"#/definitions/NumericMarkPropDef"},dy:{$ref:"#/definitions/NumericMarkPropDef"},facetIndex:{$ref:"#/definitions/FieldDefWithoutScale",description:"For internal use"},fill:{$ref:"#/definitions/ColorDef",description:"Fill color of the marks.\n\n_Note:_ The `fill` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},fillOpacity:{$ref:"#/definitions/NumericMarkPropDef",description:"Fill opacity of the marks."},opacity:{$ref:"#/definitions/NumericMarkPropDef",description:"Opacity of the marks."},sample:{$ref:"#/definitions/FieldDefWithoutScale",description:"Facet identifier for interactive filtering, sorting, and grouping in the App."},search:{$ref:"#/definitions/FieldDefWithoutScale"},semanticScore:{$ref:"#/definitions/FieldDefWithoutScale"},shape:{$ref:"#/definitions/ShapeDef",description:'Shape of the mark.\n\nFor `point` marks the supported values include:\n- plotting shapes: `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, or `"triangle-left"`.\n- centered directional shape `"triangle"`'},size:{$ref:"#/definitions/NumericMarkPropDef",description:'Size of the mark.\n- For `"point"`  the symbol size, or pixel area of the mark.\n- For `"text"`  the text\'s font size.'},stroke:{$ref:"#/definitions/ColorDef",description:"Stroke color of the marks.\n\n_Note:_ The `stroke` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},strokeOpacity:{$ref:"#/definitions/NumericMarkPropDef",description:"Stroke opacity of the marks."},strokeWidth:{$ref:"#/definitions/NumericMarkPropDef",description:"Stroke width of the marks."},text:{$ref:"#/definitions/TextDef",description:"Text of the `text` mark."},uniqueId:{$ref:"#/definitions/FieldDefWithoutScale",description:"For internal use"},x:{anyOf:[{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},buildIndex:{description:"Builds and index for efficient rendering of subsets of the data. This setting is useful when rendering large amounts of data and often only a small subset of the data is visible. An example of such a situation is a scatter plot spanning the whole genome.\n\nThis setting implicitly sorts the data by the field assigned on the `x` channel.",type:"boolean"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},buildIndex:{description:"Builds and index for efficient rendering of subsets of the data. This setting is useful when rendering large amounts of data and often only a small subset of the data is visible. An example of such a situation is a scatter plot spanning the whole genome.\n\nThis setting implicitly sorts the data by the field assigned on the `x` channel.",type:"boolean"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{const:"locus",type:"string"}},required:["chrom","type"],type:"object"},{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},buildIndex:{description:"Builds and index for efficient rendering of subsets of the data. This setting is useful when rendering large amounts of data and often only a small subset of the data is visible. An example of such a situation is a scatter plot spanning the whole genome.\n\nThis setting implicitly sorts the data by the field assigned on the `x` channel.",type:"boolean"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},buildIndex:{description:"Builds and index for efficient rendering of subsets of the data. This setting is useful when rendering large amounts of data and often only a small subset of the data is visible. An example of such a situation is a scatter plot spanning the whole genome.\n\nThis setting implicitly sorts the data by the field assigned on the `x` channel.",type:"boolean"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},{additionalProperties:!1,properties:{buildIndex:{description:"Builds and index for efficient rendering of subsets of the data. This setting is useful when rendering large amounts of data and often only a small subset of the data is visible. An example of such a situation is a scatter plot spanning the whole genome.\n\nThis setting implicitly sorts the data by the field assigned on the `x` channel.",type:"boolean"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},required:["value"],type:"object"}],description:"X coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},x2:{$ref:"#/definitions/Position2Def",description:"X2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y:{$ref:"#/definitions/PositionDef",description:"Y coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y2:{$ref:"#/definitions/Position2Def",description:"Y2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."}},type:"object"},ExprDef:{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr"],type:"object"},ExprFilterParams:{additionalProperties:!1,properties:{expr:{description:"An expression string. The data object is removed if the expression evaluates to false.",type:"string"},type:{const:"filter",description:"The type of the transform to be applied",type:"string"}},required:["expr","type"],type:"object"},ExprRef:{additionalProperties:!1,properties:{expr:{description:"The expression string.",type:"string"}},required:["expr"],type:"object"},Field:{description:"The name of the field or a JavaScript expression for accessing nested properties. Dots and brackets in the field name must be escaped.",type:"string"},FieldDefWithoutScale:{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},FieldName:{type:"string"},"FieldOrDatumDefWithCondition<DatumDef,(string|null)>":{additionalProperties:!1,description:"A FieldDef with Condition<ValueDef> {   condition: {value: ...},   field: ...,   ... }",properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},condition:{anyOf:[{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},type:"array"}],description:"One or more value definition(s) with [a parameter or a test predicate](https://vega.github.io/vega-lite/docs/condition.html).\n\n__Note:__ A field definition's `condition` property can only contain [conditional value definitions](https://vega.github.io/vega-lite/docs/condition.html#value) since Vega-Lite only allows at most one encoded field per encoding channel."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},type:"object"},"FieldOrDatumDefWithCondition<DatumDef,number>":{additionalProperties:!1,description:"A FieldDef with Condition<ValueDef> {   condition: {value: ...},   field: ...,   ... }",properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},condition:{anyOf:[{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},type:"array"}],description:"One or more value definition(s) with [a parameter or a test predicate](https://vega.github.io/vega-lite/docs/condition.html).\n\n__Note:__ A field definition's `condition` property can only contain [conditional value definitions](https://vega.github.io/vega-lite/docs/condition.html#value) since Vega-Lite only allows at most one encoded field per encoding channel."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},type:"object"},"FieldOrDatumDefWithCondition<MarkPropFieldDef<Type>,(string|null)>":{additionalProperties:!1,description:"A FieldDef with Condition<ValueDef> {   condition: {value: ...},   field: ...,   ... }",properties:{condition:{anyOf:[{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},type:"array"}],description:"One or more value definition(s) with [a parameter or a test predicate](https://vega.github.io/vega-lite/docs/condition.html).\n\n__Note:__ A field definition's `condition` property can only contain [conditional value definitions](https://vega.github.io/vega-lite/docs/condition.html#value) since Vega-Lite only allows at most one encoded field per encoding channel."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"FieldOrDatumDefWithCondition<MarkPropFieldDef<Type>,number>":{additionalProperties:!1,description:"A FieldDef with Condition<ValueDef> {   condition: {value: ...},   field: ...,   ... }",properties:{condition:{anyOf:[{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},type:"array"}],description:"One or more value definition(s) with [a parameter or a test predicate](https://vega.github.io/vega-lite/docs/condition.html).\n\n__Note:__ A field definition's `condition` property can only contain [conditional value definitions](https://vega.github.io/vega-lite/docs/condition.html#value) since Vega-Lite only allows at most one encoded field per encoding channel."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"FieldOrDatumDefWithCondition<MarkPropFieldDef<TypeForShape>,(string|null)>":{additionalProperties:!1,description:"A FieldDef with Condition<ValueDef> {   condition: {value: ...},   field: ...,   ... }",properties:{condition:{anyOf:[{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},type:"array"}],description:"One or more value definition(s) with [a parameter or a test predicate](https://vega.github.io/vega-lite/docs/condition.html).\n\n__Note:__ A field definition's `condition` property can only contain [conditional value definitions](https://vega.github.io/vega-lite/docs/condition.html#value) since Vega-Lite only allows at most one encoded field per encoding channel."},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/TypeForShape"}},required:["type"],type:"object"},FilterParams:{anyOf:[{$ref:"#/definitions/ExprFilterParams"},{$ref:"#/definitions/SelectionFilterParams"}]},FilterScoredLabelsParams:{additionalProperties:!1,properties:{channel:{description:'**Default:** `"x"`',enum:["x","y"],type:"string"},lane:{$ref:"#/definitions/Field",description:"An optional field representing element's lane, e.g., if transcripts are shown using a piled up layout."},padding:{description:"Padding (in pixels) around the element.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/Field",description:"The field representing element's position on the domain."},score:{$ref:"#/definitions/Field",description:"The field representing the score used for prioritization."},type:{const:"filterScoredLabels",description:"The type of the transform to be applied",type:"string"},width:{$ref:"#/definitions/Field",description:"The field representing element's width in pixels"}},required:["pos","score","type","width"],type:"object"},FlattenCompressedExonsParams:{additionalProperties:!1,properties:{as:{description:'Field names for the flattened exons.\n\n**Default:** `["exonStart", "exonEnd"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},exons:{$ref:"#/definitions/Field",description:'The field containing the exons.\n\n**Default:** `"exons"`'},start:{$ref:"#/definitions/Field",description:'Start coordinate of the gene body.\n\n**Default:** `"start"`'},type:{const:"flattenCompressedExons",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenDelimitedParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to split and flatten"},separator:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"Separator(s) used on the field(s) TODO: Rename to delimiter"},type:{const:"flattenDelimited",description:"The type of the transform to be applied",type:"string"}},required:["field","separator","type"],type:"object"},FlattenParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},fields:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to flatten. If no field is defined, the data object itself is treated as an array to be flattened."},index:{description:"The output field name for the zero-based index of the array values. If unspecified, an index field is not added.",type:"string"},type:{const:"flatten",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenSequenceParams:{additionalProperties:!1,properties:{as:{description:'Name of the fields where the zero-based index number and flattened sequence letter are written to.\n\n**Default:** `["pos", "sequence"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},field:{$ref:"#/definitions/Field",description:'The field to flatten.\n\n**Default:** `"sequence"`'},type:{const:"flattenSequence",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FontStyle:{enum:["normal","italic"],type:"string"},FontWeight:{anyOf:[{type:"number"},{const:"thin",type:"string"},{const:"light",type:"string"},{const:"regular",type:"string"},{const:"normal",type:"string"},{const:"medium",type:"string"},{const:"bold",type:"string"},{const:"black",type:"string"}]},FormulaParams:{additionalProperties:!1,properties:{as:{description:"The (new) field where the computed value is written to",type:"string"},expr:{description:"An expression string",type:"string"},type:{const:"formula",description:"The type of the transform to be applied",type:"string"}},required:["as","expr","type"],type:"object"},Generator:{$ref:"#/definitions/SequenceGenerator"},GenomeAxis:{additionalProperties:!1,properties:{chromGrid:{description:"A boolean flag indicating if chromosome grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},chromGridCap:{description:'The stroke cap for the chromosome grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},chromGridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},chromGridDash:{description:"An array of alternating [stroke, space] lengths for dashed chromosome grid mark lines.",items:{type:"number"},type:"array"},chromGridDashOffset:{description:"The pixel offset at which to start drawing with the chromosome grid mark dash array.",type:"number"},chromGridFillEven:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridFillOdd:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridOpacity:{description:"The opacity of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromGridWidth:{description:"Width of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromLabelAlign:{$ref:"#/definitions/Align"},chromLabelColor:{type:"string"},chromLabelFont:{type:"string"},chromLabelFontSize:{type:"number"},chromLabelFontStyle:{$ref:"#/definitions/FontStyle"},chromLabelFontWeight:{$ref:"#/definitions/FontWeight"},chromLabelPadding:{type:"number"},chromLabels:{type:"boolean"},chromTickColor:{type:"string"},chromTickDash:{items:{type:"number"},type:"array"},chromTickDashOffset:{type:"number"},chromTickSize:{type:"number"},chromTickWidth:{type:"number"},chromTicks:{type:"boolean"},domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},GenomeConfig:{anyOf:[{$ref:"#/definitions/UrlGenomeConfig"},{$ref:"#/definitions/InlineGenomeConfig"},{$ref:"#/definitions/GenomeConfigBase"}]},GenomeConfigBase:{additionalProperties:!1,properties:{name:{description:"Name of the genome assembly, e.g., `hg19` or `hg38`.",type:"string"}},required:["name"],type:"object"},Gff3Data:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounce:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Debounce time for data updates, in milliseconds. Debouncing prevents excessive data updates when the user is zooming or panning around.\n\n__Default value:__ `200`"},debounceMode:{description:'The debounce mode for data updates. If set to `"domain"`, domain change events (panning and zooming) will be debounced. If set to `"window"`, the data fetches initiated by the changes to the visible window (or tile) will be debounced.  If your data is small, the `"window"` is better as it will start fetching data while the user is still panning around, resulting in a shorter perceived latency.\n\n__Default value:__ `"window"`',enum:["domain","window"],type:"string"},indexUrl:{description:'Url of the tabix index file.\n\n__Default value:__ `url` + `".tbi"`.',type:"string"},type:{const:"gff3",type:"string"},url:{description:"Url of the bgzip compressed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the Tabix file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `30000000`",type:"number"}},required:["type","url"],type:"object"},HConcatSpec:{additionalProperties:!1,properties:{baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},hconcat:{description:"Specifies views that will be concatenated horizontally.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["hconcat"],type:"object"},HandledTooltip:{additionalProperties:!1,properties:{handler:{type:"string"},params:{type:"object"}},required:["handler"],type:"object"},IdentifierParams:{additionalProperties:!1,properties:{as:{description:'**Default:** `"_uniqueId"`',type:"string"},type:{const:"identifier",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},ImportSpec:{additionalProperties:!1,properties:{import:{anyOf:[{$ref:"#/definitions/UrlImport"},{$ref:"#/definitions/TemplateImport"}],description:"The method to import a specification."},name:{description:"The name given to the imported view. This property overrides the name specified in the imported specification.",type:"string"},params:{anyOf:[{items:{$ref:"#/definitions/Parameter"},type:"array"},{type:"object"}],description:"Dynamic variables that parameterize a visualization. Parameters defined here override the parameters defined in the imported specification."}},required:["import"],type:"object"},IndexedFastaData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounce:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Debounce time for data updates, in milliseconds. Debouncing prevents excessive data updates when the user is zooming or panning around.\n\n__Default value:__ `200`"},debounceMode:{description:'The debounce mode for data updates. If set to `"domain"`, domain change events (panning and zooming) will be debounced. If set to `"window"`, the data fetches initiated by the changes to the visible window (or tile) will be debounced.  If your data is small, the `"window"` is better as it will start fetching data while the user is still panning around, resulting in a shorter perceived latency.\n\n__Default value:__ `"window"`',enum:["domain","window"],type:"string"},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".fai"`.',type:"string"},type:{const:"indexedFasta",type:"string"},url:{description:"URL of the fasta file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the fasta file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `7000`",type:"number"}},required:["type","url"],type:"object"},InlineData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},values:{$ref:"#/definitions/InlineDataset",description:"The full data set, included inline. This can be an array of objects or primitive values, an object, or a string. Arrays of primitive values are ingested as objects with a `data` property. Strings are parsed according to the specified format type."}},required:["values"],type:"object"},InlineDataset:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"},{items:{type:"object"},type:"array"},{type:"string"},{type:"object"}]},InlineGenomeConfig:{additionalProperties:!1,properties:{contigs:{description:"An array of contigs/sequences in the genome assembly.",items:{$ref:"#/definitions/Contig"},type:"array"},name:{description:"Name of the genome assembly, e.g., `hg19` or `hg38`.",type:"string"}},required:["contigs","name"],type:"object"},IntervalSelectionConfig:{additionalProperties:!1,properties:{encodings:{description:"An array of encoding channels. The corresponding data field values must match for a data tuple to fall within the selection.\n\n__See also:__ The [projection with `encodings` and `fields` section](https://vega.github.io/vega-lite/docs/selection.html#project) in the documentation.",items:{$ref:"#/definitions/ChannelWithScale"},type:"array"},fields:{description:"An array of field names whose values must match for a data tuple to fall within the selection.\n\n__See also:__ The [projection with `encodings` and `fields` section](https://vega.github.io/vega-lite/docs/selection.html#project) in the documentation.",items:{type:"string"},type:"array"},on:{enum:["click","mouseover","pointerover"],type:"string"},type:{const:"interval",description:'Determines the default event processing and data query for the selection. Vega-Lite currently supports two selection types:\n\n- `"point"` -- to select multiple discrete data values; the first value is selected on `click` and additional values toggled on shift-click.\n- `"interval"` -- to select a continuous range of data values on `drag`.',type:"string"}},required:["type"],type:"object"},JsonDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},property:{description:'The JSON property containing the desired data. This parameter can be used when the loaded JSON file may have surrounding structure or meta-data. For example `"property": "values.features"` is equivalent to retrieving `json.values.features` from the loaded JSON object.',type:"string"},type:{const:"json",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},type:"object"},LayerSpec:{additionalProperties:!1,properties:{aggregateSamples:{description:"Specifies views that [aggregate](https://genomespy.app/docs/sample-collections/visualizing/#aggregation) multiple samples within the GenomeSpy App.",items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:`Opacity of the view and all its children. Allows implementing semantic zooming where the layers are faded in and out as the user zooms in and out.

TODO: Write proper documentation with examples.

**Default:** \`1.0\``},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["layer"],type:"object"},LazyData:{additionalProperties:!1,properties:{lazy:{$ref:"#/definitions/LazyDataParams"}},required:["lazy"],type:"object"},LazyDataParams:{anyOf:[{$ref:"#/definitions/AxisTicksData"},{$ref:"#/definitions/AxisGenomeData"},{$ref:"#/definitions/IndexedFastaData"},{$ref:"#/definitions/BigWigData"},{$ref:"#/definitions/BigBedData"},{$ref:"#/definitions/BamData"},{$ref:"#/definitions/Gff3Data"}]},LinearizeGenomicCoordinateParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The output field or fields for linearized coordinates."},channel:{description:'Get the genome assembly from the scale of the channel.\n\n**Default:** `"x"`',enum:["x","y"],type:"string"},chrom:{$ref:"#/definitions/Field",description:"The chromosome/contig field"},offset:{anyOf:[{type:"number"},{items:{type:"number"},type:"array"}],description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`"},pos:{anyOf:[{$ref:"#/definitions/Field"},{items:{$ref:"#/definitions/Field"},type:"array"}],description:"The field or fields that contain intra-chromosomal positions"},type:{const:"linearizeGenomicCoordinate",description:"The type of the transform to be applied",type:"string"}},required:["as","chrom","pos","type"],type:"object"},LinkProps:{additionalProperties:!1,properties:{arcFadingDistance:{anyOf:[{items:{type:"number"},maxItems:2,minItems:2,type:"array"},{const:!1,type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"The range of the `\"arc\"` shape's fading distance in pixels. This property allows for making the arc's opacity fade out as it extends away from the chord. The fading distance is interpolated from one to zero between the interval defined by this property. Both `false` and `[0, 0]` disable fading.\n\n**Default value:** `false`"},arcHeightFactor:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'Scaling factor for the `"arc`" shape\'s height. The default value `1.0` produces roughly circular arcs.\n\n**Default value:** `1.0`'},clampApex:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:'Whether the apex of the `"dome"` shape is clamped to the viewport edge. When over a half of the dome is located outside the viewport, clamping allows for more accurate reading of the value encoded by the apex\' position.\n\n**Default value:** `false`'},clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Color of the mark. Affects either `fill` or `stroke`, depending on the `filled` property."},linkShape:{anyOf:[{const:"arc",type:"string"},{const:"diagonal",type:"string"},{const:"line",type:"string"},{const:"dome",type:"string"},{$ref:"#/definitions/ExprRef"}],description:'The shape of the link path.\n\nThe `"arc"` shape draws a circular arc between the two points. The apex of the arc resides on the left side of the line that connects the two points. The `"dome"` shape draws a vertical or horizontal arc with a specific height. The primary positional channel determines the apex of the arc and the secondary determines the endpoint placement. The `"diagonal"` shape draws an "S"-shaped curve between the two points. The `"line"` shape draws a straight line between the two points. See an [example](#different-link-shapes-and-orientations) of the different shapes below.\n\n**Default value:** `"arc"`'},maxChordLength:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'The maximum length of `"arc"` shape\'s chord in pixels. The chord is the line segment between the two points that define the arc. Limiting the chord length serves two purposes when zooming in close enough: 1) it prevents the arc from becoming a straight line and 2) it mitigates the limited precision of floating point numbers in arc rendering.\n\n**Default value:** `50000`'},minArcHeight:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'The minimum height of an `"arc"` shape. Makes very short links more clearly visible.\n\n**Default value:** `1.5`'},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minPickingSize:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'The minimum picking size invisibly increases the stroke width or point diameter of marks when pointing them with the mouse cursor, making it easier to select them. The valus is the minimum size in pixels.\n\n**Default value:** `3.0` for `"link"` and `2.0` for `"point"`'},noFadingOnPointSelection:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"Disables fading of the link when an mark instance is subject to any point selection. As the fading distance is unavailable as a visual channel, this property allows for enhancing the visibility of the selected links.\n\n**Default value:** `true`"},opacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Opacity of the mark. Affects `fillOpacity` or `strokeOpacity`, depending on the `filled` property."},orient:{anyOf:[{const:"vertical",type:"string"},{const:"horizontal",type:"string"},{$ref:"#/definitions/ExprRef"}],description:'The orientation of the link path. Either `"vertical"` or `"horizontal"`. Only applies to diagonal links.\n\n**Default value:** `"vertical"`'},segments:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The number of segments in the bzier curve. Affects the rendering quality and performance. Use a higher value for a smoother curve.\n\n**Default value:** `101`"},size:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'Stroke width of `"link"` and `"rule"` marks in pixels, the area of the bounding square of `"point"` mark, or the font size of `"text"` mark.'},tooltip:{$ref:"#/definitions/Tooltip",description:"Tooltip handler. If `null`, no tooltip is shown. If string, specifies the [tooltip handler](https://genomespy.app/docs/api/#custom-tooltip-handlers) to use."},type:{const:"link",type:"string"},x:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the x axis."},x2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the x axis."},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the y axis."},y2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the y axis."},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},"MarkPropDef<(string|null),TypeForShape>":{anyOf:[{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CMarkPropFieldDef%3CTypeForShape%3E%2C(string%7Cnull)%3E"},{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CDatumDef%2C(string%7Cnull)%3E"},{$ref:"#/definitions/ValueDefWithCondition%3C(string%7Cnull)%3E"}]},"MarkPropDef<(string|null)>":{anyOf:[{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CMarkPropFieldDef%3CType%3E%2C(string%7Cnull)%3E"},{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CDatumDef%2C(string%7Cnull)%3E"},{$ref:"#/definitions/ValueDefWithCondition%3C(string%7Cnull)%3E"}]},"MarkPropDef<number>":{anyOf:[{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CMarkPropFieldDef%3CType%3E%2Cnumber%3E"},{$ref:"#/definitions/FieldOrDatumDefWithCondition%3CDatumDef%2Cnumber%3E"},{$ref:"#/definitions/ValueDefWithCondition%3Cnumber%3E"}]},MarkProps:{anyOf:[{$ref:"#/definitions/RectProps"},{$ref:"#/definitions/TextProps"},{$ref:"#/definitions/RuleProps"},{$ref:"#/definitions/LinkProps"},{$ref:"#/definitions/PointProps"}]},MarkType:{enum:["rect","point","rule","text","link"],type:"string"},MeasureTextParams:{additionalProperties:!1,properties:{as:{type:"string"},field:{$ref:"#/definitions/Field"},fontSize:{type:"number"},type:{const:"measureText",description:"The type of the transform to be applied",type:"string"}},required:["as","field","fontSize","type"],type:"object"},MergeFacetsParams:{additionalProperties:!1,properties:{type:{const:"mergeFacets",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},NamedData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["name"],type:"object"},NumericDomain:{items:{type:"number"},type:"array"},NumericMarkPropDef:{$ref:"#/definitions/MarkPropDef%3Cnumber%3E"},NumericValueDef:{$ref:"#/definitions/ValueDef%3Cnumber%3E"},OtherDataFormat:{additionalProperties:!1,description:'Other data format, such as `"fasta"`',properties:{type:{type:"string"}},required:["type"],type:"object"},PaddingConfig:{anyOf:[{$ref:"#/definitions/Paddings"},{type:"number"}]},Paddings:{additionalProperties:!1,properties:{bottom:{type:"number"},left:{type:"number"},right:{type:"number"},top:{type:"number"}},type:"object"},Parameter:{anyOf:[{$ref:"#/definitions/VariableParameter"},{$ref:"#/definitions/SelectionParameter"}]},Parse:{additionalProperties:{$ref:"#/definitions/ParseValue"},type:"object"},ParseValue:{anyOf:[{type:"null"},{type:"string"},{const:"string",type:"string"},{const:"boolean",type:"string"},{const:"date",type:"string"},{const:"number",type:"string"}]},PileupParams:{additionalProperties:!1,properties:{as:{description:'The output field name for the computed lane.\n\n**Default:** `"lane"`.',type:"string"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},preference:{$ref:"#/definitions/Field",description:"An optional field indicating the preferred lane. Use together with the `preferredOrder` property."},preferredOrder:{anyOf:[{items:{type:"string"},type:"array"},{items:{type:"number"},type:"array"},{items:{type:"boolean"},type:"array"}],description:"The order of the lane preferences. The first element contains the value that should place the segment on the first lane and so forth. If the preferred lane is occupied, the first available lane is taken."},spacing:{description:"The spacing between adjacent segments on the same lane in coordinate units.\n\n**Default:** `1`.",type:"number"},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"pileup",description:"The type of the transform to be applied",type:"string"}},required:["end","start","type"],type:"object"},PointProps:{additionalProperties:!1,properties:{angle:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The rotation angle in degrees.\n\n**Default value:** `0`"},clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Color of the mark. Affects either `fill` or `stroke`, depending on the `filled` property."},fill:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The fill color."},fillGradientStrength:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Gradient strength controls the amount of the gradient eye-candy effect in the fill color. Valid values are between `0` and `1`.\n\n**Default value:** `0`"},fillOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The fill opacity. Value between `0` and `1`."},filled:{description:"Whether the `color` represents the `fill` color (`true`) or the `stroke` color (`false`).",type:"boolean"},geometricZoomBound:{description:"Enables geometric zooming. The value is the base two logarithmic zoom level where the maximum point size is reached.\n\n**Default value:** `0`",type:"number"},inwardStroke:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"Should the stroke only grow inwards, e.g, the diameter/outline is not affected by the stroke width. Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with geometric zoom, etc.\n\n**Default value:** `false`"},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minPickingSize:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'The minimum picking size invisibly increases the stroke width or point diameter of marks when pointing them with the mouse cursor, making it easier to select them. The valus is the minimum size in pixels.\n\n**Default value:** `3.0` for `"link"` and `2.0` for `"point"`'},opacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Opacity of the mark. Affects `fillOpacity` or `strokeOpacity`, depending on the `filled` property."},semanticZoomFraction:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"TODO\n\n**Default value:** `0.02`"},shape:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:'One of `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, `"triangle-left"`, `"tick-up"`, `"tick-down"`, `"tick-right"`, or `"tick-left"`\n\n**Default value:** `"circle"`'},size:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'Stroke width of `"link"` and `"rule"` marks in pixels, the area of the bounding square of `"point"` mark, or the font size of `"text"` mark.'},stroke:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The stroke color"},strokeOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The stroke opacity. Value between `0` and `1`."},strokeWidth:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The stroke width in pixels."},tooltip:{$ref:"#/definitions/Tooltip",description:"Tooltip handler. If `null`, no tooltip is shown. If string, specifies the [tooltip handler](https://genomespy.app/docs/api/#custom-tooltip-handlers) to use."},type:{const:"point",type:"string"},x:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the x axis."},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the y axis."},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},PointSelectionConfig:{additionalProperties:!1,properties:{encodings:{description:"An array of encoding channels. The corresponding data field values must match for a data tuple to fall within the selection.\n\n__See also:__ The [projection with `encodings` and `fields` section](https://vega.github.io/vega-lite/docs/selection.html#project) in the documentation.",items:{$ref:"#/definitions/ChannelWithScale"},type:"array"},fields:{description:"An array of field names whose values must match for a data tuple to fall within the selection.\n\n__See also:__ The [projection with `encodings` and `fields` section](https://vega.github.io/vega-lite/docs/selection.html#project) in the documentation.",items:{type:"string"},type:"array"},on:{enum:["click","mouseover","pointerover"],type:"string"},type:{const:"point",description:'Determines the default event processing and data query for the selection. Vega-Lite currently supports two selection types:\n\n- `"point"` -- to select multiple discrete data values; the first value is selected on `click` and additional values toggled on shift-click.\n- `"interval"` -- to select a continuous range of data values on `drag`.',type:"string"}},required:["type"],type:"object"},Position2Def:{anyOf:[{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},{$ref:"#/definitions/SecondaryChromPosDef"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},type:"object"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr"],type:"object"},{$ref:"#/definitions/PositionValueDef"}]},PositionDatumDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},PositionDef:{anyOf:[{$ref:"#/definitions/PositionFieldDef"},{$ref:"#/definitions/ChromPosDef"},{$ref:"#/definitions/PositionDatumDef"},{$ref:"#/definitions/PositionExprDef"},{$ref:"#/definitions/PositionValueDef"}]},PositionExprDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},PositionFieldDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},PositionValueDef:{$ref:"#/definitions/NumericValueDef"},PositionalChannel:{anyOf:[{$ref:"#/definitions/PrimaryPositionalChannel"},{$ref:"#/definitions/SecondaryPositionalChannel"}]},PrimaryPositionalChannel:{enum:["x","y"],type:"string"},ProjectParams:{additionalProperties:!1,properties:{as:{description:"New names for the projected fields. If omitted, the names of the source fields are used.",items:{type:"string"},type:"array"},fields:{description:"The fields to be projected.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"project",description:"The type of the transform to be applied",type:"string"}},required:["fields","type"],type:"object"},RectProps:{additionalProperties:!1,properties:{clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Color of the mark. Affects either `fill` or `stroke`, depending on the `filled` property."},cornerRadius:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Radius of the rounded corners.\n\n**Default value:** `0`"},cornerRadiusBottomLeft:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Radius of the bottom left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)"},cornerRadiusBottomRight:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Radius of the bottom right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)"},cornerRadiusTopLeft:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Radius of the top left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)"},cornerRadiusTopRight:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Radius of the top right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)"},fill:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The fill color."},fillOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The fill opacity. Value between `0` and `1`."},filled:{description:"Whether the `color` represents the `fill` color (`true`) or the `stroke` color (`false`).",type:"boolean"},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minHeight:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The minimum height of a rectangle in pixels. The property clamps rectangles' heights.\n\n**Default value:** `0`"},minOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Clamps the minimum size-dependent opacity. The property does not affect the `opacity` channel. Valid values are between `0` and `1`.\n\nWhen a rectangle would be smaller than what is specified in `minHeight` and `minWidth`, it is faded out proportionally. Example: a rectangle would be rendered as one pixel wide, but `minWidth` clamps it to five pixels. The rectangle is actually rendered as five pixels wide, but its opacity is multiplied by 0.2. With this setting, you can limit the factor to, for example, 0.5 to keep the rectangles more clearly visible.\n\n**Default value:** `0`"},minWidth:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:`The minimum width of a rectangle in pixels. The property clamps rectangles' widths when the viewport is zoomed out.

This property also reduces flickering of very narrow rectangles when zooming. The value should generally be at least one.

**Default value:** \`1\``},opacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Opacity of the mark. Affects `fillOpacity` or `strokeOpacity`, depending on the `filled` property."},stroke:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The stroke color"},strokeOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The stroke opacity. Value between `0` and `1`."},strokeWidth:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The stroke width in pixels."},tooltip:{$ref:"#/definitions/Tooltip",description:"Tooltip handler. If `null`, no tooltip is shown. If string, specifies the [tooltip handler](https://genomespy.app/docs/api/#custom-tooltip-handlers) to use."},type:{const:"rect",type:"string"},x:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the x axis."},x2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the x axis."},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the y axis."},y2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the y axis."},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},RegexExtractParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The new field or an array of fields where the extracted values are written."},field:{$ref:"#/definitions/Field",description:"The source field"},regex:{description:'A valid JavaScript regular expression with at least one group. For example: `"^Sample(\\\\d+)$"`.\n\nRead more at: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions',type:"string"},skipInvalidInput:{description:"Do not complain about invalid input. Just skip it and leave the new fields undefined on the affected datum.\n\n**Default:** `false`",type:"boolean"},type:{const:"regexExtract",description:"The type of the transform to be applied",type:"string"}},required:["as","field","regex","type"],type:"object"},RegexFoldParams:{additionalProperties:!1,properties:{asKey:{description:'**Default:** `"sample"`',type:"string"},asValue:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A new column name for the extracted values."},columnRegex:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A regular expression that matches to column names. The regex must have one capturing group that is used for extracting the key (e.g., a sample id) from the column name."},skipRegex:{description:"An optional regex that matches to fields that should not be included in the new folded data objects.",type:"string"},type:{const:"regexFold",description:"The type of the transform to be applied",type:"string"}},required:["asValue","columnRegex","type"],type:"object"},ResolutionBehavior:{description:'`"independent"` and `"shared"` behave similarly to Vega-Lite. `"excluded"` behaves like `"shared"`, but is not pulled towards the root. `"forced"` behaves like `"shared"`, but is forced towards the root even if the parent has `"independent"` behavior.',enum:["independent","shared","excluded","forced"],type:"string"},RootSpec:{anyOf:[{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{description:"Specifies views that [aggregate](https://genomespy.app/docs/sample-collections/visualizing/#aggregation) multiple samples within the GenomeSpy App.",items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkProps"}],description:"The graphical mark presenting the data objects."},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:`Opacity of the view and all its children. Allows implementing semantic zooming where the layers are faded in and out as the user zooms in and out.

TODO: Write proper documentation with examples.

**Default:** \`1.0\``},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"The background of the view, including fill, stroke, and stroke width."},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["mark"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{description:"Specifies views that [aggregate](https://genomespy.app/docs/sample-collections/visualizing/#aggregation) multiple samples within the GenomeSpy App.",items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:`Opacity of the view and all its children. Allows implementing semantic zooming where the layers are faded in and out as the user zooms in and out.

TODO: Write proper documentation with examples.

**Default:** \`1.0\``},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["layer"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{description:"Specifies views that will be concatenated vertically.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["vconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},hconcat:{description:"Specifies views that will be concatenated horizontally.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["hconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},columns:{description:"The number of columns in the grid.",type:"number"},concat:{description:"Specifies views that will be concatenated into a grid that wraps when the specified number of columns are used.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["columns","concat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["samples","spec"],type:"object"}]},RuleProps:{additionalProperties:!1,properties:{clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Color of the mark. Affects either `fill` or `stroke`, depending on the `filled` property."},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minLength:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The minimum length of the rule in pixels. Use this property to ensure that very short ranged rules remain visible even when the user zooms out.\n\n**Default value:** `0`"},opacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Opacity of the mark. Affects `fillOpacity` or `strokeOpacity`, depending on the `filled` property."},size:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'Stroke width of `"link"` and `"rule"` marks in pixels, the area of the bounding square of `"point"` mark, or the font size of `"text"` mark.'},strokeCap:{anyOf:[{const:"butt",type:"string"},{const:"square",type:"string"},{const:"round",type:"string"},{$ref:"#/definitions/ExprRef"}],description:'The style of stroke ends. Available choices: `"butt"`, `"round`", and `"square"`.\n\n**Default value:** `"butt"`'},strokeDash:{description:"An array of of alternating stroke and gap lengths or `null` for solid strokes.\n\n**Default value:** `null`",items:{type:"number"},type:"array"},strokeDashOffset:{description:"An offset for the stroke dash pattern.\n\n**Default value:** `0`",type:"number"},tooltip:{$ref:"#/definitions/Tooltip",description:"Tooltip handler. If `null`, no tooltip is shown. If string, specifies the [tooltip handler](https://genomespy.app/docs/api/#custom-tooltip-handlers) to use."},type:{const:"rule",type:"string"},x:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the x axis."},x2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the x axis."},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the y axis."},y2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the y axis."},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},SampleAttributeDef:{additionalProperties:!1,properties:{barScale:{$ref:"#/definitions/Scale",description:"An optional scale definition for mapping the attribute to the width of a metadata rectangle."},scale:{$ref:"#/definitions/Scale",description:"Scale definition for the (default) color channel"},type:{$ref:"#/definitions/Type",description:'The attribute type. One of `"nominal"`, `"ordinal"`, or `"quantitative"`.'},visible:{description:"Whether the attribute is visible by default.",type:"boolean"},width:{description:"Width of the column in pixels.",type:"number"}},required:["type"],type:"object"},SampleDef:{additionalProperties:!1,properties:{attributeLabelAngle:{description:"Angle to be added to the default label angle (-90).\n\n**Default value:** `0`",type:"number"},attributeLabelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},attributeLabelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},attributeLabelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},attributeLabelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},attributeSize:{description:"Default size (width) of the metadata attribute columns. Can be configured per attribute using the `attributes` property.\n\n**Default value:** `10`",type:"number"},attributeSpacing:{description:"Spacing between attribute columns in pixels.\n\n**Default value:** `1`",type:"number"},attributes:{additionalProperties:{$ref:"#/definitions/SampleAttributeDef"},description:"Explicitly specify the sample attributes.",type:"object"},data:{$ref:"#/definitions/Data",description:"Optional metadata about the samples."},labelAlign:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},labelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},labelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},labelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},labelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},labelLength:{description:"How much space in pixels to reserve for the labels.\n\n**Default:** `140`",type:"number"},labelTitleText:{description:'Text in the label title\n\n**Default:** `"Sample name"`',type:"string"}},type:"object"},SampleParams:{additionalProperties:!1,properties:{size:{description:"The maximum sample size.\n\n**Default:** `500`",type:"number"},type:{const:"sample",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},SampleSpec:{additionalProperties:!1,description:"A view specification for a SampleView. This is only functional in the GenomeSpy app.",properties:{baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["samples","spec"],type:"object"},Scalar:{type:["string","number","boolean"]},ScalarDomain:{anyOf:[{$ref:"#/definitions/NumericDomain"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"}]},Scale:{additionalProperties:!1,properties:{align:{description:"The alignment of the steps within the scale range.\n\nThis value must lie in the range `[0,1]`. A value of `0.5` indicates that the steps should be centered within the range. A value of `0` or `1` may be used to shift the bands to one side, say to position them adjacent to an axis.\n\n__Default value:__ `0.5`",type:"number"},base:{description:"The logarithm base of the `log` scale (default `10`).",type:"number"},bins:{description:"An array of bin boundaries over the scale domain. If provided, axes and legends will use the bin boundaries to inform the choice of tick marks and text labels.",items:{type:"number"},type:"array"},clamp:{description:"If `true`, values that exceed the data domain are clamped to either the minimum or maximum range value\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/config.html#scale-config)'s `clamp` (`true` by default).",type:"boolean"},constant:{description:"A constant determining the slope of the symlog function around zero. Only used for `symlog` scales.\n\n__Default value:__ `1`",type:"number"},domain:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"Customized domain values.\n\nFor _quantitative_ fields, `domain` can take the form of a two-element array with minimum and maximum values.  [Piecewise scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise) can be created by providing a `domain` with more than two entries.\n\nFor _temporal_ fields, `domain` can be a two-element array minimum and maximum values, in the form of either timestamps or the [DateTime definition objects](https://vega.github.io/vega-lite/docs/types.html#datetime).\n\nFor _ordinal_ and _nominal_ fields, `domain` can be an array that lists valid input values."},domainMax:{description:"Sets the maximum value in the scale domain, overriding the `domain` property. This property is only intended for use with scales having continuous domains.",type:"number"},domainMid:{description:"Inserts a single mid-point value into a two-element domain. The mid-point value must lie between the domain minimum and maximum values. This property can be useful for setting a midpoint for [diverging color scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise). The domainMid property is only intended for use with scales supporting continuous, piecewise domains.",type:"number"},domainMin:{description:"Sets the minimum value in the scale domain, overriding the domain property. This property is only intended for use with scales having continuous domains.",type:"number"},exponent:{description:"The exponent of the `pow` scale.",type:"number"},interpolate:{anyOf:[{$ref:"#/definitions/ScaleInterpolate"},{$ref:"#/definitions/ScaleInterpolateParams"}],description:"The interpolation method for range values. By default, a general interpolator for numbers, dates, strings and colors (in HCL space) is used. For color ranges, this property allows interpolation in alternative color spaces. Legal values include `rgb`, `hsl`, `hsl-long`, `lab`, `hcl`, `hcl-long`, `cubehelix` and `cubehelix-long` ('-long' variants use longer paths in polar coordinate spaces). If object-valued, this property accepts an object with a string-valued _type_ property and an optional numeric _gamma_ property applicable to rgb and cubehelix interpolators. For more, see the [d3-interpolate documentation](https://github.com/d3/d3-interpolate).\n\n__Default value:__ `hcl`"},name:{description:"The name of the scale. Names are optional but allow the scales to be referenced and found with the API.",type:"string"},nice:{anyOf:[{type:"boolean"},{type:"number"},{additionalProperties:!1,properties:{interval:{type:"string"},step:{type:"number"}},required:["interval","step"],type:"object"}],description:"Extending the domain so that it starts and ends on nice round values. This method typically modifies the scales domain, and may only extend the bounds to the nearest round value. Nicing is useful if the domain is computed from data and may be irregular. For example, for a domain of _[0.201479, 0.996679]_, a nice domain might be _[0.2, 1.0]_.\n\nFor quantitative scales such as linear, `nice` can be either a boolean flag or a number. If `nice` is a number, it will represent a desired tick count. This allows greater control over the step size used to extend the bounds, guaranteeing that the returned ticks will exactly cover the domain.\n\n__Default value:__ `true` for unbinned _quantitative_ fields; `false` otherwise."},padding:{description:"For _[continuous](https://vega.github.io/vega-lite/docs/scale.html#continuous)_ scales, expands the scale domain to accommodate the specified number of pixels on each of the scale range. The scale range must represent pixels for this parameter to function as intended. Padding adjustment is performedpriorto all other adjustments, including the effects of the`zero`,`nice`,`domainMin`, and`domainMax`properties.\n\nFor _[band](https://vega.github.io/vega-lite/docs/scale.html#band)_ scales, shortcut for setting `paddingInner` and `paddingOuter` to the same value.\n\nFor _[point](https://vega.github.io/vega-lite/docs/scale.html#point)_ scales, alias for `paddingOuter`.\n\n__Default value:__ For _continuous_ scales, derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `continuousPadding`. For _band and point_ scales, see `paddingInner` and `paddingOuter`.  By default, Vega-Lite sets padding such that _width/height = number of unique values * step_.",minimum:0,type:"number"},paddingInner:{description:`The inner padding (spacing) within each band step of band scales, as a fraction of the step size. This value must lie in the range [0,1].

For point scale, this property is invalid as point scales do not have internal band widths (only step sizes between bands).

__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s \`bandPaddingInner\`.`,maximum:1,minimum:0,type:"number"},paddingOuter:{description:"The outer padding (spacing) at the ends of the range of band and point scales, as a fraction of the step size. This value must lie in the range [0,1].\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `bandPaddingOuter` for band scales and `pointPadding` for point scales. By default, Vega-Lite sets outer padding such that _width/height = number of unique values * step_.",maximum:1,minimum:0,type:"number"},range:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{type:"string"},{items:{$ref:"#/definitions/ExprRef"},type:"array"}],description:'The range of the scale. One of:\n\n- A string indicating a [pre-defined named scale range](https://vega.github.io/vega-lite/docs/scale.html#range-config) (e.g., example, `"symbol"`, or `"diverging"`).\n\n- For [continuous scales](https://vega.github.io/vega-lite/docs/scale.html#continuous), two-element array indicating  minimum and maximum values, or an array with more than two entries for specifying a [piecewise scale](https://vega.github.io/vega-lite/docs/scale.html#piecewise).\n\n- For [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) and [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales, an array of desired output values.\n\n__Notes:__\n\n1) For color scales you can also specify a color [`scheme`](https://vega.github.io/vega-lite/docs/scale.html#scheme) instead of `range`.\n\n2) Any directly specified `range` for `x` and `y` channels will be ignored. Range can be customized via the view\'s corresponding [size](https://vega.github.io/vega-lite/docs/size.html) (`width` and `height`).'},reverse:{description:"If true, reverses the order of the scale range.\n\n__Default value:__ `false`.",type:"boolean"},round:{description:"If `true`, rounds numeric output values to integers. This can be helpful for snapping to the pixel grid.\n\n__Default value:__ `false`.",type:"boolean"},scheme:{anyOf:[{type:"string"},{$ref:"#/definitions/SchemeParams"}],description:'A string indicating a color [scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme) name (e.g., `"category10"` or `"blues"`) or a [scheme parameter object](https://vega.github.io/vega-lite/docs/scale.html#scheme-params).\n\nDiscrete color schemes may be used with [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) or [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales. Continuous color schemes are intended for use with color scales.\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.'},type:{$ref:"#/definitions/ScaleType",description:'The type of scale.  Vega-Lite supports the following categories of scale types:\n\n1) [**Continuous Scales**](https://vega.github.io/vega-lite/docs/scale.html#continuous) -- mapping continuous domains to continuous output ranges ([`"linear"`](https://vega.github.io/vega-lite/docs/scale.html#linear), [`"pow"`](https://vega.github.io/vega-lite/docs/scale.html#pow), [`"sqrt"`](https://vega.github.io/vega-lite/docs/scale.html#sqrt), [`"symlog"`](https://vega.github.io/vega-lite/docs/scale.html#symlog), [`"log"`](https://vega.github.io/vega-lite/docs/scale.html#log), [`"time"`](https://vega.github.io/vega-lite/docs/scale.html#time), [`"utc"`](https://vega.github.io/vega-lite/docs/scale.html#utc).\n\n2) [**Discrete Scales**](https://vega.github.io/vega-lite/docs/scale.html#discrete) -- mapping discrete domains to discrete ([`"ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#ordinal)) or continuous ([`"band"`](https://vega.github.io/vega-lite/docs/scale.html#band) and [`"point"`](https://vega.github.io/vega-lite/docs/scale.html#point)) output ranges.\n\n3) [**Discretizing Scales**](https://vega.github.io/vega-lite/docs/scale.html#discretizing) -- mapping continuous domains to discrete output ranges [`"bin-ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#bin-ordinal), [`"quantile"`](https://vega.github.io/vega-lite/docs/scale.html#quantile), [`"quantize"`](https://vega.github.io/vega-lite/docs/scale.html#quantize) and [`"threshold"`](https://vega.github.io/vega-lite/docs/scale.html#threshold).\n\n__Default value:__ please see the [scale type table](https://vega.github.io/vega-lite/docs/scale.html#type).'},zero:{description:"If `true`, ensures that a zero baseline value is included in the scale domain.\n\n__Default value:__ `true` for x and y channels if the quantitative field is not binned and no custom `domain` is provided; `false` otherwise.\n\n__Note:__ Log, time, and utc scales do not support `zero`.",type:"boolean"},zoom:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ZoomParams"}],description:"If `true` and the scale is used on a positional channel, it can bee zoomed and translated interactively."}},type:"object"},ScaleInterpolate:{enum:["rgb","lab","hcl","hsl","hsl-long","hcl-long","cubehelix","cubehelix-long"],type:"string"},ScaleInterpolateParams:{additionalProperties:!1,properties:{gamma:{type:"number"},type:{enum:["rgb","cubehelix","cubehelix-long"],type:"string"}},required:["type"],type:"object"},ScaleType:{enum:["null","linear","log","pow","sqrt","symlog","identity","sequential","quantize","threshold","ordinal","point","band","index","locus"],type:"string"},SchemeParams:{additionalProperties:!1,properties:{count:{description:'The number of colors to use in the scheme. This can be useful for scale types such as `"quantize"`, which use the length of the scale range to determine the number of discrete bins for the scale domain.',type:"number"},extent:{description:"The extent of the color range to use. For example `[0.2, 1]` will rescale the color scheme such that color values in the range _[0, 0.2)_ are excluded from the scheme.",items:{type:"number"},type:"array"},name:{description:'A color scheme name for ordinal scales (e.g., `"category10"` or `"blues"`).\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.',type:"string"}},required:["name"],type:"object"},SecondaryChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},required:["chrom"],type:"object"},SecondaryPositionalChannel:{enum:["x2","y2"],type:"string"},SelectionFilterParams:{additionalProperties:!1,properties:{empty:{description:"If true, the filter retains all data objects when the selection is empty.\n\n**Default:** `true`",type:"boolean"},param:{description:"A selection parameter. The data object is removed if it is not part of the selection.",type:"string"},type:{const:"filter",description:"The type of the transform to be applied",type:"string"}},required:["param","type"],type:"object"},SelectionParameter:{additionalProperties:!1,properties:{name:{description:'A unique name for the variable parameter. Parameter names should be valid JavaScript identifiers: they should contain only alphanumeric characters (or "$", or "_") and may not start with a digit. Reserved keywords that may not be used as parameter names are: "datum".',type:"string"},push:{const:"outer",type:"string"},select:{anyOf:[{$ref:"#/definitions/SelectionType"},{$ref:"#/definitions/PointSelectionConfig"},{$ref:"#/definitions/IntervalSelectionConfig"}],description:'Determines the default event processing and data query for the selection. Vega-Lite currently supports two selection types:\n\n- `"point"` -- to select multiple discrete data values; the first value is selected on `click` and additional values toggled on shift-click.\n- `"interval"` -- to select a continuous range of data values on `drag`.'}},required:["name","select"],type:"object"},SelectionType:{enum:["point","interval"],type:"string"},SequenceGenerator:{additionalProperties:!1,properties:{name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},sequence:{$ref:"#/definitions/SequenceParams",description:"Generate a sequence of numbers."}},required:["sequence"],type:"object"},SequenceParams:{additionalProperties:!1,properties:{as:{anyOf:[{$ref:"#/definitions/FieldName"},{$ref:"#/definitions/ExprRef"}],description:'The name of the generated sequence field.\n\n__Default value:__ `"data"`'},start:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The starting value of the sequence (inclusive)."},step:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The step value between sequence entries.\n\n__Default value:__ `1`"},stop:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The ending value of the sequence (exclusive)."}},required:["start","stop"],type:"object"},ShapeDef:{$ref:"#/definitions/MarkPropDef%3C(string%7Cnull)%2CTypeForShape%3E"},SizeDef:{additionalProperties:!1,properties:{grow:{description:"Share of the remaining space. See [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.",type:"number"},px:{description:"Size in pixels",type:"number"}},type:"object"},SortOrder:{enum:["ascending","descending"],type:"string"},StackParams:{additionalProperties:!1,properties:{as:{description:'Fields to write the stacked values.\n\n**Default:** `["y0", "y1"]`',items:{type:"string"},type:"array"},baseField:{$ref:"#/definitions/Field",description:'The field that contains the base or amino acid. Used for information content calculation when the offset is `"information"`. The data objects that have `null` in the baseField are considered gaps and they are taken into account when scaling the the locus\' information content.'},cardinality:{description:'Cardinality, e.g., the number if distinct bases or amino acids. Used for information content calculation when the offset is `"information"`.\n\n**Default:** `4`',type:"number"},field:{$ref:"#/definitions/Field",description:"The field to stack. If no field is defined, a constant value of one is assumed."},groupby:{description:"The fields to be used for forming groups for different stacks.",items:{$ref:"#/definitions/Field"},type:"array"},offset:{description:'How to offset the values in a stack. `"zero"` (default) starts stacking at 0. `"center"` centers the values around zero. `"normalize"` computes intra-stack percentages and normalizes the values to the range of `[0, 1]`. `"information"` computes a layout for a sequence logo. The total height of the stack reflects the group\'s information content.',enum:["zero","center","normalize","information"],type:"string"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order of data in each stack."},type:{const:"stack",description:"The type of the transform to be applied",type:"string"}},required:["as","groupby","type"],type:"object"},Step:{additionalProperties:!1,properties:{step:{type:"number"}},required:["step"],type:"object"},StringDatumDef:{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},contributesToScaleDomain:{description:"Whether the field or evaluated expr should be included in the scale's domain.\n\n**Default value:** `true`",type:"boolean"},datum:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:"A constant value in data domain."},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},type:"object"},StringFieldDef:{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},TemplateImport:{additionalProperties:!1,properties:{template:{description:"Imports a specification from the current view hierarchy, searching first in the current view, then ascending through ancestors.",type:"string"}},required:["template"],type:"object"},TextDef:{anyOf:[{$ref:"#/definitions/StringFieldDef"},{$ref:"#/definitions/StringDatumDef"},{$ref:"#/definitions/ExprDef"}]},TextProps:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},angle:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The rotation angle in degrees.\n\n**Default value:** `0`"},baseline:{$ref:"#/definitions/Baseline",description:'The vertical alignment of the text.  One of `"top"`, `"middle"`, `"bottom"`.\n\n**Default value:** `"bottom"`'},clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Color of the mark. Affects either `fill` or `stroke`, depending on the `filled` property."},dx:{description:"The horizontal offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},dy:{description:"The vertical offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},fitToBand:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:'If true, sets the secondary positional channel that allows the text to be squeezed (see the `squeeze` property). Can be used when: 1) `"band"`, `"index"`, or `"locus"` scale is being used and 2) only the primary positional channel is specified.\n\n**Default value:** `false`'},flushX:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"If true, the text is kept inside the viewport when the range of `x` and `x2` intersect the viewport."},flushY:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"If true, the text is kept inside the viewport when the range of `y` and `y2` intersect the viewport."},font:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},fontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},fontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},logoLetters:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"Stretch letters so that they can be used with [sequence logos](https://en.wikipedia.org/wiki/Sequence_logo), etc..."},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},opacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Opacity of the mark. Affects `fillOpacity` or `strokeOpacity`, depending on the `filled` property."},paddingX:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The horizontal padding, in pixels, when the `x2` channel is used for ranged text.\n\n**Default value:** `0`"},paddingY:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The vertical padding, in pixels, when the `y2` channel is used for ranged text.\n\n**Default value:** `0`"},size:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The font size in pixels.\n\n**Default value:** `11`"},squeeze:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ExprRef"}],description:"If the `squeeze` property is true and secondary positional channels (`x2` and/or `y2`) are used, the text is scaled to fit mark's width and/or height.\n\n**Default value:** `true`"},text:{anyOf:[{$ref:"#/definitions/Scalar"},{$ref:"#/definitions/ExprRef"}],description:'The text to display. The format of numeric data can be customized by setting a [format specifier](https://github.com/d3/d3-format#locale_format) to channel definition\'s `format` property.\n\n**Default value:** `""`'},tooltip:{$ref:"#/definitions/Tooltip",description:"Tooltip handler. If `null`, no tooltip is shown. If string, specifies the [tooltip handler](https://genomespy.app/docs/api/#custom-tooltip-handlers) to use."},type:{const:"text",type:"string"},viewportEdgeFadeDistanceBottom:{type:"number"},viewportEdgeFadeDistanceLeft:{type:"number"},viewportEdgeFadeDistanceRight:{type:"number"},viewportEdgeFadeDistanceTop:{type:"number"},viewportEdgeFadeWidthBottom:{type:"number"},viewportEdgeFadeWidthLeft:{type:"number"},viewportEdgeFadeWidthRight:{type:"number"},viewportEdgeFadeWidthTop:{type:"number"},x:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the x axis."},x2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the x axis."},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Position on the y axis."},y2:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The secondary position on the y axis."},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},Title:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'Horizontal text alignment for title text. One of `"left"`, `"center"`, or `"right"`.'},anchor:{$ref:"#/definitions/TitleAnchor",description:'The anchor position for placing the title and subtitle text. One of `"start"`, `"middle"`, or `"end"`. For example, with an orientation of top these anchor positions map to a left-, center-, or right-aligned title.'},angle:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Angle in degrees of title and subtitle text."},baseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline for title and subtitle text. One of `"alphabetic"` (default), `"top"`, `"middle"`, or `"bottom"`.'},color:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"Text color for title text."},dx:{description:"Delta offset for title and subtitle text x-coordinate.",type:"number"},dy:{description:"Delta offset for title and subtitle text y-coordinate.",type:"number"},font:{description:"Font name for title text.",type:"string"},fontSize:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"Font size in pixels for title text.",minimum:0},fontStyle:{$ref:"#/definitions/FontStyle",description:"Font style for title text."},fontWeight:{$ref:"#/definitions/FontWeight",description:'Font weight for title text. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).'},frame:{$ref:"#/definitions/TitleFrame",description:'The reference frame for the anchor position, one of `"bounds"` (to anchor relative to the full bounding box) or `"group"` (to anchor relative to the group width or height).'},offset:{description:"The orthogonal offset in pixels by which to displace the title group from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/TitleOrient",description:'Default title orientation (`"top"`, `"bottom"`, `"left"`, or `"right"`)'},style:{description:'A mark style property to apply to the title text mark. If not specified, a default style of `"group-title"` is applied.',type:"string"},text:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The title text."}},required:["text"],type:"object"},TitleAnchor:{enum:[null,"start","middle","end"],type:["null","string"]},TitleFrame:{enum:["bounds","group"],type:"string"},TitleOrient:{enum:["none","left","right","top","bottom"],type:"string"},Tooltip:{anyOf:[{$ref:"#/definitions/HandledTooltip"},{type:"null"}]},TransformParams:{anyOf:[{$ref:"#/definitions/AggregateParams"},{$ref:"#/definitions/CollectParams"},{$ref:"#/definitions/CoverageParams"},{$ref:"#/definitions/FlattenDelimitedParams"},{$ref:"#/definitions/FormulaParams"},{$ref:"#/definitions/FilterParams"},{$ref:"#/definitions/FilterScoredLabelsParams"},{$ref:"#/definitions/FlattenParams"},{$ref:"#/definitions/FlattenCompressedExonsParams"},{$ref:"#/definitions/FlattenSequenceParams"},{$ref:"#/definitions/IdentifierParams"},{$ref:"#/definitions/LinearizeGenomicCoordinateParams"},{$ref:"#/definitions/MeasureTextParams"},{$ref:"#/definitions/MergeFacetsParams"},{$ref:"#/definitions/PileupParams"},{$ref:"#/definitions/ProjectParams"},{$ref:"#/definitions/RegexExtractParams"},{$ref:"#/definitions/RegexFoldParams"},{$ref:"#/definitions/SampleParams"},{$ref:"#/definitions/StackParams"}]},Type:{enum:["quantitative","ordinal","nominal","index","locus"],type:"string"},TypeForShape:{enum:["ordinal","nominal"],type:"string"},UnitSpec:{additionalProperties:!1,properties:{aggregateSamples:{description:"Specifies views that [aggregate](https://genomespy.app/docs/sample-collections/visualizing/#aggregation) multiple samples within the GenomeSpy App.",items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkProps"}],description:"The graphical mark presenting the data objects."},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:`Opacity of the view and all its children. Allows implementing semantic zooming where the layers are faded in and out as the user zooms in and out.

TODO: Write proper documentation with examples.

**Default:** \`1.0\``},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"The background of the view, including fill, stroke, and stroke width."},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["mark"],type:"object"},UrlData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},url:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"},{$ref:"#/definitions/ExprRef"}],description:"An URL or an array of URLs from which to load the data set. Use the `format.type` property to ensure the loaded data is correctly parsed."}},required:["url"],type:"object"},UrlGenomeConfig:{additionalProperties:!1,properties:{name:{description:"Name of the genome assembly, e.g., `hg19` or `hg38`.",type:"string"},url:{description:'A URL to a `chrom.sizes` file, which is a tab-separated file with two columns: the sequence name and its size.\n\nYou may want to strip alternative loci, haplotypes, and other non-canonical contigs from the file.\n\nExample: `"https://genomespy.app/data/genomes/hg19/chrom.sizes"`',type:"string"}},required:["name","url"],type:"object"},UrlImport:{additionalProperties:!1,properties:{url:{description:"Imports a specification from the specified URL.",type:"string"}},required:["url"],type:"object"},VConcatSpec:{additionalProperties:!1,properties:{baseUrl:{description:"The base URL for relative URL data sources and URL [imports](https://genomespy.app/docs/grammar/import/#importing-from-a-url). The base URLs are inherited in the view hierarchy unless overridden with this property. By default, the top-level view's base URL equals to the visualization specification's base URL.",type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the [GenomeSpy App](https://genomespy.app/docs/sample-collections/). Configurability requires that the view has an explicitly specified name that is *unique* in within the view hierarchy.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data",description:"Specifies a [data source](https://genomespy.app/docs/grammar/data/). If omitted, the data source is inherited from the parent view."},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Can be used for documentation. The description of the top-level view is shown in the toolbar of the [GenomeSpy App](https://genomespy.app/docs/sample-collections/)."},encoding:{$ref:"#/definitions/Encoding",description:"Specifies how data are [encoded](https://genomespy.app/docs/grammar/mark/#encoding) using the visual channels."},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Height of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default value:** `"container"`'},name:{description:"An internal name that can be used for referring the view. For referencing purposes, the name should be unique within the view hierarchy.",type:"string"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding applied to the view. Accepts either a number representing pixels or an object specifying separate paddings for each edge.\n\nExamples:\n- `padding: 10`\n- `padding: { top: 10, right: 20, bottom: 10, left: 20 }`\n\n**Default value:** `0`"},params:{description:"Dynamic variables that [parameterize](https://genomespy.app/docs/grammar/parameters/) a visualization.",items:{$ref:"#/definitions/Parameter"},type:"array"},resolve:{additionalProperties:!1,description:"Specifies how scales and axes are [resolved](https://genomespy.app/docs/grammar/composition/#scale-and-axis-resolution) in the view hierarchy.",properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{description:"The gap between the views, in pixels.",type:"number"},templates:{additionalProperties:{$ref:"#/definitions/ViewSpec"},description:"[Templates](https://genomespy.app/docs/grammar/import/#repeating-with-named-templates) that can be reused within the view specification by importing them with the template key.",type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}],description:"View title. N.B.: Currently, GenomeSpy doesn't do bound calculation, and you need to manually specify proper padding for the view to ensure that the title is visible."},transform:{description:"An array of [transformations](https://genomespy.app/docs/grammar/transform/) applied to the data before visual encoding.",items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{description:"Specifies views that will be concatenated vertically.",items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},viewportHeight:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport height of the view. If the view size exceeds the viewport height, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `height`)"},viewportWidth:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{const:"container",type:"string"}],description:"Optional viewport width of the view. If the view size exceeds the viewport width, it will be shown with [scrollbars](https://genomespy.app/docs/grammar/composition/concat/#scrollable-viewports). This property implicitly enables clipping.\n\n**Default:** `null` (same as `width`)"},visible:{description:"The default visibility of the view. An invisible view is removed from the layout and not rendered. For context, see [toggleable view visibility](https://genomespy.app/docs/sample-collections/visualizing/#toggleable-view-visibility).\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}],description:'Width of the view. If a number, it is interpreted as pixels. Check [child sizing](https://genomespy.app/docs/grammar/composition/concat/#child-sizing) for details.\n\n**Default:** `"container"`'}},required:["vconcat"],type:"object"},"ValueDef<number>":{additionalProperties:!1,properties:{title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},required:["value"],type:"object"},"ValueDefWithCondition<(string|null)>":{additionalProperties:!1,minProperties:1,properties:{condition:{anyOf:[{$ref:"#/definitions/Conditional%3CFieldDef%3E"},{$ref:"#/definitions/Conditional%3CDatumDef%3E"},{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(string%7Cnull%7CExprRef)%3E%3E"},type:"array"}],description:"A field definition or one or more value definition(s) with a parameter predicate."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"string"},{type:"null"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},type:"object"},"ValueDefWithCondition<number>":{additionalProperties:!1,minProperties:1,properties:{condition:{anyOf:[{$ref:"#/definitions/Conditional%3CFieldDef%3E"},{$ref:"#/definitions/Conditional%3CDatumDef%3E"},{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},{items:{$ref:"#/definitions/Conditional%3CValueDef%3C(number%7CExprRef)%3E%3E"},type:"array"}],description:"A field definition or one or more value definition(s) with a parameter predicate."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).'}},type:"object"},VariableParameter:{additionalProperties:!1,properties:{bind:{$ref:"#/definitions/Binding",description:"Binds the parameter to an external input element such as a slider, selection list or radio button group."},expr:{description:"An expression for the value of the parameter. This expression may include other parameters, in which case the parameter will automatically update in response to upstream parameter changes.",type:"string"},name:{description:'A unique name for the variable parameter. Parameter names should be valid JavaScript identifiers: they should contain only alphanumeric characters (or "$", or "_") and may not start with a digit. Reserved keywords that may not be used as parameter names are: "datum".',type:"string"},push:{const:"outer",type:"string"},value:{description:"The [initial value](http://vega.github.io/vega-lite/docs/value.html) of the parameter.\n\n__Default value:__ `undefined`"}},required:["name"],type:"object"},ViewBackground:{additionalProperties:!1,properties:{fill:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The fill color."},fillOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The fill opacity. Value between `0` and `1`."},stroke:{anyOf:[{type:"string"},{$ref:"#/definitions/ExprRef"}],description:"The stroke color"},strokeOpacity:{anyOf:[{type:"number"},{$ref:"#/definitions/ExprRef"}],description:"The stroke opacity. Value between `0` and `1`."},strokeWidth:{description:"The stroke width in pixels.",type:"number"}},type:"object"},ViewOpacityDef:{anyOf:[{type:"number"},{$ref:"#/definitions/DynamicOpacity"},{$ref:"#/definitions/ExprRef"}]},ViewSpec:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/VConcatSpec"},{$ref:"#/definitions/HConcatSpec"},{$ref:"#/definitions/ConcatSpec"},{$ref:"#/definitions/SampleSpec"}]},ZoomParams:{additionalProperties:!1,properties:{extent:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"The boundaries that limit the zoom and pan interactions."}},type:"object"}},EB={$ref:mNe,$schema:_Ne,definitions:bNe},vNe="@genome-spy/playground",yNe="0.52.0",wNe="A playground for testing GenomeSpy visualizations",CNe="module",SNe={dev:"vite",build:"vite build",serve:"vite preview"},xNe="Kari Lavikka",LNe="MIT",DNe={"@fortawesome/fontawesome-free":"^6.1.1","@fortawesome/fontawesome-svg-core":"^6.1.1","@fortawesome/free-solid-svg-icons":"^6.1.1","@genome-spy/core":"^0.52.0",lit:"^3.1.2","monaco-editor":"^0.44.0","vega-loader":"^4.4.0"},AB={name:vNe,private:!0,version:yNe,description:wNe,type:CNe,scripts:SNe,author:xNe,license:LNe,dependencies:DNe};/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.44.0(3e047efd345ff102c8c61b5398fb30845aaac166)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var kNe=Object.defineProperty,ENe=Object.getOwnPropertyDescriptor,ANe=Object.getOwnPropertyNames,INe=Object.prototype.hasOwnProperty,IB=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ANe(e))!INe.call(n,s)&&s!==t&&kNe(n,s,{get:()=>e[s],enumerable:!(i=ENe(e,s))||i.enumerable});return n},TNe=(n,e,t)=>(IB(n,e,"default"),t&&IB(t,e,"default")),Ly={};TNe(Ly,pNe);var NNe=class{constructor(n,e,t){Ui(this,"_onDidChange",new Ly.Emitter);Ui(this,"_diagnosticsOptions");Ui(this,"_modeConfiguration");Ui(this,"_languageId");this._languageId=n,this.setDiagnosticsOptions(e),this.setModeConfiguration(t)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(n){this._diagnosticsOptions=n||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(n){this._modeConfiguration=n||Object.create(null),this._onDidChange.fire(this)}},RNe={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},MNe={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},aY=new NNe("json",RNe,MNe);Ly.languages.json={jsonDefaults:aY};function PNe(){return Ys(()=>import("./jsonMode-khwP1fga.js"),__vite__mapDeps([]),import.meta.url)}Ly.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});Ly.languages.onLanguage("json",()=>{PNe().then(n=>n.setupMode(aY))});const ONe={0:" ",1:"u",2:"r"},TB=65535,zr=16777215,NB=4278190080;class HE{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,s=e%32,o=this._states[i];t?this._states[i]=o|1<<s:this._states[i]=o&~(1<<s)}}class go{constructor(e,t,i){if(e.length!==t.length||e.length>TB)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new HE(e.length),this._userDefinedStates=new HE(e.length),this._recoveredStates=new HE(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,s)=>{const o=e[e.length-1];return this.getStartLineNumber(o)<=i&&this.getEndLineNumber(o)>=s};for(let i=0,s=this._startIndexes.length;i<s;i++){const o=this._startIndexes[i],r=this._endIndexes[i];if(o>zr||r>zr)throw new Error("startLineNumber or endLineNumber must not exceed "+zr);for(;e.length>0&&!t(o,r);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=o+((a&255)<<24),this._endIndexes[i]=r+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&zr}getEndLineNumber(e){return this._endIndexes[e]&zr}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let s=0;s<this._types.length;s++)this._types[s]===e&&(this.setCollapsed(s,t),i=!0);return i}toRegion(e){return new FNe(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&NB)>>>24)+((this._endIndexes[e]&NB)>>>16);return t===TB?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const s=Math.floor((t+i)/2);e<this.getStartLineNumber(s)?i=s:t=s+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${ONe[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&zr,endLineNumber:this._endIndexes[e]&zr,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),s=new Uint32Array(t);let o=[],r=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,s[l]=c.endLineNumber,o.push(c.type),c.type&&(r=!0)}r||(o=void 0);const a=new go(i,s,o);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i){i=i??Number.MAX_VALUE;const s=(p,_)=>Array.isArray(p)?v=>v<_?p[v]:void 0:v=>v<_?p.toFoldRange(v):void 0,o=s(e,e.length),r=s(t,t.length);let a=0,l=0,c=o(0),d=r(0);const u=[];let h,f=0;const g=[];for(;c||d;){let p;if(d&&(!c||c.startLineNumber>=d.startLineNumber))c&&c.startLineNumber===d.startLineNumber?(d.source===1?p=d:(p=c,p.isCollapsed=d.isCollapsed&&c.endLineNumber===d.endLineNumber,p.source=0),c=o(++a)):(p=d,d.isCollapsed&&d.source===0&&(p.source=2)),d=r(++l);else{let _=l,v=d;for(;;){if(!v||v.startLineNumber>c.endLineNumber){p=c;break}if(v.source===1&&v.endLineNumber>c.endLineNumber)break;v=r(++_)}c=o(++a)}if(p){for(;h&&h.endLineNumber<p.startLineNumber;)h=u.pop();p.endLineNumber>p.startLineNumber&&p.startLineNumber>f&&p.endLineNumber<=i&&(!h||h.endLineNumber>=p.endLineNumber)&&(g.push(p),f=p.startLineNumber,h&&u.push(h),h=p)}}return g}}class FNe{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class BNe{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new B,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new go(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,s)=>i.regionIndex-s.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let s=0,o=-1,r=-1;const a=l=>{for(;s<l;){const c=this._regions.getEndLineNumber(s),d=this._regions.isCollapsed(s);if(c<=o){const u=this.regions.getSource(s)!==0;i.changeDecorationOptions(this._editorDecorationIds[s],this._decorationProvider.getDecorationOption(d,c<=r,u))}d&&c>r&&(r=c),s++}};for(const l of e){const c=l.regionIndex,d=this._editorDecorationIds[c];if(d&&!t[d]){t[d]=!0,a(c);const u=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,u),o=Math.max(o,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=s=>{for(const o of e)if(!(o.startLineNumber>s.endLineNumber||s.startLineNumber>o.endLineNumber))return!0;return!1};for(let s=0;s<this._regions.length;s++){const o=this._regions.toFoldRange(s);(o.source===0||!i(o))&&t.push(o)}this.updatePost(go.fromFoldRanges(t))}update(e,t=[]){const i=this._currentFoldedOrManualRanges(t),s=go.sanitizeAndMerge(e,i,this._textModel.getLineCount());this.updatePost(go.fromFoldRanges(s))}updatePost(e){const t=[];let i=-1;for(let s=0,o=e.length;s<o;s++){const r=e.getStartLineNumber(s),a=e.getEndLineNumber(s),l=e.isCollapsed(s),c=e.getSource(s)!==0,d={startLineNumber:r,startColumn:this._textModel.getLineMaxColumn(r),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(s=>this._editorDecorationIds=s.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e=[]){const t=(s,o)=>{for(const r of e)if(s<r&&r<=o)return!0;return!1},i=[];for(let s=0,o=this._regions.length;s<o;s++){let r=this.regions.isCollapsed(s);const a=this.regions.getSource(s);if(r||a!==0){const l=this._regions.toFoldRange(s),c=this._textModel.getDecorationRange(this._editorDecorationIds[s]);c&&(r&&t(c.startLineNumber,c.endLineNumber)&&(r=!1),i.push({startLineNumber:c.startLineNumber,endLineNumber:c.endLineNumber,type:l.type,isCollapsed:r,source:a}))}}return i}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let s=0,o=e.length;s<o;s++){const r=e[s];if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>i)continue;const a=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,isCollapsed:r.isCollapsed,source:r.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){var t,i;if(!Array.isArray(e))return;const s=[],o=this._textModel.getLineCount();for(const a of e){if(a.startLineNumber>=a.endLineNumber||a.startLineNumber<1||a.endLineNumber>o)continue;const l=this._getLinesChecksum(a.startLineNumber+1,a.endLineNumber);(!a.checksum||l===a.checksum)&&s.push({startLineNumber:a.startLineNumber,endLineNumber:a.endLineNumber,type:void 0,isCollapsed:(t=a.isCollapsed)!==null&&t!==void 0?t:!0,source:(i=a.source)!==null&&i!==void 0?i:0})}const r=go.sanitizeAndMerge(this._regions,s,o);this.updatePost(go.fromFoldRanges(r))}_getLinesChecksum(e,t){return O0e(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let s=this._regions.findRange(e),o=1;for(;s>=0;){const r=this._regions.toRegion(s);(!t||t(r,o))&&i.push(r),o++,s=r.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],s=e?e.regionIndex+1:0,o=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const r=[];for(let a=s,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<o){for(;r.length>0&&!c.containedBy(r[r.length-1]);)r.pop();r.push(c),t(c,r.length)&&i.push(c)}else break}}else for(let r=s,a=this._regions.length;r<a;r++){const l=this._regions.toRegion(r);if(this._regions.getStartLineNumber(r)<o)(!t||t(l))&&i.push(l);else break}return i}}function WNe(n,e,t){const i=[];for(const s of t){const o=n.getRegionAtLine(s);if(o){const r=!o.isCollapsed;if(i.push(o),e>1){const a=n.getRegionsInside(o,(l,c)=>l.isCollapsed!==r&&c<e);i.push(...a)}}}n.toggleCollapseState(i)}function l0(n,e,t=Number.MAX_VALUE,i){const s=[];if(i&&i.length>0)for(const o of i){const r=n.getRegionAtLine(o);if(r&&(r.isCollapsed!==e&&s.push(r),t>1)){const a=n.getRegionsInside(r,(l,c)=>l.isCollapsed!==e&&c<t);s.push(...a)}}else{const o=n.getRegionsInside(null,(r,a)=>r.isCollapsed!==e&&a<t);s.push(...o)}n.toggleCollapseState(s)}function lY(n,e,t,i){const s=[];for(const o of i){const r=n.getAllRegionsAtLine(o,(a,l)=>a.isCollapsed!==e&&l<=t);s.push(...r)}n.toggleCollapseState(s)}function VNe(n,e,t){const i=[];for(const s of t){const o=n.getAllRegionsAtLine(s,r=>r.isCollapsed!==e);o.length>0&&i.push(o[0])}n.toggleCollapseState(i)}function zNe(n,e,t,i){const s=(r,a)=>a===e&&r.isCollapsed!==t&&!i.some(l=>r.containsLine(l)),o=n.getRegionsInside(null,s);n.toggleCollapseState(o)}function cY(n,e,t){const i=[];for(const r of t){const a=n.getAllRegionsAtLine(r,void 0);a.length>0&&i.push(a[0])}const s=r=>i.every(a=>!a.containedBy(r)&&!r.containedBy(a))&&r.isCollapsed!==e,o=n.getRegionsInside(null,s);n.toggleCollapseState(o)}function X3(n,e,t){const i=n.textModel,s=n.regions,o=[];for(let r=s.length-1;r>=0;r--)if(t!==s.isCollapsed(r)){const a=s.getStartLineNumber(r);e.test(i.getLineContent(a))&&o.push(s.toRegion(r))}n.toggleCollapseState(o)}function Q3(n,e,t){const i=n.regions,s=[];for(let o=i.length-1;o>=0;o--)t!==i.isCollapsed(o)&&e===i.getType(o)&&s.push(i.toRegion(o));n.toggleCollapseState(s)}function HNe(n,e){let t=null;const i=e.getRegionAtLine(n);if(i!==null&&(t=i.startLineNumber,n===t)){const s=i.parentIndex;s!==-1?t=e.regions.getStartLineNumber(s):t=null}return t}function $Ne(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){if(n!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let s=0;for(i!==-1&&(s=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=s)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<n)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function UNe(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){const i=t.parentIndex;let s=0;if(i!==-1)s=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;s=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=s)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>n)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class jNe{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new B,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||_f(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,s=0,o=Number.MAX_VALUE,r=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);o<=l&&c<=r||(!e&&s<this._hiddenRanges.length&&this._hiddenRanges[s].startLineNumber===l&&this._hiddenRanges[s].endLineNumber===c?(t.push(this._hiddenRanges[s]),s++):(e=!0,t.push(new N(l,1,c,1))),o=l,r=c)}(this._hasLineChanges||e||s<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return RB(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let s=null;const o=r=>((!s||!qNe(r,s))&&(s=RB(this._hiddenRanges,r)),s?s.startLineNumber-1:null);for(let r=0,a=e.length;r<a;r++){let l=e[r];const c=o(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const d=o(l.endLineNumber);d&&(l=l.setEndPosition(d,i.getLineMaxColumn(d)),t=!0),e[r]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function qNe(n,e){return n>=e.startLineNumber&&n<=e.endLineNumber}function RB(n,e){const t=qb(n,i=>e<i.startLineNumber)-1;return t>=0&&n[t].endLineNumber>=e?n[t]:null}const GNe=5e3,KNe="indent";class dY{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=KNe}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,s=t&&t.markers;return Promise.resolve(XNe(this.editorModel,i,s,this.foldingRangesLimit))}}let YNe=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>zr||t>zr)return;const s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),s=new Uint32Array(this._length);for(let o=this._length-1,r=0;o>=0;o--,r++)i[r]=this._startIndexes[o],s[r]=this._endIndexes[o];return new go(i,s)}else{this._foldingRangesLimit.update(this._length,t);let i=0,s=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){s=l;break}i+=c}}const o=e.getOptions().tabSize,r=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const d=this._startIndexes[l],u=e.getLineContent(d),h=qD(u,o);(h<s||h===s&&i++<t)&&(r[c]=d,a[c]=this._endIndexes[l],c++)}return new go(r,a)}}};const ZNe={limit:GNe,update:()=>{}};function XNe(n,e,t,i=ZNe){const s=n.getOptions().tabSize,o=new YNe(i);let r;t&&(r=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=n.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=n.getLineCount();c>0;c--){const d=n.getLineContent(c),u=qD(d,s);let h=a[a.length-1];if(u===-1){e&&(h.endAbove=c);continue}let f;if(r&&(f=d.match(r)))if(f[1]){let g=a.length-1;for(;g>0&&a[g].indent!==-2;)g--;if(g>0){a.length=g+1,h=a[g],o.insertFirst(c,h.line,u),h.line=c,h.indent=u,h.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(h.indent>u){do a.pop(),h=a[a.length-1];while(h.indent>u);const g=h.endAbove-1;g-c>=1&&o.insertFirst(c,g,u)}h.indent===u?h.endAbove=c:a.push({indent:u,endAbove:c,line:c})}return o.toIndentRanges(n)}const QNe=E("editor.foldBackground",{light:Ce(ld,.3),dark:Ce(ld,.3),hcDark:null,hcLight:null},m("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);E("editorGutter.foldingControlForeground",{dark:ad,light:ad,hcDark:ad,hcLight:ad},m("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const J3=Yi("folding-expanded",se.chevronDown,m("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),e5=Yi("folding-collapsed",se.chevronRight,m("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),uY=Yi("folding-manual-collapsed",e5,m("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),hY=Yi("folding-manual-expanded",J3,m("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),t5={color:sn(QNe),position:Xs.Inline};class Ei{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?Ei.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?Ei.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:Ei.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:Ei.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?Ei.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Ei.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?Ei.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Ei.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?Ei.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:Ei.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?Ei.MANUALLY_EXPANDED_VISUAL_DECORATION:Ei.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}}Ei.COLLAPSED_VISUAL_DECORATION=et.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(e5)});Ei.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=et.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:t5,isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(e5)});Ei.MANUALLY_COLLAPSED_VISUAL_DECORATION=et.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(uY)});Ei.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=et.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:t5,isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(uY)});Ei.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=et.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0});Ei.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=et.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:t5,isWholeLine:!0});Ei.EXPANDED_VISUAL_DECORATION=et.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ne.asClassName(J3)});Ei.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=et.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(J3)});Ei.MANUALLY_EXPANDED_VISUAL_DECORATION=et.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+Ne.asClassName(hY)});Ei.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=et.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:Ne.asClassName(hY)});Ei.NO_CONTROLS_EXPANDED_RANGE_DECORATION=et.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0});Ei.HIDDEN_RANGE_DECORATION=et.register({description:"folding-hidden-range-decoration",stickiness:1});const JNe={},eRe="syntax";class fY{constructor(e,t,i,s,o){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=s,this.fallbackRangeProvider=o,this.id=eRe,this.disposables=new pe,o&&this.disposables.add(o);for(const r of t)typeof r.onDidChange=="function"&&this.disposables.add(r.onDidChange(i))}compute(e){return tRe(this.providers,this.editorModel,e).then(t=>{var i,s;return t?nRe(t,this.foldingRangesLimit):(s=(i=this.fallbackRangeProvider)===null||i===void 0?void 0:i.compute(e))!==null&&s!==void 0?s:null})}dispose(){this.disposables.dispose()}}function tRe(n,e,t){let i=null;const s=n.map((o,r)=>Promise.resolve(o.provideFoldingRanges(e,JNe,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:r,kind:c.kind})}},bc));return Promise.all(s).then(o=>i)}class iRe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,s){if(e>zr||t>zr)return;const o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=t,this._nestingLevels[o]=s,this._types[o]=i,this._length++,s<30&&(this._nestingLevelCounts[s]=(this._nestingLevelCounts[s]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let s=0;s<this._length;s++)t[s]=this._startIndexes[s],i[s]=this._endIndexes[s];return new go(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const s=new Uint32Array(e),o=new Uint32Array(e),r=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(s[l]=this._startIndexes[a],o[l]=this._endIndexes[a],r[l]=this._types[a],l++)}return new go(s,o,r)}}}function nRe(n,e){const t=n.sort((r,a)=>{let l=r.start-a.start;return l===0&&(l=r.rank-a.rank),l}),i=new iRe(e);let s;const o=[];for(const r of t)if(!s)s=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else if(r.start>s.start)if(r.end<=s.end)o.push(s),s=r,i.add(r.start,r.end,r.kind&&r.kind.value,o.length);else{if(r.start>s.end){do s=o.pop();while(s&&r.start>s.end);s&&o.push(s),s=r}i.add(r.start,r.end,r.kind&&r.kind.value,o.length)}return i.toIndentRanges()}var sRe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},B0=function(n,e){return function(t,i){e(t,i,n)}},oRe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},kg;const zn=new _e("foldingEnabled",!1);let wf=kg=class extends Y{static get(e){return e.getContribution(kg.ID)}static getFoldingRangeProviders(e,t){var i,s;const o=e.foldingRangeProvider.ordered(t);return(s=(i=kg._foldingRangeSelector)===null||i===void 0?void 0:i.call(kg,o,t))!==null&&s!==void 0?s:o}constructor(e,t,i,s,o,r){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=r,this.localToDispose=this._register(new pe),this.editor=e,this._foldingLimitReporter=new rRe(e);const a=this.editor.getOptions();this._isEnabled=a.get(43),this._useFoldingProviders=a.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(46),this.updateDebounceInfo=o.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new Ei(e),this.foldingDecorationProvider.showFoldingControls=a.get(109),this.foldingDecorationProvider.showFoldingHighlights=a.get(45),this.foldingEnabled=zn.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(47)&&this.onModelChanged(),l.hasChanged(109)||l.hasChanged(45)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(109),this.foldingDecorationProvider.showFoldingHighlights=c.get(45),this.triggerFoldingModelChanged()}l.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),l.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new BNe(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new jNe(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new xu(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new Li(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{var t,i;this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),(t=this.updateScheduler)===null||t===void 0||t.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,(i=this.rangeProvider)===null||i===void 0||i.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){var e;(e=this.rangeProvider)===null||e===void 0||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new dY(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=kg.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new fY(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;(t=this.hiddenRangeModel)===null||t===void 0||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new yu,i=this.getRangeProvider(e.textModel),s=this.foldingRegionPromise=wc(o=>i.compute(o));return s.then(o=>{if(o&&s===this.foldingRegionPromise){let r;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const d=o.setCollapsedAllOfType(as.Imports.value,!0);d&&(r=Iv.capture(this.editor),this._currentModelHasFoldedImports=d)}const a=this.editor.getSelections(),l=a?a.map(d=>d.startLineNumber):[];e.update(o,l),r==null||r.restore(this.editor);const c=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=c)}return e})}).then(void 0,e=>(mt(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const s=[];for(const o of i){const r=o.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(r)&&s.push(...t.getAllRegionsAtLine(r,a=>a.isCollapsed&&r>a.startLineNumber))}s.length&&(t.toggleCollapseState(s),this.reveal(i[0].getPosition()))}}}).then(void 0,mt)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const s=e.target.detail,o=e.target.element.offsetLeft;if(s.offsetX-o<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const s=this.editor.getModel();if(s&&t.startColumn===s.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,s=this.mouseDownInfo.iconClicked,o=e.target.range;if(!o||o.startLineNumber!==i)return;if(s){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||o.startColumn!==a.getLineMaxColumn(i))return}const r=t.getRegionAtLine(i);if(r&&r.startLineNumber===i){const a=r.isCollapsed;if(s||a){const l=e.event.altKey;let c=[];if(l){const d=h=>!h.containedBy(r)&&!r.containedBy(h),u=t.getRegionsInside(null,d);for(const h of u)h.isCollapsed&&c.push(h);c.length===0&&(c=u)}else{const d=e.event.middleButton||e.event.shiftKey;if(d)for(const u of t.getRegionsInside(r))u.isCollapsed===a&&c.push(u);(a||!d||c.length===0)&&c.push(r)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};wf.ID="editor.contrib.folding";wf=kg=sRe([B0(1,tt),B0(2,oo),B0(3,Ln),B0(4,SG),B0(5,nt)],wf);class rRe{constructor(e){this.editor=e,this._onDidChange=new B,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class Jn extends Xt{runEditorCommand(e,t,i){const s=e.get(oo),o=wf.get(t);if(!o)return;const r=o.getFoldingModel();if(r)return this.reportTelemetry(e,t),r.then(a=>{if(a){this.invoke(o,a,t,i,s);const l=t.getSelection();l&&o.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function gY(n){if(!qs(n)){if(!Ls(n))return!1;const e=n;if(!qs(e.levels)&&!Xd(e.levels)||!qs(e.direction)&&!Ns(e.direction)||!qs(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(Xd)))return!1}return!0}class aRe extends Jn{constructor(){super({id:"editor.unfold",label:m("unfoldAction.label","Unfold"),alias:"Unfold",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:gY,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){const o=s&&s.levels||1,r=this.getLineNumbers(s,i);s&&s.direction==="up"?lY(t,!1,o,r):l0(t,!1,o,r)}}class lRe extends Jn{constructor(){super({id:"editor.unfoldRecursively",label:m("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2142),weight:100}})}invoke(e,t,i,s){l0(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class cRe extends Jn{constructor(){super({id:"editor.fold",label:m("foldAction.label","Fold"),alias:"Fold",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:gY,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,s){const o=this.getLineNumbers(s,i),r=s&&s.levels,a=s&&s.direction;typeof r!="number"&&typeof a!="string"?VNe(t,!0,o):a==="up"?lY(t,!0,r||1,o):l0(t,!0,r||1,o)}}class dRe extends Jn{constructor(){super({id:"editor.toggleFold",label:m("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2090),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);WNe(t,1,s)}}class uRe extends Jn{constructor(){super({id:"editor.foldRecursively",label:m("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2140),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);l0(t,!0,Number.MAX_VALUE,s)}}class hRe extends Jn{constructor(){super({id:"editor.foldAllBlockComments",label:m("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2138),weight:100}})}invoke(e,t,i,s,o){if(t.regions.hasTypes())Q3(t,as.Comment.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+br(a.blockCommentStartToken));X3(t,l,!0)}}}}class fRe extends Jn{constructor(){super({id:"editor.foldAllMarkerRegions",label:m("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2077),weight:100}})}invoke(e,t,i,s,o){if(t.regions.hasTypes())Q3(t,as.Region.value,!0);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);X3(t,l,!0)}}}}class gRe extends Jn{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:m("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2078),weight:100}})}invoke(e,t,i,s,o){if(t.regions.hasTypes())Q3(t,as.Region.value,!1);else{const r=i.getModel();if(!r)return;const a=o.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);X3(t,l,!1)}}}}class pRe extends Jn{constructor(){super({id:"editor.foldAllExcept",label:m("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2136),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);cY(t,!0,s)}}class mRe extends Jn{constructor(){super({id:"editor.unfoldAllExcept",label:m("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2134),weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);cY(t,!1,s)}}class _Re extends Jn{constructor(){super({id:"editor.foldAll",label:m("foldAllAction.label","Fold All"),alias:"Fold All",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2069),weight:100}})}invoke(e,t,i){l0(t,!0)}}class bRe extends Jn{constructor(){super({id:"editor.unfoldAll",label:m("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2088),weight:100}})}invoke(e,t,i){l0(t,!1)}}class Cf extends Jn{getFoldingLevel(){return parseInt(this.id.substr(Cf.ID_PREFIX.length))}invoke(e,t,i){zNe(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}Cf.ID_PREFIX="editor.foldLevel";Cf.ID=n=>Cf.ID_PREFIX+n;class vRe extends Jn{constructor(){super({id:"editor.gotoParentFold",label:m("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const o=HNe(s[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class yRe extends Jn{constructor(){super({id:"editor.gotoPreviousFold",label:m("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const o=$Ne(s[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class wRe extends Jn{constructor(){super({id:"editor.gotoNextFold",label:m("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,weight:100}})}invoke(e,t,i){const s=this.getSelectedLines(i);if(s.length>0){const o=UNe(s[0],t);o!==null&&i.setSelection({startLineNumber:o,startColumn:1,endLineNumber:o,endColumn:1})}}}class CRe extends Jn{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:m("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2135),weight:100}})}invoke(e,t,i){var s;const o=[],r=i.getSelections();if(r){for(const a of r){let l=a.endLineNumber;a.endColumn===1&&--l,l>a.startLineNumber&&(o.push({startLineNumber:a.startLineNumber,endLineNumber:l,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:a.startLineNumber,startColumn:1,endLineNumber:a.startLineNumber,endColumn:1}))}if(o.length>0){o.sort((l,c)=>l.startLineNumber-c.startLineNumber);const a=go.sanitizeAndMerge(t.regions,o,(s=i.getModel())===null||s===void 0?void 0:s.getLineCount());t.updatePost(go.fromFoldRanges(a))}}}}class SRe extends Jn{constructor(){super({id:"editor.removeManualFoldingRanges",label:m("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2137),weight:100}})}invoke(e,t,i){const s=i.getSelections();if(s){const o=[];for(const r of s){const{startLineNumber:a,endLineNumber:l}=r;o.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(o),e.triggerFoldingModelChanged()}}}Lr(wf.ID,wf,0);Xe(aRe);Xe(lRe);Xe(cRe);Xe(uRe);Xe(_Re);Xe(bRe);Xe(hRe);Xe(fRe);Xe(gRe);Xe(pRe);Xe(mRe);Xe(dRe);Xe(vRe);Xe(yRe);Xe(wRe);Xe(CRe);Xe(SRe);for(let n=1;n<=7;n++)Rme(new Cf({id:Cf.ID(n),label:m("foldLevelAction.label","Fold Level {0}",n),alias:`Fold Level ${n}`,precondition:zn,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2048|21+n),weight:100}}));Kt.registerCommand("_executeFoldingRangeProvider",function(n,...e){return oRe(this,void 0,void 0,function*(){const[t]=e;if(!(t instanceof je))throw ic();const i=n.get(nt),s=n.get(hs).getModel(t);if(!s)throw ic();const o=n.get(ti);if(!o.getValue("editor.folding",{resource:t}))return[];const r=n.get(oo),a=o.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return o.getValue("editor.foldingMaximumRegions",{resource:t})},update:(f,g)=>{}},c=new dY(s,r,l);let d=c;if(a!=="indentation"){const f=wf.getFoldingRangeProviders(i,s);f.length&&(d=new fY(s,f,()=>{},l,c))}const u=yield d.compute(rn.None),h=[];try{if(u)for(let f=0;f<u.length;f++){const g=u.getType(f);h.push({start:u.getStartLineNumber(f),end:u.getEndLineNumber(f),kind:g?as.fromValue(g):void 0})}return h}finally{d.dispose()}})});class qn{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const s=i.options;if(s===qn._FIND_MATCH_DECORATION||s===qn._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let s=0,o=this._decorations.length;s<o;s++){const r=this._editor.getModel().getDecorationRange(this._decorations[s]);if(e.equalsRange(r)){t=this._decorations[s],i=s+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(s=>{if(this._highlightedDecorationId!==null&&(s.changeDecorationOptions(this._highlightedDecorationId,qn._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,s.changeDecorationOptions(this._highlightedDecorationId,qn._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(s.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let o=this._editor.getModel().getDecorationRange(t);if(o.startLineNumber!==o.endLineNumber&&o.endColumn===1){const r=o.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(r);o=new N(o.startLineNumber,o.startColumn,r,a)}this._rangeHighlightDecorationId=s.addDecoration(o,qn._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let s=qn._FIND_MATCH_DECORATION;const o=[];if(e.length>1e3){s=qn._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,d=Math.max(2,Math.ceil(3/c));let u=e[0].range.startLineNumber,h=e[0].range.endLineNumber;for(let f=1,g=e.length;f<g;f++){const p=e[f].range;h+d>=p.startLineNumber?p.endLineNumber>h&&(h=p.endLineNumber):(o.push({range:new N(u,1,h,1),options:qn._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),u=p.startLineNumber,h=p.endLineNumber)}o.push({range:new N(u,1,h,1),options:qn._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const r=new Array(e.length);for(let a=0,l=e.length;a<l;a++)r[a]={range:e[a].range,options:s};this._decorations=i.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,o),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t!=null&&t.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,qn._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],s=this._editor.getModel().getDecorationRange(i);if(!(!s||s.endLineNumber>e.lineNumber)){if(s.endLineNumber<e.lineNumber)return s;if(!(s.endColumn>e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const s=this._decorations[t],o=this._editor.getModel().getDecorationRange(s);if(!(!o||o.startLineNumber<e.lineNumber)){if(o.startLineNumber>e.lineNumber)return o;if(!(o.startColumn<e.column))return o}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}qn._CURRENT_FIND_MATCH_DECORATION=et.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:sn(TP),position:jo.Center},minimap:{color:sn(jg),position:Xs.Inline}});qn._FIND_MATCH_DECORATION=et.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:sn(TP),position:jo.Center},minimap:{color:sn(jg),position:Xs.Inline}});qn._FIND_MATCH_NO_OVERVIEW_DECORATION=et.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0});qn._FIND_MATCH_ONLY_OVERVIEW_DECORATION=et.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:sn(TP),position:jo.Center}});qn._RANGE_HIGHLIGHT_DECORATION=et.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0});qn._FIND_SCOPE_DECORATION=et.register({description:"find-scope",className:"findScope",isWholeLine:!0});class xRe{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let r=0;r<this._ranges.length;r++)i.push({range:this._ranges[r],text:this._replaceStrings[r]});i.sort((r,a)=>N.compareRangesUsingStarts(r.range,a.range));const s=[];let o=i[0];for(let r=1;r<i.length;r++)o.range.endLineNumber===i[r].range.startLineNumber&&o.range.endColumn===i[r].range.startColumn?(o.range=o.range.plusRange(i[r].range),o.text=o.text+i[r].text):(s.push(o),o=i[r]);s.push(o);for(const r of s)t.addEditOperation(r.range,r.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function pY(n,e){if(n&&n[0]!==""){const t=MB(n,e,"-"),i=MB(n,e,"_");return t&&!i?PB(n,e,"-"):!t&&i?PB(n,e,"_"):n[0].toUpperCase()===n[0]?e.toUpperCase():n[0].toLowerCase()===n[0]?e.toLowerCase():Qge(n[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):n[0][0].toUpperCase()!==n[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function MB(n,e,t){return n[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&n[0].split(t).length===e.split(t).length}function PB(n,e,t){const i=e.split(t),s=n[0].split(t);let o="";return i.forEach((r,a)=>{o+=pY([s[a]],r)+t}),o.slice(0,-1)}class OB{constructor(e){this.staticValue=e,this.kind=0}}class LRe{constructor(e){this.pieces=e,this.kind=1}}class Bm{static fromStaticValue(e){return new Bm([Jh.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new OB(""):e.length===1&&e[0].staticValue!==null?this._state=new OB(e[0].staticValue):this._state=new LRe(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?pY(e,this._state.staticValue):this._state.staticValue;let i="";for(let s=0,o=this._state.pieces.length;s<o;s++){const r=this._state.pieces[s];if(r.staticValue!==null){i+=r.staticValue;continue}let a=Bm._substitute(r.matchIndex,e);if(r.caseOps!==null&&r.caseOps.length>0){const l=[],c=r.caseOps.length;let d=0;for(let u=0,h=a.length;u<h;u++){if(d>=c){l.push(a.slice(u));break}switch(r.caseOps[d]){case"U":l.push(a[u].toUpperCase());break;case"u":l.push(a[u].toUpperCase()),d++;break;case"L":l.push(a[u].toLowerCase());break;case"l":l.push(a[u].toLowerCase()),d++;break;default:l.push(a[u])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class Jh{static staticValue(e){return new Jh(e,-1,null)}static caseOps(e,t){return new Jh(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class DRe{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Jh.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=Jh.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Jh.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new Bm(this._result)}}function kRe(n){if(!n||n.length===0)return new Bm(null);const e=[],t=new DRe(n);for(let i=0,s=n.length;i<s;i++){const o=n.charCodeAt(i);if(o===92){if(i++,i>=s)break;const r=n.charCodeAt(i);switch(r){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(r));break}continue}if(o===36){if(i++,i>=s)break;const r=n.charCodeAt(i);if(r===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(r===48||r===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=r&&r<=57){let a=r-48;if(i+1<s){const l=n.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const Dc=new _e("findWidgetVisible",!1);Dc.toNegated();const wk=new _e("findInputFocussed",!1),i5=new _e("replaceInputFocussed",!1),jw={primary:545,mac:{primary:2593}},qw={primary:565,mac:{primary:2613}},Gw={primary:560,mac:{primary:2608}},Kw={primary:554,mac:{primary:2602}},Yw={primary:558,mac:{primary:2606}},Mt={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},_d=19999,ERe=240;class Y_{constructor(e,t){this._toDispose=new pe,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new Cc,this._decorations=new qn(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new Li(()=>this.research(!1),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,Ft(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},ERe)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new N(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const s=this._findMatches(i,!1,_d);this._decorations.set(s,i);const o=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(o);if(r===0&&s.length>0){const a=qb(s.map(l=>l.range),l=>N.compareRangesUsingStarts(l,o)>=0);r=a>0?a-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const o=this._editor.getModel();return t||s===1?(i===1?i=o.getLineCount():i--,s=o.getLineMaxColumn(i)):s--,new V(i,s)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const d=this._decorations.matchAfterPosition(e);d&&this._setCurrentFindMatch(d);return}if(this._decorations.getCount()<_d){let d=this._decorations.matchBeforePosition(e);d&&d.isEmpty()&&d.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),d=this._decorations.matchBeforePosition(e)),d&&this._setCurrentFindMatch(d);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),s=Y_._getSearchRange(this._editor.getModel(),i);s.getEndPosition().isBefore(e)&&(e=s.getEndPosition()),e.isBefore(s.getStartPosition())&&(e=s.getEndPosition());const{lineNumber:o,column:r}=e,a=this._editor.getModel();let l=new V(o,r),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,!1)),!!c){if(!t&&!s.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:s}=e;const o=this._editor.getModel();return t||s===o.getLineMaxColumn(i)?(i===o.getLineCount()?i=1:i++,s=1):s++,new V(i,s)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<_d){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,s=!1){if(this._cannotFind())return null;const o=this._decorations.getFindScope(),r=Y_._getSearchRange(this._editor.getModel(),o);r.getEndPosition().isBefore(e)&&(e=r.getStartPosition()),e.isBefore(r.getStartPosition())&&(e=r.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let d=new V(a,l),u=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t);return i&&u&&u.range.isEmpty()&&u.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),u=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t)),u?!s&&!r.containsRange(u.range)?this._getNextMatch(u.range.getEndPosition(),t,i,!0):u:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?kRe(this._state.replaceString):Bm.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const s=e.buildReplaceString(i.matches,this._state.preserveCase),o=new vs(t,s);this._executeEditorCommand("replace",o),this._decorations.setStartPosition(new V(t.startLineNumber,t.startColumn+s.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const s=(e||[null]).map(o=>Y_._getSearchRange(this._editor.getModel(),o));return this._editor.getModel().findMatches(this._state.searchString,s,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=_d?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new Qu(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(129):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let u="mu";i.ignoreCase&&(u+="i"),i.global&&(u+="g"),i=new RegExp(i.source,u)}const s=this._editor.getModel(),o=s.getValue(1),r=s.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=o.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=o.replace(i,a.buildReplaceString(null,c));const d=new Oq(r,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",d)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),s=[];for(let r=0,a=i.length;r<a;r++)s[r]=t.buildReplaceString(i[r].matches,this._state.preserveCase);const o=new xRe(this._editor.getSelection(),i.map(r=>r.range),s);this._executeEditorCommand("replaceAll",o)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(o=>new lt(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn));const s=this._editor.getSelection();for(let o=0,r=i.length;o<r;o++)if(i[o].equalsRange(s)){i=[s].concat(i.slice(0,o)).concat(i.slice(o+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class Ck extends la{constructor(e,t,i){super(),this._hideSoon=this._register(new Li(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s={inputActiveOptionBorder:re(EP),inputActiveOptionForeground:re(AP),inputActiveOptionBackground:re(Ch)};this.caseSensitive=this._register(new rK(Object.assign({appendTitle:this._keybindingLabelFor(Mt.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase},s))),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new aK(Object.assign({appendTitle:this._keybindingLabelFor(Mt.ToggleWholeWordCommand),isChecked:this._state.wholeWord},s))),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new lK(Object.assign({appendTitle:this._keybindingLabelFor(Mt.ToggleRegexCommand),isChecked:this._state.isRegex},s))),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(o=>{let r=!1;o.isRegex&&(this.regex.checked=this._state.isRegex,r=!0),o.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,r=!0),o.matchCase&&(this.caseSensitive.checked=this._state.matchCase,r=!0),!this._state.isRevealed&&r&&this._revealTemporarily()})),this._register(K(this._domNode,de.MOUSE_LEAVE,o=>this._onMouseLeave())),this._register(K(this._domNode,"mouseover",o=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return Ck.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}}Ck.ID="editor.contrib.findOptionsWidget";function Zw(n,e){return n===1?!0:n===2?!1:e}class ARe extends Y{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return Zw(this._isRegexOverride,this._isRegex)}get wholeWord(){return Zw(this._wholeWordOverride,this._wholeWord)}get matchCase(){return Zw(this._matchCaseOverride,this._matchCase)}get preserveCase(){return Zw(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new B),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const s={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let o=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,s.matchesPosition=!0,o=!0),this._matchesCount!==t&&(this._matchesCount=t,s.matchesCount=!0,o=!0),typeof i<"u"&&(N.equalsRange(this._currentMatch,i)||(this._currentMatch=i,s.currentMatch=!0,o=!0)),o&&this._onFindReplaceStateChange.fire(s)}change(e,t,i=!0){var s;const o={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let r=!1;const a=this.isRegex,l=this.wholeWord,c=this.matchCase,d=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,o.searchString=!0,r=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,o.replaceString=!0,r=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,o.isRevealed=!0,r=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,o.isReplaceRevealed=!0,r=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&(!((s=e.searchScope)===null||s===void 0)&&s.every(u=>{var h;return(h=this._searchScope)===null||h===void 0?void 0:h.some(f=>!N.equalsRange(f,u))})||(this._searchScope=e.searchScope,o.searchScope=!0,r=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,o.loop=!0,r=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,o.isSearching=!0,r=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,o.filters=!0,r=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,a!==this.isRegex&&(r=!0,o.isRegex=!0),l!==this.wholeWord&&(r=!0,o.wholeWord=!0),c!==this.matchCase&&(r=!0,o.matchCase=!0),d!==this.preserveCase&&(r=!0,o.preserveCase=!0),r&&this._onFindReplaceStateChange.fire(o)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=_d}}const IRe=m("defaultLabel","input"),TRe=m("label.preserveCaseToggle","Preserve Case");class NRe extends r0{constructor(e){super({icon:se.preserveCase,title:TRe+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class RRe extends la{constructor(e,t,i,s){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new B),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new B),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new B),this._onInput=this._register(new B),this._onKeyUp=this._register(new B),this._onPreserveCaseKeyDown=this._register(new B),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=s.placeholder||"",this.validation=s.validation,this.label=s.label||IRe;const o=s.appendPreserveCaseLabel||"",r=s.history||[],a=!!s.flexibleHeight,l=!!s.flexibleWidth,c=s.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new cK(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:r,showHistoryHint:s.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:s.inputBoxStyles})),this.preserveCase=this._register(new NRe(Object.assign({appendTitle:o,isChecked:!1},s.toggleStyles))),this._register(this.preserveCase.onChange(h=>{this._onDidOptionChange.fire(h),!h&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(h=>{this._onPreserveCaseKeyDown.fire(h)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const d=[this.preserveCase.domNode];this.onkeydown(this.domNode,h=>{if(h.equals(15)||h.equals(17)||h.equals(9)){const f=d.indexOf(document.activeElement);if(f>=0){let g=-1;h.equals(17)?g=(f+1)%d.length:h.equals(15)&&(f===0?g=d.length-1:g=f-1),h.equals(9)?(d[f].blur(),this.inputBox.focus()):g>=0&&d[g].focus(),Ue.stop(h,!0)}}});const u=document.createElement("div");u.className="controls",u.style.display=this._showOptionButtons?"block":"none",u.appendChild(this.preserveCase.domNode),this.domNode.appendChild(u),e==null||e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,h=>this._onKeyDown.fire(h)),this.onkeyup(this.inputBox.inputElement,h=>this._onKeyUp.fire(h)),this.oninput(this.inputBox.inputElement,h=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,h=>this._onMouseDown.fire(h))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){var e;(e=this.inputBox)===null||e===void 0||e.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var mY=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},_Y=function(n,e){return function(t,i){e(t,i,n)}};const bY=new _e("suggestWidgetVisible",!1,m("suggestWidgetVisible","Whether suggestion are visible")),n5="historyNavigationWidgetFocus",vY="historyNavigationForwardsEnabled",yY="historyNavigationBackwardsEnabled";let ac;const Xw=[];function wY(n,e){if(Xw.includes(e))throw new Error("Cannot register the same widget multiple times");Xw.push(e);const t=new pe,i=new _e(n5,!1).bindTo(n),s=new _e(vY,!0).bindTo(n),o=new _e(yY,!0).bindTo(n),r=()=>{i.set(!0),ac=e},a=()=>{i.set(!1),ac===e&&(ac=void 0)};return e.element===document.activeElement&&r(),t.add(e.onDidFocus(()=>r())),t.add(e.onDidBlur(()=>a())),t.add(Ze(()=>{Xw.splice(Xw.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:s,historyNavigationBackwardsEnablement:o,dispose(){t.dispose()}}}let WR=class extends dK{constructor(e,t,i,s){super(e,t,i);const o=this._register(s.createScoped(this.inputBox.element));this._register(wY(o,this.inputBox))}};WR=mY([_Y(3,tt)],WR);let VR=class extends RRe{constructor(e,t,i,s,o=!1){super(e,t,o,i);const r=this._register(s.createScoped(this.inputBox.element));this._register(wY(r,this.inputBox))}};VR=mY([_Y(3,tt)],VR);Fs.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:Le.and(Le.has(n5),Le.equals(yY,!0),Le.not("isComposing"),bY.isEqualTo(!1)),primary:16,secondary:[528],handler:n=>{ac==null||ac.showPreviousValue()}});Fs.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:Le.and(Le.has(n5),Le.equals(vY,!0),Le.not("isComposing"),bY.isEqualTo(!1)),primary:18,secondary:[530],handler:n=>{ac==null||ac.showNextValue()}});function FB(n){var e,t;return((e=n.lookupKeybinding("history.showPrevious"))===null||e===void 0?void 0:e.getElectronAccelerator())==="Up"&&((t=n.lookupKeybinding("history.showNext"))===null||t===void 0?void 0:t.getElectronAccelerator())==="Down"}var MRe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const PRe=Yi("find-selection",se.selection,m("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),BB=Yi("find-collapsed",se.chevronRight,m("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),WB=Yi("find-expanded",se.chevronDown,m("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),ORe=Yi("find-replace",se.replace,m("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),FRe=Yi("find-replace-all",se.replaceAll,m("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),BRe=Yi("find-previous-match",se.arrowUp,m("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),WRe=Yi("find-next-match",se.arrowDown,m("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),VRe=m("label.findDialog","Find / Replace"),zRe=m("label.find","Find"),HRe=m("placeholder.find","Find"),$Re=m("label.previousMatchButton","Previous Match"),URe=m("label.nextMatchButton","Next Match"),jRe=m("label.toggleSelectionFind","Find in Selection"),qRe=m("label.closeButton","Close"),GRe=m("label.replace","Replace"),KRe=m("placeholder.replace","Replace"),YRe=m("label.replaceButton","Replace"),ZRe=m("label.replaceAllButton","Replace All"),XRe=m("label.toggleReplaceButton","Toggle Replace"),QRe=m("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",_d),JRe=m("label.matchesLocation","{0} of {1}"),VB=m("label.noResults","No results"),pa=419,eMe=275,tMe=eMe-54;let W0=69;const iMe=33,zB="ctrlEnterReplaceAll.windows.donotask",HB=pt?256:2048;class $E{constructor(e){this.afterLineNumber=e,this.heightInPx=iMe,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function $B(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){n.stopPropagation();return}}function UB(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){n.stopPropagation();return}}class Sk extends la{constructor(e,t,i,s,o,r,a,l,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=s,this._keybindingService=o,this._contextKeyService=r,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(zB,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new xu(500),this._register(Ze(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(d=>this._onStateChanged(d))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(d=>{if(d.hasChanged(90)&&(this._codeEditor.getOption(90)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),d.hasChanged(143)&&this._tryUpdateWidgetWidth(),d.hasChanged(2)&&this.updateAccessibilitySupport(),d.hasChanged(41)){const u=this._codeEditor.getOption(41).loop;this._state.change({loop:u},!1);const h=this._codeEditor.getOption(41).addExtraSpaceOnTop;h&&!this._viewZone&&(this._viewZone=new $E(0),this._showViewZone()),!h&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(()=>MRe(this,void 0,void 0,function*(){if(this._isVisible){const d=yield this._controller.getGlobalBufferTerm();d&&d!==this._state.searchString&&(this._state.change({searchString:d},!1),this._findInput.select())}}))),this._findInputFocused=wk.bindTo(r),this._findFocusTracker=this._register(eu(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=i5.bindTo(r),this._replaceFocusTracker=this._register(eu(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new $E(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(d=>{if(d.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return Sk.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(90)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=ys(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,mt)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=W0+"px",this._state.matchesCount>=_d?this._matchesCount.title=QRe:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild);let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=_d&&(t+="+");let i=String(this._state.matchesPosition);i==="0"&&(i="?"),e=Pb(JRe,i,t)}else e=VB;this._matchesCount.appendChild(document.createTextNode(e)),ay(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),W0=Math.max(W0,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===VB)return i===""?m("ariaSearchNoResultEmpty","{0} found",e):m("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const s=m("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();return o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1?`${o.getLineContent(t.startLineNumber)}, ${s}`:s}return m("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(90);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const s=Nn(i),o=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),r=s.left+(o?o.left:0),a=o?o.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=_j(this._domNode).left;r>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());s.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(s=>{i.heightInPx=this._getHeight(),this._viewZoneId=s.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new $E(0));const i=this._viewZone;this._codeEditor.changeViewZones(s=>{if(this._viewZoneId!==void 0){const o=this._getHeight();if(o===i.heightInPx)return;const r=o-i.heightInPx;i.heightInPx=o,s.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r);return}else{let o=this._getHeight();if(o-=this._codeEditor.getOption(83).top,o<=0)return;i.heightInPx=o,this._viewZoneId=s.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!uP(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,s=e.minimap.minimapWidth;let o=!1,r=!1,a=!1;if(this._resized&&ys(this._domNode)>pa){this._domNode.style.maxWidth=`${i-28-s-15}px`,this._replaceInput.width=ys(this._findInput.domNode);return}if(pa+28+s>=i&&(r=!0),pa+28+s-W0>=i&&(a=!0),pa+28+s-W0>=i+50&&(o=!0),this._domNode.classList.toggle("collapsed-find-widget",o),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",r),!a&&!o&&(this._domNode.style.maxWidth=`${i-28-s-15}px`),this._findInput.layout({collapsedFindWidget:o,narrowFindWidget:a,reducedFindWidget:r}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=ys(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!N.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(HB|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return $B(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return UB(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(HB|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{Ps&&lp&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(m("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(zB,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return $B(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return UB(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new WR(null,this._contextViewProvider,{width:tMe,label:zRe,placeholder:HRe,appendCaseSensitiveLabel:this._keybindingLabelFor(Mt.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Mt.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Mt.ToggleRegexCommand),validation:l=>{if(l.length===0||!this._findInput.getRegex())return null;try{return new RegExp(l,"gu"),null}catch(c){return{content:c.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>FB(this._keybindingService),inputBoxStyles:Ex,toggleStyles:kx},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(l=>this._onFindInputKeyDown(l))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(l=>{l.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),l.preventDefault())})),this._register(this._findInput.onRegexKeyDown(l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),l.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(l=>{this._tryUpdateHeight()&&this._showViewZone()})),Xn&&this._register(this._findInput.onMouseDown(l=>this._onFindInputMouseDown(l))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new yg({label:$Re+this._keybindingLabelFor(Mt.PreviousMatchFindAction),icon:BRe,onTrigger:()=>{vI(this._codeEditor.getAction(Mt.PreviousMatchFindAction)).run().then(void 0,mt)}})),this._nextBtn=this._register(new yg({label:URe+this._keybindingLabelFor(Mt.NextMatchFindAction),icon:WRe,onTrigger:()=>{vI(this._codeEditor.getAction(Mt.NextMatchFindAction)).run().then(void 0,mt)}}));const i=document.createElement("div");i.className="find-part",i.appendChild(this._findInput.domNode);const s=document.createElement("div");s.className="find-actions",i.appendChild(s),s.appendChild(this._matchesCount),s.appendChild(this._prevBtn.domNode),s.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new r0({icon:PRe,title:jRe+this._keybindingLabelFor(Mt.ToggleSearchScopeCommand),isChecked:!1,inputActiveOptionBackground:re(Ch),inputActiveOptionBorder:re(EP),inputActiveOptionForeground:re(AP)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){const l=this._codeEditor.getSelections();l.map(c=>(c.endColumn===1&&c.endLineNumber>c.startLineNumber&&(c=c.setEndPosition(c.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(c.endLineNumber-1))),c.isEmpty()?null:c)).filter(c=>!!c),l.length&&this._state.change({searchScope:l},!0)}}else this._state.change({searchScope:null},!0)})),s.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new yg({label:qRe+this._keybindingLabelFor(Mt.CloseFindWidgetCommand),icon:BEe,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),l.preventDefault())}})),this._replaceInput=this._register(new VR(null,void 0,{label:GRe,placeholder:KRe,appendPreserveCaseLabel:this._keybindingLabelFor(Mt.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>FB(this._keybindingService),inputBoxStyles:Ex,toggleStyles:kx},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(l=>this._onReplaceInputKeyDown(l))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(l=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(l=>{l.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),l.preventDefault())})),this._replaceBtn=this._register(new yg({label:YRe+this._keybindingLabelFor(Mt.ReplaceOneAction),icon:ORe,onTrigger:()=>{this._controller.replace()},onKeyDown:l=>{l.equals(1026)&&(this._closeBtn.focus(),l.preventDefault())}})),this._replaceAllBtn=this._register(new yg({label:ZRe+this._keybindingLabelFor(Mt.ReplaceAllAction),icon:FRe,onTrigger:()=>{this._controller.replaceAll()}}));const o=document.createElement("div");o.className="replace-part",o.appendChild(this._replaceInput.domNode);const r=document.createElement("div");r.className="replace-actions",o.appendChild(r),r.appendChild(this._replaceBtn.domNode),r.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new yg({label:XRe,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=ys(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=VRe,this._domNode.role="dialog",this._domNode.style.width=`${pa}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(i),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(o),this._resizeSash=new kn(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let a=pa;this._register(this._resizeSash.onDidStart(()=>{a=ys(this._domNode)})),this._register(this._resizeSash.onDidChange(l=>{this._resized=!0;const c=a+l.startX-l.currentX;if(c<pa)return;const d=parseFloat(LD(this._domNode).maxWidth)||0;c>d||(this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=ys(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const l=ys(this._domNode);if(l<pa)return;let c=pa;if(!this._resized||l===pa){const d=this._codeEditor.getLayoutInfo();c=d.width-28-d.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=ys(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}}Sk.ID="editor.contrib.findWidget";class yg extends la{constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+Ne.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,i=>{this._opts.onTrigger(),i.preventDefault()}),this.onkeydown(this._domNode,i=>{var s,o;if(i.equals(10)||i.equals(3)){this._opts.onTrigger(),i.preventDefault();return}(o=(s=this._opts).onKeyDown)===null||o===void 0||o.call(s,i)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...Ne.asClassNameArray(BB)),this._domNode.classList.add(...Ne.asClassNameArray(WB))):(this._domNode.classList.remove(...Ne.asClassNameArray(WB)),this._domNode.classList.add(...Ne.asClassNameArray(BB)))}}Dr((n,e)=>{const t=(p,_)=>{_&&e.addRule(`.monaco-editor ${p} { background-color: ${_}; }`)};t(".findMatch",n.getColor(Wa)),t(".currentFindMatch",n.getColor(bve)),t(".findScope",n.getColor(vve));const i=n.getColor(zi);t(".find-widget",i);const s=n.getColor(Yl);s&&e.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${s}; }`);const o=n.getColor(cq);o&&e.addRule(`.monaco-editor .find-widget { border-left: 1px solid ${o}; border-right: 1px solid ${o}; border-bottom: 1px solid ${o}; }`);const r=n.getColor(cd);r&&e.addRule(`.monaco-editor .findMatch { border: 1px ${sc(n.type)?"dotted":"solid"} ${r}; box-sizing: border-box; }`);const a=n.getColor(yve);a&&e.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${a}; padding: 1px; box-sizing: border-box; }`);const l=n.getColor(wve);l&&e.addRule(`.monaco-editor .findScope { border: 1px ${sc(n.type)?"dashed":"solid"} ${l}; }`);const c=n.getColor(Je);c&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${c}; }`);const d=n.getColor(Ba);d&&e.addRule(`.monaco-editor .find-widget { color: ${d}; }`);const u=n.getColor(Bbe);u&&e.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${u}; }`);const h=n.getColor(cve);if(h)e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${h}; }`);else{const p=n.getColor(zg);p&&e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${p}; }`)}const f=n.getColor(YT);f&&e.addRule(`
		.monaco-editor .find-widget .button:not(.disabled):hover,
		.monaco-editor .find-widget .codicon-find-selection:hover {
			background-color: ${f} !important;
		}
	`);const g=n.getColor(yo);g&&e.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${g}; }`)});var CY=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Hr=function(n,e){return function(t,i){e(t,i,n)}},Sf=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},zR;const nMe=524288;function HR(n,e="single",t=!1){if(!n.hasModel())return null;const i=n.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const s=n.getConfiguredWordAtPosition(i.getStartPosition());if(s&&t===!1)return s.word}else if(n.getModel().getValueLengthInRange(i)<nMe)return n.getModel().getValueInRange(i)}return null}let us=zR=class extends Y{get editor(){return this._editor}static get(e){return e.getContribution(zR.ID)}constructor(e,t,i,s,o){super(),this._editor=e,this._findWidgetVisible=Dc.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=s,this._notificationService=o,this._updateHistoryDelayer=new xu(500),this._state=this._register(new ARe),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(r=>this._onStateChanged(r))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const r=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),r&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!wk.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){const e=this._editor.getSelections();e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=br(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return Sf(this,void 0,void 0,function*(){if(this.disposeModel(),!this._editor.hasModel())return;const i=Object.assign(Object.assign({},t),{isRevealed:!0});if(e.seedSearchStringFromSelection==="single"){const s=HR(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);s&&(this._state.isRegex?i.searchString=br(s):i.searchString=s)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const s=HR(this._editor,e.seedSearchStringFromSelection);s&&(i.searchString=s)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const s=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;s&&(i.searchString=s)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const s=this._editor.getSelections();s.some(o=>!o.isEmpty())&&(i.searchScope=s)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new Y_(this._editor,this._state))})}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){var e;return this._model?!((e=this._editor.getModel())===null||e===void 0)&&e.isTooLargeForHeapOperation()?(this._notificationService.warn(m("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}getGlobalBufferTerm(){return Sf(this,void 0,void 0,function*(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""})}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};us.ID="editor.contrib.findController";us=zR=CY([Hr(1,tt),Hr(2,Gf),Hr(3,Sy),Hr(4,Ln)],us);let $R=class extends us{constructor(e,t,i,s,o,r,a,l){super(e,i,a,l,r),this._contextViewService=t,this._keybindingService=s,this._themeService=o,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return Sf(this,void 0,void 0,function*(){this._widget||this._createFindWidget();const s=this._editor.getSelection();let o=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":o=!0;break;case"never":o=!1;break;case"multiline":{o=!!s&&s.startLineNumber!==s.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||o,yield i._start.call(this,e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())})}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new Sk(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new Ck(this._editor,this._state,this._keybindingService))}};$R=CY([Hr(1,Eu),Hr(2,tt),Hr(3,bi),Hr(4,ao),Hr(5,Ln),Hr(6,Gf),Hr(7,Sy)],$R);const sMe=Lj(new xj({id:Mt.StartFindAction,label:m("startFindAction","Find"),alias:"Find",precondition:Le.or(H.focus,Le.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:I.MenubarEditMenu,group:"3_find",title:m({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));sMe.addImplementation(0,(n,e,t)=>{const i=us.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop}):!1});const oMe={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:m("actions.find.isRegexOverride",`Overrides "Use Regular Expression" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:m("actions.find.wholeWordOverride",`Overrides "Match Whole Word" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:m("actions.find.matchCaseOverride",`Overrides "Math Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:m("actions.find.preserveCaseOverride",`Overrides "Preserve Case" flag.
The flag will not be saved for the future.
0: Do Nothing
1: True
2: False`)},findInSelection:{type:"boolean"}}}}]};class rMe extends Xt{constructor(){super({id:Mt.StartFindWithArgs,label:m("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:oMe})}run(e,t,i){return Sf(this,void 0,void 0,function*(){const s=us.get(t);if(s){const o=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield s.start({forceRevealReplace:!1,seedSearchStringFromSelection:s.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(i==null?void 0:i.findInSelection)||!1,loop:t.getOption(41).loop},o),s.setGlobalBufferTerm(s.getState().searchString)}})}}class aMe extends Xt{constructor(){super({id:Mt.StartFindWithSelection,label:m("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return Sf(this,void 0,void 0,function*(){const i=us.get(t);i&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),i.setGlobalBufferTerm(i.getState().searchString))})}}class SY extends Xt{run(e,t){return Sf(this,void 0,void 0,function*(){const i=us.get(t);i&&!this._run(i)&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))})}}class lMe extends SY{constructor(){super({id:Mt.NextMatchFindAction,label:m("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:H.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:Le.and(H.focus,wk),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class cMe extends SY{constructor(){super({id:Mt.PreviousMatchFindAction,label:m("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:H.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:Le.and(H.focus,wk),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class dMe extends Xt{constructor(){super({id:Mt.GoToMatchFindAction,label:m("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:Dc}),this._highlightDecorations=[]}run(e,t,i){const s=us.get(t);if(!s)return;const o=s.getState().matchesCount;if(o<1){e.get(Ln).notify({severity:fG.Warning,message:m("findMatchAction.noResults","No matches. Try searching for something else.")});return}const a=e.get(F3).createInputBox();a.placeholder=m("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",o);const l=d=>{const u=parseInt(d);if(isNaN(u))return;const h=s.getState().matchesCount;if(u>0&&u<=h)return u-1;if(u<0&&u>=-h)return h+u},c=d=>{const u=l(d);if(typeof u=="number"){a.validationMessage=void 0,s.goToMatch(u);const h=s.getState().currentMatch;h&&this.addDecorations(t,h)}else a.validationMessage=m("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount),this.clearDecorations(t)};a.onDidChangeValue(d=>{c(d)}),a.onDidAccept(()=>{const d=l(a.value);typeof d=="number"?(s.goToMatch(d),a.hide()):a.validationMessage=m("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",s.getState().matchesCount)}),a.onDidHide(()=>{this.clearDecorations(t),a.dispose()}),a.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:sn(gye),position:jo.Full}}}])})}}class xY extends Xt{run(e,t){return Sf(this,void 0,void 0,function*(){const i=us.get(t);if(!i)return;const s=HR(t,"single",!1);s&&i.setSearchString(s),this._run(i)||(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))})}}class uMe extends xY{constructor(){super({id:Mt.NextSelectionMatchFindAction,label:m("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class hMe extends xY{constructor(){super({id:Mt.PreviousSelectionMatchFindAction,label:m("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const fMe=Lj(new xj({id:Mt.StartFindReplaceAction,label:m("startReplace","Replace"),alias:"Replace",precondition:Le.or(H.focus,Le.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:I.MenubarEditMenu,group:"3_find",title:m({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));fMe.addImplementation(0,(n,e,t)=>{if(!e.hasModel()||e.getOption(90))return!1;const i=us.get(e);if(!i)return!1;const s=e.getSelection(),o=i.isFindInputFocused(),r=!s.isEmpty()&&s.startLineNumber===s.endLineNumber&&e.getOption(41).seedSearchStringFromSelection!=="never"&&!o,a=o||r?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop})});Lr(us.ID,$R,0);Xe(rMe);Xe(aMe);Xe(lMe);Xe(cMe);Xe(dMe);Xe(uMe);Xe(hMe);const da=Cr.bindToContribution(us.get);Ae(new da({id:Mt.CloseFindWidgetCommand,precondition:Dc,handler:n=>n.closeFindWidget(),kbOpts:{weight:100+5,kbExpr:Le.and(H.focus,Le.not("isComposing")),primary:9,secondary:[1033]}}));Ae(new da({id:Mt.ToggleCaseSensitiveCommand,precondition:void 0,handler:n=>n.toggleCaseSensitive(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:jw.primary,mac:jw.mac,win:jw.win,linux:jw.linux}}));Ae(new da({id:Mt.ToggleWholeWordCommand,precondition:void 0,handler:n=>n.toggleWholeWords(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:qw.primary,mac:qw.mac,win:qw.win,linux:qw.linux}}));Ae(new da({id:Mt.ToggleRegexCommand,precondition:void 0,handler:n=>n.toggleRegex(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:Gw.primary,mac:Gw.mac,win:Gw.win,linux:Gw.linux}}));Ae(new da({id:Mt.ToggleSearchScopeCommand,precondition:void 0,handler:n=>n.toggleSearchScope(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:Kw.primary,mac:Kw.mac,win:Kw.win,linux:Kw.linux}}));Ae(new da({id:Mt.TogglePreserveCaseCommand,precondition:void 0,handler:n=>n.togglePreserveCase(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:Yw.primary,mac:Yw.mac,win:Yw.win,linux:Yw.linux}}));Ae(new da({id:Mt.ReplaceOneAction,precondition:Dc,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:3094}}));Ae(new da({id:Mt.ReplaceOneAction,precondition:Dc,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:Le.and(H.focus,i5),primary:3}}));Ae(new da({id:Mt.ReplaceAllAction,precondition:Dc,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:2563}}));Ae(new da({id:Mt.ReplaceAllAction,precondition:Dc,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:Le.and(H.focus,i5),primary:void 0,mac:{primary:2051}}}));Ae(new da({id:Mt.SelectAllMatchesAction,precondition:Dc,handler:n=>n.selectAllMatches(),kbOpts:{weight:100+5,kbExpr:H.focus,primary:515}}));const Qw=E("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},m("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},m("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);E("editor.wordHighlightTextBackground",{light:Qw,dark:Qw,hcDark:Qw,hcLight:Qw},m("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const Jw=E("editor.wordHighlightBorder",{light:null,dark:null,hcDark:jt,hcLight:jt},m("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));E("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:jt,hcLight:jt},m("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));E("editor.wordHighlightTextBorder",{light:Jw,dark:Jw,hcDark:Jw,hcLight:Jw},m("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const gMe=E("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hcDark:"#A0A0A0CC",hcLight:"#A0A0A0CC"},m("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),pMe=E("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hcDark:"#C0A0C0CC",hcLight:"#C0A0C0CC"},m("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),mMe=E("editorOverviewRuler.wordHighlightTextForeground",{dark:l_,light:l_,hcDark:l_,hcLight:l_},m("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);et.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:sn(pMe),position:jo.Center},minimap:{color:sn(VD),position:Xs.Inline}});et.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:sn(mMe),position:jo.Center},minimap:{color:sn(VD),position:Xs.Inline}});const _Me=et.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:sn(l_),position:jo.Center},minimap:{color:sn(VD),position:Xs.Inline}}),bMe=et.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"});et.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:sn(gMe),position:jo.Center},minimap:{color:sn(VD),position:Xs.Inline}});function vMe(n){return n?bMe:_Me}Dr((n,e)=>{const t=n.getColor(IP);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var yMe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},wMe=function(n,e){return function(t,i){e(t,i,n)}},UR;function Tu(n,e){const t=e.filter(i=>!n.find(s=>s.equals(i)));if(t.length>=1){const i=t.map(o=>`line ${o.viewState.position.lineNumber} column ${o.viewState.position.column}`).join(", "),s=t.length===1?m("cursorAdded","Cursor added: {0}",i):m("cursorsAdded","Cursors added: {0}",i);Qb(s)}}class CMe extends Xt{constructor(){super({id:"editor.action.insertCursorAbove",label:m("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&i.logicalLine===!1&&(s=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,_n.addCursorUp(o,r,s)),o.revealTopMostCursor(i.source),Tu(r,o.getCursorStates())}}class SMe extends Xt{constructor(){super({id:"editor.action.insertCursorBelow",label:m("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let s=!0;i&&i.logicalLine===!1&&(s=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,_n.addCursorDown(o,r,s)),o.revealBottomMostCursor(i.source),Tu(r,o.getCursorStates())}}class xMe extends Xt{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:m("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let s=e.startLineNumber;s<e.endLineNumber;s++){const o=t.getLineMaxColumn(s);i.push(new lt(s,o,s,o))}e.endColumn>1&&i.push(new lt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),s=t.getSelections(),o=t._getViewModel(),r=o.getCursorStates(),a=[];s.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),Tu(r,o.getCursorStates())}}class LMe extends Xt{constructor(){super({id:"editor.action.addCursorsToBottom",label:m("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=t.getModel().getLineCount(),o=[];for(let l=i[0].startLineNumber;l<=s;l++)o.push(new lt(l,i[0].startColumn,l,i[0].endColumn));const r=t._getViewModel(),a=r.getCursorStates();o.length>0&&t.setSelections(o),Tu(a,r.getCursorStates())}}class DMe extends Xt{constructor(){super({id:"editor.action.addCursorsToTop",label:m("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),s=[];for(let a=i[0].startLineNumber;a>=1;a--)s.push(new lt(a,i[0].startColumn,a,i[0].endColumn));const o=t._getViewModel(),r=o.getCursorStates();s.length>0&&t.setSelections(s),Tu(r,o.getCursorStates())}}class eC{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class Rv{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new Rv(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let s=!1,o,r;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(s=!0,o=!0,r=!0):(o=i.wholeWord,r=i.matchCase);const l=e.getSelection();let c,d=null;if(l.isEmpty()){const u=e.getConfiguredWordAtPosition(l.getStartPosition());if(!u)return null;c=u.word,d=new lt(l.startLineNumber,u.startColumn,l.startLineNumber,u.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new Rv(e,t,s,c,o,r,d)}constructor(e,t,i,s,o,r,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=s,this.wholeWord=o,this.matchCase=r,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new eC(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new eC(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const s=this.currentMatch;return this.currentMatch=null,s}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1);return i?new lt(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new eC(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new eC(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const s=this.currentMatch;return this.currentMatch=null,s}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1);return i?new lt(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(129):null,!1,1073741824)}}class xf extends Y{static get(e){return e.getContribution(xf.ID)}constructor(e){super(),this._sessionDispose=this._register(new pe),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=Rv.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(s=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(s=>{(s.matchCase||s.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new lt(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const s=e.getState().matchCase;if(!LY(this._editor.getModel(),t,s)){const r=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(r,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const s=this._editor.getModel();i.searchScope?t=s.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(129):null,!1,1073741824):t=s.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(129):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const s=this._editor.getSelection();for(let o=0,r=t.length;o<r;o++){const a=t[o];if(a.range.intersectRanges(s)){t[o]=t[0],t[0]=a;break}}this._setSelections(t.map(o=>new lt(o.range.startLineNumber,o.range.startColumn,o.range.endLineNumber,o.range.endColumn)))}}}xf.ID="editor.contrib.multiCursorController";class c0 extends Xt{run(e,t){const i=xf.get(t);if(!i)return;const s=t._getViewModel();if(s){const o=s.getCursorStates(),r=us.get(t);if(r)this._run(i,r);else{const a=e.get(vt).createInstance(us,t);this._run(i,a),a.dispose()}Tu(o,s.getCursorStates())}}}class kMe extends c0{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:m("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:2082,weight:100},menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class EMe extends c0{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:m("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class AMe extends c0{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:m("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:Fn(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class IMe extends c0{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:m("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class TMe extends c0{constructor(){super({id:"editor.action.selectHighlights",label:m("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:3114,weight:100},menuOpts:{menuId:I.MenubarSelectionMenu,group:"3_multi",title:m({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class NMe extends c0{constructor(){super({id:"editor.action.changeAll",label:m("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:Le.and(H.writable,H.editorTextFocus),kbOpts:{kbExpr:H.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class RMe{constructor(e,t,i,s,o){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=s,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,o&&this._model===o._model&&this._searchText===o._searchText&&this._matchCase===o._matchCase&&this._wordSeparators===o._wordSeparators&&this._modelVersionId===o._modelVersionId&&(this._cachedFindMatches=o._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(N.compareRangesUsingStarts)),this._cachedFindMatches}}let Mv=UR=class extends Y{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(107),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new Li(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(s=>{this._isEnabled=e.getOption(107)})),this._register(e.onDidChangeCursorSelection(s=>{this._isEnabled&&(s.selection.isEmpty()?s.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(s=>{this._setState(null)})),this._register(e.onDidChangeModelContent(s=>{this._isEnabled&&this.updateSoon.schedule()}));const i=us.get(e);i&&this._register(i.getState().onFindReplaceStateChange(s=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(UR._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t||!i.hasModel())return null;const s=i.getSelection();if(s.startLineNumber!==s.endLineNumber)return null;const o=xf.get(i);if(!o)return null;const r=us.get(i);if(!r)return null;let a=o.getSession(r);if(!a){const d=i.getSelections();if(d.length>1){const h=r.getState().matchCase;if(!LY(i.getModel(),d,h))return null}a=Rv.create(i,r)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;const l=r.getState(),c=l.matchCase;if(l.isRevealed){let d=l.searchString;c||(d=d.toLowerCase());let u=a.searchText;if(c||(u=u.toLowerCase()),d===u&&a.matchCase===l.matchCase&&a.wholeWord===l.wholeWord&&!l.isRegex)return null}return new RMe(i.getModel(),a.searchText,a.matchCase,a.wholeWord?i.getOption(129):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),s=this.editor.getSelections();s.sort(N.compareRangesUsingStarts);const o=[];for(let l=0,c=0,d=i.length,u=s.length;l<d;){const h=i[l];if(c>=u)o.push(h),l++;else{const f=N.compareRangesUsingStarts(h,s[c]);f<0?((s[c].isEmpty()||!N.areIntersecting(h,s[c]))&&o.push(h),l++):(f>0||l++,c++)}}const r=this._languageFeaturesService.documentHighlightProvider.has(t)&&this.editor.getOption(80),a=o.map(l=>({range:l,options:vMe(r)}));this._decorations.set(a)}dispose(){this._setState(null),super.dispose()}};Mv.ID="editor.contrib.selectionHighlighter";Mv=UR=yMe([wMe(1,nt)],Mv);function LY(n,e,t){const i=jB(n,e[0],!t);for(let s=1,o=e.length;s<o;s++){const r=e[s];if(r.isEmpty())return!1;const a=jB(n,r,!t);if(i!==a)return!1}return!0}function jB(n,e,t){const i=n.getValueInRange(e);return t?i.toLowerCase():i}class MMe extends Xt{constructor(){super({id:"editor.action.focusNextCursor",label:m("mutlicursor.focusNextCursor","Focus Next Cursor"),description:{description:m("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const o=Array.from(s.getCursorStates()),r=o.shift();r&&(o.push(r),s.setCursorStates(i.source,3,o),s.revealPrimaryCursor(i.source,!0),Tu(o,s.getCursorStates()))}}class PMe extends Xt{constructor(){super({id:"editor.action.focusPreviousCursor",label:m("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),description:{description:m("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const o=Array.from(s.getCursorStates()),r=o.pop();r&&(o.unshift(r),s.setCursorStates(i.source,3,o),s.revealPrimaryCursor(i.source,!0),Tu(o,s.getCursorStates()))}}Lr(xf.ID,xf,4);Lr(Mv.ID,Mv,1);Xe(CMe);Xe(SMe);Xe(xMe);Xe(kMe);Xe(EMe);Xe(AMe);Xe(IMe);Xe(TMe);Xe(NMe);Xe(LMe);Xe(DMe);Xe(MMe);Xe(PMe);const OMe=E("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hcDark:"#A0A0A0",hcLight:"#A0A0A0"},m("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class FMe extends Xt{constructor(){super({id:"editor.action.jumpToBracket",label:m("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:3165,weight:100}})}run(e,t){var i;(i=gr.get(t))===null||i===void 0||i.jumpToBracket()}}class BMe extends Xt{constructor(){super({id:"editor.action.selectToBracket",label:m("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){var s;let o=!0;i&&i.selectBrackets===!1&&(o=!1),(s=gr.get(t))===null||s===void 0||s.selectToBracket(o)}}class WMe extends Xt{constructor(){super({id:"editor.action.removeBrackets",label:m("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:2561,weight:100}})}run(e,t){var i;(i=gr.get(t))===null||i===void 0||i.removeBrackets(this.id)}}class VMe{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}class gr extends Y{static get(e){return e.getContribution(gr.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new Li(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(71),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(71)&&(this._matchBrackets=this._editor.getOption(71),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const s=i.getStartPosition(),o=e.bracketPairs.matchBracket(s);let r=null;if(o)o[0].containsPosition(s)&&!o[1].containsPosition(s)?r=o[1].getStartPosition():o[1].containsPosition(s)&&(r=o[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(s);if(a)r=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(s);l&&l.range&&(r=l.range.getStartPosition())}}return r?new lt(r.lineNumber,r.column,r.lineNumber,r.column):new lt(s.lineNumber,s.column,s.lineNumber,s.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(s=>{const o=s.getStartPosition();let r=t.bracketPairs.matchBracket(o);if(!r&&(r=t.bracketPairs.findEnclosingBrackets(o),!r)){const c=t.bracketPairs.findNextBracket(o);c&&c.range&&(r=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(r){r.sort(N.compareRangesUsingStarts);const[c,d]=r;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?d.getEndPosition():d.getStartPosition(),d.containsPosition(o)){const u=a;a=l,l=u}}a&&l&&i.push(new lt(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const s=i.getPosition();let o=t.bracketPairs.matchBracket(s);o||(o=t.bracketPairs.findEnclosingBrackets(s)),o&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:o[0],text:""},{range:o[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const s=i.brackets;s&&(e[t++]={range:s[0],options:i.options},e[t++]={range:s[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let s=[];this._lastVersionId===i&&(s=this._lastBracketsData);const o=[];let r=0;for(let u=0,h=e.length;u<h;u++){const f=e[u];f.isEmpty()&&(o[r++]=f.getStartPosition())}o.length>1&&o.sort(V.compare);const a=[];let l=0,c=0;const d=s.length;for(let u=0,h=o.length;u<h;u++){const f=o[u];for(;c<d&&s[c].position.isBefore(f);)c++;if(c<d&&s[c].position.equals(f))a[l++]=s[c];else{let g=t.bracketPairs.matchBracket(f,20),p=gr._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!g&&this._matchBrackets==="always"&&(g=t.bracketPairs.findEnclosingBrackets(f,20),p=gr._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new VMe(f,g,p)}}this._lastBracketsData=a,this._lastVersionId=i}}gr.ID="editor.contrib.bracketMatchingController";gr._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=et.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:sn(OMe),position:jo.Center}});gr._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=et.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});Lr(gr.ID,gr,1);Xe(BMe);Xe(FMe);Xe(WMe);rr.appendMenuItem(I.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:m({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});function jR(n,e){return!!n[e]}class UE{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=jR(e.event,t.triggerModifier),this.hasSideBySideModifier=jR(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class qB{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=jR(e,t.triggerModifier)}}class tC{constructor(e,t,i,s){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=s}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function GB(n){return n==="altKey"?pt?new tC(57,"metaKey",6,"altKey"):new tC(5,"ctrlKey",6,"altKey"):pt?new tC(6,"altKey",57,"metaKey"):new tC(6,"altKey",5,"ctrlKey")}class zMe extends Y{constructor(e,t){var i;super(),this._onMouseMoveOrRelevantKeyDown=this._register(new B),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new B),this.onExecute=this._onExecute.event,this._onCancel=this._register(new B),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=(i=t==null?void 0:t.extractLineNumberFromMouseEvent)!==null&&i!==void 0?i:s=>s.target.position?s.target.position.lineNumber:0,this._opts=GB(this._editor.getOption(77)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(s=>{if(s.hasChanged(77)){const o=GB(this._editor.getOption(77));if(this._opts.equals(o))return;this._opts=o,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(s=>this._onEditorMouseMove(new UE(s,this._opts)))),this._register(this._editor.onMouseDown(s=>this._onEditorMouseDown(new UE(s,this._opts)))),this._register(this._editor.onMouseUp(s=>this._onEditorMouseUp(new UE(s,this._opts)))),this._register(this._editor.onKeyDown(s=>this._onEditorKeyDown(new qB(s,this._opts)))),this._register(this._editor.onKeyUp(s=>this._onEditorKeyUp(new qB(s,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(s=>this._onDidChangeCursorSelection(s))),this._register(this._editor.onDidChangeModel(s=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(s=>{(s.scrollTopChanged||s.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var HMe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},bl=function(n,e){return function(t,i){e(t,i,n)}};let Wm=class extends Im{constructor(e,t,i,s,o,r,a,l,c,d,u,h,f){super(e,Object.assign(Object.assign({},s.getRawOptions()),{overflowWidgetsDomNode:s.getOverflowWidgetsDomNode()}),i,o,r,a,l,c,d,u,h,f),this._parentEditor=s,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(s.onDidChangeConfiguration(g=>this._onParentConfigurationChanged(g)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){uD(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};Wm=HMe([bl(4,vt),bl(5,Ut),bl(6,fs),bl(7,tt),bl(8,ao),bl(9,Ln),bl(10,Du),bl(11,oo),bl(12,nt)],Wm);const KB=new z(new ut(0,122,204)),$Me={showArrow:!0,showFrame:!0,className:"",frameColor:KB,arrowColor:KB,keepEditorSelection:!1},UMe="vs.editor.contrib.zoneWidget";class jMe{constructor(e,t,i,s,o,r,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=s,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=o,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class qMe{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class xk{constructor(e){this._editor=e,this._ruleName=xk._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),E9(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){E9(this._ruleName),LT(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:N.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}}xk._IdGenerator=new p3(".arrow-decoration-");class GMe{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new pe,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=kl(t),uD(this.options,$Me,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const s=this._getWidth(i);this.domNode.style.width=s+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(s)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new xk(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){var t;if(this.domNode.style.height=`${e}px`,this.container){const i=e-this._decoratingElementsHeight();this.container.style.height=`${i}px`;const s=this.editor.getLayoutInfo();this._doLayout(i,this._getWidth(s))}(t=this._resizeSash)===null||t===void 0||t.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=N.isIRange(e)?N.lift(e):N.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:et.EMPTY}])}hide(){var e;this._viewZone&&(this.editor.changeViewZones(t=>{this._viewZone&&t.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),(e=this._arrow)===null||e===void 0||e.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const e=this.editor.getOption(66);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),s=this.editor.getLayoutInfo(),o=this._getWidth(s);this.domNode.style.width=`${o}px`,this.domNode.style.left=this._getLeft(s)+"px";const r=document.createElement("div");r.style.overflow="hidden";const a=this.editor.getOption(66);if(!this.options.allowUnlimitedHeight){const h=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,h)}let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(c=Math.round(a/9)),this.editor.changeViewZones(h=>{this._viewZone&&h.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new jMe(r,i.lineNumber,i.column,t,f=>this._onViewZoneTop(f),f=>this._onViewZoneHeight(f),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=h.addZone(this._viewZone),this._overlayWidget=new qMe(UMe+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const h=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=h+"px",this.container.style.borderBottomWidth=h+"px"}const d=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=d+"px",this.container.style.overflow="hidden"),this._doLayout(d,o),this.options.keepEditorSelection||this.editor.setSelection(e);const u=this.editor.getModel();if(u){const h=u.validateRange(new N(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(h,h.startLineNumber===u.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new kn(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(66),s=i<0?Math.ceil(i):Math.floor(i),o=e.heightInLines+s;o>5&&o<35&&this._relayout(o)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var DY=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},kY=function(n,e){return function(t,i){e(t,i,n)}};const EY=at("IPeekViewService");ht(EY,class{constructor(){this._widgets=new Map}addExclusiveWidget(n,e){const t=this._widgets.get(n);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const s=this._widgets.get(n);s&&s.widget===e&&(s.listener.dispose(),this._widgets.delete(n))};this._widgets.set(n,{widget:e,listener:e.onDidClose(i)})}},1);var to;(function(n){n.inPeekEditor=new _e("inReferenceSearchEditor",!0,m("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),n.notInPeekEditor=n.inPeekEditor.toNegated()})(to||(to={}));let Pv=class{constructor(e,t){e instanceof Wm&&to.inPeekEditor.bindTo(t)}dispose(){}};Pv.ID="editor.contrib.referenceController";Pv=DY([kY(1,tt)],Pv);Lr(Pv.ID,Pv,0);function KMe(n){const e=n.get(Ut).getFocusedCodeEditor();return e instanceof Wm?e.getParentEditor():e}const YMe={headerBackgroundColor:z.white,primaryHeadingColor:z.fromHex("#333333"),secondaryHeadingColor:z.fromHex("#6c6c6cb3")};let Zx=class extends GMe{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new B,this.onDidClose=this._onDidClose.event,uD(this.options,YMe,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=we(".head"),this._bodyElement=we(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=we(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),Hi(this._titleElement,"click",o=>this._onTitleClick(o))),le(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=we("span.filename"),this._secondaryHeading=we("span.dirname"),this._metaHeading=we("span.meta"),le(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=we(".peekview-actions");le(this._headElement,i);const s=this._getActionBarOptions();this._actionbarWidget=new il(i,s),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new xo("peekview.close",m("label.close","Close"),Ne.asClassName(se.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:Pke.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:Lo(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,Uh(this._metaHeading)):sd(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(66)*1.2),s=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(s,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};Zx=DY([kY(2,vt)],Zx);const ZMe=E("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:z.black,hcLight:z.white},m("peekViewTitleBackground","Background color of the peek view title area.")),AY=E("peekViewTitleLabel.foreground",{dark:z.white,light:z.black,hcDark:z.white,hcLight:ku},m("peekViewTitleForeground","Color of the peek view title.")),IY=E("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},m("peekViewTitleInfoForeground","Color of the peek view title info.")),XMe=E("peekView.border",{dark:ks,light:ks,hcDark:Je,hcLight:Je},m("peekViewBorder","Color of the peek view borders and arrow.")),QMe=E("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:z.black,hcLight:z.white},m("peekViewResultsBackground","Background color of the peek view result list."));E("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:z.white,hcLight:ku},m("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));E("peekViewResult.fileForeground",{dark:z.white,light:"#1E1E1E",hcDark:z.white,hcLight:ku},m("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));E("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},m("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));E("peekViewResult.selectionForeground",{dark:z.white,light:"#6C6C6C",hcDark:z.white,hcLight:ku},m("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const bd=E("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:z.black,hcLight:z.white},m("peekViewEditorBackground","Background color of the peek view editor."));E("peekViewEditorGutter.background",{dark:bd,light:bd,hcDark:bd,hcLight:bd},m("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));E("peekViewEditorStickyScroll.background",{dark:bd,light:bd,hcDark:bd,hcLight:bd},m("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));E("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},m("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));E("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},m("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));E("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:jt,hcLight:jt},m("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var JMe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class ru{constructor(e,t,i,s){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=s,this.id=TN.nextId()}get uri(){return this.link.uri}get range(){var e,t;return(t=(e=this._range)!==null&&e!==void 0?e:this.link.targetSelectionRange)!==null&&t!==void 0?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=(e=this.parent.getPreview(this))===null||e===void 0?void 0:e.preview(this.range);return t?m({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",t.value,na(this.uri),this.range.startLineNumber,this.range.startColumn):m("aria.oneReference","in {0} on line {1} at column {2}",na(this.uri),this.range.startLineNumber,this.range.startColumn)}}class e4e{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:s,startColumn:o,endLineNumber:r,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:s,column:o-t}),c=new N(s,l.startColumn,s,o),d=new N(r,a,r,1073741824),u=i.getValueInRange(c).replace(/^\s+/,""),h=i.getValueInRange(e),f=i.getValueInRange(d).replace(/\s+$/,"");return{value:u+h+f,highlight:{start:u.length,end:u.length+h.length}}}}class Ov{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new In}dispose(){Ft(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?m("aria.fileReferences.1","1 symbol in {0}, full path {1}",na(this.uri),this.uri.fsPath):m("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,na(this.uri),this.uri.fsPath)}resolve(e){return JMe(this,void 0,void 0,function*(){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=yield e.createModelReference(t.uri);this._previews.set(t.uri,new e4e(i))}catch(i){mt(i)}return this})}}class Qs{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new B,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(Qs._compareReferences);let s;for(const o of e)if((!s||!Ht.isEqual(s.uri,o.uri,!0))&&(s=new Ov(this,o.uri),this.groups.push(s)),s.children.length===0||Qs._compareReferences(o,s.children[s.children.length-1])!==0){const r=new ru(i===o,s,o,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(r),s.children.push(r)}}dispose(){Ft(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new Qs(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?m("aria.result.0","No results found"):this.references.length===1?m("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?m("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):m("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let s=i.children.indexOf(e);const o=i.children.length,r=i.parent.groups.length;return r===1||t&&s+1<o||!t&&s>0?(t?s=(s+1)%o:s=(s+o-1)%o,i.children[s]):(s=i.parent.groups.indexOf(i),t?(s=(s+1)%r,i.parent.groups[s].children[0]):(s=(s+r-1)%r,i.parent.groups[s].children[i.parent.groups[s].children.length-1]))}nearestReference(e,t){const i=this.references.map((s,o)=>({idx:o,prefixLen:BS(s.uri.toString(),e.toString()),offsetDist:Math.abs(s.range.startLineNumber-t.lineNumber)*100+Math.abs(s.range.startColumn-t.column)})).sort((s,o)=>s.prefixLen>o.prefixLen?-1:s.prefixLen<o.prefixLen?1:s.offsetDist<o.offsetDist?-1:s.offsetDist>o.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&N.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return Ht.compare(e.uri,t.uri)||N.compareRangesUsingStarts(e.range,t.range)}}var Lk=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Dk=function(n,e){return function(t,i){e(t,i,n)}},qR;let GR=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof Qs||e instanceof Ov}getChildren(e){if(e instanceof Qs)return e.groups;if(e instanceof Ov)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};GR=Lk([Dk(0,Cu)],GR);class t4e{getHeight(){return 23}getTemplateId(e){return e instanceof Ov?Fv.id:Dy.id}}let KR=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof ru){const i=(t=e.parent.getPreview(e))===null||t===void 0?void 0:t.preview(e.range);if(i)return i.value}return na(e.uri)}};KR=Lk([Dk(0,bi)],KR);class i4e{getId(e){return e instanceof ru?e.id:e.uri}}let YR=class extends Y{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new tR(i,{supportHighlights:!0})),this.badge=new eR(le(i,we(".count")),{},JG),e.appendChild(i)}set(e,t){const i=qP(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const s=e.children.length;this.badge.setCount(s),s>1?this.badge.setTitleFormat(m("referencesCount","{0} references",s)):this.badge.setTitleFormat(m("referenceCount","{0} reference",s))}};YR=Lk([Dk(1,QD)],YR);let Fv=qR=class{constructor(e){this._instantiationService=e,this.templateId=qR.id}renderTemplate(e){return this._instantiationService.createInstance(YR,e)}renderElement(e,t,i){i.set(e.element,u3(e.filterData))}disposeTemplate(e){e.dispose()}};Fv.id="FileReferencesRenderer";Fv=qR=Lk([Dk(0,vt)],Fv);class n4e{constructor(e){this.label=new Td(e)}set(e,t){var i;const s=(i=e.parent.getPreview(e))===null||i===void 0?void 0:i.preview(e.range);if(!s||!s.value)this.label.set(`${na(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:o,highlight:r}=s;t&&!Xh.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(o,u3(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(o,[r]))}}}class Dy{constructor(){this.templateId=Dy.id}renderTemplate(e){return new n4e(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}Dy.id="OneReferenceRenderer";class s4e{getWidgetAriaLabel(){return m("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var o4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},vl=function(n,e){return function(t,i){e(t,i,n)}},YB=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class kk{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new pe,this._callOnModelChange=new pe,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let s=0,o=e.children.length;s<o;s++){const r=e.children[s];this._decorationIgnoreSet.has(r.id)||r.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:r.range,options:kk.DecorationOptions}),i.push(s))}this._editor.changeDecorations(s=>{const o=s.deltaDecorations([],t);for(let r=0;r<o.length;r++)this._decorations.set(o[r],e.children[i[r]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,s]of this._decorations){const o=t.getDecorationRange(i);if(!o)continue;let r=!1;if(!N.equalsRange(o,s.range)){if(N.spansMultipleLines(o))r=!0;else{const a=s.range.endColumn-s.range.startColumn,l=o.endColumn-o.startColumn;a!==l&&(r=!0)}r?(this._decorationIgnoreSet.add(s.id),e.push(i)):s.range=o}}for(let i=0,s=e.length;i<s;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}kk.DecorationOptions=et.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class r4e{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const s=JSON.parse(e);t=s.ratio,i=s.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class a4e extends XN{}let ZR=class extends Zx{constructor(e,t,i,s,o,r,a,l,c,d,u,h){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=o,this._instantiationService=r,this._peekViewService=a,this._uriLabel=l,this._undoRedoService=c,this._keybindingService=d,this._languageService=u,this._languageConfigurationService=h,this._disposeOnNewModel=new pe,this._callOnDispose=new pe,this._onDidSelectReference=new B,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new Qt(0,0),this._applyTheme(s.getColorTheme()),this._callOnDispose.add(s.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),Ft(this._preview),Ft(this._previewNotAvailableMessage),Ft(this._tree),Ft(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(XMe)||z.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(ZMe)||z.transparent,primaryHeadingColor:e.getColor(AY),secondaryHeadingColor:e.getColor(IY)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=le(e,we("div.messages")),sd(this._messageContainer),this._splitView=new oK(e,{orientation:1}),this._previewContainer=le(e,we("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(Wm,this._previewContainer,t,{},this.editor),sd(this._previewContainer),this._previewNotAvailableMessage=new tl(m("missingPreviewMessage","no preview available"),zo,tl.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=le(e,we("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new s4e,keyboardNavigationLabelProvider:this._instantiationService.createInstance(KR),identityProvider:new i4e,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:QMe}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(Hi(this._treeContainer,"keydown",o=>{o.equals(9)&&(this._keybindingService.dispatchEvent(o,o.target),o.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(a4e,"ReferencesWidget",this._treeContainer,new t4e,[this._instantiationService.createInstance(Fv),this._instantiationService.createInstance(Dy)],this._instantiationService.createInstance(GR),i),this._splitView.addView({onDidChange:ue.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:o=>{this._preview.layout({height:this._dim.height,width:o})}},Ox.Distribute),this._splitView.addView({onDidChange:ue.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:o=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${o}px`,this._tree.layout(this._dim.height,o)}},Ox.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const s=(o,r)=>{o instanceof ru&&(r==="show"&&this._revealReference(o,!1),this._onDidSelectReference.fire({element:o,kind:r,source:"tree"}))};this._tree.onDidOpen(o=>{o.sideBySide?s(o.element,"side"):o.editorOptions.pinned?s(o.element,"goto"):s(o.element,"show")}),sd(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new Qt(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=m("noResults","No results"),Uh(this._messageContainer),Promise.resolve(void 0)):(sd(this._messageContainer),this._decorationsManager=new kk(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const s=this._getFocusedReference();s&&this._onDidSelectReference.fire({element:{uri:s.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),Uh(this._treeContainer),Uh(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof ru)return e;if(e instanceof Ov&&e.children.length>0)return e.children[0]}revealReference(e){return YB(this,void 0,void 0,function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})})}_revealReference(e,t){return YB(this,void 0,void 0,function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==it.inMemory?this.setTitle(SCe(e.uri),this._uriLabel.getUriLabel(qP(e.uri))):this.setTitle(m("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent),this._tree.reveal(e));const s=yield i;if(!this._model){s.dispose();return}Ft(this._previewModelReference);const o=s.object;if(o){const r=this._preview.getModel()===o.textEditorModel?0:1,a=N.lift(e.range).collapseToStart();this._previewModelReference=s,this._preview.setModel(o.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,r)}else this._preview.setModel(this._previewNotAvailableMessage),s.dispose()})}};ZR=o4e([vl(3,ao),vl(4,Cu),vl(5,vt),vl(6,EY),vl(7,QD),vl(8,KD),vl(9,bi),vl(10,Ai),vl(11,oo)],ZR);var l4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},wg=function(n,e){return function(t,i){e(t,i,n)}},ZB=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},GC;const Qf=new _e("referenceSearchVisible",!1,m("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let Vm=GC=class{static get(e){return e.getContribution(GC.ID)}constructor(e,t,i,s,o,r,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=s,this._notificationService=o,this._instantiationService=r,this._storageService=a,this._configurationService=l,this._disposables=new pe,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=Qf.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)===null||e===void 0||e.dispose(),(t=this._model)===null||t===void 0||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let s;if(this._widget&&(s=this._widget.position),this.closeWidget(),s&&e.containsPosition(s))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const o="peekViewLayout",r=r4e.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(ZR,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(m("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget&&(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:d}=l;if(c)switch(d){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{var c;if(a!==this._requestIdPool||!this._widget){l.dispose();return}return(c=this._model)===null||c===void 0||c.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(m("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const d=this._editor.getModel().uri,u=new V(e.startLineNumber,e.startColumn),h=this._model.nearestReference(d,u);if(h)return this._widget.setSelection(h).then(()=>{this._widget&&this._editor.getOption(86)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return ZB(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const s=this._model.nextOrPreviousReference(i,e),o=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(s),yield this._gotoReference(s,!1),o?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()})}revealReference(e){return ZB(this,void 0,void 0,function*(){!this._editor.hasModel()||!this._model||!this._widget||(yield this._widget.revealReference(e))})}closeWidget(e=!0){var t,i;(t=this._widget)===null||t===void 0||t.dispose(),(i=this._model)===null||i===void 0||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){var i;(i=this._widget)===null||i===void 0||i.hide(),this._ignoreModelChangeEvent=!0;const s=N.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:s,selectionSource:"code.jump",pinned:t}},this._editor).then(o=>{var r;if(this._ignoreModelChangeEvent=!1,!o||!this._widget){this.closeWidget();return}if(this._editor===o)this._widget.show(s),this._widget.focusOnReferenceTree();else{const a=GC.get(o),l=this._model.clone();this.closeWidget(),o.focus(),a==null||a.toggleWidget(s,wc(c=>Promise.resolve(l)),(r=this._peekMode)!==null&&r!==void 0?r:!1)}},o=>{this._ignoreModelChangeEvent=!1,mt(o)})}openReference(e,t,i){t||this.closeWidget();const{uri:s,range:o}=e;this._editorService.openCodeEditor({resource:s,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,t)}};Vm.ID="editor.contrib.referencesController";Vm=GC=l4e([wg(2,tt),wg(3,Ut),wg(4,Ln),wg(5,vt),wg(6,Gf),wg(7,ti)],Vm);function Jf(n,e){const t=KMe(n);if(!t)return;const i=Vm.get(t);i&&e(i)}Fs.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:Fn(2089,60),when:Le.or(Qf,to.inPeekEditor),handler(n){Jf(n,e=>{e.changeFocusBetweenPreviewAndReferences()})}});Fs.registerCommandAndKeybindingRule({id:"goToNextReference",weight:100-10,primary:62,secondary:[70],when:Le.or(Qf,to.inPeekEditor),handler(n){Jf(n,e=>{e.goToNextOrPreviousReference(!0)})}});Fs.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:100-10,primary:1086,secondary:[1094],when:Le.or(Qf,to.inPeekEditor),handler(n){Jf(n,e=>{e.goToNextOrPreviousReference(!1)})}});Kt.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");Kt.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");Kt.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");Kt.registerCommand("closeReferenceSearch",n=>Jf(n,e=>e.closeWidget()));Fs.registerKeybindingRule({id:"closeReferenceSearch",weight:100-101,primary:9,secondary:[1033],when:Le.and(to.inPeekEditor,Le.not("config.editor.stablePeek"))});Fs.registerKeybindingRule({id:"closeReferenceSearch",weight:200+50,primary:9,secondary:[1033],when:Le.and(Qf,Le.not("config.editor.stablePeek"))});Fs.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:Le.and(Qf,yK,T3.negate(),N3.negate()),handler(n){var e;const i=(e=n.get(Zo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof ru&&Jf(n,s=>s.revealReference(i[0]))}});Fs.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:Le.and(Qf,yK,T3.negate(),N3.negate()),handler(n){var e;const i=(e=n.get(Zo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof ru&&Jf(n,s=>s.openReference(i[0],!0,!0))}});Kt.registerCommand("openReference",n=>{var e;const i=(e=n.get(Zo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof ru&&Jf(n,s=>s.openReference(i[0],!1,!0))});var TY=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},p_=function(n,e){return function(t,i){e(t,i,n)}};const s5=new _e("hasSymbols",!1,m("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),Ek=at("ISymbolNavigationService");let XR=class{constructor(e,t,i,s){this._editorService=t,this._notificationService=i,this._keybindingService=s,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=s5.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)===null||e===void 0||e.dispose(),(t=this._currentMessage)===null||t===void 0||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new QR(this._editorService),s=i.onDidChange(o=>{if(this._ignoreEditorChange)return;const r=this._editorService.getActiveCodeEditor();if(!r)return;const a=r.getModel(),l=r.getPosition();if(!a||!l)return;let c=!1,d=!1;for(const u of t.references)if(jP(u.uri,a.uri))c=!0,d=d||N.containsPosition(u.range,l);else if(c)break;(!c||!d)&&this.reset()});this._currentState=fr(i,s)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:N.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var e;(e=this._currentMessage)===null||e===void 0||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?m("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):m("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};XR=TY([p_(0,tt),p_(1,Ut),p_(2,Ln),p_(3,bi)],XR);ht(Ek,XR,1);Ae(new class extends Cr{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:s5,kbOpts:{weight:100,primary:70}})}runEditorCommand(n,e){return n.get(Ek).revealNext(e)}});Fs.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:s5,primary:9,handler(n){n.get(Ek).reset()}});let QR=class{constructor(e){this._listener=new Map,this._disposables=new pe,this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),Ft(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,fr(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))===null||t===void 0||t.dispose(),this._listener.delete(e)}};QR=TY([p_(0,Ut)],QR);var c4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},XB=function(n,e){return function(t,i){e(t,i,n)}},NY=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},JR;let Bv=JR=class{constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new B,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const s=new pe,o=s.add(ek(e,Object.assign(Object.assign({},this._getRenderOptions(e,s)),t),i));return o.element.classList.add("rendered-markdown"),{element:o.element,dispose:()=>s.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:(i,s)=>NY(this,void 0,void 0,function*(){var o,r,a;let l;i?l=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(l=(o=this._options.editor.getModel())===null||o===void 0?void 0:o.getLanguageId()),l||(l=zo);const c=yield GSe(this._languageService,s,l),d=document.createElement("span");if(d.innerHTML=(a=(r=JR._ttpTokenizer)===null||r===void 0?void 0:r.createHTML(c))!==null&&a!==void 0?a:c,this._options.editor){const u=this._options.editor.getOption(50);Rn(d,u)}else this._options.codeBlockFontFamily&&(d.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(d.style.fontSize=this._options.codeBlockFontSize),d}),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>RY(this._openerService,i,e.isTrusted),disposables:t}}}};Bv._ttpTokenizer=Vf("tokenizeToString",{createHTML(n){return n}});Bv=JR=c4e([XB(1,Ai),XB(2,Sc)],Bv);function RY(n,e,t){return NY(this,void 0,void 0,function*(){try{return yield n.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:d4e(t)})}catch(i){return mt(i),!1}})}function d4e(n){return n===!0?!0:n&&Array.isArray(n.enabledCommands)?n.enabledCommands:!1}var u4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},QB=function(n,e){return function(t,i){e(t,i,n)}},KC;let pr=KC=class{static get(e){return e.getContribution(KC.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new ta,this._messageListeners=new pe,this._mouseOverMessage=!1,this._editor=e,this._visible=KC.MESSAGE_VISIBLE.bindTo(t)}dispose(){var e;(e=this._message)===null||e===void 0||e.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){ay(Ad(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=Ad(e)?ek(e,{actionHandler:{callback:s=>RY(this._openerService,s,Ad(e)?e.isTrusted:void 0),disposables:this._messageListeners}}):void 0,this._messageWidget.value=new JB(this._editor,t,typeof e=="string"?e:this._message.element),this._messageListeners.add(ue.debounce(this._editor.onDidBlurEditorText,(s,o)=>o,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&Cn(Xr(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(K(this._messageWidget.value.getDomNode(),de.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(K(this._messageWidget.value.getDomNode(),de.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(s=>{s.target.position&&(i?i.containsPosition(s.target.position)||this.closeMessage():i=new N(t.lineNumber-3,1,s.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(JB.fadeOut(this._messageWidget.value))}};pr.ID="editor.contrib.messageController";pr.MESSAGE_VISIBLE=new _e("messageVisible",!1,m("messageVisible","Whether the editor is currently showing an inline message"));pr=KC=u4e([QB(1,tt),QB(2,Sc)],pr);const h4e=Cr.bindToContribution(pr.get);Ae(new h4e({id:"leaveEditorMessage",precondition:pr.MESSAGE_VISIBLE,handler:n=>n.closeMessage(),kbOpts:{weight:100+30,primary:9}}));let JB=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},s){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);const r=document.createElement("div");typeof s=="string"?(r.classList.add("message"),r.textContent=s):(s.classList.add("message"),r.appendChild(s)),this._domNode.appendChild(r);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};Lr(pr.ID,pr,4);var o5=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function ky(n,e,t,i){return o5(this,void 0,void 0,function*(){const o=t.ordered(n).map(a=>Promise.resolve(i(a,n,e)).then(void 0,l=>{bc(l)})),r=yield Promise.all(o);return cD(r.flat())})}function r5(n,e,t,i){return ky(e,t,n,(s,o,r)=>s.provideDefinition(o,r,i))}function MY(n,e,t,i){return ky(e,t,n,(s,o,r)=>s.provideDeclaration(o,r,i))}function PY(n,e,t,i){return ky(e,t,n,(s,o,r)=>s.provideImplementation(o,r,i))}function OY(n,e,t,i){return ky(e,t,n,(s,o,r)=>s.provideTypeDefinition(o,r,i))}function Ak(n,e,t,i,s){return ky(e,t,n,(o,r,a)=>o5(this,void 0,void 0,function*(){const l=yield o.provideReferences(r,a,{includeDeclaration:!0},s);if(!i||!l||l.length!==2)return l;const c=yield o.provideReferences(r,a,{includeDeclaration:!1},s);return c&&c.length===1?c:l}))}function Ey(n){return o5(this,void 0,void 0,function*(){const e=yield n(),t=new Qs(e,""),i=t.references.map(s=>s.link);return t.dispose(),i})}t0("_executeDefinitionProvider",(n,e,t)=>{const i=n.get(nt),s=r5(i.definitionProvider,e,t,rn.None);return Ey(()=>s)});t0("_executeTypeDefinitionProvider",(n,e,t)=>{const i=n.get(nt),s=OY(i.typeDefinitionProvider,e,t,rn.None);return Ey(()=>s)});t0("_executeDeclarationProvider",(n,e,t)=>{const i=n.get(nt),s=MY(i.declarationProvider,e,t,rn.None);return Ey(()=>s)});t0("_executeReferenceProvider",(n,e,t)=>{const i=n.get(nt),s=Ak(i.referenceProvider,e,t,!1,rn.None);return Ey(()=>s)});t0("_executeImplementationProvider",(n,e,t)=>{const i=n.get(nt),s=PY(i.implementationProvider,e,t,rn.None);return Ey(()=>s)});var mr=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},V0,z0,H0,iC,nC,sC,oC,rC;rr.appendMenuItem(I.EditorContext,{submenu:I.EditorContextPeek,title:m("peek.submenu","Peek"),group:"navigation",order:100});class Xx{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof Xx||V.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}class is extends Nme{static all(){return is._allSymbolNavigationCommands.values()}static _patchConfig(e){const t=Object.assign(Object.assign({},e),{f1:!0});if(t.menu)for(const i of dt.wrap(t.menu))(i.id===I.EditorContext||i.id===I.EditorContextPeek)&&(i.when=Le.and(e.precondition,i.when));return t}constructor(e,t){super(is._patchConfig(t)),this.configuration=e,is._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,s){if(!t.hasModel())return Promise.resolve(void 0);const o=e.get(Ln),r=e.get(Ut),a=e.get(gy),l=e.get(Ek),c=e.get(nt),d=e.get(vt),u=t.getModel(),h=t.getPosition(),f=Xx.is(i)?i:new Xx(u,h),g=new ZTe(t,5),p=Ome(this._getLocationModel(c,f.model,f.position,g.token),g.token).then(_=>mr(this,void 0,void 0,function*(){var v;if(!_||g.token.isCancellationRequested)return;ay(_.ariaMessage);let b;if(_.referenceAt(u.uri,h)){const w=this._getAlternativeCommand(t);!is._activeAlternativeCommands.has(w)&&is._allSymbolNavigationCommands.has(w)&&(b=is._allSymbolNavigationCommands.get(w))}const y=_.references.length;if(y===0){if(!this.configuration.muteMessage){const w=u.getWordAtPosition(h);(v=pr.get(t))===null||v===void 0||v.showMessage(this._getNoResultFoundMessage(w),h)}}else if(y===1&&b)is._activeAlternativeCommands.add(this.desc.id),d.invokeFunction(w=>b.runEditorCommand(w,t,i,s).finally(()=>{is._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(r,l,t,_,s)}),_=>{o.error(_)}).finally(()=>{g.dispose()});return a.showWhile(p,250),p}_onResult(e,t,i,s,o){return mr(this,void 0,void 0,function*(){const r=this._getGoToPreference(i);if(!(i instanceof Wm)&&(this.configuration.openInPeek||r==="peek"&&s.references.length>1))this._openInPeek(i,s,o);else{const a=s.firstReference(),l=s.references.length>1&&r==="gotoAndPeek",c=yield this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,s,o):s.dispose(),r==="goto"&&t.put(a)}})}_openReference(e,t,i,s,o){return mr(this,void 0,void 0,function*(){let r;if(Wge(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const a=yield t.openCodeEditor({resource:i.uri,options:{selection:N.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,s);if(a){if(o){const l=a.getModel(),c=a.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}})}_openInPeek(e,t,i){const s=Vm.get(e);s&&e.hasModel()?s.toggleWidget(i??e.getSelection(),wc(o=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}}is._allSymbolNavigationCommands=new Map;is._activeAlternativeCommands=new Set;class Ik extends is{_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield r5(e.definitionProvider,t,i,s),m("def.title","Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?m("noResultWord","No definition found for '{0}'",e.word):m("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}Bs((V0=class extends Ik{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:V0.id,title:{value:m("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:m({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:Le.and(H.hasDefinitionProvider,H.isInWalkThroughSnippet.toNegated()),keybinding:[{when:H.editorTextFocus,primary:70,weight:100},{when:Le.and(H.editorTextFocus,_K),primary:2118,weight:100}],menu:[{id:I.EditorContext,group:"navigation",order:1.1},{id:I.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),Kt.registerCommandAlias("editor.action.goToDeclaration",V0.id)}},V0.id="editor.action.revealDefinition",V0));Bs((z0=class extends Ik{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:z0.id,title:{value:m("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:Le.and(H.hasDefinitionProvider,H.isInWalkThroughSnippet.toNegated()),keybinding:[{when:H.editorTextFocus,primary:Fn(2089,70),weight:100},{when:Le.and(H.editorTextFocus,_K),primary:Fn(2089,2118),weight:100}]}),Kt.registerCommandAlias("editor.action.openDeclarationToTheSide",z0.id)}},z0.id="editor.action.revealDefinitionAside",z0));Bs((H0=class extends Ik{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:H0.id,title:{value:m("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:Le.and(H.hasDefinitionProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),keybinding:{when:H.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:I.EditorContextPeek,group:"peek",order:2}}),Kt.registerCommandAlias("editor.action.previewDeclaration",H0.id)}},H0.id="editor.action.peekDefinition",H0));class FY extends is{_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield MY(e.declarationProvider,t,i,s),m("decl.title","Declarations"))})}_getNoResultFoundMessage(e){return e&&e.word?m("decl.noResultWord","No declaration found for '{0}'",e.word):m("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}Bs((iC=class extends FY{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:iC.id,title:{value:m("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:m({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:Le.and(H.hasDeclarationProvider,H.isInWalkThroughSnippet.toNegated()),menu:[{id:I.EditorContext,group:"navigation",order:1.3},{id:I.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?m("decl.noResultWord","No declaration found for '{0}'",e.word):m("decl.generic.noResults","No declaration found")}},iC.id="editor.action.revealDeclaration",iC));Bs(class extends FY{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:m("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:Le.and(H.hasDeclarationProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),menu:{id:I.EditorContextPeek,group:"peek",order:3}})}});class BY extends is{_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield OY(e.typeDefinitionProvider,t,i,s),m("typedef.title","Type Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?m("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):m("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}Bs((nC=class extends BY{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:nC.ID,title:{value:m("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:m({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:Le.and(H.hasTypeDefinitionProvider,H.isInWalkThroughSnippet.toNegated()),keybinding:{when:H.editorTextFocus,primary:0,weight:100},menu:[{id:I.EditorContext,group:"navigation",order:1.4},{id:I.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},nC.ID="editor.action.goToTypeDefinition",nC));Bs((sC=class extends BY{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:sC.ID,title:{value:m("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:Le.and(H.hasTypeDefinitionProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),menu:{id:I.EditorContextPeek,group:"peek",order:4}})}},sC.ID="editor.action.peekTypeDefinition",sC));class WY extends is{_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield PY(e.implementationProvider,t,i,s),m("impl.title","Implementations"))})}_getNoResultFoundMessage(e){return e&&e.word?m("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):m("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}Bs((oC=class extends WY{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:oC.ID,title:{value:m("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:m({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:Le.and(H.hasImplementationProvider,H.isInWalkThroughSnippet.toNegated()),keybinding:{when:H.editorTextFocus,primary:2118,weight:100},menu:[{id:I.EditorContext,group:"navigation",order:1.45},{id:I.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},oC.ID="editor.action.goToImplementation",oC));Bs((rC=class extends WY{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:rC.ID,title:{value:m("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:Le.and(H.hasImplementationProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),keybinding:{when:H.editorTextFocus,primary:3142,weight:100},menu:{id:I.EditorContextPeek,group:"peek",order:5}})}},rC.ID="editor.action.peekImplementation",rC));class VY extends is{_getNoResultFoundMessage(e){return e?m("references.no","No references found for '{0}'",e.word):m("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}Bs(class extends VY{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:m("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:m({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:Le.and(H.hasReferenceProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),keybinding:{when:H.editorTextFocus,primary:1094,weight:100},menu:[{id:I.EditorContext,group:"navigation",order:1.45},{id:I.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield Ak(e.referenceProvider,t,i,!0,s),m("ref.title","References"))})}});Bs(class extends VY{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:m("references.action.label","Peek References"),original:"Peek References"},precondition:Le.and(H.hasReferenceProvider,to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated()),menu:{id:I.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(yield Ak(e.referenceProvider,t,i,!1,s),m("ref.title","References"))})}});class f4e extends is{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:{value:m("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:Le.and(to.notInPeekEditor,H.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i,s){return mr(this,void 0,void 0,function*(){return new Qs(this._references,m("generic.title","Locations"))})}_getNoResultFoundMessage(e){return e&&m("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return(t=this._gotoMultipleBehaviour)!==null&&t!==void 0?t:e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}Kt.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:je},{name:"position",description:"The position at which to start",constraint:V.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(n,e,t,i,s,o,r)=>mr(void 0,void 0,void 0,function*(){xs(je.isUri(e)),xs(V.isIPosition(t)),xs(Array.isArray(i)),xs(typeof s>"u"||typeof s=="string"),xs(typeof r>"u"||typeof r=="boolean");const a=n.get(Ut),l=yield a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(sY(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const d=new class extends f4e{_getNoResultFoundMessage(u){return o||super._getNoResultFoundMessage(u)}}({muteMessage:!o,openInPeek:!!r,openToSide:!1},i,s);c.get(vt).invokeFunction(d.run.bind(d),l)})})});Kt.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:je},{name:"position",description:"The position at which to start",constraint:V.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(n,e,t,i,s)=>mr(void 0,void 0,void 0,function*(){n.get(fs).executeCommand("editor.action.goToLocations",e,t,i,s,void 0,!0)})});Kt.registerCommand({id:"editor.action.findReferences",handler:(n,e,t)=>{xs(je.isUri(e)),xs(V.isIPosition(t));const i=n.get(nt),s=n.get(Ut);return s.openCodeEditor({resource:e},s.getFocusedCodeEditor()).then(o=>{if(!sY(o)||!o.hasModel())return;const r=Vm.get(o);if(!r)return;const a=wc(c=>Ak(i.referenceProvider,o.getModel(),V.lift(t),!1,c).then(d=>new Qs(d,m("ref.title","References")))),l=new N(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(r.toggleWidget(l,a,!1))})}});Kt.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");var g4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},jE=function(n,e){return function(t,i){e(t,i,n)}},eW=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},m_;let Lf=m_=class{constructor(e,t,i,s){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=s,this.toUnhook=new pe,this.toUnhookForKeyboard=new pe,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const o=new zMe(e);this.toUnhook.add(o),this.toUnhook.add(o.onMouseMoveOrRelevantKeyDown(([r,a])=>{this.startFindDefinitionFromMouse(r,a??void 0)})),this.toUnhook.add(o.onExecute(r=>{this.isEnabled(r)&&this.gotoDefinition(r.target.position,r.hasSideBySideModifier).catch(a=>{mt(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(o.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(m_.ID)}startFindDefinitionFromCursor(e){return eW(this,void 0,void 0,function*(){yield this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))})}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;return eW(this,void 0,void 0,function*(){this.toUnhookForKeyboard.clear();const i=e?(t=this.editor.getModel())===null||t===void 0?void 0:t.getWordAtPosition(e):null;if(!i){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return;this.currentWordAtPosition=i;const s=new YTe(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=wc(a=>this.findDefinition(e,a));let o;try{o=yield this.previousPromise}catch(a){mt(a);return}if(!o||!o.length||!s.validate(this.editor)){this.removeLinkDecorations();return}const r=o[0].originSelectionRange?N.lift(o[0].originSelectionRange):new N(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);if(o.length>1){let a=r;for(const{originSelectionRange:l}of o)l&&(a=N.plusRange(a,l));this.addDecoration(a,new Rm().appendText(m("multipleResults","Click to show {0} definitions.",o.length)))}else{const a=o[0];if(!a.uri)return;this.textModelResolverService.createModelReference(a.uri).then(l=>{if(!l.object||!l.object.textEditorModel){l.dispose();return}const{object:{textEditorModel:c}}=l,{startLineNumber:d}=a.range;if(d<1||d>c.getLineCount()){l.dispose();return}const u=this.getPreviewValue(c,d,a),h=this.languageService.guessLanguageIdByFilepathOrFirstLine(c.uri);this.addDecoration(r,u?new Rm().appendCodeblock(h||"",u):void 0),l.dispose()})}})}getPreviewValue(e,t,i){let s=i.range;return s.endLineNumber-s.startLineNumber>=m_.MAX_SOURCE_PREVIEW_LINES&&(s=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,s)}stripIndentationFromPreviewRange(e,t,i){let o=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);o=Math.min(o,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${o-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),s=Math.min(e.getLineCount(),t+m_.MAX_SOURCE_PREVIEW_LINES);let o=t+1;for(;o<s;o++){const r=e.getLineFirstNonWhitespaceColumn(o);if(i===r)break}return new N(t,1,o+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(((i=e.target.detail.injectedText)===null||i===void 0?void 0:i.options)instanceof Am)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?r5(this.languageFeaturesService.definitionProvider,i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const s=!t&&this.editor.getOption(87)&&!this.isInPeekEditor(i);return new Ik({openToSide:t,openInPeek:s,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(tt);return to.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};Lf.ID="editor.contrib.gotodefinitionatposition";Lf.MAX_SOURCE_PREVIEW_LINES=8;Lf=m_=g4e([jE(1,Cu),jE(2,Ai),jE(3,nt)],Lf);Lr(Lf.ID,Lf,2);const aC=we;class zY extends Y{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new FP(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}}class a5 extends Y{static render(e,t,i){return new a5(e,t,i)}constructor(e,t,i){super(),this.actionContainer=le(e,aC("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=le(this.actionContainer,aC("a.action")),this.action.setAttribute("role","button"),t.iconClass&&le(this.action,aC(`span.icon.${t.iconClass}`));const s=le(this.action,aC("span"));s.textContent=i?`${t.label} (${i})`:t.label,this._register(K(this.actionContainer,de.CLICK,o=>{o.stopPropagation(),o.preventDefault(),t.run(this.actionContainer)})),this._register(K(this.actionContainer,de.KEY_DOWN,o=>{const r=new zt(o);(r.equals(3)||r.equals(10))&&(o.stopPropagation(),o.preventDefault(),t.run(this.actionContainer))})),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function p4e(n,e){return n&&e?m("acessibleViewHint","Inspect this in the accessible view with {0}.",e):n?m("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}var m4e=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},_4e=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(r){return new Promise(function(a,l){r=n[o](r),s(a,l,r.done,r.value)})}}function s(o,r,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},r)}};let b4e=class{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}};class HY extends Y{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new B),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new Li(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new Li(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new Li(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=Hme(e=>this._computer.computeAsync(e)),m4e(this,void 0,void 0,function*(){var e,t,i,s;try{try{for(var o=!0,r=_4e(this._asyncIterable),a;a=yield r.next(),e=a.done,!e;o=!0){s=a.value,o=!1;const l=s;l&&(this._result.push(l),this._fireResult())}}catch(l){t={error:l}}finally{try{!o&&!e&&(i=r.return)&&(yield i.call(r))}finally{if(t)throw t.error}}this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(l){mt(l)}})):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const e=this._state===0,t=this._state===4;this._onResult.fire(new b4e(this._result.slice(0),e,t))}start(e){if(e===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class qE{constructor(e,t,i,s){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=s,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}const l5=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};class v4e{constructor(){this._onDidWillResize=new B,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new B,this.onDidResize=this._onDidResize.event,this._sashListener=new pe,this._size=new Qt(0,0),this._minSize=new Qt(0,0),this._maxSize=new Qt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new kn(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new kn(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new kn(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:Mx.North}),this._southSash=new kn(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:Mx.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(ue.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(ue.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(s=>{e&&(i=s.currentX-s.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(s=>{e&&(i=-(s.currentX-s.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(s=>{e&&(t=-(s.currentY-s.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(s=>{e&&(t=s.currentY-s.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(ue.any(this._eastSash.onDidReset,this._westSash.onDidReset)(s=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(ue.any(this._northSash.onDidReset,this._southSash.onDidReset)(s=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,s){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=s?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:s}=this._minSize,{height:o,width:r}=this._maxSize;e=Math.max(i,Math.min(o,e)),t=Math.max(s,Math.min(r,t));const a=new Qt(t,e);Qt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const y4e=30,w4e=24;class C4e extends Y{constructor(e,t=new Qt(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new v4e),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=Qt.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new Qt(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return!((e=this._contentPosition)===null||e===void 0)&&e.position?V.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:Nn(t).top+i.top-y4e}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const s=Nn(t),o=DD(t.ownerDocument.body),r=s.top+i.top+i.height;return o.height-r-w4e}_findPositionPreference(e,t){var i,s;const o=Math.min((i=this._availableVerticalSpaceBelow(t))!==null&&i!==void 0?i:1/0,e),r=Math.min((s=this._availableVerticalSpaceAbove(t))!==null&&s!==void 0?s:1/0,e),a=Math.min(Math.max(r,o),e),l=Math.min(e,a);let c;return this._editor.getOption(60).above?c=l<=r?1:2:c=l<=o?2:1,c===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),c}_resize(e){this._resizableNode.layout(e.height,e.width)}}var c5=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},kh=function(n,e){return function(t,i){e(t,i,n)}},YC,_a;const tW=we;let Qx=YC=class extends Y{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._widget=this._register(this._instantiationService.createInstance(Md,this._editor)),this._participants=[];for(const s of l5.getAll())this._participants.push(this._instantiationService.createInstance(s,this._editor));this._participants.sort((s,o)=>s.hoverOrdinal-o.hoverOrdinal),this._computer=new Jx(this._editor,this._participants),this._hoverOperation=this._register(new HY(this._editor,this._computer)),this._register(this._hoverOperation.onResult(s=>{if(!this._computer.anchor)return;const o=s.hasLoadingMessage?this._addLoadingMessage(s.value):s.value;this._withResult(new $Y(this._computer.anchor,o,s.isComplete))})),this._register(Hi(this._widget.getDomNode(),"keydown",s=>{s.equals(9)&&this.hide()})),this._register(Si.onDidChange(()=>{this._widget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}get widget(){return this._widget}maybeShowAt(e){if(this._widget.isResizing)return!0;const t=[];for(const s of this._participants)if(s.suggestHoverAnchor){const o=s.suggestHoverAnchor(e);o&&t.push(o)}const i=e.target;if(i.type===6&&t.push(new qE(0,i.range,e.event.posx,e.event.posy)),i.type===7){const s=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<s&&t.push(new qE(0,i.range,e.event.posx,e.event.posy))}return t.length===0?this._startShowingOrUpdateHover(null,0,0,!1,e):(t.sort((s,o)=>o.priority-s.priority),this._startShowingOrUpdateHover(t[0],0,0,!1,e))}startShowingAtRange(e,t,i,s){this._startShowingOrUpdateHover(new qE(0,e,void 0,void 0),t,i,s,null)}_startShowingOrUpdateHover(e,t,i,s,o){return!this._widget.position||!this._currentResult?e?(this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):!1:this._editor.getOption(60).sticky&&o&&this._widget.isMouseGettingCloser(o.event.posx,o.event.posy)?(e&&this._startHoverOperationIfNecessary(e,t,i,s,!0),!0):e?e&&this._currentResult.anchor.equals(e)?!0:e.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,s,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,s,o){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=s,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=o,this._hoverOperation.start(t))}_setCurrentResult(e){this._currentResult!==e&&(e&&e.messages.length===0&&(e=null),this._currentResult=e,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}get isColorPickerVisible(){return this._widget.isColorPickerVisible}get isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}get isVisible(){return this._widget.isVisible}get isFocused(){return this._widget.isFocused}get isResizing(){return this._widget.isResizing}containsNode(e){return e?this._widget.getDomNode().contains(e):!1}_addLoadingMessage(e){if(this._computer.anchor){for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}}return e}_withResult(e){this._widget.position&&this._currentResult&&this._currentResult.isComplete&&(!e.isComplete||this._computer.insistOnKeepingHoverVisible&&e.messages.length===0)||this._setCurrentResult(e)}_renderMessages(e,t){const{showAtPosition:i,showAtSecondaryPosition:s,highlightRange:o}=YC.computeHoverRanges(this._editor,e.range,t),r=new pe,a=r.add(new eM(this._keybindingService)),l=document.createDocumentFragment();let c=null;const d={fragment:l,statusBar:a,setColorPicker:h=>c=h,onContentsChanged:()=>this._widget.onContentsChanged(),setMinimumDimensions:h=>this._widget.setMinimumDimensions(h),hide:()=>this.hide()};for(const h of this._participants){const f=t.filter(g=>g.owner===h);f.length>0&&r.add(h.renderHoverParts(d,f))}const u=t.some(h=>h.isBeforeContent);if(a.hasContent&&l.appendChild(a.hoverElement),l.hasChildNodes()){if(o){const h=this._editor.createDecorationsCollection();h.set([{range:o,options:YC._DECORATION_OPTIONS}]),r.add(Ze(()=>{h.clear()}))}this._widget.showAt(l,new x4e(c,i,s,this._editor.getOption(60).above,this._computer.shouldFocus,this._computer.source,u,e.initialMousePosX,e.initialMousePosY,r))}else r.dispose()}static computeHoverRanges(e,t,i){let s=1;if(e.hasModel()){const c=e._getViewModel(),d=c.coordinatesConverter,u=d.convertModelRangeToViewRange(t),h=new V(u.startLineNumber,c.getLineMinColumn(u.startLineNumber));s=d.convertViewPositionToModelPosition(h).column}const o=t.startLineNumber;let r=t.startColumn,a=i[0].range,l=null;for(const c of i)a=N.plusRange(a,c.range),c.range.startLineNumber===o&&c.range.endLineNumber===o&&(r=Math.max(Math.min(r,c.range.startColumn),s)),c.forceShowAtRange&&(l=c.range);return{showAtPosition:l?l.getStartPosition():new V(o,t.startColumn),showAtSecondaryPosition:l?l.getStartPosition():new V(o,r),highlightRange:a}}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}};Qx._DECORATION_OPTIONS=et.register({description:"content-hover-highlight",className:"hoverHighlight"});Qx=YC=c5([kh(1,vt),kh(2,bi)],Qx);class $Y{constructor(e,t,i){this.anchor=e,this.messages=t,this.isComplete=i}filter(e){const t=this.messages.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.messages.length?this:new S4e(this,this.anchor,t,this.isComplete)}}class S4e extends $Y{constructor(e,t,i,s){super(t,i,s),this.original=e}filter(e){return this.original.filter(e)}}class x4e{constructor(e,t,i,s,o,r,a,l,c,d){this.colorPicker=e,this.showAtPosition=t,this.showAtSecondaryPosition=i,this.preferAbove=s,this.stoleFocus=o,this.source=r,this.isBeforeContent=a,this.initialMousePosX=l,this.initialMousePosY=c,this.disposables=d,this.closestMouseDistance=void 0}}const iW=30,GE=10,L4e=6;let Md=_a=class extends C4e{get isColorPickerVisible(){var e;return!!(!((e=this._visibleData)===null||e===void 0)&&e.colorPicker)}get isVisibleFromKeyboard(){var e;return((e=this._visibleData)===null||e===void 0?void 0:e.source)===1}get isVisible(){var e;return(e=this._hoverVisibleKey.get())!==null&&e!==void 0?e:!1}get isFocused(){var e;return(e=this._hoverFocusedKey.get())!==null&&e!==void 0?e:!1}constructor(e,t,i,s,o){const r=e.getOption(66)+8,a=150,l=new Qt(a,r);super(e,l),this._configurationService=i,this._accessibilityService=s,this._keybindingService=o,this._hover=this._register(new zY),this._minimumSize=l,this._hoverVisibleKey=H.hoverVisible.bindTo(t),this._hoverFocusedKey=H.hoverFocused.bindTo(t),le(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>this._layout())),this._register(this._editor.onDidChangeConfiguration(d=>{d.hasChanged(50)&&this._updateFont()}));const c=this._register(eu(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setHoverData(void 0),this._layout(),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),(e=this._visibleData)===null||e===void 0||e.disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return _a.ID}static _applyDimensions(e,t,i){const s=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.width=s,e.style.height=o}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return _a._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return _a._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const s=typeof t=="number"?`${t}px`:t,o=typeof i=="number"?`${i}px`:i;e.style.maxWidth=s,e.style.maxHeight=o}_setHoverWidgetMaxDimensions(e,t){_a._applyMaxDimensions(this._hover.contentsDomNode,e,t),_a._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_hasHorizontalScrollbar(){const e=this._hover.scrollbar.getScrollDimensions();return e.scrollWidth>e.width}_adjustContentsBottomPadding(){const e=this._hover.contentsDomNode,t=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;e.style.paddingBottom!==t&&(e.style.paddingBottom=t)}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._setContentsDomNodeDimensions(t,i-GE))}_updateResizableNodeMaxDimensions(){var e,t;const i=(e=this._findMaximumRenderingWidth())!==null&&e!==void 0?e:1/0,s=(t=this._findMaximumRenderingHeight())!==null&&t!==void 0?t:1/0;this._resizableNode.maxSize=new Qt(i,s),this._setHoverWidgetMaxDimensions(i,s)}_resize(e){var t,i;_a._lastDimensions=new Qt(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),(i=(t=this._visibleData)===null||t===void 0?void 0:t.colorPicker)===null||i===void 0||i.layout()}_findAvailableSpaceVertically(){var e;const t=(e=this._visibleData)===null||e===void 0?void 0:e.showAtPosition;if(t)return this._positionPreference===1?this._availableVerticalSpaceAbove(t):this._availableVerticalSpaceBelow(t)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=L4e;return Array.from(this._hover.contentsDomNode.children).forEach(i=>{t+=i.clientHeight}),this._hasHorizontalScrollbar()&&(t+=GE),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<t?DD(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._visibleData)return!1;if(typeof this._visibleData.initialMousePosX>"u"||typeof this._visibleData.initialMousePosY>"u")return this._visibleData.initialMousePosX=e,this._visibleData.initialMousePosY=t,!1;const i=Nn(this.getDomNode());typeof this._visibleData.closestMouseDistance>"u"&&(this._visibleData.closestMouseDistance=nW(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,i.left,i.top,i.width,i.height));const s=nW(e,t,i.left,i.top,i.width,i.height);return s>this._visibleData.closestMouseDistance+4?!1:(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,s),!0)}_setHoverData(e){var t;(t=this._visibleData)===null||t===void 0||t.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_layout(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,this._updateMaxDimensions()}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,_a._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,500,_a._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e,t){this._setHoverData(t),this._updateFont(),this._updateContent(e),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){var e;return this._visibleData?{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,positionAffinity:this._visibleData.isBeforeContent?3:void 0,preference:[(e=this._positionPreference)!==null&&e!==void 0?e:1]}:null}showAt(e,t){var i,s,o,r;if(!this._editor||!this._editor.hasModel())return;this._render(e,t);const a=wh(this._hover.containerDomNode),l=t.showAtPosition;this._positionPreference=(i=this._findPositionPreference(a,l))!==null&&i!==void 0?i:1,this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),(s=t.colorPicker)===null||s===void 0||s.layout();const c=p4e(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),(r=(o=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))===null||o===void 0?void 0:o.getAriaLabel())!==null&&r!==void 0?r:"");c&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+c)}hide(){if(!this._visibleData)return;const e=this._visibleData.stoleFocus||this._hoverFocusedKey.get();this._setHoverData(void 0),this._resizableNode.maxSize=new Qt(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}_adjustHoverHeightForScrollbar(e){var t;const i=this._hover.containerDomNode,s=this._hover.contentsDomNode,o=(t=this._findMaximumRenderingHeight())!==null&&t!==void 0?t:1/0;this._setContainerDomNodeDimensions(ys(i),Math.min(o,e)),this._setContentsDomNodeDimensions(ys(s),Math.min(o,e-GE))}setMinimumDimensions(e){this._minimumSize=new Qt(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new Qt(e,this._minimumSize.height)}onContentsChanged(){var e;this._removeConstraintsRenderNormally();const t=this._hover.containerDomNode;let i=wh(t),s=ys(t);if(this._resizableNode.layout(i,s),this._setHoverWidgetDimensions(s,i),i=wh(t),s=ys(t),this._contentWidth=s,this._updateMinimumWidth(),this._resizableNode.layout(i,s),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._adjustHoverHeightForScrollbar(i)),!((e=this._visibleData)===null||e===void 0)&&e.showAtPosition){const o=wh(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(o,this._visibleData.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-iW})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+iW})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};Md.ID="editor.contrib.resizableContentHoverWidget";Md._lastDimensions=new Qt(0,0);Md=_a=c5([kh(1,tt),kh(2,ti),kh(3,Du),kh(4,bi)],Md);let eM=class extends Y{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=tW("div.hover-row.status-bar"),this.actionsElement=le(this.hoverElement,tW("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(a5.render(this.actionsElement,e,i))}append(e){const t=le(this.actionsElement,e);return this._hasContent=!0,t}};eM=c5([kh(0,bi)],eM);class Jx{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),s=t.range.startLineNumber;if(s>i.getLineCount())return[];const o=i.getLineMaxColumn(s);return e.getLineDecorations(s).filter(r=>{if(r.options.isWholeLine)return!0;const a=r.range.startLineNumber===s?r.range.startColumn:1,l=r.range.endLineNumber===s?r.range.endColumn:o;if(r.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return ln.EMPTY;const i=Jx._getLineDecorations(this._editor,t);return ln.merge(this._participants.map(s=>s.computeAsync?s.computeAsync(t,i,e):ln.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=Jx._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return cD(t)}}function nW(n,e,t,i,s,o){const r=t+s/2,a=i+o/2,l=Math.max(Math.abs(n-r)-s/2,0),c=Math.max(Math.abs(e-a)-o/2,0);return Math.sqrt(l*l+c*c)}const sW=we;class Np extends Y{constructor(e,t,i){super(),this._renderDisposeables=this._register(new pe),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new zY),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new Bv({editor:this._editor},t,i)),this._computer=new D4e(this._editor),this._hoverOperation=this._register(new HY(this._editor,this._computer)),this._register(this._hoverOperation.onResult(s=>{this._withResult(s.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(s=>{s.hasChanged(50)&&this._updateFont()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return Np.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const s of t){const o=sW("div.hover-row.markdown-hover"),r=le(o,sW("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(s.value));r.appendChild(a.element),i.appendChild(o)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),s=this._editor.getScrollTop(),o=this._editor.getOption(66),r=this._hover.containerDomNode.clientHeight,a=i-s-(r-o)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}}Np.ID="editor.contrib.modesGlyphHoverWidget";class D4e{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}constructor(e){this._editor=e,this._lineNumber=-1}computeSync(){const e=s=>({value:s}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const s of t){if(!s.options.glyphMarginClassName)continue;const o=s.options.glyphMarginHoverMessage;!o||bv(o)||i.push(...mU(o).map(e))}return i}}var k4e=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class E4e{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function A4e(n,e,t,i,s){return k4e(this,void 0,void 0,function*(){try{const o=yield Promise.resolve(n.provideHover(t,i,s));if(o&&T4e(o))return new E4e(n,o,e)}catch(o){bc(o)}})}function UY(n,e,t,i){const o=n.ordered(e).map((r,a)=>A4e(r,a,e,t,i));return ln.fromPromises(o).coalesce()}function I4e(n,e,t,i){return UY(n,e,t,i).map(s=>s.hover).toPromise()}t0("_executeHoverProvider",(n,e,t)=>{const i=n.get(nt);return I4e(i.hoverProvider,e,t,rn.None)});function T4e(n){const e=typeof n.range<"u",t=typeof n.contents<"u"&&n.contents&&n.contents.length>0;return e&&t}var N4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},lC=function(n,e){return function(t,i){e(t,i,n)}};const oW=we;class $0{constructor(e,t,i,s,o){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=s,this.ordinal=o}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let tM=class{constructor(e,t,i,s,o){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=s,this._languageFeaturesService=o,this.hoverOrdinal=3}createLoadingMessage(e){return new $0(this,e.range,[new Rm().appendText(m("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),s=e.range.startLineNumber,o=i.getLineMaxColumn(s),r=[];let a=1e3;const l=i.getLineLength(s),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._editor.getOption(116),u=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let h=!1;d>=0&&l>d&&e.range.startColumn>=d&&(h=!0,r.push(new $0(this,e.range,[{value:m("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!h&&typeof u=="number"&&l>=u&&r.push(new $0(this,e.range,[{value:m("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let f=!1;for(const g of t){const p=g.range.startLineNumber===s?g.range.startColumn:1,_=g.range.endLineNumber===s?g.range.endColumn:o,v=g.options.hoverMessage;if(!v||bv(v))continue;g.options.beforeContentClassName&&(f=!0);const b=new N(e.range.startLineNumber,p,e.range.startLineNumber,_);r.push(new $0(this,b,mU(v),f,a++))}return r}computeAsync(e,t,i){if(!this._editor.hasModel()||e.type!==1)return ln.EMPTY;const s=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(s))return ln.EMPTY;const o=new V(e.range.startLineNumber,e.range.startColumn);return UY(this._languageFeaturesService.hoverProvider,s,o,i).filter(r=>!bv(r.hover.contents)).map(r=>{const a=r.hover.range?N.lift(r.hover.range):e.range;return new $0(this,a,r.hover.contents,!1,r.ordinal)})}renderHoverParts(e,t){return R4e(e,t,this._editor,this._languageService,this._openerService)}};tM=N4e([lC(1,Ai),lC(2,Sc),lC(3,ti),lC(4,nt)],tM);function R4e(n,e,t,i,s){e.sort((r,a)=>r.ordinal-a.ordinal);const o=new pe;for(const r of e)for(const a of r.contents){if(bv(a))continue;const l=oW("div.hover-row.markdown-hover"),c=le(l,oW("div.hover-contents")),d=o.add(new Bv({editor:t},i,s));o.add(d.onDidRenderAsync(()=>{c.className="hover-contents code-hover-contents",n.onContentsChanged()}));const u=o.add(d.render(a));c.appendChild(u.element),n.fragment.appendChild(l)}return o}var M4e=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class We{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+We.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(e){return new We(this.value+We.sep+e)}}We.sep=".";We.None=new We("@@none@@");We.Empty=new We("");We.QuickFix=new We("quickfix");We.Refactor=new We("refactor");We.RefactorExtract=We.Refactor.append("extract");We.RefactorInline=We.Refactor.append("inline");We.RefactorMove=We.Refactor.append("move");We.RefactorRewrite=We.Refactor.append("rewrite");We.Notebook=new We("notebook");We.Source=new We("source");We.SourceOrganizeImports=We.Source.append("organizeImports");We.SourceFixAll=We.Source.append("fixAll");We.SurroundWith=We.Refactor.append("surround");var au;(function(n){n.Refactor="refactor",n.RefactorPreview="refactor preview",n.Lightbulb="lightbulb",n.Default="other (default)",n.SourceAction="source action",n.QuickFix="quick fix action",n.FixAll="fix all",n.OrganizeImports="organize imports",n.AutoFix="auto fix",n.QuickFixHover="quick fix hover window",n.OnSave="save participants",n.ProblemsView="problems view"})(au||(au={}));function P4e(n,e){return!(n.include&&!n.include.intersects(e)||n.excludes&&n.excludes.some(t=>jY(e,t,n.include))||!n.includeSourceActions&&We.Source.contains(e))}function O4e(n,e){const t=e.kind?new We(e.kind):void 0;return!(n.include&&(!t||!n.include.contains(t))||n.excludes&&t&&n.excludes.some(i=>jY(t,i,n.include))||!n.includeSourceActions&&t&&We.Source.contains(t)||n.onlyIncludePreferredActions&&!e.isPreferred)}function jY(n,e,t){return!(!e.contains(n)||t&&e.contains(t))}class hh{static fromUser(e,t){return!e||typeof e!="object"?new hh(t.kind,t.apply,!1):new hh(hh.getKindFromUser(e,t.kind),hh.getApplyFromUser(e,t.apply),hh.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new We(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class F4e{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}resolve(e){var t;return M4e(this,void 0,void 0,function*(){if(!((t=this.provider)===null||t===void 0)&&t.resolveCodeAction&&!this.action.edit){let i;try{i=yield this.provider.resolveCodeAction(this.action,e)}catch(s){bc(s)}i&&(this.action.edit=i.edit)}return this})}}var eL=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const B4e="editor.action.codeAction",qY="editor.action.quickFix",W4e="editor.action.autoFix",V4e="editor.action.refactor",z4e="editor.action.sourceAction",GY="editor.action.organizeImports",KY="editor.action.fixAll";class Z_ extends Y{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return tc(e.diagnostics)?tc(t.diagnostics)?Z_.codeActionsPreferredComparator(e,t):-1:tc(t.diagnostics)?1:Z_.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(Z_.codeActionsComparator),this.validActions=this.allActions.filter(({action:s})=>!s.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&We.QuickFix.contains(new We(e.kind))&&!!e.isPreferred)}}const rW={actions:[],documentation:void 0};function X_(n,e,t,i,s,o){var r;return eL(this,void 0,void 0,function*(){const a=i.filter||{},l=Object.assign(Object.assign({},a),{excludes:[...a.excludes||[],We.Notebook]}),c={only:(r=a.include)===null||r===void 0?void 0:r.value,trigger:i.type},d=new XTe(e,o),u=i.type===2,h=H4e(n,e,u?l:a),f=new pe,g=h.map(_=>eL(this,void 0,void 0,function*(){try{s.report(_);const v=yield _.provideCodeActions(e,t,c,d.token);if(v&&f.add(v),d.token.isCancellationRequested)return rW;const b=((v==null?void 0:v.actions)||[]).filter(w=>w&&O4e(a,w)),y=U4e(_,b,a.include);return{actions:b.map(w=>new F4e(w,_)),documentation:y}}catch(v){if(Rf(v))throw v;return bc(v),rW}})),p=n.onDidChange(()=>{const _=n.all(e);Ki(_,h)||d.cancel()});try{const _=yield Promise.all(g),v=_.map(y=>y.actions).flat(),b=[...cD(_.map(y=>y.documentation)),...$4e(n,e,i,v)];return new Z_(v,b,f)}finally{p.dispose(),d.dispose()}})}function H4e(n,e,t){return n.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(s=>P4e(t,new We(s))):!0)}function*$4e(n,e,t,i){var s,o,r;if(e&&i.length)for(const a of n.all(e))a._getAdditionalMenuItems&&(yield*(s=a._getAdditionalMenuItems)===null||s===void 0?void 0:s.call(a,{trigger:t.type,only:(r=(o=t.filter)===null||o===void 0?void 0:o.include)===null||r===void 0?void 0:r.value},i.map(l=>l.action)))}function U4e(n,e,t){if(!n.documentation)return;const i=n.documentation.map(s=>({kind:new We(s.kind),command:s.command}));if(t){let s;for(const o of i)o.kind.contains(t)&&(s?s.kind.contains(o.kind)&&(s=o):s=o);if(s)return s==null?void 0:s.command}for(const s of e)if(s.kind){for(const o of i)if(o.kind.contains(new We(s.kind)))return o.command}}var tL;(function(n){n.OnSave="onSave",n.FromProblemsView="fromProblemsView",n.FromCodeActions="fromCodeActions"})(tL||(tL={}));function j4e(n,e,t,i,s=rn.None){var o;return eL(this,void 0,void 0,function*(){const r=n.get(AG),a=n.get(fs),l=n.get(vc),c=n.get(Ln);if(l.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),yield e.resolve(s),!s.isCancellationRequested&&!(!((o=e.action.edit)===null||o===void 0)&&o.edits.length&&!(yield r.apply(e.action.edit,{editor:i==null?void 0:i.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==tL.OnSave,showPreview:i==null?void 0:i.preview})).isApplied)&&e.action.command)try{yield a.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(d){const u=q4e(d);c.error(typeof u=="string"?u:m("applyCodeActionFailed","An unknown error occurred while applying the code action"))}})}function q4e(n){return typeof n=="string"?n:n instanceof Error&&typeof n.message=="string"?n.message:void 0}Kt.registerCommand("_executeCodeActionProvider",function(n,e,t,i,s){return eL(this,void 0,void 0,function*(){if(!(e instanceof je))throw ic();const{codeActionProvider:o}=n.get(nt),r=n.get(hs).getModel(e);if(!r)throw ic();const a=lt.isISelection(t)?lt.liftSelection(t):N.isIRange(t)?r.validateRange(t):void 0;if(!a)throw ic();const l=typeof i=="string"?new We(i):void 0,c=yield X_(o,r,a,{type:1,triggerAction:au.Default,filter:{includeSourceActions:!0,include:l}},Lp.None,rn.None),d=[],u=Math.min(c.validActions.length,typeof s=="number"?s:0);for(let h=0;h<u;h++)d.push(c.validActions[h].resolve(rn.None));try{return yield Promise.all(d),c.validActions.map(h=>h.action)}finally{setTimeout(()=>c.dispose(),100)}})});var G4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},K4e=function(n,e){return function(t,i){e(t,i,n)}},iM;let iL=iM=class{constructor(e){this.keybindingService=e}getResolver(){const e=new Mf(()=>this.keybindingService.getKeybindings().filter(t=>iM.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===GY?i={kind:We.SourceOrganizeImports.value}:t.command===KY&&(i={kind:We.SourceFixAll.value}),Object.assign({resolvedKeybinding:t.resolvedKeybinding},hh.fromUser(i,{kind:We.None,apply:"never"}))}));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.value);return i==null?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new We(e.kind);return t.filter(s=>s.kind.contains(i)).filter(s=>s.preferred?e.isPreferred:!0).reduceRight((s,o)=>s?s.kind.contains(o.kind)?o:s:o,void 0)}};iL.codeActionCommands=[V4e,B4e,z4e,GY,KY];iL=iM=G4e([K4e(0,bi)],iL);E("symbolIcon.arrayForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.booleanForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},m("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.colorForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.constantForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},m("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},m("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.fileForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.folderForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.keyForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.keywordForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},m("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.moduleForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.namespaceForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.nullForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.numberForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.objectForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.operatorForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.packageForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.propertyForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.referenceForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.snippetForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.stringForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.structForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.textForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.typeParameterForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.unitForeground",{dark:ee,light:ee,hcDark:ee,hcLight:ee},m("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));E("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},m("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const YY=Object.freeze({kind:We.Empty,title:m("codeAction.widget.id.more","More Actions...")}),Y4e=Object.freeze([{kind:We.QuickFix,title:m("codeAction.widget.id.quickfix","Quick Fix")},{kind:We.RefactorExtract,title:m("codeAction.widget.id.extract","Extract"),icon:se.wrench},{kind:We.RefactorInline,title:m("codeAction.widget.id.inline","Inline"),icon:se.wrench},{kind:We.RefactorRewrite,title:m("codeAction.widget.id.convert","Rewrite"),icon:se.wrench},{kind:We.RefactorMove,title:m("codeAction.widget.id.move","Move"),icon:se.wrench},{kind:We.SurroundWith,title:m("codeAction.widget.id.surround","Surround With"),icon:se.symbolSnippet},{kind:We.Source,title:m("codeAction.widget.id.source","Source Action"),icon:se.symbolFile},YY]);function Z4e(n,e,t){if(!e)return n.map(o=>{var r;return{kind:"action",item:o,group:YY,disabled:!!o.action.disabled,label:o.action.disabled||o.action.title,canPreview:!!(!((r=o.action.edit)===null||r===void 0)&&r.edits.length)}});const i=Y4e.map(o=>({group:o,actions:[]}));for(const o of n){const r=o.action.kind?new We(o.action.kind):We.None;for(const a of i)if(a.group.kind.contains(r)){a.actions.push(o);break}}const s=[];for(const o of i)if(o.actions.length){s.push({kind:"header",group:o.group});for(const r of o.actions)s.push({kind:"action",item:r,group:o.group,label:r.action.title,disabled:!!r.action.disabled,keybinding:t(r.action)})}return s}var X4e=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Q4e=function(n,e){return function(t,i){e(t,i,n)}},nM,ip;(function(n){n.Hidden={type:0};class e{constructor(i,s,o,r){this.actions=i,this.trigger=s,this.editorPosition=o,this.widgetPosition=r,this.type=1}}n.Showing=e})(ip||(ip={}));let Wv=nM=class extends Y{constructor(e,t){super(),this._editor=e,this._onClick=this._register(new B),this.onClick=this._onClick.event,this._state=ip.Hidden,this._domNode=we("div.lightBulbWidget"),this._register(Rt.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const s=this._editor.getModel();(this.state.type!==1||!s||this.state.editorPosition.lineNumber>=s.getLineCount())&&this.hide()})),this._register(pme(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:s,height:o}=Nn(this._domNode),r=this._editor.getOption(66);let a=Math.floor(r/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.posx,y:s+o+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(K(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(64)&&!this._editor.getOption(64).enabled&&this.hide()})),this._register(ue.runAndSubscribe(t.onDidUpdateKeybindings,()=>{var i,s,o,r;this._preferredKbLabel=(s=(i=t.lookupKeybinding(W4e))===null||i===void 0?void 0:i.getLabel())!==null&&s!==void 0?s:void 0,this._quickFixKbLabel=(r=(o=t.lookupKeybinding(qY))===null||o===void 0?void 0:o.getLabel())!==null&&r!==void 0?r:void 0,this._updateLightBulbTitleAndIcon()}))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.hide();const s=this._editor.getOptions();if(!s.get(64).enabled)return this.hide();const o=this._editor.getModel();if(!o)return this.hide();const{lineNumber:r,column:a}=o.validatePosition(i),l=o.getOptions().tabSize,c=s.get(50),d=o.getLineContent(r),u=qD(d,l),h=c.spaceWidth*u>22,f=p=>p>2&&this._editor.getTopForLineNumber(p)===this._editor.getTopForLineNumber(p-1);let g=r;if(!h){if(r>1&&!f(r-1))g-=1;else if(!f(r+1))g+=1;else if(a*c.spaceWidth<22)return this.hide()}this.state=new ip.Showing(e,t,i,{position:{lineNumber:g,column:1},preference:nM._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state!==ip.Hidden&&(this.state=ip.Hidden,this._editor.layoutContentWidget(this))}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this.state.type===1&&this.state.actions.hasAutoFix&&(this._domNode.classList.remove(...Ne.asClassNameArray(se.lightBulb)),this._domNode.classList.add(...Ne.asClassNameArray(se.lightbulbAutofix)),this._preferredKbLabel)){this.title=m("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel);return}this._domNode.classList.remove(...Ne.asClassNameArray(se.lightbulbAutofix)),this._domNode.classList.add(...Ne.asClassNameArray(se.lightBulb)),this._quickFixKbLabel?this.title=m("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):this.title=m("codeAction","Show Code Actions")}set title(e){this._domNode.title=e}};Wv.ID="editor.contrib.lightbulbWidget";Wv._posPref=[0];Wv=nM=X4e([Q4e(1,bi)],Wv);var ZY=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},sM=function(n,e){return function(t,i){e(t,i,n)}},J4e=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const XY="acceptSelectedCodeAction",QY="previewSelectedCodeAction";class ePe{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){var s,o;i.text.textContent=(o=(s=e.group)===null||s===void 0?void 0:s.title)!==null&&o!==void 0?o:""}disposeTemplate(e){}}let oM=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const s=new yy(e,vo);return{container:e,icon:t,text:i,keybinding:s}}renderElement(e,t,i){var s,o,r;if(!((s=e.group)===null||s===void 0)&&s.icon?(i.icon.className=Ne.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=re(e.group.icon.color.id))):(i.icon.className=Ne.asClassName(se.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;i.text.textContent=JY(e.label),i.keybinding.set(e.keybinding),Dme(!!e.keybinding,i.keybinding.element);const a=(o=this._keybindingService.lookupKeybinding(XY))===null||o===void 0?void 0:o.getLabel(),l=(r=this._keybindingService.lookupKeybinding(QY))===null||r===void 0?void 0:r.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.disabled?i.container.title=e.label:a&&l?this._supportsPreview&&e.canPreview?i.container.title=m({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to apply, Shift+F2 to preview"']},"{0} to apply, {1} to preview",a,l):i.container.title=m({key:"label",comment:['placeholder is a keybinding, e.g "F2 to apply"']},"{0} to apply",a):i.container.title=""}disposeTemplate(e){}};oM=ZY([sM(1,bi)],oM);class tPe extends UIEvent{constructor(){super("acceptSelectedAction")}}class aW extends UIEvent{constructor(){super("previewSelectedAction")}}function iPe(n){if(n.kind==="action")return n.label}let rM=class extends Y{constructor(e,t,i,s,o,r){super(),this._delegate=s,this._contextViewService=o,this._keybindingService=r,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new xr),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const a={getHeight:l=>l.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:l=>l.kind};this._list=this._register(new ca(e,this.domNode,a,[new oM(t,this._keybindingService),new ePe],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:iPe},accessibilityProvider:{getAriaLabel:l=>{if(l.kind==="action"){let c=l.label?JY(l==null?void 0:l.label):"";return l.disabled&&(c=m({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",c,l.disabled)),c}return null},getWidgetAriaLabel:()=>m({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:l=>l.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(Kf),this._register(this._list.onMouseClick(l=>this.onListClick(l))),this._register(this._list.onMouseOver(l=>this.onListHover(l))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(l=>this.onListSelection(l))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(c=>c.kind==="header").length,s=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight;this._list.layout(s);const o=this._allMenuItems.map((c,d)=>{const u=document.getElementById(this._list.getElementID(d));if(u){u.style.width="auto";const h=u.getBoundingClientRect().width;return u.style.width="",h}return 0}),r=Math.max(...o,e),a=.7,l=Math.min(s,document.body.clientHeight*a);return this._list.layout(l,r),this.domNode.style.height=`${l}px`,this._list.domFocus(),r}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],s=this._list.element(i);if(!this.focusCondition(s))return;const o=e?new aW:new tPe;this._list.setSelection([i],o)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof aW):this._list.setSelection([])}onFocus(){var e,t;this._list.domFocus();const i=this._list.getFocus();if(i.length===0)return;const s=i[0],o=this._list.element(s);(t=(e=this._delegate).onFocus)===null||t===void 0||t.call(e,o.item)}onListHover(e){return J4e(this,void 0,void 0,function*(){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=yield this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])})}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};rM=ZY([sM(4,Eu),sM(5,bi)],rM);function JY(n){return n.replace(/\r\n|\r|\n/g," ")}var nPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},KE=function(n,e){return function(t,i){e(t,i,n)}};E("actionBar.toggledBackground",{dark:Ch,light:Ch,hcDark:Ch,hcLight:Ch},m("actionBar.toggledBackground","Background color for toggled action items in action bar."));const Df={Visible:new _e("codeActionMenuVisible",!1,m("codeActionMenuVisible","Whether the action widget list is visible"))},eg=at("actionWidgetService");let kf=class extends Y{get isVisible(){return Df.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new ta)}show(e,t,i,s,o,r,a){const l=Df.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance(rM,e,t,i,s);this._contextViewService.showContextView({getAnchor:()=>o,render:d=>(l.set(!0),this._renderWidget(d,c,a??[])),onHide:d=>{l.reset(),this._onWidgetClosed(d)}},r,!1)}acceptSelected(e){var t;(t=this._list.value)===null||t===void 0||t.acceptSelected(e)}focusPrevious(){var e,t;(t=(e=this._list)===null||e===void 0?void 0:e.value)===null||t===void 0||t.focusPrevious()}focusNext(){var e,t;(t=(e=this._list)===null||e===void 0?void 0:e.value)===null||t===void 0||t.focusNext()}hide(){var e;(e=this._list.value)===null||e===void 0||e.hide(),this._list.clear()}_renderWidget(e,t,i){var s;const o=document.createElement("div");if(o.classList.add("action-widget"),e.appendChild(o),this._list.value=t,this._list.value)o.appendChild(this._list.value.domNode);else throw new Error("List has no value");const r=new pe,a=document.createElement("div"),l=e.appendChild(a);l.classList.add("context-view-block"),r.add(K(l,de.MOUSE_DOWN,g=>g.stopPropagation()));const c=document.createElement("div"),d=e.appendChild(c);d.classList.add("context-view-pointerBlock"),r.add(K(d,de.POINTER_MOVE,()=>d.remove())),r.add(K(d,de.MOUSE_DOWN,()=>d.remove()));let u=0;if(i.length){const g=this._createActionBar(".action-widget-action-bar",i);g&&(o.appendChild(g.getContainer().parentElement),r.add(g),u=g.getContainer().offsetWidth)}const h=(s=this._list.value)===null||s===void 0?void 0:s.layout(u);o.style.width=`${h}px`;const f=r.add(eu(e));return r.add(f.onDidBlur(()=>this.hide())),r}_createActionBar(e,t){if(!t.length)return;const i=we(e),s=new il(i);return s.push(t,{icon:!1,label:!0}),s}_onWidgetClosed(e){var t;(t=this._list.value)===null||t===void 0||t.hide(e)}};kf=nPe([KE(0,Eu),KE(1,tt),KE(2,vt)],kf);ht(eg,kf,1);const Ay=100+1e3;Bs(class extends e0{constructor(){super({id:"hideCodeActionWidget",title:{value:m("hideCodeActionWidget.title","Hide action widget"),original:"Hide action widget"},precondition:Df.Visible,keybinding:{weight:Ay,primary:9,secondary:[1033]}})}run(n){n.get(eg).hide()}});Bs(class extends e0{constructor(){super({id:"selectPrevCodeAction",title:{value:m("selectPrevCodeAction.title","Select previous action"),original:"Select previous action"},precondition:Df.Visible,keybinding:{weight:Ay,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(n){const e=n.get(eg);e instanceof kf&&e.focusPrevious()}});Bs(class extends e0{constructor(){super({id:"selectNextCodeAction",title:{value:m("selectNextCodeAction.title","Select next action"),original:"Select next action"},precondition:Df.Visible,keybinding:{weight:Ay,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(n){const e=n.get(eg);e instanceof kf&&e.focusNext()}});Bs(class extends e0{constructor(){super({id:XY,title:{value:m("acceptSelected.title","Accept selected action"),original:"Accept selected action"},precondition:Df.Visible,keybinding:{weight:Ay,primary:3,secondary:[2137]}})}run(n){const e=n.get(eg);e instanceof kf&&e.acceptSelected()}});Bs(class extends e0{constructor(){super({id:QY,title:{value:m("previewSelected.title","Preview selected action"),original:"Preview selected action"},precondition:Df.Visible,keybinding:{weight:Ay,primary:2051}})}run(n){const e=n.get(eg);e instanceof kf&&e.acceptSelected(!0)}});var sPe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const oPe=new _e("supportedCodeAction","");class rPe extends Y{constructor(e,t,i,s=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=s,this._autoTriggerTimer=this._register(new Cc),this._register(this._markerService.onMarkerChanged(o=>this._onMarkerChanges(o))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>jP(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:au.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelection();if(i.isEmpty()&&e.type===2){const{lineNumber:s,column:o}=i.getPosition(),r=t.getLineContent(s);if(r.length===0)return;if(o===1){if(/\s/.test(r[0]))return}else if(o===t.getLineMaxColumn(s)){if(/\s/.test(r[r.length-1]))return}else if(/\s/.test(r[o-2])&&/\s/.test(r[o-1]))return}return i}}var fh;(function(n){n.Empty={type:0};class e{constructor(i,s,o){this.trigger=i,this.position=s,this._cancellablePromise=o,this.type=1,this.actions=o.catch(r=>{if(Rf(r))return eZ;throw r})}cancel(){this._cancellablePromise.cancel()}}n.Triggered=e})(fh||(fh={}));const eZ=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1});class aPe extends Y{constructor(e,t,i,s,o,r){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=o,this._configurationService=r,this._codeActionOracle=this._register(new ta),this._state=fh.Empty,this._onDidChangeState=this._register(new B),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=oPe.bindTo(s),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(fh.Empty,!0))}_settingEnabledNearbyQuickfixes(){var e;const t=(e=this._editor)===null||e===void 0?void 0:e.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickfixes",{resource:t==null?void 0:t.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(fh.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(90)){const t=this._registry.all(e).flatMap(i=>{var s;return(s=i.providedCodeActionKinds)!==null&&s!==void 0?s:[]});this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new rPe(this._editor,this._markerService,i=>{var s;if(!i){this.setState(fh.Empty);return}const o=i.selection.getStartPosition(),r=wc(a=>sPe(this,void 0,void 0,function*(){var l,c,d,u,h,f;if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===au.QuickFix||!((c=(l=i.trigger.filter)===null||l===void 0?void 0:l.include)===null||c===void 0)&&c.contains(We.QuickFix))){const g=yield X_(this._registry,e,i.selection,i.trigger,Lp.None,a);if(a.isCancellationRequested)return eZ;if(!((d=g.validActions)===null||d===void 0?void 0:d.some(_=>_.action.kind?We.QuickFix.contains(new We(_.action.kind)):!1))){const _=this._markerService.read({resource:e.uri});if(_.length>0){const v=i.selection.getPosition();let b=v,y=Number.MAX_VALUE,w=!1;for(const C of _){const L=C.endColumn,x=C.endLineNumber,D=C.startLineNumber;(x===v.lineNumber||D===v.lineNumber)&&Math.abs(v.column-L)<y&&(y=Math.abs(v.column-L),w=!0,b=new V(x,L))}if(w){const C={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:!((u=i.trigger.filter)===null||u===void 0)&&u.include?(h=i.trigger.filter)===null||h===void 0?void 0:h.include:We.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:((f=i.trigger.context)===null||f===void 0?void 0:f.notAvailableMessage)||"",position:b}},L=new lt(b.lineNumber,b.column,b.lineNumber,b.column),x=yield X_(this._registry,e,L,C,Lp.None,a),D=[...g.validActions];return x.validActions.length!==0&&(x.validActions.forEach(k=>{k.highlightRange=k.action.isPreferred}),D.push(...x.validActions)),{validActions:D,allActions:g.allActions,documentation:g.documentation,hasAutoFix:g.hasAutoFix,dispose:()=>{g.dispose()}}}}}}return X_(this._registry,e,i.selection,i.trigger,Lp.None,a)}));i.trigger.type===1&&((s=this._progressService)===null||s===void 0||s.showWhile(r,250)),this.setState(new fh.Triggered(i.trigger,o,r))},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:au.Default})}else this._supportedCodeActions.reset()}trigger(e){var t;(t=this._codeActionOracle.value)===null||t===void 0||t.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var lPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},yl=function(n,e){return function(t,i){e(t,i,n)}},U0=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},ZC;const cPe="quickfix-edit-highlight";let Vv=ZC=class extends Y{static get(e){return e.getContribution(ZC.ID)}constructor(e,t,i,s,o,r,a,l,c,d){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=d,this._activeCodeActions=this._register(new ta),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new aPe(this._editor,o.codeActionProvider,t,i,r,l)),this._register(this._model.onDidChangeState(u=>this.update(u))),this._lightBulbWidget=new Mf(()=>{const u=this._editor.getContribution(Wv.ID);return u&&this._register(u.onClick(h=>this.showCodeActionList(h.actions,h,{includeDisabledActions:!1,fromLightbulb:!0}))),u}),this._resolver=s.createInstance(iL),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,s){var o;if(!this._editor.hasModel())return;(o=pr.get(this._editor))===null||o===void 0||o.closeMessage();const r=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:s,context:{notAvailableMessage:e,position:r}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e,t,i){return U0(this,void 0,void 0,function*(){try{yield this._instantiationService.invokeFunction(j4e,e,tL.FromCodeActions,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:au.QuickFix,filter:{}})}})}update(e){var t,i,s,o,r,a,l;return U0(this,void 0,void 0,function*(){if(e.type!==1){(t=this._lightBulbWidget.rawValue)===null||t===void 0||t.hide();return}let c;try{c=yield e.actions}catch(d){mt(d);return}if(!this._disposed)if((i=this._lightBulbWidget.value)===null||i===void 0||i.update(c,e.trigger,e.position),e.trigger.type===1){if(!((s=e.trigger.filter)===null||s===void 0)&&s.include){const u=this.tryGetValidActionToApply(e.trigger,c);if(u){try{(o=this._lightBulbWidget.value)===null||o===void 0||o.hide(),yield this._applyCodeAction(u,!1,!1)}finally{c.dispose()}return}if(e.trigger.context){const h=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,c);if(h&&h.action.disabled){(r=pr.get(this._editor))===null||r===void 0||r.showMessage(h.action.disabled,e.trigger.context.position),c.dispose();return}}}const d=!!(!((a=e.trigger.filter)===null||a===void 0)&&a.include);if(e.trigger.context&&(!c.allActions.length||!d&&!c.validActions.length)){(l=pr.get(this._editor))===null||l===void 0||l.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=c,c.dispose();return}this._activeCodeActions.value=c,this.showCodeActionList(c,this.toCoords(e.position),{includeDisabledActions:d,fromLightbulb:!1})}else this._actionWidgetService.isVisible?c.dispose():this._activeCodeActions.value=c})}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}showCodeActionList(e,t,i){return U0(this,void 0,void 0,function*(){const s=this._editor.createDecorationsCollection(),o=this._editor.getDomNode();if(!o)return;const r=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!r.length)return;const a=V.isIPosition(t)?this.toCoords(t):t,l={onSelect:(c,d)=>U0(this,void 0,void 0,function*(){this._applyCodeAction(c,!0,!!d),this._actionWidgetService.hide(),s.clear()}),onHide:()=>{var c;(c=this._editor)===null||c===void 0||c.focus(),s.clear()},onHover:(c,d)=>U0(this,void 0,void 0,function*(){var u;if(yield c.resolve(d),!d.isCancellationRequested)return{canPreview:!!(!((u=c.action.edit)===null||u===void 0)&&u.edits.length)}}),onFocus:c=>{var d,u;if(c&&c.highlightRange&&c.action.diagnostics){const h=[{range:c.action.diagnostics[0],options:ZC.DECORATION}];s.set(h);const f=c.action.diagnostics[0],g=(u=(d=this._editor.getModel())===null||d===void 0?void 0:d.getWordAtPosition({lineNumber:f.startLineNumber,column:f.startColumn}))===null||u===void 0?void 0:u.word;Qb(m("editingNewSelection","Context: {0} at line {1} and column {2}.",g,f.startLineNumber,f.startColumn))}else s.clear()}};this._actionWidgetService.show("codeActionWidget",!0,Z4e(r,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,o,this._getActionBarActions(e,t,i))})}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=Nn(this._editor.getDomNode()),s=i.left+t.left,o=i.top+t.top+t.height;return{x:s,y:o}}_shouldShowHeaders(){var e;const t=(e=this._editor)===null||e===void 0?void 0:e.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:t==null?void 0:t.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const s=e.documentation.map(o=>{var r;return{id:o.id,label:o.title,tooltip:(r=o.tooltip)!==null&&r!==void 0?r:"",class:void 0,enabled:!0,run:()=>{var a;return this._commandService.executeCommand(o.id,...(a=o.arguments)!==null&&a!==void 0?a:[])}}});return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&s.push(this._showDisabled?{id:"hideMoreActions",label:m("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:m("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),s}};Vv.ID="editor.contrib.codeActionController";Vv.DECORATION=et.register({description:"quickfix-highlight",className:cPe});Vv=ZC=lPe([yl(1,dl),yl(2,tt),yl(3,vt),yl(4,nt),yl(5,gy),yl(6,fs),yl(7,ti),yl(8,eg),yl(9,vt)],Vv);Dr((n,e)=>{((s,o)=>{o&&e.addRule(`.monaco-editor ${s} { background-color: ${o}; }`)})(".quickfix-edit-highlight",n.getColor(Wa));const i=n.getColor(cd);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${sc(n.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});var tZ=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},nL=function(n,e){return function(t,i){e(t,i,n)}};class lW{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let aM=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new B,this.onDidChange=this._onDidChange.event,this._dispoables=new pe,this._markers=[],this._nextIdx=-1,je.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const s=this._configService.getValue("problems.sortOrder"),o=(a,l)=>{let c=Ob(a.resource.toString(),l.resource.toString());return c===0&&(s==="position"?c=N.compareRangesUsingStarts(a,l)||Jt.compare(a.severity,l.severity):c=Jt.compare(a.severity,l.severity)||N.compareRangesUsingStarts(a,l)),c},r=()=>{this._markers=this._markerService.read({resource:je.isUri(e)?e:void 0,severities:Jt.Error|Jt.Warning|Jt.Info}),typeof e=="function"&&(this._markers=this._markers.filter(a=>this._resourceFilter(a.resource))),this._markers.sort(o)};r(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&(r(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new lW(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let s=!1,o=this._markers.findIndex(r=>r.resource.toString()===e.uri.toString());o<0&&(o=hU(this._markers,{resource:e.uri},(r,a)=>Ob(r.resource.toString(),a.resource.toString())),o<0&&(o=~o));for(let r=o;r<this._markers.length;r++){let a=N.lift(this._markers[r]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new N(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=r,s=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}s||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const s=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),s!==this._nextIdx}find(e,t){let i=this._markers.findIndex(s=>s.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(N.containsPosition(this._markers[i],t))return new lW(this._markers[i],i+1,this._markers.length)}}};aM=tZ([nL(1,dl),nL(2,ti)],aM);const iZ=at("IMarkerNavigationService");let lM=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new Ds}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new aM(e,this._markerService,this._configService)}};lM=tZ([nL(0,dl),nL(1,ti)],lM);ht(iZ,lM,1);var cM;(function(n){function e(t){switch(t){case mi.Ignore:return"severity-ignore "+Ne.asClassName(se.info);case mi.Info:return Ne.asClassName(se.info);case mi.Warning:return Ne.asClassName(se.warning);case mi.Error:return Ne.asClassName(se.error);default:return""}}n.className=e})(cM||(cM={}));var dPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Cg=function(n,e){return function(t,i){e(t,i,n)}},dM;class uPe{constructor(e,t,i,s,o){this._openerService=s,this._labelService=o,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new pe,this._editor=t;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(Hi(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new xq(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{r.style.left=`-${a.scrollLeft}px`,r.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){Ft(this._disposables)}update(e){const{source:t,message:i,relatedInformation:s,code:o}=e;let r=((t==null?void 0:t.length)||0)+2;o&&(typeof o=="string"?r+=o.length:r+=o.value.length);const a=Pf(i);this._lines=a.length,this._longestLineLength=0;for(const h of a)this._longestLineLength=Math.max(h.length+r,this._longestLineLength);Lo(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const h of a)l=document.createElement("div"),l.innerText=h,h===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||o){const h=document.createElement("span");if(h.classList.add("details"),l.appendChild(h),t){const f=document.createElement("span");f.innerText=t,f.classList.add("source"),h.appendChild(f)}if(o)if(typeof o=="string"){const f=document.createElement("span");f.innerText=`(${o})`,f.classList.add("code"),h.appendChild(f)}else{this._codeLink=we("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=g=>{this._openerService.open(o.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()};const f=le(this._codeLink,we("span"));f.innerText=o.value,h.appendChild(this._codeLink)}}if(Lo(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),tc(s)){const h=this._relatedBlock.appendChild(document.createElement("div"));h.style.paddingTop=`${Math.floor(this._editor.getOption(66)*.66)}px`,this._lines+=1;for(const f of s){const g=document.createElement("div"),p=document.createElement("a");p.classList.add("filename"),p.innerText=`${this._labelService.getUriBasenameLabel(f.resource)}(${f.startLineNumber}, ${f.startColumn}): `,p.title=this._labelService.getUriLabel(f.resource),this._relatedDiagnostics.set(p,f);const _=document.createElement("span");_.innerText=f.message,g.appendChild(p),g.appendChild(_),this._lines+=1,h.appendChild(g)}}const c=this._editor.getOption(50),d=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),u=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:u})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case Jt.Error:t=m("Error","Error");break;case Jt.Warning:t=m("Warning","Warning");break;case Jt.Info:t=m("Info","Info");break;case Jt.Hint:t=m("Hint","Hint");break}let i=m("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const s=this._editor.getModel();return s&&e.startLineNumber<=s.getLineCount()&&e.startLineNumber>=1&&(i=`${s.getLineContent(e.startLineNumber)}, ${i}`),i}}let zm=dM=class extends Zx{constructor(e,t,i,s,o,r,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},o),this._themeService=t,this._openerService=i,this._menuService=s,this._contextKeyService=r,this._labelService=a,this._callOnDispose=new pe,this._onDidSelectRelatedInformation=new B,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=Jt.Warning,this._backgroundColor=z.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(pPe);let t=uM,i=hPe;this._severity===Jt.Warning?(t=XC,i=fPe):this._severity===Jt.Info&&(t=hM,i=gPe);const s=e.getColor(t),o=e.getColor(i);this.style({arrowColor:s,frameColor:s,headerBackgroundColor:o,primaryHeadingColor:e.getColor(AY),secondaryHeadingColor:e.getColor(IY)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(s=>this.editor.focus()));const t=[],i=this._menuService.createMenu(dM.TitleMenu,this._contextKeyService);tK(i,void 0,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0}),i.dispose()}_fillTitleIcon(e){this._icon=le(e,we(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new uPe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const s=N.lift(e),o=this.editor.getPosition(),r=o&&s.containsPosition(o)?o:s.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?m("problems","{0} of {1} problems",t,i):m("change","{0} of {1} problem",t,i);this.setTitle(na(a.uri),l)}this._icon.className=`codicon ${cM.className(Jt.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};zm.TitleMenu=new I("gotoErrorTitleMenu");zm=dM=dPe([Cg(1,ao),Cg(2,Sc),Cg(3,Su),Cg(4,vt),Cg(5,tt),Cg(6,QD)],zm);const cW=iv(Fa,ave),dW=iv(wo,ev),uW=iv(ks,tv),uM=E("editorMarkerNavigationError.background",{dark:cW,light:cW,hcDark:Je,hcLight:Je},m("editorMarkerNavigationError","Editor marker navigation widget error color.")),hPe=E("editorMarkerNavigationError.headerBackground",{dark:Ce(uM,.1),light:Ce(uM,.1),hcDark:null,hcLight:null},m("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),XC=E("editorMarkerNavigationWarning.background",{dark:dW,light:dW,hcDark:Je,hcLight:Je},m("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),fPe=E("editorMarkerNavigationWarning.headerBackground",{dark:Ce(XC,.1),light:Ce(XC,.1),hcDark:"#0C141F",hcLight:Ce(XC,.2)},m("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),hM=E("editorMarkerNavigationInfo.background",{dark:uW,light:uW,hcDark:Je,hcLight:Je},m("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),gPe=E("editorMarkerNavigationInfo.headerBackground",{dark:Ce(hM,.1),light:Ce(hM,.1),hcDark:null,hcLight:null},m("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),pPe=E("editorMarkerNavigation.background",{dark:Gi,light:Gi,hcDark:Gi,hcLight:Gi},m("editorMarkerNavigationBackground","Editor marker navigation widget background."));var mPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},cC=function(n,e){return function(t,i){e(t,i,n)}},nZ=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},__;let lu=__=class{static get(e){return e.getContribution(__.ID)}constructor(e,t,i,s,o){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=s,this._instantiationService=o,this._sessionDispoables=new pe,this._editor=e,this._widgetVisible=sZ.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(zm,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{var s,o,r;(!(!((s=this._model)===null||s===void 0)&&s.selected)||!N.containsPosition((o=this._model)===null||o===void 0?void 0:o.selected.marker,i.position))&&((r=this._model)===null||r===void 0||r.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:N.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new V(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(e,t){var i,s;return nZ(this,void 0,void 0,function*(){if(this._editor.hasModel()){const o=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(o.move(e,this._editor.getModel(),this._editor.getPosition()),!o.selected)return;if(o.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const r=yield this._editorService.openCodeEditor({resource:o.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:o.selected.marker}},this._editor);r&&((i=__.get(r))===null||i===void 0||i.close(),(s=__.get(r))===null||s===void 0||s.nagivate(e,t))}else this._widget.showAtMarker(o.selected.marker,o.selected.index,o.selected.total)}})}};lu.ID="editor.contrib.markerController";lu=__=mPe([cC(1,iZ),cC(2,tt),cC(3,Ut),cC(4,vt)],lu);class Tk extends Xt{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return nZ(this,void 0,void 0,function*(){t.hasModel()&&((i=lu.get(t))===null||i===void 0||i.nagivate(this._next,this._multiFile))})}}class Pd extends Tk{constructor(){super(!0,!1,{id:Pd.ID,label:Pd.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:578,weight:100},menuOpts:{menuId:zm.TitleMenu,title:Pd.LABEL,icon:Yi("marker-navigation-next",se.arrowDown,m("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}Pd.ID="editor.action.marker.next";Pd.LABEL=m("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class ef extends Tk{constructor(){super(!1,!1,{id:ef.ID,label:ef.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:1602,weight:100},menuOpts:{menuId:zm.TitleMenu,title:ef.LABEL,icon:Yi("marker-navigation-previous",se.arrowUp,m("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}ef.ID="editor.action.marker.prev";ef.LABEL=m("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class _Pe extends Tk{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:m("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:66,weight:100},menuOpts:{menuId:I.MenubarGoMenu,title:m({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class bPe extends Tk{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:m("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:H.focus,primary:1090,weight:100},menuOpts:{menuId:I.MenubarGoMenu,title:m({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}Lr(lu.ID,lu,4);Xe(Pd);Xe(ef);Xe(_Pe);Xe(bPe);const sZ=new _e("markersNavigationVisible",!1),vPe=Cr.bindToContribution(lu.get);Ae(new vPe({id:"closeMarkersNavigation",precondition:sZ,handler:n=>n.close(),kbOpts:{weight:100+50,kbExpr:H.focus,primary:9,secondary:[1033]}}));var yPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},YE=function(n,e){return function(t,i){e(t,i,n)}};const er=we;class wPe{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const hW={type:1,filter:{include:We.QuickFix},triggerAction:au.QuickFixHover};let fM=class{constructor(e,t,i,s){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=s,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),s=e.range.startLineNumber,o=i.getLineMaxColumn(s),r=[];for(const a of t){const l=a.range.startLineNumber===s?a.range.startColumn:1,c=a.range.endLineNumber===s?a.range.endColumn:o,d=this._markerDecorationsService.getMarker(i.uri,a);if(!d)continue;const u=new N(e.range.startLineNumber,l,e.range.startLineNumber,c);r.push(new wPe(this,u,d))}return r}renderHoverParts(e,t){if(!t.length)return Y.None;const i=new pe;t.forEach(o=>e.fragment.appendChild(this.renderMarkerHover(o,i)));const s=t.length===1?t[0]:t.sort((o,r)=>Jt.compare(o.marker.severity,r.marker.severity))[0];return this.renderMarkerStatusbar(e,s,i),i}renderMarkerHover(e,t){const i=er("div.hover-row"),s=le(i,er("div.marker.hover-contents")),{source:o,message:r,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(s);const c=le(s,er("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=r,o||a)if(a&&typeof a!="string"){const d=er("span");if(o){const g=le(d,er("span"));g.innerText=o}const u=le(d,er("a.code-link"));u.setAttribute("href",a.target.toString()),t.add(K(u,"click",g=>{this._openerService.open(a.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()}));const h=le(u,er("span"));h.innerText=a.value;const f=le(s,d);f.style.opacity="0.6",f.style.paddingLeft="6px"}else{const d=le(s,er("span"));d.style.opacity="0.6",d.style.paddingLeft="6px",d.innerText=o&&a?`${o}(${a})`:o||`(${a})`}if(tc(l))for(const{message:d,resource:u,startLineNumber:h,startColumn:f}of l){const g=le(s,er("div"));g.style.marginTop="8px";const p=le(g,er("a"));p.innerText=`${na(u)}(${h}, ${f}): `,p.style.cursor="pointer",t.add(K(p,"click",v=>{v.stopPropagation(),v.preventDefault(),this._openerService&&this._openerService.open(u,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:h,startColumn:f}}}).catch(mt)}));const _=le(g,er("span"));_.innerText=d,this._editor.applyFontInfo(_)}return i}renderMarkerStatusbar(e,t,i){if((t.marker.severity===Jt.Error||t.marker.severity===Jt.Warning||t.marker.severity===Jt.Info)&&e.statusBar.addAction({label:m("view problem","View Problem"),commandId:Pd.ID,run:()=>{var s;e.hide(),(s=lu.get(this._editor))===null||s===void 0||s.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(90)){const s=e.statusBar.append(er("div"));this.recentMarkerCodeActionsInfo&&(Nx.makeKey(this.recentMarkerCodeActionsInfo.marker)===Nx.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(s.textContent=m("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const o=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?Y.None:i.add(US(()=>s.textContent=m("checkingForQuickFixes","Checking for quick fixes..."),200));s.textContent||(s.textContent=String.fromCharCode(160));const r=this.getCodeActions(t.marker);i.add(Ze(()=>r.cancel())),r.then(a=>{if(o.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),s.textContent=m("noQuickFixes","No quick fixes available");return}s.style.display="none";let l=!1;i.add(Ze(()=>{l||a.dispose()})),e.statusBar.addAction({label:m("quick fixes","Quick Fix..."),commandId:qY,run:c=>{l=!0;const d=Vv.get(this._editor),u=Nn(c);e.hide(),d==null||d.showCodeActions(hW,a,{x:u.left,y:u.top,width:u.width,height:u.height})}})},mt)}}getCodeActions(e){return wc(t=>X_(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new N(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),hW,Lp.None,t))}};fM=yPe([YE(1,DP),YE(2,Sc),YE(3,nt)],fM);const CPe="editor.action.inlineSuggest.showPrevious",SPe="editor.action.inlineSuggest.showNext";var xPe=function(n,e,t,i){function s(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function a(d){try{c(i.next(d))}catch(u){r(u)}}function l(d){try{c(i.throw(d))}catch(u){r(u)}}function c(d){d.done?o(d.value):s(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class LPe extends Y{constructor(e,t,i={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new fge),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new pe),this.options=i,this.lookupKeybindings=typeof this.options.getKeyBinding=="function",this.toggleMenuAction=this._register(new zv(()=>{var s;return(s=this.toggleMenuActionViewItem)===null||s===void 0?void 0:s.show()},i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new il(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,actionViewItemProvider:(s,o)=>{var r;if(s.id===zv.ID)return this.toggleMenuActionViewItem=new Dx(s,s.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:Ne.asClassNameArray((r=i.moreIcon)!==null&&r!==void 0?r:se.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const a=i.actionViewItemProvider(s,o);if(a)return a}if(s instanceof pD){const a=new Dx(s,s.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:s.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry});return a.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(a),this.disposables.add(this._onDidChangeDropdownVisibility.add(a.onDidChangeVisibility)),a}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(s=>{this.actionBar.push(s,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(s)})})}getKeybindingLabel(e){var t,i,s;const o=this.lookupKeybindings?(i=(t=this.options).getKeyBinding)===null||i===void 0?void 0:i.call(t,e):void 0;return(s=o==null?void 0:o.getLabel())!==null&&s!==void 0?s:void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class zv extends xo{constructor(e,t){t=t||m("moreActions","More Actions..."),super(zv.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}run(){return xPe(this,void 0,void 0,function*(){this.toggleDropdownMenu()})}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}}zv.ID="toolbar.toggle.more";var DPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},j0=function(n,e){return function(t,i){e(t,i,n)}};let gM=class extends LPe{constructor(e,t,i,s,o,r,a){super(e,o,Object.assign(Object.assign({getKeyBinding:c=>{var d;return(d=r.lookupKeybinding(c.id))!==null&&d!==void 0?d:void 0}},t),{allowContextMenu:!0,skipTelemetry:typeof(t==null?void 0:t.telemetrySource)=="string"})),this._options=t,this._menuService=i,this._contextKeyService=s,this._contextMenuService=o,this._sessionDisposables=this._store.add(new pe);const l=t==null?void 0:t.telemetrySource;l&&this._store.add(this.actionBar.onDidRun(c=>a.publicLog2("workbenchActionExecuted",{id:c.action.id,from:l})))}setActions(e,t=[],i){var s,o,r;this._sessionDisposables.clear();const a=e.slice(),l=t.slice(),c=[];let d=0;const u=[];let h=!1;if(((s=this._options)===null||s===void 0?void 0:s.hiddenItemStrategy)!==-1)for(let f=0;f<a.length;f++){const g=a[f];!(g instanceof Xa)&&!(g instanceof HS)||g.hideActions&&(c.push(g.hideActions.toggle),g.hideActions.toggle.checked&&d++,g.hideActions.isHidden&&(h=!0,a[f]=void 0,((o=this._options)===null||o===void 0?void 0:o.hiddenItemStrategy)!==0&&(u[f]=g)))}if(((r=this._options)===null||r===void 0?void 0:r.overflowBehavior)!==void 0){const f=Hke(new Set(this._options.overflowBehavior.exempted),dt.map(a,_=>_==null?void 0:_.id)),g=this._options.overflowBehavior.maxItems-f.size;let p=0;for(let _=0;_<a.length;_++){const v=a[_];v&&(p++,!f.has(v.id)&&p>=g&&(a[_]=void 0,u[_]=v))}}GF(a),GF(u),super.setActions(a,Mn.join(u,l)),c.length>0&&this._sessionDisposables.add(K(this.getElement(),"contextmenu",f=>{var g,p,_,v,b;const y=new ar(f),w=this.getItemAction(y.target);if(!w)return;y.preventDefault(),y.stopPropagation();let C=!1;if(d===1&&((g=this._options)===null||g===void 0?void 0:g.hiddenItemStrategy)===0){C=!0;for(let D=0;D<c.length;D++)if(c[D].checked){c[D]=E_({id:w.id,label:w.label,checked:!0,enabled:!1,run(){}});break}}let L;if(!C&&(w instanceof Xa||w instanceof HS)){if(!w.hideActions)return;L=w.hideActions.hide}else L=E_({id:"label",label:m("hide","Hide"),enabled:!1,run(){}});const x=Mn.join([L],c);!((p=this._options)===null||p===void 0)&&p.resetMenu&&!i&&(i=[this._options.resetMenu]),h&&i&&(x.push(new Mn),x.push(E_({id:"resetThisMenu",label:m("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),this._contextMenuService.showContextMenu({getAnchor:()=>y,getActions:()=>x,menuId:(_=this._options)===null||_===void 0?void 0:_.contextMenu,menuActionOptions:Object.assign({renderShortTitle:!0},(v=this._options)===null||v===void 0?void 0:v.menuOptions),skipTelemetry:typeof((b=this._options)===null||b===void 0?void 0:b.telemetrySource)=="string",contextKeyService:this._contextKeyService})}))}};gM=DPe([j0(2,Su),j0(3,tt),j0(4,Au),j0(5,bi),j0(6,vc)],gM);var d5=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},Kr=function(n,e){return function(t,i){e(t,i,n)}},QC;let fW=class extends Y{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=As(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).showToolbar==="always"),this.sessionPosition=void 0,this.position=_t(this,s=>{var o,r,a;const l=(o=this.model.read(s))===null||o===void 0?void 0:o.ghostText.read(s);if(!this.alwaysShowToolbar.read(s)||!l||l.parts.length===0)return this.sessionPosition=void 0,null;const c=l.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==l.lineNumber&&(this.sessionPosition=void 0);const d=new V(l.lineNumber,Math.min(c,(a=(r=this.sessionPosition)===null||r===void 0?void 0:r.column)!==null&&a!==void 0?a:Number.MAX_SAFE_INTEGER));return this.sessionPosition=d,d}),this._register($s((s,o)=>{const r=this.model.read(s);if(!r||!this.alwaysShowToolbar.read(s))return;const a=o.add(this.instantiationService.createInstance(Hm,this.editor,!0,this.position,r.selectedInlineCompletionIndex,r.inlineCompletionsCount,r.selectedInlineCompletion.map(l=>{var c;return(c=l==null?void 0:l.inlineCompletion.source.inlineCompletions.commands)!==null&&c!==void 0?c:[]})));e.addContentWidget(a),o.add(Ze(()=>e.removeContentWidget(a))),o.add(li(l=>{this.position.read(l)&&r.lastTriggerKind.read(l)!==EI.Explicit&&r.triggerExplicitly()}))}))}};fW=d5([Kr(2,vt)],fW);const kPe=Yi("inline-suggestion-hints-next",se.chevronRight,m("parameterHintsNextIcon","Icon for show next parameter hint.")),EPe=Yi("inline-suggestion-hints-previous",se.chevronLeft,m("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let Hm=QC=class extends Y{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const s=new xo(e,t,i,!0,()=>this._commandService.executeCommand(e)),o=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let r=t;return o&&(r=m({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,o.getLabel())),s.tooltip=r,s}constructor(e,t,i,s,o,r,a,l,c,d,u){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=s,this._suggestionCount=o,this._extraCommands=r,this._commandService=a,this.keybindingService=c,this._contextKeyService=d,this._menuService=u,this.id=`InlineSuggestionHintsContentWidget${QC.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=dn("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[dn("div@toolBar")]),this.previousAction=this.createCommandAction(CPe,m("previous","Previous"),Ne.asClassName(EPe)),this.availableSuggestionCountAction=new xo("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(SPe,m("next","Next"),Ne.asClassName(kPe)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(I.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new Li(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new Li(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.lastCommands=[],this.toolBar=this._register(l.createInstance(pM,this.nodes.toolBar,I.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:h=>h.startsWith("primary")},actionViewItemProvider:(h,f)=>{if(h instanceof Xa)return l.createInstance(IPe,h,void 0);if(h===this.availableSuggestionCountAction){const g=new APe(void 0,h,{label:!0,icon:!1});return g.setClass("availableSuggestionCount"),g}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(h=>{QC._dropDownVisible=h})),this._register(li(h=>{this._position.read(h),this.editor.layoutContentWidget(this)})),this._register(li(h=>{const f=this._suggestionCount.read(h),g=this._currentSuggestionIdx.read(h);f!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${g+1}/${f}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),f!==void 0&&f>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(li(h=>{const f=this._extraCommands.read(h);if(Ki(this.lastCommands,f))return;this.lastCommands=f;const g=f.map(p=>({class:void 0,id:p.id,enabled:!0,tooltip:p.tooltip||"",label:p.title,run:_=>this._commandService.executeCommand(p.id)}));for(const[p,_]of this.inlineCompletionsActionsMenus.getActions())for(const v of _)v instanceof Xa&&g.push(v);g.length>0&&g.unshift(new Mn),this.toolBar.setAdditionalSecondaryActions(g)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};Hm._dropDownVisible=!1;Hm.id=0;Hm=QC=d5([Kr(6,fs),Kr(7,vt),Kr(8,bi),Kr(9,tt),Kr(10,Su)],Hm);class APe extends tk{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}}class IPe extends Mm{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=dn("div.keybinding").root;new yy(t,vo,Object.assign({disableTitle:!0},rEe)).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}}let pM=class extends gM{constructor(e,t,i,s,o,r,a,l){super(e,Object.assign({resetMenu:t},i),s,o,r,a,l),this.menuId=t,this.options2=i,this.menuService=s,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){var e,t,i,s,o,r,a;const l=[],c=[];tK(this.menu,(e=this.options2)===null||e===void 0?void 0:e.menuOptions,{primary:l,secondary:c},(i=(t=this.options2)===null||t===void 0?void 0:t.toolbarOptions)===null||i===void 0?void 0:i.primaryGroup,(o=(s=this.options2)===null||s===void 0?void 0:s.toolbarOptions)===null||o===void 0?void 0:o.shouldInlineSubmenu,(a=(r=this.options2)===null||r===void 0?void 0:r.toolbarOptions)===null||a===void 0?void 0:a.useSeparatorsInPrimaryActions),c.push(...this.additionalActions),l.unshift(...this.prependedPrimaryActions),this.setActions(l,c)}setPrependedPrimaryActions(e){Ki(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){Ki(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};pM=d5([Kr(3,Su),Kr(4,tt),Kr(5,Au),Kr(6,bi),Kr(7,vc)],pM);var TPe=function(n,e,t,i){var s=arguments.length,o=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(o=(s<3?r(o):s>3?r(e,t,o):r(e,t))||o);return s>3&&o&&Object.defineProperty(e,t,o),o},dC=function(n,e){return function(t,i){e(t,i,n)}},mM;const NPe=!1;let io=mM=class extends Y{static get(e){return e.getContribution(mM.ID)}constructor(e,t,i,s,o){super(),this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=s,this._keybindingService=o,this._toUnhook=new pe,this._hoverActivatedByColorDecoratorClick=!1,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._reactToEditorMouseMoveRunner=this._register(new Li(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookEvents(),this._register(this._editor.onDidChangeConfiguration(r=>{r.hasChanged(60)&&(this._unhookEvents(),this._hookEvents())})),this._register(this._editor.onMouseLeave(()=>{this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}))}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(60);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._hidingDelay=t.hidingDelay,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown(i=>this._onEditorMouseDown(i))),this._toUnhook.add(this._editor.onMouseUp(i=>this._onEditorMouseUp(i))),this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))):(this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))),this._toUnhook.add(this._editor.onMouseLeave(i=>this._onEditorMouseLeave(i))),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange(i=>this._onEditorScrollChanged(i)))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){var t;this._isMouseDown=!0;const i=e.target;if(i.type===9&&i.detail===Md.ID){this._hoverClicked=!0;return}i.type===12&&i.detail===Np.ID||(i.type!==12&&(this._hoverClicked=!1),!((t=this._contentWidget)===null||t===void 0)&&t.widget.isResizing||this._hideWidgets())}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseLeave(e){var t,i;const s=e.event.browserEvent.relatedTarget;!((t=this._contentWidget)===null||t===void 0)&&t.widget.isResizing||!((i=this._contentWidget)===null||i===void 0)&&i.containsNode(s)||this._hideWidgets()}_isMouseOverWidget(e){var t,i,s,o,r;const a=e.target;return!!(this._isHoverSticky&&a.type===9&&a.detail===Md.ID||this._isHoverSticky&&(!((t=this._contentWidget)===null||t===void 0)&&t.containsNode((i=e.event.browserEvent.view)===null||i===void 0?void 0:i.document.activeElement))&&!(!((o=(s=e.event.browserEvent.view)===null||s===void 0?void 0:s.getSelection())===null||o===void 0)&&o.isCollapsed)||!this._isHoverSticky&&a.type===9&&a.detail===Md.ID&&(!((r=this._contentWidget)===null||r===void 0)&&r.isColorPickerVisible)||this._isHoverSticky&&a.type===12&&a.detail===Np.ID)}_onEditorMouseMove(e){var t,i,s,o;if(this._mouseMoveEvent=e,!((t=this._contentWidget)===null||t===void 0)&&t.isFocused||!((i=this._contentWidget)===null||i===void 0)&&i.isResizing||this._isMouseDown&&this._hoverClicked||this._isHoverSticky&&(!((s=this._contentWidget)===null||s===void 0)&&s.isVisibleFromKeyboard))return;if(this._isMouseOverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}if(!((o=this._contentWidget)===null||o===void 0)&&o.isVisible&&this._isHoverSticky&&this._hidingDelay>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(this._hidingDelay);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){var t,i,s;if(!e)return;const o=e.target,r=(t=o.element)===null||t===void 0?void 0:t.classList.contains("colorpicker-color-decoration"),a=this._editor.getOption(146);if(r&&(a==="click"&&!this._hoverActivatedByColorDecoratorClick||a==="hover"&&!this._isHoverEnabled&&!NPe||a==="clickAndHover"&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)||!r&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick){this._hideWidgets();return}if(this._getOrCreateContentWidget().maybeShowAt(e)){(i=this._glyphWidget)===null||i===void 0||i.hide();return}if(o.type===2&&o.position){(s=this._contentWidget)===null||s===void 0||s.hide(),this._glyphWidget||(this._glyphWidget=new Np(this._editor,this._languageService,this._openerService)),this._glyphWidget.startShowingAt(o.position.lineNumber);return}this._hideWidgets()}_onKeyDown(e){var t;if(!this._editor.hasModel())return;const i=this._keybindingService.softDispatch(e,this._editor.getDomNode()),s=i.kind===1||i.kind===2&&i.commandId==="editor.action.showHover"&&((t=this._contentWidget)===null||t===void 0?void 0:t.isVisible);e.keyCode!==5&&e.keyCode!==6&&e.keyCode!==57&&e.keyCode!==4&&!s&&this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(!((e=this._contentWidget)===null||e===void 0)&&e.isColorPickerVisible)||Hm.dropDownVisible||(this._hoverActivatedByColorDecoratorClick=!1,this._hoverClicked=!1,(t=this._glyphWidget)===null||t===void 0||t.hide(),(i=this._contentWidget)===null||i===void 0||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(Qx,this._editor)),this._contentWidget}showContentHover(e,t,i,s,o=!1){this._hoverActivatedByColorDecoratorClick=o,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,s)}focus(){var e;(e=this._contentWidget)===null||e===void 0||e.focus()}scrollUp(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollUp()}scrollDown(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollDown()}scrollLeft(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollLeft()}scrollRight(){var e;(e=this._contentWidget)===null||e===void 0||e.scrollRight()}pageUp(){var e;(e=this._contentWidget)===null||e===void 0||e.pageUp()}pageDown(){var e;(e=this._contentWidget)===null||e===void 0||e.pageDown()}goToTop(){var e;(e=this._contentWidget)===null||e===void 0||e.goToTop()}goToBottom(){var e;(e=this._contentWidget)===null||e===void 0||e.goToBottom()}get isColorPickerVisible(){var e;return(e=this._contentWidget)===null||e===void 0?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return(e=this._contentWidget)===null||e===void 0?void 0:e.isVisible}dispose(){var e,t;super.dispose(),this._unhookEvents(),this._toUnhook.dispose(),(e=this._glyphWidget)===null||e===void 0||e.dispose(),(t=this._contentWidget)===null||t===void 0||t.dispose()}};io.ID="editor.contrib.hover";io=mM=TPe([dC(1,vt),dC(2,Sc),dC(3,Ai),dC(4,bi)],io);class RPe extends Xt{constructor(){super({id:"editor.action.showHover",label:m({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse.","If the hover is already visible, it will take focus."]},"Show or Focus Hover"),description:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if when triggered with the keyboard, the hover should take focus immediately.",type:"boolean",default:!1}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:H.editorTextFocus,primary:Fn(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const s=io.get(t);if(!s)return;const o=t.getPosition(),r=new N(o.lineNumber,o.column,o.lineNumber,o.column),a=t.getOption(2)===2||!!(i!=null&&i.focus);s.isHoverVisible?s.focus():s.showContentHover(r,1,1,a)}}class MPe extends Xt{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:m({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=io.get(t);if(!i)return;const s=t.getPosition();if(!s)return;const o=new N(s.lineNumber,s.column,s.lineNumber,s.column),r=Lf.get(t);if(!r)return;r.startFindDefinitionFromCursor(s).then(()=>{i.showContentHover(o,1,1,!0)})}}class PPe extends Xt{constructor(){super({id:"editor.action.scrollUpHover",label:m({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:16,weight:100}})}run(e,t){const i=io.get(t);i&&i.scrollUp()}}class OPe extends Xt{constructor(){super({id:"editor.action.scrollDownHover",label:m({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:18,weight:100}})}run(e,t){const i=io.get(t);i&&i.scrollDown()}}class FPe extends Xt{constructor(){super({id:"editor.action.scrollLeftHover",label:m({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:15,weight:100}})}run(e,t){const i=io.get(t);i&&i.scrollLeft()}}class BPe extends Xt{constructor(){super({id:"editor.action.scrollRightHover",label:m({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:17,weight:100}})}run(e,t){const i=io.get(t);i&&i.scrollRight()}}class WPe extends Xt{constructor(){super({id:"editor.action.pageUpHover",label:m({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:11,secondary:[528],weight:100}})}run(e,t){const i=io.get(t);i&&i.pageUp()}}class VPe extends Xt{constructor(){super({id:"editor.action.pageDownHover",label:m({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:12,secondary:[530],weight:100}})}run(e,t){const i=io.get(t);i&&i.pageDown()}}class zPe extends Xt{constructor(){super({id:"editor.action.goToTopHover",label:m({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(e,t){const i=io.get(t);i&&i.goToTop()}}class HPe extends Xt{constructor(){super({id:"editor.action.goToBottomHover",label:m({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:H.hoverFocused,kbOpts:{kbExpr:H.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(e,t){const i=io.get(t);i&&i.goToBottom()}}Lr(io.ID,io,2);Xe(RPe);Xe(MPe);Xe(PPe);Xe(OPe);Xe(FPe);Xe(BPe);Xe(WPe);Xe(VPe);Xe(zPe);Xe(HPe);l5.register(tM);l5.register(fM);Dr((n,e)=>{const t=n.getColor(Cve);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});function $Pe(n){return new Worker(""+new URL("json.worker-TYfeENH3.js",import.meta.url).href,{name:n==null?void 0:n.name})}self.MonacoEnvironment={getWorker(n,e){if(e==="json")return new $Pe;throw new Error("Unsupported language: "+e)}};class UPe extends np{constructor(){super();Ui(this,"_editor");Ui(this,"_initialValue")}set value(t){this._editor?this._editor.setValue(t):this._initialValue=t}get value(){var t;return((t=this._editor)==null?void 0:t.getValue())??this._initialValue}createRenderRoot(){return this}disconnectedCallback(){var t,i,s;(t=this._editor)==null||t.dispose(),(s=(i=this._editor)==null?void 0:i.getModel())==null||s.dispose()}render(){return Vi}firstUpdated(){this._editor=oY.create(this,{value:this._initialValue,language:"json",minimap:{enabled:!1},fontFamily:"'Source Code Pro', monospace",fontSize:12}),this._editor.getModel().onDidChangeContent(()=>{this.dispatchEvent(new CustomEvent("change",{detail:{}}))}),new ResizeObserver(i=>{this._editor.layout()}).observe(this)}}customElements.define("code-editor",UPe);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*jPe(n,e){if(n!==void 0){let t=0;for(const i of n)yield e(i,t++)}}var Ol;class oZ extends np{constructor(){super();ve(this,Ol,void 0);Ui(this,"files");this.missingFiles=new Set}createRenderRoot(){return this}render(){return At`
            <ul class="tabs">
                ${Object.keys(this.files).map(t=>At`
                            <li
                                data-name=${t}
                                class=${t==J(this,Ol)?"selected":""}
                            >
                                <a
                                    href="#"
                                    @click=${i=>this._changeTab(i)}
                                    >${t}</a
                                >
                            </li>
                        `)}
                <li class=${J(this,Ol)===void 0?"selected":""}>
                    <a
                        href="#"
                        @click=${t=>this._changeTab(t)}
                        >Add new files</a
                    >
                </li>
                <li style="flex-grow: 1"></li>
            </ul>

            <div class="tab-pages">
                ${Object.keys(this.files).map(t=>At`
                        <div
                            class=${t==J(this,Ol)?"selected":""}
                        >
                            ${GPe(this.files[t].data)}
                        </div>
                    `)}

                <div class=${J(this,Ol)===void 0?"selected":""}>
                    ${this.missingFiles.size?At`<div class="missing-files">
                              <p>Please add the following files:</p>
                              <ul>
                                  ${jPe(this.missingFiles,t=>At`<li>${t}</li>`)}
                              </ul>
                          </div>`:Vi}
                    ${qPe(t=>this._handleFiles(t))}
                </div>
            </div>
        `}async _handleFiles(t){const s=t.target.files;for(const o of s){const r=await KPe(o),a=HM(r,{type:YPe(r,o.name),parse:"auto"});this.files[o.name]={metadata:o,data:a},gt(this,Ol,o.name)}this.requestUpdate(),this.dispatchEvent(new CustomEvent("upload",{detail:{}}))}_changeTab(t){const s=t.target.parentElement.dataset.name;gt(this,Ol,s),t.preventDefault(),this.requestUpdate()}}Ol=new WeakMap,Ui(oZ,"properties",{missingFiles:{type:Set,attribute:!1}});customElements.define("file-pane",oZ);function qPe(n){return At` <form class="upload-form">
        <input
            type="file"
            multiple
            accept=".csv,.tsv,.txt,.json"
            id="fileInput"
            @change=${n}
            style="display:none"
        />
        <div id="upload-button-wrapper">
            <button
                class="btn"
                @click=${e=>{document.getElementById("fileInput").click(),e.preventDefault(),e.stopPropagation()}}
            >
                Choose files
            </button>
        </div>

        <p>
            The added file becomes a named datasource, which can be accessed as
            follows:
        </p>

        <pre>
"data": {
    "name": "filename.csv"
}
</pre
        >

        <p>
            N.B. All data processing takes place in your web browser. Nothing is
            uploaded anywhere.
        </p>
    </form>`}function GPe(n){const e=Object.keys(n[0]),t=n.slice(0,30),i=e.map(a=>"text-align: "+(typeof n[0][a]=="number"?"right":"left")),s=a=>At`
        <tr>
            ${e.map((l,c)=>At`<td style=${i[c]}>${a[l]}</td> `)}
        </tr>
    `,o=()=>At`
        <tr>
            ${e.map((a,l)=>At`<td style=${i[l]}>...</td> `)}
        </tr>
    `;return At`
        <table class="data-sample-table">
            <thead>
                ${(()=>At`
        <tr>
            ${e.map((a,l)=>At`<th style=${i[l]}>${a}</th> `)}
        </tr>
    `)()}
            </thead>
            <tbody>
                ${t.map(s)}
                ${t.length<n.length?o():""}
            </tbody>
        </table>
    `}function KPe(n){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>e(i.result),i.onerror=t,i.readAsText(n)})}function YPe(n,e){return/\.json$/.test(e)?"json":n.indexOf("	")>=0?"tsv":"csv"}function rZ(n){if(typeof n=="object"&&n!==null){n.description&&(n.markdownDescription=n.description);for(const e in n)n.hasOwnProperty(e)&&(n[e]=rZ(n[e]))}return n}QPe();const aZ="playgroundSpec",lZ=EW(),u5=EW(),cZ={};let h5=new Set,ZE,gW="";const JC=["stacked","parallel","full"];let _M=JC[0],eS,dZ="";async function ZPe(){const e=new URLSearchParams(window.location.search).get("spec");if(e){const s=await fetch(e);return eS=e.match(/.*\//)[0],s.text()}const t=window.localStorage.getItem(aZ);return(t==null?void 0:t.length)>0?t:Whe}function XPe(){_M=JC[(JC.indexOf(_M)+1)%JC.length],f5(),window.dispatchEvent(new Event("resize"))}function QPe(){rZ(EB),rY.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"https://unpkg.com/@genome-spy/core/dist/schema.json",fileMatch:["*"],schema:EB}]})}function JPe(n){let e=cZ[n];return e||h5.add(n),e==null?void 0:e.data}async function uZ(n=!1){var t,i;h5=new Set,eS&&window.location.search&&window.history.replaceState(null,"",window.location.pathname);const e=(t=u5.value)==null?void 0:t.value;e&&window.localStorage.setItem(aZ,e);try{const s=JSON.parse(e),o=JSON.stringify(s);if(o===gW&&!n)return;gW=o,ZE&&ZE.finalize(),eS&&!s.baseUrl&&(s.baseUrl=eS),dZ=(i=Ks(s.description))==null?void 0:i[0],ZE=await Ohe(lZ.value,s,{namedDataProvider:JPe,powerPreference:"high-performance"}),f5()}catch(s){console.log(s)}}const e3e=()=>At`
    <div class="toolbar">
        <a
            href="https://genomespy.app/"
            target="_blank"
            class="genome-spy-icon"
        >
            <img title="GenomeSpy" alt="GenomeSpy" src="${Phe}" />
        </a>
        <span class="title">
            <span>GenomeSpy Playground</span>
        </span>
        <button @click=${XPe} class="tool-button hide-mobile">
            ${nO(yQ).node[0]}
            <span>Toggle layout</span>
        </button>
        <span class="vis-title">
            <span class="hide-mobile">${dZ}</span>
        </span>
        <a
            class="version tool-button"
            href="https://github.com/genome-spy/genome-spy/releases/tag/v${AB.version}"
            >v${AB.version}</a
        >
        <a
            href="https://genomespy.app/docs/"
            target="_blank"
            class="tool-button hide-mobile"
            >${nO(CQ).node[0]} <span>Docs</span></a
        >
    </div>
`,t3e=Ib(()=>uZ(),500,!1),i3e=()=>At`
    <section id="playground-layout" class="${_M}">
        ${e3e()}
        <section id="editor-pane">
            <code-editor
                ${T5(u5)}
                @change=${t3e}
            ></code-editor>
        </section>
        <section id="genome-spy-pane">
            <div ${T5(lZ)}></div>
        </section>
        <section id="file-pane">
            <file-pane
                @upload=${uZ}
                .files=${cZ}
                .missingFiles=${h5}
            ></file-pane>
        </section>
    </section>
`;function f5(){Qp(i3e(),document.body)}f5();ZPe().then(n=>{u5.value.value=n});export{pNe as m};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-Bk-LtoET.js","./_commonjsHelpers-DM6icglO.js","./index-BBh4oK1e.js","./__vite-browser-external-D80GqXp3.js","./long-BSQIMyNf.js","./index-DjJdr7nk.js","./remoteFile-C-wzVgAr.js","./index-CyR2IQoV.js","./index-COZiUjmP.js","./index-BHxDtRx7.js","./index-Cef--9Aq.js","./index-BydEQ8c3.js","./index-Bm-vzmU9.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}