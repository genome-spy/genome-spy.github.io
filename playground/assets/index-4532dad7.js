var hre=Object.defineProperty;var ure=(n,e,t)=>e in n?hre(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var dr=(n,e,t)=>(ure(n,typeof e!="symbol"?e+"":e,t),t),u2=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var Ze=(n,e,t)=>(u2(n,e,"read from private field"),t?t.call(n):e.get(n)),Vt=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Co=(n,e,t,i)=>(u2(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),jB=(n,e,t,i)=>({set _(r){Co(n,e,r,t)},get _(){return Ze(n,e,i)}}),_t=(n,e,t)=>(u2(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hS=window,cP=hS.ShadowRoot&&(hS.ShadyCSS===void 0||hS.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,vU=Symbol(),qB=new WeakMap;let dre=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==vU)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(cP&&e===void 0){const i=t!==void 0&&t.length===1;i&&(e=qB.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&qB.set(t,e))}return e}toString(){return this.cssText}};const fre=n=>new dre(typeof n=="string"?n:n+"",void 0,vU),gre=(n,e)=>{cP?n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet):e.forEach(t=>{const i=document.createElement("style"),r=hS.litNonce;r!==void 0&&i.setAttribute("nonce",r),i.textContent=t.cssText,n.appendChild(i)})},GB=cP?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return fre(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var d2;const dx=window,KB=dx.trustedTypes,pre=KB?KB.emptyScript:"",ZB=dx.reactiveElementPolyfillSupport,ZA={toAttribute(n,e){switch(e){case Boolean:n=n?pre:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},wU=(n,e)=>e!==n&&(e==e||n==n),f2={attribute:!0,type:String,converter:ZA,reflect:!1,hasChanged:wU};let Rp=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;(t=this.h)!==null&&t!==void 0||(this.h=[]),this.h.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach((t,i)=>{const r=this._$Ep(i,t);r!==void 0&&(this._$Ev.set(r,i),e.push(r))}),e}static createProperty(e,t=f2){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const i=typeof e=="symbol"?Symbol():"__"+e,r=this.getPropertyDescriptor(e,i,t);r!==void 0&&Object.defineProperty(this.prototype,e,r)}}static getPropertyDescriptor(e,t,i){return{get(){return this[t]},set(r){const s=this[e];this[t]=r,this.requestUpdate(e,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||f2}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,i=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const r of i)this.createProperty(r,t[r])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const r of i)t.unshift(GB(r))}else e!==void 0&&t.push(GB(e));return t}static _$Ep(e,t){const i=t.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(e=this.constructor.h)===null||e===void 0||e.forEach(t=>t(this))}addController(e){var t,i;((t=this._$ES)!==null&&t!==void 0?t:this._$ES=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&((i=e.hostConnected)===null||i===void 0||i.call(e))}removeController(e){var t;(t=this._$ES)===null||t===void 0||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])})}createRenderRoot(){var e;const t=(e=this.shadowRoot)!==null&&e!==void 0?e:this.attachShadow(this.constructor.shadowRootOptions);return gre(t,this.constructor.elementStyles),t}connectedCallback(){var e;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)===null||e===void 0||e.forEach(t=>{var i;return(i=t.hostConnected)===null||i===void 0?void 0:i.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)===null||e===void 0||e.forEach(t=>{var i;return(i=t.hostDisconnected)===null||i===void 0?void 0:i.call(t)})}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EO(e,t,i=f2){var r;const s=this.constructor._$Ep(e,i);if(s!==void 0&&i.reflect===!0){const o=(((r=i.converter)===null||r===void 0?void 0:r.toAttribute)!==void 0?i.converter:ZA).toAttribute(t,i.type);this._$El=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$El=null}}_$AK(e,t){var i;const r=this.constructor,s=r._$Ev.get(e);if(s!==void 0&&this._$El!==s){const o=r.getPropertyOptions(s),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((i=o.converter)===null||i===void 0?void 0:i.fromAttribute)!==void 0?o.converter:ZA;this._$El=s,this[s]=a.fromAttribute(t,o.type),this._$El=null}}requestUpdate(e,t,i){let r=!0;e!==void 0&&(((i=i||this.constructor.getPropertyOptions(e)).hasChanged||wU)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),i.reflect===!0&&this._$El!==e&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(e,i))):r=!1),!this.isUpdatePending&&r&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((r,s)=>this[s]=r),this._$Ei=void 0);let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),(e=this._$ES)===null||e===void 0||e.forEach(r=>{var s;return(s=r.hostUpdate)===null||s===void 0?void 0:s.call(r)}),this.update(i)):this._$Ek()}catch(r){throw t=!1,this._$Ek(),r}t&&this._$AE(i)}willUpdate(e){}_$AE(e){var t;(t=this._$ES)===null||t===void 0||t.forEach(i=>{var r;return(r=i.hostUpdated)===null||r===void 0?void 0:r.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){this._$EC!==void 0&&(this._$EC.forEach((t,i)=>this._$EO(i,this[i],t)),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};Rp.finalized=!0,Rp.elementProperties=new Map,Rp.elementStyles=[],Rp.shadowRootOptions={mode:"open"},ZB==null||ZB({ReactiveElement:Rp}),((d2=dx.reactiveElementVersions)!==null&&d2!==void 0?d2:dx.reactiveElementVersions=[]).push("1.4.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var g2;const fx=window,Km=fx.trustedTypes,YB=Km?Km.createPolicy("lit-html",{createHTML:n=>n}):void 0,Jh=`lit$${(Math.random()+"").slice(9)}$`,yU="?"+Jh,mre=`<${yU}>`,Zm=document,Iv=(n="")=>Zm.createComment(n),Tv=n=>n===null||typeof n!="object"&&typeof n!="function",CU=Array.isArray,_re=n=>CU(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",F0=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,XB=/-->/g,QB=/>/g,wd=RegExp(`>|[ 	
\f\r](?:([^\\s"'>=/]+)([ 	
\f\r]*=[ 	
\f\r]*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),JB=/'/g,e6=/"/g,SU=/^(?:script|style|textarea|title)$/i,bre=n=>(e,...t)=>({_$litType$:n,strings:e,values:t}),on=bre(1),Ym=Symbol.for("lit-noChange"),ln=Symbol.for("lit-nothing"),t6=new WeakMap,am=Zm.createTreeWalker(Zm,129,null,!1),vre=(n,e)=>{const t=n.length-1,i=[];let r,s=e===2?"<svg>":"",o=F0;for(let l=0;l<t;l++){const c=n[l];let h,u,d=-1,f=0;for(;f<c.length&&(o.lastIndex=f,u=o.exec(c),u!==null);)f=o.lastIndex,o===F0?u[1]==="!--"?o=XB:u[1]!==void 0?o=QB:u[2]!==void 0?(SU.test(u[2])&&(r=RegExp("</"+u[2],"g")),o=wd):u[3]!==void 0&&(o=wd):o===wd?u[0]===">"?(o=r??F0,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,h=u[1],o=u[3]===void 0?wd:u[3]==='"'?e6:JB):o===e6||o===JB?o=wd:o===XB||o===QB?o=F0:(o=wd,r=void 0);const g=o===wd&&n[l+1].startsWith("/>")?" ":"";s+=o===F0?c+mre:d>=0?(i.push(h),c.slice(0,d)+"$lit$"+c.slice(d)+Jh+g):c+Jh+(d===-2?(i.push(void 0),l):g)}const a=s+(n[t]||"<?>")+(e===2?"</svg>":"");if(!Array.isArray(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return[YB!==void 0?YB.createHTML(a):a,i]};let YA=class xU{constructor({strings:e,_$litType$:t},i){let r;this.parts=[];let s=0,o=0;const a=e.length-1,l=this.parts,[c,h]=vre(e,t);if(this.el=xU.createElement(c,i),am.currentNode=this.el.content,t===2){const u=this.el.content,d=u.firstChild;d.remove(),u.append(...d.childNodes)}for(;(r=am.nextNode())!==null&&l.length<a;){if(r.nodeType===1){if(r.hasAttributes()){const u=[];for(const d of r.getAttributeNames())if(d.endsWith("$lit$")||d.startsWith(Jh)){const f=h[o++];if(u.push(d),f!==void 0){const g=r.getAttribute(f.toLowerCase()+"$lit$").split(Jh),p=/([.?@])?(.*)/.exec(f);l.push({type:1,index:s,name:p[2],strings:g,ctor:p[1]==="."?yre:p[1]==="?"?Sre:p[1]==="@"?xre:jD})}else l.push({type:6,index:s})}for(const d of u)r.removeAttribute(d)}if(SU.test(r.tagName)){const u=r.textContent.split(Jh),d=u.length-1;if(d>0){r.textContent=Km?Km.emptyScript:"";for(let f=0;f<d;f++)r.append(u[f],Iv()),am.nextNode(),l.push({type:2,index:++s});r.append(u[d],Iv())}}}else if(r.nodeType===8)if(r.data===yU)l.push({type:2,index:s});else{let u=-1;for(;(u=r.data.indexOf(Jh,u+1))!==-1;)l.push({type:7,index:s}),u+=Jh.length-1}s++}}static createElement(e,t){const i=Zm.createElement("template");return i.innerHTML=e,i}};function Xm(n,e,t=n,i){var r,s,o,a;if(e===Ym)return e;let l=i!==void 0?(r=t._$Co)===null||r===void 0?void 0:r[i]:t._$Cl;const c=Tv(e)?void 0:e._$litDirective$;return(l==null?void 0:l.constructor)!==c&&((s=l==null?void 0:l._$AO)===null||s===void 0||s.call(l,!1),c===void 0?l=void 0:(l=new c(n),l._$AT(n,t,i)),i!==void 0?((o=(a=t)._$Co)!==null&&o!==void 0?o:a._$Co=[])[i]=l:t._$Cl=l),l!==void 0&&(e=Xm(n,l._$AS(n,e.values),l,i)),e}class wre{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:i},parts:r}=this._$AD,s=((t=e==null?void 0:e.creationScope)!==null&&t!==void 0?t:Zm).importNode(i,!0);am.currentNode=s;let o=am.nextNode(),a=0,l=0,c=r[0];for(;c!==void 0;){if(a===c.index){let h;c.type===2?h=new D1(o,o.nextSibling,this,e):c.type===1?h=new c.ctor(o,c.name,c.strings,this,e):c.type===6&&(h=new Ere(o,this,e)),this.u.push(h),c=r[++l]}a!==(c==null?void 0:c.index)&&(o=am.nextNode(),a++)}return s}p(e){let t=0;for(const i of this.u)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class D1{constructor(e,t,i,r){var s;this.type=2,this._$AH=ln,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=r,this._$Cm=(s=r==null?void 0:r.isConnected)===null||s===void 0||s}get _$AU(){var e,t;return(t=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&t!==void 0?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&e.nodeType===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Xm(this,e,t),Tv(e)?e===ln||e==null||e===""?(this._$AH!==ln&&this._$AR(),this._$AH=ln):e!==this._$AH&&e!==Ym&&this.g(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):_re(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==ln&&Tv(this._$AH)?this._$AA.nextSibling.data=e:this.T(Zm.createTextNode(e)),this._$AH=e}$(e){var t;const{values:i,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=YA.createElement(r.h,this.options)),r);if(((t=this._$AH)===null||t===void 0?void 0:t._$AD)===s)this._$AH.p(i);else{const o=new wre(s,this),a=o.v(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(e){let t=t6.get(e.strings);return t===void 0&&t6.set(e.strings,t=new YA(e)),t}k(e){CU(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,r=0;for(const s of e)r===t.length?t.push(i=new D1(this.O(Iv()),this.O(Iv()),this,this.options)):i=t[r],i._$AI(s),r++;r<t.length&&(this._$AR(i&&i._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){var i;for((i=this._$AP)===null||i===void 0||i.call(this,!1,!0,t);e&&e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){var t;this._$AM===void 0&&(this._$Cm=e,(t=this._$AP)===null||t===void 0||t.call(this,e))}}class jD{constructor(e,t,i,r,s){this.type=1,this._$AH=ln,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=ln}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,i,r){const s=this.strings;let o=!1;if(s===void 0)e=Xm(this,e,t,0),o=!Tv(e)||e!==this._$AH&&e!==Ym,o&&(this._$AH=e);else{const a=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=Xm(this,a[i+l],t,l),c===Ym&&(c=this._$AH[l]),o||(o=!Tv(c)||c!==this._$AH[l]),c===ln?e=ln:e!==ln&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!r&&this.j(e)}j(e){e===ln?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class yre extends jD{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ln?void 0:e}}const Cre=Km?Km.emptyScript:"";class Sre extends jD{constructor(){super(...arguments),this.type=4}j(e){e&&e!==ln?this.element.setAttribute(this.name,Cre):this.element.removeAttribute(this.name)}}class xre extends jD{constructor(e,t,i,r,s){super(e,t,i,r,s),this.type=5}_$AI(e,t=this){var i;if((e=(i=Xm(this,e,t,0))!==null&&i!==void 0?i:ln)===Ym)return;const r=this._$AH,s=e===ln&&r!==ln||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,o=e!==ln&&(r===ln||s);s&&this.element.removeEventListener(this.name,this,r),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,i;typeof this._$AH=="function"?this._$AH.call((i=(t=this.options)===null||t===void 0?void 0:t.host)!==null&&i!==void 0?i:this.element,e):this._$AH.handleEvent(e)}}class Ere{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Xm(this,e)}}const i6=fx.litHtmlPolyfillSupport;i6==null||i6(YA,D1),((g2=fx.litHtmlVersions)!==null&&g2!==void 0?g2:fx.litHtmlVersions=[]).push("2.4.0");const gx=(n,e,t)=>{var i,r;const s=(i=t==null?void 0:t.renderBefore)!==null&&i!==void 0?i:e;let o=s._$litPart$;if(o===void 0){const a=(r=t==null?void 0:t.renderBefore)!==null&&r!==void 0?r:null;s._$litPart$=o=new D1(e.insertBefore(Iv(),a),a,void 0,t??{})}return o._$AI(n),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var p2,m2;let lm=class extends Rp{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var e,t;const i=super.createRenderRoot();return(e=(t=this.renderOptions).renderBefore)!==null&&e!==void 0||(t.renderBefore=i.firstChild),i}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Dt=gx(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Dt)===null||e===void 0||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Dt)===null||e===void 0||e.setConnected(!1)}render(){return Ym}};lm.finalized=!0,lm._$litElement$=!0,(p2=globalThis.litElementHydrateSupport)===null||p2===void 0||p2.call(globalThis,{LitElement:lm});const n6=globalThis.litElementPolyfillSupport;n6==null||n6({LitElement:lm});((m2=globalThis.litElementVersions)!==null&&m2!==void 0?m2:globalThis.litElementVersions=[]).push("3.2.0");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Dre=n=>n.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const kre={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Lre=n=>(...e)=>({_$litDirective$:n,values:e});let Ire=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,i){this._$Ct=e,this._$AM=t,this._$Ci=i}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Nb=(n,e)=>{var t,i;const r=n._$AN;if(r===void 0)return!1;for(const s of r)(i=(t=s)._$AO)===null||i===void 0||i.call(t,e,!1),Nb(s,e);return!0},px=n=>{let e,t;do{if((e=n._$AM)===void 0)break;t=e._$AN,t.delete(n),n=e}while((t==null?void 0:t.size)===0)},EU=n=>{for(let e;e=n._$AM;n=e){let t=e._$AN;if(t===void 0)e._$AN=t=new Set;else if(t.has(n))break;t.add(n),Nre(e)}};function Tre(n){this._$AN!==void 0?(px(this),this._$AM=n,EU(this)):this._$AM=n}function Are(n,e=!1,t=0){const i=this._$AH,r=this._$AN;if(r!==void 0&&r.size!==0)if(e)if(Array.isArray(i))for(let s=t;s<i.length;s++)Nb(i[s],!1),px(i[s]);else i!=null&&(Nb(i,!1),px(i));else Nb(this,n)}const Nre=n=>{var e,t,i,r;n.type==kre.CHILD&&((e=(i=n)._$AP)!==null&&e!==void 0||(i._$AP=Are),(t=(r=n)._$AQ)!==null&&t!==void 0||(r._$AQ=Tre))};let Rre=class extends Ire{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),EU(this),this.isConnected=e._$AU}_$AO(e,t=!0){var i,r;e!==this.isConnected&&(this.isConnected=e,e?(i=this.reconnected)===null||i===void 0||i.call(this):(r=this.disconnected)===null||r===void 0||r.call(this)),t&&(Nb(this,e),px(this))}setValue(e){if(Dre(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const DU=()=>new Mre;let Mre=class{};const _2=new WeakMap,r6=Lre(class extends Rre{render(n){return ln}update(n,[e]){var t;const i=e!==this.Y;return i&&this.Y!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.Y=e,this.dt=(t=n.options)===null||t===void 0?void 0:t.host,this.rt(this.ct=n.element)),ln}rt(n){var e;if(typeof this.Y=="function"){const t=(e=this.dt)!==null&&e!==void 0?e:globalThis;let i=_2.get(t);i===void 0&&(i=new WeakMap,_2.set(t,i)),i.get(this.Y)!==void 0&&this.Y.call(this.dt,void 0),i.set(this.Y,n),n!==void 0&&this.Y.call(this.dt,n)}else this.Y.value=n}get lt(){var n,e,t;return typeof this.Y=="function"?(e=_2.get((n=this.dt)!==null&&n!==void 0?n:globalThis))===null||e===void 0?void 0:e.get(this.Y):(t=this.Y)===null||t===void 0?void 0:t.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */function s6(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function We(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?s6(Object(t),!0).forEach(function(i){Pre(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s6(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function mx(n){return mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mx(n)}function Fre(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function o6(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function Ore(n,e,t){return e&&o6(n.prototype,e),t&&o6(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Pre(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hP(n,e){return Vre(n)||$re(n,e)||kU(n,e)||Hre()}function qD(n){return Bre(n)||Wre(n)||kU(n)||zre()}function Bre(n){if(Array.isArray(n))return XA(n)}function Vre(n){if(Array.isArray(n))return n}function Wre(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function $re(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],r=!0,s=!1,o,a;try{for(t=t.call(n);!(r=(o=t.next()).done)&&(i.push(o.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,a=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw a}}return i}}function kU(n,e){if(n){if(typeof n=="string")return XA(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return XA(n,e)}}function XA(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function zre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a6=function(){},uP={},LU={},IU=null,TU={mark:a6,measure:a6};try{typeof window<"u"&&(uP=window),typeof document<"u"&&(LU=document),typeof MutationObserver<"u"&&(IU=MutationObserver),typeof performance<"u"&&(TU=performance)}catch{}var Ure=uP.navigator||{},l6=Ure.userAgent,c6=l6===void 0?"":l6,Nu=uP,qi=LU,h6=IU,By=TU;Nu.document;var Dh=!!qi.documentElement&&!!qi.head&&typeof qi.addEventListener=="function"&&typeof qi.createElement=="function",AU=~c6.indexOf("MSIE")||~c6.indexOf("Trident/"),_h="___FONT_AWESOME___",QA=16,NU="fa",RU="svg-inline--fa",Bf="data-fa-i2svg",JA="data-fa-pseudo-element",jre="data-fa-pseudo-element-pending",dP="data-prefix",fP="data-icon",u6="fontawesome-i2svg",qre="async",Gre=["HTML","HEAD","STYLE","SCRIPT"],MU=function(){try{return!0}catch{return!1}}(),gP={fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit",fa:"solid"},_x={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"},FU={fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},Kre={"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},Zre=/fa[srltdbk\-\ ]/,OU="fa-layers-text",Yre=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Kit)?.*/i,Xre={900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},PU=[1,2,3,4,5,6,7,8,9,10],Qre=PU.concat([11,12,13,14,15,16,17,18,19,20]),Jre=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Zd={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ese=[].concat(qD(Object.keys(_x)),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Zd.GROUP,Zd.SWAP_OPACITY,Zd.PRIMARY,Zd.SECONDARY]).concat(PU.map(function(n){return"".concat(n,"x")})).concat(Qre.map(function(n){return"w-".concat(n)})),BU=Nu.FontAwesomeConfig||{};function tse(n){var e=qi.querySelector("script["+n+"]");if(e)return e.getAttribute(n)}function ise(n){return n===""?!0:n==="false"?!1:n==="true"?!0:n}if(qi&&typeof qi.querySelector=="function"){var nse=[["data-family-prefix","familyPrefix"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];nse.forEach(function(n){var e=hP(n,2),t=e[0],i=e[1],r=ise(tse(t));r!=null&&(BU[i]=r)})}var rse={familyPrefix:NU,styleDefault:"solid",replacementClass:RU,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},Rb=We(We({},rse),BU);Rb.autoReplaceSvg||(Rb.observeMutations=!1);var nt={};Object.keys(Rb).forEach(function(n){Object.defineProperty(nt,n,{enumerable:!0,set:function(t){Rb[n]=t,uS.forEach(function(i){return i(nt)})},get:function(){return Rb[n]}})});Nu.FontAwesomeConfig=nt;var uS=[];function sse(n){return uS.push(n),function(){uS.splice(uS.indexOf(n),1)}}var Rh=QA,Bl={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function ose(n){if(!(!n||!Dh)){var e=qi.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=n;for(var t=qi.head.childNodes,i=null,r=t.length-1;r>-1;r--){var s=t[r],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=s)}return qi.head.insertBefore(e,i),n}}var ase="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Av(){for(var n=12,e="";n-- >0;)e+=ase[Math.random()*62|0];return e}function Z_(n){for(var e=[],t=(n||[]).length>>>0;t--;)e[t]=n[t];return e}function pP(n){return n.classList?Z_(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(e){return e})}function VU(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function lse(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(VU(n[t]),'" ')},"").trim()}function GD(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(n[t].trim(),";")},"")}function mP(n){return n.size!==Bl.size||n.x!==Bl.x||n.y!==Bl.y||n.rotate!==Bl.rotate||n.flipX||n.flipY}function cse(n){var e=n.transform,t=n.containerWidth,i=n.iconWidth,r={transform:"translate(".concat(t/2," 256)")},s="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(s," ").concat(o," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:r,inner:l,path:c}}function hse(n){var e=n.transform,t=n.width,i=t===void 0?QA:t,r=n.height,s=r===void 0?QA:r,o=n.startCentered,a=o===void 0?!1:o,l="";return a&&AU?l+="translate(".concat(e.x/Rh-i/2,"em, ").concat(e.y/Rh-s/2,"em) "):a?l+="translate(calc(-50% + ".concat(e.x/Rh,"em), calc(-50% + ").concat(e.y/Rh,"em)) "):l+="translate(".concat(e.x/Rh,"em, ").concat(e.y/Rh,"em) "),l+="scale(".concat(e.size/Rh*(e.flipX?-1:1),", ").concat(e.size/Rh*(e.flipY?-1:1),") "),l+="rotate(".concat(e.rotate,"deg) "),l}var use=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function WU(){var n=NU,e=RU,t=nt.familyPrefix,i=nt.replacementClass,r=use;if(t!==n||i!==e){var s=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(i))}return r}var d6=!1;function b2(){nt.autoAddCss&&!d6&&(ose(WU()),d6=!0)}var dse={mixout:function(){return{dom:{css:WU,insertCss:b2}}},hooks:function(){return{beforeDOMElementCreation:function(){b2()},beforeI2svg:function(){b2()}}}},bh=Nu||{};bh[_h]||(bh[_h]={});bh[_h].styles||(bh[_h].styles={});bh[_h].hooks||(bh[_h].hooks={});bh[_h].shims||(bh[_h].shims=[]);var ka=bh[_h],$U=[],fse=function n(){qi.removeEventListener("DOMContentLoaded",n),bx=1,$U.map(function(e){return e()})},bx=!1;Dh&&(bx=(qi.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(qi.readyState),bx||qi.addEventListener("DOMContentLoaded",fse));function gse(n){Dh&&(bx?setTimeout(n,0):$U.push(n))}function k1(n){var e=n.tag,t=n.attributes,i=t===void 0?{}:t,r=n.children,s=r===void 0?[]:r;return typeof n=="string"?VU(n):"<".concat(e," ").concat(lse(i),">").concat(s.map(k1).join(""),"</").concat(e,">")}function f6(n,e,t){if(n&&n[e]&&n[e][t])return{prefix:e,iconName:t,icon:n[e][t]}}var pse=function(e,t){return function(i,r,s,o){return e.call(t,i,r,s,o)}},v2=function(e,t,i,r){var s=Object.keys(e),o=s.length,a=r!==void 0?pse(t,r):t,l,c,h;for(i===void 0?(l=1,h=e[s[0]]):(l=0,h=i);l<o;l++)c=s[l],h=a(h,e[c],c,e);return h};function mse(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e}function eN(n){var e=mse(n);return e.length===1?e[0].toString(16):null}function _se(n,e){var t=n.length,i=n.charCodeAt(e),r;return i>=55296&&i<=56319&&t>e+1&&(r=n.charCodeAt(e+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function g6(n){return Object.keys(n).reduce(function(e,t){var i=n[t],r=!!i.icon;return r?e[i.iconName]=i.icon:e[t]=i,e},{})}function tN(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.skipHooks,r=i===void 0?!1:i,s=g6(e);typeof ka.hooks.addPack=="function"&&!r?ka.hooks.addPack(n,g6(e)):ka.styles[n]=We(We({},ka.styles[n]||{}),s),n==="fas"&&tN("fa",e)}var Mb=ka.styles,bse=ka.shims,vse=Object.values(FU),_P=null,zU={},HU={},UU={},jU={},qU={},wse=Object.keys(gP);function yse(n){return~ese.indexOf(n)}function Cse(n,e){var t=e.split("-"),i=t[0],r=t.slice(1).join("-");return i===n&&r!==""&&!yse(r)?r:null}var GU=function(){var e=function(s){return v2(Mb,function(o,a,l){return o[l]=v2(a,s,{}),o},{})};zU=e(function(r,s,o){if(s[3]&&(r[s[3]]=o),s[2]){var a=s[2].filter(function(l){return typeof l=="number"});a.forEach(function(l){r[l.toString(16)]=o})}return r}),HU=e(function(r,s,o){if(r[o]=o,s[2]){var a=s[2].filter(function(l){return typeof l=="string"});a.forEach(function(l){r[l]=o})}return r}),qU=e(function(r,s,o){var a=s[2];return r[o]=o,a.forEach(function(l){r[l]=o}),r});var t="far"in Mb||nt.autoFetchSvg,i=v2(bse,function(r,s){var o=s[0],a=s[1],l=s[2];return a==="far"&&!t&&(a="fas"),typeof o=="string"&&(r.names[o]={prefix:a,iconName:l}),typeof o=="number"&&(r.unicodes[o.toString(16)]={prefix:a,iconName:l}),r},{names:{},unicodes:{}});UU=i.names,jU=i.unicodes,_P=KD(nt.styleDefault)};sse(function(n){_P=KD(n.styleDefault)});GU();function bP(n,e){return(zU[n]||{})[e]}function Sse(n,e){return(HU[n]||{})[e]}function zp(n,e){return(qU[n]||{})[e]}function KU(n){return UU[n]||{prefix:null,iconName:null}}function xse(n){var e=jU[n],t=bP("fas",n);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}function Ru(){return _P}var vP=function(){return{prefix:null,iconName:null,rest:[]}};function KD(n){var e=gP[n],t=_x[n]||_x[e],i=n in ka.styles?n:null;return t||i||null}function ZD(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.skipLookups,i=t===void 0?!1:t,r=null,s=n.reduce(function(o,a){var l=Cse(nt.familyPrefix,a);if(Mb[a]?(a=vse.includes(a)?Kre[a]:a,r=a,o.prefix=a):wse.indexOf(a)>-1?(r=a,o.prefix=KD(a)):l?o.iconName=l:a!==nt.replacementClass&&o.rest.push(a),!i&&o.prefix&&o.iconName){var c=r==="fa"?KU(o.iconName):{},h=zp(o.prefix,o.iconName);c.prefix&&(r=null),o.iconName=c.iconName||h||o.iconName,o.prefix=c.prefix||o.prefix,o.prefix==="far"&&!Mb.far&&Mb.fas&&!nt.autoFetchSvg&&(o.prefix="fas")}return o},vP());return(s.prefix==="fa"||r==="fa")&&(s.prefix=Ru()||"fas"),s}var Ese=function(){function n(){Fre(this,n),this.definitions={}}return Ore(n,[{key:"add",value:function(){for(var t=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];var o=r.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=We(We({},t.definitions[a]||{}),o[a]),tN(a,o[a]);var l=FU[a];l&&tN(l,o[a]),GU()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,i){var r=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(r).map(function(s){var o=r[s],a=o.prefix,l=o.iconName,c=o.icon,h=c[2];t[a]||(t[a]={}),h.length>0&&h.forEach(function(u){typeof u=="string"&&(t[a][u]=c)}),t[a][l]=c}),t}}]),n}(),p6=[],Hp={},cm={},Dse=Object.keys(cm);function kse(n,e){var t=e.mixoutsTo;return p6=n,Hp={},Object.keys(cm).forEach(function(i){Dse.indexOf(i)===-1&&delete cm[i]}),p6.forEach(function(i){var r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(function(o){typeof r[o]=="function"&&(t[o]=r[o]),mx(r[o])==="object"&&Object.keys(r[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=r[o][a]})}),i.hooks){var s=i.hooks();Object.keys(s).forEach(function(o){Hp[o]||(Hp[o]=[]),Hp[o].push(s[o])})}i.provides&&i.provides(cm)}),t}function iN(n,e){for(var t=arguments.length,i=new Array(t>2?t-2:0),r=2;r<t;r++)i[r-2]=arguments[r];var s=Hp[n]||[];return s.forEach(function(o){e=o.apply(null,[e].concat(i))}),e}function Vf(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];var r=Hp[n]||[];r.forEach(function(s){s.apply(null,t)})}function vh(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);return cm[n]?cm[n].apply(null,e):void 0}function nN(n){n.prefix==="fa"&&(n.prefix="fas");var e=n.iconName,t=n.prefix||Ru();if(e)return e=zp(t,e)||e,f6(ZU.definitions,t,e)||f6(ka.styles,t,e)}var ZU=new Ese,Lse=function(){nt.autoReplaceSvg=!1,nt.observeMutations=!1,Vf("noAuto")},Ise={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Dh?(Vf("beforeI2svg",e),vh("pseudoElements2svg",e),vh("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot;nt.autoReplaceSvg===!1&&(nt.autoReplaceSvg=!0),nt.observeMutations=!0,gse(function(){Ase({autoReplaceSvgRoot:t}),Vf("watch",e)})}},Tse={icon:function(e){if(e===null)return null;if(mx(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:zp(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var t=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=KD(e[0]);return{prefix:i,iconName:zp(i,t)||t}}if(typeof e=="string"&&(e.indexOf("".concat(nt.familyPrefix,"-"))>-1||e.match(Zre))){var r=ZD(e.split(" "),{skipLookups:!0});return{prefix:r.prefix||Ru(),iconName:zp(r.prefix,r.iconName)||r.iconName}}if(typeof e=="string"){var s=Ru();return{prefix:s,iconName:zp(s,e)||e}}}},go={noAuto:Lse,config:nt,dom:Ise,parse:Tse,library:ZU,findIconDefinition:nN,toHtml:k1},Ase=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.autoReplaceSvgRoot,i=t===void 0?qi:t;(Object.keys(ka.styles).length>0||nt.autoFetchSvg)&&Dh&&nt.autoReplaceSvg&&go.dom.i2svg({node:i})};function YD(n,e){return Object.defineProperty(n,"abstract",{get:e}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(i){return k1(i)})}}),Object.defineProperty(n,"node",{get:function(){if(Dh){var i=qi.createElement("div");return i.innerHTML=n.html,i.children}}}),n}function Nse(n){var e=n.children,t=n.main,i=n.mask,r=n.attributes,s=n.styles,o=n.transform;if(mP(o)&&t.found&&!i.found){var a=t.width,l=t.height,c={x:a/l/2,y:.5};r.style=GD(We(We({},s),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function Rse(n){var e=n.prefix,t=n.iconName,i=n.children,r=n.attributes,s=n.symbol,o=s===!0?"".concat(e,"-").concat(nt.familyPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:We(We({},r),{},{id:o}),children:i}]}]}function wP(n){var e=n.icons,t=e.main,i=e.mask,r=n.prefix,s=n.iconName,o=n.transform,a=n.symbol,l=n.title,c=n.maskId,h=n.titleId,u=n.extra,d=n.watchable,f=d===void 0?!1:d,g=i.found?i:t,p=g.width,m=g.height,b=r==="fak",_=[nt.replacementClass,s?"".concat(nt.familyPrefix,"-").concat(s):""].filter(function(E){return u.classes.indexOf(E)===-1}).filter(function(E){return E!==""||!!E}).concat(u.classes).join(" "),w={children:[],attributes:We(We({},u.attributes),{},{"data-prefix":r,"data-icon":s,class:_,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(m)})},y=b&&!~u.classes.indexOf("fa-fw")?{width:"".concat(p/m*16*.0625,"em")}:{};f&&(w.attributes[Bf]=""),l&&(w.children.push({tag:"title",attributes:{id:w.attributes["aria-labelledby"]||"title-".concat(h||Av())},children:[l]}),delete w.attributes.title);var S=We(We({},w),{},{prefix:r,iconName:s,main:t,mask:i,maskId:c,transform:o,symbol:a,styles:We(We({},y),u.styles)}),k=i.found&&t.found?vh("generateAbstractMask",S)||{children:[],attributes:{}}:vh("generateAbstractIcon",S)||{children:[],attributes:{}},C=k.children,D=k.attributes;return S.children=C,S.attributes=D,a?Rse(S):Nse(S)}function m6(n){var e=n.content,t=n.width,i=n.height,r=n.transform,s=n.title,o=n.extra,a=n.watchable,l=a===void 0?!1:a,c=We(We(We({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});l&&(c[Bf]="");var h=We({},o.styles);mP(r)&&(h.transform=hse({transform:r,startCentered:!0,width:t,height:i}),h["-webkit-transform"]=h.transform);var u=GD(h);u.length>0&&(c.style=u);var d=[];return d.push({tag:"span",attributes:c,children:[e]}),s&&d.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),d}function Mse(n){var e=n.content,t=n.title,i=n.extra,r=We(We(We({},i.attributes),t?{title:t}:{}),{},{class:i.classes.join(" ")}),s=GD(i.styles);s.length>0&&(r.style=s);var o=[];return o.push({tag:"span",attributes:r,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}var w2=ka.styles;function rN(n){var e=n[0],t=n[1],i=n.slice(4),r=hP(i,1),s=r[0],o=null;return Array.isArray(s)?o={tag:"g",attributes:{class:"".concat(nt.familyPrefix,"-").concat(Zd.GROUP)},children:[{tag:"path",attributes:{class:"".concat(nt.familyPrefix,"-").concat(Zd.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(nt.familyPrefix,"-").concat(Zd.PRIMARY),fill:"currentColor",d:s[1]}}]}:o={tag:"path",attributes:{fill:"currentColor",d:s}},{found:!0,width:e,height:t,icon:o}}var Fse={found:!1,width:512,height:512};function Ose(n,e){!MU&&!nt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(e,'" is missing.'))}function sN(n,e){var t=e;return e==="fa"&&nt.styleDefault!==null&&(e=Ru()),new Promise(function(i,r){if(vh("missingIconAbstract"),t==="fa"){var s=KU(n)||{};n=s.iconName||n,e=s.prefix||e}if(n&&e&&w2[e]&&w2[e][n]){var o=w2[e][n];return i(rN(o))}Ose(n,e),i(We(We({},Fse),{},{icon:nt.showMissingIcons&&n?vh("missingIconAbstract")||{}:{}}))})}var _6=function(){},oN=nt.measurePerformance&&By&&By.mark&&By.measure?By:{mark:_6,measure:_6},hb='FA "6.1.1"',Pse=function(e){return oN.mark("".concat(hb," ").concat(e," begins")),function(){return YU(e)}},YU=function(e){oN.mark("".concat(hb," ").concat(e," ends")),oN.measure("".concat(hb," ").concat(e),"".concat(hb," ").concat(e," begins"),"".concat(hb," ").concat(e," ends"))},yP={begin:Pse,end:YU},dS=function(){};function b6(n){var e=n.getAttribute?n.getAttribute(Bf):null;return typeof e=="string"}function Bse(n){var e=n.getAttribute?n.getAttribute(dP):null,t=n.getAttribute?n.getAttribute(fP):null;return e&&t}function Vse(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(nt.replacementClass)}function Wse(){if(nt.autoReplaceSvg===!0)return fS.replace;var n=fS[nt.autoReplaceSvg];return n||fS.replace}function $se(n){return qi.createElementNS("http://www.w3.org/2000/svg",n)}function zse(n){return qi.createElement(n)}function XU(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.ceFn,i=t===void 0?n.tag==="svg"?$se:zse:t;if(typeof n=="string")return qi.createTextNode(n);var r=i(n.tag);Object.keys(n.attributes||[]).forEach(function(o){r.setAttribute(o,n.attributes[o])});var s=n.children||[];return s.forEach(function(o){r.appendChild(XU(o,{ceFn:i}))}),r}function Hse(n){var e=" ".concat(n.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var fS={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(r){t.parentNode.insertBefore(XU(r),t)}),t.getAttribute(Bf)===null&&nt.keepOriginalSource){var i=qi.createComment(Hse(t));t.parentNode.replaceChild(i,t)}else t.remove()},nest:function(e){var t=e[0],i=e[1];if(~pP(t).indexOf(nt.replacementClass))return fS.replace(e);var r=new RegExp("".concat(nt.familyPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var s=i[0].attributes.class.split(" ").reduce(function(a,l){return l===nt.replacementClass||l.match(r)?a.toSvg.push(l):a.toNode.push(l),a},{toNode:[],toSvg:[]});i[0].attributes.class=s.toSvg.join(" "),s.toNode.length===0?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=i.map(function(a){return k1(a)}).join(`
`);t.setAttribute(Bf,""),t.innerHTML=o}};function v6(n){n()}function QU(n,e){var t=typeof e=="function"?e:dS;if(n.length===0)t();else{var i=v6;nt.mutateApproach===qre&&(i=Nu.requestAnimationFrame||v6),i(function(){var r=Wse(),s=yP.begin("mutate");n.map(r),s(),t()})}}var CP=!1;function JU(){CP=!0}function aN(){CP=!1}var vx=null;function w6(n){if(h6&&nt.observeMutations){var e=n.treeCallback,t=e===void 0?dS:e,i=n.nodeCallback,r=i===void 0?dS:i,s=n.pseudoElementsCallback,o=s===void 0?dS:s,a=n.observeMutationsRoot,l=a===void 0?qi:a;vx=new h6(function(c){if(!CP){var h=Ru();Z_(c).forEach(function(u){if(u.type==="childList"&&u.addedNodes.length>0&&!b6(u.addedNodes[0])&&(nt.searchPseudoElements&&o(u.target),t(u.target)),u.type==="attributes"&&u.target.parentNode&&nt.searchPseudoElements&&o(u.target.parentNode),u.type==="attributes"&&b6(u.target)&&~Jre.indexOf(u.attributeName))if(u.attributeName==="class"&&Bse(u.target)){var d=ZD(pP(u.target)),f=d.prefix,g=d.iconName;u.target.setAttribute(dP,f||h),g&&u.target.setAttribute(fP,g)}else Vse(u.target)&&r(u.target)})}}),Dh&&vx.observe(l,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Use(){vx&&vx.disconnect()}function jse(n){var e=n.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(i,r){var s=r.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),t}function qse(n){var e=n.getAttribute("data-prefix"),t=n.getAttribute("data-icon"),i=n.innerText!==void 0?n.innerText.trim():"",r=ZD(pP(n));return r.prefix||(r.prefix=Ru()),e&&t&&(r.prefix=e,r.iconName=t),r.iconName&&r.prefix||r.prefix&&i.length>0&&(r.iconName=Sse(r.prefix,n.innerText)||bP(r.prefix,eN(n.innerText))),r}function Gse(n){var e=Z_(n.attributes).reduce(function(r,s){return r.name!=="class"&&r.name!=="style"&&(r[s.name]=s.value),r},{}),t=n.getAttribute("title"),i=n.getAttribute("data-fa-title-id");return nt.autoA11y&&(t?e["aria-labelledby"]="".concat(nt.replacementClass,"-title-").concat(i||Av()):(e["aria-hidden"]="true",e.focusable="false")),e}function Kse(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Bl,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function y6(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},t=qse(n),i=t.iconName,r=t.prefix,s=t.rest,o=Gse(n),a=iN("parseNodeAttributes",{},n),l=e.styleParser?jse(n):[];return We({iconName:i,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:r,transform:Bl,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:l,attributes:o}},a)}var Zse=ka.styles;function ej(n){var e=nt.autoReplaceSvg==="nest"?y6(n,{styleParser:!1}):y6(n);return~e.extra.classes.indexOf(OU)?vh("generateLayersText",n,e):vh("generateSvgReplacementMutation",n,e)}function C6(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Dh)return Promise.resolve();var t=qi.documentElement.classList,i=function(u){return t.add("".concat(u6,"-").concat(u))},r=function(u){return t.remove("".concat(u6,"-").concat(u))},s=nt.autoFetchSvg?Object.keys(gP):Object.keys(Zse),o=[".".concat(OU,":not([").concat(Bf,"])")].concat(s.map(function(h){return".".concat(h,":not([").concat(Bf,"])")})).join(", ");if(o.length===0)return Promise.resolve();var a=[];try{a=Z_(n.querySelectorAll(o))}catch{}if(a.length>0)i("pending"),r("complete");else return Promise.resolve();var l=yP.begin("onTree"),c=a.reduce(function(h,u){try{var d=ej(u);d&&h.push(d)}catch(f){MU||f.name==="MissingIcon"&&console.error(f)}return h},[]);return new Promise(function(h,u){Promise.all(c).then(function(d){QU(d,function(){i("active"),i("complete"),r("pending"),typeof e=="function"&&e(),l(),h()})}).catch(function(d){l(),u(d)})})}function Yse(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;ej(n).then(function(t){t&&QU([t],e)})}function Xse(n){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:nN(e||{}),r=t.mask;return r&&(r=(r||{}).icon?r:nN(r||{})),n(i,We(We({},t),{},{mask:r}))}}var Qse=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=t.transform,r=i===void 0?Bl:i,s=t.symbol,o=s===void 0?!1:s,a=t.mask,l=a===void 0?null:a,c=t.maskId,h=c===void 0?null:c,u=t.title,d=u===void 0?null:u,f=t.titleId,g=f===void 0?null:f,p=t.classes,m=p===void 0?[]:p,b=t.attributes,_=b===void 0?{}:b,w=t.styles,y=w===void 0?{}:w;if(e){var S=e.prefix,k=e.iconName,C=e.icon;return YD(We({type:"icon"},e),function(){return Vf("beforeDOMElementCreation",{iconDefinition:e,params:t}),nt.autoA11y&&(d?_["aria-labelledby"]="".concat(nt.replacementClass,"-title-").concat(g||Av()):(_["aria-hidden"]="true",_.focusable="false")),wP({icons:{main:rN(C),mask:l?rN(l.icon):{found:!1,width:null,height:null,icon:{}}},prefix:S,iconName:k,transform:We(We({},Bl),r),symbol:o,title:d,maskId:h,titleId:g,extra:{attributes:_,styles:y,classes:m}})})}},Jse={mixout:function(){return{icon:Xse(Qse)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=C6,t.nodeCallback=Yse,t}}},provides:function(e){e.i2svg=function(t){var i=t.node,r=i===void 0?qi:i,s=t.callback,o=s===void 0?function(){}:s;return C6(r,o)},e.generateSvgReplacementMutation=function(t,i){var r=i.iconName,s=i.title,o=i.titleId,a=i.prefix,l=i.transform,c=i.symbol,h=i.mask,u=i.maskId,d=i.extra;return new Promise(function(f,g){Promise.all([sN(r,a),h.iconName?sN(h.iconName,h.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(p){var m=hP(p,2),b=m[0],_=m[1];f([t,wP({icons:{main:b,mask:_},prefix:a,iconName:r,transform:l,symbol:c,maskId:u,title:s,titleId:o,extra:d,watchable:!0})])}).catch(g)})},e.generateAbstractIcon=function(t){var i=t.children,r=t.attributes,s=t.main,o=t.transform,a=t.styles,l=GD(a);l.length>0&&(r.style=l);var c;return mP(o)&&(c=vh("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),i.push(c||s.icon),{children:i,attributes:r}}}},eoe={mixout:function(){return{layer:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.classes,s=r===void 0?[]:r;return YD({type:"layer"},function(){Vf("beforeDOMElementCreation",{assembler:t,params:i});var o=[];return t(function(a){Array.isArray(a)?a.map(function(l){o=o.concat(l.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(nt.familyPrefix,"-layers")].concat(qD(s)).join(" ")},children:o}]})}}}},toe={mixout:function(){return{counter:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.title,s=r===void 0?null:r,o=i.classes,a=o===void 0?[]:o,l=i.attributes,c=l===void 0?{}:l,h=i.styles,u=h===void 0?{}:h;return YD({type:"counter",content:t},function(){return Vf("beforeDOMElementCreation",{content:t,params:i}),Mse({content:t.toString(),title:s,extra:{attributes:c,styles:u,classes:["".concat(nt.familyPrefix,"-layers-counter")].concat(qD(a))}})})}}}},ioe={mixout:function(){return{text:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.transform,s=r===void 0?Bl:r,o=i.title,a=o===void 0?null:o,l=i.classes,c=l===void 0?[]:l,h=i.attributes,u=h===void 0?{}:h,d=i.styles,f=d===void 0?{}:d;return YD({type:"text",content:t},function(){return Vf("beforeDOMElementCreation",{content:t,params:i}),m6({content:t,transform:We(We({},Bl),s),title:a,extra:{attributes:u,styles:f,classes:["".concat(nt.familyPrefix,"-layers-text")].concat(qD(c))}})})}}},provides:function(e){e.generateLayersText=function(t,i){var r=i.title,s=i.transform,o=i.extra,a=null,l=null;if(AU){var c=parseInt(getComputedStyle(t).fontSize,10),h=t.getBoundingClientRect();a=h.width/c,l=h.height/c}return nt.autoA11y&&!r&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,m6({content:t.innerHTML,width:a,height:l,transform:s,title:r,extra:o,watchable:!0})])}}},noe=new RegExp('"',"ug"),S6=[1105920,1112319];function roe(n){var e=n.replace(noe,""),t=_se(e,0),i=t>=S6[0]&&t<=S6[1],r=e.length===2?e[0]===e[1]:!1;return{value:eN(r?e[0]:e),isSecondary:i||r}}function x6(n,e){var t="".concat(jre).concat(e.replace(":","-"));return new Promise(function(i,r){if(n.getAttribute(t)!==null)return i();var s=Z_(n.children),o=s.filter(function(k){return k.getAttribute(JA)===e})[0],a=Nu.getComputedStyle(n,e),l=a.getPropertyValue("font-family").match(Yre),c=a.getPropertyValue("font-weight"),h=a.getPropertyValue("content");if(o&&!l)return n.removeChild(o),i();if(l&&h!=="none"&&h!==""){var u=a.getPropertyValue("content"),d=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(l[2])?_x[l[2].toLowerCase()]:Xre[c],f=roe(u),g=f.value,p=f.isSecondary,m=l[0].startsWith("FontAwesome"),b=bP(d,g),_=b;if(m){var w=xse(g);w.iconName&&w.prefix&&(b=w.iconName,d=w.prefix)}if(b&&!p&&(!o||o.getAttribute(dP)!==d||o.getAttribute(fP)!==_)){n.setAttribute(t,_),o&&n.removeChild(o);var y=Kse(),S=y.extra;S.attributes[JA]=e,sN(b,d).then(function(k){var C=wP(We(We({},y),{},{icons:{main:k,mask:vP()},prefix:d,iconName:_,extra:S,watchable:!0})),D=qi.createElement("svg");e==="::before"?n.insertBefore(D,n.firstChild):n.appendChild(D),D.outerHTML=C.map(function(E){return k1(E)}).join(`
`),n.removeAttribute(t),i()}).catch(r)}else i()}else i()})}function soe(n){return Promise.all([x6(n,"::before"),x6(n,"::after")])}function ooe(n){return n.parentNode!==document.head&&!~Gre.indexOf(n.tagName.toUpperCase())&&!n.getAttribute(JA)&&(!n.parentNode||n.parentNode.tagName!=="svg")}function E6(n){if(Dh)return new Promise(function(e,t){var i=Z_(n.querySelectorAll("*")).filter(ooe).map(soe),r=yP.begin("searchPseudoElements");JU(),Promise.all(i).then(function(){r(),aN(),e()}).catch(function(){r(),aN(),t()})})}var aoe={hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=E6,t}}},provides:function(e){e.pseudoElements2svg=function(t){var i=t.node,r=i===void 0?qi:i;nt.searchPseudoElements&&E6(r)}}},D6=!1,loe={mixout:function(){return{dom:{unwatch:function(){JU(),D6=!0}}}},hooks:function(){return{bootstrap:function(){w6(iN("mutationObserverCallbacks",{}))},noAuto:function(){Use()},watch:function(t){var i=t.observeMutationsRoot;D6?aN():w6(iN("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},k6=function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,r){var s=r.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&a==="h")return i.flipX=!0,i;if(o&&a==="v")return i.flipY=!0,i;if(a=parseFloat(a),isNaN(a))return i;switch(o){case"grow":i.size=i.size+a;break;case"shrink":i.size=i.size-a;break;case"left":i.x=i.x-a;break;case"right":i.x=i.x+a;break;case"up":i.y=i.y-a;break;case"down":i.y=i.y+a;break;case"rotate":i.rotate=i.rotate+a;break}return i},t)},coe={mixout:function(){return{parse:{transform:function(t){return k6(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-transform");return r&&(t.transform=k6(r)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var i=t.main,r=t.transform,s=t.containerWidth,o=t.iconWidth,a={transform:"translate(".concat(s/2," 256)")},l="translate(".concat(r.x*32,", ").concat(r.y*32,") "),c="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),h="rotate(".concat(r.rotate," 0 0)"),u={transform:"".concat(l," ").concat(c," ").concat(h)},d={transform:"translate(".concat(o/2*-1," -256)")},f={outer:a,inner:u,path:d};return{tag:"g",attributes:We({},f.outer),children:[{tag:"g",attributes:We({},f.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:We(We({},i.icon.attributes),f.path)}]}]}}}},y2={x:0,y:0,width:"100%",height:"100%"};function L6(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.attributes&&(n.attributes.fill||e)&&(n.attributes.fill="black"),n}function hoe(n){return n.tag==="g"?n.children:[n]}var uoe={hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-mask"),s=r?ZD(r.split(" ").map(function(o){return o.trim()})):vP();return s.prefix||(s.prefix=Ru()),t.mask=s,t.maskId=i.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var i=t.children,r=t.attributes,s=t.main,o=t.mask,a=t.maskId,l=t.transform,c=s.width,h=s.icon,u=o.width,d=o.icon,f=cse({transform:l,containerWidth:u,iconWidth:c}),g={tag:"rect",attributes:We(We({},y2),{},{fill:"white"})},p=h.children?{children:h.children.map(L6)}:{},m={tag:"g",attributes:We({},f.inner),children:[L6(We({tag:h.tag,attributes:We(We({},h.attributes),f.path)},p))]},b={tag:"g",attributes:We({},f.outer),children:[m]},_="mask-".concat(a||Av()),w="clip-".concat(a||Av()),y={tag:"mask",attributes:We(We({},y2),{},{id:_,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,b]},S={tag:"defs",children:[{tag:"clipPath",attributes:{id:w},children:hoe(d)},y]};return i.push(S,{tag:"rect",attributes:We({fill:"currentColor","clip-path":"url(#".concat(w,")"),mask:"url(#".concat(_,")")},y2)}),{children:i,attributes:r}}}},doe={provides:function(e){var t=!1;Nu.matchMedia&&(t=Nu.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],r={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:We(We({},r),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=We(We({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:We(We({},r),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:We(We({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:We(We({},o),{},{values:"1;0;1;1;0;1;"})}),i.push(a),i.push({tag:"path",attributes:We(We({},r),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:We(We({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||i.push({tag:"path",attributes:We(We({},r),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:We(We({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},foe={hooks:function(){return{parseNodeAttributes:function(t,i){var r=i.getAttribute("data-fa-symbol"),s=r===null?!1:r===""?!0:r;return t.symbol=s,t}}}},goe=[dse,Jse,eoe,toe,ioe,aoe,loe,coe,uoe,doe,foe];kse(goe,{mixoutsTo:go});go.noAuto;go.config;go.library;go.dom;go.parse;go.findIconDefinition;go.toHtml;var I6=go.icon;go.layer;go.text;go.counter;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var poe={prefix:"fas",iconName:"circle-question",icon:[512,512,[62108,"question-circle"],"f059","M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 400c-18 0-32-14-32-32s13.1-32 32-32c17.1 0 32 14 32 32S273.1 400 256 400zM325.1 258L280 286V288c0 13-11 24-24 24S232 301 232 288V272c0-8 4-16 12-21l57-34C308 213 312 206 312 198C312 186 301.1 176 289.1 176h-51.1C225.1 176 216 186 216 198c0 13-11 24-24 24s-24-11-24-24C168 159 199 128 237.1 128h51.1C329 128 360 159 360 198C360 222 347 245 325.1 258z"]},moe=poe,_oe={prefix:"fas",iconName:"table-columns",icon:[512,512,["columns"],"f0db","M0 96C0 60.65 28.65 32 64 32H448C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96zM64 416H224V160H64V416zM448 160H288V416H448V160z"]},boe=_oe;function rd(n,e,t){return n.fields=e||[],n.fname=t,n}function voe(n){return n==null?null:n.fname}function tj(n){return n==null?null:n.fields}function woe(n){return n.length===1?yoe(n[0]):Coe(n)}const yoe=n=>function(e){return e[n]},Coe=n=>{const e=n.length;return function(t){for(let i=0;i<e;++i)t=t[n[i]];return t}};function cn(n){throw Error(n)}function Soe(n){const e=[],t=n.length;let i=null,r=0,s="",o,a,l;n=n+"";function c(){e.push(s+n.substring(o,a)),s="",o=a+1}for(o=a=0;a<t;++a)if(l=n[a],l==="\\")s+=n.substring(o,a),s+=n.substring(++a,++a),o=a;else if(l===i)c(),i=null,r=-1;else{if(i)continue;o===r&&l==='"'||o===r&&l==="'"?(o=a+1,i=l):l==="."&&!r?a>o?c():o=a+1:l==="["?(a>o&&c(),r=o=a+1):l==="]"&&(r||cn("Access path missing open bracket: "+n),r>0&&c(),r=0,o=a+1)}return r&&cn("Access path missing closing bracket: "+n),i&&cn("Access path missing closing quote: "+n),a>o&&(a++,c()),e}function XD(n,e,t){const i=Soe(n);return n=i.length===1?i[0]:n,rd((t&&t.get||woe)(i),[n],e||n)}XD("id");const QD=rd(n=>n,[],"identity");rd(()=>0,[],"zero");rd(()=>1,[],"one");rd(()=>!0,[],"true");rd(()=>!1,[],"false");var po=Array.isArray;function Qa(n){return n===Object(n)}function $a(n){return n[n.length-1]}function Nv(n){return n==null||n===""?null:+n}const ij=n=>e=>n*Math.exp(e),nj=n=>e=>Math.log(n*e),xoe=n=>e=>Math.sign(e)*Math.log1p(Math.abs(e/n)),Eoe=n=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*n,wx=n=>e=>e<0?-Math.pow(-e,n):Math.pow(e,n);function SP(n,e,t,i){const r=t(n[0]),s=t($a(n)),o=(s-r)*e;return[i(r-o),i(s-o)]}function Doe(n,e){return SP(n,e,Nv,QD)}function koe(n,e){var t=Math.sign(n[0]);return SP(n,e,nj(t),ij(t))}function Loe(n,e,t){return SP(n,e,wx(t),wx(1/t))}function JD(n,e,t,i,r){const s=i(n[0]),o=i($a(n)),a=e!=null?i(e):(s+o)/2;return[r(a+(s-a)*t),r(a+(o-a)*t)]}function rj(n,e,t){return JD(n,e,t,Nv,QD)}function sj(n,e,t){const i=Math.sign(n[0]);return JD(n,e,t,nj(i),ij(i))}function lN(n,e,t,i){return JD(n,e,t,wx(i),wx(1/i))}function Ioe(n,e,t,i){return JD(n,e,t,xoe(i),Eoe(i))}function cN(n){return n!=null?po(n)?n:[n]:[]}function Toe(n,e,t){let i=n[0],r=n[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=t-e?[e,t]:[i=Math.min(Math.max(i,e),t-s),i+s]}function Ms(n){return typeof n=="function"}const Aoe="descending";function oj(n,e,t){t=t||{},e=cN(e)||[];const i=[],r=[],s={},o=t.comparator||Noe;return cN(n).forEach((a,l)=>{a!=null&&(i.push(e[l]===Aoe?-1:1),r.push(a=Ms(a)?a:XD(a,null,t)),(tj(a)||[]).forEach(c=>s[c]=1))}),r.length===0?null:rd(o(r,i),Object.keys(s))}const aj=(n,e)=>(n<e||n==null)&&e!=null?-1:(n>e||e==null)&&n!=null?1:(e=e instanceof Date?+e:e,(n=n instanceof Date?+n:n)!==n&&e===e?-1:e!==e&&n===n?1:0),Noe=(n,e)=>n.length===1?Roe(n[0],e[0]):Moe(n,e,n.length),Roe=(n,e)=>function(t,i){return aj(n(t),n(i))*e},Moe=(n,e,t)=>(e.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<t;)s=n[a],o=aj(s(i),s(r));return o*e[a]});function Foe(n){return Ms(n)?n:()=>n}function xP(n){for(let e,t,i=1,r=arguments.length;i<r;++i){e=arguments[i];for(t in e)n[t]=e[t]}return n}const Ooe=Object.prototype.hasOwnProperty;function Yd(n,e){return Ooe.call(n,e)}function ek(n){return typeof n=="boolean"}function Poe(n){return Object.prototype.toString.call(n)==="[object Date]"}function Boe(n){return n&&Ms(n[Symbol.iterator])}function Os(n){return typeof n=="number"}function un(n){return typeof n=="string"}function Voe(n,e){const t=n[0],i=$a(n),r=+e;return r?r===1?i:t+r*(i-t):t}function yx(n){return n&&$a(n)-n[0]||0}function tk(n){return po(n)?"["+n.map(tk)+"]":Qa(n)||un(n)?JSON.stringify(n).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):n}function Woe(n){return n==null||n===""?null:!n||n==="false"||n==="0"?!1:!!n}const $oe=n=>Os(n)||Poe(n)?n:Date.parse(n);function zoe(n,e){return e=e||$oe,n==null||n===""?null:e(n)}function Hoe(n){return n==null||n===""?null:n+""}function Cx(n){const e={},t=n.length;for(let i=0;i<t;++i)e[n[i]]=!0;return e}var T6={},C2={},S2=34,O0=10,x2=13;function lj(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Uoe(n,e){var t=lj(n);return function(i,r){return e(t(i),r,n)}}function A6(n){var e=Object.create(null),t=[];return n.forEach(function(i){for(var r in i)r in e||t.push(e[r]=r)}),t}function vs(n,e){var t=n+"",i=t.length;return i<e?new Array(e-i+1).join(0)+t:t}function joe(n){return n<0?"-"+vs(-n,6):n>9999?"+"+vs(n,6):vs(n,4)}function qoe(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),i=n.getUTCSeconds(),r=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":joe(n.getUTCFullYear())+"-"+vs(n.getUTCMonth()+1,2)+"-"+vs(n.getUTCDate(),2)+(r?"T"+vs(e,2)+":"+vs(t,2)+":"+vs(i,2)+"."+vs(r,3)+"Z":i?"T"+vs(e,2)+":"+vs(t,2)+":"+vs(i,2)+"Z":t||e?"T"+vs(e,2)+":"+vs(t,2)+"Z":"")}function cj(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function i(u,d){var f,g,p=r(u,function(m,b){if(f)return f(m,b-1);g=m,f=d?Uoe(m,d):lj(m)});return p.columns=g||[],p}function r(u,d){var f=[],g=u.length,p=0,m=0,b,_=g<=0,w=!1;u.charCodeAt(g-1)===O0&&--g,u.charCodeAt(g-1)===x2&&--g;function y(){if(_)return C2;if(w)return w=!1,T6;var k,C=p,D;if(u.charCodeAt(C)===S2){for(;p++<g&&u.charCodeAt(p)!==S2||u.charCodeAt(++p)===S2;);return(k=p)>=g?_=!0:(D=u.charCodeAt(p++))===O0?w=!0:D===x2&&(w=!0,u.charCodeAt(p)===O0&&++p),u.slice(C+1,k-1).replace(/""/g,'"')}for(;p<g;){if((D=u.charCodeAt(k=p++))===O0)w=!0;else if(D===x2)w=!0,u.charCodeAt(p)===O0&&++p;else if(D!==t)continue;return u.slice(C,k)}return _=!0,u.slice(C,g)}for(;(b=y())!==C2;){for(var S=[];b!==T6&&b!==C2;)S.push(b),b=y();d&&(S=d(S,m++))==null||f.push(S)}return f}function s(u,d){return u.map(function(f){return d.map(function(g){return h(f[g])}).join(n)})}function o(u,d){return d==null&&(d=A6(u)),[d.map(h).join(n)].concat(s(u,d)).join(`
`)}function a(u,d){return d==null&&(d=A6(u)),s(u,d).join(`
`)}function l(u){return u.map(c).join(`
`)}function c(u){return u.map(h).join(n)}function h(u){return u==null?"":u instanceof Date?qoe(u):e.test(u+="")?'"'+u.replace(/"/g,'""')+'"':u}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:l,formatRow:c,formatValue:h}}var Goe=cj("	"),Koe=Goe.parseRows;function Zoe(n){return n}function Yoe(n){if(n==null)return Zoe;var e,t,i=n.scale[0],r=n.scale[1],s=n.translate[0],o=n.translate[1];return function(a,l){l||(e=t=0);var c=2,h=a.length,u=new Array(h);for(u[0]=(e+=a[0])*i+s,u[1]=(t+=a[1])*r+o;c<h;)u[c]=a[c],++c;return u}}function Xoe(n,e){for(var t,i=n.length,r=i-e;r<--i;)t=n[r],n[r++]=n[i],n[i]=t}function Qoe(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(t){return N6(n,t)})}:N6(n,e)}function N6(n,e){var t=e.id,i=e.bbox,r=e.properties==null?{}:e.properties,s=hj(n,e);return t==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:t,properties:r,geometry:s}:{type:"Feature",id:t,bbox:i,properties:r,geometry:s}}function hj(n,e){var t=Yoe(n.transform),i=n.arcs;function r(h,u){u.length&&u.pop();for(var d=i[h<0?~h:h],f=0,g=d.length;f<g;++f)u.push(t(d[f],f));h<0&&Xoe(u,g)}function s(h){return t(h)}function o(h){for(var u=[],d=0,f=h.length;d<f;++d)r(h[d],u);return u.length<2&&u.push(u[0]),u}function a(h){for(var u=o(h);u.length<4;)u.push(u[0]);return u}function l(h){return h.map(a)}function c(h){var u=h.type,d;switch(u){case"GeometryCollection":return{type:u,geometries:h.geometries.map(c)};case"Point":d=s(h.coordinates);break;case"MultiPoint":d=h.coordinates.map(s);break;case"LineString":d=o(h.arcs);break;case"MultiLineString":d=h.arcs.map(o);break;case"Polygon":d=l(h.arcs);break;case"MultiPolygon":d=h.arcs.map(l);break;default:return null}return{type:u,coordinates:d}}return c(e)}function Joe(n,e){var t={},i={},r={},s=[],o=-1;e.forEach(function(c,h){var u=n.arcs[c<0?~c:c],d;u.length<3&&!u[1][0]&&!u[1][1]&&(d=e[++o],e[o]=c,e[h]=d)}),e.forEach(function(c){var h=a(c),u=h[0],d=h[1],f,g;if(f=r[u])if(delete r[f.end],f.push(c),f.end=d,g=i[d]){delete i[g.start];var p=g===f?f:f.concat(g);i[p.start=f.start]=r[p.end=g.end]=p}else i[f.start]=r[f.end]=f;else if(f=i[d])if(delete i[f.start],f.unshift(c),f.start=u,g=r[u]){delete r[g.end];var m=g===f?f:g.concat(f);i[m.start=g.start]=r[m.end=f.end]=m}else i[f.start]=r[f.end]=f;else f=[c],i[f.start=u]=r[f.end=d]=f});function a(c){var h=n.arcs[c<0?~c:c],u=h[0],d;return n.transform?(d=[0,0],h.forEach(function(f){d[0]+=f[0],d[1]+=f[1]})):d=h[h.length-1],c<0?[d,u]:[u,d]}function l(c,h){for(var u in c){var d=c[u];delete h[d.start],delete d.start,delete d.end,d.forEach(function(f){t[f<0?~f:f]=1}),s.push(d)}}return l(r,i),l(i,r),e.forEach(function(c){t[c<0?~c:c]||s.push([c])}),s}function eae(n){return hj(n,tae.apply(this,arguments))}function tae(n,e,t){var i,r,s;if(arguments.length>1)i=iae(n,e,t);else for(r=0,i=new Array(s=n.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:Joe(n,i)}}function iae(n,e,t){var i=[],r=[],s;function o(u){var d=u<0?~u:u;(r[d]||(r[d]=[])).push({i:u,g:s})}function a(u){u.forEach(o)}function l(u){u.forEach(a)}function c(u){u.forEach(l)}function h(u){switch(s=u,u.type){case"GeometryCollection":u.geometries.forEach(h);break;case"LineString":a(u.arcs);break;case"MultiLineString":case"Polygon":l(u.arcs);break;case"MultiPolygon":c(u.arcs);break}}return h(e),r.forEach(t==null?function(u){i.push(u[0].i)}:function(u){t(u[0].g,u[u.length-1].g)&&i.push(u[0].i)}),i}function Fb(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function nae(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function ik(n){let e,t,i;n.length!==2?(e=Fb,t=(a,l)=>Fb(n(a),l),i=(a,l)=>n(a)-l):(e=n===Fb||n===nae?n:rae,t=n,i=n);function r(a,l,c=0,h=a.length){if(c<h){if(e(l,l)!==0)return h;do{const u=c+h>>>1;t(a[u],l)<0?c=u+1:h=u}while(c<h)}return c}function s(a,l,c=0,h=a.length){if(c<h){if(e(l,l)!==0)return h;do{const u=c+h>>>1;t(a[u],l)<=0?c=u+1:h=u}while(c<h)}return c}function o(a,l,c=0,h=a.length){const u=r(a,l,c,h-1);return u>c&&i(a[u-1],l)>-i(a[u],l)?u-1:u}return{left:r,center:o,right:s}}function rae(){return 0}function uj(n){return n===null?NaN:+n}const dj=ik(Fb),hN=dj.right;dj.left;ik(uj).center;const Y_=hN;function sae(n,e){let t,i;if(e===void 0)for(const r of n)r!=null&&(t===void 0?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)));else{let r=-1;for(let s of n)(s=e(s,++r,n))!=null&&(t===void 0?s>=s&&(t=i=s):(t>s&&(t=s),i<s&&(i=s)))}return[t,i]}class Wf extends Map{constructor(e,t=lae){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(R6(this,e))}has(e){return super.has(R6(this,e))}set(e,t){return super.set(oae(this,e),t)}delete(e){return super.delete(aae(this,e))}}function R6({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):t}function oae({_intern:n,_key:e},t){const i=e(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function aae({_intern:n,_key:e},t){const i=e(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function lae(n){return n!==null&&typeof n=="object"?n.valueOf():n}function uN(n){return n}function nk(n,...e){return fj(n,uN,uN,e)}function cae(n,...e){return fj(n,Array.from,uN,e)}function fj(n,e,t,i){return function r(s,o){if(o>=i.length)return t(s);const a=new Wf,l=i[o++];let c=-1;for(const h of s){const u=l(h,++c,s),d=a.get(u);d?d.push(h):a.set(u,[h])}for(const[h,u]of a)a.set(h,r(u,o));return e(a)}(n,0)}var dN=Math.sqrt(50),fN=Math.sqrt(10),gN=Math.sqrt(2);function Sx(n,e,t){var i,r=-1,s,o,a;if(e=+e,n=+n,t=+t,n===e&&t>0)return[n];if((i=e<n)&&(s=n,n=e,e=s),(a=gj(n,e,t))===0||!isFinite(a))return[];if(a>0){let l=Math.round(n/a),c=Math.round(e/a);for(l*a<n&&++l,c*a>e&&--c,o=new Array(s=c-l+1);++r<s;)o[r]=(l+r)*a}else{a=-a;let l=Math.round(n*a),c=Math.round(e*a);for(l/a<n&&++l,c/a>e&&--c,o=new Array(s=c-l+1);++r<s;)o[r]=(l+r)/a}return i&&o.reverse(),o}function gj(n,e,t){var i=(e-n)/Math.max(0,t),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=dN?10:s>=fN?5:s>=gN?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=dN?10:s>=fN?5:s>=gN?2:1)}function $f(n,e,t){var i=Math.abs(e-n)/Math.max(0,t),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=dN?r*=10:s>=fN?r*=5:s>=gN&&(r*=2),e<n?-r:r}function pj(n,e,t=uj){if(i=n.length){if((e=+e)<=0||i<2)return+t(n[0],0,n);if(e>=1)return+t(n[i-1],i-1,n);var i,r=(i-1)*e,s=Math.floor(r),o=+t(n[s],s,n),a=+t(n[s+1],s+1,n);return o+(a-o)*(r-s)}}function Rv(n,e,t){n=+n,e=+e,t=(r=arguments.length)<2?(e=n,n=0,1):r<3?1:+t;for(var i=-1,r=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(r);++i<r;)s[i]=n+i*t;return s}function Vy(n,e){let t=0;if(e===void 0)for(let i of n)(i=+i)&&(t+=i);else{let i=-1;for(let r of n)(r=+e(r,++i,n))&&(t+=r)}return t}function hae(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function xx(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function Qm(n){return n=xx(Math.abs(n)),n?n[1]:NaN}function uae(n,e){return function(t,i){for(var r=t.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function dae(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var fae=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mu(n){if(!(e=fae.exec(n)))throw new Error("invalid format: "+n);var e;return new EP({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Mu.prototype=EP.prototype;function EP(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}EP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gae(n){e:for(var e=n.length,t=1,i=-1,r;t<e;++t)switch(n[t]){case".":i=r=t;break;case"0":i===0&&(i=t),r=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(r+1):n}var mj;function pae(n,e){var t=xx(n,e);if(!t)return n+"";var i=t[0],r=t[1],s=r-(mj=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+xx(n,Math.max(0,e+s-1))[0]}function M6(n,e){var t=xx(n,e);if(!t)return n+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const F6={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:hae,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>M6(n*100,e),r:M6,s:pae,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function O6(n){return n}var P6=Array.prototype.map,B6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function mae(n){var e=n.grouping===void 0||n.thousands===void 0?O6:uae(P6.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",r=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?O6:dae(P6.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function c(u){u=Mu(u);var d=u.fill,f=u.align,g=u.sign,p=u.symbol,m=u.zero,b=u.width,_=u.comma,w=u.precision,y=u.trim,S=u.type;S==="n"?(_=!0,S="g"):F6[S]||(w===void 0&&(w=12),y=!0,S="g"),(m||d==="0"&&f==="=")&&(m=!0,d="0",f="=");var k=p==="$"?t:p==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",C=p==="$"?i:/[%p]/.test(S)?o:"",D=F6[S],E=/[defgprs%]/.test(S);w=w===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function N(T){var j=k,q=C,ie,ge,be;if(S==="c")q=D(T)+q,T="";else{T=+T;var Se=T<0||1/T<0;if(T=isNaN(T)?l:D(Math.abs(T),w),y&&(T=gae(T)),Se&&+T==0&&g!=="+"&&(Se=!1),j=(Se?g==="("?g:a:g==="-"||g==="("?"":g)+j,q=(S==="s"?B6[8+mj/3]:"")+q+(Se&&g==="("?")":""),E){for(ie=-1,ge=T.length;++ie<ge;)if(be=T.charCodeAt(ie),48>be||be>57){q=(be===46?r+T.slice(ie+1):T.slice(ie))+q,T=T.slice(0,ie);break}}}_&&!m&&(T=e(T,1/0));var Le=j.length+T.length+q.length,ke=Le<b?new Array(b-Le+1).join(d):"";switch(_&&m&&(T=e(ke+T,ke.length?b-q.length:1/0),ke=""),f){case"<":T=j+T+q+ke;break;case"=":T=j+ke+T+q;break;case"^":T=ke.slice(0,Le=ke.length>>1)+j+T+q+ke.slice(Le);break;default:T=ke+j+T+q;break}return s(T)}return N.toString=function(){return u+""},N}function h(u,d){var f=c((u=Mu(u),u.type="f",u)),g=Math.max(-8,Math.min(8,Math.floor(Qm(d)/3)))*3,p=Math.pow(10,-g),m=B6[8+g/3];return function(b){return f(p*b)+m}}return{format:c,formatPrefix:h}}var Wy,Cr,DP;_ae({thousands:",",grouping:[3],currency:["$",""]});function _ae(n){return Wy=mae(n),Cr=Wy.format,DP=Wy.formatPrefix,Wy}function _j(n){return Math.max(0,-Qm(Math.abs(n)))}function bj(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qm(e)/3)))*3-Qm(Math.abs(n)))}function vj(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,Qm(e)-Qm(n))+1}var E2=new Date,D2=new Date;function cr(n,e,t,i){function r(s){return n(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=function(s){return n(s=new Date(+s)),s},r.ceil=function(s){return n(s=new Date(s-1)),e(s,1),n(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return e(s=new Date(+s),o==null?1:Math.floor(o)),s},r.range=function(s,o,a){var l=[],c;if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return l;do l.push(c=new Date(+s)),e(s,a),n(s);while(c<s&&s<o);return l},r.filter=function(s){return cr(function(o){if(o>=o)for(;n(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););})},t&&(r.count=function(s,o){return E2.setTime(+s),D2.setTime(+o),n(E2),n(D2),Math.floor(t(E2,D2))},r.every=function(s){return s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?function(o){return i(o)%s===0}:function(o){return r.count(0,o)%s===0}):r}),r}var Ex=cr(function(){},function(n,e){n.setTime(+n+e)},function(n,e){return e-n});Ex.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?cr(function(e){e.setTime(Math.floor(e/n)*n)},function(e,t){e.setTime(+e+t*n)},function(e,t){return(t-e)/n}):Ex};const kP=Ex;Ex.range;const sh=1e3,Wo=sh*60,oh=Wo*60,zf=oh*24,LP=zf*7,V6=zf*30,k2=zf*365;var wj=cr(function(n){n.setTime(n-n.getMilliseconds())},function(n,e){n.setTime(+n+e*sh)},function(n,e){return(e-n)/sh},function(n){return n.getUTCSeconds()});const lu=wj;wj.range;var yj=cr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*sh)},function(n,e){n.setTime(+n+e*Wo)},function(n,e){return(e-n)/Wo},function(n){return n.getMinutes()});const IP=yj;yj.range;var Cj=cr(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*sh-n.getMinutes()*Wo)},function(n,e){n.setTime(+n+e*oh)},function(n,e){return(e-n)/oh},function(n){return n.getHours()});const TP=Cj;Cj.range;var Sj=cr(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*Wo)/zf,n=>n.getDate()-1);const vf=Sj;Sj.range;function Eg(n){return cr(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wo)/LP})}var L1=Eg(0),Dx=Eg(1),bae=Eg(2),vae=Eg(3),Jm=Eg(4),wae=Eg(5),yae=Eg(6);L1.range;Dx.range;bae.range;vae.range;Jm.range;wae.range;yae.range;var xj=cr(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,e){n.setMonth(n.getMonth()+e)},function(n,e){return e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()});const kx=xj;xj.range;var AP=cr(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});AP.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:cr(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};const Fu=AP;AP.range;var Ej=cr(function(n){n.setUTCSeconds(0,0)},function(n,e){n.setTime(+n+e*Wo)},function(n,e){return(e-n)/Wo},function(n){return n.getUTCMinutes()});const NP=Ej;Ej.range;var Dj=cr(function(n){n.setUTCMinutes(0,0,0)},function(n,e){n.setTime(+n+e*oh)},function(n,e){return(e-n)/oh},function(n){return n.getUTCHours()});const RP=Dj;Dj.range;var kj=cr(function(n){n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e-n)/zf},function(n){return n.getUTCDate()-1});const wf=kj;kj.range;function Dg(n){return cr(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/LP})}var I1=Dg(0),Lx=Dg(1),Cae=Dg(2),Sae=Dg(3),e_=Dg(4),xae=Dg(5),Eae=Dg(6);I1.range;Lx.range;Cae.range;Sae.range;e_.range;xae.range;Eae.range;var Lj=cr(function(n){n.setUTCDate(1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCMonth(n.getUTCMonth()+e)},function(n,e){return e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12},function(n){return n.getUTCMonth()});const Ix=Lj;Lj.range;var MP=cr(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});MP.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:cr(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};const Ou=MP;MP.range;function Ij(n,e,t,i,r,s){const o=[[lu,1,sh],[lu,5,5*sh],[lu,15,15*sh],[lu,30,30*sh],[s,1,Wo],[s,5,5*Wo],[s,15,15*Wo],[s,30,30*Wo],[r,1,oh],[r,3,3*oh],[r,6,6*oh],[r,12,12*oh],[i,1,zf],[i,2,2*zf],[t,1,LP],[e,1,V6],[e,3,3*V6],[n,1,k2]];function a(c,h,u){const d=h<c;d&&([c,h]=[h,c]);const f=u&&typeof u.range=="function"?u:l(c,h,u),g=f?f.range(c,+h+1):[];return d?g.reverse():g}function l(c,h,u){const d=Math.abs(h-c)/u,f=ik(([,,m])=>m).right(o,d);if(f===o.length)return n.every($f(c/k2,h/k2,u));if(f===0)return kP.every(Math.max($f(c,h,u),1));const[g,p]=o[d/o[f-1][2]<o[f][2]/d?f-1:f];return g.every(p)}return[a,l]}const[Dae,kae]=Ij(Ou,Ix,I1,wf,RP,NP),[Lae,Iae]=Ij(Fu,kx,L1,vf,TP,IP),Mv="year",Fv="quarter",Ov="month",Pv="week",Bv="date",rk="day",FP="dayofyear",Vv="hours",Wv="minutes",$v="seconds",sk="milliseconds",Tae=[Mv,Fv,Ov,Pv,Bv,rk,FP,Vv,Wv,$v,sk];Tae.reduce((n,e,t)=>(n[e]=1+t,n),{});const Aae={[Mv]:Fu,[Fv]:kx.every(3),[Ov]:kx,[Pv]:L1,[Bv]:vf,[rk]:vf,[FP]:vf,[Vv]:TP,[Wv]:IP,[$v]:lu,[sk]:kP},Nae={[Mv]:Ou,[Fv]:Ix.every(3),[Ov]:Ix,[Pv]:I1,[Bv]:wf,[rk]:wf,[FP]:wf,[Vv]:RP,[Wv]:NP,[$v]:lu,[sk]:kP};function Rae(n){return Aae[n]}function Mae(n){return Nae[n]}function L2(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function I2(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function P0(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function Tj(n){var e=n.dateTime,t=n.date,i=n.time,r=n.periods,s=n.days,o=n.shortDays,a=n.months,l=n.shortMonths,c=B0(r),h=V0(r),u=B0(s),d=V0(s),f=B0(o),g=V0(o),p=B0(a),m=V0(a),b=B0(l),_=V0(l),w={a:Se,A:Le,b:ke,B:Lt,c:null,d:j6,e:j6,f:nle,g:fle,G:ple,H:ele,I:tle,j:ile,L:Aj,m:rle,M:sle,p:Ge,q:Je,Q:K6,s:Z6,S:ole,u:ale,U:lle,V:cle,w:hle,W:ule,x:null,X:null,y:dle,Y:gle,Z:mle,"%":G6},y={a:Ct,A:ut,b:Ai,B:te,c:null,d:q6,e:q6,f:wle,g:Tle,G:Nle,H:_le,I:ble,j:vle,L:Rj,m:yle,M:Cle,p:ee,q:pe,Q:K6,s:Z6,S:Sle,u:xle,U:Ele,V:Dle,w:kle,W:Lle,x:null,X:null,y:Ile,Y:Ale,Z:Rle,"%":G6},S={a:N,A:T,b:j,B:q,c:ie,d:H6,e:H6,f:Yae,g:z6,G:$6,H:U6,I:U6,j:qae,L:Zae,m:jae,M:Gae,p:E,q:Uae,Q:Qae,s:Jae,S:Kae,u:Vae,U:Wae,V:$ae,w:Bae,W:zae,x:ge,X:be,y:z6,Y:$6,Z:Hae,"%":Xae};w.x=k(t,w),w.X=k(i,w),w.c=k(e,w),y.x=k(t,y),y.X=k(i,y),y.c=k(e,y);function k(se,De){return function(O){var I=[],ue=-1,_e=0,at=se.length,ze,lt,fn;for(O instanceof Date||(O=new Date(+O));++ue<at;)se.charCodeAt(ue)===37&&(I.push(se.slice(_e,ue)),(lt=W6[ze=se.charAt(++ue)])!=null?ze=se.charAt(++ue):lt=ze==="e"?" ":"0",(fn=De[ze])&&(ze=fn(O,lt)),I.push(ze),_e=ue+1);return I.push(se.slice(_e,ue)),I.join("")}}function C(se,De){return function(O){var I=P0(1900,void 0,1),ue=D(I,se,O+="",0),_e,at;if(ue!=O.length)return null;if("Q"in I)return new Date(I.Q);if("s"in I)return new Date(I.s*1e3+("L"in I?I.L:0));if(De&&!("Z"in I)&&(I.Z=0),"p"in I&&(I.H=I.H%12+I.p*12),I.m===void 0&&(I.m="q"in I?I.q:0),"V"in I){if(I.V<1||I.V>53)return null;"w"in I||(I.w=1),"Z"in I?(_e=I2(P0(I.y,0,1)),at=_e.getUTCDay(),_e=at>4||at===0?Lx.ceil(_e):Lx(_e),_e=wf.offset(_e,(I.V-1)*7),I.y=_e.getUTCFullYear(),I.m=_e.getUTCMonth(),I.d=_e.getUTCDate()+(I.w+6)%7):(_e=L2(P0(I.y,0,1)),at=_e.getDay(),_e=at>4||at===0?Dx.ceil(_e):Dx(_e),_e=vf.offset(_e,(I.V-1)*7),I.y=_e.getFullYear(),I.m=_e.getMonth(),I.d=_e.getDate()+(I.w+6)%7)}else("W"in I||"U"in I)&&("w"in I||(I.w="u"in I?I.u%7:"W"in I?1:0),at="Z"in I?I2(P0(I.y,0,1)).getUTCDay():L2(P0(I.y,0,1)).getDay(),I.m=0,I.d="W"in I?(I.w+6)%7+I.W*7-(at+5)%7:I.w+I.U*7-(at+6)%7);return"Z"in I?(I.H+=I.Z/100|0,I.M+=I.Z%100,I2(I)):L2(I)}}function D(se,De,O,I){for(var ue=0,_e=De.length,at=O.length,ze,lt;ue<_e;){if(I>=at)return-1;if(ze=De.charCodeAt(ue++),ze===37){if(ze=De.charAt(ue++),lt=S[ze in W6?De.charAt(ue++):ze],!lt||(I=lt(se,O,I))<0)return-1}else if(ze!=O.charCodeAt(I++))return-1}return I}function E(se,De,O){var I=c.exec(De.slice(O));return I?(se.p=h.get(I[0].toLowerCase()),O+I[0].length):-1}function N(se,De,O){var I=f.exec(De.slice(O));return I?(se.w=g.get(I[0].toLowerCase()),O+I[0].length):-1}function T(se,De,O){var I=u.exec(De.slice(O));return I?(se.w=d.get(I[0].toLowerCase()),O+I[0].length):-1}function j(se,De,O){var I=b.exec(De.slice(O));return I?(se.m=_.get(I[0].toLowerCase()),O+I[0].length):-1}function q(se,De,O){var I=p.exec(De.slice(O));return I?(se.m=m.get(I[0].toLowerCase()),O+I[0].length):-1}function ie(se,De,O){return D(se,e,De,O)}function ge(se,De,O){return D(se,t,De,O)}function be(se,De,O){return D(se,i,De,O)}function Se(se){return o[se.getDay()]}function Le(se){return s[se.getDay()]}function ke(se){return l[se.getMonth()]}function Lt(se){return a[se.getMonth()]}function Ge(se){return r[+(se.getHours()>=12)]}function Je(se){return 1+~~(se.getMonth()/3)}function Ct(se){return o[se.getUTCDay()]}function ut(se){return s[se.getUTCDay()]}function Ai(se){return l[se.getUTCMonth()]}function te(se){return a[se.getUTCMonth()]}function ee(se){return r[+(se.getUTCHours()>=12)]}function pe(se){return 1+~~(se.getUTCMonth()/3)}return{format:function(se){var De=k(se+="",w);return De.toString=function(){return se},De},parse:function(se){var De=C(se+="",!1);return De.toString=function(){return se},De},utcFormat:function(se){var De=k(se+="",y);return De.toString=function(){return se},De},utcParse:function(se){var De=C(se+="",!0);return De.toString=function(){return se},De}}}var W6={"-":"",_:" ",0:"0"},hr=/^\s*\d+/,Fae=/^%/,Oae=/[\\^$*+?|[\]().{}]/g;function si(n,e,t){var i=n<0?"-":"",r=(i?-n:n)+"",s=r.length;return i+(s<t?new Array(t-s+1).join(e)+r:r)}function Pae(n){return n.replace(Oae,"\\$&")}function B0(n){return new RegExp("^(?:"+n.map(Pae).join("|")+")","i")}function V0(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function Bae(n,e,t){var i=hr.exec(e.slice(t,t+1));return i?(n.w=+i[0],t+i[0].length):-1}function Vae(n,e,t){var i=hr.exec(e.slice(t,t+1));return i?(n.u=+i[0],t+i[0].length):-1}function Wae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.U=+i[0],t+i[0].length):-1}function $ae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.V=+i[0],t+i[0].length):-1}function zae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.W=+i[0],t+i[0].length):-1}function $6(n,e,t){var i=hr.exec(e.slice(t,t+4));return i?(n.y=+i[0],t+i[0].length):-1}function z6(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function Hae(n,e,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return i?(n.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function Uae(n,e,t){var i=hr.exec(e.slice(t,t+1));return i?(n.q=i[0]*3-3,t+i[0].length):-1}function jae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.m=i[0]-1,t+i[0].length):-1}function H6(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.d=+i[0],t+i[0].length):-1}function qae(n,e,t){var i=hr.exec(e.slice(t,t+3));return i?(n.m=0,n.d=+i[0],t+i[0].length):-1}function U6(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.H=+i[0],t+i[0].length):-1}function Gae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.M=+i[0],t+i[0].length):-1}function Kae(n,e,t){var i=hr.exec(e.slice(t,t+2));return i?(n.S=+i[0],t+i[0].length):-1}function Zae(n,e,t){var i=hr.exec(e.slice(t,t+3));return i?(n.L=+i[0],t+i[0].length):-1}function Yae(n,e,t){var i=hr.exec(e.slice(t,t+6));return i?(n.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function Xae(n,e,t){var i=Fae.exec(e.slice(t,t+1));return i?t+i[0].length:-1}function Qae(n,e,t){var i=hr.exec(e.slice(t));return i?(n.Q=+i[0],t+i[0].length):-1}function Jae(n,e,t){var i=hr.exec(e.slice(t));return i?(n.s=+i[0],t+i[0].length):-1}function j6(n,e){return si(n.getDate(),e,2)}function ele(n,e){return si(n.getHours(),e,2)}function tle(n,e){return si(n.getHours()%12||12,e,2)}function ile(n,e){return si(1+vf.count(Fu(n),n),e,3)}function Aj(n,e){return si(n.getMilliseconds(),e,3)}function nle(n,e){return Aj(n,e)+"000"}function rle(n,e){return si(n.getMonth()+1,e,2)}function sle(n,e){return si(n.getMinutes(),e,2)}function ole(n,e){return si(n.getSeconds(),e,2)}function ale(n){var e=n.getDay();return e===0?7:e}function lle(n,e){return si(L1.count(Fu(n)-1,n),e,2)}function Nj(n){var e=n.getDay();return e>=4||e===0?Jm(n):Jm.ceil(n)}function cle(n,e){return n=Nj(n),si(Jm.count(Fu(n),n)+(Fu(n).getDay()===4),e,2)}function hle(n){return n.getDay()}function ule(n,e){return si(Dx.count(Fu(n)-1,n),e,2)}function dle(n,e){return si(n.getFullYear()%100,e,2)}function fle(n,e){return n=Nj(n),si(n.getFullYear()%100,e,2)}function gle(n,e){return si(n.getFullYear()%1e4,e,4)}function ple(n,e){var t=n.getDay();return n=t>=4||t===0?Jm(n):Jm.ceil(n),si(n.getFullYear()%1e4,e,4)}function mle(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+si(e/60|0,"0",2)+si(e%60,"0",2)}function q6(n,e){return si(n.getUTCDate(),e,2)}function _le(n,e){return si(n.getUTCHours(),e,2)}function ble(n,e){return si(n.getUTCHours()%12||12,e,2)}function vle(n,e){return si(1+wf.count(Ou(n),n),e,3)}function Rj(n,e){return si(n.getUTCMilliseconds(),e,3)}function wle(n,e){return Rj(n,e)+"000"}function yle(n,e){return si(n.getUTCMonth()+1,e,2)}function Cle(n,e){return si(n.getUTCMinutes(),e,2)}function Sle(n,e){return si(n.getUTCSeconds(),e,2)}function xle(n){var e=n.getUTCDay();return e===0?7:e}function Ele(n,e){return si(I1.count(Ou(n)-1,n),e,2)}function Mj(n){var e=n.getUTCDay();return e>=4||e===0?e_(n):e_.ceil(n)}function Dle(n,e){return n=Mj(n),si(e_.count(Ou(n),n)+(Ou(n).getUTCDay()===4),e,2)}function kle(n){return n.getUTCDay()}function Lle(n,e){return si(Lx.count(Ou(n)-1,n),e,2)}function Ile(n,e){return si(n.getUTCFullYear()%100,e,2)}function Tle(n,e){return n=Mj(n),si(n.getUTCFullYear()%100,e,2)}function Ale(n,e){return si(n.getUTCFullYear()%1e4,e,4)}function Nle(n,e){var t=n.getUTCDay();return n=t>=4||t===0?e_(n):e_.ceil(n),si(n.getUTCFullYear()%1e4,e,4)}function Rle(){return"+0000"}function G6(){return"%"}function K6(n){return+n}function Z6(n){return Math.floor(+n/1e3)}var op,OP,Fj,PP,Oj;Mle({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mle(n){return op=Tj(n),OP=op.format,Fj=op.parse,PP=op.utcFormat,Oj=op.utcParse,op}function ub(n){const e={};return t=>e[t]||(e[t]=n(t))}function Fle(n,e){return t=>{const i=n(t),r=i.indexOf(e);if(r<0)return i;let s=Ole(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function Ole(n,e){let t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}function Ple(n){const e=ub(n.format),t=n.formatPrefix;return{format:e,formatPrefix:t,formatFloat(i){const r=Mu(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return Fle(e(r),e(".1f")(1)[1])}else return e(r)},formatSpan(i,r,s,o){o=Mu(o??",f");const a=$f(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let c;if(o.precision==null)switch(o.type){case"s":return isNaN(c=bj(a,l))||(o.precision=c),t(o,l);case"":case"e":case"g":case"p":case"r":{isNaN(c=vj(a,l))||(o.precision=c-(o.type==="e"));break}case"f":case"%":{isNaN(c=_j(a))||(o.precision=c-(o.type==="%")*2);break}}return e(o)}}}Ble();function Ble(){return Ple({format:Cr,formatPrefix:DP})}function Y6(n,e,t){t=t||{},Qa(t)||cn("Invalid time multi-format specifier: ".concat(t));const i=e($v),r=e(Wv),s=e(Vv),o=e(Bv),a=e(Pv),l=e(Ov),c=e(Fv),h=e(Mv),u=n(t[sk]||".%L"),d=n(t[$v]||":%S"),f=n(t[Wv]||"%I:%M"),g=n(t[Vv]||"%I %p"),p=n(t[Bv]||t[rk]||"%a %d"),m=n(t[Pv]||"%b %d"),b=n(t[Ov]||"%B"),_=n(t[Fv]||"%B"),w=n(t[Mv]||"%Y");return y=>(i(y)<y?u:r(y)<y?d:s(y)<y?f:o(y)<y?g:l(y)<y?a(y)<y?p:m:h(y)<y?c(y)<y?b:_:w)(y)}function Pj(n){const e=ub(n.format),t=ub(n.utcFormat);return{timeFormat:i=>un(i)?e(i):Y6(e,Rae,i),utcFormat:i=>un(i)?t(i):Y6(t,Mae,i),timeParse:ub(n.parse),utcParse:ub(n.utcParse)}}let pN;Vle();function Vle(){return pN=Pj({format:OP,parse:Fj,utcFormat:PP,utcParse:Oj})}function Wle(n){return Pj(Tj(n))}function $le(n){return arguments.length?pN=Wle(n):pN}const zle=/^(data:|([A-Za-z]+:)?\/\/)/,Hle=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ule=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,X6="file://";function jle(n,e){return t=>({options:t||{},sanitize:Gle,load:qle,fileAccess:!!e,file:Kle(e),http:Yle(n)})}async function qle(n,e){const t=await this.sanitize(n,e),i=t.href;return t.localFile?this.file(i):this.http(i,e)}async function Gle(n,e){e=xP({},this.options,e);const t=this.fileAccess,i={href:null};let r,s,o;const a=Hle.test(n.replace(Ule,""));(n==null||typeof n!="string"||!a)&&cn("Sanitize failure, invalid URI: "+tk(n));const l=zle.test(n);return(o=e.baseURL)&&!l&&(!n.startsWith("/")&&!o.endsWith("/")&&(n="/"+n),n=o+n),s=(r=n.startsWith(X6))||e.mode==="file"||e.mode!=="http"&&!l&&t,r?n=n.slice(X6.length):n.startsWith("//")&&(e.defaultProtocol==="file"?(n=n.slice(2),s=!0):n=(e.defaultProtocol||"http")+":"+n),Object.defineProperty(i,"localFile",{value:!!s}),i.href=n,e.target&&(i.target=e.target+""),e.rel&&(i.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(i.crossOrigin=e.crossOrigin+""),i}function Kle(n){return n?e=>new Promise((t,i)=>{n.readFile(e,(r,s)=>{r?i(r):t(s)})}):Zle}async function Zle(){cn("No file system access.")}function Yle(n){return n?async function(e,t){const i=xP({},this.options.http,t),r=t&&t.response,s=await n(e,i);return s.ok?Ms(s[r])?s[r]():s.text():cn(s.status+""+s.statusText)}:Xle}async function Xle(){cn("No HTTP fetch method available.")}const Qle=n=>n!=null&&n===n,Jle=n=>n==="true"||n==="false"||n===!0||n===!1,ece=n=>!Number.isNaN(Date.parse(n)),Bj=n=>!Number.isNaN(+n)&&!(n instanceof Date),tce=n=>Bj(n)&&Number.isInteger(+n),Q6={boolean:Woe,integer:Nv,number:Nv,date:zoe,string:Hoe,unknown:QD},$y=[Jle,tce,Bj,ece],ice=["boolean","integer","number","date"];function nce(n,e){if(!n||!n.length)return"unknown";const t=n.length,i=$y.length,r=$y.map((s,o)=>o+1);for(let s=0,o=0,a,l;s<t;++s)for(l=e?n[s][e]:n[s],a=0;a<i;++a)if(r[a]&&Qle(l)&&!$y[a](l)&&(r[a]=0,++o,o===$y.length))return"string";return ice[r.reduce((s,o)=>s===0?o:s,0)-1]}function rce(n,e){return e.reduce((t,i)=>(t[i]=nce(n,i),t),{})}function J6(n){const e=function(t,i){const r={delimiter:n};return BP(t,i?xP(i,r):r)};return e.responseType="text",e}function BP(n,e){return e.header&&(n=e.header.map(tk).join(e.delimiter)+`
`+n),cj(e.delimiter).parse(n+"")}BP.responseType="text";function sce(n){return typeof Buffer=="function"&&Ms(Buffer.isBuffer)?Buffer.isBuffer(n):!1}function VP(n,e){const t=e&&e.property?XD(e.property):QD;return Qa(n)&&!sce(n)?oce(t(n),e):t(JSON.parse(n))}VP.responseType="json";function oce(n,e){return!po(n)&&Boe(n)&&(n=[...n]),e&&e.copy?JSON.parse(JSON.stringify(n)):n}const ace={interior:(n,e)=>n!==e,exterior:(n,e)=>n===e};function Vj(n,e){let t,i,r,s;return n=VP(n,e),e&&e.feature?(t=Qoe,r=e.feature):e&&e.mesh?(t=eae,r=e.mesh,s=ace[e.filter]):cn("Missing TopoJSON feature or mesh parameter."),i=(i=n.objects[r])?t(n,i,s):cn("Invalid TopoJSON object: "+r),i&&i.features||[i]}Vj.responseType="json";const T2={dsv:BP,csv:J6(","),tsv:J6("	"),json:VP,topojson:Vj};function Wj(n,e){return arguments.length>1?(T2[n]=e,this):Yd(T2,n)?T2[n]:null}function WP(n,e,t,i){e=e||{};const r=Wj(e.type||"json");return r||cn("Unknown data format type: "+e.type),n=r(n,e),e.parse&&lce(n,e.parse,t,i),Yd(n,"columns")&&delete n.columns,n}function lce(n,e,t,i){if(!n.length)return;const r=$le();t=t||r.timeParse,i=i||r.utcParse;let s=n.columns||Object.keys(n[0]),o,a,l,c,h,u;e==="auto"&&(e=rce(n,s)),s=Object.keys(e);const d=s.map(f=>{const g=e[f];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:t)(m);if(!Q6[g])throw Error("Illegal format pattern: "+f+":"+g);return Q6[g]});for(l=0,h=n.length,u=s.length;l<h;++l)for(o=n[l],c=0;c<u;++c)a=s[c],o[a]=d[c](o[a])}const ok=jle(typeof fetch<"u"&&fetch,null),cce=`.genome-spy {
  font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  position: relative;
}
.genome-spy canvas {
  transform: scale(1, 1);
  opacity: 1;
  transition: transform 0.6s, opacity 0.6s;
}
.genome-spy .loading-message {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}
.genome-spy .loading-message .message {
  color: #666;
  opacity: 0;
  transition: opacity 0.7s;
}
.genome-spy.loading canvas {
  transform: scale(0.95, 0.95);
  opacity: 0;
}
.genome-spy.loading .loading-message .message {
  opacity: 1;
}
.genome-spy.loading .ellipsis {
  animation: blinker 1s linear infinite;
}
@keyframes blinker {
  50% {
    opacity: 0;
  }
}
.genome-spy .tooltip {
  position: absolute;
  max-width: 450px;
  overflow: hidden;
  background: #f6f6f6;
  padding: 10px;
  font-size: 13px;
  box-shadow: 0px 3px 15px 0px rgba(0, 0, 0, 0.21);
  pointer-events: none;
  z-index: 100;
}
.genome-spy .tooltip > :last-child {
  margin-bottom: 0;
}
.genome-spy .tooltip > .title {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px dashed #b6b6b6;
}
.genome-spy .tooltip .summary {
  font-size: 12px;
}
.genome-spy .tooltip table {
  border-collapse: collapse;
}
.genome-spy .tooltip table:first-child {
  margin-top: 0;
}
.genome-spy .tooltip table th,
.genome-spy .tooltip table td {
  padding: 2px 0.4em;
  vertical-align: top;
}
.genome-spy .tooltip table th:first-child,
.genome-spy .tooltip table td:first-child {
  padding-left: 0;
}
.genome-spy .tooltip table th {
  text-align: left;
  font-weight: bold;
}
.genome-spy .tooltip .color-legend {
  display: inline-block;
  width: 0.8em;
  height: 0.8em;
  margin-left: 0.4em;
  box-shadow: 0px 0px 3px 1px white;
}
.genome-spy .tooltip .attributes .hovered {
  background-color: #e0e0e0;
}
.genome-spy .tooltip .na {
  color: #aaa;
  font-style: italic;
  font-size: 80%;
}
.genome-spy .gene-track-tooltip .summary {
  font-size: 90%;
}
.genome-spy .message-box {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: 0;
  height: 100%;
  width: 100%;
}
.genome-spy .message-box > div {
  border: 1px solid red;
  padding: 10px;
  background: #fff0f0;
}`;function hce(n,e){var t=n.getBoundingClientRect();return[e.clientX-t.left-n.clientLeft,e.clientY-t.top-n.clientTop]}function Tx(n,e){return n.length==e.length&&n.every((t,i)=>n[i]===e[i])}function Fs(n){return Array.isArray(n)?n:typeof n<"u"?[n]:[]}function T1(n){return n[n.length-1]}class uce{constructor(e){this.container=e,this.element=document.createElement("div"),this.element.className="tooltip",this._visible=!0,this.container.appendChild(this.element),this._previousTooltipDatum=void 0,this.enabledStack=[!0],this._penaltyUntil=0,this._lastCoords=void 0,this._previousMove=0,this.clear()}set visible(e){e!=this._visible&&(this.element.style.display=e?null:"none",this._visible=e)}get visible(){return this._visible}get enabled(){return T1(this.enabledStack)??!0}pushEnabledState(e){this.enabledStack.push(e),e||(this.visible=!1)}popEnabledState(){this.enabledStack.pop()}handleMouseMove(e){this.mouseCoords=hce(this.container,e);const t=performance.now();!this.visible&&!this._isPenalty()&&t-this._previousMove>500&&(this._penaltyUntil=t+70),this._lastCoords&&dce(this.mouseCoords,this._lastCoords)>20&&(this._penaltyUntil=t+400),this._lastCoords=this.mouseCoords,this.visible&&this.updatePlacement(),this._previousMove=t}updatePlacement(){const[t,i]=this.mouseCoords;let r=t+20;r>this.container.clientWidth-this.element.offsetWidth&&(r=t-20-this.element.offsetWidth),this.element.style.left=r+"px",this.element.style.top=Math.min(i+20,this.container.clientHeight-this.element.offsetHeight)+"px"}setContent(e){if(!e||!this.enabled||this._isPenalty()){this.visible&&(gx("",this.element),this.visible=!1),this._previousTooltipDatum=void 0;return}gx(e,this.element),this.visible=!0,this.updatePlacement()}clear(){this._previousTooltipDatum=void 0,this.setContent(void 0)}updateWithDatum(e,t){e!==this._previousTooltipDatum&&(this._previousTooltipDatum=e,t||(t=i=>Promise.resolve(on` ${JSON.stringify(i)} `)),t(e).then(i=>this.setContent(i)).catch(i=>{if(i!=="debounced")throw i}))}_isPenalty(){return this._penaltyUntil&&this._penaltyUntil>performance.now()}}function dce(n,e){let t=0;for(let i=0;i<n.length;i++)t+=(n[i]-e[i])**2;return Math.sqrt(t)}const fce="RawCode",gce="Literal",pce="Property",mce="Identifier",_ce="ArrayExpression",bce="BinaryExpression",vce="CallExpression",wce="ConditionalExpression",yce="LogicalExpression",Cce="MemberExpression",Sce="ObjectExpression",xce="UnaryExpression";function Ja(n){this.type=n}Ja.prototype.visit=function(n){let e,t,i;if(n(this))return 1;for(e=Ece(this),t=0,i=e.length;t<i;++t)if(e[t].visit(n))return 1};function Ece(n){switch(n.type){case _ce:return n.elements;case bce:case yce:return[n.left,n.right];case vce:return[n.callee].concat(n.arguments);case wce:return[n.test,n.consequent,n.alternate];case Cce:return[n.object,n.property];case Sce:return n.properties;case pce:return[n.key,n.value];case xce:return[n.argument];case mce:case gce:case fce:default:return[]}}var uc,Ue,de,Vr,pi,ak=1,A1=2,Hf=3,sd=4,lk=5,kg=6,ws=7,N1=8,Dce=9;uc={};uc[ak]="Boolean";uc[A1]="<end>";uc[Hf]="Identifier";uc[sd]="Keyword";uc[lk]="Null";uc[kg]="Numeric";uc[ws]="Punctuator";uc[N1]="String";uc[Dce]="RegularExpression";var kce="ArrayExpression",Lce="BinaryExpression",Ice="CallExpression",Tce="ConditionalExpression",$j="Identifier",Ace="Literal",Nce="LogicalExpression",Rce="MemberExpression",Mce="ObjectExpression",Fce="Property",Oce="UnaryExpression",or="Unexpected token %0",Pce="Unexpected number",Bce="Unexpected string",Vce="Unexpected identifier",Wce="Unexpected reserved word",$ce="Unexpected end of input",mN="Invalid regular expression",A2="Invalid regular expression: missing /",zj="Octal literals are not allowed in strict mode.",zce="Duplicate data property in object literal not allowed in strict mode",br="ILLEGAL",zv="Disabled.",Hce=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Uce=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function ck(n,e){if(!n)throw new Error("ASSERT: "+e)}function $c(n){return n>=48&&n<=57}function $P(n){return"0123456789abcdefABCDEF".indexOf(n)>=0}function Ob(n){return"01234567".indexOf(n)>=0}function jce(n){return n===32||n===9||n===11||n===12||n===160||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(n)>=0}function Hv(n){return n===10||n===13||n===8232||n===8233}function R1(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n===92||n>=128&&Hce.test(String.fromCharCode(n))}function Ax(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57||n===92||n>=128&&Uce.test(String.fromCharCode(n))}const qce={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Hj(){for(;de<Vr;){const n=Ue.charCodeAt(de);if(jce(n)||Hv(n))++de;else break}}function _N(n){var e,t,i,r=0;for(t=n==="u"?4:2,e=0;e<t;++e)de<Vr&&$P(Ue[de])?(i=Ue[de++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):ni({},or,br);return String.fromCharCode(r)}function Gce(){var n,e,t,i;for(n=Ue[de],e=0,n==="}"&&ni({},or,br);de<Vr&&(n=Ue[de++],!!$P(n));)e=e*16+"0123456789abcdef".indexOf(n.toLowerCase());return(e>1114111||n!=="}")&&ni({},or,br),e<=65535?String.fromCharCode(e):(t=(e-65536>>10)+55296,i=(e-65536&1023)+56320,String.fromCharCode(t,i))}function Uj(){var n,e;for(n=Ue.charCodeAt(de++),e=String.fromCharCode(n),n===92&&(Ue.charCodeAt(de)!==117&&ni({},or,br),++de,n=_N("u"),(!n||n==="\\"||!R1(n.charCodeAt(0)))&&ni({},or,br),e=n);de<Vr&&(n=Ue.charCodeAt(de),!!Ax(n));)++de,e+=String.fromCharCode(n),n===92&&(e=e.substr(0,e.length-1),Ue.charCodeAt(de)!==117&&ni({},or,br),++de,n=_N("u"),(!n||n==="\\"||!Ax(n.charCodeAt(0)))&&ni({},or,br),e+=n);return e}function Kce(){var n,e;for(n=de++;de<Vr;){if(e=Ue.charCodeAt(de),e===92)return de=n,Uj();if(Ax(e))++de;else break}return Ue.slice(n,de)}function Zce(){var n,e,t;return n=de,e=Ue.charCodeAt(de)===92?Uj():Kce(),e.length===1?t=Hf:qce.hasOwnProperty(e)?t=sd:e==="null"?t=lk:e==="true"||e==="false"?t=ak:t=Hf,{type:t,value:e,start:n,end:de}}function N2(){var n=de,e=Ue.charCodeAt(de),t,i=Ue[de],r,s,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++de,{type:ws,value:String.fromCharCode(e),start:n,end:de};default:if(t=Ue.charCodeAt(de+1),t===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return de+=2,{type:ws,value:String.fromCharCode(e)+String.fromCharCode(t),start:n,end:de};case 33:case 61:return de+=2,Ue.charCodeAt(de)===61&&++de,{type:ws,value:Ue.slice(n,de),start:n,end:de}}}if(o=Ue.substr(de,4),o===">>>=")return de+=4,{type:ws,value:o,start:n,end:de};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return de+=3,{type:ws,value:s,start:n,end:de};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return de+=2,{type:ws,value:r,start:n,end:de};if(r==="//"&&ni({},or,br),"<>=!+-*%&|^/".indexOf(i)>=0)return++de,{type:ws,value:i,start:n,end:de};ni({},or,br)}function Yce(n){let e="";for(;de<Vr&&$P(Ue[de]);)e+=Ue[de++];return e.length===0&&ni({},or,br),R1(Ue.charCodeAt(de))&&ni({},or,br),{type:kg,value:parseInt("0x"+e,16),start:n,end:de}}function Xce(n){let e="0"+Ue[de++];for(;de<Vr&&Ob(Ue[de]);)e+=Ue[de++];return(R1(Ue.charCodeAt(de))||$c(Ue.charCodeAt(de)))&&ni({},or,br),{type:kg,value:parseInt(e,8),octal:!0,start:n,end:de}}function e8(){var n,e,t;if(t=Ue[de],ck($c(t.charCodeAt(0))||t===".","Numeric literal must start with a decimal digit or a decimal point"),e=de,n="",t!=="."){if(n=Ue[de++],t=Ue[de],n==="0"){if(t==="x"||t==="X")return++de,Yce(e);if(Ob(t))return Xce(e);t&&$c(t.charCodeAt(0))&&ni({},or,br)}for(;$c(Ue.charCodeAt(de));)n+=Ue[de++];t=Ue[de]}if(t==="."){for(n+=Ue[de++];$c(Ue.charCodeAt(de));)n+=Ue[de++];t=Ue[de]}if(t==="e"||t==="E")if(n+=Ue[de++],t=Ue[de],(t==="+"||t==="-")&&(n+=Ue[de++]),$c(Ue.charCodeAt(de)))for(;$c(Ue.charCodeAt(de));)n+=Ue[de++];else ni({},or,br);return R1(Ue.charCodeAt(de))&&ni({},or,br),{type:kg,value:parseFloat(n),start:e,end:de}}function Qce(){var n="",e,t,i,r,s=!1;for(e=Ue[de],ck(e==="'"||e==='"',"String literal must starts with a quote"),t=de,++de;de<Vr;)if(i=Ue[de++],i===e){e="";break}else if(i==="\\")if(i=Ue[de++],!i||!Hv(i.charCodeAt(0)))switch(i){case"u":case"x":Ue[de]==="{"?(++de,n+=Gce()):n+=_N(i);break;case"n":n+=`
`;break;case"r":n+="\r";break;case"t":n+="	";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v";break;default:Ob(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),de<Vr&&Ob(Ue[de])&&(s=!0,r=r*8+"01234567".indexOf(Ue[de++]),"0123".indexOf(i)>=0&&de<Vr&&Ob(Ue[de])&&(r=r*8+"01234567".indexOf(Ue[de++]))),n+=String.fromCharCode(r)):n+=i;break}else i==="\r"&&Ue[de]===`
`&&++de;else{if(Hv(i.charCodeAt(0)))break;n+=i}return e!==""&&ni({},or,br),{type:N1,value:n,octal:s,start:t,end:de}}function Jce(n,e){let t=n;e.indexOf("u")>=0&&(t=t.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";ni({},mN)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(t)}catch{ni({},mN)}try{return new RegExp(n,e)}catch{return null}}function ehe(){var n,e,t,i,r;for(n=Ue[de],ck(n==="/","Regular expression literal must start with a slash"),e=Ue[de++],t=!1,i=!1;de<Vr;)if(n=Ue[de++],e+=n,n==="\\")n=Ue[de++],Hv(n.charCodeAt(0))&&ni({},A2),e+=n;else if(Hv(n.charCodeAt(0)))ni({},A2);else if(t)n==="]"&&(t=!1);else if(n==="/"){i=!0;break}else n==="["&&(t=!0);return i||ni({},A2),r=e.substr(1,e.length-2),{value:r,literal:e}}function the(){var n,e,t;for(e="",t="";de<Vr&&(n=Ue[de],!!Ax(n.charCodeAt(0)));)++de,n==="\\"&&de<Vr?ni({},or,br):(t+=n,e+=n);return t.search(/[^gimuy]/g)>=0&&ni({},mN,t),{value:t,literal:e}}function ihe(){var n,e,t,i;return pi=null,Hj(),n=de,e=ehe(),t=the(),i=Jce(e.value,t.value),{literal:e.literal+t.literal,value:i,regex:{pattern:e.value,flags:t.value},start:n,end:de}}function nhe(n){return n.type===Hf||n.type===sd||n.type===ak||n.type===lk}function jj(){if(Hj(),de>=Vr)return{type:A1,start:de,end:de};const n=Ue.charCodeAt(de);return R1(n)?Zce():n===40||n===41||n===59?N2():n===39||n===34?Qce():n===46?$c(Ue.charCodeAt(de+1))?e8():N2():$c(n)?e8():N2()}function ys(){const n=pi;return de=n.end,pi=jj(),de=n.end,n}function qj(){const n=de;pi=jj(),de=n}function rhe(n){const e=new Ja(kce);return e.elements=n,e}function t8(n,e,t){const i=new Ja(n==="||"||n==="&&"?Nce:Lce);return i.operator=n,i.left=e,i.right=t,i}function she(n,e){const t=new Ja(Ice);return t.callee=n,t.arguments=e,t}function ohe(n,e,t){const i=new Ja(Tce);return i.test=n,i.consequent=e,i.alternate=t,i}function zP(n){const e=new Ja($j);return e.name=n,e}function db(n){const e=new Ja(Ace);return e.value=n.value,e.raw=Ue.slice(n.start,n.end),n.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=n.regex),e}function i8(n,e,t){const i=new Ja(Rce);return i.computed=n==="[",i.object=e,i.property=t,i.computed||(t.member=!0),i}function ahe(n){const e=new Ja(Mce);return e.properties=n,e}function n8(n,e,t){const i=new Ja(Fce);return i.key=e,i.value=t,i.kind=n,i}function lhe(n,e){const t=new Ja(Oce);return t.operator=n,t.argument=e,t.prefix=!0,t}function ni(n,e){var t,i=Array.prototype.slice.call(arguments,2),r=e.replace(/%(\d)/g,(s,o)=>(ck(o<i.length,"Message reference must be in range"),i[o]));throw t=new Error(r),t.index=de,t.description=r,t}function hk(n){n.type===A1&&ni(n,$ce),n.type===kg&&ni(n,Pce),n.type===N1&&ni(n,Bce),n.type===Hf&&ni(n,Vce),n.type===sd&&ni(n,Wce),ni(n,or,n.value)}function Wr(n){const e=ys();(e.type!==ws||e.value!==n)&&hk(e)}function Ui(n){return pi.type===ws&&pi.value===n}function R2(n){return pi.type===sd&&pi.value===n}function che(){const n=[];for(de=pi.start,Wr("[");!Ui("]");)Ui(",")?(ys(),n.push(null)):(n.push(Uf()),Ui("]")||Wr(","));return ys(),rhe(n)}function r8(){de=pi.start;const n=ys();return n.type===N1||n.type===kg?(n.octal&&ni(n,zj),db(n)):zP(n.value)}function hhe(){var n,e,t,i;if(de=pi.start,n=pi,n.type===Hf)return t=r8(),Wr(":"),i=Uf(),n8("init",t,i);if(n.type===A1||n.type===ws)hk(n);else return e=r8(),Wr(":"),i=Uf(),n8("init",e,i)}function uhe(){var n=[],e,t,i,r={},s=String;for(de=pi.start,Wr("{");!Ui("}");)e=hhe(),e.key.type===$j?t=e.key.name:t=s(e.key.value),i="$"+t,Object.prototype.hasOwnProperty.call(r,i)?ni({},zce):r[i]=!0,n.push(e),Ui("}")||Wr(",");return Wr("}"),ahe(n)}function dhe(){Wr("(");const n=HP();return Wr(")"),n}const fhe={if:1};function ghe(){var n,e,t;if(Ui("("))return dhe();if(Ui("["))return che();if(Ui("{"))return uhe();if(n=pi.type,de=pi.start,n===Hf||fhe[pi.value])t=zP(ys().value);else if(n===N1||n===kg)pi.octal&&ni(pi,zj),t=db(ys());else{if(n===sd)throw new Error(zv);n===ak?(e=ys(),e.value=e.value==="true",t=db(e)):n===lk?(e=ys(),e.value=null,t=db(e)):Ui("/")||Ui("/=")?(t=db(ihe()),qj()):hk(ys())}return t}function phe(){const n=[];if(Wr("("),!Ui(")"))for(;de<Vr&&(n.push(Uf()),!Ui(")"));)Wr(",");return Wr(")"),n}function mhe(){de=pi.start;const n=ys();return nhe(n)||hk(n),zP(n.value)}function _he(){return Wr("."),mhe()}function bhe(){Wr("[");const n=HP();return Wr("]"),n}function vhe(){var n,e,t;for(n=ghe();;)if(Ui("."))t=_he(),n=i8(".",n,t);else if(Ui("("))e=phe(),n=she(n,e);else if(Ui("["))t=bhe(),n=i8("[",n,t);else break;return n}function s8(){const n=vhe();if(pi.type===ws&&(Ui("++")||Ui("--")))throw new Error(zv);return n}function gS(){var n,e;if(pi.type!==ws&&pi.type!==sd)e=s8();else{if(Ui("++")||Ui("--"))throw new Error(zv);if(Ui("+")||Ui("-")||Ui("~")||Ui("!"))n=ys(),e=gS(),e=lhe(n.value,e);else{if(R2("delete")||R2("void")||R2("typeof"))throw new Error(zv);e=s8()}}return e}function o8(n){let e=0;if(n.type!==ws&&n.type!==sd)return 0;switch(n.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function whe(){var n,e,t,i,r,s,o,a,l,c;if(n=pi,l=gS(),i=pi,r=o8(i),r===0)return l;for(i.prec=r,ys(),e=[n,pi],o=gS(),s=[l,i,o];(r=o8(pi))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),e.pop(),t=t8(a,l,o),s.push(t);i=ys(),i.prec=r,s.push(i),e.push(pi),t=gS(),s.push(t)}for(c=s.length-1,t=s[c],e.pop();c>1;)e.pop(),t=t8(s[c-1].value,s[c-2],t),c-=2;return t}function Uf(){var n,e,t;return n=whe(),Ui("?")&&(ys(),e=Uf(),Wr(":"),t=Uf(),n=ohe(n,e,t)),n}function HP(){const n=Uf();if(Ui(","))throw new Error(zv);return n}function yhe(n){Ue=n,de=0,Vr=Ue.length,pi=null,qj();const e=HP();if(pi.type!==A1)throw new Error("Unexpect token after expression.");return e}var Che={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function She(n){function e(o,a,l,c){let h=n(a[0]);return l&&(h=l+"("+h+")",l.lastIndexOf("new ",0)===0&&(h="("+h+")")),h+"."+o+(c<0?"":c===0?"()":"("+a.slice(1).map(n).join(",")+")")}function t(o,a,l){return c=>e(o,c,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&cn("Missing arguments to clamp function."),o.length>3&&cn("Too many arguments to clamp function.");const a=o.map(n);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:t("getDate",i,0),day:t("getDay",i,0),year:t("getFullYear",i,0),month:t("getMonth",i,0),hours:t("getHours",i,0),minutes:t("getMinutes",i,0),seconds:t("getSeconds",i,0),milliseconds:t("getMilliseconds",i,0),time:t("getTime",i,0),timezoneoffset:t("getTimezoneOffset",i,0),utcdate:t("getUTCDate",i,0),utcday:t("getUTCDay",i,0),utcyear:t("getUTCFullYear",i,0),utcmonth:t("getUTCMonth",i,0),utchours:t("getUTCHours",i,0),utcminutes:t("getUTCMinutes",i,0),utcseconds:t("getUTCSeconds",i,0),utcmilliseconds:t("getUTCMilliseconds",i,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:s,test:t("test",s),if:function(o){o.length<3&&cn("Missing arguments to if function."),o.length>3&&cn("Too many arguments to if function.");const a=o.map(n);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function xhe(n){const e=n&&n.length-1;return e&&(n[0]==='"'&&n[e]==='"'||n[0]==="'"&&n[e]==="'")?n.slice(1,-1):n}function Ehe(n){n=n||{};const e=n.allowed?Cx(n.allowed):{},t=n.forbidden?Cx(n.forbidden):{},i=n.constants||Che,r=(n.functions||She)(u),s=n.globalvar,o=n.fieldvar,a=Ms(s)?s:g=>`${s}["${g}"]`;let l={},c={},h=0;function u(g){if(un(g))return g;const p=d[g.type];return p==null&&cn("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return h>0?p:Yd(t,p)?cn("Illegal identifier: "+p):Yd(i,p)?i[p]:Yd(e,p)?p:(l[p]=1,a(p))},MemberExpression:g=>{const p=!g.computed,m=u(g.object);p&&(h+=1);const b=u(g.property);return m===o&&(c[xhe(b)]=1),p&&(h-=1),m+(p?"."+b:"["+b+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&cn("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,b=Yd(r,p)&&r[p];return b||cn("Unrecognized function: "+p),Ms(b)?b(m):b+"("+m.map(u).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(u).join(",")+"]",BinaryExpression:g=>"("+u(g.left)+" "+g.operator+" "+u(g.right)+")",UnaryExpression:g=>"("+g.operator+u(g.argument)+")",ConditionalExpression:g=>"("+u(g.test)+"?"+u(g.consequent)+":"+u(g.alternate)+")",LogicalExpression:g=>"("+u(g.left)+g.operator+u(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(u).join(",")+"}",Property:g=>{h+=1;const p=u(g.key);return h-=1,p+":"+u(g.value)}};function f(g){const p={code:u(g),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},p}return f.functions=r,f.constants=i,f}function UP(n,e={}){const t=Ehe({forbidden:[],allowed:["datum"],globalvar:"global",fieldvar:"datum"});try{const i=yhe(n),r=t(i),s=Function("datum","global",`"use strict"; return (${r.code});`),o=a=>s(a,e);return o.fields=r.fields,o}catch(i){throw new Error(`Invalid expression: ${n}, ${i.message}`)}}function dc(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function od(n,e){switch(arguments.length){case 0:break;case 1:{typeof n=="function"?this.interpolator(n):this.range(n);break}default:{this.domain(n),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const bN=Symbol("implicit");function jP(){var n=new Wf,e=[],t=[],i=bN;function r(s){let o=n.get(s);if(o===void 0){if(i!==bN)return i;n.set(s,o=e.push(s)-1)}return t[o%t.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],n=new Wf;for(const o of s)n.has(o)||n.set(o,e.push(o)-1);return r},r.range=function(s){return arguments.length?(t=Array.from(s),r):t.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return jP(e,t).unknown(i)},dc.apply(r,arguments),r}function X_(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function M1(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function ad(){}var jf=.7,t_=1/jf,hm="\\s*([+-]?\\d+)\\s*",Uv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dhe=/^#([0-9a-f]{3,8})$/,khe=new RegExp(`^rgb\\(${hm},${hm},${hm}\\)$`),Lhe=new RegExp(`^rgb\\(${Hl},${Hl},${Hl}\\)$`),Ihe=new RegExp(`^rgba\\(${hm},${hm},${hm},${Uv}\\)$`),The=new RegExp(`^rgba\\(${Hl},${Hl},${Hl},${Uv}\\)$`),Ahe=new RegExp(`^hsl\\(${Uv},${Hl},${Hl}\\)$`),Nhe=new RegExp(`^hsla\\(${Uv},${Hl},${Hl},${Uv}\\)$`),a8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};X_(ad,Pu,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:l8,formatHex:l8,formatHex8:Rhe,formatHsl:Mhe,formatRgb:c8,toString:c8});function l8(){return this.rgb().formatHex()}function Rhe(){return this.rgb().formatHex8()}function Mhe(){return Gj(this).formatHsl()}function c8(){return this.rgb().formatRgb()}function Pu(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=Dhe.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?h8(e):t===3?new ar(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?zy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?zy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=khe.exec(n))?new ar(e[1],e[2],e[3],1):(e=Lhe.exec(n))?new ar(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ihe.exec(n))?zy(e[1],e[2],e[3],e[4]):(e=The.exec(n))?zy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Ahe.exec(n))?f8(e[1],e[2]/100,e[3]/100,1):(e=Nhe.exec(n))?f8(e[1],e[2]/100,e[3]/100,e[4]):a8.hasOwnProperty(n)?h8(a8[n]):n==="transparent"?new ar(NaN,NaN,NaN,0):null}function h8(n){return new ar(n>>16&255,n>>8&255,n&255,1)}function zy(n,e,t,i){return i<=0&&(n=e=t=NaN),new ar(n,e,t,i)}function qP(n){return n instanceof ad||(n=Pu(n)),n?(n=n.rgb(),new ar(n.r,n.g,n.b,n.opacity)):new ar}function Nx(n,e,t,i){return arguments.length===1?qP(n):new ar(n,e,t,i??1)}function ar(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}X_(ar,Nx,M1(ad,{brighter(n){return n=n==null?t_:Math.pow(t_,n),new ar(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?jf:Math.pow(jf,n),new ar(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new ar(yf(this.r),yf(this.g),yf(this.b),Rx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:u8,formatHex:u8,formatHex8:Fhe,formatRgb:d8,toString:d8}));function u8(){return`#${Xd(this.r)}${Xd(this.g)}${Xd(this.b)}`}function Fhe(){return`#${Xd(this.r)}${Xd(this.g)}${Xd(this.b)}${Xd((isNaN(this.opacity)?1:this.opacity)*255)}`}function d8(){const n=Rx(this.opacity);return`${n===1?"rgb(":"rgba("}${yf(this.r)}, ${yf(this.g)}, ${yf(this.b)}${n===1?")":`, ${n})`}`}function Rx(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function yf(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Xd(n){return n=yf(n),(n<16?"0":"")+n.toString(16)}function f8(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Ea(n,e,t,i)}function Gj(n){if(n instanceof Ea)return new Ea(n.h,n.s,n.l,n.opacity);if(n instanceof ad||(n=Pu(n)),!n)return new Ea;if(n instanceof Ea)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,r=Math.min(e,t,i),s=Math.max(e,t,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(t-i)/a+(t<i)*6:t===s?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ea(o,a,l,n.opacity)}function vN(n,e,t,i){return arguments.length===1?Gj(n):new Ea(n,e,t,i??1)}function Ea(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}X_(Ea,vN,M1(ad,{brighter(n){return n=n==null?t_:Math.pow(t_,n),new Ea(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?jf:Math.pow(jf,n),new Ea(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,r=2*t-i;return new ar(M2(n>=240?n-240:n+120,r,i),M2(n,r,i),M2(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new Ea(g8(this.h),Hy(this.s),Hy(this.l),Rx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Rx(this.opacity);return`${n===1?"hsl(":"hsla("}${g8(this.h)}, ${Hy(this.s)*100}%, ${Hy(this.l)*100}%${n===1?")":`, ${n})`}`}}));function g8(n){return n=(n||0)%360,n<0?n+360:n}function Hy(n){return Math.max(0,Math.min(1,n||0))}function M2(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Kj=Math.PI/180,Zj=180/Math.PI,Mx=18,Yj=.96422,Xj=1,Qj=.82521,Jj=4/29,um=6/29,eq=3*um*um,Ohe=um*um*um;function tq(n){if(n instanceof Ul)return new Ul(n.l,n.a,n.b,n.opacity);if(n instanceof ah)return iq(n);n instanceof ar||(n=qP(n));var e=B2(n.r),t=B2(n.g),i=B2(n.b),r=F2((.2225045*e+.7168786*t+.0606169*i)/Xj),s,o;return e===t&&t===i?s=o=r:(s=F2((.4360747*e+.3850649*t+.1430804*i)/Yj),o=F2((.0139322*e+.0971045*t+.7141733*i)/Qj)),new Ul(116*r-16,500*(s-r),200*(r-o),n.opacity)}function wN(n,e,t,i){return arguments.length===1?tq(n):new Ul(n,e,t,i??1)}function Ul(n,e,t,i){this.l=+n,this.a=+e,this.b=+t,this.opacity=+i}X_(Ul,wN,M1(ad,{brighter(n){return new Ul(this.l+Mx*(n??1),this.a,this.b,this.opacity)},darker(n){return new Ul(this.l-Mx*(n??1),this.a,this.b,this.opacity)},rgb(){var n=(this.l+16)/116,e=isNaN(this.a)?n:n+this.a/500,t=isNaN(this.b)?n:n-this.b/200;return e=Yj*O2(e),n=Xj*O2(n),t=Qj*O2(t),new ar(P2(3.1338561*e-1.6168667*n-.4906146*t),P2(-.9787684*e+1.9161415*n+.033454*t),P2(.0719453*e-.2289914*n+1.4052427*t),this.opacity)}}));function F2(n){return n>Ohe?Math.pow(n,1/3):n/eq+Jj}function O2(n){return n>um?n*n*n:eq*(n-Jj)}function P2(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function B2(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Phe(n){if(n instanceof ah)return new ah(n.h,n.c,n.l,n.opacity);if(n instanceof Ul||(n=tq(n)),n.a===0&&n.b===0)return new ah(NaN,0<n.l&&n.l<100?0:NaN,n.l,n.opacity);var e=Math.atan2(n.b,n.a)*Zj;return new ah(e<0?e+360:e,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity)}function yN(n,e,t,i){return arguments.length===1?Phe(n):new ah(n,e,t,i??1)}function ah(n,e,t,i){this.h=+n,this.c=+e,this.l=+t,this.opacity=+i}function iq(n){if(isNaN(n.h))return new Ul(n.l,0,0,n.opacity);var e=n.h*Kj;return new Ul(n.l,Math.cos(e)*n.c,Math.sin(e)*n.c,n.opacity)}X_(ah,yN,M1(ad,{brighter(n){return new ah(this.h,this.c,this.l+Mx*(n??1),this.opacity)},darker(n){return new ah(this.h,this.c,this.l-Mx*(n??1),this.opacity)},rgb(){return iq(this).rgb()}}));var nq=-.14861,GP=1.78277,KP=-.29227,uk=-.90649,jv=1.97294,p8=jv*uk,m8=jv*GP,_8=GP*KP-uk*nq;function Bhe(n){if(n instanceof Cf)return new Cf(n.h,n.s,n.l,n.opacity);n instanceof ar||(n=qP(n));var e=n.r/255,t=n.g/255,i=n.b/255,r=(_8*i+p8*e-m8*t)/(_8+p8-m8),s=i-r,o=(jv*(t-r)-KP*s)/uk,a=Math.sqrt(o*o+s*s)/(jv*r*(1-r)),l=a?Math.atan2(o,s)*Zj-120:NaN;return new Cf(l<0?l+360:l,a,r,n.opacity)}function CN(n,e,t,i){return arguments.length===1?Bhe(n):new Cf(n,e,t,i??1)}function Cf(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}X_(Cf,CN,M1(ad,{brighter(n){return n=n==null?t_:Math.pow(t_,n),new Cf(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?jf:Math.pow(jf,n),new Cf(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=isNaN(this.h)?0:(this.h+120)*Kj,e=+this.l,t=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(n),r=Math.sin(n);return new ar(255*(e+t*(nq*i+GP*r)),255*(e+t*(KP*i+uk*r)),255*(e+t*(jv*i)),this.opacity)}}));function rq(n,e,t,i,r){var s=n*n,o=s*n;return((1-3*n+3*s-o)*e+(4-6*s+3*o)*t+(1+3*n+3*s-3*o)*i+o*r)/6}function sq(n){var e=n.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,e-1):Math.floor(t*e),r=n[i],s=n[i+1],o=i>0?n[i-1]:2*r-s,a=i<e-1?n[i+2]:2*s-r;return rq((t-i/e)*e,o,r,s,a)}}function oq(n){var e=n.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*e),r=n[(i+e-1)%e],s=n[i%e],o=n[(i+1)%e],a=n[(i+2)%e];return rq((t-i/e)*e,r,s,o,a)}}const dk=n=>()=>n;function aq(n,e){return function(t){return n+t*e}}function Vhe(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function fk(n,e){var t=e-n;return t?aq(n,t>180||t<-180?t-360*Math.round(t/360):t):dk(isNaN(n)?e:n)}function Whe(n){return(n=+n)==1?lr:function(e,t){return t-e?Vhe(e,t,n):dk(isNaN(e)?t:e)}}function lr(n,e){var t=e-n;return t?aq(n,t):dk(isNaN(n)?e:n)}const SN=function n(e){var t=Whe(e);function i(r,s){var o=t((r=Nx(r)).r,(s=Nx(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),c=lr(r.opacity,s.opacity);return function(h){return r.r=o(h),r.g=a(h),r.b=l(h),r.opacity=c(h),r+""}}return i.gamma=n,i}(1);function lq(n){return function(e){var t=e.length,i=new Array(t),r=new Array(t),s=new Array(t),o,a;for(o=0;o<t;++o)a=Nx(e[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=n(i),r=n(r),s=n(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var $he=lq(sq),zhe=lq(oq);function ZP(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),r;return function(s){for(r=0;r<t;++r)i[r]=n[r]*(1-s)+e[r]*s;return i}}function cq(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Hhe(n,e){return(cq(e)?ZP:hq)(n,e)}function hq(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,r=new Array(i),s=new Array(t),o;for(o=0;o<i;++o)r[o]=ld(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function uq(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function Ca(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function dq(n,e){var t={},i={},r;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in n?t[r]=ld(n[r],e[r]):i[r]=e[r];return function(s){for(r in t)i[r]=t[r](s);return i}}var xN=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,V2=new RegExp(xN.source,"g");function Uhe(n){return function(){return n}}function jhe(n){return function(e){return n(e)+""}}function fq(n,e){var t=xN.lastIndex=V2.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(i=xN.exec(n))&&(r=V2.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Ca(i,r)})),t=V2.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?jhe(l[0].x):Uhe(e):(e=l.length,function(c){for(var h=0,u;h<e;++h)a[(u=l[h]).i]=u.x(c);return a.join("")})}function ld(n,e){var t=typeof e,i;return e==null||t==="boolean"?dk(e):(t==="number"?Ca:t==="string"?(i=Pu(e))?(e=i,SN):fq:e instanceof Pu?SN:e instanceof Date?uq:cq(e)?ZP:Array.isArray(e)?hq:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?dq:Ca)(n,e)}function qhe(n){var e=n.length;return function(t){return n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}}function Ghe(n,e){var t=fk(+n,+e);return function(i){var r=t(i);return r-360*Math.floor(r/360)}}function F1(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var b8=180/Math.PI,EN={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gq(n,e,t,i,r,s){var o,a,l;return(o=Math.sqrt(n*n+e*e))&&(n/=o,e/=o),(l=n*t+e*i)&&(t-=n*l,i-=e*l),(a=Math.sqrt(t*t+i*i))&&(t/=a,i/=a,l/=a),n*i<e*t&&(n=-n,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,n)*b8,skewX:Math.atan(l)*b8,scaleX:o,scaleY:a}}var Uy;function Khe(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?EN:gq(e.a,e.b,e.c,e.d,e.e,e.f)}function Zhe(n){return n==null||(Uy||(Uy=document.createElementNS("http://www.w3.org/2000/svg","g")),Uy.setAttribute("transform",n),!(n=Uy.transform.baseVal.consolidate()))?EN:(n=n.matrix,gq(n.a,n.b,n.c,n.d,n.e,n.f))}function pq(n,e,t,i){function r(c){return c.length?c.pop()+" ":""}function s(c,h,u,d,f,g){if(c!==u||h!==d){var p=f.push("translate(",null,e,null,t);g.push({i:p-4,x:Ca(c,u)},{i:p-2,x:Ca(h,d)})}else(u||d)&&f.push("translate("+u+e+d+t)}function o(c,h,u,d){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),d.push({i:u.push(r(u)+"rotate(",null,i)-2,x:Ca(c,h)})):h&&u.push(r(u)+"rotate("+h+i)}function a(c,h,u,d){c!==h?d.push({i:u.push(r(u)+"skewX(",null,i)-2,x:Ca(c,h)}):h&&u.push(r(u)+"skewX("+h+i)}function l(c,h,u,d,f,g){if(c!==u||h!==d){var p=f.push(r(f)+"scale(",null,",",null,")");g.push({i:p-4,x:Ca(c,u)},{i:p-2,x:Ca(h,d)})}else(u!==1||d!==1)&&f.push(r(f)+"scale("+u+","+d+")")}return function(c,h){var u=[],d=[];return c=n(c),h=n(h),s(c.translateX,c.translateY,h.translateX,h.translateY,u,d),o(c.rotate,h.rotate,u,d),a(c.skewX,h.skewX,u,d),l(c.scaleX,c.scaleY,h.scaleX,h.scaleY,u,d),c=h=null,function(f){for(var g=-1,p=d.length,m;++g<p;)u[(m=d[g]).i]=m.x(f);return u.join("")}}}var Yhe=pq(Khe,"px, ","px)","deg)"),Xhe=pq(Zhe,", ",")",")"),Qhe=1e-12;function v8(n){return((n=Math.exp(n))+1/n)/2}function Jhe(n){return((n=Math.exp(n))-1/n)/2}function eue(n){return((n=Math.exp(2*n))-1)/(n+1)}const tue=function n(e,t,i){function r(s,o){var a=s[0],l=s[1],c=s[2],h=o[0],u=o[1],d=o[2],f=h-a,g=u-l,p=f*f+g*g,m,b;if(p<Qhe)b=Math.log(d/c)/e,m=function(C){return[a+C*f,l+C*g,c*Math.exp(e*C*b)]};else{var _=Math.sqrt(p),w=(d*d-c*c+i*p)/(2*c*t*_),y=(d*d-c*c-i*p)/(2*d*t*_),S=Math.log(Math.sqrt(w*w+1)-w),k=Math.log(Math.sqrt(y*y+1)-y);b=(k-S)/e,m=function(C){var D=C*b,E=v8(S),N=c/(t*_)*(E*eue(e*D+S)-Jhe(S));return[a+N*f,l+N*g,c*E/v8(e*D+S)]}}return m.duration=b*1e3*e/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return n(o,a,l)},r}(Math.SQRT2,2,4);function mq(n){return function(e,t){var i=n((e=vN(e)).h,(t=vN(t)).h),r=lr(e.s,t.s),s=lr(e.l,t.l),o=lr(e.opacity,t.opacity);return function(a){return e.h=i(a),e.s=r(a),e.l=s(a),e.opacity=o(a),e+""}}}const iue=mq(fk);var nue=mq(lr);function rue(n,e){var t=lr((n=wN(n)).l,(e=wN(e)).l),i=lr(n.a,e.a),r=lr(n.b,e.b),s=lr(n.opacity,e.opacity);return function(o){return n.l=t(o),n.a=i(o),n.b=r(o),n.opacity=s(o),n+""}}function _q(n){return function(e,t){var i=n((e=yN(e)).h,(t=yN(t)).h),r=lr(e.c,t.c),s=lr(e.l,t.l),o=lr(e.opacity,t.opacity);return function(a){return e.h=i(a),e.c=r(a),e.l=s(a),e.opacity=o(a),e+""}}}const sue=_q(fk);var oue=_q(lr);function bq(n){return function e(t){t=+t;function i(r,s){var o=n((r=CN(r)).h,(s=CN(s)).h),a=lr(r.s,s.s),l=lr(r.l,s.l),c=lr(r.opacity,s.opacity);return function(h){return r.h=o(h),r.s=a(h),r.l=l(Math.pow(h,t)),r.opacity=c(h),r+""}}return i.gamma=e,i}(1)}const aue=bq(fk);var lue=bq(lr);function YP(n,e){e===void 0&&(e=n,n=ld);for(var t=0,i=e.length-1,r=e[0],s=new Array(i<0?0:i);t<i;)s[t]=n(r,r=e[++t]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function cue(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n(i/(e-1));return t}const hue=Object.freeze(Object.defineProperty({__proto__:null,interpolate:ld,interpolateArray:Hhe,interpolateBasis:sq,interpolateBasisClosed:oq,interpolateCubehelix:aue,interpolateCubehelixLong:lue,interpolateDate:uq,interpolateDiscrete:qhe,interpolateHcl:sue,interpolateHclLong:oue,interpolateHsl:iue,interpolateHslLong:nue,interpolateHue:Ghe,interpolateLab:rue,interpolateNumber:Ca,interpolateNumberArray:ZP,interpolateObject:dq,interpolateRgb:SN,interpolateRgbBasis:$he,interpolateRgbBasisClosed:zhe,interpolateRound:F1,interpolateString:fq,interpolateTransformCss:Yhe,interpolateTransformSvg:Xhe,interpolateZoom:tue,piecewise:YP,quantize:cue},Symbol.toStringTag,{value:"Module"}));function uue(n){return function(){return n}}function DN(n){return+n}var w8=[0,1];function Es(n){return n}function kN(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:uue(isNaN(e)?NaN:.5)}function due(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function fue(n,e,t){var i=n[0],r=n[1],s=e[0],o=e[1];return r<i?(i=kN(r,i),s=t(o,s)):(i=kN(i,r),s=t(s,o)),function(a){return s(i(a))}}function gue(n,e,t){var i=Math.min(n.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=kN(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=Y_(n,a,1,i)-1;return s[l](r[l](a))}}function O1(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function gk(){var n=w8,e=w8,t=ld,i,r,s,o=Es,a,l,c;function h(){var d=Math.min(n.length,e.length);return o!==Es&&(o=due(n[0],n[d-1])),a=d>2?gue:fue,l=c=null,u}function u(d){return d==null||isNaN(d=+d)?s:(l||(l=a(n.map(i),e,t)))(i(o(d)))}return u.invert=function(d){return o(r((c||(c=a(e,n.map(i),Ca)))(d)))},u.domain=function(d){return arguments.length?(n=Array.from(d,DN),h()):n.slice()},u.range=function(d){return arguments.length?(e=Array.from(d),h()):e.slice()},u.rangeRound=function(d){return e=Array.from(d),t=F1,h()},u.clamp=function(d){return arguments.length?(o=d?!0:Es,h()):o!==Es},u.interpolate=function(d){return arguments.length?(t=d,h()):t},u.unknown=function(d){return arguments.length?(s=d,u):s},function(d,f){return i=d,r=f,h()}}function vq(){return gk()(Es,Es)}function wq(n,e,t,i){var r=$f(n,e,t),s;switch(i=Mu(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(s=bj(r,o))&&(i.precision=s),DP(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=vj(r,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=_j(r))&&(i.precision=s-(i.type==="%")*2);break}}return Cr(i)}function Lg(n){var e=n.domain;return n.ticks=function(t){var i=e();return Sx(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var r=e();return wq(r[0],r[r.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),r=0,s=i.length-1,o=i[r],a=i[s],l,c,h=10;for(a<o&&(c=o,o=a,a=c,c=r,r=s,s=c);h-- >0;){if(c=gj(o,a,t),c===l)return i[r]=o,i[s]=a,e(i);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return n},n}function yq(){var n=vq();return n.copy=function(){return O1(n,yq())},dc.apply(n,arguments),Lg(n)}function Cq(n){var e;function t(i){return i==null||isNaN(i=+i)?e:i}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=Array.from(i,DN),t):n.slice()},t.unknown=function(i){return arguments.length?(e=i,t):e},t.copy=function(){return Cq(n).unknown(e)},n=arguments.length?Array.from(n,DN):[0,1],Lg(t)}function Sq(n,e){n=n.slice();var t=0,i=n.length-1,r=n[t],s=n[i],o;return s<r&&(o=t,t=i,i=o,o=r,r=s,s=o),n[t]=e.floor(r),n[i]=e.ceil(s),n}function y8(n){return Math.log(n)}function C8(n){return Math.exp(n)}function pue(n){return-Math.log(-n)}function mue(n){return-Math.exp(-n)}function _ue(n){return isFinite(n)?+("1e"+n):n<0?0:n}function bue(n){return n===10?_ue:n===Math.E?Math.exp:e=>Math.pow(n,e)}function vue(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function S8(n){return(e,t)=>-n(-e,t)}function XP(n){const e=n(y8,C8),t=e.domain;let i=10,r,s;function o(){return r=vue(i),s=bue(i),t()[0]<0?(r=S8(r),s=S8(s),n(pue,mue)):n(y8,C8),e}return e.base=function(a){return arguments.length?(i=+a,o()):i},e.domain=function(a){return arguments.length?(t(a),o()):t()},e.ticks=a=>{const l=t();let c=l[0],h=l[l.length-1];const u=h<c;u&&([c,h]=[h,c]);let d=r(c),f=r(h),g,p;const m=a==null?10:+a;let b=[];if(!(i%1)&&f-d<m){if(d=Math.floor(d),f=Math.ceil(f),c>0){for(;d<=f;++d)for(g=1;g<i;++g)if(p=d<0?g/s(-d):g*s(d),!(p<c)){if(p>h)break;b.push(p)}}else for(;d<=f;++d)for(g=i-1;g>=1;--g)if(p=d>0?g/s(-d):g*s(d),!(p<c)){if(p>h)break;b.push(p)}b.length*2<m&&(b=Sx(c,h,m))}else b=Sx(d,f,Math.min(f-d,m)).map(s);return u?b.reverse():b},e.tickFormat=(a,l)=>{if(a==null&&(a=10),l==null&&(l=i===10?"s":","),typeof l!="function"&&(!(i%1)&&(l=Mu(l)).precision==null&&(l.trim=!0),l=Cr(l)),a===1/0)return l;const c=Math.max(1,i*a/e.ticks().length);return h=>{let u=h/s(Math.round(r(h)));return u*i<i-.5&&(u*=i),u<=c?l(h):""}},e.nice=()=>t(Sq(t(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),e}function QP(){const n=XP(gk()).domain([1,10]);return n.copy=()=>O1(n,QP()).base(n.base()),dc.apply(n,arguments),n}function x8(n){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/n))}}function E8(n){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*n}}function JP(n){var e=1,t=n(x8(e),E8(e));return t.constant=function(i){return arguments.length?n(x8(e=+i),E8(e)):e},Lg(t)}function xq(){var n=JP(gk());return n.copy=function(){return O1(n,xq()).constant(n.constant())},dc.apply(n,arguments)}function D8(n){return function(e){return e<0?-Math.pow(-e,n):Math.pow(e,n)}}function wue(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function yue(n){return n<0?-n*n:n*n}function e4(n){var e=n(Es,Es),t=1;function i(){return t===1?n(Es,Es):t===.5?n(wue,yue):n(D8(t),D8(1/t))}return e.exponent=function(r){return arguments.length?(t=+r,i()):t},Lg(e)}function t4(){var n=e4(gk());return n.copy=function(){return O1(n,t4()).exponent(n.exponent())},dc.apply(n,arguments),n}function Cue(){return t4.apply(null,arguments).exponent(.5)}function Eq(){var n=[],e=[],t=[],i;function r(){var o=0,a=Math.max(1,e.length);for(t=new Array(a-1);++o<a;)t[o-1]=pj(n,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:e[Y_(t,o)]}return s.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?t[a-1]:n[0],a<t.length?t[a]:n[n.length-1]]},s.domain=function(o){if(!arguments.length)return n.slice();n=[];for(let a of o)a!=null&&!isNaN(a=+a)&&n.push(a);return n.sort(Fb),r()},s.range=function(o){return arguments.length?(e=Array.from(o),r()):e.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return t.slice()},s.copy=function(){return Eq().domain(n).range(e).unknown(i)},dc.apply(s,arguments)}function Dq(){var n=0,e=1,t=1,i=[.5],r=[0,1],s;function o(l){return l!=null&&l<=l?r[Y_(i,l,0,t)]:s}function a(){var l=-1;for(i=new Array(t);++l<t;)i[l]=((l+1)*e-(l-t)*n)/(t+1);return o}return o.domain=function(l){return arguments.length?([n,e]=l,n=+n,e=+e,a()):[n,e]},o.range=function(l){return arguments.length?(t=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var c=r.indexOf(l);return c<0?[NaN,NaN]:c<1?[n,i[0]]:c>=t?[i[t-1],e]:[i[c-1],i[c]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return Dq().domain([n,e]).range(r).unknown(s)},dc.apply(Lg(o),arguments)}function kq(){var n=[.5],e=[0,1],t,i=1;function r(s){return s!=null&&s<=s?e[Y_(n,s,0,i)]:t}return r.domain=function(s){return arguments.length?(n=Array.from(s),i=Math.min(n.length,e.length-1),r):n.slice()},r.range=function(s){return arguments.length?(e=Array.from(s),i=Math.min(n.length,e.length-1),r):e.slice()},r.invertExtent=function(s){var o=e.indexOf(s);return[n[o-1],n[o]]},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return kq().domain(n).range(e).unknown(t)},dc.apply(r,arguments)}function Sue(n){return new Date(n)}function xue(n){return n instanceof Date?+n:+new Date(+n)}function i4(n,e,t,i,r,s,o,a,l,c){var h=vq(),u=h.invert,d=h.domain,f=c(".%L"),g=c(":%S"),p=c("%I:%M"),m=c("%I %p"),b=c("%a %d"),_=c("%b %d"),w=c("%B"),y=c("%Y");function S(k){return(l(k)<k?f:a(k)<k?g:o(k)<k?p:s(k)<k?m:i(k)<k?r(k)<k?b:_:t(k)<k?w:y)(k)}return h.invert=function(k){return new Date(u(k))},h.domain=function(k){return arguments.length?d(Array.from(k,xue)):d().map(Sue)},h.ticks=function(k){var C=d();return n(C[0],C[C.length-1],k??10)},h.tickFormat=function(k,C){return C==null?S:c(C)},h.nice=function(k){var C=d();return(!k||typeof k.range!="function")&&(k=e(C[0],C[C.length-1],k??10)),k?d(Sq(C,k)):h},h.copy=function(){return O1(h,i4(n,e,t,i,r,s,o,a,l,c))},h}function Eue(){return dc.apply(i4(Lae,Iae,Fu,kx,L1,vf,TP,IP,lu,OP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Due(){return dc.apply(i4(Dae,kae,Ou,Ix,I1,wf,RP,NP,lu,PP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function pk(){var n=0,e=1,t,i,r,s,o=Es,a=!1,l;function c(u){return u==null||isNaN(u=+u)?l:o(r===0?.5:(u=(s(u)-t)*r,a?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([n,e]=u,t=s(n=+n),i=s(e=+e),r=t===i?0:1/(i-t),c):[n,e]},c.clamp=function(u){return arguments.length?(a=!!u,c):a},c.interpolator=function(u){return arguments.length?(o=u,c):o};function h(u){return function(d){var f,g;return arguments.length?([f,g]=d,o=u(f,g),c):[o(0),o(1)]}}return c.range=h(ld),c.rangeRound=h(F1),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return s=u,t=u(n),i=u(e),r=t===i?0:1/(i-t),c}}function cd(n,e){return e.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function n4(){var n=Lg(pk()(Es));return n.copy=function(){return cd(n,n4())},od.apply(n,arguments)}function Lq(){var n=XP(pk()).domain([1,10]);return n.copy=function(){return cd(n,Lq()).base(n.base())},od.apply(n,arguments)}function Iq(){var n=JP(pk());return n.copy=function(){return cd(n,Iq()).constant(n.constant())},od.apply(n,arguments)}function r4(){var n=e4(pk());return n.copy=function(){return cd(n,r4()).exponent(n.exponent())},od.apply(n,arguments)}function kue(){return r4.apply(null,arguments).exponent(.5)}function mk(){var n=0,e=.5,t=1,i=1,r,s,o,a,l,c=Es,h,u=!1,d;function f(p){return isNaN(p=+p)?d:(p=.5+((p=+h(p))-s)*(i*p<i*s?a:l),c(u?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([n,e,t]=p,r=h(n=+n),s=h(e=+e),o=h(t=+t),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,f):[n,e,t]},f.clamp=function(p){return arguments.length?(u=!!p,f):u},f.interpolator=function(p){return arguments.length?(c=p,f):c};function g(p){return function(m){var b,_,w;return arguments.length?([b,_,w]=m,c=YP(p,[b,_,w]),f):[c(0),c(.5),c(1)]}}return f.range=g(ld),f.rangeRound=g(F1),f.unknown=function(p){return arguments.length?(d=p,f):d},function(p){return h=p,r=p(n),s=p(e),o=p(t),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,f}}function Tq(){var n=Lg(mk()(Es));return n.copy=function(){return cd(n,Tq())},od.apply(n,arguments)}function Aq(){var n=XP(mk()).domain([.1,1,10]);return n.copy=function(){return cd(n,Aq()).base(n.base())},od.apply(n,arguments)}function Nq(){var n=JP(mk());return n.copy=function(){return cd(n,Nq()).constant(n.constant())},od.apply(n,arguments)}function s4(){var n=e4(mk());return n.copy=function(){return cd(n,s4()).exponent(n.exponent())},od.apply(n,arguments)}function Lue(){return s4.apply(null,arguments).exponent(.5)}function o4(n,e,t){const i=n-e+t*2;return n?i>0?i:1:0}const Iue="identity",i_="linear",Bu="log",P1="pow",B1="sqrt",_k="symlog",Rq="time",Mq="utc",jl="sequential",Q_="diverging",LN="quantile",Fq="quantize",Oq="threshold",a4="ordinal",IN="point",Pq="band",l4="bin-ordinal",Xn="continuous",V1="discrete",W1="discretizing",aa="interpolating",Bq="temporal";function Tue(n){return function(e){let t=e[0],i=e[1],r;return i<t&&(r=t,t=i,i=r),[n.invert(t),n.invert(i)]}}function Aue(n){return function(e){const t=n.range();let i=e[0],r=e[1],s=-1,o,a,l,c;for(r<i&&(a=i,i=r,r=a),l=0,c=t.length;l<c;++l)t[l]>=i&&t[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=n.invertExtent(t[s]),r=n.invertExtent(t[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function c4(){const n=jP().unknown(void 0),e=n.domain,t=n.range;let i=[0,1],r,s,o=!1,a=0,l=0,c=.5;delete n.unknown;function h(){const u=e().length,d=i[1]<i[0],f=i[1-d],g=o4(u,a,l);let p=i[d-0];r=(f-p)/(g||1),o&&(r=Math.floor(r)),p+=(f-p-r*(u-a))*c,s=r*(1-a),o&&(p=Math.round(p),s=Math.round(s));const m=Rv(u).map(b=>p+r*b);return t(d?m.reverse():m)}return n.domain=function(u){return arguments.length?(e(u),h()):e()},n.range=function(u){return arguments.length?(i=[+u[0],+u[1]],h()):i.slice()},n.rangeRound=function(u){return i=[+u[0],+u[1]],o=!0,h()},n.bandwidth=function(){return s},n.step=function(){return r},n.round=function(u){return arguments.length?(o=!!u,h()):o},n.padding=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),a=l,h()):a},n.paddingInner=function(u){return arguments.length?(a=Math.max(0,Math.min(1,u)),h()):a},n.paddingOuter=function(u){return arguments.length?(l=Math.max(0,Math.min(1,u)),h()):l},n.align=function(u){return arguments.length?(c=Math.max(0,Math.min(1,u)),h()):c},n.invertRange=function(u){if(u[0]==null||u[1]==null)return;const d=i[1]<i[0],f=d?t().reverse():t(),g=f.length-1;let p=+u[0],m=+u[1],b,_,w;if(!(p!==p||m!==m)&&(m<p&&(w=p,p=m,m=w),!(m<f[0]||p>i[1-d])))return b=Math.max(0,hN(f,p)-1),_=p===m?b:hN(f,m)-1,p-f[b]>s+1e-10&&++b,d&&(w=b,b=g-_,_=g-w),b>_?void 0:e().slice(b,_+1)},n.invert=function(u){const d=n.invertRange([u,u]);return d&&d[0]},n.copy=function(){return c4().domain(e()).range(i).round(o).paddingInner(a).paddingOuter(l).align(c)},h()}function Vq(n){const e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,n.copy=function(){return Vq(e())},n}function Nue(){return Vq(c4().paddingInner(1))}var Rue=Array.prototype.map;function Mue(n){return Rue.call(n,Nv)}const Fue=Array.prototype.slice;function Wq(){let n=[],e=[];function t(i){return i==null||i!==i?void 0:e[(Y_(n,i)-1)%e.length]}return t.domain=function(i){return arguments.length?(n=Mue(i),t):n.slice()},t.range=function(i){return arguments.length?(e=Fue.call(i),t):e.slice()},t.tickFormat=function(i,r){return wq(n[0],$a(n),i??10,r)},t.copy=function(){return Wq().domain(t.domain()).range(t.range())},t}const Fx={};function Oue(n,e,t){const i=function(){const s=e();return s.invertRange||(s.invertRange=s.invert?Tue(s):s.invertExtent?Aue(s):void 0),s.type=n,s};return i.metadata=Cx(cN(t)),i}function di(n,e,t){return arguments.length>1?(Fx[n]=Oue(n,e,t),this):Pue(n)?Fx[n]:void 0}di(Iue,Cq);di(i_,yq,Xn);di(Bu,QP,[Xn,Bu]);di(P1,t4,Xn);di(B1,Cue,Xn);di(_k,xq,Xn);di(Rq,Eue,[Xn,Bq]);di(Mq,Due,[Xn,Bq]);di(jl,n4,[Xn,aa]);di("".concat(jl,"-").concat(i_),n4,[Xn,aa]);di("".concat(jl,"-").concat(Bu),Lq,[Xn,aa,Bu]);di("".concat(jl,"-").concat(P1),r4,[Xn,aa]);di("".concat(jl,"-").concat(B1),kue,[Xn,aa]);di("".concat(jl,"-").concat(_k),Iq,[Xn,aa]);di("".concat(Q_,"-").concat(i_),Tq,[Xn,aa]);di("".concat(Q_,"-").concat(Bu),Aq,[Xn,aa,Bu]);di("".concat(Q_,"-").concat(P1),s4,[Xn,aa]);di("".concat(Q_,"-").concat(B1),Lue,[Xn,aa]);di("".concat(Q_,"-").concat(_k),Nq,[Xn,aa]);di(LN,Eq,[W1,LN]);di(Fq,Dq,W1);di(Oq,kq,W1);di(l4,Wq,[V1,W1]);di(a4,jP,V1);di(Pq,c4,V1);di(IN,Nue,V1);function Pue(n){return Yd(Fx,n)}function $1(n,e){const t=Fx[n];return t&&t.metadata[e]}function Pr(n){return $1(n,Xn)}function Vu(n){return $1(n,V1)}function Mp(n){return $1(n,W1)}function $q(n){return $1(n,Bu)}function bk(n){return $1(n,aa)}function Bue(n,e){const t=e[0],i=$a(e)-t;return function(r){return n(t+r*i)}}function vk(n,e,t){return YP(zq(e||"rgb",t),n)}function Vue(n,e){const t=new Array(e),i=e+1;for(let r=0;r<e;)t[r]=n(++r/i);return t}function zq(n,e){const t=hue[Wue(n)];return e!=null&&t&&t.gamma?t.gamma(e):t}function Wue(n){return"interpolate"+n.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")}const $ue={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},zue={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Hq(n){const e=n.length/6|0,t=new Array(e);for(let i=0;i<e;)t[i]="#"+n.slice(i*6,++i*6);return t}function Uq(n,e){for(const t in n)h4(t,e(n[t]))}const k8={};Uq(zue,Hq);Uq($ue,n=>vk(Hq(n)));function h4(n,e){return n=n&&n.toLowerCase(),arguments.length>1?(k8[n]=e,this):k8[n]}function Hue(){let n=0;const e=new Map,t=i=>{let r=e.get(i);return r===void 0&&(r=n++,e.set(i,r)),r};return t.addAll=i=>{for(const r of i)t(r)},t.invert=i=>{for(const r of e.entries())if(r[1]==i)return r[0]},t.domain=()=>[...e.keys()],t}function wk(){const n=e=>e;return n.invert=e=>e,n.copy=wk,n.invertRange=()=>{},n.type="null",n}function Uue(n,e){const t={};e||(e=n.encoding);for(const[i,r]of Object.entries(e)){if(!r)continue;const s=(($o(r)&&r.resolutionChannel)??(xf(i)&&i))||void 0,o=n.unitView.getScaleResolution(s);t[i]=jue(e[i],o==null?void 0:o.getScale(),n.unitView.getAccessor(i),i)}return t}function jue(n,e,t,i){let r;if(za(n)){const s=n.value;r=o=>s,r.constant=!0,r.constantValue=!0,r.accessor=void 0}else if(t)if(i=="text")r=s=>{},r.accessor=t,r.constant=t.constant;else{if(!e)if(!xf(i))e=wk();else throw new Error(`Missing scale! "${i}": ${JSON.stringify(n)}`);if(r=s=>e(t(s)),Vu(e.type)){const s=Hue();s.addAll(e.domain()),r.indexer=s}r.constant=t.constant,r.accessor=t,r.scale=e}else throw new Error(`Missing value or accessor (field, expr, datum) on channel "${i}": ${JSON.stringify(n)}`);return r.invert=e?s=>e.invert(s):s=>{throw new Error("No scale available, cannot invert: "+JSON.stringify(n))},r.channelDef=n,r.applyMetadata=s=>{for(const o in r)o in r&&(s[o]=r[o]);return s},r}function za(n){return n&&"value"in n}function z1(n){return n&&"field"in n}function H1(n){return n&&"datum"in n}function $o(n){return z1(n)||H1(n)||u4(n)||jq(n)}function TN(n,e){const t=n.mark.encoding[e];if($o(t))return t;throw new Error("Not a channel def with scale!")}function jq(n){return n&&"chrom"in n}function u4(n){return n&&"expr"in n}const J_=["x","y"],que=["x2","y2"],Gue=[...J_,...que];function qq(n){return J_.includes(n)}function qv(n){return Gue.includes(n)}const d4={x:"x2",y:"y2"},Gq=Object.fromEntries(Object.entries(d4).map(n=>[n[1],n[0]]));function Pb(n){return n in Gq}function Kue(n){const e=d4[n];if(e)return e;throw new Error(`${n} has no secondary channel!`)}function qf(n){return Gq[n]??n}function Sf(n){return["color","fill","stroke"].includes(qf(n))}function yk(n){return["shape","squeeze"].includes(n)}function xf(n){return["x","y","x2","y2","color","fill","stroke","opacity","fillOpacity","strokeOpacity","strokeWidth","size","shape","angle","dx","dy","sample"].includes(n)}function Kq(n){switch(n){case"shape":return["circle","square","triangle-up","cross","diamond","triangle-down","triangle-right","triangle-left"]}}function Zq(n){if(!yk(n))throw new Error("Not a discrete channel: "+n);const e=new Map(Kq(n).map((t,i)=>[t,i]));return t=>{const i=e.get(t);if(i!==void 0)return i;throw new Error(`Invalid value for "${n}" channel: ${t}`)}}function Ii(n,e=n){if(/^[A-Za-z0-9_]+$/.test(n)){const t=new Function("datum",`return datum[${JSON.stringify(n)}]`);return rd(t,[n],e)}else return XD(n)}class Zue{constructor(){this.accessorCreators=[],this.register(e=>{if(z1(e))try{const t=Ii(e.field);return t.constant=!1,t.fields=tj(t),t}catch(t){throw new Error(`Invalid field definition: ${t.message}`)}}),this.register(e=>u4(e)?Yue(e.expr):void 0),this.register(e=>{if(H1(e)){const i=Foe(e.datum);return i.constant=!0,i.fields=[],i}})}register(e){this.accessorCreators.push(e)}createAccessor(e){for(const t of this.accessorCreators){const i=t(e);if(i)return i}}}function Yue(n){const e=UP(n);return e.constant=e.fields.length==0,e}/* @license twgl.js 4.22.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const f4=5120,Gv=5121,g4=5122,p4=5123,m4=5124,_4=5125,b4=5126,Xue=32819,Que=32820,Jue=33635,ede=5131,tde=33640,ide=35899,nde=35902,rde=36269,sde=34042,Yq={};{const n=Yq;n[f4]=Int8Array,n[Gv]=Uint8Array,n[g4]=Int16Array,n[p4]=Uint16Array,n[m4]=Int32Array,n[_4]=Uint32Array,n[b4]=Float32Array,n[Xue]=Uint16Array,n[Que]=Uint16Array,n[Jue]=Uint16Array,n[ede]=Uint16Array,n[tde]=Uint32Array,n[ide]=Uint32Array,n[nde]=Uint32Array,n[rde]=Uint32Array,n[sde]=Uint32Array}function v4(n){if(n instanceof Int8Array)return f4;if(n instanceof Uint8Array||n instanceof Uint8ClampedArray)return Gv;if(n instanceof Int16Array)return g4;if(n instanceof Uint16Array)return p4;if(n instanceof Int32Array)return m4;if(n instanceof Uint32Array)return _4;if(n instanceof Float32Array)return b4;throw new Error("unsupported typed array type")}function ode(n){if(n===Int8Array)return f4;if(n===Uint8Array||n===Uint8ClampedArray)return Gv;if(n===Int16Array)return g4;if(n===Uint16Array)return p4;if(n===Int32Array)return m4;if(n===Uint32Array)return _4;if(n===Float32Array)return b4;throw new Error("unsupported typed array type")}function ade(n){const e=Yq[n];if(!e)throw new Error("unknown gl type");return e}const Ox=typeof SharedArrayBuffer<"u"?function(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function lde(...n){console.error(...n)}function Xq(...n){console.warn(...n)}function cde(n,e){return typeof WebGLBuffer<"u"&&e instanceof WebGLBuffer}function Qq(n,e){return typeof WebGLRenderbuffer<"u"&&e instanceof WebGLRenderbuffer}function Ck(n,e){return typeof WebGLTexture<"u"&&e instanceof WebGLTexture}function hde(n,e){return typeof WebGLSampler<"u"&&e instanceof WebGLSampler}const Jq=35044,ql=34962,ude=34963,dde=34660,fde=5120,gde=5121,pde=5122,mde=5123,_de=5124,bde=5125,vde=5126,eG={attribPrefix:""};function tG(n,e,t,i,r){n.bindBuffer(e,t),n.bufferData(e,i,r||Jq)}function iG(n,e,t,i){if(cde(n,e))return e;t=t||ql;const r=n.createBuffer();return tG(n,t,r,e,i),r}function nG(n){return n==="indices"}function wde(n){return n instanceof Int8Array||n instanceof Uint8Array}function yde(n){return n===Int8Array||n===Uint8Array}function Cde(n){return n.length?n:n.data}const Sde=/coord|texture/i,xde=/color|colour/i;function rG(n,e){let t;if(Sde.test(n)?t=2:xde.test(n)?t=4:t=3,e%t>0)throw new Error(`Can not guess numComponents for attribute '${n}'. Tried ${t} but ${e} values is not evenly divisible by ${t}. You should specify it.`);return t}function Ede(n,e){return n.numComponents||n.size||rG(e,Cde(n).length)}function w4(n,e){if(Ox(n))return n;if(Ox(n.data))return n.data;Array.isArray(n)&&(n={data:n});let t=n.type;return t||(nG(e)?t=Uint16Array:t=Float32Array),new t(n.data)}function Dde(n,e){const t={};return Object.keys(e).forEach(function(i){if(!nG(i)){const r=e[i],s=r.attrib||r.name||r.attribName||eG.attribPrefix+i;if(r.value){if(!Array.isArray(r.value)&&!Ox(r.value))throw new Error("array.value is not array or typedarray");t[s]={value:r.value}}else{let o,a,l,c;if(r.buffer&&r.buffer instanceof WebGLBuffer)o=r.buffer,c=r.numComponents||r.size,a=r.type,l=r.normalize;else if(typeof r=="number"||typeof r.data=="number"){const h=r.data||r,u=r.type||Float32Array,d=h*u.BYTES_PER_ELEMENT;a=ode(u),l=r.normalize!==void 0?r.normalize:yde(u),c=r.numComponents||r.size||rG(i,h),o=n.createBuffer(),n.bindBuffer(ql,o),n.bufferData(ql,d,r.drawType||Jq)}else{const h=w4(r,i);o=iG(n,h,void 0,r.drawType),a=v4(h),l=r.normalize!==void 0?r.normalize:wde(h),c=Ede(r,i)}t[s]={buffer:o,numComponents:c,type:a,normalize:l,stride:r.stride||0,offset:r.offset||0,divisor:r.divisor===void 0?void 0:r.divisor,drawType:r.drawType}}}}),n.bindBuffer(ql,null),t}function kde(n,e,t,i){t=w4(t),i!==void 0?(n.bindBuffer(ql,e.buffer),n.bufferSubData(ql,i,t)):tG(n,ql,e.buffer,t,e.drawType)}function Lde(n,e){return e===fde||e===gde?1:e===pde||e===mde?2:e===_de||e===bde||e===vde?4:0}const W2=["position","positions","a_position"];function Ide(n,e){let t,i;for(i=0;i<W2.length&&(t=W2[i],!(t in e||(t=eG.attribPrefix+t,t in e)));++i);i===W2.length&&(t=Object.keys(e)[0]);const r=e[t];n.bindBuffer(ql,r.buffer);const s=n.getBufferParameter(ql,dde);n.bindBuffer(ql,null);const o=Lde(n,r.type),a=s/o,l=r.numComponents||r.size,c=a/l;if(c%1!==0)throw new Error(`numComponents ${l} not correct for length ${length}`);return c}function Tde(n,e,t){const i=Dde(n,e),r=Object.assign({},t||{});r.attribs=Object.assign({},t?t.attribs:{},i);const s=e.indices;if(s){const o=w4(s,"indices");r.indices=iG(n,o,ude),r.numElements=o.length,r.elementType=v4(o)}else r.numElements||(r.numElements=Ide(n,r.attribs));return r}function e0(n){return!!n.texStorage2D}const AN=function(){const n={},e={};function t(i){const r=i.constructor.name;if(!n[r]){for(const s in i)if(typeof i[s]=="number"){const o=e[i[s]];e[i[s]]=o?`${o} | ${s}`:s}n[r]=!0}}return function(r,s){return t(r),e[s]||(typeof s=="number"?`0x${s.toString(16)}`:s)}}(),hd={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},n_=Ox,sG=function(){let n;return function(){return n=n||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),n}}(),L8=6406,ul=6407,sn=6408,I8=6409,T8=6410,W0=6402,A8=34041,Px=33071,Ade=9728,Nde=9729,kh=3553,wh=34067,Wu=32879,$u=35866,Sk=34069,Rde=34070,Mde=34071,Fde=34072,Ode=34073,Pde=34074,NN=10241,RN=10240,Bx=10242,Vx=10243,N8=32882,Bde=33082,Vde=33083,Wde=33084,$de=33085,y4=3317,oG=3314,aG=32878,lG=3316,cG=3315,hG=32877,zde=37443,Hde=37441,Ude=37440,jde=33321,qde=36756,Gde=33325,Kde=33326,Zde=33330,Yde=33329,Xde=33338,Qde=33337,Jde=33340,efe=33339,tfe=33323,ife=36757,nfe=33327,rfe=33328,sfe=33336,ofe=33335,afe=33332,lfe=33331,cfe=33334,hfe=33333,ufe=32849,dfe=35905,ffe=36194,gfe=36758,pfe=35898,mfe=35901,_fe=34843,bfe=34837,vfe=36221,wfe=36239,yfe=36215,Cfe=36233,Sfe=36209,xfe=36227,Efe=32856,Dfe=35907,kfe=36759,Lfe=32855,Ife=32854,Tfe=32857,Afe=34842,Nfe=34836,Rfe=36220,Mfe=36238,Ffe=36975,Ofe=36214,Pfe=36232,Bfe=36226,Vfe=36208,Wfe=33189,$fe=33190,zfe=36012,Hfe=36013,Ufe=35056,Mh=5120,nn=5121,jy=5122,ap=5123,qy=5124,yd=5125,Tr=5126,R8=32819,M8=32820,F8=33635,da=5131,$0=36193,$2=33640,jfe=35899,qfe=35902,Gfe=36269,Kfe=34042,Gy=33319,lp=33320,Ky=6403,cp=36244,hp=36248,Cd=36249;let z2;function xk(n){if(!z2){const e={};e[L8]={textureFormat:L8,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[nn,da,$0,Tr]},e[I8]={textureFormat:I8,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[nn,da,$0,Tr]},e[T8]={textureFormat:T8,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[nn,da,$0,Tr]},e[ul]={textureFormat:ul,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[nn,da,$0,Tr,F8]},e[sn]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[nn,da,$0,Tr,R8,M8]},e[W0]={textureFormat:W0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[yd,ap]},e[jde]={textureFormat:Ky,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[nn]},e[qde]={textureFormat:Ky,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[Mh]},e[Gde]={textureFormat:Ky,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[Tr,da]},e[Kde]={textureFormat:Ky,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[Tr]},e[Zde]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[nn]},e[Yde]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[Mh]},e[afe]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ap]},e[lfe]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[jy]},e[cfe]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[yd]},e[hfe]={textureFormat:cp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[qy]},e[tfe]={textureFormat:Gy,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[nn]},e[ife]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[Mh]},e[nfe]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[Tr,da]},e[rfe]={textureFormat:Gy,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[Tr]},e[sfe]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[nn]},e[ofe]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Mh]},e[Xde]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ap]},e[Qde]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[jy]},e[Jde]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[yd]},e[efe]={textureFormat:lp,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[qy]},e[ufe]={textureFormat:ul,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[nn]},e[dfe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[nn]},e[ffe]={textureFormat:ul,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[nn,F8]},e[gfe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[Mh]},e[pfe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Tr,da,jfe]},e[mfe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Tr,da,qfe]},e[_fe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[Tr,da]},e[bfe]={textureFormat:ul,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Tr]},e[vfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[nn]},e[wfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[Mh]},e[yfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[ap]},e[Cfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[jy]},e[Sfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[yd]},e[xfe]={textureFormat:hp,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[qy]},e[Efe]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[nn]},e[Dfe]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[nn]},e[kfe]={textureFormat:sn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[Mh]},e[Lfe]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[nn,M8,$2]},e[Ife]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[nn,R8]},e[Tfe]={textureFormat:sn,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[$2]},e[Afe]={textureFormat:sn,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[Tr,da]},e[Nfe]={textureFormat:sn,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[Tr]},e[Rfe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[nn]},e[Mfe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Mh]},e[Ffe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$2]},e[Ofe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ap]},e[Pfe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[jy]},e[Bfe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[qy]},e[Vfe]={textureFormat:Cd,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[yd]},e[Wfe]={textureFormat:W0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ap,yd]},e[$fe]={textureFormat:W0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[yd]},e[zfe]={textureFormat:W0,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Tr]},e[Ufe]={textureFormat:A8,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Kfe]},e[Hfe]={textureFormat:A8,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Gfe]},Object.keys(e).forEach(function(t){const i=e[t];i.bytesPerElementMap={},i.bytesPerElement.forEach(function(r,s){const o=i.type[s];i.bytesPerElementMap[o]=r})}),z2=e}return z2[n]}function Zfe(n,e){const t=xk(n);if(!t)throw"unknown internal format";const i=t.bytesPerElementMap[e];if(i===void 0)throw"unknown internal format";return i}function t0(n){const e=xk(n);if(!e)throw"unknown internal format";return{format:e.textureFormat,type:e.type[0]}}function O8(n){return(n&n-1)===0}function Yfe(n,e,t,i){if(!e0(n))return O8(e)&&O8(t);const r=xk(i);if(!r)throw"unknown internal format";return r.colorRenderable&&r.textureFilterable}function Xfe(n){const e=xk(n);if(!e)throw"unknown internal format";return e.textureFilterable}function uG(n,e,t){return n_(e)?v4(e):t||nn}function Zy(n,e,t,i,r){if(r%1!==0)throw"can't guess dimensions";if(!t&&!i){const s=Math.sqrt(r/(e===wh?6:1));s%1===0?(t=s,i=s):(t=r,i=1)}else if(i){if(!t&&(t=r/i,t%1))throw"can't guess dimensions"}else if(i=r/t,i%1)throw"can't guess dimensions";return{width:t,height:i}}function r_(n,e){e.colorspaceConversion!==void 0&&n.pixelStorei(zde,e.colorspaceConversion),e.premultiplyAlpha!==void 0&&n.pixelStorei(Hde,e.premultiplyAlpha),e.flipY!==void 0&&n.pixelStorei(Ude,e.flipY)}function dG(n){n.pixelStorei(y4,4),e0(n)&&(n.pixelStorei(oG,0),n.pixelStorei(aG,0),n.pixelStorei(lG,0),n.pixelStorei(cG,0),n.pixelStorei(hG,0))}function Qfe(n,e,t,i){i.minMag&&(t.call(n,e,NN,i.minMag),t.call(n,e,RN,i.minMag)),i.min&&t.call(n,e,NN,i.min),i.mag&&t.call(n,e,RN,i.mag),i.wrap&&(t.call(n,e,Bx,i.wrap),t.call(n,e,Vx,i.wrap),(e===Wu||hde(n,e))&&t.call(n,e,N8,i.wrap)),i.wrapR&&t.call(n,e,N8,i.wrapR),i.wrapS&&t.call(n,e,Bx,i.wrapS),i.wrapT&&t.call(n,e,Vx,i.wrapT),i.minLod&&t.call(n,e,Bde,i.minLod),i.maxLod&&t.call(n,e,Vde,i.maxLod),i.baseLevel&&t.call(n,e,Wde,i.baseLevel),i.maxLevel&&t.call(n,e,$de,i.maxLevel)}function fG(n,e,t){const i=t.target||kh;n.bindTexture(i,e),Qfe(n,i,n.texParameteri,t)}function Jfe(n){return n=n||hd.textureColor,n_(n)?n:new Uint8Array([n[0]*255,n[1]*255,n[2]*255,n[3]*255])}function MN(n,e,t,i,r,s){t=t||hd.textureOptions,s=s||sn;const o=t.target||kh;if(i=i||t.width,r=r||t.height,n.bindTexture(o,e),Yfe(n,i,r,s))n.generateMipmap(o);else{const a=Xfe(s)?Nde:Ade;n.texParameteri(o,NN,a),n.texParameteri(o,RN,a),n.texParameteri(o,Bx,Px),n.texParameteri(o,Vx,Px)}}function Kv(n){return n.auto===!0||n.auto===void 0&&n.level===void 0}function FN(n,e){return e=e||{},e.cubeFaceOrder||[Sk,Rde,Mde,Fde,Ode,Pde]}function ON(n,e){const i=FN(n,e).map(function(r,s){return{face:r,ndx:s}});return i.sort(function(r,s){return r.face-s.face}),i}function gG(n,e,t,i){i=i||hd.textureOptions;const r=i.target||kh,s=i.level||0;let o=t.width,a=t.height;const l=i.internalFormat||i.format||sn,c=t0(l),h=i.format||c.format,u=i.type||c.type;if(r_(n,i),n.bindTexture(r,e),r===wh){const d=t.width,f=t.height;let g,p;if(d/6===f)g=f,p=[0,0,1,0,2,0,3,0,4,0,5,0];else if(f/6===d)g=d,p=[0,0,0,1,0,2,0,3,0,4,0,5];else if(d/3===f/2)g=d/3,p=[0,0,1,0,2,0,0,1,1,1,2,1];else if(d/2===f/3)g=d/2,p=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);const m=sG();m?(m.canvas.width=g,m.canvas.height=g,o=g,a=g,ON(n,i).forEach(function(b){const _=p[b.ndx*2+0]*g,w=p[b.ndx*2+1]*g;m.drawImage(t,_,w,g,g,0,0,g,g),n.texImage2D(b.face,s,l,h,u,m.canvas)}),m.canvas.width=1,m.canvas.height=1):typeof createImageBitmap<"u"&&(o=g,a=g,ON(n,i).forEach(function(b){const _=p[b.ndx*2+0]*g,w=p[b.ndx*2+1]*g;n.texImage2D(b.face,s,l,g,g,0,h,u,null),createImageBitmap(t,_,w,g,g,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(y){r_(n,i),n.bindTexture(r,e),n.texImage2D(b.face,s,l,h,u,y),Kv(i)&&MN(n,e,i,o,a,l)})}))}else if(r===Wu||r===$u){const d=Math.min(t.width,t.height),f=Math.max(t.width,t.height),g=f/d;if(g%1!==0)throw"can not compute 3D dimensions of element";const p=t.width===f?1:0,m=t.height===f?1:0;n.pixelStorei(y4,1),n.pixelStorei(oG,t.width),n.pixelStorei(aG,0),n.pixelStorei(hG,0),n.texImage3D(r,s,l,d,d,d,0,h,u,null);for(let b=0;b<g;++b){const _=b*d*p,w=b*d*m;n.pixelStorei(lG,_),n.pixelStorei(cG,w),n.texSubImage3D(r,s,0,0,b,d,d,1,h,u,t)}dG(n)}else n.texImage2D(r,s,l,h,u,t);Kv(i)&&MN(n,e,i,o,a,l),fG(n,e,i)}function U1(){}function ege(n){if(typeof document<"u"){const e=document.createElement("a");return e.href=n,e.hostname===location.hostname&&e.port===location.port&&e.protocol===location.protocol}else{const e=new URL(location.href).origin;return new URL(n,location.href).origin===e}}function tge(n,e){return e===void 0&&!ege(n)?"anonymous":e}function ige(n,e,t){t=t||U1;let i;if(e=e!==void 0?e:hd.crossOrigin,e=tge(n,e),typeof Image<"u"){i=new Image,e!==void 0&&(i.crossOrigin=e);const r=function(){i.removeEventListener("error",s),i.removeEventListener("load",o),i=null},s=function(){const l="couldn't load image: "+n;lde(l),t(l,i),r()},o=function(){t(null,i),r()};return i.addEventListener("error",s),i.addEventListener("load",o),i.src=n,i}else if(typeof ImageBitmap<"u"){let r,s;const o=function(){t(r,s)},a={};e&&(a.mode="cors"),fetch(n,a).then(function(l){if(!l.ok)throw l;return l.blob()}).then(function(l){return createImageBitmap(l,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(l){s=l,setTimeout(o)}).catch(function(l){r=l,setTimeout(o)}),i=null}return i}function pG(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof ImageData<"u"&&n instanceof ImageData||typeof HTMLElement<"u"&&n instanceof HTMLElement}function C4(n,e,t){return pG(n)?(setTimeout(function(){t(null,n)}),n):ige(n,e,t)}function S4(n,e,t){t=t||hd.textureOptions;const i=t.target||kh;if(n.bindTexture(i,e),t.color===!1)return;const r=Jfe(t.color);if(i===wh)for(let s=0;s<6;++s)n.texImage2D(Sk+s,0,sn,1,1,0,sn,nn,r);else i===Wu||i===$u?n.texImage3D(i,0,sn,1,1,1,0,sn,nn,r):n.texImage2D(i,0,sn,1,1,0,sn,nn,r)}function nge(n,e,t,i){return i=i||U1,t=t||hd.textureOptions,S4(n,e,t),t=Object.assign({},t),C4(t.src,t.crossOrigin,function(s,o){s?i(s,e,o):(gG(n,e,o,t),i(null,e,o))})}function rge(n,e,t,i){i=i||U1;const r=t.src;if(r.length!==6)throw"there must be 6 urls for a cubemap";const s=t.level||0,o=t.internalFormat||t.format||sn,a=t0(o),l=t.format||a.format,c=t.type||nn,h=t.target||kh;if(h!==wh)throw"target must be TEXTURE_CUBE_MAP";S4(n,e,t),t=Object.assign({},t);let u=6;const d=[],f=FN(n,t);let g;function p(m){return function(b,_){--u,b?d.push(b):_.width!==_.height?d.push("cubemap face img is not a square: "+_.src):(r_(n,t),n.bindTexture(h,e),u===5?FN().forEach(function(w){n.texImage2D(w,s,o,l,c,_)}):n.texImage2D(m,s,o,l,c,_),Kv(t)&&n.generateMipmap(h)),u===0&&i(d.length?d:void 0,e,g)}}g=r.map(function(m,b){return C4(m,t.crossOrigin,p(f[b]))})}function sge(n,e,t,i){i=i||U1;const r=t.src,s=t.internalFormat||t.format||sn,o=t0(s),a=t.format||o.format,l=t.type||nn,c=t.target||$u;if(c!==Wu&&c!==$u)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";S4(n,e,t),t=Object.assign({},t);let h=r.length;const u=[];let d;const f=t.level||0;let g=t.width,p=t.height;const m=r.length;let b=!0;function _(w){return function(y,S){if(--h,y)u.push(y);else{if(r_(n,t),n.bindTexture(c,e),b){b=!1,g=t.width||S.width,p=t.height||S.height,n.texImage3D(c,f,s,g,p,m,0,a,l,null);for(let k=0;k<m;++k)n.texSubImage3D(c,f,0,0,k,g,p,1,a,l,S)}else{let k=S,C;(S.width!==g||S.height!==p)&&(C=sG(),k=C.canvas,C.canvas.width=g,C.canvas.height=p,C.drawImage(S,0,0,g,p)),n.texSubImage3D(c,f,0,0,w,g,p,1,a,l,k),C&&k===C.canvas&&(C.canvas.width=0,C.canvas.height=0)}Kv(t)&&n.generateMipmap(c)}h===0&&i(u.length?u:void 0,e,d)}}d=r.map(function(w,y){return C4(w,t.crossOrigin,_(y))})}function mG(n,e,t,i){i=i||hd.textureOptions;const r=i.target||kh;n.bindTexture(r,e);let s=i.width,o=i.height,a=i.depth;const l=i.level||0,c=i.internalFormat||i.format||sn,h=t0(c),u=i.format||h.format,d=i.type||uG(n,t,h.type);if(n_(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{const m=ade(d);t=new m(t)}const f=Zfe(c,d),g=t.byteLength/f;if(g%1)throw"length wrong size for format: "+AN(n,u);let p;if(r===Wu||r===$u)if(!s&&!o&&!a){const m=Math.cbrt(g);if(m%1!==0)throw"can't guess cube size of array of numElements: "+g;s=m,o=m,a=m}else s&&(!o||!a)?(p=Zy(n,r,o,a,g/s),o=p.width,a=p.height):o&&(!s||!a)?(p=Zy(n,r,s,a,g/o),s=p.width,a=p.height):(p=Zy(n,r,s,o,g/a),s=p.width,o=p.height);else p=Zy(n,r,s,o,g),s=p.width,o=p.height;if(dG(n),n.pixelStorei(y4,i.unpackAlignment||1),r_(n,i),r===wh){const m=f/t.BYTES_PER_ELEMENT,b=g/6*m;ON(n,i).forEach(_=>{const w=b*_.ndx,y=t.subarray(w,w+b);n.texImage2D(_.face,l,c,s,o,0,u,d,y)})}else r===Wu||r===$u?n.texImage3D(r,l,c,s,o,a,0,u,d,t):n.texImage2D(r,l,c,s,o,0,u,d,t);return{width:s,height:o,depth:a,type:d}}function oge(n,e,t){const i=t.target||kh;n.bindTexture(i,e);const r=t.level||0,s=t.internalFormat||t.format||sn,o=t0(s),a=t.format||o.format,l=t.type||o.type;if(r_(n,t),i===wh)for(let c=0;c<6;++c)n.texImage2D(Sk+c,r,s,t.width,t.height,0,a,l,null);else i===Wu||i===$u?n.texImage3D(i,r,s,t.width,t.height,t.depth,0,a,l,null):n.texImage2D(i,r,s,t.width,t.height,0,a,l,null)}function Zv(n,e,t){t=t||U1,e=e||hd.textureOptions;const i=n.createTexture(),r=e.target||kh;let s=e.width||1,o=e.height||1;const a=e.internalFormat||sn;n.bindTexture(r,i),r===wh&&(n.texParameteri(r,Bx,Px),n.texParameteri(r,Vx,Px));let l=e.src;if(l)if(typeof l=="function"&&(l=l(n,e)),typeof l=="string")nge(n,i,e,t);else if(n_(l)||Array.isArray(l)&&(typeof l[0]=="number"||Array.isArray(l[0])||n_(l[0]))){const c=mG(n,i,l,e);s=c.width,o=c.height}else Array.isArray(l)&&(typeof l[0]=="string"||pG(l[0]))?r===wh?rge(n,i,e,t):sge(n,i,e,t):(gG(n,i,l,e),s=l.width,o=l.height);else oge(n,i,e);return Kv(e)&&MN(n,i,e,s,o,a),fG(n,i,e),i}function age(n,e,t,i,r,s){i=i||t.width,r=r||t.height,s=s||t.depth;const o=t.target||kh;n.bindTexture(o,e);const a=t.level||0,l=t.internalFormat||t.format||sn,c=t0(l),h=t.format||c.format;let u;const d=t.src;if(d&&(n_(d)||Array.isArray(d)&&typeof d[0]=="number")?u=t.type||uG(n,d,c.type):u=t.type||c.type,o===wh)for(let f=0;f<6;++f)n.texImage2D(Sk+f,a,l,i,r,0,h,u,null);else o===Wu||o===$u?n.texImage3D(o,a,l,i,r,s,0,h,u,null):n.texImage2D(o,a,l,i,r,0,h,u,null)}const lge=Xq,Wx=33984,cge=35048,Ek=34962,hge=34963,x4=35345,_G=35718,uge=35721,dge=35971,fge=35382,gge=35396,pge=35398,mge=35392,_ge=35395,Dk=5126,bG=35664,vG=35665,wG=35666,E4=5124,yG=35667,CG=35668,SG=35669,xG=35670,EG=35671,DG=35672,kG=35673,LG=35674,IG=35675,TG=35676,bge=35678,vge=35680,wge=35679,yge=35682,Cge=35685,Sge=35686,xge=35687,Ege=35688,Dge=35689,kge=35690,Lge=36289,Ige=36292,Tge=36293,D4=5125,AG=36294,NG=36295,RG=36296,Age=36298,Nge=36299,Rge=36300,Mge=36303,Fge=36306,Oge=36307,Pge=36308,Bge=36311,kk=3553,Lk=34067,k4=32879,Ik=35866,yt={};function MG(n,e){return yt[e].bindPoint}function Vge(n,e){return function(t){n.uniform1f(e,t)}}function Wge(n,e){return function(t){n.uniform1fv(e,t)}}function $ge(n,e){return function(t){n.uniform2fv(e,t)}}function zge(n,e){return function(t){n.uniform3fv(e,t)}}function Hge(n,e){return function(t){n.uniform4fv(e,t)}}function FG(n,e){return function(t){n.uniform1i(e,t)}}function OG(n,e){return function(t){n.uniform1iv(e,t)}}function PG(n,e){return function(t){n.uniform2iv(e,t)}}function BG(n,e){return function(t){n.uniform3iv(e,t)}}function VG(n,e){return function(t){n.uniform4iv(e,t)}}function Uge(n,e){return function(t){n.uniform1ui(e,t)}}function jge(n,e){return function(t){n.uniform1uiv(e,t)}}function qge(n,e){return function(t){n.uniform2uiv(e,t)}}function Gge(n,e){return function(t){n.uniform3uiv(e,t)}}function Kge(n,e){return function(t){n.uniform4uiv(e,t)}}function Zge(n,e){return function(t){n.uniformMatrix2fv(e,!1,t)}}function Yge(n,e){return function(t){n.uniformMatrix3fv(e,!1,t)}}function Xge(n,e){return function(t){n.uniformMatrix4fv(e,!1,t)}}function Qge(n,e){return function(t){n.uniformMatrix2x3fv(e,!1,t)}}function Jge(n,e){return function(t){n.uniformMatrix3x2fv(e,!1,t)}}function epe(n,e){return function(t){n.uniformMatrix2x4fv(e,!1,t)}}function tpe(n,e){return function(t){n.uniformMatrix4x2fv(e,!1,t)}}function ipe(n,e){return function(t){n.uniformMatrix3x4fv(e,!1,t)}}function npe(n,e){return function(t){n.uniformMatrix4x3fv(e,!1,t)}}function fs(n,e,t,i){const r=MG(n,e);return e0(n)?function(s){let o,a;Ck(n,s)?(o=s,a=null):(o=s.texture,a=s.sampler),n.uniform1i(i,t),n.activeTexture(Wx+t),n.bindTexture(r,o),n.bindSampler(t,a)}:function(s){n.uniform1i(i,t),n.activeTexture(Wx+t),n.bindTexture(r,s)}}function gs(n,e,t,i,r){const s=MG(n,e),o=new Int32Array(r);for(let a=0;a<r;++a)o[a]=t+a;return e0(n)?function(a){n.uniform1iv(i,o),a.forEach(function(l,c){n.activeTexture(Wx+o[c]);let h,u;Ck(n,l)?(h=l,u=null):(h=l.texture,u=l.sampler),n.bindSampler(t,u),n.bindTexture(s,h)})}:function(a){n.uniform1iv(i,o),a.forEach(function(l,c){n.activeTexture(Wx+o[c]),n.bindTexture(s,l)})}}yt[Dk]={Type:Float32Array,size:4,setter:Vge,arraySetter:Wge};yt[bG]={Type:Float32Array,size:8,setter:$ge,cols:2};yt[vG]={Type:Float32Array,size:12,setter:zge,cols:3};yt[wG]={Type:Float32Array,size:16,setter:Hge,cols:4};yt[E4]={Type:Int32Array,size:4,setter:FG,arraySetter:OG};yt[yG]={Type:Int32Array,size:8,setter:PG,cols:2};yt[CG]={Type:Int32Array,size:12,setter:BG,cols:3};yt[SG]={Type:Int32Array,size:16,setter:VG,cols:4};yt[D4]={Type:Uint32Array,size:4,setter:Uge,arraySetter:jge};yt[AG]={Type:Uint32Array,size:8,setter:qge,cols:2};yt[NG]={Type:Uint32Array,size:12,setter:Gge,cols:3};yt[RG]={Type:Uint32Array,size:16,setter:Kge,cols:4};yt[xG]={Type:Uint32Array,size:4,setter:FG,arraySetter:OG};yt[EG]={Type:Uint32Array,size:8,setter:PG,cols:2};yt[DG]={Type:Uint32Array,size:12,setter:BG,cols:3};yt[kG]={Type:Uint32Array,size:16,setter:VG,cols:4};yt[LG]={Type:Float32Array,size:32,setter:Zge,rows:2,cols:2};yt[IG]={Type:Float32Array,size:48,setter:Yge,rows:3,cols:3};yt[TG]={Type:Float32Array,size:64,setter:Xge,rows:4,cols:4};yt[Cge]={Type:Float32Array,size:32,setter:Qge,rows:2,cols:3};yt[Sge]={Type:Float32Array,size:32,setter:epe,rows:2,cols:4};yt[xge]={Type:Float32Array,size:48,setter:Jge,rows:3,cols:2};yt[Ege]={Type:Float32Array,size:48,setter:ipe,rows:3,cols:4};yt[Dge]={Type:Float32Array,size:64,setter:tpe,rows:4,cols:2};yt[kge]={Type:Float32Array,size:64,setter:npe,rows:4,cols:3};yt[bge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:kk};yt[vge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Lk};yt[wge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:k4};yt[yge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:kk};yt[Lge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Ik};yt[Ige]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Ik};yt[Tge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Lk};yt[Age]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:kk};yt[Nge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:k4};yt[Rge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Lk};yt[Mge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Ik};yt[Fge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:kk};yt[Oge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:k4};yt[Pge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Lk};yt[Bge]={Type:null,size:0,setter:fs,arraySetter:gs,bindPoint:Ik};function Tk(n,e){return function(t){if(t.value)switch(n.disableVertexAttribArray(e),t.value.length){case 4:n.vertexAttrib4fv(e,t.value);break;case 3:n.vertexAttrib3fv(e,t.value);break;case 2:n.vertexAttrib2fv(e,t.value);break;case 1:n.vertexAttrib1fv(e,t.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else n.bindBuffer(Ek,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribPointer(e,t.numComponents||t.size,t.type||Dk,t.normalize||!1,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function ud(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4iv(e,t.value);else throw new Error("The length of an integer constant value must be 4!");else n.bindBuffer(Ek,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||E4,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function Ak(n,e){return function(t){if(t.value)if(n.disableVertexAttribArray(e),t.value.length===4)n.vertexAttrib4uiv(e,t.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else n.bindBuffer(Ek,t.buffer),n.enableVertexAttribArray(e),n.vertexAttribIPointer(e,t.numComponents||t.size,t.type||D4,t.stride||0,t.offset||0),t.divisor!==void 0&&n.vertexAttribDivisor(e,t.divisor)}}function L4(n,e,t){const i=t.size,r=t.count;return function(s){n.bindBuffer(Ek,s.buffer);const o=s.size||s.numComponents||i,a=o/r,l=s.type||Dk,h=yt[l].size*o,u=s.normalize||!1,d=s.offset||0,f=h/r;for(let g=0;g<r;++g)n.enableVertexAttribArray(e+g),n.vertexAttribPointer(e+g,a,l,u,h,d+f*g),s.divisor!==void 0&&n.vertexAttribDivisor(e+g,s.divisor)}}const Pn={};Pn[Dk]={size:4,setter:Tk};Pn[bG]={size:8,setter:Tk};Pn[vG]={size:12,setter:Tk};Pn[wG]={size:16,setter:Tk};Pn[E4]={size:4,setter:ud};Pn[yG]={size:8,setter:ud};Pn[CG]={size:12,setter:ud};Pn[SG]={size:16,setter:ud};Pn[D4]={size:4,setter:Ak};Pn[AG]={size:8,setter:Ak};Pn[NG]={size:12,setter:Ak};Pn[RG]={size:16,setter:Ak};Pn[xG]={size:4,setter:ud};Pn[EG]={size:8,setter:ud};Pn[DG]={size:12,setter:ud};Pn[kG]={size:16,setter:ud};Pn[LG]={size:4,setter:L4,count:2};Pn[IG]={size:9,setter:L4,count:3};Pn[TG]={size:16,setter:L4,count:4};function WG(n){const e=n.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const rpe=/(\.|\[|]|\w+)/g,spe=n=>n>="0"&&n<="9";function $G(n,e,t,i){const r=n.split(rpe).filter(a=>a!=="");let s=0,o="";for(;;){const a=r[s++];o+=a;const l=spe(a[0]),c=l?parseInt(a):a;if(l&&(o+=r[s++]),s===r.length){t[c]=e;break}else{const u=r[s++],d=u==="[",f=t[c]||(d?[]:{});t[c]=f,t=f,i[o]=i[o]||function(g){return function(p){zG(g,p)}}(f),o+=u}}}function ope(n,e){let t=0;function i(a,l,c){const h=l.name.endsWith("[0]"),u=l.type,d=yt[u];if(!d)throw new Error(`unknown type: 0x${u.toString(16)}`);let f;if(d.bindPoint){const g=t;t+=l.size,h?f=d.arraySetter(n,u,g,c,l.size):f=d.setter(n,u,g,c,l.size)}else d.arraySetter&&h?f=d.arraySetter(n,c):f=d.setter(n,c);return f.location=c,f}const r={},s={},o=n.getProgramParameter(e,_G);for(let a=0;a<o;++a){const l=n.getActiveUniform(e,a);if(WG(l))continue;let c=l.name;c.endsWith("[0]")&&(c=c.substr(0,c.length-3));const h=n.getUniformLocation(e,l.name);if(h){const u=i(e,l,h);r[c]=u,$G(c,u,s,r)}}return r}function ape(n,e){const t={},i=n.getProgramParameter(e,dge);for(let r=0;r<i;++r){const s=n.getTransformFeedbackVarying(e,r);t[s.name]={index:r,type:s.type,size:s.size}}return t}function lpe(n,e){const t=n.getProgramParameter(e,_G),i=[],r=[];for(let a=0;a<t;++a){r.push(a),i.push({});const l=n.getActiveUniform(e,a);i[a].name=l.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){const l=a[0],c=a[1];n.getActiveUniforms(e,r,n[l]).forEach(function(h,u){i[u][c]=h})});const s={},o=n.getProgramParameter(e,fge);for(let a=0;a<o;++a){const l=n.getActiveUniformBlockName(e,a),c={index:n.getUniformBlockIndex(e,l),usedByVertexShader:n.getActiveUniformBlockParameter(e,a,gge),usedByFragmentShader:n.getActiveUniformBlockParameter(e,a,pge),size:n.getActiveUniformBlockParameter(e,a,mge),uniformIndices:n.getActiveUniformBlockParameter(e,a,_ge)};c.used=c.usedByVertexShader||c.usedByFragmentShader,s[l]=c}return{blockSpecs:s,uniformData:i}}const P8=/\[\d+\]\.$/,cpe=(n,e)=>((n+(e-1))/e|0)*e;function hpe(n,e,t,i){if(e||t){i=i||1;const s=n.length/4;return function(o){let a=0,l=0;for(let c=0;c<s;++c){for(let h=0;h<i;++h)n[a++]=o[l++];a+=4-i}}}else return function(r){r.length?n.set(r):n[0]=r}}function upe(n,e,t,i){const r=t.blockSpecs,s=t.uniformData,o=r[i];if(!o)return lge("no uniform block object named:",i),{name:i,uniforms:{}};const a=new ArrayBuffer(o.size),l=n.createBuffer(),c=o.index;n.bindBuffer(x4,l),n.uniformBlockBinding(e,o.index,c);let h=i+".";P8.test(h)&&(h=h.replace(P8,"."));const u={},d={},f={};return o.uniformIndices.forEach(function(g){const p=s[g];let m=p.name;m.startsWith(h)&&(m=m.substr(h.length));const b=m.endsWith("[0]");b&&(m=m.substr(0,m.length-3));const _=yt[p.type],w=_.Type,y=b?cpe(_.size,16)*p.size:_.size*p.size,S=new w(a,p.offset,y/w.BYTES_PER_ELEMENT);u[m]=S;const k=hpe(S,b,_.rows,_.cols);d[m]=k,$G(m,k,f,d)}),{name:i,array:a,asFloat:new Float32Array(a),buffer:l,uniforms:u,setters:d}}function B8(n,e,t){return upe(n,e.program,e.uniformBlockSpec,t)}function dpe(n,e,t){const r=(e.uniformBlockSpec||e).blockSpecs[t.name];if(r){const s=r.index;return n.bindBufferRange(x4,s,t.buffer,t.offset||0,t.array.byteLength),!0}return!1}function V8(n,e,t){dpe(n,e,t)&&n.bufferData(x4,t.array,cge)}function W8(n,e){const t=n.setters;for(const i in e){const r=t[i];if(r){const s=e[i];r(s)}}}function zG(n,e){for(const t in e){const i=n[t];typeof i=="function"?i(e[t]):zG(n[t],e[t])}}function io(n,...e){const t=n.uniformSetters||n,i=e.length;for(let r=0;r<i;++r){const s=e[r];if(Array.isArray(s)){const o=s.length;for(let a=0;a<o;++a)io(t,s[a])}else for(const o in s){const a=t[o];a&&a(s[o])}}}function fpe(n,e){const t={},i=n.getProgramParameter(e,uge);for(let r=0;r<i;++r){const s=n.getActiveAttrib(e,r);if(WG(s))continue;const o=n.getAttribLocation(e,s.name),a=Pn[s.type],l=a.setter(n,o,a);l.location=o,t[s.name]=l}return t}function gpe(n,e){for(const t in e){const i=n[t];i&&i(e[t])}}function i0(n,e,t){t.vertexArrayObject?n.bindVertexArray(t.vertexArrayObject):(gpe(e.attribSetters||e,t.attribs),t.indices&&n.bindBuffer(hge,t.indices))}function ppe(n,e){const t=ope(n,e),i=fpe(n,e),r={program:e,uniformSetters:t,attribSetters:i};return e0(n)&&(r.uniformBlockSpec=lpe(n,e),r.transformFeedbackInfo=ape(n,e)),r}const mpe=4,$8=5123;function j1(n,e,t,i,r,s){t=t===void 0?mpe:t;const o=e.indices,a=e.elementType,l=i===void 0?e.numElements:i;r=r===void 0?0:r,a||o?s!==void 0?n.drawElementsInstanced(t,l,a===void 0?$8:e.elementType,r,s):n.drawElements(t,l,a===void 0?$8:e.elementType,r):s!==void 0?n.drawArraysInstanced(t,r,l,s):n.drawArrays(t,r,l)}const _pe=36160,Qd=36161,bpe=3553,vpe=5121,wpe=6402,ype=6408,Cpe=33190,Spe=36012,xpe=35056,Epe=36013,Dpe=32854,kpe=32855,Lpe=36194,HG=33189,UG=6401,jG=36168,I4=34041,Ipe=36064,Nk=36096,qG=36128,T4=33306,PN=33071,BN=9729,GG=[{format:ype,type:vpe,min:BN,wrap:PN},{format:I4}],Ha={};Ha[I4]=T4;Ha[UG]=qG;Ha[jG]=qG;Ha[wpe]=Nk;Ha[HG]=Nk;Ha[Cpe]=Nk;Ha[Spe]=Nk;Ha[xpe]=T4;Ha[Epe]=T4;function Tpe(n,e){return Ha[n]||Ha[e]}const dd={};dd[Dpe]=!0;dd[kpe]=!0;dd[Lpe]=!0;dd[I4]=!0;dd[HG]=!0;dd[UG]=!0;dd[jG]=!0;function Ape(n){return dd[n]}function Npe(n,e,t,i){const r=_pe,s=n.createFramebuffer();n.bindFramebuffer(r,s),t=t||n.drawingBufferWidth,i=i||n.drawingBufferHeight,e=e||GG;let o=0;const a={framebuffer:s,attachments:[],width:t,height:i};return e.forEach(function(l){let c=l.attachment;const h=l.samples,u=l.format;let d=l.attachmentPoint||Tpe(u,l.internalFormat);if(d||(d=Ipe+o++),!c)if(h!==void 0||Ape(u))c=n.createRenderbuffer(),n.bindRenderbuffer(Qd,c),h>1?n.renderbufferStorageMultisample(Qd,h,u,t,i):n.renderbufferStorage(Qd,u,t,i);else{const f=Object.assign({},l);f.width=t,f.height=i,f.auto===void 0&&(f.auto=!1,f.min=f.min||f.minMag||BN,f.mag=f.mag||f.minMag||BN,f.wrapS=f.wrapS||f.wrap||PN,f.wrapT=f.wrapT||f.wrap||PN),c=Zv(n,f)}if(Qq(n,c))n.framebufferRenderbuffer(r,d,Qd,c);else if(Ck(n,c))l.layer!==void 0?n.framebufferTextureLayer(r,d,c,l.level||0,l.layer):n.framebufferTexture2D(r,d,l.target||bpe,c,l.level||0);else throw new Error("unknown attachment type");a.attachments.push(c)}),a}function Rpe(n,e,t,i,r){i=i||n.drawingBufferWidth,r=r||n.drawingBufferHeight,e.width=i,e.height=r,t=t||GG,t.forEach(function(s,o){const a=e.attachments[o],l=s.format,c=s.samples;if(c!==void 0||Qq(n,a))n.bindRenderbuffer(Qd,a),c>1?n.renderbufferStorageMultisample(Qd,c,l,i,r):n.renderbufferStorage(Qd,l,i,r);else if(Ck(n,a))age(n,a,s,i,r);else throw new Error("unknown attachment type")})}function Mpe(n,e,t){const i=n.createVertexArray();return n.bindVertexArray(i),e.length||(e=[e]),e.forEach(function(r){i0(n,r,t)}),n.bindVertexArray(null),{numElements:t.numElements,elementType:t.elementType,vertexArrayObject:i}}const Fpe=/^(.*?)_/;function Ope(n,e){AN(n,0);const t=n.getExtension(e);if(t){const i={},r=Fpe.exec(e)[1],s="_"+r;for(const o in t){const a=t[o],l=typeof a=="function",c=l?r:s;let h=o;o.endsWith(c)&&(h=o.substring(0,o.length-c.length)),n[h]!==void 0?!l&&n[h]!==a&&Xq(h,n[h],a,o):l?n[h]=function(u){return function(){return u.apply(t,arguments)}}(a):(n[h]=a,i[h]=a)}i.constructor={name:t.constructor.name},AN(i,0)}return t}const z8=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function KG(n){for(let e=0;e<z8.length;++e)Ope(n,z8[e])}function Ppe(n,e){const t=["webgl2","webgl","experimental-webgl"];let i=null;for(let r=0;r<t.length;++r)if(i=n.getContext(t[r],e),i){KG(i);break}return i}function Bpe(n,e){return Ppe(n,e)}const Vpe=`/**
 * The vertex position wrt the rectangle specified by (x, x2, y, y2).
 * [0, 0] = [x, y], [1, 1] = [x2, y2]. 
 * The x or y component may contain fractional values if the rectangle 
 * have been tessellated.
 */
in vec2 frac;

/** Minimum size (width, height) of the displayed rectangle in pixels */
uniform vec2 uMinSize;

/** Minimum opacity for the size size clamping */
uniform float uMinOpacity;

/** top-right, bottom-right, top-left, bottom-left */
uniform vec4 uCornerRadii;

out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out float vHalfStrokeWidth;
out vec4 vCornerRadii;


#if defined(ROUNDED_CORNERS) || defined(STROKED)
/** Position for SDF-strokes */
out vec2 vPosInPixels;
#endif

/** Size of the rect in pixels */
out vec2 vHalfSizeInPixels;

/**
 * Clamps the minimumSize and returns an opacity that reflects the amount of clamping.
 */
float clampMinSize(inout float pos, float frac, float size, float minSize) {
    if (minSize > 0.0 && abs(size) < minSize) {
        pos += (frac - 0.5) * (minSize * sign(size) - size);
        return abs(size) / minSize;
    }

    return 1.0;
}

void sort(inout float a, inout float b) {
    if (a > b) {
        float tmp = b;
        b = a;
        a = tmp;
    }
}

void main(void) {
    vec2 normalizedMinSize = uMinSize / uViewportSize;

    float x = getScaled_x();
    float x2 = getScaled_x2();
    float y = getScaled_y();
    float y2 = getScaled_y2();

    sort(x, x2);
    sort(y, y2);

    // Clamp x to prevent precision artifacts when the scale is zoomed very close.
	// TODO: clamp y as well
	float clampMargin = 1.0;
    vec2 pos1 = vec2(clamp(x, 0.0 - clampMargin, 1.0 + clampMargin), y);
    vec2 pos2 = vec2(clamp(x2, 0.0 - clampMargin, 1.0 + clampMargin), y2);

    vec2 size = pos2 - pos1;

    if (size.x <= 0.0 || size.y <= 0.0) {
        // Early exit. May increase performance or not...
        gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
        return;
    }

    vec2 pos = pos1 + frac * size;

    size.y *= getSampleFacetHeight(pos);

    // Clamp to minimum size, optionally compensate with opacity
    float opaFactor = uViewOpacity * max(uMinOpacity,
        clampMinSize(pos.x, frac.x, size.x, normalizedMinSize.x) *
        clampMinSize(pos.y, frac.y, size.y, normalizedMinSize.y));

    pos = applySampleFacet(pos);

#if defined(ROUNDED_CORNERS) || defined(STROKED)
    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = 1.0 / uDevicePixelRatio;
    float strokeWidth = getScaled_strokeWidth();
    float strokeOpacity = getScaled_strokeOpacity() * opaFactor;

    vec2 centeredFrac = frac - 0.5;
    vec2 expand = centeredFrac * (strokeWidth + aaPadding) / uViewportSize;
    pos += expand;

    vec2 sizeInPixels = size * uViewportSize;
    vPosInPixels = (centeredFrac + expand / size) * sizeInPixels;

    vHalfSizeInPixels = sizeInPixels / 2.0;

    vCornerRadii = min(uCornerRadii, min(vHalfSizeInPixels.x, vHalfSizeInPixels.y));
    vHalfStrokeWidth = strokeWidth / 2.0;
    vStrokeColor = vec4(getScaled_stroke() * strokeOpacity, strokeOpacity);
#endif

    gl_Position = unitToNdc(pos);

    float fillOpacity = getScaled_fillOpacity() * opaFactor;
    vFillColor = vec4(getScaled_fill() * fillOpacity, fillOpacity);

    setupPicking();
}
`,Wpe=`#if defined(ROUNDED_CORNERS) || defined(STROKED)
in vec2 vPosInPixels;
#endif

in vec2 vHalfSizeInPixels;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in float vHalfStrokeWidth;
in vec4 vCornerRadii;

out lowp vec4 fragColor;

// Source: https://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
float sdRoundedBox(vec2 p, vec2 b, vec4 r) {
    r.xy = p.x > 0.0 ? r.xy : r.zw;
    r.x  = p.y > 0.0 ? r.x  : r.y;
    vec2 q = abs(p) - b + r.x;
    return min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - r.x;
}

// Not a true SDF. Makes the corners of strokes sharp and is faster.
float sdSharpBox(vec2 p, vec2 b) {
    vec2 q = abs(p) - b;
    return max(q.x, q.y);
}

void main(void) {

#if defined(ROUNDED_CORNERS) || defined(STROKED)
#ifdef ROUNDED_CORNERS
    // Distance from rectangle's edge in pixels. Negative inside the rectangle.
    float d = sdRoundedBox(vPosInPixels, vHalfSizeInPixels, vCornerRadii);
#else
    float d = sdSharpBox(vPosInPixels, vHalfSizeInPixels);
#endif

    fragColor = distanceToColor(d, vFillColor, vStrokeColor, vHalfStrokeWidth);

    if (fragColor.a == 0.0) {
        discard;
    }
#else
    // The trivial, non-decorated case
    fragColor = vFillColor;
#endif

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,A4="attr_",ZG="uDomain_",$pe="range_",H8="scale_",YG="getScaled_",VN="uRangeTexture_",U8=3402823466e29;function zpe(n){const e=n.match(/^(?:(\w+)-)?(\w+)$/);if(!e)throw new Error("Not a scale type: "+n);return{family:e[1]||"continuous",transform:e[2]}}function Hpe(n,e){let t;if(yk(n))t=Jd(Zq(n)(e));else if(un(e))if(Sf(n))t=jpe(e);else throw new Error(`String values are not supported on the "${n}" channel: ${e}`);else if(ek(e))t=Jd(e?1:0);else if(e===null)if(Sf(n))t=Jd([0,0,0]);else throw new Error(`null value is not supported on the "${n}" chanel.`);else t=Jd(e);return`
#define ${n}_DEFINED
${t.type} ${YG}${n}() {
    // Constant value
    return ${t};
}`}function Upe(n,e,t){if(za(t))throw new Error(`Cannot create scale for "value": ${JSON.stringify(t)}`);if(!e)throw new Error("Scale is undefined");const i=qf(n),r=A4+n,s=ZG+i,o=$pe+i,a=$x(e.type),l=a?"vec2":"float",c=e.domain?e.domain().length:void 0;let h;const u=[];u.push(""),u.push("/".repeat(70)),u.push(`// Channel: ${n}`),u.push(""),u.push(`#define ${n}_DEFINED`);const{transform:d}=zpe(e.type),f=(C,...D)=>qpe.apply(null,[C,"value",...D]);let g;switch(d){case"linear":g=f("scaleLinear","domain",o);break;case"log":g=f("scaleLog","domain",o,e.base());break;case"symlog":g=f("scaleSymlog","domain",o,e.constant());break;case"pow":case"sqrt":g=f("scalePow","domain",o,e.exponent());break;case"index":case"locus":g=f("scaleBandHp","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"point":case"band":g=f("scaleBand","domain",o,e.paddingInner(),e.paddingOuter(),e.align(),t.band??.5);break;case"ordinal":case"null":case"identity":g=f("scaleIdentity");break;case"threshold":break;default:throw new Error(`Unsupported scale type: ${e.type}! ${n}: ${JSON.stringify(t)}`)}const p=bk(e.type)||Pr(e.type)&&Sf(n)?[0,1]:e.range?e.range():void 0;if(p&&n==i&&p.length&&p.every(Os)){const C=j8(p);u.push(`const ${C.type} ${o} = ${C};`)}const m=Sf(n)?"vec3":"float";let b;if(Sf(n)){const C=VN+i;if(n==i&&u.push(`uniform sampler2D ${C};`),Pr(e.type))b=`getInterpolatedColor(${C}, transformed)`;else if(Vu(e.type)||Mp(e.type))b=`getDiscreteColor(${C}, int(transformed))`;else throw new Error("Problem with color scale!")}else if(e.type==="ordinal"||Mp(e.type)){const C=VN+i;n==i&&u.push(`uniform sampler2D ${C};`),b=`getDiscreteColor(${C}, int(transformed)).r`}H1(t)?u.push(`uniform highp ${l} ${r};`):u.push(`in highp ${l} ${r};`);const _=[],w=Pr(e.type)&&c>2,y=Mp(e.type)||w;if(_.push("int slot = 0;"),y){const C=s;_.push(w?`while (slot < ${C}.length() - 2 && value >= ${C}[slot + 1]) { slot++; }`:`while (slot < ${C}.length() && value >= ${C}[slot]) { slot++; }`)}const S=Pr(e.type)||Mp(e.type)||["band","point"].includes(e.type);if(g){const C=s;S&&(a?_.push(`vec3 domain = ${C};`):_.push(`vec2 domain = vec2(${C}[slot], ${C}[slot + 1]);`)),_.push(`float transformed = ${g};`),w&&_.push(`transformed = (float(slot) + transformed) / (float(${C}.length() - 1));`)}else _.push("float transformed = float(slot);");"clamp"in e&&e.clamp()&&_.push(`transformed = clampToRange(transformed, ${j8(p)});`),_.push(`return ${b??"transformed"};`),u.push(`
${m} ${H8}${n}(${l} value) {
${_.map(C=>`    ${C}
`).join("")}
}`),u.push(`
${m} ${YG}${n}() {
    return ${H8}${n}(${r});
}`);const k=u.join(`
`);if(S&&n==i){const C=Pr(e.type)||Mp(e.type)?c:2;h=a?`highp vec3 ${s};`:`mediump float ${s}[${C}];`}return{glsl:k,domainUniform:h}}function WN(n){if(!Os(n))throw new Error(`Not a number: ${n}`);if(n==1/0)return""+U8;if(n==-1/0)return""+-U8;{let e=`${n}`;return/^(-)?\d+$/.test(e)&&(e+=".0"),e}}function Jd(n){typeof n=="number"&&(n=[n]);const e=n.length;if(e<1||e>4)throw new Error("Invalid number of components: "+e);let t,i;return e>1?(t=`vec${e}`,i=`${t}(${n.map(WN).join(", ")})`):(t="float",i=WN(n[0])),Object.assign(i,{type:t,numComponents:e})}function jpe(n){const e=Pu(n).rgb();return Jd([e.r,e.g,e.b].map(t=>t/255))}function j8(n){return Jd([n[0],T1(n)])}function qpe(n,...e){const t=[];for(const i of e)Os(i)?t.push(WN(i)):po(i)?t.push(Jd(i)):t.push(i);return`${n}(${t.join(", ")})`}function $x(n){return n=="index"||n=="locus"}const XG=2**11,Gpe=XG-1;function QG(n,e=[]){const t=n&Gpe,i=n-t;return e[0]=i,e[1]=t,e}function Kpe(n){const e=n%XG;return[n-e,e]}function Zpe(n){return[...Kpe(n[0]),n[1]-n[0]]}class Ype{constructor(e){this.size=e,this.arrays={},this.pushers=[],this.dataUpdaters=[],this.vertexCount=0}addConverter(e,t){const i=this.createUpdater(A4+e,t.numComponents||1,t.arrayReference),r=t.f;this.dataUpdaters.push(t.arrayReference?s=>i(r(s)):s=>i(r(s)))}createUpdater(e,t,i){if(!Os(this.size))throw new Error("The number of vertices must be defined!");let r,s,o=0;const a=new Float32Array(this.size*t);if(this.arrays[e]={data:a,numComponents:t},t==1){let l=0;const c=h=>{l=+h};r=()=>{a[o++]=l},s=c}else{let l=i??[0];const c=i?h=>{}:h=>{l=h};switch(t){case 1:break;case 2:r=()=>{a[o++]=l[0],a[o++]=l[1]},s=c;break;case 3:r=()=>{a[o++]=l[0],a[o++]=l[1],a[o++]=l[2]},s=c;break;case 4:r=()=>{a[o++]=l[0],a[o++]=l[1],a[o++]=l[2],a[o++]=l[3]},s=c;break;default:throw new Error("Invalid numComponents: "+t)}}return this.pushers.push(r),s}_unrollPushAll(){let e="",t="";for(let r=0;r<this.pushers.length;r++)e+=`const p${r} = that.pushers[${r}];
`,t+=`p${r}();
`;const i=new Function("that",`${e}

            return function unrolledPushAll() {
                ${t}
                that.vertexCount++;
            };
        `);this.pushAll=i(this)}pushAll(){this.size>1e5?this._unrollPushAll():this.pushAll=()=>{for(let t=0;t<this.pushers.length;t++)this.pushers[t]();this.vertexCount++},this.pushAll()}updateFromDatum(e){for(let t=0;t<this.dataUpdaters.length;t++)this.dataUpdaters[t](e)}pushFromDatum(e){this.updateFromDatum(e),this.pushAll()}}const Up=5,H2=127;function $N(n){const e=[];for(let g=0;g<=H2;g++)e.push(void 0);const t=new Map;for(const g of n.chars)g.id<=H2?e[g.id]=g:t.set(g.id,g);const i=8722;t.has(i)||t.set(i,e["-".charCodeAt(0)]);function r(g){return(g<=H2?e[g]:t.get(g))||e[63]}function s(g){return r(g.charCodeAt(0))}const o=n.common.base,a=s("x"),l=s("X"),c=s("q"),h=a.height-Up*2,u=l.height-Up*2,d=c.height-a.height+c.yoffset-a.yoffset;function f(g,p=1){let m=0;for(let b=0;b<g.length;b++)m+=r(g.charCodeAt(b)).xadvance;return m/o*p}return{measureWidth:f,getCharByCode:r,getChar:s,xHeight:h,capHeight:u,descent:d,common:n.common}}function Xpe(n,e=0,t=1){return Math.max(e,Math.min(t,n))}const q8=2**31-1,Qpe=-(2**31);function Jpe(n,e,t,i=t){const r=new Int32Array(n);r.fill(q8);let s=Qpe,o=!1;const a=new Int32Array(n),l=e[0],h=(e[1]-e[0])/n,u=(m,b)=>{const _=(m-l)/h,w=Math.floor(_);return Xpe(b&&w==_?w-1:w,0,n-1)};function d(m,b,_){b>s?s=b:o||(o=!0,console.debug("Items are not ordered properly. Disabling binned index."));const w=t(m),y=u(w,!1);r[y]>b&&(r[y]=b),a[y]<_&&(a[y]=_)}function f(m,b,_){b>s?s=b:o||(o=!0,console.debug("Items are not ordered properly. Disabling binned index."));const w=t(m),y=i(m),S=u(w,!1),k=u(y,!0);for(let C=S;C<=k;C++)r[C]>b&&(r[C]=b),a[C]<_&&(a[C]=_)}const g=(m,b,_=[0,0])=>{const w=u(m,!1),y=u(b,!0),S=r[w],k=Math.max(a[y],S);return _[0]=S,_[1]=k,_},p=()=>{for(let b=1;b<a.length;b++)a[b]<a[b-1]&&(a[b]=a[b-1]);let m=!0;for(let b=r.length-1;b>0;b--)m&&r[b]==q8?(r[b]=a[b],m=!1):r[b-1]>r[b]&&(r[b-1]=r[b]);return g};if(d.getIndex=p,f.getIndex=p,!o)return t==i?d:f}class q1{constructor({encoders:e,numVertices:t=void 0,attributes:i=[]}){this.encoders=e,this.variableEncoders=Object.fromEntries(Object.entries(e).filter(([r,s])=>i.includes(r)&&s&&s.scale&&!s.constant)),this.allocatedVertices=t,this.variableBuilder=new Ype(t);for(const[r,s]of Object.entries(this.variableEncoders)){const o=s.accessor,a=[0,0],l=$x(s.scale.type),c=s.indexer,h=c?u=>c(o(u)):l?u=>QG(o(u),a):o;this.variableBuilder.addConverter(r,{f:h,numComponents:l?2:1,arrayReference:l?a:void 0})}this.lastOffset=0,this.rangeMap=new Wf([],JSON.stringify)}registerBatch(e){var s;const t=this.lastOffset,i=this.variableBuilder.vertexCount,r=i-t;r&&this.rangeMap.set(e,{offset:t,count:r,xIndex:(s=this.xIndexer)==null?void 0:s.getIndex()}),this.lastOffset=i}addBatches(e){for(const[t,i]of e)this.addBatch(t,i)}addBatch(e,t,i=0,r=t.length){this.prepareXIndexer(t,i,r);for(let s=i;s<r;s++){const o=t[s];this.variableBuilder.pushFromDatum(o),this.addToXIndex(o)}this.registerBatch(e)}prepareXIndexer(e,t=0,i=t+e.length){const r=()=>{this.addToXIndex=l=>{},this.xIndexer=void 0};if(!e.length||i-t<0){r();return}const s=l=>{var c;return l&&Pr((c=l.scale)==null?void 0:c.type)&&l},o=s(this.variableEncoders.x),a=s(this.variableEncoders.x2);if(o){const l=o.accessor,c=a?a.accessor:l,h=[l(e[t]),c(e[i-1])];if(h[1]>h[0]){this.xIndexer=Jpe(50,h,l,c);let u=this.variableBuilder.vertexCount;this.addToXIndex=d=>{let f=this.variableBuilder.vertexCount;this.xIndexer(d,u,f),u=f}}else r()}else r()}addToXIndex(e){}toArrays(){return{arrays:this.variableBuilder.arrays,vertexCount:this.variableBuilder.vertexCount,allocatedVertices:this.allocatedVertices,rangeMap:this.rangeMap}}}class eme extends q1{constructor({encoders:e,attributes:t,tessellationThreshold:i=1/0,visibleRange:r=[-1/0,1/0],numItems:s}){super({encoders:e,attributes:t,numVertices:i==1/0?s*6:void 0}),this.visibleRange=r,this.tessellationThreshold=i||1/0,this.updateFrac=this.variableBuilder.createUpdater("frac",2)}addBatch(e,t,i=0,r=t.length){if(r<=i)return;const s=this.encoders,[o,a]=this.visibleRange,l=d=>d.accessor||(f=>0),c=l(s.x),h=l(s.x2);this.prepareXIndexer(t,i,r);const u=[0,0];this.updateFrac(u);for(let d=i;d<r;d++){const f=t[d];let g=c(f),p=h(f);if(g>p&&([g,p]=[p,g]),p<o||g>a)continue;g<o&&(g=o),p>a&&(p=a),this.variableBuilder.updateFromDatum(f),u[0]=0,u[1]=0;const m=1;this.variableBuilder.pushAll();for(let b=0;b<=m;b++)u[0]=b/m,u[1]=0,this.variableBuilder.pushAll(),u[1]=1,this.variableBuilder.pushAll();this.variableBuilder.pushAll(),this.addToXIndex(f)}this.registerBatch(e)}}class tme extends q1{constructor({encoders:e,attributes:t,tessellationThreshold:i=1/0,visibleRange:r=[-1/0,1/0],numItems:s}){super({encoders:e,attributes:t,numVertices:i==1/0?s*6:void 0}),this.visibleRange=r,this.tessellationThreshold=i||1/0,this.updateSide=this.variableBuilder.createUpdater("side",1),this.updatePos=this.variableBuilder.createUpdater("pos",1)}addBatch(e,t,i=0,r=t.length){this.prepareXIndexer(t,i,r);for(let s=i;s<r;s++){const o=t[s];this.variableBuilder.updateFromDatum(o),this.updateSide(-.5),this.updatePos(0),this.variableBuilder.pushAll();const a=1;for(let l=0;l<=a;l++)this.updatePos(l/a),this.updateSide(-.5),this.variableBuilder.pushAll(),this.updateSide(.5),this.variableBuilder.pushAll();this.variableBuilder.pushAll(),this.addToXIndex(o)}this.registerBatch(e)}}class ime extends q1{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i})}}class nme extends q1{constructor({encoders:e,attributes:t,numItems:i=void 0}){super({encoders:e,attributes:t,numVertices:i})}toArrays(){const e=this.variableBuilder.arrays;for(let t of Object.values(e))t.divisor=1;return super.toArrays()}}class rme extends q1{constructor({encoders:e,attributes:t,fontMetrics:i,properties:r,numCharacters:s=void 0}){super({encoders:e,attributes:t,numVertices:s*6}),this.metadata=i,this.metrics=i,this.properties=r;const a=e.text.channelDef;this.numberFormat=!za(a)&&"format"in a&&a.format?Cr(a.format):l=>l,this.updateVertexCoord=this.variableBuilder.createUpdater("vertexCoord",2),this.updateTextureCoord=this.variableBuilder.createUpdater("textureCoord",2),this.updateWidth=this.variableBuilder.createUpdater("width",1)}addBatch(e,t,i=0,r=t.length){const s=this.properties.align||"left",o=this.properties.logoLetters??!1,a=this.metadata.common.base,l=this.metadata.common.scaleH;let c=-Up;switch(this.properties.baseline){case"top":c+=this.metrics.capHeight;break;case"middle":c+=this.metrics.capHeight/2;break;case"bottom":c-=this.metrics.descent;break}const h=this.encoders.text.accessor||this.encoders.text,u=[0,0];this.updateVertexCoord(u);const d=[0,0];this.updateTextureCoord(d),this.prepareXIndexer(t,i,r);for(let f=i;f<r;f++){const g=t[f],p=this.numberFormat(h(g)),m=un(p)?p:p===null?"":""+p;if(m.length==0)continue;this.variableBuilder.updateFromDatum(g);const b=o?m.length:this.metrics.measureWidth(m);this.updateWidth(b);let _=s=="right"?-b:s=="center"?-b/2:0;if(!o){const k=this.metrics.getCharByCode(m.charCodeAt(0));_-=(k.width-k.xadvance)/a/2}let w=-.5,y=1,S=1;for(let k=0;k<m.length;k++){const C=this.metrics.getCharByCode(m.charCodeAt(k)),D=o?1:C.xadvance/a;if(C.id==32){_+=D;continue}o?(S=(C.width+Up*2)/C.width,_=-S/2,y=(C.height+Up*2)/C.height,w=-.5-Up/C.height):(y=C.height/a,w=-(C.height+C.yoffset+c)/a,S=C.width/a);const E=C.x,N=C.y;u[0]=_,u[1]=w+y,d[0]=E/l,d[1]=N/l,this.variableBuilder.pushAll(),u[0]=_+S,u[1]=w+y,d[0]=(E+C.width)/l,d[1]=N/l,this.variableBuilder.pushAll(),u[0]=_,u[1]=w,d[0]=E/l,d[1]=(N+C.height)/l,this.variableBuilder.pushAll(),u[0]=_+S,u[1]=w+y,d[0]=(E+C.width)/l,d[1]=N/l,this.variableBuilder.pushAll(),u[0]=_,u[1]=w,d[0]=E/l,d[1]=(N+C.height)/l,this.variableBuilder.pushAll(),u[0]=_+S,u[1]=w,d[0]=(E+C.width)/l,d[1]=(N+C.height)/l,this.variableBuilder.pushAll(),_+=D}this.addToXIndex(g)}this.registerBatch(e)}}const G8=`#define PI 3.141593

uniform View {
    /** Offset in "unit" units */
    mediump vec2 uViewOffset;
    mediump vec2 uViewScale;
    /** Size of the logical viewport in pixels, i.e., the view */
    mediump vec2 uViewportSize;
    lowp float uDevicePixelRatio;
    // TODO: Views with opacity less than 1.0 should be rendered into a texture
    // that is rendered with the specified opacity.
    lowp float uViewOpacity;
    bool uPickingEnabled;
};


/**
 * Maps a coordinate on the unit scale to a normalized device coordinate.
 * (0, 0) is at the bottom left corner.
 */
vec4 unitToNdc(vec2 coord) {
    return vec4((coord * uViewScale + uViewOffset) * 2.0 - 1.0, 0.0, 1.0);
}

vec4 unitToNdc(float x, float y) {
    return unitToNdc(vec2(x, y));
}

vec4 pixelsToNdc(vec2 coord) {
    return unitToNdc(coord / uViewportSize);
}

vec4 pixelsToNdc(float x, float y) {
    return pixelsToNdc(vec2(x, y));
}

float linearstep(float edge0, float edge1, float x) {
    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
}

// Fragment shader stuff ////////////////////////////////////////////////////////

// TODO: include the following only in fragment shaders

/**
 * Specialized linearstep for doing antialiasing
 */
float distanceToRatio(float d) {
	return clamp(d * uDevicePixelRatio + 0.5, 0.0, 1.0);
}

vec4 distanceToColor(float d, vec4 fill, vec4 stroke, float halfStrokeWidth) {
    if (halfStrokeWidth > 0.0) {
        // Distance to stroke's edge. Negative inside the stroke.
        float sd = abs(d) - halfStrokeWidth;
        return mix(
            stroke,
            d <= 0.0 ? fill : vec4(0.0),
            distanceToRatio(sd));
    } else {
        return fill * distanceToRatio(-d);
    }
}
`,sme=`const float inf = 1.0 / 0.0;

// Utils ------------

vec3 getDiscreteColor(sampler2D s, int index) {
    return texelFetch(s, ivec2(index % textureSize(s, 0).x, 0), 0).rgb;
}

vec3 getInterpolatedColor(sampler2D s, float unitValue) {
    return texture(s, vec2(unitValue, 0.0)).rgb;
}

float clampToRange(float value, vec2 range) {
    return clamp(value, min(range[0], range[1]), max(range[0], range[1]));
}

// Scales ------------
// Based on d3 scales: https://github.com/d3/d3-scale

float scaleIdentity(float value) {
    return value;
}

float scaleLinear(float value, vec2 domain, vec2 range) {
    float domainSpan = domain[1] - domain[0];
    float rangeSpan = range[1] - range[0];
    return (value - domain[0]) / domainSpan * rangeSpan + range[0];
}

float scaleLog(float value, vec2 domain, vec2 range, float base) {
    // y = m log(x) + b 
    // TODO: Perf optimization: precalculate log domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(log(value) / log(base), log(domain) / log(base), range);
}

float symlog(float value, float constant) {
    // WARNING: emulating log1p with log(x + 1). Small numbers are likely to
    // have significant precision problems.
    return sign(value) * log(abs(value / constant) + 1.0);
}

float scaleSymlog(float value, vec2 domain, vec2 range, float constant) {
    return scaleLinear(
        symlog(value, constant),
        vec2(symlog(domain[0], constant), symlog(domain[1], constant)),
        range
    );
}

float scalePow(float value, vec2 domain, vec2 range, float exponent) {
    // y = mx^k + b
    // TODO: Perf optimization: precalculate pow domain in js.
    // TODO: Reversed domain, etc
    return scaleLinear(
        pow(abs(value), exponent) * sign(value),
        pow(abs(domain), vec2(exponent)) * sign(domain),
        range
    );
}

// TODO: scaleThreshold
// TODO: scaleQuantile (special case of threshold scale)

float scaleBand(float value, vec2 domainExtent, vec2 range,
                float paddingInner, float paddingOuter,
                float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    float n = domainExtent[1] - domainExtent[0];

    // This fix departs from Vega and d3: https://github.com/vega/vega/issues/3357#issuecomment-1063253596
    paddingInner = int(n) > 1 ? paddingInner : 0.0;

    // Adapted from: https://github.com/d3/d3-scale/blob/master/src/band.js
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    return start + (value - domainExtent[0]) * step + bandwidth * band;
}

// High precision variant of scaleBand for index/locus scales
float scaleBandHp(vec2 value, vec3 domainExtent, vec2 range,
                 float paddingInner, float paddingOuter,
                 float align, float band) {

    // TODO: reverse
    float start = range[0];
    float stop = range[1];
    float rangeSpan = stop - start;

    vec2 domainStart = domainExtent.xy;
    float n = domainExtent[2];

    // The following computation is identical for every vertex. Could be done on the JS side.
    float step = rangeSpan / max(1.0, n - paddingInner + paddingOuter * 2.0);
    start += (rangeSpan - step * (n - paddingInner)) * align;
    float bandwidth = step * (1.0 - paddingInner);

    // Using max to prevent the shader compiler from wrecking the precision.
    // Othwewise the compiler could optimize the sum of the four terms into
    // some equivalent form that does premature rounding.
    float hi = max(value[0] - domainStart[0], -inf);
    float lo = max(value[1] - domainStart[1], -inf);

    return dot(vec4(start, hi, lo, bandwidth), vec4(1.0, step, step, band));
}
`,ome=`
/**
 * Describes where a sample facet should be shown. Interpolating between the
 * current and target positions/heights allows for transitioning between facet
 * configurations.
 */
struct SampleFacetPosition {
    float pos;
    float height;
    float targetPos;
    float targetHeight;
};

/**
 * Trasition fraction [0, 1] between the current and target configurations.
 */
uniform float uTransitionOffset;


// ----------------------------------------------------------------------------

#if !defined(SAMPLE_FACET_UNIFORM) && !defined(SAMPLE_FACET_TEXTURE)

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

#elif defined(SAMPLE_FACET_UNIFORM)

/**
 * Location and height of the band on the Y axis on a normalized [0, 1] scale.
 * Elements: curr pos, curr height, target pos, target height
 */
uniform vec4 uSampleFacet;

SampleFacetPosition getSampleFacetPos() {
    return SampleFacetPosition(
        1.0 - uSampleFacet.x - uSampleFacet.y,
        uSampleFacet.y,
        1.0 - uSampleFacet.z - uSampleFacet.w,
        uSampleFacet.w
    );
}

#elif defined(SAMPLE_FACET_TEXTURE)

uniform sampler2D uSampleFacetTexture;

SampleFacetPosition getSampleFacetPos() {
    vec4 texel = texelFetch(uSampleFacetTexture, ivec2(int(attr_facetIndex), 0), 0);
    return SampleFacetPosition(
        1.0 - texel.r - texel.g,
        texel.g,
        1.0 - texel.r - texel.g,
        texel.g);
}

#endif

// ----------------------------------------------------------------------------

bool isFacetedSamples(SampleFacetPosition facetPos) {
    return facetPos != SampleFacetPosition(0.0, 1.0, 0.0, 1.0);
}

bool isFacetedSamples() {
    return isFacetedSamples(getSampleFacetPos());
}

bool isInTransit() {
    return uTransitionOffset > 0.0;
}

float getTransitionFraction(float xPos) {
    return smoothstep(0.0, 0.7 + uTransitionOffset, (xPos - uTransitionOffset) * 2.0);
}

vec2 applySampleFacet(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return pos;
    } else if (isInTransit()) {
        vec2 interpolated = mix(
            vec2(facetPos.pos, facetPos.height),
            vec2(facetPos.targetPos, facetPos.targetHeight),
            getTransitionFraction(pos.x));
        return vec2(pos.x, interpolated[0] + pos.y * interpolated[1]);
    } else {
        return vec2(pos.x, facetPos.pos + pos.y * facetPos.height);
    }
}

float getSampleFacetHeight(vec2 pos) {
    SampleFacetPosition facetPos = getSampleFacetPos();

    if (!isFacetedSamples(facetPos)) {
        return 1.0;
    } else if (isInTransit()) {
        return mix(
            facetPos.height,
            facetPos.targetHeight,
            getTransitionFraction(pos.x));
    } else {
        return facetPos.height;
    }
}
`,ame=`/*
 * Based on concepts presented at:
 * https://webglfundamentals.org/webgl/lessons/webgl-picking.html
 * https://deck.gl/docs/developer-guide/custom-layers/picking
 */

out highp vec4 vPickingColor;

/**
 * Passes the unique id to the fragment shader as a color if picking is enabled.
 * Returns true if picking is enabled.
 */
bool setupPicking() {
    if (uPickingEnabled) {
#ifdef uniqueId_DEFINED
        int id = int(getScaled_uniqueId());
        // TODO: Take the sign bit into account
        vPickingColor = vec4(
            ivec4(id >> 0, id >> 8, id >> 16, 0xFF) & 0xFF
        ) / float(0xFF);
#else
        vPickingColor = vec4(1.0);
#endif
        return true;
    }
    return false;
}
`,lme=`in highp vec4 vPickingColor;
`,pS=Symbol("cacheMap");function s_(n,e,t){let i=Yv(n).get(e);return i===void 0&&(i=t(e),Yv(n).set(e,i)),i}function JG(n,e){Yv(n).delete(e)}function mS(n,e){const t=Yv(n);for(const i of t.keys())i.startsWith(e)&&t.delete(i);Yv(n).delete(e)}function eK(n){n[pS]=new Map}function Yv(n){return n[pS]||eK(n),n[pS]}function cme(n,e,t,i){const r=un(n)?n:n.name,s=!un(n)&&n.extent||[0,1];if(t===void 0&&!un(n)&&(t=n.count),r){const o=h4(r);if(Ms(o)){const a=tK(o,{extent:s,count:t});return Rk(e,{minMag:e.LINEAR,format:e.RGB,height:1,wrap:e.CLAMP_TO_EDGE},a,i)}else{if(po(o))return zN(o,e);throw new Error("Unknown scheme: "+r)}}}function hme(n,e="rgb",t,i){const r=vk(n,un(e)?e:e.type,un(e)?void 0:e.gamma),s=tK(r);return Rk(t,{minMag:t.LINEAR,format:t.RGB,height:1,wrap:t.CLAMP_TO_EDGE},s,i)}function ume(n,e,t,i){const r=Math.max(n.length,t||0),s=new Float32Array(r);for(let o=0;o<r;o++)s[o]=n[o%n.length];return Rk(e,{minMag:e.NEAREST,format:e.RED,internalFormat:e.R32F,height:1},s,i)}function zN(n,e,t,i){const r=iK(n,t);return Rk(e,{minMag:e.NEAREST,format:e.RGB,height:1},r,i)}function tK(n,{extent:e=[0,1],reverse:t=!1,count:i=256}={}){const r=e[0],s=T1(e)-r,o=Rv(i).map(a=>a/(i-1)).map(a=>r+a/s).map(n);return t&&o.reverse(),iK(o)}function iK(n,e){const t=Math.max(n.length,e||0),i=new Uint8Array(t*3);for(let r=0;r<t;r++){const s=Pu(n[r%n.length]).rgb();i[r*3+0]=s.r,i[r*3+1]=s.g,i[r*3+2]=s.b}return i}class dme{constructor(e,t,i){this._container=e,this._sizeSource=t,this._shaderCache=new Map,this._listeners=[],this.rangeTextures=new WeakMap;const r=document.createElement("canvas");e.appendChild(r);const s=Bpe(r,{antialias:!0,depth:!1,premultipliedAlpha:!0});if(!s)throw new Error("Unable to initialize WebGL. Your browser or machine may not support it.");if(!e0(s))throw new Error("Your web browser does not support WebGL 2.0. Chrome, Firefox, and Safari Tech Preview should work.");if(KG(s),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.canvas=r,this.gl=s,this._pickingAttachmentOptions=[{format:s.RGBA,type:s.UNSIGNED_BYTE,minMag:s.LINEAR,wrap:s.CLAMP_TO_EDGE}],this._pickingBufferInfo=Npe(s,this._pickingAttachmentOptions),s.bindFramebuffer(s.FRAMEBUFFER,null),this.adjustGl(),this._resizeObserver=new ResizeObserver(o=>{this.invalidateSize(),this._emit("resize")}),this._resizeObserver.observe(this._container),this._updateDpr(),this._clearColor=[0,0,0,0],i){const o=Pu(i).rgb();this._clearColor=[o.r/255,o.g/255,o.b/255,o.opacity]}}invalidateSize(){this._logicalCanvasSize=void 0,this._updateDpr(),this.adjustGl()}_updateDpr(){this.dpr=window.devicePixelRatio}compileShader(e,t){const i="#version 300 es",r="precision mediump float;";po(t)&&(t=t.join(`

`));const s=this.gl,o=t.replaceAll(/ {2,}|^\s*\/\/.*$/gm,"");let a=this._shaderCache.get(o);if(!a){const l=[i,r,t].join(`

`);a=s.createShader(e),s.shaderSource(a,l),s.compileShader(a),this._shaderCache.set(o,a)}return a}adjustGl(){const e=this.getLogicalCanvasSize();this.canvas.style.width=`${e.width}px`,this.canvas.style.height=`${e.height}px`;const t=this.getPhysicalCanvasSize(e);this.canvas.width=t.width,this.canvas.height=t.height,Rpe(this.gl,this._pickingBufferInfo,this._pickingAttachmentOptions)}finalize(){this._resizeObserver.unobserve(this._container),this.canvas.remove()}getPhysicalCanvasSize(e){return e=e||this.getLogicalCanvasSize(),{width:e.width*this.dpr,height:e.height*this.dpr}}getLogicalCanvasSize(){var s;if(this._logicalCanvasSize)return this._logicalCanvasSize;const e=((s=this._sizeSource)==null?void 0:s.call(this))??{width:void 0,height:void 0},t=window.getComputedStyle(this._container,null),i=e.width??this._container.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),r=e.height??this._container.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom);return this._logicalCanvasSize={width:i,height:r},this._logicalCanvasSize}addEventListener(e,t){this._listeners.push({type:e,listener:t})}_emit(e){for(const t of this._listeners)t.type===e&&t.listener()}readPickingPixel(e,t){const i=this.gl;e*=this.dpr,t*=this.dpr;const r=this.getPhysicalCanvasSize().height,s=new Uint8Array(4);return i.bindFramebuffer(i.FRAMEBUFFER,this._pickingBufferInfo.framebuffer),i.readPixels(e,r-t-1,1,1,i.RGBA,i.UNSIGNED_BYTE,s),i.bindFramebuffer(i.FRAMEBUFFER,null),s}clearAll(){const e=this.gl,{width:t,height:i}=this.getPhysicalCanvasSize();e.viewport(0,0,t,i),e.disable(e.SCISSOR_TEST),e.clearColor(...this._clearColor),e.clear(e.COLOR_BUFFER_BIT)}createRangeTexture(e,t=!1){const i=this.rangeTextures.get(e);if(!t&&i)return;function r(o,a){return Vu(a.type)?a.domain().length:a.type=="threshold"?a.domain().length+1:a.type=="quantize"||a.type=="quantile"?o??4:o}const s=e.channel;if(Sf(s)){const o=e.getScaleProps(),a=e.getScale(),l=a.range();let c;if(o.scheme)if(a.type=="threshold"&&l)c=zN(l,this.gl,a.domain().length,i);else{let h=un(o.scheme)?void 0:o.scheme.count;h=r(h,a),c=cme(o.scheme,this.gl,h,i)}else bk(a.type)||Pr(a.type)&&l.length>2?c=hme(l,o.interpolate,this.gl,i):c=zN(l,this.gl,a.domain().length,i);this.rangeTextures.set(e,c)}else{const o=e.getScale();if(o.type==="ordinal"||Mp(o.type)){const a=yk(s)?Zq(s):c=>c,l=e.getScale().range();this.rangeTextures.set(e,ume(l.map(a),this.gl,o.domain().length,i))}}}}function fme(n,e="",t=0){const i=/ERROR:\s*\d+:(\d+)/gi,r=[...e.matchAll(i)],s=new Map(r.map((o,a)=>{const l=parseInt(o[1]),c=r[a+1],h=c?c.index:e.length,u=e.substring(o.index,h);return[l-1,u]}));return n.split(`
`).map((o,a)=>{const l=s.get(a);return`${a+1+t}: ${o}${l?`

^^^ ${l}`:""}`}).join(`
`)}function gme(n,e,t){const i=n.createProgram();n.attachShader(i,e),n.attachShader(i,t),n.linkProgram(i);function r(){let s,o;if(!n.getProgramParameter(i,n.LINK_STATUS)){s=n.getProgramInfoLog(i);for(const l of[e,t])n.getShaderParameter(l,n.COMPILE_STATUS)||(s=n.getShaderInfoLog(l),o=fme(n.getShaderSource(l),s,0)+`
Error compiling: ${s}`,n.deleteShader(l));n.deleteProgram(i)}if(s)return{message:s,detail:o}}return{program:i,getProgramErrors:r}}function Rk(n,e,t,i){return i?mG(n,i,t,e):i=Zv(n,{...e,src:t}),i}function pme(...n){const e={get(t,i,r){for(const s of n){const a=s()[i];if(a!==void 0)return a}},has(t,i,r){for(const s of n){const o=s();if(i in o)return!0}return!1}};return new Proxy({},e)}function mme(n){return un(n)||Os(n)||ek(n)}const _me="SAMPLE_FACET_UNIFORM",K8="SAMPLE_FACET_TEXTURE";class G1{constructor(e){this.unitView=e,this.encoders=void 0,this.bufferInfo=void 0,this.programInfo=void 0,this.vertexArrayInfo=void 0,this.domainUniformInfo=void 0,this.viewUniformInfo=void 0,this.rangeMap=new bme,this.defaultProperties={get clip(){return["x","y"].map(t=>e.getScaleResolution(t)).some(t=>(t==null?void 0:t.isZoomable())??!1)},xOffset:0,yOffset:0,minBufferSize:0},this.properties=pme(typeof this.unitView.spec.mark=="object"?()=>this.unitView.spec.mark:()=>({}),()=>this.defaultProperties)}get opaque(){return!1}getAttributes(){throw new Error("Not implemented!")}getSupportedChannels(){return["sample","facetIndex","x","y","color","opacity","search","uniqueId"]}getDefaultEncoding(){const e={sample:void 0,uniqueId:void 0};return this.isPickingParticipant()&&(e.uniqueId={field:"_uniqueId"}),e}fixEncoding(e){return e}get encoding(){return s_(this,"encoding",()=>{const e=this.getDefaultEncoding(),t=this.unitView.getEncoding(),i=o=>{const a=this.properties[o];return mme(a)&&{value:a}},r=Object.fromEntries(this.getSupportedChannels().map(o=>[o,i(o)]).filter(o=>o[1].value!==void 0)),s=this.fixEncoding({...e,...r,...t});for(const o of Object.keys(s))this.getSupportedChannels().includes(o)||delete s[o];return s})}getContext(){return this.unitView.context}getType(){return this.unitView.getMarkType()}initializeData(){}initializeEncoders(){this.encoders=Uue(this)}async initializeGraphics(){}updateGraphicsData(){}getSampleFacetMode(){if(this.encoders.facetIndex)return K8;if(this.unitView.getLayoutAncestors().find(e=>"samples"in e.spec))return _me}createAndLinkShaders(e,t,i=[]){const r=this.getAttributes();i.push("// view: "+this.unitView.getPathString()),this.domainUniforms=[];let s=[];const o=this.getSampleFacetMode();o&&i.push(`#define ${o}`);for(const d of r){let f;if(d in this.encoding)f=d;else continue;const g=this.encoding[f];if(g)if(za(g))s.push(Hpe(f,g.value));else{const p=$o(g)&&g.resolutionChannel||f,m=xf(p)?this.unitView.getScaleResolution(p).getScale():wk(),b=Upe(f,m,g);s.push(b.glsl),b.domainUniform&&this.domainUniforms.push(b.domainUniform)}}const a=this.domainUniforms.length?`layout(std140) uniform Domains {
`+this.domainUniforms.map(d=>`    ${d}
`).join("")+`};

`:"",c=[`precision highp float;
`,...i,G8,sme,a,...s,ome,ame,e],h=[...i,G8,lme,t],u=this.gl;this.programStatus=gme(u,this.glHelper.compileShader(u.VERTEX_SHADER,c),this.glHelper.compileShader(u.FRAGMENT_SHADER,h))}finalizeGraphicsInitialization(){const e=this.programStatus.getProgramErrors();if(e){e.detail&&console.warn(e.detail);const t=new Error("Cannot create shader program: "+e.message);throw t.view=this.unitView,t}this.programInfo=ppe(this.gl,this.programStatus.program),delete this.programStatus,this.domainUniforms.length&&(this.domainUniformInfo=B8(this.gl,this.programInfo,"Domains")),this.viewUniformInfo=B8(this.gl,this.programInfo,"View"),this.gl.useProgram(this.programInfo.program),this._setDatums(),io(this.programInfo,{uSampleFacet:[0,1,0,1],uTransitionOffset:0})}_setDatums(){for(const[e,t]of Object.entries(this.encoding))if(H1(t)){const i=this.encoders[e],r=i.indexer?i.indexer(t.datum):$x(i.scale.type)?QG(+t.datum):+t.datum;io(this.programInfo,{[A4+e]:r})}}deleteGraphicsData(){if(this.bufferInfo){const e=this.gl;for(let t=0;t<8;t++)e.disableVertexAttribArray(t);Object.values(this.bufferInfo.attribs).forEach(t=>this.gl.deleteBuffer(t.buffer)),this.bufferInfo.indices&&this.gl.deleteBuffer(this.bufferInfo.indices),this.bufferInfo=void 0}}updateBufferInfo(e){if(this.gl.bindVertexArray(null),this.bufferInfo&&e.vertexCount<=this.bufferInfo.allocatedVertices)for(const[t,i]of Object.entries(e.arrays))i.data&&kde(this.gl,this.bufferInfo.attribs[t],i.data,0);else this.deleteGraphicsData(),this.bufferInfo=Tde(this.gl,e.arrays,{numElements:e.vertexCount}),this.bufferInfo.allocatedVertices=e.allocatedVertices,this.vertexArrayInfo=void 0}get glHelper(){return this.getContext().glHelper}get gl(){return this.glHelper.gl}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}isReady(){return this.bufferInfo&&this.programInfo}isPickingParticipant(){if(this.properties.tooltip===null)return!1;for(const e of this.unitView.getLayoutAncestors())if(!e.isPickingSupported())return!1;return!0}prepareRender(e){const t=this.glHelper,i=this.gl,r=[];if(r.push(()=>{this.vertexArrayInfo||(this.vertexArrayInfo=Mpe(this.gl,this.programInfo,this.bufferInfo)),i.useProgram(this.programInfo.program)}),this.domainUniformInfo){for(const[o,a]of Object.entries(this.domainUniformInfo.setters)){const l=o.substring(ZG.length),c=this.encoding[l],h=$o(c)&&c.resolutionChannel||l;if(xf(h)){const u=this.unitView.getScaleResolution(h).getScale();r.push(()=>{const d=Vu(u.type)?[0,u.domain().length]:u.domain();a($x(u.type)?Zpe(d):d)})}}r.push(()=>V8(i,this.programInfo,this.domainUniformInfo))}for(const[o,a]of Object.entries(this.encoding))if($o(a)){const l=$o(a)&&a.resolutionChannel||o;if(xf(l)){const c=this.unitView.getScaleResolution(l),h=t.rangeTextures.get(c);h&&r.push(()=>io(this.programInfo,{[VN+o]:h}))}}this.getSampleFacetMode()==K8&&r.push(()=>{let o;for(const a of this.unitView.getLayoutAncestors())if(o=a.getSampleFacetTexture(),o)break;if(!o)throw new Error("No facet texture available. This is bug.");io(this.programInfo,{uSampleFacetTexture:o})});const s=(e.picking??!1)&&this.isPickingParticipant();return r.push(()=>W8(this.viewUniformInfo,{uViewOpacity:this.unitView.getEffectiveOpacity(),uPickingEnabled:s})),this.opaque||e.picking?r.push(()=>i.disable(i.BLEND)):r.push(()=>i.enable(i.BLEND)),r}prepareSampleFacetRendering(e){const t=e.sampleFacetRenderingOptions,i=this.programInfo.uniformSetters.uSampleFacet;if(t&&i){const r=t.locSize?t.locSize.location:0,s=t.locSize?t.locSize.size:1;if(r>1||r+s<0)return!1;const o=t.targetLocSize?t.targetLocSize.location:r,a=t.targetLocSize?t.targetLocSize.size:s;this.gl.uniform4f(i.location,r,s,o,a)}return!0}render(e){}createRenderCallback(e,t){var u;if(!this.bufferInfo){const d=new Error(`${this.getType()} mark has no data. This is bug.`);throw d.view=this.unitView,d}const i=this;let r;const s=(u=this.unitView.getScaleResolution("x"))==null?void 0:u.getScale(),o=s&&Pr(s.type),a=["index","locus"].includes(s==null?void 0:s.type)?-1:0,l=[0,0];r=d=>{if(o&&d.xIndex){const f=s.domain(),g=d.xIndex(f[0]+a,f[1],l),p=g[0],m=g[1]-p;m>0&&e(p,m)}else e(d.offset,d.count)};const c=this.rangeMap.get(void 0).count==0?t.facetId:void 0,h=this.rangeMap.get(c);return t.sampleFacetRenderingOptions?function(){h.count&&i.prepareSampleFacetRendering(t)&&r(h)}:function(){h.count&&r(h)}}setViewport(e,t){e=e.flatten();const i=this.unitView.context.devicePixelRatio,r=this.gl,s=this.properties,o=this.glHelper.getLogicalCanvasSize(),a=.5,l=(s.xOffset??0)+a,c=(s.yOffset??0)+a;let h,u=e;if(s.clip!=="never"&&(s.clip||t)){let d=0,f=0,g;if(t){if(u=e.intersect(t).flatten(),!u.isDefined())return!1;g=[e.width/u.width,e.height/u.height],f=Math.max(0,e.y2-t.y2),d=Math.max(0,e.x2-t.x2)}else g=[1,1];const p=[u.x,o.height-u.y2,u.width,u.height].map(w=>w*i),m=p.map(w=>Math.round(w)),[b,_]=p.map((w,y)=>w-m[y]);r.viewport(...m),r.scissor(...m),r.enable(r.SCISSOR_TEST),h={uViewOffset:[(l+d+b/i)/u.width,-(c+f-_/i)/u.height],uViewScale:g}}else{if(!e.isDefined())return!1;r.viewport(0,0,o.width*i,o.height*i),r.disable(r.SCISSOR_TEST),h={uViewOffset:[(e.x+l)/o.width,(o.height-e.y-c-e.height)/o.height],uViewScale:[e.width/o.width,e.height/o.height]}}return W8(this.viewUniformInfo,{...h,uViewportSize:[e.width,e.height],uDevicePixelRatio:i}),V8(this.gl,this.programInfo,this.viewUniformInfo),!0}findDatumAt(e,t){}}let bme=class extends Wf{constructor(){super([],JSON.stringify)}get(e){let t=super.get(e);return t===void 0&&(t={offset:0,count:0,xIndex:void 0},super.set(e,t)),t}migrateEntries(e){for(const[t,i]of e.entries())Object.assign(this.get(t),i)}};function HN(n,e){const t=Kue(e);let i=n[e]&&{...n[e]},r=n[t]&&{...n[t]};if(!(za(i)||za(r))){if(i){if(!$o(n[e]))return;if(r){if(i.type!="quantitative"){const s=(1-(i.band||1))/2;i.band=s,r.band=-s}}else if(i.type=="quantitative")r={datum:0};else{r={...i};const s=(1-(i.band??1))/2;i.band=0+s,r.band=1-s}}else i={value:0},r={value:1};n[e]=i,n[t]=r}}function nK(n,e){n.stroke||(e?n.stroke={value:null}:n.stroke={resolutionChannel:"color",...n.color}),za(n.stroke)&&n.stroke.value===null&&(n.strokeWidth={value:0}),n.strokeOpacity||(n.strokeOpacity={resolutionChannel:"opacity",...n.opacity})}function rK(n,e){za(n.fill)&&n.fill.value===null?n.fillOpacity={value:0}:n.fill||(n.fill={resolutionChannel:"color",...n.color},!e&&!n.fillOpacity&&(n.fillOpacity={value:0})),n.fillOpacity||(e?n.fillOpacity={resolutionChannel:"opacity",...n.opacity}:n.fillOpacity={value:0})}class vme extends G1{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x2:void 0,y2:void 0,filled:!0,color:"#4c78a8",opacity:1,strokeWidth:3,cornerRadius:0,minWidth:.5,minHeight:.5,minOpacity:1,tessellationZoomThreshold:10,tessellationTiles:35}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","fill","stroke","fillOpacity","strokeOpacity","strokeWidth"]}get opaque(){return s_(this,"opaque",()=>!this._isRoundedCorners()&&!this._isStroked()&&za(this.encoding.fillOpacity)&&this.encoding.fillOpacity.value==1&&this.properties.minOpacity==1)&&this.unitView.getEffectiveOpacity()==1}fixEncoding(e){return HN(e,"x"),HN(e,"y"),nK(e,this.properties.filled),rK(e,this.properties.filled),delete e.color,delete e.opacity,e}onBeforeSampleAnimation(){}onAfterSampleAnimation(){}_isRoundedCorners(){const e=this.properties;return e.cornerRadius||e.cornerRadiusBottomLeft||e.cornerRadiusBottomRight||e.cornerRadiusTopLeft||e.cornerRadiusTopRight}_isStroked(){const e=this.encoding.strokeWidth;return!(za(e)&&!e.value)}async initializeGraphics(){await super.initializeGraphics();const e=[];this._isRoundedCorners()&&e.push("ROUNDED_CORNERS"),this._isStroked()&&e.push("STROKED"),this.createAndLinkShaders(Vpe,Wpe,e.map(t=>"#define "+t))}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;io(this.programInfo,{uMinSize:[e.minWidth,e.minHeight],uMinOpacity:e.minOpacity,uCornerRadii:[e.cornerRadiusTopRight??e.cornerRadius,e.cornerRadiusBottomRight??e.cornerRadius,e.cornerRadiusTopLeft??e.cornerRadius,e.cornerRadiusBottomLeft??e.cornerRadius]})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new eme({encoders:this.encoders,attributes:this.getAttributes(),numItems:t});i.addBatches(e.facetBatches);const r=i.toArrays();this.rangeMap.migrateEntries(r.rangeMap),this.updateBufferInfo(r)}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>i0(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,r)=>{j1(t,this.vertexArrayInfo,t.TRIANGLE_STRIP,r,i)},e)}findDatumAt(e,t){e=Fs(e);const i=this.unitView.getCollector().facetBatches.get(e);if(!i)return;const r=this.encoders,s=r.x.scale.type;if(Vu(s)){const o=r.x.accessor;return i.find(a=>t==o(a))}else{const o=r.x.accessor,a=r.x2.accessor;return i.find(l=>t>=o(l)&&t<a(l))}}}const wme=`/**
 * The stroke should only grow inwards, e.g, the diameter/outline is not affected by the stroke width.
 * Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with
 * geometric zoom, etc.
 */
uniform bool uInwardStroke;

/** Maximum size of the largest point as the fraction of the height of the (faceted) view */
uniform lowp float uMaxRelativePointDiameter;

/** Scale factor for geometric zoom */
uniform float uScaleFactor;

/** The size of the largest point in the data */
uniform float uMaxPointSize;

uniform float uZoomLevel;
uniform float uSemanticThreshold;

out float vRadius;
out float vRadiusWithPadding;
out lowp vec4 vFillColor;
out lowp vec4 vStrokeColor;
out lowp float vShape;
out lowp float vHalfStrokeWidth;
out mat2 vRotationMatrix;


float computeSemanticThresholdFactor() {
    // TODO: add smooth transition
    return getScaled_semanticScore() >= uSemanticThreshold ? 1.0 : 0.0;
}

/**
 * Computes a scaling factor for the points in a sample-faceted view.
 */
float getDownscaleFactor(vec2 pos) {
    if (!isFacetedSamples()) {
        return 1.0;
    }

    float sampleFacetHeight = getSampleFacetHeight(pos);
    float maxPointDiameter = sqrt(uMaxPointSize);

    float factor = sampleFacetHeight *
        uViewportSize.y *
        uMaxRelativePointDiameter;

    return clamp(0.0, maxPointDiameter, factor) / maxPointDiameter;
}

// TODO: Move this into common.glsl or something
vec2 getDxDy() {
#if defined(dx_DEFINED) || defined(dy_DEFINED)
    return vec2(getScaled_dx(), getScaled_dy()) / uViewportSize;
#else
    return vec2(0.0, 0.0);
#endif
}

void main(void) {

    float semanticThresholdFactor = computeSemanticThresholdFactor();
    if (semanticThresholdFactor <= 0.0) {
        gl_PointSize = 0.0;
        // Place the vertex outside the viewport. The default (0, 0) makes this super-slow
        // on Apple Silicon. Probably related to the tile-based GPU architecture.
        gl_Position = vec4(100.0, 0.0, 0.0, 0.0);
        // Exit early. MAY prevent some unnecessary calculations.
        return;
    }

    float size = getScaled_size();
    vec2 pos = vec2(getScaled_x(), getScaled_y()) + getDxDy();

    gl_Position = unitToNdc(applySampleFacet(pos));

    float strokeWidth = getScaled_strokeWidth();

    float diameter = sqrt(size) *
        uScaleFactor *
        semanticThresholdFactor *
        getDownscaleFactor(pos);

    // Clamp minimum size and adjust opacity instead. Yields more pleasing result,
    // no flickering etc.
    float opacity = uViewOpacity;
	if (strokeWidth <= 0.0 || uInwardStroke) {
		float minDiameter = 1.0 / uDevicePixelRatio;
		if (diameter < minDiameter) {
			// We do some "cheap" gamma correction here. It breaks on dark background, though.
			// First we take a square of the size and then apply "gamma" of 1.5.
			opacity *= pow(diameter / minDiameter, 2.5);
			diameter = minDiameter;
		}
	}

	float fillOpa = getScaled_fillOpacity() * opacity;
	float strokeOpa = getScaled_strokeOpacity() * opacity;

    vShape = getScaled_shape();

	// Circle doesn't have sharp corners. Do some special optimizations to minimize the point size.
	bool circle = vShape == 0.0;

	float angleInDegrees = getScaled_angle();
	float angle = -angleInDegrees * PI / 180.0;
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    vRotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
	float roomForRotation = circle ? 1.0 : sin(mod(angle, PI / 2.0) + PI / 4.0) / sin(PI / 4.0);

	float aaPadding = 1.0 / uDevicePixelRatio;
	float rotationPadding = (diameter * roomForRotation) - diameter;
	// sqrt(3.0) ensures that the angles of equilateral triangles have enough room
	float strokePadding = uInwardStroke ? 0.0 : strokeWidth * (circle ? 1.0 : sqrt(3.0));
	float padding = rotationPadding + strokePadding + aaPadding;
    gl_PointSize = (diameter + padding) * uDevicePixelRatio;

	vRadius = diameter / 2.0;
	vRadiusWithPadding = vRadius + padding / 2.0;

    vHalfStrokeWidth = strokeWidth / 2.0;

    vFillColor = vec4(getScaled_fill() * fillOpa, fillOpa);
    vStrokeColor = vec4(getScaled_stroke() * strokeOpa, strokeOpa);

    setupPicking();
}
`,yme=`const lowp vec4 white = vec4(1.0);
const lowp vec4 black = vec4(0.0, 0.0, 0.0, 1.0);

uniform bool uInwardStroke;
uniform float uGradientStrength;

in float vRadius;
in float vRadiusWithPadding;

in lowp vec4 vFillColor;
in lowp vec4 vStrokeColor;
in lowp float vShape;
in lowp float vHalfStrokeWidth;

in mat2 vRotationMatrix;

out lowp vec4 fragColor;

const float CIRCLE = 0.0;
const float SQUARE = 1.0;
const float TRIANGLE_UP = 2.0;
const float CROSS = 3.0;
const float DIAMOND = 4.0;
const float TRIANGLE_DOWN = 5.0;
const float TRIANGLE_RIGHT = 6.0;
const float TRIANGLE_LEFT = 7.0;


// The distance functions are inspired by:
// http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
// However, these are not true distance functions, because the corners need to be sharp.

float circle(vec2 p, float r) {
    return length(p) - r;
}

float square(vec2 p, float r) {
    p = abs(p);
    return max(p.x, p.y) - r;
}

float equilateralTriangle(vec2 p, float r, bool flip, bool swap) {
    if (swap) {
        p.xy = p.yx;
    }
    if (flip) {
        p.y = -p.y;
    }

    float k = sqrt(3.0);
    float kr = k * r;
    //p.y -= kr * 2.0 / 3.0;
    p.y -= kr / 2.0;
    return max((abs(p.x) * k + p.y) / 2.0, -p.y - kr);
}

float crossShape(vec2 p, float r) {
    p = abs(p);

	vec2 b = vec2(0.4, 1.0) * r;
    vec2 v = abs(p) - b.xy;
    vec2 h = abs(p) - b.yx;
    return min(max(v.x, v.y), max(h.x, h.y));
}

float diamond(vec2 p, float r) {
    p = abs(p);
    return (max(abs(p.x - p.y), abs(p.x + p.y)) - r) / sqrt(2.0);
}

void main() {
    float d;

	/** Normalized point coord */
    vec2 p = vRotationMatrix * (2.0 * gl_PointCoord - 1.0) * vRadiusWithPadding;
	float r = vRadius;

    // We could also use textures here. Could even be faster, because we have plenty of branching here.
    if (vShape == CIRCLE) {
        d = circle(p, r);

    } else if (vShape == SQUARE) {
        d = square(p, r);

    } else if (vShape == TRIANGLE_UP) {
        d = equilateralTriangle(p, r, true, false);

    } else if (vShape == CROSS) {
        d = crossShape(p, r);

    } else if (vShape == DIAMOND) {
        d = diamond(p, r);

    } else if (vShape == TRIANGLE_DOWN) {
        d = equilateralTriangle(p, r, false, false);

    } else if (vShape == TRIANGLE_RIGHT) {
        d = equilateralTriangle(p, r, false, true);

    } else if (vShape == TRIANGLE_LEFT) {
        d = equilateralTriangle(p, r, true, true);

    } else {
        d = 0.0;
    }

	if (!uPickingEnabled) {
		lowp vec4 fillColor = mix(vFillColor, white, -d * uGradientStrength / vRadius);

		fragColor = distanceToColor(
			d + (uInwardStroke ? vHalfStrokeWidth : 0.0),
			fillColor,
			vStrokeColor,
			vHalfStrokeWidth);

	} else if (d - vHalfStrokeWidth <= 0.0) {
        fragColor = vPickingColor;

	} else {
		discard;
    }
}

`,fc=1<<0,fd=1<<1,N4=1<<2,Cme={};class Tn{get behavior(){return 0}constructor(){this.children=[],this.parent=void 0,this.completed=!1}reset(){this.completed=!1;for(const e of this.children)e.reset()}initialize(){}_updatePropagator(){this._propagate=Function("children",Rv(this.children.length).map(e=>`const child${e} = children[${e}];`).join(`
`)+`return function propagate(datum) {${Rv(this.children.length).map(e=>`child${e}.handle(datum);`).join(`
`)}}`)(this.children)}setParent(e){this.parent=e}addChild(e){if(e.parent)throw new Error("Cannot add the child! It already has a parent.");return this.children.push(e),e.setParent(this),this._updatePropagator(),this}adopt(e){e.parent&&e.parent.removeChild(e),this.addChild(e)}adoptChildrenOf(e){for(const t of e.children)this.adopt(t)}insertAsParent(e){if(this.isRoot())throw new Error("Cannot insert a new parent for a root node!");e.parent=this.parent,this.parent.children[this.parent.children.indexOf(this)]=e,this.parent._updatePropagator(),this.parent=void 0,e.addChild(this)}removeChild(e){const t=this.children.indexOf(e);if(t>-1)this.children.splice(t,1),e.parent=void 0,this._updatePropagator();else throw new Error("Trying to remove an unknown child node!")}excise(){if(this.isRoot())throw new Error("Cannot excise root node!");if(this.isTerminal())this.parent.removeChild(this);else if(this.children.length==1){const e=this.children[0];e.setParent(this.parent),this.parent.children[this.parent.children.indexOf(this)]=e,this.parent._updatePropagator(),this.setParent(void 0),this.children.length=0}else throw new Error("Cannot excise a node that has multiple children!")}isRoot(){return!this.parent}isBranching(){return this.children.length>1}isTerminal(){return this.children.length==0}visit(e){e(this);for(const t of this.children)t.visit(e);e.afterChildren&&e.afterChildren(this)}subtreeToString(e=0){const t=this.children.map(i=>i.subtreeToString(e+1)).join("");return`${" ".repeat(e*2)}* ${this.constructor.name}${("identifier"in this&&this.identifier?": "+this.identifier:"")??""} 
${t}`}getGlobalObject(){return this.parent?this.parent.getGlobalObject():Cme}handle(e){this._propagate(e)}complete(){this.completed=!0;for(const e of this.children)e.complete()}beginBatch(e){for(const t of this.children)t.beginBatch(e)}_propagate(e){}}function sK(n){return n.type=="file"}function Sme(n){return n.type=="facet"}class oK extends Tn{constructor(e){super(),this.k=e.size||500,this.reset()}reset(){super.reset(),this.reservoir=[],this.W=void 0,this.ingester=this._initialIngester}_initialIngester(e){this.reservoir.push(e),this.reservoir.length==this.k&&(this.W=Math.exp(Math.log(Math.random())/this.k),this.i=this.k,this.next=this.i,this.ingester=this._finalIngester,this._setNextStop())}_finalIngester(e){++this.i==this.next&&(this.reservoir[Math.floor(Math.random()*this.k)]=e,this.W*=Math.exp(Math.log(Math.random())/this.k),this._setNextStop())}_setNextStop(){this.next+=Math.floor(Math.log(Math.random())/Math.log(1-this.W))+1}handle(e){this.ingester(e)}complete(){for(const e of this.reservoir)this._propagate(e);super.complete()}}function xme(n,e,t){const i=new oK({type:"sample",size:n});for(const r of e)i.handle(t(r));return i.complete(),i.reservoir}const Eme={};class Dme extends G1{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:.5,y:.5,color:"#4c78a8",filled:!0,opacity:1,size:100,semanticScore:0,shape:"circle",strokeWidth:2,fillGradientStrength:0,dx:0,dy:0,angle:0,sampleFacetPadding:.1,semanticZoomFraction:.02}))}getAttributes(){return["inwardStroke","uniqueId","facetIndex","x","y","size","semanticScore","shape","strokeWidth","gradientStrength","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"size","semanticScore","shape","strokeWidth","dx","dy","fill","stroke","fillOpacity","strokeOpacity","angle"]}getDefaultEncoding(){return{...super.getDefaultEncoding(),...Eme}}fixEncoding(e){return nK(e,this.properties.filled),rK(e,this.properties.filled),delete e.color,delete e.opacity,e}initializeData(){super.initializeData();const e=this.unitView.getAccessor("semanticScore");e&&(this.sampledSemanticScores=Float32Array.from(xme(1e4,this.unitView.getCollector().getData(),e)),this.sampledSemanticScores.sort((t,i)=>t-i))}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(wme,yme)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;io(this.programInfo,{uInwardStroke:e.inwardStroke,uGradientStrength:e.fillGradientStrength,uMaxRelativePointDiameter:1-2*e.sampleFacetPadding})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new ime({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(t,this.properties.minBufferSize||0)});i.addBatches(e.facetBatches);const r=i.toArrays();this.rangeMap.migrateEntries(r.rangeMap),this.updateBufferInfo(r)}_getGeometricScaleFactor(){const e=Math.pow(2,this.properties.geometricZoomBound||0);return Math.pow(Math.min(1,this.unitView.getZoomLevel()/e),1/3)}_getMaxPointSize(){const e=this.encoders.size;return e.constant?e(null):e.scale.range().reduce((t,i)=>Math.max(t,i))}getSemanticThreshold(){if(this.sampledSemanticScores){const e=Math.max(0,1-this.properties.semanticZoomFraction*this.unitView.getZoomLevel());if(e<=0)return-1/0;if(e>=1)return 1/0;{const t=this.sampledSemanticScores;return pj(t,e)}}else return-1}prepareRender(e){const t=super.prepareRender(e);return t.push(()=>io(this.programInfo,{uMaxPointSize:this._getMaxPointSize(),uScaleFactor:this._getGeometricScaleFactor(),uSemanticThreshold:this.getSemanticThreshold()})),t.push(()=>i0(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,r)=>{r&&j1(t,this.vertexArrayInfo,t.POINTS,r,i)},e)}}const kme=`// Line caps
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

/** Position along the rule */
in float pos;

/** Which side of the stroke: -0.5 or 0.5 */
in float side;

/** Minimum rule length in pixels */
uniform float uMinLength;

uniform mediump float uDashTextureSize;
uniform lowp int uStrokeCap;

out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

/** Distances from the line endings. Used for rendering the round caps and dashes */
out highp vec2 vPosInPixels;


void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;

    // Stroke width in pixels
    float size = getScaled_size();
    float opacity = getScaled_opacity() * uViewOpacity;

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (size < pixelSize) {
        opacity *= size / pixelSize;
        size = pixelSize;
    }

    vec2 a = applySampleFacet(vec2(getScaled_x(), getScaled_y()));
    vec2 b = applySampleFacet(vec2(getScaled_x2(), getScaled_y2()));

    vec2 tangent = b - a;

    float offset = 0.0;
    float relativeDiff = 0.0;
    if (uMinLength > 0.0 || uStrokeCap != BUTT) {
        float len = length(tangent * uViewportSize);

        // Elongate to reach the minimum length.
        // The length difference in pixels
        float diff = max(0.0, uMinLength - len);

        // Add line caps
        if (uStrokeCap != BUTT) {
            diff += size;
        }

        relativeDiff = diff / len;
        offset = relativeDiff * (pos - 0.5);
    }

    // Apply caps and minimum length by spreading the vertices along the tangent
    vec2 p = pos < 1.0
        ? a + tangent * (pos + offset)
        : b + tangent * offset;

    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float aaPadding = pixelSize;

    // Extrude
    vec2 normal = normalize(vec2(-tangent.y, tangent.x) / uViewportSize);
    p += normal * side * (size + aaPadding) / uViewportSize;

    gl_Position = unitToNdc(p);

    vColor = vec4(getScaled_color() * opacity, opacity);
    vSize = size;
    vNormalLengthInPixels = side * (size + aaPadding);

    // TODO: Here's a precision problem that breaks round caps when zoomed in enough
    vPosInPixels = vec2(pos, (1.0 - pos)) * (1.0 + relativeDiff) * length(tangent * uViewportSize) -
        vec2(uStrokeCap != BUTT ? size / 2.0 : 0.0);
    
    setupPicking();
}
`,Lme=`// Line ending
const int BUTT = 0;
const int SQUARE = 1;
const int ROUND = 2;

uniform sampler2D uDashTexture;
uniform float uDashTextureSize;
uniform float uStrokeDashOffset;
uniform lowp int uStrokeCap;

in vec4 vColor;
in float vSize;

/** Position on the rule along its length in pixels */
in vec2 vPosInPixels;
in float vNormalLengthInPixels;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distanceFromEnd = -min(vPosInPixels[0], vPosInPixels[1]);
    float distance; // from the rule centerline or end
    if (distanceFromEnd > 0.0 && uStrokeCap == ROUND) {
        // round cap
        distance = length(vec2(distanceFromEnd, vNormalLengthInPixels));
    } else {
        distance = abs(vNormalLengthInPixels);
    }

    // Use a signed distance field to implement edge antialiasing
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), -0.5, 0.5) + 0.5;

    if (uDashTextureSize > 0.0) {
        float pos = (vPosInPixels[0] + uStrokeDashOffset) * dpr;
        float floored = floor(pos);
        vec2 texelPositions = (floored + vec2(0.5, 1.5)) / dpr / uDashTextureSize;
      
        // Do antialiasing
        opacity *= mix(
            texture(uDashTexture, vec2(texelPositions[0], 0)).r,
            texture(uDashTexture, vec2(texelPositions[1], 0)).r,
            clamp((pos - floored), 0.0, 1.0));
    }

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`;class Ime extends G1{constructor(e){super(e),this.dashTextureSize=0,Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x2:void 0,y2:void 0,size:1,color:"black",opacity:1,minLength:0,strokeDash:null,strokeDashOffset:0,strokeCap:"butt"}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){if(!(e.x&&e.y&&e.x2&&e.y2))if(e.x&&e.x2&&!e.y)e.y={value:.5},e.y2=e.y;else if(e.y&&e.y2&&!e.x)e.x={value:.5},e.x2=e.x;else if(e.x&&!e.y)e.y={value:0},e.y2={value:1},e.x2=e.x;else if(e.y&&!e.x)e.x={value:0},e.x2={value:1},e.y2=e.y;else if(e.x&&e.y&&e.y2)e.x2=e.x;else if(e.y&&e.x&&e.x2)e.y2=e.y;else if(e.y&&e.x)if(!e.x2&&$o(e.y)&&e.y.type=="quantitative")e.x2=e.x,e.y2={datum:0};else if(!e.y2&&$o(e.x)&&e.x.type=="quantitative")e.y2=e.y,e.x2={datum:0};else throw new Error("A bug!");else throw new Error("Invalid x and y encodings for rule mark: "+JSON.stringify(e));return e}async initializeGraphics(){if(await super.initializeGraphics(),this.properties.strokeDash){const e=this.gl,t=Tme(this.properties.strokeDash);this.dashTexture=Zv(e,{mag:e.NEAREST,min:e.NEAREST,internalFormat:e.R8,format:e.RED,src:t,height:1}),this.dashTextureSize=t.length}this.createAndLinkShaders(kme,Lme)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;io(this.programInfo,{uMinLength:e.minLength,uDashTextureSize:this.dashTextureSize,uStrokeCap:["butt","square","round"].indexOf(e.strokeCap)})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new tme({encoders:this.encoders,attributes:this.getAttributes(),numItems:Math.max(t,this.properties.minBufferSize||0)});i.addBatches(e.facetBatches);const r=i.toArrays();this.rangeMap.migrateEntries(r.rangeMap),this.updateBufferInfo(r)}prepareRender(e){const t=super.prepareRender(e);return this.dashTexture&&t.push(()=>io(this.programInfo,{uDashTexture:this.dashTexture,uStrokeDashOffset:this.properties.strokeDashOffset})),t.push(()=>i0(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,r)=>j1(t,this.vertexArrayInfo,t.TRIANGLE_STRIP,r,i),e)}}function Tme(n){if(n.length==0||n.length%2||n.findIndex(s=>Math.round(s)!=s||s<1||s>1e3)>=0)throw new Error("Invalid stroke dash pattern: "+JSON.stringify(n));const e=n.reduce((s,o)=>s+o),t=new Uint8Array(e);let i=!0,r=0;for(let s of n){for(;s;)t[r++]=i&&255||0,s--;i=!i}return t}const Ame=`uniform float uSagittaScaleFactor;

/** Make very small arcs visible */
uniform float uMinSagittaLength;

in vec2 strip;

out vec4 vColor;

/** Stroke width */
out float vSize;

/** The distance from the line center to the direction of normal in pixels */
out float vNormalLengthInPixels;

void main(void) {
    float pixelSize = 1.0 / uDevicePixelRatio;
    float opacity = getScaled_opacity() * uViewOpacity;

    vec2 a = vec2(getScaled_x(), getScaled_y()) * uViewportSize;
    vec2 b = vec2(getScaled_x2(), getScaled_y2()) * uViewportSize;
    
    vec2 chordVector = b - a;
    vec2 unitChordVector = normalize(chordVector);
    vec2 chordNormal = vec2(-unitChordVector.y, unitChordVector.x);

    float sagitta = max(
        length(chordVector) / 2.0 * uSagittaScaleFactor,
        uMinSagittaLength
    );

    bool compress = false;
    if (compress) {
        // Work in progres...
        float maxSagittaLen = length(chordNormal * uViewportSize);
        float maxChordLen = length(unitChordVector * uViewportSize);

        float threshold = maxSagittaLen * 0.5;
        if (sagitta > threshold) {
            float m = (maxSagittaLen - threshold) / (maxChordLen - threshold);
            sagitta = (sagitta - threshold) * m + threshold;
        }
    }

    vec2 controlOffset = chordNormal * sagitta / 0.75;

    vec2 p1 = a;
    vec2 p2 = a + controlOffset;
    vec2 p3 = b + controlOffset;
    vec2 p4 = b;

    // Make segments shorter near the endpoints to make the tightly bent attachment points smoother
    float t = smoothstep(0.0, 1.0, strip.x);

    // https://stackoverflow.com/a/31317254/1547896
    vec2 C1 = p4 - 3.0 * p3 + 3.0 * p2 - p1;
    vec2 C2 = 3.0 * p3 - 6.0 * p2 + 3.0 * p1;
    vec2 C3 = 3.0 * p2 - 3.0 * p1;
    vec2 C4 = p1;

    vec2 p;
    // Skip computation at endpoints to maintain precision
    if (t == 0.0) {
        p = p1;
    } else if (t == 1.0) {
        p = p4;
    } else {
        p = C1*t*t*t + C2*t*t + C3*t + C4;
    }

    vec2 tangent = normalize(3.0*C1*t*t + 2.0*C2*t + C3);
    vec2 normal = vec2(-tangent.y, tangent.x);

    //p = applySampleFacet(p);

#ifdef size2_DEFINED
    float mixedSize = mix(getScaled_size(), getScaled_size2(), t);
#else
    float mixedSize = getScaled_size();
#endif

    // Avoid artifacts in very thin lines by clamping the size and adjusting opacity respectively
    if (mixedSize < pixelSize) {
        opacity *= mixedSize / pixelSize;
        mixedSize = pixelSize;
    }

    // Add an extra pixel to stroke width to accommodate edge antialiasing
    float paddedSize = mixedSize + pixelSize;

    vNormalLengthInPixels = strip.y * paddedSize;
    
    // Extrude
    p += normal * vNormalLengthInPixels;

    gl_Position = pixelsToNdc(p);

#ifdef color2_DEFINED
    // Yuck, RGB interpolation in gamma space!
    // TODO: linear space: https://unlimited3d.wordpress.com/2020/01/08/srgb-color-space-in-opengl/
    vec3 color = mix(getScaled_color(), getScaled_color2(), t);
#else 
    vec3 color = getScaled_color();
#endif

    vColor = vec4(color * opacity, opacity);

    vSize = paddedSize;

    setupPicking();
}
`,Nme=`in lowp vec4 vColor;
in float vSize;
in float vNormalLengthInPixels;

out lowp vec4 fragColor;

void main(void) {
    float dpr = uDevicePixelRatio;

    float distance = abs(vNormalLengthInPixels);
    float opacity = clamp(((vSize / 2.0 - distance) * dpr), 0.0, 1.0);

    fragColor = vColor * opacity;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`;class Rme extends G1{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:0,x2:void 0,y:0,y2:void 0,size:1,color:"black",opacity:1,segments:101,sagittaScaleFactor:1,minSagittaLength:1.5}))}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","size","height","color","opacity"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size"]}fixEncoding(e){return e.x||(e.x2=e.x),e.y2||(e.y2=e.y),e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(Ame,Nme)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;io(this.programInfo,{uSagittaScaleFactor:e.sagittaScaleFactor,uMinSagittaLength:e.minSagittaLength})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getItemCount(),i=new nme({encoders:this.encoders,attributes:this.getAttributes(),numItems:t});i.addBatches(e.facetBatches);const r=i.toArrays();r.arrays.strip={data:Mme(this.properties.segments),numComponents:2},this.rangeMap.migrateEntries(r.rangeMap),this.arrays=Object.fromEntries(Object.entries(r.arrays).map(([s,o])=>[s,{...o,data:void 0}])),this.updateBufferInfo(r)}render(e){const t=this.gl;return this.createRenderCallback((i,r)=>{this.gl.bindVertexArray(this.vertexArrayInfo.vertexArrayObject);for(const s of Object.entries(this.bufferInfo.attribs)){const[o,a]=s;a.buffer&&a.numComponents&&a.divisor&&(a.offset=i*this.arrays[o].numComponents*4)}i0(t,this.programInfo,this.bufferInfo),j1(t,this.bufferInfo,t.TRIANGLE_STRIP,(this.properties.segments+1)*2,0,r)},e)}}function Mme(n){let e=0;const t=[];for(;e<=n;e++)t.push(e/n,.5),t.push(e/n,-.5);return t}const Fme=`uniform float uSdfNumerator;

uniform vec2 uD; // dx & dy

in mediump vec2 vertexCoord;
in lowp vec2 textureCoord;

uniform vec4 uViewportEdgeFadeWidth;
uniform vec4 uViewportEdgeFadeDistance;
    
uniform bool uSqueeze;
uniform bool uLogoLetter;

// Width of the text (all letters)
in float width;

// x: -1, 0, 1 = left, center, right
// y: -1, 0, 1 = top, middle, bottom 
uniform ivec2 uAlign;

#ifdef x2_DEFINED
uniform float uPaddingX;
uniform bool uFlushX;
#endif

#ifdef y2_DEFINED
uniform float uPaddingY;
uniform bool uFlushY;
#endif

out vec2 vTexCoord;
out vec4 vColor;
out float vSlope;
out float vEdgeFadeOpacity;

struct RangeResult {
    float pos;
    float scale;
};

float minValue(vec4 v) {
    return min(min(v.x, v.y), min(v.z, v.w));
}

float maxValue(vec4 v) {
    return max(max(v.x, v.y), max(v.z, v.w));
}

/**
 * All measures are in [0, 1]
 */
RangeResult positionInsideRange(float a, float b, float width, float padding,
                                int align, bool flush) {
    float span = b - a;
    float paddedWidth = width + 2.0 * padding;

    // Is the text clearly outside the viewport
    if (a > 1.0 || b < 0.0) {
        return RangeResult(0.0, 0.0);
    }

    // How much extra space we have for adjusting the position so that the
    // text stays inside the range.
    float extra = max(0.0, span - paddedWidth);

    float pos;

    // Align the text and try to keep it inside the range and the viewport
    if (align == 0) {
        float centre = a + b;

        if (flush) {
            float leftOver = max(0.0, paddedWidth - centre);
            centre += min(leftOver, extra);

            float rightOver = max(0.0, paddedWidth + centre - 2.0);
            centre -= min(rightOver, extra);
        }

        pos = centre / 2.0;

    } else if (align < 0) {
        float edge = a;

        if (flush) {
            float over = max(0.0, -edge);
            edge += min(over, extra);
        }

        pos = edge + padding;

    } else {
        float edge = b;

        if (flush) {
            float over = max(0.0, edge - 1.0);
            edge -= min(over, extra);
        }

		// TODO: If the text spans the whole viewport, try to keep it centered if possible.

        pos = edge - padding;
    }

    // How the text should be scaled to make it fit inside the range (if it didn't fit).
    float scale = clamp((span - padding) / paddedWidth, 0.0, 1.0);

    // TODO: Fix padding in scale factor. Padding should stay constant
    return RangeResult(pos, scale);
}

vec2 calculateRotatedDimensions(float width, mat2 rotationMatrix) {
    vec2 a = abs(rotationMatrix * vec2(width / 2.0, 0.5));
    vec2 b = abs(rotationMatrix * vec2(width / 2.0, -0.5));
    return vec2(max(a.x, b.x), max(a.y, b.y)) * 2.0;
}

/** Needed when using ranged text */
ivec2 fixAlignForAngle(ivec2 align, float angleInDegrees) {
    float a = mod(angleInDegrees + 45.0, 360.0);
    int x = align.x;
    int y = -align.y;

    // TODO: Optimize by avoiding branching
    if (a < 90.0) {
        return ivec2(x, y);
    } else if (a < 180.0) {
        return ivec2(y, -x);
    } else if (a < 270.0) {
        return ivec2(-x, y);
    } else {
        return ivec2(-y, x);
    }
}

void main(void) {
    float opacity = getScaled_opacity() * uViewOpacity;
    vec2 size = vec2(getScaled_size());
    float x = getScaled_x();
    float y = getScaled_y();

    float scale = 1.0;

	float angleInDegrees = getScaled_angle();
	float angle = -angleInDegrees * PI / 180.0;
	
    float sinTheta = sin(angle);
    float cosTheta = cos(angle);
    mat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);

    vec2 flushSize = calculateRotatedDimensions(width, rotationMatrix);

#if defined(x2_DEFINED) || defined(y2_DEFINED)
    ivec2 align = fixAlignForAngle(uAlign, angleInDegrees);
#else
    ivec2 align = uAlign;
#endif

#ifdef x2_DEFINED
    float x2 = getScaled_x2();

    if (uLogoLetter) {
        size.x = (x2 - x) * uViewportSize.x;
        x += (x2 - x) / 2.0;

    } else {
        float x2 = getScaled_x2();
        RangeResult result = positionInsideRange(
            min(x, x2), max(x, x2),
            size.x * scale * flushSize.x / uViewportSize.x, uPaddingX / uViewportSize.x,
            align.x, uFlushX);
        
        x = result.pos;
        scale *= result.scale;
    }
#endif

    // Position of the text origo 
    vec2 pos = applySampleFacet(vec2(x, y));

#ifdef y2_DEFINED
    float y2 = getScaled_y2();
    vec2 pos2 = applySampleFacet(vec2(x, y2));

    if (uLogoLetter) {
        size.y = (pos2.y - pos.y) * uViewportSize.y;
        pos.y += (pos2.y - pos.y) / 2.0;

    } else {
        RangeResult result = positionInsideRange(
            min(pos.y, pos2.y), max(pos.y, pos2.y),
            size.y * scale * flushSize.y / uViewportSize.y, uPaddingY / uViewportSize.y,
            align.y, uFlushY);
        
        pos.y = result.pos;
        scale *= result.scale;
    }
#endif

    if (scale < 1.0) {
        if (uSqueeze) {
            vec2 scaleFadeExtent = vec2(3.0, 6.0) / size;

            if (scale  < scaleFadeExtent[0]) {
                gl_Position = vec4(0.0);
                return;
            }

            size *= scale;
            opacity *= linearstep(scaleFadeExtent[0], scaleFadeExtent[1], scale);

        } else if (scale < 1.0) {
            // Eliminate the text
            gl_Position = vec4(0.0);
            return;
        }
    }

    // Position of the character vertex in relation to the text origo
    vec2 charPos = rotationMatrix * (vertexCoord * size + uD);

    // Position of the character vertex inside the unit viewport
    vec2 unitPos = pos + charPos / uViewportSize;

    gl_Position = unitToNdc(unitPos);

    // Controls antialiasing of the SDF
    vSlope = max(1.0, min(size.x, size.y) / uSdfNumerator);

    vColor = vec4(getScaled_color() * opacity, opacity);

    vTexCoord = textureCoord;

    // Edge fading. The implementation is simplistic and fails with primitives that
    // span the whole viewport. However, it works just fine with reasonable font sizes.
    // x: top, y: right, z: bottom, w: left
    if (maxValue(uViewportEdgeFadeDistance) > -pow(10.0, 10.0)) { // -Infinity would be nice
        vEdgeFadeOpacity = minValue(
            ((vec4(1.0, 1.0, 0.0, 0.0) + vec4(-1.0, -1.0, 1.0, 1.0) * unitPos.yxyx) *
                uViewportSize.yxyx - uViewportEdgeFadeDistance) / uViewportEdgeFadeWidth);
    } else {
        vEdgeFadeOpacity = 1.0;
    }

    setupPicking();
}
`,Ome=`uniform sampler2D uTexture;
uniform bool uLogoLetter;

in vec2 vTexCoord;
in float vEdgeFadeOpacity;
in vec4 vColor;
in float vSlope;

out lowp vec4 fragColor;

float median(float r, float g, float b) {
    return max(min(r, g), min(max(r, g), b));
}

void main() {
    // TODO: Really small text should fall back to normal (non-SDF) texture that can be mip-mapped.
    // Currently small text has severe aliasing artifacts.

    vec3 c = texture(uTexture, vTexCoord).rgb;

    float sigDist = 1.0 - median(c.r, c.g, c.b);

    // Using screen-space derivatives for logo letters because skewed aspect ratios
    // result in blurry edges otherwise. However, use of screen-space derivatives
    // results in crappy looking text with regular letters text.
    float slope = uLogoLetter
        ? 0.7 / length(vec2(dFdy(sigDist), dFdx(sigDist)))
        : vSlope;

    float opa = clamp((sigDist - 0.5) * slope + 0.5, 0.0, 1.0);

    // Raise to the power of 2.2 to do some cheap gamma correction
    opa *= pow(clamp(vEdgeFadeOpacity, 0.0, 1.0), 2.2);

    fragColor = vColor * opa;

    if (uPickingEnabled) {
        fragColor = vPickingColor;
    }
}
`,Pme={left:-1,center:0,right:1},Bme={top:-1,middle:0,bottom:1,alphabetic:1};class Vme extends G1{constructor(e){super(e),Object.defineProperties(this.defaultProperties,Object.getOwnPropertyDescriptors({x:.5,y:.5,x2:void 0,y2:void 0,text:"",size:11,color:"black",opacity:1,font:void 0,fontStyle:void 0,fontWeight:void 0,align:"center",baseline:"middle",dx:0,dy:0,angle:0,fitToBand:!1,squeeze:!0,paddingX:0,paddingY:0,flushX:!0,flushY:!0,logoLetters:!1,viewportEdgeFadeWidthTop:0,viewportEdgeFadeWidthRight:0,viewportEdgeFadeWidthBottom:0,viewportEdgeFadeWidthLeft:0,viewportEdgeFadeDistanceTop:-1/0,viewportEdgeFadeDistanceRight:-1/0,viewportEdgeFadeDistanceBottom:-1/0,viewportEdgeFadeDistanceLeft:-1/0})),this.font=this.properties.font?e.context.fontManager.getFont(this.properties.font,this.properties.fontStyle,this.properties.fontWeight):e.context.fontManager.getDefaultFont()}getAttributes(){return["uniqueId","facetIndex","x","x2","y","y2","color","size","opacity","angle"]}getSupportedChannels(){return[...super.getSupportedChannels(),"x2","y2","size","text","angle"]}fixEncoding(e){for(const t of J_)this.properties.fitToBand&&HN(e,t);return e}async initializeGraphics(){await super.initializeGraphics(),this.createAndLinkShaders(Fme,Ome)}finalizeGraphicsInitialization(){super.finalizeGraphicsInitialization(),this.gl.useProgram(this.programInfo.program);const e=this.properties;io(this.programInfo,{uPaddingX:e.paddingX,uPaddingY:e.paddingY,uFlushX:!!e.flushX,uFlushY:!!e.flushY,uAlign:[Pme[e.align],Bme[e.baseline]],uD:[e.dx,-e.dy],uLogoLetter:!!e.logoLetters,uSqueeze:!!e.squeeze,uViewportEdgeFadeWidth:[e.viewportEdgeFadeWidthTop,e.viewportEdgeFadeWidthRight,e.viewportEdgeFadeWidthBottom,e.viewportEdgeFadeWidthLeft],uViewportEdgeFadeDistance:[e.viewportEdgeFadeDistanceTop,e.viewportEdgeFadeDistanceRight,e.viewportEdgeFadeDistanceBottom,e.viewportEdgeFadeDistanceLeft]})}updateGraphicsData(){const e=this.unitView.getCollector(),t=e.getData(),i=this.encoding,r=this.encoders.text.accessor||this.encoders.text;let s=0;const o="format"in i.text?Cr(i.text.format):c=>c;for(const c of t){const h=o(r(c)),u=un(h)?h:h===null?"":""+h;s+=u&&u.length||0}const a=new rme({encoders:this.encoders,attributes:this.getAttributes(),properties:this.properties,fontMetrics:this.font.metrics,numCharacters:Math.max(s,this.properties.minBufferSize||0)});a.addBatches(e.facetBatches);const l=a.toArrays();this.rangeMap.migrateEntries(l.rangeMap),this.updateBufferInfo(l)}prepareRender(e){const t=super.prepareRender(e);let i=.35;this.properties.logoLetters&&(i/=2);const r=this.font.metrics.common.base/(this.unitView.context.devicePixelRatio/i);return t.push(()=>io(this.programInfo,{uTexture:this.font.texture,uSdfNumerator:r})),t.push(()=>i0(this.gl,this.programInfo,this.vertexArrayInfo)),t}render(e){const t=this.gl;return this.createRenderCallback((i,r)=>j1(t,this.vertexArrayInfo,t.TRIANGLES,r,i),e)}}function Z8(n,e,{spacing:t,devicePixelRatio:i,offset:r,reverse:s}={}){t=t||0,r=r||0;let o=0,a=0;for(const g of n)o+=Yy(g.px)+(U2(g)?0:t),a+=Yy(g.grow);o-=t;const l=Math.max(0,e-o),c=i!==void 0?g=>Math.round(g*i)/i:g=>g,h=[],u=[],d=g=>{const p=h.length;if(!p)return;const m=(g?t:0)*(s?-1:1);f-=m;for(let b=0;b<p;b++)u.push({location:f+(b+1)/(p+1)*m,size:0});f+=m,h.length=0};let f=s?Math.max(e,o):0+r;if(n.length==1&&U2(n[0]))return[{location:f,size:0}];for(let g=0;g<n.length;g++){const p=n[g];if(U2(p))h.push(p);else{d(u.length>0);const m=Yy(p.px)+(a?Yy(p.grow)/a*l:0);s&&(f-=m),u.push({location:c(f),size:c(m)}),s?f-=t:f+=m+t}}return f+=s?t:-t,d(!1),u}function Wme(n){let e=0,t=0;for(const i of n)e=Math.max(e,i.px??0),t=Math.max(t,i.grow??0);return{px:e,grow:t}}var m1,UN;const HB=class{constructor(e,t){Vt(this,m1);this.width=e,this.height=t}addPadding(e){return _t(this,m1,UN).call(this,e.width,e.height)}subtractPadding(e){return _t(this,m1,UN).call(this,-e.width,-e.height)}};let Gf=HB;m1=new WeakSet,UN=function(e,t){return new HB({px:(this.width.px??0)+e,grow:this.width.grow},{px:(this.height.px??0)+t,grow:this.height.grow})};const Bb=Object.freeze({px:0,grow:0}),$me=new Gf(Bb,Bb);function U2(n){return!n.px&&!n.grow}function Yy(n){return n||0}function zme(n){return n&&(Os(n.px)||Os(n.grow))}function aK(n){if(uK(n))throw new Error("parseSizeDef does not accept step-based sizes.");if(zme(n))return n;if(Os(n))return{px:n,grow:0};if(n==="container")return{px:0,grow:1};if(!n)return{px:0,grow:1};throw new Error(`Invalid sizeDef: ${n}`)}class Mr{constructor(e,t,i,r){this.top=e||0,this.right=t||0,this.bottom=i||0,this.left=r||0}get width(){return this.left+this.right}get height(){return this.top+this.bottom}expand(e){return e<=0?this:new Mr(this.top+e,this.right+e,this.bottom+e,this.left+e)}add(e){return new Mr(this.top+e.top,this.right+e.right,this.bottom+e.bottom,this.left+e.left)}subtract(e){return new Mr(this.top-e.top,this.right-e.right,this.bottom-e.bottom,this.left-e.left)}union(e){return new Mr(Math.max(this.top,e.top),Math.max(this.right,e.right),Math.max(this.bottom,e.bottom),Math.max(this.left,e.left))}getHorizontal(){return new Mr(0,this.right,0,this.left)}getVertical(){return new Mr(this.top,0,this.bottom,0)}get horizontalTotal(){return this.left+this.right}get verticalTotal(){return this.top+this.bottom}static createFromConfig(e){return typeof e=="number"?this.createUniformPadding(e):e?this.createFromRecord(e):jN}static createFromRecord(e){return new Mr(e.top,e.right,e.bottom,e.left)}static zero(){return jN}static createUniformPadding(e){return new Mr(e,e,e,e)}}const jN=Mr.createUniformPadding(0);Object.freeze(jN);const Hme=/^([A-Za-z]+:)?\/\//;function Ume(n,e){if(e&&Hme.test(e))return e;const t=n();return t&&e?t.endsWith("/")?t+e:t+"/"+e:t??e}const lK="VISIT_SKIP",Vb="VISIT_STOP",Y8=n=>n;var $m,_1,b1,BD,hK,v1,qN,bU;let cK=(bU=class{constructor(e,t,i,r,s){Vt(this,BD);Vt(this,v1);Vt(this,$m,{});Vt(this,_1,{});Vt(this,b1,{});dr(this,"opacityFunction",Y8);if(!e)throw new Error("View spec must be defined!");this.context=t,this.layoutParent=i,this.dataParent=r,this.name=e.name||s,this.spec=e,this.resolutions={scale:{},axis:{}},eK(this),this.blockEncodingInheritance=!1,this.contributesToScaleDomain=!0,this.needsAxes={x:!1,y:!1}}getPadding(){return this._cache("size/padding",()=>Mr.createFromConfig(this.spec.padding))}getOverhang(){return Mr.zero()}getSize(){return this._cache("size/size",()=>this.isConfiguredVisible()?_t(this,BD,hK).call(this):$me)}isConfiguredVisible(){return this.context.isViewConfiguredVisible(this)}isVisibleInSpec(){return this.spec.visible??!0}isVisible(){return this.getLayoutAncestors().every(e=>e.isConfiguredVisible())}getEffectiveOpacity(){var e;return this.opacityFunction(((e=this.layoutParent)==null?void 0:e.getEffectiveOpacity())??1)}getPathString(){return this.getLayoutAncestors().map(e=>e.name).reverse().join("/")}getLayoutAncestors(){return _t(this,v1,qN).call(this,"layoutParent")}getDataAncestors(){return _t(this,v1,qN).call(this,"dataParent")}handleBroadcast(e){for(const t of Ze(this,$m)[e.type]||[])t(e)}_addBroadcastHandler(e,t){let i=Ze(this,$m)[e];i||(i=[],Ze(this,$m)[e]=i),i.push(t)}handleInteractionEvent(e,t,i){const r=i?Ze(this,_1):Ze(this,b1);for(const s of r[t.type]||[])s(e,t)}addInteractionEventListener(e,t,i){const r=i?Ze(this,_1):Ze(this,b1);let s=r[e];s||(s=[],r[e]=s),s.push(t)}visit(e){try{const t=e(this);if(e.postOrder&&e.postOrder(this),t!==Vb)return t}catch(t){throw t.view=this,t}}getDescendants(){const e=[];return this.visit(t=>{e.push(t)}),e}onScalesResolved(){(!this.opacityFunction||this.opacityFunction===Y8)&&(this.opacityFunction=qme(this))}onBeforeRender(){}render(e,t,i={}){}getEncoding(){const e=this.dataParent&&!this.blockEncodingInheritance?this.dataParent.getEncoding():{},t=this.spec.encoding||{},i={...e,...t};for(const[r,s]of Object.entries(i))s===null&&delete i[r];return i}getFacetAccessor(e){if(this.layoutParent)return this.layoutParent.getFacetAccessor(this)}getFacetFields(e){var i;const t=this.getEncoding().sample;return z1(t)?[t.field]:(i=this.layoutParent)==null?void 0:i.getFacetFields(this)}getSampleFacetTexture(){}getScaleResolution(e){const t=qf(e);return this.getDataAncestors().map(i=>i.resolutions.scale[t]).find(i=>i)}getAxisResolution(e){const t=qf(e);return this.getDataAncestors().map(i=>i.resolutions.axis[t]).find(i=>i)}getConfiguredResolution(e,t){var i,r;return(r=(i=this.spec.resolve)==null?void 0:i[t])==null?void 0:r[e]}getConfiguredOrDefaultResolution(e,t){return this.getConfiguredResolution(e,t)??this.getConfiguredResolution("default",t)??this.getDefaultResolution(e,t)}getDefaultResolution(e,t){return"independent"}getBaseUrl(){return Ume(()=>{var e;return(e=this.dataParent)==null?void 0:e.getBaseUrl()},this.spec.baseUrl)}isPickingSupported(){return!0}getTitleText(){const e=this.spec.title;if(e)return un(e)?e:e.text}_cache(e,t){return s_(this,e,t)}_invalidateCacheByPrefix(e,t="self"){switch(t){case"self":mS(this,e);break;case"ancestors":for(const i of this.getLayoutAncestors())mS(i,e);break;case"progeny":this.visit(i=>mS(i,e));break}}invalidateSizeCache(){this._invalidateCacheByPrefix("size/","ancestors")}propagateInteractionEvent(e){}},$m=new WeakMap,_1=new WeakMap,b1=new WeakMap,BD=new WeakSet,hK=function(){const e=t=>{var r;let i=this.spec[t];if(uK(i)){const s=i.step,o=(r=this.getScaleResolution(t=="width"?"x":"y"))==null?void 0:r.getScale();if(o){let a=0;if(Vu(o.type))a=o.domain().length;else if(["locus","index"].includes(o.type)){const c=o.domain();a=T1(c)-c[0]}else throw new Error(`Cannot use step-based size with "${o.type}" scale!`);const l=o;return a=o4(a,l.paddingInner(),l.paddingOuter()),{px:a*s,grow:0}}else throw new Error("Cannot use 'step' size with missing scale!")}else return(i&&aK(i))??{px:0,grow:1}};return this._cache("size/sizeFromSpec",()=>new Gf(e("width"),e("height")))},v1=new WeakSet,qN=function(e){const t=[];let i=this;do t.push(i),i=i[e];while(i);return t},bU);function jme(n){return"unitsPerPixel"in n}function qme(n){const e=n.spec.opacity;if(e!==void 0){if(Os(e))return t=>t*e;if(jme(e)){const t=s=>{var a;const o=(a=n.getScaleResolution(s))==null?void 0:a.getScale();if(["linear","index","locus"].includes(o==null?void 0:o.type))return o},i=e.channel?t(e.channel):t("x")||t("y");if(!i)throw new Error("Cannot find a resolved quantitative scale for dynamic opacity!");const r=QP().domain(e.unitsPerPixel).range(e.values).clamp(!0);return s=>{const a=yx(i.domain())/1e3;return r(a)*s}}}return t=>t}const uK=n=>!!(n!=null&&n.step);class o_ extends cK{constructor(e,t,i,r,s){super(e,t,i,r,s),this.spec=e}*[Symbol.iterator](){}replaceChild(e,t){throw new Error("Not implemented")}visit(e){let t;try{t=e(this)}catch(i){throw i.view=this,i}if(t===Vb)return t;if(t!==lK){e.beforeChildren&&e.beforeChildren(this);for(const i of this){const r=i.visit(e);if(r===Vb)return r}e.afterChildren&&e.afterChildren(this),e.postOrder&&e.postOrder(this)}}findDescendantByPath(e){for(const t of this)if(t.name===e[0]){if(e.length==1)return t;if(t instanceof o_)return t.findDescendantByPath(e.slice(1))}}findChildByName(e){for(const t of this)if(t.name===e)return t}findDescendantByName(e){let t;return this.visit(i=>{if(i.name==e)return t=i,Vb}),t}getDefaultResolution(e,t){return"shared"}}const X8=1;function R4(){let n=[0,1],e=[0,1],t=1,i=1,r=0,s=0,o=.5,a=0;const c=h=>(h+o-n[0])/t*i+e[0];return c.invert=h=>(h-e[0])/i*t+n[0]-o,c.domain=function(h){if(arguments.length){n=sae(h),t=n[1]-n[0];const u=n[0]===0&&n[0]===0;if(t<X8&&!u){t=X8;const d=(n[0]+n[1])/2;n[0]=d-t/2,n[1]=d+t/2}return c}else return n.slice()},c.range=function(h){return arguments.length?(e=[...h],i=e[1]-e[0],c):e},c.numberingOffset=function(h){return arguments.length?(a=h,c):a},c.padding=function(h){return arguments.length?(s=h,r=Math.min(1,h),c):r},c.paddingInner=function(h){return arguments.length?(r=Math.min(1,h),c):r},c.paddingOuter=function(h){return arguments.length?(s=h,c):s},c.align=function(h){return arguments.length?(o=Math.max(0,Math.min(1,h)),c):o},c.step=()=>i/t,c.bandwidth=()=>c.step(),c.ticks=h=>{const u=c.align(),d=c.numberingOffset();return Sx(n[0]-u+d,n[1]-u+d,Math.min(h,Math.ceil(t))).filter(Number.isInteger).map(f=>f-a)},c.tickFormat=(h,u)=>{if(u)throw new Error("Index scale's tickFormat does not support a specifier!");const f=$f(n[0],n[1],Math.min(h,Math.ceil(t)))<1e5?Cr(","):Cr(".3s");return g=>f(g+a)},c.copy=()=>R4().domain(n).range(e).paddingInner(r).paddingOuter(s).numberingOffset(a),c}function Gme(){const n=R4().numberingOffset(1);let e;n.genome=function(i){return arguments.length?(e=i,n):e},n.ticks=i=>{if(!e)return[];const r=n.domain(),s=n.numberingOffset(),[o,a]=[Math.max(r[0],0),Math.min(r[1],e.totalSize-1)].map(h=>e.toChromosome(h)),l=Math.max(1,$f(r[0],r[1],i)),c=[];for(let h=o.index;h<=a.index;h++){const u=e.chromosomes[h],d=Math.max(u.continuousStart+l,r[0]-(r[0]-u.continuousStart)%l),f=Math.min(u.continuousEnd-l/4,r[1]+1);for(let g=d;g<=f;g+=l){const p=g-s;p>=r[0]&&p<r[1]&&c.push(p)}}return c},n.tickFormat=(i,r)=>{if(!e)return;if(r)throw new Error("Locus scale's tickFormat does not support a specifier!");const s=n.domain(),o=s[1]-s[0],a=n.numberingOffset(),c=$f(s[0],s[1],Math.min(i,Math.ceil(o)))<1e6?Cr(","):Cr(".3s"),h=u=>u-e.toChromosome(u).continuousStart;return u=>c(h(u)+a)};const t=n.copy;return n.copy=()=>t().genome(e),n}function Kme(n){return n.type=="locus"}function zx(n,e,t){if(t=t||[],n.some(o=>o===null)){if(n.every(o=>o===null))return null;throw console.warn(n),new Error("Cannot merge objects with nulls!")}const i={},r=(o,a)=>o===a||up(o)&&up(a)||up(o)&&a===!0||o===!0&&Qa(a),s=o=>{for(let a in o){const l=o[a];if(!t.includes(a)&&l!==void 0)if(i[a]!==void 0&&!r(i[a],l))console.warn(`Conflicting property ${a} of ${e}: (${JSON.stringify(i[a])} and ${JSON.stringify(o[a])}). Using ${JSON.stringify(i[a])}.`);else{const c=i[a];if(up(c))up(l)&&(i[a]=zx([c,l],a));else if(up(l)){if(!(c===!0||c===void 0))throw new Error("Bug in merge! Target is: "+c);i[a]=zx([{},l],a)}else i[a]=l}}};for(const o of n)s(o);return i}function up(n){return Qa(n)&&!Array.isArray(n)}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/ticks.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */function dK(n,e,t){return Os(e)&&t!=null&&(e=Math.min(e,~~(yx(n.domain())/t)||1)),Qa(e)&&(e.step,e=e.interval),e}function fK(n,e,t){var i=n.range(),r=Math.floor(i[0]),s=Math.ceil($a(i));if(r>s&&(i=s,s=r,r=i),e=e.filter(function(a){return a=n(a),r<=a&&a<=s}),t>0&&e.length>1){for(var o=[e[0],$a(e)];e.length>t&&e.length>=3;)e=e.filter(function(a,l){return!(l%2)});e.length<3&&(e=o)}return e}function Zme(n,e){return n.bins?fK(n,Yme(n.bins,e)):n.ticks?n.ticks(e):n.domain()}function Yme(n,e){var t=n.length,i=~~(t/(e||t));return i<2?n.slice():n.filter(function(r,s){return!(s%i)})}function Xme(n,e,t){var i=n.tickFormat?n.tickFormat(e,t):t?Cr(t):String;if($q(n.type)){var r=Jme(t);i=n.bins?r:Qme(i,r)}return i}function Qme(n,e){return function(t){return n(t)?e(t):""}}function Jme(n){var e=Mu(n||",");if(e.precision==null){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1;break}return e_e(Cr(e),Cr(".1f")(1)[1])}else return Cr(e)}function e_e(n,e){return function(t){var i=n(t),r=i.indexOf(e),s,o;if(r<0)return i;for(s=t_e(i,r),o=s<i.length?i.slice(s):"";--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function t_e(n,e){var t=n.lastIndexOf("e"),i;if(t>0)return t;for(t=n.length;--t>e;)if(i=n.charCodeAt(t),i>=48&&i<=57)return t+1}/*!
 * Adapted from vega-encode:
 * https://github.com/vega/vega/blob/master/packages/vega-encode/src/Scale.js
 *
 * Copyright (c) 2015-2018, University of Washington Interactive Data Lab
 * All rights reserved.
 *
 * BSD-3-Clause License: https://github.com/vega/vega-lite/blob/master/LICENSE
 */const i_e="locus",n_e="index";var r_e=5;function s_e(n){const e=n.type;return!n.bins&&(e===i_||e===P1||e===B1)}function gK(n){return Pr(n)&&![jl,n_e,i_e].includes(n)}function pK(n){return n||{warn:(e,...t)=>console.warn(e,...t)}}var o_e=Cx(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma","zoom","fp64","name"]);function mK(n,e,t){t=pK(t);for(const i in n)if(!o_e[i]){if(i==="padding"&&gK(e.type))continue;Ms(e[i])?e[i](n[i]):t.warn("Unsupported scale property: "+i)}g_e(e,n,f_e(e,n,h_e(e,n,t)))}function a_e(n,e){const t=l_e(n),i=di(t);if(!i)throw new Error("Unknown scale type: "+t);const r=i();return!n.domain&&Pr(r.type)&&(n.domain=[0,0]),mK(n,r,e),r}function l_e(n){var e=n.type,t="",i;return e===jl?jl+"-"+i_:(c_e(n)&&(i=n.rawDomain?n.rawDomain.length:n.domain?n.domain.length+ +(n.domainMid!=null):0,t=i===2?jl+"-":i===3?Q_+"-":""),(t+e||i_).toLowerCase())}function c_e(n){const e=n.type;return Pr(e)&&e!==Rq&&e!==Mq&&(n.scheme||n.range&&n.range.length&&n.range.every(un))}function h_e(n,e,t){if(!n.domain)return 0;t=pK(t);var i=u_e(n,e.domainRaw,t);if(i>-1)return i;var r=e.domain,s=n.type,o=e.zero||e.zero===void 0&&s_e(n),a,l;return r?(gK(s)&&e.padding&&r[0]!==$a(r)&&(r=d_e(s,r,e.range,e.padding,e.exponent,e.constant)),(o||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),e.domainMin!=null&&(r[0]=e.domainMin),e.domainMax!=null&&(r[a]=e.domainMax),e.domainMid!=null&&(l=e.domainMid,(l<r[0]||l>r[a])&&t.warn("Scale domainMid exceeds domain min or max.",l),r.splice(a,0,l))),n.domain(_K(s,r,t)),s===a4&&n.unknown(e.domainImplicit?bN:void 0),e.nice&&n.nice&&n.nice(e.nice!==!0&&dK(n,e.nice)||null),r.length):0}function u_e(n,e,t){return e?(n.domain(_K(n.type,e,t)),e.length):-1}function d_e(n,e,t,i,r,s){var o=Math.abs($a(t)-t[0]),a=o/(o-2*i),l=n===Bu?sj(e,null,a):n===B1?lN(e,null,a,.5):n===P1?lN(e,null,a,r||1):n===_k?Ioe(e,null,a,s||1):rj(e,null,a);return e=e.slice(),e[0]=l[0],e[e.length-1]=l[1],e}function _K(n,e,t){if($q(n)){var i=Math.abs(e.reduce(function(r,s){return r+(s<0?-1:s>0?1:0)},0));i!==e.length&&t.warn("Log scale domain includes zero: "+tk(e))}return e}function f_e(n,e,t){let i=e.bins;if(i&&!po(i)){const r=(i.start==null||i.stop==null)&&n.domain(),s=i.start==null?r[0]:i.start,o=i.stop==null?$a(r):i.stop,a=i.step;a||cn("Scale bins parameter missing step property."),i=Rv(s,o+a,a)}return i?n.bins=i:n.bins&&delete n.bins,n.type===l4&&(i?!e.domain&&!e.domainRaw&&(n.domain(i),t=i.length):n.bins=n.domain()),t}function g_e(n,e,t){var i=n.type,r=e.round||!1,s=e.range;if(e.rangeStep!=null)s=p_e(i,e,t);else if(e.scheme&&(s=m_e(i,e,t),Ms(s))){if(n.interpolator)return n.interpolator(s);cn(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&bk(i))return n.interpolator(vk(GN(s,e.reverse),e.interpolate,e.interpolateGamma));s&&e.interpolate&&n.interpolate?n.interpolate(zq(e.interpolate,e.interpolateGamma)):Ms(n.round)?n.round(r):Ms(n.rangeRound)&&n.interpolate(r?F1:ld),s&&n.range(GN(s,e.reverse))}function p_e(n,e,t){n!==Pq&&n!==IN&&cn("Only band and point scales support rangeStep.");var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,r=n===IN?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*o4(t,r,i)]}function m_e(n,e,t){var i=e.schemeExtent,r,s;return po(e.scheme)?s=vk(e.scheme,e.interpolate,e.interpolateGamma):(r=e.scheme.toLowerCase(),s=h4(r),s||cn(`Unrecognized scheme name: ${e.scheme}`)),t=n===Oq?t+1:n===l4?t-1:n===LN||n===Fq?+e.schemeCount||r_e:t,bk(n)?Q8(s,i,e.reverse):Ms(s)?Vue(Q8(s,i),t):n===a4?s:s.slice(0,t)}function Q8(n,e,t){return Ms(n)&&(e||t)?Bue(n,GN(e||[0,1],t)):n}function GN(n,e){return e?n.slice().reverse():n}const J8=Cr(",d");function __e(n,e){return n.chrom+":"+J8(Math.floor(n.pos+1))+"-"+(n.chrom!=e.chrom?e.chrom+":":"")+J8(Math.ceil(e.pos))}const b_e="https://genomespy.app/data/genomes/";class v_e{constructor(e){if(this.config=e,!this.config.contigs&&typeof this.config.name!="string")throw new Error("No name has been defined for the genome assembly!");this.chromosomes=[],this.cumulativeChromPositions=new Map,this.chromosomesByName=new Map,this.startByIndex=[],this.totalSize=0,this.config.contigs&&this.setChromSizes(this.config.contigs)}get name(){return this.config.name}async load(e){if(!this.config.contigs){this.config.baseUrl?this.baseUrl=/^http(s)?/.test(this.config.baseUrl)?this.config.baseUrl:e+"/"+this.config.baseUrl:this.baseUrl=b_e;try{this.setChromSizes(w_e(await ok({baseURL:this.baseUrl}).load(`${this.config.name}/${this.name}.chrom.sizes`)))}catch(t){throw new Error(`Could not load chrom sizes: ${t.message}`)}}}hasChrPrefix(){return this.chromosomes.some(e=>e.name.startsWith("chr"))}setChromSizes(e){let t=0;this.startByIndex=[0];for(let i=0;i<e.length;i++){this.startByIndex.push(t);const r=e[i].size,s={...e[i],continuousStart:t,continuousEnd:t+r,continuousInterval:[t,t+r],index:i,number:i+1,odd:!(i&1)};this.chromosomes.push(s);const o=s.name.replace(/^chr/i,"");for(const a of["chr"+o,"CHR"+o,"Chr"+o,s.number,""+s.number,o,s.name])this.cumulativeChromPositions.set(a,t),this.chromosomesByName.set(a,s);t+=s.size}this.totalSize=t}getExtent(){return[0,this.totalSize]}toContinuous(e,t){let i=this.cumulativeChromPositions.get(e);if(i===void 0)throw new Error("Unknown chromosome/contig: "+e);return i+ +t}toChromosome(e){if(e>this.totalSize)return;e=Math.floor(e);const t=Y_(this.startByIndex,e)-1;if(t>0&&t<=this.chromosomes.length)return this.chromosomes[t-1]}toChromosomal(e){const t=this.toChromosome(e);if(t)return{chrom:t.name,pos:Math.floor(e)-t.continuousStart}}getChromosome(e){return this.chromosomesByName.get(e)}formatInterval(e){return __e(...this.toChromosomalInterval(e))}toChromosomalInterval(e){const t=this.toChromosomal(e[0]+.5),i=this.toChromosomal(e[1]-.5);return i.pos+=1,[t,i]}toContinuousInterval(e){var r;let[t,i]=e;return i||(i=t),[this.toContinuous(t.chrom,t.pos??0),this.toContinuous(i.chrom,i.pos??((r=this.chromosomesByName.get(i.chrom))==null?void 0:r.size))]}toDiscreteChromosomeIntervals(e){const t=e[0],i=e[1],r=[];if(t.chrom===i.chrom)r.push({chrom:t.chrom,startPos:t.pos,endPos:i.pos});else{const s=this.chromosomes.findIndex(a=>a.name===t.chrom),o=this.chromosomes.findIndex(a=>a.name===i.chrom);r.push({chrom:t.chrom,startPos:t.pos,endPos:this.chromosomes[s].size});for(let a=s+1;a<o;a++)r.push({chrom:this.chromosomes[a].name,startPos:0,endPos:this.chromosomes[a].size});r.push({chrom:i.chrom,startPos:0,endPos:i.pos})}return r}continuousToDiscreteChromosomeIntervals(e){return this.toDiscreteChromosomeIntervals([this.toChromosomal(e[0]),this.toChromosomal(e[1])])}parseInterval(e){const t=e.match(/^(chr[0-9A-Z]+)(?::([0-9,]+)(?:-(?:(chr[0-9A-Z]+):)?([0-9,]+))?)?$/);if(t){const i=t[1];if(t.slice(2).every(a=>a===void 0)){const a=this.getChromosome(i);return a?[a.continuousStart,a.continuousEnd]:void 0}const r=t[3]||i,s=parseInt(t[2].replace(/,/g,"")),o=t[4]!==void 0?parseInt(t[4].replace(/,/g,"")):s;return[this.toContinuous(i,s-1),this.toContinuous(r,o)]}}}function w_e(n){return Koe(n).filter(e=>/^chr[0-9A-Z]+$/.test(e[0])).map(([e,t])=>({name:e,size:parseInt(t)}))}function bK(n){return Qa(n)&&"chrom"in n}function y_e(n){return n.every(bK)}class K1 extends Array{constructor(){super(),this.type=void 0}extend(e){return this}extendAll(e){if(e instanceof K1&&e.type!=this.type)throw new Error(`Cannot combine different types of domains: ${this.type} and ${e.type}`);for(const t of e)this.extend(t);return this}extendAllWithAccessor(e,t){for(const i of e)this.extend(t(i));return this}}class j2 extends K1{constructor(){super(),this.type="quantitative"}extend(e){return e==null||Number.isNaN(e)?this:(e=+e,this.length?e<this[0]?this[0]=e:e>this[1]&&(this[1]=e):(this.push(e),this.push(e)),this)}}class vK extends K1{constructor(){super(),this.type="ordinal",this.uniqueValues=new Set}extend(e){return e==null||Number.isNaN(e)?this:(this.uniqueValues.has(e)||(this.uniqueValues.add(e),this.push(e)),this)}}class wK extends vK{constructor(){super(),this.type="nominal"}}class C_e extends K1{constructor(e){super();let t=0;for(let i=1;i<e.length;i++)t+=Math.sign(e[i]-e[i-1]);if(Math.abs(t)!=e.length-1)throw new Error("Piecewise domain must be strictly increasing or decreasing: "+JSON.stringify(e));e.forEach(i=>this.push(i))}extend(e){if(this.includes(e))return this;throw new Error("Piecewise domains are immutable and cannot be unioned!")}}const e7={quantitative:j2,index:j2,locus:j2,nominal:wK,ordinal:vK};function t7(n,e){if(n=="quantitative"&&S_e(e)){const t=new C_e(e);return t.type=n,t}else if(e7[n]){const t=new e7[n];return t.type=n,e&&t.extendAll(e),t}throw new Error("Unknown type: "+n)}function S_e(n){return n&&n.length>0&&n.length!=2&&n.every(e=>typeof e=="number")}function x_e(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}function E_e(n,e,t){return n*Math.pow(e/n,t)}di("index",R4,["continuous"]);di("locus",Gme,["continuous"]);di("null",wk,[]);const i7="quantitative",yK="ordinal",CK="nominal",SK="locus",D_e="index";var Qc,zm,gr,Dl,zh,VD,xK,Hm,_S,Jc,Nd,w1,KN,WD,EK,lP,L_e,y1,ZN;class k_e{constructor(e){Vt(this,Dl);Vt(this,VD);Vt(this,Hm);Vt(this,Jc);Vt(this,w1);Vt(this,WD);Vt(this,lP);Vt(this,y1);Vt(this,Qc,void 0);Vt(this,zm,new Set);Vt(this,gr,void 0);this.channel=e,this.members=[],this.type=null,this.name=void 0}addEventListener(e,t){if(e!="domain")throw new Error("Unsupported event type: "+e);Ze(this,zm).add(t)}removeEventListener(e,t){if(e!="domain")throw new Error("Unsupported event type: "+e);Ze(this,zm).delete(t)}pushUnitView(e,t){var o;const i=TN(e,t),r=i.type,s=(o=i==null?void 0:i.scale)==null?void 0:o.name;if(s){if(this.name!==void 0&&s!=this.name)throw new Error(`Shared scales have conflicting names: "${s}" vs. "${this.name}"!`);this.name=s}if(!this.type)this.type=r;else if(r!==this.type&&!Pb(t))throw new Error(`Can not use shared scale for different data types: ${this.type} vs. ${r}. Use "resolve: independent" for channel ${this.channel}`);this.members.push({view:e,channel:t})}isExplicitDomain(){return!!this.getConfiguredDomain()}isDomainInitialized(){const e=Ze(this,gr);if(!e)return!1;const t=e.domain();return Pr(e.type)?t.length>2||t.length==2&&(t[0]!==0||t[1]!==0):t.length>0}getScaleProps(){return s_(this,"scaleProps",()=>{const e=_t(this,VD,xK).call(this);if(e===null||e.type=="null")return{type:"null"};const t={..._t(this,WD,EK).call(this,this.type),...e};t.type||(t.type=I_e(this.channel,this.type));const i=_t(this,Hm,_S).call(this);return i&&i.length>0?t.domain=i:Vu(t.type)&&(t.domain=new wK),!t.domain&&t.domainMid!==void 0&&(t.domain=[t.domainMin??0,t.domainMax??1]),this.channel=="y"&&Vu(t.type)&&t.reverse==null&&(t.reverse=!0),t.range&&t.scheme&&delete t.scheme,!("zoom"in t)&&["index","locus"].includes(t.type)&&(t.zoom=!0),T_e(t,this.channel),t})}getConfiguredDomain(){return _t(this,y1,ZN).call(this,e=>Pb(e.channel)?void 0:e.view.getConfiguredDomain(e.channel))}getDataDomain(){return _t(this,y1,ZN).call(this,e=>Pb(e.channel)?void 0:e.view.extractDataDomain(e.channel))}reconfigure(){if(Ze(this,gr)&&Ze(this,gr).type!="null"){const e=this.isDomainInitialized(),t=Ze(this,gr).domain();JG(this,"scaleProps");const i=this.getScaleProps();if(mK(i,Ze(this,gr)),Pr(Ze(this,gr).type)&&Co(this,Qc,_t(this,w1,KN).call(this)),!e){_t(this,Dl,zh).call(this);return}const r=Ze(this,gr).domain();Tx(r,t)||(this.isZoomable()?Ze(this,gr).domain(t):_t(this,Jc,Nd).call(this)?(Ze(this,gr).domain(t),this.zoomTo(r,500)):_t(this,Dl,zh).call(this))}}getScale(){if(Ze(this,gr))return Ze(this,gr);const e=this.getScaleProps(),t=a_e(e);return Co(this,gr,t),Kme(t)&&t.genome(this.getGenome()),Pr(t.type)&&Co(this,Qc,_t(this,w1,KN).call(this)),t}getDomain(){return this.getScale().domain()}getComplexDomain(){var e;return((e=this.getGenome())==null?void 0:e.toChromosomalInterval(this.getDomain()))??this.getDomain()}isZoomed(){return _t(this,Jc,Nd).call(this)&&Tx(_t(this,Hm,_S).call(this),this.getDomain())}isZoomable(){return _t(this,Jc,Nd).call(this)&&!!this.getScaleProps().zoom}zoom(e,t,i){if(!_t(this,Jc,Nd).call(this))return!1;const r=this.getScale(),s=r.domain();let o=[...s],a=r.invert(t);switch(this.getScaleProps().reverse&&(i=-i),"align"in r&&(a+=r.align()),r.type){case"linear":case"index":case"locus":o=Doe(o,i||0),o=rj(o,a,e);break;case"log":o=koe(o,i||0),o=sj(o,a,e);break;case"pow":case"sqrt":{const l=r;o=Loe(o,i||0,l.exponent()),o=lN(o,a,e,l.exponent());break}default:throw new Error("Zooming is not implemented for: "+r.type)}return Ze(this,Qc)&&(o=Toe(o,Ze(this,Qc)[0],Ze(this,Qc)[1])),[0,1].some(l=>o[l]!=s[l])?(r.domain(o),_t(this,Dl,zh).call(this),!0):!1}async zoomTo(e,t=!1){var a;if(ek(t)&&(t=t?700:0),!_t(this,Jc,Nd).call(this))throw new Error("Not a zoomable scale!");const i=this.fromComplexInterval(e),r=(a=this.members[0])==null?void 0:a.view.context.animator,s=this.getScale(),o=s.domain();if(t>0&&o.length==2){const l=o[1]-o[0],c=o[0]+l/2,h=i[1]-i[0],u=i[0]+h/2;await r.transition({duration:t,easingFunction:x_e,onUpdate:d=>{const f=E_e(l,h,d),g=(l-f)/(l-h),p=g*u+(1-g)*c;s.domain([p-f/2,p+f/2]),_t(this,Dl,zh).call(this)}}),s.domain(i),_t(this,Dl,zh).call(this)}else s.domain(i),r==null||r.requestRender(),_t(this,Dl,zh).call(this)}resetZoom(){if(!_t(this,Jc,Nd).call(this))throw new Error("Not a zoomable scale!");const e=this.getDomain(),t=_t(this,Hm,_S).call(this);return[0,1].some(i=>t[i]!=e[i])?(Ze(this,gr).domain(t),_t(this,Dl,zh).call(this),!0):!1}getZoomLevel(){return this.isZoomable()?yx(Ze(this,Qc))/yx(this.getScale().domain()):1}getGenome(){var t;if(this.type!=="locus")return;const e=(t=this.members[0].view.context.genomeStore)==null?void 0:t.getGenome();if(!e)throw new Error("No genome has been defined!");return e}invertToComplex(e){const t=this.getScale();if("invert"in t){const i=t.invert(e);return this.toComplex(i)}else throw new Error("The scale does not support inverting!")}toComplex(e){const t=this.getGenome();return t?t.toChromosomal(e):e}fromComplex(e){return bK(e)?this.getGenome().toContinuous(e.chrom,e.pos):e}fromComplexInterval(e){return this.type==="locus"&&y_e(e)?this.getGenome().toContinuousInterval(e):e}}Qc=new WeakMap,zm=new WeakMap,gr=new WeakMap,Dl=new WeakSet,zh=function(){for(const e of Ze(this,zm).values())e({type:"domain",scaleResolution:this})},VD=new WeakSet,xK=function(){return s_(this,"mergedScaleProps",()=>{const e=this.members.map(t=>TN(t.view,t.channel).scale).filter(t=>t!==void 0);return zx(e,"scale",["domain"])})},Hm=new WeakSet,_S=function(){return this.getConfiguredDomain()??(this.type==SK?this.getGenome().getExtent():this.getDataDomain())},Jc=new WeakSet,Nd=function(){const e=this.getScale().type;return Pr(e)},w1=new WeakSet,KN=function(){const e=this.getScaleProps(),t=e.zoom;if(A_e(t)&&po(t.extent))return this.fromComplexInterval(t.extent);if(t)return e.type=="locus"?this.getGenome().getExtent():Ze(this,gr).domain()},WD=new WeakSet,EK=function(e){const t=this.channel,i={};return this.isExplicitDomain()&&(i.zero=!1),qv(t)?i.nice=!this.isExplicitDomain():Sf(t)?i.scheme=e==CK?"tableau10":e==yK?"blues":"viridis":yk(t)?i.range=Kq(t):t=="size"?i.range=[0,400]:t=="angle"&&(i.range=[0,360]),i},lP=new WeakSet,L_e=function(){return this.members.map(e=>e.view.getPathString()).join(", ")},y1=new WeakSet,ZN=function(e){const t=this.members.filter(i=>!i.view.getLayoutAncestors().some(r=>!r.contributesToScaleDomain)).map(e).filter(i=>!!i);if(t.length)return t.reduce((i,r)=>i.extendAll(r))};function I_e(n,e){if(e==D_e||e==SK){if(qq(n))return e;throw new Error(`${n} does not support ${e} data type. Only positional channels do.`)}const t={x:["band","band","linear"],y:["band","band","linear"],size:[void 0,"point","linear"],opacity:[void 0,"point","linear"],fillOpacity:[void 0,"point","linear"],strokeOpacity:[void 0,"point","linear"],color:["ordinal","ordinal","linear"],fill:["ordinal","ordinal","linear"],stroke:["ordinal","ordinal","linear"],strokeWidth:[void 0,void 0,"linear"],shape:["ordinal","ordinal",void 0],dx:[void 0,void 0,"null"],dy:[void 0,void 0,"null"],angle:[void 0,void 0,"linear"]},r=["sample"].includes(n)?"null":t[n]?t[n][[CK,yK,i7].indexOf(e)]:e==i7?"linear":"ordinal";if(r===void 0)throw new Error(`Channel "${n}" is not compatible with "${e}" data type. Use of a proper scale may be needed.`);return r}function T_e(n,e){qv(e)&&n.type!=="ordinal"&&(n.range=[0,1]),e=="opacity"&&Pr(n.type)&&(n.clamp=!0)}function A_e(n){return Qa(n)}function YN(n){const e=new Set;function t(i){for(const r of Object.values(i.resolutions.scale))e.add(r)}for(const i of Fs(n)){i.visit(t);for(const r of i.getDataAncestors()){if(!r.contributesToScaleDomain)break;t(r)}}e.forEach(i=>i.reconfigure())}function q2(...n){for(const e of n)if(e!==void 0)return e}class N_e{constructor(e){this.channel=e,this.members=[]}get scaleResolution(){var e;return(e=T1(this.members))==null?void 0:e.view.getScaleResolution(this.channel)}pushUnitView(e,t){const i=e.getScaleResolution(this.channel);if(!i)throw new Error("Cannot find a scale resolution!");if(this.scaleResolution&&i!==this.scaleResolution)throw new Error("Shared axes must have a shared scale!");this.members.push({view:e,channel:t})}getAxisProps(){return s_(this,"axisProps",()=>{const e=this.members.map(t=>{const i=t.view.mark.encoding[t.channel];return"axis"in i&&i.axis});return e.length>0&&e.some(t=>t===null)?null:zx(e.filter(t=>t!==void 0),"axis",["title"])})}getTitle(){const e=s=>{var a;const o=TN(s.view,s.channel);if(!za(o))return{member:s,explicitTitle:q2("axis"in o?(a=o.axis)==null?void 0:a.title:void 0,o.title),implicitTitle:q2(z1(o)?o.field:void 0,u4(o)?o.expr:void 0)}},t=this.members.map(e),i=t.filter(s=>{var o;if(Pb(s.member.channel)&&!s.explicitTitle){const a=qf(s.member.channel);return((o=t.find(l=>l.member.view==s.member.view&&l.member.channel==a))==null?void 0:o.explicitTitle)===void 0}return!0}),r=new Set(i.map(s=>q2(s.explicitTitle,s.implicitTitle)).filter(un));return r.size?[...r].join(", "):null}}const R_e={point:Dme,rect:vme,rule:Ime,link:Rme,text:Vme};class os extends o_{constructor(e,t,i,r,s){super(e,t,i,r,s),this.spec=e;const o=R_e[this.getMarkType()];if(o)this.mark=new o(this);else throw new Error(`No such mark: ${this.getMarkType()}`);this.coords=void 0,this.needsAxes={x:!0,y:!0}}render(e,t,i={}){this.isConfiguredVisible()&&(this.coords=t,e.pushView(this,t),e.renderMark(this.mark,i),e.popView(this))}getMarkType(){return typeof this.spec.mark=="object"?this.spec.mark.type:this.spec.mark}resolve(e){const t=this.mark.encoding;for(const[i,r]of Object.entries(t)){if(!$o(r))continue;const s=qf(r.resolutionChannel??i);if(!xf(s)||e=="axis"&&!qv(s))continue;let o=this;for(;(o.getConfiguredOrDefaultResolution(s,e)=="forced"||o.dataParent instanceof o_&&["shared","excluded","forced"].includes(o.dataParent.getConfiguredOrDefaultResolution(s,e)))&&o.getConfiguredOrDefaultResolution(s,e)!="excluded";)o=o.dataParent;e=="axis"&&qv(i)&&qq(s)?(o.resolutions[e][s]||(o.resolutions[e][s]=new N_e(s)),o.resolutions[e][s].pushUnitView(this,i)):e=="scale"&&xf(i)&&(o.resolutions[e][s]||(o.resolutions[e][s]=new k_e(s)),o.resolutions[e][s].pushUnitView(this,i))}}getAccessor(e){return this._cache("accessor/"+e,()=>{const t=this.mark.encoding;if(t&&t[e])return this.context.accessorFactory.createAccessor(t[e])})}getFacetAccessor(e){const t=this.getAccessor("sample");return t||super.getFacetAccessor(this)}getCollector(){return this.context.dataFlow.findCollectorByKey(this)}_validateDomainQuery(e){if(Pb(e))throw new Error(`getDomain(${e}), must only be called for primary channels!`);const t=this.mark.encoding[e];if(!$o(t))throw new Error("The channel has no scale, cannot get domain!");return t}getConfiguredDomain(e){const t=this._validateDomainQuery(e),i=t&&t.scale&&t.scale.domain;if(i){const r=this.getScaleResolution(t.resolutionChannel??e);return t7(t.type??"nominal",r.fromComplexInterval(i))}}extractDataDomain(e){const i=this._validateDomainQuery(e).type??"nominal",r=a=>{let l;const c=this.mark.encoding[a];if(c){const h=this.context.accessorFactory.createAccessor(c);if(h)if(l=t7(i),h.constant)l.extend(h({}));else{const u=this.getCollector();u!=null&&u.completed&&u.visitData(d=>l.extend(h(d)))}}return l};let s=r(e);const o=d4[e];if(o){const a=r(o);a&&s.extendAll(a)}return s}getZoomLevel(){const e=t=>{var i;return((i=this.getScaleResolution(t))==null?void 0:i.getZoomLevel())??1};return J_.map(e).reduce((t,i)=>t*i,1)}propagateInteractionEvent(e){this.handleInteractionEvent(void 0,e,!0),e.target=this,!e.stopped&&this.handleInteractionEvent(void 0,e,!1)}getDefaultResolution(e,t){return e=="x"?"shared":"independent"}}class DK extends cK{constructor(e,t,i,r,s){super(e,t,i,r,s),this.spec=e}}function*M4(n,e=[]){for(const[t,i]of n.entries())if(i instanceof Map)for(const r of M4(i,[...e,t]))yield r;else yield[[...e,t],i]}class kK extends Tn{get behavior(){return N4}constructor(e){super(),this.params=e??{type:"collect"},this.observers=[],this.facetBatches=void 0,this._init()}_init(){this._data=[],this.facetBatches=new Wf([],JSON.stringify),this.facetBatches.set(void 0,this._data)}reset(){super.reset(),this._init()}handle(e){this._data.push(e)}beginBatch(e){Sme(e)&&(this._data=[],this.facetBatches.set(Fs(e.facetId),this._data))}complete(){var r,s;const e=(r=this.params)==null?void 0:r.sort,t=e?oj(e.field,e.order):void 0,i=o=>{t&&o.sort(t)};if((s=this.params.groupby)!=null&&s.length){if(this.facetBatches.size>1)throw new Error("TODO: Support faceted data!");const o=this.params.groupby.map(l=>Ii(l)),a=nk(this._data,...o);this.facetBatches.clear();for(const[l,c]of M4(a))this.facetBatches.set(l,c)}for(const o of this.facetBatches.values())i(o);if(this.children.length)for(const[o,a]of this.facetBatches.entries()){if(o){const l={type:"facet",facetId:o};for(const c of this.children)c.beginBatch(l)}for(const l of a)this._propagate(l)}super.complete();for(const o of this.observers)o(this)}getData(){switch(this._checkStatus(),this.facetBatches.size){case 0:return[];case 1:return[...this.facetBatches.values()][0];default:{const e=this.facetBatches;return{[Symbol.iterator]:function*(){for(const i of e.values())for(let r=0;r<i.length;r++)yield i[r]}}}}}visitData(e){this._checkStatus();for(const t of this.facetBatches.values())for(let i=0;i<t.length;i++)e(t[i])}getItemCount(){let e=0;for(const t of this.facetBatches.values())e+=t.length;return e}_checkStatus(){if(!this.completed)throw new Error("Data propagation is not completed! No data are available.")}}class Hx{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(e,t){let i=this.length++;for(;i>0;){const r=i-1>>1,s=this.values[r];if(t>=s)break;this.ids[i]=this.ids[r],this.values[i]=s,i=r}this.ids[i]=e,this.values[i]=t}pop(){if(this.length===0)return;const e=this.ids[0];if(this.length--,this.length>0){const t=this.ids[0]=this.ids[this.length],i=this.values[0]=this.values[this.length],r=this.length>>1;let s=0;for(;s<r;){let o=(s<<1)+1;const a=o+1;let l=this.ids[o],c=this.values[o];const h=this.values[a];if(a<this.length&&h<c&&(o=a,l=this.ids[a],c=h),c>=i)break;this.ids[s]=l,this.values[s]=c,s=o}this.ids[s]=t,this.values[s]=i}return e}peek(){if(this.length!==0)return this.ids[0]}peekValue(){if(this.length!==0)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}class M_e extends Tn{get behavior(){return fc}constructor(e){super(),this.params=e,this.startAccessor=Ii(e.start),this.endAccessor=Ii(e.end),this.chromAccessor=e.chrom?Ii(e.chrom):t=>{},this.weightAccessor=e.weight?Ii(e.weight):t=>1,this.as={coverage:e.as||"coverage",start:e.asStart||e.start,end:e.asEnd||e.end,chrom:e.asChrom||e.chrom},this.createSegment=new Function("start","end","coverage","chrom","return {"+Object.entries(this.as).filter(([t,i])=>i).map(([t,i])=>`${JSON.stringify(i)}: ${t}`).join(", ")+"};"),this.ends=new Hx}reset(){super.reset(),this.initialize()}initialize(){const e=this.as.coverage,t=this.as.end,i=this.as.chrom,r=this.startAccessor,s=this.endAccessor,o=this.chromAccessor,a=this.weightAccessor;let l,c,h,u=0,d;const f=this.ends;f.clear();const g=(m,b,_)=>{if(m==b)return;let w=!1;l&&(l[e]===_?(l[t]=b,w=!0):l[e]!=0&&this._propagate(l)),w||(l=this.createSegment(m,b,_,h))},p=()=>{let m;for(;(m=f.peekValue())!==void 0;)g(d,m,u),d=m,u-=f.pop();d=void 0,l&&(this._propagate(l),l=void 0)};this.handle=m=>{const b=r(m);let _;for(;(_=f.peekValue())!==void 0&&_<b;)g(d,_,u),d=_,u-=f.pop();if(i){let y=o(m);y!==c&&(p(),h=y,c=h)}d!==void 0&&g(d,b,u),d=b;const w=a(m);u+=w,f.push(w,s(m))},this.complete=()=>{p(),super.complete()}}}function F_e(n,e,t=0,i=n.length){const r=new Hx,s=i-t;let o;for(o=0;o<e&&o<s;o++)r.push(o,n[t+o]);for(;o<s;o++){const c=n[t+o];c>=r.peekValue()&&(r.push(o,c),r.pop())}const a=[];let l;for(;(l=r.pop())!==void 0;)a.push(t+l);return a.reverse()}class O_e{constructor(e,t=-1/0,i=1/0){this.maxSize=e,this.lowerLimit=t,this.upperLimit=i;const r=this.maxSize*2+1;this.lowerLimits=new Float64Array(r),this.upperLimits=new Float64Array(r),this.lowerChildren=new Int32Array(r),this.upperChildren=new Int32Array(r),this.reset()}reset(){this.lowerLimits.fill(0),this.upperLimits.fill(0),this.lowerChildren.fill(0),this.upperChildren.fill(0),this.n=1,this.lowerLimits[0]=this.lowerLimit,this.upperLimits[0]=this.upperLimit}_findSlot(e,t,i=0){if(e>=this.lowerLimits[i]&&t<=this.upperLimits[i]){const r=this.lowerChildren[i];if(r){const s=this._findSlot(e,t,r);return s>=0?s:this._findSlot(e,t,this.upperChildren[i])}else return i}else return-1}reserve(e,t){if(t-e<=0)throw new Error("Cannot reserve an empty or negative-size slot!");if(this.n+1>this.lowerLimits.length)return!1;const i=this._findSlot(e,t);if(i<0)return!1;const r=this.n++,s=this.n++;return this.lowerLimits[r]=this.lowerLimits[i],this.upperLimits[r]=e,this.lowerLimits[s]=t,this.upperLimits[s]=this.upperLimits[i],this.lowerChildren[i]=r,this.upperChildren[i]=s,!0}}class P_e extends Tn{get behavior(){return N4}constructor(e,t){if(super(),this.params=e,this._data=[],this.channel=e.channel??"x",!["x","y"].includes(this.channel))throw new Error("Invalid channel: "+this.channel);this.posAccessor=Ii(this.params.pos),this.posBisector=ik(this.posAccessor),this.scoreAccessor=Ii(this.params.score),this.widthAccessor=Ii(this.params.width),this.laneAccessor=this.params.lane?Ii(this.params.lane):r=>0,this.padding=this.params.padding??0,this.reservationMaps=new Map,this.resolution=t.getScaleResolution(this.channel);const i=()=>this._filterAndPropagate();this.schedule=()=>t.context.animator.requestTransition(i),this.resolution.addEventListener("domain",r=>this.schedule()),t._addBroadcastHandler("layoutComputed",()=>this.schedule())}complete(){const e=this.posAccessor;this._data.sort((t,i)=>e(t)-e(i)),this._scores=this._data.map(this.scoreAccessor);for(const t of new Set(this._data.map(this.laneAccessor)))this.reservationMaps.set(t,new O_e(200));this.schedule(),super.complete()}_filterAndPropagate(){var o;super.reset();const e=this.resolution.getScale(),t=(o=this.resolution.members[0].view.coords)==null?void 0:o[this.channel=="x"?"width":"height"];if(!t)return;for(const a of this.reservationMaps.values())a.reset();const i=e.domain(),r=70,s=F_e(this._scores,r,this.posBisector.left(this._data,i[0]),this.posBisector.right(this._data,i[1]));for(const a of s){const l=this._data[a],c=e(this.posAccessor(l))*t,h=this.widthAccessor(l)/2+this.padding;this.reservationMaps.get(this.laneAccessor(l)).reserve(c-h,c+h)&&this._propagate(l)}super.complete()}reset(){super.reset(),this._data=[],this.groups=new Map}handle(e){this._data.push(e)}}class B_e extends Tn{constructor(e){super(),this.params=e,this.predicate=void 0}initialize(){this.predicate=UP(this.params.expr,this.getGlobalObject())}handle(e){this.predicate(e)&&this._propagate(e)}}class V_e extends Tn{get behavior(){return fc}constructor(e){super();const t=e.index;if(e.fields){const i=Fs(e.fields).map(s=>Ii(s)),r=Fs(e.as||e.fields);if(i.length!==r.length)throw new Error(`Lengths of "fields" (${i.length}), and "as" (${r.length}) do not match!`);this.handle=s=>{const o=i.map((l,c)=>l(s)??[]),a=o[0].length;for(let l=0;l<a;l++){const c=Object.assign({},s);for(let h=0;h<i.length;h++)c[r[h]]=l<o[h].length?o[h][l]:null;t&&(c[t]=l),this._propagate(c)}}}else this.handle=i=>{for(let r=0;r<i.length;r++){const s=Object.assign({},i[r]);t&&(s[t]=r),this._propagate(s)}}}}const W_e="0".charCodeAt(0);function*$_e(n,e=","){const t=e.charCodeAt(0);let i=0;for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);s==t?(yield i,i=0):i=i*10+s-W_e}yield i}class z_e extends Tn{get behavior(){return fc}constructor(e){super();const t=Ii(e.exons??"exons"),i=Ii(e.start??"start"),[r,s]=e.as||["exonStart","exonEnd"];this.handle=o=>{let a=i(o),l=a,c=!0;const h=t(o);for(const u of $_e(h)){if(c)l=a+u;else{a=l+u;const d=Object.assign({},o);d[r]=l,d[s]=a,this._propagate(d)}c=!c}}}}class H_e extends Tn{get behavior(){return fc}constructor(e){super();const t=Fs(e.field).map(s=>Ii(s)),i=Fs(e.separator),r=Fs(e.as||e.field);if(t.length!==i.length||t.length!==r.length)throw new Error(`Lengths of "separator" (${i.length}), "fields" (${t.length}), and "as" (${r.length}) do not match!`);this.handle=s=>{if(t.some(l=>!l(s)))return;const o=t.map((l,c)=>l(s).split(i[c]));U_e(o,s);const a=o[0].length;for(let l=0;l<a;l++){const c=Object.assign({},s);for(let h=0;h<t.length;h++)c[r[h]]=o[h][l];this._propagate(c)}}}}function U_e(n,e){const t=n.map(i=>i.length);if(!t.every(i=>i==t[0]))throw new Error("Mismatching number of elements in the fields to be split: "+JSON.stringify(e))}class j_e extends Tn{get behavior(){return fd}constructor(e){super(),this.params=e,this.as=e.as,this.fn=void 0}initialize(){this.fn=UP(this.params.expr,this.getGlobalObject())}handle(e){e[this.as]=this.fn(e),this._propagate(e)}}class LK extends Tn{get behavior(){return fd}constructor(e,t){super();const i=e.channel??"x";if(!["x","y"].includes(i))throw new Error("Invalid channel: "+i);const r=t.getScaleResolution(i).getGenome();if(!r)throw new Error("LinearizeGenomicCoordinate transform requires a locus scale!");const s=Ii(e.chrom),o=Fs(e.pos).map(g=>Ii(g)),a=Fs(e.as);if(o.length!=a.length)throw new Error('The number of "pos" and "as" elements must be equal!');const l=Fs(e.offset);let c;if(l.length==0)c=new Array(o.length).fill(0);else if(l.length==1)c=new Array(o.length).fill(l[0]);else if(l.length==o.length)c=l;else throw new Error(`Invalid "offset" parameter: ${JSON.stringify(e.offset)}!`);const h=new Function("datum","chromOffset","posAccessors",a.map((g,p)=>`datum[${JSON.stringify(g)}] = chromOffset + +posAccessors[${p}](datum) - ${c[p]};`).join(`
`));let u,d=0;const f=g=>{if(g!==u){if(d=r.cumulativeChromPositions.get(g),d===void 0)throw new Error("Unknown chromosome/contig: "+g);u=g}return d};this.handle=g=>{h(g,f(s(g)),o),this._propagate(g)}}}const q_e=["Lato-Regular.png"],G_e=[{id:87,width:53,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:43.491,chnl:15,x:0,y:0,page:0},{id:124,width:17,height:50,xoffset:0,yoffset:-32.193000000000005,xadvance:10.521,chnl:15,x:0,y:42,page:0},{id:40,width:20,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:94,page:0},{id:41,width:19,height:49,xoffset:0,yoffset:-32.571000000000005,xadvance:11.214,chnl:15,x:0,y:145,page:0},{id:36,width:32,height:49,xoffset:0,yoffset:-34.419000000000004,xadvance:24.360000000000003,chnl:15,x:0,y:196,page:0},{id:125,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:247,page:0},{id:91,width:22,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:297,page:0},{id:93,width:19,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.852,chnl:15,x:0,y:347,page:0},{id:123,width:21,height:48,xoffset:0,yoffset:-32.193000000000005,xadvance:12.642000000000001,chnl:15,x:0,y:397,page:0},{id:106,width:19,height:48,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:0,y:447,page:0},{id:81,width:43,height:47,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:21,y:447,page:0},{id:77,width:45,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:38.997,chnl:15,x:66,y:447,page:0},{id:64,width:43,height:44,xoffset:0,yoffset:-28.539,xadvance:35.133,chnl:15,x:23,y:397,page:0},{id:92,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:68,y:397,page:0},{id:47,width:28,height:43,xoffset:0,yoffset:-30.933000000000003,xadvance:18.984,chnl:15,x:98,y:397,page:0},{id:109,width:42,height:32,xoffset:0,yoffset:-21.609,xadvance:34.545,chnl:15,x:113,y:447,page:0},{id:119,width:42,height:31,xoffset:0,yoffset:-21.315,xadvance:32.991,chnl:15,x:157,y:447,page:0},{id:42,width:25,height:42,xoffset:0,yoffset:-31.626,xadvance:17.85,chnl:15,x:128,y:397,page:0},{id:37,width:42,height:41,xoffset:0,yoffset:-30.387,xadvance:33.663000000000004,chnl:15,x:155,y:397,page:0},{id:79,width:42,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:33.621,chnl:15,x:199,y:397,page:0},{id:102,width:24,height:41,xoffset:0,yoffset:-30.534000000000002,xadvance:14.721,chnl:15,x:243,y:397,page:0},{id:100,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:269,y:397,page:0},{id:98,width:32,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.520000000000003,chnl:15,x:302,y:397,page:0},{id:56,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:336,y:397,page:0},{id:38,width:40,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:29.904000000000003,chnl:15,x:370,y:397,page:0},{id:108,width:17,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:9.912,chnl:15,x:412,y:397,page:0},{id:107,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:21.336000000000002,chnl:15,x:431,y:397,page:0},{id:48,width:33,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:464,y:397,page:0},{id:71,width:38,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:30.681,chnl:15,x:21,y:347,page:0},{id:83,width:31,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:22.785,chnl:15,x:61,y:347,page:0},{id:63,width:27,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:18.795,chnl:15,x:94,y:347,page:0},{id:105,width:18,height:41,xoffset:0,yoffset:-30.639000000000003,xadvance:10.08,chnl:15,x:123,y:347,page:0},{id:51,width:32,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:143,y:347,page:0},{id:104,width:31,height:41,xoffset:0,yoffset:-30.933000000000003,xadvance:23.436,chnl:15,x:177,y:347,page:0},{id:67,width:37,height:41,xoffset:0,yoffset:-30.429000000000002,xadvance:28.056,chnl:15,x:210,y:347,page:0},{id:88,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.258000000000003,chnl:15,x:249,y:347,page:0},{id:68,width:40,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:31.941000000000003,chnl:15,x:288,y:347,page:0},{id:70,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:23.751,chnl:15,x:330,y:347,page:0},{id:34,width:23,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:15.561000000000002,chnl:15,x:364,y:347,page:0},{id:72,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:389,y:347,page:0},{id:73,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.760000000000002,chnl:15,x:429,y:347,page:0},{id:74,width:24,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:17.745,chnl:15,x:449,y:347,page:0},{id:75,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.825000000000003,chnl:15,x:24,y:297,page:0},{id:76,width:31,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:21.567,chnl:15,x:475,y:347,page:0},{id:66,width:35,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:27.153000000000002,chnl:15,x:64,y:297,page:0},{id:78,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:32.067,chnl:15,x:101,y:297,page:0},{id:33,width:18,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:11.298,chnl:15,x:141,y:297,page:0},{id:80,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.221,chnl:15,x:161,y:297,page:0},{id:65,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:197,y:297,page:0},{id:82,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.313000000000002,chnl:15,x:237,y:297,page:0},{id:35,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:275,y:297,page:0},{id:84,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.801000000000002,chnl:15,x:310,y:297,page:0},{id:85,width:37,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:30.891000000000002,chnl:15,x:346,y:297,page:0},{id:86,width:38,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:28.434,chnl:15,x:385,y:297,page:0},{id:39,width:16,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:8.568000000000001,chnl:15,x:425,y:297,page:0},{id:69,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.255000000000003,chnl:15,x:443,y:297,page:0},{id:89,width:36,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:26.208000000000002,chnl:15,x:23,y:247,page:0},{id:90,width:34,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:25.284000000000002,chnl:15,x:477,y:297,page:0},{id:49,width:31,height:40,xoffset:0,yoffset:-30.156000000000002,xadvance:24.360000000000003,chnl:15,x:61,y:247,page:0},{id:50,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:94,y:247,page:0},{id:57,width:32,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:24.360000000000003,chnl:15,x:128,y:247,page:0},{id:94,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:162,y:247,page:0},{id:96,width:21,height:40,xoffset:0,yoffset:-30.429000000000002,xadvance:16.8,chnl:15,x:196,y:247,page:0},{id:55,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:219,y:247,page:0},{id:54,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:254,y:247,page:0},{id:53,width:32,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:289,y:247,page:0},{id:52,width:33,height:40,xoffset:0,yoffset:-30.093000000000004,xadvance:24.360000000000003,chnl:15,x:323,y:247,page:0},{id:103,width:31,height:39,xoffset:0,yoffset:-21.630000000000003,xadvance:21.84,chnl:15,x:358,y:247,page:0},{id:112,width:32,height:39,xoffset:0,yoffset:-21.651,xadvance:23.541,chnl:15,x:391,y:247,page:0},{id:113,width:31,height:39,xoffset:0,yoffset:-21.651,xadvance:23.520000000000003,chnl:15,x:425,y:247,page:0},{id:116,width:25,height:39,xoffset:0,yoffset:-28.182000000000002,xadvance:15.057,chnl:15,x:458,y:247,page:0},{id:121,width:31,height:38,xoffset:0,yoffset:-21.273,xadvance:21.651,chnl:15,x:34,y:196,page:0},{id:59,width:18,height:36,xoffset:0,yoffset:-20.706,xadvance:10.983,chnl:15,x:485,y:247,page:0},{id:43,width:32,height:34,xoffset:0,yoffset:-24.486,xadvance:24.360000000000003,chnl:15,x:67,y:196,page:0},{id:60,width:30,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:101,y:196,page:0},{id:62,width:31,height:33,xoffset:0,yoffset:-23.331000000000003,xadvance:24.360000000000003,chnl:15,x:133,y:196,page:0},{id:117,width:30,height:32,xoffset:0,yoffset:-21.273,xadvance:23.415000000000003,chnl:15,x:166,y:196,page:0},{id:99,width:29,height:32,xoffset:0,yoffset:-21.609,xadvance:20.055,chnl:15,x:198,y:196,page:0},{id:110,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:23.436,chnl:15,x:229,y:196,page:0},{id:111,width:32,height:32,xoffset:0,yoffset:-21.609,xadvance:23.814,chnl:15,x:262,y:196,page:0},{id:126,width:32,height:26,xoffset:0,yoffset:-16.128,xadvance:24.360000000000003,chnl:15,x:201,y:447,page:0},{id:101,width:31,height:32,xoffset:0,yoffset:-21.609,xadvance:22.176000000000002,chnl:15,x:296,y:196,page:0},{id:114,width:25,height:32,xoffset:0,yoffset:-21.651,xadvance:15.288,chnl:15,x:329,y:196,page:0},{id:115,width:27,height:32,xoffset:0,yoffset:-21.609,xadvance:18.186,chnl:15,x:356,y:196,page:0},{id:97,width:28,height:32,xoffset:0,yoffset:-21.651,xadvance:20.874000000000002,chnl:15,x:385,y:196,page:0},{id:118,width:31,height:31,xoffset:0,yoffset:-21.273,xadvance:21.672,chnl:15,x:415,y:196,page:0},{id:61,width:31,height:29,xoffset:0,yoffset:-19.089000000000002,xadvance:24.360000000000003,chnl:15,x:448,y:196,page:0},{id:120,width:30,height:31,xoffset:0,yoffset:-21.273,xadvance:20.916,chnl:15,x:21,y:145,page:0},{id:58,width:18,height:31,xoffset:0,yoffset:-20.706,xadvance:10.5,chnl:15,x:53,y:145,page:0},{id:122,width:28,height:31,xoffset:0,yoffset:-21.273,xadvance:18.984,chnl:15,x:73,y:145,page:0},{id:95,width:28,height:16,xoffset:0,yoffset:0,xadvance:19.278000000000002,chnl:15,x:235,y:447,page:0},{id:45,width:23,height:24,xoffset:0,yoffset:-14.175,xadvance:15.603000000000002,chnl:15,x:481,y:196,page:0},{id:44,width:17,height:21,xoffset:0,yoffset:-4.956,xadvance:9.534,chnl:15,x:103,y:145,page:0},{id:46,width:18,height:15,xoffset:0,yoffset:-4.956,xadvance:9.912,chnl:15,x:0,y:497,page:0},{id:32,width:0,height:0,xoffset:0,yoffset:0,xadvance:10.752,chnl:15,x:20,y:497,page:0}],K_e={face:"Lato Regular",size:42,bold:0,italic:0,charset:[" ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"],unicode:1,stretchH:100,smooth:1,aa:1,padding:[0,0,0,0],spacing:[2,2]},Z_e={lineHeight:50.400000000000006,base:41.454,scaleW:512,scaleH:512,pages:1,packed:0,alphaChnl:0,redChnl:0,greenChnl:0,blueChnl:0},Y_e=[],IK={pages:q_e,chars:G_e,info:K_e,common:Z_e,kernings:Y_e};class X_e extends Tn{get behavior(){return fd}constructor(e){super();const t=$N(IK),i=Ii(e.field),r=e.as,s=e.fontSize;this.handle=o=>{const a=i(o);a!==void 0?o[r]=t.measureWidth(a,s):o[r]=0,this._propagate(o)}}}const Q_e=65536;class J_e extends Tn{get behavior(){return fd}constructor(e){super(),this.params=e}reset(){super.reset(),this.initialize()}initialize(){const e=this.params,t=e.as||"lane",i=Os(e.spacing)?e.spacing:1,r=Ii(e.start),s=Ii(e.end);if(!e.preference!=!e.preferredOrder)throw new Error('Must specify both "preference" and "preferredOrder"');if(e.preference){const o=new Float64Array(Q_e),a=Ii(e.preference),l=e.preferredOrder;let c=1/0;this.handle=h=>{const u=r(h);u<c&&o.fill(-1/0),c=u;const d=l.indexOf(a(h));let f=-1;if(d>=0&&o[d]<u)f=d;else{const g=r(h);for(f=0;f<o.length&&!(o[f]<g);f++);if(f>=o.length)throw new Error("Out of lanes!")}o[f]=s(h)+i,h[t]=f,this._propagate(h)}}else{const o=new Hx,a=new Hx;let l=-1/0,c=0;this.handle=h=>{const u=r(h);for(;o.length&&(o.peekValue()<=u||u<l);){const f=o.pop();a.push(f,f)}l=u;let d=a.pop();d===void 0&&(d=c++),h[t]=d,this._propagate(h),o.push(d,s(h)+i)}}}}class e0e extends Tn{get behavior(){return fc}constructor(e){if(super(),e.as&&e.as.length!=e.fields.length)throw new Error('"fields" and "as" have unequal lengths!');const t=e.fields.map(r=>Ii(r)),i=e.as?e.as:t.map(voe);this.handle=r=>{const s={};for(let o=0;o<t.length;o++)s[i[o]]=t[o](r);this._propagate(s)}}}class t0e extends Tn{get behavior(){return fd}constructor(e){super();const t=new RegExp(e.regex),i=typeof e.as=="string"?[e.as]:e.as,r=Ii(e.field);this.handle=s=>{const o=r(s);if(un(o)){const a=o.match(t);if(a){if(a.length-1!=i.length)throw new Error('The number of RegEx groups and the length of "as" do not match!');for(let l=0;l<i.length;l++)s[i[l]]=a[l+1]}else if(e.skipInvalidInput)for(let l=0;l<i.length;l++)s[i[l]]=void 0;else throw new Error(`"${o}" does not match the given regex: ${t.toString()}`)}else if(!e.skipInvalidInput)throw new Error(`Trying to match a non-string field. Encountered type: ${typeof o}, field content: "${o}".`);this._propagate(s)}}}class i0e extends Tn{get behavior(){return fc}constructor(e){super();const t=Fs(e.columnRegex).map(d=>new RegExp(d)),i=Fs(e.asValue);if(t.length!=i.length)throw new Error('Lengths of "columnRegex" and "as" are not equal!');const r=e.skipRegex?new RegExp(e.skipRegex):void 0,s=e.asKey||"sample";let o,a,l;const c=d=>{var m;const f=Object.keys(d),g=new Map;for(const[b,_]of t.entries())for(const w of f){const y=(m=_.exec(w))==null?void 0:m[1];if(y!==void 0){let S=g.get(y);S||(S=[],g.set(y,S)),S[b]=w}}o=[...g.entries()],a=f.filter(b=>!t.some(_=>_.test(b))&&!(r&&r.test(b)));const p=[...a.map(b=>JSON.stringify(b)+": datum["+JSON.stringify(b)+"]"),JSON.stringify(s)+": sampleId",...i.map(b=>JSON.stringify(b)+": null")];l=new Function("datum","sampleId",`return {
`+p.join(`,
`)+`
};`)},h=d=>{o||c(d);for(const[f,g]of o){const p=l(d,f);for(let m=0;m<g.length;m++)p[i[m]]=d[g[m]];this._propagate(p)}},u=d=>{c(d),h(d),this.handle=h};this.handle=u,this.beginBatch=d=>{sK(d)&&(this.handle=u),super.beginBatch(d)}}}class n0e extends Tn{get behavior(){return fd}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const e=this.params,t=e.as||["y0","y1"],i=e.sort?oj(e.sort.field,e.sort.order):void 0,r=e.field?Ii(e.field):()=>1,s=e.groupby.map(h=>Ii(h)),o=cae(this.buffer,h=>s.map(u=>u(h)).join()).map(h=>h[1]);let a=h=>!0;if(e.baseField){const h=Ii(e.baseField);a=u=>h(u)!==null}let l,c;switch(e.offset){case"normalize":l=(h,u)=>h/u,c=(h,u)=>Vy(h,u);break;case"center":l=(h,u)=>h-u/2,c=(h,u)=>Vy(h,u);break;case"information":{const h=Math.log2(e.cardinality??4);l=(u,d)=>u/d,c=(u,d)=>{const g=Vy(u,_=>+!a(_)),p=Vy(u,d),m=p-g;let b=0;for(let _=0;_<u.length;_++){const w=u[_];if(a(w)){const y=d(w)/m;b-=y*Math.log2(y)}}return m/(h-(b+0))*(m/p)}}break;default:l=(h,u)=>h,c=(h,u)=>1}for(const h of o){i&&h.sort(i);const u=c(h,r);let d=0;for(const f of h){const g=d+r(f);a(f)&&(f[t[0]]=l(d,u),f[t[1]]=l(g,u),this._propagate(f),d=g)}}super.complete()}}class r0e extends Tn{get behavior(){return fc}constructor(e){super();const t=Ii(e.field??"sequence"),[i,r]=e.as??["pos","sequence"];this.handle=s=>{const o=Object.assign({},s,{[r]:"",[i]:0}),a=t(s);for(let l=0;l<a.length;l++){const c=Object.assign({},o);c[i]=l,c[r]=a.charAt(l),this._propagate(c)}}}}class s0e extends Tn{get behavior(){return fc}constructor(e){super(),this.params=e,this.buffer=[]}reset(){this.buffer=[]}handle(e){this.buffer.push(e)}complete(){const t=this.params.groupby,i=t.map(s=>Ii(s)),r=nk(this.buffer,...i);for(const[s,o]of M4(r)){const a={count:o.length};for(let l=0;l<t.length;l++)a[t[l]]=s[l];this._propagate(a)}super.complete()}}const o0e="_uniqueId",n7=1e4,r7=[null];class TK extends Tn{get behavior(){return fd}constructor(e){super(),this.params=e,this.as=e.as??o0e,this._blocks=[],this._usedBlocks=0,this._id=-1}initialize(){}reset(){super.reset(),this._usedBlocks=0,this._id=-1}handle(e){e[this.as]=this._nextId(),this._propagate(e)}_nextId(){return++this._id%n7==0&&(this._id=this._getBlock()*n7),this._id}_getBlock(){return this._usedBlocks<this._blocks.length?this._blocks[this._usedBlocks++]:this._reserveBlock()}_reserveBlock(){const e=r7.length;return r7[e]=this,this._blocks.push(e),this._usedBlocks++,e}}const a0e={aggregate:s0e,collect:kK,coverage:M_e,filterScoredLabels:P_e,filter:B_e,flatten:V_e,flattenCompressedExons:z_e,flattenDelimited:H_e,flattenSequence:r0e,formula:j_e,identifier:TK,linearizeGenomicCoordinate:LK,measureText:X_e,pileup:J_e,project:e0e,regexExtract:t0e,regexFold:i0e,sample:oK,stack:n0e};function l0e(n,e){const t=a0e[n.type];if(t)return new t(n,e);throw new Error("Unknown transform: "+n.type)}function AK(n){if(!RK(n)&&!s7(n))return;const e={...n.format};if(e.type??(e.type=s7(n)&&c0e(n.url)),e.parse??(e.parse="auto"),!e.type)throw new Error("Format for the data source was not defined and it could not be inferred: "+JSON.stringify(n));return e}function c0e(n){var e;if(Array.isArray(n)&&(n=n[0]),n)return(e=n.match(/\.(csv|tsv|json)/))==null?void 0:e[1]}const NK=n=>typeof n!="object"?h0e:u0e,h0e=n=>({data:n}),u0e=n=>n;function s7(n){return"url"in n}let Z1=class extends Tn{get identifier(){}handle(e){throw new Error("Source does not handle incoming data!")}async load(){}};function RK(n){return"values"in n}class d0e extends Z1{constructor(e,t){var i;if(super(),this.params=e,typeof e.values=="string"&&!((i=e==null?void 0:e.format)!=null&&i.type))throw new Error("Data format type (csv, dsv, ...) must be specified if a string is provided!")}loadSynchronously(){const e=this.params.values;let t=[],i=r=>r;if(Array.isArray(e))e.length>0&&(t=e,i=NK(e[0]));else if(typeof e=="object")t=[e];else if(typeof e=="string")t=WP(e,AK(this.params));else throw new Error('"values" in data configuration is not an array, object, or a string!');this.reset(),this.beginBatch({type:"file"});for(const r of t)this._propagate(i(r));this.complete()}async load(){this.loadSynchronously()}}function f0e(n){return"url"in n}class g0e extends Z1{constructor(e,t){super(),this.params=e,this.baseUrl=t==null?void 0:t.getBaseUrl()}get identifier(){return JSON.stringify({params:this.params,baseUrl:this.baseUrl})}async load(){const e=this.params.url,t=Array.isArray(e)?e:[e],i=async s=>ok({baseURL:this.baseUrl}).load(s).catch(o=>{throw new Error(`Cannot fetch: ${this.baseUrl}${s}: ${o.message}`)}),r=(s,o)=>{try{const a=WP(s,AK(this.params));this.beginBatch({type:"file",url:o});for(const l of a)this._propagate(l)}catch(a){throw new Error(`Cannot parse: ${o}: ${a.message}`)}};this.reset(),await Promise.all(t.map(s=>i(s).then(r))),this.complete()}}function p0e(n){return"sequence"in n}class m0e extends Z1{constructor(e,t){if(super(),this.sequence=e.sequence,!("start"in this.sequence))throw new Error("'start' is missing from sequence parameters!");if(!("stop"in this.sequence))throw new Error("'stop' is missing from sequence parameters!")}loadSynchronously(){const e=this.sequence.as||"data",t=this.sequence.step||1,i=this.sequence.stop;this.reset(),this.beginBatch({type:"file"});for(let r=this.sequence.start;r<i;r+=t)this._propagate({[e]:r});this.complete()}async load(){this.loadSynchronously()}}function _0e(n,e,t){return t=(t-n)/(e-n),t=Math.max(0,Math.min(1,t)),t*t*(3-2*t)}class Ig extends Z1{constructor(e,t){if(super(),this.view=e,t){if(t!=="x"&&t!=="y")throw new Error(`Invalid channel specified for the dynamic data source: ${t}. Must be either "x" or "y"`)}else throw new Error('No channel has been specified for the dynamic data source. Must be either "x" or "y".');if(this.channel=t,this.scaleResolution=this.view.getScaleResolution(t),!this.scaleResolution){const r=[`The dynamic data source cannot find a resolved scale for channel "${t}".`];throw this.view instanceof os||r.push('Make sure the view has a "shared" scale resolution as it is not a unit view.'),new Error(r.join(" "))}const i=()=>{this.view.isVisible()&&this.onDomainChanged(this.scaleResolution.getDomain(),this.scaleResolution.getComplexDomain())};this.scaleResolution.addEventListener("domain",i),this.view.context.addBroadcastListener("layoutComputed",i)}getAxisLength(){const e=this.scaleResolution.members.map(t=>{var i;return(i=t.view.coords)==null?void 0:i[this.channel==="x"?"width":"height"]}).filter(t=>t>0);return e.length?e.reduce((t,i)=>Math.min(t,i),1e4):0}get genome(){return this.scaleResolution.getGenome()}async onDomainChanged(e,t){}requestRender(){this.view.context.animator.requestRender()}async load(){this.reset(),this.complete()}publishData(e){this.reset(),this.beginBatch({type:"file"});for(const t of e)this._propagate(t);this.complete(),YN(this.view),this.requestRender()}}class b0e extends Ig{constructor(t,i){const r={axis:{},...t};super(i,r.channel);dr(this,"ticks",[]);this.params=t}async onDomainChanged(){const t=this.scaleResolution.getScale(),i=this.params.axis,r=this.getAxisLength(),s=c=>25+60*_0e(100,700,c),o=Os(i.tickCount)?i.tickCount:Math.round(r/s(r)),a=dK(t,o,i.tickMinStep),l=i.values?fK(t,i.values,a):Zme(t,a);if(!Tx(l,this.ticks)){this.ticks=l;const c=Xme(t,o,i.format);this.publishData(l.map(h=>({value:h,label:c(h)})))}}}class v0e extends Ig{constructor(e,t){super(t,e.channel)}async load(){this.publishData(this.genome.chromosomes)}}var Ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function w0e(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){if(this instanceof i){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var vr={},Mk={};Mk.byteLength=S0e;Mk.toByteArray=E0e;Mk.fromByteArray=L0e;var Tl=[],ko=[],y0e=typeof Uint8Array<"u"?Uint8Array:Array,G2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var dp=0,C0e=G2.length;dp<C0e;++dp)Tl[dp]=G2[dp],ko[G2.charCodeAt(dp)]=dp;ko["-".charCodeAt(0)]=62;ko["_".charCodeAt(0)]=63;function MK(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function S0e(n){var e=MK(n),t=e[0],i=e[1];return(t+i)*3/4-i}function x0e(n,e,t){return(e+t)*3/4-t}function E0e(n){var e,t=MK(n),i=t[0],r=t[1],s=new y0e(x0e(n,i,r)),o=0,a=r>0?i-4:i,l;for(l=0;l<a;l+=4)e=ko[n.charCodeAt(l)]<<18|ko[n.charCodeAt(l+1)]<<12|ko[n.charCodeAt(l+2)]<<6|ko[n.charCodeAt(l+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return r===2&&(e=ko[n.charCodeAt(l)]<<2|ko[n.charCodeAt(l+1)]>>4,s[o++]=e&255),r===1&&(e=ko[n.charCodeAt(l)]<<10|ko[n.charCodeAt(l+1)]<<4|ko[n.charCodeAt(l+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function D0e(n){return Tl[n>>18&63]+Tl[n>>12&63]+Tl[n>>6&63]+Tl[n&63]}function k0e(n,e,t){for(var i,r=[],s=e;s<t;s+=3)i=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),r.push(D0e(i));return r.join("")}function L0e(n){for(var e,t=n.length,i=t%3,r=[],s=16383,o=0,a=t-i;o<a;o+=s)r.push(k0e(n,o,o+s>a?a:o+s));return i===1?(e=n[t-1],r.push(Tl[e>>2]+Tl[e<<4&63]+"==")):i===2&&(e=(n[t-2]<<8)+n[t-1],r.push(Tl[e>>10]+Tl[e>>4&63]+Tl[e<<2&63]+"=")),r.join("")}var F4={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */F4.read=function(n,e,t,i,r){var s,o,a=r*8-i-1,l=(1<<a)-1,c=l>>1,h=-7,u=t?r-1:0,d=t?-1:1,f=n[e+u];for(u+=d,s=f&(1<<-h)-1,f>>=-h,h+=a;h>0;s=s*256+n[e+u],u+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=o*256+n[e+u],u+=d,h-=8);if(s===0)s=1-c;else{if(s===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-c}return(f?-1:1)*o*Math.pow(2,s-i)};F4.write=function(n,e,t,i,r,s){var o,a,l,c=s*8-r-1,h=(1<<c)-1,u=h>>1,d=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,g=i?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+u>=1?e+=d/l:e+=d*Math.pow(2,1-u),e*l>=2&&(o++,l/=2),o+u>=h?(a=0,o=h):o+u>=1?(a=(e*l-1)*Math.pow(2,r),o=o+u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;n[t+f]=a&255,f+=g,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;n[t+f]=o&255,f+=g,o/=256,c-=8);n[t+f-g]|=p*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=Mk,t=F4,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=_,n.INSPECT_MAX_BYTES=50;const r=2147483647;n.kMaxLength=r,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const R=new Uint8Array(1),x={foo:function(){return 42}};return Object.setPrototypeOf(x,Uint8Array.prototype),Object.setPrototypeOf(R,x),R.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(R){if(R>r)throw new RangeError('The value "'+R+'" is invalid for option "size"');const x=new Uint8Array(R);return Object.setPrototypeOf(x,a.prototype),x}function a(R,x,L){if(typeof R=="number"){if(typeof x=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return u(R)}return l(R,x,L)}a.poolSize=8192;function l(R,x,L){if(typeof R=="string")return d(R,x);if(ArrayBuffer.isView(R))return g(R);if(R==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof R);if(Wi(R,ArrayBuffer)||R&&Wi(R.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Wi(R,SharedArrayBuffer)||R&&Wi(R.buffer,SharedArrayBuffer)))return p(R,x,L);if(typeof R=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const $=R.valueOf&&R.valueOf();if($!=null&&$!==R)return a.from($,x,L);const K=m(R);if(K)return K;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof R[Symbol.toPrimitive]=="function")return a.from(R[Symbol.toPrimitive]("string"),x,L);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof R)}a.from=function(R,x,L){return l(R,x,L)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(R){if(typeof R!="number")throw new TypeError('"size" argument must be of type number');if(R<0)throw new RangeError('The value "'+R+'" is invalid for option "size"')}function h(R,x,L){return c(R),R<=0?o(R):x!==void 0?typeof L=="string"?o(R).fill(x,L):o(R).fill(x):o(R)}a.alloc=function(R,x,L){return h(R,x,L)};function u(R){return c(R),o(R<0?0:b(R)|0)}a.allocUnsafe=function(R){return u(R)},a.allocUnsafeSlow=function(R){return u(R)};function d(R,x){if((typeof x!="string"||x==="")&&(x="utf8"),!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);const L=w(R,x)|0;let $=o(L);const K=$.write(R,x);return K!==L&&($=$.slice(0,K)),$}function f(R){const x=R.length<0?0:b(R.length)|0,L=o(x);for(let $=0;$<x;$+=1)L[$]=R[$]&255;return L}function g(R){if(Wi(R,Uint8Array)){const x=new Uint8Array(R);return p(x.buffer,x.byteOffset,x.byteLength)}return f(R)}function p(R,x,L){if(x<0||R.byteLength<x)throw new RangeError('"offset" is outside of buffer bounds');if(R.byteLength<x+(L||0))throw new RangeError('"length" is outside of buffer bounds');let $;return x===void 0&&L===void 0?$=new Uint8Array(R):L===void 0?$=new Uint8Array(R,x):$=new Uint8Array(R,x,L),Object.setPrototypeOf($,a.prototype),$}function m(R){if(a.isBuffer(R)){const x=b(R.length)|0,L=o(x);return L.length===0||R.copy(L,0,0,x),L}if(R.length!==void 0)return typeof R.length!="number"||Vn(R.length)?o(0):f(R);if(R.type==="Buffer"&&Array.isArray(R.data))return f(R.data)}function b(R){if(R>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return R|0}function _(R){return+R!=R&&(R=0),a.alloc(+R)}a.isBuffer=function(x){return x!=null&&x._isBuffer===!0&&x!==a.prototype},a.compare=function(x,L){if(Wi(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),Wi(L,Uint8Array)&&(L=a.from(L,L.offset,L.byteLength)),!a.isBuffer(x)||!a.isBuffer(L))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===L)return 0;let $=x.length,K=L.length;for(let ne=0,fe=Math.min($,K);ne<fe;++ne)if(x[ne]!==L[ne]){$=x[ne],K=L[ne];break}return $<K?-1:K<$?1:0},a.isEncoding=function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(x,L){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return a.alloc(0);let $;if(L===void 0)for(L=0,$=0;$<x.length;++$)L+=x[$].length;const K=a.allocUnsafe(L);let ne=0;for($=0;$<x.length;++$){let fe=x[$];if(Wi(fe,Uint8Array))ne+fe.length>K.length?(a.isBuffer(fe)||(fe=a.from(fe)),fe.copy(K,ne)):Uint8Array.prototype.set.call(K,fe,ne);else if(a.isBuffer(fe))fe.copy(K,ne);else throw new TypeError('"list" argument must be an Array of Buffers');ne+=fe.length}return K};function w(R,x){if(a.isBuffer(R))return R.length;if(ArrayBuffer.isView(R)||Wi(R,ArrayBuffer))return R.byteLength;if(typeof R!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof R);const L=R.length,$=arguments.length>2&&arguments[2]===!0;if(!$&&L===0)return 0;let K=!1;for(;;)switch(x){case"ascii":case"latin1":case"binary":return L;case"utf8":case"utf-8":return lt(R).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L*2;case"hex":return L>>>1;case"base64":return Qr(R).length;default:if(K)return $?-1:lt(R).length;x=(""+x).toLowerCase(),K=!0}}a.byteLength=w;function y(R,x,L){let $=!1;if((x===void 0||x<0)&&(x=0),x>this.length||((L===void 0||L>this.length)&&(L=this.length),L<=0)||(L>>>=0,x>>>=0,L<=x))return"";for(R||(R="utf8");;)switch(R){case"hex":return ke(this,x,L);case"utf8":case"utf-8":return ie(this,x,L);case"ascii":return Se(this,x,L);case"latin1":case"binary":return Le(this,x,L);case"base64":return q(this,x,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lt(this,x,L);default:if($)throw new TypeError("Unknown encoding: "+R);R=(R+"").toLowerCase(),$=!0}}a.prototype._isBuffer=!0;function S(R,x,L){const $=R[x];R[x]=R[L],R[L]=$}a.prototype.swap16=function(){const x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let L=0;L<x;L+=2)S(this,L,L+1);return this},a.prototype.swap32=function(){const x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let L=0;L<x;L+=4)S(this,L,L+3),S(this,L+1,L+2);return this},a.prototype.swap64=function(){const x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let L=0;L<x;L+=8)S(this,L,L+7),S(this,L+1,L+6),S(this,L+2,L+5),S(this,L+3,L+4);return this},a.prototype.toString=function(){const x=this.length;return x===0?"":arguments.length===0?ie(this,0,x):y.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(x){if(!a.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:a.compare(this,x)===0},a.prototype.inspect=function(){let x="";const L=n.INSPECT_MAX_BYTES;return x=this.toString("hex",0,L).replace(/(.{2})/g,"$1 ").trim(),this.length>L&&(x+=" ... "),"<Buffer "+x+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(x,L,$,K,ne){if(Wi(x,Uint8Array)&&(x=a.from(x,x.offset,x.byteLength)),!a.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if(L===void 0&&(L=0),$===void 0&&($=x?x.length:0),K===void 0&&(K=0),ne===void 0&&(ne=this.length),L<0||$>x.length||K<0||ne>this.length)throw new RangeError("out of range index");if(K>=ne&&L>=$)return 0;if(K>=ne)return-1;if(L>=$)return 1;if(L>>>=0,$>>>=0,K>>>=0,ne>>>=0,this===x)return 0;let fe=ne-K,tt=$-L;const Zt=Math.min(fe,tt),Ht=this.slice(K,ne),ci=x.slice(L,$);for(let Bt=0;Bt<Zt;++Bt)if(Ht[Bt]!==ci[Bt]){fe=Ht[Bt],tt=ci[Bt];break}return fe<tt?-1:tt<fe?1:0};function k(R,x,L,$,K){if(R.length===0)return-1;if(typeof L=="string"?($=L,L=0):L>2147483647?L=2147483647:L<-2147483648&&(L=-2147483648),L=+L,Vn(L)&&(L=K?0:R.length-1),L<0&&(L=R.length+L),L>=R.length){if(K)return-1;L=R.length-1}else if(L<0)if(K)L=0;else return-1;if(typeof x=="string"&&(x=a.from(x,$)),a.isBuffer(x))return x.length===0?-1:C(R,x,L,$,K);if(typeof x=="number")return x=x&255,typeof Uint8Array.prototype.indexOf=="function"?K?Uint8Array.prototype.indexOf.call(R,x,L):Uint8Array.prototype.lastIndexOf.call(R,x,L):C(R,[x],L,$,K);throw new TypeError("val must be string, number or Buffer")}function C(R,x,L,$,K){let ne=1,fe=R.length,tt=x.length;if($!==void 0&&($=String($).toLowerCase(),$==="ucs2"||$==="ucs-2"||$==="utf16le"||$==="utf-16le")){if(R.length<2||x.length<2)return-1;ne=2,fe/=2,tt/=2,L/=2}function Zt(ci,Bt){return ne===1?ci[Bt]:ci.readUInt16BE(Bt*ne)}let Ht;if(K){let ci=-1;for(Ht=L;Ht<fe;Ht++)if(Zt(R,Ht)===Zt(x,ci===-1?0:Ht-ci)){if(ci===-1&&(ci=Ht),Ht-ci+1===tt)return ci*ne}else ci!==-1&&(Ht-=Ht-ci),ci=-1}else for(L+tt>fe&&(L=fe-tt),Ht=L;Ht>=0;Ht--){let ci=!0;for(let Bt=0;Bt<tt;Bt++)if(Zt(R,Ht+Bt)!==Zt(x,Bt)){ci=!1;break}if(ci)return Ht}return-1}a.prototype.includes=function(x,L,$){return this.indexOf(x,L,$)!==-1},a.prototype.indexOf=function(x,L,$){return k(this,x,L,$,!0)},a.prototype.lastIndexOf=function(x,L,$){return k(this,x,L,$,!1)};function D(R,x,L,$){L=Number(L)||0;const K=R.length-L;$?($=Number($),$>K&&($=K)):$=K;const ne=x.length;$>ne/2&&($=ne/2);let fe;for(fe=0;fe<$;++fe){const tt=parseInt(x.substr(fe*2,2),16);if(Vn(tt))return fe;R[L+fe]=tt}return fe}function E(R,x,L,$){return kr(lt(x,R.length-L),R,L,$)}function N(R,x,L,$){return kr(fn(x),R,L,$)}function T(R,x,L,$){return kr(Qr(x),R,L,$)}function j(R,x,L,$){return kr(Us(x,R.length-L),R,L,$)}a.prototype.write=function(x,L,$,K){if(L===void 0)K="utf8",$=this.length,L=0;else if($===void 0&&typeof L=="string")K=L,$=this.length,L=0;else if(isFinite(L))L=L>>>0,isFinite($)?($=$>>>0,K===void 0&&(K="utf8")):(K=$,$=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ne=this.length-L;if(($===void 0||$>ne)&&($=ne),x.length>0&&($<0||L<0)||L>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");let fe=!1;for(;;)switch(K){case"hex":return D(this,x,L,$);case"utf8":case"utf-8":return E(this,x,L,$);case"ascii":case"latin1":case"binary":return N(this,x,L,$);case"base64":return T(this,x,L,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,x,L,$);default:if(fe)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase(),fe=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(R,x,L){return x===0&&L===R.length?e.fromByteArray(R):e.fromByteArray(R.slice(x,L))}function ie(R,x,L){L=Math.min(R.length,L);const $=[];let K=x;for(;K<L;){const ne=R[K];let fe=null,tt=ne>239?4:ne>223?3:ne>191?2:1;if(K+tt<=L){let Zt,Ht,ci,Bt;switch(tt){case 1:ne<128&&(fe=ne);break;case 2:Zt=R[K+1],(Zt&192)===128&&(Bt=(ne&31)<<6|Zt&63,Bt>127&&(fe=Bt));break;case 3:Zt=R[K+1],Ht=R[K+2],(Zt&192)===128&&(Ht&192)===128&&(Bt=(ne&15)<<12|(Zt&63)<<6|Ht&63,Bt>2047&&(Bt<55296||Bt>57343)&&(fe=Bt));break;case 4:Zt=R[K+1],Ht=R[K+2],ci=R[K+3],(Zt&192)===128&&(Ht&192)===128&&(ci&192)===128&&(Bt=(ne&15)<<18|(Zt&63)<<12|(Ht&63)<<6|ci&63,Bt>65535&&Bt<1114112&&(fe=Bt))}}fe===null?(fe=65533,tt=1):fe>65535&&(fe-=65536,$.push(fe>>>10&1023|55296),fe=56320|fe&1023),$.push(fe),K+=tt}return be($)}const ge=4096;function be(R){const x=R.length;if(x<=ge)return String.fromCharCode.apply(String,R);let L="",$=0;for(;$<x;)L+=String.fromCharCode.apply(String,R.slice($,$+=ge));return L}function Se(R,x,L){let $="";L=Math.min(R.length,L);for(let K=x;K<L;++K)$+=String.fromCharCode(R[K]&127);return $}function Le(R,x,L){let $="";L=Math.min(R.length,L);for(let K=x;K<L;++K)$+=String.fromCharCode(R[K]);return $}function ke(R,x,L){const $=R.length;(!x||x<0)&&(x=0),(!L||L<0||L>$)&&(L=$);let K="";for(let ne=x;ne<L;++ne)K+=Lr[R[ne]];return K}function Lt(R,x,L){const $=R.slice(x,L);let K="";for(let ne=0;ne<$.length-1;ne+=2)K+=String.fromCharCode($[ne]+$[ne+1]*256);return K}a.prototype.slice=function(x,L){const $=this.length;x=~~x,L=L===void 0?$:~~L,x<0?(x+=$,x<0&&(x=0)):x>$&&(x=$),L<0?(L+=$,L<0&&(L=0)):L>$&&(L=$),L<x&&(L=x);const K=this.subarray(x,L);return Object.setPrototypeOf(K,a.prototype),K};function Ge(R,x,L){if(R%1!==0||R<0)throw new RangeError("offset is not uint");if(R+x>L)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(x,L,$){x=x>>>0,L=L>>>0,$||Ge(x,L,this.length);let K=this[x],ne=1,fe=0;for(;++fe<L&&(ne*=256);)K+=this[x+fe]*ne;return K},a.prototype.readUintBE=a.prototype.readUIntBE=function(x,L,$){x=x>>>0,L=L>>>0,$||Ge(x,L,this.length);let K=this[x+--L],ne=1;for(;L>0&&(ne*=256);)K+=this[x+--L]*ne;return K},a.prototype.readUint8=a.prototype.readUInt8=function(x,L){return x=x>>>0,L||Ge(x,1,this.length),this[x]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(x,L){return x=x>>>0,L||Ge(x,2,this.length),this[x]|this[x+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(x,L){return x=x>>>0,L||Ge(x,2,this.length),this[x]<<8|this[x+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},a.prototype.readBigUInt64LE=Nn(function(x){x=x>>>0,ue(x,"offset");const L=this[x],$=this[x+7];(L===void 0||$===void 0)&&_e(x,this.length-8);const K=L+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,ne=this[++x]+this[++x]*2**8+this[++x]*2**16+$*2**24;return BigInt(K)+(BigInt(ne)<<BigInt(32))}),a.prototype.readBigUInt64BE=Nn(function(x){x=x>>>0,ue(x,"offset");const L=this[x],$=this[x+7];(L===void 0||$===void 0)&&_e(x,this.length-8);const K=L*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],ne=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+$;return(BigInt(K)<<BigInt(32))+BigInt(ne)}),a.prototype.readIntLE=function(x,L,$){x=x>>>0,L=L>>>0,$||Ge(x,L,this.length);let K=this[x],ne=1,fe=0;for(;++fe<L&&(ne*=256);)K+=this[x+fe]*ne;return ne*=128,K>=ne&&(K-=Math.pow(2,8*L)),K},a.prototype.readIntBE=function(x,L,$){x=x>>>0,L=L>>>0,$||Ge(x,L,this.length);let K=L,ne=1,fe=this[x+--K];for(;K>0&&(ne*=256);)fe+=this[x+--K]*ne;return ne*=128,fe>=ne&&(fe-=Math.pow(2,8*L)),fe},a.prototype.readInt8=function(x,L){return x=x>>>0,L||Ge(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},a.prototype.readInt16LE=function(x,L){x=x>>>0,L||Ge(x,2,this.length);const $=this[x]|this[x+1]<<8;return $&32768?$|4294901760:$},a.prototype.readInt16BE=function(x,L){x=x>>>0,L||Ge(x,2,this.length);const $=this[x+1]|this[x]<<8;return $&32768?$|4294901760:$},a.prototype.readInt32LE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},a.prototype.readInt32BE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},a.prototype.readBigInt64LE=Nn(function(x){x=x>>>0,ue(x,"offset");const L=this[x],$=this[x+7];(L===void 0||$===void 0)&&_e(x,this.length-8);const K=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+($<<24);return(BigInt(K)<<BigInt(32))+BigInt(L+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)}),a.prototype.readBigInt64BE=Nn(function(x){x=x>>>0,ue(x,"offset");const L=this[x],$=this[x+7];(L===void 0||$===void 0)&&_e(x,this.length-8);const K=(L<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(K)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+$)}),a.prototype.readFloatLE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),t.read(this,x,!0,23,4)},a.prototype.readFloatBE=function(x,L){return x=x>>>0,L||Ge(x,4,this.length),t.read(this,x,!1,23,4)},a.prototype.readDoubleLE=function(x,L){return x=x>>>0,L||Ge(x,8,this.length),t.read(this,x,!0,52,8)},a.prototype.readDoubleBE=function(x,L){return x=x>>>0,L||Ge(x,8,this.length),t.read(this,x,!1,52,8)};function Je(R,x,L,$,K,ne){if(!a.isBuffer(R))throw new TypeError('"buffer" argument must be a Buffer instance');if(x>K||x<ne)throw new RangeError('"value" argument is out of bounds');if(L+$>R.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(x,L,$,K){if(x=+x,L=L>>>0,$=$>>>0,!K){const tt=Math.pow(2,8*$)-1;Je(this,x,L,$,tt,0)}let ne=1,fe=0;for(this[L]=x&255;++fe<$&&(ne*=256);)this[L+fe]=x/ne&255;return L+$},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(x,L,$,K){if(x=+x,L=L>>>0,$=$>>>0,!K){const tt=Math.pow(2,8*$)-1;Je(this,x,L,$,tt,0)}let ne=$-1,fe=1;for(this[L+ne]=x&255;--ne>=0&&(fe*=256);)this[L+ne]=x/fe&255;return L+$},a.prototype.writeUint8=a.prototype.writeUInt8=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,1,255,0),this[L]=x&255,L+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,2,65535,0),this[L]=x&255,this[L+1]=x>>>8,L+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,2,65535,0),this[L]=x>>>8,this[L+1]=x&255,L+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,4,4294967295,0),this[L+3]=x>>>24,this[L+2]=x>>>16,this[L+1]=x>>>8,this[L]=x&255,L+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,4,4294967295,0),this[L]=x>>>24,this[L+1]=x>>>16,this[L+2]=x>>>8,this[L+3]=x&255,L+4};function Ct(R,x,L,$,K){I(x,$,K,R,L,7);let ne=Number(x&BigInt(4294967295));R[L++]=ne,ne=ne>>8,R[L++]=ne,ne=ne>>8,R[L++]=ne,ne=ne>>8,R[L++]=ne;let fe=Number(x>>BigInt(32)&BigInt(4294967295));return R[L++]=fe,fe=fe>>8,R[L++]=fe,fe=fe>>8,R[L++]=fe,fe=fe>>8,R[L++]=fe,L}function ut(R,x,L,$,K){I(x,$,K,R,L,7);let ne=Number(x&BigInt(4294967295));R[L+7]=ne,ne=ne>>8,R[L+6]=ne,ne=ne>>8,R[L+5]=ne,ne=ne>>8,R[L+4]=ne;let fe=Number(x>>BigInt(32)&BigInt(4294967295));return R[L+3]=fe,fe=fe>>8,R[L+2]=fe,fe=fe>>8,R[L+1]=fe,fe=fe>>8,R[L]=fe,L+8}a.prototype.writeBigUInt64LE=Nn(function(x,L=0){return Ct(this,x,L,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Nn(function(x,L=0){return ut(this,x,L,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(x,L,$,K){if(x=+x,L=L>>>0,!K){const Zt=Math.pow(2,8*$-1);Je(this,x,L,$,Zt-1,-Zt)}let ne=0,fe=1,tt=0;for(this[L]=x&255;++ne<$&&(fe*=256);)x<0&&tt===0&&this[L+ne-1]!==0&&(tt=1),this[L+ne]=(x/fe>>0)-tt&255;return L+$},a.prototype.writeIntBE=function(x,L,$,K){if(x=+x,L=L>>>0,!K){const Zt=Math.pow(2,8*$-1);Je(this,x,L,$,Zt-1,-Zt)}let ne=$-1,fe=1,tt=0;for(this[L+ne]=x&255;--ne>=0&&(fe*=256);)x<0&&tt===0&&this[L+ne+1]!==0&&(tt=1),this[L+ne]=(x/fe>>0)-tt&255;return L+$},a.prototype.writeInt8=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,1,127,-128),x<0&&(x=255+x+1),this[L]=x&255,L+1},a.prototype.writeInt16LE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,2,32767,-32768),this[L]=x&255,this[L+1]=x>>>8,L+2},a.prototype.writeInt16BE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,2,32767,-32768),this[L]=x>>>8,this[L+1]=x&255,L+2},a.prototype.writeInt32LE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,4,2147483647,-2147483648),this[L]=x&255,this[L+1]=x>>>8,this[L+2]=x>>>16,this[L+3]=x>>>24,L+4},a.prototype.writeInt32BE=function(x,L,$){return x=+x,L=L>>>0,$||Je(this,x,L,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[L]=x>>>24,this[L+1]=x>>>16,this[L+2]=x>>>8,this[L+3]=x&255,L+4},a.prototype.writeBigInt64LE=Nn(function(x,L=0){return Ct(this,x,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Nn(function(x,L=0){return ut(this,x,L,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ai(R,x,L,$,K,ne){if(L+$>R.length)throw new RangeError("Index out of range");if(L<0)throw new RangeError("Index out of range")}function te(R,x,L,$,K){return x=+x,L=L>>>0,K||Ai(R,x,L,4),t.write(R,x,L,$,23,4),L+4}a.prototype.writeFloatLE=function(x,L,$){return te(this,x,L,!0,$)},a.prototype.writeFloatBE=function(x,L,$){return te(this,x,L,!1,$)};function ee(R,x,L,$,K){return x=+x,L=L>>>0,K||Ai(R,x,L,8),t.write(R,x,L,$,52,8),L+8}a.prototype.writeDoubleLE=function(x,L,$){return ee(this,x,L,!0,$)},a.prototype.writeDoubleBE=function(x,L,$){return ee(this,x,L,!1,$)},a.prototype.copy=function(x,L,$,K){if(!a.isBuffer(x))throw new TypeError("argument should be a Buffer");if($||($=0),!K&&K!==0&&(K=this.length),L>=x.length&&(L=x.length),L||(L=0),K>0&&K<$&&(K=$),K===$||x.length===0||this.length===0)return 0;if(L<0)throw new RangeError("targetStart out of bounds");if($<0||$>=this.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length),x.length-L<K-$&&(K=x.length-L+$);const ne=K-$;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(L,$,K):Uint8Array.prototype.set.call(x,this.subarray($,K),L),ne},a.prototype.fill=function(x,L,$,K){if(typeof x=="string"){if(typeof L=="string"?(K=L,L=0,$=this.length):typeof $=="string"&&(K=$,$=this.length),K!==void 0&&typeof K!="string")throw new TypeError("encoding must be a string");if(typeof K=="string"&&!a.isEncoding(K))throw new TypeError("Unknown encoding: "+K);if(x.length===1){const fe=x.charCodeAt(0);(K==="utf8"&&fe<128||K==="latin1")&&(x=fe)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if(L<0||this.length<L||this.length<$)throw new RangeError("Out of range index");if($<=L)return this;L=L>>>0,$=$===void 0?this.length:$>>>0,x||(x=0);let ne;if(typeof x=="number")for(ne=L;ne<$;++ne)this[ne]=x;else{const fe=a.isBuffer(x)?x:a.from(x,K),tt=fe.length;if(tt===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(ne=0;ne<$-L;++ne)this[ne+L]=fe[ne%tt]}return this};const pe={};function se(R,x,L){pe[R]=class extends L{constructor(){super(),Object.defineProperty(this,"message",{value:x.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${R}]`,this.stack,delete this.name}get code(){return R}set code(K){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:K,writable:!0})}toString(){return`${this.name} [${R}]: ${this.message}`}}}se("ERR_BUFFER_OUT_OF_BOUNDS",function(R){return R?`${R} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),se("ERR_INVALID_ARG_TYPE",function(R,x){return`The "${R}" argument must be of type number. Received type ${typeof x}`},TypeError),se("ERR_OUT_OF_RANGE",function(R,x,L){let $=`The value of "${R}" is out of range.`,K=L;return Number.isInteger(L)&&Math.abs(L)>2**32?K=De(String(L)):typeof L=="bigint"&&(K=String(L),(L>BigInt(2)**BigInt(32)||L<-(BigInt(2)**BigInt(32)))&&(K=De(K)),K+="n"),$+=` It must be ${x}. Received ${K}`,$},RangeError);function De(R){let x="",L=R.length;const $=R[0]==="-"?1:0;for(;L>=$+4;L-=3)x=`_${R.slice(L-3,L)}${x}`;return`${R.slice(0,L)}${x}`}function O(R,x,L){ue(x,"offset"),(R[x]===void 0||R[x+L]===void 0)&&_e(x,R.length-(L+1))}function I(R,x,L,$,K,ne){if(R>L||R<x){const fe=typeof x=="bigint"?"n":"";let tt;throw ne>3?x===0||x===BigInt(0)?tt=`>= 0${fe} and < 2${fe} ** ${(ne+1)*8}${fe}`:tt=`>= -(2${fe} ** ${(ne+1)*8-1}${fe}) and < 2 ** ${(ne+1)*8-1}${fe}`:tt=`>= ${x}${fe} and <= ${L}${fe}`,new pe.ERR_OUT_OF_RANGE("value",tt,R)}O($,K,ne)}function ue(R,x){if(typeof R!="number")throw new pe.ERR_INVALID_ARG_TYPE(x,"number",R)}function _e(R,x,L){throw Math.floor(R)!==R?(ue(R,L),new pe.ERR_OUT_OF_RANGE(L||"offset","an integer",R)):x<0?new pe.ERR_BUFFER_OUT_OF_BOUNDS:new pe.ERR_OUT_OF_RANGE(L||"offset",`>= ${L?1:0} and <= ${x}`,R)}const at=/[^+/0-9A-Za-z-_]/g;function ze(R){if(R=R.split("=")[0],R=R.trim().replace(at,""),R.length<2)return"";for(;R.length%4!==0;)R=R+"=";return R}function lt(R,x){x=x||1/0;let L;const $=R.length;let K=null;const ne=[];for(let fe=0;fe<$;++fe){if(L=R.charCodeAt(fe),L>55295&&L<57344){if(!K){if(L>56319){(x-=3)>-1&&ne.push(239,191,189);continue}else if(fe+1===$){(x-=3)>-1&&ne.push(239,191,189);continue}K=L;continue}if(L<56320){(x-=3)>-1&&ne.push(239,191,189),K=L;continue}L=(K-55296<<10|L-56320)+65536}else K&&(x-=3)>-1&&ne.push(239,191,189);if(K=null,L<128){if((x-=1)<0)break;ne.push(L)}else if(L<2048){if((x-=2)<0)break;ne.push(L>>6|192,L&63|128)}else if(L<65536){if((x-=3)<0)break;ne.push(L>>12|224,L>>6&63|128,L&63|128)}else if(L<1114112){if((x-=4)<0)break;ne.push(L>>18|240,L>>12&63|128,L>>6&63|128,L&63|128)}else throw new Error("Invalid code point")}return ne}function fn(R){const x=[];for(let L=0;L<R.length;++L)x.push(R.charCodeAt(L)&255);return x}function Us(R,x){let L,$,K;const ne=[];for(let fe=0;fe<R.length&&!((x-=2)<0);++fe)L=R.charCodeAt(fe),$=L>>8,K=L%256,ne.push(K),ne.push($);return ne}function Qr(R){return e.toByteArray(ze(R))}function kr(R,x,L,$){let K;for(K=0;K<$&&!(K+L>=x.length||K>=R.length);++K)x[K+L]=R[K];return K}function Wi(R,x){return R instanceof x||R!=null&&R.constructor!=null&&R.constructor.name!=null&&R.constructor.name===x.name}function Vn(R){return R!==R}const Lr=function(){const R="0123456789abcdef",x=new Array(256);for(let L=0;L<16;++L){const $=L*16;for(let K=0;K<16;++K)x[$+K]=R[L]+R[K]}return x}();function Nn(R){return typeof BigInt>"u"?Ir:R}function Ir(){throw new Error("BigInt not supported")}})(vr);const no={},I0e=Object.freeze(Object.defineProperty({__proto__:null,default:no},Symbol.toStringTag,{value:"Module"})),K2=typeof window<"u"?window:typeof self<"u"?self:{fetch:void 0};class Vl{async getBufferFromResponse(e){if(typeof e.buffer=="function")return e.buffer();if(typeof e.arrayBuffer=="function"){const t=await e.arrayBuffer();return vr.Buffer.from(t)}else throw new TypeError("invalid HTTP response object, has no buffer method, and no arrayBuffer method")}constructor(e,t={}){this.baseOverrides={},this.url=e;const i=t.fetch||K2.fetch&&K2.fetch.bind(K2);if(!i)throw new TypeError("no fetch function supplied, and none found in global environment");t.overrides&&(this.baseOverrides=t.overrides),this.fetchImplementation=i}async fetch(e,t){let i;try{i=await this.fetchImplementation(e,t)}catch(r){if(`${r}`.includes("Failed to fetch"))console.warn(`generic-filehandle: refetching ${e} to attempt to work around chrome CORS header caching bug`),i=await this.fetchImplementation(e,{...t,cache:"reload"});else throw r}return i}async read(e,t=0,i,r=0,s={}){const{headers:o={},signal:a,overrides:l={}}=s;i<1/0?o.range=`bytes=${r}-${r+i}`:i===1/0&&r!==0&&(o.range=`bytes=${r}-`);const c={...this.baseOverrides,...l,headers:{...o,...l.headers,...this.baseOverrides.headers},method:"GET",redirect:"follow",mode:"cors",signal:a},h=await this.fetch(this.url,c);if(!h.ok)throw new Error(`HTTP ${h.status} ${h.statusText} ${this.url}`);if(h.status===200&&r===0||h.status===206){const u=await this.getBufferFromResponse(h),d=u.copy(e,t,0,Math.min(i,u.length)),f=h.headers.get("content-range"),g=/\/(\d+)$/.exec(f||"");return g&&g[1]&&(this._stat={size:parseInt(g[1],10)}),{bytesRead:d,buffer:e}}throw h.status===200?new Error("${this.url} fetch returned status 200, expected 206"):new Error(`HTTP ${h.status} fetching ${this.url}`)}async readFile(e={}){let t,i;typeof e=="string"?(t=e,i={}):(t=e.encoding,i=e,delete i.encoding);const{headers:r={},signal:s,overrides:o={}}=i,a={headers:r,method:"GET",redirect:"follow",mode:"cors",signal:s,...this.baseOverrides,...o},l=await this.fetch(this.url,a);if(!l)throw new Error("generic-filehandle failed to fetch");if(l.status!==200)throw Object.assign(new Error(`HTTP ${l.status} fetching ${this.url}`),{status:l.status});if(t==="utf8")return l.text();if(t)throw new Error(`unsupported encoding: ${t}`);return this.getBufferFromResponse(l)}async stat(){if(!this._stat){const e=vr.Buffer.allocUnsafe(10);if(await this.read(e,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}async close(){}}var Lh={};(function(n){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function t(s,o){return Object.prototype.hasOwnProperty.call(s,o)}n.assign=function(s){for(var o=Array.prototype.slice.call(arguments,1);o.length;){var a=o.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(var l in a)t(a,l)&&(s[l]=a[l])}}return s},n.shrinkBuf=function(s,o){return s.length===o?s:s.subarray?s.subarray(0,o):(s.length=o,s)};var i={arraySet:function(s,o,a,l,c){if(o.subarray&&s.subarray){s.set(o.subarray(a,a+l),c);return}for(var h=0;h<l;h++)s[c+h]=o[a+h]},flattenChunks:function(s){var o,a,l,c,h,u;for(l=0,o=0,a=s.length;o<a;o++)l+=s[o].length;for(u=new Uint8Array(l),c=0,o=0,a=s.length;o<a;o++)h=s[o],u.set(h,c),c+=h.length;return u}},r={arraySet:function(s,o,a,l,c){for(var h=0;h<l;h++)s[c+h]=o[a+h]},flattenChunks:function(s){return[].concat.apply([],s)}};n.setTyped=function(s){s?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,r))},n.setTyped(e)})(Lh);var Y1={},gc={},n0={},T0e=Lh,A0e=4,o7=0,a7=1,N0e=2;function r0(n){for(var e=n.length;--e>=0;)n[e]=0}var R0e=0,FK=1,M0e=2,F0e=3,O0e=258,O4=29,X1=256,Xv=X1+1+O4,dm=30,P4=19,OK=2*Xv+1,ef=15,Z2=16,P0e=7,B4=256,PK=16,BK=17,VK=18,XN=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],bS=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B0e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],WK=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V0e=512,zc=new Array((Xv+2)*2);r0(zc);var Wb=new Array(dm*2);r0(Wb);var Qv=new Array(V0e);r0(Qv);var Jv=new Array(O0e-F0e+1);r0(Jv);var V4=new Array(O4);r0(V4);var Ux=new Array(dm);r0(Ux);function Y2(n,e,t,i,r){this.static_tree=n,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=r,this.has_stree=n&&n.length}var $K,zK,HK;function X2(n,e){this.dyn_tree=n,this.max_code=0,this.stat_desc=e}function UK(n){return n<256?Qv[n]:Qv[256+(n>>>7)]}function ew(n,e){n.pending_buf[n.pending++]=e&255,n.pending_buf[n.pending++]=e>>>8&255}function Ds(n,e,t){n.bi_valid>Z2-t?(n.bi_buf|=e<<n.bi_valid&65535,ew(n,n.bi_buf),n.bi_buf=e>>Z2-n.bi_valid,n.bi_valid+=t-Z2):(n.bi_buf|=e<<n.bi_valid&65535,n.bi_valid+=t)}function Al(n,e,t){Ds(n,t[e*2],t[e*2+1])}function jK(n,e){var t=0;do t|=n&1,n>>>=1,t<<=1;while(--e>0);return t>>>1}function W0e(n){n.bi_valid===16?(ew(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)}function $0e(n,e){var t=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,h,u,d,f,g,p=0;for(d=0;d<=ef;d++)n.bl_count[d]=0;for(t[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<OK;c++)h=n.heap[c],d=t[t[h*2+1]*2+1]+1,d>l&&(d=l,p++),t[h*2+1]=d,!(h>i)&&(n.bl_count[d]++,f=0,h>=a&&(f=o[h-a]),g=t[h*2],n.opt_len+=g*(d+f),s&&(n.static_len+=g*(r[h*2+1]+f)));if(p!==0){do{for(d=l-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[l]--,p-=2}while(p>0);for(d=l;d!==0;d--)for(h=n.bl_count[d];h!==0;)u=n.heap[--c],!(u>i)&&(t[u*2+1]!==d&&(n.opt_len+=(d-t[u*2+1])*t[u*2],t[u*2+1]=d),h--)}}function qK(n,e,t){var i=new Array(ef+1),r=0,s,o;for(s=1;s<=ef;s++)i[s]=r=r+t[s-1]<<1;for(o=0;o<=e;o++){var a=n[o*2+1];a!==0&&(n[o*2]=jK(i[a]++,a))}}function z0e(){var n,e,t,i,r,s=new Array(ef+1);for(t=0,i=0;i<O4-1;i++)for(V4[i]=t,n=0;n<1<<XN[i];n++)Jv[t++]=i;for(Jv[t-1]=i,r=0,i=0;i<16;i++)for(Ux[i]=r,n=0;n<1<<bS[i];n++)Qv[r++]=i;for(r>>=7;i<dm;i++)for(Ux[i]=r<<7,n=0;n<1<<bS[i]-7;n++)Qv[256+r++]=i;for(e=0;e<=ef;e++)s[e]=0;for(n=0;n<=143;)zc[n*2+1]=8,n++,s[8]++;for(;n<=255;)zc[n*2+1]=9,n++,s[9]++;for(;n<=279;)zc[n*2+1]=7,n++,s[7]++;for(;n<=287;)zc[n*2+1]=8,n++,s[8]++;for(qK(zc,Xv+1,s),n=0;n<dm;n++)Wb[n*2+1]=5,Wb[n*2]=jK(n,5);$K=new Y2(zc,XN,X1+1,Xv,ef),zK=new Y2(Wb,bS,0,dm,ef),HK=new Y2(new Array(0),B0e,0,P4,P0e)}function GK(n){var e;for(e=0;e<Xv;e++)n.dyn_ltree[e*2]=0;for(e=0;e<dm;e++)n.dyn_dtree[e*2]=0;for(e=0;e<P4;e++)n.bl_tree[e*2]=0;n.dyn_ltree[B4*2]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0}function KK(n){n.bi_valid>8?ew(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0}function H0e(n,e,t,i){KK(n),i&&(ew(n,t),ew(n,~t)),T0e.arraySet(n.pending_buf,n.window,e,t,n.pending),n.pending+=t}function l7(n,e,t,i){var r=e*2,s=t*2;return n[r]<n[s]||n[r]===n[s]&&i[e]<=i[t]}function Q2(n,e,t){for(var i=n.heap[t],r=t<<1;r<=n.heap_len&&(r<n.heap_len&&l7(e,n.heap[r+1],n.heap[r],n.depth)&&r++,!l7(e,i,n.heap[r],n.depth));)n.heap[t]=n.heap[r],t=r,r<<=1;n.heap[t]=i}function c7(n,e,t){var i,r,s=0,o,a;if(n.last_lit!==0)do i=n.pending_buf[n.d_buf+s*2]<<8|n.pending_buf[n.d_buf+s*2+1],r=n.pending_buf[n.l_buf+s],s++,i===0?Al(n,r,e):(o=Jv[r],Al(n,o+X1+1,e),a=XN[o],a!==0&&(r-=V4[o],Ds(n,r,a)),i--,o=UK(i),Al(n,o,t),a=bS[o],a!==0&&(i-=Ux[o],Ds(n,i,a)));while(s<n.last_lit);Al(n,B4,e)}function QN(n,e){var t=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,l=-1,c;for(n.heap_len=0,n.heap_max=OK,o=0;o<s;o++)t[o*2]!==0?(n.heap[++n.heap_len]=l=o,n.depth[o]=0):t[o*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,t[c*2]=1,n.depth[c]=0,n.opt_len--,r&&(n.static_len-=i[c*2+1]);for(e.max_code=l,o=n.heap_len>>1;o>=1;o--)Q2(n,t,o);c=s;do o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Q2(n,t,1),a=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=a,t[c*2]=t[o*2]+t[a*2],n.depth[c]=(n.depth[o]>=n.depth[a]?n.depth[o]:n.depth[a])+1,t[o*2+1]=t[a*2+1]=c,n.heap[1]=c++,Q2(n,t,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],$0e(n,e),qK(t,l,n.bl_count)}function h7(n,e,t){var i,r=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)&&(a<c?n.bl_tree[s*2]+=a:s!==0?(s!==r&&n.bl_tree[s*2]++,n.bl_tree[PK*2]++):a<=10?n.bl_tree[BK*2]++:n.bl_tree[VK*2]++,a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))}function u7(n,e,t){var i,r=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)){if(a<c)do Al(n,s,n.bl_tree);while(--a!==0);else s!==0?(s!==r&&(Al(n,s,n.bl_tree),a--),Al(n,PK,n.bl_tree),Ds(n,a-3,2)):a<=10?(Al(n,BK,n.bl_tree),Ds(n,a-3,3)):(Al(n,VK,n.bl_tree),Ds(n,a-11,7));a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}}function U0e(n){var e;for(h7(n,n.dyn_ltree,n.l_desc.max_code),h7(n,n.dyn_dtree,n.d_desc.max_code),QN(n,n.bl_desc),e=P4-1;e>=3&&n.bl_tree[WK[e]*2+1]===0;e--);return n.opt_len+=3*(e+1)+5+5+4,e}function j0e(n,e,t,i){var r;for(Ds(n,e-257,5),Ds(n,t-1,5),Ds(n,i-4,4),r=0;r<i;r++)Ds(n,n.bl_tree[WK[r]*2+1],3);u7(n,n.dyn_ltree,e-1),u7(n,n.dyn_dtree,t-1)}function q0e(n){var e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&n.dyn_ltree[t*2]!==0)return o7;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return a7;for(t=32;t<X1;t++)if(n.dyn_ltree[t*2]!==0)return a7;return o7}var d7=!1;function G0e(n){d7||(z0e(),d7=!0),n.l_desc=new X2(n.dyn_ltree,$K),n.d_desc=new X2(n.dyn_dtree,zK),n.bl_desc=new X2(n.bl_tree,HK),n.bi_buf=0,n.bi_valid=0,GK(n)}function ZK(n,e,t,i){Ds(n,(R0e<<1)+(i?1:0),3),H0e(n,e,t,!0)}function K0e(n){Ds(n,FK<<1,3),Al(n,B4,zc),W0e(n)}function Z0e(n,e,t,i){var r,s,o=0;n.level>0?(n.strm.data_type===N0e&&(n.strm.data_type=q0e(n)),QN(n,n.l_desc),QN(n,n.d_desc),o=U0e(n),r=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=r&&(r=s)):r=s=t+5,t+4<=r&&e!==-1?ZK(n,e,t,i):n.strategy===A0e||s===r?(Ds(n,(FK<<1)+(i?1:0),3),c7(n,zc,Wb)):(Ds(n,(M0e<<1)+(i?1:0),3),j0e(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),c7(n,n.dyn_ltree,n.dyn_dtree)),GK(n),i&&KK(n)}function Y0e(n,e,t){return n.pending_buf[n.d_buf+n.last_lit*2]=e>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=e&255,n.pending_buf[n.l_buf+n.last_lit]=t&255,n.last_lit++,e===0?n.dyn_ltree[t*2]++:(n.matches++,e--,n.dyn_ltree[(Jv[t]+X1+1)*2]++,n.dyn_dtree[UK(e)*2]++),n.last_lit===n.lit_bufsize-1}n0._tr_init=G0e;n0._tr_stored_block=ZK;n0._tr_flush_block=Z0e;n0._tr_tally=Y0e;n0._tr_align=K0e;function X0e(n,e,t,i){for(var r=n&65535|0,s=n>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[i++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0}var YK=X0e;function Q0e(){for(var n,e=[],t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e}var J0e=Q0e();function ebe(n,e,t,i){var r=J0e,s=i+t;n^=-1;for(var o=i;o<s;o++)n=n>>>8^r[(n^e[o])&255];return n^-1}var XK=ebe,W4={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ns=Lh,Qo=n0,QK=YK,Hh=XK,tbe=W4,Ag=0,ibe=1,nbe=3,_u=4,f7=5,Nl=0,g7=1,Jo=-2,rbe=-3,J2=-5,sbe=-1,obe=1,Xy=2,abe=3,lbe=4,cbe=0,hbe=2,Fk=8,ube=9,dbe=15,fbe=8,gbe=29,pbe=256,JN=pbe+1+gbe,mbe=30,_be=19,bbe=2*JN+1,vbe=15,Wt=3,cu=258,Na=cu+Wt+1,wbe=32,Ok=42,eR=69,vS=73,wS=91,yS=103,tf=113,fb=666,Un=1,Q1=2,Kf=3,s0=4,ybe=3;function hu(n,e){return n.msg=tbe[e],e}function p7(n){return(n<<1)-(n>4?9:0)}function eu(n){for(var e=n.length;--e>=0;)n[e]=0}function Uh(n){var e=n.state,t=e.pending;t>n.avail_out&&(t=n.avail_out),t!==0&&(ns.arraySet(n.output,e.pending_buf,e.pending_out,t,n.next_out),n.next_out+=t,e.pending_out+=t,n.total_out+=t,n.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function wr(n,e){Qo._tr_flush_block(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,e),n.block_start=n.strstart,Uh(n.strm)}function ei(n,e){n.pending_buf[n.pending++]=e}function z0(n,e){n.pending_buf[n.pending++]=e>>>8&255,n.pending_buf[n.pending++]=e&255}function Cbe(n,e,t,i){var r=n.avail_in;return r>i&&(r=i),r===0?0:(n.avail_in-=r,ns.arraySet(e,n.input,n.next_in,r,t),n.state.wrap===1?n.adler=QK(n.adler,e,r,t):n.state.wrap===2&&(n.adler=Hh(n.adler,e,r,t)),n.next_in+=r,n.total_in+=r,r)}function JK(n,e){var t=n.max_chain_length,i=n.strstart,r,s,o=n.prev_length,a=n.nice_match,l=n.strstart>n.w_size-Na?n.strstart-(n.w_size-Na):0,c=n.window,h=n.w_mask,u=n.prev,d=n.strstart+cu,f=c[i+o-1],g=c[i+o];n.prev_length>=n.good_match&&(t>>=2),a>n.lookahead&&(a=n.lookahead);do if(r=e,!(c[r+o]!==g||c[r+o-1]!==f||c[r]!==c[i]||c[++r]!==c[i+1])){i+=2,r++;do;while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<d);if(s=cu-(d-i),i=d-cu,s>o){if(n.match_start=e,o=s,s>=a)break;f=c[i+o-1],g=c[i+o]}}while((e=u[e&h])>l&&--t!==0);return o<=n.lookahead?o:n.lookahead}function Zf(n){var e=n.w_size,t,i,r,s,o;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=e+(e-Na)){ns.arraySet(n.window,n.window,e,e,0),n.match_start-=e,n.strstart-=e,n.block_start-=e,i=n.hash_size,t=i;do r=n.head[--t],n.head[t]=r>=e?r-e:0;while(--i);i=e,t=i;do r=n.prev[--t],n.prev[t]=r>=e?r-e:0;while(--i);s+=e}if(n.strm.avail_in===0)break;if(i=Cbe(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=i,n.lookahead+n.insert>=Wt)for(o=n.strstart-n.insert,n.ins_h=n.window[o],n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+Wt-1])&n.hash_mask,n.prev[o&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=o,o++,n.insert--,!(n.lookahead+n.insert<Wt)););}while(n.lookahead<Na&&n.strm.avail_in!==0)}function Sbe(n,e){var t=65535;for(t>n.pending_buf_size-5&&(t=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Zf(n),n.lookahead===0&&e===Ag)return Un;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;var i=n.block_start+t;if((n.strstart===0||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,wr(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-Na&&(wr(n,!1),n.strm.avail_out===0))return Un}return n.insert=0,e===_u?(wr(n,!0),n.strm.avail_out===0?Kf:s0):(n.strstart>n.block_start&&(wr(n,!1),n.strm.avail_out===0),Un)}function eI(n,e){for(var t,i;;){if(n.lookahead<Na){if(Zf(n),n.lookahead<Na&&e===Ag)return Un;if(n.lookahead===0)break}if(t=0,n.lookahead>=Wt&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Wt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),t!==0&&n.strstart-t<=n.w_size-Na&&(n.match_length=JK(n,t)),n.match_length>=Wt)if(i=Qo._tr_tally(n,n.strstart-n.match_start,n.match_length-Wt),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=Wt){n.match_length--;do n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Wt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else i=Qo._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(wr(n,!1),n.strm.avail_out===0))return Un}return n.insert=n.strstart<Wt-1?n.strstart:Wt-1,e===_u?(wr(n,!0),n.strm.avail_out===0?Kf:s0):n.last_lit&&(wr(n,!1),n.strm.avail_out===0)?Un:Q1}function fp(n,e){for(var t,i,r;;){if(n.lookahead<Na){if(Zf(n),n.lookahead<Na&&e===Ag)return Un;if(n.lookahead===0)break}if(t=0,n.lookahead>=Wt&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Wt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=Wt-1,t!==0&&n.prev_length<n.max_lazy_match&&n.strstart-t<=n.w_size-Na&&(n.match_length=JK(n,t),n.match_length<=5&&(n.strategy===obe||n.match_length===Wt&&n.strstart-n.match_start>4096)&&(n.match_length=Wt-1)),n.prev_length>=Wt&&n.match_length<=n.prev_length){r=n.strstart+n.lookahead-Wt,i=Qo._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-Wt),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=r&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+Wt-1])&n.hash_mask,t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=Wt-1,n.strstart++,i&&(wr(n,!1),n.strm.avail_out===0))return Un}else if(n.match_available){if(i=Qo._tr_tally(n,0,n.window[n.strstart-1]),i&&wr(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return Un}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=Qo._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<Wt-1?n.strstart:Wt-1,e===_u?(wr(n,!0),n.strm.avail_out===0?Kf:s0):n.last_lit&&(wr(n,!1),n.strm.avail_out===0)?Un:Q1}function xbe(n,e){for(var t,i,r,s,o=n.window;;){if(n.lookahead<=cu){if(Zf(n),n.lookahead<=cu&&e===Ag)return Un;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=Wt&&n.strstart>0&&(r=n.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=n.strstart+cu;do;while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);n.match_length=cu-(s-r),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=Wt?(t=Qo._tr_tally(n,1,n.match_length-Wt),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(t=Qo._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),t&&(wr(n,!1),n.strm.avail_out===0))return Un}return n.insert=0,e===_u?(wr(n,!0),n.strm.avail_out===0?Kf:s0):n.last_lit&&(wr(n,!1),n.strm.avail_out===0)?Un:Q1}function Ebe(n,e){for(var t;;){if(n.lookahead===0&&(Zf(n),n.lookahead===0)){if(e===Ag)return Un;break}if(n.match_length=0,t=Qo._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,t&&(wr(n,!1),n.strm.avail_out===0))return Un}return n.insert=0,e===_u?(wr(n,!0),n.strm.avail_out===0?Kf:s0):n.last_lit&&(wr(n,!1),n.strm.avail_out===0)?Un:Q1}function dl(n,e,t,i,r){this.good_length=n,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=r}var jp;jp=[new dl(0,0,0,0,Sbe),new dl(4,4,8,4,eI),new dl(4,5,16,8,eI),new dl(4,6,32,32,eI),new dl(4,4,16,16,fp),new dl(8,16,32,32,fp),new dl(8,16,128,128,fp),new dl(8,32,128,256,fp),new dl(32,128,258,1024,fp),new dl(32,258,258,4096,fp)];function Dbe(n){n.window_size=2*n.w_size,eu(n.head),n.max_lazy_match=jp[n.level].max_lazy,n.good_match=jp[n.level].good_length,n.nice_match=jp[n.level].nice_length,n.max_chain_length=jp[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=Wt-1,n.match_available=0,n.ins_h=0}function kbe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Fk,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ns.Buf16(bbe*2),this.dyn_dtree=new ns.Buf16((2*mbe+1)*2),this.bl_tree=new ns.Buf16((2*_be+1)*2),eu(this.dyn_ltree),eu(this.dyn_dtree),eu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ns.Buf16(vbe+1),this.heap=new ns.Buf16(2*JN+1),eu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ns.Buf16(2*JN+1),eu(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function eZ(n){var e;return!n||!n.state?hu(n,Jo):(n.total_in=n.total_out=0,n.data_type=hbe,e=n.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Ok:tf,n.adler=e.wrap===2?0:1,e.last_flush=Ag,Qo._tr_init(e),Nl)}function tZ(n){var e=eZ(n);return e===Nl&&Dbe(n.state),e}function Lbe(n,e){return!n||!n.state||n.state.wrap!==2?Jo:(n.state.gzhead=e,Nl)}function iZ(n,e,t,i,r,s){if(!n)return Jo;var o=1;if(e===sbe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>ube||t!==Fk||i<8||i>15||e<0||e>9||s<0||s>lbe)return hu(n,Jo);i===8&&(i=9);var a=new kbe;return n.state=a,a.strm=n,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Wt-1)/Wt),a.window=new ns.Buf8(a.w_size*2),a.head=new ns.Buf16(a.hash_size),a.prev=new ns.Buf16(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new ns.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=t,tZ(n)}function Ibe(n,e){return iZ(n,e,Fk,dbe,fbe,cbe)}function Tbe(n,e){var t,i,r,s;if(!n||!n.state||e>f7||e<0)return n?hu(n,Jo):Jo;if(i=n.state,!n.output||!n.input&&n.avail_in!==0||i.status===fb&&e!==_u)return hu(n,n.avail_out===0?J2:Jo);if(i.strm=n,t=i.last_flush,i.last_flush=e,i.status===Ok)if(i.wrap===2)n.adler=0,ei(i,31),ei(i,139),ei(i,8),i.gzhead?(ei(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ei(i,i.gzhead.time&255),ei(i,i.gzhead.time>>8&255),ei(i,i.gzhead.time>>16&255),ei(i,i.gzhead.time>>24&255),ei(i,i.level===9?2:i.strategy>=Xy||i.level<2?4:0),ei(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(ei(i,i.gzhead.extra.length&255),ei(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=Hh(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=eR):(ei(i,0),ei(i,0),ei(i,0),ei(i,0),ei(i,0),ei(i,i.level===9?2:i.strategy>=Xy||i.level<2?4:0),ei(i,ybe),i.status=tf);else{var o=Fk+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=Xy||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=wbe),o+=31-o%31,i.status=tf,z0(i,o),i.strstart!==0&&(z0(i,n.adler>>>16),z0(i,n.adler&65535)),n.adler=1}if(i.status===eR)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),Uh(n),r=i.pending,i.pending===i.pending_buf_size));)ei(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=vS)}else i.status=vS;if(i.status===vS)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),Uh(n),r=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,ei(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),s===0&&(i.gzindex=0,i.status=wS)}else i.status=wS;if(i.status===wS)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),Uh(n),r=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,ei(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>r&&(n.adler=Hh(n.adler,i.pending_buf,i.pending-r,r)),s===0&&(i.status=yS)}else i.status=yS;if(i.status===yS&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Uh(n),i.pending+2<=i.pending_buf_size&&(ei(i,n.adler&255),ei(i,n.adler>>8&255),n.adler=0,i.status=tf)):i.status=tf),i.pending!==0){if(Uh(n),n.avail_out===0)return i.last_flush=-1,Nl}else if(n.avail_in===0&&p7(e)<=p7(t)&&e!==_u)return hu(n,J2);if(i.status===fb&&n.avail_in!==0)return hu(n,J2);if(n.avail_in!==0||i.lookahead!==0||e!==Ag&&i.status!==fb){var l=i.strategy===Xy?Ebe(i,e):i.strategy===abe?xbe(i,e):jp[i.level].func(i,e);if((l===Kf||l===s0)&&(i.status=fb),l===Un||l===Kf)return n.avail_out===0&&(i.last_flush=-1),Nl;if(l===Q1&&(e===ibe?Qo._tr_align(i):e!==f7&&(Qo._tr_stored_block(i,0,0,!1),e===nbe&&(eu(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Uh(n),n.avail_out===0))return i.last_flush=-1,Nl}return e!==_u?Nl:i.wrap<=0?g7:(i.wrap===2?(ei(i,n.adler&255),ei(i,n.adler>>8&255),ei(i,n.adler>>16&255),ei(i,n.adler>>24&255),ei(i,n.total_in&255),ei(i,n.total_in>>8&255),ei(i,n.total_in>>16&255),ei(i,n.total_in>>24&255)):(z0(i,n.adler>>>16),z0(i,n.adler&65535)),Uh(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Nl:g7)}function Abe(n){var e;return!n||!n.state?Jo:(e=n.state.status,e!==Ok&&e!==eR&&e!==vS&&e!==wS&&e!==yS&&e!==tf&&e!==fb?hu(n,Jo):(n.state=null,e===tf?hu(n,rbe):Nl))}function Nbe(n,e){var t=e.length,i,r,s,o,a,l,c,h;if(!n||!n.state||(i=n.state,o=i.wrap,o===2||o===1&&i.status!==Ok||i.lookahead))return Jo;for(o===1&&(n.adler=QK(n.adler,e,t,0)),i.wrap=0,t>=i.w_size&&(o===0&&(eu(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new ns.Buf8(i.w_size),ns.arraySet(h,e,t-i.w_size,i.w_size,0),e=h,t=i.w_size),a=n.avail_in,l=n.next_in,c=n.input,n.avail_in=t,n.next_in=0,n.input=e,Zf(i);i.lookahead>=Wt;){r=i.strstart,s=i.lookahead-(Wt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+Wt-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++;while(--s);i.strstart=r,i.lookahead=Wt-1,Zf(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Wt-1,i.match_available=0,n.next_in=l,n.input=c,n.avail_in=a,i.wrap=o,Nl}gc.deflateInit=Ibe;gc.deflateInit2=iZ;gc.deflateReset=tZ;gc.deflateResetKeep=eZ;gc.deflateSetHeader=Lbe;gc.deflate=Tbe;gc.deflateEnd=Abe;gc.deflateSetDictionary=Nbe;gc.deflateInfo="pako deflate (from Nodeca project)";var Ng={},Pk=Lh,nZ=!0,rZ=!0;try{String.fromCharCode.apply(null,[0])}catch{nZ=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{rZ=!1}var tw=new Pk.Buf8(256);for(var Fh=0;Fh<256;Fh++)tw[Fh]=Fh>=252?6:Fh>=248?5:Fh>=240?4:Fh>=224?3:Fh>=192?2:1;tw[254]=tw[254]=1;Ng.string2buf=function(n){var e,t,i,r,s,o=n.length,a=0;for(r=0;r<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Pk.Buf8(a),s=0,r=0;s<a;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};function sZ(n,e){if(e<65534&&(n.subarray&&rZ||!n.subarray&&nZ))return String.fromCharCode.apply(null,Pk.shrinkBuf(n,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t}Ng.buf2binstring=function(n){return sZ(n,n.length)};Ng.binstring2buf=function(n){for(var e=new Pk.Buf8(n.length),t=0,i=e.length;t<i;t++)e[t]=n.charCodeAt(t);return e};Ng.buf2string=function(n,e){var t,i,r,s,o=e||n.length,a=new Array(o*2);for(i=0,t=0;t<o;){if(r=n[t++],r<128){a[i++]=r;continue}if(s=tw[r],s>4){a[i++]=65533,t+=s-1;continue}for(r&=s===2?31:s===3?15:7;s>1&&t<o;)r=r<<6|n[t++]&63,s--;if(s>1){a[i++]=65533;continue}r<65536?a[i++]=r:(r-=65536,a[i++]=55296|r>>10&1023,a[i++]=56320|r&1023)}return sZ(a,i)};Ng.utf8border=function(n,e){var t;for(e=e||n.length,e>n.length&&(e=n.length),t=e-1;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+tw[n[t]]>e?t:e};function Rbe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var oZ=Rbe,$b=gc,zb=Lh,tR=Ng,iR=W4,Mbe=oZ,aZ=Object.prototype.toString,Fbe=0,tI=4,fm=0,m7=1,_7=2,Obe=-1,Pbe=0,Bbe=8;function Yf(n){if(!(this instanceof Yf))return new Yf(n);this.options=zb.assign({level:Obe,method:Bbe,chunkSize:16384,windowBits:15,memLevel:8,strategy:Pbe,to:""},n||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mbe,this.strm.avail_out=0;var t=$b.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==fm)throw new Error(iR[t]);if(e.header&&$b.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=tR.string2buf(e.dictionary):aZ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=$b.deflateSetDictionary(this.strm,i),t!==fm)throw new Error(iR[t]);this._dict_set=!0}}Yf.prototype.push=function(n,e){var t=this.strm,i=this.options.chunkSize,r,s;if(this.ended)return!1;s=e===~~e?e:e===!0?tI:Fbe,typeof n=="string"?t.input=tR.string2buf(n):aZ.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new zb.Buf8(i),t.next_out=0,t.avail_out=i),r=$b.deflate(t,s),r!==m7&&r!==fm)return this.onEnd(r),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(s===tI||s===_7))&&(this.options.to==="string"?this.onData(tR.buf2binstring(zb.shrinkBuf(t.output,t.next_out))):this.onData(zb.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&r!==m7);return s===tI?(r=$b.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===fm):(s===_7&&(this.onEnd(fm),t.avail_out=0),!0)};Yf.prototype.onData=function(n){this.chunks.push(n)};Yf.prototype.onEnd=function(n){n===fm&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=zb.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function $4(n,e){var t=new Yf(e);if(t.push(n,!0),t.err)throw t.msg||iR[t.err];return t.result}function Vbe(n,e){return e=e||{},e.raw=!0,$4(n,e)}function Wbe(n,e){return e=e||{},e.gzip=!0,$4(n,e)}Y1.Deflate=Yf;Y1.deflate=$4;Y1.deflateRaw=Vbe;Y1.gzip=Wbe;var J1={},el={},Qy=30,$be=12,zbe=function(e,t){var i,r,s,o,a,l,c,h,u,d,f,g,p,m,b,_,w,y,S,k,C,D,E,N,T;i=e.state,r=e.next_in,N=e.input,s=r+(e.avail_in-5),o=e.next_out,T=e.output,a=o-(t-e.avail_out),l=o+(e.avail_out-257),c=i.dmax,h=i.wsize,u=i.whave,d=i.wnext,f=i.window,g=i.hold,p=i.bits,m=i.lencode,b=i.distcode,_=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;e:do{p<15&&(g+=N[r++]<<p,p+=8,g+=N[r++]<<p,p+=8),y=m[g&_];t:for(;;){if(S=y>>>24,g>>>=S,p-=S,S=y>>>16&255,S===0)T[o++]=y&65535;else if(S&16){k=y&65535,S&=15,S&&(p<S&&(g+=N[r++]<<p,p+=8),k+=g&(1<<S)-1,g>>>=S,p-=S),p<15&&(g+=N[r++]<<p,p+=8,g+=N[r++]<<p,p+=8),y=b[g&w];i:for(;;){if(S=y>>>24,g>>>=S,p-=S,S=y>>>16&255,S&16){if(C=y&65535,S&=15,p<S&&(g+=N[r++]<<p,p+=8,p<S&&(g+=N[r++]<<p,p+=8)),C+=g&(1<<S)-1,C>c){e.msg="invalid distance too far back",i.mode=Qy;break e}if(g>>>=S,p-=S,S=o-a,C>S){if(S=C-S,S>u&&i.sane){e.msg="invalid distance too far back",i.mode=Qy;break e}if(D=0,E=f,d===0){if(D+=h-S,S<k){k-=S;do T[o++]=f[D++];while(--S);D=o-C,E=T}}else if(d<S){if(D+=h+d-S,S-=d,S<k){k-=S;do T[o++]=f[D++];while(--S);if(D=0,d<k){S=d,k-=S;do T[o++]=f[D++];while(--S);D=o-C,E=T}}}else if(D+=d-S,S<k){k-=S;do T[o++]=f[D++];while(--S);D=o-C,E=T}for(;k>2;)T[o++]=E[D++],T[o++]=E[D++],T[o++]=E[D++],k-=3;k&&(T[o++]=E[D++],k>1&&(T[o++]=E[D++]))}else{D=o-C;do T[o++]=T[D++],T[o++]=T[D++],T[o++]=T[D++],k-=3;while(k>2);k&&(T[o++]=T[D++],k>1&&(T[o++]=T[D++]))}}else if(S&64){e.msg="invalid distance code",i.mode=Qy;break e}else{y=b[(y&65535)+(g&(1<<S)-1)];continue i}break}}else if(S&64)if(S&32){i.mode=$be;break e}else{e.msg="invalid literal/length code",i.mode=Qy;break e}else{y=m[(y&65535)+(g&(1<<S)-1)];continue t}break}}while(r<s&&o<l);k=p>>3,r-=k,p-=k<<3,g&=(1<<p)-1,e.next_in=r,e.next_out=o,e.avail_in=r<s?5+(s-r):5-(r-s),e.avail_out=o<l?257+(l-o):257-(o-l),i.hold=g,i.bits=p},b7=Lh,gp=15,v7=852,w7=592,y7=0,iI=1,C7=2,Hbe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ube=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],jbe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],qbe=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Gbe=function(e,t,i,r,s,o,a,l){var c=l.bits,h=0,u=0,d=0,f=0,g=0,p=0,m=0,b=0,_=0,w=0,y,S,k,C,D,E=null,N=0,T,j=new b7.Buf16(gp+1),q=new b7.Buf16(gp+1),ie=null,ge=0,be,Se,Le;for(h=0;h<=gp;h++)j[h]=0;for(u=0;u<r;u++)j[t[i+u]]++;for(g=c,f=gp;f>=1&&j[f]===0;f--);if(g>f&&(g=f),f===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&j[d]===0;d++);for(g<d&&(g=d),b=1,h=1;h<=gp;h++)if(b<<=1,b-=j[h],b<0)return-1;if(b>0&&(e===y7||f!==1))return-1;for(q[1]=0,h=1;h<gp;h++)q[h+1]=q[h]+j[h];for(u=0;u<r;u++)t[i+u]!==0&&(a[q[t[i+u]]++]=u);if(e===y7?(E=ie=a,T=19):e===iI?(E=Hbe,N-=257,ie=Ube,ge-=257,T=256):(E=jbe,ie=qbe,T=-1),w=0,u=0,h=d,D=o,p=g,m=0,k=-1,_=1<<g,C=_-1,e===iI&&_>v7||e===C7&&_>w7)return 1;for(;;){be=h-m,a[u]<T?(Se=0,Le=a[u]):a[u]>T?(Se=ie[ge+a[u]],Le=E[N+a[u]]):(Se=32+64,Le=0),y=1<<h-m,S=1<<p,d=S;do S-=y,s[D+(w>>m)+S]=be<<24|Se<<16|Le|0;while(S!==0);for(y=1<<h-1;w&y;)y>>=1;if(y!==0?(w&=y-1,w+=y):w=0,u++,--j[h]===0){if(h===f)break;h=t[i+a[u]]}if(h>g&&(w&C)!==k){for(m===0&&(m=g),D+=d,p=h-m,b=1<<p;p+m<f&&(b-=j[p+m],!(b<=0));)p++,b<<=1;if(_+=1<<p,e===iI&&_>v7||e===C7&&_>w7)return 1;k=w&C,s[k]=g<<24|p<<16|D-o|0}}return w!==0&&(s[D+w]=h-m<<24|64<<16|0),l.bits=g,0},ro=Lh,nR=YK,fl=XK,Kbe=zbe,Hb=Gbe,Zbe=0,lZ=1,cZ=2,S7=4,Ybe=5,Jy=6,Xf=0,Xbe=1,Qbe=2,na=-2,hZ=-3,uZ=-4,Jbe=-5,x7=8,dZ=1,E7=2,D7=3,k7=4,L7=5,I7=6,T7=7,A7=8,N7=9,R7=10,jx=11,xc=12,nI=13,M7=14,rI=15,F7=16,O7=17,P7=18,B7=19,eC=20,tC=21,V7=22,W7=23,$7=24,z7=25,H7=26,sI=27,U7=28,j7=29,Ji=30,fZ=31,eve=32,tve=852,ive=592,nve=15,rve=nve;function q7(n){return(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24)}function sve(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ro.Buf16(320),this.work=new ro.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function gZ(n){var e;return!n||!n.state?na:(e=n.state,n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=dZ,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new ro.Buf32(tve),e.distcode=e.distdyn=new ro.Buf32(ive),e.sane=1,e.back=-1,Xf)}function pZ(n){var e;return!n||!n.state?na:(e=n.state,e.wsize=0,e.whave=0,e.wnext=0,gZ(n))}function mZ(n,e){var t,i;return!n||!n.state||(i=n.state,e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?na:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,pZ(n))}function _Z(n,e){var t,i;return n?(i=new sve,n.state=i,i.window=null,t=mZ(n,e),t!==Xf&&(n.state=null),t):na}function ove(n){return _Z(n,rve)}var G7=!0,oI,aI;function ave(n){if(G7){var e;for(oI=new ro.Buf32(512),aI=new ro.Buf32(32),e=0;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Hb(lZ,n.lens,0,288,oI,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Hb(cZ,n.lens,0,32,aI,0,n.work,{bits:5}),G7=!1}n.lencode=oI,n.lenbits=9,n.distcode=aI,n.distbits=5}function bZ(n,e,t,i){var r,s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new ro.Buf8(s.wsize)),i>=s.wsize?(ro.arraySet(s.window,e,t-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),ro.arraySet(s.window,e,t-i,r,s.wnext),i-=r,i?(ro.arraySet(s.window,e,t-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0}function lve(n,e){var t,i,r,s,o,a,l,c,h,u,d,f,g,p,m=0,b,_,w,y,S,k,C,D,E=new ro.Buf8(4),N,T,j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return na;t=n.state,t.mode===xc&&(t.mode=nI),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,c=t.hold,h=t.bits,u=a,d=l,D=Xf;e:for(;;)switch(t.mode){case dZ:if(t.wrap===0){t.mode=nI;break}for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.wrap&2&&c===35615){t.check=0,E[0]=c&255,E[1]=c>>>8&255,t.check=fl(t.check,E,2,0),c=0,h=0,t.mode=E7;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=Ji;break}if((c&15)!==x7){n.msg="unknown compression method",t.mode=Ji;break}if(c>>>=4,h-=4,C=(c&15)+8,t.wbits===0)t.wbits=C;else if(C>t.wbits){n.msg="invalid window size",t.mode=Ji;break}t.dmax=1<<C,n.adler=t.check=1,t.mode=c&512?R7:xc,c=0,h=0;break;case E7:for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.flags=c,(t.flags&255)!==x7){n.msg="unknown compression method",t.mode=Ji;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Ji;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&(E[0]=c&255,E[1]=c>>>8&255,t.check=fl(t.check,E,2,0)),c=0,h=0,t.mode=D7;case D7:for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.head&&(t.head.time=c),t.flags&512&&(E[0]=c&255,E[1]=c>>>8&255,E[2]=c>>>16&255,E[3]=c>>>24&255,t.check=fl(t.check,E,4,0)),c=0,h=0,t.mode=k7;case k7:for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&(E[0]=c&255,E[1]=c>>>8&255,t.check=fl(t.check,E,2,0)),c=0,h=0,t.mode=L7;case L7:if(t.flags&1024){for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&(E[0]=c&255,E[1]=c>>>8&255,t.check=fl(t.check,E,2,0)),c=0,h=0}else t.head&&(t.head.extra=null);t.mode=I7;case I7:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(C=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),ro.arraySet(t.head.extra,i,s,f,C)),t.flags&512&&(t.check=fl(t.check,i,f,s)),a-=f,s+=f,t.length-=f),t.length))break e;t.length=0,t.mode=T7;case T7:if(t.flags&2048){if(a===0)break e;f=0;do C=i[s+f++],t.head&&C&&t.length<65536&&(t.head.name+=String.fromCharCode(C));while(C&&f<a);if(t.flags&512&&(t.check=fl(t.check,i,f,s)),a-=f,s+=f,C)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=A7;case A7:if(t.flags&4096){if(a===0)break e;f=0;do C=i[s+f++],t.head&&C&&t.length<65536&&(t.head.comment+=String.fromCharCode(C));while(C&&f<a);if(t.flags&512&&(t.check=fl(t.check,i,f,s)),a-=f,s+=f,C)break e}else t.head&&(t.head.comment=null);t.mode=N7;case N7:if(t.flags&512){for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Ji;break}c=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=xc;break;case R7:for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}n.adler=t.check=q7(c),c=0,h=0,t.mode=jx;case jx:if(t.havedict===0)return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,Qbe;n.adler=t.check=1,t.mode=xc;case xc:if(e===Ybe||e===Jy)break e;case nI:if(t.last){c>>>=h&7,h-=h&7,t.mode=sI;break}for(;h<3;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}switch(t.last=c&1,c>>>=1,h-=1,c&3){case 0:t.mode=M7;break;case 1:if(ave(t),t.mode=eC,e===Jy){c>>>=2,h-=2;break e}break;case 2:t.mode=O7;break;case 3:n.msg="invalid block type",t.mode=Ji}c>>>=2,h-=2;break;case M7:for(c>>>=h&7,h-=h&7;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Ji;break}if(t.length=c&65535,c=0,h=0,t.mode=rI,e===Jy)break e;case rI:t.mode=F7;case F7:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;ro.arraySet(r,i,s,f,o),a-=f,s+=f,l-=f,o+=f,t.length-=f;break}t.mode=xc;break;case O7:for(;h<14;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.nlen=(c&31)+257,c>>>=5,h-=5,t.ndist=(c&31)+1,c>>>=5,h-=5,t.ncode=(c&15)+4,c>>>=4,h-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Ji;break}t.have=0,t.mode=P7;case P7:for(;t.have<t.ncode;){for(;h<3;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.lens[j[t.have++]]=c&7,c>>>=3,h-=3}for(;t.have<19;)t.lens[j[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,N={bits:t.lenbits},D=Hb(Zbe,t.lens,0,19,t.lencode,0,t.work,N),t.lenbits=N.bits,D){n.msg="invalid code lengths set",t.mode=Ji;break}t.have=0,t.mode=B7;case B7:for(;t.have<t.nlen+t.ndist;){for(;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(w<16)c>>>=b,h-=b,t.lens[t.have++]=w;else{if(w===16){for(T=b+2;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(c>>>=b,h-=b,t.have===0){n.msg="invalid bit length repeat",t.mode=Ji;break}C=t.lens[t.have-1],f=3+(c&3),c>>>=2,h-=2}else if(w===17){for(T=b+3;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=b,h-=b,C=0,f=3+(c&7),c>>>=3,h-=3}else{for(T=b+7;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=b,h-=b,C=0,f=11+(c&127),c>>>=7,h-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Ji;break}for(;f--;)t.lens[t.have++]=C}}if(t.mode===Ji)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Ji;break}if(t.lenbits=9,N={bits:t.lenbits},D=Hb(lZ,t.lens,0,t.nlen,t.lencode,0,t.work,N),t.lenbits=N.bits,D){n.msg="invalid literal/lengths set",t.mode=Ji;break}if(t.distbits=6,t.distcode=t.distdyn,N={bits:t.distbits},D=Hb(cZ,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,N),t.distbits=N.bits,D){n.msg="invalid distances set",t.mode=Ji;break}if(t.mode=eC,e===Jy)break e;case eC:t.mode=tC;case tC:if(a>=6&&l>=258){n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,Kbe(n,d),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,c=t.hold,h=t.bits,t.mode===xc&&(t.back=-1);break}for(t.back=0;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(_&&!(_&240)){for(y=b,S=_,k=w;m=t.lencode[k+((c&(1<<y+S)-1)>>y)],b=m>>>24,_=m>>>16&255,w=m&65535,!(y+b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=y,h-=y,t.back+=y}if(c>>>=b,h-=b,t.back+=b,t.length=w,_===0){t.mode=H7;break}if(_&32){t.back=-1,t.mode=xc;break}if(_&64){n.msg="invalid literal/length code",t.mode=Ji;break}t.extra=_&15,t.mode=V7;case V7:if(t.extra){for(T=t.extra;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=W7;case W7:for(;m=t.distcode[c&(1<<t.distbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(!(_&240)){for(y=b,S=_,k=w;m=t.distcode[k+((c&(1<<y+S)-1)>>y)],b=m>>>24,_=m>>>16&255,w=m&65535,!(y+b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=y,h-=y,t.back+=y}if(c>>>=b,h-=b,t.back+=b,_&64){n.msg="invalid distance code",t.mode=Ji;break}t.offset=w,t.extra=_&15,t.mode=$7;case $7:if(t.extra){for(T=t.extra;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Ji;break}t.mode=z7;case z7:if(l===0)break e;if(f=d-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Ji;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),p=t.window}else p=r,g=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do r[o++]=p[g++];while(--f);t.length===0&&(t.mode=tC);break;case H7:if(l===0)break e;r[o++]=t.length,l--,t.mode=tC;break;case sI:if(t.wrap){for(;h<32;){if(a===0)break e;a--,c|=i[s++]<<h,h+=8}if(d-=l,n.total_out+=d,t.total+=d,d&&(n.adler=t.check=t.flags?fl(t.check,r,d,o-d):nR(t.check,r,d,o-d)),d=l,(t.flags?c:q7(c))!==t.check){n.msg="incorrect data check",t.mode=Ji;break}c=0,h=0}t.mode=U7;case U7:if(t.wrap&&t.flags){for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Ji;break}c=0,h=0}t.mode=j7;case j7:D=Xbe;break e;case Ji:D=hZ;break e;case fZ:return uZ;case eve:default:return na}return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,(t.wsize||d!==n.avail_out&&t.mode<Ji&&(t.mode<sI||e!==S7))&&bZ(n,n.output,n.next_out,d-n.avail_out),u-=n.avail_in,d-=n.avail_out,n.total_in+=u,n.total_out+=d,t.total+=d,t.wrap&&d&&(n.adler=t.check=t.flags?fl(t.check,r,d,n.next_out-d):nR(t.check,r,d,n.next_out-d)),n.data_type=t.bits+(t.last?64:0)+(t.mode===xc?128:0)+(t.mode===eC||t.mode===rI?256:0),(u===0&&d===0||e===S7)&&D===Xf&&(D=Jbe),D}function cve(n){if(!n||!n.state)return na;var e=n.state;return e.window&&(e.window=null),n.state=null,Xf}function hve(n,e){var t;return!n||!n.state||(t=n.state,!(t.wrap&2))?na:(t.head=e,e.done=!1,Xf)}function uve(n,e){var t=e.length,i,r,s;return!n||!n.state||(i=n.state,i.wrap!==0&&i.mode!==jx)?na:i.mode===jx&&(r=1,r=nR(r,e,t,0),r!==i.check)?hZ:(s=bZ(n,e,t,t),s?(i.mode=fZ,uZ):(i.havedict=1,Xf))}el.inflateReset=pZ;el.inflateReset2=mZ;el.inflateResetKeep=gZ;el.inflateInit=ove;el.inflateInit2=_Z;el.inflate=lve;el.inflateEnd=cve;el.inflateGetHeader=hve;el.inflateSetDictionary=uve;el.inflateInfo="pako inflate (from Nodeca project)";var vZ={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function dve(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var fve=dve,gm=el,Ub=Lh,CS=Ng,En=vZ,rR=W4,gve=oZ,pve=fve,wZ=Object.prototype.toString;function Qf(n){if(!(this instanceof Qf))return new Qf(n);this.options=Ub.assign({chunkSize:16384,windowBits:0,to:""},n||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gve,this.strm.avail_out=0;var t=gm.inflateInit2(this.strm,e.windowBits);if(t!==En.Z_OK)throw new Error(rR[t]);if(this.header=new pve,gm.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=CS.string2buf(e.dictionary):wZ.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=gm.inflateSetDictionary(this.strm,e.dictionary),t!==En.Z_OK)))throw new Error(rR[t])}Qf.prototype.push=function(n,e){var t=this.strm,i=this.options.chunkSize,r=this.options.dictionary,s,o,a,l,c,h=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?En.Z_FINISH:En.Z_NO_FLUSH,typeof n=="string"?t.input=CS.binstring2buf(n):wZ.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Ub.Buf8(i),t.next_out=0,t.avail_out=i),s=gm.inflate(t,En.Z_NO_FLUSH),s===En.Z_NEED_DICT&&r&&(s=gm.inflateSetDictionary(this.strm,r)),s===En.Z_BUF_ERROR&&h===!0&&(s=En.Z_OK,h=!1),s!==En.Z_STREAM_END&&s!==En.Z_OK)return this.onEnd(s),this.ended=!0,!1;t.next_out&&(t.avail_out===0||s===En.Z_STREAM_END||t.avail_in===0&&(o===En.Z_FINISH||o===En.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=CS.utf8border(t.output,t.next_out),l=t.next_out-a,c=CS.buf2string(t.output,a),t.next_out=l,t.avail_out=i-l,l&&Ub.arraySet(t.output,t.output,a,l,0),this.onData(c)):this.onData(Ub.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(h=!0)}while((t.avail_in>0||t.avail_out===0)&&s!==En.Z_STREAM_END);return s===En.Z_STREAM_END&&(o=En.Z_FINISH),o===En.Z_FINISH?(s=gm.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===En.Z_OK):(o===En.Z_SYNC_FLUSH&&(this.onEnd(En.Z_OK),t.avail_out=0),!0)};Qf.prototype.onData=function(n){this.chunks.push(n)};Qf.prototype.onEnd=function(n){n===En.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ub.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function z4(n,e){var t=new Qf(e);if(t.push(n,!0),t.err)throw t.msg||rR[t.err];return t.result}function mve(n,e){return e=e||{},e.raw=!0,z4(n,e)}J1.Inflate=Qf;J1.inflate=z4;J1.inflateRaw=mve;J1.ungzip=z4;var _ve=Lh.assign,bve=Y1,vve=J1,wve=vZ,yZ={};_ve(yZ,bve,vve,wve);var qx=yZ;async function a_(n){try{let e,t=0,i=0;const r=[];let s=0,o;do{const l=n.subarray(t);if(o=new qx.Inflate,{strm:e}=o,o.push(l,qx.Z_SYNC_FLUSH),o.err)throw new Error(o.msg);t+=e.next_in,r[i]=o.result,s+=r[i].length,i+=1}while(e.avail_in);const a=new Uint8Array(s);for(let l=0,c=0;l<r.length;l++)a.set(r[l],c),c+=r[l].length;return Buffer.from(a)}catch(e){throw`${e}`.match(/incorrect header check/)?new Error("problem decompressing block: incorrect gzip header check"):e}}async function CZ(n,e){try{let t;const{minv:i,maxv:r}=e;let s=i.blockPosition,o=i.dataPosition;const a=[],l=[],c=[];let h=0,u=0;do{const g=n.subarray(s-i.blockPosition),p=new qx.Inflate;if({strm:t}=p,p.push(g,qx.Z_SYNC_FLUSH),p.err)throw new Error(p.msg);const m=p.result;a.push(m);let b=m.length;l.push(s),c.push(o),a.length===1&&i.dataPosition&&(a[0]=a[0].subarray(i.dataPosition),b=a[0].length);const _=s;if(s+=t.next_in,o+=b,_>=r.blockPosition){a[u]=a[u].subarray(0,r.blockPosition===i.blockPosition?r.dataPosition-i.dataPosition+1:r.dataPosition+1),l.push(s),c.push(o),h+=a[u].length;break}h+=a[u].length,u++}while(t.avail_in);const d=new Uint8Array(h);for(let g=0,p=0;g<a.length;g++)d.set(a[g],p),p+=a[g].length;return{buffer:Buffer.from(d),cpositions:l,dpositions:c}}catch(t){throw`${t}`.match(/incorrect header check/)?new Error("problem decompressing block: incorrect gzip header check"):t}}/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var zo=null;try{zo=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Gi(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Gi.prototype.__isLong__;Object.defineProperty(Gi.prototype,"__isLong__",{value:!0});function jr(n){return(n&&n.__isLong__)===!0}function K7(n){var e=Math.clz32(n&-n);return n?31-e:e}Gi.isLong=jr;var Z7={},Y7={};function Rg(n,e){var t,i,r;return e?(n>>>=0,(r=0<=n&&n<256)&&(i=Y7[n],i)?i:(t=ri(n,0,!0),r&&(Y7[n]=t),t)):(n|=0,(r=-128<=n&&n<128)&&(i=Z7[n],i)?i:(t=ri(n,n<0?-1:0,!1),r&&(Z7[n]=t),t))}Gi.fromInt=Rg;function Ho(n,e){if(isNaN(n))return e?lh:La;if(e){if(n<0)return lh;if(n>=SZ)return DZ}else{if(n<=-Q7)return ks;if(n+1>=Q7)return EZ}return n<0?Ho(-n,e).neg():ri(n%l_|0,n/l_|0,e)}Gi.fromNumber=Ho;function ri(n,e,t){return new Gi(n,e,t)}Gi.fromBits=ri;var Gx=Math.pow;function H4(n,e,t){if(n.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return e?lh:La;if(t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return H4(n.substring(1),e,t).neg();for(var r=Ho(Gx(t,8)),s=La,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=Ho(Gx(t,a));s=s.mul(c).add(Ho(l))}else s=s.mul(r),s=s.add(Ho(l))}return s.unsigned=e,s}Gi.fromString=H4;function tl(n,e){return typeof n=="number"?Ho(n,e):typeof n=="string"?H4(n,e):ri(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Gi.fromValue=tl;var X7=1<<16,yve=1<<24,l_=X7*X7,SZ=l_*l_,Q7=SZ/2,J7=Rg(yve),La=Rg(0);Gi.ZERO=La;var lh=Rg(0,!0);Gi.UZERO=lh;var qp=Rg(1);Gi.ONE=qp;var xZ=Rg(1,!0);Gi.UONE=xZ;var sR=Rg(-1);Gi.NEG_ONE=sR;var EZ=ri(-1,2147483647,!1);Gi.MAX_VALUE=EZ;var DZ=ri(-1,-1,!0);Gi.MAX_UNSIGNED_VALUE=DZ;var ks=ri(0,-2147483648,!1);Gi.MIN_VALUE=ks;var xe=Gi.prototype;xe.toInt=function(){return this.unsigned?this.low>>>0:this.low};xe.toNumber=function(){return this.unsigned?(this.high>>>0)*l_+(this.low>>>0):this.high*l_+(this.low>>>0)};xe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ks)){var t=Ho(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Ho(Gx(e,6),this.unsigned),o=this,a="";;){var l=o.div(s),c=o.sub(l.mul(s)).toInt()>>>0,h=c.toString(e);if(o=l,o.isZero())return h+a;for(;h.length<6;)h="0"+h;a=""+h+a}};xe.getHighBits=function(){return this.high};xe.getHighBitsUnsigned=function(){return this.high>>>0};xe.getLowBits=function(){return this.low};xe.getLowBitsUnsigned=function(){return this.low>>>0};xe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ks)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};xe.isZero=function(){return this.high===0&&this.low===0};xe.eqz=xe.isZero;xe.isNegative=function(){return!this.unsigned&&this.high<0};xe.isPositive=function(){return this.unsigned||this.high>=0};xe.isOdd=function(){return(this.low&1)===1};xe.isEven=function(){return(this.low&1)===0};xe.equals=function(e){return jr(e)||(e=tl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};xe.eq=xe.equals;xe.notEquals=function(e){return!this.eq(e)};xe.neq=xe.notEquals;xe.ne=xe.notEquals;xe.lessThan=function(e){return this.comp(e)<0};xe.lt=xe.lessThan;xe.lessThanOrEqual=function(e){return this.comp(e)<=0};xe.lte=xe.lessThanOrEqual;xe.le=xe.lessThanOrEqual;xe.greaterThan=function(e){return this.comp(e)>0};xe.gt=xe.greaterThan;xe.greaterThanOrEqual=function(e){return this.comp(e)>=0};xe.gte=xe.greaterThanOrEqual;xe.ge=xe.greaterThanOrEqual;xe.compare=function(e){if(jr(e)||(e=tl(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};xe.comp=xe.compare;xe.negate=function(){return!this.unsigned&&this.eq(ks)?ks:this.not().add(qp)};xe.neg=xe.negate;xe.add=function(e){jr(e)||(e=tl(e));var t=this.high>>>16,i=this.high&65535,r=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,h=0,u=0,d=0,f=0;return f+=s+c,d+=f>>>16,f&=65535,d+=r+l,u+=d>>>16,d&=65535,u+=i+a,h+=u>>>16,u&=65535,h+=t+o,h&=65535,ri(d<<16|f,h<<16|u,this.unsigned)};xe.subtract=function(e){return jr(e)||(e=tl(e)),this.add(e.neg())};xe.sub=xe.subtract;xe.multiply=function(e){if(this.isZero())return this;if(jr(e)||(e=tl(e)),zo){var t=zo.mul(this.low,this.high,e.low,e.high);return ri(t,zo.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?lh:La;if(this.eq(ks))return e.isOdd()?ks:La;if(e.eq(ks))return this.isOdd()?ks:La;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(J7)&&e.lt(J7))return Ho(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,h=e.low&65535,u=0,d=0,f=0,g=0;return g+=o*h,f+=g>>>16,g&=65535,f+=s*h,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*h,u+=d>>>16,d&=65535,d+=s*c,u+=d>>>16,d&=65535,d+=o*l,u+=d>>>16,d&=65535,u+=i*h+r*c+s*l+o*a,u&=65535,ri(f<<16|g,u<<16|d,this.unsigned)};xe.mul=xe.multiply;xe.divide=function(e){if(jr(e)||(e=tl(e)),e.isZero())throw Error("division by zero");if(zo){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?zo.div_u:zo.div_s)(this.low,this.high,e.low,e.high);return ri(t,zo.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?lh:La;var i,r,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return lh;if(e.gt(this.shru(1)))return xZ;s=lh}else{if(this.eq(ks)){if(e.eq(qp)||e.eq(sR))return ks;if(e.eq(ks))return qp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(La)?e.isNegative()?qp:sR:(r=this.sub(e.mul(i)),s=i.add(r.div(e)),s)}else if(e.eq(ks))return this.unsigned?lh:La;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=La}for(r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:Gx(2,a-48),c=Ho(i),h=c.mul(e);h.isNegative()||h.gt(r);)i-=l,c=Ho(i,this.unsigned),h=c.mul(e);c.isZero()&&(c=qp),s=s.add(c),r=r.sub(h)}return s};xe.div=xe.divide;xe.modulo=function(e){if(jr(e)||(e=tl(e)),zo){var t=(this.unsigned?zo.rem_u:zo.rem_s)(this.low,this.high,e.low,e.high);return ri(t,zo.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};xe.mod=xe.modulo;xe.rem=xe.modulo;xe.not=function(){return ri(~this.low,~this.high,this.unsigned)};xe.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};xe.clz=xe.countLeadingZeros;xe.countTrailingZeros=function(){return this.low?K7(this.low):K7(this.high)+32};xe.ctz=xe.countTrailingZeros;xe.and=function(e){return jr(e)||(e=tl(e)),ri(this.low&e.low,this.high&e.high,this.unsigned)};xe.or=function(e){return jr(e)||(e=tl(e)),ri(this.low|e.low,this.high|e.high,this.unsigned)};xe.xor=function(e){return jr(e)||(e=tl(e)),ri(this.low^e.low,this.high^e.high,this.unsigned)};xe.shiftLeft=function(e){return jr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ri(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ri(0,this.low<<e-32,this.unsigned)};xe.shl=xe.shiftLeft;xe.shiftRight=function(e){return jr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ri(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ri(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};xe.shr=xe.shiftRight;xe.shiftRightUnsigned=function(e){return jr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?ri(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?ri(this.high,0,this.unsigned):ri(this.high>>>e-32,0,this.unsigned)};xe.shru=xe.shiftRightUnsigned;xe.shr_u=xe.shiftRightUnsigned;xe.rotateLeft=function(e){var t;return jr(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ri(this.high,this.low,this.unsigned):e<32?(t=32-e,ri(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,ri(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};xe.rotl=xe.rotateLeft;xe.rotateRight=function(e){var t;return jr(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?ri(this.high,this.low,this.unsigned):e<32?(t=32-e,ri(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,ri(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};xe.rotr=xe.rotateRight;xe.toSigned=function(){return this.unsigned?ri(this.low,this.high,!1):this};xe.toUnsigned=function(){return this.unsigned?this:ri(this.low,this.high,!0)};xe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};xe.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};xe.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Gi.fromBytes=function(e,t,i){return i?Gi.fromBytesLE(e,t):Gi.fromBytesBE(e,t)};Gi.fromBytesLE=function(e,t){return new Gi(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Gi.fromBytesBE=function(e,t){return new Gi(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};function e9(n,e){return n.offset+n.lineBytes*Math.floor(e/n.lineLength)+e%n.lineLength}async function Cve(n,e){const t=await n.readFile(e);if(!(t&&t.length))throw new Error("No data read from FASTA index (FAI) file");let i=0,r;const s=t.toString("utf8").split(/\r?\n/).filter(o=>/\S/.test(o)).map(o=>o.split("	")).filter(o=>o[0]!=="").map(o=>((!r||r.name!==o[0])&&(r={name:o[0],id:i},i+=1),{id:r.id,name:o[0],length:+o[1],start:0,end:+o[1],offset:+o[2],lineLength:+o[3],lineBytes:+o[4]}));return{name:Object.fromEntries(s.map(o=>[o.name,o])),id:Object.fromEntries(s.map(o=>[o.id,o]))}}class Sve{constructor({fasta:e,fai:t,path:i,faiPath:r,chunkSizeLimit:s=1e6}){if(e)this.fasta=e;else if(i)this.fasta=new no(i);else throw new Error("Need to pass filehandle for fasta or path to localfile");if(t)this.fai=t;else if(r)this.fai=new no(r);else if(i)this.fai=new no(`${i}.fai`);else throw new Error("Need to pass filehandle for  or path to localfile");this.chunkSizeLimit=s}async _getIndexes(e){return this.indexes||(this.indexes=Cve(this.fai,e)),this.indexes}async getSequenceNames(e){return Object.keys((await this._getIndexes(e)).name)}async getSequenceSizes(e){const t={},i=await this._getIndexes(e),r=Object.values(i.id);for(let s=0;s<r.length;s+=1)t[r[s].name]=r[s].length;return t}async getSequenceSize(e,t){var i;return(i=(await this._getIndexes(t)).name[e])===null||i===void 0?void 0:i.length}async hasReferenceSequence(e,t){return!!(await this._getIndexes(t)).name[e]}async getResiduesById(e,t,i,r){const s=(await this._getIndexes(r)).id[e];if(s)return this._fetchFromIndexEntry(s,t,i,r)}async getResiduesByName(e,t,i,r){const s=(await this._getIndexes(r)).name[e];if(s)return this._fetchFromIndexEntry(s,t,i,r)}async getSequence(e,t,i,r){return this.getResiduesByName(e,t,i,r)}async _fetchFromIndexEntry(e,t=0,i,r){let s=i;if(t<0)throw new TypeError("regionStart cannot be less than 0");if((s===void 0||s>e.length)&&(s=e.length),t>=s)return"";const o=e9(e,t),a=e9(e,s)-o;if(a>this.chunkSizeLimit)throw new Error(`data size of ${a.toLocaleString()} bytes exceeded chunk size limit of ${this.chunkSizeLimit.toLocaleString()} bytes`);const l=Buffer.allocUnsafe(a);return await this.fasta.read(l,0,a,o,r),l.toString("utf8").replace(/\s+/g,"")}}function ey(n){return class extends n{constructor(){super(...arguments);dr(this,"lastQuantizedInterval",[0,0])}quantizeInterval(i,r){return[Math.max(Math.floor(i[0]/r-1)*r,0),Math.min(Math.ceil(i[1]/r+1)*r,this.genome.totalSize)]}checkAndUpdateLastInterval(i){return Tx(this.lastQuantizedInterval,i)?!1:(this.lastQuantizedInterval=i,!0)}}}function ty(n,e){return!e||/^(data:|([A-Za-z]+:)?\/\/)/.test(n)||n.startsWith("/")?n:(e.endsWith("/")||(e+="/"),e+n)}typeof window<"u"&&(window.Buffer=vr.Buffer);class xve extends ey(Ig){constructor(e,t){const i={channel:"x",windowSize:7e3,...e};if(super(t,i.channel),this.params=i,!this.params.url)throw new Error("No URL provided for IndexedFastaSource");const r=s=>new Vl(ty(s,this.view.getBaseUrl()));this.fasta=new Sve({fasta:r(this.params.url),fai:r(this.params.indexUrl??this.params.url+".fai")})}async onDomainChanged(e){const t=this.params.windowSize;if(e[1]-e[0]>t)return;const i=this.quantizeInterval(e,t);if(this.checkAndUpdateLastInterval(i)){const r=this.genome.continuousToDiscreteChromosomeIntervals(i),s=await Promise.all(r.map(o=>this.fasta.getSequence(o.chrom,o.startPos,o.endPos).then(a=>({chrom:o.chrom,start:o.startPos,sequence:a}))));this.publishData(s)}}}const Bk=BigInt(32);function Eve(n,e,t){const i=+!!t,r=+!t;return BigInt(n.getInt32(e,t)*r+n.getInt32(e+4,t)*i)<<Bk|BigInt(n.getUint32(e,t)*i+n.getUint32(e+4,t)*r)}function Dve(n,e,t){const i=n.getUint32(e,t),r=n.getUint32(e+4,t),s=+!!t,o=+!t;return BigInt(i*o+r*s)<<Bk|BigInt(i*s+r*o)}function kve(n,e,t,i){const r=Number(t>>Bk),s=Number(t&BigInt(4294967295));i?(n.setInt32(e+4,r,i),n.setUint32(e,s,i)):(n.setInt32(e,r,i),n.setUint32(e+4,s,i))}function Lve(n,e,t,i){const r=Number(t>>Bk),s=Number(t&BigInt(4294967295));i?(n.setUint32(e+4,r,i),n.setUint32(e,s,i)):(n.setUint32(e,r,i),n.setUint32(e+4,s,i))}"getBigInt64"in DataView||(DataView.prototype.getBigInt64=function(n,e){return Eve(this,n,e)});"getBigUint64"in DataView||(DataView.prototype.getBigUint64=function(n,e){return Dve(this,n,e)});"setBigInt64"in DataView||(DataView.prototype.setBigInt64=function(n,e,t){kve(this,n,e,t)});"setBigUint64"in DataView||(DataView.prototype.setBigUint64=function(n,e,t){Lve(this,n,e,t)});let Ive=class{constructor(e,t){this.code="",this.scopes=[["vars"]],this.bitFields=[],this.tmpVariableCount=0,this.references=new Map,this.imports=[],this.reverseImports=new Map,this.useContextVariables=!1,this.importPath=e,this.useContextVariables=t}generateVariable(e){const t=[...this.scopes[this.scopes.length-1]];return e&&t.push(e),t.join(".")}generateOption(e){switch(typeof e){case"number":return e.toString();case"string":return this.generateVariable(e);case"function":return`${this.addImport(e)}.call(${this.generateVariable()}, vars)`}}generateError(e){this.pushCode(`throw new Error(${e});`)}generateTmpVariable(){return"$tmp"+this.tmpVariableCount++}pushCode(e){this.code+=e+`
`}pushPath(e){e&&this.scopes[this.scopes.length-1].push(e)}popPath(e){e&&this.scopes[this.scopes.length-1].pop()}pushScope(e){this.scopes.push([e])}popScope(){this.scopes.pop()}addImport(e){if(!this.importPath)return`(${e})`;let t=this.reverseImports.get(e);return t||(t=this.imports.push(e)-1,this.reverseImports.set(e,t)),`${this.importPath}[${t}]`}addReference(e){this.references.has(e)||this.references.set(e,{resolved:!1,requested:!1})}markResolved(e){const t=this.references.get(e);t&&(t.resolved=!0)}markRequested(e){e.forEach(t=>{const i=this.references.get(t);i&&(i.requested=!0)})}getUnresolvedReferences(){return Array.from(this.references).filter(([e,t])=>!t.resolved&&!t.requested).map(([e,t])=>e)}};const fa=new Map,Sd="___parser_",ga={uint8:1,uint16le:2,uint16be:2,uint32le:4,uint32be:4,int8:1,int16le:2,int16be:2,int32le:4,int32be:4,int64be:8,int64le:8,uint64be:8,uint64le:8,floatle:4,floatbe:4,doublele:8,doublebe:8},iC={uint8:"Uint8",uint16le:"Uint16",uint16be:"Uint16",uint32le:"Uint32",uint32be:"Uint32",int8:"Int8",int16le:"Int16",int16be:"Int16",int32le:"Int32",int32be:"Int32",int64be:"BigInt64",int64le:"BigInt64",uint64be:"BigUint64",uint64le:"BigUint64",floatle:"Float32",floatbe:"Float32",doublele:"Float64",doublebe:"Float64"},nC={uint8:!1,uint16le:!0,uint16be:!1,uint32le:!0,uint32be:!1,int8:!1,int16le:!0,int16be:!1,int32le:!0,int32be:!1,int64be:!1,int64le:!0,uint64be:!1,uint64le:!0,floatle:!0,floatbe:!1,doublele:!0,doublebe:!1};let gi=class pa{constructor(){this.varName="",this.type="",this.options={},this.endian="be",this.useContextVariables=!1}static start(){return new pa}primitiveGenerateN(e,t){const i=iC[e],r=nC[e];t.pushCode(`${t.generateVariable(this.varName)} = dataView.get${i}(offset, ${r});`),t.pushCode(`offset += ${ga[e]};`)}primitiveN(e,t,i){return this.setNextParser(e,t,i)}useThisEndian(e){return e+this.endian.toLowerCase()}uint8(e,t={}){return this.primitiveN("uint8",e,t)}uint16(e,t={}){return this.primitiveN(this.useThisEndian("uint16"),e,t)}uint16le(e,t={}){return this.primitiveN("uint16le",e,t)}uint16be(e,t={}){return this.primitiveN("uint16be",e,t)}uint32(e,t={}){return this.primitiveN(this.useThisEndian("uint32"),e,t)}uint32le(e,t={}){return this.primitiveN("uint32le",e,t)}uint32be(e,t={}){return this.primitiveN("uint32be",e,t)}int8(e,t={}){return this.primitiveN("int8",e,t)}int16(e,t={}){return this.primitiveN(this.useThisEndian("int16"),e,t)}int16le(e,t={}){return this.primitiveN("int16le",e,t)}int16be(e,t={}){return this.primitiveN("int16be",e,t)}int32(e,t={}){return this.primitiveN(this.useThisEndian("int32"),e,t)}int32le(e,t={}){return this.primitiveN("int32le",e,t)}int32be(e,t={}){return this.primitiveN("int32be",e,t)}bigIntVersionCheck(){if(!DataView.prototype.getBigInt64)throw new Error("BigInt64 is unsupported on this runtime")}int64(e,t={}){return this.bigIntVersionCheck(),this.primitiveN(this.useThisEndian("int64"),e,t)}int64be(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("int64be",e,t)}int64le(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("int64le",e,t)}uint64(e,t={}){return this.bigIntVersionCheck(),this.primitiveN(this.useThisEndian("uint64"),e,t)}uint64be(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("uint64be",e,t)}uint64le(e,t={}){return this.bigIntVersionCheck(),this.primitiveN("uint64le",e,t)}floatle(e,t={}){return this.primitiveN("floatle",e,t)}floatbe(e,t={}){return this.primitiveN("floatbe",e,t)}doublele(e,t={}){return this.primitiveN("doublele",e,t)}doublebe(e,t={}){return this.primitiveN("doublebe",e,t)}bitN(e,t,i){return i.length=e,this.setNextParser("bit",t,i)}bit1(e,t={}){return this.bitN(1,e,t)}bit2(e,t={}){return this.bitN(2,e,t)}bit3(e,t={}){return this.bitN(3,e,t)}bit4(e,t={}){return this.bitN(4,e,t)}bit5(e,t={}){return this.bitN(5,e,t)}bit6(e,t={}){return this.bitN(6,e,t)}bit7(e,t={}){return this.bitN(7,e,t)}bit8(e,t={}){return this.bitN(8,e,t)}bit9(e,t={}){return this.bitN(9,e,t)}bit10(e,t={}){return this.bitN(10,e,t)}bit11(e,t={}){return this.bitN(11,e,t)}bit12(e,t={}){return this.bitN(12,e,t)}bit13(e,t={}){return this.bitN(13,e,t)}bit14(e,t={}){return this.bitN(14,e,t)}bit15(e,t={}){return this.bitN(15,e,t)}bit16(e,t={}){return this.bitN(16,e,t)}bit17(e,t={}){return this.bitN(17,e,t)}bit18(e,t={}){return this.bitN(18,e,t)}bit19(e,t={}){return this.bitN(19,e,t)}bit20(e,t={}){return this.bitN(20,e,t)}bit21(e,t={}){return this.bitN(21,e,t)}bit22(e,t={}){return this.bitN(22,e,t)}bit23(e,t={}){return this.bitN(23,e,t)}bit24(e,t={}){return this.bitN(24,e,t)}bit25(e,t={}){return this.bitN(25,e,t)}bit26(e,t={}){return this.bitN(26,e,t)}bit27(e,t={}){return this.bitN(27,e,t)}bit28(e,t={}){return this.bitN(28,e,t)}bit29(e,t={}){return this.bitN(29,e,t)}bit30(e,t={}){return this.bitN(30,e,t)}bit31(e,t={}){return this.bitN(31,e,t)}bit32(e,t={}){return this.bitN(32,e,t)}namely(e){return fa.set(e,this),this.alias=e,this}skip(e,t={}){return this.seek(e,t)}seek(e,t={}){if(t.assert)throw new Error("assert option on seek is not allowed.");return this.setNextParser("seek","",{length:e})}string(e,t){if(!t.zeroTerminated&&!t.length&&!t.greedy)throw new Error("One of length, zeroTerminated, or greedy must be defined for string.");if((t.zeroTerminated||t.length)&&t.greedy)throw new Error("greedy is mutually exclusive with length and zeroTerminated for string.");if(t.stripNull&&!(t.length||t.greedy))throw new Error("length or greedy must be defined if stripNull is enabled.");return t.encoding=t.encoding||"utf8",this.setNextParser("string",e,t)}buffer(e,t){if(!t.length&&!t.readUntil)throw new Error("length or readUntil must be defined for buffer.");return this.setNextParser("buffer",e,t)}wrapped(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t||!t.wrapper||!t.type)throw new Error("Both wrapper and type must be defined for wrapped.");if(!t.length&&!t.readUntil)throw new Error("length or readUntil must be defined for wrapped.");return this.setNextParser("wrapper",e,t)}array(e,t){if(!t.readUntil&&!t.length&&!t.lengthInBytes)throw new Error("One of readUntil, length and lengthInBytes must be defined for array.");if(!t.type)throw new Error("type is required for array.");if(typeof t.type=="string"&&!fa.has(t.type)&&!(t.type in ga))throw new Error(`Array element type "${t.type}" is unkown.`);return this.setNextParser("array",e,t)}choice(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t)throw new Error("tag and choices are are required for choice.");if(!t.tag)throw new Error("tag is requird for choice.");if(!t.choices)throw new Error("choices is required for choice.");for(const i in t.choices){const r=parseInt(i,10),s=t.choices[r];if(isNaN(r))throw new Error(`Choice key "${i}" is not a number.`);if(typeof s=="string"&&!fa.has(s)&&!(s in ga))throw new Error(`Choice type "${s}" is unkown.`)}return this.setNextParser("choice",e,t)}nest(e,t){if(typeof t!="object"&&typeof e=="object"&&(t=e,e=""),!t||!t.type)throw new Error("type is required for nest.");if(!(t.type instanceof pa)&&!fa.has(t.type))throw new Error("type must be a known parser name or a Parser object.");if(!(t.type instanceof pa)&&!e)throw new Error("type must be a Parser object if the variable name is omitted.");return this.setNextParser("nest",e,t)}pointer(e,t){if(!t.offset)throw new Error("offset is required for pointer.");if(!t.type)throw new Error("type is required for pointer.");if(typeof t.type=="string"&&!(t.type in ga)&&!fa.has(t.type))throw new Error(`Pointer type "${t.type}" is unkown.`);return this.setNextParser("pointer",e,t)}saveOffset(e,t={}){return this.setNextParser("saveOffset",e,t)}endianness(e){switch(e.toLowerCase()){case"little":this.endian="le";break;case"big":this.endian="be";break;default:throw new Error('endianness must be one of "little" or "big"')}return this}endianess(e){return this.endianness(e)}useContextVars(e=!0){return this.useContextVariables=e,this}create(e){if(!(e instanceof Function))throw new Error("Constructor must be a Function object.");return this.constructorFn=e,this}getContext(e){const t=new Ive(e,this.useContextVariables);return t.pushCode("var dataView = new DataView(buffer.buffer, buffer.byteOffset, buffer.length);"),this.alias?(this.addAliasedCode(t),t.pushCode(`return ${Sd+this.alias}(0).result;`)):this.addRawCode(t),t}getCode(){const e="imports";return this.getContext(e).code}addRawCode(e){e.pushCode("var offset = 0;"),e.pushCode(`var vars = ${this.constructorFn?"new constructorFn()":"{}"};`),e.pushCode("vars.$parent = null;"),e.pushCode("vars.$root = vars;"),this.generate(e),this.resolveReferences(e),e.pushCode("delete vars.$parent;"),e.pushCode("delete vars.$root;"),e.pushCode("return vars;")}addAliasedCode(e){return e.pushCode(`function ${Sd+this.alias}(offset, context) {`),e.pushCode(`var vars = ${this.constructorFn?"new constructorFn()":"{}"};`),e.pushCode("var ctx = Object.assign({$parent: null, $root: vars}, context || {});"),e.pushCode("vars = Object.assign(vars, ctx);"),this.generate(e),e.markResolved(this.alias),this.resolveReferences(e),e.pushCode("Object.keys(ctx).forEach(function (item) { delete vars[item]; });"),e.pushCode("return { offset: offset, result: vars };"),e.pushCode("}"),e}resolveReferences(e){const t=e.getUnresolvedReferences();e.markRequested(t),t.forEach(i=>{var r;(r=fa.get(i))===null||r===void 0||r.addAliasedCode(e)})}compile(){const e="imports",t=this.getContext(e);this.compiled=new Function(e,"TextDecoder",`return function (buffer, constructorFn) { ${t.code} };`)(t.imports,TextDecoder)}sizeOf(){let e=NaN;if(Object.keys(ga).indexOf(this.type)>=0)e=ga[this.type];else if(this.type==="string"&&typeof this.options.length=="number")e=this.options.length;else if(this.type==="buffer"&&typeof this.options.length=="number")e=this.options.length;else if(this.type==="array"&&typeof this.options.length=="number"){let t=NaN;typeof this.options.type=="string"?t=ga[this.options.type]:this.options.type instanceof pa&&(t=this.options.type.sizeOf()),e=this.options.length*t}else this.type==="seek"?e=this.options.length:this.type==="nest"?e=this.options.type.sizeOf():this.type||(e=0);return this.next&&(e+=this.next.sizeOf()),e}parse(e){return this.compiled||this.compile(),this.compiled(e,this.constructorFn)}setNextParser(e,t,i){const r=new pa;return r.type=e,r.varName=t,r.options=i,r.endian=this.endian,this.head?this.head.next=r:this.next=r,this.head=r,this}generate(e){if(this.type){switch(this.type){case"uint8":case"uint16le":case"uint16be":case"uint32le":case"uint32be":case"int8":case"int16le":case"int16be":case"int32le":case"int32be":case"int64be":case"int64le":case"uint64be":case"uint64le":case"floatle":case"floatbe":case"doublele":case"doublebe":this.primitiveGenerateN(this.type,e);break;case"bit":this.generateBit(e);break;case"string":this.generateString(e);break;case"buffer":this.generateBuffer(e);break;case"seek":this.generateSeek(e);break;case"nest":this.generateNest(e);break;case"array":this.generateArray(e);break;case"choice":this.generateChoice(e);break;case"pointer":this.generatePointer(e);break;case"saveOffset":this.generateSaveOffset(e);break;case"wrapper":this.generateWrapper(e);break}this.type!=="bit"&&this.generateAssert(e)}const t=e.generateVariable(this.varName);return this.options.formatter&&this.type!=="bit"&&this.generateFormatter(e,t,this.options.formatter),this.generateNext(e)}generateAssert(e){if(!this.options.assert)return;const t=e.generateVariable(this.varName);switch(typeof this.options.assert){case"function":{const i=e.addImport(this.options.assert);e.pushCode(`if (!${i}.call(vars, ${t})) {`)}break;case"number":e.pushCode(`if (${this.options.assert} !== ${t}) {`);break;case"string":e.pushCode(`if (${JSON.stringify(this.options.assert)} !== ${t}) {`);break;default:throw new Error("assert option must be a string, number or a function.")}e.generateError(`"Assertion error: ${t} is " + ${JSON.stringify(this.options.assert.toString())}`),e.pushCode("}")}generateNext(e){return this.next&&(e=this.next.generate(e)),e}generateBit(e){const t=JSON.parse(JSON.stringify(this));if(t.options=this.options,t.generateAssert=this.generateAssert.bind(this),t.generateFormatter=this.generateFormatter.bind(this),t.varName=e.generateVariable(t.varName),e.bitFields.push(t),!this.next||this.next&&["bit","nest"].indexOf(this.next.type)<0){const i=e.generateTmpVariable();e.pushCode(`var ${i} = 0;`);const r=(h=0)=>{let u=0;for(let d=h;d<e.bitFields.length;d++){const f=e.bitFields[d].options.length;if(u+f>32)break;u+=f}return u},s=h=>(h<=8?(e.pushCode(`${i} = dataView.getUint8(offset);`),h=8):h<=16?(e.pushCode(`${i} = dataView.getUint16(offset);`),h=16):h<=24?(e.pushCode(`${i} = (dataView.getUint16(offset) << 8) | dataView.getUint8(offset + 2);`),h=24):(e.pushCode(`${i} = dataView.getUint32(offset);`),h=32),e.pushCode(`offset += ${h/8};`),h);let o=0;const a=this.endian==="be";let l=0,c=0;e.bitFields.forEach((h,u)=>{let d=h.options.length;if(d>c){if(c){const p=-1>>>32-c;e.pushCode(`${h.varName} = (${i} & 0x${p.toString(16)}) << ${d-c};`),d-=c}o=0,c=l=s(r(u)-c)}const f=a?l-o-d:o,g=-1>>>32-d;e.pushCode(`${h.varName} ${d<h.options.length?"|=":"="} ${i} >> ${f} & 0x${g.toString(16)};`),h.options.length===32&&e.pushCode(`${h.varName} >>>= 0`),h.options.assert&&h.generateAssert(e),h.options.formatter&&h.generateFormatter(e,h.varName,h.options.formatter),o+=d,c-=d}),e.bitFields=[]}}generateSeek(e){const t=e.generateOption(this.options.length);e.pushCode(`offset += ${t};`)}generateString(e){const t=e.generateVariable(this.varName),i=e.generateTmpVariable(),r=this.options.encoding,s=r.toLowerCase()==="hex",o='b => b.toString(16).padStart(2, "0")';if(this.options.length&&this.options.zeroTerminated){const a=this.options.length;e.pushCode(`var ${i} = offset;`),e.pushCode(`while(dataView.getUint8(offset++) !== 0 && offset - ${i} < ${a});`);const l=`offset - ${i} < ${a} ? offset - 1 : offset`;e.pushCode(s?`${t} = Array.from(buffer.subarray(${i}, ${l}), ${o}).join('');`:`${t} = new TextDecoder('${r}').decode(buffer.subarray(${i}, ${l}));`)}else if(this.options.length){const a=e.generateOption(this.options.length);e.pushCode(s?`${t} = Array.from(buffer.subarray(offset, offset + ${a}), ${o}).join('');`:`${t} = new TextDecoder('${r}').decode(buffer.subarray(offset, offset + ${a}));`),e.pushCode(`offset += ${a};`)}else this.options.zeroTerminated?(e.pushCode(`var ${i} = offset;`),e.pushCode("while(dataView.getUint8(offset++) !== 0);"),e.pushCode(s?`${t} = Array.from(buffer.subarray(${i}, offset - 1), ${o}).join('');`:`${t} = new TextDecoder('${r}').decode(buffer.subarray(${i}, offset - 1));`)):this.options.greedy&&(e.pushCode(`var ${i} = offset;`),e.pushCode("while(buffer.length > offset++);"),e.pushCode(s?`${t} = Array.from(buffer.subarray(${i}, offset), ${o}).join('');`:`${t} = new TextDecoder('${r}').decode(buffer.subarray(${i}, offset));`));this.options.stripNull&&e.pushCode(`${t} = ${t}.replace(/\\x00+$/g, '')`)}generateBuffer(e){const t=e.generateVariable(this.varName);if(typeof this.options.readUntil=="function"){const i=this.options.readUntil,r=e.generateTmpVariable(),s=e.generateTmpVariable();e.pushCode(`var ${r} = offset;`),e.pushCode(`var ${s} = 0;`),e.pushCode("while (offset < buffer.length) {"),e.pushCode(`${s} = dataView.getUint8(offset);`);const o=e.addImport(i);e.pushCode(`if (${o}.call(${e.generateVariable()}, ${s}, buffer.subarray(offset))) break;`),e.pushCode("offset += 1;"),e.pushCode("}"),e.pushCode(`${t} = buffer.subarray(${r}, offset);`)}else if(this.options.readUntil==="eof")e.pushCode(`${t} = buffer.subarray(offset);`);else{const i=e.generateOption(this.options.length);e.pushCode(`${t} = buffer.subarray(offset, offset + ${i});`),e.pushCode(`offset += ${i};`)}this.options.clone&&e.pushCode(`${t} = buffer.constructor.from(${t});`)}generateArray(e){const t=e.generateOption(this.options.length),i=e.generateOption(this.options.lengthInBytes),r=this.options.type,s=e.generateTmpVariable(),o=e.generateVariable(this.varName),a=e.generateTmpVariable(),l=this.options.key,c=typeof l=="string";if(c?e.pushCode(`${o} = {};`):e.pushCode(`${o} = [];`),typeof this.options.readUntil=="function"?e.pushCode("do {"):this.options.readUntil==="eof"?e.pushCode(`for (var ${s} = 0; offset < buffer.length; ${s}++) {`):i!==void 0?e.pushCode(`for (var ${s} = offset + ${i}; offset < ${s}; ) {`):e.pushCode(`for (var ${s} = ${t}; ${s} > 0; ${s}--) {`),typeof r=="string")if(fa.get(r)){const h=e.generateTmpVariable();if(e.pushCode(`var ${h} = ${Sd+r}(offset, {`),e.useContextVariables){const u=e.generateVariable();e.pushCode(`$parent: ${u},`),e.pushCode(`$root: ${u}.$root,`),!this.options.readUntil&&i===void 0&&e.pushCode(`$index: ${t} - ${s},`)}e.pushCode("});"),e.pushCode(`var ${a} = ${h}.result; offset = ${h}.offset;`),r!==this.alias&&e.addReference(r)}else{const h=iC[r],u=nC[r];e.pushCode(`var ${a} = dataView.get${h}(offset, ${u});`),e.pushCode(`offset += ${ga[r]};`)}else if(r instanceof pa){e.pushCode(`var ${a} = {};`);const h=e.generateVariable();e.pushScope(a),e.useContextVariables&&(e.pushCode(`${a}.$parent = ${h};`),e.pushCode(`${a}.$root = ${h}.$root;`),!this.options.readUntil&&i===void 0&&e.pushCode(`${a}.$index = ${t} - ${s};`)),r.generate(e),e.useContextVariables&&(e.pushCode(`delete ${a}.$parent;`),e.pushCode(`delete ${a}.$root;`),e.pushCode(`delete ${a}.$index;`)),e.popScope()}if(c?e.pushCode(`${o}[${a}.${l}] = ${a};`):e.pushCode(`${o}.push(${a});`),e.pushCode("}"),typeof this.options.readUntil=="function"){const h=this.options.readUntil,u=e.addImport(h);e.pushCode(`while (!${u}.call(${e.generateVariable()}, ${a}, buffer.subarray(offset)));`)}}generateChoiceCase(e,t,i){if(typeof i=="string"){const r=e.generateVariable(this.varName);if(fa.has(i)){const s=e.generateTmpVariable();e.pushCode(`var ${s} = ${Sd+i}(offset, {`),e.useContextVariables&&(e.pushCode(`$parent: ${r}.$parent,`),e.pushCode(`$root: ${r}.$root,`)),e.pushCode("});"),e.pushCode(`${r} = ${s}.result; offset = ${s}.offset;`),i!==this.alias&&e.addReference(i)}else{const s=iC[i],o=nC[i];e.pushCode(`${r} = dataView.get${s}(offset, ${o});`),e.pushCode(`offset += ${ga[i]}`)}}else i instanceof pa&&(e.pushPath(t),i.generate(e),e.popPath(t))}generateChoice(e){const t=e.generateOption(this.options.tag),i=e.generateVariable(this.varName);if(this.varName&&(e.pushCode(`${i} = {};`),e.useContextVariables)){const r=e.generateVariable();e.pushCode(`${i}.$parent = ${r};`),e.pushCode(`${i}.$root = ${r}.$root;`)}e.pushCode(`switch(${t}) {`);for(const r in this.options.choices){const s=parseInt(r,10),o=this.options.choices[s];e.pushCode(`case ${s}:`),this.generateChoiceCase(e,this.varName,o),e.pushCode("break;")}e.pushCode("default:"),this.options.defaultChoice?this.generateChoiceCase(e,this.varName,this.options.defaultChoice):e.generateError(`"Met undefined tag value " + ${t} + " at choice"`),e.pushCode("}"),this.varName&&e.useContextVariables&&(e.pushCode(`delete ${i}.$parent;`),e.pushCode(`delete ${i}.$root;`))}generateNest(e){const t=e.generateVariable(this.varName);if(this.options.type instanceof pa){if(this.varName&&(e.pushCode(`${t} = {};`),e.useContextVariables)){const i=e.generateVariable();e.pushCode(`${t}.$parent = ${i};`),e.pushCode(`${t}.$root = ${i}.$root;`)}e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName),this.varName&&e.useContextVariables&&e.useContextVariables&&(e.pushCode(`delete ${t}.$parent;`),e.pushCode(`delete ${t}.$root;`))}else if(fa.has(this.options.type)){const i=e.generateTmpVariable();if(e.pushCode(`var ${i} = ${Sd+this.options.type}(offset, {`),e.useContextVariables){const r=e.generateVariable();e.pushCode(`$parent: ${r},`),e.pushCode(`$root: ${r}.$root,`)}e.pushCode("});"),e.pushCode(`${t} = ${i}.result; offset = ${i}.offset;`),this.options.type!==this.alias&&e.addReference(this.options.type)}}generateWrapper(e){const t=e.generateVariable(this.varName),i=e.generateTmpVariable();if(typeof this.options.readUntil=="function"){const l=this.options.readUntil,c=e.generateTmpVariable(),h=e.generateTmpVariable();e.pushCode(`var ${c} = offset;`),e.pushCode(`var ${h} = 0;`),e.pushCode("while (offset < buffer.length) {"),e.pushCode(`${h} = dataView.getUint8(offset);`);const u=e.addImport(l);e.pushCode(`if (${u}.call(${e.generateVariable()}, ${h}, buffer.subarray(offset))) break;`),e.pushCode("offset += 1;"),e.pushCode("}"),e.pushCode(`${i} = buffer.subarray(${c}, offset);`)}else if(this.options.readUntil==="eof")e.pushCode(`${i} = buffer.subarray(offset);`);else{const l=e.generateOption(this.options.length);e.pushCode(`${i} = buffer.subarray(offset, offset + ${l});`),e.pushCode(`offset += ${l};`)}this.options.clone&&e.pushCode(`${i} = buffer.constructor.from(${i});`);const r=e.generateTmpVariable(),s=e.generateTmpVariable(),o=e.generateTmpVariable(),a=e.addImport(this.options.wrapper);if(e.pushCode(`${i} = ${a}.call(this, ${i}).subarray(0);`),e.pushCode(`var ${r} = buffer;`),e.pushCode(`var ${s} = offset;`),e.pushCode(`var ${o} = dataView;`),e.pushCode(`buffer = ${i};`),e.pushCode("offset = 0;"),e.pushCode("dataView = new DataView(buffer.buffer, buffer.byteOffset, buffer.length);"),this.options.type instanceof pa)this.varName&&e.pushCode(`${t} = {};`),e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName);else if(fa.has(this.options.type)){const l=e.generateTmpVariable();e.pushCode(`var ${l} = ${Sd+this.options.type}(0);`),e.pushCode(`${t} = ${l}.result;`),this.options.type!==this.alias&&e.addReference(this.options.type)}e.pushCode(`buffer = ${r};`),e.pushCode(`dataView = ${o};`),e.pushCode(`offset = ${s};`)}generateFormatter(e,t,i){if(typeof i=="function"){const r=e.addImport(i);e.pushCode(`${t} = ${r}.call(${e.generateVariable()}, ${t});`)}}generatePointer(e){const t=this.options.type,i=e.generateOption(this.options.offset),r=e.generateTmpVariable(),s=e.generateVariable(this.varName);if(e.pushCode(`var ${r} = offset;`),e.pushCode(`offset = ${i};`),this.options.type instanceof pa){if(e.pushCode(`${s} = {};`),e.useContextVariables){const o=e.generateVariable();e.pushCode(`${s}.$parent = ${o};`),e.pushCode(`${s}.$root = ${o}.$root;`)}e.pushPath(this.varName),this.options.type.generate(e),e.popPath(this.varName),e.useContextVariables&&(e.pushCode(`delete ${s}.$parent;`),e.pushCode(`delete ${s}.$root;`))}else if(fa.has(this.options.type)){const o=e.generateTmpVariable();if(e.pushCode(`var ${o} = ${Sd+this.options.type}(offset, {`),e.useContextVariables){const a=e.generateVariable();e.pushCode(`$parent: ${a},`),e.pushCode(`$root: ${a}.$root,`)}e.pushCode("});"),e.pushCode(`${s} = ${o}.result; offset = ${o}.offset;`),this.options.type!==this.alias&&e.addReference(this.options.type)}else if(Object.keys(ga).indexOf(this.options.type)>=0){const o=iC[t],a=nC[t];e.pushCode(`${s} = dataView.get${o}(offset, ${a});`),e.pushCode(`offset += ${ga[t]};`)}e.pushCode(`offset = ${r};`)}generateSaveOffset(e){const t=e.generateVariable(this.varName);e.pushCode(`${t} = offset`)}};var kZ={},U4={},Jf={},iy={};Object.defineProperty(iy,"__esModule",{value:!0});function j4(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function t9(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function q4(n,e,t){return e&&t9(n.prototype,e),t&&t9(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Tve(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&oR(n,e)}function c_(n){return c_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c_(n)}function oR(n,e){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},oR(n,e)}function Ave(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gb(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Nve(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gb(n)}function Rve(n){var e=Ave();return function(){var i=c_(n),r;if(e){var s=c_(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return Nve(this,r)}}function Mve(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&(n=c_(n),n!==null););return n}function SS(){return typeof Reflect<"u"&&Reflect.get?SS=Reflect.get.bind():SS=function(e,t,i){var r=Mve(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(arguments.length<3?e:i):s.value}},SS.apply(this,arguments)}var i9=function(){function n(){j4(this,n),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return q4(n,[{key:"addEventListener",value:function(t,i,r){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push({callback:i,options:r})}},{key:"removeEventListener",value:function(t,i){if(t in this.listeners){for(var r=this.listeners[t],s=0,o=r.length;s<o;s++)if(r[s].callback===i){r.splice(s,1);return}}}},{key:"dispatchEvent",value:function(t){if(t.type in this.listeners){for(var i=this.listeners[t.type],r=i.slice(),s=0,o=r.length;s<o;s++){var a=r[s];try{a.callback.call(this,t)}catch(l){Promise.resolve().then(function(){throw l})}a.options&&a.options.once&&this.removeEventListener(t.type,a.callback)}return!t.defaultPrevented}}}]),n}(),G4=function(n){Tve(t,n);var e=Rve(t);function t(){var i;return j4(this,t),i=e.call(this),i.listeners||i9.call(gb(i)),Object.defineProperty(gb(i),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(gb(i),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(gb(i),"reason",{value:void 0,writable:!0,configurable:!0}),i}return q4(t,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(r){r.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,r)),SS(c_(t.prototype),"dispatchEvent",this).call(this,r)}}]),t}(i9),LZ=function(){function n(){j4(this,n),Object.defineProperty(this,"signal",{value:new G4,writable:!0,configurable:!0})}return q4(n,[{key:"abort",value:function(t){var i;try{i=new Event("abort")}catch{typeof document<"u"?document.createEvent?(i=document.createEvent("Event"),i.initEvent("abort",!1,!1)):(i=document.createEventObject(),i.type="abort"):i={type:"abort",bubbles:!1,cancelable:!1}}var r=t;if(r===void 0)if(typeof document>"u")r=new Error("This operation was aborted"),r.name="AbortError";else try{r=new DOMException("signal is aborted without reason")}catch{r=new Error("This operation was aborted"),r.name="AbortError"}this.signal.reason=r,this.signal.dispatchEvent(i)}},{key:"toString",value:function(){return"[object AbortController]"}}]),n}();typeof Symbol<"u"&&Symbol.toStringTag&&(LZ.prototype[Symbol.toStringTag]="AbortController",G4.prototype[Symbol.toStringTag]="AbortSignal");function Fve(n){return n.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):typeof n.Request=="function"&&!n.Request.prototype.hasOwnProperty("signal")||!n.AbortController}function Ove(n){typeof n=="function"&&(n={fetch:n});var e=n,t=e.fetch,i=e.Request,r=i===void 0?t.Request:i,s=e.AbortController,o=e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=o===void 0?!1:o;if(!Fve({fetch:t,Request:r,AbortController:s,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return{fetch:t,Request:l};var l=r;(l&&!l.prototype.hasOwnProperty("signal")||a)&&(l=function(d,f){var g;f&&f.signal&&(g=f.signal,delete f.signal);var p=new r(d,f);return g&&Object.defineProperty(p,"signal",{writable:!1,enumerable:!1,configurable:!0,value:g}),p},l.prototype=r.prototype);var c=t,h=function(d,f){var g=l&&l.prototype.isPrototypeOf(d)?d.signal:f?f.signal:void 0;if(g){var p;try{p=new DOMException("Aborted","AbortError")}catch{p=new Error("Aborted"),p.name="AbortError"}if(g.aborted)return Promise.reject(p);var m=new Promise(function(b,_){g.addEventListener("abort",function(){return _(p)},{once:!0})});return f&&f.signal&&delete f.signal,Promise.race([m,c(d,f)])}return c(d,f)};return{fetch:h,Request:l}}iy.AbortController=LZ;iy.AbortSignal=G4;iy.abortableFetch=Ove;Object.defineProperty(Jf,"__esModule",{value:!0});Jf.AbortSignal=Jf.AbortController=void 0;const IZ=iy;var Kx=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Ua<"u")return Ua;throw new Error("unable to locate global object")};let Pve=typeof Kx().AbortController>"u"?IZ.AbortController:Kx().AbortController;Jf.AbortController=Pve;let Bve=typeof Kx().AbortController>"u"?IZ.AbortSignal:Kx().AbortSignal;Jf.AbortSignal=Bve;var K4={};Object.defineProperty(K4,"__esModule",{value:!0});const Vve=Jf;class Wve{}class $ve{constructor(){this.signals=new Set,this.abortController=new Vve.AbortController}addSignal(e=new Wve){if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(e),e.aborted?this.handleAborted(e):typeof e.addEventListener=="function"&&e.addEventListener("abort",()=>{this.handleAborted(e)})}handleAborted(e){this.signals.delete(e),this.signals.size===0&&this.abortController.abort()}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}}K4.default=$ve;var Z4={};Object.defineProperty(Z4,"__esModule",{value:!0});class zve{constructor(){this.callbacks=new Set}addCallback(e=()=>{}){this.callbacks.add(e),e(this.currentMessage)}callback(e){this.currentMessage=e,this.callbacks.forEach(t=>{t(e)})}}Z4.default=zve;var TZ=Ua&&Ua.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(U4,"__esModule",{value:!0});const Hve=Jf,Uve=TZ(K4),jve=TZ(Z4);class Zx{constructor({fill:e,cache:t}){if(typeof e!="function")throw new TypeError("must pass a fill function");if(typeof t!="object")throw new TypeError("must pass a cache object");if(typeof t.get!="function"||typeof t.set!="function"||typeof t.delete!="function")throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=t,this.fillCallback=e}static isAbortException(e){return e.name==="AbortError"||e.code==="ERR_ABORTED"||e.message==="AbortError: aborted"||e.message==="Error: aborted"}evict(e,t){this.cache.get(e)===t&&this.cache.delete(e)}fill(e,t,i,r){const s=new Uve.default,o=new jve.default;o.addCallback(r);const a={aborter:s,promise:this.fillCallback(t,s.signal,l=>{o.callback(l)}),settled:!1,statusReporter:o,get aborted(){return this.aborter.signal.aborted}};a.aborter.addSignal(i),a.aborter.signal.addEventListener("abort",()=>{a.settled||this.evict(e,a)}),a.promise.then(()=>{a.settled=!0},()=>{a.settled=!0,this.evict(e,a)}).catch(l=>{throw console.error(l),l}),this.cache.set(e,a)}static checkSinglePromise(e,t){function i(){if(t&&t.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then(r=>(i(),r),r=>{throw i(),r})}has(e){return this.cache.has(e)}get(e,t,i,r){if(!i&&t instanceof Hve.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");const s=this.cache.get(e);return s?s.aborted&&!s.settled?(this.evict(e,s),this.get(e,t,i,r)):s.settled?s.promise:(s.aborter.addSignal(i),s.statusReporter.addCallback(r),Zx.checkSinglePromise(s.promise,i)):(this.fill(e,t,i,r),Zx.checkSinglePromise(this.cache.get(e).promise,i))}delete(e){const t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}clear(){const e=this.cache.keys();let t=0;for(let i=e.next();!i.done;i=e.next())this.delete(i.value),t+=1;return t}}U4.default=Zx;var qve=Ua&&Ua.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(kZ,"__esModule",{value:!0});const Gve=qve(U4);var Vk=kZ.default=Gve.default;let Kve=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return this._size+e}};var Zve=Kve;const Y4=Tg(Zve);let n9=class Fp{constructor(e,t){this.ranges=arguments.length===2?[{min:e,max:t}]:0 in e?Object.assign({},e):[e]}min(){return this.ranges[0].min}max(){return this.ranges[this.ranges.length-1].max}contains(e){for(let t=0;t<this.ranges.length;t+=1){const i=this.ranges[t];if(i.min<=e&&i.max>=e)return!0}return!1}isContiguous(){return this.ranges.length>1}getRanges(){return this.ranges.map(e=>new Fp(e.min,e.max))}toString(){return this.ranges.map(e=>`[${e.min}-${e.max}]`).join(",")}union(e){const t=this.getRanges().concat(e.getRanges()).sort(this.rangeOrder),i=[];let r=t[0];for(let s=1;s<t.length;s+=1){const o=t[s];o.min()>r.max()+1?(i.push(r),r=o):o.max()>r.max()&&(r=new Fp(r.min(),o.max()))}return i.push(r),i.length===1?i[0]:new Fp(i)}intersection(e){let t=this,i=e;const r=this.ranges(),s=i.ranges(),o=r.length,a=s.length;let l=0,c=0;const h=[];for(;l<o&&c<a;){t=r[l],i=s[c];const u=Math.max(t.min(),i.min()),d=Math.min(t.max(),i.max());d>=u&&h.push(new Fp(u,d)),t.max()>i.max()?c+=1:l+=1}if(h.length===0)throw new Error("found range of length 0");return h.length===1?h[0]:new Fp(h)}coverage(){let e=0;const t=this.ranges();for(const i of t)e+=i.max()-i.min()+1;return e}rangeOrder(e,t){let i=e,r=t;return arguments.length<2&&(r=i,i=this),i.min()<r.min()?-1:i.min()>r.min()?1:i.max()<r.max()?-1:r.max()>i.max()?1:0}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Yve=4,r9=0,s9=1,Xve=2;function o0(n){let e=n.length;for(;--e>=0;)n[e]=0}const Qve=0,AZ=1,Jve=2,ewe=3,twe=258,X4=29,ny=256,iw=ny+1+X4,pm=30,Q4=19,NZ=2*iw+1,nf=15,lI=16,iwe=7,J4=256,RZ=16,MZ=17,FZ=18,aR=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),xS=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),nwe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),OZ=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rwe=512,Hc=new Array((iw+2)*2);o0(Hc);const jb=new Array(pm*2);o0(jb);const nw=new Array(rwe);o0(nw);const rw=new Array(twe-ewe+1);o0(rw);const e3=new Array(X4);o0(e3);const Yx=new Array(pm);o0(Yx);function cI(n,e,t,i,r){this.static_tree=n,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=r,this.has_stree=n&&n.length}let PZ,BZ,VZ;function hI(n,e){this.dyn_tree=n,this.max_code=0,this.stat_desc=e}const WZ=n=>n<256?nw[n]:nw[256+(n>>>7)],sw=(n,e)=>{n.pending_buf[n.pending++]=e&255,n.pending_buf[n.pending++]=e>>>8&255},Ls=(n,e,t)=>{n.bi_valid>lI-t?(n.bi_buf|=e<<n.bi_valid&65535,sw(n,n.bi_buf),n.bi_buf=e>>lI-n.bi_valid,n.bi_valid+=t-lI):(n.bi_buf|=e<<n.bi_valid&65535,n.bi_valid+=t)},Rl=(n,e,t)=>{Ls(n,t[e*2],t[e*2+1])},$Z=(n,e)=>{let t=0;do t|=n&1,n>>>=1,t<<=1;while(--e>0);return t>>>1},swe=n=>{n.bi_valid===16?(sw(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},owe=(n,e)=>{const t=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let c,h,u,d,f,g,p=0;for(d=0;d<=nf;d++)n.bl_count[d]=0;for(t[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<NZ;c++)h=n.heap[c],d=t[t[h*2+1]*2+1]+1,d>l&&(d=l,p++),t[h*2+1]=d,!(h>i)&&(n.bl_count[d]++,f=0,h>=a&&(f=o[h-a]),g=t[h*2],n.opt_len+=g*(d+f),s&&(n.static_len+=g*(r[h*2+1]+f)));if(p!==0){do{for(d=l-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[l]--,p-=2}while(p>0);for(d=l;d!==0;d--)for(h=n.bl_count[d];h!==0;)u=n.heap[--c],!(u>i)&&(t[u*2+1]!==d&&(n.opt_len+=(d-t[u*2+1])*t[u*2],t[u*2+1]=d),h--)}},zZ=(n,e,t)=>{const i=new Array(nf+1);let r=0,s,o;for(s=1;s<=nf;s++)r=r+t[s-1]<<1,i[s]=r;for(o=0;o<=e;o++){let a=n[o*2+1];a!==0&&(n[o*2]=$Z(i[a]++,a))}},awe=()=>{let n,e,t,i,r;const s=new Array(nf+1);for(t=0,i=0;i<X4-1;i++)for(e3[i]=t,n=0;n<1<<aR[i];n++)rw[t++]=i;for(rw[t-1]=i,r=0,i=0;i<16;i++)for(Yx[i]=r,n=0;n<1<<xS[i];n++)nw[r++]=i;for(r>>=7;i<pm;i++)for(Yx[i]=r<<7,n=0;n<1<<xS[i]-7;n++)nw[256+r++]=i;for(e=0;e<=nf;e++)s[e]=0;for(n=0;n<=143;)Hc[n*2+1]=8,n++,s[8]++;for(;n<=255;)Hc[n*2+1]=9,n++,s[9]++;for(;n<=279;)Hc[n*2+1]=7,n++,s[7]++;for(;n<=287;)Hc[n*2+1]=8,n++,s[8]++;for(zZ(Hc,iw+1,s),n=0;n<pm;n++)jb[n*2+1]=5,jb[n*2]=$Z(n,5);PZ=new cI(Hc,aR,ny+1,iw,nf),BZ=new cI(jb,xS,0,pm,nf),VZ=new cI(new Array(0),nwe,0,Q4,iwe)},HZ=n=>{let e;for(e=0;e<iw;e++)n.dyn_ltree[e*2]=0;for(e=0;e<pm;e++)n.dyn_dtree[e*2]=0;for(e=0;e<Q4;e++)n.bl_tree[e*2]=0;n.dyn_ltree[J4*2]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},UZ=n=>{n.bi_valid>8?sw(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},o9=(n,e,t,i)=>{const r=e*2,s=t*2;return n[r]<n[s]||n[r]===n[s]&&i[e]<=i[t]},uI=(n,e,t)=>{const i=n.heap[t];let r=t<<1;for(;r<=n.heap_len&&(r<n.heap_len&&o9(e,n.heap[r+1],n.heap[r],n.depth)&&r++,!o9(e,i,n.heap[r],n.depth));)n.heap[t]=n.heap[r],t=r,r<<=1;n.heap[t]=i},a9=(n,e,t)=>{let i,r,s=0,o,a;if(n.sym_next!==0)do i=n.pending_buf[n.sym_buf+s++]&255,i+=(n.pending_buf[n.sym_buf+s++]&255)<<8,r=n.pending_buf[n.sym_buf+s++],i===0?Rl(n,r,e):(o=rw[r],Rl(n,o+ny+1,e),a=aR[o],a!==0&&(r-=e3[o],Ls(n,r,a)),i--,o=WZ(i),Rl(n,o,t),a=xS[o],a!==0&&(i-=Yx[o],Ls(n,i,a)));while(s<n.sym_next);Rl(n,J4,e)},lR=(n,e)=>{const t=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,l=-1,c;for(n.heap_len=0,n.heap_max=NZ,o=0;o<s;o++)t[o*2]!==0?(n.heap[++n.heap_len]=l=o,n.depth[o]=0):t[o*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=l<2?++l:0,t[c*2]=1,n.depth[c]=0,n.opt_len--,r&&(n.static_len-=i[c*2+1]);for(e.max_code=l,o=n.heap_len>>1;o>=1;o--)uI(n,t,o);c=s;do o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],uI(n,t,1),a=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=a,t[c*2]=t[o*2]+t[a*2],n.depth[c]=(n.depth[o]>=n.depth[a]?n.depth[o]:n.depth[a])+1,t[o*2+1]=t[a*2+1]=c,n.heap[1]=c++,uI(n,t,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],owe(n,e),zZ(t,l,n.bl_count)},l9=(n,e,t)=>{let i,r=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)&&(a<c?n.bl_tree[s*2]+=a:s!==0?(s!==r&&n.bl_tree[s*2]++,n.bl_tree[RZ*2]++):a<=10?n.bl_tree[MZ*2]++:n.bl_tree[FZ*2]++,a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4))},c9=(n,e,t)=>{let i,r=-1,s,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<l&&s===o)){if(a<c)do Rl(n,s,n.bl_tree);while(--a!==0);else s!==0?(s!==r&&(Rl(n,s,n.bl_tree),a--),Rl(n,RZ,n.bl_tree),Ls(n,a-3,2)):a<=10?(Rl(n,MZ,n.bl_tree),Ls(n,a-3,3)):(Rl(n,FZ,n.bl_tree),Ls(n,a-11,7));a=0,r=s,o===0?(l=138,c=3):s===o?(l=6,c=3):(l=7,c=4)}},lwe=n=>{let e;for(l9(n,n.dyn_ltree,n.l_desc.max_code),l9(n,n.dyn_dtree,n.d_desc.max_code),lR(n,n.bl_desc),e=Q4-1;e>=3&&n.bl_tree[OZ[e]*2+1]===0;e--);return n.opt_len+=3*(e+1)+5+5+4,e},cwe=(n,e,t,i)=>{let r;for(Ls(n,e-257,5),Ls(n,t-1,5),Ls(n,i-4,4),r=0;r<i;r++)Ls(n,n.bl_tree[OZ[r]*2+1],3);c9(n,n.dyn_ltree,e-1),c9(n,n.dyn_dtree,t-1)},hwe=n=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&n.dyn_ltree[t*2]!==0)return r9;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return s9;for(t=32;t<ny;t++)if(n.dyn_ltree[t*2]!==0)return s9;return r9};let h9=!1;const uwe=n=>{h9||(awe(),h9=!0),n.l_desc=new hI(n.dyn_ltree,PZ),n.d_desc=new hI(n.dyn_dtree,BZ),n.bl_desc=new hI(n.bl_tree,VZ),n.bi_buf=0,n.bi_valid=0,HZ(n)},jZ=(n,e,t,i)=>{Ls(n,(Qve<<1)+(i?1:0),3),UZ(n),sw(n,t),sw(n,~t),t&&n.pending_buf.set(n.window.subarray(e,e+t),n.pending),n.pending+=t},dwe=n=>{Ls(n,AZ<<1,3),Rl(n,J4,Hc),swe(n)},fwe=(n,e,t,i)=>{let r,s,o=0;n.level>0?(n.strm.data_type===Xve&&(n.strm.data_type=hwe(n)),lR(n,n.l_desc),lR(n,n.d_desc),o=lwe(n),r=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=r&&(r=s)):r=s=t+5,t+4<=r&&e!==-1?jZ(n,e,t,i):n.strategy===Yve||s===r?(Ls(n,(AZ<<1)+(i?1:0),3),a9(n,Hc,jb)):(Ls(n,(Jve<<1)+(i?1:0),3),cwe(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),a9(n,n.dyn_ltree,n.dyn_dtree)),HZ(n),i&&UZ(n)},gwe=(n,e,t)=>(n.pending_buf[n.sym_buf+n.sym_next++]=e,n.pending_buf[n.sym_buf+n.sym_next++]=e>>8,n.pending_buf[n.sym_buf+n.sym_next++]=t,e===0?n.dyn_ltree[t*2]++:(n.matches++,e--,n.dyn_ltree[(rw[t]+ny+1)*2]++,n.dyn_dtree[WZ(e)*2]++),n.sym_next===n.sym_end);var pwe=uwe,mwe=jZ,_we=fwe,bwe=gwe,vwe=dwe,wwe={_tr_init:pwe,_tr_stored_block:mwe,_tr_flush_block:_we,_tr_tally:bwe,_tr_align:vwe};const ywe=(n,e,t,i)=>{let r=n&65535|0,s=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[i++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};var ow=ywe;const Cwe=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},Swe=new Uint32Array(Cwe()),xwe=(n,e,t,i)=>{const r=Swe,s=i+t;n^=-1;for(let o=i;o<s;o++)n=n>>>8^r[(n^e[o])&255];return n^-1};var ir=xwe,h_={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ry={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ewe,_tr_stored_block:cR,_tr_flush_block:Dwe,_tr_tally:bu,_tr_align:kwe}=wwe,{Z_NO_FLUSH:vu,Z_PARTIAL_FLUSH:Lwe,Z_FULL_FLUSH:Iwe,Z_FINISH:Mo,Z_BLOCK:u9,Z_OK:pr,Z_STREAM_END:d9,Z_STREAM_ERROR:Gl,Z_DATA_ERROR:Twe,Z_BUF_ERROR:dI,Z_DEFAULT_COMPRESSION:Awe,Z_FILTERED:Nwe,Z_HUFFMAN_ONLY:rC,Z_RLE:Rwe,Z_FIXED:Mwe,Z_DEFAULT_STRATEGY:Fwe,Z_UNKNOWN:Owe,Z_DEFLATED:Wk}=ry,Pwe=9,Bwe=15,Vwe=8,Wwe=29,$we=256,hR=$we+1+Wwe,zwe=30,Hwe=19,Uwe=2*hR+1,jwe=15,$t=3,uu=258,Kl=uu+$t+1,qwe=32,u_=42,t3=57,uR=69,dR=73,fR=91,gR=103,rf=113,pb=666,as=1,a0=2,eg=3,l0=4,Gwe=3,sf=(n,e)=>(n.msg=h_[e],e),f9=n=>n*2-(n>4?9:0),tu=n=>{let e=n.length;for(;--e>=0;)n[e]=0},Kwe=n=>{let e,t,i,r=n.w_size;e=n.hash_size,i=e;do t=n.head[--i],n.head[i]=t>=r?t-r:0;while(--e);e=r,i=e;do t=n.prev[--i],n.prev[i]=t>=r?t-r:0;while(--e)};let Zwe=(n,e,t)=>(e<<n.hash_shift^t)&n.hash_mask,wu=Zwe;const Gs=n=>{const e=n.state;let t=e.pending;t>n.avail_out&&(t=n.avail_out),t!==0&&(n.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),n.next_out),n.next_out+=t,e.pending_out+=t,n.total_out+=t,n.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},so=(n,e)=>{Dwe(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,e),n.block_start=n.strstart,Gs(n.strm)},oi=(n,e)=>{n.pending_buf[n.pending++]=e},H0=(n,e)=>{n.pending_buf[n.pending++]=e>>>8&255,n.pending_buf[n.pending++]=e&255},pR=(n,e,t,i)=>{let r=n.avail_in;return r>i&&(r=i),r===0?0:(n.avail_in-=r,e.set(n.input.subarray(n.next_in,n.next_in+r),t),n.state.wrap===1?n.adler=ow(n.adler,e,r,t):n.state.wrap===2&&(n.adler=ir(n.adler,e,r,t)),n.next_in+=r,n.total_in+=r,r)},qZ=(n,e)=>{let t=n.max_chain_length,i=n.strstart,r,s,o=n.prev_length,a=n.nice_match;const l=n.strstart>n.w_size-Kl?n.strstart-(n.w_size-Kl):0,c=n.window,h=n.w_mask,u=n.prev,d=n.strstart+uu;let f=c[i+o-1],g=c[i+o];n.prev_length>=n.good_match&&(t>>=2),a>n.lookahead&&(a=n.lookahead);do if(r=e,!(c[r+o]!==g||c[r+o-1]!==f||c[r]!==c[i]||c[++r]!==c[i+1])){i+=2,r++;do;while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<d);if(s=uu-(d-i),i=d-uu,s>o){if(n.match_start=e,o=s,s>=a)break;f=c[i+o-1],g=c[i+o]}}while((e=u[e&h])>l&&--t!==0);return o<=n.lookahead?o:n.lookahead},d_=n=>{const e=n.w_size;let t,i,r;do{if(i=n.window_size-n.lookahead-n.strstart,n.strstart>=e+(e-Kl)&&(n.window.set(n.window.subarray(e,e+e-i),0),n.match_start-=e,n.strstart-=e,n.block_start-=e,n.insert>n.strstart&&(n.insert=n.strstart),Kwe(n),i+=e),n.strm.avail_in===0)break;if(t=pR(n.strm,n.window,n.strstart+n.lookahead,i),n.lookahead+=t,n.lookahead+n.insert>=$t)for(r=n.strstart-n.insert,n.ins_h=n.window[r],n.ins_h=wu(n,n.ins_h,n.window[r+1]);n.insert&&(n.ins_h=wu(n,n.ins_h,n.window[r+$t-1]),n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,n.insert--,!(n.lookahead+n.insert<$t)););}while(n.lookahead<Kl&&n.strm.avail_in!==0)},GZ=(n,e)=>{let t=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,i,r,s,o=0,a=n.strm.avail_in;do{if(i=65535,s=n.bi_valid+42>>3,n.strm.avail_out<s||(s=n.strm.avail_out-s,r=n.strstart-n.block_start,i>r+n.strm.avail_in&&(i=r+n.strm.avail_in),i>s&&(i=s),i<t&&(i===0&&e!==Mo||e===vu||i!==r+n.strm.avail_in)))break;o=e===Mo&&i===r+n.strm.avail_in?1:0,cR(n,0,0,o),n.pending_buf[n.pending-4]=i,n.pending_buf[n.pending-3]=i>>8,n.pending_buf[n.pending-2]=~i,n.pending_buf[n.pending-1]=~i>>8,Gs(n.strm),r&&(r>i&&(r=i),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+r),n.strm.next_out),n.strm.next_out+=r,n.strm.avail_out-=r,n.strm.total_out+=r,n.block_start+=r,i-=r),i&&(pR(n.strm,n.strm.output,n.strm.next_out,i),n.strm.next_out+=i,n.strm.avail_out-=i,n.strm.total_out+=i)}while(o===0);return a-=n.strm.avail_in,a&&(a>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=a&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-a,n.strm.next_in),n.strstart),n.strstart+=a,n.insert+=a>n.w_size-n.insert?n.w_size-n.insert:a),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),o?l0:e!==vu&&e!==Mo&&n.strm.avail_in===0&&n.strstart===n.block_start?a0:(s=n.window_size-n.strstart,n.strm.avail_in>s&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,s+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),s>n.strm.avail_in&&(s=n.strm.avail_in),s&&(pR(n.strm,n.window,n.strstart,s),n.strstart+=s,n.insert+=s>n.w_size-n.insert?n.w_size-n.insert:s),n.high_water<n.strstart&&(n.high_water=n.strstart),s=n.bi_valid+42>>3,s=n.pending_buf_size-s>65535?65535:n.pending_buf_size-s,t=s>n.w_size?n.w_size:s,r=n.strstart-n.block_start,(r>=t||(r||e===Mo)&&e!==vu&&n.strm.avail_in===0&&r<=s)&&(i=r>s?s:r,o=e===Mo&&n.strm.avail_in===0&&i===r?1:0,cR(n,n.block_start,i,o),n.block_start+=i,Gs(n.strm)),o?eg:as)},fI=(n,e)=>{let t,i;for(;;){if(n.lookahead<Kl){if(d_(n),n.lookahead<Kl&&e===vu)return as;if(n.lookahead===0)break}if(t=0,n.lookahead>=$t&&(n.ins_h=wu(n,n.ins_h,n.window[n.strstart+$t-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),t!==0&&n.strstart-t<=n.w_size-Kl&&(n.match_length=qZ(n,t)),n.match_length>=$t)if(i=bu(n,n.strstart-n.match_start,n.match_length-$t),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=$t){n.match_length--;do n.strstart++,n.ins_h=wu(n,n.ins_h,n.window[n.strstart+$t-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=wu(n,n.ins_h,n.window[n.strstart+1]);else i=bu(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(so(n,!1),n.strm.avail_out===0))return as}return n.insert=n.strstart<$t-1?n.strstart:$t-1,e===Mo?(so(n,!0),n.strm.avail_out===0?eg:l0):n.sym_next&&(so(n,!1),n.strm.avail_out===0)?as:a0},pp=(n,e)=>{let t,i,r;for(;;){if(n.lookahead<Kl){if(d_(n),n.lookahead<Kl&&e===vu)return as;if(n.lookahead===0)break}if(t=0,n.lookahead>=$t&&(n.ins_h=wu(n,n.ins_h,n.window[n.strstart+$t-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=$t-1,t!==0&&n.prev_length<n.max_lazy_match&&n.strstart-t<=n.w_size-Kl&&(n.match_length=qZ(n,t),n.match_length<=5&&(n.strategy===Nwe||n.match_length===$t&&n.strstart-n.match_start>4096)&&(n.match_length=$t-1)),n.prev_length>=$t&&n.match_length<=n.prev_length){r=n.strstart+n.lookahead-$t,i=bu(n,n.strstart-1-n.prev_match,n.prev_length-$t),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=r&&(n.ins_h=wu(n,n.ins_h,n.window[n.strstart+$t-1]),t=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=$t-1,n.strstart++,i&&(so(n,!1),n.strm.avail_out===0))return as}else if(n.match_available){if(i=bu(n,0,n.window[n.strstart-1]),i&&so(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return as}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=bu(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<$t-1?n.strstart:$t-1,e===Mo?(so(n,!0),n.strm.avail_out===0?eg:l0):n.sym_next&&(so(n,!1),n.strm.avail_out===0)?as:a0},Ywe=(n,e)=>{let t,i,r,s;const o=n.window;for(;;){if(n.lookahead<=uu){if(d_(n),n.lookahead<=uu&&e===vu)return as;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=$t&&n.strstart>0&&(r=n.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=n.strstart+uu;do;while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);n.match_length=uu-(s-r),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=$t?(t=bu(n,1,n.match_length-$t),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(t=bu(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),t&&(so(n,!1),n.strm.avail_out===0))return as}return n.insert=0,e===Mo?(so(n,!0),n.strm.avail_out===0?eg:l0):n.sym_next&&(so(n,!1),n.strm.avail_out===0)?as:a0},Xwe=(n,e)=>{let t;for(;;){if(n.lookahead===0&&(d_(n),n.lookahead===0)){if(e===vu)return as;break}if(n.match_length=0,t=bu(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,t&&(so(n,!1),n.strm.avail_out===0))return as}return n.insert=0,e===Mo?(so(n,!0),n.strm.avail_out===0?eg:l0):n.sym_next&&(so(n,!1),n.strm.avail_out===0)?as:a0};function gl(n,e,t,i,r){this.good_length=n,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=r}const mb=[new gl(0,0,0,0,GZ),new gl(4,4,8,4,fI),new gl(4,5,16,8,fI),new gl(4,6,32,32,fI),new gl(4,4,16,16,pp),new gl(8,16,32,32,pp),new gl(8,16,128,128,pp),new gl(8,32,128,256,pp),new gl(32,128,258,1024,pp),new gl(32,258,258,4096,pp)],Qwe=n=>{n.window_size=2*n.w_size,tu(n.head),n.max_lazy_match=mb[n.level].max_lazy,n.good_match=mb[n.level].good_length,n.nice_match=mb[n.level].nice_length,n.max_chain_length=mb[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=$t-1,n.match_available=0,n.ins_h=0};function Jwe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Wk,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Uwe*2),this.dyn_dtree=new Uint16Array((2*zwe+1)*2),this.bl_tree=new Uint16Array((2*Hwe+1)*2),tu(this.dyn_ltree),tu(this.dyn_dtree),tu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(jwe+1),this.heap=new Uint16Array(2*hR+1),tu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*hR+1),tu(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const sy=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.status!==u_&&e.status!==t3&&e.status!==uR&&e.status!==dR&&e.status!==fR&&e.status!==gR&&e.status!==rf&&e.status!==pb?1:0},KZ=n=>{if(sy(n))return sf(n,Gl);n.total_in=n.total_out=0,n.data_type=Owe;const e=n.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?t3:e.wrap?u_:rf,n.adler=e.wrap===2?0:1,e.last_flush=-2,Ewe(e),pr},ZZ=n=>{const e=KZ(n);return e===pr&&Qwe(n.state),e},e1e=(n,e)=>sy(n)||n.state.wrap!==2?Gl:(n.state.gzhead=e,pr),YZ=(n,e,t,i,r,s)=>{if(!n)return Gl;let o=1;if(e===Awe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>Pwe||t!==Wk||i<8||i>15||e<0||e>9||s<0||s>Mwe||i===8&&o!==1)return sf(n,Gl);i===8&&(i=9);const a=new Jwe;return n.state=a,a.strm=n,a.status=u_,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+$t-1)/$t),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=e,a.strategy=s,a.method=t,ZZ(n)},t1e=(n,e)=>YZ(n,e,Wk,Bwe,Vwe,Fwe),i1e=(n,e)=>{if(sy(n)||e>u9||e<0)return n?sf(n,Gl):Gl;const t=n.state;if(!n.output||n.avail_in!==0&&!n.input||t.status===pb&&e!==Mo)return sf(n,n.avail_out===0?dI:Gl);const i=t.last_flush;if(t.last_flush=e,t.pending!==0){if(Gs(n),n.avail_out===0)return t.last_flush=-1,pr}else if(n.avail_in===0&&f9(e)<=f9(i)&&e!==Mo)return sf(n,dI);if(t.status===pb&&n.avail_in!==0)return sf(n,dI);if(t.status===u_&&t.wrap===0&&(t.status=rf),t.status===u_){let r=Wk+(t.w_bits-8<<4)<<8,s=-1;if(t.strategy>=rC||t.level<2?s=0:t.level<6?s=1:t.level===6?s=2:s=3,r|=s<<6,t.strstart!==0&&(r|=qwe),r+=31-r%31,H0(t,r),t.strstart!==0&&(H0(t,n.adler>>>16),H0(t,n.adler&65535)),n.adler=1,t.status=rf,Gs(n),t.pending!==0)return t.last_flush=-1,pr}if(t.status===t3){if(n.adler=0,oi(t,31),oi(t,139),oi(t,8),t.gzhead)oi(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),oi(t,t.gzhead.time&255),oi(t,t.gzhead.time>>8&255),oi(t,t.gzhead.time>>16&255),oi(t,t.gzhead.time>>24&255),oi(t,t.level===9?2:t.strategy>=rC||t.level<2?4:0),oi(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(oi(t,t.gzhead.extra.length&255),oi(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(n.adler=ir(n.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=uR;else if(oi(t,0),oi(t,0),oi(t,0),oi(t,0),oi(t,0),oi(t,t.level===9?2:t.strategy>=rC||t.level<2?4:0),oi(t,Gwe),t.status=rf,Gs(n),t.pending!==0)return t.last_flush=-1,pr}if(t.status===uR){if(t.gzhead.extra){let r=t.pending,s=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+s>t.pending_buf_size;){let a=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+a),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r)),t.gzindex+=a,Gs(n),t.pending!==0)return t.last_flush=-1,pr;r=0,s-=a}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+s),t.pending),t.pending+=s,t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=dR}if(t.status===dR){if(t.gzhead.name){let r=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r)),Gs(n),t.pending!==0)return t.last_flush=-1,pr;r=0}t.gzindex<t.gzhead.name.length?s=t.gzhead.name.charCodeAt(t.gzindex++)&255:s=0,oi(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=fR}if(t.status===fR){if(t.gzhead.comment){let r=t.pending,s;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r)),Gs(n),t.pending!==0)return t.last_flush=-1,pr;r=0}t.gzindex<t.gzhead.comment.length?s=t.gzhead.comment.charCodeAt(t.gzindex++)&255:s=0,oi(t,s)}while(s!==0);t.gzhead.hcrc&&t.pending>r&&(n.adler=ir(n.adler,t.pending_buf,t.pending-r,r))}t.status=gR}if(t.status===gR){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(Gs(n),t.pending!==0))return t.last_flush=-1,pr;oi(t,n.adler&255),oi(t,n.adler>>8&255),n.adler=0}if(t.status=rf,Gs(n),t.pending!==0)return t.last_flush=-1,pr}if(n.avail_in!==0||t.lookahead!==0||e!==vu&&t.status!==pb){let r=t.level===0?GZ(t,e):t.strategy===rC?Xwe(t,e):t.strategy===Rwe?Ywe(t,e):mb[t.level].func(t,e);if((r===eg||r===l0)&&(t.status=pb),r===as||r===eg)return n.avail_out===0&&(t.last_flush=-1),pr;if(r===a0&&(e===Lwe?kwe(t):e!==u9&&(cR(t,0,0,!1),e===Iwe&&(tu(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),Gs(n),n.avail_out===0))return t.last_flush=-1,pr}return e!==Mo?pr:t.wrap<=0?d9:(t.wrap===2?(oi(t,n.adler&255),oi(t,n.adler>>8&255),oi(t,n.adler>>16&255),oi(t,n.adler>>24&255),oi(t,n.total_in&255),oi(t,n.total_in>>8&255),oi(t,n.total_in>>16&255),oi(t,n.total_in>>24&255)):(H0(t,n.adler>>>16),H0(t,n.adler&65535)),Gs(n),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?pr:d9)},n1e=n=>{if(sy(n))return Gl;const e=n.state.status;return n.state=null,e===rf?sf(n,Twe):pr},r1e=(n,e)=>{let t=e.length;if(sy(n))return Gl;const i=n.state,r=i.wrap;if(r===2||r===1&&i.status!==u_||i.lookahead)return Gl;if(r===1&&(n.adler=ow(n.adler,e,t,0)),i.wrap=0,t>=i.w_size){r===0&&(tu(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(e.subarray(t-i.w_size,t),0),e=l,t=i.w_size}const s=n.avail_in,o=n.next_in,a=n.input;for(n.avail_in=t,n.next_in=0,n.input=e,d_(i);i.lookahead>=$t;){let l=i.strstart,c=i.lookahead-($t-1);do i.ins_h=wu(i,i.ins_h,i.window[l+$t-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=$t-1,d_(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=$t-1,i.match_available=0,n.next_in=o,n.input=a,n.avail_in=s,i.wrap=r,pr};var s1e=t1e,o1e=YZ,a1e=ZZ,l1e=KZ,c1e=e1e,h1e=i1e,u1e=n1e,d1e=r1e,f1e="pako deflate (from Nodeca project)",qb={deflateInit:s1e,deflateInit2:o1e,deflateReset:a1e,deflateResetKeep:l1e,deflateSetHeader:c1e,deflate:h1e,deflateEnd:u1e,deflateSetDictionary:d1e,deflateInfo:f1e};const g1e=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var p1e=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)g1e(t,i)&&(n[i]=t[i])}}return n},m1e=n=>{let e=0;for(let i=0,r=n.length;i<r;i++)e+=n[i].length;const t=new Uint8Array(e);for(let i=0,r=0,s=n.length;i<s;i++){let o=n[i];t.set(o,r),r+=o.length}return t},$k={assign:p1e,flattenChunks:m1e};let XZ=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{XZ=!1}const aw=new Uint8Array(256);for(let n=0;n<256;n++)aw[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;aw[254]=aw[254]=1;var _1e=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,i,r,s,o=n.length,a=0;for(r=0;r<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const b1e=(n,e)=>{if(e<65534&&n.subarray&&XZ)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t};var v1e=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let i,r;const s=new Array(t*2);for(r=0,i=0;i<t;){let o=n[i++];if(o<128){s[r++]=o;continue}let a=aw[o];if(a>4){s[r++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|n[i++]&63,a--;if(a>1){s[r++]=65533;continue}o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|o&1023)}return b1e(s,r)},w1e=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+aw[n[t]]>e?t:e},lw={string2buf:_1e,buf2string:v1e,utf8border:w1e};function y1e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var QZ=y1e;const JZ=Object.prototype.toString,{Z_NO_FLUSH:C1e,Z_SYNC_FLUSH:S1e,Z_FULL_FLUSH:x1e,Z_FINISH:E1e,Z_OK:Xx,Z_STREAM_END:D1e,Z_DEFAULT_COMPRESSION:k1e,Z_DEFAULT_STRATEGY:L1e,Z_DEFLATED:I1e}=ry;function i3(n){this.options=$k.assign({level:k1e,method:I1e,chunkSize:16384,windowBits:15,memLevel:8,strategy:L1e},n||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new QZ,this.strm.avail_out=0;let t=qb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==Xx)throw new Error(h_[t]);if(e.header&&qb.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=lw.string2buf(e.dictionary):JZ.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=qb.deflateSetDictionary(this.strm,i),t!==Xx)throw new Error(h_[t]);this._dict_set=!0}}i3.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?E1e:C1e,typeof n=="string"?t.input=lw.string2buf(n):JZ.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(s===S1e||s===x1e)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(r=qb.deflate(t,s),r===D1e)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),r=qb.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Xx;if(t.avail_out===0){this.onData(t.output);continue}if(s>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};i3.prototype.onData=function(n){this.chunks.push(n)};i3.prototype.onEnd=function(n){n===Xx&&(this.result=$k.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};const sC=16209,T1e=16191;var A1e=function(e,t){let i,r,s,o,a,l,c,h,u,d,f,g,p,m,b,_,w,y,S,k,C,D,E,N;const T=e.state;i=e.next_in,E=e.input,r=i+(e.avail_in-5),s=e.next_out,N=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=T.dmax,c=T.wsize,h=T.whave,u=T.wnext,d=T.window,f=T.hold,g=T.bits,p=T.lencode,m=T.distcode,b=(1<<T.lenbits)-1,_=(1<<T.distbits)-1;e:do{g<15&&(f+=E[i++]<<g,g+=8,f+=E[i++]<<g,g+=8),w=p[f&b];t:for(;;){if(y=w>>>24,f>>>=y,g-=y,y=w>>>16&255,y===0)N[s++]=w&65535;else if(y&16){S=w&65535,y&=15,y&&(g<y&&(f+=E[i++]<<g,g+=8),S+=f&(1<<y)-1,f>>>=y,g-=y),g<15&&(f+=E[i++]<<g,g+=8,f+=E[i++]<<g,g+=8),w=m[f&_];i:for(;;){if(y=w>>>24,f>>>=y,g-=y,y=w>>>16&255,y&16){if(k=w&65535,y&=15,g<y&&(f+=E[i++]<<g,g+=8,g<y&&(f+=E[i++]<<g,g+=8)),k+=f&(1<<y)-1,k>l){e.msg="invalid distance too far back",T.mode=sC;break e}if(f>>>=y,g-=y,y=s-o,k>y){if(y=k-y,y>h&&T.sane){e.msg="invalid distance too far back",T.mode=sC;break e}if(C=0,D=d,u===0){if(C+=c-y,y<S){S-=y;do N[s++]=d[C++];while(--y);C=s-k,D=N}}else if(u<y){if(C+=c+u-y,y-=u,y<S){S-=y;do N[s++]=d[C++];while(--y);if(C=0,u<S){y=u,S-=y;do N[s++]=d[C++];while(--y);C=s-k,D=N}}}else if(C+=u-y,y<S){S-=y;do N[s++]=d[C++];while(--y);C=s-k,D=N}for(;S>2;)N[s++]=D[C++],N[s++]=D[C++],N[s++]=D[C++],S-=3;S&&(N[s++]=D[C++],S>1&&(N[s++]=D[C++]))}else{C=s-k;do N[s++]=N[C++],N[s++]=N[C++],N[s++]=N[C++],S-=3;while(S>2);S&&(N[s++]=N[C++],S>1&&(N[s++]=N[C++]))}}else if(y&64){e.msg="invalid distance code",T.mode=sC;break e}else{w=m[(w&65535)+(f&(1<<y)-1)];continue i}break}}else if(y&64)if(y&32){T.mode=T1e;break e}else{e.msg="invalid literal/length code",T.mode=sC;break e}else{w=p[(w&65535)+(f&(1<<y)-1)];continue t}break}}while(i<r&&s<a);S=g>>3,i-=S,g-=S<<3,f&=(1<<g)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<a?257+(a-s):257-(s-a),T.hold=f,T.bits=g};const mp=15,g9=852,p9=592,m9=0,gI=1,_9=2,N1e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),R1e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),M1e=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),F1e=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),O1e=(n,e,t,i,r,s,o,a)=>{const l=a.bits;let c=0,h=0,u=0,d=0,f=0,g=0,p=0,m=0,b=0,_=0,w,y,S,k,C,D=null,E;const N=new Uint16Array(mp+1),T=new Uint16Array(mp+1);let j=null,q,ie,ge;for(c=0;c<=mp;c++)N[c]=0;for(h=0;h<i;h++)N[e[t+h]]++;for(f=l,d=mp;d>=1&&N[d]===0;d--);if(f>d&&(f=d),d===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,a.bits=1,0;for(u=1;u<d&&N[u]===0;u++);for(f<u&&(f=u),m=1,c=1;c<=mp;c++)if(m<<=1,m-=N[c],m<0)return-1;if(m>0&&(n===m9||d!==1))return-1;for(T[1]=0,c=1;c<mp;c++)T[c+1]=T[c]+N[c];for(h=0;h<i;h++)e[t+h]!==0&&(o[T[e[t+h]]++]=h);if(n===m9?(D=j=o,E=20):n===gI?(D=N1e,j=R1e,E=257):(D=M1e,j=F1e,E=0),_=0,h=0,c=u,C=s,g=f,p=0,S=-1,b=1<<f,k=b-1,n===gI&&b>g9||n===_9&&b>p9)return 1;for(;;){q=c-p,o[h]+1<E?(ie=0,ge=o[h]):o[h]>=E?(ie=j[o[h]-E],ge=D[o[h]-E]):(ie=32+64,ge=0),w=1<<c-p,y=1<<g,u=y;do y-=w,r[C+(_>>p)+y]=q<<24|ie<<16|ge|0;while(y!==0);for(w=1<<c-1;_&w;)w>>=1;if(w!==0?(_&=w-1,_+=w):_=0,h++,--N[c]===0){if(c===d)break;c=e[t+o[h]]}if(c>f&&(_&k)!==S){for(p===0&&(p=f),C+=u,g=c-p,m=1<<g;g+p<d&&(m-=N[g+p],!(m<=0));)g++,m<<=1;if(b+=1<<g,n===gI&&b>g9||n===_9&&b>p9)return 1;S=_&k,r[S]=f<<24|g<<16|C-s|0}}return _!==0&&(r[C+_]=c-p<<24|64<<16|0),a.bits=f,0};var Gb=O1e;const P1e=0,eY=1,tY=2,{Z_FINISH:b9,Z_BLOCK:B1e,Z_TREES:oC,Z_OK:tg,Z_STREAM_END:V1e,Z_NEED_DICT:W1e,Z_STREAM_ERROR:ra,Z_DATA_ERROR:iY,Z_MEM_ERROR:nY,Z_BUF_ERROR:$1e,Z_DEFLATED:v9}=ry,zk=16180,w9=16181,y9=16182,C9=16183,S9=16184,x9=16185,E9=16186,D9=16187,k9=16188,L9=16189,Qx=16190,Ec=16191,pI=16192,I9=16193,mI=16194,T9=16195,A9=16196,N9=16197,R9=16198,aC=16199,lC=16200,M9=16201,F9=16202,O9=16203,P9=16204,B9=16205,_I=16206,V9=16207,W9=16208,en=16209,rY=16210,sY=16211,z1e=852,H1e=592,U1e=15,j1e=U1e,$9=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function q1e(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Mg=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<zk||e.mode>sY?1:0},oY=n=>{if(Mg(n))return ra;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=zk,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(z1e),e.distcode=e.distdyn=new Int32Array(H1e),e.sane=1,e.back=-1,tg},aY=n=>{if(Mg(n))return ra;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,oY(n)},lY=(n,e)=>{let t;if(Mg(n))return ra;const i=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?ra:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,aY(n))},cY=(n,e)=>{if(!n)return ra;const t=new q1e;n.state=t,t.strm=n,t.window=null,t.mode=zk;const i=lY(n,e);return i!==tg&&(n.state=null),i},G1e=n=>cY(n,j1e);let z9=!0,bI,vI;const K1e=n=>{if(z9){bI=new Int32Array(512),vI=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Gb(eY,n.lens,0,288,bI,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Gb(tY,n.lens,0,32,vI,0,n.work,{bits:5}),z9=!1}n.lencode=bI,n.lenbits=9,n.distcode=vI,n.distbits=5},hY=(n,e,t,i)=>{let r;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(t-i,t-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(t-i,t),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},Z1e=(n,e)=>{let t,i,r,s,o,a,l,c,h,u,d,f,g,p,m=0,b,_,w,y,S,k,C,D;const E=new Uint8Array(4);let N,T;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mg(n)||!n.output||!n.input&&n.avail_in!==0)return ra;t=n.state,t.mode===Ec&&(t.mode=pI),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,c=t.hold,h=t.bits,u=a,d=l,D=tg;e:for(;;)switch(t.mode){case zk:if(t.wrap===0){t.mode=pI;break}for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,E[0]=c&255,E[1]=c>>>8&255,t.check=ir(t.check,E,2,0),c=0,h=0,t.mode=w9;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",t.mode=en;break}if((c&15)!==v9){n.msg="unknown compression method",t.mode=en;break}if(c>>>=4,h-=4,C=(c&15)+8,t.wbits===0&&(t.wbits=C),C>15||C>t.wbits){n.msg="invalid window size",t.mode=en;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=c&512?L9:Ec,c=0,h=0;break;case w9:for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.flags=c,(t.flags&255)!==v9){n.msg="unknown compression method",t.mode=en;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=en;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(E[0]=c&255,E[1]=c>>>8&255,t.check=ir(t.check,E,2,0)),c=0,h=0,t.mode=y9;case y9:for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(E[0]=c&255,E[1]=c>>>8&255,E[2]=c>>>16&255,E[3]=c>>>24&255,t.check=ir(t.check,E,4,0)),c=0,h=0,t.mode=C9;case C9:for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(E[0]=c&255,E[1]=c>>>8&255,t.check=ir(t.check,E,2,0)),c=0,h=0,t.mode=S9;case S9:if(t.flags&1024){for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(E[0]=c&255,E[1]=c>>>8&255,t.check=ir(t.check,E,2,0)),c=0,h=0}else t.head&&(t.head.extra=null);t.mode=x9;case x9:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(C=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(s,s+f),C)),t.flags&512&&t.wrap&4&&(t.check=ir(t.check,i,f,s)),a-=f,s+=f,t.length-=f),t.length))break e;t.length=0,t.mode=E9;case E9:if(t.flags&2048){if(a===0)break e;f=0;do C=i[s+f++],t.head&&C&&t.length<65536&&(t.head.name+=String.fromCharCode(C));while(C&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=ir(t.check,i,f,s)),a-=f,s+=f,C)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=D9;case D9:if(t.flags&4096){if(a===0)break e;f=0;do C=i[s+f++],t.head&&C&&t.length<65536&&(t.head.comment+=String.fromCharCode(C));while(C&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=ir(t.check,i,f,s)),a-=f,s+=f,C)break e}else t.head&&(t.head.comment=null);t.mode=k9;case k9:if(t.flags&512){for(;h<16;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.wrap&4&&c!==(t.check&65535)){n.msg="header crc mismatch",t.mode=en;break}c=0,h=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Ec;break;case L9:for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}n.adler=t.check=$9(c),c=0,h=0,t.mode=Qx;case Qx:if(t.havedict===0)return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,W1e;n.adler=t.check=1,t.mode=Ec;case Ec:if(e===B1e||e===oC)break e;case pI:if(t.last){c>>>=h&7,h-=h&7,t.mode=_I;break}for(;h<3;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}switch(t.last=c&1,c>>>=1,h-=1,c&3){case 0:t.mode=I9;break;case 1:if(K1e(t),t.mode=aC,e===oC){c>>>=2,h-=2;break e}break;case 2:t.mode=A9;break;case 3:n.msg="invalid block type",t.mode=en}c>>>=2,h-=2;break;case I9:for(c>>>=h&7,h-=h&7;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",t.mode=en;break}if(t.length=c&65535,c=0,h=0,t.mode=mI,e===oC)break e;case mI:t.mode=T9;case T9:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;r.set(i.subarray(s,s+f),o),a-=f,s+=f,l-=f,o+=f,t.length-=f;break}t.mode=Ec;break;case A9:for(;h<14;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.nlen=(c&31)+257,c>>>=5,h-=5,t.ndist=(c&31)+1,c>>>=5,h-=5,t.ncode=(c&15)+4,c>>>=4,h-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=en;break}t.have=0,t.mode=N9;case N9:for(;t.have<t.ncode;){for(;h<3;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.lens[j[t.have++]]=c&7,c>>>=3,h-=3}for(;t.have<19;)t.lens[j[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,N={bits:t.lenbits},D=Gb(P1e,t.lens,0,19,t.lencode,0,t.work,N),t.lenbits=N.bits,D){n.msg="invalid code lengths set",t.mode=en;break}t.have=0,t.mode=R9;case R9:for(;t.have<t.nlen+t.ndist;){for(;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(w<16)c>>>=b,h-=b,t.lens[t.have++]=w;else{if(w===16){for(T=b+2;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(c>>>=b,h-=b,t.have===0){n.msg="invalid bit length repeat",t.mode=en;break}C=t.lens[t.have-1],f=3+(c&3),c>>>=2,h-=2}else if(w===17){for(T=b+3;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=b,h-=b,C=0,f=3+(c&7),c>>>=3,h-=3}else{for(T=b+7;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=b,h-=b,C=0,f=11+(c&127),c>>>=7,h-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=en;break}for(;f--;)t.lens[t.have++]=C}}if(t.mode===en)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=en;break}if(t.lenbits=9,N={bits:t.lenbits},D=Gb(eY,t.lens,0,t.nlen,t.lencode,0,t.work,N),t.lenbits=N.bits,D){n.msg="invalid literal/lengths set",t.mode=en;break}if(t.distbits=6,t.distcode=t.distdyn,N={bits:t.distbits},D=Gb(tY,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,N),t.distbits=N.bits,D){n.msg="invalid distances set",t.mode=en;break}if(t.mode=aC,e===oC)break e;case aC:t.mode=lC;case lC:if(a>=6&&l>=258){n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,A1e(n,d),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,c=t.hold,h=t.bits,t.mode===Ec&&(t.back=-1);break}for(t.back=0;m=t.lencode[c&(1<<t.lenbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(_&&!(_&240)){for(y=b,S=_,k=w;m=t.lencode[k+((c&(1<<y+S)-1)>>y)],b=m>>>24,_=m>>>16&255,w=m&65535,!(y+b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=y,h-=y,t.back+=y}if(c>>>=b,h-=b,t.back+=b,t.length=w,_===0){t.mode=B9;break}if(_&32){t.back=-1,t.mode=Ec;break}if(_&64){n.msg="invalid literal/length code",t.mode=en;break}t.extra=_&15,t.mode=M9;case M9:if(t.extra){for(T=t.extra;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=F9;case F9:for(;m=t.distcode[c&(1<<t.distbits)-1],b=m>>>24,_=m>>>16&255,w=m&65535,!(b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(!(_&240)){for(y=b,S=_,k=w;m=t.distcode[k+((c&(1<<y+S)-1)>>y)],b=m>>>24,_=m>>>16&255,w=m&65535,!(y+b<=h);){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}c>>>=y,h-=y,t.back+=y}if(c>>>=b,h-=b,t.back+=b,_&64){n.msg="invalid distance code",t.mode=en;break}t.offset=w,t.extra=_&15,t.mode=O9;case O9:if(t.extra){for(T=t.extra;h<T;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,h-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=en;break}t.mode=P9;case P9:if(l===0)break e;if(f=d-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=en;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),p=t.window}else p=r,g=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do r[o++]=p[g++];while(--f);t.length===0&&(t.mode=lC);break;case B9:if(l===0)break e;r[o++]=t.length,l--,t.mode=lC;break;case _I:if(t.wrap){for(;h<32;){if(a===0)break e;a--,c|=i[s++]<<h,h+=8}if(d-=l,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?ir(t.check,r,d,o-d):ow(t.check,r,d,o-d)),d=l,t.wrap&4&&(t.flags?c:$9(c))!==t.check){n.msg="incorrect data check",t.mode=en;break}c=0,h=0}t.mode=V9;case V9:if(t.wrap&&t.flags){for(;h<32;){if(a===0)break e;a--,c+=i[s++]<<h,h+=8}if(t.wrap&4&&c!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=en;break}c=0,h=0}t.mode=W9;case W9:D=V1e;break e;case en:D=iY;break e;case rY:return nY;case sY:default:return ra}return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=c,t.bits=h,(t.wsize||d!==n.avail_out&&t.mode<en&&(t.mode<_I||e!==b9))&&hY(n,n.output,n.next_out,d-n.avail_out),u-=n.avail_in,d-=n.avail_out,n.total_in+=u,n.total_out+=d,t.total+=d,t.wrap&4&&d&&(n.adler=t.check=t.flags?ir(t.check,r,d,n.next_out-d):ow(t.check,r,d,n.next_out-d)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Ec?128:0)+(t.mode===aC||t.mode===mI?256:0),(u===0&&d===0||e===b9)&&D===tg&&(D=$1e),D},Y1e=n=>{if(Mg(n))return ra;let e=n.state;return e.window&&(e.window=null),n.state=null,tg},X1e=(n,e)=>{if(Mg(n))return ra;const t=n.state;return t.wrap&2?(t.head=e,e.done=!1,tg):ra},Q1e=(n,e)=>{const t=e.length;let i,r,s;return Mg(n)||(i=n.state,i.wrap!==0&&i.mode!==Qx)?ra:i.mode===Qx&&(r=1,r=ow(r,e,t,0),r!==i.check)?iY:(s=hY(n,e,t,t),s?(i.mode=rY,nY):(i.havedict=1,tg))};var J1e=aY,eye=lY,tye=oY,iye=G1e,nye=cY,rye=Z1e,sye=Y1e,oye=X1e,aye=Q1e,lye="pako inflate (from Nodeca project)",Uc={inflateReset:J1e,inflateReset2:eye,inflateResetKeep:tye,inflateInit:iye,inflateInit2:nye,inflate:rye,inflateEnd:sye,inflateGetHeader:oye,inflateSetDictionary:aye,inflateInfo:lye};function cye(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var hye=cye;const uY=Object.prototype.toString,{Z_NO_FLUSH:uye,Z_FINISH:dye,Z_OK:cw,Z_STREAM_END:wI,Z_NEED_DICT:yI,Z_STREAM_ERROR:fye,Z_DATA_ERROR:H9,Z_MEM_ERROR:gye}=ry;function oy(n){this.options=$k.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new QZ,this.strm.avail_out=0;let t=Uc.inflateInit2(this.strm,e.windowBits);if(t!==cw)throw new Error(h_[t]);if(this.header=new hye,Uc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=lw.string2buf(e.dictionary):uY.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Uc.inflateSetDictionary(this.strm,e.dictionary),t!==cw)))throw new Error(h_[t])}oy.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?dye:uye,uY.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),s=Uc.inflate(t,o),s===yI&&r&&(s=Uc.inflateSetDictionary(t,r),s===cw?s=Uc.inflate(t,o):s===H9&&(s=yI));t.avail_in>0&&s===wI&&t.state.wrap>0&&n[t.next_in]!==0;)Uc.inflateReset(t),s=Uc.inflate(t,o);switch(s){case fye:case H9:case yI:case gye:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===wI))if(this.options.to==="string"){let l=lw.utf8border(t.output,t.next_out),c=t.next_out-l,h=lw.buf2string(t.output,l);t.next_out=c,t.avail_out=i-c,c&&t.output.set(t.output.subarray(l,l+c),0),this.onData(h)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===cw&&a===0)){if(s===wI)return s=Uc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};oy.prototype.onData=function(n){this.chunks.push(n)};oy.prototype.onEnd=function(n){n===cw&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$k.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function n3(n,e){const t=new oy(e);if(t.push(n),t.err)throw t.msg||h_[t.err];return t.result}function pye(n,e){return e=e||{},e.raw=!0,n3(n,e)}var mye=oy,_ye=n3,bye=pye,vye=n3,wye=ry,yye={Inflate:mye,inflate:_ye,inflateRaw:bye,ungzip:vye,constants:wye};const{Inflate:Mze,inflate:Fze,inflateRaw:Cye,ungzip:Oze}=yye;var Sye=Cye;function xye(n){return Sye(n.subarray(2))}let Eye=class extends Error{constructor(e){super(e),this.code="ERR_ABORTED"}};function Dye(n){n.sort((r,s)=>Number(r.offset)-Number(s.offset));const e=[];let t,i;for(const r of n)t&&i&&Number(r.offset)-i<=2e3?(t.length=BigInt(Number(t.length)+Number(r.length)-i+Number(r.offset)),t.blocks.push(r)):e.push(t={blocks:[r],length:r.length,offset:r.offset}),i=Number(t.offset)+Number(t.length);return e}function cC(n){if(n&&n.aborted)if(typeof DOMException>"u"){const e=new Eye("aborted");throw e.code="ERR_ABORTED",e}else throw new DOMException("aborted","AbortError")}const kye=1,Lye=2,Iye=3;function CI(n,e,t,i){return n<i&&e>=t}function Tye(n){const e=n?"big":"little",t=new gi().endianess(e).uint32("chromId").uint32("start").uint32("end").uint32("validCnt").floatle("minScore").floatle("maxScore").floatle("sumData").floatle("sumSqData").saveOffset("offset"),i=new gi().endianess(e).uint8("isLeaf").skip(1).uint16("cnt").choice({tag:"isLeaf",choices:{1:new gi().endianess(e).array("blocksToFetch",{length:"cnt",type:new gi().endianess(e).uint32("startChrom").uint32("startBase").uint32("endChrom").uint32("endBase").uint64("blockOffset").uint64("blockSize").saveOffset("offset")}),0:new gi().array("recurOffsets",{length:"cnt",type:new gi().endianess(e).uint32("startChrom").uint32("startBase").uint32("endChrom").uint32("endBase").uint64("blockOffset").saveOffset("offset")})}}),r=new gi().endianess(e).uint32("chromId").int32("start").int32("end").string("rest",{zeroTerminated:!0}).saveOffset("offset");return{bigWigParser:new gi().endianess(e).skip(4).int32("blockStart").skip(4).uint32("itemStep").uint32("itemSpan").uint8("blockType").skip(1).uint16("itemCount").choice({tag:"blockType",choices:{[Iye]:new gi().array("items",{length:"itemCount",type:new gi().floatle("score")}),[Lye]:new gi().array("items",{length:"itemCount",type:new gi().endianess(e).int32("start").floatle("score")}),[kye]:new gi().array("items",{length:"itemCount",type:new gi().endianess(e).int32("start").int32("end").floatle("score")})}}),bigBedParser:r,summaryParser:t,leafParser:i}}class dY{constructor(e,t,i,r,s,o){if(this.bbi=e,this.refsByName=t,this.cirTreeOffset=i,this.isBigEndian=r,this.isCompressed=s,this.blockType=o,this.featureCache=new Vk({cache:new Y4({maxSize:1e3}),fill:async(l,c)=>{const h=Number(l.length),u=Number(l.offset),{buffer:d}=await this.bbi.read(vr.Buffer.alloc(h),0,h,u,{signal:c});return d}}),!(i>=0))throw new Error("invalid cirTreeOffset!");const a=Tye(r);this.leafParser=a.leafParser,this.bigBedParser=a.bigBedParser}async readWigData(e,t,i,r,s){try{const{refsByName:o,bbi:a,cirTreeOffset:l,isBigEndian:c}=this,h=o[e];h===void 0&&r.complete();const u={chrId:h,start:t,end:i};this.cirTreePromise||(this.cirTreePromise=a.read(vr.Buffer.alloc(48),0,48,Number(l),s));const{buffer:d}=await this.cirTreePromise,f=c?d.readUInt32BE(4):d.readUInt32LE(4);let g=[],p=0;const m=(y,S,k)=>{try{const C=y.subarray(S),D=this.leafParser.parse(C);if(D.blocksToFetch&&(g=g.concat(D.blocksToFetch.filter(E=>b(E)).map(E=>({offset:E.blockOffset,length:E.blockSize})))),D.recurOffsets){const E=D.recurOffsets.filter(N=>b(N)).map(N=>Number(N.blockOffset));E.length>0&&w(E,k+1)}}catch(C){r.error(C)}},b=y=>{const{startChrom:S,startBase:k,endChrom:C,endBase:D}=y;return(S<h||S===h&&k<=i)&&(C>h||C===h&&D>=t)},_=async(y,S,k)=>{try{const C=S.max()-S.min(),D=S.min(),E=await this.featureCache.get(`${C}_${D}`,{length:C,offset:D},s==null?void 0:s.signal);for(const N of y)S.contains(N)&&(m(E,N-D,k),p-=1,p===0&&this.readFeatures(r,g,{...s,request:u}))}catch(C){r.error(C)}},w=(y,S)=>{try{p+=y.length;const k=4+Number(f)*32;let C=new n9(y[0],y[0]+k);for(let D=1;D<y.length;D+=1){const E=new n9(y[D],y[D]+k);C=C.union(E)}C.getRanges().map(D=>_(y,D,S))}catch(k){r.error(k)}};return w([Number(l)+48],1)}catch(o){r.error(o)}}parseSummaryBlock(e,t,i){const r=[];let s=t;const o=new DataView(e.buffer,e.byteOffset,e.length);for(;s<e.byteLength;){const a=o.getUint32(s,!0);s+=4;const l=o.getUint32(s,!0);s+=4;const c=o.getUint32(s,!0);s+=4;const h=o.getUint32(s,!0);s+=4;const u=o.getFloat32(s,!0);s+=4;const d=o.getFloat32(s,!0);s+=4;const f=o.getFloat32(s,!0);s+=4,s+=4,(!i||a===i.chrId&&CI(l,c,i.start,i.end))&&r.push({start:l,end:c,maxScore:d,minScore:u,summary:!0,score:f/(h||1)})}return r}parseBigBedBlock(e,t,i,r){const s=[];let o=t;for(;o<e.byteLength;){const a=this.bigBedParser.parse(e.subarray(o));s.push({...a,uniqueId:`bb-${i+o}`}),o+=a.offset}return r?s.filter(a=>CI(a.start,a.end,r.start,r.end)):s}parseBigWigBlock(e,t,i){const r=e.subarray(t),s=new DataView(r.buffer,r.byteOffset,r.length);let o=0;o+=4;const a=s.getInt32(o,!0);o+=8;const l=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);o+=4;const h=s.getUint8(o);o+=2;const u=s.getUint16(o,!0);o+=2;const d=new Array(u);switch(h){case 1:{for(let f=0;f<u;f++){const g=s.getInt32(o,!0);o+=4;const p=s.getInt32(o,!0);o+=4;const m=s.getFloat32(o,!0);o+=4,d[f]={start:g,end:p,score:m}}break}case 2:{for(let f=0;f<u;f++){const g=s.getInt32(o,!0);o+=4;const p=s.getFloat32(o,!0);o+=4,d[f]={score:p,start:g,end:g+c}}break}case 3:{for(let f=0;f<u;f++){const g=s.getFloat32(o,!0);o+=4;const p=a+f*l;d[f]={score:g,start:p,end:p+c}}break}}return i?d.filter(f=>CI(f.start,f.end,i.start,i.end)):d}async readFeatures(e,t,i={}){try{const{blockType:r,isCompressed:s}=this,{signal:o,request:a}=i,l=Dye(t);cC(o),await Promise.all(l.map(async c=>{cC(o);const{length:h,offset:u}=c,d=await this.featureCache.get(`${h}_${u}`,c,o);for(const f of c.blocks){cC(o);let g=Number(f.offset)-Number(c.offset),p=d;switch(s&&(p=xye(d.subarray(g)),g=0),cC(o),r){case"summary":{e.next(this.parseSummaryBlock(p,g,a));break}case"bigwig":{e.next(this.parseBigWigBlock(p,g,a));break}case"bigbed":{e.next(this.parseBigBedBlock(p,g,Number(f.offset)*(1<<8),a));break}default:console.warn(`Don't know what to do with ${r}`)}}})),e.complete()}catch(r){e.error(r)}}}var mR=function(n,e){return mR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},mR(n,e)};function r3(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mR(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Aye(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function fY(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return l([c,h])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(h){c=[6,h],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function hw(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jx(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,s=[],o;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return s}function eE(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}function mm(n){return this instanceof mm?(this.v=n,this):new mm(n)}function Nye(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(g,p){s.push([d,f,g,p])>1||a(d,f)})})}function a(d,f){try{l(i[d](f))}catch(g){u(s[0][3],g)}}function l(d){d.value instanceof mm?Promise.resolve(d.value.v).then(c,h):u(s[0][2],d)}function c(d){a("next",d)}function h(d){a("throw",d)}function u(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Rye(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof hw=="function"?hw(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){o=n[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}function qn(n){return typeof n=="function"}function gY(n){var e=function(i){Error.call(i),i.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var SI=gY(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function U9(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var s3=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,i,r,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=hw(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else o.remove(this);var h=this.initialTeardown;if(qn(h))try{h()}catch(p){s=p instanceof SI?p.errors:[p]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var d=hw(u),f=d.next();!f.done;f=d.next()){var g=f.value;try{j9(g)}catch(p){s=s??[],p instanceof SI?s=eE(eE([],Jx(s)),Jx(p.errors)):s.push(p)}}}catch(p){i={error:p}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}if(s)throw new SI(s)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)j9(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&U9(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&U9(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}();s3.EMPTY;function pY(n){return n instanceof s3||n&&"closed"in n&&qn(n.remove)&&qn(n.add)&&qn(n.unsubscribe)}function j9(n){qn(n)?n():n.unsubscribe()}var mY={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},_R={setTimeout:function(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];var r=_R.delegate;return r!=null&&r.setTimeout?r.setTimeout.apply(r,eE([n,e],Jx(t))):setTimeout.apply(void 0,eE([n,e],Jx(t)))},clearTimeout:function(n){var e=_R.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function _Y(n){_R.setTimeout(function(){throw n})}function q9(){}function Mye(n){n()}var o3=function(n){r3(e,n);function e(t){var i=n.call(this)||this;return i.isStopped=!1,t?(i.destination=t,pY(t)&&t.add(i)):i.destination=Bye,i}return e.create=function(t,i,r){return new tE(t,i,r)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(s3),Fye=Function.prototype.bind;function xI(n,e){return Fye.call(n,e)}var Oye=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(i){hC(i)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(i){hC(i)}else hC(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){hC(t)}},n}(),tE=function(n){r3(e,n);function e(t,i,r){var s=n.call(this)||this,o;if(qn(t)||!t)o={next:t??void 0,error:i??void 0,complete:r??void 0};else{var a;s&&mY.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return s.unsubscribe()},o={next:t.next&&xI(t.next,a),error:t.error&&xI(t.error,a),complete:t.complete&&xI(t.complete,a)}):o=t}return s.destination=new Oye(o),s}return e}(o3);function hC(n){_Y(n)}function Pye(n){throw n}var Bye={closed:!0,next:q9,error:Pye,complete:q9},a3=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function bY(n){return n}function Vye(n){return n.length===0?bY:n.length===1?n[0]:function(t){return n.reduce(function(i,r){return r(i)},t)}}var la=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,i){var r=this,s=$ye(e)?e:new tE(e,t,i);return Mye(function(){var o=r,a=o.operator,l=o.source;s.add(a?a.call(s,l):l?r._subscribe(s):r._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var i=this;return t=G9(t),new t(function(r,s){var o=new tE({next:function(a){try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});i.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[a3]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vye(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=G9(e),new e(function(i,r){var s;t.subscribe(function(o){return s=o},function(o){return r(o)},function(){return i(s)})})},n.create=function(e){return new n(e)},n}();function G9(n){var e;return(e=n??mY.Promise)!==null&&e!==void 0?e:Promise}function Wye(n){return n&&qn(n.next)&&qn(n.error)&&qn(n.complete)}function $ye(n){return n&&n instanceof o3||Wye(n)&&pY(n)}function zye(n){return qn(n==null?void 0:n.lift)}function c0(n){return function(e){if(zye(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function uw(n,e,t,i,r){return new Hye(n,e,t,i,r)}var Hye=function(n){r3(e,n);function e(t,i,r,s,o,a){var l=n.call(this,t)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=i?function(c){try{i(c)}catch(h){t.error(h)}}:n.prototype._next,l._error=s?function(c){try{s(c)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;n.prototype.unsubscribe.call(this),!i&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(o3),Uye=new la(function(n){return n.complete()});function jye(n){return n&&qn(n.schedule)}function vY(n){return n[n.length-1]}function qye(n){return jye(vY(n))?n.pop():void 0}function Gye(n,e){return typeof vY(n)=="number"?n.pop():e}var wY=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function yY(n){return qn(n==null?void 0:n.then)}function CY(n){return qn(n[a3])}function SY(n){return Symbol.asyncIterator&&qn(n==null?void 0:n[Symbol.asyncIterator])}function xY(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Kye(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var EY=Kye();function DY(n){return qn(n==null?void 0:n[EY])}function kY(n){return Nye(this,arguments,function(){var t,i,r,s;return fY(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,mm(t.read())];case 3:return i=o.sent(),r=i.value,s=i.done,s?[4,mm(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,mm(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function LY(n){return qn(n==null?void 0:n.getReader)}function h0(n){if(n instanceof la)return n;if(n!=null){if(CY(n))return Zye(n);if(wY(n))return Yye(n);if(yY(n))return Xye(n);if(SY(n))return IY(n);if(DY(n))return Qye(n);if(LY(n))return Jye(n)}throw xY(n)}function Zye(n){return new la(function(e){var t=n[a3]();if(qn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Yye(n){return new la(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Xye(n){return new la(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,_Y)})}function Qye(n){return new la(function(e){var t,i;try{for(var r=hw(n),s=r.next();!s.done;s=r.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){t={error:a}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}e.complete()})}function IY(n){return new la(function(e){eCe(n,e).catch(function(t){return e.error(t)})})}function Jye(n){return IY(kY(n))}function eCe(n,e){var t,i,r,s;return Aye(this,void 0,void 0,function(){var o,a;return fY(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Rye(n),l.label=1;case 1:return[4,t.next()];case 2:if(i=l.sent(),!!i.done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),r={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function yu(n,e,t,i,r){i===void 0&&(i=0),r===void 0&&(r=!1);var s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function TY(n,e){return e===void 0&&(e=0),c0(function(t,i){t.subscribe(uw(i,function(r){return yu(i,n,function(){return i.next(r)},e)},function(){return yu(i,n,function(){return i.complete()},e)},function(r){return yu(i,n,function(){return i.error(r)},e)}))})}function AY(n,e){return e===void 0&&(e=0),c0(function(t,i){i.add(n.schedule(function(){return t.subscribe(i)},e))})}function tCe(n,e){return h0(n).pipe(AY(e),TY(e))}function iCe(n,e){return h0(n).pipe(AY(e),TY(e))}function nCe(n,e){return new la(function(t){var i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function rCe(n,e){return new la(function(t){var i;return yu(t,e,function(){i=n[EY](),yu(t,e,function(){var r,s,o;try{r=i.next(),s=r.value,o=r.done}catch(a){t.error(a);return}o?t.complete():t.next(s)},0,!0)}),function(){return qn(i==null?void 0:i.return)&&i.return()}})}function NY(n,e){if(!n)throw new Error("Iterable cannot be null");return new la(function(t){yu(t,e,function(){var i=n[Symbol.asyncIterator]();yu(t,e,function(){i.next().then(function(r){r.done?t.complete():t.next(r.value)})},0,!0)})})}function sCe(n,e){return NY(kY(n),e)}function oCe(n,e){if(n!=null){if(CY(n))return tCe(n,e);if(wY(n))return nCe(n,e);if(yY(n))return iCe(n,e);if(SY(n))return NY(n,e);if(DY(n))return rCe(n,e);if(LY(n))return sCe(n,e)}throw xY(n)}function aCe(n,e){return e?oCe(n,e):h0(n)}var lCe=gY(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function RY(n,e){var t=typeof e=="object";return new Promise(function(i,r){var s=new tE({next:function(o){i(o),s.unsubscribe()},error:r,complete:function(){t?i(e.defaultValue):r(new lCe)}});n.subscribe(s)})}function MY(n,e){return c0(function(t,i){var r=0;t.subscribe(uw(i,function(s){i.next(n.call(e,s,r++))}))})}function cCe(n,e,t,i,r,s,o,a){var l=[],c=0,h=0,u=!1,d=function(){u&&!l.length&&!c&&e.complete()},f=function(p){return c<i?g(p):l.push(p)},g=function(p){s&&e.next(p),c++;var m=!1;h0(t(p,h++)).subscribe(uw(e,function(b){r==null||r(b),s?f(b):e.next(b)},function(){m=!0},void 0,function(){if(m)try{c--;for(var b=function(){var _=l.shift();o?yu(e,o,function(){return g(_)}):g(_)};l.length&&c<i;)b();d()}catch(_){e.error(_)}}))};return n.subscribe(uw(e,f,function(){u=!0,d()})),function(){a==null||a()}}function FY(n,e,t){return t===void 0&&(t=1/0),qn(e)?FY(function(i,r){return MY(function(s,o){return e(i,s,r,o)})(h0(n(i,r)))},t):(typeof e=="number"&&(t=e),c0(function(i,r){return cCe(i,r,n,t)}))}function hCe(n){return n===void 0&&(n=1/0),FY(bY,n)}function uCe(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=qye(n),i=Gye(n,1/0),r=n;return r.length?r.length===1?h0(r[0]):hCe(i)(aCe(r,t)):Uye}function dCe(n,e,t,i,r){return function(s,o){var a=t,l=e,c=0;s.subscribe(uw(o,function(h){var u=c++;l=a?n(l,h,u):(a=!0,h),i&&o.next(l)},r&&function(){a&&o.next(l),o.complete()}))}}function OY(n,e){return c0(dCe(n,e,arguments.length>=2,!1,!0))}var fCe=function(n,e){return n.push(e),n};function gCe(){return c0(function(n,e){OY(fCe,[])(n).subscribe(e)})}const K9=-2003829722,EI=-2021002517;function pCe(n){return new TextDecoder().decode(n)}function Z9(n){const e=n?"big":"little",t=new gi().endianess(e).int32("magic").uint16("version").uint16("numZoomLevels").uint64("chromTreeOffset").uint64("unzoomedDataOffset").uint64("unzoomedIndexOffset").uint16("fieldCount").uint16("definedFieldCount").uint64("asOffset").uint64("totalSummaryOffset").uint32("uncompressBufSize").uint64("extHeaderOffset").array("zoomLevels",{length:"numZoomLevels",type:new gi().endianess(e).uint32("reductionLevel").uint32("reserved").uint64("dataOffset").uint64("indexOffset")}),i=new gi().endianess(e).uint64("basesCovered").doublele("scoreMin").doublele("scoreMax").doublele("scoreSum").doublele("scoreSumSquares"),r=new gi().endianess(e).uint32("magic").uint32("blockSize").uint32("keySize").uint32("valSize").uint64("itemCount"),s=new gi().endianess(e).uint8("isLeafNode").skip(1).uint16("cnt").saveOffset("offset");return{chromTreeParser:r,totalSummaryParser:i,headerParser:t,isLeafNode:s}}class PY{getHeader(e){return this.headerP||(this.headerP=this._getHeader(e).catch(t=>{throw this.headerP=void 0,t})),this.headerP}constructor(e){const{filehandle:t,renameRefSeqs:i=o=>o,path:r,url:s}=e;if(this.renameRefSeqs=i,t)this.bbi=t;else if(s)this.bbi=new Vl(s);else if(r)this.bbi=new no(r);else throw new Error("no file given")}async _getHeader(e){const t=await this._getMainHeader(e),i=await this._readChromTree(t,e);return{...t,...i}}async _getMainHeader(e,t=2e3){const{buffer:i}=await this.bbi.read(vr.Buffer.alloc(t),0,t,0,e),r=this._isBigEndian(i),s=Z9(r),o=s.headerParser.parse(i),{magic:a,asOffset:l,totalSummaryOffset:c}=o;if(o.fileType=a===EI?"bigbed":"bigwig",l>t||c>t)return this._getMainHeader(e,t*2);if(l){const h=Number(o.asOffset);o.autoSql=pCe(i.subarray(h,i.indexOf(0,h)))}if(o.totalSummaryOffset>t)return this._getMainHeader(e,t*2);if(o.totalSummaryOffset){const h=i.subarray(Number(o.totalSummaryOffset)),u=s.totalSummaryParser.parse(h);o.totalSummary={...u,basesCovered:Number(u.basesCovered)}}return{...o,isBigEndian:r}}_isBigEndian(e){let t=e.readInt32LE(0);if(t===K9||t===EI)return!1;if(t=e.readInt32BE(0),t===K9||t===EI)return!0;throw new Error("not a BigWig/BigBed file")}async _readChromTree(e,t){const i=e.isBigEndian,r=i?"big":"little",s=[],o={};let a=Number(e.unzoomedDataOffset);const l=Number(e.chromTreeOffset);for(;a%4!==0;)a+=1;const c=a-l,{buffer:h}=await this.bbi.read(vr.Buffer.alloc(c),0,c,Number(l),t),u=Z9(i),{keySize:d}=u.chromTreeParser.parse(h),f=new gi().endianess(r).string("key",{stripNull:!0,length:d}).uint32("refId").uint32("refSize").saveOffset("offset"),g=new gi().endianess(r).skip(d).uint64("childOffset").saveOffset("offset"),p=32,m=async b=>{let _=b;if(_>=h.length)throw new Error("reading beyond end of buffer");const w=u.isLeafNode.parse(h.subarray(_)),{isLeafNode:y,cnt:S}=w;if(_+=w.offset,y)for(let k=0;k<S;k+=1){const C=f.parse(h.subarray(_));_+=C.offset;const{key:D,refId:E,refSize:N}=C,T={name:D,id:E,length:N};o[this.renameRefSeqs(D)]=E,s[E]=T}else{const k=[];for(let C=0;C<S;C+=1){const D=g.parse(h.subarray(_)),{childOffset:E}=D;_+=D.offset,k.push(m(Number(E)-Number(l)))}await Promise.all(k)}};return await m(p),{refsByName:o,refsByNumber:s}}async getUnzoomedView(e){const{unzoomedIndexOffset:t,refsByName:i,uncompressBufSize:r,isBigEndian:s,fileType:o}=await this.getHeader(e);return new dY(this.bbi,i,t,s,r>0,o)}async getFeatureStream(e,t,i,r){await this.getHeader(r);const s=this.renameRefSeqs(e);let o;const{basesPerSpan:a,scale:l}=r||{};return a?o=await this.getView(1/a,r):l?o=await this.getView(l,r):o=await this.getView(1,r),new la(c=>{o.readWigData(s,t,i,c,r)})}async getFeatures(e,t,i,r){const s=await this.getFeatureStream(e,t,i,r);return(await RY(s.pipe(gCe()))).flat()}}class mCe extends PY{async getView(e,t){const{zoomLevels:i,refsByName:r,fileSize:s,isBigEndian:o,uncompressBufSize:a}=await this.getHeader(t),l=1/e;let c=i.length;s||(c-=1);for(let h=c;h>=0;h-=1){const u=i[h];if(u&&u.reductionLevel<=2*l){const d=Number(u.indexOffset);return new dY(this.bbi,r,d,o,a>0,"summary")}}return this.getUnzoomedView(t)}}function _Ce(n){return n.filter(e=>!!e)}class bCe extends PY{constructor(){super(...arguments),this.readIndicesCache=new Vk({cache:new Y4({maxSize:1}),fill:(e,t)=>this._readIndices({...e,signal:t})})}readIndices(e={}){const{signal:t,...i}=e;return this.readIndicesCache.get(JSON.stringify(i),e,t)}async getView(e,t){return this.getUnzoomedView(t)}async _readIndices(e){const{extHeaderOffset:t,isBigEndian:i}=await this.getHeader(e),{buffer:r}=await this.bbi.read(vr.Buffer.alloc(64),0,64,Number(t)),s=i?"big":"little",o=new gi().endianess(s).uint16("size").uint16("count").uint64("offset").parse(r),{count:a,offset:l}=o;if(a===0)return[];const c=20,h=c*a,{buffer:u}=await this.bbi.read(vr.Buffer.alloc(h),0,h,Number(l)),d=new gi().endianess(s).int16("type").int16("fieldcount").uint64("offset").skip(4).int16("field"),f=[];for(let g=0;g<a;g+=1)f.push(d.parse(u.subarray(g*c)));return f}async searchExtraIndexBlocks(e,t={}){const{isBigEndian:i}=await this.getHeader(t),r=await this.readIndices(t);if(r.length===0)return[];const s=r.map(async o=>{const{offset:a,field:l}=o,{buffer:c}=await this.bbi.read(vr.Buffer.alloc(32),0,32,Number(a),t),h=i?"big":"little",u=new gi().endianess(h).int32("magic").int32("blockSize").int32("keySize").int32("valSize").uint64("itemCount"),{blockSize:d,keySize:f,valSize:g}=u.parse(c),p=new gi().endianess(h).int8("nodeType").skip(1).int16("cnt").choice({tag:"nodeType",choices:{0:new gi().array("leafkeys",{length:"cnt",type:new gi().endianess(h).string("key",{length:f,stripNull:!0}).uint64("offset")}),1:new gi().array("keys",{length:"cnt",type:new gi().endianess(h).string("key",{length:f,stripNull:!0}).uint64("offset").uint32("length").uint32("reserved")})}}),m=async _=>{const w=Number(_),y=4+d*(f+g),{buffer:S}=await this.bbi.read(vr.Buffer.alloc(y),0,y,w,t),k=p.parse(S);if(k.leafkeys){let C;for(let D=0;D<k.leafkeys.length;D+=1){const{key:E}=k.leafkeys[D];if(e.localeCompare(E)<0&&C)return m(C);C=k.leafkeys[D].offset}return m(C)}for(let C=0;C<k.keys.length;C+=1)if(k.keys[C].key===e)return{...k.keys[C],field:l}},b=32;return m(Number(a)+b)});return _Ce(await Promise.all(s))}async searchExtraIndex(e,t={}){const i=await this.searchExtraIndexBlocks(e,t);if(i.length===0)return[];const r=await this.getUnzoomedView(t),s=i.map(a=>new la(l=>{r.readFeatures(l,[a],t)}).pipe(OY((l,c)=>l.concat(c)),MY(l=>{for(const c of l)c.field=a.field;return l})));return(await RY(uCe(...s))).filter(a=>{var l;return((l=a.rest)===null||l===void 0?void 0:l.split("	")[(a.field||0)-3])===e})}}function ay(n,e,t=!0){let i,r=o=>{};return function(...a){return new Promise((l,c)=>{const h=()=>{clearTimeout(i),r=u=>{},l(n(...a))};t&&r("debounced"),clearTimeout(i),r=c,i=window.setTimeout(h,e)})}}class vCe extends ey(Ig){constructor(t,i){const r={pixelsPerBin:2,channel:"x",...t};super(i,r.channel);dr(this,"reductionLevels",[]);dr(this,"lastRequestId",0);if(this.params=r,!this.params.url)throw new Error("No URL provided for BigWigSource");this.bbi=new mCe({filehandle:new Vl(ty(this.params.url,this.view.getBaseUrl()))}),this.doDebouncedRequest=ay(this.doRequest.bind(this),200,!1),this.headerPromise=this.bbi.getHeader(),this.headerPromise.then(s=>{this.reductionLevels=s.zoomLevels.map(o=>o.reductionLevel).reverse(),this.reductionLevels.push(1)})}async onDomainChanged(t){await this.headerPromise;const i=this.getAxisLength()||700,r=wCe(t,i,this.reductionLevels),s=Math.max(r*i,5e3),o=this.quantizeInterval(t,s);this.checkAndUpdateLastInterval(o)&&this.doDebouncedRequest(o,r)}async doRequest(t,i){const r=await this.getFeatures(t,.5/i/this.params.pixelsPerBin);r.requestId<this.lastRequestId||this.publishData(r.features)}async getFeatures(t,i){let r=++this.lastRequestId;const s=new AbortController,o=this.genome.continuousToDiscreteChromosomeIntervals(t),a=await Promise.all(o.map(l=>this.bbi.getFeatures(l.chrom,l.startPos,l.endPos,{scale:i,signal:s.signal}).then(c=>c.map(h=>({chrom:l.chrom,start:h.start,end:h.end,score:h.score})))));return{requestId:r,abort:()=>s.abort(),features:a.flat()}}}function wCe(n,e,t){const i=(n[1]-n[0])/e;return t.find(r=>r<i)??t.at(-1)}function yCe(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function f_(n,e,t,i){this.message=n,this.expected=e,this.found=t,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,f_)}yCe(f_,Error);f_.buildMessage=function(n,e){var t={literal:function(c){return'"'+r(c.text)+'"'},class:function(c){var h="",u;for(u=0;u<c.parts.length;u++)h+=c.parts[u]instanceof Array?s(c.parts[u][0])+"-"+s(c.parts[u][1]):s(c.parts[u]);return"["+(c.inverted?"^":"")+h+"]"},any:function(c){return"any character"},end:function(c){return"end of input"},other:function(c){return c.description}};function i(c){return c.charCodeAt(0).toString(16).toUpperCase()}function r(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+i(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+i(h)})}function s(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(h){return"\\x0"+i(h)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(h){return"\\x"+i(h)})}function o(c){return t[c.type](c)}function a(c){var h=new Array(c.length),u,d;for(u=0;u<c.length;u++)h[u]=o(c[u]);if(h.sort(),h.length>0){for(u=1,d=1;u<h.length;u++)h[u-1]!==h[u]&&(h[d]=h[u],d++);h.length=d}switch(h.length){case 1:return h[0];case 2:return h[0]+" or "+h[1];default:return h.slice(0,-1).join(", ")+", or "+h[h.length-1]}}function l(c){return c?'"'+r(c)+'"':"end of input"}return"Expected "+a(n)+" but "+l(e)+" found."};function CCe(n,e){e=e!==void 0?e:{};var t={},i={declaration:Xi},r=Xi,s="(",o=J("(",!1),a=")",l=J(")",!1),c=function(B,ce,Fe,Be){return{type:B,name:ce,comment:Fe,fields:Be}},h="simple",u=J("simple",!1),d="object",f=J("object",!1),g="table",p=J("table",!1),m="auto",b=J("auto",!1),_="primary",w=J("primary",!1),y="index",S=J("index",!1),k="unique",C=J("unique",!1),D=function(B,ce){return ce},E=function(B,ce){return B.name&&ce.unshift(B),ce},N="#",T=J("#",!1),j=";",q=J(";",!1),ie=function(B,ce,Fe){return{type:B,name:ce,comment:Fe}},ge="[",be=J("[",!1),Se="]",Le=J("]",!1),ke=function(B,ce,Fe,Be){return{type:B,size:ce,name:Fe,comment:Be}},Lt=function(B,ce,Fe,Be){return{type:B,vals:ce,name:Fe,comment:Be}},Ge=",",Je=J(",",!1),Ct=function(B,ce){return ce.unshift(B),ce},ut="int",Ai=J("int",!1),te="uint",ee=J("uint",!1),pe="short",se=J("short",!1),De="ushort",O=J("ushort",!1),I="byte",ue=J("byte",!1),_e="ubyte",at=J("ubyte",!1),ze="float",lt=J("float",!1),fn="char",Us=J("char",!1),Qr="string",kr=J("string",!1),Wi="lstring",Vn=J("lstring",!1),Lr="enum",Nn=J("enum",!1),Ir="double",R=J("double",!1),x="bigint",L=J("bigint",!1),$="set",K=J("set",!1),ne=function(B,ce){return B+" "+ce},fe=/^[a-zA-Z_]/,tt=oe([["a","z"],["A","Z"],"_"],!1,!1),Zt=/^[a-zA-Z0-9_]/,Ht=oe([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ci=function(B){return U()},Bt=/^[^\n\r]/,vc=oe([`
`,"\r"],!0,!1),cl=function(B){return B.join("").replace(/^"/,"").replace(/"$/,"")},ip=He("integer"),Jr=/^[0-9]/,md=oe([["0","9"]],!1,!1),np=function(){return parseInt(U(),10)},rp=He("whitespace"),gt=/^[ \t\n\r]/,hl=oe([" ","	",`
`,"\r"],!1,!1),M=0,Y=0,Q=[{line:1,column:1}],F=0,W=[],P=0,A;if("startRule"in e){if(!(e.startRule in i))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');r=i[e.startRule]}function U(){return n.substring(Y,M)}function J(B,ce){return{type:"literal",text:B,ignoreCase:ce}}function oe(B,ce,Fe){return{type:"class",parts:B,inverted:ce,ignoreCase:Fe}}function Ee(){return{type:"end"}}function He(B){return{type:"other",description:B}}function Ke(B){var ce=Q[B],Fe;if(ce)return ce;for(Fe=B-1;!Q[Fe];)Fe--;for(ce=Q[Fe],ce={line:ce.line,column:ce.column};Fe<B;)n.charCodeAt(Fe)===10?(ce.line++,ce.column=1):ce.column++,Fe++;return Q[B]=ce,ce}function et(B,ce){var Fe=Ke(B),Be=Ke(ce);return{start:{offset:B,line:Fe.line,column:Fe.column},end:{offset:ce,line:Be.line,column:Be.column}}}function we(B){M<F||(M>F&&(F=M,W=[]),W.push(B))}function Ve(B,ce,Fe){return new f_(f_.buildMessage(B,ce),B,ce,Fe)}function Xi(){var B,ce,Fe,Be,rt,Ni,Qi,yo,Th,yc,Ah,Cc,Nh,Sc;return B=M,ce=Yt(),ce!==t?(Fe=It(),Fe!==t?(Be=Yt(),Be!==t?(rt=Jn(),rt!==t?(Ni=Yt(),Ni!==t?(Qi=gn(),Qi!==t?(yo=Yt(),yo!==t?(n.charCodeAt(M)===40?(Th=s,M++):(Th=t,P===0&&we(o)),Th!==t?(yc=Yt(),yc!==t?(Ah=_d(),Ah!==t?(Cc=Yt(),Cc!==t?(n.charCodeAt(M)===41?(Nh=a,M++):(Nh=t,P===0&&we(l)),Nh!==t?(Sc=Yt(),Sc!==t?(Y=B,ce=c(Fe,rt,Qi,Ah),B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t),B}function It(){var B;return n.substr(M,6)===h?(B=h,M+=6):(B=t,P===0&&we(u)),B===t&&(n.substr(M,6)===d?(B=d,M+=6):(B=t,P===0&&we(f)),B===t&&(n.substr(M,5)===g?(B=g,M+=5):(B=t,P===0&&we(p)))),B}function Jn(){var B,ce,Fe,Be;return B=ua(),B===t&&(B=M,ce=ua(),ce!==t?(Fe=wc(),Fe!==t?(ce=[ce,Fe],B=ce):(M=B,B=t)):(M=B,B=t),B===t&&(B=M,ce=ua(),ce!==t?(n.substr(M,4)===m?(Fe=m,M+=4):(Fe=t,P===0&&we(b)),Fe!==t?(ce=[ce,Fe],B=ce):(M=B,B=t)):(M=B,B=t),B===t&&(B=M,ce=ua(),ce!==t?(Fe=wc(),Fe!==t?(n.substr(M,4)===m?(Be=m,M+=4):(Be=t,P===0&&we(b)),Be!==t?(ce=[ce,Fe,Be],B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)))),B}function wc(){var B;return n.substr(M,7)===_?(B=_,M+=7):(B=t,P===0&&we(w)),B===t&&(n.substr(M,5)===y?(B=y,M+=5):(B=t,P===0&&we(S)),B===t&&(n.substr(M,6)===k?(B=k,M+=6):(B=t,P===0&&we(C)))),B}function gn(){var B;return B=UB(),B===t&&(B=Yt()),B}function _d(){var B,ce,Fe,Be,rt,Ni,Qi;if(B=M,ce=vd(),ce!==t)if(Fe=Yt(),Fe!==t){for(Be=[],rt=M,Ni=Yt(),Ni!==t?(Qi=vd(),Qi!==t?(Y=rt,Ni=D(ce,Qi),rt=Ni):(M=rt,rt=t)):(M=rt,rt=t);rt!==t;)Be.push(rt),rt=M,Ni=Yt(),Ni!==t?(Qi=vd(),Qi!==t?(Y=rt,Ni=D(ce,Qi),rt=Ni):(M=rt,rt=t)):(M=rt,rt=t);Be!==t?(rt=Yt(),rt!==t?(Y=B,ce=E(ce,Be),B=ce):(M=B,B=t)):(M=B,B=t)}else M=B,B=t;else M=B,B=t;return B}function Oy(){var B;return n.charCodeAt(M)===35?(B=N,M++):(B=t,P===0&&we(T)),B}function bd(){var B,ce,Fe,Be,rt;return B=M,ce=Yt(),ce!==t?(Fe=Oy(),Fe!==t?(Be=UB(),Be!==t?(rt=Yt(),rt!==t?(ce=[ce,Fe,Be,rt],B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t),B}function vd(){var B,ce,Fe,Be,rt,Ni,Qi,yo,Th,yc,Ah,Cc,Nh,Sc;return B=M,ce=sp(),ce!==t?(Fe=Yt(),Fe!==t?(Be=ua(),Be!==t?(rt=Yt(),rt!==t?(n.charCodeAt(M)===59?(Ni=j,M++):(Ni=t,P===0&&we(q)),Ni!==t?(Qi=Yt(),Qi!==t?(yo=gn(),yo!==t?(Y=B,ce=ie(ce,Be,yo),B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t),B===t&&(B=M,ce=sp(),ce!==t?(Fe=Yt(),Fe!==t?(n.charCodeAt(M)===91?(Be=ge,M++):(Be=t,P===0&&we(be)),Be!==t?(rt=Yt(),rt!==t?(Ni=lre(),Ni!==t?(Qi=Yt(),Qi!==t?(n.charCodeAt(M)===93?(yo=Se,M++):(yo=t,P===0&&we(Le)),yo!==t?(Th=Yt(),Th!==t?(yc=ua(),yc!==t?(Ah=Yt(),Ah!==t?(n.charCodeAt(M)===59?(Cc=j,M++):(Cc=t,P===0&&we(q)),Cc!==t?(Nh=Yt(),Nh!==t?(Sc=gn(),Sc!==t?(Y=B,ce=ke(ce,Ni,yc,Sc),B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t),B===t&&(B=M,ce=sp(),ce!==t?(Fe=Yt(),Fe!==t?(n.charCodeAt(M)===40?(Be=s,M++):(Be=t,P===0&&we(o)),Be!==t?(rt=Yt(),rt!==t?(Ni=Py(),Ni!==t?(Qi=Yt(),Qi!==t?(n.charCodeAt(M)===41?(yo=a,M++):(yo=t,P===0&&we(l)),yo!==t?(Th=Yt(),Th!==t?(yc=ua(),yc!==t?(Ah=Yt(),Ah!==t?(n.charCodeAt(M)===59?(Cc=j,M++):(Cc=t,P===0&&we(q)),Cc!==t?(Nh=Yt(),Nh!==t?(Sc=gn(),Sc!==t?(Y=B,ce=Lt(ce,Ni,yc,Sc),B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t)):(M=B,B=t),B===t&&(B=bd()))),B}function Py(){var B,ce,Fe,Be,rt,Ni,Qi;if(B=M,ce=ua(),ce!==t){for(Fe=[],Be=M,n.charCodeAt(M)===44?(rt=Ge,M++):(rt=t,P===0&&we(Je)),rt!==t?(Ni=Yt(),Ni!==t?(Qi=ua(),Qi!==t?(Y=Be,rt=D(ce,Qi),Be=rt):(M=Be,Be=t)):(M=Be,Be=t)):(M=Be,Be=t);Be!==t;)Fe.push(Be),Be=M,n.charCodeAt(M)===44?(rt=Ge,M++):(rt=t,P===0&&we(Je)),rt!==t?(Ni=Yt(),Ni!==t?(Qi=ua(),Qi!==t?(Y=Be,rt=D(ce,Qi),Be=rt):(M=Be,Be=t)):(M=Be,Be=t)):(M=Be,Be=t);Fe!==t?(Y=B,ce=Ct(ce,Fe),B=ce):(M=B,B=t)}else M=B,B=t;return B}function sp(){var B,ce,Fe,Be;return n.substr(M,3)===ut?(B=ut,M+=3):(B=t,P===0&&we(Ai)),B===t&&(n.substr(M,4)===te?(B=te,M+=4):(B=t,P===0&&we(ee)),B===t&&(n.substr(M,5)===pe?(B=pe,M+=5):(B=t,P===0&&we(se)),B===t&&(n.substr(M,6)===De?(B=De,M+=6):(B=t,P===0&&we(O)),B===t&&(n.substr(M,4)===I?(B=I,M+=4):(B=t,P===0&&we(ue)),B===t&&(n.substr(M,5)===_e?(B=_e,M+=5):(B=t,P===0&&we(at)),B===t&&(n.substr(M,5)===ze?(B=ze,M+=5):(B=t,P===0&&we(lt)),B===t&&(n.substr(M,4)===fn?(B=fn,M+=4):(B=t,P===0&&we(Us)),B===t&&(n.substr(M,6)===Qr?(B=Qr,M+=6):(B=t,P===0&&we(kr)),B===t&&(n.substr(M,7)===Wi?(B=Wi,M+=7):(B=t,P===0&&we(Vn)),B===t&&(n.substr(M,4)===Lr?(B=Lr,M+=4):(B=t,P===0&&we(Nn)),B===t&&(n.substr(M,6)===Ir?(B=Ir,M+=6):(B=t,P===0&&we(R)),B===t&&(n.substr(M,6)===x?(B=x,M+=6):(B=t,P===0&&we(L)),B===t&&(n.substr(M,3)===$?(B=$,M+=3):(B=t,P===0&&we(K)),B===t&&(B=M,ce=It(),ce!==t?(Fe=Yt(),Fe!==t?(Be=Jn(),Be!==t?(Y=B,ce=ne(ce,Be),B=ce):(M=B,B=t)):(M=B,B=t)):(M=B,B=t))))))))))))))),B}function lre(){var B;return B=cre(),B===t&&(B=ua()),B}function ua(){var B,ce,Fe,Be,rt;if(B=M,ce=M,fe.test(n.charAt(M))?(Fe=n.charAt(M),M++):(Fe=t,P===0&&we(tt)),Fe!==t){for(Be=[],Zt.test(n.charAt(M))?(rt=n.charAt(M),M++):(rt=t,P===0&&we(Ht));rt!==t;)Be.push(rt),Zt.test(n.charAt(M))?(rt=n.charAt(M),M++):(rt=t,P===0&&we(Ht));Be!==t?(Fe=[Fe,Be],ce=Fe):(M=ce,ce=t)}else M=ce,ce=t;return ce!==t&&(Y=B,ce=ci()),B=ce,B}function UB(){var B,ce,Fe;for(B=M,ce=[],Bt.test(n.charAt(M))?(Fe=n.charAt(M),M++):(Fe=t,P===0&&we(vc));Fe!==t;)ce.push(Fe),Bt.test(n.charAt(M))?(Fe=n.charAt(M),M++):(Fe=t,P===0&&we(vc));return ce!==t&&(Y=B,ce=cl(ce)),B=ce,B}function cre(){var B,ce,Fe,Be;if(P++,B=M,ce=Yt(),ce!==t){if(Fe=[],Jr.test(n.charAt(M))?(Be=n.charAt(M),M++):(Be=t,P===0&&we(md)),Be!==t)for(;Be!==t;)Fe.push(Be),Jr.test(n.charAt(M))?(Be=n.charAt(M),M++):(Be=t,P===0&&we(md));else Fe=t;Fe!==t?(Y=B,ce=np(),B=ce):(M=B,B=t)}else M=B,B=t;return P--,B===t&&(ce=t,P===0&&we(ip)),B}function Yt(){var B,ce;for(P++,B=[],gt.test(n.charAt(M))?(ce=n.charAt(M),M++):(ce=t,P===0&&we(hl));ce!==t;)B.push(ce),gt.test(n.charAt(M))?(ce=n.charAt(M),M++):(ce=t,P===0&&we(hl));return P--,B===t&&(ce=t,P===0&&we(rp)),B}if(A=r(),A!==t&&M===n.length)return A;throw A!==t&&M<n.length&&we(Ee()),Ve(W,F<n.length?n.charAt(F):null,F<n.length?et(F,F+1):et(F,F))}var BY={SyntaxError:f_,parse:CCe};const SCe=Tg(BY),xCe=`table bigChain
"bigChain pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - for strand"
    uint tSize;         "size of target sequence"
    string qName;       "name of query sequence"
    uint qSize;         "size of query sequence"
    uint qStart;        "start of alignment on query sequence"
    uint qEnd;          "end of alignment on query sequence"
    uint chainScore;    "score from chain"
    )`,ECe=`table bigGenePred
"bigGenePred gene models"
   (
   string chrom;       "Reference sequence chromosome or scaffold"
   uint   chromStart;  "Start position in chromosome"
   uint   chromEnd;    "End position in chromosome"
   string name;        "Name or ID of item, ideally both human readable and unique"
   uint score;         "Score (0-1000)"
   char[1] strand;     "+ or - for strand"
   uint thickStart;    "Start of where display should be thick (start codon)"
   uint thickEnd;      "End of where display should be thick (stop codon)"
   uint reserved;       "RGB value (use R,G,B string in input file)"
   int blockCount;     "Number of blocks"
   int[blockCount] blockSizes; "Comma separated list of block sizes"
   int[blockCount] chromStarts; "Start positions relative to chromStart"
   string name2;       "Alternative/human readable name"
   string cdsStartStat; "Status of CDS start annotation (none, unknown, incomplete, or complete)"
   string cdsEndStat;   "Status of CDS end annotation (none, unknown, incomplete, or complete)"
   int[blockCount] exonFrames; "Exon frame {0,1,2}, or -1 if no frame for exon"
   string type;        "Transcript type"
   string geneName;    "Primary identifier for gene"
   string geneName2;   "Alternative/human readable gene name"
   string geneType;    "Gene type"
   )`,DCe=`table interact
"interaction between two regions"
    (
    string chrom;        "Chromosome (or contig, scaffold, etc.). For interchromosomal, use 2 records"
    uint chromStart;     "Start position of lower region. For interchromosomal, set to chromStart of this region"
    uint chromEnd;       "End position of upper region. For interchromosomal, set to chromEnd of this region"
    string name;         "Name of item, for display.  Usually 'sourceName/targetName/exp' or empty"
    uint score;          "Score (0-1000)"
    double value;        "Strength of interaction or other data value. Typically basis for score"
    string exp;          "Experiment name (metadata for filtering). Use . if not applicable"
    string color;        "Item color.  Specified as r,g,b or hexadecimal #RRGGBB or html color name, as in //www.w3.org/TR/css3-color/#html4. Use 0 and spectrum setting to shade by score"
    string sourceChrom;  "Chromosome of source region (directional) or lower region. For non-directional interchromosomal, chrom of this region."
    uint sourceStart;    "Start position in chromosome of source/lower/this region"
    uint sourceEnd;      "End position in chromosome of source/lower/this region"
    string sourceName;   "Identifier of source/lower/this region"
    string sourceStrand; "Orientation of source/lower/this region: + or -.  Use . if not applicable"
    string targetChrom;  "Chromosome of target region (directional) or upper region. For non-directional interchromosomal, chrom of other region"
    uint targetStart;    "Start position in chromosome of target/upper/this region"
    uint targetEnd;      "End position in chromosome of target/upper/this region"
    string targetName;   "Identifier of target/upper/this region"
    string targetStrand; "Orientation of target/upper/this region: + or -.  Use . if not applicable"

    )`,kCe=`table bigLink
"bigLink pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint qStart;        "start of alignment on query sequence"
    )`,LCe=`table bedMaf
"Bed3 with MAF block"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    lstring mafBlock;   "MAF block"
    )`,ICe=`table bigNarrowPeak
"BED6+4 Peaks of signal enrichment based on pooled, normalized (interpreted) data."
(
    string chrom;        "Reference sequence chromosome or scaffold"
    uint   chromStart;   "Start position in chromosome"
    uint   chromEnd;     "End position in chromosome"
    string name;	 "Name given to a region (preferably unique). Use . if no name is assigned"
    uint   score;        "Indicates how dark the peak will be displayed in the browser (0-1000) "
    char[1]  strand;     "+ or - or . for unknown"
    float  signalValue;  "Measurement of average enrichment for the region"
    float  pValue;       "Statistical significance of signal value (-log10). Set to -1 if not used."
    float  qValue;       "Statistical significance with multiple-test correction applied (FDR -log10). Set to -1 if not used."
    int   peak;         "Point-source called for this peak; 0-based offset from chromStart. Set to -1 if no point-source called."
)`,TCe=`table bigPsl
"bigPsl pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - indicates whether the query aligns to the + or - strand on the reference"
    uint thickStart;    "Start of where display should be thick (start codon)"
    uint thickEnd;      "End of where display should be thick (stop codon)"
    uint reserved;       "RGB value (use R,G,B string in input file)"
    int blockCount;     "Number of blocks"
    int[blockCount] blockSizes; "Comma separated list of block sizes"
    int[blockCount] chromStarts; "Start positions relative to chromStart"

    uint    oChromStart;"Start position in other chromosome"
    uint    oChromEnd;  "End position in other chromosome"
    char[1] oStrand;    "+ or -, - means that psl was reversed into BED-compatible coordinates"
    uint    oChromSize; "Size of other chromosome."
    int[blockCount] oChromStarts; "Start positions relative to oChromStart or from oChromStart+oChromSize depending on strand"

    lstring  oSequence;  "Sequence on other chrom (or empty)"
    string   oCDS;       "CDS in NCBI format"

    uint    chromSize;"Size of target chromosome"

    uint match;        "Number of bases matched."
    uint misMatch; " Number of bases that don't match "
    uint repMatch; " Number of bases that match but are part of repeats "
    uint nCount;   " Number of 'N' bases "
    uint seqType;    "0=empty, 1=nucleotide, 2=amino_acid"
    )`,ACe=`table defaultBedSchema
"BED12"
    (
    string chrom;      "The name of the chromosome (e.g. chr3, chrY, chr2_random) or scaffold (e.g. scaffold10671)."
    uint   chromStart; "The starting position of the feature in the chromosome or scaffold. The first base in a chromosome is numbered 0."
    uint   chromEnd;   "The ending position of the feature in the chromosome or scaffold. The chromEnd base is not included in the display of the feature. For example, the first 100 bases of a chromosome are defined as chromStart=0, chromEnd=100, and span the bases numbered 0-99."
    string   name;   "Defines the name of the BED line."
    float   score;   "Feature score, doesn't care about the 0-1000 limit as in bed"
    char   strand;   "Defines the strand. Either '.' (=no strand) or '+' or '-'"
    uint thickStart; "The starting position at which the feature is drawn thickly (for example, the start codon in gene displays). When there is no thick part, thickStart and thickEnd are usually set to the chromStart position."
    uint thickEnd; "The ending position at which the feature is drawn thickly (for example the stop codon in gene displays)."
    string itemRgb; "An RGB value of the form R,G,B (e.g. 255,0,0). "
    uint blockCount; " The number of blocks (exons) in the BED line."
    uint[blockCount] blockSizes; " A comma-separated list of the block sizes. The number of items in this list should correspond to blockCount."
    uint[blockCount] blockStarts; "A comma-separated list of block starts. All of the blockStart positions should be calculated relative to chromStart. The number of items in this list should correspond to blockCount."
    )`,NCe=`table mafFrames
"codon frame assignment for MAF components"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start range in chromosome"
    uint   chromEnd;   "End range in chromosome"
    string src;        "Name of sequence source in MAF"
    ubyte frame;       "frame (0,1,2) for first base(+) or last bast(-)"
    char[1] strand;    "+ or -"
    string name;       "Name of gene used to define frame"
    int    prevFramePos;  "target position of the previous base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    int    nextFramePos;  "target position of the next base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    ubyte  isExonStart;  "does this start the CDS portion of an exon?"
    ubyte  isExonEnd;    "does this end the CDS portion of an exon?"
    )`,RCe=`table mafSummary
"Positions and scores for alignment blocks"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    string src;        "Sequence name or database of alignment"
    float  score;      "Floating point score."
    char[1] leftStatus;  "Gap/break annotation for preceding block"
    char[1] rightStatus; "Gap/break annotation for following block"
    )`,MCe=Object.freeze(Object.defineProperty({__proto__:null,bigChain:xCe,bigGenePred:ECe,bigInteract:DCe,bigLink:kCe,bigMaf:LCe,bigNarrowPeak:ICe,bigPsl:TCe,defaultBedSchema:ACe,mafFrames:NCe,mafSummary:RCe},Symbol.toStringTag,{value:"Module"})),DI=Object.fromEntries(Object.entries(MCe).map(([n,e])=>[n,BY.parse(e.trim())]));function kI(n){const e=["uint","int","float","long"];return{...n,fields:n.fields.map(t=>({...t,isArray:t.size&&t.type!=="char",arrayIsNumeric:t.size&&e.includes(t.type),isNumeric:!t.size&&e.includes(t.type)}))}}const FCe={".":0,"-":-1,"+":1};function OCe(n){var e;return n.length>=12&&!Number.isNaN(parseInt(n[9],10))&&((e=n[10])===null||e===void 0?void 0:e.split(",").filter(t=>!!t).length)===parseInt(n[9],10)}class PCe{constructor(e={}){if(e.autoSql)this.autoSql=kI(SCe.parse(e.autoSql));else if(e.type){if(!DI[e.type])throw new Error("Type not found");this.autoSql=kI(DI[e.type])}else this.autoSql=kI(DI.defaultBedSchema),this.attemptDefaultBed=!0}parseLine(e,t={}){const{autoSql:i}=this,{uniqueId:r}=t,s=Array.isArray(e)?e:e.split("	");let o={};if(!this.attemptDefaultBed||this.attemptDefaultBed&&OCe(s))for(let a=0;a<i.fields.length;a++){const l=i.fields[a];let c=s[a];const{isNumeric:h,isArray:u,arrayIsNumeric:d,name:f}=l;if(c==null)break;if(c!=="."){if(h){const g=Number(c);c=Number.isNaN(g)?c:g}else u&&(c=c.split(","),c[c.length-1]===""&&c.pop(),d&&(c=c.map(g=>Number(g))));o[f]=c}}else{const a=["chrom","chromStart","chromEnd","name"];o=Object.fromEntries(s.map((l,c)=>[a[c]||"field"+c,l])),o.chromStart=+o.chromStart,o.chromEnd=+o.chromEnd,Number.isNaN(Number.parseFloat(o.field4))||(o.score=+o.field4,delete o.field4),(o.field5==="+"||o.field5==="-")&&(o.strand=o.field5,delete o.field5)}return r&&(o.uniqueId=r),o.strand=FCe[o.strand]||0,o.chrom=decodeURIComponent(o.chrom),o}}class BCe extends ey(Ig){constructor(t,i){const r={channel:"x",windowSize:1e6,...t};super(i,r.channel);dr(this,"lastRequestId",0);dr(this,"parser");if(this.params=r,!this.params.url)throw new Error("No URL provided for BigBedSource");this.bbi=new bCe({filehandle:new Vl(ty(this.params.url,this.view.getBaseUrl()))}),this.doDebouncedRequest=ay(this.doRequest.bind(this),200,!1),this.headerPromise=this.bbi.getHeader(),this.headerPromise.then(s=>{this.parser=new PCe({autoSql:s.autoSql})})}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;const r=this.quantizeInterval(t,i);this.checkAndUpdateLastInterval(r)&&this.doDebouncedRequest(r)}async doRequest(t){const i=await this.getFeatures(t);i.requestId<this.lastRequestId||this.publishData(i.features)}async getFeatures(t){let i=++this.lastRequestId;const r=new AbortController,s=this.genome.continuousToDiscreteChromosomeIntervals(t),o=await Promise.all(s.map(a=>this.bbi.getFeatures(a.chrom,a.startPos,a.endPos,{signal:r.signal}).then(l=>l.map(c=>this.parser.parseLine(`${a.chrom}	${c.start}	${c.end}	${c.rest}`,{uniqueId:c.uniqueId})))));return{requestId:i,abort:()=>r.abort(),features:o.flat()}}}var VCe=Oi,Uo=null;try{Uo=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Oi(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Oi.prototype.__isLong__;Object.defineProperty(Oi.prototype,"__isLong__",{value:!0});function Ws(n){return(n&&n.__isLong__)===!0}Oi.isLong=Ws;var Y9={},X9={};function Fg(n,e){var t,i,r;return e?(n>>>=0,(r=0<=n&&n<256)&&(i=X9[n],i)?i:(t=Pi(n,(n|0)<0?-1:0,!0),r&&(X9[n]=t),t)):(n|=0,(r=-128<=n&&n<128)&&(i=Y9[n],i)?i:(t=Pi(n,n<0?-1:0,!1),r&&(Y9[n]=t),t))}Oi.fromInt=Fg;function jo(n,e){if(isNaN(n))return e?of:qo;if(e){if(n<0)return of;if(n>=VY)return zY}else{if(n<=-J9)return Is;if(n+1>=J9)return $Y}return n<0?jo(-n,e).neg():Pi(n%g_|0,n/g_|0,e)}Oi.fromNumber=jo;function Pi(n,e,t){return new Oi(n,e,t)}Oi.fromBits=Pi;var iE=Math.pow;function l3(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return qo;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return l3(n.substring(1),e,t).neg();for(var r=jo(iE(t,8)),s=qo,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=jo(iE(t,a));s=s.mul(c).add(jo(l))}else s=s.mul(r),s=s.add(jo(l))}return s.unsigned=e,s}Oi.fromString=l3;function il(n,e){return typeof n=="number"?jo(n,e):typeof n=="string"?l3(n,e):Pi(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Oi.fromValue=il;var Q9=1<<16,WCe=1<<24,g_=Q9*Q9,VY=g_*g_,J9=VY/2,eV=Fg(WCe),qo=Fg(0);Oi.ZERO=qo;var of=Fg(0,!0);Oi.UZERO=of;var Gp=Fg(1);Oi.ONE=Gp;var WY=Fg(1,!0);Oi.UONE=WY;var bR=Fg(-1);Oi.NEG_ONE=bR;var $Y=Pi(-1,2147483647,!1);Oi.MAX_VALUE=$Y;var zY=Pi(-1,-1,!0);Oi.MAX_UNSIGNED_VALUE=zY;var Is=Pi(0,-2147483648,!1);Oi.MIN_VALUE=Is;var Ae=Oi.prototype;Ae.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ae.toNumber=function(){return this.unsigned?(this.high>>>0)*g_+(this.low>>>0):this.high*g_+(this.low>>>0)};Ae.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Is)){var t=jo(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=jo(iE(e,6),this.unsigned),o=this,a="";;){var l=o.div(s),c=o.sub(l.mul(s)).toInt()>>>0,h=c.toString(e);if(o=l,o.isZero())return h+a;for(;h.length<6;)h="0"+h;a=""+h+a}};Ae.getHighBits=function(){return this.high};Ae.getHighBitsUnsigned=function(){return this.high>>>0};Ae.getLowBits=function(){return this.low};Ae.getLowBitsUnsigned=function(){return this.low>>>0};Ae.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Is)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};Ae.isZero=function(){return this.high===0&&this.low===0};Ae.eqz=Ae.isZero;Ae.isNegative=function(){return!this.unsigned&&this.high<0};Ae.isPositive=function(){return this.unsigned||this.high>=0};Ae.isOdd=function(){return(this.low&1)===1};Ae.isEven=function(){return(this.low&1)===0};Ae.equals=function(e){return Ws(e)||(e=il(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ae.eq=Ae.equals;Ae.notEquals=function(e){return!this.eq(e)};Ae.neq=Ae.notEquals;Ae.ne=Ae.notEquals;Ae.lessThan=function(e){return this.comp(e)<0};Ae.lt=Ae.lessThan;Ae.lessThanOrEqual=function(e){return this.comp(e)<=0};Ae.lte=Ae.lessThanOrEqual;Ae.le=Ae.lessThanOrEqual;Ae.greaterThan=function(e){return this.comp(e)>0};Ae.gt=Ae.greaterThan;Ae.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ae.gte=Ae.greaterThanOrEqual;Ae.ge=Ae.greaterThanOrEqual;Ae.compare=function(e){if(Ws(e)||(e=il(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ae.comp=Ae.compare;Ae.negate=function(){return!this.unsigned&&this.eq(Is)?Is:this.not().add(Gp)};Ae.neg=Ae.negate;Ae.add=function(e){Ws(e)||(e=il(e));var t=this.high>>>16,i=this.high&65535,r=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,h=0,u=0,d=0,f=0;return f+=s+c,d+=f>>>16,f&=65535,d+=r+l,u+=d>>>16,d&=65535,u+=i+a,h+=u>>>16,u&=65535,h+=t+o,h&=65535,Pi(d<<16|f,h<<16|u,this.unsigned)};Ae.subtract=function(e){return Ws(e)||(e=il(e)),this.add(e.neg())};Ae.sub=Ae.subtract;Ae.multiply=function(e){if(this.isZero())return qo;if(Ws(e)||(e=il(e)),Uo){var t=Uo.mul(this.low,this.high,e.low,e.high);return Pi(t,Uo.get_high(),this.unsigned)}if(e.isZero())return qo;if(this.eq(Is))return e.isOdd()?Is:qo;if(e.eq(Is))return this.isOdd()?Is:qo;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(eV)&&e.lt(eV))return jo(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,h=e.low&65535,u=0,d=0,f=0,g=0;return g+=o*h,f+=g>>>16,g&=65535,f+=s*h,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*h,u+=d>>>16,d&=65535,d+=s*c,u+=d>>>16,d&=65535,d+=o*l,u+=d>>>16,d&=65535,u+=i*h+r*c+s*l+o*a,u&=65535,Pi(f<<16|g,u<<16|d,this.unsigned)};Ae.mul=Ae.multiply;Ae.divide=function(e){if(Ws(e)||(e=il(e)),e.isZero())throw Error("division by zero");if(Uo){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Uo.div_u:Uo.div_s)(this.low,this.high,e.low,e.high);return Pi(t,Uo.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?of:qo;var i,r,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return of;if(e.gt(this.shru(1)))return WY;s=of}else{if(this.eq(Is)){if(e.eq(Gp)||e.eq(bR))return Is;if(e.eq(Is))return Gp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(qo)?e.isNegative()?Gp:bR:(r=this.sub(e.mul(i)),s=i.add(r.div(e)),s)}else if(e.eq(Is))return this.unsigned?of:qo;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=qo}for(r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:iE(2,a-48),c=jo(i),h=c.mul(e);h.isNegative()||h.gt(r);)i-=l,c=jo(i,this.unsigned),h=c.mul(e);c.isZero()&&(c=Gp),s=s.add(c),r=r.sub(h)}return s};Ae.div=Ae.divide;Ae.modulo=function(e){if(Ws(e)||(e=il(e)),Uo){var t=(this.unsigned?Uo.rem_u:Uo.rem_s)(this.low,this.high,e.low,e.high);return Pi(t,Uo.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ae.mod=Ae.modulo;Ae.rem=Ae.modulo;Ae.not=function(){return Pi(~this.low,~this.high,this.unsigned)};Ae.and=function(e){return Ws(e)||(e=il(e)),Pi(this.low&e.low,this.high&e.high,this.unsigned)};Ae.or=function(e){return Ws(e)||(e=il(e)),Pi(this.low|e.low,this.high|e.high,this.unsigned)};Ae.xor=function(e){return Ws(e)||(e=il(e)),Pi(this.low^e.low,this.high^e.high,this.unsigned)};Ae.shiftLeft=function(e){return Ws(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Pi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Pi(0,this.low<<e-32,this.unsigned)};Ae.shl=Ae.shiftLeft;Ae.shiftRight=function(e){return Ws(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Pi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Pi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ae.shr=Ae.shiftRight;Ae.shiftRightUnsigned=function(e){if(Ws(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return Pi(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Pi(t,0,this.unsigned):Pi(t>>>e-32,0,this.unsigned)};Ae.shru=Ae.shiftRightUnsigned;Ae.shr_u=Ae.shiftRightUnsigned;Ae.toSigned=function(){return this.unsigned?Pi(this.low,this.high,!1):this};Ae.toUnsigned=function(){return this.unsigned?this:Pi(this.low,this.high,!0)};Ae.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ae.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ae.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Oi.fromBytes=function(e,t,i){return i?Oi.fromBytesLE(e,t):Oi.fromBytesBE(e,t)};Oi.fromBytesLE=function(e,t){return new Oi(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Oi.fromBytesBE=function(e,t){return new Oi(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const HY=Tg(VCe);let UY=class{constructor(e,t){this.blockPosition=e,this.dataPosition=t}toString(){return`${this.blockPosition}:${this.dataPosition}`}compareTo(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}static min(...e){let t,i=0;for(;!t;i+=1)t=e[i];for(;i<e.length;i+=1)t.compareTo(e[i])>0&&(t=e[i]);return t}};function _m(n,e=0,t=!1){if(t)throw new Error("big-endian virtual file offsets not implemented");return new UY(n[e+7]*1099511627776+n[e+6]*4294967296+n[e+5]*16777216+n[e+4]*65536+n[e+3]*256+n[e+2],n[e+1]<<8|n[e])}let nE=class{constructor(e,t,i,r=void 0){this.minv=e,this.maxv=t,this.bin=i,this._fetchedSize=r}toUniqueString(){return`${this.minv}..${this.maxv} (bin ${this.bin}, fetchedSize ${this.fetchedSize()})`}toString(){return this.toUniqueString()}compareTo(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}fetchedSize(){return this._fetchedSize!==void 0?this._fetchedSize:this.maxv.blockPosition+(1<<16)-this.minv.blockPosition}},jY=class{constructor({filehandle:e,renameRefSeq:t=i=>i}){this.filehandle=e,this.renameRefSeq=t}_findFirstData(e,t){const i=e.firstDataLine;i?e.firstDataLine=i.compareTo(t)>0?t:i:e.firstDataLine=t}async parse(e={}){return this.setupP||(this.setupP=this._parse(e).catch(t=>{throw this.setupP=void 0,t})),this.setupP}async hasRefSeq(e,t={}){return!!((await this.parse(t)).indices[e]||{}).binIndex}};function $Ce(n){return new Promise(e=>setTimeout(e,n))}function qY(n){if(n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return n.toNumber()}function GY(n){if(n&&n.aborted){if(typeof DOMException<"u")throw new DOMException("aborted","AbortError");{const e=new Error("aborted");throw e.code="ERR_ABORTED",e}}}async function KY(n){await Promise.resolve(),GY(n)}function zCe(n,e){return e.minv.blockPosition-n.maxv.blockPosition<65e3&&e.maxv.blockPosition-n.minv.blockPosition<5e6}function HCe(n={}){return"aborted"in n?{signal:n}:n}function ZY(n,e){const t=[];let i=null;return n.length===0?n:(n.sort((r,s)=>{const o=r.minv.blockPosition-s.minv.blockPosition;return o!==0?o:r.minv.dataPosition-s.minv.dataPosition}),n.forEach(r=>{(!e||r.maxv.compareTo(e)>0)&&(i===null?(t.push(r),i=r):zCe(i,r)?r.maxv.compareTo(i.maxv)>0&&(i.maxv=r.maxv):(t.push(r),i=r))}),t)}const UCe=21578050;function jCe(n,e){return n-n%e}function qCe(n,e){return n-n%e+e}class U0 extends jY{parsePseudoBin(e,t){return{lineCount:qY(HY.fromBytesLE(Array.prototype.slice.call(e,t+16,t+24),!0))}}async lineCount(e,t={}){const r=(await this.parse(t)).indices[e];if(!r)return-1;const s=r.stats||{};return s.lineCount===void 0?-1:s.lineCount}fetchBai(e={}){return this.baiP||(this.baiP=this.filehandle.readFile(e).catch(t=>{throw this.baiP=void 0,t})),this.baiP}async _parse(){const e={bai:!0,maxBlockSize:65536},t=await this.fetchBai();if(t.readUInt32LE(0)!==UCe)throw new Error("Not a BAI file");e.refCount=t.readInt32LE(4);const r=((1<<(5+1)*3)-1)/7;e.indices=new Array(e.refCount);let s=8;for(let o=0;o<e.refCount;o+=1){const a=t.readInt32LE(s);let l;s+=4;const c={};for(let d=0;d<a;d+=1){const f=t.readUInt32LE(s);if(s+=4,f===r+1)s+=4,l=this.parsePseudoBin(t,s),s+=32;else{if(f>r+1)throw new Error("bai index contains too many bins, please use CSI");{const g=t.readInt32LE(s);s+=4;const p=new Array(g);for(let m=0;m<g;m+=1){const b=_m(t,s),_=_m(t,s+8);s+=16,this._findFirstData(e,b),p[m]=new nE(b,_,f)}c[f]=p}}}const h=t.readInt32LE(s);s+=4;const u=new Array(h);for(let d=0;d<h;d+=1)u[d]=_m(t,s),s+=8,this._findFirstData(e,u[d]);e.indices[o]={binIndex:c,linearIndex:u,stats:l}}return e}async indexCov(e,t,i,r={}){const o=t!==void 0,l=(await this.parse(r)).indices[e];if(!l)return[];const{linearIndex:c=[],stats:h}=l;if(!c.length)return[];const u=i!==void 0?qCe(i,16384):(c.length-1)*16384,d=t!==void 0?jCe(t,16384):0;let f;o?f=new Array((u-d)/16384):f=new Array(c.length-1);const g=c[c.length-1].blockPosition;if(u>(c.length-1)*16384)throw new Error("query outside of range of linear index");let p=c[d/16384].blockPosition;for(let m=d/16384,b=0;m<u/16384;m++,b++)f[b]={score:c[m+1].blockPosition-p,start:m*16384,end:m*16384+16384},p=c[m+1].blockPosition;return f.map(m=>({...m,score:m.score*h.lineCount/g}))}reg2bins(e,t){return t-=1,[[0,0],[1+(e>>26),1+(t>>26)],[9+(e>>23),9+(t>>23)],[73+(e>>20),73+(t>>20)],[585+(e>>17),585+(t>>17)],[4681+(e>>14),4681+(t>>14)]]}async blocksForRange(e,t,i,r={}){t<0&&(t=0);const s=await this.parse(r);if(!s)return[];const o=s.indices[e];if(!o)return[];const a=this.reg2bins(t,i),l=[];for(const[f,g]of a)for(let p=f;p<=g;p++)if(o.binIndex[p]){const m=o.binIndex[p];for(let b=0;b<m.length;++b)l.push(new nE(m[b].minv,m[b].maxv,p))}const c=o.linearIndex.length;let h=null;const u=Math.min(t>>14,c-1),d=Math.min(i>>14,c-1);for(let f=u;f<=d;++f){const g=o.linearIndex[f];g&&(!h||g.compareTo(h)<0)&&(h=g)}return ZY(l,h)}}const GCe=21582659,KCe=38359875;function ZCe(n,e){return n*2**e}function tV(n,e){return Math.floor(n/2**e)}let LI=class extends jY{constructor(e){super(e),this.maxBinNumber=0,this.depth=0,this.minShift=0}async lineCount(e){const t=await this.parse();if(!t||!t.indices[e])return-1;const{stats:r}=t.indices[e];return r?r.lineCount:-1}async indexCov(){return[]}parseAuxData(e,t,i){if(i<30)return{};const r={};if(r.formatFlags=e.readInt32LE(t),r.coordinateType=r.formatFlags&65536?"zero-based-half-open":"1-based-closed",r.format={0:"generic",1:"SAM",2:"VCF"}[r.formatFlags&15],!r.format)throw new Error(`invalid Tabix preset format flags ${r.formatFlags}`);r.columnNumbers={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},r.metaValue=e.readInt32LE(t+16),r.metaChar=r.metaValue?String.fromCharCode(r.metaValue):"",r.skipLines=e.readInt32LE(t+20);const s=e.readInt32LE(t+24);return Object.assign(r,this._parseNameBytes(e.subarray(t+28,t+28+s))),r}_parseNameBytes(e){let t=0,i=0;const r=[],s={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),r[t]=a,s[a]=t}i=o+1,t+=1}return{refNameToId:s,refIdToName:r}}async _parse(e){const t={csi:!0,maxBlockSize:65536},i=await this.filehandle.readFile(e),r=await a_(i);if(r.readUInt32LE(0)===GCe)t.csiVersion=1;else if(r.readUInt32LE(0)===KCe)t.csiVersion=2;else throw new Error("Not a CSI file");this.minShift=r.readInt32LE(4),this.depth=r.readInt32LE(8),this.maxBinNumber=((1<<(this.depth+1)*3)-1)/7;const s=r.readInt32LE(12);s&&Object.assign(t,this.parseAuxData(r,16,s)),t.refCount=r.readInt32LE(16+s),t.indices=new Array(t.refCount);let o=16+s+4;for(let a=0;a<t.refCount;a+=1){await KY(e.signal);const l=r.readInt32LE(o);o+=4;const c={};let h;for(let u=0;u<l;u+=1){const d=r.readUInt32LE(o);if(d>this.maxBinNumber)h=this.parsePseudoBin(r,o+4),o+=4+8+4+16+16;else{const f=_m(r,o+4);this._findFirstData(t,f);const g=r.readInt32LE(o+12);o+=16;const p=new Array(g);for(let m=0;m<g;m+=1){const b=_m(r,o),_=_m(r,o+8);o+=16,p[m]=new nE(b,_,d)}c[d]=p}}t.indices[a]={binIndex:c,stats:h}}return t}parsePseudoBin(e,t){return{lineCount:qY(HY.fromBytesLE(Array.prototype.slice.call(e,t+28,t+36),!0))}}async blocksForRange(e,t,i,r={}){t<0&&(t=0);const s=await this.parse(r),o=s==null?void 0:s.indices[e];if(!o)return[];const a=this.reg2bins(t,i),l=[];for(const[c,h]of a)for(let u=c;u<=h;u++)if(o.binIndex[u]){const d=o.binIndex[u];for(let f=0;f<d.length;++f)l.push(new nE(d[f].minv,d[f].maxv,u))}return ZY(l,new UY(0,0))}reg2bins(e,t){e-=1,e<1&&(e=1),t>2**50&&(t=2**34),t-=1;let i=0,r=0,s=this.minShift+this.depth*3;const o=[];for(;i<=this.depth;s-=3,r+=ZCe(1,i*3),i+=1){const a=r+tV(e,s),l=r+tV(t,s);if(l-a+o.length>this.maxBinNumber)throw new Error(`query ${e}-${t} is too large for current binning scheme (shift ${this.minShift}, depth ${this.depth}), try a smaller query or a coarser index binning scheme`);o.push([a,l])}return o}};var jh=vr.Buffer,vR=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(vR=new Int32Array(vR));function YY(n){if(jh.isBuffer(n))return n;var e=typeof jh.alloc=="function"&&typeof jh.from=="function";if(typeof n=="number")return e?jh.alloc(n):new jh(n);if(typeof n=="string")return e?jh.from(n):new jh(n);throw new Error("input must be buffer, number, or string, received "+typeof n)}function YCe(n){var e=YY(4);return e.writeInt32BE(n,0),e}function c3(n,e){n=YY(n),jh.isBuffer(e)&&(e=e.readUInt32BE(0));for(var t=~~e^-1,i=0;i<n.length;i++)t=vR[(t^n[i])&255]^t>>>8;return t^-1}function h3(){return YCe(c3.apply(null,arguments))}h3.signed=function(){return c3.apply(null,arguments)};h3.unsigned=function(){return c3.apply(null,arguments)>>>0};var XCe=h3;const QCe=Tg(XCe);var II,iV;function JCe(){if(iV)return II;iV=1;var n=function(i,r){return Object.prototype.hasOwnProperty.call(i,r)},e=function(i,r){return Object.prototype.propertyIsEnumerable.call(i,r)};function t(i){if(i==null)throw new TypeError("Cannot convert undefined or null to object");var r=[];for(var s in i)n(i,s)&&e(i,s)&&r.push([s,i[s]]);return r}return II=t,II}var eSe=typeof Object.entries=="function"?Object.entries:JCe();const tSe=Tg(eSe);class iSe{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const t=this.oldCache.get(e);return this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return this._size+e}}var nSe=iSe;const rSe=Tg(nSe),So={BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048},nV="=ACMGRSVTWYHKDBN".split(""),j0="MIDNSHP=X???????".split("");class sSe{constructor(e){this.data={},this._tagList=[],this._allTagsParsed=!1;const{bytes:t,fileOffset:i}=e,{byteArray:r,start:s}=t;this.data={},this.bytes=t,this._id=i,this._refID=r.readInt32LE(s+4),this.data.start=r.readInt32LE(s+8),this.flags=(r.readInt32LE(s+16)&4294901760)>>16}get(e){return this[e]?this.data[e]?this.data[e]:(this.data[e]=this[e](),this.data[e]):this._get(e.toLowerCase())}end(){return this.get("start")+this.get("length_on_ref")}seq_id(){return this._refID}_get(e){return e in this.data?this.data[e]:(this.data[e]=this._parseTag(e),this.data[e])}_tags(){this._parseAllTags();let e=["seq"];this.isSegmentUnmapped()||e.push("start","end","strand","score","qual","MQ","CIGAR","length_on_ref","template_length"),this.isPaired()&&e.push("next_segment_position","pair_orientation"),e=e.concat(this._tagList||[]),Object.keys(this.data).forEach(i=>{i[0]!=="_"&&i!=="next_seq_id"&&e.push(i)});const t={};return e.filter(i=>{if(i in this.data&&this.data[i]===void 0||i==="CG"||i==="cg")return!1;const r=i.toLowerCase(),s=t[r];return t[r]=!0,!s})}parent(){}children(){return this.get("subfeatures")}id(){return this._id}mq(){const e=(this.get("_bin_mq_nl")&65280)>>8;return e===255?void 0:e}score(){return this.get("mq")}qual(){var e;return(e=this.qualRaw())===null||e===void 0?void 0:e.join(" ")}qualRaw(){if(this.isSegmentUnmapped())return;const{start:e,byteArray:t}=this.bytes,i=e+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4+this.get("_seq_bytes"),r=this.get("seq_length");return t.subarray(i,i+r)}strand(){return this.isReverseComplemented()?-1:1}multi_segment_next_segment_strand(){if(!this.isMateUnmapped())return this.isMateReverseComplemented()?-1:1}name(){return this.get("_read_name")}_read_name(){const e=this.get("_l_read_name"),{byteArray:t,start:i}=this.bytes;return t.toString("ascii",i+36,i+36+e-1)}_parseTag(e){if(this._allTagsParsed)return;const{byteArray:t,start:i}=this.bytes;let r=this._tagOffset||i+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4+this.get("_seq_bytes")+this.get("seq_length");const s=this.bytes.end;let o;for(;r<s&&o!==e;){const a=String.fromCharCode(t[r],t[r+1]);o=a.toLowerCase();const l=String.fromCharCode(t[r+2]);r+=3;let c;switch(l){case"A":c=String.fromCharCode(t[r]),r+=1;break;case"i":c=t.readInt32LE(r),r+=4;break;case"I":c=t.readUInt32LE(r),r+=4;break;case"c":c=t.readInt8(r),r+=1;break;case"C":c=t.readUInt8(r),r+=1;break;case"s":c=t.readInt16LE(r),r+=2;break;case"S":c=t.readUInt16LE(r),r+=2;break;case"f":c=t.readFloatLE(r),r+=4;break;case"Z":case"H":for(c="";r<=s;){const h=t[r++];if(h===0)break;c+=String.fromCharCode(h)}break;case"B":{c="";const h=t[r++],u=String.fromCharCode(h),d=t.readInt32LE(r);if(r+=4,u==="i")if(a==="CG")for(let f=0;f<d;f++){const g=t.readInt32LE(r),p=g>>4,m=j0[g&15];c+=p+m,r+=4}else for(let f=0;f<d;f++)c+=t.readInt32LE(r),f+1<d&&(c+=","),r+=4;if(u==="I")if(a==="CG")for(let f=0;f<d;f++){const g=t.readUInt32LE(r),p=g>>4,m=j0[g&15];c+=p+m,r+=4}else for(let f=0;f<d;f++)c+=t.readUInt32LE(r),f+1<d&&(c+=","),r+=4;if(u==="s")for(let f=0;f<d;f++)c+=t.readInt16LE(r),f+1<d&&(c+=","),r+=2;if(u==="S")for(let f=0;f<d;f++)c+=t.readUInt16LE(r),f+1<d&&(c+=","),r+=2;if(u==="c")for(let f=0;f<d;f++)c+=t.readInt8(r),f+1<d&&(c+=","),r+=1;if(u==="C")for(let f=0;f<d;f++)c+=t.readUInt8(r),f+1<d&&(c+=","),r+=1;if(u==="f")for(let f=0;f<d;f++)c+=t.readFloatLE(r),f+1<d&&(c+=","),r+=4;break}default:console.warn(`Unknown BAM tag type '${l}', tags may be incomplete`),c=void 0,r=s}if(this._tagOffset=r,this._tagList.push(a),o===e)return c;this.data[o]=c}this._allTagsParsed=!0}_parseAllTags(){this._parseTag("")}_parseCigar(e){return e.match(/\d+\D/g).map(t=>[t.match(/\D/)[0].toUpperCase(),parseInt(t,10)])}isPaired(){return!!(this.flags&So.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&So.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&So.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&So.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&So.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&So.BAM_FMREVERSE)}isRead1(){return!!(this.flags&So.BAM_FREAD1)}isRead2(){return!!(this.flags&So.BAM_FREAD2)}isSecondary(){return!!(this.flags&So.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&So.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&So.BAM_FDUP)}isSupplementary(){return!!(this.flags&So.BAM_FSUPPLEMENTARY)}cigar(){if(this.isSegmentUnmapped())return;const{byteArray:e,start:t}=this.bytes,i=this.get("_n_cigar_op");let r=t+36+this.get("_l_read_name");const s=this.get("seq_length");let o="",a=0,l=e.readInt32LE(r),c=l>>4,h=j0[l&15];if(h==="S"&&c===s)return r+=4,l=e.readInt32LE(r),c=l>>4,h=j0[l&15],h!=="N"&&console.warn("CG tag with no N tag"),this.data.length_on_ref=c,this.get("CG");for(let u=0;u<i;++u)l=e.readInt32LE(r),c=l>>4,h=j0[l&15],o+=c+h,h!=="H"&&h!=="S"&&h!=="I"&&(a+=c),r+=4;return this.data.length_on_ref=a,o}_flags(){}length_on_ref(){return this.data.length_on_ref?this.data.length_on_ref:(this.get("cigar"),this.data.length_on_ref)}_n_cigar_op(){return this.get("_flag_nc")&65535}_l_read_name(){return this.get("_bin_mq_nl")&255}_seq_bytes(){return this.get("seq_length")+1>>1}getReadBases(){return this.seq()}seq(){const{byteArray:e,start:t}=this.bytes,i=t+36+this.get("_l_read_name")+this.get("_n_cigar_op")*4,r=this.get("_seq_bytes"),s=this.get("seq_length");let o="",a=0;for(let l=0;l<r;++l){const c=e[i+l];o+=nV[(c&240)>>4],a++,a<s&&(o+=nV[c&15],a++)}return o}getPairOrientation(){if(!this.isSegmentUnmapped()&&!this.isMateUnmapped()&&this._refID===this._next_refid()){const e=this.isReverseComplemented()?"R":"F",t=this.isMateReverseComplemented()?"R":"F";let i=" ",r=" ";this.isRead1()?(i="1",r="2"):this.isRead2()&&(i="2",r="1");const s=[];return this.template_length()>0?(s[0]=e,s[1]=i,s[2]=t,s[3]=r):(s[2]=e,s[3]=i,s[0]=t,s[1]=r),s.join("")}return null}_bin_mq_nl(){return this.bytes.byteArray.readInt32LE(this.bytes.start+12)}_flag_nc(){return this.bytes.byteArray.readInt32LE(this.bytes.start+16)}seq_length(){return this.bytes.byteArray.readInt32LE(this.bytes.start+20)}_next_refid(){return this.bytes.byteArray.readInt32LE(this.bytes.start+24)}_next_pos(){return this.bytes.byteArray.readInt32LE(this.bytes.start+28)}template_length(){return this.bytes.byteArray.readInt32LE(this.bytes.start+32)}toJSON(){const e={};return Object.keys(this).forEach(t=>{t.charAt(0)==="_"||t==="bytes"||(e[t]=this[t])}),e}}function oSe(n){const e=n.split(/\r?\n/),t=[];return e.forEach(i=>{const[r,...s]=i.split(/\t/),o=s.map(a=>{const[l,c]=a.split(":",2);return{tag:l,value:c}});r&&t.push({tag:r.substr(1),data:o})}),t}const aSe=21840194,TI=1<<16;function AI(n){return[].concat(...n)}async function lSe(n){const e=[];for await(const t of n)e.push(t);return e}class cSe{constructor({bamFilehandle:e,bamPath:t,bamUrl:i,baiPath:r,baiFilehandle:s,baiUrl:o,csiPath:a,csiFilehandle:l,csiUrl:c,fetchSizeLimit:h,chunkSizeLimit:u,yieldThreadTime:d=100,renameRefSeqs:f=g=>g}){if(this.featureCache=new Vk({cache:new rSe({maxSize:50}),fill:async({chunk:g,opts:p},m)=>{const{data:b,cpositions:_,dpositions:w}=await this._readChunk({chunk:g,opts:{...p,signal:m}});return await this.readBamFeatures(b,_,w,g)}}),this.renameRefSeq=f,e)this.bam=e;else if(t)this.bam=new no(t);else if(i)this.bam=new Vl(i);else throw new Error("unable to initialize bam");if(l)this.index=new LI({filehandle:l});else if(a)this.index=new LI({filehandle:new no(a)});else if(c)this.index=new LI({filehandle:new Vl(c)});else if(s)this.index=new U0({filehandle:s});else if(r)this.index=new U0({filehandle:new no(r)});else if(o)this.index=new U0({filehandle:new Vl(o)});else if(t)this.index=new U0({filehandle:new no(`${t}.bai`)});else if(i)this.index=new U0({filehandle:new Vl(`${i}.bai`)});else throw new Error("unable to infer index format");this.fetchSizeLimit=h||5e8,this.chunkSizeLimit=u||3e8,this.yieldThreadTime=d}async getHeader(e={}){const t=HCe(e),i=await this.index.parse(t),r=i.firstDataLine?i.firstDataLine.blockPosition+65535:void 0;let s;if(r){const h=await this.bam.read(Buffer.alloc(r+TI),0,r+TI,0,t),{bytesRead:u}=h;if({buffer:s}=h,!u)throw new Error("Error reading header");u<r?s=s.subarray(0,u):s=s.subarray(0,r)}else s=await this.bam.readFile(t);const o=await a_(s);if(o.readInt32LE(0)!==aSe)throw new Error("Not a BAM file");const a=o.readInt32LE(4);this.header=o.toString("utf8",8,8+a);const{chrToIndex:l,indexToChr:c}=await this._readRefSeqs(a+8,65535,t);return this.chrToIndex=l,this.indexToChr=c,oSe(this.header)}async getHeaderText(e={}){return await this.getHeader(e),this.header}async _readRefSeqs(e,t,i={}){if(e>t)return this._readRefSeqs(e,t*2,i);const r=t+TI,{bytesRead:s,buffer:o}=await this.bam.read(Buffer.alloc(r),0,t,0,i);if(!s)throw new Error("Error reading refseqs from header");const a=await a_(o.subarray(0,Math.min(s,t))),l=a.readInt32LE(e);let c=e+4;const h={},u=[];for(let d=0;d<l;d+=1){const f=a.readInt32LE(c),g=this.renameRefSeq(a.toString("utf8",c+4,c+4+f-1)),p=a.readInt32LE(c+f+4);if(h[g]=d,u.push({refName:g,length:p}),c=c+8+f,c>a.length)return console.warn(`BAM header is very big.  Re-fetching ${t} bytes.`),this._readRefSeqs(e,t*2,i)}return{chrToIndex:h,indexToChr:u}}async getRecordsForRange(e,t,i,r={viewAsPairs:!1,pairAcrossChr:!1,maxInsertSize:2e5}){return AI(await lSe(this.streamRecordsForRange(e,t,i,r)))}async*streamRecordsForRange(e,t,i,r={}){const{signal:s}=r,o=this.chrToIndex&&this.chrToIndex[e];let a;if(!(o>=0))a=[];else if(a=await this.index.blocksForRange(o,t-1,i,r),!a)throw new Error("Error in index fetch");for(let c=0;c<a.length;c+=1){await KY(s);const h=a[c].fetchedSize();if(h>this.chunkSizeLimit)throw new Error(`Too many BAM features. BAM chunk size ${h} bytes exceeds chunkSizeLimit of ${this.chunkSizeLimit}`)}const l=a.map(c=>c.fetchedSize()).reduce((c,h)=>c+h,0);if(l>this.fetchSizeLimit)throw new Error(`data size of ${l.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);yield*this._fetchChunkFeatures(a,o,t,i,r)}async*_fetchChunkFeatures(e,t,i,r,s){const{viewAsPairs:o=!1}=s,a=[];let l=!1;for(let c=0;c<e.length;c++){const h=e[c],u=await this.featureCache.get(h.toString(),{chunk:h,opts:s},s.signal),d=[];for(let f=0;f<u.length;f+=1){const g=u[f];if(g.seq_id()===t)if(g.get("start")>=r){l=!0;break}else g.get("end")>=i&&d.push(g)}if(a.push(d),yield d,l)break}GY(s.signal),o&&(yield this.fetchPairs(t,a,s))}async fetchPairs(e,t,i){const{pairAcrossChr:r=!1,maxInsertSize:s=2e5}=i,o={},a={};t.map(d=>{const f={};for(let g=0;g<d.length;g++){const p=d[g].name(),m=d[g].id();f[p]||(f[p]=0),f[p]++,a[m]=1}tSe(f).forEach(([g,p])=>{p===1&&(o[g]=!0)})});const l=[];t.map(d=>{for(let f=0;f<d.length;f++){const g=d[f],p=g.name(),m=g.get("start"),b=g._next_pos(),_=g._next_refid();o[p]&&(r||_===e&&Math.abs(m-b)<s)&&l.push(this.index.blocksForRange(_,b,b+1,i))}});const c=AI(await Promise.all(l)).sort().filter((d,f,g)=>!f||d.toString()!==g[f-1].toString()),h=c.map(d=>d.fetchedSize()).reduce((d,f)=>d+f,0);if(h>this.fetchSizeLimit)throw new Error(`data size of ${h.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);const u=c.map(async d=>{const{data:f,cpositions:g,dpositions:p,chunk:m}=await this._readChunk({chunk:d,opts:i}),b=await this.readBamFeatures(f,g,p,m),_=[];for(let w=0;w<b.length;w+=1){const y=b[w];o[y.get("name")]&&!a[y.id()]&&_.push(y)}return _});return AI(await Promise.all(u))}async _readChunk({chunk:e,opts:t}){const i=e.fetchedSize(),{buffer:r,bytesRead:s}=await this.bam.read(Buffer.alloc(i),0,i,e.minv.blockPosition,t),{buffer:o,cpositions:a,dpositions:l}=await CZ(r.subarray(0,Math.min(s,i)),e);return{data:o,cpositions:a,dpositions:l,chunk:e}}async readBamFeatures(e,t,i,r){let s=0;const o=[];let a=0,l=+Date.now();for(;s+4<e.length;){const c=e.readInt32LE(s),h=s+4+c-1;if(i){for(;s+r.minv.dataPosition>=i[a++];);a--}if(h<e.length){const u=new sSe({bytes:{byteArray:e,start:s,end:h},fileOffset:t?t[a]*256+(s-i[a])+r.minv.dataPosition+1:QCe.signed(e.slice(s,h))});o.push(u),this.yieldThreadTime&&+Date.now()-l>this.yieldThreadTime&&(await $Ce(1),l=+Date.now())}s=h+1}return o}async hasRefSeq(e){const t=this.chrToIndex&&this.chrToIndex[e];return this.index.hasRefSeq(t)}async lineCount(e){const t=this.chrToIndex&&this.chrToIndex[e];return this.index.lineCount(t)}async indexCov(e,t,i){await this.index.parse();const r=this.chrToIndex&&this.chrToIndex[e];return this.index.indexCov(r,t,i)}async blocksForRange(e,t,i,r){await this.index.parse();const s=this.chrToIndex&&this.chrToIndex[e];return this.index.blocksForRange(s,t,i,r)}}(function(){(function(n){(function(e){var t={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function i(E){return E&&DataView.prototype.isPrototypeOf(E)}if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(E){return E&&r.indexOf(Object.prototype.toString.call(E))>-1};function o(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(E))throw new TypeError("Invalid character in header field name");return E.toLowerCase()}function a(E){return typeof E!="string"&&(E=String(E)),E}function l(E){var N={next:function(){var T=E.shift();return{done:T===void 0,value:T}}};return t.iterable&&(N[Symbol.iterator]=function(){return N}),N}function c(E){this.map={},E instanceof c?E.forEach(function(N,T){this.append(T,N)},this):Array.isArray(E)?E.forEach(function(N){this.append(N[0],N[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(N){this.append(N,E[N])},this)}c.prototype.append=function(E,N){E=o(E),N=a(N);var T=this.map[E];this.map[E]=T?T+", "+N:N},c.prototype.delete=function(E){delete this.map[o(E)]},c.prototype.get=function(E){return E=o(E),this.has(E)?this.map[E]:null},c.prototype.has=function(E){return this.map.hasOwnProperty(o(E))},c.prototype.set=function(E,N){this.map[o(E)]=a(N)},c.prototype.forEach=function(E,N){for(var T in this.map)this.map.hasOwnProperty(T)&&E.call(N,this.map[T],T,this)},c.prototype.keys=function(){var E=[];return this.forEach(function(N,T){E.push(T)}),l(E)},c.prototype.values=function(){var E=[];return this.forEach(function(N){E.push(N)}),l(E)},c.prototype.entries=function(){var E=[];return this.forEach(function(N,T){E.push([T,N])}),l(E)},t.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function h(E){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}function u(E){return new Promise(function(N,T){E.onload=function(){N(E.result)},E.onerror=function(){T(E.error)}})}function d(E){var N=new FileReader,T=u(N);return N.readAsArrayBuffer(E),T}function f(E){var N=new FileReader,T=u(N);return N.readAsText(E),T}function g(E){for(var N=new Uint8Array(E),T=new Array(N.length),j=0;j<N.length;j++)T[j]=String.fromCharCode(N[j]);return T.join("")}function p(E){if(E.slice)return E.slice(0);var N=new Uint8Array(E.byteLength);return N.set(new Uint8Array(E)),N.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(E){this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:t.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:t.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:t.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():t.arrayBuffer&&t.blob&&i(E)?(this._bodyArrayBuffer=p(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):t.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||s(E))?this._bodyArrayBuffer=p(E):this._bodyText=E=Object.prototype.toString.call(E):this._bodyText="",this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var E=h(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var E=h(this);if(E)return E;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(E){var N=E.toUpperCase();return b.indexOf(N)>-1?N:E}function w(E,N){N=N||{};var T=N.body;if(E instanceof w){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,N.headers||(this.headers=new c(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!T&&E._bodyInit!=null&&(T=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=N.credentials||this.credentials||"same-origin",(N.headers||!this.headers)&&(this.headers=new c(N.headers)),this.method=_(N.method||this.method||"GET"),this.mode=N.mode||this.mode||null,this.signal=N.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&T)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(T)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function y(E){var N=new FormData;return E.trim().split("&").forEach(function(T){if(T){var j=T.split("="),q=j.shift().replace(/\+/g," "),ie=j.join("=").replace(/\+/g," ");N.append(decodeURIComponent(q),decodeURIComponent(ie))}}),N}function S(E){var N=new c,T=E.replace(/\r?\n[\t ]+/g," ");return T.split(/\r?\n/).forEach(function(j){var q=j.split(":"),ie=q.shift().trim();if(ie){var ge=q.join(":").trim();N.append(ie,ge)}}),N}m.call(w.prototype);function k(E,N){N||(N={}),this.type="default",this.status=N.status===void 0?200:N.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in N?N.statusText:"OK",this.headers=new c(N.headers),this.url=N.url||"",this._initBody(E)}m.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},k.error=function(){var E=new k(null,{status:0,statusText:""});return E.type="error",E};var C=[301,302,303,307,308];k.redirect=function(E,N){if(C.indexOf(N)===-1)throw new RangeError("Invalid status code");return new k(null,{status:N,headers:{location:E}})},e.DOMException=n.DOMException;try{new e.DOMException}catch{e.DOMException=function(N,T){this.message=N,this.name=T;var j=Error(N);this.stack=j.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function D(E,N){return new Promise(function(T,j){var q=new w(E,N);if(q.signal&&q.signal.aborted)return j(new e.DOMException("Aborted","AbortError"));var ie=new XMLHttpRequest;function ge(){ie.abort()}ie.onload=function(){var be={status:ie.status,statusText:ie.statusText,headers:S(ie.getAllResponseHeaders()||"")};be.url="responseURL"in ie?ie.responseURL:be.headers.get("X-Request-URL");var Se="response"in ie?ie.response:ie.responseText;T(new k(Se,be))},ie.onerror=function(){j(new TypeError("Network request failed"))},ie.ontimeout=function(){j(new TypeError("Network request failed"))},ie.onabort=function(){j(new e.DOMException("Aborted","AbortError"))},ie.open(q.method,q.url,!0),q.credentials==="include"?ie.withCredentials=!0:q.credentials==="omit"&&(ie.withCredentials=!1),"responseType"in ie&&t.blob&&(ie.responseType="blob"),q.headers.forEach(function(be,Se){ie.setRequestHeader(Se,be)}),q.signal&&(q.signal.addEventListener("abort",ge),ie.onreadystatechange=function(){ie.readyState===4&&q.signal.removeEventListener("abort",ge)}),ie.send(typeof q._bodyInit>"u"?null:q._bodyInit)})}return D.polyfill=!0,n.fetch||(n.fetch=D,n.Headers=c,n.Request=w,n.Response=k),e.Headers=c,e.Request=w,e.Response=k,e.fetch=D,Object.defineProperty(e,"__esModule",{value:!0}),e})({})})(typeof self<"u"?self:Ua)})();class hSe extends ey(Ig){constructor(t,i){const r={channel:"x",windowSize:2e4,...t};super(i,r.channel);dr(this,"lastRequestId",0);dr(this,"chrPrefixFixer",t=>t);if(this.params=r,!this.params.url)throw new Error("No URL provided for BamSource");const s=o=>new Vl(ty(o,this.view.getBaseUrl()));this.bam=new cSe({bamFilehandle:s(this.params.url),baiFilehandle:s(this.params.indexUrl??this.params.url+".bai")}),this.headerPromise=this.bam.getHeader(),this.headerPromise.then(o=>{var c,h;const a=this.genome.hasChrPrefix(),l=(h=(c=this.bam.indexToChr)==null?void 0:c[0])==null?void 0:h.refName.startsWith("chr");a&&!l?this.chrPrefixFixer=u=>u.replace("chr",""):!a&&l&&(this.chrPrefixFixer=u=>"chr"+u)})}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;await this.headerPromise;const r=this.quantizeInterval(t,i);if(this.checkAndUpdateLastInterval(r)){const s=this.genome.continuousToDiscreteChromosomeIntervals(r),o=await Promise.all(s.map(a=>this.bam.getRecordsForRange(this.chrPrefixFixer(a.chrom),a.startPos,a.endPos).then(l=>l.map(c=>({chrom:a.chrom,start:c.get("start"),end:c.get("end"),name:c.get("name"),MD:c.get("MD"),cigar:c.get("cigar"),mapq:c.get("mq"),strand:c.get("strand")===1?"+":"-"})))));this.publishData(o.flat())}}}var u3={exports:{}},bm=typeof Reflect=="object"?Reflect:null,rV=bm&&typeof bm.apply=="function"?bm.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},ES;bm&&typeof bm.ownKeys=="function"?ES=bm.ownKeys:Object.getOwnPropertySymbols?ES=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ES=function(e){return Object.getOwnPropertyNames(e)};function uSe(n){console&&console.warn&&console.warn(n)}var XY=Number.isNaN||function(e){return e!==e};function Ci(){Ci.init.call(this)}u3.exports=Ci;u3.exports.once=pSe;Ci.EventEmitter=Ci;Ci.prototype._events=void 0;Ci.prototype._eventsCount=0;Ci.prototype._maxListeners=void 0;var sV=10;function Hk(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Ci,"defaultMaxListeners",{enumerable:!0,get:function(){return sV},set:function(n){if(typeof n!="number"||n<0||XY(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");sV=n}});Ci.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ci.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||XY(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function QY(n){return n._maxListeners===void 0?Ci.defaultMaxListeners:n._maxListeners}Ci.prototype.getMaxListeners=function(){return QY(this)};Ci.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")rV(l,this,t);else for(var c=l.length,h=nX(l,c),i=0;i<c;++i)rV(h[i],this,t);return!0};function JY(n,e,t,i){var r,s,o;if(Hk(t),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),s=n._events),o=s[e]),o===void 0)o=s[e]=t,++n._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),r=QY(n),r>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=n,a.type=e,a.count=o.length,uSe(a)}return n}Ci.prototype.addListener=function(e,t){return JY(this,e,t,!1)};Ci.prototype.on=Ci.prototype.addListener;Ci.prototype.prependListener=function(e,t){return JY(this,e,t,!0)};function dSe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function eX(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},r=dSe.bind(i);return r.listener=t,i.wrapFn=r,r}Ci.prototype.once=function(e,t){return Hk(t),this.on(e,eX(this,e,t)),this};Ci.prototype.prependOnceListener=function(e,t){return Hk(t),this.prependListener(e,eX(this,e,t)),this};Ci.prototype.removeListener=function(e,t){var i,r,s,o,a;if(Hk(t),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():fSe(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Ci.prototype.off=Ci.prototype.removeListener;Ci.prototype.removeAllListeners=function(e){var t,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(r=0;r<s.length;++r)o=s[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function tX(n,e,t){var i=n._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?gSe(r):nX(r,r.length)}Ci.prototype.listeners=function(e){return tX(this,e,!0)};Ci.prototype.rawListeners=function(e){return tX(this,e,!1)};Ci.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):iX.call(n,e)};Ci.prototype.listenerCount=iX;function iX(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ci.prototype.eventNames=function(){return this._eventsCount>0?ES(this._events):[]};function nX(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function fSe(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function gSe(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function pSe(n,e){return new Promise(function(t,i){function r(o){n.removeListener(e,s),i(o)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",r),t([].slice.call(arguments))}rX(n,e,s,{once:!0}),e!=="error"&&mSe(n,r,{once:!0})})}function mSe(n,e,t){typeof n.on=="function"&&rX(n,"error",e,t)}function rX(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function r(s){i.once&&n.removeEventListener(e,r),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var d3=u3.exports,wR={exports:{}};typeof Object.create=="function"?wR.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:wR.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var u0=wR.exports,NI,oV;function sX(){return oV||(oV=1,NI=d3.EventEmitter),NI}const oX=w0e(I0e);var RI,aV;function _Se(){if(aV)return RI;aV=1;function n(d,f){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(d);f&&(p=p.filter(function(m){return Object.getOwnPropertyDescriptor(d,m).enumerable})),g.push.apply(g,p)}return g}function e(d){for(var f=1;f<arguments.length;f++){var g=arguments[f]!=null?arguments[f]:{};f%2?n(Object(g),!0).forEach(function(p){t(d,p,g[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):n(Object(g)).forEach(function(p){Object.defineProperty(d,p,Object.getOwnPropertyDescriptor(g,p))})}return d}function t(d,f,g){return f in d?Object.defineProperty(d,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):d[f]=g,d}function i(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}function r(d,f){for(var g=0;g<f.length;g++){var p=f[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(d,p.key,p)}}function s(d,f,g){return f&&r(d.prototype,f),g&&r(d,g),d}var o=vr,a=o.Buffer,l=oX,c=l.inspect,h=c&&c.custom||"inspect";function u(d,f,g){a.prototype.copy.call(d,f,g)}return RI=function(){function d(){i(this,d),this.head=null,this.tail=null,this.length=0}return s(d,[{key:"push",value:function(g){var p={data:g,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length}},{key:"unshift",value:function(g){var p={data:g,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var p=this.head,m=""+p.data;p=p.next;)m+=g+p.data;return m}},{key:"concat",value:function(g){if(this.length===0)return a.alloc(0);for(var p=a.allocUnsafe(g>>>0),m=this.head,b=0;m;)u(m.data,p,b),b+=m.data.length,m=m.next;return p}},{key:"consume",value:function(g,p){var m;return g<this.head.data.length?(m=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):g===this.head.data.length?m=this.shift():m=p?this._getString(g):this._getBuffer(g),m}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var p=this.head,m=1,b=p.data;for(g-=b.length;p=p.next;){var _=p.data,w=g>_.length?_.length:g;if(w===_.length?b+=_:b+=_.slice(0,g),g-=w,g===0){w===_.length?(++m,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p,p.data=_.slice(w));break}++m}return this.length-=m,b}},{key:"_getBuffer",value:function(g){var p=a.allocUnsafe(g),m=this.head,b=1;for(m.data.copy(p),g-=m.data.length;m=m.next;){var _=m.data,w=g>_.length?_.length:g;if(_.copy(p,p.length-g,0,w),g-=w,g===0){w===_.length?(++b,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=_.slice(w));break}++b}return this.length-=b,p}},{key:h,value:function(g,p){return c(this,e({},p,{depth:0,customInspect:!1}))}}]),d}(),RI}var MI,lV;function aX(){if(lV)return MI;lV=1;function n(o,a){var l=this,c=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return c||h?(a?a(o):o&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(r,this,o)):process.nextTick(r,this,o)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(o||null,function(u){!a&&u?l._writableState?l._writableState.errorEmitted?process.nextTick(t,l):(l._writableState.errorEmitted=!0,process.nextTick(e,l,u)):process.nextTick(e,l,u):a?(process.nextTick(t,l),a(u)):process.nextTick(t,l)}),this)}function e(o,a){r(o,a),t(o)}function t(o){o._writableState&&!o._writableState.emitClose||o._readableState&&!o._readableState.emitClose||o.emit("close")}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function r(o,a){o.emit("error",a)}function s(o,a){var l=o._readableState,c=o._writableState;l&&l.autoDestroy||c&&c.autoDestroy?o.destroy(a):o.emit("error",a)}return MI={destroy:n,undestroy:i,errorOrDestroy:s},MI}var FI={},cV;function d0(){if(cV)return FI;cV=1;function n(a,l){a.prototype=Object.create(l.prototype),a.prototype.constructor=a,a.__proto__=l}var e={};function t(a,l,c){c||(c=Error);function h(d,f,g){return typeof l=="string"?l:l(d,f,g)}var u=function(d){n(f,d);function f(g,p,m){return d.call(this,h(g,p,m))||this}return f}(c);u.prototype.name=c.name,u.prototype.code=a,e[a]=u}function i(a,l){if(Array.isArray(a)){var c=a.length;return a=a.map(function(h){return String(h)}),c>2?"one of ".concat(l," ").concat(a.slice(0,c-1).join(", "),", or ")+a[c-1]:c===2?"one of ".concat(l," ").concat(a[0]," or ").concat(a[1]):"of ".concat(l," ").concat(a[0])}else return"of ".concat(l," ").concat(String(a))}function r(a,l,c){return a.substr(!c||c<0?0:+c,l.length)===l}function s(a,l,c){return(c===void 0||c>a.length)&&(c=a.length),a.substring(c-l.length,c)===l}function o(a,l,c){return typeof c!="number"&&(c=0),c+l.length>a.length?!1:a.indexOf(l,c)!==-1}return t("ERR_INVALID_OPT_VALUE",function(a,l){return'The value "'+l+'" is invalid for option "'+a+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(a,l,c){var h;typeof l=="string"&&r(l,"not ")?(h="must not be",l=l.replace(/^not /,"")):h="must be";var u;if(s(a," argument"))u="The ".concat(a," ").concat(h," ").concat(i(l,"type"));else{var d=o(a,".")?"property":"argument";u='The "'.concat(a,'" ').concat(d," ").concat(h," ").concat(i(l,"type"))}return u+=". Received type ".concat(typeof c),u},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),FI.codes=e,FI}var OI,hV;function lX(){if(hV)return OI;hV=1;var n=d0().codes.ERR_INVALID_OPT_VALUE;function e(i,r,s){return i.highWaterMark!=null?i.highWaterMark:r?i[s]:null}function t(i,r,s,o){var a=e(r,o,s);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var l=o?s:"highWaterMark";throw new n(l,a)}return Math.floor(a)}return i.objectMode?16:16*1024}return OI={getHighWaterMark:t},OI}var PI,uV;function bSe(){if(uV)return PI;uV=1,PI=n;function n(t,i){if(e("noDeprecation"))return t;var r=!1;function s(){if(!r){if(e("throwDeprecation"))throw new Error(i);e("traceDeprecation")?console.trace(i):console.warn(i),r=!0}return t.apply(this,arguments)}return s}function e(t){try{if(!Ua.localStorage)return!1}catch{return!1}var i=Ua.localStorage[t];return i==null?!1:String(i).toLowerCase()==="true"}return PI}var BI,dV;function cX(){if(dV)return BI;dV=1,BI=D;function n(te){var ee=this;this.next=null,this.entry=null,this.finish=function(){Ai(ee,te)}}var e;D.WritableState=k;var t={deprecate:bSe()},i=sX(),r=vr.Buffer,s=Ua.Uint8Array||function(){};function o(te){return r.from(te)}function a(te){return r.isBuffer(te)||te instanceof s}var l=aX(),c=lX(),h=c.getHighWaterMark,u=d0().codes,d=u.ERR_INVALID_ARG_TYPE,f=u.ERR_METHOD_NOT_IMPLEMENTED,g=u.ERR_MULTIPLE_CALLBACK,p=u.ERR_STREAM_CANNOT_PIPE,m=u.ERR_STREAM_DESTROYED,b=u.ERR_STREAM_NULL_VALUES,_=u.ERR_STREAM_WRITE_AFTER_END,w=u.ERR_UNKNOWN_ENCODING,y=l.errorOrDestroy;u0(D,i);function S(){}function k(te,ee,pe){e=e||p_(),te=te||{},typeof pe!="boolean"&&(pe=ee instanceof e),this.objectMode=!!te.objectMode,pe&&(this.objectMode=this.objectMode||!!te.writableObjectMode),this.highWaterMark=h(this,te,"writableHighWaterMark",pe),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var se=te.decodeStrings===!1;this.decodeStrings=!se,this.defaultEncoding=te.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(De){be(ee,De)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=te.emitClose!==!1,this.autoDestroy=!!te.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}k.prototype.getBuffer=function(){for(var ee=this.bufferedRequest,pe=[];ee;)pe.push(ee),ee=ee.next;return pe},function(){try{Object.defineProperty(k.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var C;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(C=Function.prototype[Symbol.hasInstance],Object.defineProperty(D,Symbol.hasInstance,{value:function(ee){return C.call(this,ee)?!0:this!==D?!1:ee&&ee._writableState instanceof k}})):C=function(ee){return ee instanceof this};function D(te){e=e||p_();var ee=this instanceof e;if(!ee&&!C.call(D,this))return new D(te);this._writableState=new k(te,this,ee),this.writable=!0,te&&(typeof te.write=="function"&&(this._write=te.write),typeof te.writev=="function"&&(this._writev=te.writev),typeof te.destroy=="function"&&(this._destroy=te.destroy),typeof te.final=="function"&&(this._final=te.final)),i.call(this)}D.prototype.pipe=function(){y(this,new p)};function E(te,ee){var pe=new _;y(te,pe),process.nextTick(ee,pe)}function N(te,ee,pe,se){var De;return pe===null?De=new b:typeof pe!="string"&&!ee.objectMode&&(De=new d("chunk",["string","Buffer"],pe)),De?(y(te,De),process.nextTick(se,De),!1):!0}D.prototype.write=function(te,ee,pe){var se=this._writableState,De=!1,O=!se.objectMode&&a(te);return O&&!r.isBuffer(te)&&(te=o(te)),typeof ee=="function"&&(pe=ee,ee=null),O?ee="buffer":ee||(ee=se.defaultEncoding),typeof pe!="function"&&(pe=S),se.ending?E(this,pe):(O||N(this,se,te,pe))&&(se.pendingcb++,De=j(this,se,O,te,ee,pe)),De},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){var te=this._writableState;te.corked&&(te.corked--,!te.writing&&!te.corked&&!te.bufferProcessing&&te.bufferedRequest&&ke(this,te))},D.prototype.setDefaultEncoding=function(ee){if(typeof ee=="string"&&(ee=ee.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ee+"").toLowerCase())>-1))throw new w(ee);return this._writableState.defaultEncoding=ee,this},Object.defineProperty(D.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function T(te,ee,pe){return!te.objectMode&&te.decodeStrings!==!1&&typeof ee=="string"&&(ee=r.from(ee,pe)),ee}Object.defineProperty(D.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function j(te,ee,pe,se,De,O){if(!pe){var I=T(ee,se,De);se!==I&&(pe=!0,De="buffer",se=I)}var ue=ee.objectMode?1:se.length;ee.length+=ue;var _e=ee.length<ee.highWaterMark;if(_e||(ee.needDrain=!0),ee.writing||ee.corked){var at=ee.lastBufferedRequest;ee.lastBufferedRequest={chunk:se,encoding:De,isBuf:pe,callback:O,next:null},at?at.next=ee.lastBufferedRequest:ee.bufferedRequest=ee.lastBufferedRequest,ee.bufferedRequestCount+=1}else q(te,ee,!1,ue,se,De,O);return _e}function q(te,ee,pe,se,De,O,I){ee.writelen=se,ee.writecb=I,ee.writing=!0,ee.sync=!0,ee.destroyed?ee.onwrite(new m("write")):pe?te._writev(De,ee.onwrite):te._write(De,O,ee.onwrite),ee.sync=!1}function ie(te,ee,pe,se,De){--ee.pendingcb,pe?(process.nextTick(De,se),process.nextTick(Ct,te,ee),te._writableState.errorEmitted=!0,y(te,se)):(De(se),te._writableState.errorEmitted=!0,y(te,se),Ct(te,ee))}function ge(te){te.writing=!1,te.writecb=null,te.length-=te.writelen,te.writelen=0}function be(te,ee){var pe=te._writableState,se=pe.sync,De=pe.writecb;if(typeof De!="function")throw new g;if(ge(pe),ee)ie(te,pe,se,ee,De);else{var O=Lt(pe)||te.destroyed;!O&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&ke(te,pe),se?process.nextTick(Se,te,pe,O,De):Se(te,pe,O,De)}}function Se(te,ee,pe,se){pe||Le(te,ee),ee.pendingcb--,se(),Ct(te,ee)}function Le(te,ee){ee.length===0&&ee.needDrain&&(ee.needDrain=!1,te.emit("drain"))}function ke(te,ee){ee.bufferProcessing=!0;var pe=ee.bufferedRequest;if(te._writev&&pe&&pe.next){var se=ee.bufferedRequestCount,De=new Array(se),O=ee.corkedRequestsFree;O.entry=pe;for(var I=0,ue=!0;pe;)De[I]=pe,pe.isBuf||(ue=!1),pe=pe.next,I+=1;De.allBuffers=ue,q(te,ee,!0,ee.length,De,"",O.finish),ee.pendingcb++,ee.lastBufferedRequest=null,O.next?(ee.corkedRequestsFree=O.next,O.next=null):ee.corkedRequestsFree=new n(ee),ee.bufferedRequestCount=0}else{for(;pe;){var _e=pe.chunk,at=pe.encoding,ze=pe.callback,lt=ee.objectMode?1:_e.length;if(q(te,ee,!1,lt,_e,at,ze),pe=pe.next,ee.bufferedRequestCount--,ee.writing)break}pe===null&&(ee.lastBufferedRequest=null)}ee.bufferedRequest=pe,ee.bufferProcessing=!1}D.prototype._write=function(te,ee,pe){pe(new f("_write()"))},D.prototype._writev=null,D.prototype.end=function(te,ee,pe){var se=this._writableState;return typeof te=="function"?(pe=te,te=null,ee=null):typeof ee=="function"&&(pe=ee,ee=null),te!=null&&this.write(te,ee),se.corked&&(se.corked=1,this.uncork()),se.ending||ut(this,se,pe),this},Object.defineProperty(D.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Lt(te){return te.ending&&te.length===0&&te.bufferedRequest===null&&!te.finished&&!te.writing}function Ge(te,ee){te._final(function(pe){ee.pendingcb--,pe&&y(te,pe),ee.prefinished=!0,te.emit("prefinish"),Ct(te,ee)})}function Je(te,ee){!ee.prefinished&&!ee.finalCalled&&(typeof te._final=="function"&&!ee.destroyed?(ee.pendingcb++,ee.finalCalled=!0,process.nextTick(Ge,te,ee)):(ee.prefinished=!0,te.emit("prefinish")))}function Ct(te,ee){var pe=Lt(ee);if(pe&&(Je(te,ee),ee.pendingcb===0&&(ee.finished=!0,te.emit("finish"),ee.autoDestroy))){var se=te._readableState;(!se||se.autoDestroy&&se.endEmitted)&&te.destroy()}return pe}function ut(te,ee,pe){ee.ending=!0,Ct(te,ee),pe&&(ee.finished?process.nextTick(pe):te.once("finish",pe)),ee.ended=!0,te.writable=!1}function Ai(te,ee,pe){var se=te.entry;for(te.entry=null;se;){var De=se.callback;ee.pendingcb--,De(pe),se=se.next}ee.corkedRequestsFree.next=te}return Object.defineProperty(D.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(ee){this._writableState&&(this._writableState.destroyed=ee)}}),D.prototype.destroy=l.destroy,D.prototype._undestroy=l.undestroy,D.prototype._destroy=function(te,ee){ee(te)},BI}var VI,fV;function p_(){if(fV)return VI;fV=1;var n=Object.keys||function(c){var h=[];for(var u in c)h.push(u);return h};VI=o;var e=hX(),t=cX();u0(o,e);for(var i=n(t.prototype),r=0;r<i.length;r++){var s=i[r];o.prototype[s]||(o.prototype[s]=t.prototype[s])}function o(c){if(!(this instanceof o))return new o(c);e.call(this,c),t.call(this,c),this.allowHalfOpen=!0,c&&(c.readable===!1&&(this.readable=!1),c.writable===!1&&(this.writable=!1),c.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||process.nextTick(l,this)}function l(c){c.end()}return Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(h){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=h,this._writableState.destroyed=h)}}),VI}var yR={},CR={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=vr,i=t.Buffer;function r(o,a){for(var l in o)a[l]=o[l]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=t:(r(t,e),e.Buffer=s);function s(o,a,l){return i(o,a,l)}s.prototype=Object.create(i.prototype),r(i,s),s.from=function(o,a,l){if(typeof o=="number")throw new TypeError("Argument must not be a number");return i(o,a,l)},s.alloc=function(o,a,l){if(typeof o!="number")throw new TypeError("Argument must be a number");var c=i(o);return a!==void 0?typeof l=="string"?c.fill(a,l):c.fill(a):c.fill(0),c},s.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return i(o)},s.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}})(CR,CR.exports);var vSe=CR.exports,f3=vSe.Buffer,gV=f3.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function wSe(n){if(!n)return"utf8";for(var e;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(e)return;n=(""+n).toLowerCase(),e=!0}}function ySe(n){var e=wSe(n);if(typeof e!="string"&&(f3.isEncoding===gV||!gV(n)))throw new Error("Unknown encoding: "+n);return e||n}var CSe=yR.StringDecoder=ly;function ly(n){this.encoding=ySe(n);var e;switch(this.encoding){case"utf16le":this.text=LSe,this.end=ISe,e=4;break;case"utf8":this.fillLast=ESe,e=4;break;case"base64":this.text=TSe,this.end=ASe,e=3;break;default:this.write=NSe,this.end=RSe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=f3.allocUnsafe(e)}ly.prototype.write=function(n){if(n.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(n),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<n.length?e?e+this.text(n,t):this.text(n,t):e||""};ly.prototype.end=kSe;ly.prototype.text=DSe;ly.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function WI(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function SSe(n,e,t){var i=e.length-1;if(i<t)return 0;var r=WI(e[i]);return r>=0?(r>0&&(n.lastNeed=r-1),r):--i<t||r===-2?0:(r=WI(e[i]),r>=0?(r>0&&(n.lastNeed=r-2),r):--i<t||r===-2?0:(r=WI(e[i]),r>=0?(r>0&&(r===2?r=0:n.lastNeed=r-3),r):0))}function xSe(n,e,t){if((e[0]&192)!==128)return n.lastNeed=0,"";if(n.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return n.lastNeed=1,"";if(n.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return n.lastNeed=2,""}}function ESe(n){var e=this.lastTotal-this.lastNeed,t=xSe(this,n);if(t!==void 0)return t;if(this.lastNeed<=n.length)return n.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,e,0,n.length),this.lastNeed-=n.length}function DSe(n,e){var t=SSe(this,n,e);if(!this.lastNeed)return n.toString("utf8",e);this.lastTotal=t;var i=n.length-(t-this.lastNeed);return n.copy(this.lastChar,0,i),n.toString("utf8",e,i)}function kSe(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"":e}function LSe(n,e){if((n.length-e)%2===0){var t=n.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",e,n.length-1)}function ISe(n){var e=n&&n.length?this.write(n):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function TSe(n,e){var t=(n.length-e)%3;return t===0?n.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",e,n.length-t))}function ASe(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function NSe(n){return n.toString(this.encoding)}function RSe(n){return n&&n.length?this.write(n):""}var $I,pV;function g3(){if(pV)return $I;pV=1;var n=d0().codes.ERR_STREAM_PREMATURE_CLOSE;function e(s){var o=!1;return function(){if(!o){o=!0;for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];s.apply(this,l)}}}function t(){}function i(s){return s.setHeader&&typeof s.abort=="function"}function r(s,o,a){if(typeof o=="function")return r(s,null,o);o||(o={}),a=e(a||t);var l=o.readable||o.readable!==!1&&s.readable,c=o.writable||o.writable!==!1&&s.writable,h=function(){s.writable||d()},u=s._writableState&&s._writableState.finished,d=function(){c=!1,u=!0,l||a.call(s)},f=s._readableState&&s._readableState.endEmitted,g=function(){l=!1,f=!0,c||a.call(s)},p=function(w){a.call(s,w)},m=function(){var w;if(l&&!f)return(!s._readableState||!s._readableState.ended)&&(w=new n),a.call(s,w);if(c&&!u)return(!s._writableState||!s._writableState.ended)&&(w=new n),a.call(s,w)},b=function(){s.req.on("finish",d)};return i(s)?(s.on("complete",d),s.on("abort",m),s.req?b():s.on("request",b)):c&&!s._writableState&&(s.on("end",h),s.on("close",h)),s.on("end",g),s.on("finish",d),o.error!==!1&&s.on("error",p),s.on("close",m),function(){s.removeListener("complete",d),s.removeListener("abort",m),s.removeListener("request",b),s.req&&s.req.removeListener("finish",d),s.removeListener("end",h),s.removeListener("close",h),s.removeListener("finish",d),s.removeListener("end",g),s.removeListener("error",p),s.removeListener("close",m)}}return $I=r,$I}var zI,mV;function MSe(){if(mV)return zI;mV=1;var n;function e(b,_,w){return _ in b?Object.defineProperty(b,_,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[_]=w,b}var t=g3(),i=Symbol("lastResolve"),r=Symbol("lastReject"),s=Symbol("error"),o=Symbol("ended"),a=Symbol("lastPromise"),l=Symbol("handlePromise"),c=Symbol("stream");function h(b,_){return{value:b,done:_}}function u(b){var _=b[i];if(_!==null){var w=b[c].read();w!==null&&(b[a]=null,b[i]=null,b[r]=null,_(h(w,!1)))}}function d(b){process.nextTick(u,b)}function f(b,_){return function(w,y){b.then(function(){if(_[o]){w(h(void 0,!0));return}_[l](w,y)},y)}}var g=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((n={get stream(){return this[c]},next:function(){var _=this,w=this[s];if(w!==null)return Promise.reject(w);if(this[o])return Promise.resolve(h(void 0,!0));if(this[c].destroyed)return new Promise(function(C,D){process.nextTick(function(){_[s]?D(_[s]):C(h(void 0,!0))})});var y=this[a],S;if(y)S=new Promise(f(y,this));else{var k=this[c].read();if(k!==null)return Promise.resolve(h(k,!1));S=new Promise(this[l])}return this[a]=S,S}},e(n,Symbol.asyncIterator,function(){return this}),e(n,"return",function(){var _=this;return new Promise(function(w,y){_[c].destroy(null,function(S){if(S){y(S);return}w(h(void 0,!0))})})}),n),g),m=function(_){var w,y=Object.create(p,(w={},e(w,c,{value:_,writable:!0}),e(w,i,{value:null,writable:!0}),e(w,r,{value:null,writable:!0}),e(w,s,{value:null,writable:!0}),e(w,o,{value:_._readableState.endEmitted,writable:!0}),e(w,l,{value:function(k,C){var D=y[c].read();D?(y[a]=null,y[i]=null,y[r]=null,k(h(D,!1))):(y[i]=k,y[r]=C)},writable:!0}),w));return y[a]=null,t(_,function(S){if(S&&S.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=y[r];k!==null&&(y[a]=null,y[i]=null,y[r]=null,k(S)),y[s]=S;return}var C=y[i];C!==null&&(y[a]=null,y[i]=null,y[r]=null,C(h(void 0,!0))),y[o]=!0}),_.on("readable",d.bind(null,y)),y};return zI=m,zI}var HI,_V;function FSe(){return _V||(_V=1,HI=function(){throw new Error("Readable.from is not available in the browser")}),HI}var UI,bV;function hX(){if(bV)return UI;bV=1,UI=E;var n;E.ReadableState=D,d3.EventEmitter;var e=function(I,ue){return I.listeners(ue).length},t=sX(),i=vr.Buffer,r=Ua.Uint8Array||function(){};function s(O){return i.from(O)}function o(O){return i.isBuffer(O)||O instanceof r}var a=oX,l;a&&a.debuglog?l=a.debuglog("stream"):l=function(){};var c=_Se(),h=aX(),u=lX(),d=u.getHighWaterMark,f=d0().codes,g=f.ERR_INVALID_ARG_TYPE,p=f.ERR_STREAM_PUSH_AFTER_EOF,m=f.ERR_METHOD_NOT_IMPLEMENTED,b=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,w,y;u0(E,t);var S=h.errorOrDestroy,k=["error","close","destroy","pause","resume"];function C(O,I,ue){if(typeof O.prependListener=="function")return O.prependListener(I,ue);!O._events||!O._events[I]?O.on(I,ue):Array.isArray(O._events[I])?O._events[I].unshift(ue):O._events[I]=[ue,O._events[I]]}function D(O,I,ue){n=n||p_(),O=O||{},typeof ue!="boolean"&&(ue=I instanceof n),this.objectMode=!!O.objectMode,ue&&(this.objectMode=this.objectMode||!!O.readableObjectMode),this.highWaterMark=d(this,O,"readableHighWaterMark",ue),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.destroyed=!1,this.defaultEncoding=O.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,O.encoding&&(_||(_=yR.StringDecoder),this.decoder=new _(O.encoding),this.encoding=O.encoding)}function E(O){if(n=n||p_(),!(this instanceof E))return new E(O);var I=this instanceof n;this._readableState=new D(O,this,I),this.readable=!0,O&&(typeof O.read=="function"&&(this._read=O.read),typeof O.destroy=="function"&&(this._destroy=O.destroy)),t.call(this)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(I){this._readableState&&(this._readableState.destroyed=I)}}),E.prototype.destroy=h.destroy,E.prototype._undestroy=h.undestroy,E.prototype._destroy=function(O,I){I(O)},E.prototype.push=function(O,I){var ue=this._readableState,_e;return ue.objectMode?_e=!0:typeof O=="string"&&(I=I||ue.defaultEncoding,I!==ue.encoding&&(O=i.from(O,I),I=""),_e=!0),N(this,O,I,!1,_e)},E.prototype.unshift=function(O){return N(this,O,null,!0,!1)};function N(O,I,ue,_e,at){l("readableAddChunk",I);var ze=O._readableState;if(I===null)ze.reading=!1,be(O,ze);else{var lt;if(at||(lt=j(ze,I)),lt)S(O,lt);else if(ze.objectMode||I&&I.length>0)if(typeof I!="string"&&!ze.objectMode&&Object.getPrototypeOf(I)!==i.prototype&&(I=s(I)),_e)ze.endEmitted?S(O,new b):T(O,ze,I,!0);else if(ze.ended)S(O,new p);else{if(ze.destroyed)return!1;ze.reading=!1,ze.decoder&&!ue?(I=ze.decoder.write(I),ze.objectMode||I.length!==0?T(O,ze,I,!1):ke(O,ze)):T(O,ze,I,!1)}else _e||(ze.reading=!1,ke(O,ze))}return!ze.ended&&(ze.length<ze.highWaterMark||ze.length===0)}function T(O,I,ue,_e){I.flowing&&I.length===0&&!I.sync?(I.awaitDrain=0,O.emit("data",ue)):(I.length+=I.objectMode?1:ue.length,_e?I.buffer.unshift(ue):I.buffer.push(ue),I.needReadable&&Se(O)),ke(O,I)}function j(O,I){var ue;return!o(I)&&typeof I!="string"&&I!==void 0&&!O.objectMode&&(ue=new g("chunk",["string","Buffer","Uint8Array"],I)),ue}E.prototype.isPaused=function(){return this._readableState.flowing===!1},E.prototype.setEncoding=function(O){_||(_=yR.StringDecoder);var I=new _(O);this._readableState.decoder=I,this._readableState.encoding=this._readableState.decoder.encoding;for(var ue=this._readableState.buffer.head,_e="";ue!==null;)_e+=I.write(ue.data),ue=ue.next;return this._readableState.buffer.clear(),_e!==""&&this._readableState.buffer.push(_e),this._readableState.length=_e.length,this};var q=1073741824;function ie(O){return O>=q?O=q:(O--,O|=O>>>1,O|=O>>>2,O|=O>>>4,O|=O>>>8,O|=O>>>16,O++),O}function ge(O,I){return O<=0||I.length===0&&I.ended?0:I.objectMode?1:O!==O?I.flowing&&I.length?I.buffer.head.data.length:I.length:(O>I.highWaterMark&&(I.highWaterMark=ie(O)),O<=I.length?O:I.ended?I.length:(I.needReadable=!0,0))}E.prototype.read=function(O){l("read",O),O=parseInt(O,10);var I=this._readableState,ue=O;if(O!==0&&(I.emittedReadable=!1),O===0&&I.needReadable&&((I.highWaterMark!==0?I.length>=I.highWaterMark:I.length>0)||I.ended))return l("read: emitReadable",I.length,I.ended),I.length===0&&I.ended?pe(this):Se(this),null;if(O=ge(O,I),O===0&&I.ended)return I.length===0&&pe(this),null;var _e=I.needReadable;l("need readable",_e),(I.length===0||I.length-O<I.highWaterMark)&&(_e=!0,l("length less than watermark",_e)),I.ended||I.reading?(_e=!1,l("reading or ended",_e)):_e&&(l("do read"),I.reading=!0,I.sync=!0,I.length===0&&(I.needReadable=!0),this._read(I.highWaterMark),I.sync=!1,I.reading||(O=ge(ue,I)));var at;return O>0?at=ee(O,I):at=null,at===null?(I.needReadable=I.length<=I.highWaterMark,O=0):(I.length-=O,I.awaitDrain=0),I.length===0&&(I.ended||(I.needReadable=!0),ue!==O&&I.ended&&pe(this)),at!==null&&this.emit("data",at),at};function be(O,I){if(l("onEofChunk"),!I.ended){if(I.decoder){var ue=I.decoder.end();ue&&ue.length&&(I.buffer.push(ue),I.length+=I.objectMode?1:ue.length)}I.ended=!0,I.sync?Se(O):(I.needReadable=!1,I.emittedReadable||(I.emittedReadable=!0,Le(O)))}}function Se(O){var I=O._readableState;l("emitReadable",I.needReadable,I.emittedReadable),I.needReadable=!1,I.emittedReadable||(l("emitReadable",I.flowing),I.emittedReadable=!0,process.nextTick(Le,O))}function Le(O){var I=O._readableState;l("emitReadable_",I.destroyed,I.length,I.ended),!I.destroyed&&(I.length||I.ended)&&(O.emit("readable"),I.emittedReadable=!1),I.needReadable=!I.flowing&&!I.ended&&I.length<=I.highWaterMark,te(O)}function ke(O,I){I.readingMore||(I.readingMore=!0,process.nextTick(Lt,O,I))}function Lt(O,I){for(;!I.reading&&!I.ended&&(I.length<I.highWaterMark||I.flowing&&I.length===0);){var ue=I.length;if(l("maybeReadMore read 0"),O.read(0),ue===I.length)break}I.readingMore=!1}E.prototype._read=function(O){S(this,new m("_read()"))},E.prototype.pipe=function(O,I){var ue=this,_e=this._readableState;switch(_e.pipesCount){case 0:_e.pipes=O;break;case 1:_e.pipes=[_e.pipes,O];break;default:_e.pipes.push(O);break}_e.pipesCount+=1,l("pipe count=%d opts=%j",_e.pipesCount,I);var at=(!I||I.end!==!1)&&O!==process.stdout&&O!==process.stderr,ze=at?fn:Ir;_e.endEmitted?process.nextTick(ze):ue.once("end",ze),O.on("unpipe",lt);function lt(R,x){l("onunpipe"),R===ue&&x&&x.hasUnpiped===!1&&(x.hasUnpiped=!0,kr())}function fn(){l("onend"),O.end()}var Us=Ge(ue);O.on("drain",Us);var Qr=!1;function kr(){l("cleanup"),O.removeListener("close",Lr),O.removeListener("finish",Nn),O.removeListener("drain",Us),O.removeListener("error",Vn),O.removeListener("unpipe",lt),ue.removeListener("end",fn),ue.removeListener("end",Ir),ue.removeListener("data",Wi),Qr=!0,_e.awaitDrain&&(!O._writableState||O._writableState.needDrain)&&Us()}ue.on("data",Wi);function Wi(R){l("ondata");var x=O.write(R);l("dest.write",x),x===!1&&((_e.pipesCount===1&&_e.pipes===O||_e.pipesCount>1&&De(_e.pipes,O)!==-1)&&!Qr&&(l("false write response, pause",_e.awaitDrain),_e.awaitDrain++),ue.pause())}function Vn(R){l("onerror",R),Ir(),O.removeListener("error",Vn),e(O,"error")===0&&S(O,R)}C(O,"error",Vn);function Lr(){O.removeListener("finish",Nn),Ir()}O.once("close",Lr);function Nn(){l("onfinish"),O.removeListener("close",Lr),Ir()}O.once("finish",Nn);function Ir(){l("unpipe"),ue.unpipe(O)}return O.emit("pipe",ue),_e.flowing||(l("pipe resume"),ue.resume()),O};function Ge(O){return function(){var ue=O._readableState;l("pipeOnDrain",ue.awaitDrain),ue.awaitDrain&&ue.awaitDrain--,ue.awaitDrain===0&&e(O,"data")&&(ue.flowing=!0,te(O))}}E.prototype.unpipe=function(O){var I=this._readableState,ue={hasUnpiped:!1};if(I.pipesCount===0)return this;if(I.pipesCount===1)return O&&O!==I.pipes?this:(O||(O=I.pipes),I.pipes=null,I.pipesCount=0,I.flowing=!1,O&&O.emit("unpipe",this,ue),this);if(!O){var _e=I.pipes,at=I.pipesCount;I.pipes=null,I.pipesCount=0,I.flowing=!1;for(var ze=0;ze<at;ze++)_e[ze].emit("unpipe",this,{hasUnpiped:!1});return this}var lt=De(I.pipes,O);return lt===-1?this:(I.pipes.splice(lt,1),I.pipesCount-=1,I.pipesCount===1&&(I.pipes=I.pipes[0]),O.emit("unpipe",this,ue),this)},E.prototype.on=function(O,I){var ue=t.prototype.on.call(this,O,I),_e=this._readableState;return O==="data"?(_e.readableListening=this.listenerCount("readable")>0,_e.flowing!==!1&&this.resume()):O==="readable"&&!_e.endEmitted&&!_e.readableListening&&(_e.readableListening=_e.needReadable=!0,_e.flowing=!1,_e.emittedReadable=!1,l("on readable",_e.length,_e.reading),_e.length?Se(this):_e.reading||process.nextTick(Ct,this)),ue},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(O,I){var ue=t.prototype.removeListener.call(this,O,I);return O==="readable"&&process.nextTick(Je,this),ue},E.prototype.removeAllListeners=function(O){var I=t.prototype.removeAllListeners.apply(this,arguments);return(O==="readable"||O===void 0)&&process.nextTick(Je,this),I};function Je(O){var I=O._readableState;I.readableListening=O.listenerCount("readable")>0,I.resumeScheduled&&!I.paused?I.flowing=!0:O.listenerCount("data")>0&&O.resume()}function Ct(O){l("readable nexttick read 0"),O.read(0)}E.prototype.resume=function(){var O=this._readableState;return O.flowing||(l("resume"),O.flowing=!O.readableListening,ut(this,O)),O.paused=!1,this};function ut(O,I){I.resumeScheduled||(I.resumeScheduled=!0,process.nextTick(Ai,O,I))}function Ai(O,I){l("resume",I.reading),I.reading||O.read(0),I.resumeScheduled=!1,O.emit("resume"),te(O),I.flowing&&!I.reading&&O.read(0)}E.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function te(O){var I=O._readableState;for(l("flow",I.flowing);I.flowing&&O.read()!==null;);}E.prototype.wrap=function(O){var I=this,ue=this._readableState,_e=!1;O.on("end",function(){if(l("wrapped end"),ue.decoder&&!ue.ended){var lt=ue.decoder.end();lt&&lt.length&&I.push(lt)}I.push(null)}),O.on("data",function(lt){if(l("wrapped data"),ue.decoder&&(lt=ue.decoder.write(lt)),!(ue.objectMode&&lt==null)&&!(!ue.objectMode&&(!lt||!lt.length))){var fn=I.push(lt);fn||(_e=!0,O.pause())}});for(var at in O)this[at]===void 0&&typeof O[at]=="function"&&(this[at]=function(fn){return function(){return O[fn].apply(O,arguments)}}(at));for(var ze=0;ze<k.length;ze++)O.on(k[ze],this.emit.bind(this,k[ze]));return this._read=function(lt){l("wrapped _read",lt),_e&&(_e=!1,O.resume())},this},typeof Symbol=="function"&&(E.prototype[Symbol.asyncIterator]=function(){return w===void 0&&(w=MSe()),w(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}}),E._fromList=ee,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ee(O,I){if(I.length===0)return null;var ue;return I.objectMode?ue=I.buffer.shift():!O||O>=I.length?(I.decoder?ue=I.buffer.join(""):I.buffer.length===1?ue=I.buffer.first():ue=I.buffer.concat(I.length),I.buffer.clear()):ue=I.buffer.consume(O,I.decoder),ue}function pe(O){var I=O._readableState;l("endReadable",I.endEmitted),I.endEmitted||(I.ended=!0,process.nextTick(se,I,O))}function se(O,I){if(l("endReadableNT",O.endEmitted,O.length),!O.endEmitted&&O.length===0&&(O.endEmitted=!0,I.readable=!1,I.emit("end"),O.autoDestroy)){var ue=I._writableState;(!ue||ue.autoDestroy&&ue.finished)&&I.destroy()}}typeof Symbol=="function"&&(E.from=function(O,I){return y===void 0&&(y=FSe()),y(E,O,I)});function De(O,I){for(var ue=0,_e=O.length;ue<_e;ue++)if(O[ue]===I)return ue;return-1}return UI}var jI,vV;function uX(){if(vV)return jI;vV=1,jI=a;var n=d0().codes,e=n.ERR_METHOD_NOT_IMPLEMENTED,t=n.ERR_MULTIPLE_CALLBACK,i=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,r=n.ERR_TRANSFORM_WITH_LENGTH_0,s=p_();u0(a,s);function o(h,u){var d=this._transformState;d.transforming=!1;var f=d.writecb;if(f===null)return this.emit("error",new t);d.writechunk=null,d.writecb=null,u!=null&&this.push(u),f(h);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function a(h){if(!(this instanceof a))return new a(h);s.call(this,h),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",l)}function l(){var h=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(u,d){c(h,u,d)}):c(this,null,null)}a.prototype.push=function(h,u){return this._transformState.needTransform=!1,s.prototype.push.call(this,h,u)},a.prototype._transform=function(h,u,d){d(new e("_transform()"))},a.prototype._write=function(h,u,d){var f=this._transformState;if(f.writecb=d,f.writechunk=h,f.writeencoding=u,!f.transforming){var g=this._readableState;(f.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},a.prototype._read=function(h){var u=this._transformState;u.writechunk!==null&&!u.transforming?(u.transforming=!0,this._transform(u.writechunk,u.writeencoding,u.afterTransform)):u.needTransform=!0},a.prototype._destroy=function(h,u){s.prototype._destroy.call(this,h,function(d){u(d)})};function c(h,u,d){if(u)return h.emit("error",u);if(d!=null&&h.push(d),h._writableState.length)throw new r;if(h._transformState.transforming)throw new i;return h.push(null)}return jI}var qI,wV;function OSe(){if(wV)return qI;wV=1,qI=e;var n=uX();u0(e,n);function e(t){if(!(this instanceof e))return new e(t);n.call(this,t)}return e.prototype._transform=function(t,i,r){r(null,t)},qI}var GI,yV;function PSe(){if(yV)return GI;yV=1;var n;function e(d){var f=!1;return function(){f||(f=!0,d.apply(void 0,arguments))}}var t=d0().codes,i=t.ERR_MISSING_ARGS,r=t.ERR_STREAM_DESTROYED;function s(d){if(d)throw d}function o(d){return d.setHeader&&typeof d.abort=="function"}function a(d,f,g,p){p=e(p);var m=!1;d.on("close",function(){m=!0}),n===void 0&&(n=g3()),n(d,{readable:f,writable:g},function(_){if(_)return p(_);m=!0,p()});var b=!1;return function(_){if(!m&&!b){if(b=!0,o(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();p(_||new r("pipe"))}}}function l(d){d()}function c(d,f){return d.pipe(f)}function h(d){return!d.length||typeof d[d.length-1]!="function"?s:d.pop()}function u(){for(var d=arguments.length,f=new Array(d),g=0;g<d;g++)f[g]=arguments[g];var p=h(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new i("streams");var m,b=f.map(function(_,w){var y=w<f.length-1,S=w>0;return a(_,y,S,function(k){m||(m=k),k&&b.forEach(l),!y&&(b.forEach(l),p(m))})});return f.reduce(c)}return GI=u,GI}var dX=sa,p3=d3.EventEmitter,BSe=u0;BSe(sa,p3);sa.Readable=hX();sa.Writable=cX();sa.Duplex=p_();sa.Transform=uX();sa.PassThrough=OSe();sa.finished=g3();sa.pipeline=PSe();sa.Stream=sa;function sa(){p3.call(this)}sa.prototype.pipe=function(n,e){var t=this;function i(h){n.writable&&n.write(h)===!1&&t.pause&&t.pause()}t.on("data",i);function r(){t.readable&&t.resume&&t.resume()}n.on("drain",r),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",o),t.on("close",a));var s=!1;function o(){s||(s=!0,n.end())}function a(){s||(s=!0,typeof n.destroy=="function"&&n.destroy())}function l(h){if(c(),p3.listenerCount(this,"error")===0)throw h}t.on("error",l),n.on("error",l);function c(){t.removeListener("data",i),n.removeListener("drain",r),t.removeListener("end",o),t.removeListener("close",a),t.removeListener("error",l),n.removeListener("error",l),t.removeListener("end",c),t.removeListener("close",c),n.removeListener("close",c)}return t.on("end",c),t.on("close",c),n.on("close",c),n.emit("pipe",t),n};function Kb(n){return n.replace(/%([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}function fX(n,e){return String(e).replace(n,t=>`%${t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}`)}function _b(n){return fX(/[\n;\r\t=%&,\x00-\x1f\x7f-\xff]/g,n)}function Mc(n){return fX(/[\n\r\t%\x00-\x1f\x7f-\xff]/g,n)}function gX(n){if(!(n&&n.length)||n===".")return{};const e={};return n.replace(/\r?\n$/,"").split(";").forEach(t=>{const i=t.split("=",2);if(!(i[1]&&i[1].length))return;i[0]=i[0].trim();let r=e[i[0].trim()];r||(r=[],e[i[0]]=r),r.push(...i[1].split(",").map(s=>s.trim()).map(Kb))}),e}function pX(n){const e=n.split("	").map(i=>i==="."||i===""?null:i);return{seq_id:e[0]&&Kb(e[0]),source:e[1]&&Kb(e[1]),type:e[2]&&Kb(e[2]),start:e[3]===null?null:parseInt(e[3],10),end:e[4]===null?null:parseInt(e[4],10),score:e[5]===null?null:parseFloat(e[5]),strand:e[6],phase:e[7],attributes:e[8]===null?null:gX(e[8])}}function mX(n){const e=/^\s*##\s*(\S+)\s*(.*)/.exec(n);if(!e)return null;const[,t]=e;let[,,i]=e;const r={directive:t};if(i.length&&(i=i.replace(/\r?\n$/,""),r.value=i),t==="sequence-region"){const s=i.split(/\s+/,3);return{...r,seq_id:s[0],start:s[1]&&s[1].replace(/\D/g,""),end:s[2]&&s[2].replace(/\D/g,"")}}else if(t==="genome-build"){const[s,o]=i.split(/\s+/,2);return{...r,source:s,buildName:o}}return r}function _X(n){const e=[];return Object.entries(n).forEach(([t,i])=>{if(!i)return;let r;i.hasOwnProperty("toString")?r=_b(i.toString()):Array.isArray(i)?r=i.map(_b).join(","):r=_b(i),e.push(`${_b(t)}=${r}`)}),e.length?e.join(";"):"."}function VSe(n,e){const t=n.attributes===null||n.attributes===void 0?".":_X(n.attributes),r=`${[n.seq_id===null?".":Mc(n.seq_id),n.source===null?".":Mc(n.source),n.type===null?".":Mc(n.type),n.start===null?".":Mc(n.start),n.end===null?".":Mc(n.end),n.score===null?".":Mc(n.score),n.strand===null?".":Mc(n.strand),n.phase===null?".":Mc(n.phase),t].join("	")}
`;return e[r]?"":(e[r]=!0,r)}function DS(n,e){if(Array.isArray(n))return n.map(i=>DS(i,e)).join("");const t=[VSe(n,e)];return WSe(n)&&t.push(...n.child_features.map(i=>DS(i,e)),...n.derived_features.map(i=>DS(i,e))),t.join("")}function bX(n){return DS(n,{})}function vX(n){let e=`##${n.directive}`;return n.value&&(e+=` ${n.value}`),e+=`
`,e}function wX(n){return`# ${n.comment}
`}function m3(n){return`>${n.id}${n.description?` ${n.description}`:""}
${n.sequence}
`}function rE(n){function e(t){return"attributes"in t?bX(t):"directive"in t?vX(t):"sequence"in t?m3(t):"comment"in t?wX(t):`# (invalid item found during format)
`}return Array.isArray(n)?n.map(e):e(n)}function WSe(n){return n.child_features!==void 0&&n.derived_features!==void 0}const $Se=Object.freeze(Object.defineProperty({__proto__:null,escape:_b,escapeColumn:Mc,formatAttributes:_X,formatComment:wX,formatDirective:vX,formatFeature:bX,formatItem:rE,formatSequence:m3,parseAttributes:gX,parseDirective:mX,parseFeature:pX,unescape:Kb},Symbol.toStringTag,{value:"Module"})),CV={Parent:"child_features",Derives_from:"derived_features"};class SV{constructor(e){this.seqCallback=e,this.currentSequence=void 0}addLine(e){const t=/^>\s*(\S+)\s*(.*)/.exec(e);t?(this._flush(),this.currentSequence={id:t[1],sequence:""},t[2]&&(this.currentSequence.description=t[2].trim())):this.currentSequence&&/\S/.test(e)&&(this.currentSequence.sequence+=e.replace(/\s/g,""))}_flush(){this.currentSequence&&this.seqCallback(this.currentSequence)}finish(){this._flush()}}let yX=class{constructor(e){this.fastaParser=void 0,this.eof=!1,this.lineNumber=0,this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},this._underConstructionOrphans={};const t=()=>{};this.featureCallback=e.featureCallback||t,this.endCallback=e.endCallback||t,this.commentCallback=e.commentCallback||t,this.errorCallback=e.errorCallback||t,this.directiveCallback=e.directiveCallback||t,this.sequenceCallback=e.sequenceCallback||t,this.disableDerivesFromReferences=e.disableDerivesFromReferences||!1,this.bufferSize=e.bufferSize===void 0?1e3:e.bufferSize}addLine(e){if(this.fastaParser){this.fastaParser.addLine(e);return}if(this.eof)return;if(this.lineNumber+=1,/^\s*[^#\s>]/.test(e)){this._bufferLine(e);return}const t=/^\s*(#+)(.*)/.exec(e);if(t){const[,i]=t;let[,,r]=t;if(i.length===3)this._emitAllUnderConstructionFeatures();else if(i.length===2){const s=mX(e);s&&(s.directive==="FASTA"?(this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new SV(this.sequenceCallback)):this._emitItem(s))}else r=r.replace(/\s*/,""),this._emitItem({comment:r})}else if(!/^\s*$/.test(e))if(/^\s*>/.test(e))this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new SV(this.sequenceCallback),this.fastaParser.addLine(e);else{const i=e.replace(/\r?\n?$/g,"");throw new Error(`GFF3 parse error.  Cannot parse '${i}'.`)}}finish(){this._emitAllUnderConstructionFeatures(),this.fastaParser&&this.fastaParser.finish(),this.endCallback()}_emitItem(e){Array.isArray(e)?this.featureCallback(e):"directive"in e?this.directiveCallback(e):"comment"in e&&this.commentCallback(e)}_enforceBufferSizeLimit(e=0){const t=i=>{i&&Array.isArray(i)&&i[0].attributes&&i[0].attributes.ID&&i[0].attributes.ID[0]&&(i[0].attributes.ID.forEach(s=>{delete this._underConstructionById[s],delete this._completedReferences[s]}),i.forEach(s=>{s.child_features&&s.child_features.forEach(o=>t(o)),s.derived_features&&s.derived_features.forEach(o=>t(o))}))};for(;this._underConstructionTopLevel.length+e>this.bufferSize;){const i=this._underConstructionTopLevel.shift();i&&(this._emitItem(i),t(i))}}_emitAllUnderConstructionFeatures(){if(this._underConstructionTopLevel.forEach(this._emitItem.bind(this)),this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},Array.from(Object.values(this._underConstructionOrphans)).length)throw new Error(`some features reference other features that do not exist in the file (or in the same '###' scope). ${Object.keys(this._underConstructionOrphans)}`)}_bufferLine(e){var t,i,r;const o={...pX(e),child_features:[],derived_features:[]},a=((t=o.attributes)===null||t===void 0?void 0:t.ID)||[],l=((i=o.attributes)===null||i===void 0?void 0:i.Parent)||[],c=this.disableDerivesFromReferences?[]:((r=o.attributes)===null||r===void 0?void 0:r.Derives_from)||[];if(!a.length&&!l.length&&!c.length){this._emitItem([o]);return}let h;a.forEach(u=>{const d=this._underConstructionById[u];d?(d[d.length-1].type!==o.type&&this._parseError(`multi-line feature "${u}" has inconsistent types: "${o.type}", "${d[d.length-1].type}"`),d.push(o),h=d):(h=[o],this._enforceBufferSizeLimit(1),!l.length&&!c.length&&this._underConstructionTopLevel.push(h),this._underConstructionById[u]=h,this._resolveReferencesTo(h,u))}),this._resolveReferencesFrom(h||[o],{Parent:l,Derives_from:c},a)}_resolveReferencesTo(e,t){const i=this._underConstructionOrphans[t];i&&(e.forEach(r=>{r.child_features.push(...i.Parent)}),e.forEach(r=>{r.derived_features.push(...i.Derives_from)}),delete this._underConstructionOrphans[t])}_parseError(e){this.eof=!0,this.errorCallback(`${this.lineNumber}: ${e}`)}_resolveReferencesFrom(e,t,i){function r(s,o,a){let l=s[o];l||(l={},s[o]=l);const c=l[a]||!1;return l[a]=!0,c}t.Parent.forEach(s=>{const o=this._underConstructionById[s];if(o){const a=CV.Parent;i.filter(l=>r(this._completedReferences,l,`Parent,${s}`)).length||o.forEach(l=>{l[a].push(e)})}else{let a=this._underConstructionOrphans[s];a||(a={Parent:[],Derives_from:[]},this._underConstructionOrphans[s]=a),a.Parent.push(e)}}),t.Derives_from.forEach(s=>{const o=this._underConstructionById[s];if(o){const a=CV.Derives_from;i.filter(l=>r(this._completedReferences,l,`Derives_from,${s}`)).length||o.forEach(l=>{l[a].push(e)})}else{let a=this._underConstructionOrphans[s];a||(a={Parent:[],Derives_from:[]},this._underConstructionOrphans[s]=a),a.Derives_from.push(e)}})}};function SR(n){process&&process.nextTick?process.nextTick(n):n()}function CX(n){const e={encoding:"utf8",parseFeatures:!0,parseDirectives:!1,parseSequences:!0,parseComments:!1,bufferSize:1e3,disableDerivesFromReferences:!1,...n};return n.parseAll&&(e.parseFeatures=!0,e.parseDirectives=!0,e.parseComments=!0,e.parseSequences=!0),e}class zSe extends dX.Transform{constructor(e={}){super({objectMode:!0}),this.textBuffer="";const t=CX(e);this.encoding=e.encoding||"utf8",this.decoder=new CSe;const i=this.push.bind(this);this.parser=new yX({featureCallback:t.parseFeatures?i:void 0,directiveCallback:t.parseDirectives?i:void 0,commentCallback:t.parseComments?i:void 0,sequenceCallback:t.parseSequences?i:void 0,errorCallback:r=>this.emit("error",r),bufferSize:t.bufferSize,disableDerivesFromReferences:t.disableDerivesFromReferences})}_addLine(e){e&&this.parser.addLine(e)}_nextText(e){const t=(this.textBuffer+e).split(/\r?\n/);this.textBuffer=t.pop()||"",t.forEach(i=>this._addLine(i))}_transform(e,t,i){this._nextText(this.decoder.write(e)),SR(i)}_flush(e){this.decoder.end&&this._nextText(this.decoder.end()),this.textBuffer!=null&&this._addLine(this.textBuffer),this.parser.finish(),SR(e)}}function HSe(n={}){return new zSe(n)}function USe(n,e={}){if(!n)return[];const t=CX(e),i=[],r=i.push.bind(i),s=new yX({featureCallback:t.parseFeatures?r:void 0,directiveCallback:t.parseDirectives?r:void 0,commentCallback:t.parseComments?r:void 0,sequenceCallback:t.parseSequences?r:void 0,disableDerivesFromReferences:t.disableDerivesFromReferences||!1,bufferSize:1/0,errorCallback:o=>{throw o}});return n.split(/\r?\n/).forEach(s.addLine.bind(s)),s.finish(),i}function jSe(n){const e=[],t=[];n.forEach(r=>{"sequence"in r?t.push(r):e.push(r)});let i=e.map(rE).join("");return t.length&&(i+=`##FASTA
`,i+=t.map(m3).join("")),i}class SX extends dX.Transform{constructor(e={}){super(Object.assign(e,{objectMode:!0})),this.linesSinceLastSyncMark=0,this.haveWeEmittedData=!1,this.fastaMode=!1,this.minLinesBetweenSyncMarks=e.minSyncLines||100,this.insertVersionDirective=e.insertVersionDirective||!1}_transform(e,t,i){let r;if(!this.haveWeEmittedData&&this.insertVersionDirective){const s=Array.isArray(e)?e[0]:e;"directive"in s&&s.directive!=="gff-version"&&this.push(`##gff-version 3
`)}if("sequence"in e&&!this.fastaMode&&(this.push(`##FASTA
`),this.fastaMode=!0),Array.isArray(e)?r=e.map(rE).join(""):r=rE(e),this.push(r),this.linesSinceLastSyncMark>=this.minLinesBetweenSyncMarks)this.push(`###
`),this.linesSinceLastSyncMark=0;else{let s=0;for(let o=0;o<r.length;o+=1)r[o]===`
`&&(s+=1);this.linesSinceLastSyncMark+=s}this.haveWeEmittedData=!0,SR(i)}}function qSe(n={}){return new SX(n)}function GSe(n,e,t={}){const i={insertVersionDirective:!0,...t};return new Promise((r,s)=>{n.pipe(new SX(i)).on("end",()=>r(null)).on("error",s).pipe(e)})}const KSe={parseStream:HSe,parseStringSync:USe,formatSync:jSe,formatStream:qSe,formatFile:GSe,util:$Se};function xX(n){if(n.greaterThan(Number.MAX_SAFE_INTEGER)||n.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return n.toNumber()}class ZSe extends Error{}function Rd(n){if(n&&n.aborted){if(typeof DOMException<"u")throw new DOMException("aborted","AbortError");{const e=new ZSe("aborted");throw e.code="ERR_ABORTED",e}}}function YSe(n,e){return e.minv.blockPosition-n.maxv.blockPosition<65e3&&e.maxv.blockPosition-n.minv.blockPosition<5e6}function EX(n,e){const t=[];let i=null;return n.length===0?n:(n.sort(function(r,s){const o=r.minv.blockPosition-s.minv.blockPosition;return o!==0?o:r.minv.dataPosition-s.minv.dataPosition}),n.forEach(r=>{(!e||r.maxv.compareTo(e)>0)&&(i===null?(t.push(r),i=r):YSe(i,r)?r.maxv.compareTo(i.maxv)>0&&(i.maxv=r.maxv):(t.push(r),i=r))}),t)}var XSe=Bi,Go=null;try{Go=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Bi(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Bi.prototype.__isLong__;Object.defineProperty(Bi.prototype,"__isLong__",{value:!0});function $s(n){return(n&&n.__isLong__)===!0}Bi.isLong=$s;var xV={},EV={};function Og(n,e){var t,i,r;return e?(n>>>=0,(r=0<=n&&n<256)&&(i=EV[n],i)?i:(t=Vi(n,(n|0)<0?-1:0,!0),r&&(EV[n]=t),t)):(n|=0,(r=-128<=n&&n<128)&&(i=xV[n],i)?i:(t=Vi(n,n<0?-1:0,!1),r&&(xV[n]=t),t))}Bi.fromInt=Og;function Ko(n,e){if(isNaN(n))return e?af:Zo;if(e){if(n<0)return af;if(n>=DX)return IX}else{if(n<=-kV)return Ts;if(n+1>=kV)return LX}return n<0?Ko(-n,e).neg():Vi(n%m_|0,n/m_|0,e)}Bi.fromNumber=Ko;function Vi(n,e,t){return new Bi(n,e,t)}Bi.fromBits=Vi;var sE=Math.pow;function _3(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return Zo;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=n.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return _3(n.substring(1),e,t).neg();for(var r=Ko(sE(t,8)),s=Zo,o=0;o<n.length;o+=8){var a=Math.min(8,n.length-o),l=parseInt(n.substring(o,o+a),t);if(a<8){var c=Ko(sE(t,a));s=s.mul(c).add(Ko(l))}else s=s.mul(r),s=s.add(Ko(l))}return s.unsigned=e,s}Bi.fromString=_3;function nl(n,e){return typeof n=="number"?Ko(n,e):typeof n=="string"?_3(n,e):Vi(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Bi.fromValue=nl;var DV=1<<16,QSe=1<<24,m_=DV*DV,DX=m_*m_,kV=DX/2,LV=Og(QSe),Zo=Og(0);Bi.ZERO=Zo;var af=Og(0,!0);Bi.UZERO=af;var Kp=Og(1);Bi.ONE=Kp;var kX=Og(1,!0);Bi.UONE=kX;var xR=Og(-1);Bi.NEG_ONE=xR;var LX=Vi(-1,2147483647,!1);Bi.MAX_VALUE=LX;var IX=Vi(-1,-1,!0);Bi.MAX_UNSIGNED_VALUE=IX;var Ts=Vi(0,-2147483648,!1);Bi.MIN_VALUE=Ts;var Ne=Bi.prototype;Ne.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ne.toNumber=function(){return this.unsigned?(this.high>>>0)*m_+(this.low>>>0):this.high*m_+(this.low>>>0)};Ne.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ts)){var t=Ko(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Ko(sE(e,6),this.unsigned),o=this,a="";;){var l=o.div(s),c=o.sub(l.mul(s)).toInt()>>>0,h=c.toString(e);if(o=l,o.isZero())return h+a;for(;h.length<6;)h="0"+h;a=""+h+a}};Ne.getHighBits=function(){return this.high};Ne.getHighBitsUnsigned=function(){return this.high>>>0};Ne.getLowBits=function(){return this.low};Ne.getLowBitsUnsigned=function(){return this.low>>>0};Ne.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ts)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};Ne.isZero=function(){return this.high===0&&this.low===0};Ne.eqz=Ne.isZero;Ne.isNegative=function(){return!this.unsigned&&this.high<0};Ne.isPositive=function(){return this.unsigned||this.high>=0};Ne.isOdd=function(){return(this.low&1)===1};Ne.isEven=function(){return(this.low&1)===0};Ne.equals=function(e){return $s(e)||(e=nl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ne.eq=Ne.equals;Ne.notEquals=function(e){return!this.eq(e)};Ne.neq=Ne.notEquals;Ne.ne=Ne.notEquals;Ne.lessThan=function(e){return this.comp(e)<0};Ne.lt=Ne.lessThan;Ne.lessThanOrEqual=function(e){return this.comp(e)<=0};Ne.lte=Ne.lessThanOrEqual;Ne.le=Ne.lessThanOrEqual;Ne.greaterThan=function(e){return this.comp(e)>0};Ne.gt=Ne.greaterThan;Ne.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ne.gte=Ne.greaterThanOrEqual;Ne.ge=Ne.greaterThanOrEqual;Ne.compare=function(e){if($s(e)||(e=nl(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ne.comp=Ne.compare;Ne.negate=function(){return!this.unsigned&&this.eq(Ts)?Ts:this.not().add(Kp)};Ne.neg=Ne.negate;Ne.add=function(e){$s(e)||(e=nl(e));var t=this.high>>>16,i=this.high&65535,r=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,h=0,u=0,d=0,f=0;return f+=s+c,d+=f>>>16,f&=65535,d+=r+l,u+=d>>>16,d&=65535,u+=i+a,h+=u>>>16,u&=65535,h+=t+o,h&=65535,Vi(d<<16|f,h<<16|u,this.unsigned)};Ne.subtract=function(e){return $s(e)||(e=nl(e)),this.add(e.neg())};Ne.sub=Ne.subtract;Ne.multiply=function(e){if(this.isZero())return Zo;if($s(e)||(e=nl(e)),Go){var t=Go.mul(this.low,this.high,e.low,e.high);return Vi(t,Go.get_high(),this.unsigned)}if(e.isZero())return Zo;if(this.eq(Ts))return e.isOdd()?Ts:Zo;if(e.eq(Ts))return this.isOdd()?Ts:Zo;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(LV)&&e.lt(LV))return Ko(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,h=e.low&65535,u=0,d=0,f=0,g=0;return g+=o*h,f+=g>>>16,g&=65535,f+=s*h,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*h,u+=d>>>16,d&=65535,d+=s*c,u+=d>>>16,d&=65535,d+=o*l,u+=d>>>16,d&=65535,u+=i*h+r*c+s*l+o*a,u&=65535,Vi(f<<16|g,u<<16|d,this.unsigned)};Ne.mul=Ne.multiply;Ne.divide=function(e){if($s(e)||(e=nl(e)),e.isZero())throw Error("division by zero");if(Go){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Go.div_u:Go.div_s)(this.low,this.high,e.low,e.high);return Vi(t,Go.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?af:Zo;var i,r,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return af;if(e.gt(this.shru(1)))return kX;s=af}else{if(this.eq(Ts)){if(e.eq(Kp)||e.eq(xR))return Ts;if(e.eq(Ts))return Kp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(Zo)?e.isNegative()?Kp:xR:(r=this.sub(e.mul(i)),s=i.add(r.div(e)),s)}else if(e.eq(Ts))return this.unsigned?af:Zo;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Zo}for(r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:sE(2,a-48),c=Ko(i),h=c.mul(e);h.isNegative()||h.gt(r);)i-=l,c=Ko(i,this.unsigned),h=c.mul(e);c.isZero()&&(c=Kp),s=s.add(c),r=r.sub(h)}return s};Ne.div=Ne.divide;Ne.modulo=function(e){if($s(e)||(e=nl(e)),Go){var t=(this.unsigned?Go.rem_u:Go.rem_s)(this.low,this.high,e.low,e.high);return Vi(t,Go.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ne.mod=Ne.modulo;Ne.rem=Ne.modulo;Ne.not=function(){return Vi(~this.low,~this.high,this.unsigned)};Ne.and=function(e){return $s(e)||(e=nl(e)),Vi(this.low&e.low,this.high&e.high,this.unsigned)};Ne.or=function(e){return $s(e)||(e=nl(e)),Vi(this.low|e.low,this.high|e.high,this.unsigned)};Ne.xor=function(e){return $s(e)||(e=nl(e)),Vi(this.low^e.low,this.high^e.high,this.unsigned)};Ne.shiftLeft=function(e){return $s(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Vi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Vi(0,this.low<<e-32,this.unsigned)};Ne.shl=Ne.shiftLeft;Ne.shiftRight=function(e){return $s(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Vi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Vi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ne.shr=Ne.shiftRight;Ne.shiftRightUnsigned=function(e){if($s(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return Vi(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Vi(t,0,this.unsigned):Vi(t>>>e-32,0,this.unsigned)};Ne.shru=Ne.shiftRightUnsigned;Ne.shr_u=Ne.shiftRightUnsigned;Ne.toSigned=function(){return this.unsigned?Vi(this.low,this.high,!1):this};Ne.toUnsigned=function(){return this.unsigned?this:Vi(this.low,this.high,!0)};Ne.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ne.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ne.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Bi.fromBytes=function(e,t,i){return i?Bi.fromBytesLE(e,t):Bi.fromBytesBE(e,t)};Bi.fromBytesLE=function(e,t){return new Bi(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Bi.fromBytesBE=function(e,t){return new Bi(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const TX=Tg(XSe);class b3{constructor(e,t){this.blockPosition=e,this.dataPosition=t}toString(){return`${this.blockPosition}:${this.dataPosition}`}compareTo(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}static min(...e){let t,i=0;for(;!t;i+=1)t=e[i];for(;i<e.length;i+=1)t.compareTo(e[i])>0&&(t=e[i]);return t}}function vm(n,e=0,t=!1){if(t)throw new Error("big-endian virtual file offsets not implemented");return new b3(n[e+7]*1099511627776+n[e+6]*4294967296+n[e+5]*16777216+n[e+4]*65536+n[e+3]*256+n[e+2],n[e+1]<<8|n[e])}class oE{constructor(e,t,i,r=void 0){this.minv=e,this.maxv=t,this.bin=i,this._fetchedSize=r}toUniqueString(){return`${this.minv}..${this.maxv} (bin ${this.bin}, fetchedSize ${this.fetchedSize()})`}toString(){return this.toUniqueString()}compareTo(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}fetchedSize(){return this._fetchedSize!==void 0?this._fetchedSize:this.maxv.blockPosition+(1<<16)-this.minv.blockPosition}}class AX{constructor({filehandle:e,renameRefSeqs:t=i=>i}){this.filehandle=e,this.renameRefSeq=t}async getMetadata(e={}){const{indices:t,...i}=await this.parse(e);return i}_findFirstData(e,t){return e?e.compareTo(t)>0?t:e:t}async parse(e={}){return this.parseP||(this.parseP=this._parse(e).catch(t=>{throw this.parseP=void 0,t})),this.parseP}async hasRefSeq(e,t={}){return!!((await this.parse(t)).indices[e]||{}).binIndex}}const JSe=21578324,IV=14;function exe(n,e){return n+=1,e-=1,[[0,0],[1+(n>>26),1+(e>>26)],[9+(n>>23),9+(e>>23)],[73+(n>>20),73+(e>>20)],[585+(n>>17),585+(e>>17)],[4681+(n>>14),4681+(e>>14)]]}class KI extends AX{async lineCount(e,t={}){const i=await this.parse(t);if(!i)return-1;const r=i.refNameToId[e];if(!i.indices[r])return-1;const{stats:o}=i.indices[r];return o?o.lineCount:-1}async _parse(e={}){const t=await this.filehandle.readFile(e),i=await a_(t);if(Rd(e.signal),i.readUInt32LE(0)!==JSe)throw new Error("Not a TBI file");const r=i.readInt32LE(4),s=i.readInt32LE(8),o=s&65536?"zero-based-half-open":"1-based-closed",l={0:"generic",1:"SAM",2:"VCF"}[s&15];if(!l)throw new Error(`invalid Tabix preset format flags ${s}`);const c={ref:i.readInt32LE(12),start:i.readInt32LE(16),end:i.readInt32LE(20)},h=i.readInt32LE(24),u=5,d=((1<<(u+1)*3)-1)/7,f=2**(14+u*3),g=h?String.fromCharCode(h):null,p=i.readInt32LE(28),m=i.readInt32LE(32),{refNameToId:b,refIdToName:_}=this._parseNameBytes(i.slice(36,36+m));let w=36+m,y;return{indices:new Array(r).fill(0).map(()=>{const k=i.readInt32LE(w);w+=4;const C={};let D;for(let T=0;T<k;T+=1){const j=i.readUInt32LE(w);if(w+=4,j>d+1)throw new Error("tabix index contains too many bins, please use a CSI index");if(j===d+1){const q=i.readInt32LE(w);w+=4,q===2&&(D=this.parsePseudoBin(i,w)),w+=16*q}else{const q=i.readInt32LE(w);w+=4;const ie=new Array(q);for(let ge=0;ge<q;ge+=1){const be=vm(i,w),Se=vm(i,w+8);w+=16,y=this._findFirstData(y,be),ie[ge]=new oE(be,Se,j)}C[j]=ie}}const E=i.readInt32LE(w);w+=4;const N=new Array(E);for(let T=0;T<E;T+=1)N[T]=vm(i,w),w+=8,y=this._findFirstData(y,N[T]);return{binIndex:C,linearIndex:N,stats:D}}),metaChar:g,maxBinNumber:d,maxRefLength:f,skipLines:p,firstDataLine:y,columnNumbers:c,coordinateType:o,format:l,refIdToName:_,refNameToId:b,maxBlockSize:1<<16}}parsePseudoBin(e,t){return{lineCount:xX(TX.fromBytesLE(e.slice(t+16,t+24),!0))}}_parseNameBytes(e){let t=0,i=0;const r=[],s={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),r[t]=a,s[a]=t}i=o+1,t+=1}return{refNameToId:s,refIdToName:r}}async blocksForRange(e,t,i,r={}){t<0&&(t=0);const s=await this.parse(r);if(!s)return[];const o=s.refNameToId[e],a=s.indices[o];if(!a)return[];(a.linearIndex.length?a.linearIndex[t>>IV>=a.linearIndex.length?a.linearIndex.length-1:t>>IV]:new b3(0,0))||console.warn("querying outside of possible tabix range");const c=exe(t,i),h=[];for(const[p,m]of c)for(let b=p;b<=m;b++)if(a.binIndex[b]){const _=a.binIndex[b];for(let w=0;w<_.length;++w)h.push(new oE(_[w].minv,_[w].maxv,b))}const u=a.linearIndex.length;let d=null;const f=Math.min(t>>14,u-1),g=Math.min(i>>14,u-1);for(let p=f;p<=g;++p){const m=a.linearIndex[p];m&&(!d||m.compareTo(d)<0)&&(d=m)}return EX(h,d)}}const txe=21582659,ixe=38359875;function nxe(n,e){return n*2**e}function TV(n,e){return Math.floor(n/2**e)}class AV extends AX{constructor(e){super(e),this.maxBinNumber=0,this.depth=0,this.minShift=0}async lineCount(e,t={}){const i=await this.parse(t);if(!i)return-1;const r=i.refNameToId[e];if(!i.indices[r])return-1;const{stats:o}=i.indices[r];return o?o.lineCount:-1}async indexCov(){throw new Error("CSI indexes do not support indexcov")}parseAuxData(e,t){const i=e.readInt32LE(t),r=i&65536?"zero-based-half-open":"1-based-closed",s={0:"generic",1:"SAM",2:"VCF"}[i&15];if(!s)throw new Error(`invalid Tabix preset format flags ${i}`);const o={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},a=e.readInt32LE(t+16),l=a?String.fromCharCode(a):null,c=e.readInt32LE(t+20),h=e.readInt32LE(t+24),{refIdToName:u,refNameToId:d}=this._parseNameBytes(e.slice(t+28,t+28+h));return{refIdToName:u,refNameToId:d,skipLines:c,metaChar:l,columnNumbers:o,format:s,coordinateType:r}}_parseNameBytes(e){let t=0,i=0;const r=[],s={};for(let o=0;o<e.length;o+=1)if(!e[o]){if(i<o){let a=e.toString("utf8",i,o);a=this.renameRefSeq(a),r[t]=a,s[a]=t}i=o+1,t+=1}return{refNameToId:s,refIdToName:r}}async _parse(e={}){const t=await a_(await this.filehandle.readFile(e));let i;if(t.readUInt32LE(0)===txe)i=1;else if(t.readUInt32LE(0)===ixe)i=2;else throw new Error("Not a CSI file");this.minShift=t.readInt32LE(4),this.depth=t.readInt32LE(8),this.maxBinNumber=((1<<(this.depth+1)*3)-1)/7;const r=2**(this.minShift+this.depth*3),s=t.readInt32LE(12),o=s&&s>=30?this.parseAuxData(t,16):{refIdToName:[],refNameToId:{},metaChar:null,columnNumbers:{ref:0,start:1,end:2},coordinateType:"zero-based-half-open",format:"generic"},a=t.readInt32LE(16+s);let l,c=16+s+4;const h=new Array(a).fill(0).map(()=>{const u=t.readInt32LE(c);c+=4;const d={};let f;for(let g=0;g<u;g+=1){const p=t.readUInt32LE(c);if(p>this.maxBinNumber)f=this.parsePseudoBin(t,c+4),c+=4+8+4+16+16;else{const m=vm(t,c+4);l=this._findFirstData(l,m);const b=t.readInt32LE(c+12);c+=16;const _=new Array(b);for(let w=0;w<b;w+=1){const y=vm(t,c),S=vm(t,c+8);c+=16,_[w]=new oE(y,S,p)}d[p]=_}}return{binIndex:d,stats:f}});return{...o,csi:!0,refCount:a,maxBlockSize:1<<16,firstDataLine:l,csiVersion:i,indices:h,depth:this.depth,maxBinNumber:this.maxBinNumber,maxRefLength:r}}parsePseudoBin(e,t){return{lineCount:xX(TX.fromBytesLE(e.slice(t+28,t+36),!0))}}async blocksForRange(e,t,i,r={}){t<0&&(t=0);const s=await this.parse(r);if(!s)return[];const o=s.refNameToId[e],a=s.indices[o];if(!a)return[];const l=this.reg2bins(t,i),c=[];for(const[h,u]of l)for(let d=h;d<=u;d++)if(a.binIndex[d]){const f=a.binIndex[d];for(let g=0;g<f.length;++g)c.push(new oE(f[g].minv,f[g].maxv,d))}return EX(c,new b3(0,0))}reg2bins(e,t){e-=1,e<1&&(e=1),t>2**50&&(t=2**34),t-=1;let i=0,r=0,s=this.minShift+this.depth*3;const o=[];for(;i<=this.depth;s-=3,r+=nxe(1,i*3),i+=1){const a=r+TV(e,s),l=r+TV(t,s);if(l-a+o.length>this.maxBinNumber)throw new Error(`query ${e}-${t} is too large for current binning scheme (shift ${this.minShift}, depth ${this.depth}), try a smaller query or a coarser index binning scheme`);o.push([a,l])}return o}}const ZI=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function rxe(n){return new Promise(e=>setTimeout(e,n))}class sxe{constructor({path:e,filehandle:t,tbiPath:i,tbiFilehandle:r,csiPath:s,csiFilehandle:o,yieldTime:a=500,chunkSizeLimit:l=5e7,renameRefSeqs:c=u=>u,chunkCacheSize:h=5*2**20}){if(t)this.filehandle=t;else if(e)this.filehandle=new no(e);else throw new TypeError("must provide either filehandle or path");if(r)this.index=new KI({filehandle:r,renameRefSeqs:c});else if(o)this.index=new AV({filehandle:o,renameRefSeqs:c});else if(i)this.index=new KI({filehandle:new no(i),renameRefSeqs:c});else if(s)this.index=new AV({filehandle:new no(s),renameRefSeqs:c});else if(e)this.index=new KI({filehandle:new no(`${e}.tbi`),renameRefSeqs:c});else throw new TypeError("must provide one of tbiFilehandle, tbiPath, csiFilehandle, or csiPath");this.chunkSizeLimit=l,this.renameRefSeq=c,this.yieldTime=a,this.chunkCache=new Vk({cache:new Y4({maxSize:Math.floor(h/(1<<16))}),fill:(u,d)=>this.readChunk(u,{signal:d})})}async getLines(e,t,i,r){let s,o={},a;if(typeof r>"u")throw new TypeError("line callback must be provided");if(typeof r=="function"?a=r:(o=r,a=r.lineCallback),e===void 0)throw new TypeError("must provide a reference sequence name");if(!a)throw new TypeError("line callback must be provided");const l=await this.index.getMetadata(o);if(Rd(s),t||(t=0),i||(i=l.maxRefLength),!(t<=i))throw new TypeError("invalid start and end coordinates. start must be less than or equal to end");if(t===i)return;const c=await this.index.blocksForRange(e,t,i,o);Rd(s);for(let u=0;u<c.length;u+=1){const d=c[u].fetchedSize();if(d>this.chunkSizeLimit)throw new Error(`Too much data. Chunk size ${d.toLocaleString()} bytes exceeds chunkSizeLimit of ${this.chunkSizeLimit.toLocaleString()}.`)}let h=Date.now();for(let u=0;u<c.length;u+=1){let d;const f=c[u],{buffer:g,cpositions:p,dpositions:m}=await this.chunkCache.get(f.toString(),f);Rd(s);let b=0,_=0;for(;b<g.length;){const w=g.indexOf(`
`,b);if(w===-1)break;const y=g.slice(b,w),S=(ZI==null?void 0:ZI.decode(y))||y.toString();if(m){for(;b+f.minv.dataPosition>=m[_++];);_--}const{startCoordinate:k,overlaps:C}=this.checkLine(l,e,t,i,S);if(d!==void 0&&k!==void 0&&d>k)throw new Error(`Lines not sorted by start coordinate (${d} > ${k}), this file is not usable with Tabix.`);if(d=k,C)a(S.trim(),p[_]*(1<<8)+(b-m[_])+f.minv.dataPosition+1);else if(k!==void 0&&k>=i)return;this.yieldTime&&h-Date.now()>this.yieldTime&&(h=Date.now(),Rd(s),await rxe(1)),b=w+1}}}async getMetadata(e={}){return this.index.getMetadata(e)}async getHeaderBuffer(e={}){const{firstDataLine:t,metaChar:i,maxBlockSize:r}=await this.getMetadata(e);Rd(e.signal);const s=((t==null?void 0:t.blockPosition)||0)+r;let o=await this._readRegion(0,s,e);Rd(e.signal);try{o=await a_(o)}catch(a){throw console.error(a),new Error(`error decompressing block ${a.code} at 0 (length ${s}) ${a}`)}if(i){let a=-1;const l=`
`.charCodeAt(0),c=i.charCodeAt(0);for(let h=0;h<o.length&&!(h===a+1&&o[h]!==c);h+=1)o[h]===l&&(a=h);o=o.slice(0,a+1)}return o}async getHeader(e={}){return(await this.getHeaderBuffer(e)).toString("utf8")}async getReferenceSequenceNames(e={}){return(await this.getMetadata(e)).refIdToName}checkLine(e,t,i,r,s){const{columnNumbers:o,metaChar:a,coordinateType:l,format:c}=e;if(s.charAt(0)===a)return{overlaps:!1};let{ref:h,start:u,end:d}=o;h||(h=0),u||(u=0),d||(d=0),c==="VCF"&&(d=8);const f=Math.max(h,u,d);let g=1,p=0,m="",b=-1/0;for(let _=0;_<s.length+1;_+=1)if(s[_]==="	"||_===s.length){if(g===h){if(this.renameRefSeq(s.slice(p,_))!==t)return{overlaps:!1}}else if(g===u){if(b=parseInt(s.slice(p,_),10),l==="1-based-closed"&&(b-=1),b>=r)return{startCoordinate:b,overlaps:!1};if((d===0||d===u)&&b+1<=i)return{startCoordinate:b,overlaps:!1}}else if(c==="VCF"&&g===4)m=s.slice(p,_);else if(g===d){let w;if(c==="VCF"?w=this._getVcfEnd(b,m,s.slice(p,_)):w=parseInt(s.slice(p,_),10),w<=i)return{overlaps:!1}}if(p=_+1,g+=1,g>f)break}return{startCoordinate:b,overlaps:!0}}_getVcfEnd(e,t,i){let r=e+t.length;const s=i.indexOf("SVTYPE=TRA")!==-1;if(i[0]!=="."&&!s){let o=";";for(let a=0;a<i.length;a+=1){if(o===";"&&i.slice(a,a+4)==="END="){let l=i.indexOf(";",a);l===-1&&(l=i.length),r=parseInt(i.slice(a+4,l),10);break}o=i[a]}}else if(s)return e+1;return r}async lineCount(e,t={}){return this.index.lineCount(e,t)}async _readRegion(e,t,i={}){const r=Buffer.alloc(t),{bytesRead:s,buffer:o}=await this.filehandle.read(r,0,t,e,i);return o.slice(0,s)}async readChunk(e,t={}){const i=await this._readRegion(e.minv.blockPosition,e.fetchedSize(),t);try{return CZ(i,e)}catch(r){throw new Error(`error decompressing c ${e.toString()} ${r}`)}}}class oxe extends ey(Ig){constructor(t,i){const r={channel:"x",windowSize:3e6,debounceDomainChange:200,...t};super(i,r.channel);dr(this,"lastRequestId",0);dr(this,"tbiIndex");if(this.params=r,!this.params.url)throw new Error("No URL provided for TabixSource");const s=o=>new Vl(ty(o,this.view.getBaseUrl()));this.tbiIndex=new sxe({filehandle:s(this.params.url),tbiFilehandle:s(this.params.indexUrl??this.params.url+".tbi")}),this.params.debounceDomainChange>0&&(this.onDomainChanged=ay(this.onDomainChanged.bind(this),this.params.debounceDomainChange,!1))}async onDomainChanged(t){const i=this.params.windowSize;if(t[1]-t[0]>i)return;const r=this.quantizeInterval(t,i);this.checkAndUpdateLastInterval(r)&&this.doRequest(r)}async doRequest(t){const i=await this.getFeatures(t);i.requestId<this.lastRequestId||this.publishData(i.features)}async getFeatures(t){let i=++this.lastRequestId;const r=new AbortController,s=this.genome.continuousToDiscreteChromosomeIntervals(t),o=await Promise.all(s.map(async a=>{const l=[];return await this.tbiIndex.getLines(a.chrom,a.startPos,a.endPos,{lineCallback:c=>{l.push(c)},signal:r.signal}),this._parseFeatures(l)}));return{requestId:i,abort:()=>r.abort(),features:o.flat()}}_parseFeatures(t){return[]}}class axe extends oxe{_parseFeatures(e){return KSe.parseStringSync(e.join(`
`),{parseSequences:!1})}}function lxe(n,e){if(RK(n))return new d0e(n,e);if(f0e(n))return new g0e(n,e);if(p0e(n))return new m0e(n,e);if(cxe(n))return _xe(n.lazy,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function cxe(n){return"lazy"in n}function hxe(n){return(n==null?void 0:n.type)=="axisTicks"}function uxe(n){return(n==null?void 0:n.type)=="axisGenome"}function dxe(n){return(n==null?void 0:n.type)=="indexedFasta"}function fxe(n){return(n==null?void 0:n.type)=="bigwig"}function gxe(n){return(n==null?void 0:n.type)=="bigbed"}function pxe(n){return(n==null?void 0:n.type)=="bam"}function mxe(n){return(n==null?void 0:n.type)=="gff3"}function _xe(n,e){if(hxe(n))return new b0e(n,e);if(uxe(n))return new v0e(n,e);if(dxe(n))return new xve(n,e);if(fxe(n))return new vCe(n,e);if(gxe(n))return new BCe(n,e);if(pxe(n))return new hSe(n,e);if(mxe(n))return new axe(n,e);throw new Error("Cannot figure out the data source type: "+JSON.stringify(n))}function bxe(n){const e=Object.keys(n).filter(i=>typeof i=="string"),t=new Function("source","return { "+e.map(i=>JSON.stringify(i)).map(i=>`${i}: source[${i}]`).join(`,
`)+" };");return t.properties=e,t}class aE extends Tn{get behavior(){return fc}constructor(){super();const e=t=>{const i=bxe(t);this.handle=r=>this._propagate(i(r)),this.handle(t)};this.handle=e,this.beginBatch=t=>{sK(t)&&(this.handle=e),super.beginBatch(t)}}}function vxe(n){return"name"in n}var C1;class NX extends Z1{constructor(t,i,r){super();Vt(this,C1,void 0);this.provider=r,this.params=t}get identifier(){return this.params.name}updateDynamicData(t){Co(this,C1,t),this.loadSynchronously()}loadSynchronously(){const t=Ze(this,C1)??this.provider(this.params.name)??[];let i=r=>r;if(Array.isArray(t))t.length>0&&(i=NK(t[0]));else throw new Error(`Named data "${this.params.name}" is not an array!`);this.reset(),this.beginBatch({type:"file"});for(const r of t)this._propagate(i(r));this.complete()}async load(){this.loadSynchronously()}}C1=new WeakMap;class RX{constructor(){this._dataSourcesByHost=new Map,this._collectorsByHost=new Map,this._observers=new Map}get dataSources(){return[...new Set(this._dataSourcesByHost.values()).values()]}get collectors(){return[...this._collectorsByHost.values()]}addObserver(e,t){let i=this._observers.get(t);i||(i=[],this._observers.set(t,i)),i.push(e)}_relayObserverCallback(e,t){const i=this._observers.get(t);if(i)for(const r of i)r(e)}addDataSource(e,t){this._dataSourcesByHost.set(t,e)}findDataSourceByKey(e){return this._dataSourcesByHost.get(e)}findNamedDataSource(e){let t,i=[];for(const[r,s]of this._dataSourcesByHost.entries())if(s instanceof NX&&e==s.identifier){if(t&&t!==s)throw new Error(`Found multiple instances of named data: ${e}. Data flow optimization is broken (it's a bug).`);t=s,i.push(r)}if(t)return{dataSource:t,hosts:i}}addCollector(e,t){this._collectorsByHost.set(t,e),e.observers.push(i=>this._relayObserverCallback(i,t))}findCollectorByKey(e){return this._collectorsByHost.get(e)}initialize(){for(const e of this.dataSources)e.visit(t=>t.initialize())}}function wxe(n,e){const t=new Map,i=[];for(const r of n)t.set(r,{ref:r,children:[]});for(const r of t.values()){const s=t.get(e(r.ref));s?s.children.push(r):i.push(r)}return i}function MX(n,e,t){var r,s;const i=(r=e.preOrder)==null?void 0:r.call(e,n);if(i)return i;for(const o of t(n)){const a=MX(o,e,t);if(a==="stop")return a}return(s=e.postOrder)==null?void 0:s.call(e,n)}function yxe(n,e){return MX(n,e,t=>t.children)}function Cxe(n,e){const t=[];let i;const r=e??new RX,s=[];function o(u,d=()=>{}){if(!i)throw d()||new Error("Cannot append data flow node, no parent exist!");return i.addChild(u),i=u,u}function a(u,d){return o(u,()=>new Error(`Cannot append a transform because no (inherited) data are available! ${d?JSON.stringify(d):""}`))}function l(u,d){for(const f of u){let g;try{g=l0e(f,d)}catch(p){throw console.warn(p),new Error(`Cannot initialize "${f.type}" transform: ${p}`)}g.behavior&fd&&a(new aE),a(g)}}const c=u=>{if(t.push(i),u.spec.data){const d=vxe(u.spec.data)?new NX(u.spec.data,u,u.context.getNamedDataFromProvider):lxe(u.spec.data,u);i=d,r.addDataSource(d,u)}if(u.spec.transform&&l(u.spec.transform,u),u instanceof os){if(!i)throw new Error(`A unit view (${u.getPathString()}) has no (inherited) data source`);const d=Sxe(u);if(d){s.push(d.rewrite);for(const g of d.transforms)a(g)}u.mark.isPickingParticipant()&&(a(new aE),a(new TK({type:"identifier"})));const f=new kK({type:"collect",groupby:u.getFacetFields(),sort:xxe(u,d==null?void 0:d.rewrittenEncoding)});o(f),r.addCollector(f,u)}},h=wxe(n.getDescendants(),u=>u.dataParent);for(const u of h)yxe(u,{preOrder:d=>c(d.ref),postOrder:()=>{i=t.pop()}});return s.forEach(u=>u()),r}function Sxe(n){var s;const e=[],t={},i=[];for(const[o,a]of Object.entries(n.getEncoding())){const l=o;qv(l)&&jq(a)&&i.push({channel:l,chromPosDef:a})}const r=nk(i,o=>qf(o.channel),o=>o.chromPosDef.chrom);for(const[o,a]of r.entries())for(const[l,c]of a.entries()){const h=[],u=[],d=[];for(const{channel:f,chromPosDef:g}of c){const p=_=>_.replace(/[^A-Za-z0-9_]/g,""),m=["_linearized_",p(g.chrom),"_",p(g.pos)].join(""),b={...((s=n.spec.encoding)==null?void 0:s[f])??n.getEncoding()[f]??{},field:m};delete b.chrom,delete b.pos,!b.type&&g.type&&(b.type=g.type),t[f]=b,h.push(g.pos),d.push(g.offset??0),u.push(m)}e.push(new aE),e.push(new LK({type:"linearizeGenomicCoordinate",channel:o,chrom:l,pos:h,offset:d,as:u},n))}return e.length?{transforms:e,rewrittenEncoding:t,rewrite:()=>{n.spec.encoding={...n.spec.encoding,...t},JG(n.mark,"encoding")}}:void 0}function xxe(n,e){var i;const t={...n.getEncoding(),...e}.x;if($o(t)&&(i=n.getScaleResolution("x"))!=null&&i.isZoomable()){if(z1(t))return{field:t.field};if(!H1(t))throw new Error("A zoomable x channel must be mapped to a field.")}}function FX(n,e=void 0){if(n.parent!==e)return!1;for(const t of n.children)if(!FX(t,n))return!1;return!0}function ER(n,e=!1){if(n.behavior&N4&&(e=!0),n instanceof aE)if(e)e=!1;else{const t=n.children[0];n.excise(),t&&ER(t,e);return}n.behavior&fc&&(e=!1);for(let t=0,i=n.children.length;t<i;t++)ER(n.children[t],e||i>1)}function Exe(n){const e=[...n._dataSourcesByHost.entries()],t=new Map;for(const i of e){const r=i[1];r.identifier&&!t.has(r.identifier)&&t.set(r.identifier,r)}n._dataSourcesByHost.clear();for(let[i,r]of e){const s=t.get(r.identifier);s&&(s.adoptChildrenOf(r),r=s),n.addDataSource(r,i)}}function Dxe(n){if(ER(n),!FX(n))throw new Error("Encountered a bug! There's a problem in the data flow structure.")}function kxe(n){for(const e of n.dataSources)Dxe(e);Exe(n)}function Lxe(n){n.visit(t=>{t instanceof os&&t.resolve("scale")});const e=new Set;n.visit(t=>{for(const i of Object.values(t.resolutions.scale)){const r=i.name;if(r&&e.has(r))throw new Error(`The same scale name "${r}" occurs in multiple scale resolutions!`);e.add(r)}}),n.visit(t=>{t instanceof os&&t.resolve("axis")}),n.visit(t=>t.onScalesResolved())}function Ixe(n){for(const e of J_){const t=n.getScaleResolution(e);t&&!t.name&&t.isZoomable()&&(t.name=`${e}_at_root`)}}async function Txe(n,e,t){var o;if(!n.import.url)throw new Error("Cannot import, not an import spec: "+JSON.stringify(n));const i=ok({baseURL:e}),r=n.import.url,s=JSON.parse(await i.load(r).catch(a=>{throw new Error(`Could not load imported view spec: ${r} 
Reason: ${a.message}`)}));if(t.isViewSpec(s))return s.baseUrl=(o=r.match(/^[^?#]*\//))==null?void 0:o[0],s;throw new Error(`The imported spec "${r}" is not a view spec: ${JSON.stringify(n)}`)}async function OX(n){const e=[];n.visit(t=>{if(t instanceof DK)return e.push(t),lK});for(const t of e){const i=t.context,r=await Txe(t.spec,t.getBaseUrl(),i),s=i.createView(r,t.layoutParent,t.dataParent,t.name);t.layoutParent.replaceChild(t,s),await OX(s)}}function Axe(n){const e=n.getSize().addPadding(n.getOverhang()),t=i=>i.grow>0?void 0:i.px;return{width:t(e.width),height:t(e.height)}}function Dc(n){return()=>n}const Wc=class{static create(e,t,i,r){return new Wc(Dc(e),Dc(t),Dc(i),Dc(r))}_offset(e,t){const i=this["_"+e];if(t===0)return i;switch(typeof t){case"number":return()=>i()+t;case"function":return()=>i()+t();default:throw new Error("Not a number of function")}}_passThrough(e){return this._offset(e,0)}constructor(e,t,i,r){this._x=e,this._y=t,this._width=i,this._height=r}get x(){return this._x()}get y(){return this._y()}get width(){return this._width()}get height(){return this._height()}get x2(){return this._x()+this._width()}get y2(){return this._y()+this._height()}equals(e){return e?this===e||this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height:!1}modify(e){if(!Object.keys(e).length)return this;const t=i=>{const r=e[i];return typeof r=="number"?Dc(r):typeof r=="function"?r:this._passThrough(i)};return new Wc(t("x"),t("y"),t("width"),t("height"))}translate(e,t){return e===0&&t===0?this:new Wc(this._offset("x",e),this._offset("y",t),this._passThrough("width"),this._passThrough("height"))}translateBy(e){return this.translate(e.x,e.y)}expand(e,t=1){return e.left==0&&e.top==0&&e.right==0&&e.bottom==0?this:new Wc(e.left?this._offset("x",-e.left*t):this._passThrough("x"),e.top?this._offset("y",-e.top*t):this._passThrough("y"),e.width?this._offset("width",e.width*t):this._passThrough("width"),e.height?this._offset("height",e.height*t):this._passThrough("height"))}shrink(e){return this.expand(e,-1)}intersect(e){return this===e?this:new Wc(()=>Math.max(this.x,e.x),()=>Math.max(this.y,e.y),()=>Math.min(this.x2,e.x2)-Math.max(this.x,e.x),()=>Math.min(this.y2,e.y2)-Math.max(this.y,e.y))}isDefined(){return this.width>=0&&this.height>=0}flatten(){return new Wc(Dc(this.x),Dc(this.y),Dc(this.width),Dc(this.height))}containsPoint(e,t){return e>=this.x&&e<this.x2&&t>=this.y&&t<this.y2}normalizePoint(e,t){return{x:(e-this.x)/this.width,y:(t-this.y)/this.height}}toString(){return`Rectangle: x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height}`}toRoundedString(){return`Rectangle: x: ${Math.round(this.x)}, y: ${Math.round(this.y)}, width: ${Math.round(this.width)}, height: ${Math.round(this.height)}`}};let wm=Wc;dr(wm,"ZERO",Wc.create(0,0,0,0));class PX{constructor(e){this.globalOptions=e}pushView(e,t){}popView(e){}renderMark(e,t){}}class NV extends PX{constructor(e,t){super(e),this.webGLHelper=t,this.buffer=[],this.coords=void 0,this.views=new Set}pushView(e,t){this.views.add(e),this.coords=t}renderMark(e,t){if(this.globalOptions.picking&&!e.isPickingParticipant())return;const i=e.render(t);i&&this.buffer.push({mark:e,callback:i,coords:this.coords,clipRect:t.clipRect})}render(){if(this.batch||this._buildBatch(),this.batch.length==0)return;const e=this.webGLHelper.gl,t=this.globalOptions.picking;e.bindFramebuffer(e.FRAMEBUFFER,t?this.webGLHelper._pickingBufferInfo.framebuffer:null),this.webGLHelper.clearAll();for(const i of this.views)i.onBeforeRender();for(const i of this.batch)i();t&&e.bindFramebuffer(e.FRAMEBUFFER,null)}_buildBatch(){this.batch=[];let e=!0,t=!0;const i=o=>()=>{e&&o()},r=o=>()=>{e&&t&&o()},s=nk(this.buffer.reverse(),o=>o.mark);for(const[o,a]of[...s.entries()].reverse()){if(!o.isReady())continue;this.batch.push(()=>{e=o.unitView.getEffectiveOpacity()>0}),this.batch.push(...o.prepareRender(this.globalOptions).map(c=>i(c)));let l;for(const c of a){const h=c.coords;h.equals(l)||this.batch.push(i(()=>{t=o.setViewport(h,c.clipRect)})),this.batch.push(r(c.callback)),l=c.coords}}}}class Nxe extends PX{constructor(...e){super({}),this.contexts=e}pushView(e,t){for(const i of this.contexts)i.pushView(e,t)}popView(e){for(const t of this.contexts)t.popView(e)}renderMark(e,t){for(const i of this.contexts)i.renderMark(e,t)}}class Rxe{constructor(e,t){this.point=e,this.uiEvent=t,this.stopped=!1,this.target=void 0}stopPropagation(){this.stopped=!0}get type(){return this.uiEvent.type}}class Mxe{constructor(e,t){this.x=e,this.y=t}equals(e){return e?e===this||e.x===this.x&&e.y===this.y:!1}}const Fxe=n=>new Promise(e=>setTimeout(e,n));function Oxe(n){const e=n.requestAnimationFrame||window.requestAnimationFrame,t=n.signal,i=()=>new Promise((r,s)=>{if(t!=null&&t.aborted)return s("aborted");const o=performance.now(),a=o+(n.duration||1e3),l=typeof n.from=="number"?n.from:0,c=typeof n.to=="number"?n.to:1,h=n.easingFunction||(p=>p),u=p=>(p-o)/(a-o),d=p=>p*(c-l)+l,f=p=>Math.max(0,Math.min(1,p)),g=p=>{t!=null&&t.aborted?s("aborted"):(n.onUpdate(d(h(f(u(p))))),p<a?e(g):(n.onUpdate(d(h(1))),r()))};e(g)});return n.delay?t!=null&&t.aborted?Promise.reject("aborted"):Fxe(n.delay).then(i):i()}class Pxe{constructor(e){this._renderCallback=e,this._renderRequested=!1,this._warn=!1,this.transitions=[]}requestTransition(e){this.cancelTransition(e),this.transitions.push(e),this.requestRender()}cancelTransition(e){const t=this.transitions.indexOf(e);t>=0&&this.transitions.splice(t,1)}requestRender(){this._renderRequested?this._warn&&console.warn("Render already requested!"):(this._renderRequested=!0,window.requestAnimationFrame(e=>{this._renderRequested=!1;const t=this.transitions;this.transitions=[];let i;for(;i=t.shift();)i(e);this._renderCallback(e)}))}transition(e){return Oxe({requestAnimationFrame:t=>this.requestTransition(t),...e})}}class Bxe{constructor(e){this.genomes=new Map,this.baseUrl=e}async initialize(e){const t=new v_e(e);return this.genomes.set(t.name,t),Promise.all([...this.genomes.values()].map(i=>i.load(this.baseUrl)))}getGenome(e){if(!this.genomes.size)throw new Error("No genomes have been configured!");if(e){const t=this.genomes.get(e);if(!t)throw new Error(`No genome with the name ${e} has been configured!`);return t}else{if(this.genomes.size>1)throw new Error("Cannot pick a default genome! More than one have been configured!");return this.genomes.values().next().value}}}const Vxe=""+new URL("Lato-Regular-e459d1f9.png",import.meta.url).href,Wxe={thin:100,light:300,regular:400,normal:400,medium:500,bold:700,black:900};class $xe{constructor(e){this._webGLHelper=e,this.fontRepository="https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/",this._fonts=new Wf([],JSON.stringify),this._metadataPromises=new Map,this._fontPromises=new Map,this._promises=[],this._defaultFontEntry={metrics:$N(IK),texture:e?this._createTextureNow(Vxe):void 0}}async waitUntilReady(){await Promise.all(this._promises)}getFont(e,t="normal",i="regular"){if(un(i)&&(i=Wxe[i.toLowerCase()],!i))throw new Error("Unknown font weight: "+i);const r={family:e,style:t,weight:i};let s=this._fonts.get(r);return s||(s={metrics:void 0,texture:void 0},this._fonts.set(r,s),this._promises.push(this._loadFontEntry(s,r))),s}async _loadFontEntry(e,t){try{const i=await this._loadMetadata(t.family),r=Hxe(i,t),s=this.fontRepository+RV(t.family)+"/"+r.replace(/\.\w+/,""),o=this._createTexture(s+".png"),a=this._loadFont(s+".json");e.texture=await o,e.metrics=await a}catch(i){console.log("Cannot load font. Using default.",i),e.metrics=this._defaultFontEntry.metrics,e.texture=this._defaultFontEntry.texture}}_loadFont(e){let t=this._fontPromises.get(e);return t||(t=fetch(e).then(i=>{if(!i.ok)throw new Error("Could not load font: "+i.status);return i}).then(i=>i.json()).then(i=>$N(i)),this._fontPromises.set(e,t)),t}_loadMetadata(e){const t=RV(e);let i=this._metadataPromises.get(t);return i||(i=fetch(this.fontRepository+t+"/METADATA.pb").then(r=>{if(!r.ok)throw new Error("Could not load font metadata: "+r.status);return r}).then(r=>r.text()).then(r=>zxe(r)).catch(r=>{console.warn(r)}),this._metadataPromises.set(t,i)),i}getDefaultFont(){return this._defaultFontEntry}_createTexture(e){const t=this._webGLHelper.gl;return new Promise((i,r)=>{Zv(t,{src:e,min:t.LINEAR},(s,o,a)=>{s?r(s):i(o)})})}_createTextureNow(e){const t=this._webGLHelper.gl;let i;const r=new Promise((s,o)=>{i=Zv(t,{src:e,min:t.LINEAR},(a,l,c)=>{a?o(a):s(l)})});return this._promises.push(r),i}}function RV(n){return n.toLowerCase().replaceAll(/[^\w]/g,"")}function zxe(n){const e=n.split(`
`),t=[];let i;for(const r of e)if(r.startsWith("fonts {")&&(i={name:void 0,style:void 0,weight:void 0,filename:void 0,post_script_name:void 0,full_name:void 0,copyright:void 0}),r.startsWith("}")&&(t.push(i),i=void 0),i){let s=r.match(/^\s*([A-Za-z_]+):[ ]?"(.*)"$/);if(s){const o=s[1];i[o]=s[2]}if(s=r.match(/^\s*([A-Za-z_]+):[ ]?(\d+)$/),s){const o=s[1];i[o]=+s[2]}}return t}function Hxe(n,e){let t,i=Number.POSITIVE_INFINITY;for(const r of n)if(e.family.localeCompare(r.name,void 0,{sensitivity:"accent"})==0&&e.style==r.style){const s=Math.abs(e.weight-r.weight);s<i&&(i=s,t=r)}return t==null?void 0:t.filename}function Uxe(n,e){const t=[];let i;for(const r of n.split(`
`))if(r.startsWith(">"))i={identifier:r.match(/>(\S+)/)[1],sequence:""},t.push(i);else if(i)i.sequence+=r.trim();else throw new Error("Invalid fasta file!");return t}class jxe{constructor(e,t){this.animator=e,this.disabled=!!t,this.damping=.015,this.acceleration=.3,this.accelerationThreshold=100,this.lowerLimit=.5,this.loop=!1,this.momentum=0,this.timestamp=0,this.callback=null,this._transitionCallback=this.animate.bind(this),this.clear()}clear(){this.momentum=0,this.timestamp=null,this.loop=null,this.callback=null}cancel(){this.loop&&(this.animator.cancelTransition(this._transitionCallback),this.clear())}setMomentum(e,t){if(this.disabled){t(e);return}e*this.momentum<0?this.momentum=0:Math.abs(e)>this.accelerationThreshold?this.momentum=Voe([this.momentum,e],this.acceleration):this.momentum=e,this.callback=t,this.loop||this.animate()}animate(e){this.callback(this.momentum);const t=e-this.timestamp||0;this.timestamp=e;const i=Math.abs(this.momentum);this.momentum=Math.sign(this.momentum)*Math.max(0,i-((i*this.damping)**1.5+.04)*t),Math.abs(this.momentum)>this.lowerLimit?(this.loop=!0,this.animator.requestTransition(this._transitionCallback)):this.clear()}}function qxe(n){const e={},t=["string","number","boolean"],i=["wheelDelta","wheelDeltaX","wheelDeltaY"];for(const r in n){const s=r;!i.includes(r)&&t.includes(typeof n[s])&&(e[s]=n[s])}return e}const MV=new Map;async function Gxe(n,e,t){const i=n.symbol;let r=MV.get(i)??await Yxe(n.symbol);return r?(MV.set(i,r),on`
            <div class="title">
                <strong>${r.name}</strong>
                ${r.description}
            </div>
            <p class="summary">${r.summary}</p>
            <p class="source">Source: NCBI RefSeq Gene</p>
        `):null}async function Kxe(n){console.log("Searching: "+n);const e={mode:"cors"},i=(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=gene&term=${n}[GENE]&sort=relevance&retmode=json`,e).then(r=>r.json())).esearchresult.idlist[0];return i?(await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=gene&id=${i}&retmode=json`,e).then(o=>o.json())).result[i]:null}const Zxe=ay(Kxe,500);function Yxe(n){return Zxe(n)}const Xxe=Cr(".4~r"),Qxe=Cr(".4~e");function BX(n){return n==null?on` <span class="na">NA</span> `:un(n)?n.substring(0,30):Number.isInteger(n)?""+n:Os(n)?Math.abs(n)>Math.pow(10,8)||Math.abs(n)<Math.pow(10,-8)?Qxe(n):Xxe(n):ek(n)?n?"True":"False":po(n)?on`${n.map((e,t)=>[BX(e),t<n.length-1?", ":ln])}`:"?"+typeof n+" "+n}async function Jxe(n,e,t){const i=(l,c)=>{var h;for(const[u,d]of Object.entries(e.encoders))if((h=d==null?void 0:d.accessor)!=null&&h.fields.includes(l))switch(u){case"color":case"fill":case"stroke":return on`
                            <span
                                class="color-legend"
                                style=${`background-color: ${d(c)}`}
                            ></span>
                        `}return""},r=Object.entries(n).filter(([l,c])=>!l.startsWith("_"));if(r.length===0)return;const s=on`
        <table class="attributes">
            ${r.map(([l,c])=>on`
                    <tr>
                        <th>${l}</th>
                        <td>${BX(c)} ${i(l,n)}</td>
                    </tr>
                `)}
        </table>
    `,o=e.unitView.getTitleText(),a=o?on`
              <div class="title">
                  <strong>${o}</strong>
              </div>
          `:"";return on`${a}${s}`}class cy extends o_{constructor(e,t,i,r,s){super(e,t,i,r,s),this.spec=e,this.children=(e.layer||[]).map((o,a)=>{if(ZX(o)||KX(o))return t.createView(o,this,this,"layer"+a);throw new Error("LayerView accepts only unit or layer specs as children!")}),this.needsAxes={x:!0,y:!0}}*[Symbol.iterator](){for(const e of this.children)yield e}render(e,t,i={}){if(this.isConfiguredVisible()){e.pushView(this,t);for(const r of this.children)r.render(e,t,i);e.popView(this)}}propagateInteractionEvent(e){this.handleInteractionEvent(void 0,e,!0);for(let t=this.children.length-1;t>=0;t--)if(this.children[t].propagateInteractionEvent(e),e.stopped)return;this.handleInteractionEvent(void 0,e,!1)}}class FV{constructor(e,t){this.n=e,this.maxCols=t??1/0}get nRows(){return this.maxCols==1/0?1:Math.ceil(this.n/this.maxCols)}get nCols(){return Math.min(this.n,this.maxCols)}get rowIndices(){const e=[],t=this.nCols,i=this.nRows;for(let r=0;r<i;r++){const s=[];e.push(s);for(let o=0;o<t;o++){const a=r*t+o;a<this.n&&s.push(a)}}return e}get colIndices(){const e=[],t=this.nCols,i=this.nRows;for(let r=0;r<t;r++){const s=[];e.push(s);for(let o=0;o<i;o++){const a=o*t+r;a<this.n&&s.push(a)}}return e}getCellIndex(e,t){let i=0;if(this.maxCols==1/0)i=t==0?e:void 0;else{if(e>=this.maxCols)return;i=t*this.nCols+e}return i<this.n?i:void 0}getCellCoords(e){if(!(e<0||e>=this.n))return[e%this.nCols,Math.floor(e/this.nCols)]}}const eEe="chromosome_ticks_and_labels",tEe={x:"width",y:"height"};function DR(n){return n=="x"?"y":"x"}const lE={x:["bottom","top"],y:["left","right"]},v3=Object.fromEntries(Object.entries(lE).map(([n,e])=>e.map(t=>[t,n])).flat(1));function zu(n){return v3[n]}class VX extends cy{constructor(e,t,i,r,s){const o=t=="locus",a={...o?nEe:WX,...iEe(t,e),...e};super(o?rEe(a,t):$X(a,t),i,r,s,`axis_${e.orient}`),this.axisProps=a,this.blockEncodingInheritance=!0,this.contributesToScaleDomain=!1}getSize(){const e={px:this.getPerpendicularSize()},t={grow:1};return v3[this.axisProps.orient]=="x"?new Gf(t,e):new Gf(e,t)}getPerpendicularSize(){return w3(this.axisProps)}isPickingSupported(){return!1}}function w3(n){const e=zu(n.orient);let t=n.ticks&&n.tickSize||0;return n.labels&&(t+=n.labelPadding,e=="x"?t+=n.labelFontSize:t+=30),n.title&&(t+=n.titlePadding+n.titleFontSize),t=Math.min(n.maxExtent||1/0,Math.max(n.minExtent||0,t)),t}const WX={values:null,minExtent:20,maxExtent:1/0,offset:0,domain:!0,domainWidth:1,domainColor:"gray",domainDash:null,domainDashOffset:0,domainCap:"square",ticks:!0,tickSize:5,tickWidth:1,tickColor:"gray",tickDash:null,tickDashOffset:0,tickCap:"square",tickCount:null,tickMinStep:null,labels:!0,labelAlign:"center",labelBaseline:"middle",labelPadding:4,labelFontSize:10,labelLimit:180,labelColor:"black",format:null,titleColor:"black",titleFont:"sans-serif",titleFontSize:10,titlePadding:3};function iEe(n,e){const t=e.orient,i=n=="nominal"||n=="ordinal";let r="center",s="middle",o=e.labelAngle??((t=="top"||t=="bottom")&&i?-90:0);switch(t){case"left":r="right";break;case"right":r="left";break;case"top":case"bottom":Math.abs(o)>30?(r=o>0==(t=="bottom")?"left":"right",s="middle"):s=t=="top"?"alphabetic":"top";break}return{labelAlign:r,labelAngle:o,labelBaseline:s}}function $X(n,e){const t={...n,extent:w3(n)},i=zu(t.orient),r=DR(i),s=t.orient=="bottom"||t.orient=="right"?1:-1,o=t.orient=="bottom"||t.orient=="left"?1:0,a=()=>({name:"domain",data:{values:[0]},mark:{type:"rule",clip:!1,strokeDash:t.domainDash,strokeCap:t.domainCap,color:t.domainColor,[r]:o,size:t.domainWidth}}),l=()=>({name:"labels",mark:{type:"text",clip:!1,align:t.labelAlign,angle:t.labelAngle,baseline:t.labelBaseline,[r+"Offset"]:(t.tickSize+t.labelPadding)*s,[r]:o,size:t.labelFontSize,color:t.labelColor,minBufferSize:1500},encoding:{[i]:{field:"value",type:e},text:{field:"label"}}}),c=()=>({name:"ticks",mark:{type:"rule",clip:!1,strokeDash:t.tickDash,strokeCap:t.tickCap,color:t.tickColor,size:t.tickWidth,minBufferSize:300},encoding:{[r]:{value:o},[r+"2"]:{value:o-t.tickSize/t.extent*(o?1:-1)}}}),h=()=>({name:"title",data:{values:[0]},mark:{type:"text",clip:!1,align:"center",baseline:t.orient=="bottom"?"bottom":"top",angle:[0,90,0,-90][["top","right","bottom","left"].indexOf(t.orient)],text:t.title,color:t.titleColor,[i]:.5,[r]:1-o}}),u=()=>{const f={name:"ticks_and_labels",encoding:{[i]:{field:"value",type:e}},layer:[]};return t.ticks&&f.layer.push(c()),t.labels&&f.layer.push(l()),f},d={resolve:{scale:{[i]:"forced"}},[tEe[DR(i)]]:t.extent,data:{lazy:{type:"axisTicks",channel:i,axis:n}},layer:[]};return t.domain&&d.layer.push(a()),(t.ticks||t.labels)&&d.layer.push(u()),t.title&&d.layer.push(h()),d}const nEe={...WX,chromTicks:!0,chromTickSize:18,chromTickWidth:1,chromTickColor:"#989898",chromTickDash:[4,2],chromTickDashOffset:1,chromLabels:!0,chromLabelFontSize:13,chromLabelFontWeight:"normal",chromLabelFontStyle:"normal",chromLabelColor:"black",chromLabelAlign:"left",chromLabelPadding:7};function rEe(n,e){const t={...n,extent:w3(n)},i=zu(t.orient),r=DR(i),s=t.orient=="bottom"||t.orient=="left"?1:0,o=()=>({name:"chromosome_ticks",mark:{type:"rule",strokeDash:n.chromTickDash,strokeDashOffset:n.chromTickDashOffset,[r]:s,[r+"2"]:s-t.chromTickSize/t.extent*(s?1:-1),color:n.chromTickColor,size:t.chromTickWidth}}),a=()=>{let h;switch(t.orient){case"top":h={y:0,angle:0,paddingX:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"bottom":h={y:1,angle:0,paddingX:4,dy:t.chromLabelPadding+t.chromLabelFontSize*.73,viewportEdgeFadeWidthLeft:20,viewportEdgeFadeWidthRight:20,viewportEdgeFadeDistanceRight:-10,viewportEdgeFadeDistanceLeft:-20};break;case"left":h={x:1,angle:-90,paddingY:4,dy:-t.chromLabelPadding,viewportEdgeFadeWidthBottom:20,viewportEdgeFadeWidthTop:20,viewportEdgeFadeDistanceBottom:-20,viewportEdgeFadeDistanceTop:-10};break;case"right":h={x:0,angle:90,align:"right",paddingY:4,dy:-t.chromLabelPadding};break;default:h={}}return{name:"chromosome_labels",mark:{type:"text",size:t.chromLabelFontSize,font:t.chromLabelFont,fontWeight:t.chromLabelFontWeight,fontStyle:t.chromLabelFontStyle,color:t.chromLabelColor,align:n.chromLabelAlign,baseline:"alphabetic",clip:!1,...h},encoding:{[i+"2"]:{field:"continuousEnd",type:e},text:{field:"name"}}}};let l;switch(t.orient){case"bottom":case"top":l={};break;case"left":l={labelAngle:-90,labelAlign:"center",labelPadding:6};break;case"right":l={labelAngle:90,labelAlign:"center",labelPadding:6};break;default:l={}}const c=$X({...n,...l},e);if(n.chromTicks||n.chromLabels){const h={name:eEe,data:{lazy:{type:"axisGenome",channel:zu(t.orient)}},encoding:{[i]:{field:"continuousStart",type:e,band:0}},layer:[]};if(n.chromTicks&&h.layer.push(o()),n.chromLabels){h.layer.push(a());let u;c.layer.filter(d=>d.name=="ticks_and_labels").forEach(d=>d.layer.filter(f=>f.name=="labels").forEach(f=>{u=f.mark})),u&&(t.orient=="top"||t.orient=="bottom"?(u.viewportEdgeFadeWidthLeft=30,u.viewportEdgeFadeDistanceLeft=40):(u.viewportEdgeFadeWidthBottom=30,u.viewportEdgeFadeDistanceBottom=40))}c.layer.push(h)}return c}class sEe extends cy{constructor(e,t,i,r,s){const a={...t=="locus"?oEe:zX,...e};super(hEe(a,t),i,r,s,`axisGrid_${e.orient}`),this.axisProps=a,this.blockEncodingInheritance=!0,this.contributesToScaleDomain=!1}getOrient(){return this.axisProps.orient}isPickingSupported(){return!1}}const zX={values:null,grid:!1,gridCap:"butt",gridColor:"lightgray",gridDash:null,gridOpacity:1,gridWidth:1,tickCount:null,tickMinStep:null},oEe={...zX,chromGrid:!1,chromGridCap:"butt",chromGridColor:"gray",chromGridDash:[1,5],chromGridOpacity:1,chromGridWidth:1};function aEe(n,e){const t=n,i=zu(t.orient);return{name:"grid_lines",data:{lazy:{type:"axisTicks",channel:i,axis:n}},mark:{type:"rule",strokeDash:t.gridDash,strokeCap:t.gridCap,color:t.gridColor,size:t.gridWidth,opacity:t.gridOpacity,minBufferSize:300},encoding:{[i]:{field:"value",type:e}}}}function lEe(n,e){const t=n,i=zu(t.orient);return{name:"chromosome_lines",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rule",strokeDash:t.chromGridDash,strokeCap:t.chromGridCap,color:t.chromGridColor,size:t.chromGridWidth,opacity:t.chromGridOpacity},encoding:{[i]:{field:"continuousStart",type:e,band:0}}}}function cEe(n,e){const t=n,i=zu(t.orient);return{name:"chromosome_fill",data:{lazy:{type:"axisGenome",channel:i}},mark:{type:"rect"},encoding:{[i]:{field:"continuousStart",type:e,band:0},[i+"2"]:{field:"continuousEnd",band:0},fill:{field:"odd",type:"nominal",scale:{domain:[!1,!0],range:[t.chromGridFillEven??"white",t.chromGridFillOdd??"white"]}},opacity:{field:"odd",type:"nominal",scale:{type:"ordinal",domain:[!1,!0],range:[t.chromGridFillEven?1:0,t.chromGridFillOdd?1:0]}}}}}function hEe(n,e){const t={...n},i=[];return t.chromGrid&&(t.chromGridFillOdd||t.chromGridFillEven)&&i.push(cEe(t,e)),t.chromGrid&&t.chromGridOpacity>0&&i.push(lEe(t,e)),t.grid&&t.gridOpacity>0&&i.push(aEe(t,e)),{name:"grid_layers",configurableVisibility:!1,resolve:{scale:{[zu(n.orient)]:"forced",fill:"independent",opacity:"independent"}},layer:i}}const OV={anchor:"middle",frame:"group",offset:10,orient:"top",align:void 0,angle:0,baseline:"alphabetic",dx:0,dy:0,color:void 0,font:void 0,fontSize:12,fontStyle:"normal",fontWeight:"normal"},uEe={orient:"left",anchor:"middle",align:"right",baseline:"middle",angle:0,fontSize:12},dEe={orient:"top",anchor:"start",align:"left",baseline:"top",offset:-10,dx:10,fontSize:12},fEe={start:0,middle:.5,end:1},gEe={start:"left",middle:"center",end:"right"};function pEe(n){if(!n)return;const e=un(n)?{text:n}:n;if(!e.text||e.orient=="none")return;const t={"track-title":uEe,overlay:dEe}[e.style]??{},i={...OV,...t,...e};let r={},s={x:0,y:0};const o=fEe[i.anchor??"middle"];switch(i.orient){case"top":s={x:o,y:1},r={baseline:"alphabetic",angle:0};break;case"right":s={x:1,y:1-o},r={baseline:"alphabetic",angle:90};break;case"bottom":s={x:o,y:0},r={baseline:"top",angle:0};break;case"left":s={x:0,y:o},r={baseline:"alphabetic",angle:-90};break}const a={...OV,...r,...t,...e},l={xOffset:0,yOffset:0};switch(i.orient){case"top":l.yOffset=-a.offset;break;case"right":l.xOffset=a.offset;break;case"bottom":l.yOffset=a.offset;break;case"left":l.xOffset=-a.offset;break}return{configurableVisibility:!1,data:{values:[{}]},mark:{type:"text",tooltip:null,clip:!1,...s,...l,text:a.text,align:a.align??gEe[a.anchor],angle:a.angle,baseline:a.baseline,dx:a.dx,dy:a.dy,color:a.color,font:a.font,size:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight}}}function mEe(n,e,t,i){if(n.type=="wheel"){n.uiEvent.preventDefault();const r=n.uiEvent,s=r.deltaMode?120:1;let{x:o,y:a}=n.point;if(i){const l=i.mark.encoders;l.x&&!l.x2&&!l.x.constantValue&&(o=+l.x(i.datum)*e.width+e.x),l.y&&!l.y2&&!l.y.constantValue&&(a=(1-+l.y(i.datum))*e.height+e.y)}Math.abs(r.deltaX)<Math.abs(r.deltaY)?t({x:o,y:a,xDelta:0,yDelta:0,zDelta:r.deltaY*s/300}):t({x:o,y:a,xDelta:-r.deltaX*s,yDelta:0,zDelta:0})}else if(n.type=="mousedown"&&n.uiEvent.button===0){const r=n.uiEvent;r.preventDefault();let s=r;const o=l=>{t({x:s.clientX,y:s.clientY,xDelta:l.clientX-s.clientX,yDelta:l.clientY-s.clientY,zDelta:0}),s=l},a=l=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a)};document.addEventListener("mouseup",a,!1),document.addEventListener("mousemove",o,!1)}}var Um,jm,Ks,_f,qm,eh,Md,$D,UX,zD,jX,bf,bb,S1,kR,x1,LR,E1,IR,HD,qX,Gm,kS,UD,GX;class HX extends o_{constructor(t,i,r,s,o,a){super(t,i,r,s,o);Vt(this,eh);Vt(this,$D);Vt(this,zD);Vt(this,bf);Vt(this,S1);Vt(this,x1);Vt(this,E1);Vt(this,HD);Vt(this,Gm);Vt(this,UD);Vt(this,Um,1/0);Vt(this,jm,10);Vt(this,Ks,[]);Vt(this,_f,{});Vt(this,qm,0);this.spec=t,Co(this,jm,t.spacing??10),Co(this,Um,a),Co(this,Ks,[]),this.wrappingFacet=!1,this._createChildren()}_createChildren(){}appendChild(t){t.layoutParent??(t.layoutParent=this),Ze(this,Ks).push(new BV(t,this,Ze(this,qm))),jB(this,qm)._++}setChildren(t){Co(this,Ks,[]);for(const i of t)this.appendChild(i)}replaceChild(t,i){const r=Ze(this,Ks).findIndex(s=>s.view==t);if(r>=0)Ze(this,Ks)[r]=new BV(i,this,Ze(this,qm));else throw new Error("Not my child view!")}get children(){return Ze(this,Ks).map(t=>t.view)}get childCount(){return Ze(this,Ks).length}onScalesResolved(){super.onScalesResolved(),_t(this,zD,jX).call(this)}*[Symbol.iterator](){for(const t of Ze(this,Ks))yield*t.getChildren();for(const t of Object.values(Ze(this,_f)))yield t}getOverhang(){return _t(this,HD,qX).call(this).union(_t(this,Gm,kS).call(this))}getSize(){return this._cache("size",()=>new Gf(_t(this,x1,LR).call(this,"column"),_t(this,x1,LR).call(this,"row")).addPadding(_t(this,Gm,kS).call(this)))}render(t,i,r={}){if(!this.isConfiguredVisible())return;this.layoutParent||(i=i.shrink(this.getPadding())),i=i.shrink(_t(this,Gm,kS).call(this)),t.pushView(this,i);const s={devicePixelRatio:this.context.devicePixelRatio},o=Z8(_t(this,S1,kR).call(this,"column"),i.width,s),a=Z8(_t(this,S1,kR).call(this,"row"),i.height,s),l=new FV(Ze(this,eh,Md).length,Ze(this,Um)??1/0);for(const[c,h]of Ze(this,eh,Md).entries()){const{view:u,axes:d,gridLines:f,background:g,backgroundStroke:p,title:m}=h,[b,_]=l.getCellCoords(c),w=o[_t(this,E1,IR).call(this,"column",b)],y=a[_t(this,E1,IR).call(this,"row",_)],S=u.getSize(),k=u.getOverhang(),C=w.location-k.left,D=y.location-k.top,E=(S.width.grow?w.size:S.width.px)+k.width,N=(S.height.grow?y.size:S.height.px)+k.height,T=new wm(()=>i.x+C,()=>i.y+D,()=>E,()=>N);h.coords=T;const j=r.clipRect?T.intersect(r.clipRect):T;g==null||g.render(t,j,{...r,clipRect:void 0});for(const ie of Object.values(f))ie.render(t,T,r);const q=wEe(u);q&&u.render(t,T,r),p==null||p.render(t,j,{...r,clipRect:void 0});for(const[ie,ge]of Object.entries(d))ge.render(t,PV(T,ie,ge),r);for(const ie of Object.values(Ze(this,_f))){const be=ie.axisProps.orient;(be=="left"&&b==0||be=="right"&&b==l.nCols-1||be=="top"&&_==0||be=="bottom"&&_==l.nRows-1)&&ie.render(t,PV(T.shrink(h.view.getOverhang()),be,ie),r)}q||u.render(t,T,r),m==null||m.render(t,T,r)}t.popView(this)}propagateInteractionEvent(t){if(this.handleInteractionEvent(void 0,t,!0),t.stopped)return;const i=Ze(this,eh,Md).find(s=>s.coords.containsPoint(t.point.x,t.point.y)),r=i==null?void 0:i.view;r&&(r.propagateInteractionEvent(t),(r instanceof os||r instanceof cy)&&mEe(t,i.coords,s=>_t(this,UD,GX).call(this,i.coords,i.view,s),this.context.getCurrentHover())),!t.stopped&&this.handleInteractionEvent(void 0,t,!1)}getDefaultResolution(t,i){return"independent"}}Um=new WeakMap,jm=new WeakMap,Ks=new WeakMap,_f=new WeakMap,qm=new WeakMap,eh=new WeakSet,Md=function(){return Ze(this,Ks).filter(t=>t.view.isConfiguredVisible())},$D=new WeakSet,UX=function(){return new FV(Ze(this,eh,Md).length,Ze(this,Um)??1/0)},zD=new WeakSet,jX=function(){for(const t of J_){const i=this.resolutions.axis[t];if(i){const r=i.getAxisProps();if(r){const s={title:i.getTitle(),orient:lE[t][0],...r},o=new VX(s,i.scaleResolution.type,this.context,this,this);Ze(this,_f)[t]=o,o.visit(a=>{a instanceof os&&a.resolve("scale")})}}}for(const t of Ze(this,Ks))t.createAxes()},bf=new WeakSet,bb=function(t){const i=t=="column"?"width":"height",r=(s,o)=>s.map(a=>{const c=Ze(this,eh,Md)[a].getOverhangAndPadding();return t=="column"?o?c.right:c.left:o?c.bottom:c.top}).reduce((a,l)=>Math.max(a,l),0);return this._cache(`size/directionSizes/${t}`,()=>Ze(this,$D,UX)[t=="column"?"colIndices":"rowIndices"].map(s=>({axisBefore:r(s,0),axisAfter:r(s,1),view:Wme(s.map(o=>Ze(this,eh,Md)[o].view.getSize()[i]))})))},S1=new WeakSet,kR=function(t){const i=_t(this,bf,bb).call(this,t),r=[];r.push(Bb);for(const[s,o]of i.entries())s>0&&r.push({px:Ze(this,jm),grow:0}),(s==0||this.wrappingFacet)&&r.push(Bb),r.push({px:o.axisBefore,grow:0}),r.push(o.view),r.push({px:o.axisAfter,grow:0}),(s==i.length-1||this.wrappingFacet)&&r.push(Bb);return r},x1=new WeakSet,LR=function(t){let i=0,r=0;const s=(t=="row"&&this.spec.height)??(t=="column"&&this.spec.width);if(s||s===0)return aK(s);const o=_t(this,bf,bb).call(this,t);for(const[a,l]of o.entries())a>0&&(r+=Ze(this,jm)),(a==0||this.wrappingFacet)&&(r+=0),r+=l.axisBefore,r+=l.view.px??0,i+=l.view.grow??0,r+=l.axisAfter,(a==o.length-1||this.wrappingFacet)&&(r+=0);return{px:r,grow:i}},E1=new WeakSet,IR=function(t,i){return t=="row"&&this.wrappingFacet?1+6*i+2:2+4*i+1},HD=new WeakSet,qX=function(){const t=_t(this,bf,bb).call(this,"column"),i=_t(this,bf,bb).call(this,"row");return!t.length||!i.length?Mr.zero():new Mr(i.at(0).axisBefore,t.at(-1).axisAfter,i.at(-1).axisAfter,t.at(0).axisBefore)},Gm=new WeakSet,kS=function(){const t=i=>{const r=v3[i],s=Ze(this,_f)[r];return(s==null?void 0:s.axisProps.orient)!==i?0:Math.max(s.getPerpendicularSize()+s.axisProps.offset,0)};return new Mr(t("top"),t("right"),t("bottom"),t("left"))},UD=new WeakSet,GX=function(t,i,r){for(const[s,o]of Object.entries(vEe(i))){if(o.size<=0)continue;const a=t.normalizePoint(r.x,r.y),l=t.normalizePoint(r.x+r.xDelta,r.y+r.yDelta),c={x:l.x-a.x,y:l.y-a.y};for(const h of o)h.zoom(2**r.zDelta,s=="y"?1-a[s]:a[s],s=="x"?c.x:-c.y)}this.context.animator.requestRender()};function _Ee(n){if(!(!n||!n.fill||n.fillOpacity===0))return{configurableVisibility:!1,data:{values:[{}]},mark:{color:n.fill,opacity:n.fillOpacity??1,type:"rect",clip:!1,tooltip:null,minHeight:1,minOpacity:0}}}function bEe(n){if(!(!n||!n.stroke||n.strokeWidth===0||n.strokeOpacity===0))return{configurableVisibility:!1,resolve:{scale:{x:"excluded",y:"excluded"},axis:{x:"excluded",y:"excluded"}},data:{values:[{x:0,y:0,x2:1,y2:0},{x:1,y:0,x2:1,y2:1},{x:1,y:1,x2:0,y2:1},{x:0,y:1,x2:0,y2:0}]},mark:{size:n.strokeWidth??1,color:n.stroke??"lightgray",strokeCap:"square",strokeOpacity:n.strokeOpacity??1,type:"rule",clip:!1,tooltip:null},encoding:{x:{field:"x",type:"quantitative",scale:null},y:{field:"y",type:"quantitative",scale:null},x2:{field:"x2"},y2:{field:"y2"}}}}function vEe(n){const e={x:new Set,y:new Set};return n.visit(t=>{for(const[i,r]of Object.entries(e)){const s=t.getScaleResolution(i);s&&s.isZoomable()&&r.add(s)}}),e}function wEe(n){let e=!0;return n.visit(t=>{t instanceof os&&e&&(e=t.mark.properties.clip===!0)}),e}function PV(n,e,t){const i=t.axisProps,r=t.getPerpendicularSize();if(e=="bottom")return n.translate(0,n.height+i.offset).modify({height:r});if(e=="top")return n.translate(0,-r-i.offset).modify({height:r});if(e=="left")return n.translate(-r-i.offset,0).modify({width:r});if(e=="right")return n.translate(n.width+i.offset,0).modify({width:r})}class BV{constructor(e,t,i){if(this.layoutParent=t,this.view=e,this.serial=i,this.background=void 0,this.backgroundStroke=void 0,this.axes={},this.gridLines={},this.title=void 0,this.coords=wm.ZERO,e.needsAxes.x||e.needsAxes.y){const r=e.spec,s="view"in r?r==null?void 0:r.view:void 0,o=_Ee(s);o&&(this.background=new os(o,t.context,t,e,"background"+i),this.background.blockEncodingInheritance=!0);const a=bEe(s);a&&(this.backgroundStroke=new os(a,t.context,t,e,"backgroundStroke"+i),this.backgroundStroke.blockEncodingInheritance=!0);const l=pEe(e.spec.title);if(l){const c=new os(l,t.context,t,e,"title"+i);c.blockEncodingInheritance=!0,this.title=c}}}*getChildren(){this.background&&(yield this.background),this.backgroundStroke&&(yield this.backgroundStroke),this.title&&(yield this.title),yield*Object.values(this.axes),yield*Object.values(this.gridLines),yield this.view}createAxes(){const{view:e,axes:t,gridLines:i}=this,r=(a,l)=>{const c=a.getAxisProps();if(c===null)return;const h=c?{...c}:{};if(!h.orient){for(const u of lE[l])if(!t[u]){h.orient=u;break}if(!h.orient)throw new Error("No slots available for an axis! Perhaps a LayerView has more than two children?")}if(h.title??(h.title=a.getTitle()),!lE[l].includes(h.orient))throw new Error(`Invalid axis orientation "${h.orient}" on channel "${l}"!`);return h},s=(a,l,c)=>{const h=r(a,l);if(h){if(t[h.orient])throw new Error(`An axis with the orient "${h.orient}" already exists!`);t[h.orient]=new VX(h,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c)}},o=(a,l,c)=>{const h=r(a,l);h&&(h.grid||h.chromGrid)&&(i[h.orient]=new sEe(h,a.scaleResolution.type,this.layoutParent.context,this.layoutParent,c))};for(const a of["x","y"])if(e.needsAxes[a]){const l=e.resolutions.axis[a];if(!l)continue;s(l,a,e)}for(const a of["x","y"])if(e.needsAxes[a]){const l=e.getAxisResolution(a);if(!l)continue;o(l,a,e)}if(e instanceof cy){for(const a of e.children)for(const[l,c]of Object.entries(a.resolutions.axis)){const h=c.getAxisProps();h&&h.orient&&s(c,l,a)}for(const a of e.children)for(const[l,c]of Object.entries(a.resolutions.axis)){const h=c.getAxisProps();h&&!h.orient&&s(c,l,a)}}[...Object.values(t),...Object.values(i)].forEach(a=>a.visit(l=>{l instanceof os&&l.resolve("scale")}))}getOverhang(){const e=t=>{const i=this.axes[t];return i?Math.max(i.getPerpendicularSize()+i.axisProps.offset,0):0};return new Mr(e("top"),e("right"),e("bottom"),e("left")).add(this.view.getOverhang())}getOverhangAndPadding(){return this.getOverhang().add(this.view.getPadding())}}class YI extends HX{constructor(e,t,i,r,s){super(e,t,i,r,s,TR(e)?e.columns:LS(e)?1:1/0),this.spec=e}_createChildren(){const e=this.spec,t=TR(e)?e.concat:LS(e)?e.vconcat:e.hconcat;this.setChildren(t.map((i,r)=>this.context.createView(i,this,this,"grid"+r)))}getDefaultResolution(e,t){if(t=="axis")return"independent";if(LS(this.spec)&&e==="x"||YX(this.spec)&&e==="y"){const i=new Set(this.children.map(r=>r.getEncoding()[e]).filter(r=>r).map(r=>"type"in r&&r.type).filter(r=>r));return i.size===1&&(i.has("index")||i.has("locus"))?"shared":"independent"}else return"independent"}}class yEe{constructor(){this.types=[];const e=t=>(i,r,s,o,a)=>new t(i,r,s,o,i.name??a);this.addViewType(CEe,e(DK)),this.addViewType(ZX,e(cy)),this.addViewType(KX,e(os)),this.addViewType(LS,e(YI)),this.addViewType(YX,e(YI)),this.addViewType(TR,e(YI))}addViewType(e,t){this.types.push({specGuard:e,factory:t})}createView(e,t,i,r,s){const o=this.types.find(a=>a.specGuard(e));if(o)return o.factory(e,t,i,r,s??"unnamed");throw new Error("Invalid spec, cannot figure out the view type from the properties: "+JSON.stringify([...Object.keys(e)]))}isViewSpec(e){const t=this.types.filter(i=>i.specGuard(e));if(t.length>1)throw new Error("Ambiguous spec. Cannot create a view!");return t.length==1}}function KX(n){return"mark"in n&&(un(n.mark)||Qa(n.mark))}function ZX(n){return"layer"in n&&Qa(n.layer)}function CEe(n){return"import"in n}function LS(n){return"vconcat"in n&&po(n.vconcat)}function YX(n){return"hconcat"in n&&po(n.hconcat)}function TR(n){return"concat"in n&&po(n.concat)}class SEe extends HX{constructor(e,t){super({vconcat:[]},e,void 0,void 0,"implicitRoot",1),t.layoutParent=this,t.dataParent=this,this.appendChild(t)}}Wj("fasta",Uxe);class xEe{constructor(e,t,i={}){this.container=e;const r=document.createElement("style");r.innerHTML=cce,e.appendChild(r),this.spec=t,this.accessorFactory=new Zue,this.viewFactory=new yEe,this.namedDataProviders=[],this.animator=new Pxe(()=>this.renderAll()),this.genomeStore=void 0,this.viewVisibilityPredicate=s=>s.isVisibleInSpec(),this._renderingContext=void 0,this._pickingContext=void 0,this._dirtyPickingBuffer=!1,this._currentHover=void 0,this._wheelInertia=new jxe(this.animator),this._keyboardListeners=new Map,this._eventListeners=new Map,this._extraBroadcastListeners=new Map,this.tooltipHandlers={default:Jxe,refseqgene:Gxe,...i.tooltipHandlers??{}},this.viewRoot=void 0}registerNamedDataProvider(e){this.namedDataProviders.unshift(e)}getNamedDataFromProvider(e){for(const t of this.namedDataProviders){const i=t(e);if(i)return i}}updateNamedData(e,t){const i=this.viewRoot.context.dataFlow.findNamedDataSource(e);if(!i)throw new Error("No such named data source: "+e);i.dataSource.updateDynamicData(t),YN(i.hosts),this.animator.requestRender()}broadcast(e,t){var r;const i={type:e,payload:t};this.viewRoot.visit(s=>s.handleBroadcast(i)),(r=this._extraBroadcastListeners.get(e))==null||r.forEach(s=>s(i))}_prepareContainer(){this.container.classList.add("genome-spy"),this.container.classList.add("loading"),this._glHelper=new dme(this.container,()=>this.viewRoot?Axe(this.viewRoot):{width:void 0,height:void 0},this.spec.background),this.loadingMessageElement=document.createElement("div"),this.loadingMessageElement.className="loading-message",this.loadingMessageElement.innerHTML='<div class="message">Loading<span class="ellipsis">...</span></div>',this.container.appendChild(this.loadingMessageElement),this.tooltip=new uce(this.container),this.loadingMessageElement.querySelector(".message").addEventListener("transitionend",()=>{this.loadingMessageElement.style.display="none"})}destroy(){this.container.classList.remove("genome-spy"),this.container.classList.remove("loading");for(const[e,t]of this._keyboardListeners)for(const i of t)document.removeEventListener(e,i);for(this._glHelper.finalize();this.container.firstChild;)this.container.firstChild.remove()}async _prepareViewsAndData(){this.spec.genome&&(this.genomeStore=new Bxe(this.spec.baseUrl),await this.genomeStore.initialize(this.spec.genome));const e=this,t={dataFlow:new RX,accessorFactory:this.accessorFactory,glHelper:this._glHelper,animator:this.animator,genomeStore:this.genomeStore,fontManager:new $xe(this._glHelper),get devicePixelRatio(){return e._glHelper.dpr},requestLayoutReflow:()=>{},updateTooltip:this.updateTooltip.bind(this),getNamedDataFromProvider:this.getNamedDataFromProvider.bind(this),getCurrentHover:()=>this._currentHover,addKeyboardListener:(a,l)=>{document.addEventListener(a,l);let c=this._keyboardListeners.get(a);c||(c=[],this._keyboardListeners.set(a,c)),c.push(l)},addBroadcastListener(a,l){const c=e._extraBroadcastListeners;let h=c.get(a);h||(h=new Set,c.set(a,h)),h.add(l)},removeBroadcastListener(a,l){var h;(h=e._extraBroadcastListeners.get(a))==null||h.delete(l)},isViewConfiguredVisible:e.viewVisibilityPredicate,isViewSpec:a=>e.viewFactory.isViewSpec(a),createView:function(a,l,c,h){return e.viewFactory.createView(a,t,l,c,h)}},i=this.spec;i.datasets&&this.registerNamedDataProvider(a=>i.datasets[a]),this.viewRoot=t.createView(i,null,null,"viewRoot"),await OX(this.viewRoot),(this.viewRoot.needsAxes.x||this.viewRoot.needsAxes.y)&&(this.viewRoot=new SEe(t,this.viewRoot)),Lxe(this.viewRoot),Ixe(this.viewRoot),this._glHelper.invalidateSize();const r=[];this.viewRoot.visit(a=>{a instanceof os&&r.push(a)});const s=Cxe(this.viewRoot,t.dataFlow);kxe(s),this.broadcast("dataFlowBuilt",s),r.forEach(a=>a.mark.initializeEncoders());const o=Promise.all(r.map(a=>a.mark.initializeGraphics()));for(const a of r)s.addObserver(l=>{a.mark.initializeData(),a.mark.updateGraphicsData()},a);await t.fontManager.waitUntilReady(),s.initialize(),await Promise.all(s.dataSources.map(a=>a.load())),YN(this.viewRoot),this.broadcast("dataLoaded"),await o,this.viewRoot.visit(a=>{for(const l of Object.values(a.resolutions.scale))this._glHelper.createRangeTexture(l)});for(const a of r)a.mark.finalizeGraphicsInitialization();t.requestLayoutReflow=this.computeLayout.bind(this),this.viewRoot.visit(a=>mS(a,"size")),this._glHelper.invalidateSize()}async launch(){try{return this._prepareContainer(),await this._prepareViewsAndData(),this.registerMouseEvents(),this.computeLayout(),this.animator.requestRender(),this._glHelper.addEventListener("resize",()=>{this.computeLayout(),this.renderAll()}),!0}catch(e){const t=`${e.view?`At "${e.view.getPathString()}": `:""}${e.toString()}`;return console.error(e.stack),EEe(this.container,t),!1}finally{this.container.classList.remove("loading"),window.setTimeout(()=>{this.loadingMessageElement.style.display="none"},2e3)}}registerMouseEvents(){const e=this._glHelper.canvas,t=i=>{var r;if(i instanceof MouseEvent){i.type=="mousemove"&&(this.tooltip.handleMouseMove(i),this._tooltipUpdateRequested=!1,i.buttons==0&&this.renderPickingFramebuffer());const s=e.getBoundingClientRect(),o=new Mxe(i.clientX-s.left-e.clientLeft,i.clientY-s.top-e.clientTop),a=l=>{this.viewRoot.propagateInteractionEvent(new Rxe(o,l)),this._tooltipUpdateRequested||this.tooltip.clear()};if(i.type!="wheel"&&this._wheelInertia.cancel(),i.type=="mousemove")this._handlePicking(o.x,o.y);else if(i.type=="mousedown"||i.type=="mouseup")this.renderPickingFramebuffer();else if(i.type=="wheel"){this._tooltipUpdateRequested=!1;const l=i;if(Math.abs(l.deltaX)>Math.abs(l.deltaY))this._currentHover=null,this._wheelInertia.cancel();else{const c=qxe(l);this._wheelInertia.setMomentum(l.deltaY*(l.deltaMode?80:1),h=>{const u=new WheelEvent("wheel",{...c,deltaMode:0,deltaX:0,deltaY:h});a(u)}),l.preventDefault();return}}if(i.type=="click"){const l=this._currentHover?{type:i.type,viewPath:this._currentHover.mark.unitView.getLayoutAncestors().map(c=>c.name).reverse(),datum:this._currentHover.datum}:{type:i.type,viewPath:null,datum:null};(r=this._eventListeners.get("click"))==null||r.forEach(c=>c(l))}a(i)}};["mousedown","mouseup","wheel","click","mousemove","gesturechange","contextmenu"].forEach(i=>e.addEventListener(i,t)),e.addEventListener("mousedown",()=>{document.addEventListener("mouseup",()=>this.tooltip.popEnabledState(),{once:!0}),this.tooltip.pushEnabledState(!1)}),e.addEventListener("dragstart",i=>i.stopPropagation())}_handlePicking(e,t){var s;const i=this._glHelper.readPickingPixel(e,t),r=i[0]|i[1]<<8|i[2]<<16;if(r==0){this._currentHover=null;return}if(r!==((s=this._currentHover)==null?void 0:s.uniqueId)&&(this._currentHover=null),this._currentHover||this.viewRoot.visit(o=>{if(o instanceof os){if(o.mark.isPickingParticipant()){const a=o.mark.encoders.uniqueId.accessor;o.getCollector().visitData(l=>{a(l)==r&&(this._currentHover={mark:o.mark,datum:l,uniqueId:r})})}if(this._currentHover)return Vb}}),this._currentHover){const o=this._currentHover.mark;this.updateTooltip(this._currentHover.datum,async a=>{if(!o.isPickingParticipant())return;const l=o.properties.tooltip;if(l!==null){const c=(l==null?void 0:l.handler)??"default",h=this.tooltipHandlers[c];if(!h)throw new Error("No such tooltip handler: "+c);return h(a,o,l==null?void 0:l.params)}})}}updateTooltip(e,t){if(!this._tooltipUpdateRequested||!e)this.tooltip.updateWithDatum(e,t),this._tooltipUpdateRequested=!0;else throw new Error("Tooltip has already been updated! Duplicate event handler?")}computeLayout(){const e=this.viewRoot;if(!e)return;this.broadcast("layout");const t=this._glHelper.getLogicalCanvasSize();if(isNaN(t.width)||isNaN(t.height)){console.log(`NaN in canvas size: ${t.width}x${t.height}. Skipping computeLayout().`);return}this._renderingContext=new NV({picking:!1},this._glHelper),this._pickingContext=new NV({picking:!0},this._glHelper),e.render(new Nxe(this._renderingContext,this._pickingContext),wm.create(0,0,t.width,t.height)),this.broadcast("layoutComputed")}renderAll(){var e;(e=this._renderingContext)==null||e.render(),this._dirtyPickingBuffer=!0}renderPickingFramebuffer(){this._dirtyPickingBuffer&&(this._pickingContext.render(),this._dirtyPickingBuffer=!1)}getSearchableViews(){const e=[];return this.viewRoot.visit(t=>{t instanceof os&&t.getAccessor("search")&&e.push(t)}),e}getNamedScaleResolutions(){const e=new Map;return this.viewRoot.visit(t=>{for(const i of Object.values(t.resolutions.scale))i.name&&e.set(i.name,i)}),e}}function EEe(n,e){const t=document.createElement("div");t.className="message-box";const i=document.createElement("div");i.textContent=e,t.appendChild(i),n.appendChild(t)}const DEe=""+new URL("bowtie-663e9fd6.svg",import.meta.url).href;async function kEe(n,e,t={}){let i;if(un(n)){if(i=document.querySelector(n),!i)throw new Error(`No such element: ${n}`)}else if(n instanceof HTMLElement)i=n;else throw new Error(`Invalid element: ${n}`);let r;try{const s=Qa(e)?e:await IEe(e);if(s.baseUrl??(s.baseUrl=""),s.width??(s.width="container"),s.padding??(s.padding=10),i==document.body){const o=document.createElement("div");o.style.position="fixed",o.style.inset="0",o.style.overflow="hidden",i.appendChild(o),i=o}r=new xEe(i,s,t),LEe(r,t),await r.launch()}catch(s){i.innerText=s.toString(),console.error(s)}return{finalize(){for(r.destroy();i.firstChild;)i.firstChild.remove()},addEventListener(s,o){const a=r._eventListeners;let l=a.get(s);l||(l=new Set,a.set(s,l)),l.add(o)},removeEventListener(s,o){var l;(l=r._eventListeners.get(s))==null||l.delete(o)},getScaleResolutionByName(s){return r.getNamedScaleResolutions().get(s)},updateNamedData:r.updateNamedData.bind(r)}}function LEe(n,e){e.namedDataProvider&&n.registerNamedDataProvider(e.namedDataProvider)}async function IEe(n){let e;try{e=JSON.parse(await ok().load(n))}catch(t){throw new Error(`Could not load or parse configuration: ${n}, reason: ${t.message}`)}if(!e.baseUrl){const t=n.match(/^[^?#]*\//);e.baseUrl=t&&t[0]||"./"}return e}const TEe=`{
  "data": {
    "sequence": { "start": 0, "stop": 60, "as": "x" }
  },
  "transform": [
    {
      "type": "formula",
      "expr": "sin((datum.x - 30) / 4) + (datum.x - 30) / 30",
      "as": "y"
    }
  ],
  "mark": "rect",
  "encoding": {
    "x": { "field": "x", "type": "index", "scale": { "padding": 0.1 } },
    "y": { "field": "y", "type": "quantitative" },
    "y2": { "datum": 0 },
    "color": {
      "field": "y",
      "type": "quantitative",
      "scale": {
        "type": "threshold",
        "domain": [0],
        "range": ["#ed553b", "#20639b"]
      }
    }
  }
}
`;function AEe(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,function(i,r){const s=r[0];return typeof e[s]<"u"?e[s]:i}),t}function v(n,e,...t){return AEe(e,t)}var XI;const IS="en";let cE=!1,hE=!1,TS=!1,XX=!1,QX=!1,y3=!1,uC,QI=IS,NEe,qh;const hi=typeof self=="object"?self:typeof global=="object"?global:{};let rr;typeof hi.vscode<"u"&&typeof hi.vscode.process<"u"?rr=hi.vscode.process:typeof process<"u"&&(rr=process);const REe=typeof((XI=rr==null?void 0:rr.versions)===null||XI===void 0?void 0:XI.electron)=="string"&&rr.type==="renderer";if(typeof navigator=="object"&&!REe)qh=navigator.userAgent,cE=qh.indexOf("Windows")>=0,hE=qh.indexOf("Macintosh")>=0,y3=(qh.indexOf("Macintosh")>=0||qh.indexOf("iPad")>=0||qh.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,TS=qh.indexOf("Linux")>=0,QX=!0,uC=navigator.language,QI=uC;else if(typeof rr=="object"){cE=rr.platform==="win32",hE=rr.platform==="darwin",TS=rr.platform==="linux",TS&&rr.env.SNAP&&rr.env.SNAP_REVISION,uC=IS,QI=IS;const n=rr.env.VSCODE_NLS_CONFIG;if(n)try{const e=JSON.parse(n),t=e.availableLanguages["*"];uC=e.locale,QI=t||IS,NEe=e._translationsConfigFile}catch{}XX=!0}else console.error("Unable to resolve platform.");const Kn=cE,wt=hE,zr=TS,ym=XX,hy=QX,Hu=y3,MEe=qh,AR=function(){if(hi.setImmediate)return hi.setImmediate.bind(hi);if(typeof hi.postMessage=="function"&&!hi.importScripts){let t=[];hi.addEventListener("message",r=>{if(r.data&&r.data.vscodeSetImmediateId)for(let s=0,o=t.length;s<o;s++){const a=t[s];if(a.id===r.data.vscodeSetImmediateId){t.splice(s,1),a.callback();return}}});let i=0;return r=>{const s=++i;t.push({id:s,callback:r}),hi.postMessage({vscodeSetImmediateId:s},"*")}}if(typeof(rr==null?void 0:rr.nextTick)=="function")return rr.nextTick.bind(rr);const e=Promise.resolve();return t=>e.then(t)}(),Fo=hE||y3?2:cE?1:3;let VV=!0,WV=!1;function JX(){if(!WV){WV=!0;const n=new Uint8Array(2);n[0]=1,n[1]=2,VV=new Uint16Array(n.buffer)[0]===(2<<8)+1}return VV}const eQ="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function FEe(n=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of eQ)n.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const tQ=FEe();function uE(n){let e=tQ;if(n&&n instanceof RegExp)if(n.global)e=n;else{let t="g";n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.unicode&&(t+="u"),e=new RegExp(n.source,t)}return e.lastIndex=0,e}const OEe={maxLen:1e3,windowSize:15,timeBudget:150};function dE(n,e,t,i,r=OEe){if(t.length>r.maxLen){let c=n-r.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,n+r.maxLen/2),dE(n,e,t,i,r)}const s=Date.now(),o=n-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-s>=r.timeBudget);c++){const h=o-r.windowSize*c;e.lastIndex=Math.max(0,h);const u=PEe(e,t,o,a);if(!u&&l||(l=u,h<=0))break;a=h}if(l){let c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function PEe(n,e,t,i){let r;for(;r=n.exec(e);){const s=r.index||0;if(s<=t&&n.lastIndex>=t)return r;if(i>0&&s>i)return null}return null}const Gh=8;class iQ{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class BEe{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class nQ{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Cn{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}compute(e,t,i){return i}}class f0{constructor(e,t=null){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0,this.deps=t}validate(e){return this.defaultValue}}class Pg{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function Pe(n,e){return typeof n>"u"?e:n==="false"?!1:!!n}class dt extends Pg{constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="boolean",r.default=i),super(e,t,i,r)}validate(e){return Pe(e,this.defaultValue)}}function NR(n,e,t,i){if(typeof n>"u")return e;let r=parseInt(n,10);return isNaN(r)?e:(r=Math.max(t,r),r=Math.min(i,r),r|0)}class ti extends Pg{constructor(e,t,i,r,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=r,o.maximum=s),super(e,t,i,o),this.minimum=r,this.maximum=s}static clampedInt(e,t,i,r){return NR(e,t,i,r)}validate(e){return ti.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Wl extends Pg{constructor(e,t,i,r,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=r}static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}validate(e){return this.validationFn(Wl.float(e,this.defaultValue))}}class is extends Pg{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="string",r.default=i),super(e,t,i,r)}validate(e){return is.string(e,this.defaultValue)}}function Fr(n,e,t){return typeof n!="string"||t.indexOf(n)===-1?e:n}class tn extends Pg{constructor(e,t,i,r,s=void 0){typeof s<"u"&&(s.type="string",s.enum=r,s.default=i),super(e,t,i,s),this._allowedValues=r}validate(e){return Fr(e,this.defaultValue,this._allowedValues)}}class q0 extends Cn{constructor(e,t,i,r,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=r),super(e,t,i,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function VEe(n){switch(n){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class WEe extends Cn{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[v("accessibilitySupport.auto","The editor will use platform APIs to detect when a Screen Reader is attached."),v("accessibilitySupport.on","The editor will be permanently optimized for usage with a Screen Reader. Word wrapping will be disabled."),v("accessibilitySupport.off","The editor will never be optimized for usage with a Screen Reader.")],default:"auto",description:v("accessibilitySupport","Controls whether the editor should run in a mode where it is optimized for screen readers. Setting to on will disable word wrapping.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class $Ee extends Cn{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(19,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:v("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:v("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:Pe(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:Pe(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function zEe(n){switch(n){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var kn;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(kn||(kn={}));function HEe(n){switch(n){case"line":return kn.Line;case"block":return kn.Block;case"underline":return kn.Underline;case"line-thin":return kn.LineThin;case"block-outline":return kn.BlockOutline;case"underline-thin":return kn.UnderlineThin}}class UEe extends f0{constructor(){super(126,[65,33])}compute(e,t,i){const r=["monaco-editor"];return t.get(33)&&r.push(t.get(33)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(65)==="default"?r.push("mouse-default"):t.get(65)==="copy"&&r.push("mouse-copy"),t.get(99)&&r.push("showUnused"),t.get(124)&&r.push("showDeprecated"),r.join(" ")}}class jEe extends dt{constructor(){super(32,"emptySelectionClipboard",!0,{description:v("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class qEe extends Cn{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(35,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:v("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[v("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),v("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),v("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:v("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[v("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),v("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),v("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:v("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:v("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:wt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:v("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:v("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:Pe(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":Fr(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":Fr(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:Pe(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:Pe(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:Pe(t.loop,this.defaultValue.loop)}}}class Cs extends Cn{constructor(){super(44,"fontLigatures",Cs.OFF,{anyOf:[{type:"boolean",description:v("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:v("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:v("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?Cs.OFF:e==="true"?Cs.ON:e:e?Cs.ON:Cs.OFF}}Cs.OFF='"liga" off, "calt" off';Cs.ON='"liga" on, "calt" on';class GEe extends f0{constructor(){super(43)}compute(e,t,i){return e.fontInfo}}class KEe extends Pg{constructor(){super(45,"fontSize",Sr.fontSize,{type:"number",minimum:6,maximum:100,default:Sr.fontSize,description:v("fontSize","Controls the font size in pixels.")})}validate(e){let t=Wl.float(e,this.defaultValue);return t===0?Sr.fontSize:Wl.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class Ml extends Cn{constructor(){super(46,"fontWeight",Sr.fontWeight,{anyOf:[{type:"number",minimum:Ml.MINIMUM_VALUE,maximum:Ml.MAXIMUM_VALUE,errorMessage:v("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Ml.SUGGESTION_VALUES}],default:Sr.fontWeight,description:v("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(ti.clampedInt(e,Sr.fontWeight,Ml.MINIMUM_VALUE,Ml.MAXIMUM_VALUE))}}Ml.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"];Ml.MINIMUM_VALUE=1;Ml.MAXIMUM_VALUE=1e3;class ZEe extends Cn{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[v("editor.gotoLocation.multiple.peek","Show peek view of the results (default)"),v("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a peek view"),v("editor.gotoLocation.multiple.goto","Go to the primary result and enable peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(50,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:v("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:v("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:v("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleDeclarations":Object.assign({description:v("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleImplementations":Object.assign({description:v("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleReferences":Object.assign({description:v("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist.")},t),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:v("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:v("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:v("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:v("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:v("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){var t,i,r,s,o;if(!e||typeof e!="object")return this.defaultValue;const a=e;return{multiple:Fr(a.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:(t=a.multipleDefinitions)!==null&&t!==void 0?t:Fr(a.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:(i=a.multipleTypeDefinitions)!==null&&i!==void 0?i:Fr(a.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:(r=a.multipleDeclarations)!==null&&r!==void 0?r:Fr(a.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:(s=a.multipleImplementations)!==null&&s!==void 0?s:Fr(a.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:(o=a.multipleReferences)!==null&&o!==void 0?o:Fr(a.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:is.string(a.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:is.string(a.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:is.string(a.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:is.string(a.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:is.string(a.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class YEe extends Cn{constructor(){const e={enabled:!0,delay:300,sticky:!0,above:!0};super(52,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:v("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,description:v("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:v("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.above":{type:"boolean",default:e.above,description:v("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Pe(t.enabled,this.defaultValue.enabled),delay:ti.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:Pe(t.sticky,this.defaultValue.sticky),above:Pe(t.above,this.defaultValue.above)}}}class Cm extends f0{constructor(){super(129,[49,57,37,64,91,59,60,93,116,119,120,121,2])}compute(e,t,i){return Cm.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=e.scrollBeyondLastLine?t-1:0,r=(e.viewLineCount+i)/(e.pixelRatio*e.height),s=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:t,extraLinesBeyondLastLine:i,desiredRatio:r,minimapLineCount:s}}static _computeMinimapLayout(e,t){const i=e.outerWidth,r=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*r),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:r};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,h=e.scrollBeyondLastLine,u=e.minimap.renderCharacters;let d=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const f=e.minimap.maxColumn,g=e.minimap.size,p=e.minimap.side,m=e.verticalScrollbarWidth,b=e.viewLineCount,_=e.remainingWidth,w=e.isViewportWrapping,y=u?2:3;let S=Math.floor(s*r);const k=S/s;let C=!1,D=!1,E=y*d,N=d/s,T=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:Le,extraLinesBeyondLastLine:ke,desiredRatio:Lt,minimapLineCount:Ge}=Cm.computeContainedMinimapLineCount({viewLineCount:b,scrollBeyondLastLine:h,height:r,lineHeight:l,pixelRatio:s});if(b/Ge>1)C=!0,D=!0,d=1,E=1,N=d/s;else{let Ct=!1,ut=d+1;if(g==="fit"){const Ai=Math.ceil((b+ke)*E);w&&a&&_<=t.stableFitRemainingWidth?(Ct=!0,ut=t.stableFitMaxMinimapScale):Ct=Ai>S}if(g==="fill"||Ct){C=!0;const Ai=d;E=Math.min(l*s,Math.max(1,Math.floor(1/Lt))),w&&a&&_<=t.stableFitRemainingWidth&&(ut=t.stableFitMaxMinimapScale),d=Math.min(ut,Math.max(1,Math.floor(E/y))),d>Ai&&(T=Math.min(2,d/Ai)),N=d/s/T,S=Math.ceil(Math.max(Le,b+ke)*E),w?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=_,t.stableFitMaxMinimapScale=d):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const j=Math.floor(f*N),q=Math.min(j,Math.max(0,Math.floor((_-m-2)*N/(c+N)))+Gh);let ie=Math.floor(s*q);const ge=ie/s;ie=Math.floor(ie*T);const be=u?1:2,Se=p==="left"?0:i-q-m;return{renderMinimap:be,minimapLeft:Se,minimapWidth:q,minimapHeightIsEditorHeight:C,minimapIsSampling:D,minimapScale:d,minimapLineHeight:E,minimapCanvasInnerWidth:ie,minimapCanvasInnerHeight:S,minimapCanvasOuterWidth:ge,minimapCanvasOuterHeight:k}}static computeLayout(e,t){const i=t.outerWidth|0,r=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,h=t.viewLineCount,u=e.get(121),d=u==="inherit"?e.get(120):u,f=d==="inherit"?e.get(116):d,g=e.get(119),p=e.get(2),m=t.isDominatedByLongLines,b=e.get(49),_=e.get(59).renderType!==0,w=e.get(60),y=e.get(93),S=e.get(64),k=e.get(91),C=k.verticalScrollbarSize,D=k.verticalHasArrows,E=k.arrowSize,N=k.horizontalScrollbarSize,T=e.get(57),j=e.get(37);let q;if(typeof T=="string"&&/^\d+(\.\d+)?ch$/.test(T)){const pe=parseFloat(T.substr(0,T.length-2));q=ti.clampedInt(pe*a,0,0,1e3)}else q=ti.clampedInt(T,0,0,1e3);j&&(q+=16);let ie=0;if(_){const pe=Math.max(o,w);ie=Math.round(pe*l)}let ge=0;b&&(ge=s);let be=0,Se=be+ge,Le=Se+ie,ke=Le+q;const Lt=i-ge-ie-q;let Ge=!1,Je=!1,Ct=-1;p!==2&&(d==="inherit"&&m?(Ge=!0,Je=!0):f==="on"||f==="bounded"?Je=!0:f==="wordWrapColumn"&&(Ct=g));const ut=Cm._computeMinimapLayout({outerWidth:i,outerHeight:r,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:y,minimap:S,verticalScrollbarWidth:C,viewLineCount:h,remainingWidth:Lt,isViewportWrapping:Je},t.memory||new nQ);ut.renderMinimap!==0&&ut.minimapLeft===0&&(be+=ut.minimapWidth,Se+=ut.minimapWidth,Le+=ut.minimapWidth,ke+=ut.minimapWidth);const Ai=Lt-ut.minimapWidth,te=Math.max(1,Math.floor((Ai-C-2)/a)),ee=D?E:0;return Je&&(Ct=Math.max(1,te),f==="bounded"&&(Ct=Math.min(Ct,g))),{width:i,height:r,glyphMarginLeft:be,glyphMarginWidth:ge,lineNumbersLeft:Se,lineNumbersWidth:ie,decorationsLeft:Le,decorationsWidth:q,contentLeft:ke,contentWidth:Ai,minimap:ut,viewportColumn:te,isWordWrapMinified:Ge,isViewportWrapping:Je,wrappingColumn:Ct,verticalScrollbarWidth:C,horizontalScrollbarHeight:N,overviewRuler:{top:ee,width:C,height:r-2*ee,right:0}}}}class XEe extends Cn{constructor(){const e={enabled:!0};super(56,"lightbulb",e,{"editor.lightbulb.enabled":{type:"boolean",default:e.enabled,description:v("codeActions","Enables the code action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Pe(e.enabled,this.defaultValue.enabled)}}}class QEe extends Cn{constructor(){const e={enabled:!0,fontSize:0,fontFamily:""};super(125,"inlayHints",e,{"editor.inlayHints.enabled":{type:"boolean",default:e.enabled,description:v("inlayHints.enable","Enables the inlay hints in the editor.")},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:v("inlayHints.fontSize","Controls font size of inlay hints in the editor. A default of 90% of `#editor.fontSize#` is used when the configured value is less than `5` or greater than the editor font size.")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:v("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the `#editor.fontFamily#` is used.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Pe(t.enabled,this.defaultValue.enabled),fontSize:ti.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:is.string(t.fontFamily,this.defaultValue.fontFamily)}}}class JEe extends Wl{constructor(){super(58,"lineHeight",Sr.lineHeight,e=>Wl.clamp(e,0,150),{markdownDescription:v("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class eDe extends Cn{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",renderCharacters:!0,maxColumn:120,scale:1};super(64,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:v("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[v("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),v("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),v("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:v("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:v("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:v("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:v("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:v("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:v("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Pe(t.enabled,this.defaultValue.enabled),size:Fr(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:Fr(t.side,this.defaultValue.side,["right","left"]),showSlider:Fr(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:Pe(t.renderCharacters,this.defaultValue.renderCharacters),scale:ti.clampedInt(t.scale,1,1,3),maxColumn:ti.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function tDe(n){return n==="ctrlCmd"?wt?"metaKey":"ctrlKey":"altKey"}class iDe extends Cn{constructor(){super(74,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:v("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:v("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:ti.clampedInt(t.top,0,0,1e3),bottom:ti.clampedInt(t.bottom,0,0,1e3)}}}class nDe extends Cn{constructor(){const e={enabled:!0,cycle:!1};super(75,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:v("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:v("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Pe(t.enabled,this.defaultValue.enabled),cycle:Pe(t.cycle,this.defaultValue.cycle)}}}class rDe extends f0{constructor(){super(127)}compute(e,t,i){return e.pixelRatio}}class sDe extends Cn{constructor(){const e={other:!0,comments:!1,strings:!1};super(78,"quickSuggestions",e,{anyOf:[{type:"boolean"},{type:"object",properties:{strings:{type:"boolean",default:e.strings,description:v("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{type:"boolean",default:e.comments,description:v("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{type:"boolean",default:e.other,description:v("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}}}],default:e,description:v("quickSuggestions","Controls whether suggestions should automatically show up while typing.")}),this.defaultValue=e}validate(e){if(typeof e=="boolean")return e;if(e&&typeof e=="object"){const t=e,i={other:Pe(t.other,this.defaultValue.other),comments:Pe(t.comments,this.defaultValue.comments),strings:Pe(t.strings,this.defaultValue.strings)};return i.other&&i.comments&&i.strings?!0:!i.other&&!i.comments&&!i.strings?!1:i}return this.defaultValue}}class oDe extends Cn{constructor(){super(59,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[v("lineNumbers.off","Line numbers are not rendered."),v("lineNumbers.on","Line numbers are rendered as absolute number."),v("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),v("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:v("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function C3(n){const e=n.get(86);return e==="editable"?n.get(80):e!=="on"}class aDe extends Cn{constructor(){const e=[],t={type:"number",description:v("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(90,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:v("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:v("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){let t=[];for(let i of e)if(typeof i=="number")t.push({column:ti.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const r=i;t.push({column:ti.clampedInt(r.column,0,0,1e4),color:r.color})}return t.sort((i,r)=>i.column-r.column),t}return this.defaultValue}}function $V(n,e){if(typeof n!="string")return e;switch(n){case"hidden":return 2;case"visible":return 3;default:return 1}}let lDe=class extends Cn{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(91,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[v("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),v("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),v("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:v("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[v("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),v("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),v("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:v("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:v("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:v("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:v("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=ti.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=ti.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:ti.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:$V(t.vertical,this.defaultValue.vertical),horizontal:$V(t.horizontal,this.defaultValue.horizontal),useShadows:Pe(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:Pe(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:Pe(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:Pe(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:Pe(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:ti.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:r,verticalSliderSize:ti.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:Pe(t.scrollByPage,this.defaultValue.scrollByPage)}}};class cDe extends Cn{constructor(){const e={enabled:!0,mode:"subwordSmart"};super(54,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:v("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:Pe(t.enabled,this.defaultValue.enabled),mode:Fr(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"])}}}class hDe extends Cn{constructor(){const e={enabled:sr.bracketPairColorizationOptions.enabled};super(12,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,description:v("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use 'workbench.colorCustomizations' to override the bracket highlight colors.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:Pe(e.enabled,this.defaultValue.enabled)}}}class uDe extends Cn{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(13,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[v("editor.guides.bracketPairs.true","Enables bracket pair guides."),v("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),v("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:v("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[v("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),v("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),v("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:v("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:v("editor.guides.highlightActiveBracketPair","Controls whether bracket pair guides are enabled or not.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:v("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:"boolean",default:e.highlightActiveIndentation,description:v("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:zV(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:zV(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:Pe(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:Pe(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:Pe(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation)}}}function zV(n,e,t){const i=t.indexOf(n);return i===-1?e:t[i]}class dDe extends Cn{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!0,localityBonus:!1,shareSuggestSelections:!1,showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(105,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[v("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),v("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:v("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:v("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:v("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:v("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:v("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:v("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:v("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:v("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:v("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:v("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:v("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:v("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:Fr(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:Pe(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:Pe(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:Pe(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:Pe(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),showIcons:Pe(t.showIcons,this.defaultValue.showIcons),showStatusBar:Pe(t.showStatusBar,this.defaultValue.showStatusBar),preview:Pe(t.preview,this.defaultValue.preview),previewMode:Fr(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:Pe(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:Pe(t.showMethods,this.defaultValue.showMethods),showFunctions:Pe(t.showFunctions,this.defaultValue.showFunctions),showConstructors:Pe(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:Pe(t.showDeprecated,this.defaultValue.showDeprecated),showFields:Pe(t.showFields,this.defaultValue.showFields),showVariables:Pe(t.showVariables,this.defaultValue.showVariables),showClasses:Pe(t.showClasses,this.defaultValue.showClasses),showStructs:Pe(t.showStructs,this.defaultValue.showStructs),showInterfaces:Pe(t.showInterfaces,this.defaultValue.showInterfaces),showModules:Pe(t.showModules,this.defaultValue.showModules),showProperties:Pe(t.showProperties,this.defaultValue.showProperties),showEvents:Pe(t.showEvents,this.defaultValue.showEvents),showOperators:Pe(t.showOperators,this.defaultValue.showOperators),showUnits:Pe(t.showUnits,this.defaultValue.showUnits),showValues:Pe(t.showValues,this.defaultValue.showValues),showConstants:Pe(t.showConstants,this.defaultValue.showConstants),showEnums:Pe(t.showEnums,this.defaultValue.showEnums),showEnumMembers:Pe(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:Pe(t.showKeywords,this.defaultValue.showKeywords),showWords:Pe(t.showWords,this.defaultValue.showWords),showColors:Pe(t.showColors,this.defaultValue.showColors),showFiles:Pe(t.showFiles,this.defaultValue.showFiles),showReferences:Pe(t.showReferences,this.defaultValue.showReferences),showFolders:Pe(t.showFolders,this.defaultValue.showFolders),showTypeParameters:Pe(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:Pe(t.showSnippets,this.defaultValue.showSnippets),showUsers:Pe(t.showUsers,this.defaultValue.showUsers),showIssues:Pe(t.showIssues,this.defaultValue.showIssues)}}}class fDe extends Cn{constructor(){super(101,"smartSelect",{selectLeadingAndTrailingWhitespace:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:v("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:Pe(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace)}}}class gDe extends f0{constructor(){super(128,[80])}compute(e,t,i){return t.get(80)?!0:e.tabFocusMode}}function pDe(n){switch(n){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}}class mDe extends f0{constructor(){super(130,[129])}compute(e,t,i){const r=t.get(129);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}}const _De="Consolas, 'Courier New', monospace",bDe="Menlo, Monaco, 'Courier New', monospace",vDe="'Droid Sans Mono', 'monospace', monospace, 'Droid Sans Fallback'",Sr={fontFamily:wt?bDe:zr?vDe:_De,fontWeight:"normal",fontSize:wt?12:14,lineHeight:0,letterSpacing:0},sr={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!1}},Zp=[];function he(n){return Zp[n.id]=n,n}const Bg={acceptSuggestionOnCommitCharacter:he(new dt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:v("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:he(new tn(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",v("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:v("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:he(new WEe),accessibilityPageSize:he(new ti(3,"accessibilityPageSize",10,1,1073741824,{description:v("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default.")})),ariaLabel:he(new is(4,"ariaLabel",v("editorViewAccessibleLabel","Editor content"))),autoClosingBrackets:he(new tn(5,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",v("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),v("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:v("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingDelete:he(new tn(6,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",v("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:v("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:he(new tn(7,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",v("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:v("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:he(new tn(8,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",v("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),v("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:v("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:he(new q0(9,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],VEe,{enumDescriptions:[v("editor.autoIndent.none","The editor will not insert indentation automatically."),v("editor.autoIndent.keep","The editor will keep the current line's indentation."),v("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),v("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),v("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:v("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:he(new dt(10,"automaticLayout",!1)),autoSurround:he(new tn(11,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[v("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),v("editor.autoSurround.quotes","Surround with quotes but not brackets."),v("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:v("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:he(new hDe),bracketPairGuides:he(new uDe),stickyTabStops:he(new dt(103,"stickyTabStops",!1,{description:v("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:he(new dt(14,"codeLens",!0,{description:v("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:he(new is(15,"codeLensFontFamily","",{description:v("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:he(new ti(16,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:v("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to `0`, the 90% of `#editor.fontSize#` is used.")})),colorDecorators:he(new dt(17,"colorDecorators",!0,{description:v("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),columnSelection:he(new dt(18,"columnSelection",!1,{description:v("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:he(new $Ee),contextmenu:he(new dt(20,"contextmenu",!0)),copyWithSyntaxHighlighting:he(new dt(21,"copyWithSyntaxHighlighting",!0,{description:v("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:he(new q0(22,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],zEe,{description:v("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:he(new dt(23,"cursorSmoothCaretAnimation",!1,{description:v("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:he(new q0(24,"cursorStyle",kn.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],HEe,{description:v("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:he(new ti(25,"cursorSurroundingLines",0,0,1073741824,{description:v("cursorSurroundingLines","Controls the minimal number of visible leading and trailing lines surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:he(new tn(26,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[v("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),v("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],description:v("cursorSurroundingLinesStyle","Controls when `cursorSurroundingLines` should be enforced.")})),cursorWidth:he(new ti(27,"cursorWidth",0,0,1073741824,{markdownDescription:v("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:he(new dt(28,"disableLayerHinting",!1)),disableMonospaceOptimizations:he(new dt(29,"disableMonospaceOptimizations",!1)),domReadOnly:he(new dt(30,"domReadOnly",!1)),dragAndDrop:he(new dt(31,"dragAndDrop",!0,{description:v("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:he(new jEe),extraEditorClassName:he(new is(33,"extraEditorClassName","")),fastScrollSensitivity:he(new Wl(34,"fastScrollSensitivity",5,n=>n<=0?5:n,{markdownDescription:v("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:he(new qEe),fixedOverflowWidgets:he(new dt(36,"fixedOverflowWidgets",!1)),folding:he(new dt(37,"folding",!0,{description:v("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:he(new tn(38,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[v("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),v("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:v("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:he(new dt(39,"foldingHighlight",!0,{description:v("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:he(new dt(40,"foldingImportsByDefault",!1,{description:v("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),unfoldOnClickAfterEndOfLine:he(new dt(41,"unfoldOnClickAfterEndOfLine",!1,{description:v("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:he(new is(42,"fontFamily",Sr.fontFamily,{description:v("fontFamily","Controls the font family.")})),fontInfo:he(new GEe),fontLigatures2:he(new Cs),fontSize:he(new KEe),fontWeight:he(new Ml),formatOnPaste:he(new dt(47,"formatOnPaste",!1,{description:v("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:he(new dt(48,"formatOnType",!1,{description:v("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:he(new dt(49,"glyphMargin",!0,{description:v("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:he(new ZEe),hideCursorInOverviewRuler:he(new dt(51,"hideCursorInOverviewRuler",!1,{description:v("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:he(new YEe),inDiffEditor:he(new dt(53,"inDiffEditor",!1)),letterSpacing:he(new Wl(55,"letterSpacing",Sr.letterSpacing,n=>Wl.clamp(n,-5,20),{description:v("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:he(new XEe),lineDecorationsWidth:he(new Pg(57,"lineDecorationsWidth",10)),lineHeight:he(new JEe),lineNumbers:he(new oDe),lineNumbersMinChars:he(new ti(60,"lineNumbersMinChars",5,1,300)),linkedEditing:he(new dt(61,"linkedEditing",!1,{description:v("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols, e.g. HTML tags, are updated while editing.")})),links:he(new dt(62,"links",!0,{description:v("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:he(new tn(63,"matchBrackets","always",["always","near","never"],{description:v("matchBrackets","Highlight matching brackets.")})),minimap:he(new eDe),mouseStyle:he(new tn(65,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:he(new Wl(66,"mouseWheelScrollSensitivity",1,n=>n===0?1:n,{markdownDescription:v("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:he(new dt(67,"mouseWheelZoom",!1,{markdownDescription:v("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:he(new dt(68,"multiCursorMergeOverlapping",!0,{description:v("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:he(new q0(69,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],tDe,{markdownEnumDescriptions:[v("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),v("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:v({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the multicursor modifier. [Read more](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:he(new tn(70,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[v("multiCursorPaste.spread","Each cursor pastes a single line of the text."),v("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:v("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),occurrencesHighlight:he(new dt(71,"occurrencesHighlight",!0,{description:v("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:he(new dt(72,"overviewRulerBorder",!0,{description:v("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:he(new ti(73,"overviewRulerLanes",3,0,3)),padding:he(new iDe),parameterHints:he(new nDe),peekWidgetDefaultFocus:he(new tn(76,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[v("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),v("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:v("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:he(new dt(77,"definitionLinkOpensInPeek",!1,{description:v("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:he(new sDe),quickSuggestionsDelay:he(new ti(79,"quickSuggestionsDelay",10,0,1073741824,{description:v("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:he(new dt(80,"readOnly",!1)),renameOnType:he(new dt(81,"renameOnType",!1,{description:v("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:v("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:he(new dt(82,"renderControlCharacters",!0,{description:v("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:he(new dt(83,"renderFinalNewline",!0,{description:v("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:he(new tn(84,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",v("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:v("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:he(new dt(85,"renderLineHighlightOnlyWhenFocus",!1,{description:v("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:he(new tn(86,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:he(new tn(87,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",v("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),v("renderWhitespace.selection","Render whitespace characters only on selected text."),v("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:v("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:he(new ti(88,"revealHorizontalRightPadding",30,0,1e3)),roundedSelection:he(new dt(89,"roundedSelection",!0,{description:v("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:he(new aDe),scrollbar:he(new lDe),scrollBeyondLastColumn:he(new ti(92,"scrollBeyondLastColumn",5,0,1073741824,{description:v("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:he(new dt(93,"scrollBeyondLastLine",!0,{description:v("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:he(new dt(94,"scrollPredominantAxis",!0,{description:v("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:he(new dt(95,"selectionClipboard",!0,{description:v("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:zr})),selectionHighlight:he(new dt(96,"selectionHighlight",!0,{description:v("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:he(new dt(97,"selectOnLineNumbers",!0)),showFoldingControls:he(new tn(98,"showFoldingControls","mouseover",["always","mouseover"],{enumDescriptions:[v("showFoldingControls.always","Always show the folding controls."),v("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:v("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:he(new dt(99,"showUnused",!0,{description:v("showUnused","Controls fading out of unused code.")})),showDeprecated:he(new dt(124,"showDeprecated",!0,{description:v("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:he(new QEe),snippetSuggestions:he(new tn(100,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[v("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),v("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),v("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),v("snippetSuggestions.none","Do not show snippet suggestions.")],description:v("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:he(new fDe),smoothScrolling:he(new dt(102,"smoothScrolling",!1,{description:v("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:he(new ti(104,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:he(new dDe),inlineSuggest:he(new cDe),suggestFontSize:he(new ti(106,"suggestFontSize",0,0,1e3,{markdownDescription:v("suggestFontSize","Font size for the suggest widget. When set to `0`, the value of `#editor.fontSize#` is used.")})),suggestLineHeight:he(new ti(107,"suggestLineHeight",0,0,1e3,{markdownDescription:v("suggestLineHeight","Line height for the suggest widget. When set to `0`, the value of `#editor.lineHeight#` is used. The minimum value is 8.")})),suggestOnTriggerCharacters:he(new dt(108,"suggestOnTriggerCharacters",!0,{description:v("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:he(new tn(109,"suggestSelection","recentlyUsed",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[v("suggestSelection.first","Always select the first suggestion."),v("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),v("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:v("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:he(new tn(110,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[v("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),v("tabCompletion.off","Disable tab completions."),v("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:v("tabCompletion","Enables tab completions.")})),tabIndex:he(new ti(111,"tabIndex",0,-1,1073741824)),unusualLineTerminators:he(new tn(112,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[v("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),v("unusualLineTerminators.off","Unusual line terminators are ignored."),v("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:v("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:he(new dt(113,"useShadowDOM",!0)),useTabStops:he(new dt(114,"useTabStops",!0,{description:v("useTabStops","Inserting and deleting whitespace follows tab stops.")})),wordSeparators:he(new is(115,"wordSeparators",eQ,{description:v("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:he(new tn(116,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[v("wordWrap.off","Lines will never wrap."),v("wordWrap.on","Lines will wrap at the viewport width."),v({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),v({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:v({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:he(new is(117,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:he(new is(118,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:he(new ti(119,"wordWrapColumn",80,1,1073741824,{markdownDescription:v({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:he(new tn(120,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:he(new tn(121,"wordWrapOverride2","inherit",["off","on","inherit"])),wrappingIndent:he(new q0(122,"wrappingIndent",1,"same",["none","same","indent","deepIndent"],pDe,{enumDescriptions:[v("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),v("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),v("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),v("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:v("wrappingIndent","Controls the indentation of wrapped lines.")})),wrappingStrategy:he(new tn(123,"wrappingStrategy","simple",["simple","advanced"],{enumDescriptions:[v("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),v("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],description:v("wrappingStrategy","Controls the algorithm that computes wrapping points.")})),editorClassName:he(new UEe),pixelRatio:he(new rDe),tabFocusMode:he(new gDe),layoutInfo:he(new Cm),wrappingInfo:he(new mDe)};class wDe{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const rQ=new wDe;function it(n){gd(n)||rQ.onUnexpectedError(n)}function ca(n){gd(n)||rQ.onUnexpectedExternalError(n)}function HV(n){if(n instanceof Error){let{name:e,message:t}=n;const i=n.stacktrace||n.stack;return{$isError:!0,name:e,message:t,stack:i}}return n}const RR="Canceled";function gd(n){return n instanceof Error&&n.name===RR&&n.message===RR}function g0(){const n=new Error(RR);return n.name=n.message,n}function Zl(n){return n?new Error(`Illegal argument: ${n}`):new Error("Illegal argument")}function yDe(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}class CDe extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}function ig(n){const e=this;let t=!1,i;return function(){return t||(t=!0,i=n.apply(e,arguments)),i}}var vt;(function(n){function e(_){return _&&typeof _=="object"&&typeof _[Symbol.iterator]=="function"}n.is=e;const t=Object.freeze([]);function i(){return t}n.empty=i;function*r(_){yield _}n.single=r;function s(_){return _||t}n.from=s;function o(_){return!_||_[Symbol.iterator]().next().done===!0}n.isEmpty=o;function a(_){return _[Symbol.iterator]().next().value}n.first=a;function l(_,w){for(const y of _)if(w(y))return!0;return!1}n.some=l;function c(_,w){for(const y of _)if(w(y))return y}n.find=c;function*h(_,w){for(const y of _)w(y)&&(yield y)}n.filter=h;function*u(_,w){let y=0;for(const S of _)yield w(S,y++)}n.map=u;function*d(..._){for(const w of _)for(const y of w)yield y}n.concat=d;function*f(_){for(const w of _)for(const y of w)yield y}n.concatNested=f;function g(_,w,y){let S=y;for(const k of _)S=w(S,k);return S}n.reduce=g;function*p(_,w,y=_.length){for(w<0&&(w+=_.length),y<0?y+=_.length:y>_.length&&(y=_.length);w<y;w++)yield _[w]}n.slice=p;function m(_,w=Number.POSITIVE_INFINITY){const y=[];if(w===0)return[y,_];const S=_[Symbol.iterator]();for(let k=0;k<w;k++){const C=S.next();if(C.done)return[y,n.empty()];y.push(C.value)}return[y,{[Symbol.iterator](){return S}}]}n.consume=m;function b(_,w,y=(S,k)=>S===k){const S=_[Symbol.iterator](),k=w[Symbol.iterator]();for(;;){const C=S.next(),D=k.next();if(C.done!==D.done)return!1;if(C.done)return!0;if(!y(C.value,D.value))return!1}}n.equals=b})(vt||(vt={}));class SDe extends Error{constructor(e){super(`Encountered errors while disposing of store. Errors: [${e.join(", ")}]`),this.errors=e}}function sQ(n){return typeof n.dispose=="function"&&n.dispose.length===0}function mt(n){if(vt.is(n)){let e=[];for(const t of n)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new SDe(e);return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function Cu(...n){return Et(()=>mt(n))}function Et(n){return{dispose:ig(()=>{n()})}}class ve{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}clear(){try{mt(this._toDispose.values())}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?ve.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}}ve.DISABLE_DISPOSED_WARNING=!1;class re{constructor(){this._store=new ve,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}re.None=Object.freeze({dispose(){}});class zs{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)===null||t===void 0||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)===null||e===void 0||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class xDe{constructor(e){this.object=e}dispose(){}}let $i=class MR{constructor(e){this.element=e,this.next=MR.Undefined,this.prev=MR.Undefined}};$i.Undefined=new $i(void 0);class As{constructor(){this._first=$i.Undefined,this._last=$i.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===$i.Undefined}clear(){let e=this._first;for(;e!==$i.Undefined;){const t=e.next;e.prev=$i.Undefined,e.next=$i.Undefined,e=t}this._first=$i.Undefined,this._last=$i.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new $i(e);if(this._first===$i.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(i))}}shift(){if(this._first!==$i.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==$i.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==$i.Undefined&&e.next!==$i.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===$i.Undefined&&e.next===$i.Undefined?(this._first=$i.Undefined,this._last=$i.Undefined):e.next===$i.Undefined?(this._last=this._last.prev,this._last.next=$i.Undefined):e.prev===$i.Undefined&&(this._first=this._first.next,this._first.prev=$i.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==$i.Undefined;)yield e.element,e=e.next}}const EDe=hi.performance&&typeof hi.performance.now=="function";class yh{constructor(e){this._highResolution=EDe&&e,this._startTime=this._now(),this._stopTime=-1}static create(e=!0){return new yh(e)}stop(){this._stopTime=this._now()}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?hi.performance.now():Date.now()}}var Re;(function(n){n.None=()=>re.None;function e(_){return(w,y=null,S)=>{let k=!1,C;return C=_(D=>{if(!k)return C?C.dispose():k=!0,w.call(y,D)},null,S),k&&C.dispose(),C}}n.once=e;function t(_,w){return l((y,S=null,k)=>_(C=>y.call(S,w(C)),null,k))}n.map=t;function i(_,w){return l((y,S=null,k)=>_(C=>{w(C),y.call(S,C)},null,k))}n.forEach=i;function r(_,w){return l((y,S=null,k)=>_(C=>w(C)&&y.call(S,C),null,k))}n.filter=r;function s(_){return _}n.signal=s;function o(..._){return(w,y=null,S)=>Cu(..._.map(k=>k(C=>w.call(y,C),null,S)))}n.any=o;function a(_,w,y){let S=y;return t(_,k=>(S=w(S,k),S))}n.reduce=a;function l(_){let w;const y=new H({onFirstListenerAdd(){w=_(y.fire,y)},onLastListenerRemove(){w.dispose()}});return y.event}function c(_,w,y=100,S=!1,k){let C,D,E,N=0;const T=new H({leakWarningThreshold:k,onFirstListenerAdd(){C=_(j=>{N++,D=w(D,j),S&&!E&&(T.fire(D),D=void 0),clearTimeout(E),E=setTimeout(()=>{const q=D;D=void 0,E=void 0,(!S||N>1)&&T.fire(q),N=0},y)})},onLastListenerRemove(){C.dispose()}});return T.event}n.debounce=c;function h(_,w=(y,S)=>y===S){let y=!0,S;return r(_,k=>{const C=y||!w(k,S);return y=!1,S=k,C})}n.latch=h;function u(_,w){return[n.filter(_,w),n.filter(_,y=>!w(y))]}n.split=u;function d(_,w=!1,y=[]){let S=y.slice(),k=_(E=>{S?S.push(E):D.fire(E)});const C=()=>{S&&S.forEach(E=>D.fire(E)),S=null},D=new H({onFirstListenerAdd(){k||(k=_(E=>D.fire(E)))},onFirstListenerDidAdd(){S&&(w?setTimeout(C):C())},onLastListenerRemove(){k&&k.dispose(),k=null}});return D.event}n.buffer=d;class f{constructor(w){this.event=w}map(w){return new f(t(this.event,w))}forEach(w){return new f(i(this.event,w))}filter(w){return new f(r(this.event,w))}reduce(w,y){return new f(a(this.event,w,y))}latch(){return new f(h(this.event))}debounce(w,y=100,S=!1,k){return new f(c(this.event,w,y,S,k))}on(w,y,S){return this.event(w,y,S)}once(w,y,S){return e(this.event)(w,y,S)}}function g(_){return new f(_)}n.chain=g;function p(_,w,y=S=>S){const S=(...E)=>D.fire(y(...E)),k=()=>_.on(w,S),C=()=>_.removeListener(w,S),D=new H({onFirstListenerAdd:k,onLastListenerRemove:C});return D.event}n.fromNodeEventEmitter=p;function m(_,w,y=S=>S){const S=(...E)=>D.fire(y(...E)),k=()=>_.addEventListener(w,S),C=()=>_.removeEventListener(w,S),D=new H({onFirstListenerAdd:k,onLastListenerRemove:C});return D.event}n.fromDOMEventEmitter=m;function b(_){return new Promise(w=>e(_)(w))}n.toPromise=b})(Re||(Re={}));class Uk{constructor(e){this._listenerCount=0,this._invocationCount=0,this._elapsedOverall=0,this._name=`${e}_${Uk._idPool++}`}start(e){this._stopWatch=new yh(!0),this._listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this._elapsedOverall+=e,this._invocationCount+=1,console.info(`did FIRE ${this._name}: elapsed_ms: ${e.toFixed(5)}, listener: ${this._listenerCount} (elapsed_overall: ${this._elapsedOverall.toFixed(2)}, invocations: ${this._invocationCount})`),this._stopWatch=void 0}}}Uk._idPool=0;let H=class{constructor(e){var t;this._disposed=!1,this._options=e,this._leakageMon=void 0,this._perfMon=!((t=this._options)===null||t===void 0)&&t._profName?new Uk(this._options._profName):void 0}get event(){return this._event||(this._event=(e,t,i)=>{var r;this._listeners||(this._listeners=new As);const s=this._listeners.isEmpty();s&&this._options&&this._options.onFirstListenerAdd&&this._options.onFirstListenerAdd(this);const o=this._listeners.push(t?[e,t]:e);s&&this._options&&this._options.onFirstListenerDidAdd&&this._options.onFirstListenerDidAdd(this),this._options&&this._options.onListenerDidAdd&&this._options.onListenerDidAdd(this,e,t);const a=(r=this._leakageMon)===null||r===void 0?void 0:r.check(this._listeners.size),l=Et(()=>{a&&a(),this._disposed||(o(),this._options&&this._options.onLastListenerRemove&&(this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this)))});return i instanceof ve?i.add(l):Array.isArray(i)&&i.push(l),l}),this._event}fire(e){var t,i;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new As);for(let r of this._listeners)this._deliveryQueue.push([r,e]);for((t=this._perfMon)===null||t===void 0||t.start(this._deliveryQueue.size);this._deliveryQueue.size>0;){const[r,s]=this._deliveryQueue.shift();try{typeof r=="function"?r.call(void 0,s):r[0].call(r[1],s)}catch(o){it(o)}}(i=this._perfMon)===null||i===void 0||i.stop()}}dispose(){var e,t,i,r,s;this._disposed||(this._disposed=!0,(e=this._listeners)===null||e===void 0||e.clear(),(t=this._deliveryQueue)===null||t===void 0||t.clear(),(r=(i=this._options)===null||i===void 0?void 0:i.onLastListenerRemove)===null||r===void 0||r.call(i),(s=this._leakageMon)===null||s===void 0||s.dispose())}};class fE extends H{constructor(e){super(e),this._isPaused=0,this._eventQueue=new As,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._listeners&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class DDe extends fE{constructor(e){var t;super(e),this._delay=(t=e.delay)!==null&&t!==void 0?t:100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class S3{constructor(){this.buffers=[]}wrapEvent(e){return(t,i,r)=>e(s=>{const o=this.buffers[this.buffers.length-1];o?o.push(()=>t.call(i,s)):t.call(i,s)},void 0,r)}bufferEvents(e){const t=[];this.buffers.push(t);const i=e();return this.buffers.pop(),t.forEach(r=>r()),i}}class UV{constructor(){this.listening=!1,this.inputEvent=Re.None,this.inputEventListener=re.None,this.emitter=new H({onFirstListenerDidAdd:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onLastListenerRemove:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const oQ=Object.freeze(function(n,e){const t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}});var ai;(function(n){function e(t){return t===n.None||t===n.Cancelled||t instanceof AS?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}n.isCancellationToken=e,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Re.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:oQ})})(ai||(ai={}));class AS{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?oQ:(this._emitter||(this._emitter=new H),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class rl{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new AS),this._token}cancel(){this._token?this._token instanceof AS&&this._token.cancel():this._token=ai.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener&&this._parentListener.dispose(),this._token?this._token instanceof AS&&this._token.dispose():this._token=ai.None}}class x3{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const NS=new x3,FR=new x3,OR=new x3,aQ=new Array(230),kDe=Object.create(null),LDe=Object.create(null),E3=[];for(let n=0;n<=193;n++)E3[n]=-1;(function(){const n="",e=[[0,1,0,"None",0,"unknown",0,"VK_UNKNOWN",n,n],[0,1,1,"Hyper",0,n,0,n,n,n],[0,1,2,"Super",0,n,0,n,n,n],[0,1,3,"Fn",0,n,0,n,n,n],[0,1,4,"FnLock",0,n,0,n,n,n],[0,1,5,"Suspend",0,n,0,n,n,n],[0,1,6,"Resume",0,n,0,n,n,n],[0,1,7,"Turbo",0,n,0,n,n,n],[0,1,8,"Sleep",0,n,0,"VK_SLEEP",n,n],[0,1,9,"WakeUp",0,n,0,n,n,n],[31,0,10,"KeyA",31,"A",65,"VK_A",n,n],[32,0,11,"KeyB",32,"B",66,"VK_B",n,n],[33,0,12,"KeyC",33,"C",67,"VK_C",n,n],[34,0,13,"KeyD",34,"D",68,"VK_D",n,n],[35,0,14,"KeyE",35,"E",69,"VK_E",n,n],[36,0,15,"KeyF",36,"F",70,"VK_F",n,n],[37,0,16,"KeyG",37,"G",71,"VK_G",n,n],[38,0,17,"KeyH",38,"H",72,"VK_H",n,n],[39,0,18,"KeyI",39,"I",73,"VK_I",n,n],[40,0,19,"KeyJ",40,"J",74,"VK_J",n,n],[41,0,20,"KeyK",41,"K",75,"VK_K",n,n],[42,0,21,"KeyL",42,"L",76,"VK_L",n,n],[43,0,22,"KeyM",43,"M",77,"VK_M",n,n],[44,0,23,"KeyN",44,"N",78,"VK_N",n,n],[45,0,24,"KeyO",45,"O",79,"VK_O",n,n],[46,0,25,"KeyP",46,"P",80,"VK_P",n,n],[47,0,26,"KeyQ",47,"Q",81,"VK_Q",n,n],[48,0,27,"KeyR",48,"R",82,"VK_R",n,n],[49,0,28,"KeyS",49,"S",83,"VK_S",n,n],[50,0,29,"KeyT",50,"T",84,"VK_T",n,n],[51,0,30,"KeyU",51,"U",85,"VK_U",n,n],[52,0,31,"KeyV",52,"V",86,"VK_V",n,n],[53,0,32,"KeyW",53,"W",87,"VK_W",n,n],[54,0,33,"KeyX",54,"X",88,"VK_X",n,n],[55,0,34,"KeyY",55,"Y",89,"VK_Y",n,n],[56,0,35,"KeyZ",56,"Z",90,"VK_Z",n,n],[22,0,36,"Digit1",22,"1",49,"VK_1",n,n],[23,0,37,"Digit2",23,"2",50,"VK_2",n,n],[24,0,38,"Digit3",24,"3",51,"VK_3",n,n],[25,0,39,"Digit4",25,"4",52,"VK_4",n,n],[26,0,40,"Digit5",26,"5",53,"VK_5",n,n],[27,0,41,"Digit6",27,"6",54,"VK_6",n,n],[28,0,42,"Digit7",28,"7",55,"VK_7",n,n],[29,0,43,"Digit8",29,"8",56,"VK_8",n,n],[30,0,44,"Digit9",30,"9",57,"VK_9",n,n],[21,0,45,"Digit0",21,"0",48,"VK_0",n,n],[3,1,46,"Enter",3,"Enter",13,"VK_RETURN",n,n],[9,1,47,"Escape",9,"Escape",27,"VK_ESCAPE",n,n],[1,1,48,"Backspace",1,"Backspace",8,"VK_BACK",n,n],[2,1,49,"Tab",2,"Tab",9,"VK_TAB",n,n],[10,1,50,"Space",10,"Space",32,"VK_SPACE",n,n],[83,0,51,"Minus",83,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[81,0,52,"Equal",81,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[87,0,53,"BracketLeft",87,"[",219,"VK_OEM_4","[","OEM_4"],[89,0,54,"BracketRight",89,"]",221,"VK_OEM_6","]","OEM_6"],[88,0,55,"Backslash",88,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,0,56,"IntlHash",0,n,0,n,n,n],[80,0,57,"Semicolon",80,";",186,"VK_OEM_1",";","OEM_1"],[90,0,58,"Quote",90,"'",222,"VK_OEM_7","'","OEM_7"],[86,0,59,"Backquote",86,"`",192,"VK_OEM_3","`","OEM_3"],[82,0,60,"Comma",82,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[84,0,61,"Period",84,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[85,0,62,"Slash",85,"/",191,"VK_OEM_2","/","OEM_2"],[8,1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",n,n],[59,1,64,"F1",59,"F1",112,"VK_F1",n,n],[60,1,65,"F2",60,"F2",113,"VK_F2",n,n],[61,1,66,"F3",61,"F3",114,"VK_F3",n,n],[62,1,67,"F4",62,"F4",115,"VK_F4",n,n],[63,1,68,"F5",63,"F5",116,"VK_F5",n,n],[64,1,69,"F6",64,"F6",117,"VK_F6",n,n],[65,1,70,"F7",65,"F7",118,"VK_F7",n,n],[66,1,71,"F8",66,"F8",119,"VK_F8",n,n],[67,1,72,"F9",67,"F9",120,"VK_F9",n,n],[68,1,73,"F10",68,"F10",121,"VK_F10",n,n],[69,1,74,"F11",69,"F11",122,"VK_F11",n,n],[70,1,75,"F12",70,"F12",123,"VK_F12",n,n],[0,1,76,"PrintScreen",0,n,0,n,n,n],[79,1,77,"ScrollLock",79,"ScrollLock",145,"VK_SCROLL",n,n],[7,1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",n,n],[19,1,79,"Insert",19,"Insert",45,"VK_INSERT",n,n],[14,1,80,"Home",14,"Home",36,"VK_HOME",n,n],[11,1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",n,n],[20,1,82,"Delete",20,"Delete",46,"VK_DELETE",n,n],[13,1,83,"End",13,"End",35,"VK_END",n,n],[12,1,84,"PageDown",12,"PageDown",34,"VK_NEXT",n,n],[17,1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",n],[15,1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",n],[18,1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",n],[16,1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",n],[78,1,89,"NumLock",78,"NumLock",144,"VK_NUMLOCK",n,n],[108,1,90,"NumpadDivide",108,"NumPad_Divide",111,"VK_DIVIDE",n,n],[103,1,91,"NumpadMultiply",103,"NumPad_Multiply",106,"VK_MULTIPLY",n,n],[106,1,92,"NumpadSubtract",106,"NumPad_Subtract",109,"VK_SUBTRACT",n,n],[104,1,93,"NumpadAdd",104,"NumPad_Add",107,"VK_ADD",n,n],[3,1,94,"NumpadEnter",3,n,0,n,n,n],[94,1,95,"Numpad1",94,"NumPad1",97,"VK_NUMPAD1",n,n],[95,1,96,"Numpad2",95,"NumPad2",98,"VK_NUMPAD2",n,n],[96,1,97,"Numpad3",96,"NumPad3",99,"VK_NUMPAD3",n,n],[97,1,98,"Numpad4",97,"NumPad4",100,"VK_NUMPAD4",n,n],[98,1,99,"Numpad5",98,"NumPad5",101,"VK_NUMPAD5",n,n],[99,1,100,"Numpad6",99,"NumPad6",102,"VK_NUMPAD6",n,n],[100,1,101,"Numpad7",100,"NumPad7",103,"VK_NUMPAD7",n,n],[101,1,102,"Numpad8",101,"NumPad8",104,"VK_NUMPAD8",n,n],[102,1,103,"Numpad9",102,"NumPad9",105,"VK_NUMPAD9",n,n],[93,1,104,"Numpad0",93,"NumPad0",96,"VK_NUMPAD0",n,n],[107,1,105,"NumpadDecimal",107,"NumPad_Decimal",110,"VK_DECIMAL",n,n],[92,0,106,"IntlBackslash",92,"OEM_102",226,"VK_OEM_102",n,n],[58,1,107,"ContextMenu",58,"ContextMenu",93,n,n,n],[0,1,108,"Power",0,n,0,n,n,n],[0,1,109,"NumpadEqual",0,n,0,n,n,n],[71,1,110,"F13",71,"F13",124,"VK_F13",n,n],[72,1,111,"F14",72,"F14",125,"VK_F14",n,n],[73,1,112,"F15",73,"F15",126,"VK_F15",n,n],[74,1,113,"F16",74,"F16",127,"VK_F16",n,n],[75,1,114,"F17",75,"F17",128,"VK_F17",n,n],[76,1,115,"F18",76,"F18",129,"VK_F18",n,n],[77,1,116,"F19",77,"F19",130,"VK_F19",n,n],[0,1,117,"F20",0,n,0,"VK_F20",n,n],[0,1,118,"F21",0,n,0,"VK_F21",n,n],[0,1,119,"F22",0,n,0,"VK_F22",n,n],[0,1,120,"F23",0,n,0,"VK_F23",n,n],[0,1,121,"F24",0,n,0,"VK_F24",n,n],[0,1,122,"Open",0,n,0,n,n,n],[0,1,123,"Help",0,n,0,n,n,n],[0,1,124,"Select",0,n,0,n,n,n],[0,1,125,"Again",0,n,0,n,n,n],[0,1,126,"Undo",0,n,0,n,n,n],[0,1,127,"Cut",0,n,0,n,n,n],[0,1,128,"Copy",0,n,0,n,n,n],[0,1,129,"Paste",0,n,0,n,n,n],[0,1,130,"Find",0,n,0,n,n,n],[0,1,131,"AudioVolumeMute",112,"AudioVolumeMute",173,"VK_VOLUME_MUTE",n,n],[0,1,132,"AudioVolumeUp",113,"AudioVolumeUp",175,"VK_VOLUME_UP",n,n],[0,1,133,"AudioVolumeDown",114,"AudioVolumeDown",174,"VK_VOLUME_DOWN",n,n],[105,1,134,"NumpadComma",105,"NumPad_Separator",108,"VK_SEPARATOR",n,n],[110,0,135,"IntlRo",110,"ABNT_C1",193,"VK_ABNT_C1",n,n],[0,1,136,"KanaMode",0,n,0,n,n,n],[0,0,137,"IntlYen",0,n,0,n,n,n],[0,1,138,"Convert",0,n,0,n,n,n],[0,1,139,"NonConvert",0,n,0,n,n,n],[0,1,140,"Lang1",0,n,0,n,n,n],[0,1,141,"Lang2",0,n,0,n,n,n],[0,1,142,"Lang3",0,n,0,n,n,n],[0,1,143,"Lang4",0,n,0,n,n,n],[0,1,144,"Lang5",0,n,0,n,n,n],[0,1,145,"Abort",0,n,0,n,n,n],[0,1,146,"Props",0,n,0,n,n,n],[0,1,147,"NumpadParenLeft",0,n,0,n,n,n],[0,1,148,"NumpadParenRight",0,n,0,n,n,n],[0,1,149,"NumpadBackspace",0,n,0,n,n,n],[0,1,150,"NumpadMemoryStore",0,n,0,n,n,n],[0,1,151,"NumpadMemoryRecall",0,n,0,n,n,n],[0,1,152,"NumpadMemoryClear",0,n,0,n,n,n],[0,1,153,"NumpadMemoryAdd",0,n,0,n,n,n],[0,1,154,"NumpadMemorySubtract",0,n,0,n,n,n],[0,1,155,"NumpadClear",0,n,0,n,n,n],[0,1,156,"NumpadClearEntry",0,n,0,n,n,n],[5,1,0,n,5,"Ctrl",17,"VK_CONTROL",n,n],[4,1,0,n,4,"Shift",16,"VK_SHIFT",n,n],[6,1,0,n,6,"Alt",18,"VK_MENU",n,n],[57,1,0,n,57,"Meta",0,"VK_COMMAND",n,n],[5,1,157,"ControlLeft",5,n,0,"VK_LCONTROL",n,n],[4,1,158,"ShiftLeft",4,n,0,"VK_LSHIFT",n,n],[6,1,159,"AltLeft",6,n,0,"VK_LMENU",n,n],[57,1,160,"MetaLeft",57,n,0,"VK_LWIN",n,n],[5,1,161,"ControlRight",5,n,0,"VK_RCONTROL",n,n],[4,1,162,"ShiftRight",4,n,0,"VK_RSHIFT",n,n],[6,1,163,"AltRight",6,n,0,"VK_RMENU",n,n],[57,1,164,"MetaRight",57,n,0,"VK_RWIN",n,n],[0,1,165,"BrightnessUp",0,n,0,n,n,n],[0,1,166,"BrightnessDown",0,n,0,n,n,n],[0,1,167,"MediaPlay",0,n,0,n,n,n],[0,1,168,"MediaRecord",0,n,0,n,n,n],[0,1,169,"MediaFastForward",0,n,0,n,n,n],[0,1,170,"MediaRewind",0,n,0,n,n,n],[114,1,171,"MediaTrackNext",119,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",n,n],[115,1,172,"MediaTrackPrevious",120,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",n,n],[116,1,173,"MediaStop",121,"MediaStop",178,"VK_MEDIA_STOP",n,n],[0,1,174,"Eject",0,n,0,n,n,n],[117,1,175,"MediaPlayPause",122,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",n,n],[0,1,176,"MediaSelect",123,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",n,n],[0,1,177,"LaunchMail",124,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",n,n],[0,1,178,"LaunchApp2",125,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",n,n],[0,1,179,"LaunchApp1",0,n,0,"VK_MEDIA_LAUNCH_APP1",n,n],[0,1,180,"SelectTask",0,n,0,n,n,n],[0,1,181,"LaunchScreenSaver",0,n,0,n,n,n],[0,1,182,"BrowserSearch",115,"BrowserSearch",170,"VK_BROWSER_SEARCH",n,n],[0,1,183,"BrowserHome",116,"BrowserHome",172,"VK_BROWSER_HOME",n,n],[112,1,184,"BrowserBack",117,"BrowserBack",166,"VK_BROWSER_BACK",n,n],[113,1,185,"BrowserForward",118,"BrowserForward",167,"VK_BROWSER_FORWARD",n,n],[0,1,186,"BrowserStop",0,n,0,"VK_BROWSER_STOP",n,n],[0,1,187,"BrowserRefresh",0,n,0,"VK_BROWSER_REFRESH",n,n],[0,1,188,"BrowserFavorites",0,n,0,"VK_BROWSER_FAVORITES",n,n],[0,1,189,"ZoomToggle",0,n,0,n,n,n],[0,1,190,"MailReply",0,n,0,n,n,n],[0,1,191,"MailForward",0,n,0,n,n,n],[0,1,192,"MailSend",0,n,0,n,n,n],[109,1,0,n,109,"KeyInComposition",229,n,n,n],[111,1,0,n,111,"ABNT_C2",194,"VK_ABNT_C2",n,n],[91,1,0,n,91,"OEM_8",223,"VK_OEM_8",n,n],[0,1,0,n,0,n,0,"VK_CLEAR",n,n],[0,1,0,n,0,n,0,"VK_KANA",n,n],[0,1,0,n,0,n,0,"VK_HANGUL",n,n],[0,1,0,n,0,n,0,"VK_JUNJA",n,n],[0,1,0,n,0,n,0,"VK_FINAL",n,n],[0,1,0,n,0,n,0,"VK_HANJA",n,n],[0,1,0,n,0,n,0,"VK_KANJI",n,n],[0,1,0,n,0,n,0,"VK_CONVERT",n,n],[0,1,0,n,0,n,0,"VK_NONCONVERT",n,n],[0,1,0,n,0,n,0,"VK_ACCEPT",n,n],[0,1,0,n,0,n,0,"VK_MODECHANGE",n,n],[0,1,0,n,0,n,0,"VK_SELECT",n,n],[0,1,0,n,0,n,0,"VK_PRINT",n,n],[0,1,0,n,0,n,0,"VK_EXECUTE",n,n],[0,1,0,n,0,n,0,"VK_SNAPSHOT",n,n],[0,1,0,n,0,n,0,"VK_HELP",n,n],[0,1,0,n,0,n,0,"VK_APPS",n,n],[0,1,0,n,0,n,0,"VK_PROCESSKEY",n,n],[0,1,0,n,0,n,0,"VK_PACKET",n,n],[0,1,0,n,0,n,0,"VK_DBE_SBCSCHAR",n,n],[0,1,0,n,0,n,0,"VK_DBE_DBCSCHAR",n,n],[0,1,0,n,0,n,0,"VK_ATTN",n,n],[0,1,0,n,0,n,0,"VK_CRSEL",n,n],[0,1,0,n,0,n,0,"VK_EXSEL",n,n],[0,1,0,n,0,n,0,"VK_EREOF",n,n],[0,1,0,n,0,n,0,"VK_PLAY",n,n],[0,1,0,n,0,n,0,"VK_ZOOM",n,n],[0,1,0,n,0,n,0,"VK_NONAME",n,n],[0,1,0,n,0,n,0,"VK_PA1",n,n],[0,1,0,n,0,n,0,"VK_OEM_CLEAR",n,n]];let t=[],i=[];for(const r of e){const[s,o,a,l,c,h,u,d,f,g]=r;if(i[a]||(i[a]=!0,kDe[l]=a,LDe[l.toLowerCase()]=a,o&&(E3[a]=c)),!t[c]){if(t[c]=!0,!h)throw new Error(`String representation missing for key code ${c} around scan code ${l}`);NS.define(c,h),FR.define(c,f||h),OR.define(c,g||f||h)}u&&(aQ[u]=c)}})();var lf;(function(n){function e(a){return NS.keyCodeToStr(a)}n.toString=e;function t(a){return NS.strToKeyCode(a)}n.fromString=t;function i(a){return FR.keyCodeToStr(a)}n.toUserSettingsUS=i;function r(a){return OR.keyCodeToStr(a)}n.toUserSettingsGeneral=r;function s(a){return FR.strToKeyCode(a)||OR.strToKeyCode(a)}n.fromUserSettings=s;function o(a){if(a>=93&&a<=108)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return NS.keyCodeToStr(a)}n.toElectronAccelerator=o})(lf||(lf={}));function qr(n,e){const t=(e&65535)<<16>>>0;return(n|t)>>>0}let Sm;if(typeof hi.vscode<"u"&&typeof hi.vscode.process<"u"){const n=hi.vscode.process;Sm={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()},nextTick(e){return AR(e)}}}else typeof process<"u"?Sm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()},nextTick(n){return process.nextTick(n)}}:Sm={get platform(){return Kn?"win32":wt?"darwin":"linux"},get arch(){},nextTick(n){return AR(n)},get env(){return{}},cwd(){return"/"}};const PR=Sm.cwd,IDe=Sm.env,Vg=Sm.platform,TDe=65,ADe=97,NDe=90,RDe=122,Su=46,tr=47,bs=92,Oh=58,MDe=63;class lQ extends Error{constructor(e,t,i){let r;typeof t=="string"&&t.indexOf("not ")===0?(r="must not be",t=t.replace(/^not /,"")):r="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${r} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function bn(n,e){if(typeof n!="string")throw new lQ(e,"string",n)}function kt(n){return n===tr||n===bs}function BR(n){return n===tr}function Ph(n){return n>=TDe&&n<=NDe||n>=ADe&&n<=RDe}function gE(n,e,t,i){let r="",s=0,o=-1,a=0,l=0;for(let c=0;c<=n.length;++c){if(c<n.length)l=n.charCodeAt(c);else{if(i(l))break;l=tr}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==Su||r.charCodeAt(r.length-2)!==Su){if(r.length>2){const h=r.lastIndexOf(t);h===-1?(r="",s=0):(r=r.slice(0,h),s=r.length-1-r.lastIndexOf(t)),o=c,a=0;continue}else if(r.length!==0){r="",s=0,o=c,a=0;continue}}e&&(r+=r.length>0?`${t}..`:"..",s=2)}else r.length>0?r+=`${t}${n.slice(o+1,c)}`:r=n.slice(o+1,c),s=c-o-1;o=c,a=0}else l===Su&&a!==-1?++a:a=-1}return r}function cQ(n,e){if(e===null||typeof e!="object")throw new lQ("pathObject","Object",e);const t=e.dir||e.root,i=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${i}`:`${t}${n}${i}`:i}const ls={resolve(...n){let e="",t="",i=!1;for(let r=n.length-1;r>=-1;r--){let s;if(r>=0){if(s=n[r],bn(s,"path"),s.length===0)continue}else e.length===0?s=PR():(s=IDe[`=${e}`]||PR(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===bs)&&(s=`${e}\\`));const o=s.length;let a=0,l="",c=!1;const h=s.charCodeAt(0);if(o===1)kt(h)&&(a=1,c=!0);else if(kt(h))if(c=!0,kt(s.charCodeAt(1))){let u=2,d=u;for(;u<o&&!kt(s.charCodeAt(u));)u++;if(u<o&&u!==d){const f=s.slice(d,u);for(d=u;u<o&&kt(s.charCodeAt(u));)u++;if(u<o&&u!==d){for(d=u;u<o&&!kt(s.charCodeAt(u));)u++;(u===o||u!==d)&&(l=`\\\\${f}\\${s.slice(d,u)}`,a=u)}}}else a=1;else Ph(h)&&s.charCodeAt(1)===Oh&&(l=s.slice(0,2),a=2,o>2&&kt(s.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=gE(t,!i,"\\",kt),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){bn(n,"path");const e=n.length;if(e===0)return".";let t=0,i,r=!1;const s=n.charCodeAt(0);if(e===1)return BR(s)?"\\":n;if(kt(s))if(r=!0,kt(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!kt(n.charCodeAt(a));)a++;if(a<e&&a!==l){const c=n.slice(l,a);for(l=a;a<e&&kt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!kt(n.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${n.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${n.slice(l,a)}`,t=a)}}}else t=1;else Ph(s)&&n.charCodeAt(1)===Oh&&(i=n.slice(0,2),t=2,e>2&&kt(n.charCodeAt(2))&&(r=!0,t=3));let o=t<e?gE(n.slice(t),!r,"\\",kt):"";return o.length===0&&!r&&(o="."),o.length>0&&kt(n.charCodeAt(e-1))&&(o+="\\"),i===void 0?r?`\\${o}`:o:r?`${i}\\${o}`:`${i}${o}`},isAbsolute(n){bn(n,"path");const e=n.length;if(e===0)return!1;const t=n.charCodeAt(0);return kt(t)||e>2&&Ph(t)&&n.charCodeAt(1)===Oh&&kt(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let s=0;s<n.length;++s){const o=n[s];bn(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,r=0;if(typeof t=="string"&&kt(t.charCodeAt(0))){++r;const s=t.length;s>1&&kt(t.charCodeAt(1))&&(++r,s>2&&(kt(t.charCodeAt(2))?++r:i=!1))}if(i){for(;r<e.length&&kt(e.charCodeAt(r));)r++;r>=2&&(e=`\\${e.slice(r)}`)}return ls.normalize(e)},relative(n,e){if(bn(n,"from"),bn(e,"to"),n===e)return"";const t=ls.resolve(n),i=ls.resolve(e);if(t===i||(n=t.toLowerCase(),e=i.toLowerCase(),n===e))return"";let r=0;for(;r<n.length&&n.charCodeAt(r)===bs;)r++;let s=n.length;for(;s-1>r&&n.charCodeAt(s-1)===bs;)s--;const o=s-r;let a=0;for(;a<e.length&&e.charCodeAt(a)===bs;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===bs;)l--;const c=l-a,h=o<c?o:c;let u=-1,d=0;for(;d<h;d++){const g=n.charCodeAt(r+d);if(g!==e.charCodeAt(a+d))break;g===bs&&(u=d)}if(d!==h){if(u===-1)return i}else{if(c>h){if(e.charCodeAt(a+d)===bs)return i.slice(a+d+1);if(d===2)return i.slice(a+d)}o>h&&(n.charCodeAt(r+d)===bs?u=d:d===2&&(u=3)),u===-1&&(u=0)}let f="";for(d=r+u+1;d<=s;++d)(d===s||n.charCodeAt(d)===bs)&&(f+=f.length===0?"..":"\\..");return a+=u,f.length>0?`${f}${i.slice(a,l)}`:(i.charCodeAt(a)===bs&&++a,i.slice(a,l))},toNamespacedPath(n){if(typeof n!="string")return n;if(n.length===0)return"";const e=ls.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===bs){if(e.charCodeAt(1)===bs){const t=e.charCodeAt(2);if(t!==MDe&&t!==Su)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Ph(e.charCodeAt(0))&&e.charCodeAt(1)===Oh&&e.charCodeAt(2)===bs)return`\\\\?\\${e}`;return n},dirname(n){bn(n,"path");const e=n.length;if(e===0)return".";let t=-1,i=0;const r=n.charCodeAt(0);if(e===1)return kt(r)?n:".";if(kt(r)){if(t=i=1,kt(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!kt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&kt(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!kt(n.charCodeAt(a));)a++;if(a===e)return n;a!==l&&(t=i=a+1)}}}}else Ph(r)&&n.charCodeAt(1)===Oh&&(t=e>2&&kt(n.charCodeAt(2))?3:2,i=t);let s=-1,o=!0;for(let a=e-1;a>=i;--a)if(kt(n.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return n.slice(0,s)},basename(n,e){e!==void 0&&bn(e,"ext"),bn(n,"path");let t=0,i=-1,r=!0,s;if(n.length>=2&&Ph(n.charCodeAt(0))&&n.charCodeAt(1)===Oh&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=t;--s){const l=n.charCodeAt(s);if(kt(l)){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=t;--s)if(kt(n.charCodeAt(s))){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){bn(n,"path");let e=0,t=-1,i=0,r=-1,s=!0,o=0;n.length>=2&&n.charCodeAt(1)===Oh&&Ph(n.charCodeAt(0))&&(e=i=2);for(let a=n.length-1;a>=e;--a){const l=n.charCodeAt(a);if(kt(l)){if(!s){i=a+1;break}continue}r===-1&&(s=!1,r=a+1),l===Su?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||r===-1||o===0||o===1&&t===r-1&&t===i+1?"":n.slice(t,r)},format:cQ.bind(null,"\\"),parse(n){bn(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.length;let i=0,r=n.charCodeAt(0);if(t===1)return kt(r)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(kt(r)){if(i=1,kt(n.charCodeAt(1))){let u=2,d=u;for(;u<t&&!kt(n.charCodeAt(u));)u++;if(u<t&&u!==d){for(d=u;u<t&&kt(n.charCodeAt(u));)u++;if(u<t&&u!==d){for(d=u;u<t&&!kt(n.charCodeAt(u));)u++;u===t?i=u:u!==d&&(i=u+1)}}}}else if(Ph(r)&&n.charCodeAt(1)===Oh){if(t<=2)return e.root=e.dir=n,e;if(i=2,kt(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;i=3}}i>0&&(e.root=n.slice(0,i));let s=-1,o=i,a=-1,l=!0,c=n.length-1,h=0;for(;c>=i;--c){if(r=n.charCodeAt(c),kt(r)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===Su?s===-1?s=c:h!==1&&(h=1):s!==-1&&(h=-1)}return a!==-1&&(s===-1||h===0||h===1&&s===a-1&&s===o+1?e.base=e.name=n.slice(o,a):(e.name=n.slice(o,s),e.base=n.slice(o,a),e.ext=n.slice(s,a))),o>0&&o!==i?e.dir=n.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},hn={resolve(...n){let e="",t=!1;for(let i=n.length-1;i>=-1&&!t;i--){const r=i>=0?n[i]:PR();bn(r,"path"),r.length!==0&&(e=`${r}/${e}`,t=r.charCodeAt(0)===tr)}return e=gE(e,!t,"/",BR),t?`/${e}`:e.length>0?e:"."},normalize(n){if(bn(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===tr,t=n.charCodeAt(n.length-1)===tr;return n=gE(n,!e,"/",BR),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return bn(n,"path"),n.length>0&&n.charCodeAt(0)===tr},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];bn(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":hn.normalize(e)},relative(n,e){if(bn(n,"from"),bn(e,"to"),n===e||(n=hn.resolve(n),e=hn.resolve(e),n===e))return"";const t=1,i=n.length,r=i-t,s=1,o=e.length-s,a=r<o?r:o;let l=-1,c=0;for(;c<a;c++){const u=n.charCodeAt(t+c);if(u!==e.charCodeAt(s+c))break;u===tr&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(s+c)===tr)return e.slice(s+c+1);if(c===0)return e.slice(s+c)}else r>a&&(n.charCodeAt(t+c)===tr?l=c:c===0&&(l=0));let h="";for(c=t+l+1;c<=i;++c)(c===i||n.charCodeAt(c)===tr)&&(h+=h.length===0?"..":"/..");return`${h}${e.slice(s+l)}`},toNamespacedPath(n){return n},dirname(n){if(bn(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===tr;let t=-1,i=!0;for(let r=n.length-1;r>=1;--r)if(n.charCodeAt(r)===tr){if(!i){t=r;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&bn(e,"ext"),bn(n,"path");let t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){const l=n.charCodeAt(s);if(l===tr){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===tr){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){bn(n,"path");let e=-1,t=0,i=-1,r=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===tr){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===Su?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},format:cQ.bind(null,"/"),parse(n){bn(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.charCodeAt(0)===tr;let i;t?(e.root="/",i=1):i=0;let r=-1,s=0,o=-1,a=!0,l=n.length-1,c=0;for(;l>=i;--l){const h=n.charCodeAt(l);if(h===tr){if(!a){s=l+1;break}continue}o===-1&&(a=!1,o=l+1),h===Su?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}if(o!==-1){const h=s===0&&t?1:s;r===-1||c===0||c===1&&r===o-1&&r===s+1?e.base=e.name=n.slice(h,o):(e.name=n.slice(h,r),e.base=n.slice(h,o),e.ext=n.slice(r,o))}return s>0?e.dir=n.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};hn.win32=ls.win32=ls;hn.posix=ls.posix=hn;const D3=Vg==="win32"?ls.normalize:hn.normalize,FDe=Vg==="win32"?ls.resolve:hn.resolve,ODe=Vg==="win32"?ls.relative:hn.relative,hQ=Vg==="win32"?ls.dirname:hn.dirname,Ef=Vg==="win32"?ls.basename:hn.basename,PDe=Vg==="win32"?ls.extname:hn.extname,RS=Vg==="win32"?ls.sep:hn.sep,BDe=/^\w[\w\d+.-]*$/,VDe=/^\//,WDe=/^\/\//;function jV(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!BDe.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!VDe.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(WDe.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function $De(n,e){return!n&&!e?"file":n}function zDe(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==Sa&&(e=Sa+e):e=Sa;break}return e}const xi="",Sa="/",HDe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class qe{constructor(e,t,i,r,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||xi,this.authority=e.authority||xi,this.path=e.path||xi,this.query=e.query||xi,this.fragment=e.fragment||xi):(this.scheme=$De(e,o),this.authority=t||xi,this.path=zDe(this.scheme,i||xi),this.query=r||xi,this.fragment=s||xi,jV(this,o))}static isUri(e){return e instanceof qe?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}get fsPath(){return pE(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:r,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=xi),i===void 0?i=this.authority:i===null&&(i=xi),r===void 0?r=this.path:r===null&&(r=xi),s===void 0?s=this.query:s===null&&(s=xi),o===void 0?o=this.fragment:o===null&&(o=xi),t===this.scheme&&i===this.authority&&r===this.path&&s===this.query&&o===this.fragment?this:new _p(t,i,r,s,o)}static parse(e,t=!1){const i=HDe.exec(e);return i?new _p(i[2]||xi,dC(i[4]||xi),dC(i[5]||xi),dC(i[7]||xi),dC(i[9]||xi),t):new _p(xi,xi,xi,xi,xi)}static file(e){let t=xi;if(Kn&&(e=e.replace(/\\/g,Sa)),e[0]===Sa&&e[1]===Sa){const i=e.indexOf(Sa,2);i===-1?(t=e.substring(2),e=Sa):(t=e.substring(2,i),e=e.substring(i)||Sa)}return new _p("file",t,e,xi,xi)}static from(e){const t=new _p(e.scheme,e.authority,e.path,e.query,e.fragment);return jV(t,!0),t}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return Kn&&e.scheme==="file"?i=qe.file(ls.join(pE(e,!0),...t)).path:i=hn.join(e.path,...t),e.with({path:i})}toString(e=!1){return VR(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof qe)return e;{const t=new _p(e);return t._formatted=e.external,t._fsPath=e._sep===uQ?e.fsPath:null,t}}else return e}}const uQ=Kn?1:void 0;class _p extends qe{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=pE(this,!1)),this._fsPath}toString(e=!1){return e?VR(this,!0):(this._formatted||(this._formatted=VR(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=uQ),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const dQ={[58]:"%3A",[47]:"%2F",[63]:"%3F",[35]:"%23",[91]:"%5B",[93]:"%5D",[64]:"%40",[33]:"%21",[36]:"%24",[38]:"%26",[39]:"%27",[40]:"%28",[41]:"%29",[42]:"%2A",[43]:"%2B",[44]:"%2C",[59]:"%3B",[61]:"%3D",[32]:"%20"};function qV(n,e){let t,i=-1;for(let r=0;r<n.length;r++){const s=n.charCodeAt(r);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||s===45||s===46||s===95||s===126||e&&s===47)i!==-1&&(t+=encodeURIComponent(n.substring(i,r)),i=-1),t!==void 0&&(t+=n.charAt(r));else{t===void 0&&(t=n.substr(0,r));const o=dQ[s];o!==void 0?(i!==-1&&(t+=encodeURIComponent(n.substring(i,r)),i=-1),t+=o):i===-1&&(i=r)}}return i!==-1&&(t+=encodeURIComponent(n.substring(i))),t!==void 0?t:n}function UDe(n){let e;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i===35||i===63?(e===void 0&&(e=n.substr(0,t)),e+=dQ[i]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function pE(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,Kn&&(t=t.replace(/\//g,"\\")),t}function VR(n,e){const t=e?UDe:qV;let i="",{scheme:r,authority:s,path:o,query:a,fragment:l}=n;if(r&&(i+=r,i+=":"),(s||r==="file")&&(i+=Sa,i+=Sa),s){let c=s.indexOf("@");if(c!==-1){const h=s.substr(0,c);s=s.substr(c+1),c=h.indexOf(":"),c===-1?i+=t(h,!1):(i+=t(h.substr(0,c),!1),i+=":",i+=t(h.substr(c+1),!1)),i+="@"}s=s.toLowerCase(),c=s.indexOf(":"),c===-1?i+=t(s,!1):(i+=t(s.substr(0,c),!1),i+=s.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const c=o.charCodeAt(1);c>=65&&c<=90&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const c=o.charCodeAt(0);c>=65&&c<=90&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0)}return a&&(i+="?",i+=t(a,!1)),l&&(i+="#",i+=e?l:qV(l,!1)),i}function fQ(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+fQ(n.substr(3)):n}}const GV=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function dC(n){return n.match(GV)?n.replace(GV,e=>fQ(e)):n}class G{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new G(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return G.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return G.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return G.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let i=e.lineNumber|0,r=t.lineNumber|0;if(i===r){let s=e.column|0,o=t.column|0;return s-o}return i-r}clone(){return new G(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new G(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}}let V=class er{constructor(e,t,i,r){e>i||e===i&&t>r?(this.startLineNumber=i,this.startColumn=r,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r)}isEmpty(){return er.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return er.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}containsRange(e){return er.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return er.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return er.plusRange(this,e)}static plusRange(e,t){let i,r,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,r=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,r=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,r=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new er(i,r,s,o)}intersectRanges(e){return er.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn,a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,h=t.endColumn;return i<a?(i=a,r=l):i===a&&(r=Math.max(r,l)),s>c?(s=c,o=h):s===c&&(o=Math.min(o,h)),i>s||i===s&&r>o?null:new er(i,r,s,o)}equalsRange(e){return er.equalsRange(this,e)}static equalsRange(e,t){return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return er.getEndPosition(this)}static getEndPosition(e){return new G(e.endLineNumber,e.endColumn)}getStartPosition(){return er.getStartPosition(this)}static getStartPosition(e){return new G(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new er(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new er(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return er.collapseToStart(this)}static collapseToStart(e){return new er(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}static fromPositions(e,t=e){return new er(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new er(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,h=t.endLineNumber|0;if(c===h){const u=e.endColumn|0,d=t.endColumn|0;return u-d}return c-h}return a-l}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}};class je extends V{constructor(e,t,i,r){super(e,t,i,r),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return je.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new je(this.startLineNumber,this.startColumn,e,t):new je(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new G(this.positionLineNumber,this.positionColumn)}setStartPosition(e,t){return this.getDirection()===0?new je(e,t,this.endLineNumber,this.endColumn):new je(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new je(e.lineNumber,e.column,t.lineNumber,t.column)}static liftSelection(e){return new je(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,r,s){return s===0?new je(e,t,i,r):new je(i,r,e,t)}}let jk=class{constructor(e,t,i){this._tokenBrand=void 0,this.offset=e|0,this.type=t,this.language=i}toString(){return"("+this.offset+", "+this.type+")"}};class k3{constructor(e,t){this._tokenizationResultBrand=void 0,this.tokens=e,this.endState=t}}class qk{constructor(e,t){this._tokenizationResult2Brand=void 0,this.tokens=e,this.endState=t}}var WR;(function(n){n[n.Unknown=0]="Unknown",n[n.Disabled=1]="Disabled",n[n.Enabled=2]="Enabled"})(WR||(WR={}));var $R;(function(n){n[n.KeepWhitespace=1]="KeepWhitespace",n[n.InsertAsSnippet=4]="InsertAsSnippet"})($R||($R={}));var zR;(function(n){n[n.Method=0]="Method",n[n.Function=1]="Function",n[n.Constructor=2]="Constructor",n[n.Field=3]="Field",n[n.Variable=4]="Variable",n[n.Class=5]="Class",n[n.Struct=6]="Struct",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Event=10]="Event",n[n.Operator=11]="Operator",n[n.Unit=12]="Unit",n[n.Value=13]="Value",n[n.Constant=14]="Constant",n[n.Enum=15]="Enum",n[n.EnumMember=16]="EnumMember",n[n.Keyword=17]="Keyword",n[n.Text=18]="Text",n[n.Color=19]="Color",n[n.File=20]="File",n[n.Reference=21]="Reference",n[n.Customcolor=22]="Customcolor",n[n.Folder=23]="Folder",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue",n[n.Snippet=27]="Snippet"})(zR||(zR={}));var HR;(function(n){n[n.Deprecated=1]="Deprecated"})(HR||(HR={}));var UR;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(UR||(UR={}));var jR;(function(n){n[n.EXACT=0]="EXACT",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(jR||(jR={}));var qR;(function(n){n[n.NotSet=0]="NotSet",n[n.ContentFlush=1]="ContentFlush",n[n.RecoverFromMarkers=2]="RecoverFromMarkers",n[n.Explicit=3]="Explicit",n[n.Paste=4]="Paste",n[n.Undo=5]="Undo",n[n.Redo=6]="Redo"})(qR||(qR={}));var GR;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(GR||(GR={}));var KR;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(KR||(KR={}));var ZR;(function(n){n[n.None=0]="None",n[n.Keep=1]="Keep",n[n.Brackets=2]="Brackets",n[n.Advanced=3]="Advanced",n[n.Full=4]="Full"})(ZR||(ZR={}));var YR;(function(n){n[n.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",n[n.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",n[n.accessibilitySupport=2]="accessibilitySupport",n[n.accessibilityPageSize=3]="accessibilityPageSize",n[n.ariaLabel=4]="ariaLabel",n[n.autoClosingBrackets=5]="autoClosingBrackets",n[n.autoClosingDelete=6]="autoClosingDelete",n[n.autoClosingOvertype=7]="autoClosingOvertype",n[n.autoClosingQuotes=8]="autoClosingQuotes",n[n.autoIndent=9]="autoIndent",n[n.automaticLayout=10]="automaticLayout",n[n.autoSurround=11]="autoSurround",n[n.bracketPairColorization=12]="bracketPairColorization",n[n.guides=13]="guides",n[n.codeLens=14]="codeLens",n[n.codeLensFontFamily=15]="codeLensFontFamily",n[n.codeLensFontSize=16]="codeLensFontSize",n[n.colorDecorators=17]="colorDecorators",n[n.columnSelection=18]="columnSelection",n[n.comments=19]="comments",n[n.contextmenu=20]="contextmenu",n[n.copyWithSyntaxHighlighting=21]="copyWithSyntaxHighlighting",n[n.cursorBlinking=22]="cursorBlinking",n[n.cursorSmoothCaretAnimation=23]="cursorSmoothCaretAnimation",n[n.cursorStyle=24]="cursorStyle",n[n.cursorSurroundingLines=25]="cursorSurroundingLines",n[n.cursorSurroundingLinesStyle=26]="cursorSurroundingLinesStyle",n[n.cursorWidth=27]="cursorWidth",n[n.disableLayerHinting=28]="disableLayerHinting",n[n.disableMonospaceOptimizations=29]="disableMonospaceOptimizations",n[n.domReadOnly=30]="domReadOnly",n[n.dragAndDrop=31]="dragAndDrop",n[n.emptySelectionClipboard=32]="emptySelectionClipboard",n[n.extraEditorClassName=33]="extraEditorClassName",n[n.fastScrollSensitivity=34]="fastScrollSensitivity",n[n.find=35]="find",n[n.fixedOverflowWidgets=36]="fixedOverflowWidgets",n[n.folding=37]="folding",n[n.foldingStrategy=38]="foldingStrategy",n[n.foldingHighlight=39]="foldingHighlight",n[n.foldingImportsByDefault=40]="foldingImportsByDefault",n[n.unfoldOnClickAfterEndOfLine=41]="unfoldOnClickAfterEndOfLine",n[n.fontFamily=42]="fontFamily",n[n.fontInfo=43]="fontInfo",n[n.fontLigatures=44]="fontLigatures",n[n.fontSize=45]="fontSize",n[n.fontWeight=46]="fontWeight",n[n.formatOnPaste=47]="formatOnPaste",n[n.formatOnType=48]="formatOnType",n[n.glyphMargin=49]="glyphMargin",n[n.gotoLocation=50]="gotoLocation",n[n.hideCursorInOverviewRuler=51]="hideCursorInOverviewRuler",n[n.hover=52]="hover",n[n.inDiffEditor=53]="inDiffEditor",n[n.inlineSuggest=54]="inlineSuggest",n[n.letterSpacing=55]="letterSpacing",n[n.lightbulb=56]="lightbulb",n[n.lineDecorationsWidth=57]="lineDecorationsWidth",n[n.lineHeight=58]="lineHeight",n[n.lineNumbers=59]="lineNumbers",n[n.lineNumbersMinChars=60]="lineNumbersMinChars",n[n.linkedEditing=61]="linkedEditing",n[n.links=62]="links",n[n.matchBrackets=63]="matchBrackets",n[n.minimap=64]="minimap",n[n.mouseStyle=65]="mouseStyle",n[n.mouseWheelScrollSensitivity=66]="mouseWheelScrollSensitivity",n[n.mouseWheelZoom=67]="mouseWheelZoom",n[n.multiCursorMergeOverlapping=68]="multiCursorMergeOverlapping",n[n.multiCursorModifier=69]="multiCursorModifier",n[n.multiCursorPaste=70]="multiCursorPaste",n[n.occurrencesHighlight=71]="occurrencesHighlight",n[n.overviewRulerBorder=72]="overviewRulerBorder",n[n.overviewRulerLanes=73]="overviewRulerLanes",n[n.padding=74]="padding",n[n.parameterHints=75]="parameterHints",n[n.peekWidgetDefaultFocus=76]="peekWidgetDefaultFocus",n[n.definitionLinkOpensInPeek=77]="definitionLinkOpensInPeek",n[n.quickSuggestions=78]="quickSuggestions",n[n.quickSuggestionsDelay=79]="quickSuggestionsDelay",n[n.readOnly=80]="readOnly",n[n.renameOnType=81]="renameOnType",n[n.renderControlCharacters=82]="renderControlCharacters",n[n.renderFinalNewline=83]="renderFinalNewline",n[n.renderLineHighlight=84]="renderLineHighlight",n[n.renderLineHighlightOnlyWhenFocus=85]="renderLineHighlightOnlyWhenFocus",n[n.renderValidationDecorations=86]="renderValidationDecorations",n[n.renderWhitespace=87]="renderWhitespace",n[n.revealHorizontalRightPadding=88]="revealHorizontalRightPadding",n[n.roundedSelection=89]="roundedSelection",n[n.rulers=90]="rulers",n[n.scrollbar=91]="scrollbar",n[n.scrollBeyondLastColumn=92]="scrollBeyondLastColumn",n[n.scrollBeyondLastLine=93]="scrollBeyondLastLine",n[n.scrollPredominantAxis=94]="scrollPredominantAxis",n[n.selectionClipboard=95]="selectionClipboard",n[n.selectionHighlight=96]="selectionHighlight",n[n.selectOnLineNumbers=97]="selectOnLineNumbers",n[n.showFoldingControls=98]="showFoldingControls",n[n.showUnused=99]="showUnused",n[n.snippetSuggestions=100]="snippetSuggestions",n[n.smartSelect=101]="smartSelect",n[n.smoothScrolling=102]="smoothScrolling",n[n.stickyTabStops=103]="stickyTabStops",n[n.stopRenderingLineAfter=104]="stopRenderingLineAfter",n[n.suggest=105]="suggest",n[n.suggestFontSize=106]="suggestFontSize",n[n.suggestLineHeight=107]="suggestLineHeight",n[n.suggestOnTriggerCharacters=108]="suggestOnTriggerCharacters",n[n.suggestSelection=109]="suggestSelection",n[n.tabCompletion=110]="tabCompletion",n[n.tabIndex=111]="tabIndex",n[n.unusualLineTerminators=112]="unusualLineTerminators",n[n.useShadowDOM=113]="useShadowDOM",n[n.useTabStops=114]="useTabStops",n[n.wordSeparators=115]="wordSeparators",n[n.wordWrap=116]="wordWrap",n[n.wordWrapBreakAfterCharacters=117]="wordWrapBreakAfterCharacters",n[n.wordWrapBreakBeforeCharacters=118]="wordWrapBreakBeforeCharacters",n[n.wordWrapColumn=119]="wordWrapColumn",n[n.wordWrapOverride1=120]="wordWrapOverride1",n[n.wordWrapOverride2=121]="wordWrapOverride2",n[n.wrappingIndent=122]="wrappingIndent",n[n.wrappingStrategy=123]="wrappingStrategy",n[n.showDeprecated=124]="showDeprecated",n[n.inlayHints=125]="inlayHints",n[n.editorClassName=126]="editorClassName",n[n.pixelRatio=127]="pixelRatio",n[n.tabFocusMode=128]="tabFocusMode",n[n.layoutInfo=129]="layoutInfo",n[n.wrappingInfo=130]="wrappingInfo"})(YR||(YR={}));var XR;(function(n){n[n.TextDefined=0]="TextDefined",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(XR||(XR={}));var QR;(function(n){n[n.LF=0]="LF",n[n.CRLF=1]="CRLF"})(QR||(QR={}));var JR;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(JR||(JR={}));var eM;(function(n){n[n.Other=0]="Other",n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(eM||(eM={}));var tM;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(tM||(tM={}));var iM;(function(n){n[n.DependsOnKbLayout=-1]="DependsOnKbLayout",n[n.Unknown=0]="Unknown",n[n.Backspace=1]="Backspace",n[n.Tab=2]="Tab",n[n.Enter=3]="Enter",n[n.Shift=4]="Shift",n[n.Ctrl=5]="Ctrl",n[n.Alt=6]="Alt",n[n.PauseBreak=7]="PauseBreak",n[n.CapsLock=8]="CapsLock",n[n.Escape=9]="Escape",n[n.Space=10]="Space",n[n.PageUp=11]="PageUp",n[n.PageDown=12]="PageDown",n[n.End=13]="End",n[n.Home=14]="Home",n[n.LeftArrow=15]="LeftArrow",n[n.UpArrow=16]="UpArrow",n[n.RightArrow=17]="RightArrow",n[n.DownArrow=18]="DownArrow",n[n.Insert=19]="Insert",n[n.Delete=20]="Delete",n[n.Digit0=21]="Digit0",n[n.Digit1=22]="Digit1",n[n.Digit2=23]="Digit2",n[n.Digit3=24]="Digit3",n[n.Digit4=25]="Digit4",n[n.Digit5=26]="Digit5",n[n.Digit6=27]="Digit6",n[n.Digit7=28]="Digit7",n[n.Digit8=29]="Digit8",n[n.Digit9=30]="Digit9",n[n.KeyA=31]="KeyA",n[n.KeyB=32]="KeyB",n[n.KeyC=33]="KeyC",n[n.KeyD=34]="KeyD",n[n.KeyE=35]="KeyE",n[n.KeyF=36]="KeyF",n[n.KeyG=37]="KeyG",n[n.KeyH=38]="KeyH",n[n.KeyI=39]="KeyI",n[n.KeyJ=40]="KeyJ",n[n.KeyK=41]="KeyK",n[n.KeyL=42]="KeyL",n[n.KeyM=43]="KeyM",n[n.KeyN=44]="KeyN",n[n.KeyO=45]="KeyO",n[n.KeyP=46]="KeyP",n[n.KeyQ=47]="KeyQ",n[n.KeyR=48]="KeyR",n[n.KeyS=49]="KeyS",n[n.KeyT=50]="KeyT",n[n.KeyU=51]="KeyU",n[n.KeyV=52]="KeyV",n[n.KeyW=53]="KeyW",n[n.KeyX=54]="KeyX",n[n.KeyY=55]="KeyY",n[n.KeyZ=56]="KeyZ",n[n.Meta=57]="Meta",n[n.ContextMenu=58]="ContextMenu",n[n.F1=59]="F1",n[n.F2=60]="F2",n[n.F3=61]="F3",n[n.F4=62]="F4",n[n.F5=63]="F5",n[n.F6=64]="F6",n[n.F7=65]="F7",n[n.F8=66]="F8",n[n.F9=67]="F9",n[n.F10=68]="F10",n[n.F11=69]="F11",n[n.F12=70]="F12",n[n.F13=71]="F13",n[n.F14=72]="F14",n[n.F15=73]="F15",n[n.F16=74]="F16",n[n.F17=75]="F17",n[n.F18=76]="F18",n[n.F19=77]="F19",n[n.NumLock=78]="NumLock",n[n.ScrollLock=79]="ScrollLock",n[n.Semicolon=80]="Semicolon",n[n.Equal=81]="Equal",n[n.Comma=82]="Comma",n[n.Minus=83]="Minus",n[n.Period=84]="Period",n[n.Slash=85]="Slash",n[n.Backquote=86]="Backquote",n[n.BracketLeft=87]="BracketLeft",n[n.Backslash=88]="Backslash",n[n.BracketRight=89]="BracketRight",n[n.Quote=90]="Quote",n[n.OEM_8=91]="OEM_8",n[n.IntlBackslash=92]="IntlBackslash",n[n.Numpad0=93]="Numpad0",n[n.Numpad1=94]="Numpad1",n[n.Numpad2=95]="Numpad2",n[n.Numpad3=96]="Numpad3",n[n.Numpad4=97]="Numpad4",n[n.Numpad5=98]="Numpad5",n[n.Numpad6=99]="Numpad6",n[n.Numpad7=100]="Numpad7",n[n.Numpad8=101]="Numpad8",n[n.Numpad9=102]="Numpad9",n[n.NumpadMultiply=103]="NumpadMultiply",n[n.NumpadAdd=104]="NumpadAdd",n[n.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",n[n.NumpadSubtract=106]="NumpadSubtract",n[n.NumpadDecimal=107]="NumpadDecimal",n[n.NumpadDivide=108]="NumpadDivide",n[n.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",n[n.ABNT_C1=110]="ABNT_C1",n[n.ABNT_C2=111]="ABNT_C2",n[n.AudioVolumeMute=112]="AudioVolumeMute",n[n.AudioVolumeUp=113]="AudioVolumeUp",n[n.AudioVolumeDown=114]="AudioVolumeDown",n[n.BrowserSearch=115]="BrowserSearch",n[n.BrowserHome=116]="BrowserHome",n[n.BrowserBack=117]="BrowserBack",n[n.BrowserForward=118]="BrowserForward",n[n.MediaTrackNext=119]="MediaTrackNext",n[n.MediaTrackPrevious=120]="MediaTrackPrevious",n[n.MediaStop=121]="MediaStop",n[n.MediaPlayPause=122]="MediaPlayPause",n[n.LaunchMediaPlayer=123]="LaunchMediaPlayer",n[n.LaunchMail=124]="LaunchMail",n[n.LaunchApp2=125]="LaunchApp2",n[n.MAX_VALUE=126]="MAX_VALUE"})(iM||(iM={}));var nM;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(nM||(nM={}));var rM;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(rM||(rM={}));var sM;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(sM||(sM={}));var oM;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.TEXTAREA=1]="TEXTAREA",n[n.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",n[n.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",n[n.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",n[n.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",n[n.CONTENT_TEXT=6]="CONTENT_TEXT",n[n.CONTENT_EMPTY=7]="CONTENT_EMPTY",n[n.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",n[n.CONTENT_WIDGET=9]="CONTENT_WIDGET",n[n.OVERVIEW_RULER=10]="OVERVIEW_RULER",n[n.SCROLLBAR=11]="SCROLLBAR",n[n.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",n[n.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(oM||(oM={}));var aM;(function(n){n[n.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",n[n.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",n[n.TOP_CENTER=2]="TOP_CENTER"})(aM||(aM={}));var lM;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(lM||(lM={}));var cM;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval",n[n.Custom=4]="Custom"})(cM||(cM={}));var hM;(function(n){n[n.None=0]="None",n[n.Text=1]="Text",n[n.Blocks=2]="Blocks"})(hM||(hM={}));var uM;(function(n){n[n.Smooth=0]="Smooth",n[n.Immediate=1]="Immediate"})(uM||(uM={}));var dM;(function(n){n[n.Auto=1]="Auto",n[n.Hidden=2]="Hidden",n[n.Visible=3]="Visible"})(dM||(dM={}));var fM;(function(n){n[n.LTR=0]="LTR",n[n.RTL=1]="RTL"})(fM||(fM={}));var gM;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(gM||(gM={}));var pM;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(pM||(pM={}));var mM;(function(n){n[n.Deprecated=1]="Deprecated"})(mM||(mM={}));var _M;(function(n){n[n.Hidden=0]="Hidden",n[n.Blink=1]="Blink",n[n.Smooth=2]="Smooth",n[n.Phase=3]="Phase",n[n.Expand=4]="Expand",n[n.Solid=5]="Solid"})(_M||(_M={}));var bM;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(bM||(bM={}));var vM;(function(n){n[n.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",n[n.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",n[n.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",n[n.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(vM||(vM={}));var wM;(function(n){n[n.None=0]="None",n[n.Same=1]="Same",n[n.Indent=2]="Indent",n[n.DeepIndent=3]="DeepIndent"})(wM||(wM={}));class uy{static chord(e,t){return qr(e,t)}}uy.CtrlCmd=2048;uy.Shift=1024;uy.Alt=512;uy.WinCtrl=256;function gQ(){return{editor:void 0,languages:void 0,CancellationTokenSource:rl,Emitter:H,KeyCode:iM,KeyMod:uy,Position:G,Range:V,Selection:je,SelectionDirection:fM,MarkerSeverity:nM,MarkerTag:rM,Uri:qe,Token:jk}}var Ia;(function(n){n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=e})(Ia||(Ia={}));const Kt=Dt("instantiationService");function pQ(n,e,t,i){e[Ia.DI_TARGET]===e?e[Ia.DI_DEPENDENCIES].push({id:n,index:t,optional:i}):(e[Ia.DI_DEPENDENCIES]=[{id:n,index:t,optional:i}],e[Ia.DI_TARGET]=e)}function Dt(n){if(Ia.serviceIds.has(n))return Ia.serviceIds.get(n);const e=function(t,i,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");pQ(e,t,r,!1)};return e.toString=()=>n,Ia.serviceIds.set(n,e),e}function jDe(n){return function(e,t,i){if(arguments.length!==3)throw new Error("@optional-decorator can only be used to decorate a parameter");pQ(n,e,i,!0)}}const ui=Dt("codeEditorService");class ng{constructor(){this._zoomLevel=0,this._lastZoomLevelChangeTime=0,this._onDidChangeZoomLevel=new H,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this._zoomFactor=1}getZoomLevel(){return this._zoomLevel}getTimeSinceLastZoomLevelChanged(){return Date.now()-this._lastZoomLevelChangeTime}getZoomFactor(){return this._zoomFactor}getPixelRatio(){let e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}}ng.INSTANCE=new ng;function yM(){return ng.INSTANCE.getZoomLevel()}function qDe(){return ng.INSTANCE.getTimeSinceLastZoomLevelChanged()}function mQ(n){return ng.INSTANCE.onDidChangeZoomLevel(n)}function GDe(){return ng.INSTANCE.getZoomFactor()}function mE(){return ng.INSTANCE.getPixelRatio()}const dy=navigator.userAgent,$r=dy.indexOf("Firefox")>=0,Df=dy.indexOf("AppleWebKit")>=0,_E=dy.indexOf("Chrome")>=0,Yo=!_E&&dy.indexOf("Safari")>=0,KDe=!_E&&!Yo&&Df,vb=dy.indexOf("Android")>=0,_Q=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches,Gk={clipboard:{writeText:ym||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:ym||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:(()=>ym||_Q?0:navigator.keyboard||Yo?1:2)(),touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)};function CM(n,e){if(n===0)return null;const t=(n&65535)>>>0,i=(n&4294901760)>>>16;return i!==0?new bE([JI(t,e),JI(i,e)]):new bE([JI(t,e)])}function JI(n,e){const t=!!(n&2048),i=!!(n&256),r=e===2?i:t,s=!!(n&1024),o=!!(n&512),a=e===2?t:i,l=n&255;return new rg(r,s,o,a,l)}class rg{constructor(e,t,i,r,s){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=r,this.keyCode=s}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toChord(){return new bE([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class bE{constructor(e){if(e.length===0)throw Zl("parts");this.parts=e}}class ZDe{constructor(e,t,i,r,s,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=r,this.keyLabel=s,this.keyAriaLabel=o}}class YDe{}function XDe(n){if(n.charCode){let t=String.fromCharCode(n.charCode).toUpperCase();return lf.fromString(t)}const e=n.keyCode;if(e===3)return 7;if($r){if(e===59)return 80;if(e===107)return 81;if(e===109)return 83;if(wt&&e===224)return 57}else if(Df){if(e===91)return 57;if(wt&&e===93)return 57;if(!wt&&e===92)return 57}return aQ[e]||0}const QDe=wt?256:2048,JDe=512,eke=1024,tke=wt?2048:256;class bi{constructor(e){this._standardKeyboardEventBrand=!0;let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.keyCode=XDe(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asRuntimeKeybinding=this._computeRuntimeKeybinding()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeybinding(){return this._asRuntimeKeybinding}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=QDe),this.altKey&&(t|=JDe),this.shiftKey&&(t|=eke),this.metaKey&&(t|=tke),t|=e,t}_computeRuntimeKeybinding(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new rg(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let SM=!1,bp=null;function ike(n){if(!n.parent||n.parent===n)return null;try{let e=n.location,t=n.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return SM=!0,null}catch{return SM=!0,null}return n.parent}class xM{static getSameOriginWindowChain(){if(!bp){bp=[];let e=window,t;do t=ike(e),t?bp.push({window:e,iframeElement:e.frameElement||null}):bp.push({window:e,iframeElement:null}),e=t;while(e)}return bp.slice(0)}static hasDifferentOriginAncestor(){return bp||this.getSameOriginWindowChain(),SM}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,r=0,s=this.getSameOriginWindowChain();for(const o of s){if(i+=o.window.scrollY,r+=o.window.scrollX,o.window===t||!o.iframeElement)break;let a=o.iframeElement.getBoundingClientRect();i+=a.top,r+=a.left}return{top:i,left:r}}}class oo{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=e.button===0,this.middleButton=e.button===1,this.rightButton=e.button===2,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,e.type==="dblclick"&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,typeof e.pageX=="number"?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);let t=xM.getPositionOfChildWindowRelativeToAncestorWindow(self,e.view);this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class __{constructor(e,t=0,i=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t,e){let r=e,s=e;if(typeof r.wheelDeltaY<"u")this.deltaY=r.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){const o=e;o.deltaMode===o.DOM_DELTA_LINE?$r&&!wt?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof r.wheelDeltaX<"u")Yo&&Kn?this.deltaX=-(r.wheelDeltaX/120):this.deltaX=r.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const o=e;o.deltaMode===o.DOM_DELTA_LINE?$r&&!wt?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation()}}var KV=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function nke(n){return!!n&&typeof n.then=="function"}function Hs(n){const e=new rl,t=n(e.token),i=new Promise((r,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),e.dispose(),s(g0())});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),r(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel()}then(r,s){return i.then(r,s)}catch(r){return this.then(void 0,r)}finally(r){return i.finally(r)}}}function bQ(n,e,t){return Promise.race([n,new Promise(i=>e.onCancellationRequested(()=>i(t)))])}class rke{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{this.queuedPromise=null;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(r=>{this.activePromise=null,t(r)},r=>{this.activePromise=null,i(r)})})}}class p0{constructor(e){this.defaultDelay=e,this.timeout=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,r)=>{this.doResolve=i,this.doReject=r}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const i=this.task;return this.task=null,i()}})),this.timeout=setTimeout(()=>{this.timeout=null,this.doResolve&&this.doResolve(null)},t),this.completionPromise}isTriggered(){return this.timeout!==null}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject&&this.doReject(g0()),this.completionPromise=null)}cancelTimeout(){this.timeout!==null&&(clearTimeout(this.timeout),this.timeout=null)}dispose(){this.cancel()}}class ske{constructor(e){this.delayer=new p0(e),this.throttler=new rke}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}dispose(){this.delayer.dispose()}}function dw(n,e){return e?new Promise((t,i)=>{const r=setTimeout(()=>{s.dispose(),t()},n),s=e.onCancellationRequested(()=>{clearTimeout(r),s.dispose(),i(g0())})}):Hs(t=>dw(n,t))}function b_(n,e=0){const t=setTimeout(n,e);return Et(()=>clearTimeout(t))}class Gr{constructor(e,t){this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class fy{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval(()=>{e()},t)}}class yi{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner&&this.runner()}}let EM;(function(){typeof requestIdleCallback!="function"||typeof cancelIdleCallback!="function"?EM=n=>{const e=setTimeout(()=>{const i=Date.now()+15;n(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0,clearTimeout(e))}}}:EM=(n,e)=>{const t=requestIdleCallback(n,typeof e=="number"?{timeout:e}:void 0);let i=!1;return{dispose(){i||(i=!0,cancelIdleCallback(t))}}}})();class Zb{constructor(e){this._didRun=!1,this._executor=()=>{try{this._value=e()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=EM(()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}var DM;(function(n){function e(i){return KV(this,void 0,void 0,function*(){let r;const s=yield Promise.all(i.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return s})}n.settled=e;function t(i){return new Promise((r,s)=>KV(this,void 0,void 0,function*(){try{yield i(r,s)}catch(o){s(o)}}))}n.withAsyncBody=t})(DM||(DM={}));var ft;(function(n){n.inMemory="inmemory",n.vscode="vscode",n.internal="private",n.walkThrough="walkThrough",n.walkThroughSnippet="walkThroughSnippet",n.http="http",n.https="https",n.file="file",n.mailto="mailto",n.untitled="untitled",n.data="data",n.command="command",n.vscodeRemote="vscode-remote",n.vscodeRemoteResource="vscode-remote-resource",n.userData="vscode-userdata",n.vscodeCustomEditor="vscode-custom-editor",n.vscodeNotebook="vscode-notebook",n.vscodeNotebookCell="vscode-notebook-cell",n.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",n.vscodeNotebookCellOutput="vscode-notebook-cell-output",n.vscodeInteractive="vscode-interactive",n.vscodeInteractiveInput="vscode-interactive-input",n.vscodeSettings="vscode-settings",n.vscodeWorkspaceTrust="vscode-workspace-trust",n.vscodeTerminal="vscode-terminal",n.webviewPanel="webview-panel",n.vscodeWebview="vscode-webview",n.extension="extension",n.vscodeFileResource="vscode-file",n.tmp="tmp"})(ft||(ft={}));class oke{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null}setPreferredWebSchema(e){this._preferredWebSchema=e}rewrite(e){if(this._delegate)return this._delegate(e);const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&(i=`[${i}]`);const r=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&tkn=${encodeURIComponent(s)}`),qe.from({scheme:hy?this._preferredWebSchema:ft.vscodeRemoteResource,authority:`${i}:${r}`,path:"/vscode-remote-resource",query:o})}}const vQ=new oke;class fw{asBrowserUri(e,t){const i=this.toUri(e,t);return i.scheme===ft.vscodeRemote?vQ.rewrite(i):i.scheme===ft.file&&(ym||typeof hi.importScripts=="function"&&hi.origin===`${ft.vscodeFileResource}://${fw.FALLBACK_AUTHORITY}`)?i.with({scheme:ft.vscodeFileResource,authority:i.authority||fw.FALLBACK_AUTHORITY,query:null,fragment:null}):i}toUri(e,t){return qe.isUri(e)?e:qe.parse(t.toUrl(e))}}fw.FALLBACK_AUTHORITY="vscode-app";const wQ=new fw;function Gn(n){for(;n.firstChild;)n.firstChild.remove()}function L3(n){var e;return(e=n==null?void 0:n.isConnected)!==null&&e!==void 0?e:!1}class ake{constructor(e,t,i,r){this._node=e,this._type=t,this._handler=i,this._options=r||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function ae(n,e,t,i){return new ake(n,e,t,i)}function yQ(n){return function(e){return n(new oo(e))}}function lke(n){return function(e){return n(new bi(e))}}let dn=function(e,t,i,r){let s=i;return t==="click"||t==="mousedown"?s=yQ(i):(t==="keydown"||t==="keypress"||t==="keyup")&&(s=lke(i)),ae(e,t,s,r)},cke=function(e,t,i){let r=yQ(t);return I3(e,r,i)};function I3(n,e,t){return ae(n,Hu&&Gk.pointerEvents?Me.POINTER_DOWN:Me.MOUSE_DOWN,e,t)}function CQ(n,e,t){return ae(n,Hu&&Gk.pointerEvents?Me.POINTER_UP:Me.MOUSE_UP,e,t)}function T3(n,e){return ae(n,"mouseout",t=>{let i=t.relatedTarget;for(;i&&i!==n;)i=i.parentNode;i!==n&&e(t)})}function hke(n,e){return ae(n,"pointerout",t=>{let i=t.relatedTarget;for(;i&&i!==n;)i=i.parentNode;i!==n&&e(t)})}let eT=null;function uke(n){if(!eT){const e=t=>setTimeout(()=>t(new Date().getTime()),0);eT=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||e}return eT.call(self,n)}let SQ,ic;class tT{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){it(e)}}static sort(e,t){return t.priority-e.priority}}(function(){let n=[],e=null,t=!1,i=!1,r=()=>{for(t=!1,e=n,n=[],i=!0;e.length>0;)e.sort(tT.sort),e.shift().execute();i=!1};ic=(s,o=0)=>{let a=new tT(s,o);return n.push(a),t||(t=!0,uke(r)),a},SQ=(s,o)=>{if(i){let a=new tT(s,o);return e.push(a),a}else return ic(s,o)}})();const dke=8,fke=function(n,e){return e};class gke extends re{constructor(e,t,i,r=fke,s=dke){super();let o=null,a=0,l=this._register(new Gr),c=()=>{a=new Date().getTime(),i(o),o=null};this._register(ae(e,t,h=>{o=r(o,h);let u=new Date().getTime()-a;u>=s?(l.cancel(),c()):l.setIfNotSet(c,s-u)}))}}function A3(n,e,t,i,r){return new gke(n,e,t,i,r)}function N3(n){return document.defaultView.getComputedStyle(n,null)}function Kk(n){if(n!==document.body)return new Gt(n.clientWidth,n.clientHeight);if(Hu&&window.visualViewport)return new Gt(window.visualViewport.width,window.visualViewport.height);if(window.innerWidth&&window.innerHeight)return new Gt(window.innerWidth,window.innerHeight);if(document.body&&document.body.clientWidth&&document.body.clientHeight)return new Gt(document.body.clientWidth,document.body.clientHeight);if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new Gt(document.documentElement.clientWidth,document.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class wi{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){let r=N3(e),s="0";return r&&(r.getPropertyValue?s=r.getPropertyValue(t):s=r.getAttribute(i)),wi.convertToPixels(e,s)}static getBorderLeftWidth(e){return wi.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return wi.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return wi.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return wi.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return wi.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return wi.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return wi.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return wi.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return wi.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return wi.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return wi.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return wi.getDimension(e,"margin-bottom","marginBottom")}}class Gt{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Gt(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof Gt?e:new Gt(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}}function xQ(n){let e=n.offsetParent,t=n.offsetTop,i=n.offsetLeft;for(;(n=n.parentNode)!==null&&n!==document.body&&n!==document.documentElement;){t-=n.scrollTop;const r=DQ(n)?null:N3(n);r&&(i-=r.direction!=="rtl"?n.scrollLeft:-n.scrollLeft),n===e&&(i+=wi.getBorderLeftWidth(n),t+=wi.getBorderTopWidth(n),t+=n.offsetTop,i+=n.offsetLeft,e=n.offsetParent)}return{left:i,top:t}}function pke(n,e,t){typeof e=="number"&&(n.style.width=`${e}px`),typeof t=="number"&&(n.style.height=`${t}px`)}function jn(n){let e=n.getBoundingClientRect();return{left:e.left+fh.scrollX,top:e.top+fh.scrollY,width:e.width,height:e.height}}const fh=new class{get scrollX(){return typeof window.scrollX=="number"?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft}get scrollY(){return typeof window.scrollY=="number"?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop}};function Lo(n){let e=wi.getMarginLeft(n)+wi.getMarginRight(n);return n.offsetWidth+e}function iT(n){let e=wi.getBorderLeftWidth(n)+wi.getBorderRightWidth(n),t=wi.getPaddingLeft(n)+wi.getPaddingRight(n);return n.offsetWidth-e-t}function mke(n){let e=wi.getBorderTopWidth(n)+wi.getBorderBottomWidth(n),t=wi.getPaddingTop(n)+wi.getPaddingBottom(n);return n.offsetHeight-e-t}function kM(n){let e=wi.getMarginTop(n)+wi.getMarginBottom(n);return n.offsetHeight+e}function Yl(n,e){for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function EQ(n,e,t){for(;n&&n.nodeType===n.ELEMENT_NODE;){if(n.classList.contains(e))return n;if(t){if(typeof t=="string"){if(n.classList.contains(t))return null}else if(n===t)return null}n=n.parentNode}return null}function ZV(n,e,t){return!!EQ(n,e,t)}function DQ(n){return n&&!!n.host&&!!n.mode}function R3(n){return!!m0(n)}function m0(n){for(;n.parentNode;){if(n===document.body)return null;n=n.parentNode}return DQ(n)?n:null}function xm(){let n=document.activeElement;for(;n!=null&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function ho(n=document.getElementsByTagName("head")[0]){let e=document.createElement("style");return e.type="text/css",e.media="screen",n.appendChild(e),e}let nT=null;function kQ(){return nT||(nT=ho()),nT}function _ke(n){var e,t;return!((e=n==null?void 0:n.sheet)===null||e===void 0)&&e.rules?n.sheet.rules:!((t=n==null?void 0:n.sheet)===null||t===void 0)&&t.cssRules?n.sheet.cssRules:[]}function LM(n,e,t=kQ()){!t||!e||t.sheet.insertRule(n+"{"+e+"}",0)}function vE(n,e=kQ()){if(!e)return;let t=_ke(e),i=[];for(let r=0;r<t.length;r++)t[r].selectorText.indexOf(n)!==-1&&i.push(r);for(let r=i.length-1;r>=0;r--)e.sheet.deleteRule(i[r])}function LQ(n){return typeof HTMLElement=="object"?n instanceof HTMLElement:n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"}const Me={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:Df?"webkitAnimationStart":"animationstart",ANIMATION_END:Df?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:Df?"webkitAnimationIteration":"animationiteration"},Ft={stop:function(n,e){n.preventDefault?n.preventDefault():n.returnValue=!1,e&&(n.stopPropagation?n.stopPropagation():n.cancelBubble=!0)}};function bke(n){let e=[];for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)e[t]=n.scrollTop,n=n.parentNode;return e}function vke(n,e){for(let t=0;n&&n.nodeType===n.ELEMENT_NODE;t++)n.scrollTop!==e[t]&&(n.scrollTop=e[t]),n=n.parentNode}class wke extends re{constructor(e){super(),this._onDidFocus=this._register(new H),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new H),this.onDidBlur=this._onDidBlur.event;let t=Yl(document.activeElement,e),i=!1;const r=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},s=()=>{t&&(i=!0,window.setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{Yl(document.activeElement,e)!==t&&(t?s():r())},this._register(ae(e,Me.FOCUS,r,!0)),this._register(ae(e,Me.BLUR,s,!0))}}function v_(n){return new wke(n)}function le(n,...e){if(n.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function yke(n,e){return n.insertBefore(e,n.firstChild),e}function gy(n,...e){n.innerText="",le(n,...e)}const Cke=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var gw;(function(n){n.HTML="http://www.w3.org/1999/xhtml",n.SVG="http://www.w3.org/2000/svg"})(gw||(gw={}));function IQ(n,e,t,...i){let r=Cke.exec(e);if(!r)throw new Error("Bad use of emmet");t=Object.assign({},t||{});let s=r[1]||"div",o;return n!==gw.HTML?o=document.createElementNS(n,s):o=document.createElement(s),r[3]&&(o.id=r[3]),r[4]&&(o.className=r[4].replace(/\./g," ").trim()),Object.keys(t).forEach(a=>{const l=t[a];typeof l>"u"||(/^on\w+$/.test(a)?o[a]=l:a==="selected"?l&&o.setAttribute(a,"true"):o.setAttribute(a,l))}),o.append(...i),o}function me(n,e,...t){return IQ(gw.HTML,n,e,...t)}me.SVG=function(n,e,...t){return IQ(gw.SVG,n,e,...t)};function Ss(...n){for(let e of n)e.style.display="",e.removeAttribute("aria-hidden")}function Or(...n){for(let e of n)e.style.display="none",e.setAttribute("aria-hidden","true")}function Ske(n){return Array.prototype.slice.call(document.getElementsByTagName(n),0)}function YV(n){const e=window.devicePixelRatio*n;return Math.max(1,Math.floor(e))/window.devicePixelRatio}function TQ(n){window.open(n,"_blank","noopener")}function xke(n){const e=()=>{n(),t=ic(e)};let t=ic(e);return Et(()=>t.dispose())}vQ.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");function Ch(n){return n?`url('${wQ.asBrowserUri(n).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function XV(n){return`'${n.replace(/'/g,"%27")}'`}class cf extends H{constructor(){super(),this._subscriptions=new ve,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(ae(window,"keydown",e=>{if(e.defaultPrevented)return;const t=new bi(e);if(!(t.keyCode===6&&e.repeat)){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(t.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}},!0)),this._subscriptions.add(ae(window,"keyup",e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))},!0)),this._subscriptions.add(ae(document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(ae(document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),this._subscriptions.add(ae(document.body,"mousemove",e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),this._subscriptions.add(ae(window,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return cf.instance||(cf.instance=new cf),cf.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}function Eke(n,e){const t=window.matchMedia(n);typeof t.addEventListener=="function"?t.addEventListener("change",e):t.addListener(e)}function AQ(n){return!n||typeof n!="string"?!0:n.trim().length===0}const Dke=/{(\d+)}/g;function No(n,...e){return e.length===0?n:n.replace(Dke,function(t,i){const r=parseInt(i,10);return isNaN(r)||r<0||r>=e.length?t:e[r]})}function M3(n){return n.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function ja(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function NQ(n,e){if(!n||!e)return n;const t=e.length;if(t===0||n.length===0)return n;let i=0;for(;n.indexOf(e,i)===i;)i=i+t;return n.substring(i)}function kke(n,e){if(!n||!e)return n;const t=e.length,i=n.length;if(t===0||i===0)return n;let r=i,s=-1;for(;s=n.lastIndexOf(e,r-1),!(s===-1||s+t!==r);){if(s===0)return"";r=s}return n.substring(0,r)}function Lke(n){return n.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function RQ(n,e,t={}){if(!n)throw new Error("Cannot create regex from empty string");e||(n=ja(n)),t.wholeWord&&(/\B/.test(n.charAt(0))||(n="\\b"+n),/\B/.test(n.charAt(n.length-1))||(n=n+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(n,i)}function Ike(n){return n.source==="^"||n.source==="^$"||n.source==="$"||n.source==="^\\s*$"?!1:!!(n.exec("")&&n.lastIndex===0)}function rT(n){return(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")}function nc(n){return n.split(/\r\n|\r|\n/)}function cs(n){for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function rn(n,e=0,t=n.length){for(let i=e;i<t;i++){const r=n.charCodeAt(i);if(r!==32&&r!==9)return n.substring(e,i)}return n.substring(e,t)}function _0(n,e=n.length-1){for(let t=e;t>=0;t--){const i=n.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function pw(n,e){return n<e?-1:n>e?1:0}function F3(n,e,t=0,i=n.length,r=0,s=e.length){for(;t<i&&r<s;t++,r++){let l=n.charCodeAt(t),c=e.charCodeAt(r);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=s-r;return o<a?-1:o>a?1:0}function IM(n,e){return py(n,e,0,n.length,0,e.length)}function py(n,e,t=0,i=n.length,r=0,s=e.length){for(;t<i&&r<s;t++,r++){let l=n.charCodeAt(t),c=e.charCodeAt(r);if(l===c)continue;if(l>=128||c>=128)return F3(n.toLowerCase(),e.toLowerCase(),t,i,r,s);Yp(l)&&(l-=32),Yp(c)&&(c-=32);const h=l-c;if(h!==0)return h}const o=i-t,a=s-r;return o<a?-1:o>a?1:0}function Yp(n){return n>=97&&n<=122}function Xh(n){return n>=65&&n<=90}function wb(n,e){return n.length===e.length&&py(n,e)===0}function O3(n,e){const t=e.length;return e.length>n.length?!1:py(n,e,0,t)===0}function mw(n,e){let t,i=Math.min(n.length,e.length);for(t=0;t<i;t++)if(n.charCodeAt(t)!==e.charCodeAt(t))return t;return i}function TM(n,e){let t,i=Math.min(n.length,e.length);const r=n.length-1,s=e.length-1;for(t=0;t<i;t++)if(n.charCodeAt(r-t)!==e.charCodeAt(s-t))return t;return i}function Ln(n){return 55296<=n&&n<=56319}function w_(n){return 56320<=n&&n<=57343}function P3(n,e){return(n-55296<<10)+(e-56320)+65536}function jc(n,e,t){const i=n.charCodeAt(t);if(Ln(i)&&t+1<e){const r=n.charCodeAt(t+1);if(w_(r))return P3(i,r)}return i}function Em(n,e){const t=n.charCodeAt(e-1);if(w_(t)&&e>1){const i=n.charCodeAt(e-2);if(Ln(i))return P3(i,t)}return t}function wE(n,e){const t=ch.getInstance(),i=e,r=n.length,s=jc(n,r,e);e+=s>=65536?2:1;let o=t.getGraphemeBreakType(s);for(;e<r;){const a=jc(n,r,e),l=t.getGraphemeBreakType(a);if(Xb(o,l))break;e+=a>=65536?2:1,o=l}return e-i}function Tke(n,e){const t=ch.getInstance(),i=e,r=Em(n,e);e-=r>=65536?2:1;let s=t.getGraphemeBreakType(r);for(;e>0;){const o=Em(n,e),a=t.getGraphemeBreakType(o);if(Xb(a,s))break;e-=o>=65536?2:1,s=a}return i-e}const Ake=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u08BD\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE33\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDCFF]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD50-\uDFFF]|\uD83B[\uDC00-\uDEBB])/;function Zk(n){return Ake.test(n)}const Nke=/(?:[\u231A\u231B\u23F0\u23F3\u2600-\u27BF\u2B50\u2B55]|\uD83C[\uDDE6-\uDDFF\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD00-\uDDFF\uDE70-\uDED6])/;function Rke(n){return Nke.test(n)}const Mke=/^[\t\n\r\x20-\x7E]*$/;function B3(n){return Mke.test(n)}const MQ=/[\u2028\u2029]/;function FQ(n){return MQ.test(n)}function Fke(n){for(let e=0,t=n.length;e<t;e++)if(Ra(n.charCodeAt(e)))return!0;return!1}function Ra(n){return n=+n,n>=11904&&n<=55215||n>=63744&&n<=64255||n>=65281&&n<=65374}function Yb(n){return n>=127462&&n<=127487||n===8986||n===8987||n===9200||n===9203||n>=9728&&n<=10175||n===11088||n===11093||n>=127744&&n<=128591||n>=128640&&n<=128764||n>=128992&&n<=129003||n>=129280&&n<=129535||n>=129648&&n<=129750}const Oke=String.fromCharCode(65279);function V3(n){return!!(n&&n.length>0&&n.charCodeAt(0)===65279)}function Pke(n,e=!1){return n?(e&&(n=n.replace(/\\./g,"")),n.toLowerCase()!==n):!1}function OQ(n){return n=n%(2*26),n<26?String.fromCharCode(97+n):String.fromCharCode(65+n-26)}function vp(n){return ch.getInstance().getGraphemeBreakType(n)}function Xb(n,e){return n===0?e!==5&&e!==7:n===2&&e===3?!1:n===4||n===2||n===3||e===4||e===2||e===3?!0:!(n===8&&(e===8||e===9||e===11||e===12)||(n===11||n===9)&&(e===9||e===10)||(n===12||n===10)&&e===10||e===5||e===13||e===7||n===1||n===13&&e===14||n===6&&e===6)}class ch{constructor(){this._data=Bke()}static getInstance(){return ch._INSTANCE||(ch._INSTANCE=new ch),ch._INSTANCE}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let r=1;for(;r<=i;)if(e<t[3*r])r=2*r;else if(e>t[3*r+1])r=2*r+1;else return t[3*r+2];return 0}}ch._INSTANCE=null;function Bke(){return JSON.parse("[0,0,0,51592,51592,11,44424,44424,11,72251,72254,5,7150,7150,7,48008,48008,11,55176,55176,11,128420,128420,14,3276,3277,5,9979,9980,14,46216,46216,11,49800,49800,11,53384,53384,11,70726,70726,5,122915,122916,5,129320,129327,14,2558,2558,5,5906,5908,5,9762,9763,14,43360,43388,8,45320,45320,11,47112,47112,11,48904,48904,11,50696,50696,11,52488,52488,11,54280,54280,11,70082,70083,1,71350,71350,7,73111,73111,5,127892,127893,14,128726,128727,14,129473,129474,14,2027,2035,5,2901,2902,5,3784,3789,5,6754,6754,5,8418,8420,5,9877,9877,14,11088,11088,14,44008,44008,5,44872,44872,11,45768,45768,11,46664,46664,11,47560,47560,11,48456,48456,11,49352,49352,11,50248,50248,11,51144,51144,11,52040,52040,11,52936,52936,11,53832,53832,11,54728,54728,11,69811,69814,5,70459,70460,5,71096,71099,7,71998,71998,5,72874,72880,5,119149,119149,7,127374,127374,14,128335,128335,14,128482,128482,14,128765,128767,14,129399,129400,14,129680,129685,14,1476,1477,5,2377,2380,7,2759,2760,5,3137,3140,7,3458,3459,7,4153,4154,5,6432,6434,5,6978,6978,5,7675,7679,5,9723,9726,14,9823,9823,14,9919,9923,14,10035,10036,14,42736,42737,5,43596,43596,5,44200,44200,11,44648,44648,11,45096,45096,11,45544,45544,11,45992,45992,11,46440,46440,11,46888,46888,11,47336,47336,11,47784,47784,11,48232,48232,11,48680,48680,11,49128,49128,11,49576,49576,11,50024,50024,11,50472,50472,11,50920,50920,11,51368,51368,11,51816,51816,11,52264,52264,11,52712,52712,11,53160,53160,11,53608,53608,11,54056,54056,11,54504,54504,11,54952,54952,11,68108,68111,5,69933,69940,5,70197,70197,7,70498,70499,7,70845,70845,5,71229,71229,5,71727,71735,5,72154,72155,5,72344,72345,5,73023,73029,5,94095,94098,5,121403,121452,5,126981,127182,14,127538,127546,14,127990,127990,14,128391,128391,14,128445,128449,14,128500,128505,14,128752,128752,14,129160,129167,14,129356,129356,14,129432,129442,14,129648,129651,14,129751,131069,14,173,173,4,1757,1757,1,2274,2274,1,2494,2494,5,2641,2641,5,2876,2876,5,3014,3016,7,3262,3262,7,3393,3396,5,3570,3571,7,3968,3972,5,4228,4228,7,6086,6086,5,6679,6680,5,6912,6915,5,7080,7081,5,7380,7392,5,8252,8252,14,9096,9096,14,9748,9749,14,9784,9786,14,9833,9850,14,9890,9894,14,9938,9938,14,9999,9999,14,10085,10087,14,12349,12349,14,43136,43137,7,43454,43456,7,43755,43755,7,44088,44088,11,44312,44312,11,44536,44536,11,44760,44760,11,44984,44984,11,45208,45208,11,45432,45432,11,45656,45656,11,45880,45880,11,46104,46104,11,46328,46328,11,46552,46552,11,46776,46776,11,47000,47000,11,47224,47224,11,47448,47448,11,47672,47672,11,47896,47896,11,48120,48120,11,48344,48344,11,48568,48568,11,48792,48792,11,49016,49016,11,49240,49240,11,49464,49464,11,49688,49688,11,49912,49912,11,50136,50136,11,50360,50360,11,50584,50584,11,50808,50808,11,51032,51032,11,51256,51256,11,51480,51480,11,51704,51704,11,51928,51928,11,52152,52152,11,52376,52376,11,52600,52600,11,52824,52824,11,53048,53048,11,53272,53272,11,53496,53496,11,53720,53720,11,53944,53944,11,54168,54168,11,54392,54392,11,54616,54616,11,54840,54840,11,55064,55064,11,65438,65439,5,69633,69633,5,69837,69837,1,70018,70018,7,70188,70190,7,70368,70370,7,70465,70468,7,70712,70719,5,70835,70840,5,70850,70851,5,71132,71133,5,71340,71340,7,71458,71461,5,71985,71989,7,72002,72002,7,72193,72202,5,72281,72283,5,72766,72766,7,72885,72886,5,73104,73105,5,92912,92916,5,113824,113827,4,119173,119179,5,121505,121519,5,125136,125142,5,127279,127279,14,127489,127490,14,127570,127743,14,127900,127901,14,128254,128254,14,128369,128370,14,128400,128400,14,128425,128432,14,128468,128475,14,128489,128494,14,128715,128720,14,128745,128745,14,128759,128760,14,129004,129023,14,129296,129304,14,129340,129342,14,129388,129392,14,129404,129407,14,129454,129455,14,129485,129487,14,129659,129663,14,129719,129727,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2363,2363,7,2402,2403,5,2507,2508,7,2622,2624,7,2691,2691,7,2786,2787,5,2881,2884,5,3006,3006,5,3072,3072,5,3170,3171,5,3267,3268,7,3330,3331,7,3406,3406,1,3538,3540,5,3655,3662,5,3897,3897,5,4038,4038,5,4184,4185,5,4352,4447,8,6068,6069,5,6155,6157,5,6448,6449,7,6742,6742,5,6783,6783,5,6966,6970,5,7042,7042,7,7143,7143,7,7212,7219,5,7412,7412,5,8206,8207,4,8294,8303,4,8596,8601,14,9410,9410,14,9742,9742,14,9757,9757,14,9770,9770,14,9794,9794,14,9828,9828,14,9855,9855,14,9882,9882,14,9900,9903,14,9929,9933,14,9963,9967,14,9987,9988,14,10006,10006,14,10062,10062,14,10175,10175,14,11744,11775,5,42607,42607,5,43043,43044,7,43263,43263,5,43444,43445,7,43569,43570,5,43698,43700,5,43766,43766,5,44032,44032,11,44144,44144,11,44256,44256,11,44368,44368,11,44480,44480,11,44592,44592,11,44704,44704,11,44816,44816,11,44928,44928,11,45040,45040,11,45152,45152,11,45264,45264,11,45376,45376,11,45488,45488,11,45600,45600,11,45712,45712,11,45824,45824,11,45936,45936,11,46048,46048,11,46160,46160,11,46272,46272,11,46384,46384,11,46496,46496,11,46608,46608,11,46720,46720,11,46832,46832,11,46944,46944,11,47056,47056,11,47168,47168,11,47280,47280,11,47392,47392,11,47504,47504,11,47616,47616,11,47728,47728,11,47840,47840,11,47952,47952,11,48064,48064,11,48176,48176,11,48288,48288,11,48400,48400,11,48512,48512,11,48624,48624,11,48736,48736,11,48848,48848,11,48960,48960,11,49072,49072,11,49184,49184,11,49296,49296,11,49408,49408,11,49520,49520,11,49632,49632,11,49744,49744,11,49856,49856,11,49968,49968,11,50080,50080,11,50192,50192,11,50304,50304,11,50416,50416,11,50528,50528,11,50640,50640,11,50752,50752,11,50864,50864,11,50976,50976,11,51088,51088,11,51200,51200,11,51312,51312,11,51424,51424,11,51536,51536,11,51648,51648,11,51760,51760,11,51872,51872,11,51984,51984,11,52096,52096,11,52208,52208,11,52320,52320,11,52432,52432,11,52544,52544,11,52656,52656,11,52768,52768,11,52880,52880,11,52992,52992,11,53104,53104,11,53216,53216,11,53328,53328,11,53440,53440,11,53552,53552,11,53664,53664,11,53776,53776,11,53888,53888,11,54000,54000,11,54112,54112,11,54224,54224,11,54336,54336,11,54448,54448,11,54560,54560,11,54672,54672,11,54784,54784,11,54896,54896,11,55008,55008,11,55120,55120,11,64286,64286,5,66272,66272,5,68900,68903,5,69762,69762,7,69817,69818,5,69927,69931,5,70003,70003,5,70070,70078,5,70094,70094,7,70194,70195,7,70206,70206,5,70400,70401,5,70463,70463,7,70475,70477,7,70512,70516,5,70722,70724,5,70832,70832,5,70842,70842,5,70847,70848,5,71088,71089,7,71102,71102,7,71219,71226,5,71231,71232,5,71342,71343,7,71453,71455,5,71463,71467,5,71737,71738,5,71995,71996,5,72000,72000,7,72145,72147,7,72160,72160,5,72249,72249,7,72273,72278,5,72330,72342,5,72752,72758,5,72850,72871,5,72882,72883,5,73018,73018,5,73031,73031,5,73109,73109,5,73461,73462,7,94031,94031,5,94192,94193,7,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,126976,126979,14,127184,127231,14,127344,127345,14,127405,127461,14,127514,127514,14,127561,127567,14,127778,127779,14,127896,127896,14,127985,127986,14,127995,127999,5,128326,128328,14,128360,128366,14,128378,128378,14,128394,128397,14,128405,128406,14,128422,128423,14,128435,128443,14,128453,128464,14,128479,128480,14,128484,128487,14,128496,128498,14,128640,128709,14,128723,128724,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129096,129103,14,129292,129292,14,129311,129311,14,129329,129330,14,129344,129349,14,129360,129374,14,129394,129394,14,129402,129402,14,129413,129425,14,129445,129450,14,129466,129471,14,129483,129483,14,129511,129535,14,129653,129655,14,129667,129670,14,129705,129711,14,129731,129743,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2307,2307,7,2366,2368,7,2382,2383,7,2434,2435,7,2497,2500,5,2519,2519,5,2563,2563,7,2631,2632,5,2677,2677,5,2750,2752,7,2763,2764,7,2817,2817,5,2879,2879,5,2891,2892,7,2914,2915,5,3008,3008,5,3021,3021,5,3076,3076,5,3146,3149,5,3202,3203,7,3264,3265,7,3271,3272,7,3298,3299,5,3390,3390,5,3402,3404,7,3426,3427,5,3535,3535,5,3544,3550,7,3635,3635,7,3763,3763,7,3893,3893,5,3953,3966,5,3981,3991,5,4145,4145,7,4157,4158,5,4209,4212,5,4237,4237,5,4520,4607,10,5970,5971,5,6071,6077,5,6089,6099,5,6277,6278,5,6439,6440,5,6451,6456,7,6683,6683,5,6744,6750,5,6765,6770,7,6846,6846,5,6964,6964,5,6972,6972,5,7019,7027,5,7074,7077,5,7083,7085,5,7146,7148,7,7154,7155,7,7222,7223,5,7394,7400,5,7416,7417,5,8204,8204,5,8233,8233,4,8288,8292,4,8413,8416,5,8482,8482,14,8986,8987,14,9193,9203,14,9654,9654,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9775,14,9792,9792,14,9800,9811,14,9825,9826,14,9831,9831,14,9852,9853,14,9872,9873,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9936,9936,14,9941,9960,14,9974,9974,14,9982,9985,14,9992,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10145,10145,14,11013,11015,14,11503,11505,5,12334,12335,5,12951,12951,14,42612,42621,5,43014,43014,5,43047,43047,7,43204,43205,5,43335,43345,5,43395,43395,7,43450,43451,7,43561,43566,5,43573,43574,5,43644,43644,5,43710,43711,5,43758,43759,7,44005,44005,5,44012,44012,7,44060,44060,11,44116,44116,11,44172,44172,11,44228,44228,11,44284,44284,11,44340,44340,11,44396,44396,11,44452,44452,11,44508,44508,11,44564,44564,11,44620,44620,11,44676,44676,11,44732,44732,11,44788,44788,11,44844,44844,11,44900,44900,11,44956,44956,11,45012,45012,11,45068,45068,11,45124,45124,11,45180,45180,11,45236,45236,11,45292,45292,11,45348,45348,11,45404,45404,11,45460,45460,11,45516,45516,11,45572,45572,11,45628,45628,11,45684,45684,11,45740,45740,11,45796,45796,11,45852,45852,11,45908,45908,11,45964,45964,11,46020,46020,11,46076,46076,11,46132,46132,11,46188,46188,11,46244,46244,11,46300,46300,11,46356,46356,11,46412,46412,11,46468,46468,11,46524,46524,11,46580,46580,11,46636,46636,11,46692,46692,11,46748,46748,11,46804,46804,11,46860,46860,11,46916,46916,11,46972,46972,11,47028,47028,11,47084,47084,11,47140,47140,11,47196,47196,11,47252,47252,11,47308,47308,11,47364,47364,11,47420,47420,11,47476,47476,11,47532,47532,11,47588,47588,11,47644,47644,11,47700,47700,11,47756,47756,11,47812,47812,11,47868,47868,11,47924,47924,11,47980,47980,11,48036,48036,11,48092,48092,11,48148,48148,11,48204,48204,11,48260,48260,11,48316,48316,11,48372,48372,11,48428,48428,11,48484,48484,11,48540,48540,11,48596,48596,11,48652,48652,11,48708,48708,11,48764,48764,11,48820,48820,11,48876,48876,11,48932,48932,11,48988,48988,11,49044,49044,11,49100,49100,11,49156,49156,11,49212,49212,11,49268,49268,11,49324,49324,11,49380,49380,11,49436,49436,11,49492,49492,11,49548,49548,11,49604,49604,11,49660,49660,11,49716,49716,11,49772,49772,11,49828,49828,11,49884,49884,11,49940,49940,11,49996,49996,11,50052,50052,11,50108,50108,11,50164,50164,11,50220,50220,11,50276,50276,11,50332,50332,11,50388,50388,11,50444,50444,11,50500,50500,11,50556,50556,11,50612,50612,11,50668,50668,11,50724,50724,11,50780,50780,11,50836,50836,11,50892,50892,11,50948,50948,11,51004,51004,11,51060,51060,11,51116,51116,11,51172,51172,11,51228,51228,11,51284,51284,11,51340,51340,11,51396,51396,11,51452,51452,11,51508,51508,11,51564,51564,11,51620,51620,11,51676,51676,11,51732,51732,11,51788,51788,11,51844,51844,11,51900,51900,11,51956,51956,11,52012,52012,11,52068,52068,11,52124,52124,11,52180,52180,11,52236,52236,11,52292,52292,11,52348,52348,11,52404,52404,11,52460,52460,11,52516,52516,11,52572,52572,11,52628,52628,11,52684,52684,11,52740,52740,11,52796,52796,11,52852,52852,11,52908,52908,11,52964,52964,11,53020,53020,11,53076,53076,11,53132,53132,11,53188,53188,11,53244,53244,11,53300,53300,11,53356,53356,11,53412,53412,11,53468,53468,11,53524,53524,11,53580,53580,11,53636,53636,11,53692,53692,11,53748,53748,11,53804,53804,11,53860,53860,11,53916,53916,11,53972,53972,11,54028,54028,11,54084,54084,11,54140,54140,11,54196,54196,11,54252,54252,11,54308,54308,11,54364,54364,11,54420,54420,11,54476,54476,11,54532,54532,11,54588,54588,11,54644,54644,11,54700,54700,11,54756,54756,11,54812,54812,11,54868,54868,11,54924,54924,11,54980,54980,11,55036,55036,11,55092,55092,11,55148,55148,11,55216,55238,9,65056,65071,5,65529,65531,4,68097,68099,5,68159,68159,5,69446,69456,5,69688,69702,5,69808,69810,7,69815,69816,7,69821,69821,1,69888,69890,5,69932,69932,7,69957,69958,7,70016,70017,5,70067,70069,7,70079,70080,7,70089,70092,5,70095,70095,5,70191,70193,5,70196,70196,5,70198,70199,5,70367,70367,5,70371,70378,5,70402,70403,7,70462,70462,5,70464,70464,5,70471,70472,7,70487,70487,5,70502,70508,5,70709,70711,7,70720,70721,7,70725,70725,7,70750,70750,5,70833,70834,7,70841,70841,7,70843,70844,7,70846,70846,7,70849,70849,7,71087,71087,5,71090,71093,5,71100,71101,5,71103,71104,5,71216,71218,7,71227,71228,7,71230,71230,7,71339,71339,5,71341,71341,5,71344,71349,5,71351,71351,5,71456,71457,7,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123628,123631,5,125252,125258,5,126980,126980,14,127183,127183,14,127245,127247,14,127340,127343,14,127358,127359,14,127377,127386,14,127462,127487,6,127491,127503,14,127535,127535,14,127548,127551,14,127568,127569,14,127744,127777,14,127780,127891,14,127894,127895,14,127897,127899,14,127902,127984,14,127987,127989,14,127991,127994,14,128000,128253,14,128255,128317,14,128329,128334,14,128336,128359,14,128367,128368,14,128371,128377,14,128379,128390,14,128392,128393,14,128398,128399,14,128401,128404,14,128407,128419,14,128421,128421,14,128424,128424,14,128433,128434,14,128444,128444,14,128450,128452,14,128465,128467,14,128476,128478,14,128481,128481,14,128483,128483,14,128488,128488,14,128495,128495,14,128499,128499,14,128506,128591,14,128710,128714,14,128721,128722,14,128725,128725,14,128728,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129664,129666,14,129671,129679,14,129686,129704,14,129712,129718,14,129728,129730,14,129744,129750,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2259,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3134,3136,5,3142,3144,5,3157,3158,5,3201,3201,5,3260,3260,5,3263,3263,5,3266,3266,5,3270,3270,5,3274,3275,7,3285,3286,5,3328,3329,5,3387,3388,5,3391,3392,7,3398,3400,7,3405,3405,5,3415,3415,5,3457,3457,5,3530,3530,5,3536,3537,7,3542,3542,5,3551,3551,5,3633,3633,5,3636,3642,5,3761,3761,5,3764,3772,5,3864,3865,5,3895,3895,5,3902,3903,7,3967,3967,7,3974,3975,5,3993,4028,5,4141,4144,5,4146,4151,5,4155,4156,7,4182,4183,7,4190,4192,5,4226,4226,5,4229,4230,5,4253,4253,5,4448,4519,9,4957,4959,5,5938,5940,5,6002,6003,5,6070,6070,7,6078,6085,7,6087,6088,7,6109,6109,5,6158,6158,4,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6848,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7673,5,8203,8203,4,8205,8205,13,8232,8232,4,8234,8238,4,8265,8265,14,8293,8293,4,8400,8412,5,8417,8417,5,8421,8432,5,8505,8505,14,8617,8618,14,9000,9000,14,9167,9167,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9776,9783,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9935,14,9937,9937,14,9939,9940,14,9961,9962,14,9968,9973,14,9975,9978,14,9981,9981,14,9986,9986,14,9989,9989,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10084,14,10133,10135,14,10160,10160,14,10548,10549,14,11035,11036,14,11093,11093,14,11647,11647,5,12330,12333,5,12336,12336,14,12441,12442,5,12953,12953,14,42608,42610,5,42654,42655,5,43010,43010,5,43019,43019,5,43045,43046,5,43052,43052,5,43188,43203,7,43232,43249,5,43302,43309,5,43346,43347,7,43392,43394,5,43443,43443,5,43446,43449,5,43452,43453,5,43493,43493,5,43567,43568,7,43571,43572,7,43587,43587,5,43597,43597,7,43696,43696,5,43703,43704,5,43713,43713,5,43756,43757,5,43765,43765,7,44003,44004,7,44006,44007,7,44009,44010,7,44013,44013,5,44033,44059,12,44061,44087,12,44089,44115,12,44117,44143,12,44145,44171,12,44173,44199,12,44201,44227,12,44229,44255,12,44257,44283,12,44285,44311,12,44313,44339,12,44341,44367,12,44369,44395,12,44397,44423,12,44425,44451,12,44453,44479,12,44481,44507,12,44509,44535,12,44537,44563,12,44565,44591,12,44593,44619,12,44621,44647,12,44649,44675,12,44677,44703,12,44705,44731,12,44733,44759,12,44761,44787,12,44789,44815,12,44817,44843,12,44845,44871,12,44873,44899,12,44901,44927,12,44929,44955,12,44957,44983,12,44985,45011,12,45013,45039,12,45041,45067,12,45069,45095,12,45097,45123,12,45125,45151,12,45153,45179,12,45181,45207,12,45209,45235,12,45237,45263,12,45265,45291,12,45293,45319,12,45321,45347,12,45349,45375,12,45377,45403,12,45405,45431,12,45433,45459,12,45461,45487,12,45489,45515,12,45517,45543,12,45545,45571,12,45573,45599,12,45601,45627,12,45629,45655,12,45657,45683,12,45685,45711,12,45713,45739,12,45741,45767,12,45769,45795,12,45797,45823,12,45825,45851,12,45853,45879,12,45881,45907,12,45909,45935,12,45937,45963,12,45965,45991,12,45993,46019,12,46021,46047,12,46049,46075,12,46077,46103,12,46105,46131,12,46133,46159,12,46161,46187,12,46189,46215,12,46217,46243,12,46245,46271,12,46273,46299,12,46301,46327,12,46329,46355,12,46357,46383,12,46385,46411,12,46413,46439,12,46441,46467,12,46469,46495,12,46497,46523,12,46525,46551,12,46553,46579,12,46581,46607,12,46609,46635,12,46637,46663,12,46665,46691,12,46693,46719,12,46721,46747,12,46749,46775,12,46777,46803,12,46805,46831,12,46833,46859,12,46861,46887,12,46889,46915,12,46917,46943,12,46945,46971,12,46973,46999,12,47001,47027,12,47029,47055,12,47057,47083,12,47085,47111,12,47113,47139,12,47141,47167,12,47169,47195,12,47197,47223,12,47225,47251,12,47253,47279,12,47281,47307,12,47309,47335,12,47337,47363,12,47365,47391,12,47393,47419,12,47421,47447,12,47449,47475,12,47477,47503,12,47505,47531,12,47533,47559,12,47561,47587,12,47589,47615,12,47617,47643,12,47645,47671,12,47673,47699,12,47701,47727,12,47729,47755,12,47757,47783,12,47785,47811,12,47813,47839,12,47841,47867,12,47869,47895,12,47897,47923,12,47925,47951,12,47953,47979,12,47981,48007,12,48009,48035,12,48037,48063,12,48065,48091,12,48093,48119,12,48121,48147,12,48149,48175,12,48177,48203,12,48205,48231,12,48233,48259,12,48261,48287,12,48289,48315,12,48317,48343,12,48345,48371,12,48373,48399,12,48401,48427,12,48429,48455,12,48457,48483,12,48485,48511,12,48513,48539,12,48541,48567,12,48569,48595,12,48597,48623,12,48625,48651,12,48653,48679,12,48681,48707,12,48709,48735,12,48737,48763,12,48765,48791,12,48793,48819,12,48821,48847,12,48849,48875,12,48877,48903,12,48905,48931,12,48933,48959,12,48961,48987,12,48989,49015,12,49017,49043,12,49045,49071,12,49073,49099,12,49101,49127,12,49129,49155,12,49157,49183,12,49185,49211,12,49213,49239,12,49241,49267,12,49269,49295,12,49297,49323,12,49325,49351,12,49353,49379,12,49381,49407,12,49409,49435,12,49437,49463,12,49465,49491,12,49493,49519,12,49521,49547,12,49549,49575,12,49577,49603,12,49605,49631,12,49633,49659,12,49661,49687,12,49689,49715,12,49717,49743,12,49745,49771,12,49773,49799,12,49801,49827,12,49829,49855,12,49857,49883,12,49885,49911,12,49913,49939,12,49941,49967,12,49969,49995,12,49997,50023,12,50025,50051,12,50053,50079,12,50081,50107,12,50109,50135,12,50137,50163,12,50165,50191,12,50193,50219,12,50221,50247,12,50249,50275,12,50277,50303,12,50305,50331,12,50333,50359,12,50361,50387,12,50389,50415,12,50417,50443,12,50445,50471,12,50473,50499,12,50501,50527,12,50529,50555,12,50557,50583,12,50585,50611,12,50613,50639,12,50641,50667,12,50669,50695,12,50697,50723,12,50725,50751,12,50753,50779,12,50781,50807,12,50809,50835,12,50837,50863,12,50865,50891,12,50893,50919,12,50921,50947,12,50949,50975,12,50977,51003,12,51005,51031,12,51033,51059,12,51061,51087,12,51089,51115,12,51117,51143,12,51145,51171,12,51173,51199,12,51201,51227,12,51229,51255,12,51257,51283,12,51285,51311,12,51313,51339,12,51341,51367,12,51369,51395,12,51397,51423,12,51425,51451,12,51453,51479,12,51481,51507,12,51509,51535,12,51537,51563,12,51565,51591,12,51593,51619,12,51621,51647,12,51649,51675,12,51677,51703,12,51705,51731,12,51733,51759,12,51761,51787,12,51789,51815,12,51817,51843,12,51845,51871,12,51873,51899,12,51901,51927,12,51929,51955,12,51957,51983,12,51985,52011,12,52013,52039,12,52041,52067,12,52069,52095,12,52097,52123,12,52125,52151,12,52153,52179,12,52181,52207,12,52209,52235,12,52237,52263,12,52265,52291,12,52293,52319,12,52321,52347,12,52349,52375,12,52377,52403,12,52405,52431,12,52433,52459,12,52461,52487,12,52489,52515,12,52517,52543,12,52545,52571,12,52573,52599,12,52601,52627,12,52629,52655,12,52657,52683,12,52685,52711,12,52713,52739,12,52741,52767,12,52769,52795,12,52797,52823,12,52825,52851,12,52853,52879,12,52881,52907,12,52909,52935,12,52937,52963,12,52965,52991,12,52993,53019,12,53021,53047,12,53049,53075,12,53077,53103,12,53105,53131,12,53133,53159,12,53161,53187,12,53189,53215,12,53217,53243,12,53245,53271,12,53273,53299,12,53301,53327,12,53329,53355,12,53357,53383,12,53385,53411,12,53413,53439,12,53441,53467,12,53469,53495,12,53497,53523,12,53525,53551,12,53553,53579,12,53581,53607,12,53609,53635,12,53637,53663,12,53665,53691,12,53693,53719,12,53721,53747,12,53749,53775,12,53777,53803,12,53805,53831,12,53833,53859,12,53861,53887,12,53889,53915,12,53917,53943,12,53945,53971,12,53973,53999,12,54001,54027,12,54029,54055,12,54057,54083,12,54085,54111,12,54113,54139,12,54141,54167,12,54169,54195,12,54197,54223,12,54225,54251,12,54253,54279,12,54281,54307,12,54309,54335,12,54337,54363,12,54365,54391,12,54393,54419,12,54421,54447,12,54449,54475,12,54477,54503,12,54505,54531,12,54533,54559,12,54561,54587,12,54589,54615,12,54617,54643,12,54645,54671,12,54673,54699,12,54701,54727,12,54729,54755,12,54757,54783,12,54785,54811,12,54813,54839,12,54841,54867,12,54869,54895,12,54897,54923,12,54925,54951,12,54953,54979,12,54981,55007,12,55009,55035,12,55037,55063,12,55065,55091,12,55093,55119,12,55121,55147,12,55149,55175,12,55177,55203,12,55243,55291,10,65024,65039,5,65279,65279,4,65520,65528,4,66045,66045,5,66422,66426,5,68101,68102,5,68152,68154,5,68325,68326,5,69291,69292,5,69632,69632,7,69634,69634,7,69759,69761,5]")}function Vke(n,e){if(n===0)return 0;const t=Wke(n,e);if(t!==void 0)return t;const i=Em(e,n);return n-=MS(i),n}function Wke(n,e){let t=Em(e,n);for(n-=MS(t);$ke(t)||t===65039||t===8419;){if(n===0)return;t=Em(e,n),n-=MS(t)}if(Yb(t)){if(n>=0){const i=Em(e,n);i===8205&&(n-=MS(i))}return n}}function MS(n){return n>=65536?2:1}function $ke(n){return 127995<=n&&n<=127999}var QV,JV;class zke{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class Hke{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?F3(e,this._value,0,e.length,this._from,this._to):py(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Uke{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){return this._value=e.replace(/\\$|\/$/,""),this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?F3(e,this._value,0,e.length,this._from,this._to):py(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class jke{constructor(e){this._ignorePathCasing=e,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new Uke(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return IM(e,this._value.scheme);if(this._states[this._stateIdx]===2)return IM(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return pw(e,this._value.query);if(this._states[this._stateIdx]===5)return pw(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class fC{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e,t;return(t=(e=this.left)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get heightRight(){var e,t;return(t=(e=this.right)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}}class Dm{constructor(e){this._iter=e}static forUris(e=()=>!1){return new Dm(new jke(e))}static forStrings(){return new Dm(new zke)}static forConfigKeys(){return new Dm(new Hke)}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let r;this._root||(this._root=new fC,this._root.segment=i.value());const s=[];for(r=this._root;;){const a=i.cmp(r.segment);if(a>0)r.left||(r.left=new fC,r.left.segment=i.value()),s.push([-1,r]),r=r.left;else if(a<0)r.right||(r.right=new fC,r.right.segment=i.value()),s.push([1,r]),r=r.right;else if(i.hasNext())i.next(),r.mid||(r.mid=new fC,r.mid.segment=i.value()),s.push([0,r]),r=r.mid;else break}const o=r.value;r.value=t,r.key=e;for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const h=s[a][0],u=s[a+1][0];if(h===1&&u===1)s[a][1]=l.rotateLeft();else if(h===-1&&u===-1)s[a][1]=l.rotateRight();else if(h===1&&u===-1)l.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=l.rotateLeft();else if(h===-1&&u===1)l.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){var t;return(t=this._getNode(e))===null||t===void 0?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){var i;const r=this._iter.reset(e),s=[];let o=this._root;for(;o;){const a=r.cmp(o.segment);if(a>0)s.push([-1,o]),o=o.left;else if(a<0)s.push([1,o]),o=o.right;else if(r.hasNext())r.next(),s.push([0,o]),o=o.mid;else break}if(o){if(t?(o.left=void 0,o.mid=void 0,o.right=void 0,o.height=1):(o.key=void 0,o.value=void 0),!o.mid&&!o.value)if(o.left&&o.right){const a=this._min(o.right),{key:l,value:c,segment:h}=a;this._delete(a.key,!1),o.key=l,o.value=c,o.segment=h}else{const a=(i=o.left)!==null&&i!==void 0?i:o.right;if(s.length>0){const[l,c]=s[s.length-1];switch(l){case-1:c.left=a;break;case 0:c.mid=a;break;case 1:c.right=a;break}}else this._root=a}for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c>1?(l.right.balanceFactor()>=0||(l.right=s[a+1][1]=s[a+1][1].rotateRight()),s[a][1]=l.rotateLeft()):c<-1&&(l.left.balanceFactor()<=0||(l.left=s[a+1][1]=s[a+1][1].rotateLeft()),s[a][1]=l.rotateRight()),a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,r;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),r=i.value||r,i=i.mid;else break}return i&&i.value||r}findSuperstr(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else return i.mid?this._entries(i.mid):void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}*_entries(e){e&&(e.left&&(yield*this._entries(e.left)),e.value&&(yield[e.key,e.value]),e.mid&&(yield*this._entries(e.mid)),e.right&&(yield*this._entries(e.right)))}}class qke{constructor(e,t){this.uri=e,this.value=t}}class _r{constructor(e,t){this[QV]="ResourceMap",e instanceof _r?(this.map=new Map(e.map),this.toKey=t??_r.defaultToKey):(this.map=new Map,this.toKey=e??_r.defaultToKey)}set(e,t){return this.map.set(this.toKey(e),new qke(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))===null||t===void 0?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[i,r]of this.map)e(r.value,r.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(QV=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}}_r.defaultToKey=n=>n.toString();class Gke{constructor(){this[JV]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)===null||e===void 0?void 0:e.value}get last(){var e;return(e=this._tail)===null||e===void 0?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let r=this._map.get(e);if(r)r.value=t,i!==0&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(r);break;case 1:this.addItemFirst(r);break;case 2:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}values(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}[(JV=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,r=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class W3 extends Gke{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}const eW=typeof Buffer<"u";let sT;class Yk{constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}static wrap(e){return eW&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new Yk(e)}toString(){return eW?this.buffer.toString():(sT||(sT=new TextDecoder),sT.decode(this.buffer))}}function Kke(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0}function Zke(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255}function ma(n,e){return n[e]*Math.pow(2,24)+n[e+1]*Math.pow(2,16)+n[e+2]*Math.pow(2,8)+n[e+3]}function _a(n,e,t){n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e}function tW(n,e){return n[e]}function iW(n,e,t){n[t]=e}function AM(n){let e=JSON.parse(n);return e=NM(e),e}function NM(n,e=0){if(!n||e>200)return n;if(typeof n=="object"){switch(n.$mid){case 1:return qe.revive(n);case 2:return new RegExp(n.source,n.flags)}if(n instanceof Yk||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let t=0;t<n.length;++t)n[t]=NM(n[t],e+1);else for(const t in n)Object.hasOwnProperty.call(n,t)&&(n[t]=NM(n[t],e+1))}return n}function Yke(n){return n.replace(/[\\/]/g,hn.sep)}function Xke(n){return n.indexOf("/")===-1&&(n=Yke(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function Qke(n,e,t,i=RS){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!O3(n,e))return!1;if(e.length===n.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,n.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),n.indexOf(e)===0}function Jke(n){return n>=65&&n<=90||n>=97&&n<=122}function eLe(n){const e=D3(n);return Kn?n.length>3?!1:PQ(e)&&(n.length===2||e.charCodeAt(2)===92):e===hn.sep}function PQ(n){return Kn?Jke(n.charCodeAt(0))&&n.charCodeAt(1)===58:!1}function oT(n){return pE(n,!0)}class tLe{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:pw(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}joinPath(e,...t){return qe.joinPath(e,...t)}basenameOrAuthority(e){return qa(e)||e.authority}basename(e){return hn.basename(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===ft.file?t=qe.file(hQ(oT(e))).path:(t=hn.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===ft.file?t=qe.file(D3(oT(e))).path:t=hn.normalize(e.path),e.with({path:t})}resolvePath(e,t){if(e.scheme===ft.file){const i=qe.file(FDe(oT(e),t));return e.with({authority:i.authority,path:i.path})}return t=Xke(t),e.with({path:hn.resolve(e.path,t)})}}const Hr=new tLe(()=>!1),BQ=Hr.isEqual.bind(Hr),VQ=Hr.basenameOrAuthority.bind(Hr),qa=Hr.basename.bind(Hr),$3=Hr.dirname.bind(Hr);Hr.joinPath.bind(Hr);const iLe=Hr.normalizePath.bind(Hr),nW=Hr.resolvePath.bind(Hr);var Uu;(function(n){n.META_DATA_LABEL="label",n.META_DATA_DESCRIPTION="description",n.META_DATA_SIZE="size",n.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(n.META_DATA_MIME,s),i}n.parseMetaData=e})(Uu||(Uu={}));function WQ(n){return Array.isArray(n)}function Ga(n){return typeof n=="string"}function Br(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function sg(n){return typeof n=="number"&&!isNaN(n)}function $Q(n){return n===!0||n===!1}function yr(n){return typeof n>"u"}function nLe(n){return!Xs(n)}function Xs(n){return yr(n)||n===null}function ji(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Qb(n){return typeof n=="function"}function rLe(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)sLe(n[i],e[i])}function sLe(n,e){if(Ga(e)){if(typeof n!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Qb(e)){try{if(n instanceof e)return}catch{}if(!Xs(n)&&n.constructor===e||e.length===1&&e.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function oLe(n){let e=[],t=Object.getPrototypeOf(n);for(;Object.prototype!==t;)e=e.concat(Object.getOwnPropertyNames(t)),t=Object.getPrototypeOf(t);return e}function z3(n){const e=[];for(const t of oLe(n))typeof n[t]=="function"&&e.push(t);return e}function aLe(n,e){const t=r=>function(){const s=Array.prototype.slice.call(arguments,0);return e(r,s)};let i={};for(const r of n)i[r]=t(r);return i}function hf(n){return n===null?void 0:n}function lLe(n,e="Unreachable"){throw new Error(e)}const An=Dt("commandService"),Pt=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new H,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(n,e){if(!n)throw new Error("invalid command");if(typeof n=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:n,handler:e})}if(n.description){const o=[];for(let l of n.description.args)o.push(l.constraint);const a=n.handler;n.handler=function(l,...c){return rLe(c,o),a(l,...c)}}const{id:t}=n;let i=this._commands.get(t);i||(i=new As,this._commands.set(t,i));let r=i.unshift(n),s=Et(()=>{r();const o=this._commands.get(t);o!=null&&o.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),s}registerCommandAlias(n,e){return Pt.registerCommand(n,(t,...i)=>t.get(An).executeCommand(e,...i))}getCommand(n){const e=this._commands.get(n);if(!(!e||e.isEmpty()))return vt.first(e)}getCommands(){const n=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&n.set(e,t)}return n}};Pt.registerCommand("noop",()=>{});var yE;(function(n){n[n.API=0]="API",n[n.USER=1]="USER"})(yE||(yE={}));var rW=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const ju=Dt("openerService"),cLe=Object.freeze({_serviceBrand:void 0,registerOpener(){return re.None},registerValidator(){return re.None},registerExternalUriResolver(){return re.None},setDefaultExternalOpener(){},registerExternalOpener(){return re.None},open(){return rW(this,void 0,void 0,function*(){return!1})},resolveExternalUri(n){return rW(this,void 0,void 0,function*(){return{resolved:n,dispose(){}}})}});function Op(n,e){return qe.isUri(n)?wb(n.scheme,e):O3(n,e+":")}var H3=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},CE=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Bd=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let RM=class{constructor(e){this._commandService=e}open(e,t){return Bd(this,void 0,void 0,function*(){if(!Op(e,ft.command))return!1;if(!(t!=null&&t.allowCommands))return!0;typeof e=="string"&&(e=qe.parse(e));let i=[];try{i=AM(decodeURIComponent(e.query))}catch{try{i=AM(e.query)}catch{}}return Array.isArray(i)||(i=[i]),yield this._commandService.executeCommand(e.path,...i),!0})}};RM=H3([CE(0,An)],RM);let MM=class{constructor(e){this._editorService=e}open(e,t){return Bd(this,void 0,void 0,function*(){typeof e=="string"&&(e=qe.parse(e));let i;const r=/^L?(\d+)(?:,(\d+))?/.exec(e.fragment);return r&&(i={startLineNumber:parseInt(r[1]),startColumn:r[2]?parseInt(r[2]):1},e=e.with({fragment:""})),e.scheme===ft.file&&(e=iLe(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:i,context:t!=null&&t.fromUserGesture?yE.USER:yE.API},t==null?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),t==null?void 0:t.openToSide),!0})}};MM=H3([CE(0,ui)],MM);let FM=class{constructor(e,t){this._openers=new As,this._validators=new As,this._resolvers=new As,this._resolvedUriTargets=new _r(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new As,this._defaultExternalOpener={openExternal:i=>Bd(this,void 0,void 0,function*(){return Op(i,ft.http)||Op(i,ft.https)?TQ(i):window.location.href=i,!0})},this._openers.push({open:(i,r)=>Bd(this,void 0,void 0,function*(){return r!=null&&r.openExternal||Op(i,ft.mailto)||Op(i,ft.http)||Op(i,ft.https)?(yield this._doOpenExternal(i,r),!0):!1})}),this._openers.push(new RM(t)),this._openers.push(new MM(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}registerValidator(e){return{dispose:this._validators.push(e)}}registerExternalUriResolver(e){return{dispose:this._resolvers.push(e)}}setDefaultExternalOpener(e){this._defaultExternalOpener=e}registerExternalOpener(e){return{dispose:this._externalOpeners.push(e)}}open(e,t){var i;return Bd(this,void 0,void 0,function*(){const r=typeof e=="string"?qe.parse(e):e,s=(i=this._resolvedUriTargets.get(r))!==null&&i!==void 0?i:e;for(const o of this._validators)if(!(yield o.shouldOpen(s)))return!1;for(const o of this._openers)if(yield o.open(e,t))return!0;return!1})}resolveExternalUri(e,t){return Bd(this,void 0,void 0,function*(){for(const i of this._resolvers)try{const r=yield i.resolveExternalUri(e,t);if(r)return this._resolvedUriTargets.has(r.resolved)||this._resolvedUriTargets.set(r.resolved,e),r}catch{}throw new Error("Could not resolve external URI: "+e.toString())})}_doOpenExternal(e,t){return Bd(this,void 0,void 0,function*(){const i=typeof e=="string"?qe.parse(e):e;let r;try{r=(yield this.resolveExternalUri(i,t)).resolved}catch{r=i}let s;if(typeof e=="string"&&i.toString()===r.toString()?s=e:s=encodeURI(r.toString(!0)),t!=null&&t.allowContributedOpeners){const o=typeof(t==null?void 0:t.allowContributedOpeners)=="string"?t==null?void 0:t.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(yield a.openExternal(s,{sourceUri:i,preferredOpenerId:o},ai.None))return!0}return this._defaultExternalOpener.openExternal(s,{sourceUri:i},ai.None)})}dispose(){this._validators.clear()}};FM=H3([CE(0,ui),CE(1,An)],FM);function FS(n,e){if(!n)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function iu(n){if(!n||typeof n!="object"||n instanceof RegExp)return n;const e=Array.isArray(n)?[]:{};return Object.keys(n).forEach(t=>{n[t]&&typeof n[t]=="object"?e[t]=iu(n[t]):e[t]=n[t]}),e}function hLe(n){if(!n||typeof n!="object")return n;const e=[n];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(zQ.call(t,i)){const r=t[i];typeof r=="object"&&!Object.isFrozen(r)&&e.push(r)}}return n}const zQ=Object.prototype.hasOwnProperty;function uLe(n,e){return OM(n,e,new Set)}function OM(n,e,t){if(Xs(n))return n;const i=e(n);if(typeof i<"u")return i;if(WQ(n)){const r=[];for(const s of n)r.push(OM(s,e,t));return r}if(Br(n)){if(t.has(n))throw new Error("Cannot clone recursive data-structure");t.add(n);const r={};for(let s in n)zQ.call(n,s)&&(r[s]=OM(n[s],e,t));return t.delete(n),r}return n}function sl(n,e,t=!0){return Br(n)?(Br(e)&&Object.keys(e).forEach(i=>{i in n?t&&(Br(n[i])&&Br(e[i])?sl(n[i],e[i],t):n[i]=e[i]):n[i]=e[i]}),n):e}function Ma(n,e){if(n===e)return!0;if(n==null||e===null||e===void 0||typeof n!=typeof e||typeof n!="object"||Array.isArray(n)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(n)){if(n.length!==e.length)return!1;for(t=0;t<n.length;t++)if(!Ma(n[t],e[t]))return!1}else{const r=[];for(i in n)r.push(i);r.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!Ma(r,s))return!1;for(t=0;t<r.length;t++)if(!Ma(n[r[t]],e[r[t]]))return!1}return!0}function pl(n,e,t){const i=e(n);return typeof i>"u"?t:i}const dLe={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0};class fLe extends re{constructor(e,t={}){super(),this._onDidUpdate=this._register(new H),this._editor=e,this._options=sl(t,dLe,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=!!this._options.alwaysRevealFirst,this._register(this._editor.onDidDispose(()=>this.dispose())),this._register(this._editor.onDidUpdateDiff(()=>this._onDiffUpdated())),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition(i=>{this.ignoreSelectionChange||(this.nextIdx=-1)})),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel(i=>{this.revealFirst=!0})),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&this._editor.getLineChanges()!==null&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach(t=>{!this._options.ignoreCharChanges&&t.charChanges?t.charChanges.forEach(i=>{this.ranges.push({rhs:!0,range:new V(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn)})}):t.modifiedEndLineNumber===0?this.ranges.push({rhs:!0,range:new V(t.modifiedStartLineNumber,1,t.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new V(t.modifiedStartLineNumber,1,t.modifiedEndLineNumber+1,1)})}),this.ranges.sort((t,i)=>V.compareRangesUsingStarts(t.range,i.range)),this._onDidUpdate.fire(this)}_initIdx(e){let t=!1,i=this._editor.getPosition();if(!i){this.nextIdx=0;return}for(let r=0,s=this.ranges.length;r<s&&!t;r++){let o=this.ranges[r].range;i.isBeforeOrEqual(o.getStartPosition())&&(this.nextIdx=r+(e?0:-1),t=!0)}t||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}_move(e,t){if(FS(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;this.nextIdx===-1?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));let i=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{let r=i.range.getStartPosition();this._editor.setPosition(r),this._editor.revealRangeInCenter(i.range,t)}finally{this.ignoreSelectionChange=!1}}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this._move(!0,e)}previous(e=0){this._move(!1,e)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}}const SE=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new H,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(n){n=Math.min(Math.max(-5,n),20),this._zoomLevel!==n&&(this._zoomLevel=n,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},gLe=wt?1.5:1.35,aT=8;class kf{constructor(e){this._bareFontInfoBrand=void 0,this.zoomLevel=e.zoomLevel,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}static createFromValidatedSettings(e,t,i,r){const s=e.get(42),o=e.get(46),a=e.get(45),l=e.get(44),c=e.get(58),h=e.get(55);return kf._create(s,o,a,l,c,h,t,i,r)}static _create(e,t,i,r,s,o,a,l,c){s===0?s=gLe*i:s<aT&&(s=s*i),s=Math.round(s),s<aT&&(s=aT);const h=1+(c?0:SE.getZoomLevel()*.1);return i*=h,s*=h,new kf({zoomLevel:a,pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:r,lineHeight:s,letterSpacing:o})}getId(){return this.zoomLevel+"-"+this.pixelRatio+"-"+this.fontFamily+"-"+this.fontWeight+"-"+this.fontSize+"-"+this.fontFeatureSettings+"-"+this.lineHeight+"-"+this.letterSpacing}getMassagedFontFamily(e){const t=kf._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const pLe=1;class PM extends kf{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=pLe,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}function mLe(n){return n&&typeof n.id=="string"}const Xk={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};var rc;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(rc||(rc={}));var Xl;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(Xl||(Xl={}));class OS{constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),this.indentSize=e.tabSize|0,this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Ma(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class _w{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}var Lf;(function(n){n[n.Disabled=0]="Disabled",n[n.EnabledForActive=1]="EnabledForActive",n[n.Enabled=2]="Enabled"})(Lf||(Lf={}));class Xp{constructor(e,t,i){this.visibleColumn=e,this.className=t,this.horizontalLine=i}}class BM{constructor(e,t){this.top=e,this.endColumn=t}}class lT{constructor(e,t,i,r,s,o){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=r,this.isAutoWhitespaceEdit=s,this._isTracked=o}}class _Le{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function bLe(n){return U3(n,0)}function U3(n,e){switch(typeof n){case"object":return n===null?hh(349,e):Array.isArray(n)?wLe(n,e):yLe(n,e);case"string":return j3(n,e);case"boolean":return vLe(n,e);case"number":return hh(n,e);case"undefined":return hh(937,e);default:return hh(617,e)}}function hh(n,e){return(e<<5)-e+n|0}function vLe(n,e){return hh(n?433:863,e)}function j3(n,e){e=hh(149417,e);for(let t=0,i=n.length;t<i;t++)e=hh(n.charCodeAt(t),e);return e}function wLe(n,e){return e=hh(104579,e),n.reduce((t,i)=>U3(i,t),e)}function yLe(n,e){return e=hh(181387,e),Object.keys(n).sort().reduce((t,i)=>(t=j3(i,t),U3(n[i],t)),e)}function cT(n,e,t=32){const i=t-e,r=~((1<<i)-1);return(n<<e|(r&n)>>>i)>>>0}function sW(n,e=0,t=n.byteLength,i=0){for(let r=0;r<t;r++)n[e+r]=i}function CLe(n,e,t="0"){for(;n.length<e;)n=t+n;return n}function G0(n,e=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join(""):CLe((n>>>0).toString(16),e/4)}class Qk{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let r=this._buffLen,s=this._leftoverHighSurrogate,o,a;for(s!==0?(o=s,a=-1,s=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(Ln(o))if(a+1<t){const c=e.charCodeAt(a+1);w_(c)?(a++,l=P3(o,c)):l=65533}else{s=o;break}else w_(o)&&(l=65533);if(r=this._push(i,r,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=r,this._leftoverHighSurrogate=s}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64+0],e[1]=e[64+1],e[2]=e[64+2]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),G0(this._h0)+G0(this._h1)+G0(this._h2)+G0(this._h3)+G0(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,sW(this._buff,this._buffLen),this._buffLen>56&&(this._step(),sW(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=Qk._bigBlock32,t=this._buffDV;for(let u=0;u<64;u+=4)e.setUint32(u,t.getUint32(u,!1),!1);for(let u=64;u<320;u+=4)e.setUint32(u,cT(e.getUint32(u-12,!1)^e.getUint32(u-32,!1)^e.getUint32(u-56,!1)^e.getUint32(u-64,!1),1),!1);let i=this._h0,r=this._h1,s=this._h2,o=this._h3,a=this._h4,l,c,h;for(let u=0;u<80;u++)u<20?(l=r&s|~r&o,c=1518500249):u<40?(l=r^s^o,c=1859775393):u<60?(l=r&s|r&o|s&o,c=2400959708):(l=r^s^o,c=3395469782),h=cT(i,5)+l+a+c+e.getUint32(u*4,!1)&4294967295,a=o,o=s,s=cT(r,30),r=i,i=h;this._h0=this._h0+i&4294967295,this._h1=this._h1+r&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}}Qk._bigBlock32=new DataView(new ArrayBuffer(320));function Ao(n,e,t){return Math.min(Math.max(n,e),t)}const hT="**",oW="/",PS="[/\\\\]",BS="[^/\\\\]",SLe=/\//g;function aW(n){switch(n){case 0:return"";case 1:return`${BS}*?`;default:return`(?:${PS}|${BS}+${PS}|${PS}${BS}+)*?`}}function lW(n,e){if(!n)return[];const t=[];let i=!1,r=!1,s="";for(const o of n){switch(o){case e:if(!i&&!r){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":r=!0;break;case"]":r=!1;break}s+=o}return s&&t.push(s),t}function HQ(n){if(!n)return"";let e="";const t=lW(n,oW);if(t.every(i=>i===hT))e=".*";else{let i=!1;t.forEach((r,s)=>{if(r===hT){i||(e+=aW(2),i=!0);return}let o=!1,a="",l=!1,c="";for(const h of r){if(h!=="}"&&o){a+=h;continue}if(l&&(h!=="]"||!c)){let u;h==="-"?u=h:(h==="^"||h==="!")&&!c?u="^":h===oW?u="":u=ja(h),c+=u;continue}switch(h){case"{":o=!0;continue;case"[":l=!0;continue;case"}":const d=`(?:${lW(a,",").map(f=>HQ(f)).join("|")})`;e+=d,o=!1,a="";break;case"]":e+="["+c+"]",l=!1,c="";break;case"?":e+=BS;continue;case"*":e+=aW(1);continue;default:e+=ja(h)}}s<t.length-1&&(t[s+1]!==hT||s+2<t.length)&&(e+=PS),i=!1})}return e}const xLe=/^\*\*\/\*\.[\w\.-]+$/,ELe=/^\*\*\/([\w\.-]+)\/?$/,DLe=/^{\*\*\/[\*\.]?[\w\.-]+\/?(,\*\*\/[\*\.]?[\w\.-]+\/?)*}$/,kLe=/^{\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?(,\*\*\/[\*\.]?[\w\.-]+(\/(\*\*)?)?)*}$/,LLe=/^\*\*((\/[\w\.-]+)+)\/?$/,ILe=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,cW=new W3(1e4),hW=function(){return!1},Ql=function(){return null};function q3(n,e){if(!n)return Ql;let t;typeof n!="string"?t=n.pattern:t=n,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let r=cW.get(i);if(r)return uW(r,n);let s;if(xLe.test(t)){const o=t.substr(4);r=function(a,l){return typeof a=="string"&&a.endsWith(o)?t:null}}else(s=ELe.exec(uT(t,e)))?r=TLe(s[1],t):(e.trimForExclusions?kLe:DLe).test(t)?r=ALe(t,e):(s=LLe.exec(uT(t,e)))?r=dW(s[1].substr(1),t,!0):(s=ILe.exec(uT(t,e)))?r=dW(s[1],t,!1):r=NLe(t);return cW.set(i,r),uW(r,n)}function uW(n,e){return typeof e=="string"?n:function(t,i){return Qke(t,e.base)?n(ODe(e.base,t),i):null}}function uT(n,e){return e.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function TLe(n,e){const t=`/${n}`,i=`\\${n}`,r=function(o,a){return typeof o!="string"?null:a?a===n?e:null:o===n||o.endsWith(t)||o.endsWith(i)?e:null},s=[n];return r.basenames=s,r.patterns=[e],r.allBasenames=s,r}function ALe(n,e){const t=jQ(n.slice(1,-1).split(",").map(a=>q3(a,e)).filter(a=>a!==Ql),n),i=t.length;if(!i)return Ql;if(i===1)return t[0];const r=function(a,l){for(let c=0,h=t.length;c<h;c++)if(t[c](a,l))return n;return null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function dW(n,e,t){const i=RS===hn.sep,r=i?n:n.replace(SLe,RS),s=RS+r,o=hn.sep+n,a=t?function(l,c){return typeof l=="string"&&(l===r||l.endsWith(s)||!i&&(l===n||l.endsWith(o)))?e:null}:function(l,c){return typeof l=="string"&&(l===r||!i&&l===n)?e:null};return a.allPaths=[(t?"*/":"./")+n],a}function NLe(n){try{const e=new RegExp(`^${HQ(n)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?n:null}}catch{return Ql}}function RLe(n,e,t){return!n||typeof e!="string"?!1:UQ(n)(e,void 0,t)}function UQ(n,e={}){if(!n)return hW;if(typeof n=="string"||MLe(n)){const t=q3(n,e);if(t===Ql)return hW;const i=function(r,s){return!!t(r,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return FLe(n,e)}function MLe(n){const e=n;return e&&typeof e.base=="string"&&typeof e.pattern=="string"}function FLe(n,e){const t=jQ(Object.getOwnPropertyNames(n).map(a=>OLe(a,n[a],e)).filter(a=>a!==Ql)),i=t.length;if(!i)return Ql;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(h,u){for(let d=0,f=t.length;d<f;d++){const g=t[d](h,u);if(g)return g}return null},l=t.find(h=>!!h.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((h,u)=>u.allPaths?h.concat(u.allPaths):h,[]);return c.length&&(a.allPaths=c),a}const r=function(a,l,c){let h;for(let u=0,d=t.length;u<d;u++){const f=t[u];f.requiresSiblings&&c&&(l||(l=Ef(a)),h||(h=l.substr(0,l.length-PDe(a).length)));const g=f(a,l,h,c);if(g)return g}return null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function OLe(n,e,t){if(e===!1)return Ql;const i=q3(n,t);if(i===Ql)return Ql;if(typeof e=="boolean")return i;if(e){const r=e.when;if(typeof r=="string"){const s=(o,a,l,c)=>{if(!c||!i(o,a))return null;const h=r.replace("$(basename)",l),u=c(h);return nke(u)?u.then(d=>d?n:null):u?n:null};return s.requiresSiblings=!0,s}}return i}function jQ(n,e){const t=n.filter(a=>!!a.basenames);if(t.length<2)return n;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let r;if(e){r=[];for(let a=0,l=i.length;a<l;a++)r.push(e)}else r=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let h;for(h=a.length;h>0;h--){const u=a.charCodeAt(h-1);if(u===47||u===92)break}l=a.substr(h)}const c=i.indexOf(l);return c!==-1?r[c]:null};s.basenames=i,s.patterns=r,s.allBasenames=i;const o=n.filter(a=>!a.basenames);return o.push(s),o}function qQ(n,e,t,i){if(Array.isArray(n)){let r=0;for(const s of n){const o=qQ(s,e,t,i);if(o===10)return o;o>r&&(r=o)}return r}else{if(typeof n=="string")return i?n==="*"?5:n===t?10:0:0;if(n){const{language:r,pattern:s,scheme:o,hasAccessToAllModels:a}=n;if(!i&&!a)return 0;let l=0;if(o)if(o===e.scheme)l=10;else if(o==="*")l=5;else return 0;if(r)if(r===t)l=10;else if(r==="*")l=Math.max(l,5);else return 0;if(s){let c;if(typeof s=="string"?c=s:c=Object.assign(Object.assign({},s),{base:D3(s.base)}),c===e.fsPath||RLe(c,e.fsPath))l=10;else return 0}return l}else return 0}}const Kr=Dt("modelService");function PLe(n){return!n.isTooLargeForSyncing()&&!n.isForSimpleWidget}function GQ(n){return typeof n=="string"?!1:Array.isArray(n)?n.every(GQ):!!n.exclusive}class Ti{constructor(){this._clock=0,this._entries=[],this._onDidChange=new H}get onDidChange(){return this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),Et(()=>{if(i){let r=this._entries.indexOf(i);r>=0&&(this._entries.splice(r,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(let i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,i=>t.push(i.provider)),t}orderedGroups(e){const t=[];let i,r;return this._orderedForEach(e,s=>{i&&r===s._score?i.push(s.provider):(r=s._score,i=[s.provider],t.push(i))}),t}_orderedForEach(e,t){if(e){this._updateScores(e);for(const i of this._entries)i._score>0&&t(i)}}_updateScores(e){let t={uri:e.uri.toString(),language:e.getLanguageId()};if(!(this._lastCandidate&&this._lastCandidate.language===t.language&&this._lastCandidate.uri===t.uri)){this._lastCandidate=t;for(let i of this._entries)if(i._score=qQ(i.selector,e.uri,e.getLanguageId(),PLe(e)),GQ(i.selector)&&i._score>0){for(let r of this._entries)r._score=0;i._score=1e3;break}this._entries.sort(Ti._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:e._time<t._time?1:e._time>t._time?-1:0}}class BLe{constructor(){this._map=new Map,this._promises=new Map,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._colorMap=null}fire(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._map.set(e,t),this.fire([e]),Et(()=>{this._map.get(e)===t&&(this._map.delete(e),this.fire([e]))})}registerPromise(e,t){let i=null,r=!1;return this._promises.set(e,t.then(s=>{this._promises.delete(e),!(r||!s)&&(i=this.register(e,s))})),Et(()=>{r=!0,i&&i.dispose()})}getPromise(e){const t=this.get(e);if(t)return Promise.resolve(t);const i=this._promises.get(e);return i?i.then(r=>this.get(e)):null}get(e){return this._map.get(e)||null}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._map.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}let VLe=class{constructor(){this._icons=new Map,this._onDidRegister=new H}add(e){const t=this._icons.get(e.id);t?e.description?t.description=e.description:console.error(`Duplicate registration of codicon ${e.id}`):(this._icons.set(e.id,e),this._onDidRegister.fire(e))}get(e){return this._icons.get(e)}get all(){return this._icons.values()}get onDidRegister(){return this._onDidRegister.event}};const KQ=new VLe,xE=KQ;function ha(n,e){return new Ce(n,e)}function WLe(n){return n?n.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}class Ce{constructor(e,t,i){this.id=e,this.definition=t,this.description=i,KQ.add(this)}get classNames(){return"codicon codicon-"+this.id}get classNamesArray(){return["codicon","codicon-"+this.id]}get cssSelector(){return".codicon.codicon-"+this.id}}var ss;(function(n){n.iconNameSegment="[A-Za-z0-9]+",n.iconNameExpression="[A-Za-z0-9\\-]+",n.iconModifierExpression="~[A-Za-z]+";const e=new RegExp(`^(${n.iconNameExpression})(${n.iconModifierExpression})?$`);function t(s){if(s instanceof Ce)return["codicon","codicon-"+s.id];const o=e.exec(s.id);if(!o)return t(Ce.error);let[,a,l]=o;const c=["codicon","codicon-"+a];return l&&c.push("codicon-modifier-"+l.substr(1)),c}n.asClassNameArray=t;function i(s){return t(s).join(" ")}n.asClassName=i;function r(s){return"."+t(s).join(".")}n.asCSSSelector=r})(ss||(ss={}));(function(n){n.add=new n("add",{fontCharacter:"\\ea60"}),n.plus=new n("plus",n.add.definition),n.gistNew=new n("gist-new",n.add.definition),n.repoCreate=new n("repo-create",n.add.definition),n.lightbulb=new n("lightbulb",{fontCharacter:"\\ea61"}),n.lightBulb=new n("light-bulb",{fontCharacter:"\\ea61"}),n.repo=new n("repo",{fontCharacter:"\\ea62"}),n.repoDelete=new n("repo-delete",{fontCharacter:"\\ea62"}),n.gistFork=new n("gist-fork",{fontCharacter:"\\ea63"}),n.repoForked=new n("repo-forked",{fontCharacter:"\\ea63"}),n.gitPullRequest=new n("git-pull-request",{fontCharacter:"\\ea64"}),n.gitPullRequestAbandoned=new n("git-pull-request-abandoned",{fontCharacter:"\\ea64"}),n.recordKeys=new n("record-keys",{fontCharacter:"\\ea65"}),n.keyboard=new n("keyboard",{fontCharacter:"\\ea65"}),n.tag=new n("tag",{fontCharacter:"\\ea66"}),n.tagAdd=new n("tag-add",{fontCharacter:"\\ea66"}),n.tagRemove=new n("tag-remove",{fontCharacter:"\\ea66"}),n.person=new n("person",{fontCharacter:"\\ea67"}),n.personFollow=new n("person-follow",{fontCharacter:"\\ea67"}),n.personOutline=new n("person-outline",{fontCharacter:"\\ea67"}),n.personFilled=new n("person-filled",{fontCharacter:"\\ea67"}),n.gitBranch=new n("git-branch",{fontCharacter:"\\ea68"}),n.gitBranchCreate=new n("git-branch-create",{fontCharacter:"\\ea68"}),n.gitBranchDelete=new n("git-branch-delete",{fontCharacter:"\\ea68"}),n.sourceControl=new n("source-control",{fontCharacter:"\\ea68"}),n.mirror=new n("mirror",{fontCharacter:"\\ea69"}),n.mirrorPublic=new n("mirror-public",{fontCharacter:"\\ea69"}),n.star=new n("star",{fontCharacter:"\\ea6a"}),n.starAdd=new n("star-add",{fontCharacter:"\\ea6a"}),n.starDelete=new n("star-delete",{fontCharacter:"\\ea6a"}),n.starEmpty=new n("star-empty",{fontCharacter:"\\ea6a"}),n.comment=new n("comment",{fontCharacter:"\\ea6b"}),n.commentAdd=new n("comment-add",{fontCharacter:"\\ea6b"}),n.alert=new n("alert",{fontCharacter:"\\ea6c"}),n.warning=new n("warning",{fontCharacter:"\\ea6c"}),n.search=new n("search",{fontCharacter:"\\ea6d"}),n.searchSave=new n("search-save",{fontCharacter:"\\ea6d"}),n.logOut=new n("log-out",{fontCharacter:"\\ea6e"}),n.signOut=new n("sign-out",{fontCharacter:"\\ea6e"}),n.logIn=new n("log-in",{fontCharacter:"\\ea6f"}),n.signIn=new n("sign-in",{fontCharacter:"\\ea6f"}),n.eye=new n("eye",{fontCharacter:"\\ea70"}),n.eyeUnwatch=new n("eye-unwatch",{fontCharacter:"\\ea70"}),n.eyeWatch=new n("eye-watch",{fontCharacter:"\\ea70"}),n.circleFilled=new n("circle-filled",{fontCharacter:"\\ea71"}),n.primitiveDot=new n("primitive-dot",{fontCharacter:"\\ea71"}),n.closeDirty=new n("close-dirty",{fontCharacter:"\\ea71"}),n.debugBreakpoint=new n("debug-breakpoint",{fontCharacter:"\\ea71"}),n.debugBreakpointDisabled=new n("debug-breakpoint-disabled",{fontCharacter:"\\ea71"}),n.debugHint=new n("debug-hint",{fontCharacter:"\\ea71"}),n.primitiveSquare=new n("primitive-square",{fontCharacter:"\\ea72"}),n.edit=new n("edit",{fontCharacter:"\\ea73"}),n.pencil=new n("pencil",{fontCharacter:"\\ea73"}),n.info=new n("info",{fontCharacter:"\\ea74"}),n.issueOpened=new n("issue-opened",{fontCharacter:"\\ea74"}),n.gistPrivate=new n("gist-private",{fontCharacter:"\\ea75"}),n.gitForkPrivate=new n("git-fork-private",{fontCharacter:"\\ea75"}),n.lock=new n("lock",{fontCharacter:"\\ea75"}),n.mirrorPrivate=new n("mirror-private",{fontCharacter:"\\ea75"}),n.close=new n("close",{fontCharacter:"\\ea76"}),n.removeClose=new n("remove-close",{fontCharacter:"\\ea76"}),n.x=new n("x",{fontCharacter:"\\ea76"}),n.repoSync=new n("repo-sync",{fontCharacter:"\\ea77"}),n.sync=new n("sync",{fontCharacter:"\\ea77"}),n.clone=new n("clone",{fontCharacter:"\\ea78"}),n.desktopDownload=new n("desktop-download",{fontCharacter:"\\ea78"}),n.beaker=new n("beaker",{fontCharacter:"\\ea79"}),n.microscope=new n("microscope",{fontCharacter:"\\ea79"}),n.vm=new n("vm",{fontCharacter:"\\ea7a"}),n.deviceDesktop=new n("device-desktop",{fontCharacter:"\\ea7a"}),n.file=new n("file",{fontCharacter:"\\ea7b"}),n.fileText=new n("file-text",{fontCharacter:"\\ea7b"}),n.more=new n("more",{fontCharacter:"\\ea7c"}),n.ellipsis=new n("ellipsis",{fontCharacter:"\\ea7c"}),n.kebabHorizontal=new n("kebab-horizontal",{fontCharacter:"\\ea7c"}),n.mailReply=new n("mail-reply",{fontCharacter:"\\ea7d"}),n.reply=new n("reply",{fontCharacter:"\\ea7d"}),n.organization=new n("organization",{fontCharacter:"\\ea7e"}),n.organizationFilled=new n("organization-filled",{fontCharacter:"\\ea7e"}),n.organizationOutline=new n("organization-outline",{fontCharacter:"\\ea7e"}),n.newFile=new n("new-file",{fontCharacter:"\\ea7f"}),n.fileAdd=new n("file-add",{fontCharacter:"\\ea7f"}),n.newFolder=new n("new-folder",{fontCharacter:"\\ea80"}),n.fileDirectoryCreate=new n("file-directory-create",{fontCharacter:"\\ea80"}),n.trash=new n("trash",{fontCharacter:"\\ea81"}),n.trashcan=new n("trashcan",{fontCharacter:"\\ea81"}),n.history=new n("history",{fontCharacter:"\\ea82"}),n.clock=new n("clock",{fontCharacter:"\\ea82"}),n.folder=new n("folder",{fontCharacter:"\\ea83"}),n.fileDirectory=new n("file-directory",{fontCharacter:"\\ea83"}),n.symbolFolder=new n("symbol-folder",{fontCharacter:"\\ea83"}),n.logoGithub=new n("logo-github",{fontCharacter:"\\ea84"}),n.markGithub=new n("mark-github",{fontCharacter:"\\ea84"}),n.github=new n("github",{fontCharacter:"\\ea84"}),n.terminal=new n("terminal",{fontCharacter:"\\ea85"}),n.console=new n("console",{fontCharacter:"\\ea85"}),n.repl=new n("repl",{fontCharacter:"\\ea85"}),n.zap=new n("zap",{fontCharacter:"\\ea86"}),n.symbolEvent=new n("symbol-event",{fontCharacter:"\\ea86"}),n.error=new n("error",{fontCharacter:"\\ea87"}),n.stop=new n("stop",{fontCharacter:"\\ea87"}),n.variable=new n("variable",{fontCharacter:"\\ea88"}),n.symbolVariable=new n("symbol-variable",{fontCharacter:"\\ea88"}),n.array=new n("array",{fontCharacter:"\\ea8a"}),n.symbolArray=new n("symbol-array",{fontCharacter:"\\ea8a"}),n.symbolModule=new n("symbol-module",{fontCharacter:"\\ea8b"}),n.symbolPackage=new n("symbol-package",{fontCharacter:"\\ea8b"}),n.symbolNamespace=new n("symbol-namespace",{fontCharacter:"\\ea8b"}),n.symbolObject=new n("symbol-object",{fontCharacter:"\\ea8b"}),n.symbolMethod=new n("symbol-method",{fontCharacter:"\\ea8c"}),n.symbolFunction=new n("symbol-function",{fontCharacter:"\\ea8c"}),n.symbolConstructor=new n("symbol-constructor",{fontCharacter:"\\ea8c"}),n.symbolBoolean=new n("symbol-boolean",{fontCharacter:"\\ea8f"}),n.symbolNull=new n("symbol-null",{fontCharacter:"\\ea8f"}),n.symbolNumeric=new n("symbol-numeric",{fontCharacter:"\\ea90"}),n.symbolNumber=new n("symbol-number",{fontCharacter:"\\ea90"}),n.symbolStructure=new n("symbol-structure",{fontCharacter:"\\ea91"}),n.symbolStruct=new n("symbol-struct",{fontCharacter:"\\ea91"}),n.symbolParameter=new n("symbol-parameter",{fontCharacter:"\\ea92"}),n.symbolTypeParameter=new n("symbol-type-parameter",{fontCharacter:"\\ea92"}),n.symbolKey=new n("symbol-key",{fontCharacter:"\\ea93"}),n.symbolText=new n("symbol-text",{fontCharacter:"\\ea93"}),n.symbolReference=new n("symbol-reference",{fontCharacter:"\\ea94"}),n.goToFile=new n("go-to-file",{fontCharacter:"\\ea94"}),n.symbolEnum=new n("symbol-enum",{fontCharacter:"\\ea95"}),n.symbolValue=new n("symbol-value",{fontCharacter:"\\ea95"}),n.symbolRuler=new n("symbol-ruler",{fontCharacter:"\\ea96"}),n.symbolUnit=new n("symbol-unit",{fontCharacter:"\\ea96"}),n.activateBreakpoints=new n("activate-breakpoints",{fontCharacter:"\\ea97"}),n.archive=new n("archive",{fontCharacter:"\\ea98"}),n.arrowBoth=new n("arrow-both",{fontCharacter:"\\ea99"}),n.arrowDown=new n("arrow-down",{fontCharacter:"\\ea9a"}),n.arrowLeft=new n("arrow-left",{fontCharacter:"\\ea9b"}),n.arrowRight=new n("arrow-right",{fontCharacter:"\\ea9c"}),n.arrowSmallDown=new n("arrow-small-down",{fontCharacter:"\\ea9d"}),n.arrowSmallLeft=new n("arrow-small-left",{fontCharacter:"\\ea9e"}),n.arrowSmallRight=new n("arrow-small-right",{fontCharacter:"\\ea9f"}),n.arrowSmallUp=new n("arrow-small-up",{fontCharacter:"\\eaa0"}),n.arrowUp=new n("arrow-up",{fontCharacter:"\\eaa1"}),n.bell=new n("bell",{fontCharacter:"\\eaa2"}),n.bold=new n("bold",{fontCharacter:"\\eaa3"}),n.book=new n("book",{fontCharacter:"\\eaa4"}),n.bookmark=new n("bookmark",{fontCharacter:"\\eaa5"}),n.debugBreakpointConditionalUnverified=new n("debug-breakpoint-conditional-unverified",{fontCharacter:"\\eaa6"}),n.debugBreakpointConditional=new n("debug-breakpoint-conditional",{fontCharacter:"\\eaa7"}),n.debugBreakpointConditionalDisabled=new n("debug-breakpoint-conditional-disabled",{fontCharacter:"\\eaa7"}),n.debugBreakpointDataUnverified=new n("debug-breakpoint-data-unverified",{fontCharacter:"\\eaa8"}),n.debugBreakpointData=new n("debug-breakpoint-data",{fontCharacter:"\\eaa9"}),n.debugBreakpointDataDisabled=new n("debug-breakpoint-data-disabled",{fontCharacter:"\\eaa9"}),n.debugBreakpointLogUnverified=new n("debug-breakpoint-log-unverified",{fontCharacter:"\\eaaa"}),n.debugBreakpointLog=new n("debug-breakpoint-log",{fontCharacter:"\\eaab"}),n.debugBreakpointLogDisabled=new n("debug-breakpoint-log-disabled",{fontCharacter:"\\eaab"}),n.briefcase=new n("briefcase",{fontCharacter:"\\eaac"}),n.broadcast=new n("broadcast",{fontCharacter:"\\eaad"}),n.browser=new n("browser",{fontCharacter:"\\eaae"}),n.bug=new n("bug",{fontCharacter:"\\eaaf"}),n.calendar=new n("calendar",{fontCharacter:"\\eab0"}),n.caseSensitive=new n("case-sensitive",{fontCharacter:"\\eab1"}),n.check=new n("check",{fontCharacter:"\\eab2"}),n.checklist=new n("checklist",{fontCharacter:"\\eab3"}),n.chevronDown=new n("chevron-down",{fontCharacter:"\\eab4"}),n.dropDownButton=new n("drop-down-button",n.chevronDown.definition),n.chevronLeft=new n("chevron-left",{fontCharacter:"\\eab5"}),n.chevronRight=new n("chevron-right",{fontCharacter:"\\eab6"}),n.chevronUp=new n("chevron-up",{fontCharacter:"\\eab7"}),n.chromeClose=new n("chrome-close",{fontCharacter:"\\eab8"}),n.chromeMaximize=new n("chrome-maximize",{fontCharacter:"\\eab9"}),n.chromeMinimize=new n("chrome-minimize",{fontCharacter:"\\eaba"}),n.chromeRestore=new n("chrome-restore",{fontCharacter:"\\eabb"}),n.circleOutline=new n("circle-outline",{fontCharacter:"\\eabc"}),n.debugBreakpointUnverified=new n("debug-breakpoint-unverified",{fontCharacter:"\\eabc"}),n.circleSlash=new n("circle-slash",{fontCharacter:"\\eabd"}),n.circuitBoard=new n("circuit-board",{fontCharacter:"\\eabe"}),n.clearAll=new n("clear-all",{fontCharacter:"\\eabf"}),n.clippy=new n("clippy",{fontCharacter:"\\eac0"}),n.closeAll=new n("close-all",{fontCharacter:"\\eac1"}),n.cloudDownload=new n("cloud-download",{fontCharacter:"\\eac2"}),n.cloudUpload=new n("cloud-upload",{fontCharacter:"\\eac3"}),n.code=new n("code",{fontCharacter:"\\eac4"}),n.collapseAll=new n("collapse-all",{fontCharacter:"\\eac5"}),n.colorMode=new n("color-mode",{fontCharacter:"\\eac6"}),n.commentDiscussion=new n("comment-discussion",{fontCharacter:"\\eac7"}),n.compareChanges=new n("compare-changes",{fontCharacter:"\\eafd"}),n.creditCard=new n("credit-card",{fontCharacter:"\\eac9"}),n.dash=new n("dash",{fontCharacter:"\\eacc"}),n.dashboard=new n("dashboard",{fontCharacter:"\\eacd"}),n.database=new n("database",{fontCharacter:"\\eace"}),n.debugContinue=new n("debug-continue",{fontCharacter:"\\eacf"}),n.debugDisconnect=new n("debug-disconnect",{fontCharacter:"\\ead0"}),n.debugPause=new n("debug-pause",{fontCharacter:"\\ead1"}),n.debugRestart=new n("debug-restart",{fontCharacter:"\\ead2"}),n.debugStart=new n("debug-start",{fontCharacter:"\\ead3"}),n.debugStepInto=new n("debug-step-into",{fontCharacter:"\\ead4"}),n.debugStepOut=new n("debug-step-out",{fontCharacter:"\\ead5"}),n.debugStepOver=new n("debug-step-over",{fontCharacter:"\\ead6"}),n.debugStop=new n("debug-stop",{fontCharacter:"\\ead7"}),n.debug=new n("debug",{fontCharacter:"\\ead8"}),n.deviceCameraVideo=new n("device-camera-video",{fontCharacter:"\\ead9"}),n.deviceCamera=new n("device-camera",{fontCharacter:"\\eada"}),n.deviceMobile=new n("device-mobile",{fontCharacter:"\\eadb"}),n.diffAdded=new n("diff-added",{fontCharacter:"\\eadc"}),n.diffIgnored=new n("diff-ignored",{fontCharacter:"\\eadd"}),n.diffModified=new n("diff-modified",{fontCharacter:"\\eade"}),n.diffRemoved=new n("diff-removed",{fontCharacter:"\\eadf"}),n.diffRenamed=new n("diff-renamed",{fontCharacter:"\\eae0"}),n.diff=new n("diff",{fontCharacter:"\\eae1"}),n.discard=new n("discard",{fontCharacter:"\\eae2"}),n.editorLayout=new n("editor-layout",{fontCharacter:"\\eae3"}),n.emptyWindow=new n("empty-window",{fontCharacter:"\\eae4"}),n.exclude=new n("exclude",{fontCharacter:"\\eae5"}),n.extensions=new n("extensions",{fontCharacter:"\\eae6"}),n.eyeClosed=new n("eye-closed",{fontCharacter:"\\eae7"}),n.fileBinary=new n("file-binary",{fontCharacter:"\\eae8"}),n.fileCode=new n("file-code",{fontCharacter:"\\eae9"}),n.fileMedia=new n("file-media",{fontCharacter:"\\eaea"}),n.filePdf=new n("file-pdf",{fontCharacter:"\\eaeb"}),n.fileSubmodule=new n("file-submodule",{fontCharacter:"\\eaec"}),n.fileSymlinkDirectory=new n("file-symlink-directory",{fontCharacter:"\\eaed"}),n.fileSymlinkFile=new n("file-symlink-file",{fontCharacter:"\\eaee"}),n.fileZip=new n("file-zip",{fontCharacter:"\\eaef"}),n.files=new n("files",{fontCharacter:"\\eaf0"}),n.filter=new n("filter",{fontCharacter:"\\eaf1"}),n.flame=new n("flame",{fontCharacter:"\\eaf2"}),n.foldDown=new n("fold-down",{fontCharacter:"\\eaf3"}),n.foldUp=new n("fold-up",{fontCharacter:"\\eaf4"}),n.fold=new n("fold",{fontCharacter:"\\eaf5"}),n.folderActive=new n("folder-active",{fontCharacter:"\\eaf6"}),n.folderOpened=new n("folder-opened",{fontCharacter:"\\eaf7"}),n.gear=new n("gear",{fontCharacter:"\\eaf8"}),n.gift=new n("gift",{fontCharacter:"\\eaf9"}),n.gistSecret=new n("gist-secret",{fontCharacter:"\\eafa"}),n.gist=new n("gist",{fontCharacter:"\\eafb"}),n.gitCommit=new n("git-commit",{fontCharacter:"\\eafc"}),n.gitCompare=new n("git-compare",{fontCharacter:"\\eafd"}),n.gitMerge=new n("git-merge",{fontCharacter:"\\eafe"}),n.githubAction=new n("github-action",{fontCharacter:"\\eaff"}),n.githubAlt=new n("github-alt",{fontCharacter:"\\eb00"}),n.globe=new n("globe",{fontCharacter:"\\eb01"}),n.grabber=new n("grabber",{fontCharacter:"\\eb02"}),n.graph=new n("graph",{fontCharacter:"\\eb03"}),n.gripper=new n("gripper",{fontCharacter:"\\eb04"}),n.heart=new n("heart",{fontCharacter:"\\eb05"}),n.home=new n("home",{fontCharacter:"\\eb06"}),n.horizontalRule=new n("horizontal-rule",{fontCharacter:"\\eb07"}),n.hubot=new n("hubot",{fontCharacter:"\\eb08"}),n.inbox=new n("inbox",{fontCharacter:"\\eb09"}),n.issueClosed=new n("issue-closed",{fontCharacter:"\\eba4"}),n.issueReopened=new n("issue-reopened",{fontCharacter:"\\eb0b"}),n.issues=new n("issues",{fontCharacter:"\\eb0c"}),n.italic=new n("italic",{fontCharacter:"\\eb0d"}),n.jersey=new n("jersey",{fontCharacter:"\\eb0e"}),n.json=new n("json",{fontCharacter:"\\eb0f"}),n.kebabVertical=new n("kebab-vertical",{fontCharacter:"\\eb10"}),n.key=new n("key",{fontCharacter:"\\eb11"}),n.law=new n("law",{fontCharacter:"\\eb12"}),n.lightbulbAutofix=new n("lightbulb-autofix",{fontCharacter:"\\eb13"}),n.linkExternal=new n("link-external",{fontCharacter:"\\eb14"}),n.link=new n("link",{fontCharacter:"\\eb15"}),n.listOrdered=new n("list-ordered",{fontCharacter:"\\eb16"}),n.listUnordered=new n("list-unordered",{fontCharacter:"\\eb17"}),n.liveShare=new n("live-share",{fontCharacter:"\\eb18"}),n.loading=new n("loading",{fontCharacter:"\\eb19"}),n.location=new n("location",{fontCharacter:"\\eb1a"}),n.mailRead=new n("mail-read",{fontCharacter:"\\eb1b"}),n.mail=new n("mail",{fontCharacter:"\\eb1c"}),n.markdown=new n("markdown",{fontCharacter:"\\eb1d"}),n.megaphone=new n("megaphone",{fontCharacter:"\\eb1e"}),n.mention=new n("mention",{fontCharacter:"\\eb1f"}),n.milestone=new n("milestone",{fontCharacter:"\\eb20"}),n.mortarBoard=new n("mortar-board",{fontCharacter:"\\eb21"}),n.move=new n("move",{fontCharacter:"\\eb22"}),n.multipleWindows=new n("multiple-windows",{fontCharacter:"\\eb23"}),n.mute=new n("mute",{fontCharacter:"\\eb24"}),n.noNewline=new n("no-newline",{fontCharacter:"\\eb25"}),n.note=new n("note",{fontCharacter:"\\eb26"}),n.octoface=new n("octoface",{fontCharacter:"\\eb27"}),n.openPreview=new n("open-preview",{fontCharacter:"\\eb28"}),n.package_=new n("package",{fontCharacter:"\\eb29"}),n.paintcan=new n("paintcan",{fontCharacter:"\\eb2a"}),n.pin=new n("pin",{fontCharacter:"\\eb2b"}),n.play=new n("play",{fontCharacter:"\\eb2c"}),n.run=new n("run",{fontCharacter:"\\eb2c"}),n.plug=new n("plug",{fontCharacter:"\\eb2d"}),n.preserveCase=new n("preserve-case",{fontCharacter:"\\eb2e"}),n.preview=new n("preview",{fontCharacter:"\\eb2f"}),n.project=new n("project",{fontCharacter:"\\eb30"}),n.pulse=new n("pulse",{fontCharacter:"\\eb31"}),n.question=new n("question",{fontCharacter:"\\eb32"}),n.quote=new n("quote",{fontCharacter:"\\eb33"}),n.radioTower=new n("radio-tower",{fontCharacter:"\\eb34"}),n.reactions=new n("reactions",{fontCharacter:"\\eb35"}),n.references=new n("references",{fontCharacter:"\\eb36"}),n.refresh=new n("refresh",{fontCharacter:"\\eb37"}),n.regex=new n("regex",{fontCharacter:"\\eb38"}),n.remoteExplorer=new n("remote-explorer",{fontCharacter:"\\eb39"}),n.remote=new n("remote",{fontCharacter:"\\eb3a"}),n.remove=new n("remove",{fontCharacter:"\\eb3b"}),n.replaceAll=new n("replace-all",{fontCharacter:"\\eb3c"}),n.replace=new n("replace",{fontCharacter:"\\eb3d"}),n.repoClone=new n("repo-clone",{fontCharacter:"\\eb3e"}),n.repoForcePush=new n("repo-force-push",{fontCharacter:"\\eb3f"}),n.repoPull=new n("repo-pull",{fontCharacter:"\\eb40"}),n.repoPush=new n("repo-push",{fontCharacter:"\\eb41"}),n.report=new n("report",{fontCharacter:"\\eb42"}),n.requestChanges=new n("request-changes",{fontCharacter:"\\eb43"}),n.rocket=new n("rocket",{fontCharacter:"\\eb44"}),n.rootFolderOpened=new n("root-folder-opened",{fontCharacter:"\\eb45"}),n.rootFolder=new n("root-folder",{fontCharacter:"\\eb46"}),n.rss=new n("rss",{fontCharacter:"\\eb47"}),n.ruby=new n("ruby",{fontCharacter:"\\eb48"}),n.saveAll=new n("save-all",{fontCharacter:"\\eb49"}),n.saveAs=new n("save-as",{fontCharacter:"\\eb4a"}),n.save=new n("save",{fontCharacter:"\\eb4b"}),n.screenFull=new n("screen-full",{fontCharacter:"\\eb4c"}),n.screenNormal=new n("screen-normal",{fontCharacter:"\\eb4d"}),n.searchStop=new n("search-stop",{fontCharacter:"\\eb4e"}),n.server=new n("server",{fontCharacter:"\\eb50"}),n.settingsGear=new n("settings-gear",{fontCharacter:"\\eb51"}),n.settings=new n("settings",{fontCharacter:"\\eb52"}),n.shield=new n("shield",{fontCharacter:"\\eb53"}),n.smiley=new n("smiley",{fontCharacter:"\\eb54"}),n.sortPrecedence=new n("sort-precedence",{fontCharacter:"\\eb55"}),n.splitHorizontal=new n("split-horizontal",{fontCharacter:"\\eb56"}),n.splitVertical=new n("split-vertical",{fontCharacter:"\\eb57"}),n.squirrel=new n("squirrel",{fontCharacter:"\\eb58"}),n.starFull=new n("star-full",{fontCharacter:"\\eb59"}),n.starHalf=new n("star-half",{fontCharacter:"\\eb5a"}),n.symbolClass=new n("symbol-class",{fontCharacter:"\\eb5b"}),n.symbolColor=new n("symbol-color",{fontCharacter:"\\eb5c"}),n.symbolConstant=new n("symbol-constant",{fontCharacter:"\\eb5d"}),n.symbolEnumMember=new n("symbol-enum-member",{fontCharacter:"\\eb5e"}),n.symbolField=new n("symbol-field",{fontCharacter:"\\eb5f"}),n.symbolFile=new n("symbol-file",{fontCharacter:"\\eb60"}),n.symbolInterface=new n("symbol-interface",{fontCharacter:"\\eb61"}),n.symbolKeyword=new n("symbol-keyword",{fontCharacter:"\\eb62"}),n.symbolMisc=new n("symbol-misc",{fontCharacter:"\\eb63"}),n.symbolOperator=new n("symbol-operator",{fontCharacter:"\\eb64"}),n.symbolProperty=new n("symbol-property",{fontCharacter:"\\eb65"}),n.wrench=new n("wrench",{fontCharacter:"\\eb65"}),n.wrenchSubaction=new n("wrench-subaction",{fontCharacter:"\\eb65"}),n.symbolSnippet=new n("symbol-snippet",{fontCharacter:"\\eb66"}),n.tasklist=new n("tasklist",{fontCharacter:"\\eb67"}),n.telescope=new n("telescope",{fontCharacter:"\\eb68"}),n.textSize=new n("text-size",{fontCharacter:"\\eb69"}),n.threeBars=new n("three-bars",{fontCharacter:"\\eb6a"}),n.thumbsdown=new n("thumbsdown",{fontCharacter:"\\eb6b"}),n.thumbsup=new n("thumbsup",{fontCharacter:"\\eb6c"}),n.tools=new n("tools",{fontCharacter:"\\eb6d"}),n.triangleDown=new n("triangle-down",{fontCharacter:"\\eb6e"}),n.triangleLeft=new n("triangle-left",{fontCharacter:"\\eb6f"}),n.triangleRight=new n("triangle-right",{fontCharacter:"\\eb70"}),n.triangleUp=new n("triangle-up",{fontCharacter:"\\eb71"}),n.twitter=new n("twitter",{fontCharacter:"\\eb72"}),n.unfold=new n("unfold",{fontCharacter:"\\eb73"}),n.unlock=new n("unlock",{fontCharacter:"\\eb74"}),n.unmute=new n("unmute",{fontCharacter:"\\eb75"}),n.unverified=new n("unverified",{fontCharacter:"\\eb76"}),n.verified=new n("verified",{fontCharacter:"\\eb77"}),n.versions=new n("versions",{fontCharacter:"\\eb78"}),n.vmActive=new n("vm-active",{fontCharacter:"\\eb79"}),n.vmOutline=new n("vm-outline",{fontCharacter:"\\eb7a"}),n.vmRunning=new n("vm-running",{fontCharacter:"\\eb7b"}),n.watch=new n("watch",{fontCharacter:"\\eb7c"}),n.whitespace=new n("whitespace",{fontCharacter:"\\eb7d"}),n.wholeWord=new n("whole-word",{fontCharacter:"\\eb7e"}),n.window=new n("window",{fontCharacter:"\\eb7f"}),n.wordWrap=new n("word-wrap",{fontCharacter:"\\eb80"}),n.zoomIn=new n("zoom-in",{fontCharacter:"\\eb81"}),n.zoomOut=new n("zoom-out",{fontCharacter:"\\eb82"}),n.listFilter=new n("list-filter",{fontCharacter:"\\eb83"}),n.listFlat=new n("list-flat",{fontCharacter:"\\eb84"}),n.listSelection=new n("list-selection",{fontCharacter:"\\eb85"}),n.selection=new n("selection",{fontCharacter:"\\eb85"}),n.listTree=new n("list-tree",{fontCharacter:"\\eb86"}),n.debugBreakpointFunctionUnverified=new n("debug-breakpoint-function-unverified",{fontCharacter:"\\eb87"}),n.debugBreakpointFunction=new n("debug-breakpoint-function",{fontCharacter:"\\eb88"}),n.debugBreakpointFunctionDisabled=new n("debug-breakpoint-function-disabled",{fontCharacter:"\\eb88"}),n.debugStackframeActive=new n("debug-stackframe-active",{fontCharacter:"\\eb89"}),n.debugStackframeDot=new n("debug-stackframe-dot",{fontCharacter:"\\eb8a"}),n.debugStackframe=new n("debug-stackframe",{fontCharacter:"\\eb8b"}),n.debugStackframeFocused=new n("debug-stackframe-focused",{fontCharacter:"\\eb8b"}),n.debugBreakpointUnsupported=new n("debug-breakpoint-unsupported",{fontCharacter:"\\eb8c"}),n.symbolString=new n("symbol-string",{fontCharacter:"\\eb8d"}),n.debugReverseContinue=new n("debug-reverse-continue",{fontCharacter:"\\eb8e"}),n.debugStepBack=new n("debug-step-back",{fontCharacter:"\\eb8f"}),n.debugRestartFrame=new n("debug-restart-frame",{fontCharacter:"\\eb90"}),n.callIncoming=new n("call-incoming",{fontCharacter:"\\eb92"}),n.callOutgoing=new n("call-outgoing",{fontCharacter:"\\eb93"}),n.menu=new n("menu",{fontCharacter:"\\eb94"}),n.expandAll=new n("expand-all",{fontCharacter:"\\eb95"}),n.feedback=new n("feedback",{fontCharacter:"\\eb96"}),n.groupByRefType=new n("group-by-ref-type",{fontCharacter:"\\eb97"}),n.ungroupByRefType=new n("ungroup-by-ref-type",{fontCharacter:"\\eb98"}),n.account=new n("account",{fontCharacter:"\\eb99"}),n.bellDot=new n("bell-dot",{fontCharacter:"\\eb9a"}),n.debugConsole=new n("debug-console",{fontCharacter:"\\eb9b"}),n.library=new n("library",{fontCharacter:"\\eb9c"}),n.output=new n("output",{fontCharacter:"\\eb9d"}),n.runAll=new n("run-all",{fontCharacter:"\\eb9e"}),n.syncIgnored=new n("sync-ignored",{fontCharacter:"\\eb9f"}),n.pinned=new n("pinned",{fontCharacter:"\\eba0"}),n.githubInverted=new n("github-inverted",{fontCharacter:"\\eba1"}),n.debugAlt=new n("debug-alt",{fontCharacter:"\\eb91"}),n.serverProcess=new n("server-process",{fontCharacter:"\\eba2"}),n.serverEnvironment=new n("server-environment",{fontCharacter:"\\eba3"}),n.pass=new n("pass",{fontCharacter:"\\eba4"}),n.stopCircle=new n("stop-circle",{fontCharacter:"\\eba5"}),n.playCircle=new n("play-circle",{fontCharacter:"\\eba6"}),n.record=new n("record",{fontCharacter:"\\eba7"}),n.debugAltSmall=new n("debug-alt-small",{fontCharacter:"\\eba8"}),n.vmConnect=new n("vm-connect",{fontCharacter:"\\eba9"}),n.cloud=new n("cloud",{fontCharacter:"\\ebaa"}),n.merge=new n("merge",{fontCharacter:"\\ebab"}),n.exportIcon=new n("export",{fontCharacter:"\\ebac"}),n.graphLeft=new n("graph-left",{fontCharacter:"\\ebad"}),n.magnet=new n("magnet",{fontCharacter:"\\ebae"}),n.notebook=new n("notebook",{fontCharacter:"\\ebaf"}),n.redo=new n("redo",{fontCharacter:"\\ebb0"}),n.checkAll=new n("check-all",{fontCharacter:"\\ebb1"}),n.pinnedDirty=new n("pinned-dirty",{fontCharacter:"\\ebb2"}),n.passFilled=new n("pass-filled",{fontCharacter:"\\ebb3"}),n.circleLargeFilled=new n("circle-large-filled",{fontCharacter:"\\ebb4"}),n.circleLargeOutline=new n("circle-large-outline",{fontCharacter:"\\ebb5"}),n.combine=new n("combine",{fontCharacter:"\\ebb6"}),n.gather=new n("gather",{fontCharacter:"\\ebb6"}),n.table=new n("table",{fontCharacter:"\\ebb7"}),n.variableGroup=new n("variable-group",{fontCharacter:"\\ebb8"}),n.typeHierarchy=new n("type-hierarchy",{fontCharacter:"\\ebb9"}),n.typeHierarchySub=new n("type-hierarchy-sub",{fontCharacter:"\\ebba"}),n.typeHierarchySuper=new n("type-hierarchy-super",{fontCharacter:"\\ebbb"}),n.gitPullRequestCreate=new n("git-pull-request-create",{fontCharacter:"\\ebbc"}),n.runAbove=new n("run-above",{fontCharacter:"\\ebbd"}),n.runBelow=new n("run-below",{fontCharacter:"\\ebbe"}),n.notebookTemplate=new n("notebook-template",{fontCharacter:"\\ebbf"}),n.debugRerun=new n("debug-rerun",{fontCharacter:"\\ebc0"}),n.workspaceTrusted=new n("workspace-trusted",{fontCharacter:"\\ebc1"}),n.workspaceUntrusted=new n("workspace-untrusted",{fontCharacter:"\\ebc2"}),n.workspaceUnspecified=new n("workspace-unspecified",{fontCharacter:"\\ebc3"}),n.terminalCmd=new n("terminal-cmd",{fontCharacter:"\\ebc4"}),n.terminalDebian=new n("terminal-debian",{fontCharacter:"\\ebc5"}),n.terminalLinux=new n("terminal-linux",{fontCharacter:"\\ebc6"}),n.terminalPowershell=new n("terminal-powershell",{fontCharacter:"\\ebc7"}),n.terminalTmux=new n("terminal-tmux",{fontCharacter:"\\ebc8"}),n.terminalUbuntu=new n("terminal-ubuntu",{fontCharacter:"\\ebc9"}),n.terminalBash=new n("terminal-bash",{fontCharacter:"\\ebca"}),n.arrowSwap=new n("arrow-swap",{fontCharacter:"\\ebcb"}),n.copy=new n("copy",{fontCharacter:"\\ebcc"}),n.personAdd=new n("person-add",{fontCharacter:"\\ebcd"}),n.filterFilled=new n("filter-filled",{fontCharacter:"\\ebce"}),n.wand=new n("wand",{fontCharacter:"\\ebcf"}),n.debugLineByLine=new n("debug-line-by-line",{fontCharacter:"\\ebd0"}),n.inspect=new n("inspect",{fontCharacter:"\\ebd1"}),n.layers=new n("layers",{fontCharacter:"\\ebd2"}),n.layersDot=new n("layers-dot",{fontCharacter:"\\ebd3"}),n.layersActive=new n("layers-active",{fontCharacter:"\\ebd4"}),n.compass=new n("compass",{fontCharacter:"\\ebd5"}),n.compassDot=new n("compass-dot",{fontCharacter:"\\ebd6"}),n.compassActive=new n("compass-active",{fontCharacter:"\\ebd7"}),n.azure=new n("azure",{fontCharacter:"\\ebd8"}),n.issueDraft=new n("issue-draft",{fontCharacter:"\\ebd9"}),n.gitPullRequestClosed=new n("git-pull-request-closed",{fontCharacter:"\\ebda"}),n.gitPullRequestDraft=new n("git-pull-request-draft",{fontCharacter:"\\ebdb"}),n.debugAll=new n("debug-all",{fontCharacter:"\\ebdc"}),n.debugCoverage=new n("debug-coverage",{fontCharacter:"\\ebdd"}),n.runErrors=new n("run-errors",{fontCharacter:"\\ebde"}),n.folderLibrary=new n("folder-library",{fontCharacter:"\\ebdf"}),n.debugContinueSmall=new n("debug-continue-small",{fontCharacter:"\\ebe0"}),n.beakerStop=new n("beaker-stop",{fontCharacter:"\\ebe1"}),n.graphLine=new n("graph-line",{fontCharacter:"\\ebe2"}),n.graphScatter=new n("graph-scatter",{fontCharacter:"\\ebe3"}),n.pieChart=new n("pie-chart",{fontCharacter:"\\ebe4"}),n.bracket=new n("bracket",n.json.definition),n.bracketDot=new n("bracket-dot",{fontCharacter:"\\ebe5"}),n.bracketError=new n("bracket-error",{fontCharacter:"\\ebe6"}),n.lockSmall=new n("lock-small",{fontCharacter:"\\ebe7"}),n.azureDevops=new n("azure-devops",{fontCharacter:"\\ebe8"}),n.verifiedFilled=new n("verified-filled",{fontCharacter:"\\ebe9"})})(Ce||(Ce={}));class Qs{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&1792)>>>8}static getFontStyle(e){return(e&14336)>>>11}static getForeground(e){return(e&8372224)>>>14}static getBackground(e){return(e&4286578688)>>>23}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e),r=this.getFontStyle(e);return r&1&&(i+=" mtki"),r&2&&(i+=" mtkb"),r&4&&(i+=" mtku"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),r=this.getFontStyle(e);let s=`color: ${t[i]};`;return r&1&&(s+="font-style: italic;"),r&2&&(s+="font-weight: bold;"),r&4&&(s+="text-decoration: underline;"),s}}const $Le=function(){let n=Object.create(null);return n[0]="symbol-method",n[1]="symbol-function",n[2]="symbol-constructor",n[3]="symbol-field",n[4]="symbol-variable",n[5]="symbol-class",n[6]="symbol-struct",n[7]="symbol-interface",n[8]="symbol-module",n[9]="symbol-property",n[10]="symbol-event",n[11]="symbol-operator",n[12]="symbol-unit",n[13]="symbol-value",n[14]="symbol-constant",n[15]="symbol-enum",n[16]="symbol-enum-member",n[17]="symbol-keyword",n[27]="symbol-snippet",n[18]="symbol-text",n[19]="symbol-color",n[20]="symbol-file",n[21]="symbol-reference",n[22]="symbol-customcolor",n[23]="symbol-folder",n[24]="symbol-type-parameter",n[25]="account",n[26]="issues",function(e){const t=n[e];let i=t&&xE.get(t);return i||(console.info("No codicon found for CompletionItemKind "+e),i=Ce.symbolProperty),i.classNames}}();let ZQ=function(){let n=Object.create(null);return n.method=0,n.function=1,n.constructor=2,n.field=3,n.variable=4,n.class=5,n.struct=6,n.interface=7,n.module=8,n.property=9,n.event=10,n.operator=11,n.unit=12,n.value=13,n.constant=14,n.enum=15,n["enum-member"]=16,n.enumMember=16,n.keyword=17,n.snippet=27,n.text=18,n.color=19,n.file=20,n.reference=21,n.customcolor=22,n.folder=23,n["type-parameter"]=24,n.typeParameter=24,n.account=25,n.issue=26,function(e,t){let i=n[e];return typeof i>"u"&&!t&&(i=9),i}}();var Js;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(Js||(Js={}));var fW;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(fW||(fW={}));var gW;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(gW||(gW={}));function zLe(n){return n&&qe.isUri(n.uri)&&V.isIRange(n.range)&&(V.isIRange(n.originSelectionRange)||V.isIRange(n.targetSelectionRange))}var pW;(function(n){const e=new Map;e.set("file",0),e.set("module",1),e.set("namespace",2),e.set("package",3),e.set("class",4),e.set("method",5),e.set("property",6),e.set("field",7),e.set("constructor",8),e.set("enum",9),e.set("interface",10),e.set("function",11),e.set("variable",12),e.set("constant",13),e.set("string",14),e.set("number",15),e.set("boolean",16),e.set("array",17),e.set("object",18),e.set("key",19),e.set("null",20),e.set("enum-member",21),e.set("struct",22),e.set("event",23),e.set("operator",24),e.set("type-parameter",25);const t=new Map;t.set(0,"file"),t.set(1,"module"),t.set(2,"namespace"),t.set(3,"package"),t.set(4,"class"),t.set(5,"method"),t.set(6,"property"),t.set(7,"field"),t.set(8,"constructor"),t.set(9,"enum"),t.set(10,"interface"),t.set(11,"function"),t.set(12,"variable"),t.set(13,"constant"),t.set(14,"string"),t.set(15,"number"),t.set(16,"boolean"),t.set(17,"array"),t.set(18,"object"),t.set(19,"key"),t.set(20,"null"),t.set(21,"enum-member"),t.set(22,"struct"),t.set(23,"event"),t.set(24,"operator"),t.set(25,"type-parameter");function i(o){return e.get(o)}n.fromString=i;function r(o){return t.get(o)}n.toString=r;function s(o,a){const l=t.get(o);let c=l&&xE.get("symbol-"+l);return c||(console.info("No codicon found for SymbolKind "+o),c=Ce.symbolProperty),`${a?"inline":"block"} ${c.classNames}`}n.toCssClassName=s})(pW||(pW={}));class Ka{constructor(e){this.value=e}}Ka.Comment=new Ka("comment");Ka.Imports=new Ka("imports");Ka.Region=new Ka("region");var mW;(function(n){n[n.Other=0]="Other",n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(mW||(mW={}));const EE=new Ti,VM=new Ti,Da=new Ti,G3=new Ti,WM=new Ti,bw=new Ti,$M=new Ti,DE=new Ti,HLe=new Ti,vw=new Ti,kE=new Ti,LE=new Ti,IE=new Ti,zM=new Ti,HM=new Ti,Jl=new Ti,Jb=new Ti,nu=new Ti,YQ=new Ti,XQ=new Ti,y_=new Ti,ULe=new Ti,UM=new Ti,C_=new Ti,QQ=new Ti,Fi=new BLe;class jLe{clone(){return this}equals(e){return this===e}}const Jk=new jLe,qu="vs.editor.nullMode";function qLe(n,e,t,i){return new k3([new jk(i,"",n)],t)}function JQ(n,e,t,i){let r=new Uint32Array(2);return r[0]=i,r[1]=(n<<0|0<<8|0<<11|1<<14|2<<23)>>>0,new qk(r,t===null?Jk:t)}const GLe="editorWorkerService",pd=Dt(GLe),Zr=Dt("modeService"),sc=Dt("textModelService"),KLe="$initialize";let _W=!1;function jM(n){hy&&(_W||(_W=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(n.message))}class ZLe{constructor(e,t,i,r){this.vsWorker=e,this.req=t,this.method=i,this.args=r,this.type=0}}class bW{constructor(e,t,i,r){this.vsWorker=e,this.seq=t,this.res=i,this.err=r,this.type=1}}class YLe{constructor(e,t,i,r){this.vsWorker=e,this.req=t,this.eventName=i,this.arg=r,this.type=2}}class XLe{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class QLe{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class JLe{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const i=String(++this._lastSentReq);return new Promise((r,s)=>{this._pendingReplies[i]={resolve:r,reject:s},this._send(new ZLe(this._workerId,i,e,t))})}listen(e,t){let i=null;const r=new H({onFirstListenerAdd:()=>{i=String(++this._lastSentReq),this._pendingEmitters.set(i,r),this._send(new YLe(this._workerId,i,e,t))},onLastListenerRemove:()=>{this._pendingEmitters.delete(i),this._send(new QLe(this._workerId,i)),i=null}});return r.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}let t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){let t=e.req;this._handler.handleMessage(e.method,e.args).then(r=>{this._send(new bW(this._workerId,t,r,void 0))},r=>{r.detail instanceof Error&&(r.detail=HV(r.detail)),this._send(new bW(this._workerId,t,void 0,HV(r)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.eventName,e.arg)(r=>{this._send(new XLe(this._workerId,t,r))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){let t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class e2e extends re{constructor(e,t,i){super();let r=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",c=>{this._protocol.handleMessage(c)},c=>{r&&r(c)})),this._protocol=new JLe({sendMessage:(c,h)=>{this._worker.postMessage(c,h)},handleMessage:(c,h)=>{if(typeof i[c]!="function")return Promise.reject(new Error("Missing method "+c+" on main thread host."));try{return Promise.resolve(i[c].apply(i,h))}catch(u){return Promise.reject(u)}},handleEvent:(c,h)=>{if(tJ(c)){const u=i[c].call(i,h);if(typeof u!="function")throw new Error(`Missing dynamic event ${c} on main thread host.`);return u}if(eJ(c)){const u=i[c];if(typeof u!="function")throw new Error(`Missing event ${c} on main thread host.`);return u}throw new Error(`Malformed event name ${c}`)}}),this._protocol.setWorkerId(this._worker.getId());let s=null;typeof hi.require<"u"&&typeof hi.require.getConfig=="function"?s=hi.require.getConfig():typeof hi.requirejs<"u"&&(s=hi.requirejs.s.contexts._.config);const o=z3(i);this._onModuleLoaded=this._protocol.sendMessage(KLe,[this._worker.getId(),JSON.parse(JSON.stringify(s)),t,o]);const a=(c,h)=>this._request(c,h),l=(c,h)=>this._protocol.listen(c,h);this._lazyProxy=new Promise((c,h)=>{r=h,this._onModuleLoaded.then(u=>{c(t2e(u,a,l))},u=>{h(u),this._onError("Worker failed to load "+t,u)})})}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise((i,r)=>{this._onModuleLoaded.then(()=>{this._protocol.sendMessage(e,t).then(i,r)},r)})}_onError(e,t){console.error(e),console.info(t)}}function eJ(n){return n[0]==="o"&&n[1]==="n"&&Xh(n.charCodeAt(2))}function tJ(n){return/^onDynamic/.test(n)&&Xh(n.charCodeAt(9))}function t2e(n,e,t){const i=o=>function(){const a=Array.prototype.slice.call(arguments,0);return e(o,a)},r=o=>function(a){return t(o,a)};let s={};for(const o of n){if(tJ(o)){s[o]=r(o);continue}if(eJ(o)){s[o]=t(o,void 0);continue}s[o]=i(o)}return s}var dT;const vW=(dT=window.trustedTypes)===null||dT===void 0?void 0:dT.createPolicy("defaultWorkerFactory",{createScriptURL:n=>n});function i2e(n,e){if(hi.MonacoEnvironment){if(typeof hi.MonacoEnvironment.getWorker=="function")return hi.MonacoEnvironment.getWorker(n,e);if(typeof hi.MonacoEnvironment.getWorkerUrl=="function"){const t=hi.MonacoEnvironment.getWorkerUrl(n,e);return new Worker(vW?vW.createScriptURL(t):t,{name:e})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function n2e(n){return typeof n.then=="function"}class r2e{constructor(e,t,i,r,s){this.id=t;const o=i2e("workerMain.js",i);n2e(o)?this.worker=o:this.worker=Promise.resolve(o),this.postMessage(e,[]),this.worker.then(a=>{a.onmessage=function(l){r(l.data)},a.onmessageerror=s,typeof a.addEventListener=="function"&&a.addEventListener("error",s)})}getId(){return this.id}postMessage(e,t){this.worker&&this.worker.then(i=>i.postMessage(e,t))}dispose(){this.worker&&this.worker.then(e=>e.terminate()),this.worker=null}}class eL{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){let r=++eL.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new r2e(e,r,this._label||"anonymous"+r,t,s=>{jM(s),this._webWorkerFailedBeforeError=s,i(s)})}}eL.LAST_WORKER_ID=0;var _n;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(_n||(_n={}));class fT{constructor(e){if(this._standardAutoClosingPairConditionalBrand=void 0,this.open=e.open,this.close=e.close,this._standardTokenMask=0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._standardTokenMask|=2;break;case"comment":this._standardTokenMask|=1;break;case"regex":this._standardTokenMask|=4;break}}isOK(e){return(this._standardTokenMask&e)===0}}class s2e{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)K0(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),K0(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),K0(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),K0(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&K0(this.autoClosingPairsCloseSingleChar,t.close,t)}}function K0(n,e,t){n.has(e)?n.get(e).push(t):n.set(e,[t])}function gC(n,e){let t=n.getCount(),i=n.findTokenIndexAtOffset(e),r=n.getLanguageId(i),s=i;for(;s+1<t&&n.getLanguageId(s+1)===r;)s++;let o=i;for(;o>0&&n.getLanguageId(o-1)===r;)o--;return new o2e(n,r,o,s+1,n.getStartOffset(o),n.getEndOffset(s))}class o2e{constructor(e,t,i,r,s,o){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=r,this.firstCharOffset=s,this._lastCharOffset=o}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function wl(n){return(n&7)!==0}class S_{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new fT(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new fT({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.colorizedBracketPairs?this._colorizedBracketPairs=wW(e.colorizedBracketPairs.map(t=>[t[0],t[1]])):e.brackets?this._colorizedBracketPairs=wW(e.brackets.map(t=>[t[0],t[1]]).filter(t=>!(t[0]==="<"&&t[1]===">"))):this._colorizedBracketPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new fT({open:t.open,close:t.close||""}))}this._autoCloseBefore=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:S_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(){return this._autoCloseBefore}static shouldAutoClosePair(e,t,i){if(t.getTokenCount()===0)return!0;const r=t.findTokenIndexAtOffset(i-2),s=t.getStandardTokenType(r);return e.isOK(s)}getSurroundingPairs(){return this._surroundingPairs}getColorizedBrackets(){return this._colorizedBracketPairs}}S_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED=`;:.,=}])> 
	`;function wW(n){return n.filter(([e,t])=>e!==""&&t!=="")}let gT;function iJ(){return gT||(gT=new TextDecoder("UTF-16LE")),gT}let pT;function a2e(){return pT||(pT=new TextDecoder("UTF-16BE")),pT}let mT;function nJ(){return mT||(mT=JX()?iJ():a2e()),mT}const rJ=typeof TextDecoder<"u";let og,qM;rJ?(og=n=>new c2e(n),qM=l2e):(og=n=>new h2e,qM=sJ);function l2e(n,e,t){const i=new Uint16Array(n.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?sJ(n,e,t):iJ().decode(i)}function sJ(n,e,t){let i=[],r=0;for(let s=0;s<t;s++){const o=Kke(n,e);e+=2,i[r++]=String.fromCharCode(o)}return i.join("")}class c2e{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return nJ().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}write1(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||Ln(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCII(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIIString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class h2e{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCII(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCIIString(e){this._pieces[this._piecesLen++]=e}}class TE{constructor(e,t,i,r,s,o){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=r,this.forwardRegex=s,this.reversedRegex=o,this._openSet=TE._toSet(this.open),this._closeSet=TE._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function u2e(n){const e=n.length;n=n.map(o=>[o[0].toLowerCase(),o[1].toLowerCase()]);const t=[];for(let o=0;o<e;o++)t[o]=o;const i=(o,a)=>{const[l,c]=o,[h,u]=a;return l===h||l===u||c===h||c===u},r=(o,a)=>{const l=Math.min(o,a),c=Math.max(o,a);for(let h=0;h<e;h++)t[h]===c&&(t[h]=l)};for(let o=0;o<e;o++){const a=n[o];for(let l=o+1;l<e;l++){const c=n[l];i(a,c)&&r(t[o],t[l])}}const s=[];for(let o=0;o<e;o++){let a=[],l=[];for(let c=0;c<e;c++)if(t[c]===o){const[h,u]=n[c];a.push(h),l.push(u)}a.length>0&&s.push({open:a,close:l})}return s}class d2e{constructor(e,t){this._richEditBracketsBrand=void 0;const i=u2e(t);this.brackets=i.map((r,s)=>new TE(e,s,r.open,r.close,f2e(r.open,r.close,i,s),g2e(r.open,r.close,i,s))),this.forwardRegex=p2e(this.brackets),this.reversedRegex=m2e(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const r of this.brackets){for(const s of r.open)this.textIsBracket[s]=r,this.textIsOpenBracket[s]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,s.length);for(const s of r.close)this.textIsBracket[s]=r,this.textIsOpenBracket[s]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,s.length)}}}function oJ(n,e,t,i){for(let r=0,s=e.length;r<s;r++){if(r===t)continue;const o=e[r];for(const a of o.open)a.indexOf(n)>=0&&i.push(a);for(const a of o.close)a.indexOf(n)>=0&&i.push(a)}}function aJ(n,e){return n.length-e.length}function tL(n){if(n.length<=1)return n;const e=[],t=new Set;for(const i of n)t.has(i)||(e.push(i),t.add(i));return e}function f2e(n,e,t,i){let r=[];r=r.concat(n),r=r.concat(e);for(let s=0,o=r.length;s<o;s++)oJ(r[s],t,i,r);return r=tL(r),r.sort(aJ),r.reverse(),iL(r)}function g2e(n,e,t,i){let r=[];r=r.concat(n),r=r.concat(e);for(let s=0,o=r.length;s<o;s++)oJ(r[s],t,i,r);return r=tL(r),r.sort(aJ),r.reverse(),iL(r.map(K3))}function p2e(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=tL(e),iL(e)}function m2e(n){let e=[];for(const t of n){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=tL(e),iL(e.map(K3))}function _2e(n){const e=/^[\w ]+$/.test(n);return n=ja(n),e?`\\b${n}\\b`:n}function iL(n){let e=`(${n.map(_2e).join(")|(")})`;return RQ(e,!0)}const K3=function(){function n(i){if(rJ){const r=new Uint16Array(i.length);let s=0;for(let o=i.length-1;o>=0;o--)r[s++]=i.charCodeAt(o);return nJ().decode(r)}else{let r=[],s=0;for(let o=i.length-1;o>=0;o--)r[s++]=i.charAt(o);return r.join("")}}let e=null,t=null;return function(r){return e!==r&&(e=r,t=n(e)),t}}();class Do{static _findPrevBracketInText(e,t,i,r){let s=i.match(e);if(!s)return null;let o=i.length-(s.index||0),a=s[0].length,l=r+o;return new V(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,r,s){const a=K3(i).substring(i.length-s,i.length-r);return this._findPrevBracketInText(e,t,a,r)}static findNextBracketInText(e,t,i,r){let s=i.match(e);if(!s)return null;let o=s.index||0,a=s[0].length;if(a===0)return null;let l=r+o;return new V(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,r,s){const o=i.substring(r,s);return this.findNextBracketInText(e,t,o,r)}}class b2e{constructor(e){this._richEditBrackets=e}getElectricCharacters(){let e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const r=i.charAt(i.length-1);e.push(r)}return e=e.filter((t,i,r)=>r.indexOf(t)===i),e}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const r=t.findTokenIndexAtOffset(i-1);if(wl(t.getStandardTokenType(r)))return null;const s=this._richEditBrackets.reversedRegex,o=t.getLineContent().substring(0,i-1)+e,a=Do.findPrevBracketInRange(s,1,o,0,o.length);if(!a)return null;const l=o.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const h=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(h)?{matchOpenBracket:l}:null}}function pC(n){return n.global&&(n.lastIndex=0),!0}class v2e{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&pC(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&pC(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&pC(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&pC(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class Qp{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=Qp._createOpenBracketRegExp(t[0]),r=Qp._createCloseBracketRegExp(t[1]);i&&r&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:r})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,r){if(e>=3)for(let s=0,o=this._regExpRules.length;s<o;s++){let a=this._regExpRules[s];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:r},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&r.length>0)for(let s=0,o=this._brackets.length;s<o;s++){let a=this._brackets[s];if(a.openRegExp.test(i)&&a.closeRegExp.test(r))return{indentAction:_n.IndentOutdent}}if(e>=2&&i.length>0){for(let s=0,o=this._brackets.length;s<o;s++)if(this._brackets[s].openRegExp.test(i))return{indentAction:_n.Indent}}return null}static _createOpenBracketRegExp(e){let t=ja(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",Qp._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=ja(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,Qp._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return it(t),null}}}class w2e{constructor(){this.data=new Map}add(e,t){FS(Ga(e)),FS(Br(t)),FS(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const Bn=new w2e,nL={JSONContribution:"base.contributions.json"};function y2e(n){return n.length>0&&n.charAt(n.length-1)==="#"?n.substring(0,n.length-1):n}class C2e{constructor(){this._onDidChangeSchema=new H,this.schemasById={}}registerSchema(e,t){this.schemasById[y2e(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const S2e=new C2e;Bn.add(nL.JSONContribution,S2e);const b0={Configuration:"base.contributions.configuration"},_T="vscode://schemas/settings/resourceLanguage",yW=Bn.as(nL.JSONContribution);class x2e{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new H,this._onDidUpdateConfiguration=new H,this.defaultValues={},this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:v("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},yW.registerSchema(_T,this.resourceLanguageSettingsSchema)}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=this.doRegisterConfigurations(e,t);yW.registerSchema(_T,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(i)}registerOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t){const i=[];return e.forEach(r=>{i.push(...this.validateAndRegisterProperties(r,t,r.extensionInfo)),this.configurationContributors.push(r),this.registerJSONConfiguration(r)}),i}validateAndRegisterProperties(e,t=!0,i,r=3){var s;r=Xs(e.scope)?r:e.scope;let o=[],a=e.properties;if(a)for(let c in a){if(t&&L2e(c)){delete a[c];continue}const h=a[c];if(this.updatePropertyDefaultValue(c,h),Z3.test(c)?h.scope=void 0:(h.scope=Xs(h.scope)?r:h.scope,h.restricted=Xs(h.restricted)?!!(!((s=i==null?void 0:i.restrictedConfigurations)===null||s===void 0)&&s.includes(c)):h.restricted),a[c].hasOwnProperty("included")&&!a[c].included){this.excludedConfigurationProperties[c]=a[c],delete a[c];continue}else this.configurationProperties[c]=a[c];!a[c].deprecationMessage&&a[c].markdownDeprecationMessage&&(a[c].deprecationMessage=a[c].markdownDeprecationMessage),o.push(c)}let l=e.allOf;if(l)for(let c of l)o.push(...this.validateAndRegisterProperties(c,t,i,r));return o}getConfigurationProperties(){return this.configurationProperties}registerJSONConfiguration(e){const t=i=>{let r=i.properties;if(r)for(const o in r)this.updateSchema(o,r[o]);let s=i.allOf;s&&s.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:v("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:v("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:_T};this.updatePropertyDefaultValue(t,i)}this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let i=this.defaultValues[e];yr(i)&&(i=t.default),yr(i)&&(i=k2e(t.type)),t.default=i}}const E2e="\\[.*\\]$",Z3=new RegExp(E2e);function D2e(n){return n.substring(1,n.length-1)}function k2e(n){switch(Array.isArray(n)?n[0]:n){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const lJ=new x2e;Bn.add(b0.Configuration,lJ);function L2e(n){return n.trim()?Z3.test(n)?v("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",n):lJ.getConfigurationProperties()[n]!==void 0?v("config.property.duplicate","Cannot register '{0}'. This property is already registered.",n):null:v("config.property.empty","Cannot register an empty property")}const Zi=Dt("configurationService");function cJ(n,e){const t=Object.create(null);for(let i in n)Y3(t,i,n[i],e);return t}function Y3(n,e,t,i){const r=e.split("."),s=r.pop();let o=n;for(let a=0;a<r.length;a++){let l=r[a],c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":break;default:i(`Ignoring ${e} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{i(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}function I2e(n,e){const t=e.split(".");hJ(n,t)}function hJ(n,e){const t=e.shift();if(e.length===0){delete n[t];return}if(Object.keys(n).indexOf(t)!==-1){const i=n[t];typeof i=="object"&&!Array.isArray(i)&&(hJ(i,e),Object.keys(i).length===0&&delete n[t])}}function T2e(n,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const r=e.split("."),s=i(n,r);return typeof s>"u"?t:s}function A2e(){const n=Bn.as(b0.Configuration).getConfigurationProperties();return Object.keys(n)}function N2e(){const n=Object.create(null),e=Bn.as(b0.Configuration).getConfigurationProperties();for(let t in e){let i=e[t].default;Y3(n,t,i,r=>console.error(`Conflict in default settings: ${r}`))}return n}class Qh{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const uJ=[];function Wg(n,e,t){e instanceof Qh||(e=new Qh(e,[],t)),uJ.push([n,e])}function R2e(){return uJ}var M2e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},CW=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class bT{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const my=Dt("languageConfigurationService");let AE=class extends re{constructor(e,t){super(),this.configurationService=e,this.modeService=t,this.onDidChangeEmitter=this._register(new H),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(GM));this._register(this.configurationService.onDidChangeConfiguration(r=>{const s=r.change.keys.some(a=>i.has(a)),o=r.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>this.modeService.validateLanguageId(a));if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new bT(void 0));else for(const a of o)a&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new bT(a)))})),this._register(zi.onDidChange(r=>{this.configurations.delete(r.languageId),this.onDidChangeEmitter.fire(new bT(r.languageId))}))}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=F2e(e,this.configurationService,this.modeService),this.configurations.set(e,t)),t}};AE=M2e([CW(0,Zi),CW(1,Zr)],AE);function F2e(n,e,t){let i=zi.getLanguageConfiguration(n);if(!i){const a=t.validateLanguageId(n);if(!a)throw new Error("Unexpected languageId");i=new ww(a,{})}const r=O2e(i.languageId,e),s=dJ([i.underlyingConfig,r]);return new ww(i.languageId,s)}const GM={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function O2e(n,e){const t=e.getValue(GM.brackets,{overrideIdentifier:n}),i=e.getValue(GM.colorizedBracketPairs,{overrideIdentifier:n});return{brackets:SW(t),colorizedBracketPairs:SW(i)}}function SW(n){if(Array.isArray(n))return n.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}class xW{constructor(e){this.languageId=e}}class P2e{constructor(){this._entries=new Map,this._onDidChange=new H,this.onDidChange=this._onDidChange.event}register(e,t,i=0){let r=this._entries.get(e);r||(r=new B2e(e),this._entries.set(e,r));const s=r.register(t,i);return this._onDidChange.fire(new xW(e)),Et(()=>{s.dispose(),this._onDidChange.fire(new xW(e))})}getLanguageConfiguration(e){let t=this._entries.get(e);return(t==null?void 0:t.getResolvedConfiguration())||null}getIndentationRules(e){const t=this.getLanguageConfiguration(e);return t&&t.indentationRules||null}_getElectricCharacterSupport(e){let t=this.getLanguageConfiguration(e);return t&&t.electricCharacter||null}getElectricCharacters(e){let t=this._getElectricCharacterSupport(e);return t?t.getElectricCharacters():[]}onElectricCharacter(e,t,i){let r=gC(t,i-1),s=this._getElectricCharacterSupport(r.languageId);return s?s.onElectricCharacter(e,r,i-r.firstCharOffset):null}getComments(e){let t=this.getLanguageConfiguration(e);return t&&t.comments||null}_getCharacterPairSupport(e){let t=this.getLanguageConfiguration(e);return t&&t.characterPair||null}getAutoClosingPairs(e){const t=this._getCharacterPairSupport(e);return new s2e(t?t.getAutoClosingPairs():[])}getAutoCloseBeforeSet(e){let t=this._getCharacterPairSupport(e);return t?t.getAutoCloseBeforeSet():S_.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED}getSurroundingPairs(e){let t=this._getCharacterPairSupport(e);return t?t.getSurroundingPairs():[]}shouldAutoClosePair(e,t,i){const r=gC(t,i-1);return S_.shouldAutoClosePair(e,r,i-r.firstCharOffset)}getWordDefinition(e){let t=this.getLanguageConfiguration(e);return uE(t&&t.wordDefinition||null)}getFoldingRules(e){let t=this.getLanguageConfiguration(e);return t?t.foldingRules:{}}getIndentRulesSupport(e){let t=this.getLanguageConfiguration(e);return t&&t.indentRulesSupport||null}getPrecedingValidLine(e,t,i){let r=e.getLanguageIdAtPosition(t,0);if(t>1){let s,o=-1;for(s=t-1;s>=1;s--){if(e.getLanguageIdAtPosition(s,0)!==r)return o;let a=e.getLineContent(s);if(i.shouldIgnore(a)||/^\s+$/.test(a)||a===""){o=s;continue}return s}}return-1}getInheritIndentForLine(e,t,i,r=!0){if(e<4)return null;const s=this.getIndentRulesSupport(t.getLanguageId());if(!s)return null;if(i<=1)return{indentation:"",action:null};const o=this.getPrecedingValidLine(t,i,s);if(o<0)return null;if(o<1)return{indentation:"",action:null};const a=t.getLineContent(o);if(s.shouldIncrease(a)||s.shouldIndentNextLine(a))return{indentation:rn(a),action:_n.Indent,line:o};if(s.shouldDecrease(a))return{indentation:rn(a),action:null,line:o};{if(o===1)return{indentation:rn(t.getLineContent(o)),action:null,line:o};const l=o-1,c=s.getIndentMetadata(t.getLineContent(l));if(!(c&3)&&c&4){let h=0;for(let u=l-1;u>0;u--)if(!s.shouldIndentNextLine(t.getLineContent(u))){h=u;break}return{indentation:rn(t.getLineContent(h+1)),action:null,line:h+1}}if(r)return{indentation:rn(t.getLineContent(o)),action:null,line:o};for(let h=o;h>0;h--){const u=t.getLineContent(h);if(s.shouldIncrease(u))return{indentation:rn(u),action:_n.Indent,line:h};if(s.shouldIndentNextLine(u)){let d=0;for(let f=h-1;f>0;f--)if(!s.shouldIndentNextLine(t.getLineContent(h))){d=f;break}return{indentation:rn(t.getLineContent(d+1)),action:null,line:d+1}}else if(s.shouldDecrease(u))return{indentation:rn(u),action:null,line:h}}return{indentation:rn(t.getLineContent(1)),action:null,line:1}}}getGoodIndentForLine(e,t,i,r,s){if(e<4)return null;const o=this.getLanguageConfiguration(i);if(!o)return null;const a=this.getIndentRulesSupport(i);if(!a)return null;const l=this.getInheritIndentForLine(e,t,r),c=t.getLineContent(r);if(l){const h=l.line;if(h!==void 0){const u=o.onEnter(e,"",t.getLineContent(h),"");if(u){let d=rn(t.getLineContent(h));return u.removeText&&(d=d.substring(0,d.length-u.removeText)),u.indentAction===_n.Indent||u.indentAction===_n.IndentOutdent?d=s.shiftIndent(d):u.indentAction===_n.Outdent&&(d=s.unshiftIndent(d)),a.shouldDecrease(c)&&(d=s.unshiftIndent(d)),u.appendText&&(d+=u.appendText),rn(d)}}return a.shouldDecrease(c)?l.action===_n.Indent?l.indentation:s.unshiftIndent(l.indentation):l.action===_n.Indent?s.shiftIndent(l.indentation):l.indentation}return null}getIndentForEnter(e,t,i,r){if(e<4)return null;t.forceTokenization(i.startLineNumber);const s=t.getLineTokens(i.startLineNumber),o=gC(s,i.startColumn-1),a=o.getLineContent();let l=!1,c;o.firstCharOffset>0&&s.getLanguageId(0)!==o.languageId?(l=!0,c=a.substr(0,i.startColumn-1-o.firstCharOffset)):c=s.getLineContent().substring(0,i.startColumn-1);let h;i.isEmpty()?h=a.substr(i.startColumn-1-o.firstCharOffset):h=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-o.firstCharOffset);const u=this.getIndentRulesSupport(o.languageId);if(!u)return null;const d=c,f=rn(c),g={getLineTokens:_=>t.getLineTokens(_),getLanguageId:()=>t.getLanguageId(),getLanguageIdAtPosition:(_,w)=>t.getLanguageIdAtPosition(_,w),getLineContent:_=>_===i.startLineNumber?d:t.getLineContent(_)},p=rn(s.getLineContent()),m=this.getInheritIndentForLine(e,g,i.startLineNumber+1);if(!m){const _=l?p:f;return{beforeEnter:_,afterEnter:_}}let b=l?p:m.indentation;return m.action===_n.Indent&&(b=r.shiftIndent(b)),u.shouldDecrease(h)&&(b=r.unshiftIndent(b)),{beforeEnter:l?p:f,afterEnter:b}}getIndentActionForType(e,t,i,r,s){if(e<4)return null;const o=this.getScopedLineTokens(t,i.startLineNumber,i.startColumn);if(o.firstCharOffset)return null;const a=this.getIndentRulesSupport(o.languageId);if(!a)return null;const l=o.getLineContent(),c=l.substr(0,i.startColumn-1-o.firstCharOffset);let h;if(i.isEmpty()?h=l.substr(i.startColumn-1-o.firstCharOffset):h=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-o.firstCharOffset),!a.shouldDecrease(c+h)&&a.shouldDecrease(c+r+h)){const u=this.getInheritIndentForLine(e,t,i.startLineNumber,!1);if(!u)return null;let d=u.indentation;return u.action!==_n.Indent&&(d=s.unshiftIndent(d)),d}return null}getIndentMetadata(e,t){const i=this.getIndentRulesSupport(e.getLanguageId());return!i||t<1||t>e.getLineCount()?null:i.getIndentMetadata(e.getLineContent(t))}getEnterAction(e,t,i){const r=this.getScopedLineTokens(t,i.startLineNumber,i.startColumn),s=this.getLanguageConfiguration(r.languageId);if(!s)return null;const o=r.getLineContent(),a=o.substr(0,i.startColumn-1-r.firstCharOffset);let l;i.isEmpty()?l=o.substr(i.startColumn-1-r.firstCharOffset):l=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-r.firstCharOffset);let c="";if(i.startLineNumber>1&&r.firstCharOffset===0){const p=this.getScopedLineTokens(t,i.startLineNumber-1);p.languageId===r.languageId&&(c=p.getLineContent())}const h=s.onEnter(e,c,a,l);if(!h)return null;const u=h.indentAction;let d=h.appendText;const f=h.removeText||0;d?u===_n.Indent&&(d="	"+d):u===_n.Indent||u===_n.IndentOutdent?d="	":d="";let g=this.getIndentationAtPosition(t,i.startLineNumber,i.startColumn);return f&&(g=g.substring(0,g.length-f)),{indentAction:u,appendText:d,removeText:f,indentation:g}}getIndentationAtPosition(e,t,i){const r=e.getLineContent(t);let s=rn(r);return s.length>i-1&&(s=s.substring(0,i-1)),s}getScopedLineTokens(e,t,i){e.forceTokenization(t);const r=e.getLineTokens(t),s=typeof i>"u"?e.getLineMaxColumn(t)-1:i-1;return gC(r,s)}}const zi=new P2e;class B2e{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new EW(e,t,++this._order);return this._entries.push(i),this._resolved=null,Et(()=>{for(let r=0;r<this._entries.length;r++)if(this._entries[r]===i){this._entries.splice(r,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new ww(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(EW.cmp),dJ(this._entries.map(e=>e.configuration)))}}function dJ(n){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of n)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class EW{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class ww{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Qp(this.underlyingConfig):null,this.comments=ww._handleComments(this.underlyingConfig),this.characterPair=new S_(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||tQ,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new v2e(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{}}getWordDefinition(){return uE(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new d2e(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new b2e(this.brackets)),this._electricCharacter}onEnter(e,t,i,r){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,r):null}static _handleComments(e){let t=e.comments;if(!t)return null;let i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){let[r,s]=t.blockComment;i.blockCommentStartToken=r,i.blockCommentEndToken=s}return i}}Wg(my,AE);class Kh{constructor(e,t,i,r){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=r}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class DW{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,r=e.length;i<r;i++)t[i]=e.charCodeAt(i);return t}}function V2e(n,e,t){return new Fl(new DW(n),new DW(e)).ComputeDiff(t).changes}class wp{static Assert(e,t){if(!e)throw new Error(t)}}class yp{static Copy(e,t,i,r,s){for(let o=0;o<s;o++)i[r+o]=e[t+o]}static Copy2(e,t,i,r,s){for(let o=0;o<s;o++)i[r+o]=e[t+o]}}class kW{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Kh(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class Fl{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[r,s,o]=Fl._getElements(e),[a,l,c]=Fl._getElements(t);this._hasStrings=o&&c,this._originalStringElements=r,this._originalElementsOrHash=s,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(Fl._isStringArray(t)){const i=new Int32Array(t.length);for(let r=0,s=t.length;r<s;r++)i[r]=j3(t[r],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=Fl._getStrictElement(this._originalSequence,e),r=Fl._getStrictElement(this._modifiedSequence,t);return i===r}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,r,s){const o=[!1];let a=this.ComputeDiffRecursive(e,t,i,r,o);return s&&(a=this.PrettifyChanges(a)),{quitEarly:o[0],changes:a}}ComputeDiffRecursive(e,t,i,r,s){for(s[0]=!1;e<=t&&i<=r&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&r>=i&&this.ElementsAreEqual(t,r);)t--,r--;if(e>t||i>r){let u;return i<=r?(wp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),u=[new Kh(e,0,i,r-i+1)]):e<=t?(wp.Assert(i===r+1,"modifiedStart should only be one more than modifiedEnd"),u=[new Kh(e,t-e+1,i,0)]):(wp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),wp.Assert(i===r+1,"modifiedStart should only be one more than modifiedEnd"),u=[]),u}const o=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,r,o,a,s),c=o[0],h=a[0];if(l!==null)return l;if(!s[0]){const u=this.ComputeDiffRecursive(e,c,i,h,s);let d=[];return s[0]?d=[new Kh(c+1,t-(c+1)+1,h+1,r-(h+1)+1)]:d=this.ComputeDiffRecursive(c+1,t,h+1,r,s),this.ConcatenateChanges(u,d)}return[new Kh(e,t-e+1,i,r-i+1)]}WALKTRACE(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p,m,b,_){let w=null,y=null,S=new kW,k=t,C=i,D=f[0]-m[0]-r,E=-1073741824,N=this.m_forwardHistory.length-1;do{const T=D+e;T===k||T<C&&c[T-1]<c[T+1]?(u=c[T+1],g=u-D-r,u<E&&S.MarkNextChange(),E=u,S.AddModifiedElement(u+1,g),D=T+1-e):(u=c[T-1]+1,g=u-D-r,u<E&&S.MarkNextChange(),E=u-1,S.AddOriginalElement(u,g+1),D=T-1-e),N>=0&&(c=this.m_forwardHistory[N],e=c[0],k=1,C=c.length-1)}while(--N>=-1);if(w=S.getReverseChanges(),_[0]){let T=f[0]+1,j=m[0]+1;if(w!==null&&w.length>0){const q=w[w.length-1];T=Math.max(T,q.getOriginalEnd()),j=Math.max(j,q.getModifiedEnd())}y=[new Kh(T,d-T+1,j,p-j+1)]}else{S=new kW,k=o,C=a,D=f[0]-m[0]-l,E=1073741824,N=b?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const T=D+s;T===k||T<C&&h[T-1]>=h[T+1]?(u=h[T+1]-1,g=u-D-l,u>E&&S.MarkNextChange(),E=u+1,S.AddOriginalElement(u+1,g+1),D=T+1-s):(u=h[T-1],g=u-D-l,u>E&&S.MarkNextChange(),E=u,S.AddModifiedElement(u+1,g+1),D=T-1-s),N>=0&&(h=this.m_reverseHistory[N],s=h[0],k=1,C=h.length-1)}while(--N>=-1);y=S.getChanges()}return this.ConcatenateChanges(w,y)}ComputeRecursionPoint(e,t,i,r,s,o,a){let l=0,c=0,h=0,u=0,d=0,f=0;e--,i--,s[0]=0,o[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const g=t-e+(r-i),p=g+1,m=new Int32Array(p),b=new Int32Array(p),_=r-i,w=t-e,y=e-i,S=t-r,C=(w-_)%2===0;m[_]=e,b[w]=t,a[0]=!1;for(let D=1;D<=g/2+1;D++){let E=0,N=0;h=this.ClipDiagonalBound(_-D,D,_,p),u=this.ClipDiagonalBound(_+D,D,_,p);for(let j=h;j<=u;j+=2){j===h||j<u&&m[j-1]<m[j+1]?l=m[j+1]:l=m[j-1]+1,c=l-(j-_)-y;const q=l;for(;l<t&&c<r&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(m[j]=l,l+c>E+N&&(E=l,N=c),!C&&Math.abs(j-w)<=D-1&&l>=b[j])return s[0]=l,o[0]=c,q<=b[j]&&1447>0&&D<=1447+1?this.WALKTRACE(_,h,u,y,w,d,f,S,m,b,l,t,s,c,r,o,C,a):null}const T=(E-e+(N-i)-D)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(E,T))return a[0]=!0,s[0]=E,o[0]=N,T>0&&1447>0&&D<=1447+1?this.WALKTRACE(_,h,u,y,w,d,f,S,m,b,l,t,s,c,r,o,C,a):(e++,i++,[new Kh(e,t-e+1,i,r-i+1)]);d=this.ClipDiagonalBound(w-D,D,w,p),f=this.ClipDiagonalBound(w+D,D,w,p);for(let j=d;j<=f;j+=2){j===d||j<f&&b[j-1]>=b[j+1]?l=b[j+1]-1:l=b[j-1],c=l-(j-w)-S;const q=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(b[j]=l,C&&Math.abs(j-_)<=D&&l<=m[j])return s[0]=l,o[0]=c,q>=m[j]&&1447>0&&D<=1447+1?this.WALKTRACE(_,h,u,y,w,d,f,S,m,b,l,t,s,c,r,o,C,a):null}if(D<=1447){let j=new Int32Array(u-h+2);j[0]=_-h+1,yp.Copy2(m,h,j,1,u-h+1),this.m_forwardHistory.push(j),j=new Int32Array(f-d+2),j[0]=w-d+1,yp.Copy2(b,d,j,1,f-d+1),this.m_reverseHistory.push(j)}}return this.WALKTRACE(_,h,u,y,w,d,f,S,m,b,l,t,s,c,r,o,C,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],r=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,s=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,o=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<r&&i.modifiedStart+i.modifiedLength<s&&(!o||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}let l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let r=0,s=0;if(t>0){const u=e[t-1];r=u.originalStart+u.originalLength,s=u.modifiedStart+u.modifiedLength}const o=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let u=1;;u++){const d=i.originalStart-u,f=i.modifiedStart-u;if(d<r||f<s||o&&!this.OriginalElementsAreEqual(d,d+i.originalLength)||a&&!this.ModifiedElementsAreEqual(f,f+i.modifiedLength))break;const p=(d===r&&f===s?5:0)+this._boundaryScore(d,i.originalLength,f,i.modifiedLength);p>c&&(c=p,l=u)}i.originalStart-=l,i.modifiedStart-=l;const h=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],h)){e[t-1]=h[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const r=e[t-1],s=e[t],o=s.originalStart-r.originalStart-r.originalLength,a=r.originalStart,l=s.originalStart+s.originalLength,c=l-a,h=r.modifiedStart,u=s.modifiedStart+s.modifiedLength,d=u-h;if(o<5&&c<20&&d<20){const f=this._findBetterContiguousSequence(a,c,h,d,o);if(f){const[g,p]=f;(g!==r.originalStart+r.originalLength||p!==r.modifiedStart+r.modifiedLength)&&(r.originalLength=g-r.originalStart,r.modifiedLength=p-r.modifiedStart,s.originalStart=g+o,s.modifiedStart=p+o,s.originalLength=l-s.originalStart,s.modifiedLength=u-s.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,r,s){if(t<s||r<s)return null;const o=e+t-s+1,a=i+r-s+1;let l=0,c=0,h=0;for(let u=e;u<o;u++)for(let d=i;d<a;d++){const f=this._contiguousSequenceScore(u,d,s);f>0&&f>l&&(l=f,c=u,h=d)}return l>0?[c,h]:null}_contiguousSequenceScore(e,t,i){let r=0;for(let s=0;s<i;s++){if(!this.ElementsAreEqual(e+s,t+s))return 0;r+=this._originalStringElements[e+s].length}return r}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,r){const s=this._OriginalRegionIsBoundary(e,t)?1:0,o=this._ModifiedRegionIsBoundary(i,r)?1:0;return s+o}ConcatenateChanges(e,t){let i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const r=new Array(e.length+t.length-1);return yp.Copy(e,0,r,0,e.length-1),r[e.length-1]=i[0],yp.Copy(t,1,r,e.length,t.length-1),r}else{const r=new Array(e.length+t.length);return yp.Copy(e,0,r,0,e.length),yp.Copy(t,0,r,e.length,t.length),r}}ChangesOverlap(e,t,i){if(wp.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),wp.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const r=e.originalStart;let s=e.originalLength;const o=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(s=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new Kh(r,s,o,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,r){if(e>=0&&e<r)return e;const s=i,o=r-i-1,a=t%2===0;if(e<0){const l=s%2===0;return a===l?0:1}else{const l=o%2===0;return a===l?r-1:r-2}}}const W2e=3;function fJ(n,e,t,i){return new Fl(n,e,t).ComputeDiff(i)}class LW{constructor(e){const t=[],i=[];for(let r=0,s=e.length;r<s;r++)t[r]=KM(e[r],1),i[r]=ZM(e[r],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const r=[],s=[],o=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],h=e?this._startColumns[l]:1,u=e?this._endColumns[l]:c.length+1;for(let d=h;d<u;d++)r[a]=c.charCodeAt(d-1),s[a]=l+1,o[a]=d,a++}return new $2e(r,s,o)}}class $2e{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}getElements(){return this._charCodes}getStartLineNumber(e){return this._lineNumbers[e]}getStartColumn(e){return this._columns[e]}getEndLineNumber(e){return this._lineNumbers[e]}getEndColumn(e){return this._columns[e]+1}}class yw{constructor(e,t,i,r,s,o,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=r,this.modifiedStartLineNumber=s,this.modifiedStartColumn=o,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){let r,s,o,a,l,c,h,u;return e.originalLength===0?(r=0,s=0,o=0,a=0):(r=t.getStartLineNumber(e.originalStart),s=t.getStartColumn(e.originalStart),o=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1)),e.modifiedLength===0?(l=0,c=0,h=0,u=0):(l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),h=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),u=i.getEndColumn(e.modifiedStart+e.modifiedLength-1)),new yw(r,s,o,a,l,c,h,u)}}function z2e(n){if(n.length<=1)return n;const e=[n[0]];let t=e[0];for(let i=1,r=n.length;i<r;i++){const s=n[i],o=s.originalStart-(t.originalStart+t.originalLength),a=s.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(o,a)<W2e?(t.originalLength=s.originalStart+s.originalLength-t.originalStart,t.modifiedLength=s.modifiedStart+s.modifiedLength-t.modifiedStart):(e.push(s),t=s)}return e}class ev{constructor(e,t,i,r,s){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=r,this.charChanges=s}static createFromDiffResult(e,t,i,r,s,o,a){let l,c,h,u,d;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(h=r.getStartLineNumber(t.modifiedStart)-1,u=0):(h=r.getStartLineNumber(t.modifiedStart),u=r.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),o&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&s()){const f=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),g=r.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);let p=fJ(f,g,s,!0).changes;a&&(p=z2e(p)),d=[];for(let m=0,b=p.length;m<b;m++)d.push(yw.createFromDiffChange(p[m],f,g))}return new ev(l,c,h,u,d)}}class H2e{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new LW(e),this.modified=new LW(t),this.continueLineDiff=IW(i.maxComputationTime),this.continueCharDiff=IW(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const e=fJ(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(ev.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const r=[];let s=0,o=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,h=c?c.originalStart:this.originalLines.length,u=c?c.modifiedStart:this.modifiedLines.length;for(;s<h&&o<u;){const d=this.originalLines[s],f=this.modifiedLines[o];if(d!==f){{let g=KM(d,1),p=KM(f,1);for(;g>1&&p>1;){const m=d.charCodeAt(g-2),b=f.charCodeAt(p-2);if(m!==b)break;g--,p--}(g>1||p>1)&&this._pushTrimWhitespaceCharChange(r,s+1,1,g,o+1,1,p)}{let g=ZM(d,1),p=ZM(f,1);const m=d.length+1,b=f.length+1;for(;g<m&&p<b;){const _=d.charCodeAt(g-1),w=d.charCodeAt(p-1);if(_!==w)break;g++,p++}(g<m||p<b)&&this._pushTrimWhitespaceCharChange(r,s+1,g,m,o+1,p,b)}}s++,o++}c&&(r.push(ev.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),s+=c.originalLength,o+=c.modifiedLength)}return{quitEarly:i,changes:r}}_pushTrimWhitespaceCharChange(e,t,i,r,s,o,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,r,s,o,a))return;let l;this.shouldComputeCharChanges&&(l=[new yw(t,i,t,r,s,o,s,a)]),e.push(new ev(t,t,s,s,l))}_mergeTrimWhitespaceCharChange(e,t,i,r,s,o,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===s?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=s,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new yw(t,i,t,r,s,o,s,a)),!0):!1}}function KM(n,e){const t=cs(n);return t===-1?e:t+1}function ZM(n,e){const t=_0(n);return t===-1?e:t+2}function IW(n){if(n===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<n}function NE(n){return n<0?0:n>255?255:n|0}function Cp(n){return n<0?0:n>4294967295?4294967295:n|0}class gJ{constructor(e,t){this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class U2e{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=Cp(e);const i=this.values,r=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}changeValue(e,t){return e=Cp(e),t=Cp(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Cp(e),t=Cp(t);const i=this.values,r=this.prefixSum;if(e>=i.length)return!1;let s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Cp(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,r=0,s=0,o=0;for(;t<=i;)if(r=t+(i-t)/2|0,s=this.prefixSum[r],o=s-this.values[r],e<o)i=r-1;else if(e>=s)t=r+1;else break;return new gJ(r,e-o)}}class j2e{constructor(e,t,i,r){this._uri=e,this._lines=t,this._eol=i,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new G(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let r=0;r<t;r++)i[r]=this._lines[r].length+e;this._lineStarts=new U2e(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.changeValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;let i=nc(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);let r=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),r[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,r)}}class v0{constructor(e){let t=NE(e);this._defaultValue=t,this._asciiMap=v0._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){let t=new Uint8Array(256);for(let i=0;i<256;i++)t[i]=e;return t}set(e,t){let i=NE(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}class q2e{constructor(){this._actual=new v0(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}}class G2e{constructor(e,t,i){const r=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)r[s]=i;this._data=r,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class K2e{constructor(e){let t=0,i=0;for(let s=0,o=e.length;s<o;s++){let[a,l,c]=e[s];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;let r=new G2e(i,t,0);for(let s=0,o=e.length;s<o;s++){let[a,l,c]=e[s];r.set(a,l,c)}this._states=r,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let vT=null;function Z2e(){return vT===null&&(vT=new K2e([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),vT}let Z0=null;function Y2e(){if(Z0===null){Z0=new v0(0);const n=` 	<>'"`;for(let t=0;t<n.length;t++)Z0.set(n.charCodeAt(t),1);const e=".,;";for(let t=0;t<e.length;t++)Z0.set(e.charCodeAt(t),2)}return Z0}class RE{static _createLink(e,t,i,r,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==2)break;o--}while(o>r);if(r>0){const a=t.charCodeAt(r-1),l=t.charCodeAt(o);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&o--}return{range:{startLineNumber:i,startColumn:r+1,endLineNumber:i,endColumn:o+2},url:t.substring(r,o+1)}}static computeLinks(e,t=Z2e()){const i=Y2e();let r=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),l=a.length;let c=0,h=0,u=0,d=1,f=!1,g=!1,p=!1,m=!1;for(;c<l;){let b=!1;const _=a.charCodeAt(c);if(d===13){let w;switch(_){case 40:f=!0,w=0;break;case 41:w=f?0:1;break;case 91:p=!0,g=!0,w=0;break;case 93:p=!1,w=g?0:1;break;case 123:m=!0,w=0;break;case 125:w=m?0:1;break;case 39:w=u===34||u===96?0:1;break;case 34:w=u===39||u===96?0:1;break;case 96:w=u===39||u===34?0:1;break;case 42:w=u===42?1:0;break;case 124:w=u===124?1:0;break;case 32:w=p?0:1;break;default:w=i.get(_)}w===1&&(r.push(RE._createLink(i,a,s,h,c)),b=!0)}else if(d===12){let w;_===91?(g=!0,w=0):w=i.get(_),w===1?b=!0:d=13}else d=t.nextState(d,_),d===0&&(b=!0);b&&(d=1,f=!1,g=!1,m=!1,h=c+1,u=_),c++}d===13&&r.push(RE._createLink(i,a,s,h,l))}return r}}function X2e(n){return!n||typeof n.getLineCount!="function"||typeof n.getLineContent!="function"?[]:RE.computeLinks(n)}class YM{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,r,s){if(e&&t){let o=this.doNavigateValueSet(t,s);if(o)return{range:e,value:o}}if(i&&r){let o=this.doNavigateValueSet(r,s);if(o)return{range:i,value:o}}return null}doNavigateValueSet(e,t){let i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){let i=Math.pow(10,e.length-(e.lastIndexOf(".")+1)),r=Number(e),s=parseFloat(e);return!isNaN(r)&&!isNaN(s)&&r===s?r===0&&!t?null:(r=Math.floor(r*i),r+=t?i:-i,String(r/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let r=null;for(let s=0,o=e.length;r===null&&s<o;s++)r=this.valueSetReplace(e[s],t,i);return r}valueSetReplace(e,t,i){let r=e.indexOf(t);return r>=0?(r+=i?1:-1,r<0?r=e.length-1:r%=e.length,e[r]):null}}YM.INSTANCE=new YM;var Sp=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class Q2e extends j2e{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){let i=dE(e.column,uE(t),this._lines[e.lineNumber-1],0);return i?new V(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let r=0,s="",o=0,a=[];return{*[Symbol.iterator](){for(;;)if(o<a.length){const l=s.substring(a[o].start,a[o].end);o+=1,yield l}else if(r<t.length)s=t[r],a=i(s,e),o=0,r+=1;else break}}}getLineWords(e,t){let i=this._lines[e-1],r=this._wordenize(i,t),s=[];for(const o of r)s.push({word:i.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1});return s}_wordenize(e,t){const i=[];let r;for(t.lastIndex=0;(r=t.exec(e))&&r[0].length!==0;)i.push({start:r.index,end:r.index+r[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);let t=this._eol,i=e.startLineNumber-1,r=e.endLineNumber-1,s=[];s.push(this._lines[i].substring(e.startColumn-1));for(let o=i+1;o<r;o++)s.push(this._lines[o]);return s.push(this._lines[r].substring(0,e.endColumn-1)),s.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();let t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!G.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,r=!1;if(t<1)t=1,i=1,r=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,r=!0;else{let s=this._lines[t-1].length+1;i<1?(i=1,r=!0):i>s&&(i=s,r=!0)}return r?{lineNumber:t,column:i}:e}}class ag{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){let e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}acceptNewModel(e){this._models[e.url]=new Q2e(qe.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeDiff(e,t,i,r){return Sp(this,void 0,void 0,function*(){const s=this._getModel(e),o=this._getModel(t);if(!s||!o)return null;const a=s.getLinesContent(),l=o.getLinesContent(),h=new H2e(a,l,{shouldComputeCharChanges:!0,shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:i,shouldMakePrettyDiff:!0,maxComputationTime:r}).computeDiff(),u=h.changes.length>0?!1:this._modelsAreIdentical(s,o);return{quitEarly:h.quitEarly,identical:u,changes:h.changes}})}_modelsAreIdentical(e,t){const i=e.getLineCount(),r=t.getLineCount();if(i!==r)return!1;for(let s=1;s<=i;s++){const o=e.getLineContent(s),a=t.getLineContent(s);if(o!==a)return!1}return!0}computeMoreMinimalEdits(e,t){return Sp(this,void 0,void 0,function*(){const i=this._getModel(e);if(!i)return t;const r=[];let s;t=t.slice(0).sort((o,a)=>{if(o.range&&a.range)return V.compareRangesUsingStarts(o.range,a.range);let l=o.range?0:1,c=a.range?0:1;return l-c});for(let{range:o,text:a,eol:l}of t){if(typeof l=="number"&&(s=l),V.isEmpty(o)&&!a)continue;const c=i.getValueInRange(o);if(a=a.replace(/\r\n|\n|\r/g,i.eol),c===a)continue;if(Math.max(a.length,c.length)>ag._diffLimit){r.push({range:o,text:a});continue}const h=V2e(c,a,!1),u=i.offsetAt(V.lift(o).getStartPosition());for(const d of h){const f=i.positionAt(u+d.originalStart),g=i.positionAt(u+d.originalStart+d.originalLength),p={text:a.substr(d.modifiedStart,d.modifiedLength),range:{startLineNumber:f.lineNumber,startColumn:f.column,endLineNumber:g.lineNumber,endColumn:g.column}};i.getValueInRange(p.range)!==p.text&&r.push(p)}}return typeof s=="number"&&r.push({eol:s,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),r})}computeLinks(e){return Sp(this,void 0,void 0,function*(){let t=this._getModel(e);return t?X2e(t):null})}textualSuggest(e,t,i,r){return Sp(this,void 0,void 0,function*(){const s=new yh(!0),o=new RegExp(i,r),a=new Set;e:for(let l of e){const c=this._getModel(l);if(c){for(let h of c.words(o))if(!(h===t||!isNaN(Number(h)))&&(a.add(h),a.size>ag._suggestionsLimit))break e}}return{words:Array.from(a),duration:s.elapsed()}})}computeWordRanges(e,t,i,r){return Sp(this,void 0,void 0,function*(){let s=this._getModel(e);if(!s)return Object.create(null);const o=new RegExp(i,r),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){let c=s.getLineWords(l,o);for(const h of c){if(!isNaN(Number(h.word)))continue;let u=a[h.word];u||(u=[],a[h.word]=u),u.push({startLineNumber:l,startColumn:h.startColumn,endLineNumber:l,endColumn:h.endColumn})}}return a})}navigateValueSet(e,t,i,r,s){return Sp(this,void 0,void 0,function*(){let o=this._getModel(e);if(!o)return null;let a=new RegExp(r,s);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});let l=o.getValueInRange(t),c=o.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;let h=o.getValueInRange(c);return YM.INSTANCE.navigateValueSet(t,l,c,h,i)})}loadForeignModule(e,t,i){let o={host:aLe(i,(a,l)=>this._host.fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(o,t),Promise.resolve(z3(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}ag._diffLimit=1e5;ag._suggestionsLimit=1e4;typeof importScripts=="function"&&(hi.monaco=gQ());const pJ=Dt("textResourceConfigurationService"),mJ=Dt("textResourcePropertiesService");function js(n,e=0){return n[n.length-(1+e)]}function J2e(n){if(n.length===0)throw new Error("Invalid tail call");return[n.slice(0,n.length-1),n[n.length-1]]}function ec(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e||n.length!==e.length)return!1;for(let i=0,r=n.length;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function X3(n,e,t){let i=0,r=n.length-1;for(;i<=r;){const s=(i+r)/2|0,o=t(n[s],e);if(o<0)i=s+1;else if(o>0)r=s-1;else return s}return-(i+1)}function _J(n,e){let t=0,i=n.length;if(i===0)return 0;for(;t<i;){const r=Math.floor((t+i)/2);e(n[r])?i=r:t=r+1}return t}function XM(n,e,t){if(n=n|0,n>=e.length)throw new TypeError("invalid index");let i=e[Math.floor(e.length*Math.random())],r=[],s=[],o=[];for(let a of e){const l=t(a,i);l<0?r.push(a):l>0?s.push(a):o.push(a)}return n<r.length?XM(n,r,t):n<r.length+o.length?o[0]:XM(n-(r.length+o.length),s,t)}function TW(n,e){const t=[];let i;for(const r of n.slice(0).sort(e))!i||e(i[0],r)!==0?(i=[r],t.push(i)):i.push(r);return t}function rL(n){return n.filter(e=>!!e)}function bJ(n){return!Array.isArray(n)||n.length===0}function tc(n){return Array.isArray(n)&&n.length>0}function ME(n,e=t=>t){const t=new Set;return n.filter(i=>{const r=e(i);return t.has(r)?!1:(t.add(r),!0)})}function eIe(n,e){const t=tIe(n,e);if(t!==-1)return n[t]}function tIe(n,e){for(let t=n.length-1;t>=0;t--){const i=n[t];if(e(i))return t}return-1}function QM(n,e){return n.length>0?n[0]:e}function Q3(n){return[].concat(...n)}function mr(n,e){let t=typeof e=="number"?n:0;typeof e=="number"?t=n:(t=0,e=n);const i=[];if(t<=e)for(let r=t;r<e;r++)i.push(r);else for(let r=t;r>e;r--)i.push(r);return i}function Cw(n,e,t){const i=n.slice(0,e),r=n.slice(e);return i.concat(t,r)}function wT(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.unshift(e))}function mC(n,e){const t=n.indexOf(e);t>-1&&(n.splice(t,1),n.push(e))}function vJ(n){return Array.isArray(n)?n:[n]}function iIe(n,e,t){const i=wJ(n,e),r=n.length,s=t.length;n.length=r+s;for(let o=r-1;o>=i;o--)n[o+s]=n[o];for(let o=0;o<s;o++)n[o+i]=t[o]}function AW(n,e,t,i){const r=wJ(n,e),s=n.splice(r,t);return iIe(n,r,i),s}function wJ(n,e){return e<0?Math.max(e+n.length,0):Math.min(e,n.length)}class tv{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){return this.items[this.firstIdx]}}const Ih=Dt("logService");var Ta;(function(n){n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Info=2]="Info",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.Off=6]="Off"})(Ta||(Ta={}));const yJ=Ta.Info;class nIe extends re{constructor(){super(...arguments),this.level=yJ,this._onDidChangeLogLevel=this._register(new H)}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}class rIe extends nIe{constructor(e=yJ){super(),this.setLevel(e)}trace(e,...t){this.getLevel()<=Ta.Trace&&console.log("%cTRACE","color: #888",e,...t)}debug(e,...t){this.getLevel()<=Ta.Debug&&console.log("%cDEBUG","background: #eee; color: #888",e,...t)}info(e,...t){this.getLevel()<=Ta.Info&&console.log("%c INFO","color: #33f",e,...t)}error(e,...t){this.getLevel()<=Ta.Error&&console.log("%c  ERR","color: #f33",e,...t)}dispose(){}}class sIe extends re{constructor(e){super(),this.logger=e,this._register(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}error(e,...t){this.logger.error(e,...t)}}var oIe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},yT=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},JM=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const NW=60*1e3,RW=5*60*1e3;function Jp(n,e){let t=n.getModel(e);return!(!t||t.isTooLargeForSyncing())}let eF=class extends re{constructor(e,t,i){super(),this._modelService=e,this._workerManager=this._register(new lIe(this._modelService)),this._logService=i,this._register(XQ.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(r,s)=>Jp(this._modelService,r.uri)?this._workerManager.withWorker().then(o=>o.computeLinks(r.uri)).then(o=>o&&{links:o}):Promise.resolve({links:[]})})),this._register(Da.register("*",new aIe(this._workerManager,t,this._modelService)))}dispose(){super.dispose()}computeDiff(e,t,i,r){return this._workerManager.withWorker().then(s=>s.computeDiff(e,t,i,r))}computeMoreMinimalEdits(e,t){if(tc(t)){if(!Jp(this._modelService,e))return Promise.resolve(t);const i=yh.create(!0),r=this._workerManager.withWorker().then(s=>s.computeMoreMinimalEdits(e,t));return r.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),i.elapsed())),Promise.race([r,dw(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Jp(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then(r=>r.navigateValueSet(e,t,i))}canComputeWordRanges(e){return Jp(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then(i=>i.computeWordRanges(e,t))}};eF=oIe([yT(0,Kr),yT(1,pJ),yT(2,Ih)],eF);class aIe{constructor(e,t,i){this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}provideCompletionItems(e,t){return JM(this,void 0,void 0,function*(){const i=this._configurationService.getValue(e.uri,t,"editor");if(!i.wordBasedSuggestions)return;const r=[];if(i.wordBasedSuggestionsMode==="currentDocument")Jp(this._modelService,e.uri)&&r.push(e.uri);else for(const u of this._modelService.getModels())Jp(this._modelService,u.uri)&&(u===e?r.unshift(u.uri):(i.wordBasedSuggestionsMode==="allDocuments"||u.getLanguageId()===e.getLanguageId())&&r.push(u.uri));if(r.length===0)return;const s=zi.getWordDefinition(e.getLanguageId()),o=e.getWordAtPosition(t),a=o?new V(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):V.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),h=yield(yield this._workerManager.withWorker()).textualSuggest(r,o==null?void 0:o.word,s);if(h)return{duration:h.duration,suggestions:h.words.map(u=>({kind:18,label:u,insertText:u,range:{insert:l,replace:a}}))}})}}class lIe extends re{constructor(e){super(),this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new fy).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(RW/2)),this._register(this._modelService.onModelRemoved(i=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>RW&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new CJ(this._modelService,!1,"editorWorkerService")),Promise.resolve(this._editorWorkerClient)}}class cIe extends re{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){let r=new fy;r.cancelAndSet(()=>this._checkStopModelSync(),Math.round(NW/2)),this._register(r)}}dispose(){for(let e in this._syncedModels)mt(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t){for(const i of e){let r=i.toString();this._syncedModels[r]||this._beginModelSync(i,t),this._syncedModels[r]&&(this._syncedModelsLastUsedTime[r]=new Date().getTime())}}_checkStopModelSync(){let e=new Date().getTime(),t=[];for(let i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>NW&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){let i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;let r=e.toString();this._proxy.acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const s=new ve;s.add(i.onDidChangeContent(o=>{this._proxy.acceptModelChanged(r.toString(),o)})),s.add(i.onWillDispose(()=>{this._stopModelSync(r)})),s.add(Et(()=>{this._proxy.acceptRemovedModel(r)})),this._syncedModels[r]=s}_stopModelSync(e){let t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],mt(t)}}class MW{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class CT{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class CJ extends re{constructor(e,t,i){super(),this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new eL(i),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new e2e(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new CT(this)))}catch(e){jM(e),this._worker=new MW(new ag(new CT(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,e=>(jM(e),this._worker=new MW(new ag(new CT(this),null)),this._getOrCreateWorker().getProxyObject()))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new cIe(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e,t=!1){return JM(this,void 0,void 0,function*(){return this._disposed?Promise.reject(g0()):this._getProxy().then(i=>(this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i))})}computeDiff(e,t,i,r){return this._withSyncedResources([e,t],!0).then(s=>s.computeDiff(e.toString(),t.toString(),i,r))}computeMoreMinimalEdits(e,t){return this._withSyncedResources([e]).then(i=>i.computeMoreMinimalEdits(e.toString(),t))}computeLinks(e){return this._withSyncedResources([e]).then(t=>t.computeLinks(e.toString()))}textualSuggest(e,t,i){return JM(this,void 0,void 0,function*(){const r=yield this._withSyncedResources(e),s=i.source,o=rT(i);return r.textualSuggest(e.map(a=>a.toString()),t,s,o)})}computeWordRanges(e,t){return this._withSyncedResources([e]).then(i=>{let r=this._modelService.getModel(e);if(!r)return Promise.resolve(null);let s=zi.getWordDefinition(r.getLanguageId()),o=s.source,a=rT(s);return i.computeWordRanges(e.toString(),t,o,a)})}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then(r=>{let s=this._modelService.getModel(e);if(!s)return null;let o=zi.getWordDefinition(s.getLanguageId()),a=o.source,l=rT(o);return r.navigateValueSet(e.toString(),t,i,a,l)})}dispose(){super.dispose(),this._disposed=!0}}function hIe(n,e){return new uIe(n,e)}class uIe extends CJ{constructor(e,t){super(e,t.keepIdleModels||!1,t.label),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?z3(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const r=(a,l)=>e.fmr(a,l),s=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)};let o={};for(const a of i)o[a]=s(a,r);return o})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then(t=>this.getProxy())}}class In{constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._languageIdCodec=i}static createEmpty(e,t){const i=In.defaultTokenMetadata,r=new Uint32Array(2);return r[0]=e.length,r[1]=i,new In(r,e,t)}equals(e){return e instanceof In?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const r=t<<1,s=r+(i<<1);for(let o=r;o<s;o++)if(this._tokens[o]!==e._tokens[o])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=Qs.getLanguageId(t);return this._languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return Qs.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return Qs.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return Qs.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return Qs.getInlineStyleFromMetadata(i,t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return In.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new J3(this,e,t,i)}static convertToEndOffset(e,t){const r=(e.length>>>1)-1;for(let s=0;s<r;s++)e[s<<1]=e[s+1<<1];e[r<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,r=(e.length>>>1)-1;for(;i<r;){const s=i+Math.floor((r-i)/2),o=e[s<<1];if(o===t)return s+1;o<t?i=s+1:o>t&&(r=s)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,r="";const s=new Array;let o=0;for(;;){let a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){r+=this._text.substring(o,a);const c=this._tokens[(t<<1)+1];s.push(r.length,c),t++,o=a}else if(l){if(l.offset>o){r+=this._text.substring(o,l.offset);const c=this._tokens[(t<<1)+1];s.push(r.length,c),o=l.offset}r+=l.text,s.push(r.length,l.tokenMetadata),i++}else break}return new In(new Uint32Array(s),r,this._languageIdCodec)}}In.defaultTokenMetadata=(0<<11|1<<14|2<<23)>>>0;class J3{constructor(e,t,i,r){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=r,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let s=this._firstTokenIndex,o=e.getCount();s<o&&!(e.getStartOffset(s)>=i);s++)this._tokensCount++}equals(e){return e instanceof J3?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}class Ns{constructor(e,t,i,r){this.startColumn=e,this.endColumn=t,this.className=i,this.type=r,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,r=t.length;if(i!==r)return!1;for(let s=0;s<i;s++)if(!Ns._equals(e[s],t[s]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const r=t+1,s=i+1,o=i-t,a=[];let l=0;for(const c of e)c.endColumn<=r||c.startColumn>=s||(a[l++]=new Ns(Math.max(1,c.startColumn-r+1),Math.min(o+1,c.endColumn-r+1),c.className,c.type));return a}static filter(e,t,i,r){if(e.length===0)return[];let s=[],o=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.range;if(h.endLineNumber<t||h.startLineNumber>t||h.isEmpty()&&(c.type===0||c.type===3))continue;const u=h.startLineNumber===t?h.startColumn:i,d=h.endLineNumber===t?h.endColumn:r;s[o++]=new Ns(u,d,c.inlineClassName,c.type)}return s}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=Ns._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class FW{constructor(e,t,i,r){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=r}}class FE{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,r=e.length;i<r;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let r=0;for(;r+1<this.count&&this.stopOffsets[r]===this.stopOffsets[r+1];)r++;i.push(new FW(t,this.stopOffsets[r],this.classNames.join(" "),FE._metadata(this.metadata))),t=this.stopOffsets[r]+1,this.stopOffsets.splice(0,r+1),this.classNames.splice(0,r+1),this.metadata.splice(0,r+1),this.count-=r+1}return this.count>0&&t<e&&(i.push(new FW(t,e-1,this.classNames.join(" "),FE._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let r=0;r<this.count;r++)if(this.stopOffsets[r]>=e){this.stopOffsets.splice(r,0,e),this.classNames.splice(r,0,t),this.metadata.splice(r,0,i);break}this.count++}}class dIe{static normalize(e,t){if(t.length===0)return[];let i=[];const r=new FE;let s=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];let c=l.startColumn,h=l.endColumn;const u=l.className,d=l.type===1?2:l.type===2?4:0;if(c>1){const p=e.charCodeAt(c-2);Ln(p)&&c--}if(h>1){const p=e.charCodeAt(h-2);Ln(p)&&h--}const f=c-1,g=h-2;s=r.consumeLowerThan(f,s,i),r.count===0&&(s=f),r.insert(g,u,d)}return r.consumeLowerThan(1073741824,s,i),i}}class wn{constructor(e,t,i){this._linePartBrand=void 0,this.endIndex=e,this.type=t,this.metadata=i}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class fIe{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class $g{constructor(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p,m,b,_,w){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=r,this.isBasicASCII=s,this.containsRTL=o,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(Ns.compare),this.tabSize=h,this.startVisibleColumn=u,this.spaceWidth=d,this.stopRenderingLineAfter=p,this.renderWhitespace=m==="all"?4:m==="boundary"?1:m==="selection"?2:m==="trailing"?3:0,this.renderControlCharacters=b,this.fontLigatures=_,this.selectionsOnLine=w&&w.sort((k,C)=>k.startOffset<C.startOffset?-1:1);const y=Math.abs(g-d),S=Math.abs(f-d);y<S?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=f,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&Ns.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class e5{constructor(e,t){this.partIndex=e,this.charIndex=t}}class kl{constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._absoluteOffsets=new Uint32Array(this.length)}static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}setColumnInfo(e,t,i,r){const s=(t<<16|i<<0)>>>0;this._data[e-1]=s,this._absoluteOffsets[e-1]=r+i}getAbsoluteOffset(e){return this._absoluteOffsets.length===0?0:this._absoluteOffsets[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=kl.getPartIndex(t),r=kl.getCharIndex(t);return new e5(i,r)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;let r=(e<<16|i<<0)>>>0,s=0,o=this.length-1;for(;s+1<o;){let p=s+o>>>1,m=this._data[p];if(m===r)return p;m>r?o=p:s=p}if(s===o)return s;let a=this._data[s],l=this._data[o];if(a===r)return s;if(l===r)return o;let c=kl.getPartIndex(a),h=kl.getCharIndex(a),u=kl.getPartIndex(l),d;c!==u?d=t:d=kl.getCharIndex(l);let f=i-h,g=d-i;return f<=g?s:o}}class tF{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function sL(n,e){if(n.lineContent.length===0){if(n.lineDecorations.length>0){e.appendASCIIString("<span>");let t=0,i=0,r=0;for(const o of n.lineDecorations)(o.type===1||o.type===2)&&(e.appendASCIIString('<span class="'),e.appendASCIIString(o.className),e.appendASCIIString('"></span>'),o.type===1&&(r|=1,t++),o.type===2&&(r|=2,i++));e.appendASCIIString("</span>");const s=new kl(1,t+i);return s.setColumnInfo(1,t,0,0),new tF(s,!1,r)}return e.appendASCIIString("<span><span></span></span>"),new tF(new kl(0,0),!1,0)}return CIe(mIe(n),e)}class gIe{constructor(e,t,i,r){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=r}}function oL(n){let e=og(1e4),t=sL(n,e);return new gIe(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class pIe{constructor(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=r,this.isOverflowing=s,this.parts=o,this.containsForeignElements=a,this.fauxIndentLength=l,this.tabSize=c,this.startVisibleColumn=h,this.containsRTL=u,this.spaceWidth=d,this.renderSpaceCharCode=f,this.renderWhitespace=g,this.renderControlCharacters=p}}function mIe(n){const e=n.lineContent;let t,i;n.stopRenderingLineAfter!==-1&&n.stopRenderingLineAfter<e.length?(t=!0,i=n.stopRenderingLineAfter):(t=!1,i=e.length);let r=_Ie(n.lineTokens,n.fauxIndentLength,i);(n.renderWhitespace===4||n.renderWhitespace===1||n.renderWhitespace===2&&n.selectionsOnLine||n.renderWhitespace===3)&&(r=wIe(n,e,i,r));let s=0;if(n.lineDecorations.length>0){for(let o=0,a=n.lineDecorations.length;o<a;o++){const l=n.lineDecorations[o];l.type===3||l.type===1?s|=1:l.type===2&&(s|=2)}r=yIe(e,i,r,n.lineDecorations)}return n.containsRTL||(r=bIe(e,r,!n.isBasicASCII||n.fontLigatures)),n.renderControlCharacters&&!n.isBasicASCII&&(r=vIe(e,r)),new pIe(n.useMonospaceOptimizations,n.canUseHalfwidthRightwardsArrow,e,i,t,r,s,n.fauxIndentLength,n.tabSize,n.startVisibleColumn,n.containsRTL,n.spaceWidth,n.renderSpaceCharCode,n.renderWhitespace,n.renderControlCharacters)}function _Ie(n,e,t){let i=[],r=0;e>0&&(i[r++]=new wn(e,"",0));for(let s=0,o=n.getCount();s<o;s++){const a=n.getEndOffset(s);if(a<=e)continue;const l=n.getClassName(s);if(a>=t){i[r++]=new wn(t,l,0);break}i[r++]=new wn(a,l,0)}return i}function bIe(n,e,t){let i=0,r=[],s=0;if(t)for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;if(i+50<c){const h=l.type,u=l.metadata;let d=-1,f=i;for(let g=i;g<c;g++)n.charCodeAt(g)===32&&(d=g),d!==-1&&g-f>=50&&(r[s++]=new wn(d+1,h,u),f=d+1,d=-1);f!==c&&(r[s++]=new wn(c,h,u))}else r[s++]=l;i=c}else for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.endIndex;let h=c-i;if(h>50){const u=l.type,d=l.metadata,f=Math.ceil(h/50);for(let g=1;g<f;g++){let p=i+g*50;r[s++]=new wn(p,u,d)}r[s++]=new wn(c,u,d)}else r[s++]=l;i=c}return r}function SJ(n){return n<32?n!==9:n===127||n>=8234&&n<=8238||n>=8294&&n<=8297||n>=8206&&n<=8207||n===1564}function vIe(n,e){let t=[],i=new wn(0,"",0),r=0;for(const s of e){const o=s.endIndex;for(;r<o;r++){const a=n.charCodeAt(r);SJ(a)&&(r>i.endIndex&&(i=new wn(r,s.type,s.metadata),t.push(i)),i=new wn(r+1,"mtkcontrol",s.metadata),t.push(i))}r>i.endIndex&&(i=new wn(o,s.type,s.metadata),t.push(i))}return t}function wIe(n,e,t,i){const r=n.continuesWithWrappedLine,s=n.fauxIndentLength,o=n.tabSize,a=n.startVisibleColumn,l=n.useMonospaceOptimizations,c=n.selectionsOnLine,h=n.renderWhitespace===1,u=n.renderWhitespace===3,d=n.renderSpaceWidth!==n.spaceWidth;let f=[],g=0,p=0,m=i[p].type,b=i[p].endIndex;const _=i.length;let w=!1,y=cs(e),S;y===-1?(w=!0,y=t,S=t):S=_0(e);let k=!1,C=0,D=c&&c[C],E=a%o;for(let T=s;T<t;T++){const j=e.charCodeAt(T);D&&T>=D.endOffset&&(C++,D=c&&c[C]);let q;if(T<y||T>S)q=!0;else if(j===9)q=!0;else if(j===32)if(h)if(k)q=!0;else{const ie=T+1<t?e.charCodeAt(T+1):0;q=ie===32||ie===9}else q=!0;else q=!1;if(q&&c&&(q=!!D&&D.startOffset<=T&&D.endOffset>T),q&&u&&(q=w||T>S),k){if(!q||!l&&E>=o){if(d){const ie=g>0?f[g-1].endIndex:s;for(let ge=ie+1;ge<=T;ge++)f[g++]=new wn(ge,"mtkw",1)}else f[g++]=new wn(T,"mtkw",1);E=E%o}}else(T===b||q&&T>s)&&(f[g++]=new wn(T,m,0),E=E%o);for(j===9?E=o:Ra(j)?E+=2:E++,k=q;T===b&&(p++,p<_);)m=i[p].type,b=i[p].endIndex}let N=!1;if(k)if(r&&h){let T=t>0?e.charCodeAt(t-1):0,j=t>1?e.charCodeAt(t-2):0;T===32&&j!==32&&j!==9||(N=!0)}else N=!0;if(N)if(d){const T=g>0?f[g-1].endIndex:s;for(let j=T+1;j<=t;j++)f[g++]=new wn(j,"mtkw",1)}else f[g++]=new wn(t,"mtkw",1);else f[g++]=new wn(t,m,0);return f}function yIe(n,e,t,i){i.sort(Ns.compare);const r=dIe.normalize(n,i),s=r.length;let o=0,a=[],l=0,c=0;for(let u=0,d=t.length;u<d;u++){const f=t[u],g=f.endIndex,p=f.type,m=f.metadata;for(;o<s&&r[o].startOffset<g;){const b=r[o];if(b.startOffset>c&&(c=b.startOffset,a[l++]=new wn(c,p,m)),b.endOffset+1<=g)c=b.endOffset+1,a[l++]=new wn(c,p+" "+b.className,m|b.metadata),o++;else{c=g,a[l++]=new wn(c,p+" "+b.className,m|b.metadata);break}}g>c&&(c=g,a[l++]=new wn(c,p,m))}const h=t[t.length-1].endIndex;if(o<s&&r[o].startOffset===h)for(;o<s&&r[o].startOffset===h;){const u=r[o];a[l++]=new wn(c,u.className,u.metadata),o++}return a}function CIe(n,e){const t=n.fontIsMonospace,i=n.canUseHalfwidthRightwardsArrow,r=n.containsForeignElements,s=n.lineContent,o=n.len,a=n.isOverflowing,l=n.parts,c=n.fauxIndentLength,h=n.tabSize,u=n.startVisibleColumn,d=n.containsRTL,f=n.spaceWidth,g=n.renderSpaceCharCode,p=n.renderWhitespace,m=n.renderControlCharacters,b=new kl(o+1,l.length);let _=!1,w=0,y=u,S=0,k=0,C=0,D=0;d?e.appendASCIIString('<span dir="ltr">'):e.appendASCIIString("<span>");for(let E=0,N=l.length;E<N;E++){D+=C;const T=l[E],j=T.endIndex,q=T.type,ie=p!==0&&T.isWhitespace(),ge=ie&&!t&&(q==="mtkw"||!r),be=w===j&&T.isPseudoAfter();if(S=0,e.appendASCIIString('<span class="'),e.appendASCIIString(ge?"mtkz":q),e.appendASCII(34),ie){let Se=0;{let Le=w,ke=y;for(;Le<j;Le++){const Ge=(s.charCodeAt(Le)===9?h-ke%h:1)|0;Se+=Ge,Le>=c&&(ke+=Ge)}}for(ge&&(e.appendASCIIString(' style="width:'),e.appendASCIIString(String(f*Se)),e.appendASCIIString('px"')),e.appendASCII(62);w<j;w++){b.setColumnInfo(w+1,E-k,S,D),k=0;const Le=s.charCodeAt(w);let ke;if(Le===9){ke=h-y%h|0,!i||ke>1?e.write1(8594):e.write1(65515);for(let Lt=2;Lt<=ke;Lt++)e.write1(160)}else ke=1,e.write1(g);S+=ke,w>=c&&(y+=ke)}C=Se}else{let Se=0;for(e.appendASCII(62);w<j;w++){b.setColumnInfo(w+1,E-k,S,D),k=0;const Le=s.charCodeAt(w);let ke=1,Lt=1;switch(Le){case 9:ke=h-y%h,Lt=ke;for(let Ge=1;Ge<=ke;Ge++)e.write1(160);break;case 32:e.write1(160);break;case 60:e.appendASCIIString("&lt;");break;case 62:e.appendASCIIString("&gt;");break;case 38:e.appendASCIIString("&amp;");break;case 0:m?e.write1(9216):e.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.write1(65533);break;default:Ra(Le)&&Lt++,m&&Le<32?e.write1(9216+Le):m&&Le===127?e.write1(9249):m&&SJ(Le)?(e.appendASCIIString("[U+"),e.appendASCIIString(SIe(Le)),e.appendASCIIString("]"),ke=8):e.write1(Le)}S+=ke,Se+=ke,w>=c&&(y+=Lt)}C=Se}be?k++:k=0,w>=o&&!_&&T.isPseudoAfter()&&(_=!0,b.setColumnInfo(w+1,E,S,D)),e.appendASCIIString("</span>")}return _||b.setColumnInfo(o+1,l.length-1,S,D),a&&e.appendASCIIString("<span>&hellip;</span>"),e.appendASCIIString("</span>"),new tF(b,d,r)}function SIe(n){return n.toString(16).toUpperCase().padStart(4,"0")}class OW{constructor(e,t,i,r){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=r|0}}class xIe{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e,t){const i=this.outputLineIndex>0?t:0;return new G(e+this.outputLineIndex,i+this.outputOffset+1)}}class iv{constructor(e,t,i,r,s){this.breakOffsets=e,this.breakOffsetsVisibleColumn=t,this.wrappedTextIndentLength=i,this.injectionOffsets=r,this.injectionOptions=s}getInputOffsetOfOutputPosition(e,t){let i=0;if(e===0?i=t:i=this.breakOffsets[e-1]+t,this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&i>this.injectionOffsets[r];r++)i<this.injectionOffsets[r]+this.injectionOptions[r].content.length?i=this.injectionOffsets[r]:i-=this.injectionOptions[r].content.length;return i}getOutputPositionOfInputOffset(e,t=2){let i=0;if(this.injectionOffsets!==null)for(let r=0;r<this.injectionOffsets.length&&!(e<this.injectionOffsets[r]||t!==1&&e===this.injectionOffsets[r]);r++)i+=this.injectionOptions[r].content.length;return e+=i,this.getOutputPositionOfOffsetInUnwrappedLine(e,t)}getOutputPositionOfOffsetInUnwrappedLine(e,t=2){let i=0,r=this.breakOffsets.length-1,s=0,o=0;for(;i<=r;){s=i+(r-i)/2|0;const a=this.breakOffsets[s];if(o=s>0?this.breakOffsets[s-1]:0,t===0)if(e<=o)r=s-1;else if(e>a)i=s+1;else break;else if(e<o)r=s-1;else if(e>=a)i=s+1;else break}return new xIe(s,e-o)}outputPositionToOffsetInUnwrappedLine(e,t){let i=(e>0?this.breakOffsets[e-1]:0)+t;return e>0&&(i-=this.wrappedTextIndentLength),i}normalizeOffsetAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2)return e===i.offsetInUnwrappedLine+i.length?i.offsetInUnwrappedLine+i.length:i.offsetInUnwrappedLine;if(t===1){let o=i.offsetInUnwrappedLine+i.length,a=i.injectedTextIndex;for(;a+1<this.injectionOffsets.length&&this.injectionOffsets[a+1]===this.injectionOffsets[a];)o+=this.injectionOptions[a+1].content.length,a++;return o}let r=i.offsetInUnwrappedLine,s=i.injectedTextIndex;for(;s-1>=0&&this.injectionOffsets[s-1]===this.injectionOffsets[s];)r-=this.injectionOptions[s-1].content.length,s++;return r}getInjectedText(e,t){const i=this.outputPositionToOffsetInUnwrappedLine(e,t),r=this.getInjectedTextAtOffset(i);return r?{options:this.injectionOptions[r.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let r=0;for(let s=0;s<t.length;s++){const o=i[s].content.length,a=t[s]+r,l=t[s]+r+o;if(a>e)break;if(e<=l)return{injectedTextIndex:s,offsetInUnwrappedLine:a,length:o};r+=o}}}}class EIe{constructor(e,t){this.tabSize=e,this.data=t}}class t5{constructor(e,t,i,r,s,o,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=r,this.startVisibleColumn=s,this.tokens=o,this.inlineDecorations=a}}class Ps{constructor(e,t,i,r,s,o,a,l,c,h){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=r,this.isBasicASCII=Ps.isBasicASCII(i,o),this.containsRTL=Ps.containsRTL(i,this.isBasicASCII,s),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=h}static isBasicASCII(e,t){return t?B3(e):!0}static containsRTL(e,t,i){return!t&&i?Zk(e):!1}}class nv{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class DIe{constructor(e,t,i,r){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=r}toInlineDecoration(e){return new nv(new V(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class xJ{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class EJ{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static cmp(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}}function kIe(n){return Array.isArray(n)}function LIe(n){return!kIe(n)}function DJ(n){return typeof n=="string"}function PW(n){return!DJ(n)}function Pp(n){return!n}function xu(n,e){return n.ignoreCase&&e?e.toLowerCase():e}function BW(n){return n.replace(/[&<>'"_]/g,"-")}function IIe(n,e){console.log(`${n.languageId}: ${e}`)}function jt(n,e){return new Error(`${n.languageId}: ${e}`)}function ru(n,e,t,i,r){const s=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let o=null;return e.replace(s,function(a,l,c,h,u,d,f,g,p){return Pp(c)?Pp(h)?!Pp(u)&&u<i.length?xu(n,i[u]):!Pp(f)&&n&&typeof n[f]=="string"?n[f]:(o===null&&(o=r.split("."),o.unshift(r)),!Pp(d)&&d<o.length?xu(n,o[d]):""):xu(n,t):"$"})}function _C(n,e){let t=e;for(;t&&t.length>0;){const i=n.tokenizer[t];if(i)return i;const r=t.lastIndexOf(".");r<0?t=null:t=t.substr(0,r)}return null}function TIe(n,e){let t=e;for(;t&&t.length>0;){if(n.stateNames[t])return!0;const r=t.lastIndexOf(".");r<0?t=null:t=t.substr(0,r)}return!1}const kJ=5;class Sw{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new km(e,t);let i=km.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let r=this._entries[i];return r||(r=new km(e,t),this._entries[i]=r,r)}}Sw._INSTANCE=new Sw(kJ);class km{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return km._equals(this,e)}push(e){return Sw.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Sw.create(this.parent,e)}}class rv{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new rv(this.languageId,this.state)}}class su{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(t!==null)return new sv(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new sv(e,t);let i=km.getStackElementId(e),r=this._entries[i];return r||(r=new sv(e,null),this._entries[i]=r,r)}}su._INSTANCE=new su(kJ);class sv{constructor(e,t){this.stack=e,this.embeddedModeData=t}clone(){return(this.embeddedModeData?this.embeddedModeData.clone():null)===this.embeddedModeData?this:su.create(this.stack,this.embeddedModeData)}equals(e){return!(e instanceof sv)||!this.stack.equals(e.stack)?!1:this.embeddedModeData===null&&e.embeddedModeData===null?!0:this.embeddedModeData===null||e.embeddedModeData===null?!1:this.embeddedModeData.equals(e.embeddedModeData)}}class AIe{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterMode(e,t){this._languageId=t}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new jk(e,t,this._languageId)))}nestedModeTokenize(e,t,i,r){const s=i.languageId,o=i.state,a=Fi.get(s);if(!a)return this.enterMode(r,s),this.emit(r,""),o;let l=a.tokenize(e,t,o,r);return this._tokens=this._tokens.concat(l.tokens),this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new k3(this._tokens,e)}}class OE{constructor(e,t){this._modeService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterMode(e,t){this._currentLanguageId=this._modeService.languageIdCodec.encodeLanguageId(t)}emit(e,t){let i=this._theme.match(this._currentLanguageId,t);this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){let r=e!==null?e.length:0,s=t.length,o=i!==null?i.length:0;if(r===0&&s===0&&o===0)return new Uint32Array(0);if(r===0&&s===0)return i;if(s===0&&o===0)return e;let a=new Uint32Array(r+s+o);e!==null&&a.set(e);for(let l=0;l<s;l++)a[r+l]=t[l];return i!==null&&a.set(i,r+s),a}nestedModeTokenize(e,t,i,r){const s=i.languageId,o=i.state,a=Fi.get(s);if(!a)return this.enterMode(r,s),this.emit(r,""),o;let l=a.tokenize2(e,t,o,r);return this._prependTokens=OE._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new qk(OE._merge(this._prependTokens,this._tokens,null),e)}}class aL{constructor(e,t,i,r){this._modeService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=r,this._embeddedModes=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let s=!1;this._tokenizationRegistryListener=Fi.onDidChange(o=>{if(s)return;let a=!1;for(let l=0,c=o.changedLanguages.length;l<c;l++){let h=o.changedLanguages[l];if(this._embeddedModes[h]){a=!0;break}}a&&(s=!0,Fi.fire([this._languageId]),s=!1)})}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){let e=[];for(let t in this._embeddedModes){const i=Fi.get(t);if(i){if(i instanceof aL){const s=i.getLoadStatus();s.loaded===!1&&e.push(s.promise)}continue}const r=Fi.getPromise(t);r&&e.push(r)}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){let e=Sw.create(null,this._lexer.start);return su.create(e,null)}tokenize(e,t,i,r){let s=new AIe,o=this._tokenize(e,t,i,r,s);return s.finalize(o)}tokenize2(e,t,i,r){let s=new OE(this._modeService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,i,r,s);return s.finalize(o)}_tokenize(e,t,i,r,s){return i.embeddedModeData?this._nestedTokenize(e,t,i,r,s):this._myTokenize(e,t,i,r,s)}_findLeavingNestedModeOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=_C(this._lexer,t.stack.state),!i))throw jt(this._lexer,"tokenizer state is not defined: "+t.stack.state);let r=-1,s=!1;for(const o of i){if(!PW(o.action)||o.action.nextEmbedded!=="@pop")continue;s=!0;let a=o.regex,l=o.regex.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){let h=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),h)}let c=e.search(a);c===-1||c!==0&&o.matchOnlyAtLineStart||(r===-1||c<r)&&(r=c)}if(!s)throw jt(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return r}_nestedTokenize(e,t,i,r,s){let o=this._findLeavingNestedModeOffset(e,i);if(o===-1){let c=s.nestedModeTokenize(e,t,i.embeddedModeData,r);return su.create(i.stack,new rv(i.embeddedModeData.languageId,c))}let a=e.substring(0,o);a.length>0&&s.nestedModeTokenize(a,!1,i.embeddedModeData,r);let l=e.substring(o);return this._myTokenize(l,t,i,r+o,s)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,r,s){s.enterMode(r,this._languageId);const o=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedModeData,h=i.stack,u=0,d=null,f=!0;for(;f||u<l;){const g=u,p=h.depth,m=d?d.groups.length:0,b=h.state;let _=null,w=null,y=null,S=null,k=null;if(d){_=d.matches;const E=d.groups.shift();w=E.matched,y=E.action,S=d.rule,d.groups.length===0&&(d=null)}else{if(!f&&u>=l)break;f=!1;let E=this._lexer.tokenizer[b];if(!E&&(E=_C(this._lexer,b),!E))throw jt(this._lexer,"tokenizer state is not defined: "+b);let N=a.substr(u);for(const T of E)if((u===0||!T.matchOnlyAtLineStart)&&(_=N.match(T.regex),_)){w=_[0],y=T.action;break}}if(_||(_=[""],w=""),y||(u<l&&(_=[a.charAt(u)],w=_[0]),y=this._lexer.defaultToken),w===null)break;for(u+=w.length;LIe(y)&&PW(y)&&y.test;)y=y.test(w,_,b,u===l);let C=null;if(typeof y=="string"||Array.isArray(y))C=y;else if(y.group)C=y.group;else if(y.token!==null&&y.token!==void 0){if(y.tokenSubst?C=ru(this._lexer,y.token,w,_,b):C=y.token,y.nextEmbedded)if(y.nextEmbedded==="@pop"){if(!c)throw jt(this._lexer,"cannot pop embedded mode if not inside one");c=null}else{if(c)throw jt(this._lexer,"cannot enter embedded mode from within an embedded mode");k=ru(this._lexer,y.nextEmbedded,w,_,b)}if(y.goBack&&(u=Math.max(0,u-y.goBack)),y.switchTo&&typeof y.switchTo=="string"){let E=ru(this._lexer,y.switchTo,w,_,b);if(E[0]==="@"&&(E=E.substr(1)),_C(this._lexer,E))h=h.switchTo(E);else throw jt(this._lexer,"trying to switch to a state '"+E+"' that is undefined in rule: "+this._safeRuleName(S))}else{if(y.transform&&typeof y.transform=="function")throw jt(this._lexer,"action.transform not supported");if(y.next)if(y.next==="@push"){if(h.depth>=this._lexer.maxStack)throw jt(this._lexer,"maximum tokenizer stack size reached: ["+h.state+","+h.parent.state+",...]");h=h.push(b)}else if(y.next==="@pop"){if(h.depth<=1)throw jt(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(S));h=h.pop()}else if(y.next==="@popall")h=h.popall();else{let E=ru(this._lexer,y.next,w,_,b);if(E[0]==="@"&&(E=E.substr(1)),_C(this._lexer,E))h=h.push(E);else throw jt(this._lexer,"trying to set a next state '"+E+"' that is undefined in rule: "+this._safeRuleName(S))}}y.log&&typeof y.log=="string"&&IIe(this._lexer,this._lexer.languageId+": "+ru(this._lexer,y.log,w,_,b))}if(C===null)throw jt(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(S));const D=E=>{let N=this._modeService.getModeIdForLanguageName(E);N&&(E=N);const T=this._getNestedEmbeddedModeData(E);if(u<l){const j=e.substr(u);return this._nestedTokenize(j,t,su.create(h,T),r+u,s)}else return su.create(h,T)};if(Array.isArray(C)){if(d&&d.groups.length>0)throw jt(this._lexer,"groups cannot be nested: "+this._safeRuleName(S));if(_.length!==C.length+1)throw jt(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(S));let E=0;for(let N=1;N<_.length;N++)E+=_[N].length;if(E!==w.length)throw jt(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(S));d={rule:S,matches:_,groups:[]};for(let N=0;N<C.length;N++)d.groups[N]={action:C[N],matched:_[N+1]};u-=w.length;continue}else{if(C==="@rematch"&&(u-=w.length,w="",_=null,C="",k!==null))return D(k);if(w.length===0){if(l===0||p!==h.depth||b!==h.state||(d?d.groups.length:0)!==m)continue;throw jt(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(S))}let E=null;if(DJ(C)&&C.indexOf("@brackets")===0){let N=C.substr(9),T=NIe(this._lexer,w);if(!T)throw jt(this._lexer,"@brackets token returned but no bracket defined as: "+w);E=BW(T.token+N)}else{let N=C===""?"":C+this._lexer.tokenPostfix;E=BW(N)}g<o&&s.emit(g+r,E)}if(k!==null)return D(k)}return su.create(h,c)}_getNestedEmbeddedModeData(e){let t=this._locateMode(e);if(t){let i=Fi.get(t);if(i)return new rv(t,i.getInitialState())}return new rv(t||qu,Jk)}_locateMode(e){if(!e||!this._modeService.isRegisteredMode(e))return null;if(e===this._languageId)return e;const t=this._modeService.getModeId(e);return t&&(this._modeService.triggerMode(t),this._embeddedModes[t]=!0),t}}function NIe(n,e){if(!e)return null;e=xu(n,e);let t=n.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}function RIe(n,e,t,i){return new aL(n,e,t,i)}var ST;const xT=(ST=window.trustedTypes)===null||ST===void 0?void 0:ST.createPolicy("standaloneColorizer",{createHTML:n=>n});class i5{static colorizeElement(e,t,i,r){r=r||{};let s=r.theme||"vs",o=r.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!o)return console.error("Mode not detected"),Promise.resolve();e.setTheme(s);let a=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+s;let l=c=>{var h;const u=(h=xT==null?void 0:xT.createHTML(c))!==null&&h!==void 0?h:c;i.innerHTML=u};return this.colorize(t,a||"",o,r).then(l,c=>console.error(c))}static colorize(e,t,i,r){const s=e.languageIdCodec;let o=4;r&&typeof r.tabSize=="number"&&(o=r.tabSize),V3(t)&&(t=t.substr(1));let a=nc(t),l=e.getModeId(i);if(!l)return Promise.resolve(VW(a,o,s));e.triggerMode(l);const c=Fi.get(l);if(c)return ET(a,o,c,s);const h=Fi.getPromise(l);return h?new Promise((u,d)=>{h.then(f=>{ET(a,o,f,s).then(u,d)},d)}):new Promise((u,d)=>{let f=null,g=null;const p=()=>{f&&(f.dispose(),f=null),g&&(g.dispose(),g=null);const m=Fi.get(l);if(m){ET(a,o,m,s).then(u,d);return}u(VW(a,o,s))};g=new Gr,g.cancelAndSet(p,500),f=Fi.onDidChange(m=>{m.changedLanguages.indexOf(l)>=0&&p()})})}static colorizeLine(e,t,i,r,s=4){const o=Ps.isBasicASCII(e,t),a=Ps.containsRTL(e,o,i);return oL(new $g(!1,!0,e,!1,o,a,0,r,[],s,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){let r=e.getLineContent(t);e.forceTokenization(t);let o=e.getLineTokens(t).inflate();return this.colorizeLine(r,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function ET(n,e,t,i){return new Promise((r,s)=>{const o=()=>{const a=MIe(n,e,t,i);if(t instanceof aL){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(o,s);return}}r(a)};o()})}function VW(n,e,t){let i=[];const s=new Uint32Array(2);s[0]=0,s[1]=16793600;for(let o=0,a=n.length;o<a;o++){let l=n[o];s[0]=l.length;const c=new In(s,l,t),h=Ps.isBasicASCII(l,!0),u=Ps.containsRTL(l,h,!0);let d=oL(new $g(!1,!0,l,!1,h,u,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(d.html),i.push("<br/>")}return i.join("")}function MIe(n,e,t,i){let r=[],s=t.getInitialState();for(let o=0,a=n.length;o<a;o++){let l=n[o],c=t.tokenize2(l,!0,s,0);In.convertToEndOffset(c.tokens,l.length);let h=new In(c.tokens,l,i);const u=Ps.isBasicASCII(l,!0),d=Ps.containsRTL(l,u,!0);let f=oL(new $g(!1,!0,l,!1,u,d,0,h.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));r=r.concat(f.html),r.push("<br/>"),s=c.endState}return r.join("")}var xw;(function(n){n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})(xw||(xw={}));(function(n){const e="error",t="warning",i="warn",r="info",s="ignore";function o(l){return l?wb(e,l)?n.Error:wb(t,l)||wb(i,l)?n.Warning:wb(r,l)?n.Info:n.Ignore:n.Ignore}n.fromValue=o;function a(l){switch(l){case n.Error:return e;case n.Warning:return t;case n.Info:return r;default:return s}}n.toString=a})(xw||(xw={}));const Li=xw;function n5(n){return n&&typeof n.getEditorType=="function"?n.getEditorType()===Xk.ICodeEditor:!1}const LJ=Dt("IWorkspaceEditService");function FIe(n){return Br(n)&&(!!n.newUri||!!n.oldUri)}function OIe(n){return Br(n)&&qe.isUri(n.resource)&&Br(n.edit)}class r5{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(OIe(t))return new IJ(t.resource,t.edit,t.modelVersionId,t.metadata);if(FIe(t))return new PIe(t.oldUri,t.newUri,t.options,t.metadata);throw new Error("Unsupported edit")})}}class IJ extends r5{constructor(e,t,i,r){super(r),this.resource=e,this.textEdit=t,this.versionId=i}}class PIe extends r5{constructor(e,t,i,r){super(r),this.oldResource=e,this.newResource=t,this.options=i}}const BIe=Object.prototype.hasOwnProperty;function VIe(n,e){for(let t in n)if(BIe.call(n,t)&&e({key:t,value:n[t]},function(){delete n[t]})===!1)return}class WIe{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}}const WW=new class{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new H,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(n){this._tabFocus!==n&&(this._tabFocus=n,this._onDidChangeTabFocus.fire(this._tabFocus))}},TJ=Object.hasOwnProperty;class $Ie{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class zIe{constructor(){this._values=[]}_read(e){return this._values[e]}_write(e,t){this._values[e]=t}}class qc{static readOptions(e){const t=e,i=new zIe;for(const r of Zp){const s=r.name==="_never_"?void 0:t[r.name];i._write(r.id,s)}return i}static validateOptions(e){const t=new BEe;for(const i of Zp)t._write(i.id,i.validate(e._read(i.id)));return t}static computeOptions(e,t){const i=new $Ie;for(const r of Zp)i._write(r.id,r.compute(t,i,e._read(r.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object")return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?ec(e,t):!1;for(let i in e)if(!qc._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let r=!1;for(const s of Zp){const o=!qc._deepEquals(e._read(s.id),t._read(s.id));i[s.id]=o,o&&(r=!0)}return r?new iQ(i):null}}function HIe(n){const e=n.wordWrap;e===!0?n.wordWrap="on":e===!1&&(n.wordWrap="off");const t=n.lineNumbers;t===!0?n.lineNumbers="on":t===!1&&(n.lineNumbers="off"),n.autoClosingBrackets===!1&&(n.autoClosingBrackets="never",n.autoClosingQuotes="never",n.autoSurround="never"),n.cursorBlinking==="visible"&&(n.cursorBlinking="solid");const s=n.renderWhitespace;s===!0?n.renderWhitespace="boundary":s===!1&&(n.renderWhitespace="none");const o=n.renderLineHighlight;o===!0?n.renderLineHighlight="line":o===!1&&(n.renderLineHighlight="none");const a=n.acceptSuggestionOnEnter;a===!0?n.acceptSuggestionOnEnter="on":a===!1&&(n.acceptSuggestionOnEnter="off");const l=n.tabCompletion;l===!1?n.tabCompletion="off":l===!0&&(n.tabCompletion="onlySnippets");const c=n.suggest;if(c&&typeof c.filteredTypes=="object"&&c.filteredTypes){const m={};m.method="showMethods",m.function="showFunctions",m.constructor="showConstructors",m.deprecated="showDeprecated",m.field="showFields",m.variable="showVariables",m.class="showClasses",m.struct="showStructs",m.interface="showInterfaces",m.module="showModules",m.property="showProperties",m.event="showEvents",m.operator="showOperators",m.unit="showUnits",m.value="showValues",m.constant="showConstants",m.enum="showEnums",m.enumMember="showEnumMembers",m.keyword="showKeywords",m.text="showWords",m.color="showColors",m.file="showFiles",m.reference="showReferences",m.folder="showFolders",m.typeParameter="showTypeParameters",m.snippet="showSnippets",VIe(m,b=>{const _=c.filteredTypes[b.key];_===!1&&(c[b.value]=_)})}const h=n.hover;h===!0?n.hover={enabled:!0}:h===!1&&(n.hover={enabled:!1});const u=n.parameterHints;u===!0?n.parameterHints={enabled:!0}:u===!1&&(n.parameterHints={enabled:!1});const d=n.autoIndent;d===!0?n.autoIndent="full":d===!1&&(n.autoIndent="advanced");const f=n.matchBrackets;f===!0?n.matchBrackets="always":f===!1&&(n.matchBrackets="never");const{renderIndentGuides:g,highlightActiveIndentGuide:p}=n;n.guides||(n.guides={}),g!==void 0&&(n.guides.indentation=!!g),p!==void 0&&(n.guides.highlightActiveIndentation=!!p)}function $W(n){const e=iu(n);return HIe(e),e}class PE extends re{constructor(e,t){super(),this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new H),this.onDidChangeFast=this._onDidChangeFast.event,this.isSimpleWidget=e,this._isDominatedByLongLines=!1,this._computeOptionsMemory=new nQ,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._rawOptions=$W(t),this._readOptions=qc.readOptions(this._rawOptions),this._validatedOptions=qc.validateOptions(this._readOptions),this._register(SE.onDidChangeZoomLevel(i=>this._recomputeOptions())),this._register(WW.onDidChangeTabFocus(i=>this._recomputeOptions()))}observeReferenceElement(e){}updatePixelRatio(){}_recomputeOptions(){const e=this.options,t=this._computeInternalOptions();if(!e)this.options=t;else{const i=qc.checkEquals(e,t);if(i===null)return;this.options=t,this._onDidChangeFast.fire(i),this._onDidChange.fire(i)}}getRawOptions(){return this._rawOptions}_computeInternalOptions(){const e=this._getEnvConfiguration(),t=kf.createFromValidatedSettings(this._validatedOptions,e.zoomLevel,e.pixelRatio,this.isSimpleWidget),i={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,fontInfo:this.readConfiguration(t),extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:WW.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport};return qc.computeOptions(this._validatedOptions,i)}static _subsetEquals(e,t){for(const i in t)if(TJ.call(t,i)){const r=t[i],s=e[i];if(s===r)continue;if(Array.isArray(s)&&Array.isArray(r)){if(!ec(s,r))return!1;continue}if(s&&typeof s=="object"&&r&&typeof r=="object"){if(!this._subsetEquals(s,r))return!1;continue}return!1}return!0}updateOptions(e){if(typeof e>"u")return;const t=$W(e);PE._subsetEquals(this._rawOptions,t)||(this._rawOptions=sl(this._rawOptions,t||{}),this._readOptions=qc.readOptions(this._rawOptions),this._validatedOptions=qc.validateOptions(this._readOptions),this._recomputeOptions())}setIsDominatedByLongLines(e){this._isDominatedByLongLines=e,this._recomputeOptions()}setMaxLineNumber(e){const t=PE._digitCount(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}static _digitCount(e){let t=0;for(;e;)e=Math.floor(e/10),t++;return t||1}}const UIe=Object.freeze({id:"editor",order:5,type:"object",title:v("editorConfigurationTitle","Editor"),scope:5}),jIe=Bn.as(b0.Configuration),BE=Object.assign(Object.assign({},UIe),{properties:{"editor.tabSize":{type:"number",default:sr.tabSize,minimum:1,markdownDescription:v("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.insertSpaces":{type:"boolean",default:sr.insertSpaces,markdownDescription:v("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.detectIndentation":{type:"boolean",default:sr.detectIndentation,markdownDescription:v("detectIndentation","Controls whether `#editor.tabSize#` and `#editor.insertSpaces#` will be automatically detected when a file is opened based on the file contents.")},"editor.trimAutoWhitespace":{type:"boolean",default:sr.trimAutoWhitespace,description:v("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:sr.largeFileOptimizations,description:v("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:v("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[v("wordBasedSuggestionsMode.currentDocument","Only suggest words from the active document."),v("wordBasedSuggestionsMode.matchingDocuments","Suggest words from all open documents of the same language."),v("wordBasedSuggestionsMode.allDocuments","Suggest words from all open documents.")],description:v("wordBasedSuggestionsMode","Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[v("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),v("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),v("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:v("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:v("stablePeek","Keep peek editors open even when double clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:v("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.language.brackets":{type:"array",default:!1,description:v("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:v("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:v("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:"array",default:!1,description:v("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:v("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:v("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:5e3,description:v("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:50,description:v("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:v("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:v("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:v("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:!1,description:v("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:"inherit",markdownEnumDescriptions:[v("wordWrap.off","Lines will never wrap."),v("wordWrap.on","Lines will wrap at the viewport width."),v("wordWrap.inherit","Lines will wrap according to the `#editor.wordWrap#` setting.")]}}});function qIe(n){return typeof n.type<"u"||typeof n.anyOf<"u"}for(const n of Zp){const e=n.schema;if(typeof e<"u")if(qIe(e))BE.properties[`editor.${n.name}`]=e;else for(let t in e)TJ.call(e,t)&&(BE.properties[t]=e[t])}let bC=null;function AJ(){return bC===null&&(bC=Object.create(null),Object.keys(BE.properties).forEach(n=>{bC[n]=!0})),bC}function GIe(n){return AJ()[`editor.${n}`]||!1}function KIe(n){return AJ()[`diffEditor.${n}`]||!1}jIe.registerConfiguration(BE);class x_{static insert(e,t){return{range:new V(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}class Ys{constructor(e={},t=[],i=[]){this._contents=e,this._keys=t,this._overrides=i,this.isFrozen=!1,this.overrideConfigurations=new Map}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?T2e(this.contents,e):this.contents}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=iu(this.contents),i=iu(this.overrides),r=[...this.keys];for(const s of e){this.mergeContents(t,s.contents);for(const o of s.overrides){const[a]=i.filter(l=>ec(l.identifiers,o.identifiers));a?this.mergeContents(a.contents,o.contents):i.push(iu(o))}for(const o of s.keys)r.indexOf(o)===-1&&r.push(o)}return new Ys(t,r,i)}freeze(){return this.isFrozen=!0,this}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;let i={};for(const r of ME([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[r],o=t[r];o&&(typeof s=="object"&&typeof o=="object"?(s=iu(s),this.mergeContents(s,o)):s=o),i[r]=s}return new Ys(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Br(e[i])&&Br(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=iu(t[i])}}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?hLe(e):e}getContentsForOverrideIdentifer(e){for(const t of this.overrides)if(t.identifiers.indexOf(e)!==-1)return t.contents;return null}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.addKey(e),Y3(this.contents,e,t,i=>{throw new Error(i)})}removeValue(e){this.removeKey(e)&&I2e(this.contents,e)}addKey(e){let t=this.keys.length;for(let i=0;i<t;i++)e.indexOf(this.keys[i])===0&&(t=i);this.keys.splice(t,1,e)}removeKey(e){let t=this.keys.indexOf(e);return t!==-1?(this.keys.splice(t,1),!0):!1}}class ZIe extends Ys{constructor(){const e=N2e(),t=A2e(),i=[];for(const r of Object.keys(e))Z3.test(r)&&i.push({identifiers:[D2e(r).trim()],keys:Object.keys(e[r]),contents:cJ(e[r],s=>console.error(`Conflict in default settings file: ${s}`))});super(e,t,i)}}let NJ=class RJ{constructor(e,t,i=new Ys,r=new Ys,s=new _r,o=new Ys,a=new _r,l=!0){this._defaultConfiguration=e,this._localUserConfiguration=t,this._remoteUserConfiguration=i,this._workspaceConfiguration=r,this._folderConfigurations=s,this._memoryConfiguration=o,this._memoryConfigurationByResource=a,this._freeze=l,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new _r,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidateConfigurationModel(t,i).getValue(e)}updateValue(e,t,i={}){let r;i.resource?(r=this._memoryConfigurationByResource.get(i.resource),r||(r=new Ys,this._memoryConfigurationByResource.set(i.resource,r))):r=this._memoryConfiguration,t===void 0?r.removeValue(e):r.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}getConsolidateConfigurationModel(e,t){let i=this.getConsolidatedConfigurationModelForResource(e,t);return e.overrideIdentifier?i.override(e.overrideIdentifier):i}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const r=t.getFolder(e);r&&(i=this.getFolderConsolidatedConfiguration(r.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),r=this._folderConfigurations.get(e);r?(t=i.merge(r),this._freeze&&(t=t.freeze()),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:r,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:r,keys:s}]),e},[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.user),r=this.parseConfigurationModel(e.workspace),s=e.folders.reduce((o,a)=>(o.set(qe.revive(a[0]),this.parseConfigurationModel(a[1])),o),new _r);return new RJ(t,i,new Ys,r,s,new Ys,new _r,!1)}static parseConfigurationModel(e){return new Ys(e.contents,e.keys,e.overrides).freeze()}};class YIe{constructor(e,t,i,r){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=r,this._previousConfiguration=void 0;const s=new Set;e.keys.forEach(a=>s.add(a)),e.overrides.forEach(([,a])=>a.forEach(l=>s.add(l))),this.affectedKeys=[...s.values()];const o=new Ys;this.affectedKeys.forEach(a=>o.setValue(a,{})),this.affectedKeysTree=o.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=NJ.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var i;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(t){const r=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(i=this.previous)===null||i===void 0?void 0:i.workspace):void 0,s=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!Ma(r,s)}return!0}return!1}doesAffectedKeysTreeContains(e,t){let i=cJ({[t]:!0},()=>{}),r;for(;typeof i=="object"&&(r=Object.keys(i)[0]);){if(e=e[r],!e)return!1;i=i[r]}return!0}}const XIe=/^(cursor|delete)/;class QIe extends re{constructor(e,t,i,r,s){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=r,this._logService=s,this._onDidUpdateKeybindings=this._register(new H),this._currentChord=null,this._currentChordChecker=new fy,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=em.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new Gr,this._logging=!1}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Re.None}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){const i=this.resolveKeyboardEvent(e);if(i.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),null;const[r]=i.getDispatchParts();if(r===null)return null;const s=this._contextKeyService.getContext(t),o=this._currentChord?this._currentChord.keypress:null;return this._getResolver().resolve(s,o,r)}_enterChordMode(e,t){this._currentChord={keypress:e,label:t},this._currentChordStatusMessage=this._notificationService.status(v("first.chord","({0}) was pressed. Waiting for second key of chord...",t));const i=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-i>5e3&&this._leaveChordMode()},500)}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChord=null}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[r]=i.getSingleModifierDispatchParts();if(r)return this._ignoreSingleModifiers.has(r)?(this._log(`+ Ignoring single modifier ${r} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=em.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=em.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${r}.`),this._currentSingleModifier=r,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):r===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${r} ${r}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${r}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[s]=i.getParts();return this._ignoreSingleModifiers=new em(s),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let r=!1;if(e.isChord())return console.warn("Unexpected keyboard event mapped to a chord"),!1;let s=null,o=null;if(i){const[h]=e.getSingleModifierDispatchParts();s=h,o=h}else[s]=e.getDispatchParts(),o=this._currentChord?this._currentChord.keypress:null;if(s===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),r;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,o,s);return this._logService.trace("KeybindingService#dispatch",l,c==null?void 0:c.commandId),c&&c.enterChord?(r=!0,this._enterChordMode(s,l),r):(this._currentChord&&(!c||!c.commandId)&&(this._notificationService.status(v("missing.chord","The key combination ({0}, {1}) is not a command.",this._currentChord.label,l),{hideAfter:10*1e3}),r=!0),this._leaveChordMode(),c&&c.commandId&&(c.bubble||(r=!0),typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,h=>this._notificationService.warn(h)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,h=>this._notificationService.warn(h)),XIe.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding"})),r)}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}class em{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}em.EMPTY=new em(null);let lL=MEe||"";const Zn=new Map;Zn.set("false",!1);Zn.set("true",!0);Zn.set("isMac",wt);Zn.set("isLinux",zr);Zn.set("isWindows",Kn);Zn.set("isWeb",hy);Zn.set("isMacNative",wt&&!hy);Zn.set("isEdge",lL.indexOf("Edg/")>=0);Zn.set("isFirefox",lL.indexOf("Firefox")>=0);Zn.set("isChrome",lL.indexOf("Chrome")>=0);Zn.set("isSafari",lL.indexOf("Safari")>=0);const JIe=Object.prototype.hasOwnProperty;class Ie{static has(e){return Gu.create(e)}static equals(e,t){return E_.create(e,t)}static regex(e,t){return VE.create(e,t)}static not(e){return lg.create(e)}static and(...e){return du.create(e,null)}static or(...e){return uh.create(e,null,!0)}static deserialize(e,t=!1){if(e)return this._deserializeOrExpression(e,t)}static _deserializeOrExpression(e,t){let i=e.split("||");return uh.create(i.map(r=>this._deserializeAndExpression(r,t)),null,!0)}static _deserializeAndExpression(e,t){let i=e.split("&&");return du.create(i.map(r=>this._deserializeOne(r,t)),null)}static _deserializeOne(e,t){if(e=e.trim(),e.indexOf("!=")>=0){let i=e.split("!=");return cL.create(i[0].trim(),this._deserializeValue(i[1],t))}if(e.indexOf("==")>=0){let i=e.split("==");return E_.create(i[0].trim(),this._deserializeValue(i[1],t))}if(e.indexOf("=~")>=0){let i=e.split("=~");return VE.create(i[0].trim(),this._deserializeRegexValue(i[1],t))}if(e.indexOf(" in ")>=0){let i=e.split(" in ");return s5.create(i[0].trim(),i[1].trim())}if(/^[^<=>]+>=[^<=>]+$/.test(e)){const i=e.split(">=");return dL.create(i[0].trim(),i[1].trim())}if(/^[^<=>]+>[^<=>]+$/.test(e)){const i=e.split(">");return uL.create(i[0].trim(),i[1].trim())}if(/^[^<=>]+<=[^<=>]+$/.test(e)){const i=e.split("<=");return gL.create(i[0].trim(),i[1].trim())}if(/^[^<=>]+<[^<=>]+$/.test(e)){const i=e.split("<");return fL.create(i[0].trim(),i[1].trim())}return/^\!\s*/.test(e)?lg.create(e.substr(1).trim()):Gu.create(e)}static _deserializeValue(e,t){if(e=e.trim(),e==="true")return!0;if(e==="false")return!1;let i=/^'([^']*)'$/.exec(e);return i?i[1].trim():e}static _deserializeRegexValue(e,t){if(AQ(e)){if(t)throw new Error("missing regexp-value for =~-expression");return console.warn("missing regexp-value for =~-expression"),null}let i=e.indexOf("/"),r=e.lastIndexOf("/");if(i===r||i<0){if(t)throw new Error(`bad regexp-value '${e}', missing /-enclosure`);return console.warn(`bad regexp-value '${e}', missing /-enclosure`),null}let s=e.slice(i+1,r),o=e[r+1]==="i"?"i":"";try{return new RegExp(s,o)}catch(a){if(t)throw new Error(`bad regexp-value '${e}', parse error: ${a}`);return console.warn(`bad regexp-value '${e}', parse error: ${a}`),null}}}function eTe(n,e){const t=n?n.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function Lm(n,e){return n.cmp(e)}class Bs{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return uo.INSTANCE}}Bs.INSTANCE=new Bs;class uo{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return Bs.INSTANCE}}uo.INSTANCE=new uo;class Gu{constructor(e,t){this.key=e,this.negated=t,this.type=2}static create(e,t=null){const i=Zn.get(e);return typeof i=="boolean"?i?uo.INSTANCE:Bs.INSTANCE:new Gu(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:FJ(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Zn.get(this.key);return typeof e=="boolean"?e?uo.INSTANCE:Bs.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=lg.create(this.key,this)),this.negated}}class E_{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}static create(e,t,i=null){if(typeof t=="boolean")return t?Gu.create(e,i):lg.create(e,i);const r=Zn.get(e);return typeof r=="boolean"?t===(r?"true":"false")?uo.INSTANCE:Bs.INSTANCE:new E_(e,t,i)}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Zn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?uo.INSTANCE:Bs.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=cL.create(this.key,this.value,this)),this.negated}}class s5{constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}static create(e,t){return new s5(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.indexOf(i)>=0:typeof i=="string"&&typeof t=="object"&&t!==null?JIe.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=o5.create(this)),this.negated}}class o5{constructor(e){this._actual=e,this.type=11}static create(e){return new o5(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}class cL{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}static create(e,t,i=null){if(typeof t=="boolean")return t?lg.create(e,i):Gu.create(e,i);const r=Zn.get(e);return typeof r=="boolean"?t===(r?"true":"false")?Bs.INSTANCE:uo.INSTANCE:new cL(e,t,i)}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=Zn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Bs.INSTANCE:uo.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=E_.create(this.key,this.value,this)),this.negated}}class lg{constructor(e,t){this.key=e,this.negated=t,this.type=3}static create(e,t=null){const i=Zn.get(e);return typeof i=="boolean"?i?Bs.INSTANCE:uo.INSTANCE:new lg(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:FJ(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=Zn.get(this.key);return typeof e=="boolean"?e?Bs.INSTANCE:uo.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Gu.create(this.key,this)),this.negated}}function hL(n,e){if(typeof n=="string"){const t=parseFloat(n);isNaN(t)||(n=t)}return typeof n=="string"||typeof n=="number"?e(n):Bs.INSTANCE}class uL{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}static create(e,t,i=null){return hL(t,r=>new uL(e,r,i))}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=gL.create(this.key,this.value,this)),this.negated}}class dL{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}static create(e,t,i=null){return hL(t,r=>new dL(e,r,i))}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=fL.create(this.key,this.value,this)),this.negated}}class fL{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}static create(e,t,i=null){return hL(t,r=>new fL(e,r,i))}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=dL.create(this.key,this.value,this)),this.negated}}class gL{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}static create(e,t,i=null){return hL(t,r=>new gL(e,r,i))}cmp(e){return e.type!==this.type?this.type-e.type:zg(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=uL.create(this.key,this.value,this)),this.negated}}class VE{constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}static create(e,t){return new VE(e,t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.ignoreCase?"i":""}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=a5.create(this)),this.negated}}class a5{constructor(e){this._actual=e,this.type=8}static create(e){return new a5(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}function MJ(n){let e=null;for(let t=0,i=n.length;t<i;t++){const r=n[t].substituteConstants();if(n[t]!==r&&e===null){e=[];for(let s=0;s<t;s++)e[s]=n[s]}e!==null&&(e[t]=r)}return e===null?n:e}class du{constructor(e,t){this.expr=e,this.negated=t,this.type=6}static create(e,t){return du._normalizeArr(e,t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const r=Lm(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=MJ(this.expr);return e===this.expr?this:du.create(e,this.negated)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t){const i=[];let r=!1;for(const s of e)if(s){if(s.type===1){r=!0;continue}if(s.type===0)return Bs.INSTANCE;if(s.type===6){i.push(...s.expr);continue}i.push(s)}if(i.length===0&&r)return uo.INSTANCE;if(i.length!==0){if(i.length===1)return i[0];i.sort(Lm);for(let s=1;s<i.length;s++)i[s-1].equals(i[s])&&(i.splice(s,1),s--);if(i.length===1)return i[0];for(;i.length>1;){const s=i[i.length-1];if(s.type!==9)break;i.pop();const o=i.pop(),a=i.length===0,l=uh.create(s.expr.map(c=>du.create([c,o],null)),null,a);l&&(i.push(l),i.sort(Lm))}return i.length===1?i[0]:new du(i,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(let t of this.expr)e.push(t.negate());this.negated=uh.create(e,this,!0)}return this.negated}}class uh{constructor(e,t){this.expr=e,this.negated=t,this.type=9}static create(e,t,i){return uh._normalizeArr(e,t,i)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const r=Lm(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=MJ(this.expr);return e===this.expr?this:uh.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let r=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===0){s=!0;continue}if(l.type===1)return uo.INSTANCE;if(l.type===9){r=r.concat(l.expr);continue}r.push(l)}}if(r.length===0&&s)return Bs.INSTANCE;r.sort(Lm)}if(r.length!==0){if(r.length===1)return r[0];for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];if(i){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)OJ(r[o],r[a])&&(r.splice(a,1),a--);if(r.length===1)return r[0]}return new uh(r,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),r=[];for(const o of WE(t))for(const a of WE(i))r.push(du.create([o,a],null));const s=e.length===0;e.unshift(uh.create(r,null,s))}this.negated=e[0]}return this.negated}}class Te extends Gu{constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?Te._info.push(Object.assign(Object.assign({},i),{key:e})):i!==!0&&Te._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}static all(){return Te._info.values()}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return E_.create(this.key,e)}}Te._info=[];const Xe=Dt("contextKeyService"),tTe="setContext";function FJ(n,e){return n<e?-1:n>e?1:0}function zg(n,e,t,i){return n<t?-1:n>t?1:e<i?-1:e>i?1:0}function OJ(n,e){if(e.type===6&&n.type!==9&&n.type!==6){for(const r of e.expr)if(n.equals(r))return!0}const t=n.negate(),i=WE(t).concat(WE(e));i.sort(Lm);for(let r=0;r<i.length;r++){const o=i[r].negate();for(let a=r+1;a<i.length;a++){const l=i[a];if(o.equals(l))return!0}}return!1}function WE(n){return n.type===9?n.expr:[n]}class Im{constructor(e,t,i){this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(let r=0,s=e.length;r<s;r++){const o=e[r].command;o&&this._defaultBoundCommands.set(o,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Im.combine(e,t);for(let r=0,s=this._keybindings.length;r<s;r++){let o=this._keybindings[r];o.keypressParts.length!==0&&(o.when&&o.when.type===0||this._addKeyPress(o.keypressParts[0],o))}}static _isTargetedForRemoval(e,t,i,r,s){return!(e.command!==r||t&&e.keypressParts[0]!==t||i&&e.keypressParts[1]!==i||s&&(!e.when||!eTe(s,e.when)))}static combine(e,t){e=e.slice(0);let i=[];for(const r of t){if(!r.command||r.command.length===0||r.command.charAt(0)!=="-"){i.push(r);continue}const s=r.command.substr(1),o=r.keypressParts[0],a=r.keypressParts[1],l=r.when;for(let c=e.length-1;c>=0;c--)this._isTargetedForRemoval(e[c],o,a,s,l)&&e.splice(c,1)}return e.concat(i)}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let r=i.length-1;r>=0;r--){let s=i[r];if(s.command===t.command)continue;const o=s.keypressParts.length>1,a=t.keypressParts.length>1;o&&a&&s.keypressParts[1]!==t.keypressParts[1]||Im.whenIsEntirelyIncluded(s.when,t.when)&&this._removeFromLookupMap(s)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,r=t.length;i<r;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:OJ(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let r=i.length-1;r>=0;r--){const s=i[r];if(t.contextMatchesRules(s.when))return s}return i[i.length-1]}resolve(e,t,i){this._log(`| Resolving ${i}${t?` chorded from ${t}`:""}`);let r=null;if(t!==null){const o=this._map.get(t);if(typeof o>"u")return this._log("\\ No keybinding entries."),null;r=[];for(let a=0,l=o.length;a<l;a++){let c=o[a];c.keypressParts[1]===i&&r.push(c)}}else{const o=this._map.get(i);if(typeof o>"u")return this._log("\\ No keybinding entries."),null;r=o}let s=this._findCommand(e,r);return s?t===null&&s.keypressParts.length>1&&s.keypressParts[1]!==null?(this._log(`\\ From ${r.length} keybinding entries, matched chord, when: ${zW(s.when)}, source: ${HW(s)}.`),{enterChord:!0,leaveChord:!1,commandId:null,commandArgs:null,bubble:!1}):(this._log(`\\ From ${r.length} keybinding entries, matched ${s.command}, when: ${zW(s.when)}, source: ${HW(s)}.`),{enterChord:!1,leaveChord:s.keypressParts.length>1,commandId:s.command,commandArgs:s.commandArgs,bubble:s.bubble}):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),null)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){let r=t[i];if(Im.contextMatchesRules(e,r.when))return r}return null}static contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function zW(n){return n?`${n.serialize()}`:"no when condition"}function HW(n){return n.extensionId?n.isBuiltinExtension?`built-in extension ${n.extensionId}`:`user extension ${n.extensionId}`:n.isDefault?"built-in":"user"}class $E{constructor(){this._coreKeybindings=[],this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Fo===1){if(e&&e.win)return e.win}else if(Fo===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=$E.bindToCurrentPlatform(e);if(t&&t.primary){const i=CM(t.primary,Fo);i&&this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when)}if(t&&Array.isArray(t.secondary))for(let i=0,r=t.secondary.length;i<r;i++){const s=t.secondary[i],o=CM(s,Fo);o&&this._registerDefaultKeybinding(o,e.id,e.args,e.weight,-i-1,e.when)}}registerCommandAndKeybindingRule(e){this.registerKeybindingRule(e),Pt.registerCommand(e)}static _mightProduceChar(e){return e>=21&&e<=30||e>=31&&e<=56?!0:e===80||e===81||e===82||e===83||e===84||e===85||e===86||e===110||e===111||e===87||e===88||e===89||e===90||e===91||e===92}_assertNoCtrlAlt(e,t){e.ctrlKey&&e.altKey&&!e.metaKey&&$E._mightProduceChar(e.keyCode)&&console.warn("Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ",e," for ",t)}_registerDefaultKeybinding(e,t,i,r,s,o){Fo===1&&this._assertNoCtrlAlt(e.parts[0],t),this._coreKeybindings.push({keybinding:e.parts,command:t,commandArgs:i,when:o,weight1:r,weight2:s,extensionId:null,isBuiltinExtension:!1}),this._cachedMergedKeybindings=null}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=[].concat(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(nTe)),this._cachedMergedKeybindings.slice(0)}}const xr=new $E,iTe={EditorModes:"platform.keybindingsRegistry"};Bn.add(iTe.EditorModes,xr);function nTe(n,e){return n.weight1!==e.weight1?n.weight1-e.weight1:n.command<e.command?-1:n.command>e.command?1:n.weight2-e.weight2}class UW{constructor(e,t,i,r,s,o,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.keypressParts=e?iF(e.getDispatchParts()):[],e&&this.keypressParts.length===0&&(this.keypressParts=iF(e.getSingleModifierDispatchParts())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=r,this.isDefault=s,this.extensionId=o,this.isBuiltinExtension=a}}function iF(n){let e=[];for(let t=0,i=n.length;t<i;t++){const r=n[t];if(!r)return e;e.push(r)}return e}class l5{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=i(a);if(l===null)return null;r[s]=oTe(a,l,this.modifierLabels[e])}return r.join(" ")}}const c5=new l5({ctrlKey:"",shiftKey:"",altKey:"",metaKey:"",separator:""},{ctrlKey:v({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:v({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:v({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:v({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:v({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:v({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:v({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:v({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),rTe=new l5({ctrlKey:v({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:v({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:v({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:v({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:v({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:v({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:v({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:v({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:v({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:v({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:v({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:v({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),sTe=new l5({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"});function oTe(n,e,t){if(e===null)return"";const i=[];return n.ctrlKey&&i.push(t.ctrlKey),n.shiftKey&&i.push(t.shiftKey),n.altKey&&i.push(t.altKey),n.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class aTe extends YDe{constructor(e,t){if(super(),t.length===0)throw Zl("parts");this._os=e,this._parts=t}getLabel(){return c5.toLabel(this._os,this._parts,e=>this._getLabel(e))}getAriaLabel(){return rTe.toLabel(this._os,this._parts,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._parts.length>1||this._parts[0].isDuplicateModifierCase()?null:sTe.toLabel(this._os,this._parts,e=>this._getElectronAccelerator(e))}isChord(){return this._parts.length>1}getParts(){return this._parts.map(e=>this._getPart(e))}_getPart(e){return new ZDe(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchParts(){return this._parts.map(e=>this._getDispatchPart(e))}getSingleModifierDispatchParts(){return this._parts.map(e=>this._getSingleModifierDispatchPart(e))}}class Ew extends aTe{constructor(e,t){super(t,e.parts)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"";case 16:return"";case 17:return"";case 18:return""}return lf.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":lf.toString(e.keyCode)}_getElectronAccelerator(e){return lf.toElectronAccelerator(e.keyCode)}_getDispatchPart(e){return Ew.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=lf.toString(e.keyCode),t}_getSingleModifierDispatchPart(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=E3[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 83;case 52:return 81;case 53:return 87;case 54:return 89;case 55:return 88;case 56:return 0;case 57:return 80;case 58:return 90;case 59:return 86;case 60:return 82;case 61:return 84;case 62:return 85;case 106:return 92}return 0}static _resolveSimpleUserBinding(e){if(!e)return null;if(e instanceof rg)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new rg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveUserBinding(e,t){const i=iF(e.map(r=>this._resolveSimpleUserBinding(r)));return i.length>0?[new Ew(new bE(i),t)]:[]}}const Qn=Dt("notificationService");class lTe{}const PJ=Dt("contextService");class cTe{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}var jW;(function(n){n.noSelection=v("noSelection","No selection"),n.singleSelectionRange=v("singleSelectionRange","Line {0}, Column {1} ({2} selected)"),n.singleSelection=v("singleSelection","Line {0}, Column {1}"),n.multiSelectionRange=v("multiSelectionRange","{0} selections ({1} characters selected)"),n.multiSelection=v("multiSelection","{0} selections"),n.emergencyConfOn=v("emergencyConfOn","Now changing the setting `accessibilitySupport` to 'on'."),n.openingDocs=v("openingDocs","Now opening the Editor Accessibility documentation page."),n.readonlyDiffEditor=v("readonlyDiffEditor"," in a read-only pane of a diff editor."),n.editableDiffEditor=v("editableDiffEditor"," in a pane of a diff editor."),n.readonlyEditor=v("readonlyEditor"," in a read-only code editor"),n.editableEditor=v("editableEditor"," in a code editor"),n.changeConfigToOnMac=v("changeConfigToOnMac","To configure the editor to be optimized for usage with a Screen Reader press Command+E now."),n.changeConfigToOnWinLinux=v("changeConfigToOnWinLinux","To configure the editor to be optimized for usage with a Screen Reader press Control+E now."),n.auto_on=v("auto_on","The editor is configured to be optimized for usage with a Screen Reader."),n.auto_off=v("auto_off","The editor is configured to never be optimized for usage with a Screen Reader, which is not the case at this time."),n.tabFocusModeOnMsg=v("tabFocusModeOnMsg","Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior by pressing {0}."),n.tabFocusModeOnMsgNoKb=v("tabFocusModeOnMsgNoKb","Pressing Tab in the current editor will move focus to the next focusable element. The command {0} is currently not triggerable by a keybinding."),n.tabFocusModeOffMsg=v("tabFocusModeOffMsg","Pressing Tab in the current editor will insert the tab character. Toggle this behavior by pressing {0}."),n.tabFocusModeOffMsgNoKb=v("tabFocusModeOffMsgNoKb","Pressing Tab in the current editor will insert the tab character. The command {0} is currently not triggerable by a keybinding."),n.openDocMac=v("openDocMac","Press Command+H now to open a browser window with more information related to editor accessibility."),n.openDocWinLinux=v("openDocWinLinux","Press Control+H now to open a browser window with more information related to editor accessibility."),n.outroMsg=v("outroMsg","You can dismiss this tooltip and return to the editor by pressing Escape or Shift+Escape."),n.showAccessibilityHelpAction=v("showAccessibilityHelpAction","Show Accessibility Help")})(jW||(jW={}));var qW;(function(n){n.inspectTokensAction=v("inspectTokens","Developer: Inspect Tokens")})(qW||(qW={}));var GW;(function(n){n.gotoLineActionLabel=v("gotoLineActionLabel","Go to Line/Column...")})(GW||(GW={}));var KW;(function(n){n.helpQuickAccessActionLabel=v("helpQuickAccess","Show all Quick Access Providers")})(KW||(KW={}));var ZW;(function(n){n.quickCommandActionLabel=v("quickCommandActionLabel","Command Palette"),n.quickCommandHelp=v("quickCommandActionHelp","Show And Run Commands")})(ZW||(ZW={}));var YW;(function(n){n.quickOutlineActionLabel=v("quickOutlineActionLabel","Go to Symbol..."),n.quickOutlineByCategoryActionLabel=v("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(YW||(YW={}));var zE;(function(n){n.editorViewAccessibleLabel=v("editorViewAccessibleLabel","Editor content"),n.accessibilityHelpMessage=v("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options.")})(zE||(zE={}));var XW;(function(n){n.toggleHighContrast=v("toggleHighContrast","Toggle High Contrast Theme")})(XW||(XW={}));var nF;(function(n){n.bulkEditServiceSummary=v("bulkEditServiceSummary","Made {0} edits in {1} files")})(nF||(nF={}));var BJ=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},VJ=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},WJ=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class hTe{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new H}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}function uTe(n,e,t){return n5(n)?e(n):t(n)}let rF=class{constructor(e){this.modelService=e}setEditor(e){this.editor=e}createModelReference(e){let t=null;return this.editor&&(t=uTe(this.editor,i=>this.findModel(i,e),i=>this.findModel(i.getOriginalEditor(),e)||this.findModel(i.getModifiedEditor(),e))),t?Promise.resolve(new xDe(new hTe(t))):Promise.reject(new Error("Model not found"))}findModel(e,t){let i=this.modelService.getModel(t);return i&&i.uri.toString()!==t.toString()?null:i}};rF=BJ([VJ(0,Kr)],rF);class pL{show(){return pL.NULL_PROGRESS_RUNNER}showWhile(e,t){return WJ(this,void 0,void 0,function*(){yield e})}}pL.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class dTe{confirm(e){return this.doConfirm(e).then(t=>({confirmed:t,checkboxChecked:!1}))}doConfirm(e){let t=e.message;return e.detail&&(t=t+`

`+e.detail),Promise.resolve(window.confirm(t))}show(e,t,i,r){return Promise.resolve({choice:0})}}class mL{info(e){return this.notify({severity:Li.Info,message:e})}warn(e){return this.notify({severity:Li.Warning,message:e})}error(e){return this.notify({severity:Li.Error,message:e})}notify(e){switch(e.severity){case Li.Error:console.error(e.message);break;case Li.Warning:console.warn(e.message);break;default:console.log(e.message);break}return mL.NO_OP}status(e,t){return re.None}}mL.NO_OP=new lTe;class fTe{constructor(e){this._onWillExecuteCommand=new H,this._onDidExecuteCommand=new H,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=Pt.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const r=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(r)}catch(r){return Promise.reject(r)}}}class $J extends QIe{constructor(e,t,i,r,s,o){super(e,t,i,r,s),this._cachedResolver=null,this._dynamicKeybindings=[],this._register(ae(o,Me.KEY_DOWN,a=>{const l=new bi(a);this._dispatch(l,l.target)&&(l.preventDefault(),l.stopPropagation())})),this._register(ae(window,Me.KEY_UP,a=>{const l=new bi(a);this._singleModifierDispatch(l,l.target)&&l.preventDefault()}))}addDynamicKeybinding(e,t,i,r){const s=CM(t,Fo),o=new ve;return s&&(this._dynamicKeybindings.push({keybinding:s.parts,command:e,when:r,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}),o.add(Et(()=>{for(let a=0;a<this._dynamicKeybindings.length;a++)if(this._dynamicKeybindings[a].command===e){this._dynamicKeybindings.splice(a,1),this.updateResolver({source:1});return}}))),o.add(Pt.registerCommand(e,i)),this.updateResolver({source:1}),o}updateResolver(e){this._cachedResolver=null,this._onDidUpdateKeybindings.fire(e)}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(xr.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Im(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){let i=[],r=0;for(const s of e){const o=s.when||void 0,a=s.keybinding;if(!a)i[r++]=new UW(void 0,s.command,s.commandArgs,o,t,null,!1);else{const l=Ew.resolveUserBinding(a,Fo);for(const c of l)i[r++]=new UW(c,s.command,s.commandArgs,o,t,null,!1)}}return i}resolveKeyboardEvent(e){let t=new rg(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode).toChord();return new Ew(t,Fo)}}function QW(n){return n&&typeof n=="object"&&(!n.overrideIdentifier||typeof n.overrideIdentifier=="string")&&(!n.resource||n.resource instanceof qe)}class zJ{constructor(){this._onDidChangeConfiguration=new H,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new NJ(new ZIe,new Ys)}getValue(e,t){const i=typeof e=="string"?e:void 0,r=QW(e)?e:QW(t)?t:{};return this._configuration.getValue(i,r,void 0)}updateValues(e){const t={data:this._configuration.toData()};let i=[];for(const r of e){const[s,o]=r;this.getValue(s)!==o&&(this._configuration.updateValue(s,o),i.push(s))}if(i.length>0){const r=new YIe({keys:i,overrides:[]},t,this._configuration);r.source=7,r.sourceConfig=null,this._onDidChangeConfiguration.fire(r)}return Promise.resolve()}}class gTe{constructor(e){this.configurationService=e,this._onDidChangeConfiguration=new H,this.configurationService.onDidChangeConfiguration(t=>{this._onDidChangeConfiguration.fire({affectedKeys:t.affectedKeys,affectsConfiguration:(i,r)=>t.affectsConfiguration(r)})})}getValue(e,t,i){const s=(G.isIPosition(t)?t:null)?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0;return typeof s>"u"?this.configurationService.getValue():this.configurationService.getValue(s)}}let sF=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:zr||wt?`
`:`\r
`}};sF=BJ([VJ(0,Zi)],sF);class pTe{publicLog(e,t){return Promise.resolve(void 0)}publicLog2(e,t){return this.publicLog(e,t)}}class _L{constructor(){const e=qe.from({scheme:_L.SCHEME,authority:"model",path:"/"});this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new cTe({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}}_L.SCHEME="inmemory";function HE(n,e,t){if(!e||!(n instanceof zJ))return;let i=[];Object.keys(e).forEach(r=>{GIe(r)&&i.push([`editor.${r}`,e[r]]),t&&KIe(r)&&i.push([`diffEditor.${r}`,e[r]])}),i.length>0&&n.updateValues(i)}class mTe{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return WJ(this,void 0,void 0,function*(){const i=new Map;for(let o of e){if(!(o instanceof IJ))throw new Error("bad edit - only text edits are supported");const a=this._modelService.getModel(o.resource);if(!a)throw new Error("bad edit - model not found");if(typeof o.versionId=="number"&&a.getVersionId()!==o.versionId)throw new Error("bad state - model changed in the meantime");let l=i.get(a);l||(l=[],i.set(a,l)),l.push(x_.replaceMove(V.lift(o.textEdit.range),o.textEdit.text))}let r=0,s=0;for(const[o,a]of i)o.pushStackElement(),o.pushEditOperations([],a,()=>[]),o.pushStackElement(),s+=1,r+=a.length;return{ariaSummary:No(nF.bulkEditServiceSummary,r,s)}})}}class _Te{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}}class bTe{constructor(e,t){this._codeEditorService=e,this._container=t,this.onDidLayout=Re.None}get dimension(){return this._dimension||(this._dimension=Kk(window.document.body)),this._dimension}get container(){return this._container}focus(){var e;(e=this._codeEditorService.getFocusedCodeEditor())===null||e===void 0||e.focus()}}const JW=2e4;let Vd,VS,oF,WS,aF;function vTe(n){Vd=document.createElement("div"),Vd.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),Vd.appendChild(i),i};VS=e(),oF=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("role","complementary"),i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),Vd.appendChild(i),i};WS=t(),aF=t(),n.appendChild(Vd)}function Hg(n){Vd&&(VS.textContent!==n?(Gn(oF),jE(VS,n)):(Gn(VS),jE(oF,n)))}function UE(n){Vd&&(wt?Hg(n):WS.textContent!==n?(Gn(aF),jE(WS,n)):(Gn(WS),jE(aF,n)))}function jE(n,e){Gn(n),e.length>JW&&(e=e.substr(0,JW)),n.textContent=e,n.style.visibility="hidden",n.style.visibility="visible"}const h5=Dt("markerDecorationsService");var qE=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class ea extends re{constructor(e,t="",i="",r=!0,s){super(),this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=r,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}run(e,t){return qE(this,void 0,void 0,function*(){this._actionCallback&&(yield this._actionCallback(e))})}}class D_ extends re{constructor(){super(...arguments),this._onBeforeRun=this._register(new H),this.onBeforeRun=this._onBeforeRun.event,this._onDidRun=this._register(new H),this.onDidRun=this._onDidRun.event}run(e,t){return qE(this,void 0,void 0,function*(){if(!e.enabled)return;this._onBeforeRun.fire({action:e});let i;try{yield this.runAction(e,t)}catch(r){i=r}this._onDidRun.fire({action:e,error:i})})}runAction(e,t){return qE(this,void 0,void 0,function*(){yield e.run(t)})}}class Fa extends ea{constructor(e){super(Fa.ID,e,e?"separator text":"separator"),this.checked=!1,this.enabled=!1}}Fa.ID="vs.actions.separator";class u5{constructor(e,t,i,r){this.tooltip="",this.enabled=!0,this.checked=!1,this.id=e,this.label=t,this.class=r,this._actions=i}get actions(){return this._actions}dispose(){}run(){return qE(this,void 0,void 0,function*(){})}}class bL extends ea{constructor(){super(bL.ID,v("submenu.empty","(empty)"),void 0,!1)}}bL.ID="vs.actions.empty";var Oa;(function(n){n.DARK="dark",n.LIGHT="light",n.HIGH_CONTRAST="hc"})(Oa||(Oa={}));const fi=Dt("themeService");var lF;(function(n){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}n.isThemeColor=e})(lF||(lF={}));function xs(n){return{id:n}}var mi;(function(n){function e(a){return a&&typeof a=="object"&&typeof a.id=="string"&&(typeof a.color>"u"||lF.isThemeColor(a.color))}n.isThemeIcon=e;const t=new RegExp(`^\\$\\((${ss.iconNameExpression}(?:${ss.iconModifierExpression})?)\\)$`);function i(a){const l=t.exec(a);if(!l)return;let[,c]=l;return{id:c}}n.fromString=i;function r(a,l){let c=a.id;const h=c.lastIndexOf("~");return h!==-1&&(c=c.substring(0,h)),l&&(c=`${c}~${l}`),{id:c}}n.modify=r;function s(a,l){var c,h;return a.id===l.id&&((c=a.color)===null||c===void 0?void 0:c.id)===((h=l.color)===null||h===void 0?void 0:h.id)}n.isEqual=s;function o(a,l){return{id:a.id,color:l?xs(l):void 0}}n.asThemeIcon=o,n.asClassNameArray=ss.asClassNameArray,n.asClassName=ss.asClassName,n.asCSSSelector=ss.asCSSSelector})(mi||(mi={}));function GE(n){switch(n){case Oa.DARK:return"vs-dark";case Oa.HIGH_CONTRAST:return"hc-black";default:return"vs"}}const HJ={ThemingContribution:"base.contributions.theming"};class wTe{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new H}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),Et(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}let UJ=new wTe;Bn.add(HJ.ThemingContribution,UJ);function li(n){return UJ.onColorThemeChange(n)}class yTe extends re{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var CTe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},e$=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};function yb(n){return n.command!==void 0}class Ye{constructor(e){this.id=Ye._idPool++,this._debugName=e}}Ye._idPool=0;Ye.CommandPalette=new Ye("CommandPalette");Ye.EditorContext=new Ye("EditorContext");Ye.SimpleEditorContext=new Ye("SimpleEditorContext");Ye.EditorContextCopy=new Ye("EditorContextCopy");Ye.EditorContextPeek=new Ye("EditorContextPeek");Ye.MenubarEditMenu=new Ye("MenubarEditMenu");Ye.MenubarCopy=new Ye("MenubarCopy");Ye.MenubarGoMenu=new Ye("MenubarGoMenu");Ye.MenubarSelectionMenu=new Ye("MenubarSelectionMenu");Ye.InlineCompletionsActions=new Ye("InlineCompletionsActions");const w0=Dt("menuService"),Pa=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new H,this.onDidChangeMenu=this._onDidChangeMenu.event,this._commandPaletteChangeEvent={has:n=>n===Ye.CommandPalette}}addCommand(n){return this.addCommands(vt.single(n))}addCommands(n){for(const e of n)this._commands.set(e.id,e);return this._onDidChangeMenu.fire(this._commandPaletteChangeEvent),Et(()=>{let e=!1;for(const t of n)e=this._commands.delete(t.id)||e;e&&this._onDidChangeMenu.fire(this._commandPaletteChangeEvent)})}getCommand(n){return this._commands.get(n)}getCommands(){const n=new Map;return this._commands.forEach((e,t)=>n.set(t,e)),n}appendMenuItem(n,e){return this.appendMenuItems(vt.single({id:n,item:e}))}appendMenuItems(n){const e=new Set,t=new As;for(const{id:i,item:r}of n){let s=this._menuItems.get(i);s||(s=new As,this._menuItems.set(i,s)),t.push(s.push(r)),e.add(i)}return this._onDidChangeMenu.fire(e),Et(()=>{if(t.size>0){for(let i of t)i();this._onDidChangeMenu.fire(e),t.clear()}})}getMenuItems(n){let e;return this._menuItems.has(n)?e=[...this._menuItems.get(n)]:e=[],n===Ye.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(n){const e=new Set;for(const t of n)yb(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||n.push({command:t})})}};class jJ extends u5{constructor(e,t,i,r){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,[],"submenu"),this.item=e,this._menuService=t,this._contextKeyService=i,this._options=r}get actions(){const e=[],t=this._menuService.createMenu(this.item.submenu,this._contextKeyService),i=t.getActions(this._options);t.dispose();for(const[,r]of i)r.length>0&&(e.push(...r),e.push(new Fa));return e.length&&e.pop(),e}}let Ku=class qJ{constructor(e,t,i,r,s){var o,a;if(this._commandService=s,this.id=e.id,this.label=i!=null&&i.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value,this.tooltip=(a=typeof e.tooltip=="string"?e.tooltip:(o=e.tooltip)===null||o===void 0?void 0:o.value)!==null&&a!==void 0?a:"",this.enabled=!e.precondition||r.contextMatchesRules(e.precondition),this.checked=void 0,e.toggled){const l=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=r.contextMatchesRules(l.condition),this.checked&&l.tooltip&&(this.tooltip=typeof l.tooltip=="string"?l.tooltip:l.tooltip.value),l.title&&(this.label=typeof l.title=="string"?l.title:l.title.value)}this.item=e,this.alt=t?new qJ(t,void 0,i,r,s):void 0,this._options=i,mi.isThemeIcon(e.icon)&&(this.class=ss.asClassName(e.icon))}dispose(){}run(...e){var t,i;let r=[];return!((t=this._options)===null||t===void 0)&&t.arg&&(r=[...r,this._options.arg]),!((i=this._options)===null||i===void 0)&&i.shouldForwardArgs&&(r=[...r,...e]),this._commandService.executeCommand(this.id,...r)}};Ku=CTe([e$(3,Xe),e$(4,An)],Ku);const y0=Dt("telemetryService");class vL{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this._description=e.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=Ie.and(i,this.precondition):i=this.precondition);const r={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};xr.registerKeybindingRule(r)}}Pt.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),description:this._description})}_registerMenuItem(e){Pa.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class d5 extends vL{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i){return this._implementations.push({priority:e,name:t,implementation:i}),this._implementations.sort((r,s)=>s.priority-r.priority),{dispose:()=>{for(let r=0;r<this._implementations.length;r++)if(this._implementations[r].implementation===i){this._implementations.splice(r,1);return}}}}runCommand(e,t){const i=e.get(Ih);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const r of this._implementations){const s=r.implementation(e,t);if(s)return i.trace(`Command '${this.id}' was handled by '${r.name}'.`),typeof s=="boolean"?void 0:s}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class GJ extends vL{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class mo extends vL{static bindToContribution(e){return class extends mo{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,r,s){e(r)&&this._callback(e(r),s)}}}runCommand(e,t){const i=e.get(ui),r=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(r)return r.invokeWithinContext(s=>{if(s.get(Xe).contextMatchesRules(hf(this.precondition)))return this.runEditorCommand(s,r,t)})}}class Si extends mo{constructor(e){super(Si.convertOptions(e)),this.label=e.label,this.alias=e.alias}static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(r){return r.menuId||(r.menuId=Ye.EditorContext),r.title||(r.title=e.label),r.when=Ie.and(e.precondition,r.when),r}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(y0).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class KJ extends Si{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,r)=>r[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const r of this._implementations){const s=r[1](e,t,i);if(s)return typeof s=="boolean"?void 0:s}}}function C0(n,e){Pt.registerCommand(n,function(t,...i){const[r,s]=i;ji(qe.isUri(r)),ji(G.isIPosition(s));const o=t.get(Kr).getModel(r);if(o){const a=G.lift(s);return e(o,a,...i.slice(2))}return t.get(sc).createModelReference(r).then(a=>new Promise((l,c)=>{try{const h=e(a.object.textEditorModel,G.lift(s),i.slice(2));l(h)}catch(h){c(h)}}).finally(()=>{a.dispose()}))})}function ye(n){return eo.INSTANCE.registerEditorCommand(n),n}function pt(n){const e=new n;return eo.INSTANCE.registerEditorAction(e),e}function ZJ(n){return eo.INSTANCE.registerEditorAction(n),n}function YJ(n){eo.INSTANCE.registerEditorAction(n)}function Yr(n,e){eo.INSTANCE.registerEditorContribution(n,e)}var Tm;(function(n){function e(o){return eo.INSTANCE.getEditorCommand(o)}n.getEditorCommand=e;function t(){return eo.INSTANCE.getEditorActions()}n.getEditorActions=t;function i(){return eo.INSTANCE.getEditorContributions()}n.getEditorContributions=i;function r(o){return eo.INSTANCE.getEditorContributions().filter(a=>o.indexOf(a.id)>=0)}n.getSomeEditorContributions=r;function s(){return eo.INSTANCE.getDiffEditorContributions()}n.getDiffEditorContributions=s})(Tm||(Tm={}));const STe={EditorCommonContributions:"editor.contributions"};class eo{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t){this.editorContributions.push({id:e,ctor:t})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions.slice(0)}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}eo.INSTANCE=new eo;Bn.add(STe.EditorCommonContributions,eo.INSTANCE);function _y(n){return n.register(),n}const f5=_y(new d5({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:Ye.MenubarEditMenu,group:"1_do",title:v({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:Ye.CommandPalette,group:"",title:v("undo","Undo"),order:1}]}));_y(new GJ(f5,{id:"default:undo",precondition:void 0}));const g5=_y(new d5({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:Ye.MenubarEditMenu,group:"1_do",title:v({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:Ye.CommandPalette,group:"",title:v("redo","Redo"),order:1}]}));_y(new GJ(g5,{id:"default:redo",precondition:void 0}));const xTe=_y(new d5({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:Ye.MenubarSelectionMenu,group:"1_basic",title:v({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:Ye.CommandPalette,group:"",title:v("selectAll","Select All"),order:1}]}));var ETe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},DTe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let Dw=class{constructor(e,t){}dispose(){}};Dw.ID="editor.contrib.markerDecorations";Dw=ETe([DTe(1,h5)],Dw);Yr(Dw.ID,Dw);class kTe{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class p5{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const e=this._bareFontInfo.getMassagedFontFamily(Yo?Sr.fontFamily:null),t=document.createElement("div");t.style.position="absolute",t.style.top="-50000px",t.style.width="50000px";const i=document.createElement("div");i.style.fontFamily=e,i.style.fontWeight=this._bareFontInfo.fontWeight,i.style.fontSize=this._bareFontInfo.fontSize+"px",i.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,i.style.lineHeight=this._bareFontInfo.lineHeight+"px",i.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",t.appendChild(i);const r=document.createElement("div");r.style.fontFamily=e,r.style.fontWeight="bold",r.style.fontSize=this._bareFontInfo.fontSize+"px",r.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,r.style.lineHeight=this._bareFontInfo.lineHeight+"px",r.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",t.appendChild(r);const s=document.createElement("div");s.style.fontFamily=e,s.style.fontWeight=this._bareFontInfo.fontWeight,s.style.fontSize=this._bareFontInfo.fontSize+"px",s.style.fontFeatureSettings=this._bareFontInfo.fontFeatureSettings,s.style.lineHeight=this._bareFontInfo.lineHeight+"px",s.style.letterSpacing=this._bareFontInfo.letterSpacing+"px",s.style.fontStyle="italic",t.appendChild(s);const o=[];for(const a of this._requests){let l;a.type===0&&(l=i),a.type===2&&(l=r),a.type===1&&(l=s),l.appendChild(document.createElement("br"));const c=document.createElement("span");p5._render(c,a),l.appendChild(c),o.push(c)}this._container=t,this._testElements=o}static _render(e,t){if(t.chr===" "){let i="";for(let r=0;r<8;r++)i+=i;e.innerText=i}else{let i=t.chr;for(let r=0;r<8;r++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],r=this._testElements[e];i.fulfill(r.offsetWidth/256)}}}function LTe(n,e){new p5(n,e).read()}class XJ extends re{constructor(e,t,i){super(),this.referenceDomElement=e,this.changeCallback=i,this.width=-1,this.height=-1,this.resizeObserver=null,this.measureReferenceDomElementToken=-1,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this.width}getHeight(){return this.height}startObserving(){typeof ResizeObserver<"u"?!this.resizeObserver&&this.referenceDomElement&&(this.resizeObserver=new ResizeObserver(e=>{e&&e[0]&&e[0].contentRect?this.observe({width:e[0].contentRect.width,height:e[0].contentRect.height}):this.observe()}),this.resizeObserver.observe(this.referenceDomElement)):this.measureReferenceDomElementToken===-1&&(this.measureReferenceDomElementToken=setInterval(()=>this.observe(),100))}stopObserving(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.measureReferenceDomElementToken!==-1&&(clearInterval(this.measureReferenceDomElementToken),this.measureReferenceDomElementToken=-1)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,r=0;t?(i=t.width,r=t.height):this.referenceDomElement&&(i=this.referenceDomElement.clientWidth,r=this.referenceDomElement.clientHeight),i=Math.max(5,i),r=Math.max(5,r),(this.width!==i||this.height!==r)&&(this.width=i,this.height=r,e&&this.changeCallback())}}class t${constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}function ITe(){cg.INSTANCE.clearCache()}class cg extends re{constructor(){super(),this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._cache=new t$,this._evictUntrustedReadingsTimeout=-1}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearCache(){this._cache=new t$,this._onDidChange.fire()}_writeToCache(e,t){this._cache.put(e,t),!t.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()},5e3))}_evictUntrustedReadings(){const e=this._cache.getValues();let t=!1;for(const i of e)i.isTrusted||(t=!0,this._cache.remove(i));t&&this._onDidChange.fire()}readConfiguration(e){if(!this._cache.has(e)){let t=cg._actualReadConfiguration(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new PM({zoomLevel:yM(),pixelRatio:mE(),fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:t.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(t.spaceWidth,5),middotWidth:Math.max(t.middotWidth,5),wsmiddotWidth:Math.max(t.wsmiddotWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}static createRequest(e,t,i,r){const s=new kTe(e,t);return i.push(s),r&&r.push(s),s}static _actualReadConfiguration(e){const t=[],i=[],r=this.createRequest("n",0,t,i),s=this.createRequest("",0,t,null),o=this.createRequest(" ",0,t,i),a=this.createRequest("0",0,t,i),l=this.createRequest("1",0,t,i),c=this.createRequest("2",0,t,i),h=this.createRequest("3",0,t,i),u=this.createRequest("4",0,t,i),d=this.createRequest("5",0,t,i),f=this.createRequest("6",0,t,i),g=this.createRequest("7",0,t,i),p=this.createRequest("8",0,t,i),m=this.createRequest("9",0,t,i),b=this.createRequest("",0,t,i),_=this.createRequest("",0,t,null),w=this.createRequest("",0,t,i),y=this.createRequest(String.fromCharCode(11825),0,t,null),S="|/-_ilm%";for(let T=0,j=S.length;T<j;T++)this.createRequest(S.charAt(T),0,t,i),this.createRequest(S.charAt(T),1,t,i),this.createRequest(S.charAt(T),2,t,i);LTe(e,t);const k=Math.max(a.width,l.width,c.width,h.width,u.width,d.width,f.width,g.width,p.width,m.width);let C=e.fontFeatureSettings===Cs.OFF;const D=i[0].width;for(let T=1,j=i.length;C&&T<j;T++){const q=D-i[T].width;if(q<-.001||q>.001){C=!1;break}}let E=!0;C&&_.width!==D&&(E=!1),_.width>b.width&&(E=!1);const N=qDe()>2e3;return new PM({zoomLevel:yM(),pixelRatio:mE(),fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:C,typicalHalfwidthCharacterWidth:r.width,typicalFullwidthCharacterWidth:s.width,canUseHalfwidthRightwardsArrow:E,spaceWidth:o.width,middotWidth:w.width,wsmiddotWidth:y.width,maxDigitWidth:k},N)}}cg.INSTANCE=new cg;class Yn extends PE{constructor(e,t,i=null,r){super(e,t),this.accessibilityService=r,this._elementSizeObserver=this._register(new XJ(i,t.dimension,()=>this._recomputeOptions())),this._register(cg.INSTANCE.onDidChange(()=>this._recomputeOptions())),this._validatedOptions.get(10)&&this._elementSizeObserver.startObserving(),this._register(mQ(s=>this._recomputeOptions())),this._register(this.accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions())),this._recomputeOptions()}static applyFontInfoSlow(e,t){e.style.fontFamily=t.getMassagedFontFamily(Yo?Sr.fontFamily:null),e.style.fontWeight=t.fontWeight,e.style.fontSize=t.fontSize+"px",e.style.fontFeatureSettings=t.fontFeatureSettings,e.style.lineHeight=t.lineHeight+"px",e.style.letterSpacing=t.letterSpacing+"px"}static applyFontInfo(e,t){e.setFontFamily(t.getMassagedFontFamily(Yo?Sr.fontFamily:null)),e.setFontWeight(t.fontWeight),e.setFontSize(t.fontSize),e.setFontFeatureSettings(t.fontFeatureSettings),e.setLineHeight(t.lineHeight),e.setLetterSpacing(t.letterSpacing)}observeReferenceElement(e){this._elementSizeObserver.observe(e)}updatePixelRatio(){this._recomputeOptions()}static _getExtraEditorClassName(){let e="";return!Yo&&!KDe&&(e+="no-user-select "),Yo&&(e+="no-minimap-shadow "),wt&&(e+="mac "),e}_getEnvConfiguration(){return{extraEditorClassName:Yn._getExtraEditorClassName(),outerWidth:this._elementSizeObserver.getWidth(),outerHeight:this._elementSizeObserver.getHeight(),emptySelectionClipboard:Df||$r,pixelRatio:mE(),zoomLevel:yM(),accessibilitySupport:this.accessibilityService.isScreenReaderOptimized()?2:this.accessibilityService.getAccessibilitySupport()}}readConfiguration(e){return cg.INSTANCE.readConfiguration(e)}}class QJ{constructor(e){this.domNode=e,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._fontFeatureSettings="",this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth+"px")}setWidth(e){this._width!==e&&(this._width=e,this.domNode.style.width=this._width+"px")}setHeight(e){this._height!==e&&(this._height=e,this.domNode.style.height=this._height+"px")}setTop(e){this._top!==e&&(this._top=e,this.domNode.style.top=this._top+"px")}unsetTop(){this._top!==-1&&(this._top=-1,this.domNode.style.top="")}setLeft(e){this._left!==e&&(this._left=e,this.domNode.style.left=this._left+"px")}setBottom(e){this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom+"px")}setRight(e){this._right!==e&&(this._right=e,this.domNode.style.right=this._right+"px")}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize+"px")}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight+"px")}setLetterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing+"px")}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function xt(n){return new QJ(n)}function an(n,e,t){let i=null,r=null;if(typeof t.value=="function"?(i="value",r=t.value,r.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",r=t.get),!r)throw new Error("not supported");const s=`$memoize$${e}`;t[i]=function(...o){return this.hasOwnProperty(s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,o)}),this[s]}}var TTe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Qt;(function(n){n.Tap="-monaco-gesturetap",n.Change="-monaco-gesturechange",n.Start="-monaco-gesturestart",n.End="-monaco-gesturesend",n.Contextmenu="-monaco-gesturecontextmenu"})(Qt||(Qt={}));class Rt extends re{constructor(){super(),this.dispatched=!1,this.activeTouches={},this.handle=null,this.targets=[],this.ignoreTargets=[],this._lastSetTapCountTime=0,this._register(ae(document,"touchstart",e=>this.onTouchStart(e),{passive:!1})),this._register(ae(document,"touchend",e=>this.onTouchEnd(e))),this._register(ae(document,"touchmove",e=>this.onTouchMove(e),{passive:!1}))}static addTarget(e){return Rt.isTouchDevice()?(Rt.INSTANCE||(Rt.INSTANCE=new Rt),Rt.INSTANCE.targets.push(e),{dispose:()=>{Rt.INSTANCE.targets=Rt.INSTANCE.targets.filter(t=>t!==e)}}):re.None}static ignoreTarget(e){return Rt.isTouchDevice()?(Rt.INSTANCE||(Rt.INSTANCE=new Rt),Rt.INSTANCE.ignoreTargets.push(e),{dispose:()=>{Rt.INSTANCE.ignoreTargets=Rt.INSTANCE.ignoreTargets.filter(t=>t!==e)}}):re.None}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,r=e.targetTouches.length;i<r;i++){let s=e.targetTouches.item(i);this.activeTouches[s.identifier]={id:s.identifier,initialTarget:s.target,initialTimeStamp:t,initialPageX:s.pageX,initialPageY:s.pageY,rollingTimestamps:[t],rollingPageX:[s.pageX],rollingPageY:[s.pageY]};let o=this.newGestureEvent(Qt.Start,s.target);o.pageX=s.pageX,o.pageY=s.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){let t=Date.now(),i=Object.keys(this.activeTouches).length;for(let r=0,s=e.changedTouches.length;r<s;r++){let o=e.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(o.identifier))){console.warn("move of an UNKNOWN touch",o);continue}let a=this.activeTouches[o.identifier],l=Date.now()-a.initialTimeStamp;if(l<Rt.HOLD_DELAY&&Math.abs(a.initialPageX-js(a.rollingPageX))<30&&Math.abs(a.initialPageY-js(a.rollingPageY))<30){let c=this.newGestureEvent(Qt.Tap,a.initialTarget);c.pageX=js(a.rollingPageX),c.pageY=js(a.rollingPageY),this.dispatchEvent(c)}else if(l>=Rt.HOLD_DELAY&&Math.abs(a.initialPageX-js(a.rollingPageX))<30&&Math.abs(a.initialPageY-js(a.rollingPageY))<30){let c=this.newGestureEvent(Qt.Contextmenu,a.initialTarget);c.pageX=js(a.rollingPageX),c.pageY=js(a.rollingPageY),this.dispatchEvent(c)}else if(i===1){let c=js(a.rollingPageX),h=js(a.rollingPageY),u=js(a.rollingTimestamps)-a.rollingTimestamps[0],d=c-a.rollingPageX[0],f=h-a.rollingPageY[0];const g=this.targets.filter(p=>a.initialTarget instanceof Node&&p.contains(a.initialTarget));this.inertia(g,t,Math.abs(d)/u,d>0?1:-1,c,Math.abs(f)/u,f>0?1:-1,h)}this.dispatchEvent(this.newGestureEvent(Qt.End,a.initialTarget)),delete this.activeTouches[o.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Qt.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>Rt.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Qt.Change||e.type===Qt.Contextmenu)&&(this._lastSetTapCountTime=0);for(let t=0;t<this.ignoreTargets.length;t++)if(e.initialTarget instanceof Node&&this.ignoreTargets[t].contains(e.initialTarget))return;this.targets.forEach(t=>{e.initialTarget instanceof Node&&t.contains(e.initialTarget)&&(t.dispatchEvent(e),this.dispatched=!0)})}inertia(e,t,i,r,s,o,a,l){this.handle=ic(()=>{let c=Date.now(),h=c-t,u=0,d=0,f=!0;i+=Rt.SCROLL_FRICTION*h,o+=Rt.SCROLL_FRICTION*h,i>0&&(f=!1,u=r*i*h),o>0&&(f=!1,d=a*o*h);let g=this.newGestureEvent(Qt.Change);g.translationX=u,g.translationY=d,e.forEach(p=>p.dispatchEvent(g)),f||this.inertia(e,c,i,r,s+u,o,a,l+d)})}onTouchMove(e){let t=Date.now();for(let i=0,r=e.changedTouches.length;i<r;i++){let s=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(s.identifier))){console.warn("end of an UNKNOWN touch",s);continue}let o=this.activeTouches[s.identifier],a=this.newGestureEvent(Qt.Change,o.initialTarget);a.translationX=s.pageX-js(o.rollingPageX),a.translationY=s.pageY-js(o.rollingPageY),a.pageX=s.pageX,a.pageY=s.pageY,this.dispatchEvent(a),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(s.pageX),o.rollingPageY.push(s.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}Rt.SCROLL_FRICTION=-.005;Rt.HOLD_DELAY=700;Rt.CLEAR_TAP_COUNT_TIME=400;TTe([an],Rt,"isTouchDevice",null);function S0(n,e){let t=new oo(e);return t.preventDefault(),{leftButton:t.leftButton,buttons:t.buttons,posx:t.posx,posy:t.posy}}class Ug{constructor(){this._hooks=new ve,this._mouseMoveEventMerger=null,this._mouseMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._mouseMoveEventMerger=null,this._mouseMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._mouseMoveEventMerger}startMonitoring(e,t,i,r,s){if(this.isMonitoring())return;this._mouseMoveEventMerger=i,this._mouseMoveCallback=r,this._onStopCallback=s;const o=xM.getSameOriginWindowChain(),a=Hu?"pointermove":"mousemove",l="mouseup",c=o.map(u=>u.window.document),h=m0(e);h&&c.unshift(h);for(const u of c)this._hooks.add(A3(u,a,d=>{if(d.buttons!==t){this.stopMonitoring(!0);return}this._mouseMoveCallback(d)},(d,f)=>this._mouseMoveEventMerger(d,f))),this._hooks.add(ae(u,l,d=>this.stopMonitoring(!0)));if(xM.hasDifferentOriginAncestor()){let u=o[o.length-1];this._hooks.add(ae(u.window.document,"mouseout",d=>{new oo(d).target.tagName.toLowerCase()==="html"&&this.stopMonitoring(!0)})),this._hooks.add(ae(u.window.document,"mouseover",d=>{new oo(d).target.tagName.toLowerCase()==="html"&&this.stopMonitoring(!0)})),this._hooks.add(ae(u.window.document.body,"mouseleave",d=>{this.stopMonitoring(!0)}))}}}class m5{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new JJ(this.x-fh.scrollX,this.y-fh.scrollY)}}class JJ{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new m5(this.clientX+fh.scrollX,this.clientY+fh.scrollY)}}class ATe{constructor(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r,this._editorPagePositionBrand=void 0}}function eee(n){const e=jn(n);return new ATe(e.left,e.top,e.width,e.height)}class hg extends oo{constructor(e,t){super(e),this._editorMouseEventBrand=void 0,this.pos=new m5(this.posx,this.posy),this.editorPos=eee(t)}}class NTe{constructor(e){this._editorViewDomNode=e}_create(e){return new hg(e,this._editorViewDomNode)}onContextMenu(e,t){return ae(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return ae(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return ae(e,"mousedown",i=>{t(this._create(i))})}onMouseLeave(e,t){return T3(e,i=>{t(this._create(i))})}onMouseMoveThrottled(e,t,i,r){return A3(e,"mousemove",t,(o,a)=>i(o,this._create(a)),r)}}class RTe{constructor(e){this._editorViewDomNode=e}_create(e){return new hg(e,this._editorViewDomNode)}onPointerUp(e,t){return ae(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return ae(e,"pointerdown",i=>{t(this._create(i))})}onPointerLeave(e,t){return hke(e,i=>{t(this._create(i))})}onPointerMoveThrottled(e,t,i,r){return A3(e,"pointermove",t,(o,a)=>i(o,this._create(a)),r)}}class MTe extends re{constructor(e){super(),this._editorViewDomNode=e,this._globalMouseMoveMonitor=this._register(new Ug),this._keydownListener=null}startMonitoring(e,t,i,r,s){this._keydownListener=dn(document,"keydown",a=>{a.toKeybinding().isModifierKey()||this._globalMouseMoveMonitor.stopMonitoring(!0,a.browserEvent)},!0);const o=(a,l)=>i(a,new hg(l,this._editorViewDomNode));this._globalMouseMoveMonitor.startMonitoring(e,t,o,r,a=>{this._keydownListener.dispose(),s(a)})}stopMonitoring(){this._globalMouseMoveMonitor.stopMonitoring(!0)}}class by extends re{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,r=e.length;i<r;i++){let s=e[i];switch(s.type){case 0:this.onCompositionStart(s)&&(t=!0);break;case 1:this.onCompositionEnd(s)&&(t=!0);break;case 2:this.onConfigurationChanged(s)&&(t=!0);break;case 3:this.onCursorStateChanged(s)&&(t=!0);break;case 4:this.onDecorationsChanged(s)&&(t=!0);break;case 5:this.onFlushed(s)&&(t=!0);break;case 6:this.onFocusChanged(s)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(s)&&(t=!0);break;case 8:this.onLineMappingChanged(s)&&(t=!0);break;case 9:this.onLinesChanged(s)&&(t=!0);break;case 10:this.onLinesDeleted(s)&&(t=!0);break;case 11:this.onLinesInserted(s)&&(t=!0);break;case 12:this.onRevealRangeRequest(s)&&(t=!0);break;case 13:this.onScrollChanged(s)&&(t=!0);break;case 15:this.onTokensChanged(s)&&(t=!0);break;case 14:this.onThemeChanged(s)&&(t=!0);break;case 16:this.onTokensColorsChanged(s)&&(t=!0);break;case 17:this.onZonesChanged(s)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(s)}}t&&(this._shouldRender=!0)}}class _o extends by{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class oc{static write(e,t){e instanceof QJ,e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){let i=[],r=0;for(;e&&e!==document.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[r++]=this.read(e)),e=e.parentElement;const s=new Uint8Array(r);for(let o=0;o<r;o++)s[o]=i[r-o-1];return s}}class FTe{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e){return this._viewLayout.getVerticalOffsetForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class OTe extends FTe{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class PTe{constructor(e,t,i){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i}}class wL{constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}static from(e){const t=new Array(e.length);for(let i=0,r=e.length;i<r;i++){const s=e[i];t[i]=new wL(s.left,s.width)}return t}toString(){return`[${this.left},${this.width}]`}}class Am{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class BTe{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class VTe{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class DT{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,r,s){const o=this._createRange();try{return o.setStart(e,t),o.setEnd(i,r),o.getClientRects()}catch{return null}finally{this._detachRange(o,s)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(Am.compare);let t=[],i=0,r=e[0];for(let s=1,o=e.length;s<o;s++){const a=e[s];r.left+r.width+.9>=a.left?r.width=Math.max(r.width,a.left+a.width-r.left):(t[i++]=r,r=a)}return t[i++]=r,t}static _createHorizontalRangesFromClientRects(e,t){if(!e||e.length===0)return null;const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i[r]=new Am(Math.max(0,o.left-t),o.width)}return this._mergeAdjacentRanges(i)}static readHorizontalRanges(e,t,i,r,s,o,a){const c=e.children.length-1;if(0>c)return null;if(t=Math.min(c,Math.max(0,t)),r=Math.min(c,Math.max(0,r)),t===r&&i===s&&i===0&&!e.children[t].firstChild){const f=e.children[t].getClientRects();return this._createHorizontalRangesFromClientRects(f,o)}t!==r&&r>0&&s===0&&(r--,s=1073741824);let h=e.children[t].firstChild,u=e.children[r].firstChild;if((!h||!u)&&(!h&&i===0&&t>0&&(h=e.children[t-1].firstChild,i=1073741824),!u&&s===0&&r>0&&(u=e.children[r-1].firstChild,s=1073741824)),!h||!u)return null;i=Math.min(h.textContent.length,Math.max(0,i)),s=Math.min(u.textContent.length,Math.max(0,s));const d=this._readClientRects(h,i,u,s,a);return this._createHorizontalRangesFromClientRects(d,o)}}const WTe=function(){return ym?!0:!(zr||$r||Yo)}();let Nm=!0;class i${constructor(e,t){this._domNode=e,this._clientRectDeltaLeft=0,this._clientRectDeltaLeftRead=!1,this.endNode=t}get clientRectDeltaLeft(){return this._clientRectDeltaLeftRead||(this._clientRectDeltaLeftRead=!0,this._clientRectDeltaLeft=this._domNode.getBoundingClientRect().left),this._clientRectDeltaLeft}}class n${constructor(e,t){this.themeType=t;const i=e.options,r=i.get(43);this.renderWhitespace=i.get(87),this.renderControlCharacters=i.get(82),this.spaceWidth=r.spaceWidth,this.middotWidth=r.middotWidth,this.wsmiddotWidth=r.wsmiddotWidth,this.useMonospaceOptimizations=r.isMonospace&&!i.get(29),this.canUseHalfwidthRightwardsArrow=r.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(58),this.stopRenderingLineAfter=i.get(104),this.fontLigatures=i.get(44)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class Ol{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=xt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return this._options.themeType===Oa.HIGH_CONTRAST||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,r){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const s=i.getViewLineRenderingData(e),o=this._options,a=Ns.filter(s.inlineDecorations,e,s.minColumn,s.maxColumn);let l=null;if(o.themeType===Oa.HIGH_CONTRAST||this._options.renderWhitespace==="selection"){const d=i.selections;for(const f of d){if(f.endLineNumber<e||f.startLineNumber>e)continue;const g=f.startLineNumber===e?f.startColumn:s.minColumn,p=f.endLineNumber===e?f.endColumn:s.maxColumn;g<p&&(o.themeType===Oa.HIGH_CONTRAST||this._options.renderWhitespace!=="selection"?a.push(new Ns(g,p,"inline-selected-text",0)):(l||(l=[]),l.push(new fIe(g-1,p-1))))}}const c=new $g(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,s.content,s.continuesWithWrappedLine,s.isBasicASCII,s.containsRTL,s.minColumn-1,s.tokens,a,s.tabSize,s.startVisibleColumn,o.spaceWidth,o.middotWidth,o.wsmiddotWidth,o.stopRenderingLineAfter,o.renderWhitespace,o.renderControlCharacters,o.fontLigatures!==Cs.OFF,l);if(this._renderedViewLine&&this._renderedViewLine.input.equals(c))return!1;r.appendASCIIString('<div style="top:'),r.appendASCIIString(String(t)),r.appendASCIIString("px;height:"),r.appendASCIIString(String(this._options.lineHeight)),r.appendASCIIString('px;" class="'),r.appendASCIIString(Ol.CLASS_NAME),r.appendASCIIString('">');const h=sL(c,r);r.appendASCIIString("</div>");let u=null;return Nm&&WTe&&s.isBasicASCII&&o.useMonospaceOptimizations&&h.containsForeignElements===0&&s.content.length<300&&c.lineTokens.getCount()<100&&(u=new vC(this._renderedViewLine?this._renderedViewLine.domNode:null,c,h.characterMapping)),u||(u=iee(this._renderedViewLine?this._renderedViewLine.domNode:null,c,h.characterMapping,h.containsRTL,h.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(){return this._renderedViewLine?this._renderedViewLine.getWidth():0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof vC:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof vC?this._renderedViewLine.monospaceAssumptionsAreValid():Nm}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof vC&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,r){if(!this._renderedViewLine)return null;t=t|0,i=i|0,t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const s=this._renderedViewLine.input.stopRenderingLineAfter|0;let o=!1;s!==-1&&t>s+1&&i>s+1&&(o=!0),s!==-1&&t>s+1&&(t=s+1),s!==-1&&i>s+1&&(i=s+1);const a=this._renderedViewLine.getVisibleRangesForRange(e,t,i,r);return a&&a.length>0?new VTe(o,a):null}getColumnOfNodeOffset(e,t,i){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t,i):1}}Ol.CLASS_NAME="view-line";class vC{constructor(e,t,i){this.domNode=e,this.input=t,this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(){return Math.round(this._getCharPosition(this._characterMapping.length))}getWidthIsFast(){return!0}monospaceAssumptionsAreValid(){if(!this.domNode)return Nm;const e=this.getWidth(),t=this.domNode.domNode.firstChild.offsetWidth;return Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Nm=!1),Nm}toSlowRenderedLine(){return iee(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,r){const s=this._getCharPosition(t),o=this._getCharPosition(i);return[new Am(s,o-s)]}_getCharPosition(e){const t=this._characterMapping.getAbsoluteOffset(e);return this._charWidth*t}getColumnOfNodeOffset(e,t,i){const r=t.textContent.length;let s=-1;for(;t;)t=t.previousSibling,s++;return this._characterMapping.getColumn(new e5(s,i),r)}}class tee{constructor(e,t,i,r,s){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=s,this._cachedWidth=-1,this._pixelOffsetCache=null,!r||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let o=0,a=this._characterMapping.length;o<=a;o++)this._pixelOffsetCache[o]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,r){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const s=this._readPixelOffset(this.domNode,e,t,r);if(s===-1)return null;const o=this._readPixelOffset(this.domNode,e,i,r);return o===-1?null:[new Am(s,o-s)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,r)}_readVisibleRangesForRange(e,t,i,r,s){if(i===r){const o=this._readPixelOffset(e,t,i,s);return o===-1?null:[new Am(o,0)]}else return this._readRawVisibleRangesForRange(e,i,r,s)}_readPixelOffset(e,t,i,r){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth();const s=this._getReadingTarget(e);return s.firstChild?s.firstChild.offsetWidth:0}if(this._pixelOffsetCache!==null){const s=this._pixelOffsetCache[i];if(s!==-1)return s;const o=this._actualReadPixelOffset(e,t,i,r);return this._pixelOffsetCache[i]=o,o}return this._actualReadPixelOffset(e,t,i,r)}_actualReadPixelOffset(e,t,i,r){if(this._characterMapping.length===0){const l=DT.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,r.clientRectDeltaLeft,r.endNode);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth();const s=this._characterMapping.getDomPosition(i),o=DT.readHorizontalRanges(this._getReadingTarget(e),s.partIndex,s.charIndex,s.partIndex,s.charIndex,r.clientRectDeltaLeft,r.endNode);if(!o||o.length===0)return-1;const a=o[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getAbsoluteOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,r){if(t===1&&i===this._characterMapping.length)return[new Am(0,this.getWidth())];const s=this._characterMapping.getDomPosition(t),o=this._characterMapping.getDomPosition(i);return DT.readHorizontalRanges(this._getReadingTarget(e),s.partIndex,s.charIndex,o.partIndex,o.charIndex,r.clientRectDeltaLeft,r.endNode)}getColumnOfNodeOffset(e,t,i){const r=t.textContent.length;let s=-1;for(;t;)t=t.previousSibling,s++;return this._characterMapping.getColumn(new e5(s,i),r)}}class $Te extends tee{_readVisibleRangesForRange(e,t,i,r,s){const o=super._readVisibleRangesForRange(e,t,i,r,s);if(!o||o.length===0||i===r||i===1&&r===this._characterMapping.length)return o;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,r,s);if(a!==-1){const l=o[o.length-1];l.left<a&&(l.width=a-l.left)}}return o}}const iee=function(){return Df?zTe:HTe}();function zTe(n,e,t,i,r){return new $Te(n,e,t,i,r)}function HTe(n,e,t,i,r){return new tee(n,e,t,i,r)}function wC(n){return n.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Rn{constructor(e,t,i,r){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=r}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${wC(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${wC(this.oldText)}")`:`(replace@${this.oldPosition} "${wC(this.oldText)}" with "${wC(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const r=t.length;_a(e,r,i),i+=4;for(let s=0;s<r;s++)Zke(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=ma(e,t);return t+=4,qM(e,t,i)}writeSize(){return 4+4+Rn._writeStringSize(this.oldText)+Rn._writeStringSize(this.newText)}write(e,t){return _a(e,this.oldPosition,t),t+=4,_a(e,this.newPosition,t),t+=4,t=Rn._writeString(e,this.oldText,t),t=Rn._writeString(e,this.newText,t),t}static read(e,t,i){const r=ma(e,t);t+=4;const s=ma(e,t);t+=4;const o=Rn._readString(e,t);t+=Rn._writeStringSize(o);const a=Rn._readString(e,t);return t+=Rn._writeStringSize(a),i.push(new Rn(r,o,s,a)),t}}function UTe(n,e){return n===null||n.length===0?e:new Sl(n,e).compress()}class Sl{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),r=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(r),r=this._getCurr(++t);continue}if(r===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(r.oldEnd<=i.newPosition){this._acceptCurr(r),r=this._getCurr(++t);continue}if(i.newEnd<=r.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(r.oldPosition<i.newPosition){const[c,h]=Sl._splitCurr(r,i.newPosition-r.oldPosition);this._acceptCurr(c),r=h;continue}if(i.newPosition<r.oldPosition){const[c,h]=Sl._splitPrev(i,r.oldPosition-i.newPosition);this._acceptPrev(c),i=h;continue}let a,l;if(r.oldEnd===i.newEnd)a=i,l=r,i=this._getPrev(++e),r=this._getCurr(++t);else if(r.oldEnd<i.newEnd){const[c,h]=Sl._splitPrev(i,r.oldLength);a=c,l=r,i=h,r=this._getCurr(++t)}else{const[c,h]=Sl._splitCurr(r,i.newLength);a=i,l=c,i=this._getPrev(++e),r=h}this._result[this._resultLen++]=new Rn(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const s=Sl._merge(this._result);return Sl._removeNoOps(s)}_acceptCurr(e){this._result[this._resultLen++]=Sl._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=Sl._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new Rn(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new Rn(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),r=e.newText.substr(t);return[new Rn(e.oldPosition,e.oldText,e.newPosition,i),new Rn(e.oldEnd,"",e.newPosition+t,r)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),r=e.oldText.substr(t);return[new Rn(e.oldPosition,i,e.newPosition,e.newText),new Rn(e.oldPosition+t,r,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;let t=[],i=0,r=e[0];for(let s=1;s<e.length;s++){const o=e[s];r.oldEnd===o.oldPosition?r=new Rn(r.oldPosition,r.oldText+o.oldText,r.newPosition,r.newText+o.newText):(t[i++]=r,r=o)}return t[i++]=r,t}static _removeNoOps(e){if(e.length===0)return e;let t=[],i=0;for(let r=0;r<e.length;r++){const s=e[r];s.oldText!==s.newText&&(t[i++]=s)}return t}}function xp(n){return n.toString()}class mn{constructor(e,t,i,r,s,o,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=r,this.beforeCursorState=s,this.afterCursorState=o,this.changes=a}static create(e,t){const i=e.getAlternativeVersionId(),r=cF(e);return new mn(i,i,r,r,t,t,[])}append(e,t,i,r,s){t.length>0&&(this.changes=UTe(this.changes,t)),this.afterEOL=i,this.afterVersionId=r,this.afterCursorState=s}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(_a(e,t?t.length:0,i),i+=4,t)for(const r of t)_a(e,r.selectionStartLineNumber,i),i+=4,_a(e,r.selectionStartColumn,i),i+=4,_a(e,r.positionLineNumber,i),i+=4,_a(e,r.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const r=ma(e,t);t+=4;for(let s=0;s<r;s++){const o=ma(e,t);t+=4;const a=ma(e,t);t+=4;const l=ma(e,t);t+=4;const c=ma(e,t);t+=4,i.push(new je(o,a,l,c))}return t}serialize(){let e=10+mn._writeSelectionsSize(this.beforeCursorState)+mn._writeSelectionsSize(this.afterCursorState)+4;for(const r of this.changes)e+=r.writeSize();const t=new Uint8Array(e);let i=0;_a(t,this.beforeVersionId,i),i+=4,_a(t,this.afterVersionId,i),i+=4,iW(t,this.beforeEOL,i),i+=1,iW(t,this.afterEOL,i),i+=1,i=mn._writeSelections(t,this.beforeCursorState,i),i=mn._writeSelections(t,this.afterCursorState,i),_a(t,this.changes.length,i),i+=4;for(const r of this.changes)i=r.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const r=ma(t,i);i+=4;const s=ma(t,i);i+=4;const o=tW(t,i);i+=1;const a=tW(t,i);i+=1;const l=[];i=mn._readSelections(t,i,l);const c=[];i=mn._readSelections(t,i,c);const h=ma(t,i);i+=4;const u=[];for(let d=0;d<h;d++)i=Rn.read(t,i,u);return new mn(r,s,o,a,l,c,u)}}class nee{constructor(e,t){this.model=e,this._data=mn.create(e,t)}get type(){return 0}get resource(){return qe.isUri(this.model)?this.model:this.model.uri}get label(){return v("edit","Typing")}toString(){return(this._data instanceof mn?this._data:mn.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(qe.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof mn}append(e,t,i,r,s){this._data instanceof mn&&this._data.append(e,t,i,r,s)}close(){this._data instanceof mn&&(this._data=this._data.serialize())}open(){this._data instanceof mn||(this._data=mn.deserialize(this._data))}undo(){if(qe.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof mn&&(this._data=this._data.serialize());const e=mn.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(qe.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof mn&&(this._data=this._data.serialize());const e=mn.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof mn&&(this._data=this._data.serialize()),this._data.byteLength+168}}class jTe{constructor(e,t){this.type=1,this.label=e,this._isOpen=!0,this._editStackElementsArr=t.slice(0),this._editStackElementsMap=new Map;for(const i of this._editStackElementsArr){const r=xp(i.resource);this._editStackElementsMap.set(r,i)}this._delegate=null}get resources(){return this._editStackElementsArr.map(e=>e.resource)}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=xp(e);return this._editStackElementsMap.has(t)}setModel(e){const t=xp(qe.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=xp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,r,s){const o=xp(e.uri);this._editStackElementsMap.get(o).append(e,t,i,r,s)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=xp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){let e=[];for(const t of this._editStackElementsArr)e.push(`${qa(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function cF(n){return n.getEOL()===`
`?0:1}function Gc(n){return n?n instanceof nee||n instanceof jTe:!1}class _5{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Gc(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);Gc(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e){const t=this._undoRedoService.getLastElement(this._model.uri);if(Gc(t)&&t.canAppend(this._model))return t;const i=new nee(this._model,e);return this._undoRedoService.pushElement(i),i}pushEOL(e){const t=this._getOrCreateEditStackElement(null);this._model.setEOL(e),t.append(this._model,[],cF(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i){const r=this._getOrCreateEditStackElement(e),s=this._model.applyEdits(t,!0),o=_5._computeCursorState(i,s),a=s.map((l,c)=>({index:c,textChange:l.textChange}));return a.sort((l,c)=>l.textChange.oldPosition===c.textChange.oldPosition?l.index-c.index:l.textChange.oldPosition-c.textChange.oldPosition),r.append(this._model,a.map(l=>l.textChange),cF(this._model),this._model.getAlternativeVersionId(),o),o}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return it(i),null}}}class qTe{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function GTe(n,e,t,i,r){r.spacesDiff=0,r.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<i;s++){let d=n.charCodeAt(s),f=t.charCodeAt(s);if(d!==f)break}let o=0,a=0;for(let d=s;d<e;d++)n.charCodeAt(d)===32?o++:a++;let l=0,c=0;for(let d=s;d<i;d++)t.charCodeAt(d)===32?l++:c++;if(o>0&&a>0||l>0&&c>0)return;let h=Math.abs(a-c),u=Math.abs(o-l);if(h===0){r.spacesDiff=u,u>0&&0<=l-1&&l-1<n.length&&l<t.length&&t.charCodeAt(l)!==32&&n.charCodeAt(l-1)===32&&n.charCodeAt(n.length-1)===44&&(r.looksLikeAlignment=!0);return}if(u%h===0){r.spacesDiff=u/h;return}}function r$(n,e,t){const i=Math.min(n.getLineCount(),1e4);let r=0,s=0,o="",a=0;const l=[2,4,6,8,3,5,7],c=8;let h=[0,0,0,0,0,0,0,0,0],u=new qTe;for(let g=1;g<=i;g++){let p=n.getLineLength(g),m=n.getLineContent(g);const b=p<=65536;let _=!1,w=0,y=0,S=0;for(let C=0,D=p;C<D;C++){let E=b?m.charCodeAt(C):n.getLineCharCode(g,C);if(E===9)S++;else if(E===32)y++;else{_=!0,w=C;break}}if(!_||(S>0?r++:y>1&&s++,GTe(o,a,m,w,u),u.looksLikeAlignment&&!(t&&e===u.spacesDiff)))continue;let k=u.spacesDiff;k<=c&&h[k]++,o=m,a=w}let d=t;r!==s&&(d=r<s);let f=e;if(d){let g=d?0:.1*i;l.forEach(p=>{let m=h[p];m>g&&(g=m,f=p)}),f===4&&h[4]>0&&h[2]>0&&h[2]>=h[4]/2&&(f=2)}return{insertSpaces:d,tabSize:f}}function Ar(n){return(n.metadata&1)>>>0}function Ut(n,e){n.metadata=n.metadata&254|e<<0}function Fn(n){return(n.metadata&2)>>>1===1}function zt(n,e){n.metadata=n.metadata&253|(e?1:0)<<1}function ree(n){return(n.metadata&4)>>>2===1}function s$(n,e){n.metadata=n.metadata&251|(e?1:0)<<2}function KTe(n){return(n.metadata&24)>>>3}function o$(n,e){n.metadata=n.metadata&231|e<<3}function ZTe(n){return(n.metadata&32)>>>5===1}function a$(n,e){n.metadata=n.metadata&223|(e?1:0)<<5}class see{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,Ut(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,s$(this,!1),o$(this,1),a$(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,zt(this,!1)}reset(e,t,i,r){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=r}setOptions(e){this.options=e;let t=this.options.className;s$(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),o$(this,this.options.stickiness),a$(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Qe=new see(null,0,0);Qe.parent=Qe;Qe.left=Qe;Qe.right=Qe;Ut(Qe,0);class kT{constructor(){this.root=Qe,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,r,s){return this.root===Qe?[]:nAe(this,e,t,i,r,s)}search(e,t,i){return this.root===Qe?[]:iAe(this,e,t,i)}collectNodesFromOwner(e){return eAe(this,e)}collectNodesPostOrder(){return tAe(this)}insert(e){l$(this,e),this._normalizeDeltaIfNecessary()}delete(e){c$(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let r=0;for(;e!==this.root;)e===e.parent.right&&(r+=e.parent.delta),e=e.parent;const s=i.start+r,o=i.end+r;i.setCachedOffsets(s,o,t)}acceptReplace(e,t,i,r){const s=QTe(this,e,e+t);for(let o=0,a=s.length;o<a;o++){const l=s[o];c$(this,l)}this._normalizeDeltaIfNecessary(),JTe(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let o=0,a=s.length;o<a;o++){const l=s[o];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,XTe(l,e,e+t,i,r),l.maxEnd=l.end,l$(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,YTe(this))}}function YTe(n){let e=n.root,t=0;for(;e!==Qe;){if(e.left!==Qe&&!Fn(e.left)){e=e.left;continue}if(e.right!==Qe&&!Fn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Zu(e),zt(e,!0),zt(e.left,!1),zt(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}zt(n.root,!1)}function Ep(n,e,t,i){return n<t?!0:n>t||i===1?!1:i===2?!0:e}function XTe(n,e,t,i,r){const s=KTe(n),o=s===0||s===2,a=s===1||s===2,l=t-e,c=i,h=Math.min(l,c),u=n.start;let d=!1;const f=n.end;let g=!1;e<=u&&f<=t&&ZTe(n)&&(n.start=e,d=!0,n.end=e,g=!0);{const m=r?1:l>0?2:0;!d&&Ep(u,o,e,m)&&(d=!0),!g&&Ep(f,a,e,m)&&(g=!0)}if(h>0&&!r){const m=l>c?2:0;!d&&Ep(u,o,e+h,m)&&(d=!0),!g&&Ep(f,a,e+h,m)&&(g=!0)}{const m=r?1:0;!d&&Ep(u,o,t,m)&&(n.start=e+c,d=!0),!g&&Ep(f,a,t,m)&&(n.end=e+c,g=!0)}const p=c-l;d||(n.start=Math.max(0,u+p)),g||(n.end=Math.max(0,f+p)),n.start>n.end&&(n.end=n.start)}function QTe(n,e,t){let i=n.root,r=0,s=0,o=0,a=0,l=[],c=0;for(;i!==Qe;){if(Fn(i)){zt(i.left,!1),zt(i.right,!1),i===i.parent.right&&(r-=i.parent.delta),i=i.parent;continue}if(!Fn(i.left)){if(s=r+i.maxEnd,s<e){zt(i,!0);continue}if(i.left!==Qe){i=i.left;continue}}if(o=r+i.start,o>t){zt(i,!0);continue}if(a=r+i.end,a>=e&&(i.setCachedOffsets(o,a,0),l[c++]=i),zt(i,!0),i.right!==Qe&&!Fn(i.right)){r+=i.delta,i=i.right;continue}}return zt(n.root,!1),l}function JTe(n,e,t,i){let r=n.root,s=0,o=0,a=0;const l=i-(t-e);for(;r!==Qe;){if(Fn(r)){zt(r.left,!1),zt(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),Zu(r),r=r.parent;continue}if(!Fn(r.left)){if(o=s+r.maxEnd,o<e){zt(r,!0);continue}if(r.left!==Qe){r=r.left;continue}}if(a=s+r.start,a>t){r.start+=l,r.end+=l,r.delta+=l,(r.delta<-1073741824||r.delta>1073741824)&&(n.requestNormalizeDelta=!0),zt(r,!0);continue}if(zt(r,!0),r.right!==Qe&&!Fn(r.right)){s+=r.delta,r=r.right;continue}}zt(n.root,!1)}function eAe(n,e){let t=n.root,i=[],r=0;for(;t!==Qe;){if(Fn(t)){zt(t.left,!1),zt(t.right,!1),t=t.parent;continue}if(t.left!==Qe&&!Fn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[r++]=t),zt(t,!0),t.right!==Qe&&!Fn(t.right)){t=t.right;continue}}return zt(n.root,!1),i}function tAe(n){let e=n.root,t=[],i=0;for(;e!==Qe;){if(Fn(e)){zt(e.left,!1),zt(e.right,!1),e=e.parent;continue}if(e.left!==Qe&&!Fn(e.left)){e=e.left;continue}if(e.right!==Qe&&!Fn(e.right)){e=e.right;continue}t[i++]=e,zt(e,!0)}return zt(n.root,!1),t}function iAe(n,e,t,i){let r=n.root,s=0,o=0,a=0,l=[],c=0;for(;r!==Qe;){if(Fn(r)){zt(r.left,!1),zt(r.right,!1),r===r.parent.right&&(s-=r.parent.delta),r=r.parent;continue}if(r.left!==Qe&&!Fn(r.left)){r=r.left;continue}o=s+r.start,a=s+r.end,r.setCachedOffsets(o,a,i);let h=!0;if(e&&r.ownerId&&r.ownerId!==e&&(h=!1),t&&ree(r)&&(h=!1),h&&(l[c++]=r),zt(r,!0),r.right!==Qe&&!Fn(r.right)){s+=r.delta,r=r.right;continue}}return zt(n.root,!1),l}function nAe(n,e,t,i,r,s){let o=n.root,a=0,l=0,c=0,h=0,u=[],d=0;for(;o!==Qe;){if(Fn(o)){zt(o.left,!1),zt(o.right,!1),o===o.parent.right&&(a-=o.parent.delta),o=o.parent;continue}if(!Fn(o.left)){if(l=a+o.maxEnd,l<e){zt(o,!0);continue}if(o.left!==Qe){o=o.left;continue}}if(c=a+o.start,c>t){zt(o,!0);continue}if(h=a+o.end,h>=e){o.setCachedOffsets(c,h,s);let f=!0;i&&o.ownerId&&o.ownerId!==i&&(f=!1),r&&ree(o)&&(f=!1),f&&(u[d++]=o)}if(zt(o,!0),o.right!==Qe&&!Fn(o.right)){a+=o.delta,o=o.right;continue}}return zt(n.root,!1),u}function l$(n,e){if(n.root===Qe)return e.parent=Qe,e.left=Qe,e.right=Qe,Ut(e,0),n.root=e,n.root;rAe(n,e),Zh(e.parent);let t=e;for(;t!==n.root&&Ar(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;Ar(i)===1?(Ut(t.parent,0),Ut(i,0),Ut(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,ov(n,t)),Ut(t.parent,0),Ut(t.parent.parent,1),av(n,t.parent.parent))}else{const i=t.parent.parent.left;Ar(i)===1?(Ut(t.parent,0),Ut(i,0),Ut(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,av(n,t)),Ut(t.parent,0),Ut(t.parent.parent,1),ov(n,t.parent.parent))}return Ut(n.root,0),e}function rAe(n,e){let t=0,i=n.root;const r=e.start,s=e.end;for(;;)if(oAe(r,s,i.start+t,i.end+t)<0)if(i.left===Qe){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Qe){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Qe,e.right=Qe,Ut(e,1)}function c$(n,e){let t,i;if(e.left===Qe?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Qe?(t=e.left,i=e):(i=sAe(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(n.requestNormalizeDelta=!0)),i===n.root){n.root=t,Ut(t,0),e.detach(),LT(),Zu(t),n.root.parent=Qe;return}let r=Ar(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,Ut(i,Ar(e)),e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Qe&&(i.left.parent=i),i.right!==Qe&&(i.right.parent=i)),e.detach(),r){Zh(t.parent),i!==e&&(Zh(i),Zh(i.parent)),LT();return}Zh(t),Zh(t.parent),i!==e&&(Zh(i),Zh(i.parent));let s;for(;t!==n.root&&Ar(t)===0;)t===t.parent.left?(s=t.parent.right,Ar(s)===1&&(Ut(s,0),Ut(t.parent,1),ov(n,t.parent),s=t.parent.right),Ar(s.left)===0&&Ar(s.right)===0?(Ut(s,1),t=t.parent):(Ar(s.right)===0&&(Ut(s.left,0),Ut(s,1),av(n,s),s=t.parent.right),Ut(s,Ar(t.parent)),Ut(t.parent,0),Ut(s.right,0),ov(n,t.parent),t=n.root)):(s=t.parent.left,Ar(s)===1&&(Ut(s,0),Ut(t.parent,1),av(n,t.parent),s=t.parent.left),Ar(s.left)===0&&Ar(s.right)===0?(Ut(s,1),t=t.parent):(Ar(s.left)===0&&(Ut(s.right,0),Ut(s,1),ov(n,s),s=t.parent.left),Ut(s,Ar(t.parent)),Ut(t.parent,0),Ut(s.left,0),av(n,t.parent),t=n.root));Ut(t,0),LT()}function sAe(n){for(;n.left!==Qe;)n=n.left;return n}function LT(){Qe.parent=Qe,Qe.delta=0,Qe.start=0,Qe.end=0}function ov(n,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(n.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Qe&&(t.left.parent=e),t.parent=e.parent,e.parent===Qe?n.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Zu(e),Zu(t)}function av(n,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(n.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Qe&&(t.right.parent=e),t.parent=e.parent,e.parent===Qe?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Zu(e),Zu(t)}function oee(n){let e=n.end;if(n.left!==Qe){const t=n.left.maxEnd;t>e&&(e=t)}if(n.right!==Qe){const t=n.right.maxEnd+n.delta;t>e&&(e=t)}return e}function Zu(n){n.maxEnd=oee(n)}function Zh(n){for(;n!==Qe;){const e=oee(n);if(n.maxEnd===e)return;n.maxEnd=e,n=n.parent}}function oAe(n,e,t,i){return n===t?e-i:n-t}class hF{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==$e)return b5(this.right);let e=this;for(;e.parent!==$e&&e.parent.left!==e;)e=e.parent;return e.parent===$e?$e:e.parent}prev(){if(this.left!==$e)return aee(this.left);let e=this;for(;e.parent!==$e&&e.parent.right!==e;)e=e.parent;return e.parent===$e?$e:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const $e=new hF(null,0);$e.parent=$e;$e.left=$e;$e.right=$e;$e.color=0;function b5(n){for(;n.left!==$e;)n=n.left;return n}function aee(n){for(;n.right!==$e;)n=n.right;return n}function v5(n){return n===$e?0:n.size_left+n.piece.length+v5(n.right)}function w5(n){return n===$e?0:n.lf_left+n.piece.lineFeedCnt+w5(n.right)}function IT(){$e.parent=$e}function lv(n,e){let t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==$e&&(t.left.parent=e),t.parent=e.parent,e.parent===$e?n.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function cv(n,e){let t=e.left;e.left=t.right,t.right!==$e&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===$e?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function yC(n,e){let t,i;if(e.left===$e?(i=e,t=i.right):e.right===$e?(i=e,t=i.left):(i=b5(e.right),t=i.right),i===n.root){n.root=t,t.color=0,e.detach(),IT(),n.root.parent=$e;return}let r=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,Cb(n,t)):(i.parent===e?t.parent=i:t.parent=i.parent,Cb(n,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==$e&&(i.left.parent=i),i.right!==$e&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,Cb(n,i)),e.detach(),t.parent.left===t){let o=v5(t),a=w5(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){let l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,Fc(n,t.parent,l,c)}}if(Cb(n,t.parent),r){IT();return}let s;for(;t!==n.root&&t.color===0;)t===t.parent.left?(s=t.parent.right,s.color===1&&(s.color=0,t.parent.color=1,lv(n,t.parent),s=t.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.right.color===0&&(s.left.color=0,s.color=1,cv(n,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=0,s.right.color=0,lv(n,t.parent),t=n.root)):(s=t.parent.left,s.color===1&&(s.color=0,t.parent.color=1,cv(n,t.parent),s=t.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.left.color===0&&(s.right.color=0,s.color=1,lv(n,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=0,s.left.color=0,cv(n,t.parent),t=n.root));t.color=0,IT()}function h$(n,e){for(Cb(n,e);e!==n.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,lv(n,e)),e.parent.color=0,e.parent.parent.color=1,cv(n,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,cv(n,e)),e.parent.color=0,e.parent.parent.color=1,lv(n,e.parent.parent))}n.root.color=0}function Fc(n,e,t,i){for(;e!==n.root&&e!==$e;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function Cb(n,e){let t=0,i=0;if(e!==n.root){for(;e!==n.root&&e===e.parent.right;)e=e.parent;if(e!==n.root)for(e=e.parent,t=v5(e.left)-e.size_left,i=w5(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==n.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}class aAe extends v0{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function lAe(n){let e={};return t=>(e.hasOwnProperty(t)||(e[t]=n(t)),e[t])}const k_=lAe(n=>new aAe(n)),cAe=999;class Fd{constructor(e,t,i,r){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=r}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=hAe(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=RQ(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new uAe(t,this.wordSeparators?k_(this.wordSeparators):null,i?this.searchString:null)}}function hAe(n){if(!n||n.length===0)return!1;for(let e=0,t=n.length;e<t;e++)if(n.charCodeAt(e)===92){if(e++,e>=t)break;const r=n.charCodeAt(e);if(r===110||r===114||r===87)return!0}return!1}class uAe{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}function Wd(n,e,t){if(!t)return new _w(n,null);let i=[];for(let r=0,s=e.length;r<s;r++)i[r]=e[r];return new _w(n,i)}class u${constructor(e){let t=[],i=0;for(let r=0,s=e.length;r<s;r++)e.charCodeAt(r)===10&&(t[i++]=r);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,r=t.length-1;if(r===-1||e<=t[0])return 0;for(;i<r;){const s=i+((r-i)/2>>0);t[s]>=e?r=s-1:t[s+1]>=e?(i=s,r=s):i=s+1}return i+1}}class CC{static findMatches(e,t,i,r,s){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,i,new Sb(o.wordSeparators,o.regex),r,s):this._doFindMatchesLineByLine(e,i,o,r,s):[]}static _getMultilineMatchRange(e,t,i,r,s,o){let a,l=0;r?(l=r.findLineFeedCountBeforeOffset(s),a=t+s+l):a=t+s;let c;if(r){let f=r.findLineFeedCountBeforeOffset(s+o.length)-l;c=a+o.length+f}else c=a+o.length;const h=e.getPositionAt(a),u=e.getPositionAt(c);return new V(h.lineNumber,h.column,u.lineNumber,u.column)}static _doFindMatchesMultiline(e,t,i,r,s){const o=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new u$(a):null,c=[];let h=0,u;for(i.reset(0);u=i.next(a);)if(c[h++]=Wd(this._getMultilineMatchRange(e,o,a,l,u.index,u[0]),u,r),h>=s)return c;return c}static _doFindMatchesLineByLine(e,t,i,r,s){const o=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,o,r,s),o}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,o,r,s);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<s;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,o,r,s);if(a<s){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,o,r,s)}return o}static _findMatchesInLine(e,t,i,r,s,o,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const d=e.simpleSearch,f=d.length,g=t.length;let p=-f;for(;(p=t.indexOf(d,p+f))!==-1;)if((!c||y5(c,t,g,p,f))&&(o[s++]=new _w(new V(i,p+1+r,i,p+1+f+r),null),s>=l))return s;return s}const h=new Sb(e.wordSeparators,e.regex);let u;h.reset(0);do if(u=h.next(t),u&&(o[s++]=Wd(new V(i,u.index+1+r,i,u.index+1+u[0].length+r),u,a),s>=l))return s;while(u);return s}static findNextMatch(e,t,i,r){const s=t.parseSearchRequest();if(!s)return null;const o=new Sb(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindNextMatchMultiline(e,i,o,r):this._doFindNextMatchLineByLine(e,i,o,r)}static _doFindNextMatchMultiline(e,t,i,r){const s=new G(t.lineNumber,1),o=e.getOffsetAt(s),a=e.getLineCount(),l=e.getValueInRange(new V(s.lineNumber,s.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new u$(l):null;i.reset(t.column-1);let h=i.next(l);return h?Wd(this._getMultilineMatchRange(e,o,l,c,h.index,h[0]),h,r):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new G(1,1),i,r):null}static _doFindNextMatchLineByLine(e,t,i,r){const s=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o),l=this._findFirstMatchInLine(i,a,o,t.column,r);if(l)return l;for(let c=1;c<=s;c++){const h=(o+c-1)%s,u=e.getLineContent(h+1),d=this._findFirstMatchInLine(i,u,h+1,1,r);if(d)return d}return null}static _findFirstMatchInLine(e,t,i,r,s){e.reset(r-1);const o=e.next(t);return o?Wd(new V(i,o.index+1,i,o.index+1+o[0].length),o,s):null}static findPreviousMatch(e,t,i,r){const s=t.parseSearchRequest();if(!s)return null;const o=new Sb(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindPreviousMatchMultiline(e,i,o,r):this._doFindPreviousMatchLineByLine(e,i,o,r)}static _doFindPreviousMatchMultiline(e,t,i,r){const s=this._doFindMatchesMultiline(e,new V(1,1,t.lineNumber,t.column),i,r,10*cAe);if(s.length>0)return s[s.length-1];const o=e.getLineCount();return t.lineNumber!==o||t.column!==e.getLineMaxColumn(o)?this._doFindPreviousMatchMultiline(e,new G(o,e.getLineMaxColumn(o)),i,r):null}static _doFindPreviousMatchLineByLine(e,t,i,r){const s=e.getLineCount(),o=t.lineNumber,a=e.getLineContent(o).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,o,r);if(l)return l;for(let c=1;c<=s;c++){const h=(s+o-c-1)%s,u=e.getLineContent(h+1),d=this._findLastMatchInLine(i,u,h+1,r);if(d)return d}return null}static _findLastMatchInLine(e,t,i,r){let s=null,o;for(e.reset(0);o=e.next(t);)s=Wd(new V(i,o.index+1,i,o.index+1+o[0].length),o,r);return s}}function dAe(n,e,t,i,r){if(i===0)return!0;const s=e.charCodeAt(i-1);if(n.get(s)!==0||s===13||s===10)return!0;if(r>0){const o=e.charCodeAt(i);if(n.get(o)!==0)return!0}return!1}function fAe(n,e,t,i,r){if(i+r===t)return!0;const s=e.charCodeAt(i+r);if(n.get(s)!==0||s===13||s===10)return!0;if(r>0){const o=e.charCodeAt(i+r-1);if(n.get(o)!==0)return!0}return!1}function y5(n,e,t,i,r){return dAe(n,e,t,i,r)&&fAe(n,e,t,i,r)}class Sb{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const r=i.index,s=i[0].length;if(r===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){jc(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=r,this._prevMatchLength=s,!this._wordSeparators||y5(this._wordSeparators,e,t,r,s))return i}while(i);return null}}const kc=65535;function lee(n){let e;return n[n.length-1]<65536?e=new Uint16Array(n.length):e=new Uint32Array(n.length),e.set(n,0),e}class gAe{constructor(e,t,i,r,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=r,this.isBasicASCII=s}}function Oc(n,e=!0){let t=[0],i=1;for(let r=0,s=n.length;r<s;r++){const o=n.charCodeAt(r);o===13?r+1<s&&n.charCodeAt(r+1)===10?(t[i++]=r+2,r++):t[i++]=r+1:o===10&&(t[i++]=r+1)}return e?lee(t):t}function pAe(n,e){n.length=0,n[0]=0;let t=1,i=0,r=0,s=0,o=!0;for(let l=0,c=e.length;l<c;l++){const h=e.charCodeAt(l);h===13?l+1<c&&e.charCodeAt(l+1)===10?(s++,n[t++]=l+2,l++):(i++,n[t++]=l+1):h===10?(r++,n[t++]=l+1):o&&h!==9&&(h<32||h>126)&&(o=!1)}const a=new gAe(lee(n),i,r,s,o);return n.length=0,a}class es{constructor(e,t,i,r,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=r,this.length=s}}class $d{constructor(e,t){this.buffer=e,this.lineStarts=t}}class mAe{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==$e&&e.iterate(e.root,i=>(i!==$e&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class _Ae{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,i=this._cache;for(let r=0;r<i.length;r++){let s=i[r];if(s.node.parent===null||s.nodeStartOffset>=e){i[r]=null,t=!0;continue}}if(t){let r=[];for(const s of i)s!==null&&r.push(s);this._cache=r}}}class bAe{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new $d("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=$e,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let r=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=Oc(e[s].buffer));let a=new es(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),r=this.rbInsertRight(r,a)}this._searchCache=new _Ae(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=kc,i=t-Math.floor(t/3),r=i*2,s="",o=0,a=[];if(this.iterate(this.root,l=>{let c=this.getNodeContent(l),h=c.length;if(o<=i||o+h<r)return s+=c,o+=h,!0;let u=s.replace(/\r\n|\r|\n/g,e);return a.push(new $d(u,Oc(u))),s=c,o=h,!0}),o>0){let l=s.replace(/\r\n|\r|\n/g,e);a.push(new $d(l,Oc(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new mAe(this,e)}getOffsetAt(e,t){let i=0,r=this.root;for(;r!==$e;)if(r.left!==$e&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){i+=r.size_left;let s=this.getAccumulatedValue(r,e-r.lf_left-2);return i+=s+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,i+=r.size_left+r.piece.length,r=r.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0,r=e;for(;t!==$e;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){let s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){let o=this.getOffsetAt(i+1,1),a=r-o;return new G(i+1,a+1)}return new G(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===$e){let s=this.getOffsetAt(i+1,1),o=r-e-s;return new G(i+1,o+1)}else t=t.right;return new G(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let i=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,r);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){let a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node,r=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start),o=r.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==$e;){let a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){let e=[],t=0,i="",r=!1;return this.iterate(this.root,s=>{if(s===$e)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,h=o.start.line,u=o.end.line;let d=c[h]+o.start.column;if(r&&(l.charCodeAt(d)===10&&(d++,a--),e[t++]=i,i="",r=!1,a===0))return!0;if(h===u)return!this._EOLNormalized&&l.charCodeAt(d+a-1)===13?(r=!0,i+=l.substr(d,a-1)):i+=l.substr(d,a),!0;i+=this._EOLNormalized?l.substring(d,Math.max(d,c[h+1]-this._EOLLength)):l.substring(d,c[h+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=h+1;f<u;f++)i=this._EOLNormalized?l.substring(c[f],c[f+1]-this._EOLLength):l.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[u]+o.end.column-1)===13?(r=!0,o.end.column===0?t--:i=l.substr(c[u],o.end.column-1)):i=l.substr(c[u],o.end.column),!0}),r&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let i=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(r)}else{let t=this._buffers[e.node.piece.bufferIndex],r=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){let i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,r,s,o,a,l,c,h,u){let d=this._buffers[e.piece.bufferIndex],f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,s),p=this.offsetInBuffer(e.piece.bufferIndex,o),m,b={line:0,column:0},_,w;t._wordSeparators?(_=d.buffer.substring(g,p),w=y=>y+g,t.reset(0)):(_=d.buffer,w=y=>y,t.reset(g));do if(m=t.next(_),m){if(w(m.index)>=p)return h;this.positionInBuffer(e,w(m.index)-f,b);let y=this.getLineFeedCnt(e.piece.bufferIndex,s,b),S=b.line===s.line?b.column-s.column+r:b.column+1,k=S+m[0].length;if(u[h++]=Wd(new V(i+y,S,i+y,k),m,l),w(m.index)+m[0].length>=p||h>=c)return h}while(m);return h}findMatchesLineByLine(e,t,i,r){const s=[];let o=0;const a=new Sb(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];let c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let h=this.positionInBuffer(l.node,l.remainder),u=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,h,u,t,i,r,o,s),s;let d=e.startLineNumber,f=l.node;for(;f!==c.node;){let p=this.getLineFeedCnt(f.piece.bufferIndex,h,f.piece.end);if(p>=1){let b=this._buffers[f.piece.bufferIndex].lineStarts,_=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start),w=b[h.line+p],y=d===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(f,a,d,y,h,this.positionInBuffer(f,w-_),t,i,r,o,s),o>=r)return s;d+=p}let m=d===e.startLineNumber?e.startColumn-1:0;if(d===e.endLineNumber){const b=this.getLineContent(d).substring(m,e.endColumn-1);return o=this._findMatchesInLine(t,a,b,e.endLineNumber,m,o,s,i,r),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(d).substr(m),d,m,o,s,i,r),o>=r)return s;d++,l=this.nodeAt2(d,1),f=l.node,h=this.positionInBuffer(l.node,l.remainder)}if(d===e.endLineNumber){let p=d===e.startLineNumber?e.startColumn-1:0;const m=this.getLineContent(d).substring(p,e.endColumn-1);return o=this._findMatchesInLine(t,a,m,e.endLineNumber,p,o,s,i,r),s}let g=d===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,d,g,h,u,t,i,r,o,s),s}_findMatchesInLine(e,t,i,r,s,o,a,l,c){const h=e.wordSeparators;if(!l&&e.simpleSearch){const d=e.simpleSearch,f=d.length,g=i.length;let p=-f;for(;(p=i.indexOf(d,p+f))!==-1;)if((!h||y5(h,i,g,p,f))&&(a[o++]=new _w(new V(r,p+1+s,r,p+1+f+s),null),o>=c))return o;return o}let u;t.reset(0);do if(u=t.next(i),u&&(a[o++]=Wd(new V(r,u.index+1+s,r,u.index+1+u[0].length+s),u,l),o>=c))return o;while(u);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==$e){let{node:r,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=r.piece,l=a.bufferIndex,c=this.positionInBuffer(r,s);if(r.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<kc){this.appendToNode(r,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,r),this._searchCache.validate(e);else if(o+r.piece.length>e){let h=[],u=new es(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(r,s)===10){let p={line:u.start.line+1,column:0};u=new es(u.bufferIndex,p,u.end,this.getLineFeedCnt(u.bufferIndex,p,u.end),u.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(r,s-1)===13){let p=this.positionInBuffer(r,s-1);this.deleteNodeTail(r,p),t="\r"+t,r.piece.length===0&&h.push(r)}else this.deleteNodeTail(r,c);else this.deleteNodeTail(r,c);let d=this.createNewPieces(t);u.length>0&&this.rbInsertRight(r,u);let f=r;for(let g=0;g<d.length;g++)f=this.rbInsertRight(f,d[g]);this.deleteNodes(h)}else this.insertContentToNodeRight(t,r)}else{let r=this.createNewPieces(t),s=this.rbInsertLeft(null,r[0]);for(let o=1;o<r.length;o++)s=this.rbInsertRight(s,r[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===$e)return;let i=this.nodeAt(e),r=this.nodeAt(e+t),s=i.node,o=r.node;if(s===o){let d=this.positionInBuffer(s,i.remainder),f=this.positionInBuffer(s,r.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){let g=s.next();yC(this,s),this.validateCRLFWithPrevNode(g),this.computeBufferMetadata();return}this.deleteNodeHead(s,f),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,d),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,d,f),this.computeBufferMetadata();return}let a=[],l=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,l),this._searchCache.validate(e),s.piece.length===0&&a.push(s);let c=this.positionInBuffer(o,r.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);let h=s.next();for(let d=h;d!==$e&&d!==o;d=d.next())a.push(d);let u=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let o=t.piece,a={line:o.start.line+1,column:0},l=new es(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,Fc(this,t,-1,-1),t.piece.length===0&&i.push(t)}let r=this.createNewPieces(e),s=this.rbInsertLeft(t,r[r.length-1]);for(let o=r.length-2;o>=0;o--)s=this.rbInsertLeft(s,r[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);let i=this.createNewPieces(e),r=this.rbInsertRight(t,i[0]),s=r;for(let o=1;o<i.length;o++)s=this.rbInsertRight(s,i[o]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,i){let r=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,l=o[r.start.line]+r.start.column+t,c=r.start.line,h=r.end.line,u=0,d=0,f=0;for(;c<=h&&(u=c+(h-c)/2|0,f=o[u],u!==h);)if(d=o[u+1],l<f)h=u-1;else if(l>=d)c=u+1;else break;return i?(i.line=u,i.column=l-f,null):{line:u,column:l-f}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;let r=this._buffers[e].lineStarts;if(i.line===r.length-1)return i.line-t.line;let s=r[i.line+1],o=r[i.line]+i.column;if(s>o+1)return i.line-t.line;let a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)yC(this,e[t])}createNewPieces(e){if(e.length>kc){let h=[];for(;e.length>kc;){const d=e.charCodeAt(kc-1);let f;d===13||d>=55296&&d<=56319?(f=e.substring(0,kc-1),e=e.substring(kc-1)):(f=e.substring(0,kc),e=e.substring(kc));let g=Oc(f);h.push(new es(this._buffers.length,{line:0,column:0},{line:g.length-1,column:f.length-g[g.length-1]},g.length-1,f.length)),this._buffers.push(new $d(f,g))}let u=Oc(e);return h.push(new es(this._buffers.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this._buffers.push(new $d(e,u)),h}let t=this._buffers[0].buffer.length;const i=Oc(e,!1);let r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let h=0;h<i.length;h++)i[h]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let h=0;h<i.length;h++)i[h]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length;let o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new es(0,r,l,this.getLineFeedCnt(0,r,l),s-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,r="",s=this._searchCache.get2(e);if(s){i=s.node;let o=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)r=a.substring(l+o,l+i.piece.length);else{let c=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==$e;)if(i.left!==$e&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){let l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),h=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),h.substring(u+l,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){let l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r=c.substring(h+l,h+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==$e;){let o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){let a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=o.substring(l,l+a-t),r}else{let a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r+=o.substr(a,i.piece.length)}i=i.next()}return r}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==$e;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){let i=e.piece,r=this.positionInBuffer(e,t),s=r.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){let o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,r);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;let i=e.piece,r=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?r[i.end.line]+i.end.column-r[i.start.line]-i.start.column:r[s]-r[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-r,h=a-s,u=i.length+h;e.piece=new es(i.bufferIndex,i.start,o,l,u),Fc(this,e,h,c)}deleteNodeHead(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-r,h=s-l,u=i.length+h;e.piece=new es(i.bufferIndex,o,i.end,a,u),Fc(this,e,h,c)}shrinkNode(e,t,i){const r=e.piece,s=r.start,o=r.end,a=r.length,l=r.lineFeedCnt,c=t,h=this.getLineFeedCnt(r.bufferIndex,r.start,c),u=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,s);e.piece=new es(r.bufferIndex,r.start,c,h,u),Fc(this,e,u-a,h-l);let d=new es(r.bufferIndex,i,o,this.getLineFeedCnt(r.bufferIndex,i,o),this.offsetInBuffer(r.bufferIndex,o)-this.offsetInBuffer(r.bufferIndex,i)),f=this.rbInsertRight(e,d);this.validateCRLFWithPrevNode(f)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=Oc(t,!1);for(let f=0;f<s.length;f++)s[f]+=r;if(i){let f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,h=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,l),d=u-h;e.piece=new es(e.piece.bufferIndex,e.piece.start,l,u,c),this._lastChangeBufferPos=l,Fc(this,e,t.length,d)}nodeAt(e){let t=this.root,i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let r=0;for(;t!==$e;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;let s={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,r=0;for(;i!==$e;)if(i.left!==$e&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){let s=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return r+=i.size_left,{node:i,remainder:Math.min(s+t-1,o),nodeStartOffset:r}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){let s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:r};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==$e;){if(i.piece.lineFeedCnt>0){let s=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(i.piece.length>=t-1){let s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let i=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===$e||e.piece.lineFeedCnt===0)return!1;let t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,s=i[r]+t.start.column;return r===i.length-1||i[r+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===$e||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let i=[],r=this._buffers[e.piece.bufferIndex].lineStarts,s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new es(e.piece.bufferIndex,e.piece.start,s,a,o),Fc(this,e,-1,-1),e.piece.length===0&&i.push(e);let l={line:t.piece.start.line+1,column:0};const c=t.piece.length-1,h=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new es(t.piece.bufferIndex,l,t.piece.end,h,c),Fc(this,t,-1,-1),t.piece.length===0&&i.push(t);let u=this.createNewPieces(`\r
`);this.rbInsertRight(e,u[0]);for(let d=0;d<i.length;d++)yC(this,i[d])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)yC(this,i);else{const r=i.piece,s={line:r.start.line+1,column:0},o=r.length-1,a=this.getLineFeedCnt(r.bufferIndex,s,r.end);i.piece=new es(r.bufferIndex,s,r.end,a,o),Fc(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===$e)return t($e);let i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===$e)return"";let t=this._buffers[e.piece.bufferIndex],i,r=e.piece,s=this.offsetInBuffer(r.bufferIndex,r.start),o=this.offsetInBuffer(r.bufferIndex,r.end);return i=t.buffer.substring(s,o),i}getPieceContent(e){let t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,r)}rbInsertRight(e,t){let i=new hF(t,1);if(i.left=$e,i.right=$e,i.parent=$e,i.size_left=0,i.lf_left=0,this.root===$e)this.root=i,i.color=0;else if(e.right===$e)e.right=i,i.parent=e;else{let s=b5(e.right);s.left=i,i.parent=s}return h$(this,i),i}rbInsertLeft(e,t){let i=new hF(t,1);if(i.left=$e,i.right=$e,i.parent=$e,i.size_left=0,i.lf_left=0,this.root===$e)this.root=i,i.color=0;else if(e.left===$e)e.left=i,i.parent=e;else{let r=aee(e.left);r.right=i,i.parent=r}return h$(this,i),i}}function L_(n){let e=0,t=0,i=0,r=0;for(let s=0,o=n.length;s<o;s++){const a=n.charCodeAt(s);a===13?(e===0&&(t=s),e++,s+1<o&&n.charCodeAt(s+1)===10?(r|=2,s++):r|=3,i=s+1):a===10&&(r|=1,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=n.length),[e,t,n.length-i,r]}function d$(n){return(n<<0|0<<8|0<<11|1<<14|2<<23)>>>0}const Lc=new Uint32Array(0).buffer;class TT{constructor(){this.tokens=[]}add(e,t){if(this.tokens.length>0){const i=this.tokens[this.tokens.length-1];if(i.startLineNumber+i.tokens.length-1+1===e){i.tokens.push(t);return}}this.tokens.push(new vAe(e,[t]))}}class KE{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){let t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return e===0?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(e===0)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),r=this._getEndCharacter(e-1);return new V(0,t+1,i,r+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const r=t+Math.floor((i-t)/2),s=this._getDeltaLine(r);if(s<e)t=r+1;else if(s>e)i=r-1;else{let o=r;for(;o>t&&this._getDeltaLine(o-1)===e;)o--;let a=r;for(;a<i&&this._getDeltaLine(a+1)===e;)a++;return new f$(this._tokens.subarray(4*o,4*a+4))}}return this._getDeltaLine(t)===e?new f$(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,r){const s=this._tokens,o=this._tokenCount;let a=0,l=!1,c=0;for(let h=0;h<o;h++){const u=4*h,d=s[u],f=s[u+1],g=s[u+2],p=s[u+3];if((d>e||d===e&&g>=t)&&(d<i||d===i&&f<=r))l=!0;else{if(a===0&&(c=d),l){const m=4*a;s[m]=d-c,s[m+1]=f,s[m+2]=g,s[m+3]=p}a++}}return this._tokenCount=a,c}split(e,t,i,r){const s=this._tokens,o=this._tokenCount;let a=[],l=[],c=a,h=0,u=0;for(let d=0;d<o;d++){const f=4*d,g=s[f],p=s[f+1],m=s[f+2],b=s[f+3];if(g>e||g===e&&m>=t){if(g<i||g===i&&p<=r)continue;c!==l&&(c=l,h=0,u=g)}c[h++]=g-u,c[h++]=p,c[h++]=m,c[h++]=b}return[new KE(new Uint32Array(a)),new KE(new Uint32Array(l)),u]}acceptDeleteRange(e,t,i,r,s){const o=this._tokens,a=this._tokenCount,l=r-t;let c=0,h=!1;for(let u=0;u<a;u++){const d=4*u;let f=o[d],g=o[d+1],p=o[d+2];const m=o[d+3];if(f<t||f===t&&p<=i){c++;continue}else if(f===t&&g<i)f===r&&p>s?p-=s-i:p=i;else if(f===t&&g===i)if(f===r&&p>s)p-=s-i;else{h=!0;continue}else if(f<r||f===r&&g<s)if(f===r&&p>s)f===t?(g=i,p=g+(p-s)):(g=0,p=g+(p-s));else{h=!0;continue}else if(f>r){if(l===0&&!h){c=a;break}f-=l}else if(f===r&&g>=s)e&&f===0&&(g+=e,p+=e),f-=l,g-=s-i,p-=s-i;else throw new Error("Not possible!");const b=4*c;o[b]=f,o[b+1]=g,o[b+2]=p,o[b+3]=m,c++}this._tokenCount=c}acceptInsertText(e,t,i,r,s,o){const a=i===0&&r===1&&(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122),l=this._tokens,c=this._tokenCount;for(let h=0;h<c;h++){const u=4*h;let d=l[u],f=l[u+1],g=l[u+2];if(!(d<e||d===e&&g<t)){if(d===e&&g===t)if(a)g+=1;else continue;else if(d===e&&f<t&&t<g)i===0?g+=r:g=t;else{if(d===e&&f===t&&a)continue;if(d===e)if(d+=i,i===0)f+=r,g+=r;else{const p=g-f;f=s+(f-t),g=f+p}else d+=i}l[u]=d,l[u+1]=f,l[u+2]=g}}}}class f${constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}class ZE{constructor(e,t){this.startLineNumber=e,this.tokens=t,this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}toString(){return this.tokens.toString(this.startLineNumber)}_updateEndLineNumber(){this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}isEmpty(){return this.tokens.isEmpty()}getLineTokens(e){return this.startLineNumber<=e&&e<=this.endLineNumber?this.tokens.getLineTokens(e-this.startLineNumber):null}getRange(){const e=this.tokens.getRange();return e&&new V(this.startLineNumber+e.startLineNumber,e.startColumn,this.startLineNumber+e.endLineNumber,e.endColumn)}removeTokens(e){const t=e.startLineNumber-this.startLineNumber,i=e.endLineNumber-this.startLineNumber;this.startLineNumber+=this.tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this.startLineNumber,i=e.endLineNumber-this.startLineNumber,[r,s,o]=this.tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new ZE(this.startLineNumber,r),new ZE(this.startLineNumber+o,s)]}applyEdit(e,t){const[i,r,s]=L_(t);this.acceptEdit(e,i,r,s,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,r,s){this._acceptDeleteRange(e),this._acceptInsertText(new G(e.startLineNumber,e.startColumn),t,i,r,s),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this.startLineNumber,i=e.endLineNumber-this.startLineNumber;if(i<0){const s=i-t;this.startLineNumber-=s;return}const r=this.tokens.getMaxDeltaLine();if(!(t>=r+1)){if(t<0&&i>=r+1){this.startLineNumber=0,this.tokens.clear();return}if(t<0){const s=-t;this.startLineNumber-=s,this.tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this.tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,r,s){if(t===0&&i===0)return;const o=e.lineNumber-this.startLineNumber;if(o<0){this.startLineNumber+=t;return}const a=this.tokens.getMaxDeltaLine();o>=a+1||this.tokens.acceptInsertText(o,e.column-1,t,i,r,s)}}class vAe{constructor(e,t){this.startLineNumber=e,this.tokens=t}}function Ic(n){return n instanceof Uint32Array?n:new Uint32Array(n)}class C5{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const s=t[0].getRange(),o=t[t.length-1].getRange();if(!s||!o)return e;i=e.plusRange(s).plusRange(o)}let r=null;for(let s=0,o=this._pieces.length;s<o;s++){const a=this._pieces[s];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){r=r||{index:s};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(s,1),s--,o--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){r=r||{index:s};continue}const[l,c]=a.split(i);if(l.isEmpty()){r=r||{index:s};continue}c.isEmpty()||(this._pieces.splice(s,1,l,c),s++,o++,r=r||{index:s})}return r=r||{index:this._pieces.length},t.length>0&&(this._pieces=Cw(this._pieces,r.index,t)),i}isComplete(){return this._isComplete}addSemanticTokens(e,t){const i=this._pieces;if(i.length===0)return t;const r=C5._findFirstPieceWithLine(i,e),s=i[r].getLineTokens(e);if(!s)return t;const o=t.getCount(),a=s.getCount();let l=0,c=[],h=0,u=0;const d=(f,g)=>{f!==u&&(u=f,c[h++]=f,c[h++]=g)};for(let f=0;f<a;f++){const g=s.getStartCharacter(f),p=s.getEndCharacter(f),m=s.getMetadata(f),b=((m&1?2048:0)|(m&2?4096:0)|(m&4?8192:0)|(m&8?8372224:0)|(m&16?4286578688:0))>>>0,_=~b>>>0;for(;l<o&&t.getEndOffset(l)<=g;)d(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<o&&t.getStartOffset(l)<g&&d(g,t.getMetadata(l));l<o&&t.getEndOffset(l)<p;)d(t.getEndOffset(l),t.getMetadata(l)&_|m&b),l++;if(l<o)d(p,t.getMetadata(l)&_|m&b),t.getEndOffset(l)===p&&l++;else{const w=Math.min(Math.max(0,l-1),o-1);d(p,t.getMetadata(w)&_|m&b)}}for(;l<o;)d(t.getEndOffset(l),t.getMetadata(l)),l++;return new In(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,r=e.length-1;for(;i<r;){let s=i+Math.floor((r-i)/2);if(e[s].endLineNumber<t)i=s+1;else if(e[s].startLineNumber>t)r=s-1;else{for(;s>i&&e[s-1].startLineNumber<=t&&t<=e[s-1].endLineNumber;)s--;return s}}return i}acceptEdit(e,t,i,r,s){for(const o of this._pieces)o.acceptEdit(e,t,i,r,s)}}class qs{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}getTokens(e,t,i){let r=null;if(t<this._len&&(r=this._lineTokens[t]),r!==null&&r!==Lc)return new In(Ic(r),i,this._languageIdCodec);const s=new Uint32Array(2);return s[0]=i.length,s[1]=d$(this._languageIdCodec.encodeLanguageId(e)),new In(s,i,this._languageIdCodec)}static _massageTokens(e,t,i){const r=i?Ic(i):null;if(t===0){let s=!1;if(r&&r.length>1&&(s=Qs.getLanguageId(r[1])!==e),!s)return Lc}if(!r||r.length===0){const s=new Uint32Array(2);return s[0]=t,s[1]=d$(e),s.buffer}return r[r.length-2]=t,r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;let i=[];for(let r=0;r<t;r++)i[r]=null;this._lineTokens=Cw(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,r,s){const o=qs._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,r);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=o,s?!qs._equals(a,o):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Ic(e),r=Ic(t);if(i.length!==r.length)return!1;for(let s=0,o=i.length;s<o;s++)if(i[s]!==r[s])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new G(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=qs._delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=qs._deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let r=null;i<this._len&&(r=qs._deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=qs._append(this._lineTokens[t],r),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const r=e.lineNumber-1;if(!(r>=this._len)){if(t===0){this._lineTokens[r]=qs._insert(this._lineTokens[r],e.column-1,i);return}this._lineTokens[r]=qs._deleteEnding(this._lineTokens[r],e.column-1),this._lineTokens[r]=qs._insert(this._lineTokens[r],e.column-1,i),this._insertLines(e.lineNumber,t)}}static _deleteBeginning(e,t){return e===null||e===Lc?e:qs._delete(e,0,t)}static _deleteEnding(e,t){if(e===null||e===Lc)return e;const i=Ic(e),r=i[i.length-2];return qs._delete(e,t,r)}static _delete(e,t,i){if(e===null||e===Lc||t===i)return e;const r=Ic(e),s=r.length>>>1;if(t===0&&r[r.length-2]===i)return Lc;const o=In.findIndexInTokensArray(r,t),a=o>0?r[o-1<<1]:0,l=r[o<<1];if(i<l){const f=i-t;for(let g=o;g<s;g++)r[g<<1]-=f;return e}let c,h;a!==t?(r[o<<1]=t,c=o+1<<1,h=t):(c=o<<1,h=a);const u=i-t;for(let f=o+1;f<s;f++){const g=r[f<<1]-u;g>h&&(r[c++]=g,r[c++]=r[(f<<1)+1],h=g)}if(c===r.length)return e;let d=new Uint32Array(c);return d.set(r.subarray(0,c),0),d.buffer}static _append(e,t){if(t===Lc)return e;if(e===Lc)return t;if(e===null)return e;if(t===null)return null;const i=Ic(e),r=Ic(t),s=r.length>>>1;let o=new Uint32Array(i.length+r.length);o.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<s;c++)o[a++]=r[c<<1]+l,o[a++]=r[(c<<1)+1];return o.buffer}static _insert(e,t,i){if(e===null||e===Lc)return e;const r=Ic(e),s=r.length>>>1;let o=In.findIndexInTokensArray(r,t);o>0&&r[o-1<<1]===t&&o--;for(let a=o;a<s;a++)r[a<<1]+=i;return e}}class Rm extends re{constructor(e,t,i,r,s,o,a){super(),this._onDidChangeContent=this._register(new H),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._pieceTree=new bAe(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let i=e+t;const r=this.getPositionAt(e),s=this.getPositionAt(i);return new V(r.lineNumber,r.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let i=this.getOffsetAt(e.startLineNumber,e.startColumn);return this.getOffsetAt(e.endLineNumber,e.endColumn)-i}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const r=e.startLineNumber,s=e.endLineNumber;for(let o=r;o<=s;o++){const a=this.getLineContent(o),l=o===r?e.startColumn-1:0,c=o===s?e.endColumn-1:a.length;for(let h=l;h<c;h++)Ln(a.charCodeAt(h))?(i=i+1,h=h+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-r),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=cs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=_0(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let r=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let p=0;p<e.length;p++){let m=e[p];a&&m._isTracked&&(a=!1);let b=m.range;if(m.text){let k=!0;o||(k=!B3(m.text),o=k),!r&&k&&(r=Zk(m.text)),!s&&k&&(s=FQ(m.text))}let _="",w=0,y=0,S=0;if(m.text){let k;[w,y,S,k]=L_(m.text);const C=this.getEOL();k===0||k===(C===`\r
`?2:1)?_=m.text:_=m.text.replace(/\r\n|\r|\n/g,C)}l[p]={sortIndex:p,identifier:m.identifier||null,range:b,rangeOffset:this.getOffsetAt(b.startLineNumber,b.startColumn),rangeLength:this.getValueLengthInRange(b),text:_,eolCount:w,firstLineLength:y,lastLineLength:S,forceMoveMarkers:!!m.forceMoveMarkers,isAutoWhitespaceEdit:m.isAutoWhitespaceEdit||!1}}l.sort(Rm._sortOpsAscending);let c=!1;for(let p=0,m=l.length-1;p<m;p++){let b=l[p].range.getEndPosition(),_=l[p+1].range.getStartPosition();if(_.isBeforeOrEqual(b)){if(_.isBefore(b))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));let h=i||t?Rm._getInverseEditRanges(l):[],u=[];if(t)for(let p=0;p<l.length;p++){let m=l[p],b=h[p];if(m.isAutoWhitespaceEdit&&m.range.isEmpty())for(let _=b.startLineNumber;_<=b.endLineNumber;_++){let w="";_===b.startLineNumber&&(w=this.getLineContent(m.range.startLineNumber),cs(w)!==-1)||u.push({lineNumber:_,oldContent:w})}}let d=null;if(i){let p=0;d=[];for(let m=0;m<l.length;m++){const b=l[m],_=h[m],w=this.getValueInRange(b.range),y=b.rangeOffset+p;p+=b.text.length-w.length,d[m]={sortIndex:b.sortIndex,identifier:b.identifier,range:_,text:w,textChange:new Rn(b.rangeOffset,w,y,b.text)}}c||d.sort((m,b)=>m.sortIndex-b.sortIndex)}this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const f=this._doApplyEdits(l);let g=null;if(t&&u.length>0){u.sort((p,m)=>m.lineNumber-p.lineNumber),g=[];for(let p=0,m=u.length;p<m;p++){let b=u[p].lineNumber;if(p>0&&u[p-1].lineNumber===b)continue;let _=u[p].oldContent,w=this.getLineContent(b);w.length===0||w===_||cs(w)!==-1||g.push(b)}}return this._onDidChangeContent.fire(),new _Le(d,f,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,r=e[e.length-1].range,s=new V(i.startLineNumber,i.startColumn,r.endLineNumber,r.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let f=0,g=e.length;f<g;f++){const p=e[f],m=p.range;t=t||p.forceMoveMarkers,l.push(this.getValueInRange(new V(o,a,m.startLineNumber,m.startColumn))),p.text.length>0&&l.push(p.text),o=m.endLineNumber,a=m.endColumn}const c=l.join(""),[h,u,d]=L_(c);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:c,eolCount:h,firstLineLength:u,lastLineLength:d,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(Rm._sortOpsDescending);let t=[];for(let i=0;i<e.length;i++){let r=e[i];const s=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,l=r.range.endColumn;if(s===a&&o===l&&r.text.length===0)continue;r.text?(this._pieceTree.delete(r.rangeOffset,r.rangeLength),this._pieceTree.insert(r.rangeOffset,r.text,!0)):this._pieceTree.delete(r.rangeOffset,r.rangeLength);const c=new V(s,o,a,l);t.push({range:c,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,r){return this._pieceTree.findMatchesLineByLine(e,t,i,r)}static _getInverseEditRanges(e){let t=[],i=0,r=0,s=null;for(let o=0,a=e.length;o<a;o++){let l=e[o],c,h;s?s.range.endLineNumber===l.range.startLineNumber?(c=i,h=r+(l.range.startColumn-s.range.endColumn)):(c=i+(l.range.startLineNumber-s.range.endLineNumber),h=l.range.startColumn):(c=l.range.startLineNumber,h=l.range.startColumn);let u;if(l.text.length>0){const d=l.eolCount+1;d===1?u=new V(c,h,c,h+l.firstLineLength):u=new V(c,h,c+d-1,l.lastLineLength+1)}else u=new V(c,h,c,h);i=u.endLineNumber,r=u.endColumn,t.push(u),s=l}return t}static _sortOpsAscending(e,t){let i=V.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){let i=V.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class wAe{constructor(e,t,i,r,s,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=r,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e);let i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=i.length;s<o;s++){let a=i[s].buffer.replace(/\r\n|\r|\n/g,t),l=Oc(a);i[s]=new $d(a,l)}const r=new Rm(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}}class yAe{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&V3(e)&&(this.BOM=Oke,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=pAe(this._tmpLineStarts,e);this.chunks.push(new $d(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,this.isBasicASCII&&(this.isBasicASCII=t.isBasicASCII),!this.isBasicASCII&&!this.containsRTL&&(this.containsRTL=Zk(e)),!this.isBasicASCII&&!this.containsUnusualLineTerminators&&(this.containsUnusualLineTerminators=FQ(e))}finish(e=!0){return this._finish(),new wAe(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=Oc(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class CAe{constructor(){this.changeType=1}}class Za{constructor(e,t,i,r,s){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=r,this.order=s}static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",r=0;for(const s of t)i+=e.substring(r,s.column-1),r=s.column-1,i+=s.options.content;return i+=e.substring(r),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new Za(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new Za(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,r)=>i.lineNumber===r.lineNumber?i.column===r.column?i.order-r.order:i.column-r.column:i.lineNumber-r.lineNumber),t}}class g${constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class SAe{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class xAe{constructor(e,t,i,r){this.changeType=4,this.injectedTexts=r,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class EAe{constructor(){this.changeType=5}}class If{constructor(e,t,i,r){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=r,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),r=t.versionId,s=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing;return new If(i,r,s,o)}}class cee{constructor(e){this.changes=e}}class YE{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=If.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=YE._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new YE(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),r=t.eol,s=t.versionId,o=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush;return{changes:i,eol:r,versionId:s,isUndoing:o,isRedoing:a,isFlush:l}}}class DAe{constructor(){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0}_reset(e){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0,e&&this._setBeginState(0,e)}flush(e){this._reset(e)}get invalidLineStartIndex(){return this._invalidLineStartIndex}_invalidateLine(e){e<this._len&&(this._valid[e]=!1),e<this._invalidLineStartIndex&&(this._invalidLineStartIndex=e)}_isValid(e){return e<this._len?this._valid[e]:!1}getBeginState(e){return e<this._len?this._beginState[e]:null}_ensureLine(e){for(;e>=this._len;)this._beginState[this._len]=null,this._valid[this._len]=!1,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._beginState.splice(e,t),this._valid.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[],r=[];for(let s=0;s<t;s++)i[s]=null,r[s]=!1;this._beginState=Cw(this._beginState,e,i),this._valid=Cw(this._valid,e,r),this._len+=t}_setValid(e,t){this._ensureLine(e),this._valid[e]=t}_setBeginState(e,t){this._ensureLine(e),this._beginState[e]=t}setEndState(e,t,i){if(this._setValid(t,!0),this._invalidLineStartIndex=t+1,t===e-1)return;const r=this.getBeginState(t+1);if(r===null||!i.equals(r)){this._setBeginState(t+1,i),this._invalidateLine(t+1);return}let s=t+1;for(;s<e&&this._isValid(s);)s++;this._invalidLineStartIndex=s}setFakeTokens(e){this._setValid(e,!1)}applyEdits(e,t){const i=e.endLineNumber-e.startLineNumber,s=Math.min(i,t);for(let o=s;o>=0;o--)this._invalidateLine(e.startLineNumber+o-1);this._acceptDeleteRange(e),this._acceptInsertText(new G(e.startLineNumber,e.startColumn),t)}_acceptDeleteRange(e){e.startLineNumber-1>=this._len||this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){e.lineNumber-1>=this._len||this._insertLines(e.lineNumber,t)}}class kAe extends re{constructor(e,t){super(),this._textModel=e,this._languageIdCodec=t,this._isDisposed=!1,this._tokenizationStateStore=new DAe,this._tokenizationSupport=null,this._register(Fi.onDidChange(i=>{const r=this._textModel.getLanguageId();i.changedLanguages.indexOf(r)!==-1&&(this._resetTokenizationState(),this._textModel.clearTokens())})),this._register(this._textModel.onDidChangeContentFast(i=>{if(i.isFlush){this._resetTokenizationState();return}for(let r=0,s=i.changes.length;r<s;r++){const o=i.changes[r],[a]=L_(o.text);this._tokenizationStateStore.applyEdits(o.range,a)}this._beginBackgroundTokenization()})),this._register(this._textModel.onDidChangeAttached(()=>{this._beginBackgroundTokenization()})),this._register(this._textModel.onDidChangeLanguage(()=>{this._resetTokenizationState(),this._textModel.clearTokens()})),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}_resetTokenizationState(){const[e,t]=LAe(this._textModel);this._tokenizationSupport=e,this._tokenizationStateStore.flush(t),this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&AR(()=>{this._isDisposed||this._revalidateTokensNow()})}_revalidateTokensNow(){const e=this._textModel.getLineCount(),t=1,i=new TT,r=yh.create(!1);let s=-1;for(;this._hasLinesToTokenize()&&!(r.elapsed()>t||(s=this._tokenizeOneInvalidLine(i),s>=e)););this._beginBackgroundTokenization(),this._textModel.setTokens(i.tokens,!this._hasLinesToTokenize())}tokenizeViewport(e,t){const i=new TT;this._tokenizeViewport(i,e,t),this._textModel.setTokens(i.tokens,!this._hasLinesToTokenize())}reset(){this._resetTokenizationState(),this._textModel.clearTokens()}forceTokenization(e){const t=new TT;this._updateTokensUntilLine(t,e),this._textModel.setTokens(t.tokens,!this._hasLinesToTokenize())}isCheapToTokenize(e){if(!this._tokenizationSupport)return!0;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return e>t?!1:e<t||this._textModel.getLineLength(e)<2048}_hasLinesToTokenize(){return this._tokenizationSupport?this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount():!1}_tokenizeOneInvalidLine(e){if(!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(e,t),t}_updateTokensUntilLine(e,t){if(!this._tokenizationSupport)return;const i=this._textModel.getLanguageId(),r=this._textModel.getLineCount(),s=t-1;for(let o=this._tokenizationStateStore.invalidLineStartIndex;o<=s;o++){const a=this._textModel.getLineContent(o+1),l=this._tokenizationStateStore.getBeginState(o),c=AT(this._languageIdCodec,i,this._tokenizationSupport,a,!0,l);e.add(o+1,c.tokens),this._tokenizationStateStore.setEndState(r,o,c.endState),o=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(e,t,i){if(!this._tokenizationSupport||i<=this._tokenizationStateStore.invalidLineStartIndex)return;if(t<=this._tokenizationStateStore.invalidLineStartIndex){this._updateTokensUntilLine(e,i);return}let r=this._textModel.getLineFirstNonWhitespaceColumn(t);const s=[];let o=null;for(let c=t-1;r>1&&c>=1;c--){const h=this._textModel.getLineFirstNonWhitespaceColumn(c);if(h!==0&&h<r){if(o=this._tokenizationStateStore.getBeginState(c-1),o)break;s.push(this._textModel.getLineContent(c)),r=h}}o||(o=this._tokenizationSupport.getInitialState());const a=this._textModel.getLanguageId();let l=o;for(let c=s.length-1;c>=0;c--)l=AT(this._languageIdCodec,a,this._tokenizationSupport,s[c],!1,l).endState;for(let c=t;c<=i;c++){const h=this._textModel.getLineContent(c),u=AT(this._languageIdCodec,a,this._tokenizationSupport,h,!0,l);e.add(c,u.tokens),this._tokenizationStateStore.setFakeTokens(c-1),l=u.endState}}}function LAe(n){const e=n.getLanguageId();let t=n.isTooLargeForTokenization()?null:Fi.get(e),i=null;if(t)try{i=t.getInitialState()}catch(r){it(r),t=null}return[t,i]}function AT(n,e,t,i,r,s){let o=null;if(t)try{o=t.tokenize2(i,r,s.clone(),0)}catch(a){it(a)}return o||(o=JQ(n.encodeLanguageId(e),i,s,0)),In.convertToEndOffset(o.tokens,i.length),o}function Eu(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}class ht{constructor(e,t,i,r=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=Eu(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class xa{constructor(e,t,i,r){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Eu(Math.max(Math.min(1,t),0),3),this.l=Eu(Math.max(Math.min(1,i),0),3),this.a=Eu(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,r=e.b/255,s=e.a,o=Math.max(t,i,r),a=Math.min(t,i,r);let l=0,c=0;const h=(a+o)/2,u=o-a;if(u>0){switch(c=Math.min(h<=.5?u/(2*h):u/(2-2*h),1),o){case t:l=(i-r)/u+(i<r?6:0);break;case i:l=(r-t)/u+2;break;case r:l=(t-i)/u+4;break}l*=60,l=Math.round(l)}return new xa(l,c,h,s)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:r,a:s}=e;let o,a,l;if(i===0)o=a=l=r;else{const c=r<.5?r*(1+i):r+i-r*i,h=2*r-c;o=xa._hue2rgb(h,c,t+1/3),a=xa._hue2rgb(h,c,t),l=xa._hue2rgb(h,c,t-1/3)}return new ht(Math.round(o*255),Math.round(a*255),Math.round(l*255),s)}}class $l{constructor(e,t,i,r){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=Eu(Math.max(Math.min(1,t),0),3),this.v=Eu(Math.max(Math.min(1,i),0),3),this.a=Eu(Math.max(Math.min(1,r),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,r=e.b/255,s=Math.max(t,i,r),o=Math.min(t,i,r),a=s-o,l=s===0?0:a/s;let c;return a===0?c=0:s===t?c=((i-r)/a%6+6)%6:s===i?c=(r-t)/a+2:c=(t-i)/a+4,new $l(Math.round(c*60),l,s,e.a)}static toRGBA(e){const{h:t,s:i,v:r,a:s}=e,o=r*i,a=o*(1-Math.abs(t/60%2-1)),l=r-o;let[c,h,u]=[0,0,0];return t<60?(c=o,h=a):t<120?(c=a,h=o):t<180?(h=o,u=a):t<240?(h=a,u=o):t<300?(c=a,u=o):t<=360&&(c=o,u=a),c=Math.round((c+l)*255),h=Math.round((h+l)*255),u=Math.round((u+l)*255),new ht(c,h,u,s)}}class X{constructor(e){if(e)if(e instanceof ht)this.rgba=e;else if(e instanceof xa)this._hsla=e,this.rgba=xa.toRGBA(e);else if(e instanceof $l)this._hsva=e,this.rgba=$l.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}static fromHex(e){return X.Format.CSS.parseHex(e)||X.red}get hsla(){return this._hsla?this._hsla:xa.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:$l.fromRGBA(this.rgba)}equals(e){return!!e&&ht.equals(this.rgba,e.rgba)&&xa.equals(this.hsla,e.hsla)&&$l.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=X._relativeLuminanceForComponent(this.rgba.r),t=X._relativeLuminanceForComponent(this.rgba.g),i=X._relativeLuminanceForComponent(this.rgba.b),r=.2126*e+.7152*t+.0722*i;return Eu(r,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new X(new xa(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new X(new xa(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:r,a:s}=this.rgba;return new X(new ht(t,i,r,s*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new X(new ht(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}toString(){return this._toString||(this._toString=X.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const r=e.getRelativeLuminance(),s=t.getRelativeLuminance();return i=i*(s-r)/s,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const r=e.getRelativeLuminance(),s=t.getRelativeLuminance();return i=i*(r-s)/r,e.darken(i)}}X.white=new X(new ht(255,255,255,1));X.black=new X(new ht(0,0,0,1));X.red=new X(new ht(255,0,0,1));X.blue=new X(new ht(0,0,255,1));X.cyan=new X(new ht(0,255,255,1));X.lightgrey=new X(new ht(211,211,211,1));X.transparent=new X(new ht(0,0,0,0));(function(n){(function(e){(function(t){function i(f){return f.rgba.a===1?`rgb(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b})`:n.Format.CSS.formatRGBA(f)}t.formatRGB=i;function r(f){return`rgba(${f.rgba.r}, ${f.rgba.g}, ${f.rgba.b}, ${+f.rgba.a.toFixed(2)})`}t.formatRGBA=r;function s(f){return f.hsla.a===1?`hsl(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%)`:n.Format.CSS.formatHSLA(f)}t.formatHSL=s;function o(f){return`hsla(${f.hsla.h}, ${(f.hsla.s*100).toFixed(2)}%, ${(f.hsla.l*100).toFixed(2)}%, ${f.hsla.a.toFixed(2)})`}t.formatHSLA=o;function a(f){const g=f.toString(16);return g.length!==2?"0"+g:g}function l(f){return`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}`}t.formatHex=l;function c(f,g=!1){return g&&f.rgba.a===1?n.Format.CSS.formatHex(f):`#${a(f.rgba.r)}${a(f.rgba.g)}${a(f.rgba.b)}${a(Math.round(f.rgba.a*255))}`}t.formatHexA=c;function h(f){return f.isOpaque()?n.Format.CSS.formatHex(f):n.Format.CSS.formatRGBA(f)}t.format=h;function u(f){const g=f.length;if(g===0||f.charCodeAt(0)!==35)return null;if(g===7){const p=16*d(f.charCodeAt(1))+d(f.charCodeAt(2)),m=16*d(f.charCodeAt(3))+d(f.charCodeAt(4)),b=16*d(f.charCodeAt(5))+d(f.charCodeAt(6));return new n(new ht(p,m,b,1))}if(g===9){const p=16*d(f.charCodeAt(1))+d(f.charCodeAt(2)),m=16*d(f.charCodeAt(3))+d(f.charCodeAt(4)),b=16*d(f.charCodeAt(5))+d(f.charCodeAt(6)),_=16*d(f.charCodeAt(7))+d(f.charCodeAt(8));return new n(new ht(p,m,b,_/255))}if(g===4){const p=d(f.charCodeAt(1)),m=d(f.charCodeAt(2)),b=d(f.charCodeAt(3));return new n(new ht(16*p+p,16*m+m,16*b+b))}if(g===5){const p=d(f.charCodeAt(1)),m=d(f.charCodeAt(2)),b=d(f.charCodeAt(3)),_=d(f.charCodeAt(4));return new n(new ht(16*p+p,16*m+m,16*b+b,(16*_+_)/255))}return null}t.parseHex=u;function d(f){switch(f){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(n.Format||(n.Format={}))})(X||(X={}));const vy=Dt("undoRedoService");class hee{constructor(e,t){this.resource=e,this.elements=t}}class I_{constructor(){this.id=I_._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}I_._ID=0;I_.None=new I_;class Pl{constructor(){this.id=Pl._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}}Pl._ID=0;Pl.None=new Pl;class p${constructor(e,t,i){this.range=e,this.nestingLevel=t,this.isInvalid=i}}class IAe{constructor(e,t,i,r){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=r}}class TAe extends IAe{constructor(e,t,i,r,s){super(e,t,i,r),this.minVisibleColumnIndentation=s}}class AAe{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}function NAe(n,e,t,i){return n!==t?ki(t-n,i):ki(0,i-e)}const Sh=0;function RAe(n){return n===0}const Rs=Math.pow(2,26);function ki(n,e){return n*Rs+e}function Du(n){const e=n,t=Math.floor(e/Rs),i=e-t*Rs;return new AAe(t,i)}function MAe(n){return Math.floor(n/Rs)}function Mn(n,e){return e<Rs?n+e:n-n%Rs+e}function FAe(n,e){const t=n,i=e;if(i-t<=0)return Sh;const s=Math.floor(t/Rs),o=Math.floor(i/Rs),a=i-o*Rs;if(s===o){const l=t-s*Rs;return ki(0,a-l)}else return ki(o-s,a)}function $S(n,e){return n<e}function uf(n,e){return n<=e}function SC(n,e){return n>=e}function xC(n){return ki(n.lineNumber-1,n.column-1)}function hv(n,e){const t=n,i=Math.floor(t/Rs),r=t-i*Rs,s=e,o=Math.floor(s/Rs),a=s-o*Rs;return new V(i+1,r+1,o+1,a+1)}function OAe(n){const e=nc(n);return ki(e.length-1,e[e.length-1].length)}class m${constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}}class PAe{constructor(e,t){this.documentLength=t,this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(i=>S5.from(i))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):this.documentLength;return FAe(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?ki(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):ki(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Du(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?ki(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):ki(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(uf(i,e)){this.nextEditIdx++;const r=Du(i),s=Du(this.translateOldToCur(t.endOffsetBeforeObj)),o=r.lineCount-s.lineCount;this.deltaOldToNewLineCount+=o;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=r.columnCount-s.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class S5{constructor(e,t,i){this.endOffsetBeforeObj=Du(t),this.endOffsetAfterObj=Du(Mn(e,i)),this.offsetObj=Du(e)}static from(e){return new S5(e.startOffset,e.endOffset,e.newLength)}}class Mt{static visibleColumnFromColumn(e,t,i){const r=e.length,s=t-1<r?t-1:r;let o=0,a=0;for(;a<s;){const l=jc(e,s,a);if(a+=l>=65536?2:1,l===9)o=Mt.nextRenderTabStop(o,i);else{let c=vp(l);for(;a<s;){const h=jc(e,s,a),u=vp(h);if(Xb(c,u))break;a+=h>=65536?2:1,c=u}Ra(l)||Yb(l)?o=o+2:o=o+1}}return o}static visibleColumnsByColumns(e,t){const i=e.length;let r=new Array;r.push(-1);let s=0,o=0;for(;o<i;){const a=jc(e,i,o);if(o+=a>=65536?2:1,r.push(s),a>=65536&&r.push(s),a===9)s=Mt.nextRenderTabStop(s,t);else{let l=vp(a);for(;o<i;){const c=jc(e,i,o),h=vp(c);if(Xb(l,h))break;o+=c>=65536?2:1,r.push(s),a>=65536&&r.push(s),l=h}Ra(a)||Yb(a)?s=s+2:s=s+1}}return r.push(s),r}static visibleColumnFromColumn2(e,t,i){return this.visibleColumnFromColumn(t.getLineContent(i.lineNumber),i.column,e.tabSize)}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const r=e.length;let s=0,o=1,a=0;for(;a<r;){const l=jc(e,r,a);a+=l>=65536?2:1;let c;if(l===9)c=Mt.nextRenderTabStop(s,i);else{let u=vp(l);for(;a<r;){const d=jc(e,r,a),f=vp(d);if(Xb(u,f))break;a+=d>=65536?2:1,u=f}Ra(l)||Yb(l)?c=s+2:c=s+1}const h=a+1;if(c>=t){const u=t-s;return c-t<u?h:o}s=c,o=h}return r+1}static columnFromVisibleColumn2(e,t,i,r){let s=this.columnFromVisibleColumn(t.getLineContent(i),r,e.tabSize),o=t.getLineMinColumn(i);if(s<o)return o;let a=t.getLineMaxColumn(i);return s>a?a:s}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}const zS=new Array;class Hi{constructor(e,t){this.items=e,this.additionalItems=t}static create(e,t){if(e<=128&&t.length===0){let i=Hi.cache[e];return i||(i=new Hi(e,t),Hi.cache[e]=i),i}return new Hi(e,t)}static getEmpty(){return this.empty}add(e,t){const i=t.getKey(e);let r=i>>5;if(r===0){const o=1<<i|this.items;return o===this.items?this:Hi.create(o,this.additionalItems)}r--;const s=this.additionalItems.slice(0);for(;s.length<r;)s.push(0);return s[r]|=1<<(i&31),Hi.create(this.items,s)}merge(e){const t=this.items|e.items;if(this.additionalItems===zS&&e.additionalItems===zS)return t===this.items?this:t===e.items?e:Hi.create(t,zS);const i=new Array;for(let r=0;r<Math.max(this.additionalItems.length,e.additionalItems.length);r++){const s=this.additionalItems[r]||0,o=e.additionalItems[r]||0;i.push(s|o)}return Hi.create(t,i)}intersects(e){if(this.items&e.items)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(this.additionalItems[t]&e.additionalItems[t])return!0;return!1}}Hi.cache=new Array(129);Hi.empty=Hi.create(0,zS);const _$={getKey(n){return n}};class BAe{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class x5{constructor(e){this._length=e}get length(){return this._length}}class kw extends x5{constructor(e,t,i,r,s){super(e),this.openingBracket=t,this.child=i,this.closingBracket=r,this.missingOpeningBracketIds=s}static create(e,t,i){let r=e.length;return t&&(r=Mn(r,t.length)),i&&(r=Mn(r,i.length)),new kw(r,e,t,i,t?t.missingOpeningBracketIds:Hi.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=new Array;return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new kw(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(Mn(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class ac extends x5{constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}static create23(e,t,i,r=!1){let s=e.length,o=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(s=Mn(s,t.length),o=o.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=Mn(s,i.length),o=o.merge(i.missingOpeningBracketIds)}return r?new VAe(s,e.listHeight+1,e,t,i,o):new Lw(s,e.listHeight+1,e,t,i,o)}static getEmpty(){return new WAe(Sh,0,[],Hi.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds))return!1;let t=this,i;for(;t.kind===4&&(i=t.childrenLength)>0;)t=t.getChild(i-1);return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let r=1;r<e;r++){const s=this.getChild(r);t=Mn(t,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,r=e;for(let s=0;s<this.childrenLength;s++){const o=this.getChild(s);o&&(i=Math.min(i,o.computeMinIndentation(r,t)),r=Mn(r,o.length))}return this.cachedMinIndentation=i,i}}class Lw extends ac{constructor(e,t,i,r,s,o){super(e,t,o),this._item1=i,this._item2=r,this._item3=s}get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new Lw(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class VAe extends Lw{toMutable(){return new Lw(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class XE extends ac{constructor(e,t,i,r){super(e,t,r),this._children=i}get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new XE(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class WAe extends XE{toMutable(){return new XE(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const $Ae=[];class E5 extends x5{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return $Ae}deepClone(){return this}}class Bp extends E5{get kind(){return 0}get missingOpeningBracketIds(){return Hi.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=Du(e),r=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,s=MAe(Mn(e,this.length))+1;let o=Number.MAX_SAFE_INTEGER;for(let a=r;a<=s;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const h=Mt.visibleColumnFromColumn(c,l,t.getOptions().tabSize);o=Math.min(o,h)}return o}}class Tf extends E5{constructor(e){super(e)}static create(e){const t=e,i=Tf.cacheByLength.get(t);if(i)return i;const r=new Tf(e);return Tf.cacheByLength.set(t,r),r}get kind(){return 1}get missingOpeningBracketIds(){return Hi.getEmpty()}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}Tf.cacheByLength=new Map;class zAe extends E5{constructor(e,t){super(t),this.missingOpeningBracketIds=e}get kind(){return 3}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class ou{constructor(e,t,i,r,s){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=r,this.astNode=s}}class HAe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new UAe(this.textModel,this.bracketTokens),this._offset=Sh,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return ki(this.textBufferLineCount,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=Mn(this._offset,e);const t=Du(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=Mn(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class UAe{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset)):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const s=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=s.length,s}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const s=this.lineTokens,o=s.getCount();let a=null;if(this.lineTokenOffset<o){const l=s.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&l===s.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=Qs.getTokenType(l)===0,h=s.getEndOffset(this.lineTokenOffset);if(c&&h!==this.lineCharOffset){const u=s.getLanguageId(this.lineTokenOffset),d=this.line.substring(this.lineCharOffset,h),f=this.bracketTokens.getSingleLanguageBracketTokens(u),g=f.regExpGlobal;if(g){g.lastIndex=0;const p=g.exec(d);p&&(a=f.getToken(p[0]),a&&(this.lineCharOffset+=p.index))}}if(i+=h-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=h}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const r=NAe(e,t,this.lineIdx,this.lineCharOffset);return new ou(r,0,-1,Hi.getEmpty(),new Bp(r))}}class jAe{constructor(e,t){this.text=e,this._offset=Sh,this.idx=0;const r=t.getRegExpStr()?new RegExp(t.getRegExpStr()+`|
`,"g"):null,s=[];let o,a=0,l=0,c=0,h=0;const u=new Array;for(let g=0;g<60;g++)u.push(new ou(ki(0,g),0,-1,Hi.getEmpty(),new Bp(ki(0,g))));const d=new Array;for(let g=0;g<60;g++)d.push(new ou(ki(1,g),0,-1,Hi.getEmpty(),new Bp(ki(1,g))));if(r)for(r.lastIndex=0;(o=r.exec(e))!==null;){const g=o.index,p=o[0];if(p===`
`)a++,l=g+1;else{if(c!==g){let m;if(h===a){const b=g-c;if(b<u.length)m=u[b];else{const _=ki(0,b);m=new ou(_,0,-1,Hi.getEmpty(),new Bp(_))}}else{const b=a-h,_=g-l;if(b===1&&_<d.length)m=d[_];else{const w=ki(b,_);m=new ou(w,0,-1,Hi.getEmpty(),new Bp(w))}}s.push(m)}s.push(t.getToken(p)),c=g+p.length,h=a}}const f=e.length;if(c!==f){const g=h===a?ki(0,f-c):ki(a-h,f-l);s.push(new ou(g,0,-1,Hi.getEmpty(),new Bp(g)))}this.length=ki(a,f-l),this.tokens=s}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new CDe}}class QE{constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}static createFromLanguage(e,t){function i(l,c){return t.getKey(`${l}:::${c}`)}const r=e.characterPair.getColorizedBrackets(),s=new Map,o=new Set;for(const[l,c]of r){o.add(l);let h=s.get(c);const u=i(e.languageId,l);h||(h={openingBrackets:Hi.getEmpty(),first:u},s.set(c,h)),h.openingBrackets=h.openingBrackets.add(u,_$)}const a=new Map;for(const[l,c]of s){const h=ki(0,l.length);a.set(l,new ou(h,2,c.first,c.openingBrackets,Tf.create(h)))}for(const l of o){const c=ki(0,l.length),h=i(e.languageId,l);a.set(l,new ou(c,1,h,Hi.getEmpty().add(h,_$),Tf.create(c)))}return new QE(a)}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>qAe(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e)}get isEmpty(){return this.map.size===0}}function qAe(n){const e=ja(n);return/^[\w ]+$/.test(n)?`\\b${e}\\b`:e}class GAe{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){const t=this.languageIdToBracketTokens.get(e);if(!t)return!1;const i=QE.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider).getRegExpStr();return t.getRegExpStr()!==i}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=QE.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function KAe(n){if(n.length===0)return null;if(n.length===1)return n[0];let e=0;function t(){if(e>=n.length)return null;const o=e,a=n[o].listHeight;for(e++;e<n.length&&n[e].listHeight===a;)e++;return e-o>=2?uee(o===0&&e===n.length?n:n.slice(o,e),!1):n[o]}let i=t(),r=t();if(!r)return i;for(let o=t();o;o=t())b$(i,r)<=b$(r,o)?(i=NT(i,r),r=o):r=NT(r,o);return NT(i,r)}function uee(n,e=!1){if(n.length===0)return null;if(n.length===1)return n[0];let t=n.length;for(;t>3;){const i=t>>1;for(let r=0;r<i;r++){const s=r<<1;n[r]=ac.create23(n[s],n[s+1],s+3===t?n[s+2]:null,e)}t=i}return ac.create23(n[0],n[1],t>=3?n[2]:null,e)}function b$(n,e){return Math.abs(n.listHeight-e.listHeight)}function NT(n,e){return n.listHeight===e.listHeight?ac.create23(n,e,null,!1):n.listHeight>e.listHeight?ZAe(n,e):YAe(e,n)}function ZAe(n,e){n=n.toMutable();let t=n;const i=new Array;let r;for(;;){if(e.listHeight===t.listHeight){r=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let s=i.length-1;s>=0;s--){const o=i[s];r?o.childrenLength>=3?r=ac.create23(o.unappendChild(),r,null,!1):(o.appendChildOfSameHeight(r),r=void 0):o.handleChildrenChanged()}return r?ac.create23(n,r,null,!1):n}function YAe(n,e){n=n.toMutable();let t=n;const i=new Array;for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let r=e;for(let s=i.length-1;s>=0;s--){const o=i[s];r?o.childrenLength>=3?r=ac.create23(r,o.unprependChild(),null,!1):(o.prependChildOfSameHeight(r),r=void 0):o.handleChildrenChanged()}return r?ac.create23(r,n,null,!1):n}class XAe{constructor(e){this.lastOffset=Sh,this.nextNodes=[e],this.offsets=[Sh],this.idxs=[]}readLongestNodeAt(e,t){if($S(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=Y0(this.nextNodes);if(!i)return;const r=Y0(this.offsets);if($S(e,r))return;if($S(r,e))if(Mn(r,i.length)<=e)this.nextNodeAfterCurrent();else{const s=RT(i);s!==-1?(this.nextNodes.push(i.getChild(s)),this.offsets.push(r),this.idxs.push(s)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const s=RT(i);if(s===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(s)),this.offsets.push(r),this.idxs.push(s)}}}}nextNodeAfterCurrent(){for(;;){const e=Y0(this.offsets),t=Y0(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=Y0(this.nextNodes),r=RT(i,this.idxs[this.idxs.length-1]);if(r!==-1){this.nextNodes.push(i.getChild(r)),this.offsets.push(Mn(e,t.length)),this.idxs[this.idxs.length-1]=r;break}else this.idxs.pop()}}}function RT(n,e=-1){for(;;){if(e++,e>=n.childrenLength)return-1;if(n.getChild(e))return e}}function Y0(n){return n.length>0?n[n.length-1]:void 0}function v$(n,e,t,i){return new QAe(n,e,t,i).parseDocument()}class QAe{constructor(e,t,i,r){if(this.tokenizer=e,this.createImmutableLists=r,this._itemsConstructed=0,this._itemsFromCache=0,i&&r)throw new Error("Not supported");this.oldNodeReader=i?new XAe(i):void 0,this.positionMapper=new PAe(t,e.length)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Hi.getEmpty());return e||(e=ac.getEmpty()),e}parseList(e){const t=new Array;for(;;){const r=this.tokenizer.peek();if(!r||r.kind===2&&r.bracketIds.intersects(e))break;const s=this.parseChild(e);s.kind===4&&s.childrenLength===0||t.push(s)}return this.oldNodeReader?KAe(t):uee(t,this.createImmutableLists)}parseChild(e){if(this.oldNodeReader){const i=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(!RAe(i)){const r=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),s=>$S(s.length,i)?s.canBeReused(e):!1);if(r)return this._itemsFromCache++,this.tokenizer.skip(r.length),r}}this._itemsConstructed++;const t=this.tokenizer.read();switch(t.kind){case 2:return new zAe(t.bracketIds,t.length);case 0:return t.astNode;case 1:const i=e.merge(t.bracketIds),r=this.parseList(i),s=this.tokenizer.peek();return s&&s.kind===2&&(s.bracketId===t.bracketId||s.bracketIds.intersects(t.bracketIds))?(this.tokenizer.read(),kw.create(t.astNode,r,s.astNode)):kw.create(t.astNode,r,null);default:throw new Error("unexpected")}}}class JAe extends re{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.cache=this._register(new zs),this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(e.onDidChangeOptions(i=>{this.cache.clear(),this.updateCache()})),this._register(e.onDidChangeLanguage(i=>{this.cache.clear(),this.updateCache()})),this._register(this.languageConfigurationService.onDidChange(i=>{var r;(!i.languageId||!((r=this.cache.value)===null||r===void 0)&&r.object.didLanguageChange(i.languageId))&&(this.cache.clear(),this.updateCache())}))}get isDocumentSupported(){return this.textModel.getValueLength()<=5e6}updateCache(){if(this.bracketsRequested&&this.isDocumentSupported){if(!this.cache.value){const e=new ve;this.cache.value=eNe(e.add(new tNe(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.cache.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.cache.clear(),this.onDidChangeEmitter.fire()}handleContentChanged(e){var t;(t=this.cache.value)===null||t===void 0||t.object.handleContentChanged(e)}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateCache(),((t=this.cache.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!1))||[]}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateCache(),((t=this.cache.value)===null||t===void 0?void 0:t.object.getBracketPairsInRange(e,!0))||[]}getBracketsInRange(e){var t;return this.bracketsRequested=!0,this.updateCache(),((t=this.cache.value)===null||t===void 0?void 0:t.object.getBracketsInRange(e))||[]}}function eNe(n,e){return{object:n,dispose:()=>e==null?void 0:e.dispose()}}class tNe extends re{constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new H,this.denseKeyProvider=new BAe,this.brackets=new GAe(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this._register(e.onBackgroundTokenizationStateChanged(()=>{if(e.backgroundTokenizationState===2){const i=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,i||this.didChangeEmitter.fire()}})),this._register(e.onDidChangeTokens(({ranges:i})=>{const r=i.map(s=>new m$(ki(s.fromLineNumber-1,0),ki(s.toLineNumber,0),ki(s.toLineNumber-s.fromLineNumber+1,0)));this.astWithTokens=this.parseDocumentFromTextBuffer(r,this.astWithTokens,!1),this.initialAstWithoutTokens||this.didChangeEmitter.fire()})),e.backgroundTokenizationState===0){const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),r=new jAe(this.textModel.getValue(),i);this.initialAstWithoutTokens=v$(r,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}else e.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):e.backgroundTokenizationState===1&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens)}didLanguageChange(e){return this.brackets.didLanguageChange(e)}handleContentChanged(e){const t=e.changes.map(i=>{const r=V.lift(i.range);return new m$(xC(r.getStartPosition()),xC(r.getEndPosition()),OAe(i.text))}).reverse();this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens,!1),this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(t,this.initialAstWithoutTokens,!1))}parseDocumentFromTextBuffer(e,t,i){const r=t,s=new HAe(this.textModel,this.brackets);return v$(s,e,r,i)}getBracketsInRange(e){const t=ki(e.startLineNumber-1,e.startColumn-1),i=ki(e.endLineNumber-1,e.endColumn-1),r=new Array,s=this.initialAstWithoutTokens||this.astWithTokens;return xb(s,Sh,s.length,t,i,r),r}getBracketPairsInRange(e,t){const i=new Array,r=xC(e.getStartPosition()),s=xC(e.getEndPosition()),o=this.initialAstWithoutTokens||this.astWithTokens,a=new iNe(i,t,this.textModel);return dee(o,Sh,o.length,r,s,a),i}}function xb(n,e,t,i,r,s,o=0){if(n.kind===1){const a=hv(e,t);s.push(new p$(a,o-1,!1))}else if(n.kind===3){const a=hv(e,t);s.push(new p$(a,o-1,!0))}else if(n.kind===4)for(const a of n.children)t=Mn(e,a.length),uf(e,r)&&SC(t,i)&&xb(a,e,t,i,r,s,o),e=t;else if(n.kind===2){o++;{const a=n.openingBracket;t=Mn(e,a.length),uf(e,r)&&SC(t,i)&&xb(a,e,t,i,r,s,o),e=t}if(n.child){const a=n.child;t=Mn(e,a.length),uf(e,r)&&SC(t,i)&&xb(a,e,t,i,r,s,o),e=t}if(n.closingBracket){const a=n.closingBracket;t=Mn(e,a.length),uf(e,r)&&SC(t,i)&&xb(a,e,t,i,r,s,o),e=t}}}class iNe{constructor(e,t,i){this.result=e,this.includeMinIndentation=t,this.textModel=i}}function dee(n,e,t,i,r,s,o=0){var a;if(n.kind===2){const c=Mn(e,n.openingBracket.length);let h=-1;s.includeMinIndentation&&(h=n.computeMinIndentation(e,s.textModel)),s.result.push(new TAe(hv(e,t),hv(e,c),n.closingBracket?hv(Mn(c,((a=n.child)===null||a===void 0?void 0:a.length)||Sh),t):void 0,o,h)),o++}let l=e;for(const c of n.children){const h=l;l=Mn(l,c.length),uf(h,r)&&uf(i,l)&&dee(c,h,l,i,r,s,o)}}const fee={ColorContribution:"base.contributions.colors"};class nNe{constructor(){this._onDidChangeSchema=new H,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,r=!1,s){let o={id:e,description:i,defaults:t,needsTransparency:r,deprecationMessage:s};this.colorsById[e]=o;let a={type:"string",description:i,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return s&&(a.deprecationMessage=s),this.colorSchema.properties[e]=a,this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i&&i.defaults){const r=i.defaults[t.type];return Pc(r,t)}}getColorSchema(){return this.colorSchema}toString(){let e=(t,i)=>{let r=t.indexOf(".")===-1?0:1,s=i.indexOf(".")===-1?0:1;return r!==s?r-s:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const yL=new nNe;Bn.add(fee.ColorContribution,yL);function z(n,e,t,i,r){return yL.registerColor(n,e,t,i,r)}const Oe=z("foreground",{dark:"#CCCCCC",light:"#616161",hc:"#FFFFFF"},v("foreground","Overall foreground color. This color is only used if not overridden by a component.")),rNe=z("errorForeground",{dark:"#F48771",light:"#A1260D",hc:"#F48771"},v("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component.")),MT=z("icon.foreground",{dark:"#C5C5C5",light:"#424242",hc:"#FFFFFF"},v("iconForeground","The default color for icons in the workbench.")),Yu=z("focusBorder",{dark:"#007FD4",light:"#0090F1",hc:"#F38518"},v("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),Ki=z("contrastBorder",{light:null,dark:null,hc:"#6FC3DF"},v("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),Ur=z("contrastActiveBorder",{light:null,dark:null,hc:Yu},v("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast.")),CL=z("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},v("textLinkForeground","Foreground color for links in text.")),SL=z("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},v("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover.")),gee=z("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hc:X.black},v("textCodeBlockBackground","Background color for code blocks in text.")),T_=z("widget.shadow",{dark:Jt(X.black,.36),light:Jt(X.black,.16),hc:null},v("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),pee=z("input.background",{dark:"#3C3C3C",light:X.white,hc:X.black},v("inputBoxBackground","Input box background.")),mee=z("input.foreground",{dark:Oe,light:Oe,hc:Oe},v("inputBoxForeground","Input box foreground.")),_ee=z("input.border",{dark:null,light:null,hc:Ki},v("inputBoxBorder","Input box border.")),uF=z("inputOption.activeBorder",{dark:"#007ACC00",light:"#007ACC00",hc:Ki},v("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),dF=z("inputOption.activeBackground",{dark:Jt(Yu,.4),light:Jt(Yu,.2),hc:X.transparent},v("inputOption.activeBackground","Background color of activated options in input fields.")),fF=z("inputOption.activeForeground",{dark:X.white,light:X.black,hc:null},v("inputOption.activeForeground","Foreground color of activated options in input fields.")),D5=z("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hc:X.black},v("inputValidationInfoBackground","Input validation background color for information severity.")),k5=z("inputValidation.infoForeground",{dark:null,light:null,hc:null},v("inputValidationInfoForeground","Input validation foreground color for information severity.")),L5=z("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hc:Ki},v("inputValidationInfoBorder","Input validation border color for information severity.")),bee=z("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hc:X.black},v("inputValidationWarningBackground","Input validation background color for warning severity.")),vee=z("inputValidation.warningForeground",{dark:null,light:null,hc:null},v("inputValidationWarningForeground","Input validation foreground color for warning severity.")),wee=z("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hc:Ki},v("inputValidationWarningBorder","Input validation border color for warning severity.")),yee=z("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hc:X.black},v("inputValidationErrorBackground","Input validation background color for error severity.")),Cee=z("inputValidation.errorForeground",{dark:null,light:null,hc:null},v("inputValidationErrorForeground","Input validation foreground color for error severity.")),See=z("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hc:Ki},v("inputValidationErrorBorder","Input validation border color for error severity.")),FT=z("dropdown.background",{dark:"#3C3C3C",light:X.white,hc:X.black},v("dropdownBackground","Dropdown background.")),w$=z("dropdown.foreground",{dark:"#F0F0F0",light:null,hc:X.white},v("dropdownForeground","Dropdown foreground.")),sNe=z("button.foreground",{dark:X.white,light:X.white,hc:X.white},v("buttonForeground","Button foreground color.")),gF=z("button.background",{dark:"#0E639C",light:"#007ACC",hc:null},v("buttonBackground","Button background color.")),oNe=z("button.hoverBackground",{dark:Tee(gF,.2),light:Iee(gF,.2),hc:null},v("buttonHoverBackground","Button background color when hovering.")),uv=z("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hc:X.black},v("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),dv=z("badge.foreground",{dark:X.white,light:"#333",hc:X.white},v("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),wy=z("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hc:null},v("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),fv=z("scrollbarSlider.background",{dark:X.fromHex("#797979").transparent(.4),light:X.fromHex("#646464").transparent(.4),hc:Jt(Ki,.6)},v("scrollbarSliderBackground","Scrollbar slider background color.")),gv=z("scrollbarSlider.hoverBackground",{dark:X.fromHex("#646464").transparent(.7),light:X.fromHex("#646464").transparent(.7),hc:Jt(Ki,.8)},v("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),pv=z("scrollbarSlider.activeBackground",{dark:X.fromHex("#BFBFBF").transparent(.4),light:X.fromHex("#000000").transparent(.6),hc:Ki},v("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),aNe=z("progressBar.background",{dark:X.fromHex("#0E70C0"),light:X.fromHex("#0E70C0"),hc:Ki},v("progressBarBackground","Background color of the progress bar that can show for long running operations.")),lNe=z("editorError.background",{dark:null,light:null,hc:null},v("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),mv=z("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hc:null},v("editorError.foreground","Foreground color of error squigglies in the editor.")),xee=z("editorError.border",{dark:null,light:null,hc:X.fromHex("#E47777").transparent(.8)},v("errorBorder","Border color of error boxes in the editor.")),cNe=z("editorWarning.background",{dark:null,light:null,hc:null},v("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),gh=z("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hc:null},v("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),xL=z("editorWarning.border",{dark:null,light:null,hc:X.fromHex("#FFCC00").transparent(.8)},v("warningBorder","Border color of warning boxes in the editor.")),hNe=z("editorInfo.background",{dark:null,light:null,hc:null},v("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),Ba=z("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hc:"#3794FF"},v("editorInfo.foreground","Foreground color of info squigglies in the editor.")),I5=z("editorInfo.border",{dark:null,light:null,hc:X.fromHex("#3794FF").transparent(.8)},v("infoBorder","Border color of info boxes in the editor.")),uNe=z("editorHint.foreground",{dark:X.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hc:null},v("editorHint.foreground","Foreground color of hint squigglies in the editor.")),dNe=z("editorHint.border",{dark:null,light:null,hc:X.fromHex("#eeeeee").transparent(.8)},v("hintBorder","Border color of hint boxes in the editor.")),lo=z("editor.background",{light:"#fffffe",dark:"#1E1E1E",hc:X.black},v("editorBackground","Editor background color.")),ku=z("editor.foreground",{light:"#333333",dark:"#BBBBBB",hc:X.white},v("editorForeground","Editor default foreground color.")),ta=z("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hc:"#0C141F"},v("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),Lu=z("editorWidget.foreground",{dark:Oe,light:Oe,hc:Oe},v("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),Af=z("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hc:Ki},v("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),fNe=z("editorWidget.resizeBorder",{light:null,dark:null,hc:null},v("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),y$=z("quickInput.background",{dark:ta,light:ta,hc:ta},v("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),gNe=z("quickInput.foreground",{dark:Lu,light:Lu,hc:Lu},v("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),pNe=z("quickInputTitle.background",{dark:new X(new ht(255,255,255,.105)),light:new X(new ht(0,0,0,.06)),hc:"#000000"},v("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),mNe=z("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hc:X.white},v("pickerGroupForeground","Quick picker color for grouping labels.")),_Ne=z("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hc:X.white},v("pickerGroupBorder","Quick picker color for grouping borders.")),bNe=z("keybindingLabel.background",{dark:new X(new ht(128,128,128,.17)),light:new X(new ht(221,221,221,.4)),hc:X.transparent},v("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),vNe=z("keybindingLabel.foreground",{dark:X.fromHex("#CCCCCC"),light:X.fromHex("#555555"),hc:X.white},v("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),wNe=z("keybindingLabel.border",{dark:new X(new ht(51,51,51,.6)),light:new X(new ht(204,204,204,.4)),hc:new X(new ht(111,195,223))},v("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),yNe=z("keybindingLabel.bottomBorder",{dark:new X(new ht(68,68,68,.6)),light:new X(new ht(187,187,187,.4)),hc:new X(new ht(111,195,223))},v("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),Iu=z("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hc:"#f3f518"},v("editorSelectionBackground","Color of the editor selection.")),CNe=z("editor.selectionForeground",{light:null,dark:null,hc:"#000000"},v("editorSelectionForeground","Color of the selected text for high contrast.")),T5=z("editor.inactiveSelectionBackground",{light:Jt(Iu,.5),dark:Jt(Iu,.5),hc:Jt(Iu,.5)},v("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),Eee=z("editor.selectionHighlightBackground",{light:x$(Iu,lo,.3,.6),dark:x$(Iu,lo,.3,.6),hc:null},v("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);z("editor.selectionHighlightBorder",{light:null,dark:null,hc:Ur},v("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));const SNe=z("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hc:null},v("editorFindMatch","Color of the current search match.")),pF=z("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hc:null},v("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),xNe=z("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hc:null},v("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),ENe=z("editor.findMatchBorder",{light:null,dark:null,hc:Ur},v("editorFindMatchBorder","Border color of the current search match.")),DNe=z("editor.findMatchHighlightBorder",{light:null,dark:null,hc:Ur},v("findMatchHighlightBorder","Border color of the other search matches.")),kNe=z("editor.findRangeHighlightBorder",{dark:null,light:null,hc:Jt(Ur,.4)},v("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),LNe=z("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hc:"#ADD6FF26"},v("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),Iw=z("editorHoverWidget.background",{light:ta,dark:ta,hc:ta},v("hoverBackground","Background color of the editor hover.")),INe=z("editorHoverWidget.foreground",{light:Lu,dark:Lu,hc:Lu},v("hoverForeground","Foreground color of the editor hover.")),TNe=z("editorHoverWidget.border",{light:Af,dark:Af,hc:Af},v("hoverBorder","Border color of the editor hover.")),ANe=z("editorHoverWidget.statusBarBackground",{dark:Tee(Iw,.2),light:Iee(Iw,.05),hc:ta},v("statusBarBackground","Background color of the editor hover status bar.")),NNe=z("editorLink.activeForeground",{dark:"#4E94CE",light:X.blue,hc:X.cyan},v("activeLinkForeground","Color of active links.")),Mm=z("editorInlayHint.foreground",{dark:Jt(dv,.8),light:Jt(dv,.8),hc:dv},v("editorInlayHintForeground","Foreground color of inline hints")),Fm=z("editorInlayHint.background",{dark:Jt(uv,.6),light:Jt(uv,.3),hc:uv},v("editorInlayHintBackground","Background color of inline hints"));z("editorInlayHint.typeForeground",{dark:Mm,light:Mm,hc:Mm},v("editorInlayHintForegroundTypes","Foreground color of inline hints for types"));z("editorInlayHint.typeBackground",{dark:Fm,light:Fm,hc:Fm},v("editorInlayHintBackgroundTypes","Background color of inline hints for types"));z("editorInlayHint.parameterForeground",{dark:Mm,light:Mm,hc:Mm},v("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters"));z("editorInlayHint.parameterBackground",{dark:Fm,light:Fm,hc:Fm},v("editorInlayHintBackgroundParameter","Background color of inline hints for parameters"));const RNe=z("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hc:"#FFCC00"},v("editorLightBulbForeground","The color used for the lightbulb actions icon.")),MNe=z("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},v("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),mF=new X(new ht(155,185,85,.2)),_F=new X(new ht(255,0,0,.2)),Dee=z("diffEditor.insertedTextBackground",{dark:mF,light:mF,hc:null},v("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),kee=z("diffEditor.removedTextBackground",{dark:_F,light:_F,hc:null},v("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),FNe=z("diffEditor.insertedTextBorder",{dark:null,light:null,hc:"#33ff2eff"},v("diffEditorInsertedOutline","Outline color for the text that got inserted.")),ONe=z("diffEditor.removedTextBorder",{dark:null,light:null,hc:"#FF008F"},v("diffEditorRemovedOutline","Outline color for text that got removed.")),PNe=z("diffEditor.border",{dark:null,light:null,hc:Ki},v("diffEditorBorder","Border color between the two text editors.")),BNe=z("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hc:null},v("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),VNe=z("list.focusBackground",{dark:null,light:null,hc:null},v("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),WNe=z("list.focusForeground",{dark:null,light:null,hc:null},v("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),$Ne=z("list.focusOutline",{dark:Yu,light:Yu,hc:Ur},v("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Tu=z("list.activeSelectionBackground",{dark:"#094771",light:"#0060C0",hc:null},v("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Au=z("list.activeSelectionForeground",{dark:X.white,light:X.white,hc:null},v("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),HS=z("list.activeSelectionIconForeground",{dark:null,light:null,hc:null},v("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),zNe=z("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hc:null},v("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),HNe=z("list.inactiveSelectionForeground",{dark:null,light:null,hc:null},v("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),UNe=z("list.inactiveSelectionIconForeground",{dark:null,light:null,hc:null},v("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),jNe=z("list.inactiveFocusBackground",{dark:null,light:null,hc:null},v("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),qNe=z("list.inactiveFocusOutline",{dark:null,light:null,hc:null},v("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),GNe=z("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hc:null},v("listHoverBackground","List/Tree background when hovering over items using the mouse.")),KNe=z("list.hoverForeground",{dark:null,light:null,hc:null},v("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),ZNe=z("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hc:null},v("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),Om=z("list.highlightForeground",{dark:"#18A3FF",light:"#0066BF",hc:Yu},v("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),OT=z("list.focusHighlightForeground",{dark:Om,light:DRe(Tu,Om,"#9DDDFF"),hc:Om},v("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree.")),YNe=z("listFilterWidget.background",{light:"#efc1ad",dark:"#653723",hc:X.black},v("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),XNe=z("listFilterWidget.outline",{dark:X.transparent,light:X.transparent,hc:"#f38518"},v("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),QNe=z("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hc:Ki},v("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),JNe=z("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hc:"#a9a9a9"},v("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),eRe=z("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hc:null},v("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),C$=z("quickInput.list.focusBackground",{dark:null,light:null,hc:null},"",void 0,v("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),US=z("quickInputList.focusForeground",{dark:Au,light:Au,hc:Au},v("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),jS=z("quickInputList.focusIconForeground",{dark:HS,light:HS,hc:HS},v("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),qS=z("quickInputList.focusBackground",{dark:Tw(C$,Tu),light:Tw(C$,Tu),hc:null},v("quickInput.listFocusBackground","Quick picker background color for the focused item.")),tRe=z("menu.border",{dark:null,light:null,hc:Ki},v("menuBorder","Border color of menus.")),iRe=z("menu.foreground",{dark:w$,light:Oe,hc:w$},v("menuForeground","Foreground color of menu items.")),nRe=z("menu.background",{dark:FT,light:FT,hc:FT},v("menuBackground","Background color of menu items.")),rRe=z("menu.selectionForeground",{dark:Au,light:Au,hc:Au},v("menuSelectionForeground","Foreground color of the selected menu item in menus.")),sRe=z("menu.selectionBackground",{dark:Tu,light:Tu,hc:Tu},v("menuSelectionBackground","Background color of the selected menu item in menus.")),oRe=z("menu.selectionBorder",{dark:null,light:null,hc:Ur},v("menuSelectionBorder","Border color of the selected menu item in menus.")),aRe=z("menu.separatorBackground",{dark:"#BBBBBB",light:"#888888",hc:Ki},v("menuSeparatorBackground","Color of a separator menu item in menus.")),lRe=z("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hc:null},v("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse")),cRe=z("editor.snippetTabstopHighlightBackground",{dark:new X(new ht(124,124,124,.3)),light:new X(new ht(10,50,100,.2)),hc:new X(new ht(124,124,124,.3))},v("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),hRe=z("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hc:null},v("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),uRe=z("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hc:null},v("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),dRe=z("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new X(new ht(10,50,100,.5)),hc:"#525252"},v("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),A5=z("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hc:"#AB5A00"},v("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),fRe=z("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},v("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Lee=z("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hc:"#AB5A00"},v("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),gRe=z("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hc:"#ffffff"},v("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),S$=z("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hc:"#ffffff"},v("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),pRe=z("minimap.errorHighlight",{dark:new X(new ht(255,18,18,.7)),light:new X(new ht(255,18,18,.7)),hc:new X(new ht(255,50,50,1))},v("minimapError","Minimap marker color for errors.")),mRe=z("minimap.warningHighlight",{dark:gh,light:gh,hc:xL},v("overviewRuleWarning","Minimap marker color for warnings.")),_Re=z("minimap.background",{dark:null,light:null,hc:null},v("minimapBackground","Minimap background color.")),bRe=z("minimap.foregroundOpacity",{dark:X.fromHex("#000f"),light:X.fromHex("#000f"),hc:X.fromHex("#000f")},v("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),vRe=z("minimapSlider.background",{light:Jt(fv,.5),dark:Jt(fv,.5),hc:Jt(fv,.5)},v("minimapSliderBackground","Minimap slider background color.")),wRe=z("minimapSlider.hoverBackground",{light:Jt(gv,.5),dark:Jt(gv,.5),hc:Jt(gv,.5)},v("minimapSliderHoverBackground","Minimap slider background color when hovering.")),yRe=z("minimapSlider.activeBackground",{light:Jt(pv,.5),dark:Jt(pv,.5),hc:Jt(pv,.5)},v("minimapSliderActiveBackground","Minimap slider background color when clicked on.")),CRe=z("problemsErrorIcon.foreground",{dark:mv,light:mv,hc:mv},v("problemsErrorIconForeground","The color used for the problems error icon.")),SRe=z("problemsWarningIcon.foreground",{dark:gh,light:gh,hc:gh},v("problemsWarningIconForeground","The color used for the problems warning icon.")),xRe=z("problemsInfoIcon.foreground",{dark:Ba,light:Ba,hc:Ba},v("problemsInfoIconForeground","The color used for the problems info icon."));function ERe(n,e){var t,i,r;switch(n.op){case 0:return(t=Pc(n.value,e))===null||t===void 0?void 0:t.darken(n.factor);case 1:return(i=Pc(n.value,e))===null||i===void 0?void 0:i.lighten(n.factor);case 2:return(r=Pc(n.value,e))===null||r===void 0?void 0:r.transparent(n.factor);case 3:for(const a of n.values){const l=Pc(a,e);if(l)return l}return;case 5:return Pc(e.defines(n.if)?n.then:n.else,e);case 4:const s=Pc(n.value,e);if(!s)return;const o=Pc(n.background,e);return o?s.isDarkerThan(o)?X.getLighterColor(s,o,n.factor).transparent(n.transparency):X.getDarkerColor(s,o,n.factor).transparent(n.transparency):s.transparent(n.factor*n.transparency);default:throw lLe()}}function Iee(n,e){return{op:0,value:n,factor:e}}function Tee(n,e){return{op:1,value:n,factor:e}}function Jt(n,e){return{op:2,value:n,factor:e}}function Tw(...n){return{op:3,values:n}}function DRe(n,e,t){return{op:5,if:n,then:e,else:t}}function x$(n,e,t,i){return{op:4,value:n,background:e,factor:t,transparency:i}}function Pc(n,e){if(n!==null){if(typeof n=="string")return n[0]==="#"?X.fromHex(n):e.getColor(n);if(n instanceof X)return n;if(typeof n=="object")return ERe(n,e)}}const Aee="vscode://schemas/workbench-colors";let Nee=Bn.as(nL.JSONContribution);Nee.registerSchema(Aee,yL.getColorSchema());const E$=new yi(()=>Nee.notifySchemaChanged(Aee),200);yL.onDidChangeSchema(()=>{E$.isScheduled()||E$.schedule()});const kRe=z("editor.lineHighlightBackground",{dark:null,light:null,hc:null},v("lineHighlight","Background color for the highlight of line at the cursor position.")),D$=z("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hc:"#f38518"},v("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),LRe=z("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hc:null},v("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),IRe=z("editor.rangeHighlightBorder",{dark:null,light:null,hc:Ur},v("rangeHighlightBorder","Background color of the border around highlighted ranges."),!0),TRe=z("editor.symbolHighlightBackground",{dark:pF,light:pF,hc:null},v("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),ARe=z("editor.symbolHighlightBorder",{dark:null,light:null,hc:Ur},v("symbolHighlightBorder","Background color of the border around highlighted symbols."),!0),Ree=z("editorCursor.foreground",{dark:"#AEAFAD",light:X.black,hc:X.white},v("caret","Color of the editor cursor.")),NRe=z("editorCursor.background",null,v("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),Nf=z("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hc:"#e3e4e229"},v("editorWhitespaces","Color of whitespace characters in the editor.")),EL=z("editorIndentGuide.background",{dark:Nf,light:Nf,hc:Nf},v("editorIndentGuides","Color of the editor indentation guides.")),DL=z("editorIndentGuide.activeBackground",{dark:Nf,light:Nf,hc:Nf},v("editorActiveIndentGuide","Color of the active editor indentation guides.")),Mee=z("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hc:X.white},v("editorLineNumbers","Color of editor line numbers.")),PT=z("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hc:Ur},v("editorActiveLineNumber","Color of editor active line number"),!1,v("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),RRe=z("editorLineNumber.activeForeground",{dark:PT,light:PT,hc:PT},v("editorActiveLineNumber","Color of editor active line number")),MRe=z("editorRuler.foreground",{dark:"#5A5A5A",light:X.lightgrey,hc:X.white},v("editorRuler","Color of the editor rulers."));z("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hc:"#999999"},v("editorCodeLensForeground","Foreground color of editor CodeLens"));const FRe=z("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hc:"#0064001a"},v("editorBracketMatchBackground","Background color behind matching brackets")),ORe=z("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hc:Ki},v("editorBracketMatchBorder","Color for matching brackets boxes")),PRe=z("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hc:"#7f7f7f4d"},v("editorOverviewRulerBorder","Color of the overview ruler border.")),BRe=z("editorOverviewRuler.background",null,v("editorOverviewRulerBackground","Background color of the editor overview ruler. Only used when the minimap is enabled and placed on the right side of the editor.")),VRe=z("editorGutter.background",{dark:lo,light:lo,hc:lo},v("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),WRe=z("editorUnnecessaryCode.border",{dark:null,light:null,hc:X.fromHex("#fff").transparent(.8)},v("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),$Re=z("editorUnnecessaryCode.opacity",{dark:X.fromHex("#000a"),light:X.fromHex("#0007"),hc:null},v("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`)),Fee=z("editorGhostText.border",{dark:null,light:null,hc:X.fromHex("#fff").transparent(.8)},v("editorGhostTextBorder","Border color of ghost text in the editor.")),Oee=z("editorGhostText.foreground",{dark:X.fromHex("#ffffff56"),light:X.fromHex("#0007"),hc:null},v("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),BT=new X(new ht(0,122,204,.6));z("editorOverviewRuler.rangeHighlightForeground",{dark:BT,light:BT,hc:BT},v("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const zRe=z("editorOverviewRuler.errorForeground",{dark:new X(new ht(255,18,18,.7)),light:new X(new ht(255,18,18,.7)),hc:new X(new ht(255,50,50,1))},v("overviewRuleError","Overview ruler marker color for errors.")),HRe=z("editorOverviewRuler.warningForeground",{dark:gh,light:gh,hc:xL},v("overviewRuleWarning","Overview ruler marker color for warnings.")),URe=z("editorOverviewRuler.infoForeground",{dark:Ba,light:Ba,hc:I5},v("overviewRuleInfo","Overview ruler marker color for infos.")),Pee=z("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hc:"#FFD700"},v("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),Bee=z("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hc:"#DA70D6"},v("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),Vee=z("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hc:"#87CEFA"},v("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),Wee=z("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),$ee=z("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),zee=z("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),jRe=z("editorBracketHighlight.unexpectedBracket.foreground",{dark:new X(new ht(255,18,18,.8)),light:new X(new ht(255,18,18,.8)),hc:new X(new ht(255,50,50,1))},v("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),qRe=z("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),GRe=z("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),KRe=z("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),ZRe=z("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),YRe=z("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),XRe=z("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),QRe=z("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),JRe=z("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),eMe=z("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),tMe=z("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),iMe=z("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),nMe=z("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},v("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));li((n,e)=>{const t=n.getColor(lo);t&&e.addRule(`.monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: ${t}; }`);const i=n.getColor(ku);i&&e.addRule(`.monaco-editor, .monaco-editor .inputarea.ime-input { color: ${i}; }`);const r=n.getColor(VRe);r&&e.addRule(`.monaco-editor .margin { background-color: ${r}; }`);const s=n.getColor(LRe);s&&e.addRule(`.monaco-editor .rangeHighlight { background-color: ${s}; }`);const o=n.getColor(IRe);o&&e.addRule(`.monaco-editor .rangeHighlight { border: 1px ${n.type==="hc"?"dotted":"solid"} ${o}; }`);const a=n.getColor(TRe);a&&e.addRule(`.monaco-editor .symbolHighlight { background-color: ${a}; }`);const l=n.getColor(ARe);l&&e.addRule(`.monaco-editor .symbolHighlight { border: 1px ${n.type==="hc"?"dotted":"solid"} ${l}; }`);const c=n.getColor(Nf);c&&(e.addRule(`.monaco-editor .mtkw { color: ${c} !important; }`),e.addRule(`.monaco-editor .mtkz { color: ${c} !important; }`))});class rMe extends re{constructor(e){super(),this.textModel=e,this.colorProvider=new Hee,this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.onDidChangeOptions(t=>{this.colorizationOptions=e.getOptions().bracketPairColorizationOptions})),this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}getDecorationsInRange(e,t,i){if(t===void 0)return[];if(!this.colorizationOptions.enabled)return[];const r=new Array,s=this.textModel.bracketPairs.getBracketsInRange(e);for(const o of s)r.push({id:`bracket${o.range.toString()}-${o.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(o)},ownerId:0,range:o.range});return r}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new V(1,1,this.textModel.getLineCount(),1),e,t):[]}}class Hee{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}li((n,e)=>{const t=[Pee,Bee,Vee,Wee,$ee,zee],i=new Hee;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${n.getColor(jRe)}; }`);let r=t.map(s=>n.getColor(s)).filter(s=>!!s).filter(s=>!s.isTransparent());for(let s=0;s<30;s++){const o=r[s%r.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(s)} { color: ${o}; }`)}});var sMe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},VT=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};function oMe(){return new yAe}function aMe(n){const e=oMe();return e.acceptChunk(n),e.finish()}function k$(n,e){return(typeof n=="string"?aMe(n):n).create(e)}let EC=0;const lMe=999,cMe=1e4;class hMe{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,i=0;do{let r=this._source.read();if(r===null)return this._eos=!0,t===0?null:e.join("");if(r.length>0&&(e[t++]=r,i+=r.length),i>=64*1024)return e.join("")}while(!0)}}const X0=()=>{throw new Error("Invalid change accessor")};class Kc{constructor(){this._searchCanceledBrand=void 0}}Kc.INSTANCE=new Kc;function DC(n){return n instanceof Kc?null:n}let fo=class yl extends re{constructor(e,t,i,r=null,s,o,a){super(),this._undoRedoService=s,this._modeService=o,this._languageConfigurationService=a,this._onWillDispose=this._register(new H),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new gMe(d=>this.handleBeforeFireDecorationsChangedEvent(d))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeLanguage=this._register(new H),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new H),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new H),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidChangeOptions=this._register(new H),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new H),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeContentOrInjectedText=this._register(new H),this.onDidChangeContentOrInjectedText=this._onDidChangeContentOrInjectedText.event,this._eventEmitter=this._register(new pMe),this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new H),this.onBackgroundTokenizationStateChanged=this._onBackgroundTokenizationStateChanged.event,this._register(this._eventEmitter.fastEvent(d=>{this._onDidChangeContentOrInjectedText.fire(d.rawContentChangedEvent)})),EC++,this.id="$model"+EC,this.isForSimpleWidget=t.isForSimpleWidget,typeof r>"u"||r===null?this._associatedResource=qe.parse("inmemory://model/"+EC):this._associatedResource=r,this._attachedEditorCount=0;const{textBuffer:l,disposable:c}=k$(e,t.defaultEOL);this._buffer=l,this._bufferDisposable=c,this._options=yl.resolveOptions(this._buffer,t);const h=this._buffer.getLineCount(),u=this._buffer.getValueLengthInRange(new V(1,1,h,this._buffer.getLineLength(h)+1),0);t.largeFileOptimizations?this._isTooLargeForTokenization=u>yl.LARGE_FILE_SIZE_THRESHOLD||h>yl.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=u>yl.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this._isDisposing=!1,this._languageId=i||qu,this._languageRegistryListener=this._languageConfigurationService.onDidChange(d=>{d.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}),this._instanceId=OQ(EC),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new L$,this._commandManager=new _5(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._tokens=new qs(this._modeService.languageIdCodec),this._tokens2=new C5(this._modeService.languageIdCodec),this._tokenization=new kAe(this,this._modeService.languageIdCodec),this._bracketPairColorizer=this._register(new JAe(this,this._languageConfigurationService)),this._decorationProvider=this._register(new rMe(this)),this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()}))}static resolveOptions(e,t){if(t.detectIndentation){const i=r$(e,t.tabSize,t.insertSpaces);return new OS({tabSize:i.tabSize,indentSize:i.tabSize,insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new OS({tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}onDidChangeContentFast(e){return this._eventEmitter.fastEvent(t=>e(t.contentChangedEvent))}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}get bracketPairs(){return this._bracketPairColorizer}get backgroundTokenizationState(){return this._backgroundTokenizationState}handleTokenizationProgress(e){if(this._backgroundTokenizationState===2)return;const t=e?2:1;this._backgroundTokenizationState!==t&&(this._backgroundTokenizationState=t,this._onBackgroundTokenizationStateChanged.fire())}dispose(){this._isDisposing=!0,this._onWillDispose.fire(),this._languageRegistryListener.dispose(),this._tokenization.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this._isDisposing=!1;const e=new Rm([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this._bracketPairColorizer.handleContentChanged(t),!this._isDisposing&&this._eventEmitter.fire(new YE(e,t))}setValue(e){if(this._assertNotDisposed(),e===null)return;const{textBuffer:t,disposable:i}=k$(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,r,s,o,a){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:r}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:s,isRedoing:o,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),o=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._tokens.flush(),this._tokens2.flush(),this._decorations=Object.create(null),this._decorationsTree=new L$,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new If([new CAe],this._versionId,!1,!1),this._createContentChanged2(new V(1,1,s,o),0,r,this.getValue(),!1,!1,!0))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),r=this.getValueLengthInRange(i),s=this.getLineCount(),o=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new If([new EAe],this._versionId,!1,!1),this._createContentChanged2(new V(1,1,s,o),0,r,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,r=t.length;i<r;i++){const s=t[i],o=s.range,a=s.cachedAbsoluteStart-s.start,l=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);s.cachedAbsoluteStart=l,s.cachedAbsoluteEnd=c,s.cachedVersionId=e,s.start=l-a,s.end=c-a,Zu(s)}}onBeforeAttached(){this._attachedEditorCount++,this._attachedEditorCount===1&&this._onDidChangeAttached.fire(void 0)}onBeforeDetached(){this._attachedEditorCount--,this._attachedEditorCount===0&&this._onDidChangeAttached.fire(void 0)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let r=1;r<=i;r++){const s=this._buffer.getLineLength(r);s>=cMe?t+=s:e+=s}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();let t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.indentSize,r=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,s=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new OS({tabSize:t,indentSize:i,insertSpaces:r,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:o});if(this._options.equals(a))return;let l=this._options.createChangeEvent(a);this._options=a,this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();let i=r$(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}static _normalizeIndentationFromWhitespace(e,t,i){let r=0;for(let o=0;o<e.length;o++)e.charAt(o)==="	"?r+=t:r++;let s="";if(!i){let o=Math.floor(r/t);r=r%t;for(let a=0;a<o;a++)s+="	"}for(let o=0;o<r;o++)s+=" ";return s}static normalizeIndentation(e,t,i){let r=cs(e);return r===-1&&(r=e.length),yl._normalizeIndentationFromWhitespace(e.substring(0,r),t,i)+e.substring(r)}normalizeIndentation(e){return this._assertNotDisposed(),yl.normalizeIndentation(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(MQ.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();let t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();let t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),r=this.getValueInRange(i,e);return t?this._buffer.getBOM()+r:r}createSnapshot(e=!1){return new hMe(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),r=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+r:r}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,r=e.startColumn;let s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),o=Math.floor(typeof r=="number"&&!isNaN(r)?r:1);if(s<1)s=1,o=1;else if(s>t)s=t,o=this.getLineMaxColumn(s);else if(o<=1)o=1;else{const u=this.getLineMaxColumn(s);o>=u&&(o=u)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),h=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,h=1;else if(c>t)c=t,h=this.getLineMaxColumn(c);else if(h<=1)h=1;else{const u=this.getLineMaxColumn(c);h>=u&&(h=u)}return i===s&&r===o&&a===c&&l===h&&e instanceof V&&!(e instanceof je)?e:new V(s,o,c,h)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const r=this._buffer.getLineCount();if(e>r)return!1;if(t===1)return!0;const s=this.getLineMaxColumn(e);if(t>s)return!1;if(i===1){const o=this._buffer.getLineCharCode(e,t-2);if(Ln(o))return!1}return!0}_validatePosition(e,t,i){const r=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),s=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),o=this._buffer.getLineCount();if(r<1)return new G(1,1);if(r>o)return new G(o,this.getLineMaxColumn(o));if(s<=1)return new G(r,1);const a=this.getLineMaxColumn(r);if(s>=a)return new G(r,a);if(i===1){const l=this._buffer.getLineCharCode(r,s-2);if(Ln(l))return new G(r,s-1)}return new G(r,s)}validatePosition(e){return this._assertNotDisposed(),e instanceof G&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(i,r,0)||!this._isValidPosition(s,o,0))return!1;if(t===1){const a=r>1?this._buffer.getLineCharCode(i,r-2):0,l=o>1&&o<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,o-2):0,c=Ln(a),h=Ln(l);return!c&&!h}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof V&&!(e instanceof je)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),r=this._validatePosition(e.endLineNumber,e.endColumn,0),s=i.lineNumber,o=i.column,a=r.lineNumber,l=r.column;{const c=o>1?this._buffer.getLineCharCode(s,o-2):0,h=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,u=Ln(c),d=Ln(h);return!u&&!d?new V(s,o,a,l):s===a&&o===l?new V(s,o-1,a,l-1):u&&d?new V(s,o-1,a,l+1):u?new V(s,o-1,a,l):new V(s,o,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();let i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new V(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,r){return this._buffer.findMatchesLineByLine(e,t,i,r)}findMatches(e,t,i,r,s,o,a=lMe){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(u=>V.isIRange(u))&&(l=t.map(u=>this.validateRange(u)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((u,d)=>u.startLineNumber-d.startLineNumber||u.startColumn-d.startColumn);const c=[];c.push(l.reduce((u,d)=>V.areIntersecting(u,d)?u.plusRange(d):(c.push(u),d)));let h;if(!i&&e.indexOf(`
`)<0){const d=new Fd(e,i,r,s).parseSearchRequest();if(!d)return[];h=f=>this.findMatchesLineByLine(f,d,o,a)}else h=u=>CC.findMatches(this,new Fd(e,i,r,s),u,o,a);return c.map(h).reduce((u,d)=>u.concat(d),[])}findNextMatch(e,t,i,r,s,o){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Fd(e,i,r,s).parseSearchRequest();if(!c)return null;const h=this.getLineCount();let u=new V(a.lineNumber,a.column,h,this.getLineMaxColumn(h)),d=this.findMatchesLineByLine(u,c,o,1);return CC.findNextMatch(this,new Fd(e,i,r,s),a,o),d.length>0||(u=new V(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),d=this.findMatchesLineByLine(u,c,o,1),d.length>0)?d[0]:null}return CC.findNextMatch(this,new Fd(e,i,r,s),a,o)}findPreviousMatch(e,t,i,r,s,o){this._assertNotDisposed();const a=this.validatePosition(t);return CC.findPreviousMatch(this,new Fd(e,i,r,s),a,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof lT?e:new lT(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,r=e.length;i<r;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let r=t.map(o=>({range:this.validateRange(o.range),text:o.text})),s=!0;if(e)for(let o=0,a=e.length;o<a;o++){let l=e[o],c=!1;for(let h=0,u=r.length;h<u;h++){let d=r[h].range,f=d.startLineNumber>l.endLineNumber,g=l.startLineNumber>d.endLineNumber;if(!f&&!g){c=!0;break}}if(!c){s=!1;break}}if(s)for(let o=0,a=this._trimAutoWhitespaceLines.length;o<a;o++){let l=this._trimAutoWhitespaceLines[o],c=this.getLineMaxColumn(l),h=!0;for(let u=0,d=r.length;u<d;u++){let f=r[u].range,g=r[u].text;if(!(l<f.startLineNumber||l>f.endLineNumber)&&!(l===f.startLineNumber&&f.startColumn===c&&f.isEmpty()&&g&&g.length>0&&g.charAt(0)===`
`)&&!(l===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&g&&g.length>0&&g.charAt(g.length-1)===`
`)){h=!1;break}}if(h){const u=new V(l,1,l,c);t.push(new lT(null,u,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i)}_applyUndo(e,t,i,r){const s=e.map(o=>{const a=this.getPositionAt(o.newPosition),l=this.getPositionAt(o.newEnd);return{range:new V(a.lineNumber,a.column,l.lineNumber,l.column),text:o.oldText}});this._applyUndoRedoEdits(s,t,!0,!1,i,r)}_applyRedo(e,t,i,r){const s=e.map(o=>{const a=this.getPositionAt(o.oldPosition),l=this.getPositionAt(o.oldEnd);return{range:new V(a.lineNumber,a.column,l.lineNumber,l.column),text:o.newText}});this._applyUndoRedoEdits(s,t,!1,!0,i,r)}_applyUndoRedoEdits(e,t,i,r,s,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=r,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),r=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),s=this._buffer.getLineCount(),o=r.changes;if(this._trimAutoWhitespaceLines=r.trimAutoWhitespaceLineNumbers,o.length!==0){for(let c=0,h=o.length;c<h;c++){const u=o[c],[d,f,g]=L_(u.text);this._tokens.acceptEdit(u.range,d,f),this._tokens2.acceptEdit(u.range,d,f,g,u.text.length>0?u.text.charCodeAt(0):0),this._decorationsTree.acceptReplace(u.rangeOffset,u.rangeLength,u.text.length,u.forceMoveMarkers)}let a=[];this._increaseVersionId();let l=i;for(let c=0,h=o.length;c<h;c++){const u=o[c],[d]=L_(u.text);this._onDidChangeDecorations.fire();const f=u.range.startLineNumber,g=u.range.endLineNumber,p=g-f,m=d,b=Math.min(p,m),_=m-p,w=s-l-_+f,y=w,S=w+m,k=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new G(y,1)),this.getOffsetAt(new G(S,this.getLineMaxColumn(S))),0),C=Za.fromDecorations(k),D=new tv(C);for(let E=b;E>=0;E--){const N=f+E,T=w+E;D.takeFromEndWhile(q=>q.lineNumber>T);const j=D.takeFromEndWhile(q=>q.lineNumber===T);a.push(new g$(N,this.getLineContent(T),j))}if(b<p){const E=f+b;a.push(new SAe(E+1,g))}if(b<m){const E=new tv(C),N=f+b,T=m-b,j=s-l-T+N+1;let q=[],ie=[];for(let ge=0;ge<T;ge++){let be=j+ge;ie[ge]=this.getLineContent(be),E.takeWhile(Se=>Se.lineNumber<be),q[ge]=E.takeWhile(Se=>Se.lineNumber===be)}a.push(new xAe(N+1,f+m,ie,q))}l+=_}this._emitContentChangedEvent(new If(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:o,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return r.reverseEdits===null?void 0:r.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=[...e].map(r=>new g$(r,this.getLineContent(r),this._getInjectedTextInLine(r)));this._onDidChangeContentOrInjectedText.fire(new cee(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){let i={addDecoration:(s,o)=>this._deltaDecorationsImpl(e,[],[{range:s,options:o}])[0],changeDecoration:(s,o)=>{this._changeDecorationImpl(s,o)},changeDecorationOptions:(s,o)=>{this._changeDecorationOptionsImpl(s,T$(o))},removeDecoration:s=>{this._deltaDecorationsImpl(e,[s],[])},deltaDecorations:(s,o)=>s.length===0&&o.length===0?[]:this._deltaDecorationsImpl(e,s,o)},r=null;try{r=t(i)}catch(s){it(s)}return i.addDecoration=X0,i.changeDecoration=X0,i.changeDecorationOptions=X0,i.removeDecoration=X0,i.deltaDecorations=X0,r}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const r=e?this._decorations[e]:null;if(!r)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:I$[i]}])[0]:null;if(!t)return this._decorationsTree.delete(r),delete this._decorations[r.id],null;const s=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),a=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(r),r.reset(this.getVersionId(),o,a,s),r.setOptions(I$[i]),this._decorationsTree.insert(r),r.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,r=t.length;i<r;i++){const s=t[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,r=!1){let s=this.getLineCount(),o=Math.min(s,Math.max(1,e)),a=Math.min(s,Math.max(1,t)),l=this.getLineMaxColumn(a);const c=new V(o,1,a,l),h=this._getDecorationsInRange(c,i,r);return h.push(...this._decorationProvider.getDecorationsInRange(c,i,r)),h}getDecorationsInRange(e,t=0,i=!1){let r=this.validateRange(e);const s=this._getDecorationsInRange(r,t,i);return s.push(...this._decorationProvider.getDecorationsInRange(r,t,i)),s}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),r=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return Za.fromDecorations(r).filter(s=>s.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}_getDecorationsInRange(e,t,i){const r=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),s=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,r,s,t,i)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const r=this._validateRangeRelaxedNoAllocations(t),s=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),o=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,o,r),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(r.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const r=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const o=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber)}if(i.options.before||t.before){const o=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber)}r!==s?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i){const r=this.getVersionId(),s=t.length;let o=0;const a=i.length;let l=0,c=new Array(a);for(;o<s||l<a;){let h=null;if(o<s){do h=this._decorations[t[o++]];while(!h&&o<s);if(h){if(h.options.after){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.endLineNumber)}if(h.options.before){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.startLineNumber)}this._decorationsTree.delete(h),this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(l<a){if(!h){const m=++this._lastDecorationId,b=`${this._instanceId};${m}`;h=new see(b,0,0),this._decorations[b]=h}const u=i[l],d=this._validateRangeRelaxedNoAllocations(u.range),f=T$(u.options),g=this._buffer.getOffsetAt(d.startLineNumber,d.startColumn),p=this._buffer.getOffsetAt(d.endLineNumber,d.endColumn);h.ownerId=e,h.reset(r,g,p,d),h.setOptions(f),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(d.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(h),c[l]=h.id,l++}else h&&delete this._decorations[h.id]}return c}setTokens(e,t=!1){if(e.length!==0){let i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];let a=0,l=0,c=!1;for(let h=0,u=o.tokens.length;h<u;h++){const d=o.startLineNumber+h;c?(this._tokens.setTokens(this._languageId,d-1,this._buffer.getLineLength(d),o.tokens[h],!1),l=d):this._tokens.setTokens(this._languageId,d-1,this._buffer.getLineLength(d),o.tokens[h],!0)&&(c=!0,a=d,l=d)}c&&i.push({fromLineNumber:a,toLineNumber:l})}i.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:i})}this.handleTokenizationProgress(t)}setSemanticTokens(e,t){this._tokens2.set(e,t),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]})}hasCompleteSemanticTokens(){return this._tokens2.isComplete()}hasSomeSemanticTokens(){return!this._tokens2.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._tokens2.setPartial(e,t);this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}tokenizeViewport(e,t){e=Math.max(1,e),t=Math.min(this._buffer.getLineCount(),t),this._tokenization.tokenizeViewport(e,t)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._buffer.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._isDisposing||this._onDidChangeTokens.fire(e)}resetTokenization(){this._tokenization.reset()}forceTokenization(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(e)}isCheapToTokenize(e){return this._tokenization.isCheapToTokenize(e)}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(e)}_getLineTokens(e){const t=this.getLineContent(e),i=this._tokens.getTokens(this._languageId,e-1,t);return this._tokens2.addSemanticTokens(e,i)}getLanguageId(){return this._languageId}setMode(e){if(this._languageId===e)return;let t={oldLanguage:this._languageId,newLanguage:e};this._languageId=e,this._onDidChangeLanguage.fire(t),this._onDidChangeLanguageConfiguration.fire({})}getLanguageIdAtPosition(e,t){const i=this.validatePosition(new G(e,t)),r=this.getLineTokens(i.lineNumber);return r.getLanguageId(r.findTokenIndexAtOffset(i.column-1))}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}getWordAtPosition(e){this._assertNotDisposed();const t=this.validatePosition(e),i=this.getLineContent(t.lineNumber),r=this._getLineTokens(t.lineNumber),s=r.findTokenIndexAtOffset(t.column-1),[o,a]=yl._findLanguageBoundaries(r,s),l=dE(t.column,this.getLanguageConfiguration(r.getLanguageId(s)).getWordDefinition(),i.substring(o,a),o);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(s>0&&o===t.column-1){const[c,h]=yl._findLanguageBoundaries(r,s-1),u=dE(t.column,this.getLanguageConfiguration(r.getLanguageId(s-1)).getWordDefinition(),i.substring(c,h),c);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn)return u}return null}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let r=0;for(let o=t;o>=0&&e.getLanguageId(o)===i;o--)r=e.getStartOffset(o);let s=e.getLineContent().length;for(let o=t,a=e.getCount();o<a&&e.getLanguageId(o)===i;o++)s=e.getEndOffset(o);return[r,s]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}findMatchingBracketUp(e,t){let i=e.toLowerCase(),r=this.validatePosition(t),s=this._getLineTokens(r.lineNumber),o=s.getLanguageId(s.findTokenIndexAtOffset(r.column-1)),a=this.getLanguageConfiguration(o).brackets;if(!a)return null;let l=a.textIsBracket[i];return l?DC(this._findMatchingBracketUp(l,r,null)):null}matchBracket(e){return this._matchBracket(this.validatePosition(e))}_establishBracketSearchOffsets(e,t,i,r){const s=t.getCount(),o=t.getLanguageId(r);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=r-1;c>=0;c--){const h=t.getEndOffset(c);if(h<=a)break;if(wl(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){a=h;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=r+1;c<s;c++){const h=t.getStartOffset(c);if(h>=l)break;if(wl(t.getStandardTokenType(c))||t.getLanguageId(c)!==o){l=h;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e){const t=e.lineNumber,i=this._getLineTokens(t),r=this._buffer.getLineContent(t),s=i.findTokenIndexAtOffset(e.column-1);if(s<0)return null;const o=this.getLanguageConfiguration(i.getLanguageId(s)).brackets;if(o&&!wl(i.getStandardTokenType(s))){let{searchStartOffset:a,searchEndOffset:l}=this._establishBracketSearchOffsets(e,i,o,s),c=null;for(;;){const h=Do.findNextBracketInRange(o.forwardRegex,t,r,a,l);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){const u=r.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),d=this._matchFoundBracket(h,o.textIsBracket[u],o.textIsOpenBracket[u],null);if(d){if(d instanceof Kc)return null;c=d}}a=h.endColumn-1}if(c)return c}if(s>0&&i.getStartOffset(s)===e.column-1){const a=s-1,l=this.getLanguageConfiguration(i.getLanguageId(a)).brackets;if(l&&!wl(i.getStandardTokenType(a))){let{searchStartOffset:c,searchEndOffset:h}=this._establishBracketSearchOffsets(e,i,l,a);const u=Do.findPrevBracketInRange(l.reversedRegex,t,r,c,h);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn){const d=r.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),f=this._matchFoundBracket(u,l.textIsBracket[d],l.textIsOpenBracket[d],null);if(f)return f instanceof Kc?null:f}}}return null}_matchFoundBracket(e,t,i,r){if(!t)return null;const s=i?this._findMatchingBracketDown(t,e.getEndPosition(),r):this._findMatchingBracketUp(t,e.getStartPosition(),r);return s?s instanceof Kc?s:[e,s]:null}_findMatchingBracketUp(e,t,i){const r=e.languageId,s=e.reversedRegex;let o=-1,a=0;const l=(c,h,u,d)=>{for(;;){if(i&&++a%100===0&&!i())return Kc.INSTANCE;const f=Do.findPrevBracketInRange(s,c,h,u,d);if(!f)break;const g=h.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(g)?o++:e.isClose(g)&&o--,o===0)return f;d=f.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const h=this._getLineTokens(c),u=h.getCount(),d=this._buffer.getLineContent(c);let f=u-1,g=d.length,p=d.length;c===t.lineNumber&&(f=h.findTokenIndexAtOffset(t.column-1),g=t.column-1,p=t.column-1);let m=!0;for(;f>=0;f--){const b=h.getLanguageId(f)===r&&!wl(h.getStandardTokenType(f));if(b)m?g=h.getStartOffset(f):(g=h.getStartOffset(f),p=h.getEndOffset(f));else if(m&&g!==p){const _=l(c,d,g,p);if(_)return _}m=b}if(m&&g!==p){const b=l(c,d,g,p);if(b)return b}}return null}_findMatchingBracketDown(e,t,i){const r=e.languageId,s=e.forwardRegex;let o=1,a=0;const l=(h,u,d,f)=>{for(;;){if(i&&++a%100===0&&!i())return Kc.INSTANCE;const g=Do.findNextBracketInRange(s,h,u,d,f);if(!g)break;const p=u.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(p)?o++:e.isClose(p)&&o--,o===0)return g;d=g.endColumn-1}return null},c=this.getLineCount();for(let h=t.lineNumber;h<=c;h++){const u=this._getLineTokens(h),d=u.getCount(),f=this._buffer.getLineContent(h);let g=0,p=0,m=0;h===t.lineNumber&&(g=u.findTokenIndexAtOffset(t.column-1),p=t.column-1,m=t.column-1);let b=!0;for(;g<d;g++){const _=u.getLanguageId(g)===r&&!wl(u.getStandardTokenType(g));if(_)b||(p=u.getStartOffset(g)),m=u.getEndOffset(g);else if(b&&p!==m){const w=l(h,f,p,m);if(w)return w}b=_}if(b&&p!==m){const _=l(h,f,p,m);if(_)return _}}return null}findPrevBracket(e){const t=this.validatePosition(e);let i=null,r=null;for(let s=t.lineNumber;s>=1;s--){const o=this._getLineTokens(s),a=o.getCount(),l=this._buffer.getLineContent(s);let c=a-1,h=l.length,u=l.length;if(s===t.lineNumber){c=o.findTokenIndexAtOffset(t.column-1),h=t.column-1,u=t.column-1;const f=o.getLanguageId(c);i!==f&&(i=f,r=this.getLanguageConfiguration(i).brackets)}let d=!0;for(;c>=0;c--){const f=o.getLanguageId(c);if(i!==f){if(r&&d&&h!==u){const p=Do.findPrevBracketInRange(r.reversedRegex,s,l,h,u);if(p)return this._toFoundBracket(r,p);d=!1}i=f,r=this.getLanguageConfiguration(i).brackets}const g=!!r&&!wl(o.getStandardTokenType(c));if(g)d?h=o.getStartOffset(c):(h=o.getStartOffset(c),u=o.getEndOffset(c));else if(r&&d&&h!==u){const p=Do.findPrevBracketInRange(r.reversedRegex,s,l,h,u);if(p)return this._toFoundBracket(r,p)}d=g}if(r&&d&&h!==u){const f=Do.findPrevBracketInRange(r.reversedRegex,s,l,h,u);if(f)return this._toFoundBracket(r,f)}}return null}findNextBracket(e){const t=this.validatePosition(e),i=this.getLineCount();let r=null,s=null;for(let o=t.lineNumber;o<=i;o++){const a=this._getLineTokens(o),l=a.getCount(),c=this._buffer.getLineContent(o);let h=0,u=0,d=0;if(o===t.lineNumber){h=a.findTokenIndexAtOffset(t.column-1),u=t.column-1,d=t.column-1;const g=a.getLanguageId(h);r!==g&&(r=g,s=this.getLanguageConfiguration(r).brackets)}let f=!0;for(;h<l;h++){const g=a.getLanguageId(h);if(r!==g){if(s&&f&&u!==d){const m=Do.findNextBracketInRange(s.forwardRegex,o,c,u,d);if(m)return this._toFoundBracket(s,m);f=!1}r=g,s=this.getLanguageConfiguration(r).brackets}const p=!!s&&!wl(a.getStandardTokenType(h));if(p)f||(u=a.getStartOffset(h)),d=a.getEndOffset(h);else if(s&&f&&u!==d){const m=Do.findNextBracketInRange(s.forwardRegex,o,c,u,d);if(m)return this._toFoundBracket(s,m)}f=p}if(s&&f&&u!==d){const g=Do.findNextBracketInRange(s.forwardRegex,o,c,u,d);if(g)return this._toFoundBracket(s,g)}}return null}findEnclosingBrackets(e,t){let i;if(typeof t>"u")i=null;else{const f=Date.now();i=()=>Date.now()-f<=t}const r=this.validatePosition(e),s=this.getLineCount(),o=new Map;let a=[];const l=(f,g)=>{if(!o.has(f)){let p=[];for(let m=0,b=g?g.brackets.length:0;m<b;m++)p[m]=0;o.set(f,p)}a=o.get(f)};let c=0;const h=(f,g,p,m,b)=>{for(;;){if(i&&++c%100===0&&!i())return Kc.INSTANCE;const _=Do.findNextBracketInRange(f.forwardRegex,g,p,m,b);if(!_)break;const w=p.substring(_.startColumn-1,_.endColumn-1).toLowerCase(),y=f.textIsBracket[w];if(y&&(y.isOpen(w)?a[y.index]++:y.isClose(w)&&a[y.index]--,a[y.index]===-1))return this._matchFoundBracket(_,y,!1,i);m=_.endColumn-1}return null};let u=null,d=null;for(let f=r.lineNumber;f<=s;f++){const g=this._getLineTokens(f),p=g.getCount(),m=this._buffer.getLineContent(f);let b=0,_=0,w=0;if(f===r.lineNumber){b=g.findTokenIndexAtOffset(r.column-1),_=r.column-1,w=r.column-1;const S=g.getLanguageId(b);u!==S&&(u=S,d=this.getLanguageConfiguration(u).brackets,l(u,d))}let y=!0;for(;b<p;b++){const S=g.getLanguageId(b);if(u!==S){if(d&&y&&_!==w){const C=h(d,f,m,_,w);if(C)return DC(C);y=!1}u=S,d=this.getLanguageConfiguration(u).brackets,l(u,d)}const k=!!d&&!wl(g.getStandardTokenType(b));if(k)y||(_=g.getStartOffset(b)),w=g.getEndOffset(b);else if(d&&y&&_!==w){const C=h(d,f,m,_,w);if(C)return DC(C)}y=k}if(d&&y&&_!==w){const S=h(d,f,m,_,w);if(S)return DC(S)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.getValueInRange(t);i=i.toLowerCase();let r=e.textIsBracket[i];return r?{range:t,open:r.open,close:r.close,isOpen:e.textIsOpenBracket[i]}:null}static computeIndentLevel(e,t){let i=0,r=0,s=e.length;for(;r<s;){let o=e.charCodeAt(r);if(o===32)i++;else if(o===9)i=i-i%t+t;else break;r++}return r===s?-1:i}_computeIndentLevel(e){return yl.computeIndentLevel(this._buffer.getLineContent(e+1),this._options.tabSize)}getActiveIndentGuide(e,t,i){this._assertNotDisposed();const r=this.getLineCount();if(e<1||e>r)throw new Error("Illegal value for lineNumber");const s=this.getLanguageConfiguration(this._languageId).foldingRules,o=!!(s&&s.offSide);let a=-2,l=-1,c=-2,h=-1;const u=C=>{if(a!==-1&&(a===-2||a>C-1)){a=-1,l=-1;for(let D=C-2;D>=0;D--){let E=this._computeIndentLevel(D);if(E>=0){a=D,l=E;break}}}if(c===-2){c=-1,h=-1;for(let D=C;D<r;D++){let E=this._computeIndentLevel(D);if(E>=0){c=D,h=E;break}}}};let d=-2,f=-1,g=-2,p=-1;const m=C=>{if(d===-2){d=-1,f=-1;for(let D=C-2;D>=0;D--){let E=this._computeIndentLevel(D);if(E>=0){d=D,f=E;break}}}if(g!==-1&&(g===-2||g<C-1)){g=-1,p=-1;for(let D=C;D<r;D++){let E=this._computeIndentLevel(D);if(E>=0){g=D,p=E;break}}}};let b=0,_=!0,w=0,y=!0,S=0,k=0;for(let C=0;_||y;C++){const D=e-C,E=e+C;C>1&&(D<1||D<t)&&(_=!1),C>1&&(E>r||E>i)&&(y=!1),C>5e4&&(_=!1,y=!1);let N=-1;if(_){const j=this._computeIndentLevel(D-1);j>=0?(c=D-1,h=j,N=Math.ceil(j/this._options.indentSize)):(u(D),N=this._getIndentLevelForWhitespaceLine(o,l,h))}let T=-1;if(y){const j=this._computeIndentLevel(E-1);j>=0?(d=E-1,f=j,T=Math.ceil(j/this._options.indentSize)):(m(E),T=this._getIndentLevelForWhitespaceLine(o,f,p))}if(C===0){k=N;continue}if(C===1){if(E<=r&&T>=0&&k+1===T){_=!1,b=E,w=E,S=T;continue}if(D>=1&&N>=0&&N-1===k){y=!1,b=D,w=D,S=N;continue}if(b=e,w=e,S=k,S===0)return{startLineNumber:b,endLineNumber:w,indent:S}}_&&(N>=S?b=D:_=!1),y&&(T>=S?w=E:y=!1)}return{startLineNumber:b,endLineNumber:w,indent:S}}getLinesBracketGuides(e,t,i,r){var s,o,a,l,c;const h=[],u=this._bracketPairColorizer.getBracketPairsInRangeWithMinIndentation(new V(e,1,t,this.getLineMaxColumn(t)));let d;if(i&&u.length>0){const b=e<=i.lineNumber&&i.lineNumber<=t?u.filter(_=>_.range.containsPosition(i)):this._bracketPairColorizer.getBracketPairsInRange(V.fromPositions(i));d=(s=eIe(b,_=>_.range.startLineNumber!==_.range.endLineNumber))===null||s===void 0?void 0:s.range}const f=new tv(u),g=new Array,p=new Array,m=new Uee;for(let b=e;b<=t;b++){let _=new Array;p.length>0&&(_=_.concat(p),p.length=0),h.push(_);for(const y of f.takeWhile(S=>S.openingBracketRange.startLineNumber<=b)||[]){if(y.range.startLineNumber===y.range.endLineNumber)continue;const S=Math.min(this.getVisibleColumnFromPosition(y.openingBracketRange.getStartPosition()),this.getVisibleColumnFromPosition((a=(o=y.closingBracketRange)===null||o===void 0?void 0:o.getStartPosition())!==null&&a!==void 0?a:y.range.getEndPosition()),y.minVisibleColumnIndentation+1);let k=!1;y.closingBracketRange&&cs(this.getLineContent(y.closingBracketRange.startLineNumber))<y.closingBracketRange.startColumn-1&&(k=!0);const C=y.openingBracketRange.getStartPosition(),D=(c=(l=y.closingBracketRange)===null||l===void 0?void 0:l.getStartPosition())!==null&&c!==void 0?c:y.range.getEndPosition();y.closingBracketRange===void 0?g[y.nestingLevel]=null:g[y.nestingLevel]={nestingLevel:y.nestingLevel,guideVisibleColumn:S,start:C,visibleStartColumn:this.getVisibleColumnFromPosition(C),end:D,visibleEndColumn:this.getVisibleColumnFromPosition(D),bracketPair:y,renderHorizontalEndLineAtTheBottom:k}}for(const y of g){if(!y)continue;const S=d&&y.bracketPair.range.equalsRange(d),k=m.getInlineClassNameOfLevel(y.nestingLevel)+(r.highlightActive&&S?" "+m.activeClassName:"");(S&&r.horizontalGuides!==Lf.Disabled||r.includeInactive&&r.horizontalGuides===Lf.Enabled)&&(y.start.lineNumber===b&&y.guideVisibleColumn<y.visibleStartColumn&&_.push(new Xp(y.guideVisibleColumn,k,new BM(!1,y.start.column))),y.end.lineNumber===b+1&&y.guideVisibleColumn<y.visibleEndColumn&&p.push(new Xp(y.guideVisibleColumn,k,new BM(!y.renderHorizontalEndLineAtTheBottom,y.end.column))))}let w=Number.MAX_SAFE_INTEGER;for(let y=g.length-1;y>=0;y--){const S=g[y];if(!S)continue;const k=r.highlightActive&&d&&S.bracketPair.range.equalsRange(d),C=m.getInlineClassNameOfLevel(S.nestingLevel)+(k?" "+m.activeClassName:"");(k||r.includeInactive)&&S.renderHorizontalEndLineAtTheBottom&&S.end.lineNumber===b+1&&p.push(new Xp(S.guideVisibleColumn,C,null)),!(S.end.lineNumber<=b||S.start.lineNumber>=b)&&(S.guideVisibleColumn>=w&&!k||(w=S.guideVisibleColumn,(k||r.includeInactive)&&_.push(new Xp(S.guideVisibleColumn,C,null))))}_.sort((y,S)=>y.visibleColumn-S.visibleColumn)}return h}getVisibleColumnFromPosition(e){return Mt.visibleColumnFromColumn(this.getLineContent(e.lineNumber),e.column,this._options.tabSize)+1}getLinesIndentGuides(e,t){this._assertNotDisposed();const i=this.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const r=this.getLanguageConfiguration(this._languageId).foldingRules,s=!!(r&&r.offSide);let o=new Array(t-e+1),a=-2,l=-1,c=-2,h=-1;for(let u=e;u<=t;u++){let d=u-e;const f=this._computeIndentLevel(u-1);if(f>=0){a=u-1,l=f,o[d]=Math.ceil(f/this._options.indentSize);continue}if(a===-2){a=-1,l=-1;for(let g=u-2;g>=0;g--){let p=this._computeIndentLevel(g);if(p>=0){a=g,l=p;break}}}if(c!==-1&&(c===-2||c<u-1)){c=-1,h=-1;for(let g=u;g<i;g++){let p=this._computeIndentLevel(g);if(p>=0){c=g,h=p;break}}}o[d]=this._getIndentLevelForWhitespaceLine(s,l,h)}return o}_getIndentLevelForWhitespaceLine(e,t,i){return t===-1||i===-1?0:t<i?1+Math.floor(t/this._options.indentSize):t===i?Math.ceil(i/this._options.indentSize):e?Math.ceil(i/this._options.indentSize):1+Math.floor(i/this._options.indentSize)}normalizePosition(e,t){return e}getLineIndentColumn(e){return uMe(this.getLineContent(e))+1}};fo.MODEL_SYNC_LIMIT=50*1024*1024;fo.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024;fo.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3;fo.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:sr.tabSize,indentSize:sr.indentSize,insertSpaces:sr.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:sr.trimAutoWhitespace,largeFileOptimizations:sr.largeFileOptimizations,bracketPairColorizationOptions:sr.bracketPairColorizationOptions};fo=sMe([VT(4,vy),VT(5,Zr),VT(6,my)],fo);function uMe(n){let e=0;for(const t of n)if(t===" "||t==="	")e++;else break;return e}class Uee{constructor(){this.activeClassName="indent-active"}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}function WT(n){return!!(n.options.overviewRuler&&n.options.overviewRuler.color)}function $T(n){return!!n.options.after||!!n.options.before}class L${constructor(){this._decorationsTree0=new kT,this._decorationsTree1=new kT,this._injectedTextDecorationsTree=new kT}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,r,s){const o=e.getVersionId(),a=this._intervalSearch(t,i,r,s,o);return this._ensureNodesHaveRanges(e,a)}_intervalSearch(e,t,i,r,s){const o=this._decorationsTree0.intervalSearch(e,t,i,r,s),a=this._decorationsTree1.intervalSearch(e,t,i,r,s),l=this._injectedTextDecorationsTree.intervalSearch(e,t,i,r,s);return o.concat(a).concat(l)}getInjectedTextInInterval(e,t,i,r){const s=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,i,r,!1,s);return this._ensureNodesHaveRanges(e,o).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),r=this._injectedTextDecorationsTree.search(t,!1,i);return this._ensureNodesHaveRanges(e,r).filter(s=>s.options.showIfCollapsed||!s.range.isEmpty())}getAll(e,t,i,r){const s=e.getVersionId(),o=this._search(t,i,r,s);return this._ensureNodesHaveRanges(e,o)}_search(e,t,i,r){if(i)return this._decorationsTree1.search(e,t,r);{const s=this._decorationsTree0.search(e,t,r),o=this._decorationsTree1.search(e,t,r),a=this._injectedTextDecorationsTree.search(e,t,r);return s.concat(o).concat(a)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),r=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(r)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){$T(e)?this._injectedTextDecorationsTree.insert(e):WT(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){$T(e)?this._injectedTextDecorationsTree.delete(e):WT(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){$T(e)?this._injectedTextDecorationsTree.resolveNode(e,t):WT(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,r){this._decorationsTree0.acceptReplace(e,t,i,r),this._decorationsTree1.acceptReplace(e,t,i,r),this._injectedTextDecorationsTree.acceptReplace(e,t,i,r)}}function Bh(n){return n.replace(/[^a-z0-9\-_]/gi," ")}class jee{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class dMe extends jee{constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:rc.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;let i=e?t.getColor(e.id):null;return i?i.toString():""}}class fMe extends jee{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?X.fromHex(e):t.getColor(e.id)}}class Aw{constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1}static from(e){return e instanceof Aw?e:new Aw(e)}}class bt{constructor(e){this.description=e.description,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?Bh(e.className):null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new dMe(e.overviewRuler):null,this.minimap=e.minimap?new fMe(e.minimap):null,this.glyphMarginClassName=e.glyphMarginClassName?Bh(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?Bh(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?Bh(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?Bh(e.marginClassName):null,this.inlineClassName=e.inlineClassName?Bh(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?Bh(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?Bh(e.afterContentClassName):null,this.after=e.after?Aw.from(e.after):null,this.before=e.before?Aw.from(e.before):null}static register(e){return new bt(e)}static createDynamic(e){return new bt(e)}}bt.EMPTY=bt.register({description:"empty"});const I$=[bt.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),bt.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),bt.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),bt.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function T$(n){return n instanceof bt?n:bt.createDynamic(n)}class gMe extends re{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new H),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;if(this._deferredCnt--,this._deferredCnt===0){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const t={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(t)}(e=this._affectedInjectedTextLines)===null||e===void 0||e.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!!(e.minimap&&e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!!(e.overviewRuler&&e.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}class pMe extends re{constructor(){super(),this._fastEmitter=this._register(new H),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new H),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}const mMe=()=>!0,A$=()=>!1,_Me=n=>n===" "||n==="	";class Ro{constructor(e,t,i){this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const r=i.options,s=r.get(129);this.readOnly=r.get(80),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=r.get(103),this.lineHeight=r.get(58),this.pageSize=Math.max(1,Math.floor(s.height/this.lineHeight)-2),this.useTabStops=r.get(114),this.wordSeparators=r.get(115),this.emptySelectionClipboard=r.get(32),this.copyWithSyntaxHighlighting=r.get(21),this.multiCursorMergeOverlapping=r.get(68),this.multiCursorPaste=r.get(70),this.autoClosingBrackets=r.get(5),this.autoClosingQuotes=r.get(8),this.autoClosingDelete=r.get(6),this.autoClosingOvertype=r.get(7),this.autoSurround=r.get(11),this.autoIndent=r.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:Ro._getShouldAutoClose(e,this.autoClosingQuotes),bracket:Ro._getShouldAutoClose(e,this.autoClosingBrackets)},this.autoClosingPairs=zi.getAutoClosingPairs(e);let o=Ro._getSurroundingPairs(e);if(o)for(const a of o)this.surroundingPairs[a.open]=a.close}static shouldRecreate(e){return e.hasChanged(129)||e.hasChanged(115)||e.hasChanged(32)||e.hasChanged(68)||e.hasChanged(70)||e.hasChanged(5)||e.hasChanged(8)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(114)||e.hasChanged(58)||e.hasChanged(80)}get electricChars(){if(!this._electricChars){this._electricChars={};let e=Ro._getElectricCharacters(this._languageId);if(e)for(const t of e)this._electricChars[t]=!0}return this._electricChars}normalizeIndentation(e){return fo.normalizeIndentation(e,this.indentSize,this.insertSpaces)}static _getElectricCharacters(e){try{return zi.getElectricCharacters(e)}catch(t){return it(t),null}}static _getShouldAutoClose(e,t){switch(t){case"beforeWhitespace":return _Me;case"languageDefined":return Ro._getLanguageDefinedShouldAutoClose(e);case"always":return mMe;case"never":return A$}}static _getLanguageDefinedShouldAutoClose(e){try{const t=zi.getAutoCloseBeforeSet(e);return i=>t.indexOf(i)!==-1}catch(t){return it(t),A$}}static _getSurroundingPairs(e){try{return zi.getSurroundingPairs(e)}catch(t){return it(t),null}}}class Dn{constructor(e,t,i,r){this._singleCursorStateBrand=void 0,this.selectionStart=e,this.selectionStartLeftoverVisibleColumns=t,this.position=i,this.leftoverVisibleColumns=r,this.selection=Dn._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,r){return e?new Dn(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new G(t,i),r):new Dn(new V(t,i,t,i),r,new G(t,i),r)}static _computeSelection(e,t){let i,r,s,o;return e.isEmpty()?(i=e.startLineNumber,r=e.startColumn,s=t.lineNumber,o=t.column):t.isBeforeOrEqual(e.getStartPosition())?(i=e.endLineNumber,r=e.endColumn,s=t.lineNumber,o=t.column):(i=e.startLineNumber,r=e.startColumn,s=t.lineNumber,o=t.column),new je(i,r,s,o)}}class N${constructor(e,t,i,r){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=r}}class bMe{constructor(e){this.modelState=e,this.viewState=null}}class vMe{constructor(e){this.modelState=null,this.viewState=e}}class st{constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}static fromModelState(e){return new bMe(e)}static fromViewState(e){return new vMe(e)}static fromModelSelection(e){const t=e.selectionStartLineNumber,i=e.selectionStartColumn,r=e.positionLineNumber,s=e.positionColumn,o=new Dn(new V(t,i,t,i),0,new G(r,s),0);return st.fromModelState(o)}static fromModelSelections(e){let t=[];for(let i=0,r=e.length;i<r;i++)t[i]=this.fromModelSelection(e[i]);return t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class ts{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function Vp(n){return n==="'"||n==='"'||n==="`"}class Nw{static whitespaceVisibleColumn(e,t,i){const r=e.length;let s=0,o=-1,a=-1;for(let l=0;l<r;l++){if(l===t)return[o,a,s];switch(s%i===0&&(o=l,a=s),e.charCodeAt(l)){case 32:s+=1;break;case 9:s=Mt.nextRenderTabStop(s,i);break;default:return[-1,-1,-1]}}return t===r?[o,a,s]:[-1,-1,-1]}static atomicPosition(e,t,i,r){const s=e.length,[o,a,l]=Nw.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(r){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(o===-1)return-1;let d=a;for(let f=o;f<s;++f){if(d===a+i)return o;switch(e.charCodeAt(f)){case 32:d+=1;break;case 9:d=Mt.nextRenderTabStop(d,i);break;default:return-1}}return d===a+i?o:-1}const h=Mt.nextRenderTabStop(l,i);let u=l;for(let d=t;d<s;d++){if(u===h)return d;switch(e.charCodeAt(d)){case 32:u+=1;break;case 9:u=Mt.nextRenderTabStop(u,i);break;default:return-1}}return u===h?s:-1}}class Yh{constructor(e=null){this.hitTarget=e,this.type=0}}class bF{constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var zd;(function(n){function e(t,i,r){const s=t.getPositionFromDOMInfo(i,r);return s?new bF(s,i,null):new Yh(i)}n.createFromDOMInfo=e})(zd||(zd={}));class wMe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class va{constructor(e,t,i=0,r=null,s=null,o=null){this.element=e,this.type=t,this.mouseColumn=i,this.position=r,!s&&r&&(s=new V(r.lineNumber,r.column,r.lineNumber,r.column)),this.range=s,this.detail=o}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+e.detail}toString(){return va.toString(this)}}class xo{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===6}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===7}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===7}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===5}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===8}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}}class A_{constructor(e,t,i){this.model=e.model;const r=e.configuration.options;this.layoutInfo=r.get(129),this.viewDomNode=t.viewDomNode,this.lineHeight=r.get(58),this.stickyTabStops=r.get(103),this.typicalHalfwidthCharacterWidth=r.get(43).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return A_.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const r=i.verticalOffset+i.height/2,s=e.model.getLineCount();let o=null,a,l=null;return i.afterLineNumber!==s&&(l=new G(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(o=new G(i.afterLineNumber,e.model.getLineMaxColumn(i.afterLineNumber))),l===null?a=o:o===null?a=l:t<r?a=o:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:o,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const r=this._context.model.getLineCount(),s=this._context.model.getLineMaxColumn(r);return{range:new V(r,s,r,s),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.model.getLineMaxColumn(t);return{range:new V(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return A_._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==document.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class yMe{constructor(e,t,i){this.editorPos=t,this.pos=i,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+i.y-t.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+i.x-t.x-e.layoutInfo.contentLeft,this.isInMarginArea=i.x-t.x<e.layoutInfo.contentLeft&&i.x-t.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,$n._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class N5 extends yMe{constructor(e,t,i,r){super(e,t,i),this._ctx=e,r?(this.target=r,this.targetPath=oc.collect(r,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}fulfill(e,t=null,i=null,r=null){let s=this.mouseColumn;return t&&t.column<this._ctx.model.getLineMaxColumn(t.lineNumber)&&(s=Mt.visibleColumnFromColumn(this._ctx.model.getLineContent(t.lineNumber),t.column,this._ctx.model.getTextModelOptions().tabSize)+1),new va(this.target,e,s,t,i,r)}withTarget(e){return new N5(this._ctx,this.editorPos,this.pos,e)}}const R$={isAfterLines:!0};function zT(n){return{isAfterLines:!1,horizontalDistanceToText:n}}class $n{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=oc.collect(t,this._viewHelper.viewDomNode);return!!(xo.isChildOfContentWidgets(i)||xo.isChildOfOverflowingContentWidgets(i)||xo.isChildOfOverlayWidgets(i))}createMouseTarget(e,t,i,r){const s=new A_(this._context,this._viewHelper,e),o=new N5(s,t,i,r);try{return $n._createMouseTarget(s,o,!1)}catch{return o.fulfill(0)}}static _createMouseTarget(e,t,i){if(t.target===null){if(i)return t.fulfill(0);const o=$n._doHitTest(e,t);return o.type===1?$n.createMouseTargetFromHitTestPosition(e,t,o.spanNode,o.position,o.injectedText):this._createMouseTarget(e,t.withTarget(o.hitTarget),!0)}const r=t;let s=null;return s=s||$n._hitTestContentWidget(e,r),s=s||$n._hitTestOverlayWidget(e,r),s=s||$n._hitTestMinimap(e,r),s=s||$n._hitTestScrollbarSlider(e,r),s=s||$n._hitTestViewZone(e,r),s=s||$n._hitTestMargin(e,r),s=s||$n._hitTestViewCursor(e,r),s=s||$n._hitTestTextArea(e,r),s=s||$n._hitTestViewLines(e,r,i),s=s||$n._hitTestScrollbar(e,r),s||t.fulfill(0)}static _hitTestContentWidget(e,t){if(xo.isChildOfContentWidgets(t.targetPath)||xo.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfill(9,null,null,i):t.fulfill(0)}return null}static _hitTestOverlayWidget(e,t){if(xo.isChildOfOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfill(12,null,null,i):t.fulfill(0)}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const r of i)if(t.target===r.domNode)return t.fulfill(6,r.position,null,{mightBeForeignElement:!1})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,r=t.mouseContentHorizontalOffset,s=t.mouseVerticalOffset;for(const o of i){if(r<o.contentLeft||r>o.contentLeft+o.width)continue;const a=e.getVerticalOffsetForLineNumber(o.position.lineNumber);if(a<=s&&s<=a+o.height)return t.fulfill(6,o.position,null,{mightBeForeignElement:!1})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const r=t.isInContentArea?8:5;return t.fulfill(r,i.position,null,i)}return null}static _hitTestTextArea(e,t){return xo.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfill(6,e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1}):t.fulfill(1,e.lastRenderData.lastTextareaPosition):null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),r=i.range.getStartPosition();let s=Math.abs(t.pos.x-t.editorPos.x);const o={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:s};return s-=e.layoutInfo.glyphMarginLeft,s<=e.layoutInfo.glyphMarginWidth?t.fulfill(2,r,i.range,o):(s-=e.layoutInfo.glyphMarginWidth,s<=e.layoutInfo.lineNumbersWidth?t.fulfill(3,r,i.range,o):(s-=e.layoutInfo.lineNumbersWidth,t.fulfill(4,r,i.range,o)))}return null}static _hitTestViewLines(e,t,i){if(!xo.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfill(7,new G(1,1),null,R$);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const s=e.model.getLineCount(),o=e.model.getLineMaxColumn(s);return t.fulfill(7,new G(s,o),null,R$)}if(i){if(xo.isStrictChildOfViewLines(t.targetPath)){const s=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.model.getLineLength(s)===0){const a=e.getLineWidth(s),l=zT(t.mouseContentHorizontalOffset-a);return t.fulfill(7,new G(s,1),null,l)}const o=e.getLineWidth(s);if(t.mouseContentHorizontalOffset>=o){const a=zT(t.mouseContentHorizontalOffset-o),l=new G(s,e.model.getLineMaxColumn(s));return t.fulfill(7,l,null,a)}}return t.fulfill(0)}const r=$n._doHitTest(e,t);return r.type===1?$n.createMouseTargetFromHitTestPosition(e,t,r.spanNode,r.position,r.injectedText):this._createMouseTarget(e,t.withTarget(r.hitTarget),!0)}static _hitTestMinimap(e,t){if(xo.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.model.getLineMaxColumn(i);return t.fulfill(11,new G(i,r))}return null}static _hitTestScrollbarSlider(e,t){if(xo.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const r=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.model.getLineMaxColumn(r);return t.fulfill(11,new G(r,s))}}return null}static _hitTestScrollbar(e,t){if(xo.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),r=e.model.getLineMaxColumn(i);return t.fulfill(11,new G(i,r))}return null}getMouseColumn(e,t){const i=this._context.configuration.options,r=i.get(129),s=this._context.viewLayout.getCurrentScrollLeft()+t.x-e.x-r.contentLeft;return $n._getMouseColumn(s,i.get(43).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,r,s){const o=r.lineNumber,a=r.column,l=e.getLineWidth(o);if(t.mouseContentHorizontalOffset>l){const m=zT(t.mouseContentHorizontalOffset-l);return t.fulfill(7,r,null,m)}const c=e.visibleRangeForPosition(o,a);if(!c)return t.fulfill(0,r);const h=c.left;if(t.mouseContentHorizontalOffset===h)return t.fulfill(6,r,null,{mightBeForeignElement:!!s});const u=[];if(u.push({offset:c.left,column:a}),a>1){const m=e.visibleRangeForPosition(o,a-1);m&&u.push({offset:m.left,column:a-1})}const d=e.model.getLineMaxColumn(o);if(a<d){const m=e.visibleRangeForPosition(o,a+1);m&&u.push({offset:m.left,column:a+1})}u.sort((m,b)=>m.offset-b.offset);const f=t.pos.toClientCoordinates(),g=i.getBoundingClientRect(),p=g.left<=f.clientX&&f.clientX<=g.right;for(let m=1;m<u.length;m++){const b=u[m-1],_=u[m];if(b.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=_.offset){const w=new V(o,b.column,o,_.column);return t.fulfill(6,r,w,{mightBeForeignElement:!p||!!s})}}return t.fulfill(6,r,null,{mightBeForeignElement:!p||!!s})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.getVerticalOffsetForLineNumber(i)+Math.floor(e.lineHeight/2);let o=t.pos.y+(s-t.mouseVerticalOffset);o<=t.editorPos.y&&(o=t.editorPos.y+1),o>=t.editorPos.y+e.layoutInfo.height&&(o=t.editorPos.y+e.layoutInfo.height-1);const a=new m5(t.pos.x,o),l=this._actualDoHitTestWithCaretRangeFromPoint(e,a.toClientCoordinates());return l.type===1?l:this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=m0(e.viewDomNode);let r;if(i?typeof i.caretRangeFromPoint>"u"?r=CMe(i,t.clientX,t.clientY):r=i.caretRangeFromPoint(t.clientX,t.clientY):r=document.caretRangeFromPoint(t.clientX,t.clientY),!r||!r.startContainer)return new Yh;const s=r.startContainer;if(s.nodeType===s.TEXT_NODE){const o=s.parentNode,a=o?o.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===Ol.CLASS_NAME?zd.createFromDOMInfo(e,o,r.startOffset):new Yh(s.parentNode)}else if(s.nodeType===s.ELEMENT_NODE){const o=s.parentNode,a=o?o.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===Ol.CLASS_NAME?zd.createFromDOMInfo(e,s,s.textContent.length):new Yh(s)}return new Yh}static _doHitTestWithCaretPositionFromPoint(e,t){const i=document.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const r=i.offsetNode.parentNode,s=r?r.parentNode:null,o=s?s.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===Ol.CLASS_NAME?zd.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new Yh(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const r=i.offsetNode.parentNode,s=r&&r.nodeType===r.ELEMENT_NODE?r.className:null,o=r?r.parentNode:null,a=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(s===Ol.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return zd.createFromDOMInfo(e,l,0)}else if(a===Ol.CLASS_NAME)return zd.createFromDOMInfo(e,i.offsetNode,0)}return new Yh(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:r}=t.getTextModelOptions(),s=Nw.atomicPosition(i,e.column-1,r,2);return s!==-1?new G(e.lineNumber,s+1):e}static _doHitTest(e,t){let i=new Yh;if(typeof document.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):document.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates())),i.type===1){const r=e.model.getInjectedTextAt(i.position),s=e.model.normalizePosition(i.position,2);(r||!s.equals(i.position))&&(i=new bF(s,i.spanNode,r))}return i.type===1&&e.stickyTabStops&&(i=new bF(this._snapToSoftTabBoundary(i.position,e.model),i.spanNode,i.injectedText)),i}}function CMe(n,e,t){const i=document.createRange();let r=n.elementFromPoint(e,t);if(r!==null){for(;r&&r.firstChild&&r.firstChild.nodeType!==r.firstChild.TEXT_NODE&&r.lastChild&&r.lastChild.firstChild;)r=r.lastChild;const s=r.getBoundingClientRect(),o=window.getComputedStyle(r,null).getPropertyValue("font"),a=r.innerText;let l=s.left,c=0,h;if(e>s.left+s.width)c=a.length;else{const u=df.getInstance();for(let d=0;d<a.length+1;d++){if(h=u.getCharWidth(a.charAt(d),o)/2,l+=h,e<l){c=d;break}l+=h}}i.setStart(r.firstChild,c),i.setEnd(r.firstChild,c)}return i}class df{constructor(){this._cache={},this._canvas=document.createElement("canvas")}static getInstance(){return df._INSTANCE||(df._INSTANCE=new df),df._INSTANCE}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const r=this._canvas.getContext("2d");r.font=t;const o=r.measureText(e).width;return this._cache[i]=o,o}}df._INSTANCE=null;function JE(n){return function(e,t){let i=!1;return n&&(i=n.mouseTargetIsWidget(t)),i||t.preventDefault(),t}}class ug extends by{constructor(e,t,i){super(),this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new $n(this._context,i),this._mouseDownOperation=this._register(new SMe(this._context,this.viewController,this.viewHelper,(o,a)=>this._createMouseTarget(o,a),o=>this._getMouseColumn(o))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(129).height;const r=new NTe(this.viewHelper.viewDomNode);this._register(r.onContextMenu(this.viewHelper.viewDomNode,o=>this._onContextMenu(o,!0))),this._register(r.onMouseMoveThrottled(this.viewHelper.viewDomNode,o=>this._onMouseMove(o),JE(this.mouseTargetFactory),ug.MOUSE_MOVE_MINIMUM_TIME)),this._register(r.onMouseUp(this.viewHelper.viewDomNode,o=>this._onMouseUp(o))),this._register(r.onMouseLeave(this.viewHelper.viewDomNode,o=>this._onMouseLeave(o))),this._register(r.onMouseDown(this.viewHelper.viewDomNode,o=>this._onMouseDown(o)));const s=o=>{if(this.viewController.emitMouseWheel(o),!this._context.configuration.options.get(67))return;const a=new __(o);if(wt?(o.metaKey||o.ctrlKey)&&!o.shiftKey&&!o.altKey:o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey){const c=SE.getZoomLevel(),h=a.deltaY>0?1:-1;SE.setZoomLevel(c+h),a.preventDefault(),a.stopPropagation()}};this._register(ae(this.viewHelper.viewDomNode,Me.MOUSE_WHEEL,s,{capture:!0,passive:!1})),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(129)){const t=this._context.configuration.options.get(129).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}onScrollChanged(e){return this._mouseDownOperation.onScrollChanged(),!1}getTargetAtClientPoint(e,t){const r=new JJ(e,t).toPageCoordinates(),s=eee(this.viewHelper.viewDomNode);return r.y<s.y||r.y>s.y+s.height||r.x<s.x||r.x>s.x+s.width?null:this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),s,r,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const r=m0(this.viewHelper.viewDomNode);r&&(i=r.elementsFromPoint(e.posx,e.posy).find(s=>this.viewHelper.viewDomNode.contains(s)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.editorPos,e.pos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e){const t=this._createMouseTarget(e,!0),i=t.type===6||t.type===7,r=t.type===2||t.type===3||t.type===4,s=t.type===3,o=this._context.configuration.options.get(97),a=t.type===8||t.type===5,l=t.type===9;let c=e.leftButton||e.middleButton;wt&&e.leftButton&&e.ctrlKey&&(c=!1);const h=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(c&&(i||s&&o))h(),this._mouseDownOperation.start(t.type,e);else if(r)e.preventDefault();else if(a){const u=t.detail;this.viewHelper.shouldSuppressMouseDownOnViewZone(u.viewZoneId)&&(h(),this._mouseDownOperation.start(t.type,e),e.preventDefault())}else l&&this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)&&(h(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:t})}}ug.MOUSE_MOVE_MINIMUM_TIME=100;class SMe extends re{constructor(e,t,i,r,s){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._createMouseTarget=r,this._getMouseColumn=s,this._mouseMoveMonitor=this._register(new MTe(this._viewHelper.viewDomNode)),this._onScrollTimeout=this._register(new Gr),this._mouseState=new kL,this._currentSelection=new je(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!0);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):this._dispatchMouse(t,!0))}start(e,t){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const i=this._findMousePosition(t,!0);if(!i||!i.position)return;this._mouseState.trySetCount(t.detail,i.position),t.detail=this._mouseState.count;const r=this._context.configuration.options;if(!r.get(80)&&r.get(31)&&!r.get(18)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&i.type===6&&i.position&&this._currentSelection.containsPosition(i.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,JE(null),s=>this._onMouseDownThenMove(s),s=>{const o=this._findMousePosition(this._lastMouseEvent,!0);s&&s instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:o?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(i,t.shiftKey),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,JE(null),s=>this._onMouseDownThenMove(s),()=>this._stop()))}_stop(){this._isActive=!1,this._onScrollTimeout.cancel()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onScrollChanged(){this._isActive&&this._onScrollTimeout.setIfNotSet(()=>{if(!this._lastMouseEvent)return;const e=this._findMousePosition(this._lastMouseEvent,!1);e&&(this._mouseState.isDragAndDrop||this._dispatchMouse(e,!0))},10)}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.model,r=this._context.viewLayout,s=this._getMouseColumn(e);if(e.posy<t.y){const a=Math.max(r.getCurrentScrollTop()-(t.y-e.posy),0),l=A_.getZoneAtCoord(this._context,a);if(l){const h=this._helpPositionJumpOverViewZone(l);if(h)return new va(null,13,s,h)}const c=r.getLineNumberAtVerticalOffset(a);return new va(null,13,s,new G(c,1))}if(e.posy>t.y+t.height){const a=r.getCurrentScrollTop()+(e.posy-t.y),l=A_.getZoneAtCoord(this._context,a);if(l){const h=this._helpPositionJumpOverViewZone(l);if(h)return new va(null,13,s,h)}const c=r.getLineNumberAtVerticalOffset(a);return new va(null,13,s,new G(c,i.getLineMaxColumn(c)))}const o=r.getLineNumberAtVerticalOffset(r.getCurrentScrollTop()+(e.posy-t.y));return e.posx<t.x?new va(null,13,s,new G(o,1)):e.posx>t.x+t.width?new va(null,13,s,new G(o,i.getLineMaxColumn(o))):null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const r=this._createMouseTarget(e,t);if(!r.position)return null;if(r.type===8||r.type===5){const o=this._helpPositionJumpOverViewZone(r.detail);if(o)return new va(r.element,r.type,r.mouseColumn,o,null,r.detail)}return r}_helpPositionJumpOverViewZone(e){const t=new G(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,r=e.positionAfter;return i&&r?i.isBefore(t)?i:r:null}_dispatchMouse(e,t){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton})}}class kL{constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>kL.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}kL.CLEAR_MOUSE_DOWN_COUNT_TIME=400;var Oo;(function(n){n.text="text/plain",n.binary="application/octet-stream",n.unknown="application/unknown",n.markdown="text/markdown",n.latex="text/latex"})(Oo||(Oo={}));let Rf=[],R5=[],eD=[];function kC(n,e=!1){const t=xMe(n);Rf.push(t),t.userConfigured?eD.push(t):R5.push(t),e&&!t.userConfigured&&Rf.forEach(i=>{i.mime===t.mime||i.userConfigured||(t.extension&&i.extension===t.extension&&console.warn(`Overwriting extension <<${t.extension}>> to now point to mime <<${t.mime}>>`),t.filename&&i.filename===t.filename&&console.warn(`Overwriting filename <<${t.filename}>> to now point to mime <<${t.mime}>>`),t.filepattern&&i.filepattern===t.filepattern&&console.warn(`Overwriting filepattern <<${t.filepattern}>> to now point to mime <<${t.mime}>>`),t.firstline&&i.firstline===t.firstline&&console.warn(`Overwriting firstline <<${t.firstline}>> to now point to mime <<${t.mime}>>`))})}function xMe(n){return{id:n.id,mime:n.mime,filename:n.filename,extension:n.extension,filepattern:n.filepattern,firstline:n.firstline,userConfigured:n.userConfigured,filenameLowercase:n.filename?n.filename.toLowerCase():void 0,extensionLowercase:n.extension?n.extension.toLowerCase():void 0,filepatternLowercase:n.filepattern?UQ(n.filepattern.toLowerCase()):void 0,filepatternOnPath:n.filepattern?n.filepattern.indexOf(hn.sep)>=0:!1}}function EMe(n){n?(Rf=Rf.filter(e=>!e.userConfigured),eD=[]):(Rf=[],R5=[],eD=[])}function DMe(n,e){let t;if(n)switch(n.scheme){case ft.file:t=n.fsPath;break;case ft.data:t=Uu.parseMetaData(n).get(Uu.META_DATA_LABEL);break;default:t=n.path}if(!t)return[Oo.unknown];t=t.toLowerCase();const i=Ef(t),r=M$(t,i,eD);if(r)return[r,Oo.text];const s=M$(t,i,R5);if(s)return[s,Oo.text];if(e){const o=kMe(e);if(o)return[o,Oo.text]}return[Oo.unknown]}function M$(n,e,t){var i;let r=null,s=null,o=null;for(let a=t.length-1;a>=0;a--){const l=t[a];if(e===l.filenameLowercase){r=l;break}if(l.filepattern&&(!s||l.filepattern.length>s.filepattern.length)){const c=l.filepatternOnPath?n:e;!((i=l.filepatternLowercase)===null||i===void 0)&&i.call(l,c)&&(s=l)}l.extension&&(!o||l.extension.length>o.extension.length)&&e.endsWith(l.extensionLowercase)&&(o=l)}return r?r.mime:s?s.mime:o?o.mime:null}function kMe(n){if(V3(n)&&(n=n.substr(1)),n.length>0)for(let e=Rf.length-1;e>=0;e--){const t=Rf[e];if(!t.firstline)continue;const i=n.match(t.firstline);if(i&&i.length>0)return t.mime}return null}class vn{constructor(e,t,i,r,s){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selectionStartPosition=r,this.selectionEndPosition=s}toString(){return"[ <"+this.value+">, selectionStart: "+this.selectionStart+", selectionEnd: "+this.selectionEnd+"]"}static readFromTextArea(e){return new vn(e.getValue(),e.getSelectionStart(),e.getSelectionEnd(),null,null)}collapseSelection(){return new vn(this.value,this.value.length,this.value.length,null,null)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const r=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selectionStartPosition,r,-1)}if(e>=this.selectionEnd){const r=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selectionEndPosition,r,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf(String.fromCharCode(8230))===-1)return this._finishDeduceEditorPosition(this.selectionStartPosition,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selectionEndPosition,i,-1)}_finishDeduceEditorPosition(e,t,i){let r=0,s=-1;for(;(s=t.indexOf(`
`,s+1))!==-1;)r++;return[e,i*t.length,r]}static selectedText(e){return new vn(e,0,e.length,null,null)}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};let r=e.value,s=e.selectionStart,o=e.selectionEnd,a=t.value,l=t.selectionStart,c=t.selectionEnd;const h=r.substring(o),u=a.substring(c),d=TM(h,u);a=a.substring(0,a.length-d),r=r.substring(0,r.length-d);const f=r.substring(0,s),g=a.substring(0,l),p=mw(f,g);if(a=a.substring(p),r=r.substring(p),l-=p,s-=p,c-=p,o-=p,i&&l===c&&r.length>0){let b=null;if(l===a.length?a.startsWith(r)&&(b=a.substring(r.length)):a.endsWith(r)&&(b=a.substring(0,a.length-r.length)),b!==null&&b.length>0&&(/\uFE0F/.test(b)||Rke(b)))return{text:b,replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0}}if(l===c){if(r===a&&s===0&&o===r.length&&l===a.length&&a.indexOf(`
`)===-1&&Fke(a))return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const b=f.length-p;return{text:a,replacePrevCharCnt:b,replaceNextCharCnt:0,positionDelta:0}}const m=o-s;return{text:a,replacePrevCharCnt:m,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(mw(e.value,t.value),e.selectionEnd),r=Math.min(TM(e.value,t.value),e.value.length-e.selectionEnd),s=e.value.substring(i,e.value.length-r),o=t.value.substring(i,t.value.length-r);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:o,replacePrevCharCnt:a,replaceNextCharCnt:s.length-a,positionDelta:l-o.length}}}vn.EMPTY=new vn("",0,0,null,null);class tm{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,r=i+1,s=i+t;return new V(r,1,s+1,1)}static fromEditorSelection(e,t,i,r,s){const o=tm._getPageOfLine(i.startLineNumber,r),a=tm._getRangeForPage(o,r),l=tm._getPageOfLine(i.endLineNumber,r),c=tm._getRangeForPage(l,r),h=a.intersectRanges(new V(1,1,i.startLineNumber,i.startColumn));let u=t.getValueInRange(h,1);const d=t.getLineCount(),f=t.getLineMaxColumn(d),g=c.intersectRanges(new V(i.endLineNumber,i.endColumn,d,f));let p=t.getValueInRange(g,1),m;if(o===l||o+1===l)m=t.getValueInRange(i,1);else{const b=a.intersectRanges(i),_=c.intersectRanges(i);m=t.getValueInRange(b,1)+String.fromCharCode(8230)+t.getValueInRange(_,1)}return s&&(u.length>500&&(u=u.substring(u.length-500,u.length)),p.length>500&&(p=p.substring(0,500)),m.length>2*500&&(m=m.substring(0,500)+String.fromCharCode(8230)+m.substring(m.length-500,m.length))),new vn(u+m+p,u.length,u.length+m.length,new G(i.startLineNumber,i.startColumn),new G(i.endLineNumber,i.endColumn))}}var tD;(function(n){n.Tap="-monaco-textarea-synthetic-tap"})(tD||(tD={}));class iD{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}iD.INSTANCE=new iD;class LMe extends re{constructor(e,t){super(),this.textArea=t,this._onFocus=this._register(new H),this.onFocus=this._onFocus.event,this._onBlur=this._register(new H),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new H),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new H),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new H),this.onCut=this._onCut.event,this._onPaste=this._register(new H),this.onPaste=this._onPaste.event,this._onType=this._register(new H),this.onType=this._onType.event,this._onCompositionStart=this._register(new H),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new H),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new H),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new H),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._host=e,this._textArea=this._register(new IMe(t)),this._asyncTriggerCut=this._register(new yi(()=>this._onCut.fire(),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new yi(()=>this.writeScreenReaderContent("asyncFocusGain"),0)),this._textAreaState=vn.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._isDoingComposition=!1,this._nextCommand=0;let i=null;this._register(dn(t.domNode,"keydown",a=>{(a.keyCode===109||this._isDoingComposition&&a.keyCode===1)&&a.stopPropagation(),a.equals(9)&&a.preventDefault(),i=a,this._onKeyDown.fire(a)})),this._register(dn(t.domNode,"keyup",a=>{this._onKeyUp.fire(a)})),this._register(ae(t.domNode,"compositionstart",a=>{if(!this._isDoingComposition){if(this._isDoingComposition=!0,wt&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===a.data&&(i&&i.equals(109)&&(i.code==="ArrowRight"||i.code==="ArrowLeft")||$r)){this._textAreaState=new vn(this._textAreaState.value,this._textAreaState.selectionStart-1,this._textAreaState.selectionEnd,this._textAreaState.selectionStartPosition?new G(this._textAreaState.selectionStartPosition.lineNumber,this._textAreaState.selectionStartPosition.column-1):null,this._textAreaState.selectionEndPosition),this._onCompositionStart.fire({revealDeltaColumns:-1});return}if(vb){this._onCompositionStart.fire({revealDeltaColumns:-this._textAreaState.selectionStart});return}this._setAndWriteTextAreaState("compositionstart",vn.EMPTY),this._onCompositionStart.fire({revealDeltaColumns:0})}}));const r=a=>{const l=this._textAreaState,c=vn.readFromTextArea(this._textArea);return[c,vn.deduceInput(l,c,a)]},s=()=>{const a=this._textAreaState,l=vn.readFromTextArea(this._textArea);return[l,vn.deduceAndroidCompositionInput(a,l)]},o=a=>{const l=this._textAreaState,c=vn.selectedText(a),h={text:c.value,replacePrevCharCnt:l.selectionEnd-l.selectionStart,replaceNextCharCnt:0,positionDelta:0};return[c,h]};this._register(ae(t.domNode,"compositionupdate",a=>{if(vb){const[h,u]=s();this._textAreaState=h,this._onType.fire(u),this._onCompositionUpdate.fire(a);return}const[l,c]=o(a.data||"");this._textAreaState=l,this._onType.fire(c),this._onCompositionUpdate.fire(a)})),this._register(ae(t.domNode,"compositionend",a=>{if(!this._isDoingComposition)return;if(this._isDoingComposition=!1,vb){const[h,u]=s();this._textAreaState=h,this._onType.fire(u),this._onCompositionEnd.fire();return}const[l,c]=o(a.data||"");this._textAreaState=l,this._onType.fire(c),(_E||$r)&&(this._textAreaState=vn.readFromTextArea(this._textArea)),this._onCompositionEnd.fire()})),this._register(ae(t.domNode,"input",()=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._isDoingComposition)return;const[a,l]=r(wt);l.replacePrevCharCnt===0&&l.text.length===1&&Ln(l.text.charCodeAt(0))||(this._textAreaState=a,this._nextCommand===0?(l.text!==""||l.replacePrevCharCnt!==0)&&this._onType.fire(l):((l.text!==""||l.replacePrevCharCnt!==0)&&this._firePaste(l.text,null),this._nextCommand=0))})),this._register(ae(t.domNode,"cut",a=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(a),this._asyncTriggerCut.schedule()})),this._register(ae(t.domNode,"copy",a=>{this._ensureClipboardGetsEditorSelection(a)})),this._register(ae(t.domNode,"paste",a=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),Q0.canUseTextData(a)){const[l,c]=Q0.getTextData(a);l!==""&&this._firePaste(l,c)}else this._textArea.getSelectionStart()!==this._textArea.getSelectionEnd()&&this._setAndWriteTextAreaState("paste",vn.EMPTY),this._nextCommand=1})),this._register(ae(t.domNode,"focus",()=>{const a=this._hasFocus;this._setHasFocus(!0),Yo&&!a&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()})),this._register(ae(t.domNode,"blur",()=>{this._isDoingComposition&&(this._isDoingComposition=!1,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(ae(t.domNode,tD.Tap,()=>{vb&&this._isDoingComposition&&(this._isDoingComposition=!1,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return ae(document,"selectionchange",t=>{if(!this._hasFocus||this._isDoingComposition||!_E)return;const i=Date.now(),r=i-e;if(e=i,r<5)return;const s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selectionStartPosition||!this._textAreaState.selectionEndPosition)return;const o=this._textArea.getValue();if(this._textAreaState.value!==o)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),h=this._host.deduceModelPosition(c[0],c[1],c[2]),u=this._textAreaState.deduceEditorPosition(l),d=this._host.deduceModelPosition(u[0],u[1],u[2]),f=new je(h.lineNumber,h.column,d.lineNumber,d.column);this._onSelectionChangeRequest.fire(f)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){const e=m0(this.textArea.domNode);e?this._setHasFocus(e.activeElement===this.textArea.domNode):L3(this.textArea.domNode)?this._setHasFocus(document.activeElement===this.textArea.domNode):this._setHasFocus(!1)}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._isDoingComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent(this._textAreaState))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(Q0.canUseTextData(e)),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};if(iD.INSTANCE.set($r?t.text.replace(/\r\n/g,`
`):t.text,i),!Q0.canUseTextData(e)){this._setAndWriteTextAreaState("copy or cut",vn.selectedText(t.text));return}Q0.setTextData(e,t.text,t.html,i)}_firePaste(e,t){t||(t=iD.INSTANCE.get(e)),this._onPaste.fire({text:e,metadata:t})}}class Q0{static canUseTextData(e){return!!e.clipboardData}static getTextData(e){if(e.clipboardData){e.preventDefault();const t=e.clipboardData.getData(Oo.text);let i=null;const r=e.clipboardData.getData("vscode-editor-data");if(typeof r=="string")try{i=JSON.parse(r),i.version!==1&&(i=null)}catch{}return[t,i]}throw new Error("ClipboardEventUtils.getTextData: Cannot use text data!")}static setTextData(e,t,i,r){if(e.clipboardData){e.clipboardData.setData(Oo.text,t),typeof i=="string"&&e.clipboardData.setData("text/html",i),e.clipboardData.setData("vscode-editor-data",JSON.stringify(r)),e.preventDefault();return}throw new Error("ClipboardEventUtils.setTextData: Cannot use text data!")}}class IMe extends re{constructor(e){super(),this._actual=e,this._ignoreSelectionChangeTime=0}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.domNode.value}setValue(e,t){const i=this._actual.domNode;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.domNode.selectionDirection==="backward"?this._actual.domNode.selectionEnd:this._actual.domNode.selectionStart}getSelectionEnd(){return this._actual.domNode.selectionDirection==="backward"?this._actual.domNode.selectionStart:this._actual.domNode.selectionEnd}setSelectionRange(e,t,i){const r=this._actual.domNode;let s=null;const o=m0(r);o?s=o.activeElement:s=document.activeElement;const a=s===r,l=r.selectionStart,c=r.selectionEnd;if(a&&l===t&&c===i){$r&&window.parent!==window&&r.focus();return}if(a){this.setIgnoreSelectionChangeTime("setSelectionRange"),r.setSelectionRange(t,i),$r&&window.parent!==window&&r.focus();return}try{const h=bke(r);this.setIgnoreSelectionChangeTime("setSelectionRange"),r.focus(),r.setSelectionRange(t,i),vke(r,h)}catch{}}}class TMe extends ug{constructor(e,t,i){super(e,t,i),this._register(Rt.addTarget(this.viewHelper.linesContentDomNode)),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Tap,s=>this.onTap(s))),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Change,s=>this.onChange(s))),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Contextmenu,s=>this._onContextMenu(new hg(s,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(ae(this.viewHelper.linesContentDomNode,"pointerdown",s=>{const o=s.pointerType;if(o==="mouse"){this._lastPointerType="mouse";return}else o==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const r=new RTe(this.viewHelper.viewDomNode);this._register(r.onPointerMoveThrottled(this.viewHelper.viewDomNode,s=>this._onMouseMove(s),JE(this.mouseTargetFactory),ug.MOUSE_MOVE_MINIMUM_TIME)),this._register(r.onPointerUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(r.onPointerLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s))),this._register(r.onPointerDown(this.viewHelper.viewDomNode,s=>this._onMouseDown(s)))}onTap(e){if(!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget))return;e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new hg(e,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.dispatchMouse({position:t.position,mouseColumn:t.position.column,startedOnLineNumbers:!1,mouseDownCount:e.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1})}onChange(e){this._lastPointerType==="touch"&&this._context.model.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e)}}class AMe extends ug{constructor(e,t,i){super(e,t,i),this._register(Rt.addTarget(this.viewHelper.linesContentDomNode)),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Tap,r=>this.onTap(r))),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Change,r=>this.onChange(r))),this._register(ae(this.viewHelper.linesContentDomNode,Qt.Contextmenu,r=>this._onContextMenu(new hg(r,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new hg(e,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(tD.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position)}}onChange(e){this._context.model.deltaScrollNow(-e.translationX,-e.translationY)}}class NMe extends re{constructor(e,t,i){super(),Hu&&Gk.pointerEvents?this.handler=this._register(new TMe(e,t,i)):window.TouchEvent?this.handler=this._register(new AMe(e,t,i)):this.handler=this._register(new ug(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class x0 extends by{}class N_ extends x0{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new G(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(58);const t=e.get(59);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(83);const i=e.get(129);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(e){const t=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new G(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const r=Math.abs(this._lastCursorModelPosition.lineNumber-i);return r===0?'<span class="relative-current-line-number">'+i+"</span>":String(r)}return this._renderLineNumbers===3?this._lastCursorModelPosition.lineNumber===i||i%10===0?String(i):"":String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=zr?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,s='<div class="'+N_.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">',o=this._context.model.getLineCount(),a=[];for(let l=i;l<=r;l++){const c=l-i;if(!this._renderFinalNewline&&l===o&&this._context.model.getLineLength(l)===0){a[c]="";continue}const h=this._getLineRenderLineNumber(l);h?l===this._activeLineNumber?a[c]='<div class="active-line-number '+N_.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">'+h+"</div>":a[c]=s+h+"</div>":a[c]=""}this._renderResult=a}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}N_.CLASS_NAME="line-numbers";li((n,e)=>{const t=n.getColor(Mee);t&&e.addRule(`.monaco-editor .line-numbers { color: ${t}; }`);const i=n.getColor(RRe);i&&e.addRule(`.monaco-editor .line-numbers.active-line-number { color: ${i}; }`)});class dg extends _o{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(129);this._canUseLayerHinting=!t.get(28),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=xt(document.createElement("div")),this._domNode.setClassName(dg.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=xt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(dg.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(129);return this._canUseLayerHinting=!t.get(28),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}dg.CLASS_NAME="glyph-margin";dg.OUTER_CLASS_NAME="margin";const Mf="monaco-mouse-cursor-text";class M5{constructor(e,t,i){this._visibleTextAreaBrand=void 0,this.top=e,this.left=t,this.width=i}setWidth(e){return new M5(this.top,this.left,e)}}const J0=$r;class RMe extends _o{constructor(e,t,i){super(e),this._primaryCursorPosition=new G(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._viewHelper=i,this._scrollLeft=0,this._scrollTop=0;const r=this._context.configuration.options,s=r.get(129);this._setAccessibilityOptions(r),this._contentLeft=s.contentLeft,this._contentWidth=s.contentWidth,this._contentHeight=s.height,this._fontInfo=r.get(43),this._lineHeight=r.get(58),this._emptySelectionClipboard=r.get(32),this._copyWithSyntaxHighlighting=r.get(21),this._visibleTextArea=null,this._selections=[new je(1,1,1,1)],this._modelSelections=[new je(1,1,1,1)],this._lastRenderPosition=null,this.textArea=xt(document.createElement("textarea")),oc.write(this.textArea,6),this.textArea.setClassName(`inputarea ${Mf}`),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(r)),this.textArea.setAttribute("tabindex",String(r.get(111))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",v("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),r.get(30)&&r.get(80)&&this.textArea.setAttribute("readonly","true"),this.textAreaCover=xt(document.createElement("div")),this.textAreaCover.setPosition("absolute");const o={getLineCount:()=>this._context.model.getLineCount(),getLineMaxColumn:l=>this._context.model.getLineMaxColumn(l),getValueInRange:(l,c)=>this._context.model.getValueInRange(l,c)},a={getDataToCopy:l=>{const c=this._context.model.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,Kn),h=this._context.model.getEOL(),u=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),d=Array.isArray(c)?c:null,f=Array.isArray(c)?c.join(h):c;let g,p=null;if(l&&this._copyWithSyntaxHighlighting&&f.length<65536){const m=this._context.model.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);m&&(g=m.html,p=m.mode)}return{isFromEmptySelection:u,multicursorText:d,text:f,html:g,mode:p}},getScreenReaderContent:l=>{if(this._accessibilitySupport===1){if(wt){const c=this._selections[0];if(c.isEmpty()){const h=c.getStartPosition();let u=this._getWordBeforePosition(h);if(u.length===0&&(u=this._getCharacterBeforePosition(h)),u.length>0)return new vn(u,u.length,u.length,h,h)}}return vn.EMPTY}if(vb){const c=this._selections[0];if(c.isEmpty()){const h=c.getStartPosition(),[u,d]=this._getAndroidWordAtPosition(h);if(u.length>0)return new vn(u,d,d,h,h)}return vn.EMPTY}return tm.fromEditorSelection(l,o,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(l,c,h)=>this._context.model.deduceModelPositionRelativeToViewPosition(l,c,h)};this._textAreaInput=this._register(new LMe(a,this.textArea)),this._register(this._textAreaInput.onKeyDown(l=>{this._viewController.emitKeyDown(l)})),this._register(this._textAreaInput.onKeyUp(l=>{this._viewController.emitKeyUp(l)})),this._register(this._textAreaInput.onPaste(l=>{let c=!1,h=null,u=null;l.metadata&&(c=this._emptySelectionClipboard&&!!l.metadata.isFromEmptySelection,h=typeof l.metadata.multicursorText<"u"?l.metadata.multicursorText:null,u=l.metadata.mode),this._viewController.paste(l.text,c,h,u)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(l=>{l.replacePrevCharCnt||l.replaceNextCharCnt||l.positionDelta?this._viewController.compositionType(l.text,l.replacePrevCharCnt,l.replaceNextCharCnt,l.positionDelta):this._viewController.type(l.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(l=>{this._viewController.setSelection(l)})),this._register(this._textAreaInput.onCompositionStart(l=>{const c=this._selections[0].startLineNumber,h=this._selections[0].startColumn+l.revealDeltaColumns;this._context.model.revealRange("keyboard",!0,new V(c,h,c,h),0,1);const u=this._viewHelper.visibleRangeForPositionRelativeToEditor(c,h);u&&(this._visibleTextArea=new M5(this._context.viewLayout.getVerticalOffsetForLineNumber(c),u.left,J0?0:1),this._render()),this.textArea.setClassName(`inputarea ${Mf} ime-input`),this._viewController.compositionStart(),this._context.model.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(l=>{this._visibleTextArea&&(this._visibleTextArea=this._visibleTextArea.setWidth(MMe(l.data,this._fontInfo)),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName(`inputarea ${Mf}`),this._viewController.compositionEnd(),this._context.model.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.model.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.model.setHasFocus(!1)}))}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.model.getLineContent(e.lineNumber),r=k_(t);let s=!0,o=e.column,a=!0,l=e.column,c=0;for(;c<50&&(s||a);){if(s&&o<=1&&(s=!1),s){const h=i.charCodeAt(o-2);r.get(h)!==0?s=!1:o--}if(a&&l>i.length&&(a=!1),a){const h=i.charCodeAt(l-1);r.get(h)!==0?a=!1:l++}c++}return[i.substring(o-1,l-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.model.getLineContent(e.lineNumber),i=k_(this._context.configuration.options.get(115));let r=e.column,s=0;for(;r>1;){const o=t.charCodeAt(r-2);if(i.get(o)!==0||s>50)return t.substring(r-1,e.column-1);s++,r--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.model.getLineContent(e.lineNumber).charAt(e.column-2);if(!Ln(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){return e.get(2)===1?v("accessibilityOffAriaLabel","The editor is not accessible at this time. Press {0} for options.",zr?"Shift+Alt+F1":"Alt+F1"):e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Bg.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(129);return this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(43),this._lineHeight=t.get(58),this._emptySelectionClipboard=t.get(32),this._copyWithSyntaxHighlighting=t.get(21),this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("tabindex",String(t.get(111))),(e.hasChanged(30)||e.hasChanged(80))&&(t.get(30)&&t.get(80)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}prepareRender(e){this._primaryCursorPosition=new G(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition)}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea){this._renderInsideEditor(null,this._visibleTextArea.top-this._scrollTop,this._contentLeft+this._visibleTextArea.left-this._scrollLeft,this._visibleTextArea.width,this._lineHeight);return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(wt){this._renderInsideEditor(this._primaryCursorPosition,t,e,J0?0:1,this._lineHeight);return}this._renderInsideEditor(this._primaryCursorPosition,t,e,J0?0:1,J0?0:1)}_renderInsideEditor(e,t,i,r,s){this._lastRenderPosition=e;const o=this.textArea,a=this.textAreaCover;Yn.applyFontInfo(o,this._fontInfo),o.setTop(t),o.setLeft(i),o.setWidth(r),o.setHeight(s),a.setTop(0),a.setLeft(0),a.setWidth(0),a.setHeight(0)}_renderAtTopLeft(){this._lastRenderPosition=null;const e=this.textArea,t=this.textAreaCover;if(Yn.applyFontInfo(e,this._fontInfo),e.setTop(0),e.setLeft(0),t.setTop(0),t.setLeft(0),J0){e.setWidth(0),e.setHeight(0),t.setWidth(0),t.setHeight(0);return}e.setWidth(1),e.setHeight(1),t.setWidth(1),t.setHeight(1);const i=this._context.configuration.options;i.get(49)?t.setClassName("monaco-editor-background textAreaCover "+dg.OUTER_CLASS_NAME):i.get(59).renderType!==0?t.setClassName("monaco-editor-background textAreaCover "+N_.CLASS_NAME):t.setClassName("monaco-editor-background textAreaCover")}}function MMe(n,e){const i=document.createElement("canvas").getContext("2d");i.font=FMe(e);const r=i.measureText(n);return $r?r.width+2:r.width}function FMe(n){return OMe("normal",n.fontWeight,n.fontSize,n.lineHeight,n.fontFamily)}function OMe(n,e,t,i,r){return`${n} normal ${e} ${t}px / ${i}px ${r}`}class Hd{static columnSelect(e,t,i,r,s,o){let a=Math.abs(s-i)+1,l=i>s,c=r>o,h=r<o,u=[];for(let d=0;d<a;d++){let f=i+(l?-d:d),g=Mt.columnFromVisibleColumn2(e,t,f,r),p=Mt.columnFromVisibleColumn2(e,t,f,o),m=Mt.visibleColumnFromColumn2(e,t,new G(f,g)),b=Mt.visibleColumnFromColumn2(e,t,new G(f,p));h&&(m>o||b<r)||c&&(b>r||m<o)||u.push(new Dn(new V(f,g,f,g),0,new G(f,p),0))}if(u.length===0)for(let d=0;d<a;d++){const f=i+(l?-d:d),g=t.getLineMaxColumn(f);u.push(new Dn(new V(f,g,f,g),0,new G(f,g),0))}return{viewStates:u,reversed:l,fromLineNumber:i,fromVisualColumn:r,toLineNumber:s,toVisualColumn:o}}static columnSelectLeft(e,t,i){let r=i.toViewVisualColumn;return r>0&&r--,Hd.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,r)}static columnSelectRight(e,t,i){let r=0;const s=Math.min(i.fromViewLineNumber,i.toViewLineNumber),o=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=s;l<=o;l++){const c=t.getLineMaxColumn(l),h=Mt.visibleColumnFromColumn2(e,t,new G(l,c));r=Math.max(r,h)}let a=i.toViewVisualColumn;return a<r&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,r){const s=r?e.pageSize:1,o=Math.max(1,i.toViewLineNumber-s);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}static columnSelectDown(e,t,i,r){const s=r?e.pageSize:1,o=Math.min(t.getLineCount(),i.toViewLineNumber+s);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,o,i.toViewVisualColumn)}}class Nr{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let r=t.getInverseEditOperations()[0].range;return new je(r.endLineNumber,r.endColumn,r.endLineNumber,r.endColumn)}}class LC{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let r=t.getInverseEditOperations()[0].range;return new je(r.startLineNumber,r.startColumn,r.startLineNumber,r.startColumn)}}class GS{constructor(e,t,i,r,s=!1){this._range=e,this._text=t,this._columnDeltaOffset=r,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=s}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){let r=t.getInverseEditOperations()[0].range;return new je(r.endLineNumber+this._lineNumberDeltaOffset,r.endColumn+this._columnDeltaOffset,r.endLineNumber+this._lineNumberDeltaOffset,r.endColumn+this._columnDeltaOffset)}}class qee{constructor(e,t,i,r=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=r,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class HT{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class Tt{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-Tke(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new G(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const r=e.getLineMinColumn(t.lineNumber),s=e.getLineContent(t.lineNumber),o=Nw.atomicPosition(s,t.column-1,i,0);if(o!==-1&&o+1>=r)return new G(t.lineNumber,o+1)}return this.leftPosition(e,t)}static left(e,t,i){const r=e.stickyTabStops?Tt.leftPositionAtomicSoftTabs(t,i,e.tabSize):Tt.leftPosition(t,i);return new HT(r.lineNumber,r.column,0)}static moveLeft(e,t,i,r,s){let o,a;if(i.hasSelection()&&!r)o=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(s-1)),c=t.normalizePosition(Tt.clipPositionColumn(l,t),0),h=Tt.left(e,t,c);o=h.lineNumber,a=h.column}return i.move(r,o,a,0)}static clipPositionColumn(e,t){return new G(e.lineNumber,Tt.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+wE(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new G(t,i)}static rightPositionAtomicSoftTabs(e,t,i,r,s){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),a=Nw.atomicPosition(o,i-1,r,1);if(a!==-1)return new G(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const r=e.stickyTabStops?Tt.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):Tt.rightPosition(t,i.lineNumber,i.column);return new HT(r.lineNumber,r.column,0)}static moveRight(e,t,i,r,s){let o,a;if(i.hasSelection()&&!r)o=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,s-1),c=t.normalizePosition(Tt.clipPositionColumn(l,t),1),h=Tt.right(e,t,c);o=h.lineNumber,a=h.column}return i.move(r,o,a,0)}static vertical(e,t,i,r,s,o,a){const l=Mt.visibleColumnFromColumn(t.getLineContent(i),r,e.tabSize)+s,c=t.getLineCount(),h=i===1&&r===1,u=i===c&&r===t.getLineMaxColumn(i),d=o<i?h:u;return i=o,i<1?(i=1,a?r=t.getLineMinColumn(i):r=Math.min(t.getLineMaxColumn(i),r)):i>c?(i=c,a?r=t.getLineMaxColumn(i):r=Math.min(t.getLineMaxColumn(i),r)):r=Mt.columnFromVisibleColumn2(e,t,i,l),d?s=0:s=l-Mt.visibleColumnFromColumn(t.getLineContent(i),r,e.tabSize),new HT(i,r,s)}static down(e,t,i,r,s,o,a){return this.vertical(e,t,i,r,s,i+o,a)}static moveDown(e,t,i,r,s){let o,a;i.hasSelection()&&!r?(o=i.selection.endLineNumber,a=i.selection.endColumn):(o=i.position.lineNumber,a=i.position.column);let l=Tt.down(e,t,o,a,i.leftoverVisibleColumns,s,!0);return i.move(r,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateDown(e,t,i){let r=i.selection,s=Tt.down(e,t,r.selectionStartLineNumber,r.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Tt.down(e,t,r.positionLineNumber,r.positionColumn,i.leftoverVisibleColumns,1,!1);return new Dn(new V(s.lineNumber,s.column,s.lineNumber,s.column),s.leftoverVisibleColumns,new G(o.lineNumber,o.column),o.leftoverVisibleColumns)}static up(e,t,i,r,s,o,a){return this.vertical(e,t,i,r,s,i-o,a)}static moveUp(e,t,i,r,s){let o,a;i.hasSelection()&&!r?(o=i.selection.startLineNumber,a=i.selection.startColumn):(o=i.position.lineNumber,a=i.position.column);let l=Tt.up(e,t,o,a,i.leftoverVisibleColumns,s,!0);return i.move(r,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){let r=i.selection,s=Tt.up(e,t,r.selectionStartLineNumber,r.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),o=Tt.up(e,t,r.positionLineNumber,r.positionColumn,i.leftoverVisibleColumns,1,!1);return new Dn(new V(s.lineNumber,s.column,s.lineNumber,s.column),s.leftoverVisibleColumns,new G(o.lineNumber,o.column),o.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,r){let s=i.position.lineNumber;for(;s>1&&this._isBlankLine(t,s);)s--;for(;s>1&&!this._isBlankLine(t,s);)s--;return i.move(r,s,t.getLineMinColumn(s),0)}static moveToNextBlankLine(e,t,i,r){const s=t.getLineCount();let o=i.position.lineNumber;for(;o<s&&this._isBlankLine(t,o);)o++;for(;o<s&&!this._isBlankLine(t,o);)o++;return i.move(r,o,t.getLineMinColumn(o),0)}static moveToBeginningOfLine(e,t,i,r){let s=i.position.lineNumber,o=t.getLineMinColumn(s),a=t.getLineFirstNonWhitespaceColumn(s)||o,l;return i.position.column===a?l=o:l=a,i.move(r,s,l,0)}static moveToEndOfLine(e,t,i,r,s){let o=i.position.lineNumber,a=t.getLineMaxColumn(o);return i.move(r,o,a,s?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,r){return i.move(r,1,1,0)}static moveToEndOfBuffer(e,t,i,r){let s=t.getLineCount(),o=t.getLineMaxColumn(s);return i.move(r,s,o,0)}}class fg{static deleteRight(e,t,i,r){let s=[],o=e!==3;for(let a=0,l=r.length;a<l;a++){const c=r[a];let h=c;if(h.isEmpty()){let u=c.getPosition(),d=Tt.right(t,i,u);h=new V(d.lineNumber,d.column,u.lineNumber,u.column)}if(h.isEmpty()){s[a]=null;continue}h.startLineNumber!==h.endLineNumber&&(o=!0),s[a]=new Nr(h,"")}return[o,s]}static isAutoClosingPairDelete(e,t,i,r,s,o,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=o.length;l<c;l++){const h=o[l],u=h.getPosition();if(!h.isEmpty())return!1;const d=s.getLineContent(u.lineNumber);if(u.column<2||u.column>=d.length+1)return!1;const f=d.charAt(u.column-2),g=r.get(f);if(!g)return!1;if(Vp(f)){if(i==="never")return!1}else if(t==="never")return!1;const p=d.charAt(u.column-1);let m=!1;for(const b of g)b.open===f&&b.close===p&&(m=!0);if(!m)return!1;if(e==="auto"){let b=!1;for(let _=0,w=a.length;_<w;_++){const y=a[_];if(u.lineNumber===y.startLineNumber&&u.column===y.startColumn){b=!0;break}}if(!b)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){let r=[];for(let s=0,o=i.length;s<o;s++){const a=i[s].getPosition(),l=new V(a.lineNumber,a.column-1,a.lineNumber,a.column+1);r[s]=new Nr(l,"")}return[!0,r]}static deleteLeft(e,t,i,r,s){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,r,s))return this._runAutoClosingPairDelete(t,i,r);const o=[];let a=e!==2;for(let l=0,c=r.length;l<c;l++){let h=fg.getDeleteRange(r[l],i,t);if(h.isEmpty()){o[l]=null;continue}h.startLineNumber!==h.endLineNumber&&(a=!0),o[l]=new Nr(h,"")}return[a,o]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const r=e.getPosition();if(i.useTabStops&&r.column>1){const s=t.getLineContent(r.lineNumber),o=cs(s),a=o===-1?s.length+1:o+1;if(r.column<=a){const l=Mt.visibleColumnFromColumn2(i,t,r),c=Mt.prevIndentTabStop(l,i.indentSize),h=Mt.columnFromVisibleColumn2(i,t,r.lineNumber,c);return new V(r.lineNumber,h,r.lineNumber,r.column)}}return V.fromPositions(fg.getPositionAfterDeleteLeft(r,t),r)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=Vke(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new G(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){let r=[],s=null;i.sort((o,a)=>G.compare(o.getStartPosition(),a.getEndPosition()));for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())if(e.emptySelectionClipboard){let c=l.getPosition(),h,u,d,f;c.lineNumber<t.getLineCount()?(h=c.lineNumber,u=1,d=c.lineNumber+1,f=1):c.lineNumber>1&&(s==null?void 0:s.endLineNumber)!==c.lineNumber?(h=c.lineNumber-1,u=t.getLineMaxColumn(c.lineNumber-1),d=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber)):(h=c.lineNumber,u=1,d=c.lineNumber,f=t.getLineMaxColumn(c.lineNumber));let g=new V(h,u,d,f);s=g,g.isEmpty()?r[o]=null:r[o]=new Nr(g,"")}else r[o]=null;else r[o]=new Nr(l,"")}return new ts(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Ei{static _createWord(e,t,i,r,s){return{start:r,end:s,wordType:t,nextCharClass:i}}static _findPreviousWordOnLine(e,t,i){let r=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(r,e,i)}static _doFindPreviousWordOnLine(e,t,i){let r=0;for(let s=i.column-2;s>=0;s--){let o=e.charCodeAt(s),a=t.get(o);if(a===0){if(r===2)return this._createWord(e,r,a,s+1,this._findEndOfWord(e,t,r,s+1));r=1}else if(a===2){if(r===1)return this._createWord(e,r,a,s+1,this._findEndOfWord(e,t,r,s+1));r=2}else if(a===1&&r!==0)return this._createWord(e,r,a,s+1,this._findEndOfWord(e,t,r,s+1))}return r!==0?this._createWord(e,r,1,0,this._findEndOfWord(e,t,r,0)):null}static _findEndOfWord(e,t,i,r){let s=e.length;for(let o=r;o<s;o++){let a=e.charCodeAt(o),l=t.get(a);if(l===1||i===1&&l===2||i===2&&l===0)return o}return s}static _findNextWordOnLine(e,t,i){let r=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(r,e,i)}static _doFindNextWordOnLine(e,t,i){let r=0,s=e.length;for(let o=i.column-1;o<s;o++){let a=e.charCodeAt(o),l=t.get(a);if(l===0){if(r===2)return this._createWord(e,r,l,this._findStartOfWord(e,t,r,o-1),o);r=1}else if(l===2){if(r===1)return this._createWord(e,r,l,this._findStartOfWord(e,t,r,o-1),o);r=2}else if(l===1&&r!==0)return this._createWord(e,r,l,this._findStartOfWord(e,t,r,o-1),o)}return r!==0?this._createWord(e,r,1,this._findStartOfWord(e,t,r,s-1),s):null}static _findStartOfWord(e,t,i,r){for(let s=r;s>=0;s--){let o=e.charCodeAt(s),a=t.get(o);if(a===1||i===1&&a===2||i===2&&a===0)return s+1}return 0}static moveWordLeft(e,t,i,r){let s=i.lineNumber,o=i.column;o===1&&s>1&&(s=s-1,o=t.getLineMaxColumn(s));let a=Ei._findPreviousWordOnLine(e,t,new G(s,o));if(r===0)return new G(s,a?a.start+1:1);if(r===1)return a&&a.wordType===2&&a.end-a.start===1&&a.nextCharClass===0&&(a=Ei._findPreviousWordOnLine(e,t,new G(s,a.start+1))),new G(s,a?a.start+1:1);if(r===3){for(;a&&a.wordType===2;)a=Ei._findPreviousWordOnLine(e,t,new G(s,a.start+1));return new G(s,a?a.start+1:1)}return a&&o<=a.end+1&&(a=Ei._findPreviousWordOnLine(e,t,new G(s,a.start+1))),new G(s,a?a.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,r=e.getLineMaxColumn(i);if(t.column===1)return i>1?new G(i-1,e.getLineMaxColumn(i-1)):t;const s=e.getLineContent(i);for(let o=t.column-1;o>1;o--){const a=s.charCodeAt(o-2),l=s.charCodeAt(o-1);if(a===95&&l!==95)return new G(i,o);if(Yp(a)&&Xh(l))return new G(i,o);if(Xh(a)&&Xh(l)&&o+1<r){const c=s.charCodeAt(o);if(Yp(c))return new G(i,o)}}return new G(i,1)}static moveWordRight(e,t,i,r){let s=i.lineNumber,o=i.column,a=!1;o===t.getLineMaxColumn(s)&&s<t.getLineCount()&&(a=!0,s=s+1,o=1);let l=Ei._findNextWordOnLine(e,t,new G(s,o));if(r===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=Ei._findNextWordOnLine(e,t,new G(s,l.end+1))),l?o=l.end+1:o=t.getLineMaxColumn(s);else if(r===3){for(a&&(o=0);l&&(l.wordType===2||l.start+1<=o);)l=Ei._findNextWordOnLine(e,t,new G(s,l.end+1));l?o=l.start+1:o=t.getLineMaxColumn(s)}else l&&!a&&o>=l.start+1&&(l=Ei._findNextWordOnLine(e,t,new G(s,l.end+1))),l?o=l.start+1:o=t.getLineMaxColumn(s);return new G(s,o)}static _moveWordPartRight(e,t){const i=t.lineNumber,r=e.getLineMaxColumn(i);if(t.column===r)return i<e.getLineCount()?new G(i+1,1):t;const s=e.getLineContent(i);for(let o=t.column+1;o<r;o++){const a=s.charCodeAt(o-2),l=s.charCodeAt(o-1);if(a!==95&&l===95)return new G(i,o);if(Yp(a)&&Xh(l))return new G(i,o);if(Xh(a)&&Xh(l)&&o+1<r){const c=s.charCodeAt(o);if(Yp(c))return new G(i,o)}}return new G(i,r)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),r=t.column-2,s=_0(i,r);return s+1<r?new V(t.lineNumber,s+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,r=e.model,s=e.selection,o=e.whitespaceHeuristics;if(!s.isEmpty())return s;if(fg.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const u=e.selection.getPosition();return new V(u.lineNumber,u.column-1,u.lineNumber,u.column+1)}const a=new G(s.positionLineNumber,s.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(o){let u=this._deleteWordLeftWhitespace(r,a);if(u)return u}let h=Ei._findPreviousWordOnLine(i,r,a);return t===0?h?c=h.start+1:c>1?c=1:(l--,c=r.getLineMaxColumn(l)):(h&&c<=h.end+1&&(h=Ei._findPreviousWordOnLine(i,r,new G(l,h.start+1))),h?c=h.end+1:c>1?c=1:(l--,c=r.getLineMaxColumn(l))),new V(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const r=new G(i.positionLineNumber,i.positionColumn);let s=this._deleteInsideWordWhitespace(t,r);return s||this._deleteInsideWordDetermineDeleteRange(e,t,r)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),r=i.length;if(r===0)return null;let s=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,s))return null;let o=Math.min(t.column-1,r-1);if(!this._charAtIsWhitespace(i,o))return null;for(;s>0&&this._charAtIsWhitespace(i,s-1);)s--;for(;o+1<r&&this._charAtIsWhitespace(i,o+1);)o++;return new V(t.lineNumber,s+1,t.lineNumber,o+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const r=t.getLineContent(i.lineNumber),s=r.length;if(s===0)return i.lineNumber>1?new V(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new V(i.lineNumber,1,i.lineNumber+1,1):new V(i.lineNumber,1,i.lineNumber,1);const o=u=>u.start+1<=i.column&&i.column<=u.end+1,a=(u,d)=>(u=Math.min(u,i.column),d=Math.max(d,i.column),new V(i.lineNumber,u,i.lineNumber,d)),l=u=>{let d=u.start+1,f=u.end+1,g=!1;for(;f-1<s&&this._charAtIsWhitespace(r,f-1);)g=!0,f++;if(!g)for(;d>1&&this._charAtIsWhitespace(r,d-2);)d--;return a(d,f)},c=Ei._findPreviousWordOnLine(e,t,i);if(c&&o(c))return l(c);const h=Ei._findNextWordOnLine(e,t,i);return h&&o(h)?l(h):c&&h?a(c.end+1,h.start+1):c?a(c.start+1,c.end+1):h?a(h.start+1,h.end+1):a(1,s+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),r=Ei._moveWordPartLeft(e,i);return new V(i.lineNumber,i.column,r.lineNumber,r.column)}static _findFirstNonWhitespaceChar(e,t){let i=e.length;for(let r=t;r<i;r++){let s=e.charAt(r);if(s!==" "&&s!=="	")return r}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),r=t.column-1,s=this._findFirstNonWhitespaceChar(i,r);return r+1<s?new V(t.lineNumber,t.column,t.lineNumber,s+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,r=e.model,s=e.selection,o=e.whitespaceHeuristics;if(!s.isEmpty())return s;const a=new G(s.positionLineNumber,s.positionColumn);let l=a.lineNumber,c=a.column;const h=r.getLineCount(),u=r.getLineMaxColumn(l);if(l===h&&c===u)return null;if(o){let f=this._deleteWordRightWhitespace(r,a);if(f)return f}let d=Ei._findNextWordOnLine(i,r,a);return t===2?d?c=d.end+1:c<u||l===h?c=u:(l++,d=Ei._findNextWordOnLine(i,r,new G(l,1)),d?c=d.start+1:c=r.getLineMaxColumn(l)):(d&&c>=d.start+1&&(d=Ei._findNextWordOnLine(i,r,new G(l,d.end+1))),d?c=d.start+1:c<u||l===h?c=u:(l++,d=Ei._findNextWordOnLine(i,r,new G(l,1)),d?c=d.start+1:c=r.getLineMaxColumn(l))),new V(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),r=Ei._moveWordPartRight(e,i);return new V(i.lineNumber,i.column,r.lineNumber,r.column)}static _createWordAtPosition(e,t,i){const r=new V(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(r),startColumn:r.startColumn,endColumn:r.endColumn}}static getWordAtPosition(e,t,i){const r=k_(t),s=Ei._findPreviousWordOnLine(r,e,i);if(s&&s.wordType===1&&s.start<=i.column-1&&i.column-1<=s.end)return Ei._createWordAtPosition(e,i.lineNumber,s);const o=Ei._findNextWordOnLine(r,e,i);return o&&o.wordType===1&&o.start<=i.column-1&&i.column-1<=o.end?Ei._createWordAtPosition(e,i.lineNumber,o):null}static word(e,t,i,r,s){const o=k_(e.wordSeparators);let a=Ei._findPreviousWordOnLine(o,t,s),l=Ei._findNextWordOnLine(o,t,s);if(!r){let f,g;return a&&a.wordType===1&&a.start<=s.column-1&&s.column-1<=a.end?(f=a.start+1,g=a.end+1):l&&l.wordType===1&&l.start<=s.column-1&&s.column-1<=l.end?(f=l.start+1,g=l.end+1):(a?f=a.end+1:f=1,l?g=l.start+1:g=t.getLineMaxColumn(s.lineNumber)),new Dn(new V(s.lineNumber,f,s.lineNumber,g),0,new G(s.lineNumber,g),0)}let c,h;a&&a.wordType===1&&a.start<s.column-1&&s.column-1<a.end?(c=a.start+1,h=a.end+1):l&&l.wordType===1&&l.start<s.column-1&&s.column-1<l.end?(c=l.start+1,h=l.end+1):(c=s.column,h=s.column);let u=s.lineNumber,d;if(i.selectionStart.containsPosition(s))d=i.selectionStart.endColumn;else if(s.isBeforeOrEqual(i.selectionStart.getStartPosition())){d=c;let f=new G(u,d);i.selectionStart.containsPosition(f)&&(d=i.selectionStart.endColumn)}else{d=h;let f=new G(u,d);i.selectionStart.containsPosition(f)&&(d=i.selectionStart.startColumn)}return i.move(!0,u,d,0)}}class xn{static addCursorDown(e,t,i){let r=[],s=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];r[s++]=new st(l.modelState,l.viewState),i?r[s++]=st.fromModelState(Tt.translateDown(e.cursorConfig,e.model,l.modelState)):r[s++]=st.fromViewState(Tt.translateDown(e.cursorConfig,e,l.viewState))}return r}static addCursorUp(e,t,i){let r=[],s=0;for(let o=0,a=t.length;o<a;o++){const l=t[o];r[s++]=new st(l.modelState,l.viewState),i?r[s++]=st.fromModelState(Tt.translateUp(e.cursorConfig,e.model,l.modelState)):r[s++]=st.fromViewState(Tt.translateUp(e.cursorConfig,e,l.viewState))}return r}static moveToBeginningOfLine(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s];r[s]=this._moveToLineStart(e,a,i)}return r}static _moveToLineStart(e,t,i){const r=t.viewState.position.column,s=t.modelState.position.column,o=r===s,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!o&&!(r===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return st.fromViewState(Tt.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return st.fromModelState(Tt.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];s[o]=this._moveToLineEnd(e,l,i,r)}return s}static _moveToLineEnd(e,t,i,r){const s=t.viewState.position,o=e.getLineMaxColumn(s.lineNumber),a=s.column===o,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),h=o-s.column===c-l.column;return a||h?this._moveToLineEndByModel(e,t,i,r):this._moveToLineEndByView(e,t,i,r)}static _moveToLineEndByView(e,t,i,r){return st.fromViewState(Tt.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,r))}static _moveToLineEndByModel(e,t,i,r){return st.fromModelState(Tt.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,r))}static expandLineSelection(e,t){let i=[];for(let r=0,s=t.length;r<s;r++){const o=t[r],a=o.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=o.modelState.selection.endLineNumber,h;c===l?h=e.model.getLineMaxColumn(l):(c++,h=1),i[r]=st.fromModelState(new Dn(new V(a,1,a,1),0,new G(c,h),0))}return i}static moveToBeginningOfBuffer(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s];r[s]=st.fromModelState(Tt.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return r}static moveToEndOfBuffer(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s];r[s]=st.fromModelState(Tt.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return r}static selectAll(e,t){const i=e.model.getLineCount(),r=e.model.getLineMaxColumn(i);return st.fromModelState(new Dn(new V(1,1,1,1),0,new G(i,r),0))}static line(e,t,i,r,s){const o=e.model.validatePosition(r),a=s?e.coordinatesConverter.validateViewPosition(new G(s.lineNumber,s.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);if(!i||!t.modelState.hasSelection()){const c=e.model.getLineCount();let h=o.lineNumber+1,u=1;return h>c&&(h=c,u=e.model.getLineMaxColumn(h)),st.fromModelState(new Dn(new V(o.lineNumber,1,h,u),0,new G(h,u),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(o.lineNumber<l)return st.fromViewState(t.viewState.move(t.modelState.hasSelection(),a.lineNumber,1,0));if(o.lineNumber>l){const c=e.getLineCount();let h=a.lineNumber+1,u=1;return h>c&&(h=c,u=e.getLineMaxColumn(h)),st.fromViewState(t.viewState.move(t.modelState.hasSelection(),h,u,0))}else{const c=t.modelState.selectionStart.getEndPosition();return st.fromModelState(t.modelState.move(t.modelState.hasSelection(),c.lineNumber,c.column,0))}}static word(e,t,i,r){const s=e.model.validatePosition(r);return st.fromModelState(Ei.word(e.cursorConfig,e.model,t.modelState,i,s))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new st(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,r=t.viewState.position.column;return st.fromViewState(new Dn(new V(i,r,i,r),0,new G(i,r),0))}static moveTo(e,t,i,r,s){const o=e.model.validatePosition(r),a=s?e.coordinatesConverter.validateViewPosition(new G(s.lineNumber,s.column),o):e.coordinatesConverter.convertModelPositionToViewPosition(o);return st.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,r,s,o){switch(i){case 0:return o===4?this._moveHalfLineLeft(e,t,r):this._moveLeft(e,t,r,s);case 1:return o===4?this._moveHalfLineRight(e,t,r):this._moveRight(e,t,r,s);case 2:return o===2?this._moveUpByViewLines(e,t,r,s):this._moveUpByModelLines(e,t,r,s);case 3:return o===2?this._moveDownByViewLines(e,t,r,s):this._moveDownByModelLines(e,t,r,s);case 4:return o===2?t.map(a=>st.fromViewState(Tt.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,r))):t.map(a=>st.fromModelState(Tt.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,r)));case 5:return o===2?t.map(a=>st.fromViewState(Tt.moveToNextBlankLine(e.cursorConfig,e,a.viewState,r))):t.map(a=>st.fromModelState(Tt.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,r)));case 6:return this._moveToViewMinColumn(e,t,r);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,r);case 8:return this._moveToViewCenterColumn(e,t,r);case 9:return this._moveToViewMaxColumn(e,t,r);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,r);default:return null}}static viewportMove(e,t,i,r,s){const o=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(o);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,s),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],r,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,s),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],r,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],r,l,c)]}case 14:{let l=[];for(let c=0,h=t.length;c<h;c++){const u=t[c];l[c]=this.findPositionInViewportIfOutside(e,u,o,r)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,r){let s=t.viewState.position.lineNumber;if(i.startLineNumber<=s&&s<=i.endLineNumber-1)return new st(t.modelState,t.viewState);{let o;s>i.endLineNumber-1?o=i.endLineNumber-1:s<i.startLineNumber?o=i.startLineNumber:o=s;const a=Tt.vertical(e.cursorConfig,e,s,t.viewState.position.column,t.viewState.leftoverVisibleColumns,o,!1);return st.fromViewState(t.viewState.move(r,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let r=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(r)&&r++,Math.min(t.endLineNumber,r+i-1)}static _lastLineNumberInRange(e,t,i){let r=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(r)&&r++,Math.max(r,t.endLineNumber-i+1)}static _moveLeft(e,t,i,r){return t.map(s=>st.fromViewState(Tt.moveLeft(e.cursorConfig,e,s.viewState,i,r)))}static _moveHalfLineLeft(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);r[s]=st.fromViewState(Tt.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return r}static _moveRight(e,t,i,r){return t.map(s=>st.fromViewState(Tt.moveRight(e.cursorConfig,e,s.viewState,i,r)))}static _moveHalfLineRight(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round(e.getLineContent(l).length/2);r[s]=st.fromViewState(Tt.moveRight(e.cursorConfig,e,a.viewState,i,c))}return r}static _moveDownByViewLines(e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];s[o]=st.fromViewState(Tt.moveDown(e.cursorConfig,e,l.viewState,i,r))}return s}static _moveDownByModelLines(e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];s[o]=st.fromModelState(Tt.moveDown(e.cursorConfig,e.model,l.modelState,i,r))}return s}static _moveUpByViewLines(e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];s[o]=st.fromViewState(Tt.moveUp(e.cursorConfig,e,l.viewState,i,r))}return s}static _moveUpByModelLines(e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];s[o]=st.fromModelState(Tt.moveUp(e.cursorConfig,e.model,l.modelState,i,r))}return s}static _moveToViewPosition(e,t,i,r,s){return st.fromViewState(t.viewState.move(i,r,s,0))}static _moveToModelPosition(e,t,i,r,s){return st.fromModelState(t.modelState.move(i,r,s,0))}static _moveToViewMinColumn(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);r[s]=this._moveToViewPosition(e,a,i,l,c)}return r}static _moveToViewFirstNonWhitespaceColumn(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);r[s]=this._moveToViewPosition(e,a,i,l,c)}return r}static _moveToViewCenterColumn(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);r[s]=this._moveToViewPosition(e,a,i,l,c)}return r}static _moveToViewMaxColumn(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);r[s]=this._moveToViewPosition(e,a,i,l,c)}return r}static _moveToViewLastNonWhitespaceColumn(e,t,i){let r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);r[s]=this._moveToViewPosition(e,a,i,l,c)}return r}}var nD;(function(n){const e=function(i){if(!Br(i))return!1;let r=i;return!(!Ga(r.to)||!yr(r.select)&&!$Q(r.select)||!yr(r.by)&&!Ga(r.by)||!yr(r.value)&&!sg(r.value))};n.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},n.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let r;switch(i.to){case n.RawDirection.Left:r=0;break;case n.RawDirection.Right:r=1;break;case n.RawDirection.Up:r=2;break;case n.RawDirection.Down:r=3;break;case n.RawDirection.PrevBlankLine:r=4;break;case n.RawDirection.NextBlankLine:r=5;break;case n.RawDirection.WrappedLineStart:r=6;break;case n.RawDirection.WrappedLineFirstNonWhitespaceCharacter:r=7;break;case n.RawDirection.WrappedLineColumnCenter:r=8;break;case n.RawDirection.WrappedLineEnd:r=9;break;case n.RawDirection.WrappedLineLastNonWhitespaceCharacter:r=10;break;case n.RawDirection.ViewPortTop:r=11;break;case n.RawDirection.ViewPortBottom:r=13;break;case n.RawDirection.ViewPortCenter:r=12;break;case n.RawDirection.ViewPortIfOutside:r=14;break;default:return null}let s=0;switch(i.by){case n.RawUnit.Line:s=1;break;case n.RawUnit.WrappedLine:s=2;break;case n.RawUnit.Character:s=3;break;case n.RawUnit.HalfLine:s=4;break}return{direction:r,unit:s,select:!!i.select,value:i.value||1}}n.parse=t})(nD||(nD={}));const UT=Object.create(null);function xd(n,e){if(e<=0)return"";UT[n]||(UT[n]=["",n]);const t=UT[n];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+n;return t[e]}class au{constructor(e,t){this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,i,r,s){const o=Mt.visibleColumnFromColumn(e,t,i);if(s){const a=xd(" ",r),c=Mt.prevIndentTabStop(o,r)/r;return xd(a,c)}else{const a="	",c=Mt.prevRenderTabStop(o,i)/i;return xd(a,c)}}static shiftIndent(e,t,i,r,s){const o=Mt.visibleColumnFromColumn(e,t,i);if(s){const a=xd(" ",r),c=Mt.nextIndentTabStop(o,r)/r;return xd(a,c)}else{const a="	",c=Mt.nextRenderTabStop(o,i)/i;return xd(a,c)}}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let r=this._selection.endLineNumber;this._selection.endColumn===1&&i!==r&&(r=r-1);const{tabSize:s,indentSize:o,insertSpaces:a}=this._opts,l=i===r;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,h=0;for(let u=i;u<=r;u++,c=h){h=0;let d=e.getLineContent(u),f=cs(d);if(this._opts.isUnshift&&(d.length===0||f===0)||!l&&!this._opts.isUnshift&&d.length===0)continue;if(f===-1&&(f=d.length),u>1&&Mt.visibleColumnFromColumn(d,f+1,s)%o!==0&&e.isCheapToTokenize(u-1)){let m=zi.getEnterAction(this._opts.autoIndent,e,new V(u-1,e.getLineMaxColumn(u-1),u-1,e.getLineMaxColumn(u-1)));if(m){if(h=c,m.appendText)for(let b=0,_=m.appendText.length;b<_&&h<o&&m.appendText.charCodeAt(b)===32;b++)h++;m.removeText&&(h=Math.max(0,h-m.removeText));for(let b=0;b<h&&!(f===0||d.charCodeAt(f-1)!==32);b++)f--}}if(this._opts.isUnshift&&f===0)continue;let g;this._opts.isUnshift?g=au.unshiftIndent(d,f+1,s,o,a):g=au.shiftIndent(d,f+1,s,o,a),this._addEditOperation(t,new V(u,1,u,f+1),g),u===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=f+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?xd(" ",o):"	";for(let h=i;h<=r;h++){const u=e.getLineContent(h);let d=cs(u);if(!(this._opts.isUnshift&&(u.length===0||d===0))&&!(!l&&!this._opts.isUnshift&&u.length===0)&&(d===-1&&(d=u.length),!(this._opts.isUnshift&&d===0)))if(this._opts.isUnshift){d=Math.min(d,o);for(let f=0;f<d;f++)if(u.charCodeAt(f)===9){d=f+1;break}this._addEditOperation(t,new V(h,1,h,d+1),"")}else this._addEditOperation(t,new V(h,1,h,1),c),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){let r=t.getInverseEditOperations()[0];return new je(r.range.endLineNumber,r.range.endColumn,r.range.endLineNumber,r.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){let r=this._selection.startColumn;return i.startColumn<=r?i:i.getDirection()===0?new je(i.startLineNumber,r,i.endLineNumber,i.endColumn):new je(i.endLineNumber,i.endColumn,i.startLineNumber,r)}return i}}class PMe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new V(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new V(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){let i=t.getInverseEditOperations(),r=i[0].range,s=i[1].range;return new je(r.endLineNumber,r.endColumn,s.endLineNumber,s.endColumn-this._charAfterSelection.length)}}class Di{static indent(e,t,i){if(t===null||i===null)return[];let r=[];for(let s=0,o=i.length;s<o;s++)r[s]=new au(i[s],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return r}static outdent(e,t,i){let r=[];for(let s=0,o=i.length;s<o;s++)r[s]=new au(i[s],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return r}static shiftIndent(e,t,i){return i=i||1,au.shiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,i){return i=i||1,au.unshiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,i,r){let s=[];for(let o=0,a=i.length;o<a;o++)s[o]=new Nr(i[o],r[o]);return new ts(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,r,s){let o=[];for(let a=0,l=i.length;a<l;a++){const c=i[a];let h=c.getPosition();if(s&&!c.isEmpty()&&(s=!1),s&&r.indexOf(`
`)!==r.length-1&&(s=!1),s){let u=new V(h.lineNumber,1,h.lineNumber,1);o[a]=new qee(u,r,c,!0)}else o[a]=new Nr(c,r)}return new ts(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,i,r,s){if(r||t.length===1)return null;if(s&&s.length===t.length)return s;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substr(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substr(0,i.length-1));let o=nc(i);if(o.length===t.length)return o}return null}static paste(e,t,i,r,s,o){const a=this._distributePasteToCursors(e,i,r,s,o);return a?(i=i.sort(V.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,r,s)}static _goodIndentForLine(e,t,i){let r=null,s="";const o=zi.getInheritIndentForLine(e.autoIndent,t,i,!1);if(o)r=o.action,s=o.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const h=t.getLineContent(a);if(_0(h)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=zi.getEnterAction(e.autoIndent,t,new V(a,l,a,l));c&&(s=c.indentation+c.appendText)}return r&&(r===_n.Indent&&(s=Di.shiftIndent(e,s)),r===_n.Outdent&&(s=Di.unshiftIndent(e,s)),s=e.normalizeIndentation(s)),s||null}static _replaceJumpToNextIndent(e,t,i,r){let s="",o=i.getStartPosition();if(e.insertSpaces){let a=Mt.visibleColumnFromColumn2(e,t,o),l=e.indentSize,c=l-a%l;for(let h=0;h<c;h++)s+=" "}else s="	";return new Nr(i,s,r)}static tab(e,t,i){let r=[];for(let s=0,o=i.length;s<o;s++){const a=i[s];if(a.isEmpty()){let l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";let h=e.normalizeIndentation(c);if(!l.startsWith(h)){r[s]=new Nr(new V(a.startLineNumber,1,a.startLineNumber,l.length+1),h,!0);continue}}r[s]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){let l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){r[s]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}r[s]=new au(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent})}}return r}static compositionType(e,t,i,r,s,o,a,l){const c=r.map(h=>this._compositionType(i,h,s,o,a,l));return new ts(4,c,{shouldPushStackElementBefore:IC(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,r,s,o){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-r),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+s),h=new V(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(h)===i&&o===0?null:new GS(h,i,0,o)}static _typeCommand(e,t,i){return i?new LC(e,t,!0):new Nr(e,t,!0)}static _enter(e,t,i,r){if(e.autoIndent===0)return Di._typeCommand(r,`
`,i);if(!t.isCheapToTokenize(r.getStartPosition().lineNumber)||e.autoIndent===1){let l=t.getLineContent(r.startLineNumber),c=rn(l).substring(0,r.startColumn-1);return Di._typeCommand(r,`
`+e.normalizeIndentation(c),i)}const s=zi.getEnterAction(e.autoIndent,t,r);if(s){if(s.indentAction===_n.None)return Di._typeCommand(r,`
`+e.normalizeIndentation(s.indentation+s.appendText),i);if(s.indentAction===_n.Indent)return Di._typeCommand(r,`
`+e.normalizeIndentation(s.indentation+s.appendText),i);if(s.indentAction===_n.IndentOutdent){const l=e.normalizeIndentation(s.indentation),c=e.normalizeIndentation(s.indentation+s.appendText),h=`
`+c+`
`+l;return i?new LC(r,h,!0):new GS(r,h,-1,c.length-l.length,!0)}else if(s.indentAction===_n.Outdent){const l=Di.unshiftIndent(e,s.indentation);return Di._typeCommand(r,`
`+e.normalizeIndentation(l+s.appendText),i)}}const o=t.getLineContent(r.startLineNumber),a=rn(o).substring(0,r.startColumn-1);if(e.autoIndent>=4){const l=zi.getIndentForEnter(e.autoIndent,t,r,{unshiftIndent:c=>Di.unshiftIndent(e,c),shiftIndent:c=>Di.shiftIndent(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)});if(l){let c=Mt.visibleColumnFromColumn2(e,t,r.getEndPosition());const h=r.endColumn,u=t.getLineContent(r.endLineNumber),d=cs(u);if(d>=0?r=r.setEndPosition(r.endLineNumber,Math.max(r.endColumn,d+1)):r=r.setEndPosition(r.endLineNumber,t.getLineMaxColumn(r.endLineNumber)),i)return new LC(r,`
`+e.normalizeIndentation(l.afterEnter),!0);{let f=0;return h<=d+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),f=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new GS(r,`
`+e.normalizeIndentation(l.afterEnter),0,f,!0)}}}return Di._typeCommand(r,`
`+e.normalizeIndentation(a),i)}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let r=0,s=i.length;r<s;r++)if(!t.isCheapToTokenize(i[r].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,i,r){const s=zi.getIndentationAtPosition(t,i.startLineNumber,i.startColumn),o=zi.getIndentActionForType(e.autoIndent,t,i,r,{shiftIndent:a=>Di.shiftIndent(e,a),unshiftIndent:a=>Di.unshiftIndent(e,a)});if(o===null)return null;if(o!==e.normalizeIndentation(s)){const a=t.getLineFirstNonWhitespaceColumn(i.startLineNumber);return a===0?Di._typeCommand(new V(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(o)+r,!1):Di._typeCommand(new V(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(o)+t.getLineContent(i.startLineNumber).substring(a-1,i.startColumn-1)+r,!1)}return null}static _isAutoClosingOvertype(e,t,i,r,s){if(e.autoClosingOvertype==="never"||!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(s))return!1;for(let o=0,a=i.length;o<a;o++){const l=i[o];if(!l.isEmpty())return!1;const c=l.getPosition(),h=t.getLineContent(c.lineNumber);if(h.charAt(c.column-1)!==s)return!1;const d=Vp(s);if((c.column>2?h.charCodeAt(c.column-2):0)===92&&d)return!1;if(e.autoClosingOvertype==="auto"){let g=!1;for(let p=0,m=r.length;p<m;p++){const b=r[p];if(c.lineNumber===b.startLineNumber&&c.column===b.startColumn){g=!0;break}}if(!g)return!1}}return!0}static _runAutoClosingOvertype(e,t,i,r,s){let o=[];for(let a=0,l=r.length;a<l;a++){const h=r[a].getPosition(),u=new V(h.lineNumber,h.column,h.lineNumber,h.column+1);o[a]=new Nr(u,s)}return new ts(4,o,{shouldPushStackElementBefore:IC(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),r=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],s=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],o=r.some(l=>t.startsWith(l.open)),a=s.some(l=>t.startsWith(l.close));return!o&&a}static _findAutoClosingPairOpen(e,t,i,r){const s=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(r);if(!s)return null;let o=null;for(const a of s)if(o===null||a.open.length>o.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new V(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+r!==a.open){l=!1;break}l&&(o=a)}return o}static _findSubAutoClosingPairClose(e,t){if(t.open.length<=1)return"";const i=t.close.charAt(t.close.length-1),r=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let s=null;for(const o of r)o.open!==t.open&&t.open.includes(o.open)&&t.close.endsWith(o.close)&&(!s||o.open.length>s.open.length)&&(s=o);return s?s.close:""}static _getAutoClosingPairClose(e,t,i,r,s){const o=Vp(r),a=o?e.autoClosingQuotes:e.autoClosingBrackets;if(a==="never")return null;const l=this._findAutoClosingPairOpen(e,t,i.map(d=>d.getPosition()),r);if(!l)return null;const c=this._findSubAutoClosingPairClose(e,l);let h=!0;const u=o?e.shouldAutoCloseBefore.quote:e.shouldAutoCloseBefore.bracket;for(let d=0,f=i.length;d<f;d++){const g=i[d];if(!g.isEmpty())return null;const p=g.getPosition(),m=t.getLineContent(p.lineNumber),b=m.substring(p.column-1);if(b.startsWith(c)||(h=!1),m.length>p.column-1){const y=m.charAt(p.column-1);if(!Di._isBeforeClosingBrace(e,b)&&!u(y))return null}if(!t.isCheapToTokenize(p.lineNumber))return null;if(l.open.length===1&&(r==="'"||r==='"')&&a!=="always"){const y=k_(e.wordSeparators);if(s&&p.column>1&&y.get(m.charCodeAt(p.column-2))===0||!s&&p.column>2&&y.get(m.charCodeAt(p.column-3))===0)return null}t.forceTokenization(p.lineNumber);const _=t.getLineTokens(p.lineNumber);let w=!1;try{w=zi.shouldAutoClosePair(l,_,s?p.column:p.column-1)}catch(y){it(y)}if(!w)return null}return h?l.close.substring(0,l.close.length-c.length):l.close}static _runAutoClosingOpenCharType(e,t,i,r,s,o,a){let l=[];for(let c=0,h=r.length;c<h;c++){const u=r[c];l[c]=new Gee(u,s,o,a)}return new ts(4,l,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return Vp(t)?e.autoSurround==="quotes"||e.autoSurround==="languageDefined":e.autoSurround==="brackets"||e.autoSurround==="languageDefined"}static _isSurroundSelectionType(e,t,i,r){if(!Di._shouldSurroundChar(e,r)||!e.surroundingPairs.hasOwnProperty(r))return!1;const s=Vp(r);for(let o=0,a=i.length;o<a;o++){const l=i[o];if(l.isEmpty())return!1;let c=!0;for(let h=l.startLineNumber;h<=l.endLineNumber;h++){const u=t.getLineContent(h),d=h===l.startLineNumber?l.startColumn-1:0,f=h===l.endLineNumber?l.endColumn-1:u.length,g=u.substring(d,f);if(/[^ \t]/.test(g)){c=!1;break}}if(c)return!1;if(s&&l.startLineNumber===l.endLineNumber&&l.startColumn+1===l.endColumn){const h=t.getValueInRange(l);if(Vp(h))return!1}}return!0}static _runSurroundSelectionType(e,t,i,r,s){let o=[];for(let a=0,l=r.length;a<l;a++){const c=r[a],h=t.surroundingPairs[s];o[a]=new PMe(c,s,h)}return new ts(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,r,s){if(!t.electricChars.hasOwnProperty(s)||!r.isEmpty())return null;let o=r.getPosition();i.forceTokenization(o.lineNumber);let a=i.getLineTokens(o.lineNumber),l;try{l=zi.onElectricCharacter(s,a,o.column)}catch(c){return it(c),null}if(!l)return null;if(l.matchOpenBracket){let c=(a.getLineContent()+s).lastIndexOf(l.matchOpenBracket)+1,h=i.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:o.lineNumber,column:c});if(h){if(h.startLineNumber===o.lineNumber)return null;let u=i.getLineContent(h.startLineNumber),d=rn(u),f=t.normalizeIndentation(d),g=i.getLineContent(o.lineNumber),p=i.getLineFirstNonWhitespaceColumn(o.lineNumber)||o.column,m=g.substring(p-1,o.column-1),b=f+m+s,_=new V(o.lineNumber,1,o.lineNumber,o.column);const w=new Nr(_,b);return new ts(jT(b,e),[w],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,i,r,s,o){if(!r||je.selectionsArrEqual(r,s))return null;let a=null;for(const c of s){if(!c.isEmpty())return null;const h=c.getPosition(),u=i.getValueInRange(new V(h.lineNumber,h.column-1,h.lineNumber,h.column));if(a===null)a=u;else if(a!==u)return null}if(!a)return null;if(this._isAutoClosingOvertype(t,i,s,o,a)){const c=s.map(h=>new Nr(new V(h.positionLineNumber,h.positionColumn,h.positionLineNumber,h.positionColumn+1),"",!1));return new ts(4,c,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const l=this._getAutoClosingPairClose(t,i,s,a,!1);return l!==null?this._runAutoClosingOpenCharType(e,t,i,s,a,!1,l):null}static typeWithInterceptors(e,t,i,r,s,o,a){if(!e&&a===`
`){let h=[];for(let u=0,d=s.length;u<d;u++)h[u]=Di._enter(i,r,!1,s[u]);return new ts(4,h,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(i,r,s)){let h=[],u=!1;for(let d=0,f=s.length;d<f;d++)if(h[d]=this._runAutoIndentType(i,r,s[d],a),!h[d]){u=!0;break}if(!u)return new ts(4,h,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoClosingOvertype(i,r,s,o,a))return this._runAutoClosingOvertype(t,i,r,s,a);if(!e){const h=this._getAutoClosingPairClose(i,r,s,a,!0);if(h)return this._runAutoClosingOpenCharType(t,i,r,s,a,!0,h)}if(this._isSurroundSelectionType(i,r,s,a))return this._runSurroundSelectionType(t,i,r,s,a);if(!e&&this._isTypeInterceptorElectricChar(i,r,s)){const h=this._typeInterceptorElectricChar(t,i,r,s[0],a);if(h)return h}let l=[];for(let h=0,u=s.length;h<u;h++)l[h]=new Nr(s[h],a);const c=jT(a,t);return new ts(c,l,{shouldPushStackElementBefore:IC(t,c),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,i,r,s){let o=[];for(let l=0,c=r.length;l<c;l++)o[l]=new Nr(r[l],s);const a=jT(s,e);return new ts(a,o,{shouldPushStackElementBefore:IC(e,a),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];let r=[];for(let s=0,o=i.length;s<o;s++){let a=i[s].positionLineNumber;if(a===1)r[s]=new LC(new V(1,1,1,1),`
`);else{a--;let l=t.getLineMaxColumn(a);r[s]=this._enter(e,t,!1,new V(a,l,a,l))}}return r}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];let r=[];for(let s=0,o=i.length;s<o;s++){const a=i[s].positionLineNumber;let l=t.getLineMaxColumn(a);r[s]=this._enter(e,t,!1,new V(a,l,a,l))}return r}static lineBreakInsert(e,t,i){let r=[];for(let s=0,o=i.length;s<o;s++)r[s]=this._enter(e,t,!0,i[s]);return r}}class Gee extends GS{constructor(e,t,i,r){super(e,(i?t:"")+r,0,-r.length),this._openCharacter=t,this._closeCharacter=r,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){let r=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new V(r.startLineNumber,r.endColumn-this._closeCharacter.length,r.endLineNumber,r.endColumn),this.enclosingRange=new V(r.startLineNumber,r.endColumn-this._openCharacter.length-this._closeCharacter.length,r.endLineNumber,r.endColumn),super.computeCursorState(e,t)}}function jT(n,e){return n===" "?e===5||e===6?6:5:4}function IC(n,e){return O$(n)&&!O$(e)?!0:n===5?!1:F$(n)!==F$(e)}function F$(n){return n===6||n===5?"space":n}function O$(n){return n===4||n===5||n===6}var Z;(function(n){n.editorSimpleInput=new Te("editorSimpleInput",!1,!0),n.editorTextFocus=new Te("editorTextFocus",!1,v("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),n.focus=new Te("editorFocus",!1,v("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),n.textInputFocus=new Te("textInputFocus",!1,v("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),n.readOnly=new Te("editorReadonly",!1,v("editorReadonly","Whether the editor is read only")),n.inDiffEditor=new Te("inDiffEditor",!1,v("inDiffEditor","Whether the context is a diff editor")),n.columnSelection=new Te("editorColumnSelection",!1,v("editorColumnSelection","Whether `editor.columnSelection` is enabled")),n.writable=n.readOnly.toNegated(),n.hasNonEmptySelection=new Te("editorHasSelection",!1,v("editorHasSelection","Whether the editor has text selected")),n.hasOnlyEmptySelection=n.hasNonEmptySelection.toNegated(),n.hasMultipleSelections=new Te("editorHasMultipleSelections",!1,v("editorHasMultipleSelections","Whether the editor has multiple selections")),n.hasSingleSelection=n.hasMultipleSelections.toNegated(),n.tabMovesFocus=new Te("editorTabMovesFocus",!1,v("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),n.tabDoesNotMoveFocus=n.tabMovesFocus.toNegated(),n.isInWalkThroughSnippet=new Te("isInEmbeddedEditor",!1,!0),n.canUndo=new Te("canUndo",!1,!0),n.canRedo=new Te("canRedo",!1,!0),n.hoverVisible=new Te("editorHoverVisible",!1,v("editorHoverVisible","Whether the editor hover is visible")),n.inCompositeEditor=new Te("inCompositeEditor",void 0,v("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),n.notInCompositeEditor=n.inCompositeEditor.toNegated(),n.languageId=new Te("editorLangId","",v("editorLangId","The language identifier of the editor")),n.hasCompletionItemProvider=new Te("editorHasCompletionItemProvider",!1,v("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),n.hasCodeActionsProvider=new Te("editorHasCodeActionsProvider",!1,v("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),n.hasCodeLensProvider=new Te("editorHasCodeLensProvider",!1,v("editorHasCodeLensProvider","Whether the editor has a code lens provider")),n.hasDefinitionProvider=new Te("editorHasDefinitionProvider",!1,v("editorHasDefinitionProvider","Whether the editor has a definition provider")),n.hasDeclarationProvider=new Te("editorHasDeclarationProvider",!1,v("editorHasDeclarationProvider","Whether the editor has a declaration provider")),n.hasImplementationProvider=new Te("editorHasImplementationProvider",!1,v("editorHasImplementationProvider","Whether the editor has an implementation provider")),n.hasTypeDefinitionProvider=new Te("editorHasTypeDefinitionProvider",!1,v("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),n.hasHoverProvider=new Te("editorHasHoverProvider",!1,v("editorHasHoverProvider","Whether the editor has a hover provider")),n.hasDocumentHighlightProvider=new Te("editorHasDocumentHighlightProvider",!1,v("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),n.hasDocumentSymbolProvider=new Te("editorHasDocumentSymbolProvider",!1,v("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),n.hasReferenceProvider=new Te("editorHasReferenceProvider",!1,v("editorHasReferenceProvider","Whether the editor has a reference provider")),n.hasRenameProvider=new Te("editorHasRenameProvider",!1,v("editorHasRenameProvider","Whether the editor has a rename provider")),n.hasSignatureHelpProvider=new Te("editorHasSignatureHelpProvider",!1,v("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),n.hasInlayHintsProvider=new Te("editorHasInlayHintsProvider",!1,v("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),n.hasDocumentFormattingProvider=new Te("editorHasDocumentFormattingProvider",!1,v("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),n.hasDocumentSelectionFormattingProvider=new Te("editorHasDocumentSelectionFormattingProvider",!1,v("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),n.hasMultipleDocumentFormattingProvider=new Te("editorHasMultipleDocumentFormattingProvider",!1,v("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),n.hasMultipleDocumentSelectionFormattingProvider=new Te("editorHasMultipleDocumentSelectionFormattingProvider",!1,v("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(Z||(Z={}));const St=0;class Ri extends mo{runEditorCommand(e,t,i){const r=t._getViewModel();r&&this.runCoreEditorCommand(r,i||{})}}var rD;(function(n){const e=function(i){if(!Br(i))return!1;const r=i;return!(!Ga(r.to)||!yr(r.by)&&!Ga(r.by)||!yr(r.value)&&!sg(r.value)||!yr(r.revealCursor)&&!$Q(r.revealCursor))};n.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},n.RawDirection={Up:"up",Down:"down"},n.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage"};function t(i){let r;switch(i.to){case n.RawDirection.Up:r=1;break;case n.RawDirection.Down:r=2;break;default:return null}let s;switch(i.by){case n.RawUnit.Line:s=1;break;case n.RawUnit.WrappedLine:s=2;break;case n.RawUnit.Page:s=3;break;case n.RawUnit.HalfPage:s=4;break;default:s=2}const o=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:r,unit:s,value:o,revealCursor:a,select:!!i.select}}n.parse=t})(rD||(rD={}));var im;(function(n){const e=function(t){if(!Br(t))return!1;const i=t;return!(!sg(i.lineNumber)&&!Ga(i.lineNumber)||!yr(i.at)&&!Ga(i.at))};n.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},n.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(im||(im={}));class vF{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const r=t.get(ui).getFocusedCodeEditor();return r&&r.hasTextFocus()?this._runEditorCommand(t,r,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const r=document.activeElement;return r&&["input","textarea"].indexOf(r.tagName.toLowerCase())>=0?(this.runDOMCommand(),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const r=t.get(ui).getActiveCodeEditor();return r?(r.focus(),this._runEditorCommand(t,r,i)):!1})}_runEditorCommand(e,t,i){const r=this.runEditorCommand(e,t,i);return r||!0}}var pn;(function(n){class e extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,[xn.moveTo(_,_.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)]),_.revealPrimaryCursor(w.source,!0)}}n.MoveTo=ye(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),n.MoveToSelect=ye(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends Ri{runCoreEditorCommand(_,w){_.model.pushStackElement();const y=this._getColumnSelectResult(_,_.getPrimaryCursorState(),_.getCursorColumnSelectData(),w);_.setCursorStates(w.source,3,y.viewStates.map(S=>st.fromViewState(S))),_.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:y.fromLineNumber,fromViewVisualColumn:y.fromVisualColumn,toViewLineNumber:y.toLineNumber,toViewVisualColumn:y.toVisualColumn}),y.reversed?_.revealTopMostCursor(w.source):_.revealBottomMostCursor(w.source)}}n.ColumnSelect=ye(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(b,_,w,y){const S=b.model.validatePosition(y.position),k=b.coordinatesConverter.validateViewPosition(new G(y.viewPosition.lineNumber,y.viewPosition.column),S);let C=y.doColumnSelect?w.fromViewLineNumber:k.lineNumber,D=y.doColumnSelect?w.fromViewVisualColumn:y.mouseColumn-1;return Hd.columnSelect(b.cursorConfig,b,C,D,k.lineNumber,y.mouseColumn-1)}}),n.CursorColumnSelectLeft=ye(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(b,_,w,y){return Hd.columnSelectLeft(b.cursorConfig,b,w)}}),n.CursorColumnSelectRight=ye(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(b,_,w,y){return Hd.columnSelectRight(b.cursorConfig,b,w)}});class i extends t{constructor(_){super(_),this._isPaged=_.isPaged}_getColumnSelectResult(_,w,y,S){return Hd.columnSelectUp(_.cursorConfig,_,y,this._isPaged)}}n.CursorColumnSelectUp=ye(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3600,linux:{primary:0}}})),n.CursorColumnSelectPageUp=ye(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3595,linux:{primary:0}}}));class r extends t{constructor(_){super(_),this._isPaged=_.isPaged}_getColumnSelectResult(_,w,y,S){return Hd.columnSelectDown(_.cursorConfig,_,y,this._isPaged)}}n.CursorColumnSelectDown=ye(new r({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3602,linux:{primary:0}}})),n.CursorColumnSelectPageDown=ye(new r({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3596,linux:{primary:0}}}));class s extends Ri{constructor(){super({id:"cursorMove",precondition:void 0,description:nD.description})}runCoreEditorCommand(_,w){const y=nD.parse(w);y&&this._runCursorMove(_,w.source,y)}_runCursorMove(_,w,y){_.model.pushStackElement(),_.setCursorStates(w,3,s._move(_,_.getCursorStates(),y)),_.revealPrimaryCursor(w,!0)}static _move(_,w,y){const S=y.select,k=y.value;switch(y.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return xn.simpleMove(_,w,y.direction,S,k,y.unit);case 11:case 13:case 12:case 14:return xn.viewportMove(_,w,y.direction,S,k);default:return null}}}n.CursorMoveImpl=s,n.CursorMove=ye(new s);class o extends Ri{constructor(_){super(_),this._staticArgs=_.args}runCoreEditorCommand(_,w){let y=this._staticArgs;this._staticArgs.value===-1&&(y={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:_.cursorConfig.pageSize}),_.model.pushStackElement(),_.setCursorStates(w.source,3,xn.simpleMove(_,_.getCursorStates(),y.direction,y.select,y.value,y.unit)),_.revealPrimaryCursor(w.source,!0)}}n.CursorLeft=ye(new o({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),n.CursorLeftSelect=ye(new o({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1039}})),n.CursorRight=ye(new o({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),n.CursorRightSelect=ye(new o({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1041}})),n.CursorUp=ye(new o({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),n.CursorUpSelect=ye(new o({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),n.CursorPageUp=ye(new o({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:11}})),n.CursorPageUpSelect=ye(new o({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1035}})),n.CursorDown=ye(new o({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),n.CursorDownSelect=ye(new o({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),n.CursorPageDown=ye(new o({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:12}})),n.CursorPageDownSelect=ye(new o({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1036}})),n.CreateCursor=ye(new class extends Ri{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(b,_){let w;_.wholeLine?w=xn.line(b,b.getPrimaryCursorState(),!1,_.position,_.viewPosition):w=xn.moveTo(b,b.getPrimaryCursorState(),!1,_.position,_.viewPosition);const y=b.getCursorStates();if(y.length>1){const S=w.modelState?w.modelState.position:null,k=w.viewState?w.viewState.position:null;for(let C=0,D=y.length;C<D;C++){const E=y[C];if(!(S&&!E.modelState.selection.containsPosition(S))&&!(k&&!E.viewState.selection.containsPosition(k))){y.splice(C,1),b.model.pushStackElement(),b.setCursorStates(_.source,3,y);return}}}y.push(w),b.model.pushStackElement(),b.setCursorStates(_.source,3,y)}}),n.LastCursorMoveToSelect=ye(new class extends Ri{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(b,_){const w=b.getLastAddedCursorIndex(),y=b.getCursorStates(),S=y.slice(0);S[w]=xn.moveTo(b,y[w],!0,_.position,_.viewPosition),b.model.pushStackElement(),b.setCursorStates(_.source,3,S)}});class a extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,xn.moveToBeginningOfLine(_,_.getCursorStates(),this._inSelectionMode)),_.revealPrimaryCursor(w.source,!0)}}n.CursorHome=ye(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),n.CursorHomeSelect=ye(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,this._exec(_.getCursorStates())),_.revealPrimaryCursor(w.source,!0)}_exec(_){const w=[];for(let y=0,S=_.length;y<S;y++){const k=_[y],C=k.modelState.position.lineNumber;w[y]=st.fromModelState(k.modelState.move(this._inSelectionMode,C,1,0))}return w}}n.CursorLineStart=ye(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:0,mac:{primary:287}}})),n.CursorLineStartSelect=ye(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,xn.moveToEndOfLine(_,_.getCursorStates(),this._inSelectionMode,w.sticky||!1)),_.revealPrimaryCursor(w.source,!0)}}n.CursorEnd=ye(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:St,kbExpr:Z.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:v("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),n.CursorEndSelect=ye(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:St,kbExpr:Z.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:v("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class h extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,this._exec(_,_.getCursorStates())),_.revealPrimaryCursor(w.source,!0)}_exec(_,w){const y=[];for(let S=0,k=w.length;S<k;S++){const C=w[S],D=C.modelState.position.lineNumber,E=_.model.getLineMaxColumn(D);y[S]=st.fromModelState(C.modelState.move(this._inSelectionMode,D,E,0))}return y}}n.CursorLineEnd=ye(new h({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:0,mac:{primary:291}}})),n.CursorLineEndSelect=ye(new h({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:0,mac:{primary:1315}}}));class u extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,xn.moveToBeginningOfBuffer(_,_.getCursorStates(),this._inSelectionMode)),_.revealPrimaryCursor(w.source,!0)}}n.CursorTop=ye(new u({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2062,mac:{primary:2064}}})),n.CursorTopSelect=ye(new u({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3086,mac:{primary:3088}}}));class d extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,xn.moveToEndOfBuffer(_,_.getCursorStates(),this._inSelectionMode)),_.revealPrimaryCursor(w.source,!0)}}n.CursorBottom=ye(new d({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2061,mac:{primary:2066}}})),n.CursorBottomSelect=ye(new d({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:3085,mac:{primary:3090}}}));class f extends Ri{constructor(){super({id:"editorScroll",precondition:void 0,description:rD.description})}runCoreEditorCommand(_,w){const y=rD.parse(w);y&&this._runEditorScroll(_,w.source,y)}_runEditorScroll(_,w,y){const S=this._computeDesiredScrollTop(_,y);if(y.revealCursor){const k=_.getCompletelyVisibleViewRangeAtScrollTop(S);_.setCursorStates(w,3,[xn.findPositionInViewportIfOutside(_,_.getPrimaryCursorState(),k,y.select)])}_.setScrollTop(S,0)}_computeDesiredScrollTop(_,w){if(w.unit===1){const k=_.getCompletelyVisibleViewRange(),C=_.coordinatesConverter.convertViewRangeToModelRange(k);let D;w.direction===1?D=Math.max(1,C.startLineNumber-w.value):D=Math.min(_.model.getLineCount(),C.startLineNumber+w.value);const E=_.coordinatesConverter.convertModelPositionToViewPosition(new G(D,1));return _.getVerticalOffsetForLineNumber(E.lineNumber)}let y;w.unit===3?y=_.cursorConfig.pageSize*w.value:w.unit===4?y=Math.round(_.cursorConfig.pageSize/2)*w.value:y=w.value;const S=(w.direction===1?-1:1)*y;return _.getScrollTop()+S*_.cursorConfig.lineHeight}}n.EditorScrollImpl=f,n.EditorScroll=ye(new f),n.ScrollLineUp=ye(new class extends Ri{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(b,_){n.EditorScroll._runEditorScroll(b,_.source,{direction:1,unit:2,value:1,revealCursor:!1,select:!1})}}),n.ScrollPageUp=ye(new class extends Ri{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(b,_){n.EditorScroll._runEditorScroll(b,_.source,{direction:1,unit:3,value:1,revealCursor:!1,select:!1})}}),n.ScrollLineDown=ye(new class extends Ri{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(b,_){n.EditorScroll._runEditorScroll(b,_.source,{direction:2,unit:2,value:1,revealCursor:!1,select:!1})}}),n.ScrollPageDown=ye(new class extends Ri{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(b,_){n.EditorScroll._runEditorScroll(b,_.source,{direction:2,unit:3,value:1,revealCursor:!1,select:!1})}});class g extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,[xn.word(_,_.getPrimaryCursorState(),this._inSelectionMode,w.position)]),_.revealPrimaryCursor(w.source,!0)}}n.WordSelect=ye(new g({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),n.WordSelectDrag=ye(new g({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),n.LastCursorWordSelect=ye(new class extends Ri{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(b,_){const w=b.getLastAddedCursorIndex(),y=b.getCursorStates(),S=y.slice(0),k=y[w];S[w]=xn.word(b,k,k.modelState.hasSelection(),_.position),b.model.pushStackElement(),b.setCursorStates(_.source,3,S)}});class p extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){_.model.pushStackElement(),_.setCursorStates(w.source,3,[xn.line(_,_.getPrimaryCursorState(),this._inSelectionMode,w.position,w.viewPosition)]),_.revealPrimaryCursor(w.source,!1)}}n.LineSelect=ye(new p({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),n.LineSelectDrag=ye(new p({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class m extends Ri{constructor(_){super(_),this._inSelectionMode=_.inSelectionMode}runCoreEditorCommand(_,w){const y=_.getLastAddedCursorIndex(),S=_.getCursorStates(),k=S.slice(0);k[y]=xn.line(_,S[y],this._inSelectionMode,w.position,w.viewPosition),_.model.pushStackElement(),_.setCursorStates(w.source,3,k)}}n.LastCursorLineSelect=ye(new m({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),n.LastCursorLineSelectDrag=ye(new m({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),n.ExpandLineSelection=ye(new class extends Ri{constructor(){super({id:"expandLineSelection",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:2090}})}runCoreEditorCommand(b,_){b.model.pushStackElement(),b.setCursorStates(_.source,3,xn.expandLineSelection(b,b.getCursorStates())),b.revealPrimaryCursor(_.source,!0)}}),n.CancelSelection=ye(new class extends Ri{constructor(){super({id:"cancelSelection",precondition:Z.hasNonEmptySelection,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,_){b.model.pushStackElement(),b.setCursorStates(_.source,3,[xn.cancelSelection(b,b.getPrimaryCursorState())]),b.revealPrimaryCursor(_.source,!0)}}),n.RemoveSecondaryCursors=ye(new class extends Ri{constructor(){super({id:"removeSecondaryCursors",precondition:Z.hasMultipleSelections,kbOpts:{weight:St+1,kbExpr:Z.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,_){b.model.pushStackElement(),b.setCursorStates(_.source,3,[b.getPrimaryCursorState()]),b.revealPrimaryCursor(_.source,!0),UE(v("removedCursor","Removed secondary cursors"))}}),n.RevealLine=ye(new class extends Ri{constructor(){super({id:"revealLine",precondition:void 0,description:im.description})}runCoreEditorCommand(b,_){const w=_,y=w.lineNumber||0;let S=typeof y=="number"?y+1:parseInt(y)+1;S<1&&(S=1);const k=b.model.getLineCount();S>k&&(S=k);const C=new V(S,1,S,b.model.getLineMaxColumn(S));let D=0;if(w.at)switch(w.at){case im.RawAtArgument.Top:D=3;break;case im.RawAtArgument.Center:D=1;break;case im.RawAtArgument.Bottom:D=4;break}const E=b.coordinatesConverter.convertModelRangeToViewRange(C);b.revealRange(_.source,!1,E,D,0)}}),n.SelectAll=new class extends vF{constructor(){super(xTe)}runDOMCommand(){$r&&(document.activeElement.focus(),document.activeElement.select()),document.execCommand("selectAll")}runEditorCommand(b,_,w){const y=_._getViewModel();y&&this.runCoreEditorCommand(y,w)}runCoreEditorCommand(b,_){b.model.pushStackElement(),b.setCursorStates("keyboard",3,[xn.selectAll(b,b.getPrimaryCursorState())])}},n.SetSelection=ye(new class extends Ri{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(b,_){b.model.pushStackElement(),b.setCursorStates(_.source,3,[st.fromModelSelection(_.selection)])}})})(pn||(pn={}));const BMe=Ie.and(Z.textInputFocus,Z.columnSelection);function E0(n,e){xr.registerKeybindingRule({id:n,primary:e,when:BMe,weight:St+1})}E0(pn.CursorColumnSelectLeft.id,1039);E0(pn.CursorColumnSelectRight.id,1041);E0(pn.CursorColumnSelectUp.id,1040);E0(pn.CursorColumnSelectPageUp.id,1035);E0(pn.CursorColumnSelectDown.id,1042);E0(pn.CursorColumnSelectPageDown.id,1036);function P$(n){return n.register(),n}var _v;(function(n){class e extends mo{runEditorCommand(i,r,s){const o=r._getViewModel();o&&this.runCoreEditingCommand(r,o,s||{})}}n.CoreEditingCommand=e,n.LineBreakInsert=ye(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:Z.writable,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,r){t.pushUndoStop(),t.executeCommands(this.id,Di.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection)))}}),n.Outdent=ye(new class extends e{constructor(){super({id:"outdent",precondition:Z.writable,kbOpts:{weight:St,kbExpr:Ie.and(Z.editorTextFocus,Z.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,r){t.pushUndoStop(),t.executeCommands(this.id,Di.outdent(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection))),t.pushUndoStop()}}),n.Tab=ye(new class extends e{constructor(){super({id:"tab",precondition:Z.writable,kbOpts:{weight:St,kbExpr:Ie.and(Z.editorTextFocus,Z.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,r){t.pushUndoStop(),t.executeCommands(this.id,Di.tab(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection))),t.pushUndoStop()}}),n.DeleteLeft=ye(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,r){const[s,o]=fg.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());s&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(2)}}),n.DeleteRight=ye(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:St,kbExpr:Z.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,r){const[s,o]=fg.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));s&&t.pushUndoStop(),t.executeCommands(this.id,o),i.setPrevEditOperationType(3)}}),n.Undo=new class extends vF{constructor(){super(f5)}runDOMCommand(){document.execCommand("undo")}runEditorCommand(t,i,r){if(!(!i.hasModel()||i.getOption(80)===!0))return i.getModel().undo()}},n.Redo=new class extends vF{constructor(){super(g5)}runDOMCommand(){document.execCommand("redo")}runEditorCommand(t,i,r){if(!(!i.hasModel()||i.getOption(80)===!0))return i.getModel().redo()}}})(_v||(_v={}));class B$ extends vL{constructor(e,t,i){super({id:e,precondition:void 0,description:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ui).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function jg(n,e){P$(new B$("default:"+n,n)),P$(new B$(n,n,e))}jg("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});jg("replacePreviousChar");jg("compositionType");jg("compositionStart");jg("compositionEnd");jg("paste");jg("cut");class VMe{constructor(e,t,i,r){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=r}paste(e,t,i,r){this.commandDelegate.paste(e,t,i,r)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,r){this.commandDelegate.compositionType(e,t,i,r)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){pn.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new G(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(69)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(69)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=zr&&t.get(95),r=t.get(18);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position):this._lastCursorLineSelect(e.position):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):e.mouseDownCount===2?this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position):e.inSelectionMode?this._wordSelectDrag(e.position):this._wordSelect(e.position):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):r?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position):this.moveTo(e.position)}_usualArgs(e){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e}}moveTo(e){pn.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_moveToSelect(e){pn.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_columnSelect(e,t,i){e=this._validateViewColumn(e),pn.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),pn.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e){pn.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelect(e){pn.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelectDrag(e){pn.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorWordSelect(e){pn.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelect(e){pn.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelectDrag(e){pn.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelect(e){pn.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelectDrag(e){pn.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_selectAll(){pn.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class LL{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown&&this.onKeyDown(e)}emitKeyUp(e){this.onKeyUp&&this.onKeyUp(e)}emitContextMenu(e){this.onContextMenu&&this.onContextMenu(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove&&this.onMouseMove(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave&&this.onMouseLeave(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown&&this.onMouseDown(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp&&this.onMouseUp(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag&&this.onMouseDrag(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop&&this.onMouseDrop(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled&&this.onMouseDropCanceled()}emitMouseWheel(e){this.onMouseWheel&&this.onMouseWheel(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return LL.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){return new WMe(e.element,e.type,e.mouseColumn,e.position?t.convertViewPositionToModelPosition(e.position):null,e.range?t.convertViewRangeToModelRange(e.range):null,e.detail)}}class WMe{constructor(e,t,i,r,s,o){this.element=e,this.type=t,this.mouseColumn=i,this.position=r,this.range=s,this.detail=o}toString(){return va.toString(this)}}var qT;class Kee{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),r=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>r)return null;let s=0,o=0;for(let l=i;l<=r;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(o===0?(s=c,o=1):o++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(s,o)}onLinesChanged(e,t){if(this.getCount()===0)return!1;const i=this.getStartLineNumber(),r=this.getEndLineNumber();let s=!1;for(let o=e;o<=t;o++)o>=i&&o<=r&&(this._lines[o-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,r=this.getStartLineNumber(),s=this.getEndLineNumber();if(e<=r)return this._rendLineNumberStart+=i,null;if(e>s)return null;if(i+e>s)return this._lines.splice(e-this._rendLineNumberStart,s-e+1);const o=[];for(let u=0;u<i;u++)o[u]=this._createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),h=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(o).concat(c),h}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let r=!1;for(let s=0,o=e.length;s<o;s++){const a=e[s];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let h=l;h<=c;h++){const u=h-this._rendLineNumberStart;this._lines[u].onTokensChanged(),r=!0}}return r}}class Zee{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new Kee(()=>this._host.createVisibleLine())}_createDomNode(){const e=xt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(129)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,r=t.length;i<r;i++){const s=t[i].getDomNode();s&&this.domNode.domNode.removeChild(s)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,r=t.length;i<r;i++){const s=t[i].getDomNode();s&&this.domNode.domNode.removeChild(s)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new ih(this.domNode.domNode,this._host,e),r={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},s=i.render(r,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(s.rendLineNumberStart,s.lines)}}class ih{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,r){const s={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(s.rendLineNumberStart+s.linesLength-1<t||i<s.rendLineNumberStart){s.rendLineNumberStart=t,s.linesLength=i-t+1,s.lines=[];for(let o=t;o<=i;o++)s.lines[o-t]=this.host.createVisibleLine();return this._finishRendering(s,!0,r),s}if(this._renderUntouchedLines(s,Math.max(t-s.rendLineNumberStart,0),Math.min(i-s.rendLineNumberStart,s.linesLength-1),r,t),s.rendLineNumberStart>t){const o=t,a=Math.min(i,s.rendLineNumberStart-1);o<=a&&(this._insertLinesBefore(s,o,a,r,t),s.linesLength+=a-o+1)}else if(s.rendLineNumberStart<t){const o=Math.min(s.linesLength,t-s.rendLineNumberStart);o>0&&(this._removeLinesBefore(s,o),s.linesLength-=o)}if(s.rendLineNumberStart=t,s.rendLineNumberStart+s.linesLength-1<i){const o=s.rendLineNumberStart+s.linesLength,a=i;o<=a&&(this._insertLinesAfter(s,o,a,r,t),s.linesLength+=a-o+1)}else if(s.rendLineNumberStart+s.linesLength-1>i){const o=Math.max(0,i-s.rendLineNumberStart+1),l=s.linesLength-1-o+1;l>0&&(this._removeLinesAfter(s,l),s.linesLength-=l)}return this._finishRendering(s,!1,r),s}_renderUntouchedLines(e,t,i,r,s){const o=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=o+l;a[l].layoutLine(c,r[c-s])}}_insertLinesBefore(e,t,i,r,s){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this.host.createVisibleLine();e.lines=o.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const r=e.lines[i].getDomNode();r&&this.domNode.removeChild(r)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,r,s){const o=[];let a=0;for(let l=t;l<=i;l++)o[a++]=this.host.createVisibleLine();e.lines=e.lines.concat(o)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let r=0;r<t;r++){const s=e.lines[i+r].getDomNode();s&&this.domNode.removeChild(s)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,r){ih._ttPolicy&&(i=ih._ttPolicy.createHTML(i));const s=this.domNode.lastChild;t||!s?this.domNode.innerHTML=i:s.insertAdjacentHTML("afterend",i);let o=this.domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];r[a]&&(l.setDomNode(o),o=o.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const r=document.createElement("div");ih._ttPolicy&&(t=ih._ttPolicy.createHTML(t)),r.innerHTML=t;for(let s=0;s<e.linesLength;s++){const o=e.lines[s];if(i[s]){const a=r.firstChild,l=o.getDomNode();l.parentNode.replaceChild(a,l),o.setDomNode(a)}}}_finishRendering(e,t,i){const r=ih._sb,s=e.linesLength,o=e.lines,a=e.rendLineNumberStart,l=[];{r.reset();let c=!1;for(let h=0;h<s;h++){const u=o[h];l[h]=!1,!(u.getDomNode()||!u.renderLine(h+a,i[h],this.viewportData,r))&&(l[h]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,r.build(),l)}{r.reset();let c=!1;const h=[];for(let u=0;u<s;u++){const d=o[u];h[u]=!1,!(l[u]||!d.renderLine(u+a,i[u],this.viewportData,r))&&(h[u]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,r.build(),h)}}}ih._ttPolicy=(qT=window.trustedTypes)===null||qT===void 0?void 0:qT.createPolicy("editorViewLayer",{createHTML:n=>n});ih._sb=og(1e5);class Yee extends _o{constructor(e){super(e),this._visibleLines=new Zee(this),this.domNode=this._visibleLines.domNode,this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new $Me(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=t;r<=i;r++)this._visibleLines.getVisibleLine(r).onConfigurationChanged(e);return!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,r=t.length;i<r;i++){const s=t[i];s.prepareRender(e),s.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class $Me{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(58),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=xt(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(58)}renderLine(e,t,i,r){let s="";for(let o=0,a=this._dynamicOverlays.length;o<a;o++){const l=this._dynamicOverlays[o];s+=l.render(i.startLineNumber,e)}return this._renderedContent===s?!1:(this._renderedContent=s,r.appendASCIIString('<div style="position:absolute;top:'),r.appendASCIIString(String(t)),r.appendASCIIString("px;width:100%;height:"),r.appendASCIIString(String(this._lineHeight)),r.appendASCIIString('px;">'),r.appendASCIIString(s),r.appendASCIIString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class zMe extends Yee{constructor(e){super(e);const i=this._context.configuration.options.get(129);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(129);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class HMe extends Yee{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(129);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),Yn.applyFontInfo(this.domNode,t.get(43))}onConfigurationChanged(e){const t=this._context.configuration.options;Yn.applyFontInfo(this.domNode,t.get(43));const i=t.get(129);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class eb{constructor(e,t){this._coordinateBrand=void 0,this.top=e,this.left=t}}class UMe extends _o{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=xt(document.createElement("div")),oc.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=xt(document.createElement("div")),oc.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onLineMappingChanged(e);return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}addWidget(e){const t=new jMe(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i){this._widgets[e.getId()].setPosition(t,i),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const r=i.domNode.domNode;r.parentNode.removeChild(r),r.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}let jMe=class{constructor(e,t,i){this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=xt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const r=this._context.configuration.options,s=r.get(129);this._fixedOverflowWidgets=r.get(36),this._contentWidth=s.contentWidth,this._contentLeft=s.contentLeft,this._lineHeight=r.get(58),this._range=null,this._viewRange=null,this._preference=[],this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(58),e.hasChanged(129)){const i=t.get(129);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}onLineMappingChanged(e){this._setPosition(this._range)}_setPosition(e){if(this._range=e,this._viewRange=null,this._range){const t=this._context.model.validateModelRange(this._range);(this._context.model.coordinatesConverter.modelPositionIsVisible(t.getStartPosition())||this._context.model.coordinatesConverter.modelPositionIsVisible(t.getEndPosition()))&&(this._viewRange=this._context.model.coordinatesConverter.convertModelRangeToViewRange(t))}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth:this._contentWidth}setPosition(e,t){this._setPosition(e),this._preference=t,this._cachedDomNodeClientWidth=-1,this._cachedDomNodeClientHeight=-1}_layoutBoxInViewport(e,t,i,r,s){const o=e.top,a=o,l=t.top+this._lineHeight,c=s.viewportHeight-l,h=o-r,u=a>=r,d=l,f=c>=r;let g=e.left,p=t.left;return g+i>s.scrollLeft+s.viewportWidth&&(g=s.scrollLeft+s.viewportWidth-i),p+i>s.scrollLeft+s.viewportWidth&&(p=s.scrollLeft+s.viewportWidth-i),g<s.scrollLeft&&(g=s.scrollLeft),p<s.scrollLeft&&(p=s.scrollLeft),{fitsAbove:u,aboveTop:h,aboveLeft:g,fitsBelow:f,belowTop:d,belowLeft:p}}_layoutHorizontalSegmentInPage(e,t,i,r){const s=Math.max(0,t.left-r),o=Math.min(t.left+t.width+r,e.width);let a=t.left+i-fh.scrollX;if(a+r>o){const l=a-(o-r);a-=l,i-=l}if(a<s){const l=a-s;a-=l,i-=l}return[i,a]}_layoutBoxInPage(e,t,i,r,s){const o=e.top-r,a=t.top+this._lineHeight,l=jn(this._viewDomNode.domNode),c=l.top+o-fh.scrollY,h=l.top+a-fh.scrollY,u=Kk(document.body),[d,f]=this._layoutHorizontalSegmentInPage(u,l,e.left-s.scrollLeft+this._contentLeft,i),[g,p]=this._layoutHorizontalSegmentInPage(u,l,t.left-s.scrollLeft+this._contentLeft,i),m=22,b=22,_=c>=m,w=h+r<=u.height-b;return this._fixedOverflowWidgets?{fitsAbove:_,aboveTop:Math.max(c,m),aboveLeft:f,fitsBelow:w,belowTop:h,belowLeft:p}:{fitsAbove:_,aboveTop:o,aboveLeft:d,fitsBelow:w,belowTop:a,belowLeft:g}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new eb(e.top,e.left+this._contentLeft)}_getTopAndBottomLeft(e){if(!this._viewRange)return[null,null];const t=e.linesVisibleRangesForRange(this._viewRange,!1);if(!t||t.length===0)return[null,null];let i=t[0],r=t[0];for(const u of t)u.lineNumber<i.lineNumber&&(i=u),u.lineNumber>r.lineNumber&&(r=u);let s=1073741824;for(const u of i.ranges)u.left<s&&(s=u.left);let o=1073741824;for(const u of r.ranges)u.left<o&&(o=u.left);const a=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.scrollTop,l=new eb(a,s),c=e.getVerticalOffsetForLineNumber(r.lineNumber)-e.scrollTop,h=new eb(c,o);return[l,h]}_prepareRenderWidget(e){const[t,i]=this._getTopAndBottomLeft(e);if(!t||!i)return null;if(this._cachedDomNodeClientWidth===-1||this._cachedDomNodeClientHeight===-1){let s=null;if(typeof this._actual.beforeRender=="function"&&(s=GT(this._actual.beforeRender,this._actual)),s)this._cachedDomNodeClientWidth=s.width,this._cachedDomNodeClientHeight=s.height;else{const o=this.domNode.domNode;this._cachedDomNodeClientWidth=o.clientWidth,this._cachedDomNodeClientHeight=o.clientHeight}}let r;if(this.allowEditorOverflow?r=this._layoutBoxInPage(t,i,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,e):r=this._layoutBoxInViewport(t,i,this._cachedDomNodeClientWidth,this._cachedDomNodeClientHeight,e),this._preference)for(let s=1;s<=2;s++)for(const o of this._preference)if(o===1){if(!r)return null;if(s===2||r.fitsAbove)return{coordinate:new eb(r.aboveTop,r.aboveLeft),position:1}}else if(o===2){if(!r)return null;if(s===2||r.fitsBelow)return{coordinate:new eb(r.belowTop,r.belowLeft),position:2}}else return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(t),position:0}:{coordinate:t,position:0};return null}onBeforeRender(e){!this._viewRange||!this._preference||this._viewRange.endLineNumber<e.startLineNumber||this._viewRange.startLineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&GT(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&GT(this._actual.afterRender,this._actual,this._renderData.position)}};function GT(n,e,...t){try{return n.call(e,...t)}catch{return null}}let wF=!0;class Xee extends x0{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(129);this._lineHeight=t.get(58),this._renderLineHighlight=t.get(84),this._renderLineHighlightOnlyWhenFocus=t.get(85),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new je(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=wF?this._selections.slice(0,1):this._selections,i=t.map(s=>s.positionLineNumber);i.sort((s,o)=>s-o),ec(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const r=t.every(s=>s.isEmpty());return this._selectionIsEmpty!==r&&(this._selectionIsEmpty=r,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(129);return this._lineHeight=t.get(58),this._renderLineHighlight=t.get(84),this._renderLineHighlightOnlyWhenFocus=t.get(85),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=this._renderOne(e),i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,s=this._cursorLineNumbers.length;let o=0;const a=[];for(let l=i;l<=r;l++){const c=l-i;for(;o<s&&this._cursorLineNumbers[o]<l;)o++;o<s&&this._cursorLineNumbers[o]===l?a[c]=t:a[c]=""}this._renderData=a}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}}class qMe extends Xee{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderOther(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class GMe extends Xee{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderThis(){return!0}_shouldRenderOther(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}li((n,e)=>{wF=!1;const t=n.getColor(kRe);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||n.defines(D$)){const i=n.getColor(D$);i&&(wF=!0,e.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${i}; }`),n.type==="hc"&&(e.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}});class KMe extends x0{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(58),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(58),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],r=0;for(let l=0,c=t.length;l<c;l++){const h=t[l];h.options.className&&(i[r++]=h)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const h=l.options.className,u=c.options.className;return h<u?-1:h>u?1:V.compareRangesUsingStarts(l.range,c.range)});const s=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber,a=[];for(let l=s;l<=o;l++){const c=l-s;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const r=String(this._lineHeight),s=e.visibleRange.startLineNumber,o=e.visibleRange.endLineNumber;for(let a=0,l=t.length;a<l;a++){const c=t[a];if(!c.options.isWholeLine)continue;const h='<div class="cdr '+c.options.className+'" style="left:0;width:100%;height:'+r+'px;"></div>',u=Math.max(c.range.startLineNumber,s),d=Math.min(c.range.endLineNumber,o);for(let f=u;f<=d;f++){const g=f-s;i[g]+=h}}}_renderNormalDecorations(e,t,i){const r=String(this._lineHeight),s=e.visibleRange.startLineNumber;let o=null,a=!1,l=null;for(let c=0,h=t.length;c<h;c++){const u=t[c];if(u.options.isWholeLine)continue;const d=u.options.className,f=!!u.options.showIfCollapsed;let g=u.range;if(f&&g.endColumn===1&&g.endLineNumber!==g.startLineNumber&&(g=new V(g.startLineNumber,g.startColumn,g.endLineNumber-1,this._context.model.getLineMaxColumn(g.endLineNumber-1))),o===d&&a===f&&V.areIntersectingOrTouching(l,g)){l=V.plusRange(l,g);continue}o!==null&&this._renderNormalDecoration(e,l,o,a,r,s,i),o=d,a=f,l=g}o!==null&&this._renderNormalDecoration(e,l,o,a,r,s,i)}_renderNormalDecoration(e,t,i,r,s,o,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,h=l.length;c<h;c++){const u=l[c];if(u.outsideRenderedLine)continue;const d=u.lineNumber-o;if(r&&u.ranges.length===1){const f=u.ranges[0];f.width===0&&(u.ranges[0]=new wL(f.left,this._typicalHalfwidthCharacterWidth))}for(let f=0,g=u.ranges.length;f<g;f++){const p=u.ranges[f],m='<div class="cdr '+i+'" style="left:'+String(p.left)+"px;width:"+String(p.width)+"px;height:"+s+'px;"></div>';a[d]+=m}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class bo extends re{onclick(e,t){this._register(ae(e,Me.CLICK,i=>t(new oo(i))))}onmousedown(e,t){this._register(ae(e,Me.MOUSE_DOWN,i=>t(new oo(i))))}onmouseover(e,t){this._register(ae(e,Me.MOUSE_OVER,i=>t(new oo(i))))}onnonbubblingmouseout(e,t){this._register(T3(e,i=>t(new oo(i))))}onkeydown(e,t){this._register(ae(e,Me.KEY_DOWN,i=>t(new bi(i))))}onkeyup(e,t){this._register(ae(e,Me.KEY_UP,i=>t(new bi(i))))}oninput(e,t){this._register(ae(e,Me.INPUT,t))}onblur(e,t){this._register(ae(e,Me.BLUR,t))}onfocus(e,t){this._register(ae(e,Me.FOCUS,t))}ignoreGesture(e){Rt.ignoreTarget(e)}}const R_=11;class ZMe extends bo{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...e.icon.classNamesArray),this.domNode.style.position="absolute",this.domNode.style.width=R_+"px",this.domNode.style.height=R_+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._mouseMoveMonitor=this._register(new Ug),this.onmousedown(this.bgDomNode,t=>this._arrowMouseDown(t)),this.onmousedown(this.domNode,t=>this._arrowMouseDown(t)),this._mousedownRepeatTimer=this._register(new fy),this._mousedownScheduleRepeatTimer=this._register(new Gr)}_arrowMouseDown(e){const t=()=>{this._mousedownRepeatTimer.cancelAndSet(()=>this._onActivate(),41.666666666666664)};this._onActivate(),this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancelAndSet(t,200),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,S0,i=>{},()=>{this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class YMe extends re{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Gr)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode&&this._domNode.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode&&this._domNode.setClassName(this._invisibleClassName+(e?" fade":"")))}}const XMe=140;class Qee extends bo{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new YMe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._mouseMoveMonitor=this._register(new Ug),this._shouldRender=!0,this.domNode=xt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,t=>this._domNodeMouseDown(t))}_createArrow(e){const t=this._register(new ZMe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,r){this.slider=xt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof r=="number"&&this.slider.setHeight(r),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,s=>{s.leftButton&&(s.preventDefault(),this._sliderMouseDown(s,()=>{}))}),this.onclick(this.slider.domNode,s=>{s.leftButton&&s.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodeMouseDown(e){e.target===this.domNode.domNode&&this._onMouseDown(e)}delegateMouseDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),r=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),s=this._sliderMousePosition(e);i<=s&&s<=r?e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,()=>{})):this._onMouseDown(e)}_onMouseDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.browserEvent.offsetX=="number"&&typeof e.browserEvent.offsetY=="number")t=e.browserEvent.offsetX,i=e.browserEvent.offsetY;else{const s=jn(this.domNode.domNode);t=e.posx-s.left,i=e.posy-s.top}const r=this._mouseDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(r):this._scrollbarState.getDesiredScrollPositionFromOffset(r)),e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,()=>{}))}_sliderMouseDown(e,t){const i=this._sliderMousePosition(e),r=this._sliderOrthogonalMousePosition(e),s=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,S0,o=>{const a=this._sliderOrthogonalMousePosition(o),l=Math.abs(a-r);if(Kn&&l>XMe){this._setDesiredScrollPositionNow(s.getScrollPosition());return}const h=this._sliderMousePosition(o)-i;this._setDesiredScrollPositionNow(s.getDesiredScrollPositionFromDelta(h))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd(),t()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const QMe=20;class Rw{constructor(e,t,i,r,s,o){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=r,this._scrollSize=s,this._scrollPosition=o,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new Rw(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,r,s){const o=Math.max(0,i-e),a=Math.max(0,o-2*t),l=r>0&&r>i;if(!l)return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(QMe,Math.floor(i*a/r))),h=(a-c)/(r-i),u=s*h;return{computedAvailableSize:Math.round(o),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:h,computedSliderPosition:Math.round(u)}}_refreshComputedValues(){const e=Rw._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}const JMe=ha("scrollbar-button-left",Ce.triangleLeft),eFe=ha("scrollbar-button-right",Ce.triangleRight);class tFe extends Qee{constructor(e,t,i){const r=e.getScrollDimensions(),s=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Rw(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,r.width,r.scrollWidth,s.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const o=(t.arrowSize-R_)/2,a=(t.horizontalScrollbarSize-R_)/2;this._createArrow({className:"scra",icon:JMe,top:a,left:o,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new __(null,1,0))}),this._createArrow({className:"scra",icon:eFe,top:a,left:void 0,bottom:void 0,right:o,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new __(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return e}_sliderMousePosition(e){return e.posx}_sliderOrthogonalMousePosition(e){return e.posy}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}const iFe=ha("scrollbar-button-up",Ce.triangleUp),nFe=ha("scrollbar-button-down",Ce.triangleDown);class rFe extends Qee{constructor(e,t,i){const r=e.getScrollDimensions(),s=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new Rw(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,r.height,r.scrollHeight,s.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const o=(t.arrowSize-R_)/2,a=(t.verticalScrollbarSize-R_)/2;this._createArrow({className:"scra",icon:iFe,top:o,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new __(null,0,1))}),this._createArrow({className:"scra",icon:nFe,top:void 0,left:a,bottom:o,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new __(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return t}_sliderMousePosition(e){return e.posy}_sliderOrthogonalMousePosition(e){return e.posx}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class sD{constructor(e,t,i,r,s,o){this._scrollStateBrand=void 0,e=e|0,t=t|0,i=i|0,r=r|0,s=s|0,o=o|0,this.rawScrollLeft=i,this.rawScrollTop=o,e<0&&(e=0),i+e>t&&(i=t-e),i<0&&(i=0),r<0&&(r=0),o+r>s&&(o=s-r),o<0&&(o=0),this.width=e,this.scrollWidth=t,this.scrollLeft=i,this.height=r,this.scrollHeight=s,this.scrollTop=o}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new sD(typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new sD(this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,r=this.scrollWidth!==e.scrollWidth,s=this.scrollLeft!==e.scrollLeft,o=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:r,scrollLeftChanged:s,heightChanged:o,scrollHeightChanged:a,scrollTopChanged:l}}}class IL extends re{constructor(e,t){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new H),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e,this._scheduleAtNextAnimationFrame=t,this._state=new sD(0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let r;t?r=new Mw(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):r=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=r}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=Mw.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class V${constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function KT(n,e){const t=e-n;return function(i){return n+t*aFe(i)}}function sFe(n,e,t){return function(i){return i<t?n(i/t):e((i-t)/(1-t))}}class Mw{constructor(e,t,i,r){this.from=e,this.to=t,this.duration=r,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let s,o;return e<t?(s=e+.75*i,o=t-.75*i):(s=e-.75*i,o=t+.75*i),sFe(KT(e,s),KT(o,t),.33)}return KT(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),r=this.scrollTop(t);return new V$(i,r,!1)}return new V$(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return Mw.start(e,t,i)}static start(e,t,i){i=i+10;const r=Date.now()-10;return new Mw(e,t,r,i)}}function oFe(n){return Math.pow(n,3)}function aFe(n){return 1-oFe(1-n)}const lFe=500,W$=50;class cFe{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class yF{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,r=this._rear;do{const s=r===this._front?e:Math.pow(2,-i);if(e-=s,t+=this._memory[r].score*s,r===this._front)break;r=(this._capacity+r-1)%this._capacity,i++}while(!0);return t<=.5}accept(e,t,i){const r=new cFe(e,t,i);r.score=this._computeScore(r),this._front===-1&&this._rear===-1?(this._memory[0]=r,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=r)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let t=.5;return this._front===-1&&this._rear===-1||this._memory[this._rear],(!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(t+=.25),Math.min(Math.max(t,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}yF.INSTANCE=new yF;class Jee extends bo{constructor(e,t,i){super(),this._onScroll=this._register(new H),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new H),e.style.overflow="hidden",this._options=hFe(t),this._scrollable=i,this._register(this._scrollable.onScroll(s=>{this._onWillScroll.fire(s),this._onDidScroll(s),this._onScroll.fire(s)}));const r={onMouseWheel:s=>this._onMouseWheel(s),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new rFe(this._scrollable,this._options,r)),this._horizontalScrollbar=this._register(new tFe(this._scrollable,this._options,r)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=xt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=xt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=xt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,s=>this._onMouseOver(s)),this.onnonbubblingmouseout(this._listenOnDomNode,s=>this._onMouseOut(s)),this._hideTimeout=this._register(new Gr),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=mt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarMouseDown(e){this._verticalScrollbar.delegateMouseDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,wt&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=mt(this._mouseWheelToDispose),e)){const i=r=>{this._onMouseWheel(new __(r))};this._mouseWheelToDispose.push(ae(this._listenOnDomNode,Me.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){const t=yF.INSTANCE;{const s=window.devicePixelRatio/GDe();Kn||zr?t.accept(Date.now(),e.deltaX/s,e.deltaY/s):t.accept(Date.now(),e.deltaX,e.deltaY)}let i=!1;if(e.deltaY||e.deltaX){let s=e.deltaY*this._options.mouseWheelScrollSensitivity,o=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(Math.abs(s)>=Math.abs(o)?o=0:s=0),this._options.flipAxes&&([s,o]=[o,s]);const a=!wt&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!o&&(o=s,s=0),e.browserEvent&&e.browserEvent.altKey&&(o=o*this._options.fastScrollSensitivity,s=s*this._options.fastScrollSensitivity);const l=this._scrollable.getFutureScrollPosition();let c={};if(s){const h=W$*s,u=l.scrollTop-(h<0?Math.floor(h):Math.ceil(h));this._verticalScrollbar.writeScrollPosition(c,u)}if(o){const h=W$*o,u=l.scrollLeft-(h<0?Math.floor(h):Math.ceil(h));this._horizontalScrollbar.writeScrollPosition(c,u)}c=this._scrollable.validateScrollPosition(c),(l.scrollLeft!==c.scrollLeft||l.scrollTop!==c.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(c):this._scrollable.setScrollPositionNow(c),i=!0)}let r=i;!r&&this._options.alwaysConsumeMouseWheel&&(r=!0),!r&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(r=!0),r&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,r=i?" left":"",s=t?" top":"",o=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${r}`),this._topShadowDomNode.setClassName(`shadow${s}`),this._topLeftShadowDomNode.setClassName(`shadow${o}${s}${r}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseOut(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),lFe)}}class F5 extends Jee{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new IL(0,r=>ic(r));super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class O5 extends Jee{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class TL extends F5{constructor(e,t){super(e,t),this._element=e,this.onScroll(i=>{i.scrollTopChanged&&(this._element.scrollTop=i.scrollTop),i.scrollLeftChanged&&(this._element.scrollLeft=i.scrollLeft)}),this.scanDomNode()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function hFe(n){const e={lazyRender:typeof n.lazyRender<"u"?n.lazyRender:!1,className:typeof n.className<"u"?n.className:"",useShadows:typeof n.useShadows<"u"?n.useShadows:!0,handleMouseWheel:typeof n.handleMouseWheel<"u"?n.handleMouseWheel:!0,flipAxes:typeof n.flipAxes<"u"?n.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof n.consumeMouseWheelIfScrollbarIsNeeded<"u"?n.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof n.alwaysConsumeMouseWheel<"u"?n.alwaysConsumeMouseWheel:!1,scrollYToX:typeof n.scrollYToX<"u"?n.scrollYToX:!1,mouseWheelScrollSensitivity:typeof n.mouseWheelScrollSensitivity<"u"?n.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof n.fastScrollSensitivity<"u"?n.fastScrollSensitivity:5,scrollPredominantAxis:typeof n.scrollPredominantAxis<"u"?n.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof n.mouseWheelSmoothScroll<"u"?n.mouseWheelSmoothScroll:!0,arrowSize:typeof n.arrowSize<"u"?n.arrowSize:11,listenOnDomNode:typeof n.listenOnDomNode<"u"?n.listenOnDomNode:null,horizontal:typeof n.horizontal<"u"?n.horizontal:1,horizontalScrollbarSize:typeof n.horizontalScrollbarSize<"u"?n.horizontalScrollbarSize:10,horizontalSliderSize:typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:0,horizontalHasArrows:typeof n.horizontalHasArrows<"u"?n.horizontalHasArrows:!1,vertical:typeof n.vertical<"u"?n.vertical:1,verticalScrollbarSize:typeof n.verticalScrollbarSize<"u"?n.verticalScrollbarSize:10,verticalHasArrows:typeof n.verticalHasArrows<"u"?n.verticalHasArrows:!1,verticalSliderSize:typeof n.verticalSliderSize<"u"?n.verticalSliderSize:0,scrollByPage:typeof n.scrollByPage<"u"?n.scrollByPage:!1};return e.horizontalSliderSize=typeof n.horizontalSliderSize<"u"?n.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof n.verticalSliderSize<"u"?n.verticalSliderSize:e.verticalScrollbarSize,wt&&(e.className+=" mac"),e}class uFe extends _o{constructor(e,t,i,r){super(e);const s=this._context.configuration.options,o=s.get(91),a=s.get(66),l=s.get(34),c=s.get(94),h={listenOnDomNode:i.domNode,className:"editor-scrollable "+GE(e.theme.type),useShadows:!1,lazyRender:!0,vertical:o.vertical,horizontal:o.horizontal,verticalHasArrows:o.verticalHasArrows,horizontalHasArrows:o.horizontalHasArrows,verticalScrollbarSize:o.verticalScrollbarSize,verticalSliderSize:o.verticalSliderSize,horizontalScrollbarSize:o.horizontalScrollbarSize,horizontalSliderSize:o.horizontalSliderSize,handleMouseWheel:o.handleMouseWheel,alwaysConsumeMouseWheel:o.alwaysConsumeMouseWheel,arrowSize:o.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:o.scrollByPage};this.scrollbar=this._register(new O5(t.domNode,h,this._context.viewLayout.getScrollable())),oc.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=xt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const u=(d,f,g)=>{const p={};if(f){const m=d.scrollTop;m&&(p.scrollTop=this._context.viewLayout.getCurrentScrollTop()+m,d.scrollTop=0)}if(g){const m=d.scrollLeft;m&&(p.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+m,d.scrollLeft=0)}this._context.model.setScrollPosition(p,1)};this._register(ae(i.domNode,"scroll",d=>u(i.domNode,!0,!0))),this._register(ae(t.domNode,"scroll",d=>u(t.domNode,!0,!1))),this._register(ae(r.domNode,"scroll",d=>u(r.domNode,!0,!1))),this._register(ae(this.scrollbarDomNode.domNode,"scroll",d=>u(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(129);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(64).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarMouseDown(e){this.scrollbar.delegateVerticalScrollbarMouseDown(e)}onConfigurationChanged(e){if(e.hasChanged(91)||e.hasChanged(66)||e.hasChanged(34)){const t=this._context.configuration.options,i=t.get(91),r=t.get(66),s=t.get(34),o=t.get(94),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:r,fastScrollSensitivity:s,scrollPredominantAxis:o};this.scrollbar.updateOptions(a)}return e.hasChanged(129)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+GE(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}li((n,e)=>{const t=n.getColor(wy);t&&e.addRule(`
			.monaco-scrollable-element > .shadow.top {
				box-shadow: ${t} 0 6px 6px -6px inset;
			}

			.monaco-scrollable-element > .shadow.left {
				box-shadow: ${t} 6px 0 6px -6px inset;
			}

			.monaco-scrollable-element > .shadow.top.left {
				box-shadow: ${t} 6px 6px 6px -6px inset;
			}
		`);const i=n.getColor(fv);i&&e.addRule(`
			.monaco-scrollable-element > .scrollbar > .slider {
				background: ${i};
			}
		`);const r=n.getColor(gv);r&&e.addRule(`
			.monaco-scrollable-element > .scrollbar > .slider:hover {
				background: ${r};
			}
		`);const s=n.getColor(pv);s&&e.addRule(`
			.monaco-scrollable-element > .scrollbar > .slider.active {
				background: ${s};
			}
		`)});class oD{constructor(e,t,i){this._decorationToRenderBrand=void 0,this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(i)}}class P5 extends x0{_render(e,t,i){const r=[];for(let a=e;a<=t;a++){const l=a-e;r[l]=[]}if(i.length===0)return r;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let s=null,o=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],h=c.className;let u=Math.max(c.startLineNumber,e)-e;const d=Math.min(c.endLineNumber,t)-e;s===h?(u=Math.max(o+1,u),o=Math.max(o,d)):(s=h,o=d);for(let f=u;f<=o;f++)r[f].push(s)}return r}}class dFe extends P5{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(129);this._lineHeight=t.get(58),this._glyphMargin=t.get(49),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(129);return this._lineHeight=t.get(58),this._glyphMargin=t.get(49),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let i=[],r=0;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.options.glyphMarginClassName;l&&(i[r++]=new oD(a.range.startLineNumber,a.range.endLineNumber,l))}return i}prepareRender(e){if(!this._glyphMargin){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._render(t,i,this._getDecorations(e)),s=this._lineHeight.toString(),o=this._glyphMarginLeft.toString(),a=this._glyphMarginWidth.toString(),l='" style="left:'+o+"px;width:"+a+"px;height:"+s+'px;"></div>',c=[];for(let h=t;h<=i;h++){const u=h-t,d=r[u];d.length===0?c[u]="":c[u]='<div class="cgmr codicon '+d.join(" ")+l}this._renderResult=c}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class fFe extends x0{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(130),r=t.get(43);this._lineHeight=t.get(58),this._spaceWidth=r.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*r.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(13),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(130),r=t.get(43);return this._lineHeight=t.get(58),this._spaceWidth=r.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*r.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(13),!0}onCursorStateChanged(e){var t;const r=e.selections[0].getPosition();return!((t=this._primaryPosition)===null||t===void 0)&&t.equals(r)?!1:(this._primaryPosition=r,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var t,i,r,s;if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const o=e.visibleRange.startLineNumber,a=e.visibleRange.endLineNumber,l=e.scrollWidth,c=this._lineHeight,h=this._primaryPosition,u=this.getGuidesByLine(o,a,h),d=[];for(let f=o;f<=a;f++){const g=f-o,p=u[g];let m="";const b=(i=(t=e.visibleRangeForPosition(new G(f,1)))===null||t===void 0?void 0:t.left)!==null&&i!==void 0?i:0;for(const _ of p){const w=b+(_.visibleColumn-1)*this._spaceWidth;if(w>l||this._maxIndentLeft>0&&w>this._maxIndentLeft)break;const y=_.horizontalLine?_.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",S=_.horizontalLine?((s=(r=e.visibleRangeForPosition(new G(f,_.horizontalLine.endColumn)))===null||r===void 0?void 0:r.left)!==null&&s!==void 0?s:w+this._spaceWidth)-w:this._spaceWidth;m+=`<div class="core-guide ${_.className} ${y}" style="left:${w}px;height:${c}px;width:${S}px"></div>`}d[g]=m}this._renderResult=d}getGuidesByLine(e,t,i){const r=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.model.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?Lf.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?Lf.EnabledForActive:Lf.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,s=this._bracketPairGuideOptions.indentation?this._context.model.getLinesIndentGuides(e,t):null;let o=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation&&i){const u=this._context.model.getActiveIndentGuide(i.lineNumber,e,t);o=u.startLineNumber,a=u.endLineNumber,l=u.indent}const{indentSize:c}=this._context.model.getTextModelOptions(),h=[];for(let u=e;u<=t;u++){const d=new Array;h.push(d);const f=r?r[u-e]:[],g=new tv(f),p=s?s[u-e]:[];for(let m=1;m<=p;m++){const b=(m-1)*c+1,_=f.length===0&&o<=u&&u<=a&&m===l;d.push(...g.takeWhile(y=>y.visibleColumn<b)||[]);const w=g.peek();(!w||w.visibleColumn!==b||w.horizontalLine)&&d.push(new Xp(b,_?"core-guide-indent-active":"core-guide-indent",null))}d.push(...g.takeWhile(m=>!0)||[])}return h}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function TC(n){if(!(n&&n.isTransparent()))return n}li((n,e)=>{const t=n.getColor(EL);t&&e.addRule(`.monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 ${t} inset; }`);const i=n.getColor(DL)||t;i&&e.addRule(`.monaco-editor .lines-content .core-guide-indent-active { box-shadow: 1px 0 0 0 ${i} inset; }`);const r=[{bracketColor:Pee,guideColor:qRe,guideColorActive:QRe},{bracketColor:Bee,guideColor:GRe,guideColorActive:JRe},{bracketColor:Vee,guideColor:KRe,guideColorActive:eMe},{bracketColor:Wee,guideColor:ZRe,guideColorActive:tMe},{bracketColor:$ee,guideColor:YRe,guideColorActive:iMe},{bracketColor:zee,guideColor:XRe,guideColorActive:nMe}],s=new Uee;let o=r.map(a=>{var l,c;const h=n.getColor(a.bracketColor),u=n.getColor(a.guideColor),d=n.getColor(a.guideColorActive),f=TC((l=TC(u))!==null&&l!==void 0?l:h==null?void 0:h.transparent(.3)),g=TC((c=TC(d))!==null&&c!==void 0?c:h);if(!(!f||!g))return{guideColor:f,guideColorActive:g}}).filter(nLe);if(o.length>0){for(let a=0;a<30;a++){const l=o[a%o.length];e.addRule(`.monaco-editor .${s.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${s.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${s.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${s.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}});class gFe{constructor(){this._currentVisibleRange=new V(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class pFe{constructor(e,t,i,r,s,o){this.lineNumber=e,this.startColumn=t,this.endColumn=i,this.startScrollTop=r,this.stopScrollTop=s,this.scrollType=o,this.type="range",this.minLineNumber=e,this.maxLineNumber=e}}class mFe{constructor(e,t,i,r){this.selections=e,this.startScrollTop=t,this.stopScrollTop=i,this.scrollType=r,this.type="selections";let s=e[0].startLineNumber,o=e[0].endLineNumber;for(let a=1,l=e.length;a<l;a++){const c=e[a];s=Math.min(s,c.startLineNumber),o=Math.max(o,c.endLineNumber)}this.minLineNumber=s,this.maxLineNumber=o}}class AL extends _o{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new Zee(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration,r=this._context.configuration.options,s=r.get(43),o=r.get(130);this._lineHeight=r.get(58),this._typicalHalfwidthCharacterWidth=s.typicalHalfwidthCharacterWidth,this._isViewportWrapping=o.isViewportWrapping,this._revealHorizontalRightPadding=r.get(88),this._cursorSurroundingLines=r.get(25),this._cursorSurroundingLinesStyle=r.get(26),this._canUseLayerHinting=!r.get(28),this._viewLineOptions=new n$(i,this._context.theme.type),oc.write(this.domNode,7),this.domNode.setClassName(`view-lines ${Mf}`),Yn.applyFontInfo(this.domNode,s),this._maxLineWidth=0,this._asyncUpdateLineWidths=new yi(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new yi(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new gFe,this._horizontalRevealRequest=null}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new Ol(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(130)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(43),r=t.get(130);return this._lineHeight=t.get(58),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=t.get(88),this._cursorSurroundingLines=t.get(25),this._cursorSurroundingLinesStyle=t.get(26),this._canUseLayerHinting=!t.get(28),Yn.applyFontInfo(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(129)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new n$(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();for(let s=i;s<=r;s++)this._visibleLines.getVisibleLine(s).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let r=!1;for(let s=t;s<=i;s++)r=this._visibleLines.getVisibleLine(s).onSelectionChanged()||r;return r}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=t;r<=i;r++)this._visibleLines.getVisibleLine(r).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new pFe(e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new mFe(e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const s=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.model.setScrollPosition(i,s),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.model.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const r=this._getLineNumberFor(i);if(r===-1||r<1||r>this._context.model.getLineCount())return null;if(this._context.model.getLineMaxColumn(r)===1)return new G(r,1);const s=this._visibleLines.getStartLineNumber(),o=this._visibleLines.getEndLineNumber();if(r<s||r>o)return null;let a=this._visibleLines.getVisibleLine(r).getColumnOfNodeOffset(r,e,t);const l=this._context.model.getLineMinColumn(r);return a<l&&(a=l),new G(r,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===Ol.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let r=t;r<=i;r++){const s=this._visibleLines.getVisibleLine(r);if(e===s.getDomNode())return r}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();return e<t||e>i?-1:this._visibleLines.getVisibleLine(e).getWidth()}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,r=V.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!r)return null;let s=[],o=0;const a=new i$(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new G(r.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),h=this._visibleLines.getEndLineNumber();for(let u=r.startLineNumber;u<=r.endLineNumber;u++){if(u<c||u>h)continue;const d=u===r.startLineNumber?r.startColumn:1,f=u===r.endLineNumber?r.endColumn:this._context.model.getLineMaxColumn(u),g=this._visibleLines.getVisibleLine(u).getVisibleRangesForRange(u,d,f,a);if(g){if(t&&u<i){const p=l;l=this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new G(u+1,1)).lineNumber,p!==l&&(g.ranges[g.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}s[o++]=new PTe(g.outsideRenderedLine,u,wL.from(g.ranges))}}return o===0?null:s}_visibleRangesForLineRange(e,t,i){return this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?null:this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,new i$(this.domNode.domNode,this._textRangeRestingSpot))}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new BTe(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let r=1,s=!0;for(let o=t;o<=i;o++){const a=this._visibleLines.getVisibleLine(o);if(e&&!a.getWidthIsFast()){s=!1;continue}r=Math.max(r,a.getWidth())}return s&&t===1&&i===this._context.model.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(r),s}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();for(let s=i;s<=r;s++){const o=this._visibleLines.getVisibleLine(s);if(o.needsMonospaceFontCheck()){const a=o.getWidth();a>t&&(t=a,e=s)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let s=i;s<=r;s++)this._visibleLines.getVisibleLine(s).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const r=this._computeScrollLeftToReveal(i);r&&(this._isViewportWrapping||this._ensureMaxLineWidth(r.maxHorizontalOffset),this._context.model.setScrollPosition({scrollLeft:r.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()||this._asyncUpdateLineWidths.schedule(),zr&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();for(let s=i;s<=r;s++)if(this._visibleLines.getVisibleLine(s).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.model.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,r,s){const o=e.top,a=e.height,l=o+a;let c,h,u;if(r&&r.length>0){let g=r[0].startLineNumber,p=r[0].endLineNumber;for(let m=1,b=r.length;m<b;m++){const _=r[m];g=Math.min(g,_.startLineNumber),p=Math.max(p,_.endLineNumber)}c=!1,h=this._context.viewLayout.getVerticalOffsetForLineNumber(g),u=this._context.viewLayout.getVerticalOffsetForLineNumber(p)+this._lineHeight}else if(i)c=!0,h=this._context.viewLayout.getVerticalOffsetForLineNumber(i.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(i.endLineNumber)+this._lineHeight;else return-1;if(!(t==="mouse"&&this._cursorSurroundingLinesStyle==="default")){const g=Math.min(a/this._lineHeight/2,this._cursorSurroundingLines);h-=g*this._lineHeight,u+=Math.max(0,g-1)*this._lineHeight}(s===0||s===4)&&(u+=this._lineHeight);let f;if(u-h>a){if(!c)return-1;f=h}else if(s===5||s===6)if(s===6&&o<=h&&u<=l)f=o;else{const g=Math.max(5*this._lineHeight,a*.2),p=h-g,m=u-a;f=Math.max(m,p)}else if(s===1||s===2)if(s===2&&o<=h&&u<=l)f=o;else{const g=(h+u)/2;f=Math.max(0,g-a/2)}else f=this._computeMinimumScrolling(o,l,h,u,s===3,s===4);return f}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=t.left,r=i+t.width;let s=1073741824,o=0;if(e.type==="range"){const l=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!l)return null;for(const c of l.ranges)s=Math.min(s,Math.round(c.left)),o=Math.max(o,Math.round(c.left+c.width))}else for(const l of e.selections){if(l.startLineNumber!==l.endLineNumber)return null;const c=this._visibleRangesForLineRange(l.startLineNumber,l.startColumn,l.endColumn);if(!c)return null;for(const h of c.ranges)s=Math.min(s,Math.round(h.left)),o=Math.max(o,Math.round(h.left+h.width))}return s=Math.max(0,s-AL.HORIZONTAL_EXTRA_PX),o+=this._revealHorizontalRightPadding,e.type==="selections"&&o-s>t.width?null:{scrollLeft:this._computeMinimumScrolling(i,r,s,o),maxHorizontalOffset:o}}_computeMinimumScrolling(e,t,i,r,s,o){e=e|0,t=t|0,i=i|0,r=r|0,s=!!s,o=!!o;const a=t-e;if(r-i<a){if(s)return i;if(o)return Math.max(0,r-a);if(i<e)return i;if(r>t)return Math.max(0,r-a)}else return i;return e}}AL.HORIZONTAL_EXTRA_PX=30;class _Fe extends P5{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(129);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(129);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let i=[],r=0;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.options.linesDecorationsClassName;l&&(i[r++]=new oD(a.range.startLineNumber,a.range.endLineNumber,l));const c=a.options.firstLineDecorationClassName;c&&(i[r++]=new oD(a.range.startLineNumber,a.range.startLineNumber,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._render(t,i,this._getDecorations(e)),s=this._decorationsLeft.toString(),o=this._decorationsWidth.toString(),a='" style="left:'+s+"px;width:"+o+'px;"></div>',l=[];for(let c=t;c<=i;c++){const h=c-t,u=r[h];let d="";for(let f=0,g=u.length;f<g;f++)d+='<div class="cldr '+u[f]+a;l[h]=d}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class bFe extends P5{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport();let i=[],r=0;for(let s=0,o=t.length;s<o;s++){const a=t[s],l=a.options.marginClassName;l&&(i[r++]=new oD(a.range.startLineNumber,a.range.endLineNumber,l))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,r=this._render(t,i,this._getDecorations(e)),s=[];for(let o=t;o<=i;o++){const a=o-t,l=r[a];let c="";for(let h=0,u=l.length;h<u;h++)c+='<div class="cmdr '+l[h]+'" style=""></div>';s[a]=c}this._renderResult=s}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class ao{constructor(e,t,i,r){this._rgba8Brand=void 0,this.r=ao._clamp(e),this.g=ao._clamp(t),this.b=ao._clamp(i),this.a=ao._clamp(r)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}}ao.Empty=new ao(0,0,0,0);class yy extends re{constructor(){super(),this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(Fi.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}static getInstance(){return this._INSTANCE||(this._INSTANCE=new yy),this._INSTANCE}_updateColorMap(){const e=Fi.getColorMap();if(!e){this._colors=[ao.Empty],this._backgroundIsLight=!0;return}this._colors=[ao.Empty];for(let i=1;i<e.length;i++){const r=e[i].rgba;this._colors[i]=new ao(r.r,r.g,r.b,Math.round(r.a*255))}let t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}yy._INSTANCE=null;const vFe=(()=>{const n=[];for(let e=32;e<=126;e++)n.push(e);return n.push(65533),n})(),wFe=(n,e)=>(n-=32,n<0||n>96?e<=2?(n+96)%96:96-1:n);class Fw{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Fw.soften(e,12/15),this.charDataLight=Fw.soften(e,50/60)}static soften(e,t){let i=new Uint8ClampedArray(e.length);for(let r=0,s=e.length;r<s;r++)i[r]=NE(e[r]*t);return i}renderChar(e,t,i,r,s,o,a,l,c,h,u){const d=1*this.scale,f=2*this.scale,g=u?1:f;if(t+d>e.width||i+g>e.height){console.warn("bad render request outside image data");return}const p=h?this.charDataLight:this.charDataNormal,m=wFe(r,c),b=e.width*4,_=a.r,w=a.g,y=a.b,S=s.r-_,k=s.g-w,C=s.b-y,D=Math.max(o,l),E=e.data;let N=m*d*f,T=i*b+t*4;for(let j=0;j<g;j++){let q=T;for(let ie=0;ie<d;ie++){const ge=p[N++]/255*(o/255);E[q++]=_+S*ge,E[q++]=w+k*ge,E[q++]=y+C*ge,E[q++]=D}T+=b}}blockRenderChar(e,t,i,r,s,o,a,l){const c=1*this.scale,h=2*this.scale,u=l?1:h;if(t+c>e.width||i+u>e.height){console.warn("bad render request outside image data");return}const d=e.width*4,f=.5*(s/255),g=o.r,p=o.g,m=o.b,b=r.r-g,_=r.g-p,w=r.b-m,y=g+b*f,S=p+_*f,k=m+w*f,C=Math.max(s,a),D=e.data;let E=i*d+t*4;for(let N=0;N<u;N++){let T=E;for(let j=0;j<c;j++)D[T++]=y,D[T++]=S,D[T++]=k,D[T++]=C;E+=d}}}const $$={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},z$=n=>{const e=new Uint8ClampedArray(n.length/2);for(let t=0;t<n.length;t+=2)e[t>>1]=$$[n[t]]<<4|$$[n[t+1]]&15;return e},H$={1:ig(()=>z$("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:ig(()=>z$("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class bv{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return H$[e]?i=new Fw(H$[e](),e):i=bv.createFromSampleData(bv.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let r=0;for(const s of vFe)i.fillText(String.fromCharCode(s),r,16/2),r+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");let r=bv._downsample(e,t);return new Fw(r,t)}static _downsampleChar(e,t,i,r,s){const o=1*s,a=2*s;let l=r,c=0;for(let h=0;h<a;h++){const u=h/a*16,d=(h+1)/a*16;for(let f=0;f<o;f++){const g=f/o*10,p=(f+1)/o*10;let m=0,b=0;for(let w=u;w<d;w++){const y=t+Math.floor(w)*3840,S=1-(w-Math.floor(w));for(let k=g;k<p;k++){const C=1-(k-Math.floor(k)),D=y+Math.floor(k)*4,E=C*S;b+=E,m+=e[D]*e[D+3]/255*E}}const _=m/b;c=Math.max(c,_),i[l++]=NE(_)}}return c}static _downsample(e,t){const i=2*t*1*t,r=i*96,s=new Uint8ClampedArray(r);let o=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,s,o,t)),o+=i,a+=10*4;if(l>0){const c=255/l;for(let h=0;h<r;h++)s[h]*=c}return s}}const yFe=140,CFe=2;class Ow{constructor(e,t,i){const r=e.options,s=r.get(127),o=r.get(129),a=o.minimap,l=r.get(43),c=r.get(64);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=r.get(93),this.showSlider=c.showSlider,this.pixelRatio=s,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=r.get(58),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=o.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=o.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=ig(()=>bv.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=Ow._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=Ow._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(_Re);return i?new ao(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(bRe);return t?ao._clamp(Math.round(255*t.rgba.a)):255}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.showSlider===e.showSlider&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class vv{constructor(e,t,i,r,s,o,a,l){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=r,this.sliderTop=s,this.sliderHeight=o,this.startLineNumber=a,this.endLineNumber=l}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}static create(e,t,i,r,s,o,a,l,c,h,u){const d=e.pixelRatio,f=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/f),p=e.lineHeight;if(e.minimapHeightIsEditorHeight){const S=l*e.lineHeight+(e.scrollBeyondLastLine?s-e.lineHeight:0),k=Math.max(1,Math.floor(s*s/S)),C=Math.max(0,e.minimapHeight-k),D=C/(h-s),E=c*D,N=C>0,T=Math.floor(e.canvasInnerHeight/e.minimapLineHeight);return new vv(c,h,N,D,E,k,1,Math.min(a,T))}let m;if(o&&i!==a){const S=i-t+1;m=Math.floor(S*f/d)}else{const S=s/p;m=Math.floor(S*f/d)}let b;e.scrollBeyondLastLine?b=(a-1)*f/d:b=Math.max(0,a*f/d-m),b=Math.min(e.minimapHeight-m,b);const _=b/(h-s),w=c*_;let y=0;if(e.scrollBeyondLastLine&&(y=s/p-1),g>=a+y){const k=a,C=b>0;return new vv(c,h,C,_,w,m,1,k)}else{let S=Math.max(1,Math.floor(t-w*d/f));u&&u.scrollHeight===h&&(u.scrollTop>c&&(S=Math.min(S,u.startLineNumber)),u.scrollTop<c&&(S=Math.max(S,u.startLineNumber)));const k=Math.min(a,S+g-1),C=(c-r)/p,D=(t-S+C)*f/d;return new vv(c,h,!0,_,D,m,S,k)}}}class aD{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}aD.INVALID=new aD(-1);class U${constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new Kee(()=>aD.INVALID),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let r=0,s=i.length;r<s;r++)if(i[r].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class B5{constructor(e,t,i,r){this._backgroundFillData=B5._createBackgroundFillData(t,i,r),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const r=i.r,s=i.g,o=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let h=0;h<t;h++)for(let u=0;u<e;u++)l[c]=r,l[c+1]=s,l[c+2]=o,l[c+3]=a,c+=4;return l}}class Pw{constructor(e,t){this.samplingRatio=e,this.minimapLines=t}static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const r=e.pixelRatio,s=e.lineHeight,o=e.scrollBeyondLastLine,{minimapLineCount:a}=Cm.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:o,height:e.editorHeight,lineHeight:s,pixelRatio:r}),l=t/a,c=l/2;if(!i||i.minimapLines.length===0){let w=[];if(w[0]=1,a>1){for(let y=0,S=a-1;y<S;y++)w[y]=Math.round(y*l+c);w[a-1]=t}return[new Pw(l,w),[]]}const h=i.minimapLines,u=h.length;let d=[],f=0,g=0,p=1;const m=10;let b=[],_=null;for(let w=0;w<a;w++){const y=Math.max(p,Math.round(w*l)),S=Math.max(y,Math.round((w+1)*l));for(;f<u&&h[f]<y;){if(b.length<m){const C=f+1+g;_&&_.type==="deleted"&&_._oldIndex===f-1?_.deleteToLineNumber++:(_={type:"deleted",_oldIndex:f,deleteFromLineNumber:C,deleteToLineNumber:C},b.push(_)),g--}f++}let k;if(f<u&&h[f]<=S)k=h[f],f++;else if(w===0?k=1:w+1===a?k=t:k=Math.round(w*l+c),b.length<m){const C=f+1+g;_&&_.type==="inserted"&&_._i===w-1?_.insertToLineNumber++:(_={type:"inserted",_i:w,insertFromLineNumber:C,insertToLineNumber:C},b.push(_)),g++}d[w]=k,p=k}if(b.length<m)for(;f<u;){const w=f+1+g;_&&_.type==="deleted"&&_._oldIndex===f-1?_.deleteToLineNumber++:(_={type:"deleted",_oldIndex:f,deleteFromLineNumber:w,deleteToLineNumber:w},b.push(_)),g--,f++}else b=[{type:"flush"}];return[new Pw(l,d),b]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let r=this.modelLineToMinimapLine(t)-1;for(;r+1<this.minimapLines.length&&this.minimapLines[r+1]<=t;)r++;if(i===r){const s=this.minimapLines[i];if(s<e||s>t)return null}return[i+1,r+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),r=this.modelLineToMinimapLine(t);return e!==t&&r===i&&(r===this.minimapLines.length?i>1&&i--:r++),[i,r]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,r=0;for(let s=this.minimapLines.length-1;s>=0&&!(this.minimapLines[s]<e.fromLineNumber);s--)this.minimapLines[s]<=e.toLineNumber?(this.minimapLines[s]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,s),r=Math.max(r,s)):this.minimapLines[s]-=t;return[i,r]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class SFe extends _o{constructor(e){super(e),this.tokensColorTracker=yy.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Ow(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=Pw.compute(this.options,this._context.model.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new lD(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new Ow(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.toLineNumber);return t?this._actual.onLinesChanged(t[0],t[1]):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._context.model.invalidateMinimapColorCache(),this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){let t=[];for(const i of e.ranges){const r=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);r&&t.push({fromLineNumber:r[0],toLineNumber:r[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const r={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(r)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=Pw.compute(this.options,this._context.model.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const r of i)switch(r.type){case"deleted":this._actual.onLinesDeleted(r.deleteFromLineNumber,r.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(r.insertFromLineNumber,r.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.model.getLineCount()}getRealLineCount(){return this._context.model.getLineCount()}getLineContent(e){return this._samplingState?this._context.model.getLineContent(this._samplingState.minimapLines[e-1]):this._context.model.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.model.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.model.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){let r=[];for(let s=0,o=t-e+1;s<o;s++)i[s]?r[s]=this._context.model.getViewLineData(this._samplingState.minimapLines[e+s-1]):r[s]=null;return r}return this._context.model.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new je(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const s=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new V(s,1,o,this._context.model.getLineMaxColumn(o))}else i=new V(e,1,t,this._context.model.getLineMaxColumn(t));const r=this._context.model.getDecorationsInViewport(i);if(this._samplingState){let s=[];for(const o of r){if(!o.options.minimap)continue;const a=o.range,l=this._samplingState.modelLineToMinimapLine(a.startLineNumber),c=this._samplingState.modelLineToMinimapLine(a.endLineNumber);s.push(new xJ(new V(l,a.startColumn,c,a.endColumn),o.options))}return s}return r}getOptions(){return this._context.model.getTextModelOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.model.revealRange("mouse",!1,new V(e,1,e,1),1,0)}setScrollTop(e){this._context.model.setScrollPosition({scrollTop:e},1)}}class lD extends re{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(S$),this._domNode=xt(document.createElement("div")),oc.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=xt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=xt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=xt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=xt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=xt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._mouseDownListener=dn(this._domNode.domNode,"mousedown",i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.leftButton&&this._lastRenderData){const c=jn(this._slider.domNode),h=c.top+c.height/2;this._startSliderDragging(i.buttons,i.posx,h,i.posy,this._lastRenderData.renderedLayout)}return}const s=this._model.options.minimapLineHeight,o=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.browserEvent.offsetY;let l=Math.floor(o/s)+this._lastRenderData.renderedLayout.startLineNumber;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderMouseMoveMonitor=new Ug,this._sliderMouseDownListener=dn(this._slider.domNode,"mousedown",i=>{i.preventDefault(),i.stopPropagation(),i.leftButton&&this._lastRenderData&&this._startSliderDragging(i.buttons,i.posx,i.posy,i.posy,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Rt.addTarget(this._domNode.domNode),this._sliderTouchStartListener=ae(this._domNode.domNode,Qt.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=ae(this._domNode.domNode,Qt.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=dn(this._domNode.domNode,Qt.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i,r,s){this._slider.toggleClassName("active",!0);const o=(a,l)=>{const c=Math.abs(l-t);if(Kn&&c>yFe){this._model.setScrollTop(s.scrollTop);return}const h=a-i;this._model.setScrollTop(s.getDesiredScrollTopFromDelta(h))};r!==i&&o(r,t),this._sliderMouseMoveMonitor.startMonitoring(this._slider.domNode,e,S0,a=>o(a.posy,a.posx),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._mouseDownListener.dispose(),this._sliderMouseMoveMonitor.dispose(),this._sliderMouseDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){return this._model.options.showSlider==="always"?"minimap slider-always":"minimap slider-mouseover"}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new B5(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(S$),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=vv.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(V.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((d,f)=>(d.options.zIndex||0)-(f.options.zIndex||0));const{canvasInnerWidth:r,canvasInnerHeight:s}=this._model.options,o=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,r,s);const h=new j$(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,h,e,o),this._renderDecorationsLineHighlights(c,i,h,e,o);const u=new j$(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,u,e,o,l,a,r),this._renderDecorationsHighlights(c,i,u,e,o,l,a,r)}}_renderSelectionLineHighlights(e,t,i,r,s){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let o=0,a=0;for(const l of t){const c=Math.max(r.startLineNumber,l.startLineNumber),h=Math.min(r.endLineNumber,l.endLineNumber);if(c>h)continue;for(let f=c;f<=h;f++)i.set(f,!0);const u=(c-r.startLineNumber)*s,d=(h-r.startLineNumber)*s+s;a>=u||(a>o&&e.fillRect(Gh,o,e.canvas.width,a-o),o=u),a=d}a>o&&e.fillRect(Gh,o,e.canvas.width,a-o)}_renderDecorationsLineHighlights(e,t,i,r,s){const o=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==Xl.Inline)continue;const h=Math.max(r.startLineNumber,l.range.startLineNumber),u=Math.min(r.endLineNumber,l.range.endLineNumber);if(h>u)continue;const d=c.getColor(this._theme);if(!d||d.isTransparent())continue;let f=o.get(d.toString());f||(f=d.transparent(.5).toString(),o.set(d.toString(),f)),e.fillStyle=f;for(let g=h;g<=u;g++){if(i.has(g))continue;i.set(g,!0);const p=(h-r.startLineNumber)*s;e.fillRect(Gh,p,e.canvas.width,s)}}}_renderSelectionsHighlights(e,t,i,r,s,o,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const h=Math.max(r.startLineNumber,c.startLineNumber),u=Math.min(r.endLineNumber,c.endLineNumber);if(!(h>u))for(let d=h;d<=u;d++)this.renderDecorationOnLine(e,i,c,this._selectionColor,r,d,s,s,o,a,l)}}_renderDecorationsHighlights(e,t,i,r,s,o,a,l){for(const c of t){const h=c.options.minimap;if(!h)continue;const u=Math.max(r.startLineNumber,c.range.startLineNumber),d=Math.min(r.endLineNumber,c.range.endLineNumber);if(u>d)continue;const f=h.getColor(this._theme);if(!(!f||f.isTransparent()))for(let g=u;g<=d;g++)switch(h.position){case Xl.Inline:this.renderDecorationOnLine(e,i,c.range,f,r,g,s,s,o,a,l);continue;case Xl.Gutter:const p=(g-r.startLineNumber)*s,m=2;this.renderDecoration(e,f,m,p,CFe,s);continue}}}renderDecorationOnLine(e,t,i,r,s,o,a,l,c,h,u){const d=(o-s.startLineNumber)*l;if(d+a<0||d>this._model.options.canvasInnerHeight)return;const{startLineNumber:f,endLineNumber:g}=i,p=f===o?i.startColumn:1,m=g===o?i.endColumn:this._model.getLineMaxColumn(o),b=this.getXOffsetForPosition(t,o,p,c,h,u),_=this.getXOffsetForPosition(t,o,m,c,h,u);this.renderDecoration(e,r,b,d,_-b,a)}getXOffsetForPosition(e,t,i,r,s,o){if(i===1)return Gh;if((i-1)*s>=o)return o;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Gh];let h=Gh;for(let u=1;u<c.length+1;u++){const d=c.charCodeAt(u-1),f=d===9?r*s:Ra(d)?2*s:s,g=h+f;if(g>=o){l[u]=o;break}l[u]=g,h=g}e.set(t,l)}return i-1<l.length?l[i-1]:o}renderDecoration(e,t,i,r,s,o){e.fillStyle=t&&t.toString()||"",e.fillRect(i,r,s,o)}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,r=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const ge=this._lastRenderData._get();return new U$(e,ge.imageData,ge.lines)}const s=this._getBuffer();if(!s)return null;let[o,a,l]=lD._renderUntouchedLines(s,t,i,r,this._lastRenderData);const c=this._model.getMinimapLinesRenderingData(t,i,l),h=this._model.getOptions().tabSize,u=this._model.options.defaultBackgroundColor,d=this._model.options.backgroundColor,f=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,p=g.backgroundIsLight(),m=this._model.options.renderMinimap,b=this._model.options.charRenderer(),_=this._model.options.fontScale,w=this._model.options.minimapCharWidth,S=(m===1?2:2+1)*_,k=r>S?Math.floor((r-S)/2):0,C=d.a/255,D=new ao(Math.round((d.r-u.r)*C+u.r),Math.round((d.g-u.g)*C+u.g),Math.round((d.b-u.b)*C+u.b),255);let E=0;const N=[];for(let ge=0,be=i-t+1;ge<be;ge++)l[ge]&&lD._renderLine(s,D,d.a,p,m,w,g,f,b,E,k,h,c[ge],_,r),N[ge]=new aD(E),E+=r;const T=o===-1?0:o,q=(a===-1?s.height:a)-T;return this._canvas.domNode.getContext("2d").putImageData(s,0,0,0,T,s.width,q),new U$(e,s,N)}static _renderUntouchedLines(e,t,i,r,s){const o=[];if(!s){for(let D=0,E=i-t+1;D<E;D++)o[D]=!0;return[-1,-1,o]}const a=s._get(),l=a.imageData.data,c=a.rendLineNumberStart,h=a.lines,u=h.length,d=e.width,f=e.data,g=(i-t+1)*r*d*4;let p=-1,m=-1,b=-1,_=-1,w=-1,y=-1,S=0;for(let D=t;D<=i;D++){const E=D-t,N=D-c,T=N>=0&&N<u?h[N].dy:-1;if(T===-1){o[E]=!0,S+=r;continue}const j=T*d*4,q=(T+r)*d*4,ie=S*d*4,ge=(S+r)*d*4;_===j&&y===ie?(_=q,y=ge):(b!==-1&&(f.set(l.subarray(b,_),w),p===-1&&b===0&&b===w&&(p=_),m===-1&&_===g&&b===w&&(m=b)),b=j,_=q,w=ie,y=ge),o[E]=!1,S+=r}b!==-1&&(f.set(l.subarray(b,_),w),p===-1&&b===0&&b===w&&(p=_),m===-1&&_===g&&b===w&&(m=b));const k=p===-1?-1:p/(d*4),C=m===-1?-1:m/(d*4);return[k,C,o]}static _renderLine(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p){const m=f.content,b=f.tokens,_=e.width-o,w=p===1;let y=Gh,S=0,k=0;for(let C=0,D=b.getCount();C<D;C++){const E=b.getEndOffset(C),N=b.getForeground(C),T=a.getColor(N);for(;S<E;S++){if(y>_)return;const j=m.charCodeAt(S);if(j===9){const q=d-(S+k)%d;k+=q-1,y+=q*o}else if(j===32)y+=o;else{const q=Ra(j)?2:1;for(let ie=0;ie<q;ie++)if(s===2?c.blockRenderChar(e,y,h+u,T,l,t,i,w):c.renderChar(e,y,h+u,j,T,l,t,i,g,r,w),y+=o,y>_)return}}}}}class j${constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let r=0,s=this._endLineNumber-this._startLineNumber+1;r<s;r++)this._values[r]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}li((n,e)=>{const t=n.getColor(vRe);t&&e.addRule(`.monaco-editor .minimap-slider .minimap-slider-horizontal { background: ${t}; }`);const i=n.getColor(wRe);i&&e.addRule(`.monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: ${i}; }`);const r=n.getColor(yRe);r&&e.addRule(`.monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: ${r}; }`);const s=n.getColor(wy);s&&e.addRule(`.monaco-editor .minimap-shadow-visible { box-shadow: ${s} -6px 0 6px -6px inset; }`)});class xFe extends _o{constructor(e){super(e);const i=this._context.configuration.options.get(129);this._widgets={},this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,this._domNode=xt(document.createElement("div")),oc.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(129);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=xt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference===t?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const r=this._widgets[t].domNode.domNode;delete this._widgets[t],r.parentNode.removeChild(r),this.setShouldRender()}}_renderWidget(e){const t=e.domNode;if(e.preference===null){t.unsetTop();return}if(e.preference===0)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(e.preference===1){const i=t.domNode.clientHeight;t.setTop(this._editorHeight-i-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else e.preference===2&&(t.setTop(0),t.domNode.style.right="50%")}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets);for(let i=0,r=t.length;i<r;i++){const s=t[i];this._renderWidget(this._widgets[s])}}}class EFe{constructor(e,t){const i=e.options;this.lineHeight=i.get(58),this.pixelRatio=i.get(127),this.overviewRulerLanes=i.get(73),this.renderBorder=i.get(72);const r=t.getColor(PRe);this.borderColor=r?r.toString():null,this.hideCursor=i.get(51);const s=t.getColor(Ree);this.cursorColor=s?s.transparent(.7).toString():null,this.themeType=t.type;const o=i.get(64),a=o.enabled,l=o.side,c=a?t.getColor(BRe)||Fi.getDefaultBackground():null;c===null||l==="left"?this.backgroundColor=null:this.backgroundColor=X.Format.CSS.formatHex(c);const u=i.get(129).overviewRuler;this.top=u.top,this.right=u.right,this.domWidth=u.width,this.domHeight=u.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[d,f]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=d,this.w=f}_initLanes(e,t,i){const r=t-e;if(i>=3){const s=Math.floor(r/3),o=Math.floor(r/3),a=r-s-o,l=e,c=l+s,h=l+s+a;return[[0,l,c,l,h,l,c,l],[0,s,a,s+a,o,s+a+o,a+o,s+a+o]]}else if(i===2){const s=Math.floor(r/2),o=r-s,a=e,l=a+s;return[[0,a,a,a,l,a,a,a],[0,s,s,s,o,s+o,s+o,s+o]]}else{const s=e,o=r;return[[0,s,s,s,s,s,s,s],[0,o,o,o,o,o,o,o]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&this.backgroundColor===e.backgroundColor&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class DFe extends _o{constructor(e){super(e),this._domNode=xt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=Fi.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new EFe(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}onConfigurationChanged(e){return this._updateSettings(!1)}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++)this._cursorPositions[t]=e.selections[t].getPosition();return this._cursorPositions.sort(G.compare),!0}onDecorationsChanged(e){return!!e.affectsOverviewRuler}onFlushed(e){return!0}onScrollChanged(e){return e.scrollHeightChanged}onZonesChanged(e){return!0}onThemeChanged(e){return this._context.model.invalidateOverviewRulerColorCache(),this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render()}_render(){if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(this._settings.backgroundColor?this._settings.backgroundColor:"");return}const e=this._settings.canvasWidth,t=this._settings.canvasHeight,i=this._settings.lineHeight,r=this._context.viewLayout,s=this._context.viewLayout.getScrollHeight(),o=t/s,a=this._context.model.getAllOverviewRulerDecorations(this._context.theme),l=6*this._settings.pixelRatio|0,c=l/2|0,h=this._domNode.domNode.getContext("2d");this._settings.backgroundColor===null?h.clearRect(0,0,e,t):(h.fillStyle=this._settings.backgroundColor,h.fillRect(0,0,e,t));const u=this._settings.x,d=this._settings.w;a.sort(EJ.cmp);for(const f of a){const g=f.color,p=f.data;h.fillStyle=g;let m=0,b=0,_=0;for(let w=0,y=p.length/3;w<y;w++){const S=p[3*w],k=p[3*w+1],C=p[3*w+2];let D=r.getVerticalOffsetForLineNumber(k)*o|0,E=(r.getVerticalOffsetForLineNumber(C)+i)*o|0;if(E-D<l){let T=(D+E)/2|0;T<c?T=c:T+c>t&&(T=t-c),D=T-c,E=T+c}D>_+1||S!==m?(w!==0&&h.fillRect(u[m],b,d[m],_-b),m=S,b=D,_=E):E>_&&(_=E)}h.fillRect(u[m],b,d[m],_-b)}if(!this._settings.hideCursor&&this._settings.cursorColor){const f=2*this._settings.pixelRatio|0,g=f/2|0,p=this._settings.x[7],m=this._settings.w[7];h.fillStyle=this._settings.cursorColor;let b=-100,_=-100;for(let w=0,y=this._cursorPositions.length;w<y;w++){const S=this._cursorPositions[w];let k=r.getVerticalOffsetForLineNumber(S.lineNumber)*o|0;k<g?k=g:k+g>t&&(k=t-g);const C=k-g,D=C+f;C>_+1?(w!==0&&h.fillRect(p,b,m,_-b),b=C,_=D):D>_&&(_=D)}h.fillRect(p,b,m,_-b)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(h.beginPath(),h.lineWidth=1,h.strokeStyle=this._settings.borderColor,h.moveTo(0,0),h.lineTo(0,t),h.stroke(),h.moveTo(0,0),h.lineTo(e,0),h.stroke())}}class q${constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class Bw{constructor(e,t,i){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.color=i,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class kFe{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(Bw.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),r=Math.floor(this._outerHeight),s=i/r,o=Math.floor(4*this._pixelRatio/2);let a=[];for(let l=0,c=this._zones.length;l<c;l++){const h=this._zones[l];if(!e){const _=h.getColorZones();if(_){a.push(_);continue}}const u=Math.floor(s*this._getVerticalOffsetForLine(h.startLineNumber)),d=Math.floor(s*(this._getVerticalOffsetForLine(h.endLineNumber)+t));let f=Math.floor((u+d)/2),g=d-f;g<o&&(g=o),f-g<0&&(f=g),f+g>i&&(f=i-g);const p=h.color;let m=this._color2Id[p];m||(m=++this._lastAssignedId,this._color2Id[p]=m,this._id2Color[m]=p);const b=new q$(f-g,f+g,m);h.setColorZone(b),a.push(b)}return this._colorZonesInvalid=!1,a.sort(q$.compare),a}}class LFe extends by{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=xt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new kFe(r=>this._context.viewLayout.getVerticalOffsetForLineNumber(r)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(58)),this._zoneManager.setPixelRatio(i.get(127)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(58)&&(this._zoneManager.setLineHeight(t.get(58)),this._render()),e.hasChanged(127)&&(this._zoneManager.setPixelRatio(t.get(127)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),r=this._zoneManager.getId2Color(),s=this._domNode.domNode.getContext("2d");return s.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(s,i,r,e),!0}_renderOneLane(e,t,i,r){let s=0,o=0,a=0;for(const l of t){const c=l.colorId,h=l.from,u=l.to;c!==s?(e.fillRect(0,o,r,a-o),s=c,e.fillStyle=i[s],o=h,a=u):a>=h?a=Math.max(a,u):(e.fillRect(0,o,r,a-o),o=h,a=u)}e.fillRect(0,o,r,a-o)}}class IFe extends _o{constructor(e){super(e),this.domNode=xt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(90),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(90),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:r}=this._context.model.getTextModelOptions(),s=r;let o=t-e;for(;o>0;){const a=xt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(s),this.domNode.appendChild(a),this._renderedRulers.push(a),o--}return}let i=e-t;for(;i>0;){const r=this._renderedRulers.pop();this.domNode.removeChild(r),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const r=this._renderedRulers[t],s=this._rulers[t];r.setBoxShadow(s.color?`1px 0 0 0 ${s.color} inset`:""),r.setHeight(Math.min(e.scrollHeight,1e6)),r.setLeft(s.column*this._typicalHalfwidthCharacterWidth)}}}li((n,e)=>{const t=n.getColor(MRe);t&&e.addRule(`.monaco-editor .view-ruler { box-shadow: 1px 0 0 0 ${t} inset; }`)});class TFe extends _o{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(91);this._useShadows=i.useShadows,this._domNode=xt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(129);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.minimap.minimapWidth-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(91);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}li((n,e)=>{const t=n.getColor(wy);t&&e.addRule(`.monaco-editor .scroll-decoration { box-shadow: ${t} 0 6px 6px -6px inset; }`)});class AFe{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class NFe{constructor(e,t){this.lineNumber=e,this.ranges=t}}function RFe(n){return new AFe(n)}function MFe(n){return new NFe(n.lineNumber,n.ranges.map(RFe))}class vi extends x0{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(58),this._roundedSelection=t.get(89),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(58),this._roundedSelection=t.get(89),this._typicalHalfwidthCharacterWidth=t.get(43).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const r=this._typicalHalfwidthCharacterWidth/4;let s=null,o=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!s&&c<i.length;c++)i[c].lineNumber===a&&(s=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!o&&c>=0;c--)i[c].lineNumber===l&&(o=i[c].ranges[0]);s&&!s.startStyle&&(s=null),o&&!o.startStyle&&(o=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],h=c.left,u=c.left+c.width,d={top:0,bottom:0},f={top:0,bottom:0};if(a>0){const g=t[a-1].ranges[0].left,p=t[a-1].ranges[0].left+t[a-1].ranges[0].width;AC(h-g)<r?d.top=2:h>g&&(d.top=1),AC(u-p)<r?f.top=2:g<u&&u<p&&(f.top=1)}else s&&(d.top=s.startStyle.top,f.top=s.endStyle.top);if(a+1<l){const g=t[a+1].ranges[0].left,p=t[a+1].ranges[0].left+t[a+1].ranges[0].width;AC(h-g)<r?d.bottom=2:g<h&&h<p&&(d.bottom=1),AC(u-p)<r?f.bottom=2:u<p&&(f.bottom=1)}else o&&(d.bottom=o.startStyle.bottom,f.bottom=o.endStyle.bottom);c.startStyle=d,c.endStyle=f}}_getVisibleRangesWithStyle(e,t,i){const s=(t.linesVisibleRangesForRange(e,!0)||[]).map(MFe);return!this._visibleRangesHaveGaps(s)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,s,i),s}_createSelectionPiece(e,t,i,r,s){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;left:"+r.toString()+"px;width:"+s.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,i,r){if(r.length===0)return;const s=!!r[0].ranges[0].startStyle,o=this._lineHeight.toString(),a=(this._lineHeight-1).toString(),l=r[0].lineNumber,c=r[r.length-1].lineNumber;for(let h=0,u=r.length;h<u;h++){const d=r[h],f=d.lineNumber,g=f-t,p=i&&(f===c||f===l)?a:o,m=i&&f===l?1:0;let b="",_="";for(let w=0,y=d.ranges.length;w<y;w++){const S=d.ranges[w];if(s){const C=S.startStyle,D=S.endStyle;if(C.top===1||C.bottom===1){b+=this._createSelectionPiece(m,p,vi.SELECTION_CLASS_NAME,S.left-vi.ROUNDED_PIECE_WIDTH,vi.ROUNDED_PIECE_WIDTH);let E=vi.EDITOR_BACKGROUND_CLASS_NAME;C.top===1&&(E+=" "+vi.SELECTION_TOP_RIGHT),C.bottom===1&&(E+=" "+vi.SELECTION_BOTTOM_RIGHT),b+=this._createSelectionPiece(m,p,E,S.left-vi.ROUNDED_PIECE_WIDTH,vi.ROUNDED_PIECE_WIDTH)}if(D.top===1||D.bottom===1){b+=this._createSelectionPiece(m,p,vi.SELECTION_CLASS_NAME,S.left+S.width,vi.ROUNDED_PIECE_WIDTH);let E=vi.EDITOR_BACKGROUND_CLASS_NAME;D.top===1&&(E+=" "+vi.SELECTION_TOP_LEFT),D.bottom===1&&(E+=" "+vi.SELECTION_BOTTOM_LEFT),b+=this._createSelectionPiece(m,p,E,S.left+S.width,vi.ROUNDED_PIECE_WIDTH)}}let k=vi.SELECTION_CLASS_NAME;if(s){const C=S.startStyle,D=S.endStyle;C.top===0&&(k+=" "+vi.SELECTION_TOP_LEFT),C.bottom===0&&(k+=" "+vi.SELECTION_BOTTOM_LEFT),D.top===0&&(k+=" "+vi.SELECTION_TOP_RIGHT),D.bottom===0&&(k+=" "+vi.SELECTION_BOTTOM_RIGHT)}_+=this._createSelectionPiece(m,p,k,S.left,S.width)}e[g][0]+=b,e[g][1]+=_}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let o=i;o<=r;o++){const a=o-i;t[a]=["",""]}const s=[];for(let o=0,a=this._selections.length;o<a;o++){const l=this._selections[o];if(l.isEmpty()){s[o]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[o]);s[o]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=s,this._renderResult=t.map(([o,a])=>o+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}vi.SELECTION_CLASS_NAME="selected-text";vi.SELECTION_TOP_LEFT="top-left-radius";vi.SELECTION_BOTTOM_LEFT="bottom-left-radius";vi.SELECTION_TOP_RIGHT="top-right-radius";vi.SELECTION_BOTTOM_RIGHT="bottom-right-radius";vi.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background";vi.ROUNDED_PIECE_WIDTH=10;li((n,e)=>{const t=n.getColor(Iu);t&&e.addRule(`.monaco-editor .focused .selected-text { background-color: ${t}; }`);const i=n.getColor(T5);i&&e.addRule(`.monaco-editor .selected-text { background-color: ${i}; }`);const r=n.getColor(CNe);r&&!r.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${r}; }`)});function AC(n){return n<0?-n:n}class G${constructor(e,t,i,r,s,o){this.top=e,this.left=t,this.width=i,this.height=r,this.textContent=s,this.textContentClassName=o}}class K${constructor(e){this._context=e;const t=this._context.configuration.options,i=t.get(43);this._cursorStyle=t.get(24),this._lineHeight=t.get(58),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(27),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=xt(document.createElement("div")),this._domNode.setClassName(`cursor ${Mf}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),Yn.applyFontInfo(this._domNode,i),this._domNode.setDisplay("none"),this._position=new G(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(43);return this._cursorStyle=t.get(24),this._lineHeight=t.get(58),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(27),this._typicalHalfwidthCharacterWidth),Yn.applyFontInfo(this._domNode,i),!0}onCursorPositionChanged(e){return this._position=e,!0}_prepareRender(e){let t="";if(this._cursorStyle===kn.Line||this._cursorStyle===kn.LineThin){const d=e.visibleRangeForPosition(this._position);if(!d||d.outsideRenderedLine)return null;let f;if(this._cursorStyle===kn.Line){if(f=YV(this._lineCursorWidth>0?this._lineCursorWidth:2),f>2){const m=this._context.model.getLineContent(this._position.lineNumber),b=wE(m,this._position.column-1);t=m.substr(this._position.column-1,b)}}else f=YV(1);let g=d.left;f>=2&&g>=1&&(g-=1);const p=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta;return new G$(p,g,f,this._lineHeight,t,"")}const i=this._context.model.getLineContent(this._position.lineNumber),r=wE(i,this._position.column-1),s=e.linesVisibleRangesForRange(new V(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column+r),!1);if(!s||s.length===0)return null;const o=s[0];if(o.outsideRenderedLine||o.ranges.length===0)return null;const a=o.ranges[0],l=a.width<1?this._typicalHalfwidthCharacterWidth:a.width;let c="";if(this._cursorStyle===kn.Block){const d=this._context.model.getViewLineData(this._position.lineNumber);t=i.substr(this._position.column-1,r);const f=d.tokens.findTokenIndexAtOffset(this._position.column-1);c=d.tokens.getClassName(f)}let h=e.getVerticalOffsetForLineNumber(this._position.lineNumber)-e.bigNumbersDelta,u=this._lineHeight;return(this._cursorStyle===kn.Underline||this._cursorStyle===kn.UnderlineThin)&&(h+=this._lineHeight-2,u=2),new G$(h,a.left,l,u,t,c)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${Mf} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class Vw extends _o{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(80),this._cursorBlinking=t.get(22),this._cursorStyle=t.get(24),this._cursorSmoothCaretAnimation=t.get(23),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new K$(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=xt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new Gr,this._cursorFlatBlinkInterval=new fy,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(80),this._cursorBlinking=t.get(22),this._cursorStyle=t.get(24),this._cursorSmoothCaretAnimation=t.get(23),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,r=this._secondaryCursors.length;i<r;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t){if(this._primaryCursor.onCursorPositionChanged(e),this._updateBlinking(),this._secondaryCursors.length<t.length){const i=t.length-this._secondaryCursors.length;for(let r=0;r<i;r++){const s=new K$(this._context);this._domNode.domNode.insertBefore(s.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(s)}}else if(this._secondaryCursors.length>t.length){const i=this._secondaryCursors.length-t.length;for(let r=0;r<i;r++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let i=0;i<t.length;i++)this._secondaryCursors[i].onCursorPositionChanged(t[i])}onCursorStateChanged(e){const t=[];for(let r=0,s=e.selections.length;r<s;r++)t[r]=e.selections[r].getPosition();this._onCursorPositionChanged(t[0],t.slice(1));const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let r=0,s=e.ranges.length;r<s;r++)if(e.ranges[r].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[r].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},Vw.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},Vw.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case kn.Line:e+=" cursor-line-style";break;case kn.Block:e+=" cursor-block-style";break;case kn.Underline:e+=" cursor-underline-style";break;case kn.LineThin:e+=" cursor-line-thin-style";break;case kn.BlockOutline:e+=" cursor-block-outline-style";break;case kn.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return this._cursorSmoothCaretAnimation&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){let t=[],i=0;const r=this._primaryCursor.render(e);r&&(t[i++]=r);for(let s=0,o=this._secondaryCursors.length;s<o;s++){const a=this._secondaryCursors[s].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}}Vw.BLINK_INTERVAL=500;li((n,e)=>{const t=n.getColor(Ree);if(t){let i=n.getColor(NRe);i||(i=t.opposite()),e.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${t}; border-color: ${t}; color: ${i}; }`),n.type==="hc"&&e.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${i}; border-right: 1px solid ${i}; }`)}});const ZT=()=>{throw new Error("Invalid change accessor")};class FFe extends _o{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(129);this._lineHeight=t.get(58),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=xt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=xt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const r of e)t.set(r.id,r);let i=!1;return this._context.model.changeWhitespace(r=>{const s=Object.keys(this._zones);for(let o=0,a=s.length;o<a;o++){const l=s[o],c=this._zones[l],h=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=h.isInHiddenArea;const u=t.get(l);u&&(u.afterLineNumber!==h.afterViewLineNumber||u.height!==h.heightInPx)&&(r.changeOneWhitespace(l,h.afterViewLineNumber,h.heightInPx),this._safeCallOnComputedHeight(c.delegate,h.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(129);return this._lineHeight=t.get(58),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(58)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return typeof e.afterColumn<"u"?e.afterColumn:1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.model.validateModelPosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const o=this._context.model.validateModelPosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new G(o,this._context.model.getModelLineMaxColumn(o))}let i;t.column===this._context.model.getModelLineMaxColumn(t.lineNumber)?i=this._context.model.validateModelPosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.model.validateModelPosition({lineNumber:t.lineNumber,column:t.column+1});const r=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(t),s=this._context.model.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!s,afterViewLineNumber:r.lineNumber,heightInPx:s?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.model.changeWhitespace(i=>{const r={addZone:s=>(t=!0,this._addZone(i,s)),removeZone:s=>{s&&(t=this._removeZone(i,s)||t)},layoutZone:s=>{s&&(t=this._layoutZone(i,s)||t)}};OFe(e,r),r.addZone=ZT,r.removeZone=ZT,r.layoutZone=ZT}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),s={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:xt(t.domNode),marginDomNode:t.marginDomNode?xt(t.marginDomNode):null};return this._safeCallOnComputedHeight(s.delegate,i.heightInPx),s.domNode.setPosition("absolute"),s.domNode.domNode.style.width="100%",s.domNode.setDisplay("none"),s.domNode.setAttribute("monaco-view-zone",s.whitespaceId),this.domNode.appendChild(s.domNode),s.marginDomNode&&(s.marginDomNode.setPosition("absolute"),s.marginDomNode.domNode.style.width="100%",s.marginDomNode.setDisplay("none"),s.marginDomNode.setAttribute("monaco-view-zone",s.whitespaceId),this.marginDomNode.appendChild(s.marginDomNode)),this._zones[s.whitespaceId]=s,this.setShouldRender(),s.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.parentNode.removeChild(i.domNode.domNode),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.parentNode.removeChild(i.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],r=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=r.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,r.afterViewLineNumber,r.heightInPx),this._safeCallOnComputedHeight(i.delegate,r.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){it(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){it(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let r=!1;for(const o of t)this._zones[o.id].isInHiddenArea||(i[o.id]=o,r=!0);const s=Object.keys(this._zones);for(let o=0,a=s.length;o<a;o++){const l=s[o],c=this._zones[l];let h=0,u=0,d="none";i.hasOwnProperty(l)?(h=i[l].verticalOffset-e.bigNumbersDelta,u=i[l].height,d="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(h),c.domNode.setHeight(u),c.domNode.setDisplay(d),c.marginDomNode&&(c.marginDomNode.setTop(h),c.marginDomNode.setHeight(u),c.marginDomNode.setDisplay(d))}r&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function OFe(n,e){try{return n(e)}catch(t){it(t)}}class PFe{constructor(e){this._theme=e}get type(){return this._theme.type}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class BFe{constructor(e,t,i){this.configuration=e,this.theme=new PFe(t),this.model=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.model.addViewEventHandler(e)}removeEventHandler(e){this.model.removeViewEventHandler(e)}}class VFe{constructor(e,t,i,r){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.whitespaceViewportData=i,this._model=r,this.visibleRange=new V(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class WFe extends by{constructor(e,t,i,r,s,o){super(),this._selections=[new je(1,1,1,1)],this._renderAnimationFrame=null;const a=new VMe(t,r,s,e);this._context=new BFe(t,i.getColorTheme(),r),this._configPixelRatio=this._context.configuration.options.get(127),this._context.addEventHandler(this),this._register(i.onDidColorThemeChange(p=>{this._context.theme.update(p),this._context.model.onDidColorThemeChange(),this.render(!0,!1)})),this._viewParts=[],this._textAreaHandler=new RMe(this._context,a,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=xt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=xt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=xt(document.createElement("div")),oc.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new uFe(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new AL(this._context,this._linesContent),this._viewZones=new FFe(this._context),this._viewParts.push(this._viewZones);const l=new DFe(this._context);this._viewParts.push(l);const c=new TFe(this._context);this._viewParts.push(c);const h=new zMe(this._context);this._viewParts.push(h),h.addDynamicOverlay(new qMe(this._context)),h.addDynamicOverlay(new vi(this._context)),h.addDynamicOverlay(new fFe(this._context)),h.addDynamicOverlay(new KMe(this._context));const u=new HMe(this._context);this._viewParts.push(u),u.addDynamicOverlay(new GMe(this._context)),u.addDynamicOverlay(new dFe(this._context)),u.addDynamicOverlay(new bFe(this._context)),u.addDynamicOverlay(new _Fe(this._context)),u.addDynamicOverlay(new N_(this._context));const d=new dg(this._context);d.getDomNode().appendChild(this._viewZones.marginDomNode),d.getDomNode().appendChild(u.getDomNode()),this._viewParts.push(d),this._contentWidgets=new UMe(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new Vw(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new xFe(this._context),this._viewParts.push(this._overlayWidgets);const f=new IFe(this._context);this._viewParts.push(f);const g=new SFe(this._context);if(this._viewParts.push(g),l){const p=this._scrollbar.getOverviewRulerLayoutInfo();p.parent.insertBefore(l.getDomNode(),p.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(c.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this.domNode.appendChild(this._overflowGuardContainer),o?o.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new NMe(this._context,a,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new wMe(e,t)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new G(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPositionRelativeToEditor:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new G(e,t)))}}_applyLayout(){const t=this._context.configuration.options.get(129);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(126)+" "+GE(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this._configPixelRatio=this._context.configuration.options.get(127),this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){this._renderAnimationFrame===null&&(this._renderAnimationFrame=SQ(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){$Fe(()=>this._actualRender())}_getViewPartsToRender(){let e=[],t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!L3(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return;const t=this._context.viewLayout.getLinesViewportData();this._context.model.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new VFe(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.model);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const r=new OTe(this._context.viewLayout,i,this._viewLines);for(const s of e)s.prepareRender(r);for(const s of e)s.render(r),s.onDidRender();Math.abs(mE()-this._configPixelRatio)>.001&&this._context.configuration.updatePixelRatio()}delegateVerticalScrollbarMouseDown(e){this._scrollbar.delegateVerticalScrollbarMouseDown(e)}restoreState(e){this._context.model.setScrollPosition({scrollTop:e.scrollTop},1),this._context.model.tokenizeViewport(),this._renderNow(),this._viewLines.updateLineWidths(),this._context.model.setScrollPosition({scrollLeft:e.scrollLeft},1)}getOffsetForColumn(e,t){const i=this._context.model.validateModelPosition({lineNumber:e,column:t}),r=this._context.model.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const s=this._viewLines.visibleRangeForPosition(new G(r.lineNumber,r.column));return s?s.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?LL.convertViewToModelMouseTarget(i,this._context.model.coordinatesConverter):null}createOverviewRuler(e){return new LFe(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){let t=e.position&&e.position.range||null;if(t===null){const r=e.position?e.position.position:null;r!==null&&(t=new V(r.lineNumber,r.column,r.lineNumber,r.column))}const i=e.position?e.position.preference:null;this._contentWidgets.setWidgetPosition(e.widget,t,i),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}}function $Fe(n){try{return n()}catch(e){it(e)}}class cD{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new Dn(new V(1,1,1,1),0,new G(1,1),0),new Dn(new V(1,1,1,1),0,new G(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new st(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.getDirection()===0?new je(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new je(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,r){return t.equals(i)?r:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,r=t.selectionStart.getStartPosition(),s=t.selectionStart.getEndPosition(),o=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,r,i,o),l=this._validatePositionWithCache(e,s,r,a);return i.equals(o)&&r.equals(a)&&s.equals(l)?t:new Dn(V.fromPositions(a,l),t.selectionStartLeftoverVisibleColumns+r.column-a.column,o,t.leftoverVisibleColumns+i.column-o.column)}_setState(e,t,i){if(i&&(i=cD._validateViewState(e.viewModel,i)),t){const r=e.model.validateRange(t.selectionStart),s=t.selectionStart.equalsRange(r)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),a=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new Dn(r,s,o,a)}else{if(!i)return;const r=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),s=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new Dn(r,i.selectionStartLeftoverVisibleColumns,s,i.leftoverVisibleColumns)}if(i){const r=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),s=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new Dn(r,t.selectionStartLeftoverVisibleColumns,s,t.leftoverVisibleColumns)}else{const r=e.coordinatesConverter.convertModelPositionToViewPosition(new G(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),s=e.coordinatesConverter.convertModelPositionToViewPosition(new G(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),o=new V(r.lineNumber,r.column,s.lineNumber,s.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new Dn(o,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class Z${constructor(e){this.context=e,this.primaryCursor=new cD(e),this.secondaryCursors=[],this.lastAddedCursorIndex=0}dispose(){this.primaryCursor.dispose(this.context),this.killSecondaryCursors()}startTrackingSelections(){this.primaryCursor.startTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].startTrackingSelection(this.context)}stopTrackingSelections(){this.primaryCursor.stopTrackingSelection(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){this.primaryCursor.ensureValidState(this.context);for(let e=0,t=this.secondaryCursors.length;e<t;e++)this.secondaryCursors[e].ensureValidState(this.context)}readSelectionFromMarkers(){let e=[];e[0]=this.primaryCursor.readSelectionFromMarkers(this.context);for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].readSelectionFromMarkers(this.context);return e}getAll(){let e=[];e[0]=this.primaryCursor.asCursorState();for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].asCursorState();return e}getViewPositions(){let e=[];e[0]=this.primaryCursor.viewState.position;for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].viewState.position;return e}getTopMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,i=this.secondaryCursors.length;t<i;t++){const r=this.secondaryCursors[t].viewState.position;r.isBefore(e)&&(e=r)}return e}getBottomMostViewPosition(){let e=this.primaryCursor.viewState.position;for(let t=0,i=this.secondaryCursors.length;t<i;t++){const r=this.secondaryCursors[t].viewState.position;e.isBeforeOrEqual(r)&&(e=r)}return e}getSelections(){let e=[];e[0]=this.primaryCursor.modelState.selection;for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].modelState.selection;return e}getViewSelections(){let e=[];e[0]=this.primaryCursor.viewState.selection;for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t].viewState.selection;return e}setSelections(e){this.setStates(st.fromModelSelections(e))}getPrimaryCursor(){return this.primaryCursor.asCursorState()}setStates(e){e!==null&&(this.primaryCursor.setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.secondaryCursors.length,i=e.length;if(t<i){let r=i-t;for(let s=0;s<r;s++)this._addSecondaryCursor()}else if(t>i){let r=t-i;for(let s=0;s<r;s++)this._removeSecondaryCursor(this.secondaryCursors.length-1)}for(let r=0;r<i;r++)this.secondaryCursors[r].setState(this.context,e[r].modelState,e[r].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.secondaryCursors.push(new cD(this.context)),this.lastAddedCursorIndex=this.secondaryCursors.length}getLastAddedCursorIndex(){return this.secondaryCursors.length===0||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.secondaryCursors[e].dispose(this.context),this.secondaryCursors.splice(e,1)}_getAll(){let e=[];e[0]=this.primaryCursor;for(let t=0,i=this.secondaryCursors.length;t<i;t++)e[t+1]=this.secondaryCursors[t];return e}normalize(){if(this.secondaryCursors.length===0)return;let e=this._getAll(),t=[];for(let i=0,r=e.length;i<r;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort((i,r)=>i.selection.startLineNumber===r.selection.startLineNumber?i.selection.startColumn-r.selection.startColumn:i.selection.startLineNumber-r.selection.startLineNumber);for(let i=0;i<t.length-1;i++){const r=t[i],s=t[i+1],o=r.selection,a=s.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||o.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(o.getEndPosition()):l=a.getStartPosition().isBefore(o.getEndPosition()),l){const c=r.index<s.index?i:i+1,h=r.index<s.index?i+1:i,u=t[h].index,d=t[c].index,f=t[h].selection,g=t[c].selection;if(!f.equalsSelection(g)){const p=f.plusRange(g),m=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn,b=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn;let _;u===this.lastAddedCursorIndex?(_=m,this.lastAddedCursorIndex=d):_=b;let w;_?w=new je(p.startLineNumber,p.startColumn,p.endLineNumber,p.endColumn):w=new je(p.endLineNumber,p.endColumn,p.startLineNumber,p.startColumn),t[c].selection=w;const y=st.fromModelSelection(w);e[d].setState(this.context,y.modelState,y.viewState)}for(const p of t)p.index>u&&p.index--;e.splice(u,1),t.splice(h,1),this._removeSecondaryCursor(u-1),i--}}}}class zFe{constructor(){this.type=0}}class HFe{constructor(){this.type=1}}class UFe{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class jFe{constructor(e,t){this.type=3,this.selections=e,this.modelSelections=t}}class Dp{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0)}}class NC{constructor(){this.type=5}}class qFe{constructor(e){this.type=6,this.isFocused=e}}class GFe{constructor(){this.type=7}}class RC{constructor(){this.type=8}}class ete{constructor(e,t){this.type=9,this.fromLineNumber=e,this.toLineNumber=t}}class CF{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class SF{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class KS{constructor(e,t,i,r,s,o){this.type=12,this.source=e,this.range=t,this.selections=i,this.verticalType=r,this.revealHorizontal=s,this.scrollType=o}}class KFe{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class ZFe{constructor(){this.type=14}}class YFe{constructor(e){this.type=15,this.ranges=e}}class XFe{constructor(){this.type=16}}let QFe=class{constructor(){this.type=17}};class JFe extends re{constructor(){super(),this._onEvent=this._register(new H),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++)if(this._outgoingEvents[t].kind===e.kind){this._outgoingEvents[t]=this._outgoingEvents[t].merge(e);return}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new eOe),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class eOe{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class V5{constructor(e,t,i,r){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=r,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}merge(e){return e.kind!==0?this:new V5(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class W5{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}merge(e){return e.kind!==1?this:new W5(this.oldHasFocus,e.hasFocus)}}class $5{constructor(e,t,i,r,s,o,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=r,this.scrollWidth=s,this.scrollLeft=o,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}merge(e){return e.kind!==2?this:new $5(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class Y${constructor(){this.kind=3}isNoOp(){return!1}merge(e){return this}}class hD{constructor(e,t,i,r,s,o,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=r,this.source=s,this.reason=o,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,r=t.length;if(i!==r)return!1;for(let s=0;s<i;s++)if(!e[s].equalsSelection(t[s]))return!1;return!0}isNoOp(){return hD._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}merge(e){return e.kind!==6?this:new hD(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class tOe{constructor(){this.kind=5}isNoOp(){return!1}merge(e){return this}}class YT{constructor(e,t){this.modelVersionId=e.getVersionId(),this.cursorState=t.getCursorStates()}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class X${constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){let e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){let t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const r=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(r&&(t.push(r),r.startLineNumber!==r.endLineNumber))return!1}t.sort(V.compareRangesUsingStarts),e.sort(V.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class M_ extends re{constructor(e,t,i,r){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new N$(this._model,this._viewModel,this._coordinatesConverter,r),this._cursors=new Z$(this.context),this._hasFocus=!1,this._isHandling=!1,this._isDoingComposition=!1,this._selectionsWhenCompositionStarted=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=mt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new N$(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){let e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,r){let s=!1;r!==null&&r.length>M_.MAX_CURSOR_COUNT&&(r=r.slice(0,M_.MAX_CURSOR_COUNT),s=!0);const o=new YT(this._model,this);return this._cursors.setStates(r),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,o,s)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,i,r){const s=this._cursors.getViewPositions();if(s.length>1){this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),0,i,r);return}else{const o=s[0],a=new V(o.lineNumber,o.column,o.lineNumber,o.column);this._emitCursorRevealRange(e,t,a,null,0,i,r)}}_revealPrimaryCursor(e,t,i,r,s){const o=this._cursors.getViewPositions();if(o.length>1)this._emitCursorRevealRange(e,t,null,this._cursors.getViewSelections(),i,r,s);else{const a=o[0],l=new V(a.lineNumber,a.column,a.lineNumber,a.column);this._emitCursorRevealRange(e,t,l,null,i,r,s)}}_emitCursorRevealRange(e,t,i,r,s,o,a){e.emitViewEvent(new KS(t,i,r,s,o,a))}saveState(){let e=[];const t=this._cursors.getSelections();for(let i=0,r=t.length;i<r;i++){const s=t[i];e.push({inSelectionMode:!s.isEmpty(),selectionStart:{lineNumber:s.selectionStartLineNumber,column:s.selectionStartColumn},position:{lineNumber:s.positionLineNumber,column:s.positionColumn}})}return e}restoreState(e,t){let i=[];for(let r=0,s=t.length;r<s;r++){const o=t[r];let a=1,l=1;o.position&&o.position.lineNumber&&(a=o.position.lineNumber),o.position&&o.position.column&&(l=o.position.column);let c=a,h=l;o.selectionStart&&o.selectionStart.lineNumber&&(c=o.selectionStart.lineNumber),o.selectionStart&&o.selectionStart.column&&(h=o.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:h,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,st.fromModelSelections(i)),this.revealPrimary(e,"restoreState",!0,1)}onModelContentChanged(e,t){if(t instanceof cee){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{if(this._knownModelVersionId=t.versionId,this._isHandling)return;const i=t.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new Z$(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&t.resultingSelection&&t.resultingSelection.length>0){const r=st.fromModelSelections(t.resultingSelection);this.setStates(e,"modelChange",t.isUndoing?5:t.isRedoing?6:2,r)&&this._revealPrimaryCursor(e,"modelChange",0,!0,0)}else{const r=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,st.fromModelSelections(r))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:Mt.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:Mt.visibleColumnFromColumn2(this.context.cursorConfig,this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,r){this.setStates(e,t,r,st.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){let i=[],r=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),r.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const s=this._model.deltaDecorations([],i),o=this._model.deltaDecorations([],r);this._autoClosedActions.push(new X$(this._model,s,o))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=iOe.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);let i=[],r=[];for(let s=0;s<e.commands.length;s++){const o=e.commands[s];o instanceof Gee&&o.enclosingRange&&o.closeCharacterRange&&(i.push(o.closeCharacterRange),r.push(o.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,r),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,r,s){const o=new YT(this._model,this);if(o.equals(r))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new jFe(l,a)),!r||r.cursorState.length!==o.cursorState.length||o.cursorState.some((c,h)=>!c.modelState.equals(r.cursorState[h].modelState))){const c=r?r.cursorState.map(u=>u.modelState.selection):null,h=r?r.modelVersionId:0;e.emitOutgoingEvent(new hD(c,a,h,o.modelVersionId,t||"keyboard",i,s))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;let t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];if(!s.text||s.text.indexOf(`
`)>=0)return null;const o=s.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const a=o[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,h=s.text.length-o[2].length-1,u=s.text.lastIndexOf(c,h-1);if(u===-1)return null;t.push([u,h])}return t}executeEdits(e,t,i,r){let s=null;t==="snippet"&&(s=this._findAutoClosingPairs(i)),s&&(i[0]._isTracked=!0);let o=[],a=[];const l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(s)for(let u=0,d=s.length;u<d;u++){const[f,g]=s[u],p=c[u],m=p.range.startLineNumber,b=p.range.startColumn-1+f,_=p.range.startColumn-1+g;o.push(new V(m,_+1,m,_+2)),a.push(new V(m,b+1,m,_+2))}const h=r(c);return h&&(this._isHandling=!0),h});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),o.length>0&&this._pushAutoClosedAction(o,a)}_executeEdit(e,t,i,r=0){if(this.context.cursorConfig.readOnly)return;const s=new YT(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(o){it(o)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,r,s,!1)&&this._revealPrimaryCursor(t,i,0,!0,0)}setIsDoingComposition(e){this._isDoingComposition=e}getAutoClosedCharacters(){return X$.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._selectionsWhenCompositionStarted=this.getSelections().slice(0)}endComposition(e,t){this._executeEdit(()=>{t==="keyboard"&&(this._executeEditOperation(Di.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this._selectionsWhenCompositionStarted,this.getSelections(),this.getAutoClosedCharacters())),this._selectionsWhenCompositionStarted=null)},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const r=t.length;let s=0;for(;s<r;){const o=wE(t,s),a=t.substr(s,o);this._executeEditOperation(Di.typeWithInterceptors(this._isDoingComposition,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),s+=o}}else this._executeEditOperation(Di.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,r,s,o){if(t.length===0&&i===0&&r===0){if(s!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new je(c.lineNumber,c.column+s,c.lineNumber,c.column+s)});this.setSelections(e,o,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Di.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,r,s))},e,o)}paste(e,t,i,r,s){this._executeEdit(()=>{this._executeEditOperation(Di.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,r||[]))},e,s,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(fg.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new ts(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new ts(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}M_.MAX_CURSOR_COUNT=1e4;class iOe{static executeCommands(e,t,i){const r={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},s=this._innerExecuteCommands(r,i);for(let o=0,a=r.trackedRanges.length;o<a;o++)r.model._setTrackedRange(r.trackedRanges[o],null,0);return s}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const r=i.operations,s=this._getLoserCursorMap(r);if(s.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;let o=[];for(let c=0,h=r.length;c<h;c++)s.hasOwnProperty(r[c].identifier.major.toString())||o.push(r[c]);i.hadTrackedEditOperation&&o.length>0&&(o[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,o,c=>{let h=[];for(let f=0;f<e.selectionsBefore.length;f++)h[f]=[];for(const f of c)f.identifier&&h[f.identifier.major].push(f);const u=(f,g)=>f.identifier.minor-g.identifier.minor;let d=[];for(let f=0;f<e.selectionsBefore.length;f++)h[f].length>0?(h[f].sort(u),d[f]=t[f].computeCursorState(e.model,{getInverseEditOperations:()=>h[f],getTrackedSelection:g=>{const p=parseInt(g,10),m=e.model._getTrackedRange(e.trackedRanges[p]);return e.trackedRangesDirection[p]===0?new je(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn):new je(m.endLineNumber,m.endColumn,m.startLineNumber,m.startColumn)}})):d[f]=e.selectionsBefore[f];return d});a||(a=e.selectionsBefore);let l=[];for(let c in s)s.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,h)=>h-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],r=!1;for(let s=0,o=t.length;s<o;s++){const a=t[s];if(a){const l=this._getEditOperationsFromCommand(e,s,a);i=i.concat(l.operations),r=r||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:r}}static _getEditOperationsFromCommand(e,t,i){let r=[],s=0;const o=(u,d,f=!1)=>{V.isEmpty(u)&&d===""||r.push({identifier:{major:t,minor:s++},range:u,text:d,forceMoveMarkers:f,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const h={addEditOperation:o,addTrackedEditOperation:(u,d,f)=>{a=!0,o(u,d,f)},trackSelection:(u,d)=>{const f=je.liftSelection(u);let g;if(f.isEmpty())if(typeof d=="boolean")d?g=2:g=3;else{const b=e.model.getLineMaxColumn(f.startLineNumber);f.startColumn===b?g=2:g=3}else g=1;const p=e.trackedRanges.length,m=e.model._setTrackedRange(null,f,g);return e.trackedRanges[p]=m,e.trackedRangesDirection[p]=f.getDirection(),p.toString()}};try{i.getEditOperations(e.model,h)}catch(u){return it(u),{operations:[],hadTrackedEditOperation:!1}}return{operations:r,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,r)=>-V.compareRangesUsingEnds(i.range,r.range));let t={};for(let i=1;i<e.length;i++){const r=e[i-1],s=e[i];if(V.getStartPosition(r.range).isBefore(V.getEndPosition(s.range))){let o;r.identifier.major>s.identifier.major?o=r.identifier.major:o=s.identifier.major,t[o.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===o&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class tte{constructor(e,t,i,r,s,o){this.id=e,this.label=t,this.alias=i,this._precondition=r,this._run=s,this._contextKeyService=o}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){return this.isSupported()?this._run():Promise.resolve(void 0)}}const Q$={getInitialState:()=>Jk,tokenize2:(n,e,t,i)=>JQ(0,n,t,i)};function ite(n,e,t=Q$){return rOe(n,e,t||Q$)}function nOe(n,e,t,i,r,s,o){let a="<div>",l=i,c=0,h=!0;for(let u=0,d=e.getCount();u<d;u++){const f=e.getEndOffset(u);if(f<=i)continue;let g="";for(;l<f&&l<r;l++){const p=n.charCodeAt(l);switch(p){case 9:let m=s-(l+c)%s;for(c+=m-1;m>0;)o&&h?(g+="&#160;",h=!1):(g+=" ",h=!0),m--;break;case 60:g+="&lt;",h=!1;break;case 62:g+="&gt;",h=!1;break;case 38:g+="&amp;",h=!1;break;case 0:g+="&#00;",h=!1;break;case 65279:case 8232:case 8233:case 133:g+="",h=!1;break;case 13:g+="&#8203",h=!1;break;case 32:o&&h?(g+="&#160;",h=!1):(g+=" ",h=!0);break;default:g+=String.fromCharCode(p),h=!1}}if(a+=`<span style="${e.getInlineStyle(u,t)}">${g}</span>`,f>r||l>=r)break}return a+="</div>",a}function rOe(n,e,t){let i='<div class="monaco-tokenized-source">';const r=nc(n);let s=t.getInitialState();for(let o=0,a=r.length;o<a;o++){const l=r[o];o>0&&(i+="<br/>");const c=t.tokenize2(l,!0,s,0);In.convertToEndOffset(c.tokens,l.length);const u=new In(c.tokens,l,e).inflate();let d=0;for(let f=0,g=u.getCount();f<g;f++){const p=u.getClassName(f),m=u.getEndOffset(f);i+=`<span class="${p}">${M3(l.substring(d,m))}</span>`,d=m}s=c.endState}return i+="</div>",i}class sOe{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,r=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,r)}}class oOe{constructor(e,t,i,r,s){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=r,this.minWidth=s,this.prefixSum=0}}class Ww{constructor(e,t,i,r){this._instanceId=OQ(++Ww.INSTANCE_COUNT),this._pendingChanges=new sOe,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=r}static findInsertionIndex(e,t,i){let r=0,s=e.length;for(;r<s;){const o=r+s>>>1;t===e[o].afterLineNumber?i<e[o].ordinal?s=o:r=o+1:t<e[o].afterLineNumber?s=o:r=o+1}return r}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(r,s,o,a)=>{t=!0,r=r|0,s=s|0,o=o|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new oOe(l,r,s,o,a)),l},changeOneWhitespace:(r,s,o)=>{t=!0,s=s|0,o=o|0,this._pendingChanges.change({id:r,newAfterLineNumber:s,newHeight:o})},removeWhitespace:r=>{t=!0,this._pendingChanges.remove({id:r})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const r=new Set;for(const l of i)r.add(l.id);const s=new Map;for(const l of t)s.set(l.id,l);const o=l=>{let c=[];for(const h of l)if(!r.has(h.id)){if(s.has(h.id)){const u=s.get(h.id);h.afterLineNumber=u.newAfterLineNumber,h.height=u.newHeight}c.push(h)}return c},a=o(this._arr).concat(o(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=Ww.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,r=t.length;i<r;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const r=this._findWhitespaceIndex(e);if(r!==-1&&(this._arr[r].height!==i&&(this._arr[r].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,r-1)),this._arr[r].afterLineNumber!==t)){const s=this._arr[r];this._removeWhitespace(r),s.afterLineNumber=t,this._insertWhitespace(s)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,r=this._arr.length;i<r;i++){const s=this._arr[i].afterLineNumber;e<=s&&s<=t?this._arr[i].afterLineNumber=e-1:s>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,r=this._arr.length;i<r;i++){const s=this._arr[i].afterLineNumber;e<=s&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,r=t.length-1;for(;i<=r;){const o=(r-i|0)/2|0,a=i+o|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else r=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e){this._checkPendingChanges(),e=e|0;let t;e>1?t=this._lineHeight*(e-1):t=0;const i=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e);return t+i+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let r=1,s=t;for(;r<s;){const o=(r+s)/2|0,a=this.getVerticalOffsetForLineNumber(o)|0;if(e>=a+i)r=o+1;else{if(e>=a)return o;s=o}}return r>t?t:r}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,r=this.getLineNumberAtOrAfterVerticalOffset(e)|0,s=this.getVerticalOffsetForLineNumber(r)|0;let o=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(r)|0;const l=this.getWhitespacesCount()|0;let c,h;a===-1?(a=l,h=o+1,c=0):(h=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let u=s,d=u;const f=5e5;let g=0;s>=f&&(g=Math.floor(s/f)*f,g=Math.floor(g/i)*i,d-=g);const p=[],m=e+(t-e)/2;let b=-1;for(let S=r;S<=o;S++){if(b===-1){const k=u,C=u+i;(k<=m&&m<C||k>m)&&(b=S)}for(u+=i,p[S-r]=d,d+=i;h===S;)d+=c,u+=c,a++,a>=l?h=o+1:(h=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(u>=t){o=S;break}}b===-1&&(b=o);const _=this.getVerticalOffsetForLineNumber(o)|0;let w=r,y=o;return w<y&&s<e&&w++,w<y&&_+i>t&&y--,{bigNumbersDelta:g,startLineNumber:r,endLineNumber:o,relativeVerticalOffset:p,centeredLineNumber:b,completelyVisibleStartLineNumber:w,completelyVisibleEndLineNumber:y}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let r;return e>0?r=this.getWhitespacesAccumulatedHeight(e-1):r=0,i+r+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const r=this.getVerticalOffsetForWhitespaceIndex(i),s=this.getHeightForWhitespaceIndex(i);if(e>=r+s)return-1;for(;t<i;){const o=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(e>=a+l)t=o+1;else{if(e>=a)return o;i=o}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const r=this.getHeightForWhitespaceIndex(t),s=this.getIdForWhitespaceIndex(t),o=this.getAfterLineNumberForWhitespaceIndex(t);return{id:s,afterLineNumber:o,verticalOffset:i,height:r}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),r=this.getWhitespacesCount()-1;if(i<0)return[];let s=[];for(let o=i;o<=r;o++){const a=this.getVerticalOffsetForWhitespaceIndex(o),l=this.getHeightForWhitespaceIndex(o);if(a>=t)break;s.push({id:this.getIdForWhitespaceIndex(o),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(o),verticalOffset:a,height:l})}return s}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}}Ww.INSTANCE_COUNT=0;const aOe=125;class Eb{constructor(e,t,i,r){e=e|0,t=t|0,i=i|0,r=r|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),r<0&&(r=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=r,this.scrollHeight=Math.max(i,r)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class lOe extends re{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new H),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new Eb(0,0,0,0),this._scrollable=this._register(new IL(e,t)),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,r=t.contentHeight!==e.contentHeight;(i||r)&&this._onDidContentSizeChange.fire(new V5(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}}class cOe extends re{constructor(e,t,i){super(),this._configuration=e;const r=this._configuration.options,s=r.get(129),o=r.get(74);this._linesLayout=new Ww(t,r.get(58),o.top,o.bottom),this._scrollable=this._register(new lOe(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Eb(s.contentWidth,0,s.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(102)?aOe:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(58)&&this._linesLayout.setLineHeight(t.get(58)),e.hasChanged(74)){const i=t.get(74);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(129)){const i=t.get(129),r=i.contentWidth,s=i.height,o=this._scrollable.getScrollDimensions(),a=o.contentWidth;this._scrollable.setScrollDimensions(new Eb(r,o.contentWidth,s,this._getContentHeight(r,s,a)))}else this._updateHeight();e.hasChanged(102)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const r=this._configuration.options.get(91);return r.horizontal===2||e>=t?0:r.horizontalScrollbarSize}_getContentHeight(e,t,i){const r=this._configuration.options;let s=this._linesLayout.getLinesTotalHeight();return r.get(93)?s+=Math.max(0,t-r.get(58)-r.get(74).bottom):s+=this._getHorizontalScrollbarHeight(e,i),s}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,r=e.contentWidth;this._scrollable.setScrollDimensions(new Eb(t,e.contentWidth,i,this._getContentHeight(t,i,r)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new OW(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new OW(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(e){const t=this._configuration.options,i=t.get(130),r=t.get(43);if(i.isViewportWrapping){const s=t.get(129),o=t.get(64);return e>s.contentWidth+r.typicalHalfwidthCharacterWidth&&o.enabled&&o.side==="right"?e+s.verticalScrollbarWidth:e}else{const s=t.get(92)*r.typicalHalfwidthCharacterWidth,o=this._linesLayout.getWhitespaceMinWidth();return Math.max(e+s,o)}}setMaxLineWidth(e){const t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Eb(t.width,this._computeContentWidth(e),t.height,t.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition();let t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),r=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-r,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e){return this._linesLayout.getVerticalOffsetForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class hOe{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class uOe{constructor(e){this._counts=e,this._isValid=!1,this._validEndIndex=-1,this._modelToView=[],this._viewToModel=[]}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._counts.length;e<t;e++){const i=this._counts[e],r=e>0?this._modelToView[e-1]:0;this._modelToView[e]=r+i;for(let s=0;s<i;s++)this._viewToModel[r+s]=e}this._modelToView.length=this._counts.length,this._viewToModel.length=this._modelToView[this._modelToView.length-1],this._isValid=!0,this._validEndIndex=this._counts.length-1}}changeValue(e,t){this._counts[e]!==t&&(this._counts[e]=t,this._invalidate(e))}removeValues(e,t){this._counts.splice(e,t),this._invalidate(e)}insertValues(e,t){this._counts=Cw(this._counts,e,t),this._invalidate(e)}getTotalValue(){return this._ensureValid(),this._viewToModel.length}getAccumulatedValue(e){return this._ensureValid(),this._modelToView[e]}getIndexOf(e){this._ensureValid();const t=this._viewToModel[e],i=t>0?this._modelToView[t-1]:0;return new gJ(t,e-i)}}class dOe{constructor(e,t,i,r,s,o,a,l,c){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=r,this.fontInfo=s,this.tabSize=o,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this._constructLines(!0,null)}dispose(){this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,[])}createCoordinatesConverter(){return new hOe(this)}_constructLines(e,t){this.lines=[],e&&(this.hiddenAreasIds=[]);const i=this.model.getLinesContent(),r=this.model.getInjectedTextDecorations(this._editorId),s=i.length,o=this.createLineBreaksComputer(),a=new tv(Za.fromDecorations(r));for(let p=0;p<s;p++){const m=a.takeWhile(b=>b.lineNumber===p+1);o.addRequest(i[p],m,t?t[p]:null)}const l=o.finalize();let c=[],h=this.hiddenAreasIds.map(p=>this.model.getDecorationRange(p)).sort(V.compareRangesUsingStarts),u=1,d=0,f=-1,g=f+1<h.length?d+1:s+2;for(let p=0;p<s;p++){let m=p+1;m===g&&(f++,u=h[f].startLineNumber,d=h[f].endLineNumber,g=f+1<h.length?d+1:s+2);let b=m>=u&&m<=d,_=QT(l[p],!b);c[p]=_.getViewLineCount(),this.lines[p]=_}this._validModelVersionId=this.model.getVersionId(),this.prefixSumComputer=new uOe(c)}getHiddenAreas(){return this.hiddenAreasIds.map(e=>this.model.getDecorationRange(e))}_reduceRanges(e){if(e.length===0)return[];let t=e.map(o=>this.model.validateRange(o)).sort(V.compareRangesUsingStarts),i=[],r=t[0].startLineNumber,s=t[0].endLineNumber;for(let o=1,a=t.length;o<a;o++){let l=t[o];l.startLineNumber>s+1?(i.push(new V(r,1,s,1)),r=l.startLineNumber,s=l.endLineNumber):l.endLineNumber>s&&(s=l.endLineNumber)}return i.push(new V(r,1,s,1)),i}setHiddenAreas(e){let t=this._reduceRanges(e),i=this.hiddenAreasIds.map(u=>this.model.getDecorationRange(u)).sort(V.compareRangesUsingStarts);if(t.length===i.length){let u=!1;for(let d=0;d<t.length;d++)if(!t[d].equalsRange(i[d])){u=!0;break}if(!u)return!1}let r=[];for(const u of t)r.push({range:u,options:bt.EMPTY});this.hiddenAreasIds=this.model.deltaDecorations(this.hiddenAreasIds,r);let s=t,o=1,a=0,l=-1,c=l+1<s.length?a+1:this.lines.length+2,h=!1;for(let u=0;u<this.lines.length;u++){let d=u+1;d===c&&(l++,o=s[l].startLineNumber,a=s[l].endLineNumber,c=l+1<s.length?a+1:this.lines.length+2);let f=!1;if(d>=o&&d<=a?this.lines[u].isVisible()&&(this.lines[u]=this.lines[u].setVisible(!1),f=!0):(h=!0,this.lines[u].isVisible()||(this.lines[u]=this.lines[u].setVisible(!0),f=!0)),f){let g=this.lines[u].getViewLineCount();this.prefixSumComputer.changeValue(u,g)}}return h||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.lines.length?!1:this.lines[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.lines.length?1:this.lines[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,r){const s=this.fontInfo.equals(e),o=this.wrappingStrategy===t,a=this.wrappingColumn===i,l=this.wrappingIndent===r;if(s&&o&&a&&l)return!1;const c=s&&o&&!a&&l;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=r;let h=null;if(c){h=[];for(let u=0,d=this.lines.length;u<d;u++)h[u]=this.lines[u].getLineBreakData()}return this._constructLines(!1,h),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;let r=t===1?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,s=this.prefixSumComputer.getAccumulatedValue(i-1);return this.lines.splice(t-1,i-t+1),this.prefixSumComputer.removeValues(t-1,i-t+1),new CF(r,s)}onModelLinesInserted(e,t,i,r){if(!e||e<=this._validModelVersionId)return null;const s=t>2&&!this.lines[t-2].isVisible();let o=t===1?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,a=0,l=[],c=[];for(let h=0,u=r.length;h<u;h++){let d=QT(r[h],!s);l.push(d);let f=d.getViewLineCount();a+=f,c[h]=f}return this.lines=this.lines.slice(0,t-1).concat(l).concat(this.lines.slice(t-1)),this.prefixSumComputer.insertValues(t-1,c),new SF(o,o+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];let r=t-1,s=this.lines[r].getViewLineCount(),o=this.lines[r].isVisible(),a=QT(i,o);this.lines[r]=a;let l=this.lines[r].getViewLineCount(),c=!1,h=0,u=-1,d=0,f=-1,g=0,p=-1;s>l?(h=t===1?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,u=h+l-1,g=u+1,p=g+(s-l)-1,c=!0):s<l?(h=t===1?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,u=h+s-1,d=u+1,f=d+(l-s)-1,c=!0):(h=t===1?1:this.prefixSumComputer.getAccumulatedValue(t-2)+1,u=h+l-1),this.prefixSumComputer.changeValue(r,l);const m=h<=u?new ete(h,u):null,b=d<=f?new SF(d,f):null,_=g<=p?new CF(g,p):null;return[c,m,b,_]}acceptVersionId(e){this._validModelVersionId=e,this.lines.length===1&&!this.lines[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.prefixSumComputer.getTotalValue()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const r=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),o=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.getActiveIndentGuide(r.lineNumber,s.lineNumber,o.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return new J$(i+1,r)}getMinColumnOfViewLine(e){return this.lines[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.lines[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),r=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new G(e.modelLineNumber,r)}getModelEndPositionOfViewLine(e){const t=this.lines[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),r=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new G(e.modelLineNumber,r)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),r=this.getViewLineInfo(t),s=new Array;let o=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=r.modelLineNumber;l++){const c=this.lines[l-1];if(c.isVisible()){let h=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,u=l===r.modelLineNumber?r.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let d=h;d<u;d++)a.push(new J$(l,d))}if(!c.isVisible()&&o){const h=new G(l-1,this.model.getLineMaxColumn(l-1)+1),u=V.fromPositions(o,h);s.push(new ez(u,a)),a=[],o=null}else c.isVisible()&&!o&&(o=new G(l,1))}if(o){const l=V.fromPositions(o,this.getModelEndPositionOfViewLine(r));s.push(new ez(l,a))}return s}getViewLinesBracketGuides(e,t,i,r){const s=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,o=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.getLinesBracketGuides(l,a.modelRange.endLineNumber,s,r);for(const h of a.viewLines)if(h.isWrappedLineContinuation&&this.getMinColumnOfViewLine(h)===1)o.push([]);else{let u=c[h.modelLineNumber-l];u=u.map(d=>d.horizontalLine?new Xp(d.visibleColumn,d.className,new BM(d.horizontalLine.top,this.convertModelPositionToViewPosition(h.modelLineNumber,d.horizontalLine.endColumn).column)):d),o.push(u)}}return o}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),r=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let s=[],o=[],a=[];const l=i.lineNumber-1,c=r.lineNumber-1;let h=null;for(let g=l;g<=c;g++){const p=this.lines[g];if(p.isVisible()){let m=p.getViewLineNumberOfModelPosition(0,g===l?i.column:1),b=p.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),_=b-m+1,w=0;_>1&&p.getViewLineMinColumn(this.model,g+1,b)===1&&(w=m===0?1:2),o.push(_),a.push(w),h===null&&(h=new G(g+1,0))}else h!==null&&(s=s.concat(this.model.getLinesIndentGuides(h.lineNumber,g)),h=null)}h!==null&&(s=s.concat(this.model.getLinesIndentGuides(h.lineNumber,r.lineNumber)),h=null);const u=t-e+1;let d=new Array(u),f=0;for(let g=0,p=s.length;g<p;g++){let m=s[g],b=Math.min(u-f,o[g]),_=a[g],w;_===2?w=0:_===1?w=1:w=b;for(let y=0;y<b;y++)y===w&&(m=0),d[f++]=m}return d}getViewLineContent(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return this.lines[i].getViewLineContent(this.model,i+1,r)}getViewLineLength(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return this.lines[i].getViewLineLength(this.model,i+1,r)}getViewLineMinColumn(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return this.lines[i].getViewLineMinColumn(this.model,i+1,r)}getViewLineMaxColumn(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return this.lines[i].getViewLineMaxColumn(this.model,i+1,r)}getViewLineData(e){e=this._toValidViewLineNumber(e);let t=this.prefixSumComputer.getIndexOf(e-1),i=t.index,r=t.remainder;return this.lines[i].getViewLineData(this.model,i+1,r)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);let r=this.prefixSumComputer.getIndexOf(e-1),s=e,o=r.index,a=r.remainder,l=[];for(let c=o,h=this.model.getLineCount();c<h;c++){let u=this.lines[c];if(!u.isVisible())continue;let d=c===o?a:0,f=u.getViewLineCount()-d,g=!1;s+f>t&&(g=!0,f=t-s+1);let p=d+f;if(u.getViewLinesData(this.model,c+1,d,p,s-e,i,l),s+=f,g)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);let r=this.prefixSumComputer.getIndexOf(e-1),s=r.index,o=r.remainder,a=this.lines[s],l=a.getViewLineMinColumn(this.model,s+1,o),c=a.getViewLineMaxColumn(this.model,s+1,o);t<l&&(t=l),t>c&&(t=c);let h=a.getModelColumnOfViewPosition(o,t);return this.model.validatePosition(new G(s+1,h)).equals(i)?new G(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),r=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new V(i.lineNumber,i.column,r.lineNumber,r.column)}convertViewPositionToModelPosition(e,t){e=this._toValidViewLineNumber(e);let i=this.prefixSumComputer.getIndexOf(e-1),r=i.index,s=i.remainder,o=this.lines[r].getModelColumnOfViewPosition(s,t);return this.model.validatePosition(new G(r+1,o))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new V(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2){const r=this.model.validatePosition(new G(e,t)),s=r.lineNumber,o=r.column;let a=s-1,l=!1;for(;a>0&&!this.lines[a].isVisible();)a--,l=!0;if(a===0&&!this.lines[a].isVisible())return new G(1,1);const c=1+(a===0?0:this.prefixSumComputer.getAccumulatedValue(a-1));let h;return l?h=this.lines[a].getViewPositionOfModelPosition(c,this.model.getLineMaxColumn(a+1),i):h=this.lines[s-1].getViewPositionOfModelPosition(c,o,i),h}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return V.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),r=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new V(i.lineNumber,i.column,r.lineNumber,r.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.lines[i].isVisible()){const s=1+(i===0?0:this.prefixSumComputer.getAccumulatedValue(i-1));return this.lines[i].getViewLineNumberOfModelPosition(s,t)}for(;i>0&&!this.lines[i].isVisible();)i--;if(i===0&&!this.lines[i].isVisible())return 1;const r=1+(i===0?0:this.prefixSumComputer.getAccumulatedValue(i-1));return this.lines[i].getViewLineNumberOfModelPosition(r,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i){const r=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),s=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(s.lineNumber-r.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new V(r.lineNumber,1,s.lineNumber,s.column),t,i);let o=[];const a=r.lineNumber-1,l=s.lineNumber-1;let c=null;for(let f=a;f<=l;f++)if(this.lines[f].isVisible())c===null&&(c=new G(f+1,f===a?r.column:1));else if(c!==null){const p=this.model.getLineMaxColumn(f);o=o.concat(this.model.getDecorationsInRange(new V(c.lineNumber,c.column,f,p),t,i)),c=null}c!==null&&(o=o.concat(this.model.getDecorationsInRange(new V(c.lineNumber,c.column,s.lineNumber,s.column),t,i)),c=null),o.sort((f,g)=>{const p=V.compareRangesUsingStarts(f.range,g.range);return p===0?f.id<g.id?-1:f.id>g.id?1:0:p});let h=[],u=0,d=null;for(const f of o){const g=f.id;d!==g&&(d=g,h[u++]=f)}return h}getInjectedTextAt(e){const t=this._toValidViewLineNumber(e.lineNumber),i=this.prefixSumComputer.getIndexOf(t-1),r=i.index,s=i.remainder;return this.lines[r].getInjectedTextAt(s,e.column)}normalizePosition(e,t){const i=this._toValidViewLineNumber(e.lineNumber),r=this.prefixSumComputer.getIndexOf(i-1),s=r.index,o=r.remainder;return this.lines[s].normalizePosition(this.model,s+1,o,e,t)}getLineIndentColumn(e){const t=this._toValidViewLineNumber(e),i=this.prefixSumComputer.getIndexOf(t-1),r=i.index;return i.remainder===0?this.model.getLineIndentColumn(r+1):0}}class J${constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}}class ez{constructor(e,t){this.modelRange=e,this.viewLines=t}}class uD{constructor(){}isVisible(){return!0}setVisible(e){return e?this:dD.INSTANCE}getLineBreakData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){let r=e.getLineTokens(t),s=r.getLineContent();return new t5(s,!1,1,s.length+1,0,r.inflate(),null)}getViewLinesData(e,t,i,r,s,o,a){if(!o[s]){a[s]=null;return}a[s]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new G(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i,r,s){return r}getInjectedTextAt(e,t){return null}}uD.INSTANCE=new uD;class dD{constructor(){}isVisible(){return!1}setVisible(e){return e?uD.INSTANCE:this}getLineBreakData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,r,s,o,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i,r,s){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}}dD.INSTANCE=new dD;class fOe{constructor(e,t){this._lineBreakData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getLineBreakData(){return this._lineBreakData}getViewLineCount(){return this._isVisible?this._lineBreakData.breakOffsets.length:0}getInputStartOffsetOfOutputLineIndex(e){return this._lineBreakData.getInputOffsetOfOutputPosition(e,0)}getInputEndOffsetOfOutputLineIndex(e,t,i){return i+1===this._lineBreakData.breakOffsets.length?e.getLineMaxColumn(t)-1:this._lineBreakData.getInputOffsetOfOutputPosition(i+1,0)}getViewLineContent(e,t,i){if(!this._isVisible)throw new Error("Not supported");const r=i>0?this._lineBreakData.breakOffsets[i-1]:0,s=i<this._lineBreakData.breakOffsets.length?this._lineBreakData.breakOffsets[i]:this._lineBreakData.breakOffsets[this._lineBreakData.breakOffsets.length-1];let o;if(this._lineBreakData.injectionOffsets!==null){const a=this._lineBreakData.injectionOffsets.map((l,c)=>new Za(0,0,l+1,this._lineBreakData.injectionOptions[c],0));o=Za.applyInjectedText(e.getLineContent(t),a).substring(r,s)}else o=e.getValueInRange({startLineNumber:t,startColumn:r+1,endLineNumber:t,endColumn:s+1});return i>0&&(o=tz(this._lineBreakData.wrappedTextIndentLength)+o),o}getViewLineLength(e,t,i){if(!this._isVisible)throw new Error("Not supported");const r=i>0?this._lineBreakData.breakOffsets[i-1]:0;let o=(i<this._lineBreakData.breakOffsets.length?this._lineBreakData.breakOffsets[i]:this._lineBreakData.breakOffsets[this._lineBreakData.breakOffsets.length-1])-r;return i>0&&(o=this._lineBreakData.wrappedTextIndentLength+o),o}getViewLineMinColumn(e,t,i){if(!this._isVisible)throw new Error("Not supported");return this._getViewLineMinColumn(i)}_getViewLineMinColumn(e){return e>0?this._lineBreakData.wrappedTextIndentLength+1:1}getViewLineMaxColumn(e,t,i){if(!this._isVisible)throw new Error("Not supported");return this.getViewLineLength(e,t,i)+1}getViewLineData(e,t,i){if(!this._isVisible)throw new Error("Not supported");const r=this._lineBreakData,s=i>0?r.wrappedTextIndentLength:0,o=r.injectionOffsets,a=r.injectionOptions;let l,c,h;if(o){const p=e.getLineTokens(t).withInserted(o.map((w,y)=>({offset:w,text:a[y].content,tokenMetadata:In.defaultTokenMetadata}))),m=i>0?r.breakOffsets[i-1]:0,b=r.breakOffsets[i];l=p.getLineContent().substring(m,b),c=p.sliceAndInflate(m,b,s),h=new Array;let _=0;for(let w=0;w<o.length;w++){const y=a[w].content.length,S=o[w]+_,k=o[w]+_+y;if(S>b)break;if(m<k){const C=a[w];if(C.inlineClassName){const D=i>0?r.wrappedTextIndentLength:0,E=D+Math.max(S-m,0),N=D+Math.min(k-m,b);E!==N&&h.push(new DIe(E,N,C.inlineClassName,C.inlineClassNameAffectsLetterSpacing))}}_+=y}}else{const p=this.getInputStartOffsetOfOutputLineIndex(i),m=this.getInputEndOffsetOfOutputLineIndex(e,t,i),b=e.getLineTokens(t);l=e.getValueInRange({startLineNumber:t,startColumn:p+1,endLineNumber:t,endColumn:m+1}),c=b.sliceAndInflate(p,m,s),h=null}i>0&&(l=tz(r.wrappedTextIndentLength)+l);const u=i>0?r.wrappedTextIndentLength+1:1,d=l.length+1,f=i+1<this.getViewLineCount(),g=i===0?0:r.breakOffsetsVisibleColumn[i-1];return new t5(l,f,u,d,g,c,h)}getViewLinesData(e,t,i,r,s,o,a){if(!this._isVisible)throw new Error("Not supported");for(let l=i;l<r;l++){let c=s+l-i;if(!o[c]){a[c]=null;continue}a[c]=this.getViewLineData(e,t,l)}}getModelColumnOfViewPosition(e,t){if(!this._isVisible)throw new Error("Not supported");let i=t-1;return e>0&&(i<this._lineBreakData.wrappedTextIndentLength?i=0:i-=this._lineBreakData.wrappedTextIndentLength),this._lineBreakData.getInputOffsetOfOutputPosition(e,i)+1}getViewPositionOfModelPosition(e,t,i=2){if(!this._isVisible)throw new Error("Not supported");let r=this._lineBreakData.getOutputPositionOfInputOffset(t-1,i),s=r.outputLineIndex,o=r.outputOffset+1;return s>0&&(o+=this._lineBreakData.wrappedTextIndentLength),new G(e+s,o)}getViewLineNumberOfModelPosition(e,t){if(!this._isVisible)throw new Error("Not supported");const i=this._lineBreakData.getOutputPositionOfInputOffset(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i,r,s){if(this._lineBreakData.injectionOffsets!==null){const o=r.lineNumber-i,a=this._lineBreakData.outputPositionToOffsetInUnwrappedLine(i,r.column-1),l=this._lineBreakData.normalizeOffsetAroundInjections(a,s);if(l!==a)return this._lineBreakData.getOutputPositionOfOffsetInUnwrappedLine(l,s).toPosition(o,this._lineBreakData.wrappedTextIndentLength)}if(s===0){if(i>0&&r.column===this._getViewLineMinColumn(i))return new G(r.lineNumber-1,this.getViewLineMaxColumn(e,t,i-1))}else if(s===1){const o=this.getViewLineCount()-1;if(i<o&&r.column===this.getViewLineMaxColumn(e,t,i))return new G(r.lineNumber+1,this._getViewLineMinColumn(i+1))}return r}getInjectedTextAt(e,t){return this._lineBreakData.getInjectedText(e,t-1)}}let XT=[""];function tz(n){if(n>=XT.length)for(let e=1;e<=n;e++)XT[e]=gOe(e);return XT[n]}function gOe(n){return new Array(n+1).join(" ")}function QT(n,e){return n===null?e?uD.INSTANCE:dD.INSTANCE:new fOe(n,e)}class pOe{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}class mOe{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new pOe(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,r){return!1}createLineBreaksComputer(){let e=[];return{addRequest:(t,i,r)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new CF(t,i)}onModelLinesInserted(e,t,i,r){return new SF(t,i)}onModelLineChanged(e,t,i){return[!1,new ete(t,t),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1;let r=new Array(i);for(let s=0;s<i;s++)r[s]=0;return r}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){let t=this.model.getLineTokens(e),i=t.getLineContent();return new t5(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const r=this.model.getLineCount();e=Math.min(Math.max(1,e),r),t=Math.min(Math.max(1,t),r);let s=[];for(let o=e;o<=t;o++){let a=o-e;i[a]||(s[a]=null),s[a]=this.getViewLineData(o)}return s}getDecorationsInRange(e,t,i){return this.model.getDecorationsInRange(e,t,i)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class _Oe{constructor(e,t,i,r,s){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=r,this._coordinatesConverter=s,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const r=e.range,s=e.options;let o;if(s.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new G(r.startLineNumber,1),0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new G(r.endLineNumber,this.model.getLineMaxColumn(r.endLineNumber)),1);o=new V(a.lineNumber,a.column,l.lineNumber,l.column)}else o=this._coordinatesConverter.convertModelRangeToViewRange(r,1);i=new xJ(o,s),this._decorationsCache[t]=i}return i}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsViewportData(e),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}_getDecorationsViewportData(e){const t=this._linesCollection.getDecorationsInRange(e,this.editorId,C3(this.configuration.options)),i=e.startLineNumber,r=e.endLineNumber;let s=[],o=0,a=[];for(let l=i;l<=r;l++)a[l-i]=[];for(let l=0,c=t.length;l<c;l++){let h=t[l],u=h.options,d=this._getOrCreateViewModelDecoration(h),f=d.range;if(s[o++]=d,u.inlineClassName){let g=new nv(f,u.inlineClassName,u.inlineClassNameAffectsLetterSpacing?3:0),p=Math.max(i,f.startLineNumber),m=Math.min(r,f.endLineNumber);for(let b=p;b<=m;b++)a[b-i].push(g)}if(u.beforeContentClassName&&i<=f.startLineNumber&&f.startLineNumber<=r){let g=new nv(new V(f.startLineNumber,f.startColumn,f.startLineNumber,f.startColumn),u.beforeContentClassName,1);a[f.startLineNumber-i].push(g)}if(u.afterContentClassName&&i<=f.endLineNumber&&f.endLineNumber<=r){let g=new nv(new V(f.endLineNumber,f.endColumn,f.endLineNumber,f.endColumn),u.afterContentClassName,2);a[f.endLineNumber-i].push(g)}}return{decorations:s,inlineDecorations:a}}}const bOe={ModesRegistry:"editor.modesRegistry"};class vOe{constructor(){this._onDidChangeLanguages=new H,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[],this._dynamicLanguages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return[].concat(this._languages).concat(this._dynamicLanguages)}}const Ff=new vOe;Bn.add(bOe.ModesRegistry,Ff);const D0="plaintext",wOe=".txt";Ff.registerLanguage({id:D0,extensions:[wOe],aliases:[v("plainText.alias","Plain Text"),"text"],mimetypes:[Oo.text]});zi.register(D0,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0);class yOe extends re{constructor(e,t,i,r,s,o){if(super(),this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new JFe,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new Ro(this.model.getLanguageId(),this.model.getOptions(),this._configuration),this._tokenizeViewportSoon=this._register(new yi(()=>this.tokenizeViewport(),50)),this._updateConfigurationViewLineCount=this._register(new yi(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStartLine=-1,this._viewportStartLineTrackedRange=null,this._viewportStartLineDelta=0,this.model.isTooLargeForTokenization())this._lines=new mOe(this.model);else{const a=this._configuration.options,l=a.get(43),c=a.get(123),h=a.get(130),u=a.get(122);this._lines=new dOe(this._editorId,this.model,r,s,l,this.model.getOptions().tabSize,c,h.wrappingColumn,u)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new M_(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new cOe(this._configuration,this.getLineCount(),o)),this._register(this.viewLayout.onDidScroll(a=>{a.scrollTopChanged&&this._tokenizeViewportSoon.schedule(),this._eventDispatcher.emitSingleViewEvent(new KFe(a)),this._eventDispatcher.emitOutgoingEvent(new $5(a.oldScrollWidth,a.oldScrollLeft,a.oldScrollHeight,a.oldScrollTop,a.scrollWidth,a.scrollLeft,a.scrollHeight,a.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(a=>{this._eventDispatcher.emitOutgoingEvent(a)})),this._decorations=new _Oe(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(a=>{try{const l=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(l,a)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(yy.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new XFe)})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this.invalidateMinimapColorCache(),this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,null,1),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}tokenizeViewport(){const e=this.viewLayout.getLinesViewportData(),t=new V(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber)),i=this._toModelVisibleRanges(t);for(const r of i)this.model.tokenizeViewport(r.startLineNumber,r.endLineNumber)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new qFe(e)),this._eventDispatcher.emitOutgoingEvent(new W5(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new zFe)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new HFe)}onDidColorThemeChange(){this._eventDispatcher.emitSingleViewEvent(new ZFe)}_onConfigurationChanged(e,t){let i=null;if(this._viewportStartLine!==-1){let h=new G(this._viewportStartLine,this.getLineMinColumn(this._viewportStartLine));i=this.coordinatesConverter.convertViewPositionToModelPosition(h)}let r=!1;const s=this._configuration.options,o=s.get(43),a=s.get(123),l=s.get(130),c=s.get(122);if(this._lines.setWrappingSettings(o,a,l.wrappingColumn,c)&&(e.emitViewEvent(new NC),e.emitViewEvent(new RC),e.emitViewEvent(new Dp(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.getCurrentScrollTop()!==0&&(r=!0),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(80)&&(this._decorations.reset(),e.emitViewEvent(new Dp(null))),e.emitViewEvent(new UFe(t)),this.viewLayout.onConfigurationChanged(t),r&&i){const h=this.coordinatesConverter.convertModelPositionToViewPosition(i),u=this.viewLayout.getVerticalOffsetForLineNumber(h.lineNumber);this.viewLayout.setScrollPosition({scrollTop:u+this._viewportStartLineDelta},1)}Ro.shouldRecreate(t)&&(this.cursorConfig=new Ro(this.model.getLanguageId(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const t=this._eventDispatcher.beginEmitViewEvents();let i=!1,r=!1;const s=e.changes,o=e instanceof If?e.versionId:null,a=this._lines.createLineBreaksComputer();for(const h of s)switch(h.changeType){case 4:{for(let u=0;u<h.detail.length;u++){const d=h.detail[u];let f=h.injectedTexts[u];f&&(f=f.filter(g=>!g.ownerId||g.ownerId===this._editorId)),a.addRequest(d,f,null)}break}case 2:{let u=null;h.injectedText&&(u=h.injectedText.filter(d=>!d.ownerId||d.ownerId===this._editorId)),a.addRequest(h.detail,u,null);break}}const l=a.finalize();let c=0;for(const h of s)switch(h.changeType){case 1:{this._lines.onModelFlushed(),t.emitViewEvent(new NC),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),i=!0;break}case 3:{const u=this._lines.onModelLinesDeleted(o,h.fromLineNumber,h.toLineNumber);u!==null&&(t.emitViewEvent(u),this.viewLayout.onLinesDeleted(u.fromLineNumber,u.toLineNumber)),i=!0;break}case 4:{const u=l.slice(c,c+h.detail.length);c+=h.detail.length;const d=this._lines.onModelLinesInserted(o,h.fromLineNumber,h.toLineNumber,u);d!==null&&(t.emitViewEvent(d),this.viewLayout.onLinesInserted(d.fromLineNumber,d.toLineNumber)),i=!0;break}case 2:{const u=l[c];c++;const[d,f,g,p]=this._lines.onModelLineChanged(o,h.lineNumber,u);r=d,f&&t.emitViewEvent(f),g&&(t.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),p&&(t.emitViewEvent(p),this.viewLayout.onLinesDeleted(p.fromLineNumber,p.toLineNumber));break}case 5:break}o!==null&&this._lines.acceptVersionId(o),this.viewLayout.onHeightMaybeChanged(),!i&&r&&(t.emitViewEvent(new RC),t.emitViewEvent(new Dp(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}if(this._viewportStartLine=-1,this._configuration.setMaxLineNumber(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&this._viewportStartLineTrackedRange){const t=this.model._getTrackedRange(this._viewportStartLineTrackedRange);if(t){const i=this.coordinatesConverter.convertModelPositionToViewPosition(t.getStartPosition()),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber);this.viewLayout.setScrollPosition({scrollTop:r+this._viewportStartLineDelta},1)}}try{const t=this._eventDispatcher.beginEmitViewEvents();this._cursor.onModelContentChanged(t,e)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(this.model.onDidChangeTokens(e=>{let t=[];for(let i=0,r=e.ranges.length;i<r;i++){const s=e.ranges[i],o=this.coordinatesConverter.convertModelPositionToViewPosition(new G(s.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new G(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;t[i]={fromLineNumber:o,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new YFe(t)),e.tokenizationSupportChanged&&this._tokenizeViewportSoon.schedule()})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new GFe),this.cursorConfig=new Ro(this.model.getLanguageId(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new Ro(this.model.getLanguageId(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new NC),t.emitViewEvent(new RC),t.emitViewEvent(new Dp(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new Ro(this.model.getLanguageId(),this.model.getOptions(),this._configuration),this._cursor.updateConfiguration(this.cursorConfig)})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new Dp(e))}))}setHiddenAreas(e){let t=!1;try{const i=this._eventDispatcher.beginEmitViewEvents();t=this._lines.setHiddenAreas(e),t&&(i.emitViewEvent(new NC),i.emitViewEvent(new RC),i.emitViewEvent(new Dp(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),t&&this._eventDispatcher.emitOutgoingEvent(new Y$)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(129),t=this._configuration.options.get(58),i=Math.max(20,Math.round(e.height/t)),r=this.viewLayout.getLinesViewportData(),s=Math.max(1,r.completelyVisibleStartLineNumber-i),o=Math.min(this.getLineCount(),r.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new V(s,this.getLineMinColumn(s),o,this.getLineMaxColumn(o)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];let r=[],s=0,o=t.startLineNumber,a=t.startColumn,l=t.endLineNumber,c=t.endColumn;for(let h=0,u=i.length;h<u;h++){const d=i[h].startLineNumber,f=i[h].endLineNumber;f<o||d>l||(o<d&&(r[s++]=new V(o,a,d-1,this.model.getLineMaxColumn(d-1))),o=f+1,a=1)}return(o<l||o===l&&a<c)&&(r[s++]=new V(o,a,l,c)),r}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new V(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,r=t.completelyVisibleEndLineNumber;return new V(i,this.getLineMinColumn(i),r,this.getLineMaxColumn(r))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),r=this.coordinatesConverter.convertViewPositionToModelPosition(new G(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:r,firstPositionDeltaTop:s}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),r=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:r}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getTextModelOptions(){return this.model.getOptions()}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStartLine=e;let r=this.coordinatesConverter.convertViewPositionToModelPosition(new G(e,this.getLineMinColumn(e)));this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,new V(r.lineNumber,r.column,r.lineNumber,r.column),1);const s=this.viewLayout.getVerticalOffsetForLineNumber(e),o=this.viewLayout.getCurrentScrollTop();this._viewportStartLineDelta=o-s}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,r){return this._lines.getViewLinesBracketGuides(e,t,i,r)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=cs(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=_0(this.getLineContent(e));return t===-1?0:t+2}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewLineRenderingData(e,t){let i=this.model.mightContainRTL(),r=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),o=this._lines.getViewLineData(t),l=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return o.inlineDecorations&&(l=[...l,...o.inlineDecorations.map(c=>c.toInlineDecoration(t))]),new Ps(o.minColumn,o.maxColumn,o.content,o.continuesWithWrappedLine,i,r,o.tokens,l,s,o.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){let r=this._lines.getViewLinesData(e,t,i);return new EIe(this.getTabSize(),r)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,C3(this._configuration.options)),i=new COe;for(const r of t){const s=r.options,o=s.overviewRuler;if(!o)continue;const a=o.position;if(a===0)continue;const l=o.getColor(e),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.startLineNumber,r.range.startColumn),h=this.coordinatesConverter.getViewLineNumberOfModelPosition(r.range.endLineNumber,r.range.endColumn);i.accept(l,s.zIndex,c,h,a)}return i.asArray}invalidateOverviewRulerColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const i=t.options.overviewRuler;i&&i.invalidateCachedColor()}}invalidateMinimapColorCache(){const e=this.model.getAllDecorations();for(const t of e){const i=t.options.minimap;i&&i.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getModelLineMaxColumn(e){return this.model.getLineMaxColumn(e)}validateModelPosition(e){return this.model.validatePosition(e)}validateModelRange(e){return this.model.validateRange(e)}deduceModelPositionRelativeToViewPosition(e,t,i){const r=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(r)+t;return this.model.getPositionAt(o)}getEOL(){return this.model.getEOL()}getPlainTextToCopy(e,t,i){const r=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(V.compareRangesUsingStarts);let s=!1,o=!1;for(const l of e)l.isEmpty()?s=!0:o=!0;if(!o){if(!t)return"";const l=e.map(h=>h.startLineNumber);let c="";for(let h=0;h<l.length;h++)h>0&&l[h-1]===l[h]||(c+=this.model.getLineContent(l[h])+r);return c}if(s&&t){let l=[],c=0;for(const h of e){const u=h.startLineNumber;h.isEmpty()?u!==c&&l.push(this.model.getLineContent(u)):l.push(this.model.getValueInRange(h,i?2:0)),c=u}return l.length===1?l[0]:l}let a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===D0||e.length!==1)return null;let r=e[0];if(r.isEmpty()){if(!t)return null;const h=r.startLineNumber;r=new V(h,this.model.getLineMinColumn(h),h,this.model.getLineMaxColumn(h))}const s=this._configuration.options.get(43),o=this._getColorMap(),l=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===Sr.fontFamily;let c;return l?c=Sr.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${Sr.fontFamily}`),{mode:i,html:`<div style="color: ${o[1]};background-color: ${o[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(r,o)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=s;c++){const h=this.model.getLineTokens(c),u=h.getLineContent(),d=c===i?r-1:0,f=c===s?o-1:u.length;u===""?l+="<br>":l+=nOe(u,h.inflate(),t,d,f,a,Kn)}return l}_getColorMap(){let e=Fi.getColorMap(),t=["#000000"];if(e)for(let i=1,r=e.length;i<r;i++)t[i]=X.Format.CSS.formatHex(e[i]);return t}pushStackElement(){this.model.pushStackElement()}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){this._withViewEventsCollector(r=>this._cursor.setStates(r,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(r=>this._cursor.setSelections(r,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new tOe);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(r=>this._cursor.executeEdits(r,e,t,i))}startComposition(){this._cursor.setIsDoingComposition(!0),this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._cursor.setIsDoingComposition(!1),this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,r,s){this._executeCursorEdit(o=>this._cursor.compositionType(o,e,t,i,r,s))}paste(e,t,i,r){this._executeCursorEdit(s=>this._cursor.paste(s,e,t,i,r))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealPrimaryCursor(e,t){this._withViewEventsCollector(i=>this._cursor.revealPrimary(i,e,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new V(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(r=>r.emitViewEvent(new KS(e,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new V(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(r=>r.emitViewEvent(new KS(e,i,null,0,!0,0)))}revealRange(e,t,i,r,s){this._withViewEventsCollector(o=>o.emitViewEvent(new KS(e,i,null,r,t,s)))}getVerticalOffsetForLineNumber(e){return this.viewLayout.getVerticalOffsetForLineNumber(e)}getScrollTop(){return this.viewLayout.getCurrentScrollTop()}setScrollTop(e,t){this.viewLayout.setScrollPosition({scrollTop:e},t)}setScrollPosition(e,t){this.viewLayout.setScrollPosition(e,t)}deltaScrollNow(e,t){this.viewLayout.deltaScrollNow(e,t)}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new QFe),this._eventDispatcher.emitOutgoingEvent(new Y$))}setMaxLineWidth(e){this.viewLayout.setMaxLineWidth(e)}_withViewEventsCollector(e){try{const t=this._eventDispatcher.beginEmitViewEvents();e(t)}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}}class COe{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,r,s){const o=this._asMap[e];if(o){const a=o.data,l=a[a.length-3],c=a[a.length-1];if(l===s&&c+1>=i){r>c&&(a[a.length-1]=r);return}a.push(s,i,r)}else{const a=new EJ(e,t,[s,i,r]);this._asMap[e]=a,this.asArray.push(a)}}}class $w{constructor(...e){this._entries=new Map;for(let[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const ps=Dt("accessibilityService"),SOe=new Te("accessibilityModeEnabled",!1);class xOe extends v0{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let xF=[],EF=[];class z5{constructor(e,t){this.classifier=new xOe(e,t)}static create(e){return new z5(e.get(118),e.get(117))}createLineBreaksComputer(e,t,i,r){t=t|0,i=+i;const s=[],o=[],a=[];return{addRequest:(l,c,h)=>{s.push(l),o.push(c),a.push(h)},finalize:()=>{const l=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth;let c=[];for(let h=0,u=s.length;h<u;h++){const d=o[h],f=a[h];f&&!f.injectionOptions&&!d?c[h]=EOe(this.classifier,f,s[h],t,i,l,r):c[h]=DOe(this.classifier,s[h],d,t,i,l,r)}return xF.length=0,EF.length=0,c}}}}function EOe(n,e,t,i,r,s,o){if(r===-1)return null;const a=t.length;if(a<=1)return null;const l=e.breakOffsets,c=e.breakOffsetsVisibleColumn,h=nte(t,i,r,s,o),u=r-h;let d=xF,f=EF,g=0,p=0,m=0,b=r;const _=l.length;let w=0;if(w>=0){let y=Math.abs(c[w]-b);for(;w+1<_;){const S=Math.abs(c[w+1]-b);if(S>=y)break;y=S,w++}}for(;w<_;){let y=w<0?0:l[w],S=w<0?0:c[w];p>y&&(y=p,S=m);let k=0,C=0,D=0,E=0;if(S<=b){let T=S,j=y===0?0:t.charCodeAt(y-1),q=y===0?0:n.get(j),ie=!0;for(let ge=y;ge<a;ge++){const be=ge,Se=t.charCodeAt(ge);let Le,ke;if(Ln(Se)?(ge++,Le=0,ke=2):(Le=n.get(Se),ke=wv(Se,T,i,s)),be>p&&DF(j,q,Se,Le)&&(k=be,C=T),T+=ke,T>b){be>p?(D=be,E=T-ke):(D=ge+1,E=T),T-C>u&&(k=0),ie=!1;break}j=Se,q=Le}if(ie){g>0&&(d[g]=l[l.length-1],f[g]=c[l.length-1],g++);break}}if(k===0){let T=S,j=t.charCodeAt(y),q=n.get(j),ie=!1;for(let ge=y-1;ge>=p;ge--){const be=ge+1,Se=t.charCodeAt(ge);if(Se===9){ie=!0;break}let Le,ke;if(w_(Se)?(ge--,Le=0,ke=2):(Le=n.get(Se),ke=Ra(Se)?s:1),T<=b){if(D===0&&(D=be,E=T),T<=b-u)break;if(DF(Se,Le,j,q)){k=be,C=T;break}}T-=ke,j=Se,q=Le}if(k!==0){const ge=u-(E-C);if(ge<=i){const be=t.charCodeAt(D);let Se;Ln(be)?Se=2:Se=wv(be,E,i,s),ge-Se<0&&(k=0)}}if(ie){w--;continue}}if(k===0&&(k=D,C=E),k<=p){const T=t.charCodeAt(p);Ln(T)?(k=p+2,C=m+2):(k=p+1,C=m+wv(T,m,i,s))}for(p=k,d[g]=k,m=C,f[g]=C,g++,b=C+u;w<0||w<_&&c[w]<C;)w++;let N=Math.abs(c[w]-b);for(;w+1<_;){const T=Math.abs(c[w+1]-b);if(T>=N)break;N=T,w++}}return g===0?null:(d.length=g,f.length=g,xF=e.breakOffsets,EF=e.breakOffsetsVisibleColumn,e.breakOffsets=d,e.breakOffsetsVisibleColumn=f,e.wrappedTextIndentLength=h,e)}function DOe(n,e,t,i,r,s,o){const a=Za.applyInjectedText(e,t);let l,c;if(t&&t.length>0?(l=t.map(C=>C.options),c=t.map(C=>C.column-1)):(l=null,c=null),r===-1)return l?new iv([a.length],[],0,c,l):null;const h=a.length;if(h<=1)return l?new iv([a.length],[],0,c,l):null;const u=nte(a,i,r,s,o),d=r-u;let f=[],g=[],p=0,m=0,b=0,_=r,w=a.charCodeAt(0),y=n.get(w),S=wv(w,0,i,s),k=1;Ln(w)&&(S+=1,w=a.charCodeAt(1),y=n.get(w),k++);for(let C=k;C<h;C++){const D=C,E=a.charCodeAt(C);let N,T;Ln(E)?(C++,N=0,T=2):(N=n.get(E),T=wv(E,S,i,s)),DF(w,y,E,N)&&(m=D,b=S),S+=T,S>_&&((m===0||S-b>d)&&(m=D,b=S-T),f[p]=m,g[p]=b,p++,_=b+d,m=0),w=E,y=N}return p===0&&(!t||t.length===0)?null:(f[p]=h,g[p]=S,new iv(f,g,u,c,l))}function wv(n,e,t,i){return n===9?t-e%t:Ra(n)||n<32?i:1}function iz(n,e){return e-n%e}function DF(n,e,t,i){return t!==32&&(e===2||e===3&&i!==2||i===1||i===3&&e!==1)}function nte(n,e,t,i,r){let s=0;if(r!==0){const o=cs(n);if(o!==-1){for(let l=0;l<o;l++){const c=n.charCodeAt(l)===9?iz(s,e):1;s+=c}const a=r===3?2:r===2?1:0;for(let l=0;l<a;l++){const c=iz(s,e);s+=c}s+i>t&&(s=0)}}return s}var JT;const eA=(JT=window.trustedTypes)===null||JT===void 0?void 0:JT.createPolicy("domLineBreaksComputer",{createHTML:n=>n});class H5{static create(){return new H5}constructor(){}createLineBreaksComputer(e,t,i,r){t=t|0,i=+i;let s=[],o=[];return{addRequest:(a,l,c)=>{s.push(a),o.push(l)},finalize:()=>kOe(s,e,t,i,r,o)}}}function kOe(n,e,t,i,r,s){var o;function a(D){const E=s[D];if(E){const N=Za.applyInjectedText(n[D],E),T=E.map(q=>q.options),j=E.map(q=>q.column-1);return new iv([N.length],[],0,j,T)}else return null}if(i===-1){const D=[];for(let E=0,N=n.length;E<N;E++)D[E]=a(E);return D}const l=Math.round(i*e.typicalHalfwidthCharacterWidth),h=Math.round(t*(r===3?2:r===2?1:0)),u=Math.ceil(e.spaceWidth*h),d=document.createElement("div");Yn.applyFontInfoSlow(d,e);const f=og(1e4),g=[],p=[],m=[],b=[],_=[];for(let D=0;D<n.length;D++){const E=Za.applyInjectedText(n[D],s[D]);let N=0,T=0,j=l;if(r!==0)if(N=cs(E),N===-1)N=0;else{for(let be=0;be<N;be++){const Se=E.charCodeAt(be)===9?t-T%t:1;T+=Se}const ge=Math.ceil(e.spaceWidth*T);ge+e.typicalFullwidthCharacterWidth>l?(N=0,T=0):j=l-ge}const q=E.substr(N),ie=LOe(q,T,t,j,f,u);g[D]=N,p[D]=T,m[D]=q,b[D]=ie[0],_[D]=ie[1]}const w=f.build(),y=(o=eA==null?void 0:eA.createHTML(w))!==null&&o!==void 0?o:w;d.innerHTML=y,d.style.position="absolute",d.style.top="10000",d.style.wordWrap="break-word",document.body.appendChild(d);let S=document.createRange();const k=Array.prototype.slice.call(d.children,0);let C=[];for(let D=0;D<n.length;D++){const E=k[D],N=IOe(S,E,m[D],b[D]);if(N===null){C[D]=a(D);continue}const T=g[D],j=p[D]+h,q=_[D],ie=[];for(let Le=0,ke=N.length;Le<ke;Le++)ie[Le]=q[N[Le]];if(T!==0)for(let Le=0,ke=N.length;Le<ke;Le++)N[Le]+=T;let ge,be;const Se=s[D];Se?(ge=Se.map(Le=>Le.options),be=Se.map(Le=>Le.column-1)):(ge=null,be=null),C[D]=new iv(N,ie,j,be,ge)}return document.body.removeChild(d),C}function LOe(n,e,t,i,r,s){if(s!==0){let d=String(s);r.appendASCIIString('<div style="text-indent: -'),r.appendASCIIString(d),r.appendASCIIString("px; padding-left: "),r.appendASCIIString(d),r.appendASCIIString("px; box-sizing: border-box; width:")}else r.appendASCIIString('<div style="width:');r.appendASCIIString(String(i)),r.appendASCIIString('px;">');const o=n.length;let a=e,l=0,c=[],h=[],u=0<o?n.charCodeAt(0):0;r.appendASCIIString("<span>");for(let d=0;d<o;d++){d!==0&&d%16384===0&&r.appendASCIIString("</span><span>"),c[d]=l,h[d]=a;const f=u;u=d+1<o?n.charCodeAt(d+1):0;let g=1,p=1;switch(f){case 9:g=t-a%t,p=g;for(let m=1;m<=g;m++)m<g?r.write1(160):r.appendASCII(32);break;case 32:u===32?r.write1(160):r.appendASCII(32);break;case 60:r.appendASCIIString("&lt;");break;case 62:r.appendASCIIString("&gt;");break;case 38:r.appendASCIIString("&amp;");break;case 0:r.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:r.write1(65533);break;default:Ra(f)&&p++,f<32?r.write1(9216+f):r.write1(f)}l+=g,a+=p}return r.appendASCIIString("</span>"),c[n.length]=l,h[n.length]=a,r.appendASCIIString("</div>"),[c,h]}function IOe(n,e,t,i){if(t.length<=1)return null;const r=Array.prototype.slice.call(e.children,0),s=[];try{kF(n,r,i,0,null,t.length-1,null,s)}catch(o){return console.log(o),null}return s.length===0?null:(s.push(t.length),s)}function kF(n,e,t,i,r,s,o,a){if(i===s||(r=r||tA(n,e,t[i],t[i+1]),o=o||tA(n,e,t[s],t[s+1]),Math.abs(r[0].top-o[0].top)<=.1))return;if(i+1===s){a.push(s);return}const l=i+(s-i)/2|0,c=tA(n,e,t[l],t[l+1]);kF(n,e,t,i,r,l,c,a),kF(n,e,t,l,c,s,o,a)}function tA(n,e,t,i){return n.setStart(e[t/16384|0].firstChild,t%16384),n.setEnd(e[i/16384|0].firstChild,i%16384),n.getClientRects()}var TOe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Ed=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let AOe=0,NOe=class{constructor(e,t,i,r,s){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=r,this.listenersToRemove=s}dispose(){mt(this.listenersToRemove),this.model.onBeforeDetached(),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}},zw=class ZS extends re{constructor(e,t,i,r,s,o,a,l,c,h){super(),this._onDidDispose=this._register(new H),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new H),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new H),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new H),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new H),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new H),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeConfiguration=this._register(new H),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new H),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new H),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new H),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new H),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new H),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new nz),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new nz),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new H),this.onWillType=this._onWillType.event,this._onDidType=this._register(new H),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new H),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new H),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new H),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new H),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new H),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new H),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new H),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new H),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onContextMenu=this._register(new H),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new H),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new H),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new H),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new H),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new H),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new H),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new H),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new H),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new H),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event;const u=Object.assign({},t);this._domElement=e,this._overflowWidgetsDomNode=u.overflowWidgetsDomNode,delete u.overflowWidgetsDomNode,this._id=++AOe,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this.isSimpleWidget=i.isSimpleWidget||!1,this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(u,h)),this._register(this._configuration.onDidChange(f=>{this._onDidChangeConfiguration.fire(f);const g=this._configuration.options;if(f.hasChanged(129)){const p=g.get(129);this._onDidLayoutChange.fire(p)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=o,this._themeService=l,this._register(new ROe(this,this._contextKeyService)),this._register(new MOe(this,this._contextKeyService)),this._instantiationService=r.createChild(new $w([Xe,this._contextKeyService])),this._modelData=null,this._contributions={},this._actions={},this._focusTracker=new FOe(e),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={};let d;Array.isArray(i.contributions)?d=i.contributions:d=Tm.getEditorContributions();for(const f of d){if(this._contributions[f.id]){it(new Error(`Cannot have two contributions with the same id ${f.id}`));continue}try{const g=this._instantiationService.createInstance(f.ctor,this);this._contributions[f.id]=g}catch(g){it(g)}}Tm.getEditorActions().forEach(f=>{if(this._actions[f.id]){it(new Error(`Cannot have two actions with the same id ${f.id}`));return}const g=new tte(f.id,f.label,f.alias,hf(f.precondition),()=>this._instantiationService.invokeFunction(p=>Promise.resolve(f.runEditorCommand(p,this,null))),this._contextKeyService);this._actions[g.id]=g}),this._codeEditorService.addCodeEditor(this)}_createConfiguration(e,t){return new Yn(this.isSimpleWidget,e,this._domElement,t)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Xk.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose();const e=Object.keys(this._contributions);for(let t=0,i=e.length;t<i;t++){const r=e[t];this._contributions[r].dispose()}this._contributions={},this._actions={},this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e)}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?Ei.getWordAtPosition(this._modelData.model,this._configuration.options.get(115),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(this._modelData===null&&t===null||this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),r=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const s={oldModelUrl:r?r.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(s),this._postDetachModelCleanup(r)}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(let i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetForPosition(e,t,i){const r=e.model.validatePosition({lineNumber:t,column:i}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(r);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber)}getTopForLineNumber(e){return this._modelData?ZS._getVerticalOffsetForPosition(this._modelData,e,1):-1}getTopForPosition(e,t){return this._modelData?ZS._getVerticalOffsetForPosition(this._modelData,e,t):-1}setHiddenAreas(e){this._modelData&&this._modelData.viewModel.setHiddenAreas(e.map(t=>V.lift(t)))}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return Mt.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e){if(this._modelData){if(!G.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections("api",[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,r){if(!this._modelData)return;if(!V.isIRange(e))throw new Error("Invalid arguments");const s=this._modelData.model.validateRange(e),o=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,o,t,r)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new V(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,r){if(!G.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new V(e.lineNumber,e.column,e.lineNumber,e.column),t,i,r)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e){const t=je.isISelection(e),i=V.isIRange(e);if(!t&&!i)throw new Error("Invalid arguments");if(t)this._setSelectionImpl(e);else if(i){const r={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(r)}}_setSelectionImpl(e){if(!this._modelData)return;const t=new je(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections("api",[t])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,r){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new V(e,1,t,1),i,!1,r)}revealRange(e,t=0,i=!1,r=!0){this._revealRange(e,i?1:0,r,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,r){if(!V.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(V.lift(e),t,i,r)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let r=0,s=e.length;r<s;r++)if(!je.isISelection(e[r]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.setScrollPosition(e,t)}saveViewState(){if(!this._modelData)return null;const e={},t=Object.keys(this._contributions);for(const s of t){const o=this._contributions[s];typeof o.saveViewState=="function"&&(e[s]=o.saveViewState())}const i=this._modelData.viewModel.saveCursorState(),r=this._modelData.viewModel.saveState();return{cursorState:i,viewState:r,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]);const r=t.contributionsState||{},s=Object.keys(this._contributions);for(let a=0,l=s.length;a<l;a++){const c=s[a],h=this._contributions[c];typeof h.restoreViewState=="function"&&h.restoreViewState(r[c])}const o=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(o)}}getContribution(e){return this._contributions[e]||null}getActions(){const e=[],t=Object.keys(this._actions);for(let i=0,r=t.length;i<r;i++){const s=t[i];e.push(this._actions[s])}return e}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions[e]||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const s=i;this._type(e,s.text||"");return}case"replacePreviousChar":{const s=i;this._compositionType(e,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{const s=i;this._compositionType(e,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{const s=i;this._paste(e,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null);return}case"cut":this._cut(e);return}const r=this.getAction(t);if(r){Promise.resolve(r.run()).then(void 0,it);return}this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,r,s){this._modelData&&this._modelData.viewModel.compositionType(t,i,r,s,e)}_paste(e,t,i,r,s){if(!this._modelData||t.length===0)return;const o=this._modelData.viewModel.getSelection().getStartPosition();this._modelData.viewModel.paste(t,i,r,e);const a=this._modelData.viewModel.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({range:new V(o.lineNumber,o.column,a.lineNumber,a.column),languageId:s})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const r=Tm.getEditorCommand(t);return r?(i=i||{},i.source=e,this._instantiationService.invokeFunction(s=>{Promise.resolve(r.runEditorCommand(s,this,i)).then(void 0,it)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(80)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(80)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(80))return!1;let r;return i?Array.isArray(i)?r=()=>i:r=i:r=()=>null,this._modelData.viewModel.executeEdits(e,t,r),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,C3(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(129)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarMouseDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarMouseDown(e)}layout(e){this._configuration.observeReferenceElement(e),this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,r=i.get(129),s=ZS._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),o=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+r.glyphMarginWidth+r.lineNumbersWidth+r.decorationsWidth-this.getScrollLeft();return{top:s,left:o,height:i.get(58)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.view.render(!0,e)}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){Yn.applyFontInfoSlow(e,this._configuration.options.get(43))}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setMaxLineNumber(e.getLineCount()),e.onBeforeAttached();const i=new yOe(this._id,this._configuration,e,H5.create(),z5.create(this._configuration.options),o=>ic(o));t.push(e.onDidChangeDecorations(o=>this._onDidChangeModelDecorations.fire(o))),t.push(e.onDidChangeLanguage(o=>{this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(o)})),t.push(e.onDidChangeLanguageConfiguration(o=>this._onDidChangeModelLanguageConfiguration.fire(o))),t.push(e.onDidChangeContent(o=>this._onDidChangeModelContent.fire(o))),t.push(e.onDidChangeOptions(o=>this._onDidChangeModelOptions.fire(o))),t.push(e.onWillDispose(()=>this.setModel(null))),t.push(i.onEvent(o=>{switch(o.kind){case 0:this._onDidContentSizeChange.fire(o);break;case 1:this._editorTextFocus.setValue(o.hasFocus);break;case 2:this._onDidScrollChange.fire(o);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{o.reachedMaxCursorCount&&this._notificationService.warn(v("cursors.maximum","The number of cursors has been limited to {0}.",M_.MAX_CURSOR_COUNT));const a=[];for(let h=0,u=o.selections.length;h<u;h++)a[h]=o.selections[h].getPosition();const l={position:a[0],secondaryPositions:a.slice(1),reason:o.reason,source:o.source};this._onDidChangeCursorPosition.fire(l);const c={selection:o.selections[0],secondarySelections:o.selections.slice(1),modelVersionId:o.modelVersionId,oldSelections:o.oldSelections,oldModelVersionId:o.oldModelVersionId,source:o.source,reason:o.reason};this._onDidChangeCursorSelection.fire(c);break}}}));const[r,s]=this._createView(i);if(s){this._domElement.appendChild(r.domNode.domNode);let o=Object.keys(this._contentWidgets);for(let a=0,l=o.length;a<l;a++){const c=o[a];r.addContentWidget(this._contentWidgets[c])}o=Object.keys(this._overlayWidgets);for(let a=0,l=o.length;a<l;a++){const c=o[a];r.addOverlayWidget(this._overlayWidgets[c])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new NOe(e,i,r,s,t)}_createView(e){let t;this.isSimpleWidget?t={paste:(s,o,a,l)=>{this._paste("keyboard",s,o,a,l)},type:s=>{this._type("keyboard",s)},compositionType:(s,o,a,l)=>{this._compositionType("keyboard",s,o,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(s,o,a,l)=>{const c={text:s,pasteOnNewLine:o,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:s=>{const o={text:s};this._commandService.executeCommand("type",o)},compositionType:(s,o,a,l)=>{if(a||l){const c={text:s,replacePrevCharCnt:o,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:s,replaceCharCnt:o};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new LL(e.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new WFe(t,this._configuration,this._themeService,e,i,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(e){e&&e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}};zw=TOe([Ed(3,Kt),Ed(4,ui),Ed(5,An),Ed(6,Xe),Ed(7,fi),Ed(8,Qn),Ed(9,ps)],zw);class nz extends re{constructor(){super(),this._onDidChangeToTrue=this._register(new H),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new H),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class ROe extends re{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=Z.editorSimpleInput.bindTo(t),this._editorFocus=Z.focus.bindTo(t),this._textInputFocus=Z.textInputFocus.bindTo(t),this._editorTextFocus=Z.editorTextFocus.bindTo(t),this._editorTabMovesFocus=Z.tabMovesFocus.bindTo(t),this._editorReadonly=Z.readOnly.bindTo(t),this._inDiffEditor=Z.inDiffEditor.bindTo(t),this._editorColumnSelection=Z.columnSelection.bindTo(t),this._hasMultipleSelections=Z.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=Z.hasNonEmptySelection.bindTo(t),this._canUndo=Z.canUndo.bindTo(t),this._canRedo=Z.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(e.get(128)),this._editorReadonly.set(e.get(80)),this._inDiffEditor.set(e.get(53)),this._editorColumnSelection.set(e.get(18))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class MOe extends re{constructor(e,t){super(),this._editor=e,this._contextKeyService=t,this._langId=Z.languageId.bindTo(t),this._hasCompletionItemProvider=Z.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=Z.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=Z.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=Z.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=Z.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=Z.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=Z.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=Z.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=Z.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=Z.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=Z.hasReferenceProvider.bindTo(t),this._hasRenameProvider=Z.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=Z.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=Z.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=Z.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=Z.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=Z.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=Z.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=Z.isInWalkThroughSnippet.bindTo(t);const i=()=>this._update();this._register(e.onDidChangeModel(i)),this._register(e.onDidChangeModelLanguage(i)),this._register(Da.onDidChange(i)),this._register(Jl.onDidChange(i)),this._register(zM.onDidChange(i)),this._register(vw.onDidChange(i)),this._register(kE.onDidChange(i)),this._register(LE.onDidChange(i)),this._register(IE.onDidChange(i)),this._register(bw.onDidChange(i)),this._register(DE.onDidChange(i)),this._register($M.onDidChange(i)),this._register(EE.onDidChange(i)),this._register(VM.onDidChange(i)),this._register(Jb.onDidChange(i)),this._register(nu.onDidChange(i)),this._register(WM.onDidChange(i)),this._register(HM.onDidChange(i)),i()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(Da.has(e)),this._hasCodeActionsProvider.set(Jl.has(e)),this._hasCodeLensProvider.set(zM.has(e)),this._hasDefinitionProvider.set(vw.has(e)),this._hasDeclarationProvider.set(kE.has(e)),this._hasImplementationProvider.set(LE.has(e)),this._hasTypeDefinitionProvider.set(IE.has(e)),this._hasHoverProvider.set(bw.has(e)),this._hasDocumentHighlightProvider.set(DE.has(e)),this._hasDocumentSymbolProvider.set($M.has(e)),this._hasReferenceProvider.set(EE.has(e)),this._hasRenameProvider.set(VM.has(e)),this._hasSignatureHelpProvider.set(WM.has(e)),this._hasInlayHintsProvider.set(HM.has(e)),this._hasDocumentFormattingProvider.set(Jb.has(e)||nu.has(e)),this._hasDocumentSelectionFormattingProvider.set(nu.has(e)),this._hasMultipleDocumentFormattingProvider.set(Jb.all(e).length+nu.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(nu.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===ft.walkThroughSnippet)})}}class FOe extends re{constructor(e){super(),this._onChange=this._register(new H),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(v_(e)),this._register(this._domFocusTracker.onDidFocus(()=>{this._hasFocus=!0,this._onChange.fire(void 0)})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasFocus=!1,this._onChange.fire(void 0)}))}hasFocus(){return this._hasFocus}}const OOe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),POe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function iA(n){return OOe+encodeURIComponent(n.toString())+POe}const BOe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),VOe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function WOe(n){return BOe+encodeURIComponent(n.toString())+VOe}li((n,e)=>{const t=n.getColor(xee);t&&e.addRule(`.monaco-editor .squiggly-error { border-bottom: 4px double ${t}; }`);const i=n.getColor(mv);i&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${iA(i)}") repeat-x bottom left; }`);const r=n.getColor(lNe);r&&e.addRule(`.monaco-editor .squiggly-error::before { display: block; content: ''; width: 100%; height: 100%; background: ${r}; }`);const s=n.getColor(xL);s&&e.addRule(`.monaco-editor .squiggly-warning { border-bottom: 4px double ${s}; }`);const o=n.getColor(gh);o&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${iA(o)}") repeat-x bottom left; }`);const a=n.getColor(cNe);a&&e.addRule(`.monaco-editor .squiggly-warning::before { display: block; content: ''; width: 100%; height: 100%; background: ${a}; }`);const l=n.getColor(I5);l&&e.addRule(`.monaco-editor .squiggly-info { border-bottom: 4px double ${l}; }`);const c=n.getColor(Ba);c&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${iA(c)}") repeat-x bottom left; }`);const h=n.getColor(hNe);h&&e.addRule(`.monaco-editor .squiggly-info::before { display: block; content: ''; width: 100%; height: 100%; background: ${h}; }`);const u=n.getColor(dNe);u&&e.addRule(`.monaco-editor .squiggly-hint { border-bottom: 2px dotted ${u}; }`);const d=n.getColor(uNe);d&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${WOe(d)}") no-repeat bottom left; }`);const f=n.getColor($Re);f&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${f.rgba.a}; }`);const g=n.getColor(WRe);g&&e.addRule(`.monaco-editor.showUnused .squiggly-unnecessary { border-bottom: 2px dashed ${g}; }`);const p=n.getColor(ku)||"inherit";e.addRule(`.monaco-editor.showDeprecated .squiggly-inline-deprecated { text-decoration: line-through; text-decoration-color: ${p}}`)});class qt{constructor(e,t,i){const r=s=>this.emitter.fire(s);this.emitter=new H({onFirstListenerAdd:()=>e.addEventListener(t,r,i),onLastListenerRemove:()=>e.removeEventListener(t,r,i)})}get event(){return this.emitter.event}dispose(){this.emitter.dispose()}}function rz(n){return n.preventDefault(),n.stopPropagation(),n}var k0=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};let $Oe=!1;var fD;(function(n){n.North="north",n.South="south",n.East="east",n.West="west"})(fD||(fD={}));let zOe=4;const HOe=new H;let UOe=300;const jOe=new H;class U5{constructor(){this.disposables=new ve}get onPointerMove(){return this.disposables.add(new qt(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new qt(window,"mouseup")).event}dispose(){this.disposables.dispose()}}k0([an],U5.prototype,"onPointerMove",null);k0([an],U5.prototype,"onPointerUp",null);class j5{constructor(e){this.el=e,this.disposables=new ve}get onPointerMove(){return this.disposables.add(new qt(this.el,Qt.Change)).event}get onPointerUp(){return this.disposables.add(new qt(this.el,Qt.End)).event}dispose(){this.disposables.dispose()}}k0([an],j5.prototype,"onPointerMove",null);k0([an],j5.prototype,"onPointerUp",null);class gD{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}}k0([an],gD.prototype,"onPointerMove",null);k0([an],gD.prototype,"onPointerUp",null);class Hn extends re{constructor(e,t,i){super(),this.hoverDelay=UOe,this.hoverDelayer=this._register(new p0(this.hoverDelay)),this._state=3,this._onDidEnablementChange=this._register(new H),this.onDidEnablementChange=this._onDidEnablementChange.event,this._onDidStart=this._register(new H),this.onDidStart=this._onDidStart.event,this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._onDidReset=this._register(new H),this.onDidReset=this._onDidReset.event,this._onDidEnd=this._register(new H),this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.orthogonalStartSashDisposables=this._register(new ve),this.orthogonalStartDragHandleDisposables=this._register(new ve),this.orthogonalEndSashDisposables=this._register(new ve),this.orthogonalEndDragHandleDisposables=this._register(new ve),this.el=le(e,me(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),wt&&this.el.classList.add("mac");const r=this._register(new qt(this.el,"mousedown")).event;this._register(r(u=>this.onPointerStart(u,new U5),this));const s=this._register(new qt(this.el,"dblclick")).event;this._register(s(this.onPointerDoublePress,this));const o=this._register(new qt(this.el,"mouseenter")).event;this._register(o(()=>Hn.onMouseEnter(this)));const a=this._register(new qt(this.el,"mouseleave")).event;this._register(a(()=>Hn.onMouseLeave(this))),this._register(Rt.addTarget(this.el));const l=Re.map(this._register(new qt(this.el,Qt.Start)).event,u=>{var d;return Object.assign(Object.assign({},u),{target:(d=u.initialTarget)!==null&&d!==void 0?d:null})});this._register(l(u=>this.onPointerStart(u,new j5(this.el)),this));const c=this._register(new qt(this.el,Qt.Tap)).event,h=Re.map(Re.filter(Re.debounce(c,(u,d)=>{var f;return{event:d,count:((f=u==null?void 0:u.count)!==null&&f!==void 0?f:0)+1}},250),({count:u})=>u===2),({event:u})=>{var d;return Object.assign(Object.assign({},u),{target:(d=u.initialTarget)!==null&&d!==void 0?d:null})});this._register(h(this.onPointerDoublePress,this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=zOe,this._register(HOe.event(u=>{this.size=u,this.layout()}))),this._register(jOe.event(u=>this.hoverDelay=u)),this.hidden=!1,this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",$Oe),this.layout()}get state(){return this._state}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this._onDidEnablementChange.fire(e))}get orthogonalStartSash(){return this._orthogonalStartSash}set orthogonalStartSash(e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=le(this.el,me(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(Et(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new qt(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Hn.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new qt(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Hn.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange(t,this)),t(e.state)}this._orthogonalStartSash=e}get orthogonalEndSash(){return this._orthogonalEndSash}set orthogonalEndSash(e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=le(this.el,me(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(Et(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new qt(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Hn.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new qt(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Hn.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange(t,this)),t(e.state)}this._orthogonalEndSash=e}onPointerStart(e,t){Ft.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const g=this.getOrthogonalSash(e);g&&(i=!0,e.__orthogonalSashEvent=!0,g.onPointerStart(e,new gD(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new gD(t))),!this.state)return;const r=Ske("iframe");for(const g of r)g.style.pointerEvents="none";const s=e.pageX,o=e.pageY,a=e.altKey,l={startX:s,currentX:s,startY:o,currentY:o,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=ho(this.el),h=()=>{let g="";i?g="all-scroll":this.orientation===1?this.state===1?g="s-resize":this.state===2?g="n-resize":g=wt?"row-resize":"ns-resize":this.state===1?g="e-resize":this.state===2?g="w-resize":g=wt?"col-resize":"ew-resize",c.textContent=`* { cursor: ${g} !important; }`},u=new ve;h(),i||this.onDidEnablementChange(h,null,u);const d=g=>{Ft.stop(g,!1);const p={startX:s,currentX:g.pageX,startY:o,currentY:g.pageY,altKey:a};this._onDidChange.fire(p)},f=g=>{Ft.stop(g,!1),this.el.removeChild(c),this.el.classList.remove("active"),this._onDidEnd.fire(),u.dispose();for(const p of r)p.style.pointerEvents="auto"};t.onPointerMove(d,null,u),t.onPointerUp(f,null,u),u.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&Hn.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Hn.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Hn.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}hide(){this.hidden=!0,this.el.style.display="none",this.el.setAttribute("aria-hidden","true")}getOrthogonalSash(e){if(!(!e.target||!(e.target instanceof HTMLElement))&&e.target.classList.contains("orthogonal-drag-handle"))return e.target.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const q5=Dt("IEditorCancelService"),rte=new Te("cancellableOperation",!1,v("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));Wg(q5,class{constructor(){this._tokens=new WeakMap}add(n,e){let t=this._tokens.get(n);t||(t=n.invokeWithinContext(r=>{const s=rte.bindTo(r.get(Xe)),o=new As;return{key:s,tokens:o}}),this._tokens.set(n,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(n){const e=this._tokens.get(n);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},!0);class qOe extends rl{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(q5).add(e,this))}dispose(){this._unregister(),super.dispose()}}ye(new class extends mo{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:rte})}runEditorCommand(n,e){n.get(q5).cancel(e)}});let GOe=class LF{constructor(e,t){if(this.flags=t,this.flags&1){const i=e.getModel();this.modelVersionId=i?No("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;this.flags&4?this.position=e.getPosition():this.position=null,this.flags&2?this.selection=e.getSelection():this.selection=null,this.flags&8?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof LF))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new LF(e,this.flags))}};class KOe extends qOe{constructor(e,t,i,r){super(e,r),this._listener=new ve,t&4&&this._listener.add(e.onDidChangeCursorPosition(s=>{(!i||!V.containsPosition(i,s.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(s=>{(!i||!V.containsRange(i,s.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(s=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(s=>this.cancel())),this._listener.add(e.onDidChangeModelContent(s=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class ZOe extends rl{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}class F_{constructor(e,t,i){this._visiblePosition=e,this._visiblePositionScrollDelta=t,this._cursorPosition=i}static capture(e){let t=null,i=0;if(e.getScrollTop()!==0){const r=e.getVisibleRanges();if(r.length>0){t=r[0].getStartPosition();const s=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-s}}return new F_(t,i,e.getPosition())}restore(e){if(this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i)}}const ste={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Oo.text,TERMINALS:"Terminals"};class YOe{constructor(e){this.data=e}update(){}getData(){return this.data}}const Bc={CurrentDragAndDropData:void 0};class Of extends re{constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof ea&&this._register(t.onDidChange(r=>{this.element&&this.handleActionChangeEvent(r)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new D_)),this._actionRunner}set actionRunner(e){this._actionRunner=e}getAction(){return this._action}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Rt.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,$r&&this._register(ae(e,Me.DRAG_START,r=>{var s;return(s=r.dataTransfer)===null||s===void 0?void 0:s.setData(ste.TEXT,this._action.label)}))),this._register(ae(t,Qt.Tap,r=>this.onClick(r,!0))),this._register(ae(t,Me.MOUSE_DOWN,r=>{i||Ft.stop(r,!0),this._action.enabled&&r.button===0&&t.classList.add("active")})),wt&&this._register(ae(t,Me.CONTEXT_MENU,r=>{r.button===0&&r.ctrlKey===!0&&this.onClick(r)})),this._register(ae(t,Me.CLICK,r=>{Ft.stop(r,!0),this.options&&this.options.isMenu||this.onClick(r)})),this._register(ae(t,Me.DBLCLICK,r=>{Ft.stop(r,!0)})),[Me.MOUSE_UP,Me.MOUSE_OUT].forEach(r=>{this._register(ae(t,r,s=>{Ft.stop(s),t.classList.remove("active")}))})}onClick(e,t=!1){var i;Ft.stop(e,!0);const r=Xs(this._context)?!((i=this.options)===null||i===void 0)&&i.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,r)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}updateTooltip(){}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),super.dispose()}}class G5 extends Of{constructor(e,t,i={}){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),this.element&&(this.label=le(this.element,me("a.action-label"))),this.label&&(this._action.id===Fa.ID?this.label.setAttribute("role","presentation"):this.options.isMenu?this.label.setAttribute("role","menuitem"):this.label.setAttribute("role","button")),this.options.label&&this.options.keybinding&&this.element&&(le(this.element,me("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.getAction().label)}updateTooltip(){let e=null;this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=v({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e&&this.label&&(this.label.title=e)}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getAction().class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label&&this.label.classList.remove("codicon")}updateEnabled(){this.getAction().enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element&&this.element.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element&&this.element.classList.add("disabled"))}updateChecked(){this.label&&(this.getAction().checked?this.label.classList.add("checked"):this.label.classList.remove("checked"))}}var XOe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class xh extends re{constructor(e,t={}){var i,r,s,o,a,l;super(),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new H),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new H({onFirstListenerAdd:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new H),this.onDidRun=this._onDidRun.event,this._onBeforeRun=this._register(new H),this.onBeforeRun=this._onBeforeRun.event,this.options=t,this._context=(i=t.context)!==null&&i!==void 0?i:null,this._orientation=(r=this.options.orientation)!==null&&r!==void 0?r:0,this._triggerKeys={keyDown:(o=(s=this.options.triggerKeys)===null||s===void 0?void 0:s.keyDown)!==null&&o!==void 0?o:!1,keys:(l=(a=this.options.triggerKeys)===null||a===void 0?void 0:a.keys)!==null&&l!==void 0?l:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new D_,this._register(this._actionRunner)),this._register(this._actionRunner.onDidRun(u=>this._onDidRun.fire(u))),this._register(this._actionRunner.onBeforeRun(u=>this._onBeforeRun.fire(u))),this._actionIds=[],this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",t.animated!==!1&&this.domNode.classList.add("animated");let c,h;switch(this._orientation){case 0:c=[15],h=[17];break;case 1:c=[16],h=[18],this.domNode.className+=" vertical";break}this._register(ae(this.domNode,Me.KEY_DOWN,u=>{const d=new bi(u);let f=!0;const g=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;c&&(d.equals(c[0])||d.equals(c[1]))?f=this.focusPrevious():h&&(d.equals(h[0])||d.equals(h[1]))?f=this.focusNext():d.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():d.equals(14)?f=this.focusFirst():d.equals(13)?f=this.focusLast():d.equals(2)&&g instanceof Of&&g.trapsArrowNavigation?f=this.focusNext():this.isTriggerKeyEvent(d)?this._triggerKeys.keyDown?this.doTrigger(d):this.triggerKeyDown=!0:f=!1,f&&(d.preventDefault(),d.stopPropagation())})),this._register(ae(this.domNode,Me.KEY_UP,u=>{const d=new bi(u);this.isTriggerKeyEvent(d)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(d)),d.preventDefault(),d.stopPropagation()):(d.equals(2)||d.equals(1026))&&this.updateFocusedItem()})),this.focusTracker=this._register(v_(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(xm()===this.domNode||!Yl(xm(),this.domNode))&&(this._onDidBlur.fire(),this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(Yl(xm(),t)){this.focusedItem=e;break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){e&&(this._actionRunner=e,this.viewItems.forEach(t=>t.actionRunner=e))}getContainer(){return this.domNode}push(e,t={}){const i=Array.isArray(e)?e:[e];let r=sg(t.index)?t.index:null;i.forEach(s=>{const o=document.createElement("li");o.className="action-item",o.setAttribute("role","presentation"),this.options.allowContextMenu||this._register(ae(o,Me.CONTEXT_MENU,l=>{Ft.stop(l,!0)}));let a;this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(s)),a||(a=new G5(this.context,s,t)),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(o),this.focusable&&a instanceof Of&&this.viewItems.length===0&&a.setFocusable(!0),r===null||r<0||r>=this.actionsList.children.length?(this.actionsList.appendChild(o),this.viewItems.push(a),this._actionIds.push(s.id)):(this.actionsList.insertBefore(o,this.actionsList.children[r]),this.viewItems.splice(r,0,a),this._actionIds.splice(r,0,s.id),r++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem)}clear(){mt(this.viewItems),this.viewItems=[],this._actionIds=[],Gn(this.actionsList)}length(){return this.viewItems.length}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const r=this.viewItems.findIndex(s=>s.isEnabled());this.focusedItem=r===-1?void 0:r,this.updateFocus()}else i!==void 0&&(this.focusedItem=i),this.updateFocus()}focusFirst(){return this.focusedItem=this.length()>1?1:0,this.focusPrevious()}focusLast(){return this.focusedItem=this.length()<2?0:this.length()-2,this.focusNext()}focusNext(){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const e=this.focusedItem;let t;do{if(this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=e,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,t=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&this.options.focusOnlyEnabledItems&&!t.isEnabled());return this.updateFocus(),!0}focusPrevious(){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const e=this.focusedItem;let t;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(this.options.preventLoopNavigation)return this.focusedItem=e,!1;this.focusedItem=this.viewItems.length-1}t=this.viewItems[this.focusedItem]}while(this.focusedItem!==e&&this.options.focusOnlyEnabledItems&&!t.isEnabled());return this.updateFocus(!0),!0}updateFocus(e,t){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t});for(let i=0;i<this.viewItems.length;i++){const r=this.viewItems[i],s=r;if(i===this.focusedItem){let o=!0;Qb(s.focus)||(o=!1),this.options.focusOnlyEnabledItems&&Qb(r.isEnabled)&&!r.isEnabled()&&(o=!1),o?s.focus(e):this.actionsList.focus({preventScroll:t})}else Qb(s.blur)&&s.blur()}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof Of){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}run(e,t){return XOe(this,void 0,void 0,function*(){yield this._actionRunner.run(e,t)})}dispose(){mt(this.viewItems),this.viewItems=[],this._actionIds=[],this.getContainer().remove(),super.dispose()}}const QOe={IconContribution:"base.contributions.icons"};class JOe{constructor(){this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:v("iconDefintion.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:v("iconDefintion.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${ss.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,r){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return s}let o={id:e,description:i,defaults:t,deprecationMessage:r};this.iconsById[e]=o;let a={$ref:"#/definitions/icons"};return r&&(a.deprecationMessage=r),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;mi.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`};let i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const r=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of r.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${mi.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of r.filter(o=>!mi.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const gg=new JOe;Bn.add(QOe.IconContribution,gg);function ur(n,e,t,i){return gg.registerIcon(n,e,t,i)}function ePe(){return gg}function tPe(){for(const n of xE.all)gg.registerIcon(n.id,n.definition,n.description);xE.onDidRegister(n=>gg.registerIcon(n.id,n.definition,n.description))}tPe();const ote="vscode://schemas/icons";let ate=Bn.as(nL.JSONContribution);ate.registerSchema(ote,gg.getIconSchema());const sz=new yi(()=>ate.notifySchemaChanged(ote),200);gg.onDidChange(()=>{sz.isScheduled()||sz.schedule()});const iPe=ur("widget-close",Ce.close,v("widgetClose","Icon for the close action in widgets."));var nPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},rPe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},sPe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},nA;const MC=3;class tb{constructor(e,t,i,r){this.originalLineStart=e,this.originalLineEnd=t,this.modifiedLineStart=i,this.modifiedLineEnd=r}getType(){return this.originalLineStart===0?1:this.modifiedLineStart===0?2:0}}class rA{constructor(e){this.entries=e}}const oPe=ur("diff-review-insert",Ce.add,v("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),aPe=ur("diff-review-remove",Ce.remove,v("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),lPe=ur("diff-review-close",Ce.close,v("diffReviewCloseIcon","Icon for 'Close' in diff review."));let pD=class Od extends re{constructor(e,t){super(),this._modeService=t,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=xt(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=xt(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new xh(this.actionBarContainer.domNode)),this._actionBar.push(new ea("diffreview.close",v("label.close","Close"),"close-diff-review "+mi.asClassName(lPe),!0,()=>sPe(this,void 0,void 0,function*(){return this.hide()})),{label:!1,icon:!0}),this.domNode=xt(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=xt(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new TL(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff(()=>{this._isVisible&&(this._diffs=this._compute(),this._render())})),this._register(e.getModifiedEditor().onDidChangeCursorPosition(()=>{this._isVisible&&this._render()})),this._register(dn(this.domNode.domNode,"click",i=>{i.preventDefault();let r=EQ(i.target,"diff-review-row");r&&this._goToRow(r)})),this._register(dn(this.domNode.domNode,"keydown",i=>{(i.equals(18)||i.equals(2066)||i.equals(530))&&(i.preventDefault(),this._goToRow(this._getNextRow())),(i.equals(16)||i.equals(2064)||i.equals(528))&&(i.preventDefault(),this._goToRow(this._getPrevRow())),(i.equals(9)||i.equals(2057)||i.equals(521)||i.equals(1033))&&(i.preventDefault(),this.hide()),(i.equals(10)||i.equals(3))&&(i.preventDefault(),this.accept())})),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let r=0,s=this._diffs.length;r<s;r++)if(this._diffs[r]===this._currentDiff){i=r;break}e=this._diffs.length+i-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs.length===0)return;e=e%this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new G(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let r=0,s=this._diffs.length;r<s;r++)if(this._diffs[r]===this._currentDiff){i=r;break}e=i+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs.length===0)return;e=e%this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new G(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}accept(){let e=-1,t=this._getCurrentFocusedRow();if(t){let i=parseInt(t.getAttribute("data-line"),10);isNaN(i)||(e=i)}this.hide(),e!==-1&&(this._diffEditor.setPosition(new G(e,1)),this._diffEditor.revealPosition(new G(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){let e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){let e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){let e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e){let t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,t,i){this._width=t,this.shadow.setTop(e-6),this.shadow.setWidth(t),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(t),this.domNode.setHeight(i),this._content.setHeight(i),this._content.setWidth(t),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const e=this._diffEditor.getLineChanges();if(!e||e.length===0)return[];const t=this._diffEditor.getOriginalEditor().getModel(),i=this._diffEditor.getModifiedEditor().getModel();return!t||!i?[]:Od._mergeAdjacent(e,t.getLineCount(),i.getLineCount())}static _mergeAdjacent(e,t,i){if(!e||e.length===0)return[];let r=[],s=0;for(let c=0,h=e.length;c<h;c++){const u=e[c],d=u.originalStartLineNumber,f=u.originalEndLineNumber,g=u.modifiedStartLineNumber,p=u.modifiedEndLineNumber;let m=[],b=0;{const _=f===0?d:d-1,w=p===0?g:g-1;let y=1,S=1;if(c>0){const D=e[c-1];D.originalEndLineNumber===0?y=D.originalStartLineNumber+1:y=D.originalEndLineNumber+1,D.modifiedEndLineNumber===0?S=D.modifiedStartLineNumber+1:S=D.modifiedEndLineNumber+1}let k=_-MC+1,C=w-MC+1;if(k<y){const D=y-k;k=k+D,C=C+D}if(C<S){const D=S-C;k=k+D,C=C+D}m[b++]=new tb(k,_,C,w)}f!==0&&(m[b++]=new tb(d,f,0,0)),p!==0&&(m[b++]=new tb(0,0,g,p));{const _=f===0?d+1:f+1,w=p===0?g+1:p+1;let y=t,S=i;if(c+1<h){const D=e[c+1];D.originalEndLineNumber===0?y=D.originalStartLineNumber:y=D.originalStartLineNumber-1,D.modifiedEndLineNumber===0?S=D.modifiedStartLineNumber:S=D.modifiedStartLineNumber-1}let k=_+MC-1,C=w+MC-1;if(k>y){const D=y-k;k=k+D,C=C+D}if(C>S){const D=S-C;k=k+D,C=C+D}m[b++]=new tb(_,k,w,C)}r[s++]=new rA(m)}let o=r[0].entries,a=[],l=0;for(let c=1,h=r.length;c<h;c++){const u=r[c].entries,d=o[o.length-1],f=u[0];if(d.getType()===0&&f.getType()===0&&f.originalLineStart<=d.originalLineEnd){o[o.length-1]=new tb(d.originalLineStart,f.originalLineEnd,d.modifiedLineStart,f.modifiedLineEnd),o=o.concat(u.slice(1));continue}a[l++]=new rA(o),o=u}return a[l++]=new rA(o),a}_findDiffIndex(e){const t=e.lineNumber;for(let i=0,r=this._diffs.length;i<r;i++){const s=this._diffs[i].entries,o=s[s.length-1].modifiedLineEnd;if(t<=o)return i}return 0}_render(){const e=this._diffEditor.getOriginalEditor().getOptions(),t=this._diffEditor.getModifiedEditor().getOptions(),i=this._diffEditor.getOriginalEditor().getModel(),r=this._diffEditor.getModifiedEditor().getModel(),s=i.getOptions(),o=r.getOptions();if(!this._isVisible||!i||!r){Gn(this._content.domNode),this._currentDiff=null,this.scrollbar.scanDomNode();return}this._diffEditor.updateOptions({readOnly:!0});const a=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[a]===this._currentDiff)return;this._currentDiff=this._diffs[a];const l=this._diffs[a].entries;let c=document.createElement("div");c.className="diff-review-table",c.setAttribute("role","list"),c.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),Yn.applyFontInfoSlow(c,t.get(43));let h=0,u=0,d=0,f=0;for(let C=0,D=l.length;C<D;C++){const E=l[C],N=E.originalLineStart,T=E.originalLineEnd,j=E.modifiedLineStart,q=E.modifiedLineEnd;N!==0&&(h===0||N<h)&&(h=N),T!==0&&(u===0||T>u)&&(u=T),j!==0&&(d===0||j<d)&&(d=j),q!==0&&(f===0||q>f)&&(f=q)}let g=document.createElement("div");g.className="diff-review-row";let p=document.createElement("div");p.className="diff-review-cell diff-review-summary";const m=u-h+1,b=f-d+1;p.appendChild(document.createTextNode(`${a+1}/${this._diffs.length}: @@ -${h},${m} +${d},${b} @@`)),g.setAttribute("data-line",String(d));const _=C=>C===0?v("no_lines_changed","no lines changed"):C===1?v("one_line_changed","1 line changed"):v("more_lines_changed","{0} lines changed",C),w=_(m),y=_(b);g.setAttribute("aria-label",v({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",a+1,this._diffs.length,h,w,d,y)),g.appendChild(p),g.setAttribute("role","listitem"),c.appendChild(g);const S=t.get(58);let k=d;for(let C=0,D=l.length;C<D;C++){const E=l[C];Od._renderSection(c,E,k,S,this._width,e,i,s,t,r,o,this._modeService.languageIdCodec),E.modifiedLineStart!==0&&(k=E.modifiedLineEnd)}Gn(this._content.domNode),this._content.domNode.appendChild(c),this.scrollbar.scanDomNode()}static _renderSection(e,t,i,r,s,o,a,l,c,h,u,d){const f=t.getType();let g="diff-review-row",p="";const m="diff-review-spacer";let b=null;switch(f){case 1:g="diff-review-row line-insert",p=" char-insert",b=oPe;break;case 2:g="diff-review-row line-delete",p=" char-delete",b=aPe;break}const _=t.originalLineStart,w=t.originalLineEnd,y=t.modifiedLineStart,S=t.modifiedLineEnd,k=Math.max(S-y,w-_),C=o.get(129),D=C.glyphMarginWidth+C.lineNumbersWidth,E=c.get(129),N=10+E.glyphMarginWidth+E.lineNumbersWidth;for(let T=0;T<=k;T++){const j=_===0?0:_+T,q=y===0?0:y+T,ie=document.createElement("div");ie.style.minWidth=s+"px",ie.className=g,ie.setAttribute("role","listitem"),q!==0&&(i=q),ie.setAttribute("data-line",String(i));let ge=document.createElement("div");ge.className="diff-review-cell",ge.style.height=`${r}px`,ie.appendChild(ge);const be=document.createElement("span");be.style.width=D+"px",be.style.minWidth=D+"px",be.className="diff-review-line-number"+p,j!==0?be.appendChild(document.createTextNode(String(j))):be.innerText="",ge.appendChild(be);const Se=document.createElement("span");Se.style.width=N+"px",Se.style.minWidth=N+"px",Se.style.paddingRight="10px",Se.className="diff-review-line-number"+p,q!==0?Se.appendChild(document.createTextNode(String(q))):Se.innerText="",ge.appendChild(Se);const Le=document.createElement("span");if(Le.className=m,b){const Ge=document.createElement("span");Ge.className=mi.asClassName(b),Ge.innerText="",Le.appendChild(Ge)}else Le.innerText="";ge.appendChild(Le);let ke;if(q!==0){let Ge=this._renderLine(h,c,u.tabSize,q,d);Od._ttPolicy&&(Ge=Od._ttPolicy.createHTML(Ge)),ge.insertAdjacentHTML("beforeend",Ge),ke=h.getLineContent(q)}else{let Ge=this._renderLine(a,o,l.tabSize,j,d);Od._ttPolicy&&(Ge=Od._ttPolicy.createHTML(Ge)),ge.insertAdjacentHTML("beforeend",Ge),ke=a.getLineContent(j)}ke.length===0&&(ke=v("blankLine","blank"));let Lt="";switch(f){case 0:j===q?Lt=v({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",ke,j):Lt=v("equalLine","{0} original line {1} modified line {2}",ke,j,q);break;case 1:Lt=v("insertLine","+ {0} modified line {1}",ke,q);break;case 2:Lt=v("deleteLine","- {0} original line {1}",ke,j);break}ie.setAttribute("aria-label",Lt),e.appendChild(ie)}}static _renderLine(e,t,i,r,s){const o=e.getLineContent(r),a=t.get(43),l=In.createEmpty(o,s),c=Ps.isBasicASCII(o,e.mightContainNonBasicASCII()),h=Ps.containsRTL(o,c,e.mightContainRTL());return oL(new $g(a.isMonospace&&!t.get(29),a.canUseHalfwidthRightwardsArrow,o,!1,c,h,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(104),t.get(87),t.get(82),t.get(44)!==Cs.OFF,null)).html}};pD._ttPolicy=(nA=window.trustedTypes)===null||nA===void 0?void 0:nA.createPolicy("diffReview",{createHTML:n=>n});pD=nPe([rPe(1,Zr)],pD);li((n,e)=>{const t=n.getColor(Mee);t&&e.addRule(`.monaco-diff-editor .diff-review-line-number { color: ${t}; }`);const i=n.getColor(wy);i&&e.addRule(`.monaco-diff-editor .diff-review-shadow { box-shadow: ${i} 0 -6px 6px -6px inset; }`)});class cPe extends Si{constructor(){super({id:"editor.action.diffReview.next",label:v("editor.action.diffReview.next","Go to Next Difference"),alias:"Go to Next Difference",precondition:Ie.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(e,t){const i=lte(e);i&&i.diffReviewNext()}}class hPe extends Si{constructor(){super({id:"editor.action.diffReview.prev",label:v("editor.action.diffReview.prev","Go to Previous Difference"),alias:"Go to Previous Difference",precondition:Ie.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(e,t){const i=lte(e);i&&i.diffReviewPrev()}}function lte(n){const e=n.get(ui),t=e.listDiffEditors(),i=e.getActiveCodeEditor();if(!i)return null;for(let r=0,s=t.length;r<s;r++){const o=t[r];if(o.getModifiedEditor().getId()===i.getId()||o.getOriginalEditor().getId()===i.getId())return o}return null}pt(cPe);pt(hPe);const qg=Dt("contextViewService"),Gg=Dt("contextMenuService");var sA=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class uPe extends re{constructor(e,t,i,r,s,o){super(),this._viewZoneId=e,this._marginDomNode=t,this.editor=i,this.diff=r,this._contextMenuService=s,this._clipboardService=o,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Ce.lightBulb.classNames+" lightbulb-glyph",this._diffActions.style.position="absolute";const a=i.getOption(58),l=i.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${a}px`,this._diffActions.style.lineHeight=`${a}px`,this._marginDomNode.appendChild(this._diffActions);const c=[],h=r.modifiedEndLineNumber===0;c.push(new ea("diff.clipboard.copyDeletedContent",h?r.originalEndLineNumber>r.modifiedStartLineNumber?v("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):v("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):r.originalEndLineNumber>r.modifiedStartLineNumber?v("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):v("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,()=>sA(this,void 0,void 0,function*(){const p=new V(r.originalStartLineNumber,1,r.originalEndLineNumber+1,1),m=r.originalModel.getValueInRange(p);yield this._clipboardService.writeText(m)})));let u=0,d;r.originalEndLineNumber>r.modifiedStartLineNumber&&(d=new ea("diff.clipboard.copyDeletedLineContent",h?v("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",r.originalStartLineNumber):v("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",r.originalStartLineNumber),void 0,!0,()=>sA(this,void 0,void 0,function*(){const p=r.originalModel.getLineContent(r.originalStartLineNumber+u);if(p===""){const m=r.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(m===0?`
`:`\r
`)}else yield this._clipboardService.writeText(p)})),c.push(d)),i.getOption(80)||c.push(new ea("diff.inline.revertChange",v("diff.inline.revertChange.label","Revert this change"),void 0,!0,()=>sA(this,void 0,void 0,function*(){const p=new V(r.originalStartLineNumber,1,r.originalEndLineNumber,r.originalModel.getLineMaxColumn(r.originalEndLineNumber)),m=r.originalModel.getValueInRange(p);if(r.modifiedEndLineNumber===0){const b=i.getModel().getLineMaxColumn(r.modifiedStartLineNumber);i.executeEdits("diffEditor",[{range:new V(r.modifiedStartLineNumber,b,r.modifiedStartLineNumber,b),text:l+m}])}else{const b=i.getModel().getLineMaxColumn(r.modifiedEndLineNumber);i.executeEdits("diffEditor",[{range:new V(r.modifiedStartLineNumber,1,r.modifiedEndLineNumber,b),text:m}])}})));const g=(p,m)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x:p,y:m}),getActions:()=>(d&&(d.label=h?v("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",r.originalStartLineNumber+u):v("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",r.originalStartLineNumber+u)),c),autoSelectFirstItem:!0})};this._register(dn(this._diffActions,"mousedown",p=>{const{top:m,height:b}=jn(this._diffActions);let _=Math.floor(a/3);p.preventDefault(),g(p.posx,m+b+_)})),this._register(i.onMouseMove(p=>{p.target.type===8||p.target.type===5?p.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,u=this._updateLightBulbPosition(this._marginDomNode,p.event.browserEvent.y,a)):this.visibility=!1:this.visibility=!1})),this._register(i.onMouseDown(p=>{p.event.rightButton&&(p.target.type===8||p.target.type===5)&&p.target.detail.viewZoneId===this._viewZoneId&&(p.event.preventDefault(),u=this._updateLightBulbPosition(this._marginDomNode,p.event.browserEvent.y,a),g(p.event.posx,p.event.posy+a))}))}get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,e?this._diffActions.style.visibility="visible":this._diffActions.style.visibility="hidden")}_updateLightBulbPosition(e,t,i){const{top:r}=jn(e),s=t-r,o=Math.floor(s/i),a=o*i;if(this._diffActions.style.top=`${a}px`,this.diff.viewLineCounts){let l=0;for(let c=0;c<this.diff.viewLineCounts.length;c++)if(l+=this.diff.viewLineCounts[c],o<l)return c}return o}}const Kg=Dt("clipboardService");class NL{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}}NL.None=Object.freeze({report(){}});const L0=Dt("editorProgressService");var dPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Tc=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},oA;class oz{constructor(e,t){this._contextMenuService=e,this._clipboardService=t,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter(t=>!this._zonesMap[String(t.id)])}clean(e){this._zones.length>0&&e.changeViewZones(t=>{for(const i of this._zones)t.removeZone(i)}),this._zones=[],this._zonesMap={},this._decorations=e.deltaDecorations(this._decorations,[])}apply(e,t,i,r){const s=r?F_.capture(e):null;e.changeViewZones(o=>{var a;for(const l of this._zones)o.removeZone(l);for(const l of this._inlineDiffMargins)l.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let l=0,c=i.zones.length;l<c;l++){const h=i.zones[l];h.suppressMouseDown=!0;const u=o.addZone(h);this._zones.push(u),this._zonesMap[String(u)]=!0,i.zones[l].diff&&h.marginDomNode&&(h.suppressMouseDown=!1,((a=i.zones[l].diff)===null||a===void 0?void 0:a.originalModel.getValueLength())!==0&&this._inlineDiffMargins.push(new uPe(u,h.marginDomNode,e,i.zones[l].diff,this._contextMenuService,this._clipboardService)))}}),s&&s.restore(e),this._decorations=e.deltaDecorations(this._decorations,i.decorations),t&&t.setZones(i.overviewZones)}}let fPe=0;const gPe=ur("diff-insert",Ce.add,v("diffInsertIcon","Line decoration for inserts in the diff editor.")),cte=ur("diff-remove",Ce.remove,v("diffRemoveIcon","Line decoration for removals in the diff editor.")),az=(oA=window.trustedTypes)===null||oA===void 0?void 0:oA.createPolicy("diffEditorWidget",{createHTML:n=>n});let Xu=class Wn extends re{constructor(e,t,i,r,s,o,a,l,c,h,u,d){super(),this._editorProgressService=d,this._onDidDispose=this._register(new H),this.onDidDispose=this._onDidDispose.event,this._onDidUpdateDiff=this._register(new H),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new H),this._lastOriginalWarning=null,this._lastModifiedWarning=null,this._editorWorkerService=s,this._codeEditorService=l,this._contextKeyService=this._register(o.createScoped(e)),this._instantiationService=a.createChild(new $w([Xe,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=c,this._notificationService=h,this._id=++fPe,this._state=0,this._updatingDiffProgress=null,this._domElement=e,t=t||{},this._options=hz(t,{enableSplitViewResizing:!0,renderSideBySide:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit"}),typeof t.isInEmbeddedEditor<"u"?this._contextKeyService.createKey("isInEmbeddedDiffEditor",t.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._updateDecorationsRunner=this._register(new yi(()=>this._updateDecorations(),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=Wn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=xt(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(dn(this._overviewDomElement,"mousedown",g=>{this._modifiedEditor.delegateVerticalScrollbarMouseDown(g)})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new oz(u,r),this._modifiedEditorState=new oz(u,r),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new XJ(this._containerDomElement,t.dimension,()=>this._onDidContainerSizeChanged())),t.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(t,i.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(t,i.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=a.createInstance(pD,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new nh(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new cz(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(c.onDidColorThemeChange(g=>{this._strategy&&this._strategy.applyColors(g)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=Wn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)}));const f=Tm.getDiffEditorContributions();for(const g of f)try{this._register(a.createInstance(g.ctor,this))}catch(p){it(p)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),this._state===1&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(e,t){let i="monaco-diff-editor monaco-editor-background ";return t&&(i+="side-by-side "),i+=GE(e.type),i}_recreateOverviewRulers(){this._options.renderOverviewRuler&&(this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(e,t){const i=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(e),t);this._register(i.onDidScrollChange(s=>{this._isHandlingScrollEvent||!s.scrollTopChanged&&!s.scrollLeftChanged&&!s.scrollHeightChanged||(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())})),this._register(i.onDidChangeViewZones(()=>{this._onViewZonesChanged()})),this._register(i.onDidChangeConfiguration(s=>{i.getModel()&&(s.hasChanged(43)&&this._updateDecorationsRunner.schedule(),s.hasChanged(130)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))})),this._register(i.onDidChangeHiddenAreas(()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()})),this._register(i.onDidChangeModelContent(()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}));const r=this._contextKeyService.createKey("isInDiffLeftEditor",i.hasWidgetFocus());return this._register(i.onDidFocusEditorWidget(()=>r.set(!0))),this._register(i.onDidBlurEditorWidget(()=>r.set(!1))),this._register(i.onDidContentSizeChange(s=>{const o=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+Wn.ONE_OVERVIEW_WIDTH,a=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:a,contentWidth:o,contentHeightChanged:s.contentHeightChanged,contentWidthChanged:s.contentWidthChanged})})),i}_createRightHandSideEditor(e,t){const i=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(e),t);this._register(i.onDidScrollChange(s=>{this._isHandlingScrollEvent||!s.scrollTopChanged&&!s.scrollLeftChanged&&!s.scrollHeightChanged||(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())})),this._register(i.onDidChangeViewZones(()=>{this._onViewZonesChanged()})),this._register(i.onDidChangeConfiguration(s=>{i.getModel()&&(s.hasChanged(43)&&this._updateDecorationsRunner.schedule(),s.hasChanged(130)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))})),this._register(i.onDidChangeHiddenAreas(()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()})),this._register(i.onDidChangeModelContent(()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})),this._register(i.onDidChangeModelOptions(s=>{s.tabSize&&this._updateDecorationsRunner.schedule()}));const r=this._contextKeyService.createKey("isInDiffRightEditor",i.hasWidgetFocus());return this._register(i.onDidFocusEditorWidget(()=>r.set(!0))),this._register(i.onDidBlurEditorWidget(()=>r.set(!1))),this._register(i.onDidContentSizeChange(s=>{const o=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+Wn.ONE_OVERVIEW_WIDTH,a=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:a,contentWidth:o,contentHeightChanged:s.contentHeightChanged,contentWidthChanged:s.contentWidthChanged})})),i}_createInnerEditor(e,t,i,r){return e.createInstance(zw,t,i,r)}dispose(){this._codeEditorService.removeDiffEditor(this),this._beginUpdateDecorationsTimeout!==-1&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Xk.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(e){const t=hz(e,this._options),i=bPe(this._options,t);this._options=t;const r=i.ignoreTrimWhitespace||i.renderIndicators,s=this._isVisible&&(i.maxComputationTime||i.maxFileSize);r?this._beginUpdateDecorations():s&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(e)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(e)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing),i.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new nh(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new cz(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=Wn._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),i.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(e){if(e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._recreateOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport()}getDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e){this._modifiedEditor.setPosition(e)}revealLine(e,t=0){this._modifiedEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._modifiedEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._modifiedEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._modifiedEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._modifiedEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._modifiedEditor.revealPositionNearTop(e,t)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e){this._modifiedEditor.setSelection(e)}setSelections(e){this._modifiedEditor.setSelections(e)}revealLines(e,t,i=0){this._modifiedEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._modifiedEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._modifiedEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,r=!0){this._modifiedEditor.revealRange(e,t,i,r)}revealRangeInCenter(e,t=0){this._modifiedEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._modifiedEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._modifiedEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){const e=this._originalEditor.saveViewState(),t=this._modifiedEditor.saveViewState();return{original:e,modified:t}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._originalEditor.restoreViewState(t.original),this._modifiedEditor.restoreViewState(t.modified)}}layout(e){this._elementSizeObserver.observe(e)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(e,t,i){this._modifiedEditor.trigger(e,t,i)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler||!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const e=this._elementSizeObserver.getHeight(),t=this._getReviewHeight(),i=Wn.ENTIRE_DIFF_OVERVIEW_WIDTH-2*Wn.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:Wn.ONE_OVERVIEW_WIDTH,right:i+Wn.ONE_OVERVIEW_WIDTH,height:e-t}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:Wn.ONE_OVERVIEW_WIDTH,height:e-t}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){this._beginUpdateDecorationsTimeout!==-1&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout(()=>this._beginUpdateDecorations(),Wn.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,t){return!e&&!t?!0:!e||!t?!1:e.toString()===t.toString()}_beginUpdateDecorations(){this._beginUpdateDecorationsTimeout=-1;const e=this._originalEditor.getModel(),t=this._modifiedEditor.getModel();if(!e||!t)return;this._diffComputationToken++;const i=this._diffComputationToken,r=this._options.maxFileSize*1024*1024,s=o=>{const a=o.getValueLength();return r===0||a<=r};if(!s(e)||!s(t)){(!Wn._equals(e.uri,this._lastOriginalWarning)||!Wn._equals(t.uri,this._lastModifiedWarning))&&(this._lastOriginalWarning=e.uri,this._lastModifiedWarning=t.uri,this._notificationService.warn(v("diff.tooLarge","Cannot compare files because one file is too large.")));return}this._setState(1),this._editorWorkerService.computeDiff(e.uri,t.uri,this._options.ignoreTrimWhitespace,this._options.maxComputationTime).then(o=>{i===this._diffComputationToken&&e===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=o,this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())},o=>{i===this._diffComputationToken&&e===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())})}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],t=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),i=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),r=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,t,i);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,r.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,r.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const t=Object.assign({},e);return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens,t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,t}_adjustOptionsForLeftHandSide(e){const t=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?t.wordWrapOverride1=this._options.diffWordWrap:t.wordWrapOverride1="off",e.originalAriaLabel&&(t.ariaLabel=e.originalAriaLabel),t.readOnly=!this._options.originalEditable,t.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}_adjustOptionsForRightHandSide(e){const t=this._adjustOptionsForSubEditor(e);return e.modifiedAriaLabel&&(t.ariaLabel=e.modifiedAriaLabel),t.wordWrapOverride1=this._options.diffWordWrap,t.revealHorizontalRightPadding=Bg.revealHorizontalRightPadding.defaultValue+Wn.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const e=this._elementSizeObserver.getWidth(),t=this._elementSizeObserver.getHeight(),i=this._getReviewHeight(),r=this._strategy.layout();this._originalDomNode.style.width=r+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=e-r+"px",this._modifiedDomNode.style.left=r+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=t-i+"px",this._overviewDomElement.style.width=Wn.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=e-Wn.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(Wn.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:r,height:t-i}),this._modifiedEditor.layout({width:e-r-(this._options.renderOverviewRuler?Wn.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:t-i}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(t-i,e,i),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const t=this._modifiedEditor.getScrollTop(),i=this._modifiedEditor.getScrollHeight(),r=Math.max(0,e.height),s=Math.max(0,r-2*0),o=i>0?s/i:0,a=Math.max(0,Math.floor(e.height*o)),l=Math.floor(t*o);return{height:a,top:l}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){this._strategy&&this._strategy.dispose(),this._strategy=e,e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(e,t){const i=this._diffComputationResult?this._diffComputationResult.changes:[];if(i.length===0||e<t(i[0]))return null;let r=0,s=i.length-1;for(;r<s;){const o=Math.floor((r+s)/2),a=t(i[o]),l=o+1<=s?t(i[o+1]):1073741824;e<a?s=o-1:e>=l?r=o+1:(r=o,s=o)}return i[r]}_getEquivalentLineForOriginalLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,l=>l.originalStartLineNumber);if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),r=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),s=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,o=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,a=e-i;return a<=s?r+Math.min(a,o):r+o-s+a}_getEquivalentLineForModifiedLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,l=>l.modifiedStartLineNumber);if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),r=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),s=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,o=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,a=e-r;return a<=o?i+Math.min(a,s):i+s-o+a}getDiffLineInformationForOriginal(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(e)}:null}getDiffLineInformationForModified(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(e)}:null}};Xu.ONE_OVERVIEW_WIDTH=15;Xu.ENTIRE_DIFF_OVERVIEW_WIDTH=30;Xu.UPDATE_DIFF_DECORATIONS_DELAY=200;Xu=dPe([Tc(3,Kg),Tc(4,pd),Tc(5,Xe),Tc(6,Kt),Tc(7,ui),Tc(8,fi),Tc(9,Qn),Tc(10,Gg),Tc(11,L0)],Xu);class hte extends re{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const t=(e.getColor(Dee)||mF).transparent(2),i=(e.getColor(kee)||_F).transparent(2),r=!t.equals(this._insertColor)||!i.equals(this._removeColor);return this._insertColor=t,this._removeColor=i,r}getEditorsDiffDecorations(e,t,i,r,s){s=s.sort((c,h)=>c.afterLineNumber-h.afterLineNumber),r=r.sort((c,h)=>c.afterLineNumber-h.afterLineNumber);const o=this._getViewZones(e,r,s,i),a=this._getOriginalEditorDecorations(e,t,i),l=this._getModifiedEditorDecorations(e,t,i);return{original:{decorations:a.decorations,overviewZones:a.overviewZones,zones:o.original},modified:{decorations:l.decorations,overviewZones:l.overviewZones,zones:o.modified}}}}class lz{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class ff{constructor(e,t,i,r,s){this._lineChanges=e,this._originalForeignVZ=t,this._modifiedForeignVZ=i,this._originalEditor=r,this._modifiedEditor=s}static _getViewLineCount(e,t,i){const r=e.getModel(),s=e._getViewModel();if(r&&s){const o=Hw(r,s,t,i);return o.endLineNumber-o.startLineNumber+1}return i-t+1}getViewZones(){const e=this._originalEditor.getOption(58),t=this._modifiedEditor.getOption(58),i=this._originalEditor.getOption(130).wrappingColumn!==-1,r=this._modifiedEditor.getOption(130).wrappingColumn!==-1,s=i||r,o=this._originalEditor.getModel(),a=this._originalEditor._getViewModel().coordinatesConverter,l=this._modifiedEditor._getViewModel().coordinatesConverter,c={original:[],modified:[]};let h=0,u=0,d=0,f=0,g=0,p=0;const m=(k,C)=>k.afterLineNumber-C.afterLineNumber,b=(k,C)=>{if(C.domNode===null&&k.length>0){const D=k[k.length-1];if(D.afterLineNumber===C.afterLineNumber&&D.domNode===null){D.heightInLines+=C.heightInLines;return}}k.push(C)},_=new lz(this._modifiedForeignVZ),w=new lz(this._originalForeignVZ);let y=1,S=1;for(let k=0,C=this._lineChanges.length;k<=C;k++){const D=k<C?this._lineChanges[k]:null;D!==null?(d=D.originalStartLineNumber+(D.originalEndLineNumber>0?-1:0),f=D.modifiedStartLineNumber+(D.modifiedEndLineNumber>0?-1:0),u=D.originalEndLineNumber>0?ff._getViewLineCount(this._originalEditor,D.originalStartLineNumber,D.originalEndLineNumber):0,h=D.modifiedEndLineNumber>0?ff._getViewLineCount(this._modifiedEditor,D.modifiedStartLineNumber,D.modifiedEndLineNumber):0,g=Math.max(D.originalStartLineNumber,D.originalEndLineNumber),p=Math.max(D.modifiedStartLineNumber,D.modifiedEndLineNumber)):(d+=1e7+u,f+=1e7+h,g=d,p=f);let E=[],N=[];if(s){let q;D?D.originalEndLineNumber>0?q=D.originalStartLineNumber-y:q=D.modifiedStartLineNumber-S:q=o.getLineCount()-y;for(let ie=0;ie<q;ie++){const ge=y+ie,be=S+ie,Se=a.getModelLineViewLineCount(ge),Le=l.getModelLineViewLineCount(be);Se<Le?E.push({afterLineNumber:ge,heightInLines:Le-Se,domNode:null,marginDomNode:null}):Se>Le&&N.push({afterLineNumber:be,heightInLines:Se-Le,domNode:null,marginDomNode:null})}D&&(y=(D.originalEndLineNumber>0?D.originalEndLineNumber:D.originalStartLineNumber)+1,S=(D.modifiedEndLineNumber>0?D.modifiedEndLineNumber:D.modifiedStartLineNumber)+1)}for(;_.current&&_.current.afterLineNumber<=p;){let q;_.current.afterLineNumber<=f?q=d-f+_.current.afterLineNumber:q=g;let ie=null;D&&D.modifiedStartLineNumber<=_.current.afterLineNumber&&_.current.afterLineNumber<=D.modifiedEndLineNumber&&(ie=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),E.push({afterLineNumber:q,heightInLines:_.current.height/t,domNode:null,marginDomNode:ie}),_.advance()}for(;w.current&&w.current.afterLineNumber<=g;){let q;w.current.afterLineNumber<=d?q=f-d+w.current.afterLineNumber:q=p,N.push({afterLineNumber:q,heightInLines:w.current.height/e,domNode:null}),w.advance()}if(D!==null&&Pm(D)){const q=this._produceOriginalFromDiff(D,u,h);q&&E.push(q)}if(D!==null&&Bm(D)){const q=this._produceModifiedFromDiff(D,u,h);q&&N.push(q)}let T=0,j=0;for(E=E.sort(m),N=N.sort(m);T<E.length&&j<N.length;){const q=E[T],ie=N[j],ge=q.afterLineNumber-d,be=ie.afterLineNumber-f;ge<be?(b(c.original,q),T++):be<ge?(b(c.modified,ie),j++):q.shouldNotShrink?(b(c.original,q),T++):ie.shouldNotShrink?(b(c.modified,ie),j++):q.heightInLines>=ie.heightInLines?(q.heightInLines-=ie.heightInLines,j++):(ie.heightInLines-=q.heightInLines,T++)}for(;T<E.length;)b(c.original,E[T]),T++;for(;j<N.length;)b(c.modified,N[j]),j++}return{original:ff._ensureDomNodes(c.original),modified:ff._ensureDomNodes(c.modified)}}static _ensureDomNodes(e){return e.map(t=>(t.domNode||(t.domNode=ute()),t))}}function Zc(n,e,t,i,r){return{range:new V(n,e,t,i),options:r}}const Rr={charDelete:bt.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:bt.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:bt.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:bt.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:bt.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"line-insert",isWholeLine:!0}),lineInsertWithSign:bt.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+mi.asClassName(gPe),marginClassName:"line-insert",isWholeLine:!0}),lineDelete:bt.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"line-delete",isWholeLine:!0}),lineDeleteWithSign:bt.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+mi.asClassName(cte),marginClassName:"line-delete",isWholeLine:!0}),lineDeleteMargin:bt.register({description:"diff-editor-line-delete-margin",marginClassName:"line-delete"})};class nh extends hte{constructor(e,t){super(e),this._disableSash=t===!1,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new Hn(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart(()=>this._onSashDragStart()),this._sash.onDidChange(i=>this._onSashDrag(i)),this._sash.onDidEnd(()=>this._onSashDragEnd()),this._sash.onDidReset(()=>this._onSashReset())}setEnableSplitViewResizing(e){const t=e===!1;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio){const i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Xu.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let r=Math.floor((e||.5)*i);const s=Math.floor(.5*i);return r=this._disableSash?s:r||s,i>nh.MINIMUM_EDITOR_WIDTH*2?(r<nh.MINIMUM_EDITOR_WIDTH&&(r=nh.MINIMUM_EDITOR_WIDTH),r>i-nh.MINIMUM_EDITOR_WIDTH&&(r=i-nh.MINIMUM_EDITOR_WIDTH)):r=s,this._sashPosition!==r&&(this._sashPosition=r,this._sash.layout()),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?Xu.ENTIRE_DIFF_OVERVIEW_WIDTH:0),r=this.layout((this._startSashPosition+(e.currentX-e.startX))/i);this._sashRatio=r/i,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=.5,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}_getViewZones(e,t,i){const r=this._dataSource.getOriginalEditor(),s=this._dataSource.getModifiedEditor();return new pPe(e,t,i,r,s).getViewZones()}_getOriginalEditorDecorations(e,t,i){const r=this._dataSource.getOriginalEditor(),s=String(this._removeColor),o={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const c of e)if(Bm(c)){o.decorations.push({range:new V(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824),options:i?Rr.lineDeleteWithSign:Rr.lineDelete}),(!Pm(c)||!c.charChanges)&&o.decorations.push(Zc(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824,Rr.charDeleteWholeLine));const h=Hw(a,l,c.originalStartLineNumber,c.originalEndLineNumber);if(o.overviewZones.push(new Bw(h.startLineNumber,h.endLineNumber,s)),c.charChanges){for(const u of c.charChanges)if(Bm(u))if(t)for(let d=u.originalStartLineNumber;d<=u.originalEndLineNumber;d++){let f,g;d===u.originalStartLineNumber?f=u.originalStartColumn:f=a.getLineFirstNonWhitespaceColumn(d),d===u.originalEndLineNumber?g=u.originalEndColumn:g=a.getLineLastNonWhitespaceColumn(d),o.decorations.push(Zc(d,f,d,g,Rr.charDelete))}else o.decorations.push(Zc(u.originalStartLineNumber,u.originalStartColumn,u.originalEndLineNumber,u.originalEndColumn,Rr.charDelete))}}return o}_getModifiedEditorDecorations(e,t,i){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),o={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const c of e)if(Pm(c)){o.decorations.push({range:new V(c.modifiedStartLineNumber,1,c.modifiedEndLineNumber,1073741824),options:i?Rr.lineInsertWithSign:Rr.lineInsert}),(!Bm(c)||!c.charChanges)&&o.decorations.push(Zc(c.modifiedStartLineNumber,1,c.modifiedEndLineNumber,1073741824,Rr.charInsertWholeLine));const h=Hw(a,l,c.modifiedStartLineNumber,c.modifiedEndLineNumber);if(o.overviewZones.push(new Bw(h.startLineNumber,h.endLineNumber,s)),c.charChanges){for(const u of c.charChanges)if(Pm(u))if(t)for(let d=u.modifiedStartLineNumber;d<=u.modifiedEndLineNumber;d++){let f,g;d===u.modifiedStartLineNumber?f=u.modifiedStartColumn:f=a.getLineFirstNonWhitespaceColumn(d),d===u.modifiedEndLineNumber?g=u.modifiedEndColumn:g=a.getLineLastNonWhitespaceColumn(d),o.decorations.push(Zc(d,f,d,g,Rr.charInsert))}else o.decorations.push(Zc(u.modifiedStartLineNumber,u.modifiedStartColumn,u.modifiedEndLineNumber,u.modifiedEndColumn,Rr.charInsert))}}return o}}nh.MINIMUM_EDITOR_WIDTH=100;class pPe extends ff{constructor(e,t,i,r,s){super(e,t,i,r,s)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,t,i){return i>t?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i-t,domNode:null}:null}_produceModifiedFromDiff(e,t,i){return t>i?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:t-i,domNode:null}:null}}class cz extends hte{constructor(e,t){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange(i=>{this._decorationsLeft!==i.decorationsLeft&&(this._decorationsLeft=i.decorationsLeft,e.relayoutEditors())}))}setEnableSplitViewResizing(e){}_getViewZones(e,t,i,r){const s=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor();return new mPe(e,t,i,s,o,r).getViewZones()}_getOriginalEditorDecorations(e,t,i){const r=String(this._removeColor),s={decorations:[],overviewZones:[]},o=this._dataSource.getOriginalEditor(),a=o.getModel(),l=o._getViewModel();for(const c of e)if(Bm(c)){s.decorations.push({range:new V(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824),options:Rr.lineDeleteMargin});const h=Hw(a,l,c.originalStartLineNumber,c.originalEndLineNumber);s.overviewZones.push(new Bw(h.startLineNumber,h.endLineNumber,r))}return s}_getModifiedEditorDecorations(e,t,i){const r=this._dataSource.getModifiedEditor(),s=String(this._insertColor),o={decorations:[],overviewZones:[]},a=r.getModel(),l=r._getViewModel();for(const c of e)if(Pm(c)){o.decorations.push({range:new V(c.modifiedStartLineNumber,1,c.modifiedEndLineNumber,1073741824),options:i?Rr.lineInsertWithSign:Rr.lineInsert});const h=Hw(a,l,c.modifiedStartLineNumber,c.modifiedEndLineNumber);if(o.overviewZones.push(new Bw(h.startLineNumber,h.endLineNumber,s)),c.charChanges){for(const u of c.charChanges)if(Pm(u))if(t)for(let d=u.modifiedStartLineNumber;d<=u.modifiedEndLineNumber;d++){let f,g;d===u.modifiedStartLineNumber?f=u.modifiedStartColumn:f=a.getLineFirstNonWhitespaceColumn(d),d===u.modifiedEndLineNumber?g=u.modifiedEndColumn:g=a.getLineLastNonWhitespaceColumn(d),o.decorations.push(Zc(d,f,d,g,Rr.charInsert))}else o.decorations.push(Zc(u.modifiedStartLineNumber,u.modifiedStartColumn,u.modifiedEndLineNumber,u.modifiedEndColumn,Rr.charInsert))}else o.decorations.push(Zc(c.modifiedStartLineNumber,1,c.modifiedEndLineNumber,1073741824,Rr.charInsertWholeLine))}return o}layout(){return Math.max(5,this._decorationsLeft)}}class mPe extends ff{constructor(e,t,i,r,s,o){super(e,t,i,r,s),this._originalModel=r.getModel(),this._renderIndicators=o,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,t,i){const r=document.createElement("div");return r.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i,domNode:document.createElement("div"),marginDomNode:r}}_produceModifiedFromDiff(e,t,i){const r=document.createElement("div");r.className=`view-lines line-delete ${Mf}`;const s=document.createElement("div");s.className="inline-deleted-margin-view-zone";const o={shouldNotShrink:!0,afterLineNumber:e.modifiedEndLineNumber===0?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:t,minWidthInPx:0,domNode:r,marginDomNode:s,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let a=e.originalStartLineNumber;a<=e.originalEndLineNumber;a++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(a),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(o),o}_finalize(e){const t=this._modifiedEditor.getOptions(),i=this._modifiedEditor.getModel().getOptions().tabSize,r=t.get(43),s=t.get(29),o=r.typicalHalfwidthCharacterWidth,a=t.get(92),l=this._originalModel.mightContainNonBasicASCII(),c=this._originalModel.mightContainRTL(),h=t.get(58),d=t.get(129).decorationsWidth,f=t.get(104),g=t.get(87),p=t.get(82),m=t.get(44),b=this._lineBreaksComputer.finalize();let _=0;for(let w=0;w<this._pendingLineChange.length;w++){const y=this._pendingLineChange[w],S=this._pendingViewZones[w],k=S.domNode;Yn.applyFontInfoSlow(k,r);const C=S.marginDomNode;Yn.applyFontInfoSlow(C,r);const D=[];if(y.charChanges)for(const be of y.charChanges)Bm(be)&&D.push(new nv(new V(be.originalStartLineNumber,be.originalStartColumn,be.originalEndLineNumber,be.originalEndColumn),"char-delete",0));const E=D.length>0,N=og(1e4);let T=0,j=0,q=null;for(let be=y.originalStartLineNumber;be<=y.originalEndLineNumber;be++){const Se=be-y.originalStartLineNumber,Le=this._originalModel.getLineTokens(be),ke=Le.getLineContent(),Lt=b[_++],Ge=Ns.filter(D,be,1,ke.length+1);if(Lt){let Je=0;for(const ut of Lt.breakOffsets){const Ai=Le.sliceAndInflate(Je,ut,0),te=ke.substring(Je,ut);T=Math.max(T,this._renderOriginalLine(j++,te,Ai,Ns.extractWrapped(Ge,Je,ut),E,l,c,r,s,h,d,f,g,p,m,i,N,C)),Je=ut}for(q||(q=[]);q.length<Se;)q[q.length]=1;q[Se]=Lt.breakOffsets.length,S.heightInLines+=Lt.breakOffsets.length-1;const Ct=document.createElement("div");Ct.className="line-delete",e.original.push({afterLineNumber:be,afterColumn:0,heightInLines:Lt.breakOffsets.length-1,domNode:ute(),marginDomNode:Ct})}else T=Math.max(T,this._renderOriginalLine(j++,ke,Le,Ge,E,l,c,r,s,h,d,f,g,p,m,i,N,C))}T+=a;const ie=N.build(),ge=az?az.createHTML(ie):ie;if(k.innerHTML=ge,S.minWidthInPx=T*o,q){const be=y.originalEndLineNumber-y.originalStartLineNumber;for(;q.length<=be;)q[q.length]=1}S.diff.viewLineCounts=q}e.original.sort((w,y)=>w.afterLineNumber-y.afterLineNumber)}_renderOriginalLine(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p,m,b,_){b.appendASCIIString('<div class="view-line'),s||b.appendASCIIString(" char-delete"),b.appendASCIIString('" style="top:'),b.appendASCIIString(String(e*h)),b.appendASCIIString('px;width:1000000px;">');const w=Ps.isBasicASCII(t,o),y=Ps.containsRTL(t,w,a),S=sL(new $g(l.isMonospace&&!c,l.canUseHalfwidthRightwardsArrow,t,!1,w,y,0,i,r,m,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,d,f,g,p!==Cs.OFF,null),b);if(b.appendASCIIString("</div>"),this._renderIndicators){const k=document.createElement("div");k.className=`delete-sign ${mi.asClassName(cte)}`,k.setAttribute("style",`position:absolute;top:${e*h}px;width:${u}px;height:${h}px;right:0;`),_.appendChild(k)}return S.characterMapping.getAbsoluteOffset(S.characterMapping.length)}}function _Pe(n,e){return Fr(n,e,["off","on","inherit"])}function Pm(n){return n.modifiedEndLineNumber>0}function Bm(n){return n.originalEndLineNumber>0}function ute(){const n=document.createElement("div");return n.className="diagonal-fill",n}function Hw(n,e,t,i){const r=n.getLineCount();return t=Math.min(r,Math.max(1,t)),i=Math.min(r,Math.max(1,i)),e.coordinatesConverter.convertModelRangeToViewRange(new V(t,n.getLineMinColumn(t),i,n.getLineMaxColumn(i)))}function hz(n,e){return{enableSplitViewResizing:Pe(n.enableSplitViewResizing,e.enableSplitViewResizing),renderSideBySide:Pe(n.renderSideBySide,e.renderSideBySide),maxComputationTime:NR(n.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:NR(n.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:Pe(n.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:Pe(n.renderIndicators,e.renderIndicators),originalEditable:Pe(n.originalEditable,e.originalEditable),diffCodeLens:Pe(n.diffCodeLens,e.diffCodeLens),renderOverviewRuler:Pe(n.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:_Pe(n.diffWordWrap,e.diffWordWrap)}}function bPe(n,e){return{enableSplitViewResizing:n.enableSplitViewResizing!==e.enableSplitViewResizing,renderSideBySide:n.renderSideBySide!==e.renderSideBySide,maxComputationTime:n.maxComputationTime!==e.maxComputationTime,maxFileSize:n.maxFileSize!==e.maxFileSize,ignoreTrimWhitespace:n.ignoreTrimWhitespace!==e.ignoreTrimWhitespace,renderIndicators:n.renderIndicators!==e.renderIndicators,originalEditable:n.originalEditable!==e.originalEditable,diffCodeLens:n.diffCodeLens!==e.diffCodeLens,renderOverviewRuler:n.renderOverviewRuler!==e.renderOverviewRuler,diffWordWrap:n.diffWordWrap!==e.diffWordWrap}}li((n,e)=>{const t=n.getColor(Dee);t&&(e.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { background-color: ${t}; }`),e.addRule(`.monaco-diff-editor .line-insert, .monaco-diff-editor .char-insert { background-color: ${t}; }`),e.addRule(`.monaco-editor .inline-added-margin-view-zone { background-color: ${t}; }`));const i=n.getColor(kee);i&&(e.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { background-color: ${i}; }`),e.addRule(`.monaco-diff-editor .line-delete, .monaco-diff-editor .char-delete { background-color: ${i}; }`),e.addRule(`.monaco-editor .inline-deleted-margin-view-zone { background-color: ${i}; }`));const r=n.getColor(FNe);r&&e.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px ${n.type==="hc"?"dashed":"solid"} ${r}; }`);const s=n.getColor(ONe);s&&e.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px ${n.type==="hc"?"dashed":"solid"} ${s}; }`);const o=n.getColor(wy);o&&e.addRule(`.monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px ${o}; }`);const a=n.getColor(PNe);a&&e.addRule(`.monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid ${a}; }`);const l=n.getColor(fv);l&&e.addRule(`
			.monaco-diff-editor .diffViewport {
				background: ${l};
			}
		`);const c=n.getColor(gv);c&&e.addRule(`
			.monaco-diff-editor .diffViewport:hover {
				background: ${c};
			}
		`);const h=n.getColor(pv);h&&e.addRule(`
			.monaco-diff-editor .diffViewport:active {
				background: ${h};
			}
		`);const u=n.getColor(BNe);e.addRule(`
	.monaco-editor .diagonal-fill {
		background-image: linear-gradient(
			-45deg,
			${u} 12.5%,
			#0000 12.5%, #0000 50%,
			${u} 50%, ${u} 62.5%,
			#0000 62.5%, #0000 100%
		);
		background-size: 8px 8px;
	}
	`)});const Cy=Dt("themeService"),Yi=Dt("keybindingService");class vPe extends re{constructor(){super(),this._onCodeEditorAdd=this._register(new H),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new H),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onDiffEditorAdd=this._register(new H),this._onDiffEditorRemove=this._register(new H),this._onDecorationTypeRegistered=this._register(new H),this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null)}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}setModelProperty(e,t,i){const r=e.toString();let s;this._modelProperties.has(r)?s=this._modelProperties.get(r):(s=new Map,this._modelProperties.set(r,s)),s.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}}var wPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},yPe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class CPe{constructor(e,t,i){this._parent=e,this._editorId=t,this._styleSheet=i,this._refCount=0}ref(){this._refCount++}unref(){var e;this._refCount--,this._refCount===0&&((e=this._styleSheet.parentNode)===null||e===void 0||e.removeChild(this._styleSheet),this._parent._removeEditorStyleSheets(this._editorId))}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){vE(e,this._styleSheet)}}class SPe{constructor(e){this._styleSheet=e}ref(){}unref(){}insertRule(e,t){this._styleSheet.sheet.insertRule(e,t)}removeRulesContainingSelector(e){vE(e,this._styleSheet)}}let IF=class extends vPe{constructor(e,t){super(),this._decorationOptionProviders=new Map,this._editorStyleSheets=new Map,this._globalStyleSheet=e||null,this._themeService=t}_getOrCreateGlobalStyleSheet(){return this._globalStyleSheet||(this._globalStyleSheet=new SPe(ho())),this._globalStyleSheet}_getOrCreateStyleSheet(e){if(!e)return this._getOrCreateGlobalStyleSheet();const t=e.getContainerDomNode();if(!R3(t))return this._getOrCreateGlobalStyleSheet();const i=e.getId();if(!this._editorStyleSheets.has(i)){const r=new CPe(this,i,ho(t));this._editorStyleSheets.set(i,r)}return this._editorStyleSheets.get(i)}_removeEditorStyleSheets(e){this._editorStyleSheets.delete(e)}registerDecorationType(e,t,i,r,s){let o=this._decorationOptionProviders.get(t);if(!o){const a=this._getOrCreateStyleSheet(s),l={styleSheet:a,key:t,parentTypeKey:r,options:i||Object.create(null)};r?o=new xPe(this._themeService,a,l):o=new EPe(e,this._themeService,a,l),this._decorationOptionProviders.set(t,o),this._onDecorationTypeRegistered.fire(t)}o.refCount++}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorations(e))))}resolveDecorationOptions(e,t){const i=this._decorationOptionProviders.get(e);if(!i)throw new Error("Unknown decoration type key: "+e);return i.getOptions(this,t)}};IF=wPe([yPe(1,fi)],IF);class xPe{constructor(e,t,i){this._styleSheet=t,this._styleSheet.ref(),this._parentTypeKey=i.parentTypeKey,this.refCount=0,this._beforeContentRules=new mD(3,i,e),this._afterContentRules=new mD(4,i,e)}getOptions(e,t){const i=e.resolveDecorationOptions(this._parentTypeKey,!0);return this._beforeContentRules&&(i.beforeContentClassName=this._beforeContentRules.className),this._afterContentRules&&(i.afterContentClassName=this._afterContentRules.className),i}dispose(){this._beforeContentRules&&(this._beforeContentRules.dispose(),this._beforeContentRules=null),this._afterContentRules&&(this._afterContentRules.dispose(),this._afterContentRules=null),this._styleSheet.unref()}}class EPe{constructor(e,t,i,r){this._disposables=new ve,this.description=e,this._styleSheet=i,this._styleSheet.ref(),this.refCount=0;const s=u=>{const d=new mD(u,r,t);if(this._disposables.add(d),d.hasContent)return d.className},o=u=>{const d=new mD(u,r,t);return this._disposables.add(d),d.hasContent?{className:d.className,hasLetterSpacing:d.hasLetterSpacing}:null};this.className=s(0);const a=o(1);if(a&&(this.inlineClassName=a.className,this.inlineClassNameAffectsLetterSpacing=a.hasLetterSpacing),this.beforeContentClassName=s(3),this.afterContentClassName=s(4),r.options.beforeInjectedText&&r.options.beforeInjectedText.contentText){const u=o(5);this.beforeInjectedText={content:r.options.beforeInjectedText.contentText,inlineClassName:u==null?void 0:u.className,inlineClassNameAffectsLetterSpacing:(u==null?void 0:u.hasLetterSpacing)||r.options.beforeInjectedText.affectsLetterSpacing}}if(r.options.afterInjectedText&&r.options.afterInjectedText.contentText){const u=o(6);this.afterInjectedText={content:r.options.afterInjectedText.contentText,inlineClassName:u==null?void 0:u.className,inlineClassNameAffectsLetterSpacing:(u==null?void 0:u.hasLetterSpacing)||r.options.afterInjectedText.affectsLetterSpacing}}this.glyphMarginClassName=s(2);const l=r.options;this.isWholeLine=!!l.isWholeLine,this.stickiness=l.rangeBehavior;const c=l.light&&l.light.overviewRulerColor||l.overviewRulerColor,h=l.dark&&l.dark.overviewRulerColor||l.overviewRulerColor;(typeof c<"u"||typeof h<"u")&&(this.overviewRuler={color:c||h,darkColor:h||c,position:l.overviewRulerLane||rc.Center})}getOptions(e,t){return t?{description:this.description,inlineClassName:this.inlineClassName,beforeContentClassName:this.beforeContentClassName,afterContentClassName:this.afterContentClassName,className:this.className,glyphMarginClassName:this.glyphMarginClassName,isWholeLine:this.isWholeLine,overviewRuler:this.overviewRuler,stickiness:this.stickiness,before:this.beforeInjectedText,after:this.afterInjectedText}:this}dispose(){this._disposables.dispose(),this._styleSheet.unref()}}const ib={color:"color:{0} !important;",opacity:"opacity:{0};",backgroundColor:"background-color:{0};",outline:"outline:{0};",outlineColor:"outline-color:{0};",outlineStyle:"outline-style:{0};",outlineWidth:"outline-width:{0};",border:"border:{0};",borderColor:"border-color:{0};",borderRadius:"border-radius:{0};",borderSpacing:"border-spacing:{0};",borderStyle:"border-style:{0};",borderWidth:"border-width:{0};",fontStyle:"font-style:{0};",fontWeight:"font-weight:{0};",fontSize:"font-size:{0};",fontFamily:"font-family:{0};",textDecoration:"text-decoration:{0};",cursor:"cursor:{0};",letterSpacing:"letter-spacing:{0};",gutterIconPath:"background:{0} center center no-repeat;",gutterIconSize:"background-size:{0};",contentText:"content:'{0}';",contentIconPath:"content:{0};",margin:"margin:{0};",padding:"padding:{0};",width:"width:{0};",height:"height:{0};",verticalAlign:"vertical-align:{0};"};class mD{constructor(e,t,i){this._theme=i.getColorTheme(),this._ruleType=e,this._providerArgs=t,this._usesThemeColors=!1,this._hasContent=!1,this._hasLetterSpacing=!1;let r=aA.getClassName(this._providerArgs.key,e);this._providerArgs.parentTypeKey&&(r=r+" "+aA.getClassName(this._providerArgs.parentTypeKey,e)),this._className=r,this._unThemedSelector=aA.getSelector(this._providerArgs.key,this._providerArgs.parentTypeKey,e),this._buildCSS(),this._usesThemeColors?this._themeListener=i.onDidColorThemeChange(s=>{this._theme=i.getColorTheme(),this._removeCSS(),this._buildCSS()}):this._themeListener=null}dispose(){this._hasContent&&(this._removeCSS(),this._hasContent=!1),this._themeListener&&(this._themeListener.dispose(),this._themeListener=null)}get hasContent(){return this._hasContent}get hasLetterSpacing(){return this._hasLetterSpacing}get className(){return this._className}_buildCSS(){const e=this._providerArgs.options;let t,i,r;switch(this._ruleType){case 0:t=this.getCSSTextForModelDecorationClassName(e),i=this.getCSSTextForModelDecorationClassName(e.light),r=this.getCSSTextForModelDecorationClassName(e.dark);break;case 1:t=this.getCSSTextForModelDecorationInlineClassName(e),i=this.getCSSTextForModelDecorationInlineClassName(e.light),r=this.getCSSTextForModelDecorationInlineClassName(e.dark);break;case 2:t=this.getCSSTextForModelDecorationGlyphMarginClassName(e),i=this.getCSSTextForModelDecorationGlyphMarginClassName(e.light),r=this.getCSSTextForModelDecorationGlyphMarginClassName(e.dark);break;case 3:t=this.getCSSTextForModelDecorationContentClassName(e.before),i=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.before),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.before);break;case 4:t=this.getCSSTextForModelDecorationContentClassName(e.after),i=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.after),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.after);break;case 5:t=this.getCSSTextForModelDecorationContentClassName(e.beforeInjectedText),i=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.beforeInjectedText),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.beforeInjectedText);break;case 6:t=this.getCSSTextForModelDecorationContentClassName(e.afterInjectedText),i=this.getCSSTextForModelDecorationContentClassName(e.light&&e.light.afterInjectedText),r=this.getCSSTextForModelDecorationContentClassName(e.dark&&e.dark.afterInjectedText);break;default:throw new Error("Unknown rule type: "+this._ruleType)}const s=this._providerArgs.styleSheet;let o=!1;t.length>0&&(s.insertRule(`${this._unThemedSelector} {${t}}`,0),o=!0),i.length>0&&(s.insertRule(`.vs${this._unThemedSelector} {${i}}`,0),o=!0),r.length>0&&(s.insertRule(`.vs-dark${this._unThemedSelector}, .hc-black${this._unThemedSelector} {${r}}`,0),o=!0),this._hasContent=o}_removeCSS(){this._providerArgs.styleSheet.removeRulesContainingSelector(this._unThemedSelector)}getCSSTextForModelDecorationClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["backgroundColor"],t),this.collectCSSText(e,["outline","outlineColor","outlineStyle","outlineWidth"],t),this.collectBorderSettingsCSSText(e,t),t.join("")}getCSSTextForModelDecorationInlineClassName(e){if(!e)return"";const t=[];return this.collectCSSText(e,["fontStyle","fontWeight","textDecoration","cursor","color","opacity","letterSpacing"],t),e.letterSpacing&&(this._hasLetterSpacing=!0),t.join("")}getCSSTextForModelDecorationContentClassName(e){if(!e)return"";const t=[];if(typeof e<"u"){if(this.collectBorderSettingsCSSText(e,t),typeof e.contentIconPath<"u"&&t.push(No(ib.contentIconPath,Ch(qe.revive(e.contentIconPath)))),typeof e.contentText=="string"){const r=e.contentText.match(/^.*$/m)[0].replace(/['\\]/g,"\\$&");t.push(No(ib.contentText,r))}this.collectCSSText(e,["verticalAlign","fontStyle","fontWeight","fontSize","fontFamily","textDecoration","color","opacity","backgroundColor","margin","padding"],t),this.collectCSSText(e,["width","height"],t)&&t.push("display:inline-block;")}return t.join("")}getCSSTextForModelDecorationGlyphMarginClassName(e){if(!e)return"";const t=[];return typeof e.gutterIconPath<"u"&&(t.push(No(ib.gutterIconPath,Ch(qe.revive(e.gutterIconPath)))),typeof e.gutterIconSize<"u"&&t.push(No(ib.gutterIconSize,e.gutterIconSize))),t.join("")}collectBorderSettingsCSSText(e,t){return this.collectCSSText(e,["border","borderColor","borderRadius","borderSpacing","borderStyle","borderWidth"],t)?(t.push(No("box-sizing: border-box;")),!0):!1}collectCSSText(e,t,i){const r=i.length;for(let s of t){const o=this.resolveValue(e[s]);typeof o=="string"&&i.push(No(ib[s],o))}return i.length!==r}resolveValue(e){if(mLe(e)){this._usesThemeColors=!0;const t=this._theme.getColor(e.id);return t?t.toString():"transparent"}return e}}class aA{static getClassName(e,t){return"ced-"+e+"-"+t}static getSelector(e,t,i){let r=".monaco-editor ."+this.getClassName(e,i);return t&&(r=r+"."+this.getClassName(t,i)),i===3?r+="::before":i===4&&(r+="::after"),r}}var DPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},uz=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let _D=class extends IF{constructor(e,t,i){super(e,i),this.onCodeEditorAdd(()=>this._checkContextKey()),this.onCodeEditorRemove(()=>this._checkContextKey()),this._editorIsOpen=t.createKey("editorIsOpen",!1),this._activeCodeEditor=null}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}openCodeEditor(e,t,i){return t?Promise.resolve(this.doOpenEditor(t,e)):Promise.resolve(null)}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const s=t.resource.scheme;if(s===ft.http||s===ft.https)return TQ(t.resource.toString()),e}return null}const r=t.options?t.options.selection:null;if(r)if(typeof r.endLineNumber=="number"&&typeof r.endColumn=="number")e.setSelection(r),e.revealRangeInCenter(r,1);else{const s={lineNumber:r.startLineNumber,column:r.startColumn};e.setPosition(s),e.revealPositionInCenter(s,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};_D=DPe([uz(1,Xe),uz(2,fi)],_D);var K5=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},ii=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let kPe=0,dz=!1;function LPe(n){if(!n){if(dz)return;dz=!0}vTe(n||document.body)}let bD=class extends zw{constructor(e,t,i,r,s,o,a,l,c,h){const u=Object.assign({},t);u.ariaLabel=u.ariaLabel||zE.editorViewAccessibleLabel,u.ariaLabel=u.ariaLabel+";"+zE.accessibilityHelpMessage,super(e,u,{},i,r,s,o,l,c,h),a instanceof $J?this._standaloneKeybindingService=a:this._standaloneKeybindingService=null,LPe(u.ariaContainerElement)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;let r="DYNAMIC_"+ ++kPe,s=Ie.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(r,e,t,s),r}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),re.None;const t=e.id,i=e.label,r=Ie.and(Ie.equals("editorId",this.getId()),Ie.deserialize(e.precondition)),s=e.keybindings,o=Ie.and(r,Ie.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(f,...g)=>Promise.resolve(e.run(this,...g)),h=new ve,u=this.getId()+":"+t;if(h.add(Pt.registerCommand(u,c)),a){let f={command:{id:u,title:i},when:r,group:a,order:l};h.add(Pa.appendMenuItem(Ye.EditorContext,f))}if(Array.isArray(s))for(const f of s)h.add(this._standaloneKeybindingService.addDynamicKeybinding(u,f,c,o));let d=new tte(u,i,i,r,c,this._contextKeyService);return this._actions[t]=d,h.add(Et(()=>{delete this._actions[t]})),h}_triggerCommand(e,t){if(this._codeEditorService instanceof _D)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};bD=K5([ii(2,Kt),ii(3,ui),ii(4,An),ii(5,Xe),ii(6,Yi),ii(7,fi),ii(8,Qn),ii(9,ps)],bD);let TF=class extends bD{constructor(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p){const m=Object.assign({},t);HE(d,m,!1);const b=h.registerEditorContainer(e);typeof m.theme=="string"&&h.setTheme(m.theme),typeof m.autoDetectHighContrast<"u"&&h.setAutoDetectHighContrast(!!m.autoDetectHighContrast);let _=m.model;delete m.model,super(e,m,r,s,o,a,l,h,u,f),this._contextViewService=c,this._configurationService=d,this._standaloneThemeService=h,this._register(i),this._register(b);let w;if(typeof _>"u"?(w=dte(g,p,m.value||"",m.language||Oo.text,void 0),this._ownsModel=!0):(w=_,this._ownsModel=!1),this._attachModel(w),w){let y={oldModelUrl:null,newModelUrl:w.uri};this._onDidChangeModel.fire(y)}}dispose(){super.dispose()}updateOptions(e){HE(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_attachModel(e){super._attachModel(e),this._modelData&&this._contextViewService.setContainer(this._modelData.view.domNode.domNode)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};TF=K5([ii(3,Kt),ii(4,ui),ii(5,An),ii(6,Xe),ii(7,Yi),ii(8,qg),ii(9,Cy),ii(10,Qn),ii(11,Zi),ii(12,ps),ii(13,Kr),ii(14,Zr)],TF);let AF=class extends Xu{constructor(e,t,i,r,s,o,a,l,c,h,u,d,f,g,p){const m=Object.assign({},t);HE(d,m,!0);const b=h.registerEditorContainer(e);typeof m.theme=="string"&&h.setTheme(m.theme),typeof m.autoDetectHighContrast<"u"&&h.setAutoDetectHighContrast(!!m.autoDetectHighContrast),super(e,m,{},p,l,s,r,c,h,u,f,g),this._contextViewService=a,this._configurationService=d,this._standaloneThemeService=h,this._register(i),this._register(b),this._contextViewService.setContainer(this._containerDomElement)}dispose(){super.dispose()}updateOptions(e){HE(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(bD,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};AF=K5([ii(3,Kt),ii(4,Xe),ii(5,Yi),ii(6,qg),ii(7,pd),ii(8,ui),ii(9,Cy),ii(10,Qn),ii(11,Zi),ii(12,Gg),ii(13,L0),ii(14,Kg)],AF);function dte(n,e,t,i,r){if(t=t||"",!i){const s=t.indexOf(`
`);let o=t;return s!==-1&&(o=t.substring(0,s)),fz(n,t,e.createByFilepathOrFirstLine(r||null,o),r)}return fz(n,t,e.create(i),r)}function fz(n,e,t,i){return n.createModel(e,t,i)}const Dd=Object.prototype.hasOwnProperty;class IPe{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(qu,0),this._register(D0,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||qu}}class Uw extends re{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,Uw.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new IPe,this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(Ff.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){Uw.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},EMe();const e=Ff.getLanguages();this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{let i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(r=>{this._lowercaseNameMap[r.toLowerCase()]=i.identifier}),i.mimetypes.forEach(r=>{this._mimeTypesMap[r]=i.identifier})}),Bn.as(b0.Configuration).registerOverrideIdentifiers(Ff.getLanguages().map(t=>t.id)),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;Dd.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let r=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),r=t.mimetypes[0]),r||(r=`text/x-${i}`,e.mimetypes.push(r)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(let a of t.extensions)kC({id:i,mime:r,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(let a of t.filenames)kC({id:i,mime:r,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(let a of t.filenamePatterns)kC({id:i,mime:r,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{let l=new RegExp(a);Ike(l)||kC({id:i,mime:r,firstline:l},this._warnOnOverwrite)}catch(l){it(l)}}e.aliases.push(i);let s=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?s=[null]:s=t.aliases),s!==null)for(const a of s)!a||a.length===0||e.aliases.push(a);let o=s!==null&&s.length>0;if(!(o&&s[0]===null)){let a=(o?s[0]:null)||i;(o||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration)}isRegisteredMode(e){return Dd.call(this._mimeTypesMap,e)?!0:Dd.call(this._languages,e)}getModeIdForLanguageNameLowercase(e){return Dd.call(this._lowercaseNameMap,e)?this._lowercaseNameMap[e]:null}extractModeIds(e){return e?e.split(",").map(t=>t.trim()).map(t=>Dd.call(this._mimeTypesMap,t)?this._mimeTypesMap[t]:t).filter(t=>Dd.call(this._languages,t)):[]}validateLanguageId(e){return!e||e===qu?qu:Dd.call(this._languages,e)?e:null}getModeIdsFromFilepathOrFirstLine(e,t){if(!e&&!t)return[];let i=DMe(e,t);return this.extractModeIds(i.join(","))}}Uw.instanceCount=0;class gz{constructor(e,t){this._selector=t,this.languageId=this._selector();let i;this._onDidChange=new H({onFirstListenerAdd:()=>{i=e(()=>this._evaluate())},onLastListenerRemove:()=>{i.dispose()}}),this.onDidChange=this._onDidChange.event}_evaluate(){const e=this._selector();e!==this.languageId&&(this.languageId=e,this._onDidChange.fire(this.languageId))}}class jw extends re{constructor(e=!1){super(),this._onDidEncounterLanguage=this._register(new H),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event,this._onLanguagesMaybeChanged=this._register(new H({leakWarningThreshold:200})),this.onLanguagesMaybeChanged=this._onLanguagesMaybeChanged.event,jw.instanceCount++,this._encounteredLanguages=new Set,this._registry=this._register(new Uw(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onLanguagesMaybeChanged.fire()))}dispose(){jw.instanceCount--,super.dispose()}isRegisteredMode(e){return this._registry.isRegisteredMode(e)}getModeIdForLanguageName(e){return this._registry.getModeIdForLanguageNameLowercase(e)}getModeIdByFilepathOrFirstLine(e,t){const i=this._registry.getModeIdsFromFilepathOrFirstLine(e,t);return QM(i,null)}getModeId(e){const t=this._registry.extractModeIds(e);return QM(t,null)}validateLanguageId(e){return this._registry.validateLanguageId(e)}create(e){return new gz(this.onLanguagesMaybeChanged,()=>{const t=this.getModeId(e);return this._createModeAndGetLanguageIdentifier(t)})}createByFilepathOrFirstLine(e,t){return new gz(this.onLanguagesMaybeChanged,()=>{const i=this.getModeIdByFilepathOrFirstLine(e,t);return this._createModeAndGetLanguageIdentifier(i)})}_createModeAndGetLanguageIdentifier(e){const t=this.validateLanguageId(e||"plaintext")||qu;return this._getOrCreateMode(t),t}triggerMode(e){const t=this.getModeId(e);this._getOrCreateMode(t||"plaintext")}_getOrCreateMode(e){if(!this._encounteredLanguages.has(e)){this._encounteredLanguages.add(e);const t=this.validateLanguageId(e)||qu;this._onDidEncounterLanguage.fire(t)}}}jw.instanceCount=0;var TPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},lA=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let NF=class{constructor(e,t,i,r){this._legend=e,this._themeService=t,this._modeService=i,this._logService=r,this._hashTable=new Yc,this._hasWarnedOverlappingTokens=!1}getMetadata(e,t,i){const r=this._modeService.languageIdCodec.encodeLanguageId(i),s=this._hashTable.get(e,t,r);let o;if(s)o=s.metadata,this._logService.getLevel()===Ta.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${e} / ${t}: foreground ${Qs.getForeground(o)}, fontStyle ${Qs.getFontStyle(o).toString(2)}`);else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let u=0;c>0&&u<this._legend.tokenModifiers.length;u++)c&1&&l.push(this._legend.tokenModifiers[u]),c=c>>1;c>0&&this._logService.getLevel()===Ta.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${t.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),l.push("not-in-legend"));const h=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof h>"u")o=2147483647;else{if(o=0,typeof h.italic<"u"){const u=(h.italic?1:0)<<11;o|=u|1}if(typeof h.bold<"u"){const u=(h.bold?2:0)<<11;o|=u|2}if(typeof h.underline<"u"){const u=(h.underline?4:0)<<11;o|=u|4}if(h.foreground){const u=h.foreground<<14;o|=u|8}o===0&&(o=2147483647)}}else this._logService.getLevel()===Ta.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${e} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),o=2147483647,a="not-in-legend";this._hashTable.add(e,t,r,o),this._logService.getLevel()===Ta.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${e} (${a}) / ${t} (${l.join(" ")}): foreground ${Qs.getForeground(o)}, fontStyle ${Qs.getFontStyle(o).toString(2)}`)}return o}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,console.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}};NF=TPe([lA(1,fi),lA(2,Zr),lA(3,Ih)],NF);function APe(n,e,t){const i=n.data,r=n.data.length/5|0,s=Math.max(Math.ceil(r/1024),400),o=[];let a=0,l=1,c=0;for(;a<r;){const h=a;let u=Math.min(h+s,r);if(u<r){let w=u;for(;w-1>h&&i[5*w]===0;)w--;if(w-1===h){let y=u;for(;y+1<r&&i[5*y]===0;)y++;u=y}else u=w}let d=new Uint32Array((u-h)*4),f=0,g=0,p=0,m=0,b=0;for(;a<u;){const w=5*a,y=i[w],S=i[w+1],k=l+y|0,C=y===0?c+S|0:S,D=i[w+2],E=i[w+3],N=i[w+4],T=e.getMetadata(E,N,t);T!==2147483647&&(g===0&&(g=k),p===k&&b>C&&(e.warnOverlappingSemanticTokens(k,C+1),m<C?d[f-4+2]=C:f-=4),d[f]=k-g,d[f+1]=C,d[f+2]=C+D,d[f+3]=T,f+=4,p=k,m=C,b=C+D),l=k,c=C,a++}f!==d.length&&(d=d.subarray(0,f));const _=new ZE(g,new KE(d));o.push(_)}return o}class NPe{constructor(e,t,i,r){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=r,this.next=null}}class Yc{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=Yc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Yc._SIZES.length?2/3*this._currentLength:0),this._elements=[],Yc._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const r=this._hashFunc(e,t,i);let s=this._elements[r];for(;s;){if(s.tokenTypeIndex===e&&s.tokenModifierSet===t&&s.languageId===i)return s;s=s.next}return null}add(e,t,i,r){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const s=this._elements;this._currentLengthIndex++,this._currentLength=Yc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<Yc._SIZES.length?2/3*this._currentLength:0),this._elements=[],Yc._nullOutEntries(this._elements,this._currentLength);for(const o of s){let a=o;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new NPe(e,t,i,r))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}Yc._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];function RPe(n){for(let e=0,t=n.length;e<t;e+=4){const i=n[e+0],r=n[e+1],s=n[e+2],o=n[e+3];n[e+0]=o,n[e+1]=s,n[e+2]=r,n[e+3]=i}}function MPe(n){const e=new Uint8Array(n.buffer,n.byteOffset,n.length*4);return JX()||RPe(e),Yk.wrap(e)}function fte(n){const e=new Uint32Array(FPe(n));let t=0;if(e[t++]=n.id,n.type==="full")e[t++]=1,e[t++]=n.data.length,e.set(n.data,t),t+=n.data.length;else{e[t++]=2,e[t++]=n.deltas.length;for(const i of n.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return MPe(e)}function FPe(n){let e=0;if(e+=1+1,n.type==="full")e+=1+n.data.length;else{e+=1,e+=(1+1+1)*n.deltas.length;for(const t of n.deltas)t.data&&(e+=t.data.length)}return e}var Qu=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function RL(n){return n&&!!n.data}function gte(n){return n&&Array.isArray(n.edits)}class OPe{constructor(e,t){this.provider=e,this.tokens=t}}function pte(n){return C_.has(n)}function PPe(n){const e=C_.orderedGroups(n);return e.length>0?e[0]:[]}function mte(n,e,t,i){return Qu(this,void 0,void 0,function*(){const r=PPe(n),s=yield Promise.all(r.map(o=>Qu(this,void 0,void 0,function*(){let a;try{a=yield o.provideDocumentSemanticTokens(n,o===e?t:null,i)}catch(l){ca(l),a=null}return(!a||!RL(a)&&!gte(a))&&(a=null),new OPe(o,a)})));for(const o of s)if(o.tokens)return o;return s.length>0?s[0]:null})}function BPe(n){const e=C_.orderedGroups(n);return e.length>0?e[0]:null}class VPe{constructor(e,t){this.provider=e,this.tokens=t}}function _te(n){const e=QQ.orderedGroups(n);return e.length>0?e[0]:[]}function bte(n,e,t){return Qu(this,void 0,void 0,function*(){const i=_te(n),r=yield Promise.all(i.map(s=>Qu(this,void 0,void 0,function*(){let o;try{o=yield s.provideDocumentRangeSemanticTokens(n,e,t)}catch(a){ca(a),o=null}return(!o||!RL(o))&&(o=null),new VPe(s,o)})));for(const s of r)if(s.tokens)return s;return r.length>0?r[0]:null})}Pt.registerCommand("_provideDocumentSemanticTokensLegend",(n,...e)=>Qu(void 0,void 0,void 0,function*(){const[t]=e;ji(t instanceof qe);const i=n.get(Kr).getModel(t);if(!i)return;const r=BPe(i);return r?r[0].getLegend():n.get(An).executeCommand("_provideDocumentRangeSemanticTokensLegend",t)}));Pt.registerCommand("_provideDocumentSemanticTokens",(n,...e)=>Qu(void 0,void 0,void 0,function*(){const[t]=e;ji(t instanceof qe);const i=n.get(Kr).getModel(t);if(!i)return;if(!pte(i))return n.get(An).executeCommand("_provideDocumentRangeSemanticTokens",t,i.getFullModelRange());const r=yield mte(i,null,null,ai.None);if(!r)return;const{provider:s,tokens:o}=r;if(!o||!RL(o))return;const a=fte({id:0,type:"full",data:o.data});return o.resultId&&s.releaseDocumentSemanticTokens(o.resultId),a}));Pt.registerCommand("_provideDocumentRangeSemanticTokensLegend",(n,...e)=>Qu(void 0,void 0,void 0,function*(){const[t,i]=e;ji(t instanceof qe);const r=n.get(Kr).getModel(t);if(!r)return;const s=_te(r);if(s.length===0)return;if(s.length===1)return s[0].getLegend();if(!i||!V.isIRange(i))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),s[0].getLegend();const o=yield bte(r,V.lift(i),ai.None);if(o)return o.provider.getLegend()}));Pt.registerCommand("_provideDocumentRangeSemanticTokens",(n,...e)=>Qu(void 0,void 0,void 0,function*(){const[t,i]=e;ji(t instanceof qe),ji(V.isIRange(i));const r=n.get(Kr).getModel(t);if(!r)return;const s=yield bte(r,V.lift(i),ai.None);if(!(!s||!s.tokens))return fte({id:0,type:"full",data:s.tokens.data})}));var WPe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},kd=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};function Vh(n){return n.toString()}function pz(n){const e=new Qk,t=n.createSnapshot();let i;for(;i=t.read();)e.update(i);return e.digest()}class $Pe{constructor(e,t,i){this._modelEventListeners=new ve,this.model=e,this._languageSelection=null,this._languageSelectionListener=null,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(r=>i(e,r)))}_disposeLanguageSelection(){this._languageSelectionListener&&(this._languageSelectionListener.dispose(),this._languageSelectionListener=null)}dispose(){this._modelEventListeners.dispose(),this._disposeLanguageSelection()}setLanguage(e){this._disposeLanguageSelection(),this._languageSelection=e,this._languageSelectionListener=this._languageSelection.onDidChange(()=>this.model.setMode(e.languageId)),this.model.setMode(e.languageId)}}const zPe=zr||wt?1:2;class HPe{constructor(e,t,i,r,s,o,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=r,this.heapSize=s,this.sha1=o,this.versionId=a,this.alternativeVersionId=l}}let vD=class Db extends re{constructor(e,t,i,r,s,o,a){super(),this._configurationService=e,this._resourcePropertiesService=t,this._themeService=i,this._logService=r,this._undoRedoService=s,this._modeService=o,this._languageConfigurationService=a,this._onModelAdded=this._register(new H),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new H),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new H),this.onModelModeChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._semanticStyling=this._register(new jPe(this._themeService,this._modeService,this._logService)),this._register(this._configurationService.onDidChangeConfiguration(()=>this._updateModelOptions())),this._updateModelOptions(),this._register(new UPe(this,this._themeService,this._configurationService,this._semanticStyling))}static _readModelOptions(e,t){var i;let r=sr.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const f=parseInt(e.editor.tabSize,10);isNaN(f)||(r=f),r<1&&(r=1)}let s=r;if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const f=parseInt(e.editor.indentSize,10);isNaN(f)||(s=f),s<1&&(s=1)}let o=sr.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(o=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let a=zPe;const l=e.eol;l===`\r
`?a=2:l===`
`&&(a=1);let c=sr.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(c=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let h=sr.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(h=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let u=sr.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(u=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let d=sr.bracketPairColorizationOptions;return!((i=e.editor)===null||i===void 0)&&i.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(d={enabled:!!e.editor.bracketPairColorization.enabled}),{isForSimpleWidget:t,tabSize:r,indentSize:s,insertSpaces:o,detectIndentation:h,defaultEOL:a,trimAutoWhitespace:c,largeFileOptimizations:u,bracketPairColorizationOptions:d}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:Fo===3||Fo===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){let r=this._modelCreationOptionsByLanguageAndResource[e+t];if(!r){const s=this._configurationService.getValue("editor",{overrideIdentifier:e,resource:t}),o=this._getEOL(t,e);r=Db._readModelOptions({editor:s,eol:o},i),this._modelCreationOptionsByLanguageAndResource[e+t]=r}return r}_updateModelOptions(){const e=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const t=Object.keys(this._models);for(let i=0,r=t.length;i<r;i++){const s=t[i],o=this._models[s],a=o.model.getLanguageId(),l=o.model.uri,c=e[a+l],h=this.getCreationOptions(a,l,o.model.isForSimpleWidget);Db._setModelOptionsForModel(o.model,h,c)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&Ma(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(Vh(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(Vh(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(Vh(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,r)=>i.time-r.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,r){const s=this.getCreationOptions(t,i,r),o=new fo(e,s,t,i,this._undoRedoService,this._modeService,this._languageConfigurationService);if(i&&this._disposedModels.has(Vh(i))){const c=this._removeDisposedModel(i),h=this._undoRedoService.getElements(i),u=pz(o)===c.sha1;if(u||c.sharesUndoRedoStack){for(const d of h.past)Gc(d)&&d.matchesResource(i)&&d.setModel(o);for(const d of h.future)Gc(d)&&d.matchesResource(i)&&d.setModel(o);this._undoRedoService.setElementsValidFlag(i,!0,d=>Gc(d)&&d.matchesResource(i)),u&&(o._overwriteVersionId(c.versionId),o._overwriteAlternativeVersionId(c.alternativeVersionId),o._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=Vh(o.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new $Pe(o,c=>this._onWillDispose(c),(c,h)=>this._onDidChangeLanguage(c,h));return this._models[a]=l,l}createModel(e,t,i,r=!1){let s;return t?(s=this._createModelData(e,t.languageId,i,r),this.setMode(s.model,t)):s=this._createModelData(e,D0,i,r),this._onModelAdded.fire(s.model),s.model}setMode(e,t){if(!t)return;const i=this._models[Vh(e.uri)];i&&i.setLanguage(t)}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,r=t.length;i<r;i++){const s=t[i];e.push(this._models[s].model)}return e}getModel(e){const t=Vh(e),i=this._models[t];return i?i.model:null}getSemanticTokensProviderStyling(e){return this._semanticStyling.get(e)}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===ft.file||e.scheme===ft.vscodeRemote||e.scheme===ft.userData||e.scheme===ft.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=Vh(e.uri),i=this._models[t],r=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let s=!1,o=0;if(r||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const l=this._undoRedoService.getElements(e.uri);if(l.past.length>0||l.future.length>0){for(const c of l.past)Gc(c)&&c.matchesResource(e.uri)&&(s=!0,o+=c.heapSize(e.uri),c.setModel(e.uri));for(const c of l.future)Gc(c)&&c.matchesResource(e.uri)&&(s=!0,o+=c.heapSize(e.uri),c.setModel(e.uri))}}const a=Db.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK;if(s)if(!r&&o>a){const l=i.model.getInitialUndoRedoSnapshot();l!==null&&this._undoRedoService.restoreSnapshot(l)}else this._ensureDisposedModelsHeapSize(a-o),this._undoRedoService.setElementsValidFlag(e.uri,!1,l=>Gc(l)&&l.matchesResource(e.uri)),this._insertDisposedModel(new HPe(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),r,o,pz(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!r){const l=i.model.getInitialUndoRedoSnapshot();l!==null&&this._undoRedoService.restoreSnapshot(l)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,r=e.getLanguageId(),s=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),o=this.getCreationOptions(r,e.uri,e.isForSimpleWidget);Db._setModelOptionsForModel(e,o,s),this._onModelModeChanged.fire({model:e,oldModeId:i})}};vD.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024;vD=WPe([kd(0,Zi),kd(1,mJ),kd(2,fi),kd(3,Ih),kd(4,vy),kd(5,Zr),kd(6,my)],vD);const vte="editor.semanticHighlighting";function mz(n,e,t){var i;const r=(i=t.getValue(vte,{overrideIdentifier:n.getLanguageId(),resource:n.uri}))===null||i===void 0?void 0:i.enabled;return typeof r=="boolean"?r:e.getColorTheme().semanticHighlighting}class UPe extends re{constructor(e,t,i,r){super(),this._watchers=Object.create(null),this._semanticStyling=r;const s=l=>{this._watchers[l.uri.toString()]=new gf(l,t,this._semanticStyling)},o=(l,c)=>{c.dispose(),delete this._watchers[l.uri.toString()]},a=()=>{for(let l of e.getModels()){const c=this._watchers[l.uri.toString()];mz(l,t,i)?c||s(l):c&&o(l,c)}};this._register(e.onModelAdded(l=>{mz(l,t,i)&&s(l)})),this._register(e.onModelRemoved(l=>{const c=this._watchers[l.uri.toString()];c&&o(l,c)})),this._register(i.onDidChangeConfiguration(l=>{l.affectsConfiguration(vte)&&a()})),this._register(t.onDidColorThemeChange(a))}}class jPe extends re{constructor(e,t,i){super(),this._themeService=e,this._modeService=t,this._logService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}get(e){return this._caches.has(e)||this._caches.set(e,new NF(e.getLegend(),this._themeService,this._modeService,this._logService)),this._caches.get(e)}}class qPe{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}class gf extends re{constructor(e,t,i){super(),this._isDisposed=!1,this._model=e,this._semanticStyling=i,this._fetchDocumentSemanticTokens=this._register(new yi(()=>this._fetchDocumentSemanticTokensNow(),gf.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule()})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const r=()=>{mt(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const s of C_.all(e))typeof s.onDidChange=="function"&&this._documentProvidersChangeListeners.push(s.onDidChange(()=>this._fetchDocumentSemanticTokens.schedule(0)))};r(),this._register(C_.onDidChange(()=>{r(),this._fetchDocumentSemanticTokens.schedule()})),this._register(t.onDidColorThemeChange(s=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule()})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!pte(this._model)){this._currentDocumentResponse&&this._model.setSemanticTokens(null,!1);return}const e=new rl,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,r=mte(this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e;const s=[],o=this._model.onDidChangeContent(a=>{s.push(a)});r.then(a=>{if(this._currentDocumentRequestCancellationTokenSource=null,o.dispose(),!a)this._setDocumentSemanticTokens(null,null,null,s);else{const{provider:l,tokens:c}=a,h=this._semanticStyling.get(l);this._setDocumentSemanticTokens(l,c||null,h,s)}},a=>{a&&(gd(a)||typeof a.message=="string"&&a.message.indexOf("busy")!==-1)||it(a),this._currentDocumentRequestCancellationTokenSource=null,o.dispose(),s.length>0&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule())})}static _copy(e,t,i,r,s){for(let o=0;o<s;o++)i[r+o]=e[t+o]}_setDocumentSemanticTokens(e,t,i,r){const s=this._currentDocumentResponse,o=()=>{r.length>0&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule()};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){e&&t&&e.releaseDocumentSemanticTokens(t.resultId);return}if(!e||!i){this._model.setSemanticTokens(null,!1);return}if(!t){this._model.setSemanticTokens(null,!0),o();return}if(gte(t)){if(!s){this._model.setSemanticTokens(null,!0);return}if(t.edits.length===0)t={resultId:t.resultId,data:s.data};else{let a=0;for(const d of t.edits)a+=(d.data?d.data.length:0)-d.deleteCount;const l=s.data,c=new Uint32Array(l.length+a);let h=l.length,u=c.length;for(let d=t.edits.length-1;d>=0;d--){const f=t.edits[d],g=h-(f.start+f.deleteCount);g>0&&(gf._copy(l,h-g,c,u-g,g),u-=g),f.data&&(gf._copy(f.data,0,c,u-f.data.length,f.data.length),u-=f.data.length),h=f.start}h>0&&gf._copy(l,0,c,0,h),t={resultId:t.resultId,data:c}}}if(RL(t)){this._currentDocumentResponse=new qPe(e,t.resultId,t.data);const a=APe(t,i,this._model.getLanguageId());if(r.length>0)for(const l of r)for(const c of a)for(const h of l.changes)c.applyEdit(h.range,h.text);this._model.setSemanticTokens(a,!0)}else this._model.setSemanticTokens(null,!0);o()}}gf.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY=300;class GPe{constructor(e,t,i,r,s){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=r,this.background=s}}function KPe(n){if(!n||!Array.isArray(n))return[];let e=[],t=0;for(let i=0,r=n.length;i<r;i++){let s=n[i],o=-1;if(typeof s.fontStyle=="string"){o=0;let c=s.fontStyle.split(" ");for(let h=0,u=c.length;h<u;h++)switch(c[h]){case"italic":o=o|1;break;case"bold":o=o|2;break;case"underline":o=o|4;break}}let a=null;typeof s.foreground=="string"&&(a=s.foreground);let l=null;typeof s.background=="string"&&(l=s.background),e[t++]=new GPe(s.token||"",i,o,a,l)}return e}function ZPe(n,e){n.sort((h,u)=>{let d=e4e(h.token,u.token);return d!==0?d:h.index-u.index});let t=0,i="000000",r="ffffff";for(;n.length>=1&&n[0].token==="";){let h=n.shift();h.fontStyle!==-1&&(t=h.fontStyle),h.foreground!==null&&(i=h.foreground),h.background!==null&&(r=h.background)}let s=new XPe;for(let h of e)s.getId(h);let o=s.getId(i),a=s.getId(r),l=new Z5(t,o,a),c=new Y5(l);for(let h=0,u=n.length;h<u;h++){let d=n[h];c.insert(d.token,d.fontStyle,s.getId(d.foreground),s.getId(d.background))}return new wte(s,c)}const YPe=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class XPe{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(YPe);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=X.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class wte{constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(KPe(e),t)}static createFromParsedTokenTheme(e,t){return ZPe(e,t)}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){let r=this._match(t),s=JPe(t);i=(r.metadata|s<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const QPe=/\b(comment|string|regex|regexp)\b/;function JPe(n){let e=n.match(QPe);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 4;case"regexp":return 4}throw new Error("Unexpected match for standard token type!")}function e4e(n,e){return n<e?-1:n>e?1:0}class Z5{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}clone(){return new Z5(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<14|this._background<<23)>>>0}}class Y5{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;let t=e.indexOf("."),i,r;t===-1?(i=e,r=""):(i=e.substring(0,t),r=e.substring(t+1));let s=this._children.get(i);return typeof s<"u"?s.match(r):this._mainRule}insert(e,t,i,r){if(e===""){this._mainRule.acceptOverwrite(t,i,r);return}let s=e.indexOf("."),o,a;s===-1?(o=e,a=""):(o=e.substring(0,s),a=e.substring(s+1));let l=this._children.get(o);typeof l>"u"&&(l=new Y5(this._mainRule.clone()),this._children.set(o,l)),l.insert(a,t,i,r)}}function t4e(n){let e=[];for(let t=1,i=n.length;t<i;t++){let r=n[t];e[t]=`.mtk${t} { color: ${r}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.join(`
`)}const i4e={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[lo]:"#FFFFFE",[ku]:"#000000",[T5]:"#E5EBF1",[EL]:"#D3D3D3",[DL]:"#939393",[Eee]:"#ADD6FF4D"}},n4e={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[lo]:"#1E1E1E",[ku]:"#D4D4D4",[T5]:"#3A3D41",[EL]:"#404040",[DL]:"#707070",[Eee]:"#ADD6FF26"}},r4e={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[lo]:"#000000",[ku]:"#FFFFFF",[EL]:"#FFFFFF",[DL]:"#FFFFFF"}};function s4e(){const n=new H,e=ePe();return e.onDidChange(()=>n.fire()),{onDidChange:n.event,getCSS(){const t={},i=s=>{let o=s.defaults;for(;mi.isThemeIcon(o);){const l=e.getIcon(o.id);if(!l)return;o=l.defaults}const a=o.fontId;if(a){const l=e.getIconFont(a);if(l)return t[a]=l,`.codicon-${s.id}:before { content: '${o.fontCharacter}'; font-family: ${XV(a)}; }`}return`.codicon-${s.id}:before { content: '${o.fontCharacter}'; }`},r=[];for(let s of e.getIcons()){const o=i(s);o&&r.push(o)}for(let s in t){const a=t[s].definition.src.map(l=>`${Ch(l.location)} format('${l.format}')`).join(", ");r.push(`@font-face { src: ${a}; font-family: ${XV(s)}; font-display: block; }`)}return r.join(`
`)}}}const pf="vs",wD="vs-dark",Vm="hc-black",o4e=Bn.as(fee.ColorContribution),a4e=Bn.as(HJ.ThemingContribution);class yte{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;let i=t.base;e.length>0?(YS(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(let t in this.themeData.colors)e.set(t,X.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){let t=RF(this.themeData.base);for(let i in t.colors)e.has(i)||e.set(i,X.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=o4e.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return Object.prototype.hasOwnProperty.call(this.getColors(),e)}get type(){switch(this.base){case pf:return Oa.LIGHT;case Vm:return Oa.HIGH_CONTRAST;default:return Oa.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){let s=RF(this.themeData.base);e=s.rules,s.encodedTokensColors&&(t=s.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],r=this.themeData.colors["editor.background"];if(i||r){const s={token:""};i&&(s.foreground=i),r&&(s.background=r),e.push(s)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=wte.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const s=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=Qs.getForeground(s),a=Qs.getFontStyle(s);return{foreground:o,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4)}}}function YS(n){return n===pf||n===wD||n===Vm}function RF(n){switch(n){case pf:return i4e;case wD:return n4e;case Vm:return r4e}}function cA(n){let e=RF(n);return new yte(n,e)}class l4e extends re{constructor(){super(),this._onColorThemeChange=this._register(new H),this.onDidColorThemeChange=this._onColorThemeChange.event,this._environment=Object.create(null),this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(pf,cA(pf)),this._knownThemes.set(wD,cA(wD)),this._knownThemes.set(Vm,cA(Vm));const e=s4e();this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(pf),e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()}),Eke("(forced-colors: active)",()=>{this._updateActualTheme()})}registerEditorContainer(e){return R3(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=ho(),this._globalStyleElement.className="monaco-colors",this._globalStyleElement.textContent=this._allCSS,this._styleElements.push(this._globalStyleElement)),re.None}_registerShadowDomContainer(e){const t=ho(e);return t.className="monaco-colors",t.textContent=this._allCSS,this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!YS(t.base)&&!YS(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new yte(e,t)),YS(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(pf),this._desiredTheme=t,this._updateActualTheme()}_updateActualTheme(){const e=this._autoDetectHighContrast&&window.matchMedia("(forced-colors: active)").matches?this._knownThemes.get(Vm):this._desiredTheme;this._theme!==e&&(this._theme=e,this._updateThemeOrColorMap())}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._updateActualTheme()}_updateThemeOrColorMap(){let e=[],t={},i={addRule:s=>{t[s]||(e.push(s),t[s]=!0)}};a4e.getThemingParticipants().forEach(s=>s(this._theme,i,this._environment));const r=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(t4e(r)),this._themeCSS=e.join(`
`),this._updateCSS(),Fi.setColorMap(r),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}}var c4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},h4e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const yv="data-keybinding-context";let X5=class{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}};class O_ extends X5{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}O_.INSTANCE=new O_;class qw extends X5{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=Dm.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(r=>{if(r.source===6){const s=Array.from(vt.map(this._values,([o])=>o));this._values.clear(),i.fire(new bz(s))}else{const s=[];for(const o of r.affectedKeys){const a=`config.${o}`,l=this._values.findSuperstr(a);l!==void 0&&(s.push(...vt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(s.push(a),this._values.delete(a))}i.fire(new bz(s))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(qw._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(qw._keyPrefix.length),i=this._configurationService.getValue(t);let r;switch(typeof i){case"number":case"boolean":case"string":r=i;break;default:Array.isArray(i)?r=JSON.stringify(i):r=i}return this._values.set(e,r),r}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}qw._keyPrefix="config.";class u4e{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class _z{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}}class bz{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}}class d4e{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}}class Cte{constructor(e){this._onDidChangeContext=new fE({merge:t=>new d4e(t)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new u4e(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new f4e(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return Im.contextMatchesRules(t,e)}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new _z(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new _z(e))}getContext(e){return this._isDisposed?O_.INSTANCE:this.getContextValuesContainer(g4e(e))}}let MF=class extends Cte{constructor(e){super(0),this._contexts=new Map,this._toDispose=new ve,this._lastContextId=0;const t=new qw(this._myContextId,e,this._onDidChangeContext);this._contexts.set(this._myContextId,t),this._toDispose.add(t)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(e){return this._isDisposed?O_.INSTANCE:this._contexts.get(e)||O_.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");let t=++this._lastContextId;return this._contexts.set(t,new X5(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};MF=c4e([h4e(0,Zi)],MF);class f4e extends Cte{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=new zs,this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(yv)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(yv,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(this._onDidChangeContext.fire,this._onDidChangeContext)}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute(yv),this._isDisposed=!0)}getContextValuesContainer(e){return this._isDisposed?O_.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function g4e(n){for(;n;){if(n.hasAttribute(yv)){const e=n.getAttribute(yv);return e?parseInt(e,10):NaN}n=n.parentElement}return 0}Pt.registerCommand(tTe,function(n,e,t){n.get(Xe).createKey(String(e),t)});Pt.registerCommand({id:"getContextKeyInfo",handler(){return[...Te.all()].sort((n,e)=>n.key.localeCompare(e.key))},description:{description:v("getContextKeyInfo","A command that returns information about context keys"),args:[]}});Pt.registerCommand("_generateContextKeyInfo",function(){const n=[],e=new Set;for(let t of Te.all())e.has(t.key)||(e.add(t.key),n.push(t));n.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(n,void 0,2))});function vz(n){let e=n.definition;for(;e instanceof Ce;)e=e.definition;return`.codicon-${n.id}:before { content: '${e.fontCharacter}'; }`}var zn;(function(n){function e(s,o){if(s.start>=o.end||o.start>=s.end)return{start:0,end:0};const a=Math.max(s.start,o.start),l=Math.min(s.end,o.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}n.intersect=e;function t(s){return s.end-s.start<=0}n.isEmpty=t;function i(s,o){return!t(e(s,o))}n.intersects=i;function r(s,o){const a=[],l={start:s.start,end:Math.min(o.start,s.end)},c={start:Math.max(o.end,s.start),end:s.end};return t(l)||a.push(l),t(c)||a.push(c),a}n.relativeComplement=r})(zn||(zn={}));var fu;(function(n){n[n.AVOID=0]="AVOID",n[n.ALIGN=1]="ALIGN"})(fu||(fu={}));function nm(n,e,t){const i=t.mode===fu.ALIGN?t.offset:t.offset+t.size,r=t.mode===fu.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=n-i?i:e<=r?r-e:Math.max(n-e,0):e<=r?r-e:e<=n-i?i:0}class P_ extends re{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=re.None,this.toDisposeOnSetContainer=re.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=me(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,Or(this.view),this.setContainer(e,t),this._register(Et(()=>this.setContainer(null,1)))}setContainer(e,t){var i;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,(i=this.shadowRootHostElement)===null||i===void 0||i.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=t!==1,this.useShadowDOM=t===3,this.useShadowDOM){this.shadowRootHostElement=me(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const s=document.createElement("style");s.textContent=p4e,this.shadowRoot.appendChild(s),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(me("slot"))}else this.container.appendChild(this.view);const r=new ve;P_.BUBBLE_UP_EVENTS.forEach(s=>{r.add(dn(this.container,s,o=>{this.onDOMEvent(o,!1)}))}),P_.BUBBLE_DOWN_EVENTS.forEach(s=>{r.add(dn(this.container,s,o=>{this.onDOMEvent(o,!0)},!0))}),this.toDisposeOnSetContainer=r}}show(e){this.isVisible()&&this.hide(),Gn(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2500",this.view.style.position=this.useFixedPosition?"fixed":"absolute",Ss(this.view),this.toDisposeOnClean=e.render(this.view)||re.None,this.delegate=e,this.doLayout(),this.delegate.focus&&this.delegate.focus()}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Hu&&Gk.pointerEvents)){this.hide();return}this.delegate.layout&&this.delegate.layout(),this.doLayout()}}doLayout(){if(!this.isVisible())return;let e=this.delegate.getAnchor(),t;if(LQ(e)){let u=jn(e);t={top:u.top,left:u.left,width:u.width,height:u.height}}else t={top:e.y,left:e.x,width:e.width||1,height:e.height||2};const i=Lo(this.view),r=kM(this.view),s=this.delegate.anchorPosition||0,o=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;if(a===0){const u={offset:t.top-window.pageYOffset,size:t.height,position:s===0?0:1},d={offset:t.left,size:t.width,position:o===0?0:1,mode:fu.ALIGN};l=nm(window.innerHeight,r,u)+window.pageYOffset,zn.intersects({start:l,end:l+r},{start:u.offset,end:u.offset+u.size})&&(d.mode=fu.AVOID),c=nm(window.innerWidth,i,d)}else{const u={offset:t.left,size:t.width,position:o===0?0:1},d={offset:t.top,size:t.height,position:s===0?0:1,mode:fu.ALIGN};c=nm(window.innerWidth,i,u),zn.intersects({start:c,end:c+i},{start:u.offset,end:u.offset+u.size})&&(d.mode=fu.AVOID),l=nm(window.innerHeight,r,d)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(s===0?"bottom":"top"),this.view.classList.add(o===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const h=jn(this.container);this.view.style.top=`${l-(this.useFixedPosition?jn(this.view).top:h.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?jn(this.view).left:h.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t!=null&&t.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),Or(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!Yl(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}P_.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"];P_.BUBBLE_DOWN_EVENTS=["click"];let p4e=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	@font-face {
		font-family: "codicon";
		font-display: block;
		src: url("./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6") format("truetype");
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;function Ste(...n){return function(e,t){for(let i=0,r=n.length;i<r;i++){const s=n[i](e,t);if(s)return s}return null}}const Q5=m4e.bind(void 0,!0);function m4e(n,e,t){if(!t||t.length<e.length)return null;let i;return n?i=O3(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function _4e(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t===-1?null:[{start:t,end:t+n.length}]}function b4e(n,e){return FF(n.toLowerCase(),e.toLowerCase(),0,0)}function FF(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]===e[i]){let r=null;return(r=FF(n,e,t+1,i+1))?Ete({start:i,end:i+1},r):null}return FF(n,e,t,i+1)}function J5(n){return 97<=n&&n<=122}function ML(n){return 65<=n&&n<=90}function eB(n){return 48<=n&&n<=57}function v4e(n){return n===32||n===9||n===10||n===13}const w4e=new Set;"`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?".split("").forEach(n=>w4e.add(n.charCodeAt(0)));function xte(n){return J5(n)||ML(n)||eB(n)}function Ete(n,e){return e.length===0?e=[n]:n.end===e[0].start?e[0].start=n.start:e.unshift(n),e}function Dte(n,e){for(let t=e;t<n.length;t++){const i=n.charCodeAt(t);if(ML(i)||eB(i)||t>0&&!xte(n.charCodeAt(t-1)))return t}return n.length}function OF(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]!==e[i].toLowerCase())return null;{let r=null,s=i+1;for(r=OF(n,e,t+1,i+1);!r&&(s=Dte(e,s))<e.length;)r=OF(n,e,t+1,s),s++;return r===null?null:Ete({start:i,end:i+1},r)}}function y4e(n){let e=0,t=0,i=0,r=0,s=0;for(let h=0;h<n.length;h++)s=n.charCodeAt(h),ML(s)&&e++,J5(s)&&t++,xte(s)&&i++,eB(s)&&r++;const o=e/n.length,a=t/n.length,l=i/n.length,c=r/n.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function C4e(n){const{upperPercent:e,lowerPercent:t}=n;return t===0&&e>.6}function S4e(n){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:r}=n;return t>.2&&e<.8&&i>.6&&r<.2}function x4e(n){let e=0,t=0,i=0,r=0;for(let s=0;s<n.length;s++)i=n.charCodeAt(s),ML(i)&&e++,J5(i)&&t++,v4e(i)&&r++;return(e===0||t===0)&&r===0?n.length<=30:e<=5}function kte(n,e){if(!e||(e=e.trim(),e.length===0)||!x4e(n)||e.length>60)return null;const t=y4e(e);if(!S4e(t)){if(!C4e(t))return null;e=e.toLowerCase()}let i=null,r=0;for(n=n.toLowerCase();r<e.length&&(i=OF(n,e,0,r))===null;)r=Dte(e,r+1);return i}const E4e=Ste(Q5,kte,_4e),D4e=Ste(Q5,kte,b4e),wz=new W3(1e4);function yz(n,e,t=!1){if(typeof n!="string"||typeof e!="string")return null;let i=wz.get(n);i||(i=new RegExp(Lke(n),"i"),wz.set(n,i));const r=i.exec(e);return r?[{start:r.index,end:r.index+r[0].length}]:t?D4e(n,e):E4e(n,e)}function k4e(n,e,t,i,r,s){const o=Math.min(13,n.length);for(;t<o;t++){const a=Gw(n,e,t,i,r,s,!1);if(a)return a}return[0,s]}function tB(n){if(typeof n>"u")return[];const e=[],t=n[1];for(let i=n.length-1;i>1;i--){const r=n[i]+t,s=e[e.length-1];s&&s.end===r?s.end=r+1:e.push({start:r,end:r+1})}return e}const gu=128;function iB(){const n=[],e=[];for(let t=0;t<=gu;t++)e[t]=0;for(let t=0;t<=gu;t++)n.push(e.slice(0));return n}function Lte(n){const e=[];for(let t=0;t<=n;t++)e[t]=0;return e}const Ite=Lte(2*gu),PF=Lte(2*gu),Ac=iB(),Ld=iB(),FC=iB();function OC(n,e){if(e<0||e>=n.length)return!1;const t=n.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 40:case 91:return!0;case void 0:return!1;default:return!!Yb(t)}}function Cz(n,e){if(e<0||e>=n.length)return!1;switch(n.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function XS(n,e,t){return e[n]!==t[n]}function L4e(n,e,t,i,r,s,o=!1){for(;e<t&&r<s;)n[e]===i[r]&&(o&&(Ite[e]=r),e+=1),r+=1;return e===t}var Va;(function(n){n.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}n.isDefault=e})(Va||(Va={}));function Gw(n,e,t,i,r,s,o){const a=n.length>gu?gu:n.length,l=i.length>gu?gu:i.length;if(t>=a||s>=l||a-t>l-s||!L4e(e,t,a,r,s,l,!0))return;I4e(a,l,t,s,e,r);let c=1,h=1,u=t,d=s;const f=[!1];for(c=1,u=t;u<a;c++,u++){const _=Ite[u],w=PF[u],y=u+1<a?PF[u+1]:l;for(h=_-s+1,d=_;d<y;h++,d++){let S=Number.MIN_SAFE_INTEGER,k=!1;d<=w&&(S=T4e(n,e,u,t,i,r,d,l,s,Ac[c-1][h-1]===0,f));let C=0;S!==Number.MAX_SAFE_INTEGER&&(k=!0,C=S+Ld[c-1][h-1]);const D=d>_,E=D?Ld[c][h-1]+(Ac[c][h-1]>0?-5:0):0,N=d>_+1&&Ac[c][h-1]>0,T=N?Ld[c][h-2]+(Ac[c][h-2]>0?-5:0):0;if(N&&(!D||T>=E)&&(!k||T>=C))Ld[c][h]=T,FC[c][h]=3,Ac[c][h]=0;else if(D&&(!k||E>=C))Ld[c][h]=E,FC[c][h]=2,Ac[c][h]=0;else if(k)Ld[c][h]=C,FC[c][h]=1,Ac[c][h]=Ac[c-1][h-1]+1;else throw new Error("not possible")}}if(!f[0]&&!o)return;c--,h--;const g=[Ld[c][h],s];let p=0,m=0;for(;c>=1;){let _=h;do{const w=FC[c][_];if(w===3)_=_-2;else if(w===2)_=_-1;else break}while(_>=1);p>1&&e[t+c-1]===r[s+h-1]&&!XS(_+s-1,i,r)&&p+1>Ac[c][_]&&(_=h),_===h?p++:p=1,m||(m=_),c--,h=_-1,g.push(h)}l===a&&(g[0]+=2);const b=m-a;return g[0]-=b,g}function I4e(n,e,t,i,r,s){let o=n-1,a=e-1;for(;o>=t&&a>=i;)r[o]===s[a]&&(PF[o]=a,o--),a--}function T4e(n,e,t,i,r,s,o,a,l,c,h){if(e[t]!==s[o])return Number.MIN_SAFE_INTEGER;let u=1,d=!1;return o===t-i?u=n[t]===r[o]?7:5:XS(o,r,s)&&(o===0||!XS(o-1,r,s))?(u=n[t]===r[o]?7:5,d=!0):OC(s,o)&&(o===0||!OC(s,o-1))?u=5:(OC(s,o-1)||Cz(s,o-1))&&(u=5,d=!0),u>1&&t===i&&(h[0]=!0),d||(d=XS(o,r,s)||OC(s,o-1)||Cz(s,o-1)),t===i?o>l&&(u-=d?3:5):c?u+=d?2:0:u+=d?0:1,o+1===a&&(u-=d?3:5),u}function A4e(n,e,t,i,r,s,o){return N4e(n,e,t,i,r,s,!0,o)}function N4e(n,e,t,i,r,s,o,a){let l=Gw(n,e,t,i,r,s,a);if(l&&!o)return l;if(n.length>=3){const c=Math.min(7,n.length-1);for(let h=t+1;h<c;h++){const u=R4e(n,h);if(u){const d=Gw(u,u.toLowerCase(),t,i,r,s,a);d&&(d[0]-=3,(!l||d[0]>l[0])&&(l=d))}}}return l}function R4e(n,e){if(e+1>=n.length)return;const t=n[e],i=n[e+1];if(t!==i)return n.slice(0,e)+i+t+n.slice(e+2)}const Cv="$(",nB=new RegExp(`\\$\\(${ss.iconNameExpression}(?:${ss.iconModifierExpression})?\\)`,"g"),M4e=new RegExp(`(\\\\)?${nB.source}`,"g");function F4e(n){return n.replace(M4e,(e,t)=>t?e:`\\${e}`)}const O4e=new RegExp(`\\\\${nB.source}`,"g");function P4e(n){return n.replace(O4e,e=>`\\${e}`)}const B4e=new RegExp(`(\\s)?(\\\\)?${nB.source}(\\s)?`,"g");function V4e(n){return n.indexOf(Cv)===-1?n:n.replace(B4e,(e,t,i,r)=>i?e:t||r||"")}function PC(n){const e=n.indexOf(Cv);return e===-1?{text:n}:W4e(n,e)}function W4e(n,e){const t=[];let i="";function r(d){if(d){i+=d;for(const f of d)t.push(a)}}let s=-1,o="",a=0,l,c,h=e;const u=n.length;for(r(n.substr(0,e));h<u;){if(l=n[h],c=n[h+1],l===Cv[0]&&c===Cv[1])s=h,r(o),o=Cv,h++;else if(l===")"&&s!==-1){const d=h-s+1;a+=d,s=-1,o=""}else s!==-1?/^[a-z0-9\-]$/i.test(l)?o+=l:(r(o),s=-1,o=""):r(l);h++}return r(o),{text:i,iconOffsets:t}}function BC(n,e,t=!1){const{text:i,iconOffsets:r}=e;if(!r||r.length===0)return yz(n,i,t);const s=NQ(i," "),o=i.length-s.length,a=yz(n,s,t);if(a)for(const l of a){const c=r[l.start+o]+o;l.start+=c,l.end+=c}return a}const BF=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,hA=/(&amp;)?(&amp;)([^\s&])/g,Tte=ha("menu-selection",Ce.check),Ate=ha("menu-submenu",Ce.chevronRight);var yD;(function(n){n[n.Right=0]="Right",n[n.Left=1]="Left"})(yD||(yD={}));let Nte=class kb extends xh{constructor(e,t,i={}){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const r=document.createElement("div");r.classList.add("monaco-menu"),r.setAttribute("role","presentation"),super(r,{orientation:1,actionViewItemProvider:a=>this.doGetActionViewItem(a,i,s),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...wt||zr?[10]:[]],keyDown:!0}}),this.menuElement=r,this.actionsList.setAttribute("role","menu"),this.actionsList.tabIndex=0,this.menuDisposables=this._register(new ve),this.initializeStyleSheet(e),this._register(Rt.addTarget(r)),ae(r,Me.KEY_DOWN,a=>{new bi(a).equals(2)&&a.preventDefault()}),i.enableMnemonics&&this.menuDisposables.add(ae(r,Me.KEY_DOWN,a=>{const l=a.key.toLocaleLowerCase();if(this.mnemonics.has(l)){Ft.stop(a,!0);const c=this.mnemonics.get(l);if(c.length===1&&(c[0]instanceof Sz&&c[0].container&&this.focusItemByElement(c[0].container),c[0].onClick(a)),c.length>1){const h=c.shift();h&&h.container&&(this.focusItemByElement(h.container),c.push(h)),this.mnemonics.set(l,c)}}})),zr&&this._register(ae(r,Me.KEY_DOWN,a=>{const l=new bi(a);l.equals(14)||l.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),Ft.stop(a,!0)):(l.equals(13)||l.equals(12))&&(this.focusedItem=0,this.focusPrevious(),Ft.stop(a,!0))})),this._register(ae(this.domNode,Me.MOUSE_OUT,a=>{let l=a.relatedTarget;Yl(l,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),a.stopPropagation())})),this._register(ae(this.actionsList,Me.MOUSE_OVER,a=>{let l=a.target;if(!(!l||!Yl(l,this.actionsList)||l===this.actionsList)){for(;l.parentElement!==this.actionsList&&l.parentElement!==null;)l=l.parentElement;if(l.classList.contains("action-item")){const c=this.focusedItem;this.setFocusedItem(l),c!==this.focusedItem&&this.updateFocus()}}})),this._register(Rt.addTarget(this.actionsList)),this._register(ae(this.actionsList,Qt.Tap,a=>{let l=a.initialTarget;if(!(!l||!Yl(l,this.actionsList)||l===this.actionsList)){for(;l.parentElement!==this.actionsList&&l.parentElement!==null;)l=l.parentElement;if(l.classList.contains("action-item")){const c=this.focusedItem;this.setFocusedItem(l),c!==this.focusedItem&&this.updateFocus()}}}));let s={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new TL(r,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const o=this.scrollableElement.getDomNode();o.style.position="",this._register(ae(r,Qt.Change,a=>{Ft.stop(a,!0);const l=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:l-a.translationY})})),this._register(ae(o,Me.MOUSE_UP,a=>{a.preventDefault()})),r.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter(a=>{var l;return!((l=i.submenuIds)===null||l===void 0)&&l.has(a.id)?(console.warn(`Found submenu cycle: ${a.id}`),!1):!0}),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(a=>!(a instanceof uA)).forEach((a,l,c)=>{a.updatePositionInSet(l+1,c.length)})}initializeStyleSheet(e){R3(e)?(this.styleSheet=ho(e),this.styleSheet.textContent=xz):(kb.globalStyleSheet||(kb.globalStyleSheet=ho(),kb.globalStyleSheet.textContent=xz),this.styleSheet=kb.globalStyleSheet)}style(e){const t=this.getContainer(),i=e.foregroundColor?`${e.foregroundColor}`:"",r=e.backgroundColor?`${e.backgroundColor}`:"",s=e.borderColor?`1px solid ${e.borderColor}`:"",o=e.shadowColor?`0 2px 4px ${e.shadowColor}`:"";t.style.border=s,this.domNode.style.color=i,this.domNode.style.backgroundColor=r,t.style.boxShadow=o,this.viewItems&&this.viewItems.forEach(a=>{(a instanceof VF||a instanceof uA)&&a.style(e)})}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){let i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof Fa)return new uA(t.context,e,{icon:!0});if(e instanceof u5){const r=new Sz(e,e.actions,i,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}));if(t.enableMnemonics){const s=r.getMnemonic();if(s&&r.isEnabled()){let o=[];this.mnemonics.has(s)&&(o=this.mnemonics.get(s)),o.push(r),this.mnemonics.set(s,o)}}return r}else{const r={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const o=t.getKeyBinding(e);if(o){const a=o.getLabel();a&&(r.keybinding=a)}}const s=new VF(t.context,e,r);if(t.enableMnemonics){const o=s.getMnemonic();if(o&&s.isEnabled()){let a=[];this.mnemonics.has(o)&&(a=this.mnemonics.get(o)),a.push(s),this.mnemonics.set(o,a)}}return s}}};class VF extends Of{constructor(e,t,i={}){if(i.isMenu=!0,super(t,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){let r=this.getAction().label;if(r){let s=BF.exec(r);s&&(this.mnemonic=(s[1]?s[1]:s[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new yi(()=>{this.element&&(this._register(ae(this.element,Me.MOUSE_UP,r=>{if(Ft.stop(r,!0),$r){if(new oo(r).rightButton)return;this.onClick(r)}else setTimeout(()=>{this.onClick(r)},0)})),this._register(ae(this.element,Me.CONTEXT_MENU,r=>{Ft.stop(r,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=le(this.element,me("a.action-menu-item")),this._action.id===Fa.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=le(this.item,me("span.menu-item-check"+Tte.cssSelector)),this.check.setAttribute("role","none"),this.label=le(this.item,me("span.action-label")),this.options.label&&this.options.keybinding&&(le(this.item,me("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item&&this.item.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){if(this.label&&this.options.label){Gn(this.label);let e=V4e(this.getAction().label);if(e){const t=$4e(e);this.options.enableMnemonics||(e=t),this.label.setAttribute("aria-label",t.replace(/&&/g,"&"));const i=BF.exec(e);if(i){e=M3(e),hA.lastIndex=0;let r=hA.exec(e);for(;r&&r[1];)r=hA.exec(e);const s=o=>o.replace(/&amp;&amp;/g,"&amp;");r?this.label.append(NQ(s(e.substr(0,r.index))," "),me("u",{"aria-hidden":"true"},r[3]),kke(s(e.substr(r.index+r[0].length))," ")):this.label.innerText=s(e).trim(),this.item&&this.item.setAttribute("aria-keyshortcuts",(i[1]?i[1]:i[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){let e=null;this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=v({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e&&this.item&&(this.item.title=e)}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.getAction().class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.getAction().enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.getAction().checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){if(!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,r=e&&this.menuStyle.selectionBorderColor?`thin solid ${this.menuStyle.selectionBorderColor}`:"";this.item&&(this.item.style.color=t?t.toString():"",this.item.style.backgroundColor=i?i.toString():""),this.check&&(this.check.style.color=t?t.toString():""),this.container&&(this.container.style.border=r)}style(e){this.menuStyle=e,this.applyStyle()}}class Sz extends VF{constructor(e,t,i,r){super(e,e,r),this.submenuActions=t,this.parentData=i,this.submenuOptions=r,this.mysubmenu=null,this.submenuDisposables=this._register(new ve),this.mouseOver=!1,this.expandDirection=r&&r.expandDirection!==void 0?r.expandDirection:yD.Right,this.showScheduler=new yi(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new yi(()=>{this.element&&!Yl(xm(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=le(this.item,me("span.submenu-indicator"+Ate.cssSelector)),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(ae(this.element,Me.KEY_UP,t=>{let i=new bi(t);(i.equals(17)||i.equals(3))&&(Ft.stop(t,!0),this.createSubmenu(!0))})),this._register(ae(this.element,Me.KEY_DOWN,t=>{let i=new bi(t);xm()===this.item&&(i.equals(17)||i.equals(3))&&Ft.stop(t,!0)})),this._register(ae(this.element,Me.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(ae(this.element,Me.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(ae(this.element,Me.FOCUS_OUT,t=>{this.element&&!Yl(xm(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!1)})))}updateEnabled(){}onClick(e){Ft.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,r){const s={top:0,left:0};return s.left=nm(e.width,t.width,{position:r===yD.Right?0:1,offset:i.left,size:i.width}),s.left>=i.left&&s.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(s.left=i.left+10),i.top+=10,i.height=0),s.top=nm(e.height,t.height,{position:0,offset:i.top,size:0}),s.top+t.height===i.top&&s.top+i.height+t.height<=e.height&&(s.top+=i.height),s}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=le(this.element,me("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Nte(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new bL],this.submenuOptions),this.menuStyle&&this.parentData.submenu.style(this.menuStyle);const r=this.element.getBoundingClientRect(),s={top:r.top-i,left:r.left,height:r.height+2*i,width:r.width},o=this.submenuContainer.getBoundingClientRect(),{top:a,left:l}=this.calculateSubmenuMenuLayout(new Gt(window.innerWidth,window.innerHeight),Gt.lift(o),s,this.expandDirection);this.submenuContainer.style.left=`${l-o.left}px`,this.submenuContainer.style.top=`${a-o.top}px`,this.submenuDisposables.add(ae(this.submenuContainer,Me.KEY_UP,c=>{new bi(c).equals(15)&&(Ft.stop(c,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(ae(this.submenuContainer,Me.KEY_DOWN,c=>{new bi(c).equals(15)&&Ft.stop(c,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&((t=this.item)===null||t===void 0||t.setAttribute("aria-expanded",e))}applyStyle(){if(super.applyStyle(),!this.menuStyle)return;const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t?`${t}`:""),this.parentData.submenu&&this.parentData.submenu.style(this.menuStyle)}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class uA extends G5{style(e){this.label&&(this.label.style.borderBottomColor=e.separatorColor?`${e.separatorColor}`:"")}}function $4e(n){const e=BF,t=e.exec(n);if(!t)return n;const i=!t[1];return n.replace(e,i?"$2$3":"").trim()}let xz=`
.monaco-menu {
	font-size: 13px;

}

${vz(Tte)}
${vz(Ate)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar.animated .action-item.active {
	transform: scale(1.272019649, 1.272019649); /* 1.272019649 =  */
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	opacity: 0.4;
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid #bbb;
	padding-top: 1px;
	margin-left: .8em;
	margin-right: .8em;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	padding: 0.5em 0 0 0;
	margin-bottom: 0.5em;
	width: 100%;
	height: 0px !important;
	margin-left: .8em !important;
	margin-right: .8em !important;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	border: thin solid transparent; /* prevents jumping behaviour on hover or focus */
}


/* High Contrast Theming */
:host-context(.hc-black) .context-view.monaco-menu-container {
	box-shadow: none;
}

:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: .5em 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 1.8em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	padding: 0.2em 0 0 0;
	margin-bottom: 0.2em;
}

:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}

/* Arrows */
.monaco-scrollable-element > .scrollbar > .scra {
	cursor: pointer;
	font-size: 11px !important;
}

.monaco-scrollable-element > .visible {
	opacity: 1;

	/* Background rule added for IE9 - to allow clicks on dom node */
	background:rgba(0,0,0,0);

	transition: opacity 100ms linear;
}
.monaco-scrollable-element > .invisible {
	opacity: 0;
	pointer-events: none;
}
.monaco-scrollable-element > .invisible.fade {
	transition: opacity 800ms linear;
}

/* Scrollable Content Inset Shadow */
.monaco-scrollable-element > .shadow {
	position: absolute;
	display: none;
}
.monaco-scrollable-element > .shadow.top {
	display: block;
	top: 0;
	left: 3px;
	height: 3px;
	width: 100%;
	box-shadow: #DDD 0 6px 6px -6px inset;
}
.monaco-scrollable-element > .shadow.left {
	display: block;
	top: 3px;
	left: 0;
	height: 100%;
	width: 3px;
	box-shadow: #DDD 6px 0 6px -6px inset;
}
.monaco-scrollable-element > .shadow.top-left-corner {
	display: block;
	top: 0;
	left: 0;
	height: 3px;
	width: 3px;
}
.monaco-scrollable-element > .shadow.top.left {
	box-shadow: #DDD 6px 6px 6px -6px inset;
}

/* ---------- Default Style ---------- */

:host-context(.vs) .monaco-scrollable-element > .scrollbar > .slider {
	background: rgba(100, 100, 100, .4);
}
:host-context(.vs-dark) .monaco-scrollable-element > .scrollbar > .slider {
	background: rgba(121, 121, 121, .4);
}
:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider {
	background: rgba(111, 195, 223, .6);
}

.monaco-scrollable-element > .scrollbar > .slider:hover {
	background: rgba(100, 100, 100, .7);
}
:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider:hover {
	background: rgba(111, 195, 223, .8);
}

.monaco-scrollable-element > .scrollbar > .slider.active {
	background: rgba(0, 0, 0, .6);
}
:host-context(.vs-dark) .monaco-scrollable-element > .scrollbar > .slider.active {
	background: rgba(191, 191, 191, .4);
}
:host-context(.hc-black) .monaco-scrollable-element > .scrollbar > .slider.active {
	background: rgba(111, 195, 223, 1);
}

:host-context(.vs-dark) .monaco-scrollable-element .shadow.top {
	box-shadow: none;
}

:host-context(.vs-dark) .monaco-scrollable-element .shadow.left {
	box-shadow: #000 6px 0 6px -6px inset;
}

:host-context(.vs-dark) .monaco-scrollable-element .shadow.top.left {
	box-shadow: #000 6px 6px 6px -6px inset;
}

:host-context(.hc-black) .monaco-scrollable-element .shadow.top {
	box-shadow: none;
}

:host-context(.hc-black) .monaco-scrollable-element .shadow.left {
	box-shadow: none;
}

:host-context(.hc-black) .monaco-scrollable-element .shadow.top.left {
	box-shadow: none;
}
`;function wa(n,e){const t=Object.create(null);for(let i in e){const r=e[i];r&&(t[i]=Pc(r,n))}return t}function rB(n,e,t){function i(){const r=wa(n.getColorTheme(),e);typeof t=="function"?t(r):t.style(r)}return i(),n.onDidColorThemeChange(i)}function z4e(n,e,t){return rB(e,{badgeBackground:(t==null?void 0:t.badgeBackground)||uv,badgeForeground:(t==null?void 0:t.badgeForeground)||dv,badgeBorder:Ki},n)}function pg(n,e,t){return rB(e,Object.assign(Object.assign({},FL),t||{}),n)}const FL={listFocusBackground:VNe,listFocusForeground:WNe,listFocusOutline:$Ne,listActiveSelectionBackground:Tu,listActiveSelectionForeground:Au,listActiveSelectionIconForeground:HS,listFocusAndSelectionBackground:Tu,listFocusAndSelectionForeground:Au,listInactiveSelectionBackground:zNe,listInactiveSelectionIconForeground:UNe,listInactiveSelectionForeground:HNe,listInactiveFocusBackground:jNe,listInactiveFocusOutline:qNe,listHoverBackground:GNe,listHoverForeground:KNe,listDropBackground:ZNe,listSelectionOutline:Ur,listHoverOutline:Ur,listFilterWidgetBackground:YNe,listFilterWidgetOutline:XNe,listFilterWidgetNoMatchesOutline:QNe,listMatchesShadow:T_,treeIndentGuidesStroke:JNe,tableColumnsBorder:eRe},H4e={shadowColor:T_,borderColor:tRe,foregroundColor:iRe,backgroundColor:nRe,selectionForegroundColor:rRe,selectionBackgroundColor:sRe,selectionBorderColor:oRe,separatorColor:aRe};function U4e(n,e,t){return rB(e,Object.assign(Object.assign({},H4e),t),n)}class j4e{constructor(e,t,i,r,s){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=r,this.themeService=s,this.focusToReturn=null,this.block=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=document.activeElement;let i,r=LQ(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:s=>{let o=e.getMenuClassName?e.getMenuClassName():"";o&&(s.className+=" "+o),this.options.blockMouse&&(this.block=s.appendChild(me(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",ae(this.block,Me.MOUSE_DOWN,c=>c.stopPropagation()));const a=new ve,l=e.actionRunner||new D_;return l.onBeforeRun(this.onActionRun,this,a),l.onDidRun(this.onDidActionRun,this,a),i=new Nte(s,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:c=>this.keybindingService.lookupKeybinding(c.id)}),a.add(U4e(i,this.themeService)),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a),a.add(ae(window,Me.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(ae(window,Me.MOUSE_DOWN,c=>{if(c.defaultPrevented)return;let h=new oo(c),u=h.target;if(!h.rightButton){for(;u;){if(u===s)return;u=u.parentElement}this.contextViewService.hideContextView(!0)}})),Cu(a,i)},focus:()=>{i&&i.focus(!!e.autoSelectFirstItem)},onHide:s=>{e.onHide&&e.onHide(!!s),this.block&&(this.block.remove(),this.block=null),this.focusToReturn&&this.focusToReturn.focus()}},r,!!r)}onActionRun(e){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1),this.focusToReturn&&this.focusToReturn.focus()}onDidActionRun(e){e.error&&!gd(e.error)&&this.notificationService.error(e.error)}}var q4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},nb=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let WF=class extends re{constructor(e,t,i,r,s){super(),this.contextMenuHandler=new j4e(i,e,t,r,s)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){this.contextMenuHandler.showContextMenu(e),cf.getInstance().resetKeyStatus()}};WF=q4e([nb(0,y0),nb(1,Qn),nb(2,qg),nb(3,Yi),nb(4,fi)],WF);const OL=Dt("layoutService");var G4e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},K4e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let $F=class extends re{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=re.None,this.container=e.container,this.contextView=this._register(new P_(this.container,1)),this.layout(),this._register(e.onDidLayout(()=>this.layout()))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,i){t?t!==this.container&&(this.container=t,this.setContainer(t,i?3:2)):this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.contextView.show(e);const r=Et(()=>{this.currentViewDisposable===r&&this.hideContextView()});return this.currentViewDisposable=r,r}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};$F=G4e([K4e(0,OL)],$F);const Rte=Dt("dialogService");let Z4e=class{constructor(e){this.incoming=new Map,this.outgoing=new Map,this.data=e}};class Y4e{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(let t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);i.outgoing.set(this._hashFn(t),r),r.incoming.set(this._hashFn(e),i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(let i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new Z4e(e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[t,i]of this._nodes)e.push(`${t}, (incoming)[${[...i.incoming.keys()].join(", ")}], (outgoing)[${[...i.outgoing.keys()].join(",")}]`);return e.join(`
`)}findCycleSlow(){for(let[e,t]of this._nodes){const i=new Set([e]),r=this._findCycle(t,i);if(r)return r}}_findCycle(e,t){for(let[i,r]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(r,t);if(s)return s;t.delete(i)}}}class Ez extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=(t=e.findCycleSlow())!==null&&t!==void 0?t:`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class CD{constructor(e=new $w,t=!1,i){this._activeInstantiations=new Set,this._services=e,this._strict=t,this._parent=i,this._services.set(Kt,this)}createChild(e){return new CD(e,this._strict,this)}invokeFunction(e,...t){let i=Po.traceInvocation(e),r=!1;try{return e({get:(o,a)=>{if(r)throw yDe("service accessor is only valid during the invocation of its target method");const l=this._getOrCreateServiceInstance(o,i);if(!l&&a!==jDe)throw new Error(`[invokeFunction] unknown service '${o}'`);return l}},...t)}finally{r=!0,i.stop()}}createInstance(e,...t){let i,r;return e instanceof Qh?(i=Po.traceCreation(e.ctor),r=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Po.traceCreation(e),r=this._createInstance(e,t,i)),i.stop(),r}_createInstance(e,t=[],i){let r=Ia.getServiceDependencies(e).sort((a,l)=>a.index-l.index),s=[];for(const a of r){let l=this._getOrCreateServiceInstance(a.id,i);if(!l&&this._strict&&!a.optional)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`);s.push(l)}let o=r.length>0?r[0].index:t.length;if(t.length!==o){console.warn(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);let a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return new e(...t,...s)}_setServiceInstance(e,t){if(this._services.get(e)instanceof Qh)this._services.set(e,t);else if(this._parent)this._parent._setServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){let i=this._getServiceInstanceOrDescriptor(e);return i instanceof Qh?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const r=new Y4e(a=>a.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}];for(;o.length;){const a=o.pop();if(r.lookupOrInsertNode(a),s++>1e3)throw new Ez(r);for(let l of Ia.getServiceDependencies(a.desc.ctor)){let c=this._getServiceInstanceOrDescriptor(l.id);if(!c&&!l.optional&&console.warn(`[createInstance] ${e} depends on ${l.id} which is NOT registered.`),c instanceof Qh){const h={id:l.id,desc:c,_trace:a._trace.branch(l.id,!0)};r.insertEdge(a,h),o.push(h)}}}for(;;){const a=r.roots();if(a.length===0){if(!r.isEmpty())throw new Ez(r);break}for(const{data:l}of a){if(this._getServiceInstanceOrDescriptor(l.id)instanceof Qh){const h=this._createServiceInstanceWithOwner(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this._setServiceInstance(l.id,h)}r.removeNode(l)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],r,s){if(this._services.get(e)instanceof Qh)return this._createServiceInstance(t,i,r,s);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,r,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t=[],i,r){if(i){const s=new Zb(()=>this._createInstance(e,t,r));return new Proxy(Object.create(null),{get(o,a){if(a in o)return o[a];let l=s.value,c=l[a];return typeof c!="function"||(c=c.bind(l),o[a]=c),c},set(o,a,l){return s.value[a]=l,!0}})}else return this._createInstance(e,t,r)}}class Po{constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}static traceInvocation(e){return Po._None}static traceCreation(e){return Po._None}branch(e,t){let i=new Po(2,e.toString());return this._dep.push([e,t,i]),i}stop(){let e=Date.now()-this._start;Po._totals+=e;let t=!1;function i(s,o){let a=[],l=new Array(s+1).join("	");for(const[c,h,u]of o._dep)if(h&&u){t=!0,a.push(`${l}CREATES -> ${c}`);let d=i(s+1,u);d&&a.push(d)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}let r=[`${this.type===0?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${Po._totals.toFixed(2)}ms)`];(e>2||t)&&console.log(r.join(`
`))}}Po._None=new class extends Po{constructor(){super(-1,null)}stop(){}branch(){return this}};Po._totals=0;const Sy=Dt("labelService");class X4e{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(r=>r.splice(e,t,i))}}class Id extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function Dz(n,e){const t=[];for(let i of e){if(n.start>=i.range.end)continue;if(n.end<i.range.start)break;const r=zn.intersect(n,i.range);zn.isEmpty(r)||t.push({range:r,size:i.size})}return t}function zF({start:n,end:e},t){return{start:n+t,end:e+t}}function Q4e(n){const e=[];let t=null;for(let i of n){const r=i.range.start,s=i.range.end,o=i.size;if(t&&o===t.size){t.range.end=s;continue}t={range:{start:r,end:s},size:o},e.push(t)}return e}function J4e(...n){return Q4e(n.reduce((e,t)=>e.concat(t),[]))}class kz{constructor(){this.groups=[],this._size=0}splice(e,t,i=[]){const r=i.length-t,s=Dz({start:0,end:e},this.groups),o=Dz({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:zF(l.range,r),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=J4e(s,a,o),this._size=this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;let t=0,i=0;for(let r of this.groups){const s=r.range.end-r.range.start,o=i+s*r.size;if(e<o)return t+Math.floor((e-i)/r.size);t+=s,i=o}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(let r of this.groups){const s=r.range.end-r.range.start,o=i+s;if(e<o)return t+(e-i)*r.size;t+=s*r.size,i=o}return-1}}function e3e(n){try{n.parentElement&&n.parentElement.removeChild(n)}catch{}}class t3e{constructor(e){this.renderers=e,this.cache=new Map}alloc(e){let t=this.getTemplateCache(e).pop();if(!t){const i=me(".monaco-list-row"),s=this.getRenderer(e).renderTemplate(i);t={domNode:i,templateId:e,templateData:s}}return t}release(e){e&&this.releaseRow(e)}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(t.classList.remove("scrolling"),e3e(t)),this.getTemplateCache(i).push(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var Zg=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};const ml={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(n){return[n]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class xy{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class i3e{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class n3e{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function r3e(n,e){return Array.isArray(n)&&Array.isArray(e)?ec(n,e):n===e}class s3e{constructor(e){e!=null&&e.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,r)=>r,e!=null&&e.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e!=null&&e.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e!=null&&e.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}class ol{constructor(e,t,i,r=ml){if(this.virtualDelegate=t,this.domId=`list_id_${++ol.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new p0(50),this.splicing=!1,this.dragOverAnimationStopDisposable=re.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=re.None,this.onDragLeaveTimeout=re.None,this.disposables=new ve,this._onDidChangeContentHeight=new H,this._horizontalScrolling=!1,r.horizontalScrolling&&r.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new kz;for(const o of i)this.renderers.set(o.templateId,o);this.cache=this.disposables.add(new t3e(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof r.mouseSupport=="boolean"?r.mouseSupport:!0),this._horizontalScrolling=pl(r,o=>o.horizontalScrolling,ml.horizontalScrolling),this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.additionalScrollHeight=typeof r.additionalScrollHeight>"u"?0:r.additionalScrollHeight,this.accessibilityProvider=new s3e(r.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",pl(r,o=>o.transformOptimization,ml.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)"),this.disposables.add(Rt.addTarget(this.rowsContainer)),this.scrollable=new IL(pl(r,o=>o.smoothScrolling,!1)?125:0,o=>ic(o)),this.scrollableElement=this.disposables.add(new O5(this.rowsContainer,{alwaysConsumeMouseWheel:pl(r,o=>o.alwaysConsumeMouseWheel,ml.alwaysConsumeMouseWheel),horizontal:1,vertical:pl(r,o=>o.verticalScrollMode,ml.verticalScrollMode),useShadows:pl(r,o=>o.useShadows,ml.useShadows),mouseWheelScrollSensitivity:r.mouseWheelScrollSensitivity,fastScrollSensitivity:r.fastScrollSensitivity},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(ae(this.rowsContainer,Qt.Change,o=>this.onTouchChange(o))),this.disposables.add(ae(this.scrollableElement.getDomNode(),"scroll",o=>o.target.scrollTop=0)),this.disposables.add(ae(this.domNode,"dragover",o=>this.onDragOver(this.toDragEvent(o)))),this.disposables.add(ae(this.domNode,"drop",o=>this.onDrop(this.toDragEvent(o)))),this.disposables.add(ae(this.domNode,"dragleave",o=>this.onDragLeave(this.toDragEvent(o)))),this.disposables.add(ae(this.domNode,"dragend",o=>this.onDragEnd(o))),this.setRowLineHeight=pl(r,o=>o.setRowLineHeight,ml.setRowLineHeight),this.setRowHeight=pl(r,o=>o.setRowHeight,ml.setRowHeight),this.supportDynamicHeights=pl(r,o=>o.supportDynamicHeights,ml.supportDynamicHeights),this.dnd=pl(r,o=>o.dnd,ml.dnd),this.layout()}get contentHeight(){return this.rangeMap.size}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:iT(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){e.additionalScrollHeight!==void 0&&(this.additionalScrollHeight=e.additionalScrollHeight,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling),e.mouseWheelScrollSensitivity!==void 0&&this.scrollableElement.updateOptions({mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&this.scrollableElement.updateOptions({fastScrollSensitivity:e.fastScrollSensitivity})}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const r=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s={start:e,end:e+t},o=zn.intersect(r,s),a=new Map;for(let k=o.start;k<o.end;k++){const C=this.items[k];if(C.dragStartDisposable.dispose(),C.row){let D=a.get(C.templateId);D||(D=[],a.set(C.templateId,D));const E=this.renderers.get(C.templateId);E&&E.disposeElement&&E.disposeElement(C.element,k,C.row.templateData,C.size),D.push(C.row)}C.row=null}const l={start:e+t,end:this.items.length},c=zn.intersect(l,r),h=zn.relativeComplement(l,r),u=i.map(k=>({id:String(this.itemId++),element:k,templateId:this.virtualDelegate.getTemplateId(k),size:this.virtualDelegate.getHeight(k),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(k),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:re.None}));let d;e===0&&t>=this.items.length?(this.rangeMap=new kz,this.rangeMap.splice(0,0,u),d=this.items,this.items=u):(this.rangeMap.splice(e,t,u),d=this.items.splice(e,t,...u));const f=i.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),p=zF(c,f),m=zn.intersect(g,p);for(let k=m.start;k<m.end;k++)this.updateItemInDOM(this.items[k],k);const b=zn.relativeComplement(p,g);for(const k of b)for(let C=k.start;C<k.end;C++)this.removeItemFromDOM(C);const _=h.map(k=>zF(k,f)),y=[{start:e,end:e+i.length},..._].map(k=>zn.intersect(g,k)),S=this.getNextToLastElement(y);for(const k of y)for(let C=k.start;C<k.end;C++){const D=this.items[C],E=a.get(D.templateId),N=E==null?void 0:E.pop();this.insertItemInDOM(C,S,N)}for(const k of a.values())for(const C of k)this.cache.release(C);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),d.map(k=>k.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=ic(()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10})}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let i={height:typeof e=="number"?e:mke(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:iT(this.domNode)})}render(e,t,i,r,s,o=!1){const a=this.getRenderRange(t,i),l=zn.relativeComplement(a,e),c=zn.relativeComplement(e,a),h=this.getNextToLastElement(l);if(o){const u=zn.intersect(e,a);for(let d=u.start;d<u.end;d++)this.updateItemInDOM(this.items[d],d)}for(const u of l)for(let d=u.start;d<u.end;d++)this.insertItemInDOM(d,h);for(const u of c)for(let d=u.start;d<u.end;d++)this.removeItemFromDOM(d);r!==void 0&&(this.rowsContainer.style.left=`-${r}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&s!==void 0&&(this.rowsContainer.style.width=`${Math.max(s,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t,i){const r=this.items[e];r.row||(r.row=i??this.cache.alloc(r.templateId));const s=this.accessibilityProvider.getRole(r.element)||"listitem";r.row.domNode.setAttribute("role",s);const o=this.accessibilityProvider.isChecked(r.element);typeof o<"u"&&r.row.domNode.setAttribute("aria-checked",String(!!o)),r.row.domNode.parentElement||(t?this.rowsContainer.insertBefore(r.row.domNode,t):this.rowsContainer.appendChild(r.row.domNode)),this.updateItemInDOM(r,e);const a=this.renderers.get(r.templateId);if(!a)throw new Error(`No renderer found for template id ${r.templateId}`);a&&a.renderElement(r.element,e,r.row.templateData,r.size);const l=this.dnd.getDragURI(r.element);r.dragStartDisposable.dispose(),r.row.domNode.draggable=!!l,l&&(r.dragStartDisposable=ae(r.row.domNode,"dragstart",c=>this.onDragStart(r.element,l,c))),this.horizontalScrolling&&(this.measureItemWidth(r),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width=$r?"-moz-fit-content":"fit-content",e.width=iT(e.row.domNode);const t=window.getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.additionalScrollHeight}get onMouseClick(){return Re.map(this.disposables.add(new qt(this.domNode,"click")).event,e=>this.toMouseEvent(e))}get onMouseDblClick(){return Re.map(this.disposables.add(new qt(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e))}get onMouseMiddleClick(){return Re.filter(Re.map(this.disposables.add(new qt(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e)),e=>e.browserEvent.button===1)}get onMouseDown(){return Re.map(this.disposables.add(new qt(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e))}get onContextMenu(){return Re.any(Re.map(this.disposables.add(new qt(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e)),Re.map(this.disposables.add(new qt(this.domNode,Qt.Contextmenu)).event,e=>this.toGestureEvent(e)))}get onTouchStart(){return Re.map(this.disposables.add(new qt(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e))}get onTap(){return Re.map(this.disposables.add(new qt(this.rowsContainer,Qt.Tap)).event,e=>this.toGestureEvent(e))}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],r=i&&i.element;return{browserEvent:e,index:t,element:r}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],r=i&&i.element;return{browserEvent:e,index:t,element:r}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],r=i&&i.element;return{browserEvent:e,index:t,element:r}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],r=i&&i.element;return{browserEvent:e,index:t,element:r}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){if(!i.dataTransfer)return;const r=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(ste.TEXT,t),i.dataTransfer.setDragImage){let s;this.dnd.getDragLabel&&(s=this.dnd.getDragLabel(r,i)),typeof s>"u"&&(s=String(r.length));const o=me(".monaco-drag-image");o.textContent=s,document.body.appendChild(o),i.dataTransfer.setDragImage(o,-10,-10),setTimeout(()=>document.body.removeChild(o),0)}this.currentDragData=new xy(r),Bc.CurrentDragAndDropData=new i3e(r),this.dnd.onDragStart&&this.dnd.onDragStart(this.currentDragData,i)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),Bc.CurrentDragAndDropData&&Bc.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(Bc.CurrentDragAndDropData)this.currentDragData=Bc.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new n3e}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect===0?"copy":"move";let i;if(typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=ME(i).filter(r=>r>=-1&&r<this.length).sort((r,s)=>r-s),i=i[0]===-1?[-1]:i,r3e(this.currentDragFeedback,i))return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=Et(()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")});else{for(const r of i){const s=this.items[r];s.dropTarget=!0,s.row&&s.row.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=Et(()=>{for(const r of i){const s=this.items[r];s.dropTarget=!1,s.row&&s.row.domNode.classList.remove("drop-target")}})}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=b_(()=>this.clearDragOverFeedback(),100),this.currentDragData&&((i=(t=this.dnd).onDragLeave)===null||i===void 0||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,Bc.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,Bc.CurrentDragAndDropData=void 0,this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=re.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=xQ(this.domNode).top;this.dragOverAnimationDisposable=xke(this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=b_(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;i instanceof HTMLElement&&i!==this.rowsContainer&&t.contains(i);){const r=i.getAttribute("data-index");if(r){const s=Number(r);if(!isNaN(s))return s}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const r=this.getRenderRange(e,t);let s,o;e===this.elementTop(r.start)?(s=r.start,o=0):r.end-r.start>1&&(s=r.start+1,o=this.elementTop(s)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let h=l.start;h<l.end;h++){const u=this.probeDynamicHeight(h);u!==0&&this.rangeMap.splice(h,1,[this.items[h]]),a+=u,c=c||u!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const h=zn.relativeComplement(r,l);for(const d of h)for(let f=d.start;f<d.end;f++)this.items[f].row&&this.removeItemFromDOM(f);const u=zn.relativeComplement(l,r);for(const d of u)for(let f=d.start;f<d.end;f++){const g=f+1,p=g<this.items.length?this.items[g].row:null,m=p?p.domNode:null;this.insertItemInDOM(f,m)}for(let d=l.start;d<l.end;d++)this.items[d].row&&this.updateItemInDOM(this.items[d],d);if(typeof s=="number"){const d=this.scrollable.getFutureScrollPosition().scrollTop-e,f=this.elementTop(s)-o+d;this.setScrollTop(f,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const o=this.virtualDelegate.getDynamicHeight(t.element);if(o!==null){const a=t.size;return t.size=o,t.lastDynamicHeightWidth=this.renderWidth,o-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(!this.setRowHeight&&t.row){let o=t.row.domNode.offsetHeight;return t.size=o,t.lastDynamicHeightWidth=this.renderWidth,o-i}const r=this.cache.alloc(t.templateId);r.domNode.style.height="",this.rowsContainer.appendChild(r.domNode);const s=this.renderers.get(t.templateId);return s&&(s.renderElement(t.element,e,r.templateData,void 0),s.disposeElement&&s.disposeElement(t.element,e,r.templateData,void 0)),t.size=r.domNode.offsetHeight,this.virtualDelegate.setDynamicHeight&&this.virtualDelegate.setDynamicHeight(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(r.domNode),this.cache.release(r),t.size-i}getNextToLastElement(e){const t=e[e.length-1];if(!t)return null;const i=this.items[t.end];return!i||!i.row?null:i.row.domNode}getElementDomId(e){return`${this.domId}_${e}`}dispose(){if(this.items){for(const e of this.items)if(e.row){const t=this.renderers.get(e.row.templateId);t&&(t.disposeElement&&t.disposeElement(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[]}this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),mt(this.disposables)}}ol.InstanceCount=0;Zg([an],ol.prototype,"onMouseClick",null);Zg([an],ol.prototype,"onMouseDblClick",null);Zg([an],ol.prototype,"onMouseMiddleClick",null);Zg([an],ol.prototype,"onMouseDown",null);Zg([an],ol.prototype,"onContextMenu",null);Zg([an],ol.prototype,"onTouchStart",null);Zg([an],ol.prototype,"onTap",null);var Yg=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Lz=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class o3e{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.trait}`}renderTemplate(e){return e}renderElement(e,t,i){const r=this.renderedElements.findIndex(s=>s.templateData===i);if(r>=0){const s=this.renderedElements[r];this.trait.unrender(i),s.index=t}else{const s={index:t,templateData:i};this.renderedElements.push(s)}this.trait.renderIndex(t,i)}splice(e,t,i){const r=[];for(const s of this.renderedElements)s.index<e?r.push(s):s.index>=e+t&&r.push({index:s.index+i-t,templateData:s.templateData});this.renderedElements=r}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let SD=class{constructor(e){this._trait=e,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new H,this.onChange=this._onChange.event}get trait(){return this._trait}get renderer(){return new o3e(this)}splice(e,t,i){var r;t=Math.max(0,Math.min(t,this.length-e));const s=i.length-t,o=e+t,a=[...this.sortedIndexes.filter(c=>c<e),...i.map((c,h)=>c?h+e:-1).filter(c=>c!==-1),...this.sortedIndexes.filter(c=>c>=o).map(c=>c+s)],l=this.length+s;if(this.sortedIndexes.length>0&&a.length===0&&l>0){const c=(r=this.sortedIndexes.find(h=>h>=e))!==null&&r!==void 0?r:l-1;a.push(Math.min(c,l-1))}this.renderer.splice(e,t,i.length),this._set(a,a),this.length=l}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(Tz),t)}_set(e,t,i){const r=this.indexes,s=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const o=HF(s,e);return this.renderer.renderIndexes(o),this._onChange.fire({indexes:e,browserEvent:i}),r}get(){return this.indexes}contains(e){return X3(this.sortedIndexes,e,Tz)>=0}dispose(){mt(this._onChange)}};Yg([an],SD.prototype,"renderer",null);class a3e extends SD{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class dA{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,i.map(()=>!1));const r=this.trait.get().map(o=>this.identityProvider.getId(this.view.element(o)).toString()),s=i.map(o=>r.indexOf(this.identityProvider.getId(o).toString())>-1);this.trait.splice(e,t,s)}}function Ju(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"}function rm(n){return n.classList.contains("monaco-editor")?!0:n.classList.contains("monaco-list")||!n.parentElement?!1:rm(n.parentElement)}class Mte{constructor(e,t,i){this.list=e,this.view=t,this.disposables=new ve,this.multipleSelectionDisposables=new ve,this.onKeyDown.filter(r=>r.keyCode===3).on(this.onEnter,this,this.disposables),this.onKeyDown.filter(r=>r.keyCode===16).on(this.onUpArrow,this,this.disposables),this.onKeyDown.filter(r=>r.keyCode===18).on(this.onDownArrow,this,this.disposables),this.onKeyDown.filter(r=>r.keyCode===11).on(this.onPageUpArrow,this,this.disposables),this.onKeyDown.filter(r=>r.keyCode===12).on(this.onPageDownArrow,this,this.disposables),this.onKeyDown.filter(r=>r.keyCode===9).on(this.onEscape,this,this.disposables),i.multipleSelectionSupport!==!1&&this.onKeyDown.filter(r=>(wt?r.metaKey:r.ctrlKey)&&r.keyCode===31).on(this.onCtrlA,this,this.multipleSelectionDisposables)}get onKeyDown(){return Re.chain(this.disposables.add(new qt(this.view.domNode,"keydown")).event).filter(e=>!Ju(e.target)).map(e=>new bi(e))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionDisposables.clear(),e.multipleSelectionSupport&&this.onKeyDown.filter(t=>(wt?t.metaKey:t.ctrlKey)&&t.keyCode===31).on(this.onCtrlA,this,this.multipleSelectionDisposables))}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(mr(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}Yg([an],Mte.prototype,"onKeyDown",null);var sm;(function(n){n[n.Idle=0]="Idle",n[n.Typing=1]="Typing"})(sm||(sm={}));const Fte=new class{mightProducePrintableCharacter(n){return n.ctrlKey||n.metaKey||n.altKey?!1:n.keyCode>=31&&n.keyCode<=56||n.keyCode>=21&&n.keyCode<=30||n.keyCode>=93&&n.keyCode<=102||n.keyCode>=80&&n.keyCode<=90}};class l3e{constructor(e,t,i,r){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.delegate=r,this.enabled=!1,this.state=sm.Idle,this.automaticKeyboardNavigation=!0,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new ve,this.disposables=new ve,this.updateOptions(e.options)}updateOptions(e){(typeof e.enableKeyboardNavigation>"u"?!0:!!e.enableKeyboardNavigation)?this.enable():this.disable(),typeof e.automaticKeyboardNavigation<"u"&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation)}enable(){if(this.enabled)return;const e=Re.chain(this.enabledDisposables.add(new qt(this.view.domNode,"keydown")).event).filter(r=>!Ju(r.target)).filter(()=>this.automaticKeyboardNavigation||this.triggered).map(r=>new bi(r)).filter(r=>this.delegate.mightProducePrintableCharacter(r)).forEach(r=>{r.stopPropagation(),r.preventDefault()}).map(r=>r.browserEvent.key).event,t=Re.debounce(e,()=>null,800);Re.reduce(Re.any(e,t),(r,s)=>s===null?null:(r||"")+s)(this.onInput,this,this.enabledDisposables),t(this.onClear,this,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var e;const t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){const i=(e=this.list.options.accessibilityProvider)===null||e===void 0?void 0:e.getAriaLabel(this.list.element(t[0]));i&&Hg(i)}this.previouslyFocused=-1}onInput(e){if(!e){this.state=sm.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,r=this.state===sm.Idle?1:0;this.state=sm.Typing;for(let s=0;s<this.list.length;s++){const o=(i+s+r)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(o)),l=a&&a.toString();if(typeof l>"u"||Q5(e,l)){this.previouslyFocused=i,this.list.setFocus([o]),this.list.reveal(o);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class c3e{constructor(e,t){this.list=e,this.view=t,this.disposables=new ve,Re.chain(this.disposables.add(new qt(t.domNode,"keydown")).event).filter(r=>!Ju(r.target)).map(r=>new bi(r)).filter(r=>r.keyCode===2&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey).on(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const r=i.querySelector("[tabIndex]");if(!r||!(r instanceof HTMLElement)||r.tabIndex===-1)return;const s=window.getComputedStyle(r);s.visibility==="hidden"||s.display==="none"||(e.preventDefault(),e.stopPropagation(),r.focus())}dispose(){this.disposables.dispose()}}function Ote(n){return wt?n.browserEvent.metaKey:n.browserEvent.ctrlKey}function Pte(n){return n.browserEvent.shiftKey}function h3e(n){return n instanceof MouseEvent&&n.button===2}const Iz={isSelectionSingleChangeEvent:Ote,isSelectionRangeChangeEvent:Pte};class Bte{constructor(e){this.list=e,this.disposables=new ve,this._onPointer=new H,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Iz),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Rt.addTarget(e.getHTMLElement()))),Re.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||Iz))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){rm(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(rm(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||Ju(e.browserEvent.target)||rm(e.browserEvent.target))return;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionRangeChangeEvent(e))return this.changeSelection(e);if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),h3e(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(Ju(e.browserEvent.target)||rm(e.browserEvent.target)||this.isSelectionChangeEvent(e))return;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(typeof i>"u"){const h=this.list.getFocus()[0];i=h??t,this.list.setAnchor(i)}const r=Math.min(i,t),s=Math.max(i,t),o=mr(r,s+1),a=this.list.getSelection(),l=f3e(HF(a,[i]),i);if(l.length===0)return;const c=HF(o,g3e(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const r=this.list.getSelection(),s=r.filter(o=>o!==t);this.list.setFocus([t]),this.list.setAnchor(t),r.length===s.length?this.list.setSelection([...s,t],e.browserEvent):this.list.setSelection(s,e.browserEvent)}}dispose(){this.disposables.dispose()}}class Vte{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&(e.listBackground.isOpaque()?i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`):wt||console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`)),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }
			`),e.listFilterWidgetBackground&&i.push(`.monaco-list-type-filter { background-color: ${e.listFilterWidgetBackground} }`),e.listFilterWidgetOutline&&i.push(`.monaco-list-type-filter { border: 1px solid ${e.listFilterWidgetOutline}; }`),e.listFilterWidgetNoMatchesOutline&&i.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${e.listFilterWidgetNoMatchesOutline}; }`),e.listMatchesShadow&&i.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${e.listMatchesShadow}; }`),e.tableColumnsBorder&&i.push(`
				.monaco-table:hover > .monaco-split-view2,
				.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
			}`),this.styleElement.textContent=i.join(`
`)}}const u3e={listFocusBackground:X.fromHex("#7FB0D0"),listActiveSelectionBackground:X.fromHex("#0E639C"),listActiveSelectionForeground:X.fromHex("#FFFFFF"),listActiveSelectionIconForeground:X.fromHex("#FFFFFF"),listFocusAndSelectionBackground:X.fromHex("#094771"),listFocusAndSelectionForeground:X.fromHex("#FFFFFF"),listInactiveSelectionBackground:X.fromHex("#3F3F46"),listInactiveSelectionIconForeground:X.fromHex("#FFFFFF"),listHoverBackground:X.fromHex("#2A2D2E"),listDropBackground:X.fromHex("#383B3D"),treeIndentGuidesStroke:X.fromHex("#a9a9a9"),tableColumnsBorder:X.fromHex("#cccccc").transparent(.2)},d3e={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){}}};function f3e(n,e){const t=n.indexOf(e);if(t===-1)return[];const i=[];let r=t-1;for(;r>=0&&n[r]===e-(t-r);)i.push(n[r--]);for(i.reverse(),r=t;r<n.length&&n[r]===e+(r-t);)i.push(n[r++]);return i}function HF(n,e){const t=[];let i=0,r=0;for(;i<n.length||r<e.length;)if(i>=n.length)t.push(e[r++]);else if(r>=e.length)t.push(n[i++]);else if(n[i]===e[r]){t.push(n[i]),i++,r++;continue}else n[i]<e[r]?t.push(n[i++]):t.push(e[r++]);return t}function g3e(n,e){const t=[];let i=0,r=0;for(;i<n.length||r<e.length;)if(i>=n.length)t.push(e[r++]);else if(r>=e.length)t.push(n[i++]);else if(n[i]===e[r]){i++,r++;continue}else n[i]<e[r]?t.push(n[i++]):r++;return t}const Tz=(n,e)=>n-e;class p3e{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,r){let s=0;for(const o of this.renderers)o.renderElement(e,t,i[s++],r)}disposeElement(e,t,i,r){let s=0;for(const o of this.renderers)o.disposeElement&&o.disposeElement(e,t,i[s],r),s+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class m3e{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return e}renderElement(e,t,i){const r=this.accessibilityProvider.getAriaLabel(e);r?i.setAttribute("aria-label",r):i.removeAttribute("aria-label");const s=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof s=="number"?i.setAttribute("aria-level",`${s}`):i.removeAttribute("aria-level")}disposeTemplate(e){}}class _3e{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(e,t)}onDragOver(e,t,i,r){return this.dnd.onDragOver(e,t,i,r)}onDragLeave(e,t,i,r){var s,o;(o=(s=this.dnd).onDragLeave)===null||o===void 0||o.call(s,e,t,i,r)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}drop(e,t,i,r){this.dnd.drop(e,t,i,r)}}class pc{constructor(e,t,i,r,s=d3e){var o;this.user=e,this._options=s,this.focus=new SD("focused"),this.anchor=new SD("anchor"),this.eventBufferer=new S3,this._ariaLabel="",this.disposables=new ve,this._onDidDispose=new H,this.onDidDispose=this._onDidDispose.event;const a=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?(o=this._options.accessibilityProvider)===null||o===void 0?void 0:o.getWidgetRole():"list";this.selection=new a3e(a!=="listbox"),sl(s,u3e,!1);const l=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=s.accessibilityProvider,this.accessibilityProvider&&(l.push(new m3e(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant&&this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant,this,this.disposables)),r=r.map(h=>new p3e(h.templateId,[...l,h]));const c=Object.assign(Object.assign({},s),{dnd:s.dnd&&new _3e(this,s.dnd)});if(this.view=new ol(t,i,r,c),this.view.domNode.setAttribute("role",a),s.styleController)this.styleController=s.styleController(this.view.domId);else{const h=ho(this.view.domNode);this.styleController=new Vte(h,this.view.domId)}if(this.spliceable=new X4e([new dA(this.focus,this.view,s.identityProvider),new dA(this.selection,this.view,s.identityProvider),new dA(this.anchor,this.view,s.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new c3e(this,this.view)),(typeof s.keyboardSupport!="boolean"||s.keyboardSupport)&&(this.keyboardController=new Mte(this,this.view,s),this.disposables.add(this.keyboardController)),s.keyboardNavigationLabelProvider){const h=s.keyboardNavigationDelegate||Fte;this.typeLabelController=new l3e(this,this.view,s.keyboardNavigationLabelProvider,h),this.disposables.add(this.typeLabelController)}this.mouseController=this.createMouseController(s),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}get onDidChangeFocus(){return Re.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e))}get onDidChangeSelection(){return Re.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e))}get domId(){return this.view.domId}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=Re.chain(this.disposables.add(new qt(this.view.domNode,"keydown")).event).map(s=>new bi(s)).filter(s=>e=s.keyCode===58||s.shiftKey&&s.keyCode===68).map(rz).filter(()=>!1).event,i=Re.chain(this.disposables.add(new qt(this.view.domNode,"keyup")).event).forEach(()=>e=!1).map(s=>new bi(s)).filter(s=>s.keyCode===58||s.shiftKey&&s.keyCode===68).map(rz).map(({browserEvent:s})=>{const o=this.getFocus(),a=o.length?o[0]:void 0,l=typeof a<"u"?this.view.element(a):void 0,c=typeof a<"u"?this.view.domElement(a):this.view.domNode;return{index:a,element:l,anchor:c,browserEvent:s}}).event,r=Re.chain(this.view.onContextMenu).filter(s=>!e).map(({element:s,index:o,browserEvent:a})=>({element:s,index:o,anchor:{x:a.pageX+1,y:a.pageY},browserEvent:a})).event;return Re.any(t,i,r)}get onKeyDown(){return this.disposables.add(new qt(this.view.domNode,"keydown")).event}get onDidFocus(){return Re.signal(this.disposables.add(new qt(this.view.domNode,"focus",!0)).event)}createMouseController(e){return new Bte(this)}updateOptions(e={}){var t;this._options=Object.assign(Object.assign({},this._options),e),this.typeLabelController&&this.typeLabelController.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),(t=this.keyboardController)===null||t===void 0||t.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new Id(this.user,`Invalid start index: ${e}`);if(t<0)throw new Id(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new Id(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new Id(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return QM(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new Id(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,r){if(this.length===0)return;const s=this.focus.get(),o=this.findNextIndex(s.length>0?s[0]+e:0,t,r);o>-1&&this.setFocus([o],i)}focusPrevious(e=1,t=!1,i,r){if(this.length===0)return;const s=this.focus.get(),o=this.findPreviousIndex(s.length>0?s[0]-e:0,t,r);o>-1&&this.setFocus([o],i)}focusNextPage(e,t){return Lz(this,void 0,void 0,function*(){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const r=this.view.element(i),s=this.getFocusedElements()[0];if(s!==r){const o=this.findPreviousIndex(i,!1,t);o>-1&&s!==this.view.element(o)?this.setFocus([o],e):this.setFocus([i],e)}else{const o=this.view.getScrollTop();this.view.setScrollTop(o+this.view.renderHeight-this.view.elementHeight(i)),this.view.getScrollTop()!==o&&(this.setFocus([]),yield dw(0),yield this.focusNextPage(e,t))}})}focusPreviousPage(e,t){return Lz(this,void 0,void 0,function*(){let i;const r=this.view.getScrollTop();r===0?i=this.view.indexAt(r):i=this.view.indexAfter(r-1);const s=this.view.element(i),o=this.getFocusedElements()[0];if(o!==s){const a=this.findNextIndex(i,!1,t);a>-1&&o!==this.view.element(a)?this.setFocus([a],e):this.setFocus([i],e)}else{const a=r;this.view.setScrollTop(r-this.view.renderHeight),this.view.getScrollTop()!==a&&(this.setFocus([]),yield dw(0),yield this.focusPreviousPage(e,t))}})}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const r=this.findNextIndex(e,!1,i);r>-1&&this.setFocus([r],t)}findNextIndex(e,t=!1,i){for(let r=0;r<this.length;r++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let r=0;r<this.length;r++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t){if(e<0||e>=this.length)throw new Id(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),r=this.view.elementTop(e),s=this.view.elementHeight(e);if(sg(t)){const o=s-this.view.renderHeight;this.view.setScrollTop(o*Ao(t,0,1)+r)}else{const o=r+s,a=i+this.view.renderHeight;r<i&&o>=a||(r<i||o>=a&&s>=this.view.renderHeight?this.view.setScrollTop(r):o>=a&&this.view.setScrollTop(o-this.view.renderHeight))}}getRelativeTop(e){if(e<0||e>=this.length)throw new Id(this.user,`Invalid index ${e}`);const t=this.view.getScrollTop(),i=this.view.elementTop(e),r=this.view.elementHeight(e);if(i<t||i+r>t+this.view.renderHeight)return null;const s=r-this.view.renderHeight;return Math.abs((t-i)/s)}getHTMLElement(){return this.view.domNode}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var e;const t=this.focus.get();if(t.length>0){let i;!((e=this.accessibilityProvider)===null||e===void 0)&&e.getActiveDescendantId&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}Yg([an],pc.prototype,"onDidChangeFocus",null);Yg([an],pc.prototype,"onDidChangeSelection",null);Yg([an],pc.prototype,"onContextMenu",null);Yg([an],pc.prototype,"onKeyDown",null);Yg([an],pc.prototype,"onDidFocus",null);class b3e{constructor(e,t){this.renderer=e,this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:re.None}}renderElement(e,t,i,r){if(i.disposable&&i.disposable.dispose(),!i.data)return;const s=this.modelProvider();if(s.isResolved(e))return this.renderer.renderElement(s.get(e),e,i.data,r);const o=new rl,a=s.resolve(e,o.token);i.disposable={dispose:()=>o.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(l=>this.renderer.renderElement(l,e,i.data,r))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class v3e{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function w3e(n,e){return Object.assign(Object.assign({},e),{accessibilityProvider:e.accessibilityProvider&&new v3e(n,e.accessibilityProvider)})}class y3e{constructor(e,t,i,r,s={}){const o=()=>this.model,a=r.map(l=>new b3e(l,o));this.list=new pc(e,t,i,a,w3e(o,s))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Re.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return Re.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return Re.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(r=>this._model.get(r)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,mr(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}const C3e={separatorBorder:X.transparent};class Wte{constructor(e,t,i,r){this.container=e,this.view=t,this.disposable=r,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){e!==this.visible&&(e?(this.size=Ao(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e),this.view.setVisible&&this.view.setVisible(e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e),this.view.layout(this.size,e,t)}dispose(){return this.disposable.dispose(),this.view}}class S3e extends Wte{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class x3e extends Wte{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var Vc;(function(n){n[n.Idle=0]="Idle",n[n.Busy=1]="Busy"})(Vc||(Vc={}));var xD;(function(n){n.Distribute={type:"distribute"};function e(i){return{type:"split",index:i}}n.Split=e;function t(i){return{type:"invisible",cachedVisibleSize:i}}n.Invisible=t})(xD||(xD={}));class $te extends re{constructor(e,t={}){var i,r;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=Vc.Idle,this._onDidSashChange=this._register(new H),this.onDidSashChange=this._onDidSashChange.event,this._onDidSashReset=this._register(new H),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.orientation=yr(t.orientation)?0:t.orientation,this.inverseAltBehavior=!!t.inverseAltBehavior,this.proportionalLayout=yr(t.proportionalLayout)?!0:!!t.proportionalLayout,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=le(this.el,me(".sash-container")),this.viewContainer=me(".split-view-container"),this.scrollable=new IL(125,ic),this.scrollableElement=this._register(new O5(this.viewContainer,{vertical:this.orientation===0?(i=t.scrollbarVisibility)!==null&&i!==void 0?i:1:2,horizontal:this.orientation===1?(r=t.scrollbarVisibility)!==null&&r!==void 0?r:1:2},this.scrollable)),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(s=>{this.viewContainer.scrollTop=s.scrollTop,this.viewContainer.scrollLeft=s.scrollLeft})),le(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||C3e),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((s,o)=>{const a=yr(s.visible)||s.visible?s.size:{type:"invisible",cachedVisibleSize:s.size},l=s.view;this.doAddView(l,a,o,!0)}),this.contentSize=this.viewItems.reduce((s,o)=>s+o.size,0),this.saveProportions())}get orthogonalStartSash(){return this._orthogonalStartSash}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}get orthogonalEndSash(){return this._orthogonalEndSash}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}get startSnappingEnabled(){return this._startSnappingEnabled}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}get endSnappingEnabled(){return this._endSnappingEnabled}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,r){this.doAddView(e,t,i,r)}layout(e,t){const i=Math.max(this.size,this.contentSize);if(this.size=e,this.layoutContext=t,this.proportions)for(let r=0;r<this.viewItems.length;r++){const s=this.viewItems[r];s.size=Ao(Math.round(this.proportions[r]*e),s.minimumSize,s.maximumSize)}else{const r=mr(this.viewItems.length),s=r.filter(a=>this.viewItems[a].priority===1),o=r.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,s,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map(e=>e.size/this.contentSize))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const r=this.sashItems.findIndex(a=>a.sash===e),s=Cu(ae(document.body,"keydown",a=>o(this.sashDragState.current,a.altKey)),ae(document.body,"keyup",()=>o(this.sashDragState.current,!1))),o=(a,l)=>{const c=this.viewItems.map(g=>g.size);let h=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(r===this.sashItems.length-1){const p=this.viewItems[r];h=(p.minimumSize-p.size)/2,u=(p.maximumSize-p.size)/2}else{const p=this.viewItems[r+1];h=(p.size-p.maximumSize)/2,u=(p.size-p.minimumSize)/2}let d,f;if(!l){const g=mr(r,-1),p=mr(r+1,this.viewItems.length),m=g.reduce((D,E)=>D+(this.viewItems[E].minimumSize-c[E]),0),b=g.reduce((D,E)=>D+(this.viewItems[E].viewMaximumSize-c[E]),0),_=p.length===0?Number.POSITIVE_INFINITY:p.reduce((D,E)=>D+(c[E]-this.viewItems[E].minimumSize),0),w=p.length===0?Number.NEGATIVE_INFINITY:p.reduce((D,E)=>D+(c[E]-this.viewItems[E].viewMaximumSize),0),y=Math.max(m,w),S=Math.min(_,b),k=this.findFirstSnapIndex(g),C=this.findFirstSnapIndex(p);if(typeof k=="number"){const D=this.viewItems[k],E=Math.floor(D.viewMinimumSize/2);d={index:k,limitDelta:D.visible?y-E:y+E,size:D.size}}if(typeof C=="number"){const D=this.viewItems[C],E=Math.floor(D.viewMinimumSize/2);f={index:C,limitDelta:D.visible?S+E:S-E,size:D.size}}}this.sashDragState={start:a,current:a,index:r,sizes:c,minDelta:h,maxDelta:u,alt:l,snapBefore:d,snapAfter:f,disposable:s}};o(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:r,alt:s,minDelta:o,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const h=e-i,u=this.resize(t,h,r,void 0,void 0,o,a,l,c);if(s){const d=t===this.sashItems.length-1,f=this.viewItems.map(w=>w.size),g=d?t:t+1,p=this.viewItems[g],m=p.size-p.maximumSize,b=p.size-p.minimumSize,_=d?t-1:t+1;this.resize(_,-u,f,void 0,void 0,m,b)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=Ao(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(this.state!==Vc.Idle)throw new Error("Cant modify splitview");if(this.state=Vc.Busy,e<0||e>=this.viewItems.length)return;const i=mr(this.viewItems.length).filter(a=>a!==e),r=[...i.filter(a=>this.viewItems[a].priority===1),e],s=i.filter(a=>this.viewItems[a].priority===2),o=this.viewItems[e];t=Math.round(t),t=Ao(t,o.minimumSize,Math.min(o.maximumSize,this.size)),o.size=t,this.relayout(r,s),this.state=Vc.Idle}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=Ao(i,a.minimumSize,a.maximumSize);const r=mr(this.viewItems.length),s=r.filter(a=>this.viewItems[a].priority===1),o=r.filter(a=>this.viewItems[a].priority===2);this.relayout(s,o)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,r){if(this.state!==Vc.Idle)throw new Error("Cant modify splitview");this.state=Vc.Busy;const s=me(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(s):this.viewContainer.insertBefore(s,this.viewContainer.children.item(i));const o=e.onDidChange(d=>this.onViewChange(h,d)),a=Et(()=>this.viewContainer.removeChild(s)),l=Cu(o,a);let c;typeof t=="number"?c=t:t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize;const h=this.orientation===0?new S3e(s,e,c,l):new x3e(s,e,c,l);if(this.viewItems.splice(i,0,h),this.viewItems.length>1){let d={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash};const f=this.orientation===0?new Hn(this.sashContainer,{getHorizontalSashTop:D=>this.getSashPosition(D),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},d),{orientation:1})):new Hn(this.sashContainer,{getVerticalSashLeft:D=>this.getSashPosition(D),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},d),{orientation:0})),g=this.orientation===0?D=>({sash:f,start:D.startY,current:D.currentY,alt:D.altKey}):D=>({sash:f,start:D.startX,current:D.currentX,alt:D.altKey}),m=Re.map(f.onDidStart,g)(this.onSashStart,this),_=Re.map(f.onDidChange,g)(this.onSashChange,this),y=Re.map(f.onDidEnd,()=>this.sashItems.findIndex(D=>D.sash===f))(this.onSashEnd,this),S=f.onDidReset(()=>{const D=this.sashItems.findIndex(q=>q.sash===f),E=mr(D,-1),N=mr(D+1,this.viewItems.length),T=this.findFirstSnapIndex(E),j=this.findFirstSnapIndex(N);typeof T=="number"&&!this.viewItems[T].visible||typeof j=="number"&&!this.viewItems[j].visible||this._onDidSashReset.fire(D)}),k=Cu(m,_,y,S,f),C={sash:f,disposable:k};this.sashItems.splice(i-1,0,C)}s.appendChild(e.element);let u;typeof t!="number"&&t.type==="split"&&(u=[t.index]),r||this.relayout([i],u),this.state=Vc.Idle,!r&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}relayout(e,t){const i=this.viewItems.reduce((r,s)=>r+s.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(h=>h.size),r,s,o=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const h=mr(e,-1),u=mr(e+1,this.viewItems.length);if(s)for(const C of s)wT(h,C),wT(u,C);if(r)for(const C of r)mC(h,C),mC(u,C);const d=h.map(C=>this.viewItems[C]),f=h.map(C=>i[C]),g=u.map(C=>this.viewItems[C]),p=u.map(C=>i[C]),m=h.reduce((C,D)=>C+(this.viewItems[D].minimumSize-i[D]),0),b=h.reduce((C,D)=>C+(this.viewItems[D].maximumSize-i[D]),0),_=u.length===0?Number.POSITIVE_INFINITY:u.reduce((C,D)=>C+(i[D]-this.viewItems[D].minimumSize),0),w=u.length===0?Number.NEGATIVE_INFINITY:u.reduce((C,D)=>C+(i[D]-this.viewItems[D].maximumSize),0),y=Math.max(m,w,o),S=Math.min(_,b,a);let k=!1;if(l){const C=this.viewItems[l.index],D=t>=l.limitDelta;k=D!==C.visible,C.setVisible(D,l.size)}if(!k&&c){const C=this.viewItems[c.index],D=t<c.limitDelta;k=D!==C.visible,C.setVisible(D,c.size)}if(k)return this.resize(e,t,i,r,s,o,a);t=Ao(t,y,S);for(let C=0,D=t;C<d.length;C++){const E=d[C],N=Ao(f[C]+D,E.minimumSize,E.maximumSize),T=N-f[C];D-=T,E.size=N}for(let C=0,D=t;C<g.length;C++){const E=g[C],N=Ao(p[C]-D,E.minimumSize,E.maximumSize),T=N-p[C];D+=T,E.size=N}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const r=mr(this.viewItems.length-1,-1),s=r.filter(a=>this.viewItems[a].priority===1),o=r.filter(a=>this.viewItems[a].priority===2);for(const a of o)wT(r,a);for(const a of s)mC(r,a);typeof e=="number"&&mC(r,e);for(let a=0;i!==0&&a<r.length;a++){const l=this.viewItems[r[a]],c=Ao(l.size+i,l.minimumSize,l.maximumSize),h=c-l.size;i-=h,l.size=c}}layoutViews(){this.contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),r=[...this.viewItems].reverse();e=!1;const s=r.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const o=r.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],h=this.viewItems[l];a+=h.size;const u=!(t[l]&&o[l+1]),d=!(i[l]&&s[l+1]);if(u&&d){const f=mr(l,-1),g=mr(l+1,this.viewItems.length),p=this.findFirstSnapIndex(f),m=this.findFirstSnapIndex(g),b=typeof p=="number"&&!this.viewItems[p].visible,_=typeof m=="number"&&!this.viewItems[m].visible;b&&s[l]&&(a>0||this.startSnappingEnabled)?c.state=1:_&&t[l]&&(a<this.contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else u&&!d?c.state=1:!u&&d?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}dispose(){super.dispose(),this.viewItems.forEach(e=>e.dispose()),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[]}}class Ey{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=Ey.TemplateId,this.renderedTemplates=new Set;const r=new Map(t.map(s=>[s.templateId,s]));this.renderers=[];for(const s of e){const o=r.get(s.templateId);if(!o)throw new Error(`Table cell renderer for template id ${s.templateId} not found.`);this.renderers.push(o)}}renderTemplate(e){const t=le(e,me(".monaco-table-tr")),i=[],r=[];for(let o=0;o<this.columns.length;o++){const a=this.renderers[o],l=le(t,me(".monaco-table-td",{"data-col-index":o}));l.style.width=`${this.getColumnSize(o)}px`,i.push(l),r.push(a.renderTemplate(l))}const s={container:e,cellContainers:i,cellTemplateData:r};return this.renderedTemplates.add(s),s}renderElement(e,t,i,r){for(let s=0;s<this.columns.length;s++){const a=this.columns[s].project(e);this.renderers[s].renderElement(a,t,i.cellTemplateData[s],r)}}disposeElement(e,t,i,r){for(let s=0;s<this.columns.length;s++){const o=this.renderers[s];if(o.disposeElement){const l=this.columns[s].project(e);o.disposeElement(l,t,i.cellTemplateData[s],r)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);Gn(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}Ey.TemplateId="row";function E3e(n){return{getHeight(e){return n.getHeight(e)},getTemplateId(){return Ey.TemplateId}}}class D3e{constructor(e,t){this.column=e,this.index=t,this._onDidLayout=new H,this.onDidLayout=this._onDidLayout.event,this.element=me(".monaco-table-th",{"data-col-index":t,title:e.tooltip},e.label)}get minimumSize(){var e;return(e=this.column.minimumWidth)!==null&&e!==void 0?e:120}get maximumSize(){var e;return(e=this.column.maximumWidth)!==null&&e!==void 0?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return(e=this.column.onDidChangeWidthConstraints)!==null&&e!==void 0?e:Re.None}layout(e){this._onDidLayout.fire([this.index,e])}}class PL{constructor(e,t,i,r,s,o){this.virtualDelegate=i,this.domId=`table_id_${++PL.InstanceCount}`,this.cachedHeight=0,this.domNode=le(t,me(`.monaco-table.${this.domId}`));const a=r.map((h,u)=>new D3e(h,u)),l={size:a.reduce((h,u)=>h+u.column.weight,0),views:a.map(h=>({size:h.column.weight,view:h}))};this.splitview=new $te(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l}),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new Ey(r,s,h=>this.splitview.getViewSize(h));this.list=new pc(e,this.domNode,E3e(i),[c],o),this.columnLayoutDisposable=Re.any(...a.map(h=>h.onDidLayout))(([h,u])=>c.layoutColumn(h,u)),this.styleElement=ho(this.domNode),this.style({})}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.splitview.dispose(),this.list.dispose(),this.columnLayoutDisposable.dispose()}}PL.InstanceCount=0;var Sv;(function(n){n[n.Unknown=0]="Unknown",n[n.Twistie=1]="Twistie",n[n.Element=2]="Element"})(Sv||(Sv={}));class to extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class sB{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function oB(n){return typeof n=="object"&&"visibility"in n&&"data"in n}function Kw(n){switch(n){case!0:return 1;case!1:return 0;default:return n}}function fA(n){return typeof n.collapsible=="boolean"}class k3e{constructor(e,t,i,r={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new S3,this._onDidChangeCollapseState=new H,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new H,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new H,this.onDidSplice=this._onDidSplice.event,this.collapseByDefault=typeof r.collapseByDefault>"u"?!1:r.collapseByDefault,this.filter=r.filter,this.autoExpandSingleChildren=typeof r.autoExpandSingleChildren>"u"?!1:r.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=vt.empty(),r={}){if(e.length===0)throw new to(this.user,"Invalid tree location");r.diffIdentityProvider?this.spliceSmart(r.diffIdentityProvider,e,t,i,r):this.spliceSimple(e,t,i,r)}spliceSmart(e,t,i,r,s,o){var a;r===void 0&&(r=vt.empty()),o===void 0&&(o=(a=s.diffDepth)!==null&&a!==void 0?a:0);const{parentNode:l}=this.getParentNodeWithListIndex(t);if(!l.lastDiffIds)return this.spliceSimple(t,i,r,s);const c=[...r],h=t[t.length-1],u=new Fl({getElements:()=>l.lastDiffIds},{getElements:()=>[...l.children.slice(0,h),...c,...l.children.slice(h+i)].map(m=>e.getId(m.element).toString())}).ComputeDiff(!1);if(u.quitEarly)return l.lastDiffIds=void 0,this.spliceSimple(t,i,c,s);const d=t.slice(0,-1),f=(m,b,_)=>{if(o>0)for(let w=0;w<_;w++)m--,b--,this.spliceSmart(e,[...d,m,0],Number.MAX_SAFE_INTEGER,c[b].children,s,o-1)};let g=Math.min(l.children.length,h+i),p=c.length;for(const m of u.changes.sort((b,_)=>_.originalStart-b.originalStart))f(g,p,g-(m.originalStart+m.originalLength)),g=m.originalStart,p=m.modifiedStart-h,this.spliceSimple([...d,g],m.originalLength,vt.slice(c,p,p+m.modifiedLength),s);f(g,p,g)}spliceSimple(e,t,i=vt.empty(),{onDidCreateNode:r,onDidDeleteNode:s,diffIdentityProvider:o}){const{parentNode:a,listIndex:l,revealed:c,visible:h}=this.getParentNodeWithListIndex(e),u=[],d=vt.map(i,C=>this.createTreeNode(C,a,a.visible?1:0,c,u,r)),f=e[e.length-1],g=a.children.length>0;let p=0;for(let C=f;C>=0&&C<a.children.length;C--){const D=a.children[C];if(D.visible){p=D.visibleChildIndex;break}}const m=[];let b=0,_=0;for(const C of d)m.push(C),_+=C.renderNodeCount,C.visible&&(C.visibleChildIndex=p+b++);const w=AW(a.children,f,t,m);o?a.lastDiffIds?AW(a.lastDiffIds,f,t,m.map(C=>o.getId(C.element).toString())):a.lastDiffIds=a.children.map(C=>o.getId(C.element).toString()):a.lastDiffIds=void 0;let y=0;for(const C of w)C.visible&&y++;if(y!==0)for(let C=f+m.length;C<a.children.length;C++){const D=a.children[C];D.visible&&(D.visibleChildIndex-=y)}if(a.visibleChildrenCount+=b-y,c&&h){const C=w.reduce((D,E)=>D+(E.visible?E.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,_-C),this.list.splice(l,C,u)}if(w.length>0&&s){const C=D=>{s(D),D.children.forEach(C)};w.forEach(C)}const S=a.children.length>0;g!==S&&this.setCollapsible(e.slice(0,-1),S),this._onDidSplice.fire({insertedNodes:m,deletedNodes:w});let k=a;for(;k;){if(k.visibility===2){this.refilter();break}k=k.parent}}rerender(e){if(e.length===0)throw new to(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:r}=this.getTreeNodeWithListIndex(e);t.visible&&r&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:r}=this.getTreeNodeWithListIndex(e);return i&&r?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const r={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,r))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const r=this.getTreeNode(e);typeof t>"u"&&(t=!r.collapsed);const s={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,s))}_setCollapseState(e,t){const{node:i,listIndex:r,revealed:s}=this.getTreeNodeWithListIndex(e),o=this._setListNodeCollapseState(i,r,s,t);if(i!==this.root&&this.autoExpandSingleChildren&&o&&!fA(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return o}_setListNodeCollapseState(e,t,i,r){const s=this._setNodeCollapseState(e,r,!1);if(!i||!e.visible||!s)return s;const o=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=o-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),s}_setNodeCollapseState(e,t,i){let r;if(e===this.root?r=!1:(fA(t)?(r=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(r=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):r=!1,r&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!fA(t)&&t.recursive)for(const s of e.children)r=this._setNodeCollapseState(s,t,!0)||r;return r}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t)}createTreeNode(e,t,i,r,s,o){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,r&&s.push(a);const c=e.children||vt.empty(),h=r&&l!==0&&!a.collapsed,u=vt.map(c,g=>this.createTreeNode(g,a,l,h,s,o));let d=0,f=1;for(const g of u)a.children.push(g),f+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=d++);return a.collapsible=a.collapsible||a.children.length>0,a.visibleChildrenCount=d,a.visible=l===2?d>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=f):(a.renderNodeCount=0,r&&s.pop()),o&&o(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,r=!0){let s;if(e!==this.root){if(s=this._filterNode(e,t),s===0)return e.visible=!1,e.renderNodeCount=0,!1;r&&i.push(e)}const o=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||s!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,s,i,r&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=s===2?a:s===1,e.visibility=s),e.visible?e.collapsed||(e.renderNodeCount+=i.length-o):(e.renderNodeCount=0,r&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):oB(i)?(e.filterData=i.data,Kw(i.visibility)):(e.filterData=void 0,Kw(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...r]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(r,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...r]=e;if(i<0||i>t.children.length)throw new to(this.user,"Invalid tree location");return this.getTreeNode(r,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:r,visible:s}=this.getParentNodeWithListIndex(e),o=e[e.length-1];if(o<0||o>t.children.length)throw new to(this.user,"Invalid tree location");const a=t.children[o];return{node:a,listIndex:i,revealed:r,visible:s&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,r=!0,s=!0){const[o,...a]=e;if(o<0||o>t.children.length)throw new to(this.user,"Invalid tree location");for(let l=0;l<o;l++)i+=t.children[l].renderNodeCount;return r=r&&!t.collapsed,s=s&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:r,visible:s}:this.getParentNodeWithListIndex(a,t.children[o],i+1,r,s)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:J2e(e)[0]}}const Az=ha("tree-item-expanded",Ce.chevronDown),Nz=ha("tree-filter-on-type-on",Ce.listFilter),Rz=ha("tree-filter-on-type-off",Ce.listSelection),L3e=ha("tree-filter-clear",Ce.close),ED=ha("tree-item-loading",Ce.loading);class I3e extends xy{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function gA(n){return n instanceof xy?new I3e(n):n}class T3e{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=re.None}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(gA(e),t)}onDragOver(e,t,i,r,s=!0){const o=this.dnd.onDragOver(gA(e),t&&t.element,i,r),a=this.autoExpandNode!==t;if(a&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return o;if(a&&typeof o!="boolean"&&o.autoExpand&&(this.autoExpandDisposable=b_(()=>{const d=this.modelProvider(),f=d.getNodeLocation(t);d.isCollapsed(f)&&d.setCollapsed(f,!1),this.autoExpandNode=void 0},500)),typeof o=="boolean"||!o.accept||typeof o.bubble>"u"||o.feedback){if(!s){const d=typeof o=="boolean"?o:o.accept,f=typeof o=="boolean"?void 0:o.effect;return{accept:d,effect:f,feedback:[i]}}return o}if(o.bubble===1){const d=this.modelProvider(),f=d.getNodeLocation(t),g=d.getParentNodeLocation(f),p=d.getNode(g),m=g&&d.getListIndex(g);return this.onDragOver(e,p,m,r,!1)}const l=this.modelProvider(),c=l.getNodeLocation(t),h=l.getListIndex(c),u=l.getListRenderCount(c);return Object.assign(Object.assign({},o),{feedback:mr(h,h+u)})}drop(e,t,i,r){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(gA(e),t&&t.element,i,r)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}function A3e(n,e){return e&&Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new T3e(n,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))}},accessibilityProvider:e.accessibilityProvider&&Object.assign(Object.assign({},e.accessibilityProvider),{getSetSize(t){const i=n(),r=i.getNodeLocation(t),s=i.getParentNodeLocation(r);return i.getNode(s).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))}),keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}),enableKeyboardNavigation:e.simpleKeyboardNavigation})}class aB{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight&&this.delegate.setDynamicHeight(e.element,t)}}var Zw;(function(n){n.None="none",n.OnHover="onHover",n.Always="always"})(Zw||(Zw={}));class N3e{constructor(e,t=[]){this._elements=t,this.onDidChange=Re.forEach(e,i=>this._elements=i)}get elements(){return this._elements}}class Yw{constructor(e,t,i,r,s={}){this.renderer=e,this.modelProvider=t,this.activeNodes=r,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=Yw.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.renderedIndentGuides=new WIe,this.activeIndentNodes=new Set,this.indentGuidesDisposable=re.None,this.disposables=new ve,this.templateId=e.templateId,this.updateOptions(s),Re.map(i,o=>o.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState&&e.onDidChangeTwistieState(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"&&(this.indent=Ao(e.indent,0,40)),typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==Zw.None;if(t!==this.shouldRenderIndentGuides&&(this.shouldRenderIndentGuides=t,this.indentGuidesDisposable.dispose(),t)){const i=new ve;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=le(e,me(".monaco-tl-row")),i=le(t,me(".monaco-tl-indent")),r=le(t,me(".monaco-tl-twistie")),s=le(t,me(".monaco-tl-contents")),o=this.renderer.renderTemplate(s);return{container:e,indent:i,twistie:r,indentGuidesDisposable:re.None,templateData:o}}renderElement(e,t,i,r){typeof r=="number"&&(this.renderedNodes.set(e,{templateData:i,height:r}),this.renderedElements.set(e.element,e));const s=Yw.DefaultIndent+(e.depth-1)*this.indent;i.twistie.style.paddingLeft=`${s}px`,i.indent.style.width=`${s+this.indent-16}px`,this.renderTwistie(e,i),typeof r=="number"&&this.renderIndentGuides(e,i),this.renderer.renderElement(e,t,i.templateData,r)}disposeElement(e,t,i,r){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement&&this.renderer.disposeElement(e,t,i.templateData,r),typeof r=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this.renderTwistie(e,t.templateData),this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderIndentGuides(e,t.templateData))}renderTwistie(e,t){t.twistie.classList.remove(...Az.classNamesArray);let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...Az.classNamesArray),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded")}renderIndentGuides(e,t){if(Gn(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new ve,r=this.modelProvider();let s=e;for(;;){const o=r.getNodeLocation(s),a=r.getParentNodeLocation(o);if(!a)break;const l=r.getNode(a),c=me(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(l)&&c.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(c):t.indent.insertBefore(c,t.indent.firstElementChild),this.renderedIndentGuides.add(l,c),i.add(Et(()=>this.renderedIndentGuides.delete(l,c))),s=l}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(r=>{const s=i.getNodeLocation(r);try{const o=i.getParentNodeLocation(s);r.collapsible&&r.children.length>0&&!r.collapsed?t.add(r):o&&t.add(i.getNode(o))}catch{}}),this.activeIndentNodes.forEach(r=>{t.has(r)||this.renderedIndentGuides.forEach(r,s=>s.classList.remove("active"))}),t.forEach(r=>{this.activeIndentNodes.has(r)||this.renderedIndentGuides.forEach(r,s=>s.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),mt(this.disposables)}}Yw.DefaultIndent=8;class R3e{constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new ve,e.onWillRefilter(this.reset,this,this.disposables)}get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){if(this._filter){const s=this._filter.filter(e,t);if(this.tree.options.simpleKeyboardNavigation)return s;let o;if(typeof s=="boolean"?o=s?1:0:oB(s)?o=Kw(s.visibility):o=s,o===0)return!1}if(this._totalCount++,this.tree.options.simpleKeyboardNavigation||!this._pattern)return this._matchCount++,{data:Va.Default,visibility:!0};const i=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),r=Array.isArray(i)?i:[i];for(const s of r){const o=s&&s.toString();if(typeof o>"u")return{data:Va.Default,visibility:!0};const a=Gw(this._pattern,this._lowercasePattern,0,o,o.toLowerCase(),0,!0);if(a)return this._matchCount++,r.length===1?{data:a,visibility:!0}:{data:{label:o,score:a},visibility:!0}}return this.tree.options.filterOnType?2:{data:Va.Default,visibility:!0}}reset(){this._totalCount=0,this._matchCount=0}dispose(){mt(this.disposables)}}class M3e{constructor(e,t,i,r,s){this.tree=e,this.view=i,this.filter=r,this.keyboardNavigationDelegate=s,this._enabled=!1,this._pattern="",this._empty=!1,this._onDidChangeEmptyState=new H,this.positionClassName="ne",this.automaticKeyboardNavigation=!0,this.triggered=!1,this._onDidChangePattern=new H,this.enabledDisposables=new ve,this.disposables=new ve,this.domNode=me(`.monaco-list-type-filter.${this.positionClassName}`),this.domNode.draggable=!0,this.disposables.add(ae(this.domNode,"dragstart",()=>this.onDragStart())),this.messageDomNode=le(i.getHTMLElement(),me(".monaco-list-type-filter-message")),this.labelDomNode=le(this.domNode,me("span.label"));const o=le(this.domNode,me(".controls"));this._filterOnType=!!e.options.filterOnType,this.filterOnTypeDomNode=le(o,me("input.filter")),this.filterOnTypeDomNode.type="checkbox",this.filterOnTypeDomNode.checked=this._filterOnType,this.filterOnTypeDomNode.tabIndex=-1,this.updateFilterOnTypeTitleAndIcon(),this.disposables.add(ae(this.filterOnTypeDomNode,"input",()=>this.onDidChangeFilterOnType())),this.clearDomNode=le(o,me("button.clear"+L3e.cssSelector)),this.clearDomNode.tabIndex=-1,this.clearDomNode.title=v("clear","Clear"),this.keyboardNavigationEventFilter=e.options.keyboardNavigationEventFilter,t.onDidSplice(this.onDidSpliceModel,this,this.disposables),this.updateOptions(e.options)}get enabled(){return this._enabled}get pattern(){return this._pattern}get filterOnType(){return this._filterOnType}updateOptions(e){e.simpleKeyboardNavigation?this.disable():this.enable(),typeof e.filterOnType<"u"&&(this._filterOnType=!!e.filterOnType,this.filterOnTypeDomNode.checked=this._filterOnType,this.updateFilterOnTypeTitleAndIcon()),typeof e.automaticKeyboardNavigation<"u"&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation),this.tree.refilter(),this.render(),this.automaticKeyboardNavigation||this.onEventOrInput("")}enable(){if(this._enabled)return;const e=this.enabledDisposables.add(new qt(this.view.getHTMLElement(),"keydown")),t=Re.chain(e.event).filter(r=>!Ju(r.target)||r.target===this.filterOnTypeDomNode).filter(r=>r.key!=="Dead"&&!/^Media/.test(r.key)).map(r=>new bi(r)).filter(this.keyboardNavigationEventFilter||(()=>!0)).filter(()=>this.automaticKeyboardNavigation||this.triggered).filter(r=>this.keyboardNavigationDelegate.mightProducePrintableCharacter(r)&&!(r.keyCode===18||r.keyCode===16||r.keyCode===15||r.keyCode===17)||(this.pattern.length>0||this.triggered)&&(r.keyCode===9||r.keyCode===1)&&!r.altKey&&!r.ctrlKey&&!r.metaKey||r.keyCode===1&&(wt?r.altKey&&!r.metaKey:r.ctrlKey)&&!r.shiftKey).forEach(r=>{r.stopPropagation(),r.preventDefault()}).event,i=this.enabledDisposables.add(new qt(this.clearDomNode,"click"));Re.chain(Re.any(t,i.event)).event(this.onEventOrInput,this,this.enabledDisposables),this.filter.pattern="",this.tree.refilter(),this.render(),this._enabled=!0,this.triggered=!1}disable(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.clear(),this.tree.refilter(),this.render(),this._enabled=!1,this.triggered=!1)}onEventOrInput(e){typeof e=="string"?this.onInput(e):e instanceof MouseEvent||e.keyCode===9||e.keyCode===1&&(wt?e.altKey:e.ctrlKey)?this.onInput(""):e.keyCode===1?this.onInput(this.pattern.length===0?"":this.pattern.substr(0,this.pattern.length-1)):this.onInput(this.pattern+e.browserEvent.key)}onInput(e){const t=this.view.getHTMLElement();e&&!this.domNode.parentElement?t.append(this.domNode):!e&&this.domNode.parentElement&&(this.domNode.remove(),this.tree.domFocus()),this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,r=>!Va.isDefault(r.filterData));const i=this.tree.getFocus();if(i.length>0){const r=i[0];this.tree.getRelativeTop(r)===null&&this.tree.reveal(r,.5)}this.render(),e||(this.triggered=!1)}onDragStart(){const e=this.view.getHTMLElement(),{left:t}=jn(e),i=e.clientWidth,r=i/2,s=this.domNode.clientWidth,o=new ve;let a=this.positionClassName;const l=()=>{switch(a){case"nw":this.domNode.style.top="4px",this.domNode.style.left="4px";break;case"ne":this.domNode.style.top="4px",this.domNode.style.left=`${i-s-6}px`;break}},c=u=>{u.preventDefault();const d=u.clientX-t;u.dataTransfer&&(u.dataTransfer.dropEffect="none"),d<r?a="nw":a="ne",l()},h=()=>{this.positionClassName=a,this.domNode.className=`monaco-list-type-filter ${this.positionClassName}`,this.domNode.style.top="",this.domNode.style.left="",mt(o)};l(),this.domNode.classList.remove(a),this.domNode.classList.add("dragging"),o.add(Et(()=>this.domNode.classList.remove("dragging"))),o.add(ae(document,"dragover",u=>c(u))),o.add(ae(this.domNode,"dragend",()=>h())),Bc.CurrentDragAndDropData=new YOe("vscode-ui"),o.add(Et(()=>Bc.CurrentDragAndDropData=void 0))}onDidSpliceModel(){!this._enabled||this.pattern.length===0||(this.tree.refilter(),this.render())}onDidChangeFilterOnType(){this.tree.updateOptions({filterOnType:this.filterOnTypeDomNode.checked}),this.tree.refilter(),this.tree.domFocus(),this.render(),this.updateFilterOnTypeTitleAndIcon()}updateFilterOnTypeTitleAndIcon(){this.filterOnType?(this.filterOnTypeDomNode.classList.remove(...Rz.classNamesArray),this.filterOnTypeDomNode.classList.add(...Nz.classNamesArray),this.filterOnTypeDomNode.title=v("disable filter on type","Disable Filter on Type")):(this.filterOnTypeDomNode.classList.remove(...Nz.classNamesArray),this.filterOnTypeDomNode.classList.add(...Rz.classNamesArray),this.filterOnTypeDomNode.title=v("enable filter on type","Enable Filter on Type"))}render(){const e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&this.tree.options.filterOnType&&e?(this.messageDomNode.textContent=v("empty","No elements found"),this._empty=!0):(this.messageDomNode.innerText="",this._empty=!1),this.domNode.classList.toggle("no-matches",e),this.domNode.title=v("found","Matched {0} out of {1} elements",this.filter.matchCount,this.filter.totalCount),this.labelDomNode.textContent=this.pattern.length>16?""+this.pattern.substr(this.pattern.length-16):this.pattern,this._onDidChangeEmptyState.fire(this._empty)}shouldAllowFocus(e){return!this.enabled||!this.pattern||this.filterOnType||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!Va.isDefault(e.filterData)}dispose(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.dispose(),this._enabled=!1,this.triggered=!1),this._onDidChangePattern.dispose(),mt(this.disposables)}}function Mz(n){let e=Sv.Unknown;return ZV(n.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=Sv.Twistie:ZV(n.browserEvent.target,"monaco-tl-contents","monaco-tl-row")&&(e=Sv.Element),{browserEvent:n.browserEvent,element:n.element?n.element.element:null,target:e}}function QS(n,e){e(n),n.children.forEach(t=>QS(t,e))}class pA{constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new H,this.onDidChange=this._onDidChange.event}get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){var i;!(!((i=t)===null||i===void 0)&&i.__forceEvent)&&ec(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const r=this;this._onDidChange.fire({get elements(){return r.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=h=>l.delete(h);t.forEach(h=>QS(h,c)),this.set([...l.values()]);return}const i=new Set,r=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>QS(l,r));const s=new Map,o=l=>s.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>QS(l,o));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const u=s.get(c);u&&a.push(u)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class F3e extends Bte{constructor(e,t){super(e),this.tree=t}onViewPointer(e){if(Ju(e.browserEvent.target)||rm(e.browserEvent.target))return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,r=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let s=!1;if(typeof this.tree.expandOnlyOnTwistieClick=="function"?s=this.tree.expandOnlyOnTwistieClick(t.element):s=!!this.tree.expandOnlyOnTwistieClick,s&&!r&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e);if(t.collapsible){const o=this.tree.model,a=o.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),o.setCollapsed(a,void 0,l),s&&r)return}super.onViewPointer(e)}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||super.onDoubleClick(e)}}class O3e extends pc{constructor(e,t,i,r,s,o,a,l){super(e,t,i,r,l),this.focusTrait=s,this.selectionTrait=o,this.anchorTrait=a}createMouseController(e){return new F3e(this,e.tree)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const r=[],s=[];let o;i.forEach((a,l)=>{this.focusTrait.has(a)&&r.push(e+l),this.selectionTrait.has(a)&&s.push(e+l),this.anchorTrait.has(a)&&(o=e+l)}),r.length>0&&super.setFocus(ME([...super.getFocus(),...r])),s.length>0&&super.setSelection(ME([...super.getSelection(),...s])),typeof o=="number"&&super.setAnchor(o)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(r=>this.element(r)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(r=>this.element(r)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class zte{constructor(e,t,i,r,s={}){this._options=s,this.eventBufferer=new S3,this.disposables=new ve,this._onWillRefilter=new H,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new H;const o=new aB(i),a=new UV,l=new UV,c=new N3e(l.event);this.renderers=r.map(d=>new Yw(d,()=>this.model,a.event,c,s));for(let d of this.renderers)this.disposables.add(d);let h;s.keyboardNavigationLabelProvider&&(h=new R3e(this,s.keyboardNavigationLabelProvider,s.filter),s=Object.assign(Object.assign({},s),{filter:h}),this.disposables.add(h)),this.focus=new pA(()=>this.view.getFocusedElements()[0],s.identityProvider),this.selection=new pA(()=>this.view.getSelectedElements()[0],s.identityProvider),this.anchor=new pA(()=>this.view.getAnchorElement(),s.identityProvider),this.view=new O3e(e,t,o,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},A3e(()=>this.model,s)),{tree:this})),this.model=this.createModel(e,this.view,s),a.input=this.model.onDidChangeCollapseState;const u=Re.forEach(this.model.onDidSplice,d=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(d),this.selection.onDidModelSplice(d)})});if(u(()=>null,null,this.disposables),l.input=Re.chain(Re.any(u,this.focus.onDidChange,this.selection.onDidChange)).debounce(()=>null,0).map(()=>{const d=new Set;for(const f of this.focus.getNodes())d.add(f);for(const f of this.selection.getNodes())d.add(f);return[...d.values()]}).event,s.keyboardSupport!==!1){const d=Re.chain(this.view.onKeyDown).filter(f=>!Ju(f.target)).map(f=>new bi(f));d.filter(f=>f.keyCode===15).on(this.onLeftArrow,this,this.disposables),d.filter(f=>f.keyCode===17).on(this.onRightArrow,this,this.disposables),d.filter(f=>f.keyCode===10).on(this.onSpace,this,this.disposables)}if(s.keyboardNavigationLabelProvider){const d=s.keyboardNavigationDelegate||Fte;this.typeFilterController=new M3e(this,this.model,this.view,h,d),this.focusNavigationFilter=f=>this.typeFilterController.shouldAllowFocus(f),this.disposables.add(this.typeFilterController)}this.styleElement=ho(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Zw.Always)}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Re.map(this.view.onMouseDblClick,Mz)}get onPointer(){return Re.map(this.view.onPointer,Mz)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options=Object.assign(Object.assign({},this._options),e);for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(Object.assign(Object.assign({},this._options),{enableKeyboardNavigation:this._options.simpleKeyboardNavigation})),this.typeFilterController&&this.typeFilterController.updateOptions(this._options),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===Zw.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}domFocus(){this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeIndentGuidesStroke.transparent(.4)}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){const i=e.map(s=>this.model.getNode(s));this.selection.set(i,t);const r=e.map(s=>this.model.getListIndex(s)).filter(s=>s>-1);this.view.setSelection(r,t,!0)}getSelection(){return this.selection.get()}setFocus(e,t){const i=e.map(s=>this.model.getNode(s));this.focus.set(i,t);const r=e.map(s=>this.model.getListIndex(s)).filter(s=>s>-1);this.view.setFocus(r,t,!0)}focusNext(e=1,t=!1,i,r=this.focusNavigationFilter){this.view.focusNext(e,t,i,r)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);i!==-1&&this.view.reveal(i,t)}getRelativeTop(e){const t=this.model.getListIndex(e);return t===-1?null:this.view.getRelativeTop(t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],r=this.model.getNodeLocation(i);if(!this.model.setCollapsed(r,!0)){const o=this.model.getParentNodeLocation(r);if(!o)return;const a=this.model.getListIndex(o);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],r=this.model.getNodeLocation(i);if(!this.model.setCollapsed(r,!1)){if(!i.children.some(l=>l.visible))return;const[o]=this.view.getFocus(),a=o+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],r=this.model.getNodeLocation(i),s=e.browserEvent.altKey;this.model.setCollapsed(r,void 0,s)}dispose(){mt(this.disposables),this.view.dispose()}}class lB{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new k3e(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(r,s){return i.sorter.compare(r.element,s.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=vt.empty(),i={}){const r=this.getElementLocation(e);this._setChildren(r,this.preserveCollapseState(t),i)}_setChildren(e,t=vt.empty(),i){const r=new Set,s=new Set,o=l=>{var c;if(l.element===null)return;const h=l;if(r.add(h.element),this.nodes.set(h.element,h),this.identityProvider){const u=this.identityProvider.getId(h.element).toString();s.add(u),this.nodesByIdentity.set(u,h)}(c=i.onDidCreateNode)===null||c===void 0||c.call(i,h)},a=l=>{var c;if(l.element===null)return;const h=l;if(r.has(h.element)||this.nodes.delete(h.element),this.identityProvider){const u=this.identityProvider.getId(h.element).toString();s.has(u)||this.nodesByIdentity.delete(u)}(c=i.onDidDeleteNode)===null||c===void 0||c.call(i,h)};this.model.splice([...e,0],Number.MAX_VALUE,t,Object.assign(Object.assign({},i),{onDidCreateNode:o,onDidDeleteNode:a}))}preserveCollapseState(e=vt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),vt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const o=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(o)}if(!i)return Object.assign(Object.assign({},t),{children:this.preserveCollapseState(t.children)});const r=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible,s=typeof t.collapsed<"u"?t.collapsed:i.collapsed;return Object.assign(Object.assign({},t),{collapsible:r,collapsed:s,children:this.preserveCollapseState(t.children)})})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const r=this.getElementLocation(e);return this.model.setCollapsed(r,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new to(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new to(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new to(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),r=this.model.getParentNodeLocation(i);return this.model.getNode(r).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new to(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function JS(n){const e=[n.element],t=n.incompressible||!1;return{element:{elements:e,incompressible:t},children:vt.map(vt.from(n.children),JS),collapsible:n.collapsible,collapsed:n.collapsed}}function ex(n){const e=[n.element],t=n.incompressible||!1;let i,r;for(;[r,i]=vt.consume(vt.from(n.children),2),!(r.length!==1||r[0].incompressible);)n=r[0],e.push(n.element);return{element:{elements:e,incompressible:t},children:vt.map(vt.concat(r,i),ex),collapsible:n.collapsible,collapsed:n.collapsed}}function UF(n,e=0){let t;return e<n.element.elements.length-1?t=[UF(n,e+1)]:t=vt.map(vt.from(n.children),i=>UF(i,0)),e===0&&n.element.incompressible?{element:n.element.elements[e],children:t,incompressible:!0,collapsible:n.collapsible,collapsed:n.collapsed}:{element:n.element.elements[e],children:t,collapsible:n.collapsible,collapsed:n.collapsed}}function Fz(n){return UF(n,0)}function Hte(n,e,t){return n.element===e?Object.assign(Object.assign({},n),{children:t}):Object.assign(Object.assign({},n),{children:vt.map(vt.from(n.children),i=>Hte(i,e,t))})}const P3e=n=>({getId(e){return e.elements.map(t=>n.getId(t).toString()).join("\0")}});class B3e{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new lB(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}setChildren(e,t=vt.empty(),i){const r=i.diffIdentityProvider&&P3e(i.diffIdentityProvider);if(e===null){const f=vt.map(t,this.enabled?ex:JS);this._setChildren(null,f,{diffIdentityProvider:r,diffDepth:1/0});return}const s=this.nodes.get(e);if(!s)throw new Error("Unknown compressed tree node");const o=this.model.getNode(s),a=this.model.getParentNodeLocation(s),l=this.model.getNode(a),c=Fz(o),h=Hte(c,e,t),u=(this.enabled?ex:JS)(h),d=l.children.map(f=>f===o?u:f);this._setChildren(l.element,d,{diffIdentityProvider:r,diffDepth:o.depth-l.depth})}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,r=vt.map(i,Fz),s=vt.map(r,e?ex:JS);this._setChildren(null,s,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const r=new Set,s=a=>{for(const l of a.element.elements)r.add(l),this.nodes.set(l,a.element)},o=a=>{for(const l of a.element.elements)r.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,Object.assign(Object.assign({},i),{onDidCreateNode:s,onDidDeleteNode:o}))}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const r=this.getCompressedNode(e);return this.model.setCollapsed(r,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new to(this.user,`Tree element not found: ${e}`);return t}}const V3e=n=>n[n.length-1];class cB{constructor(e,t){this.unwrapper=e,this.node=t}get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new cB(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}function W3e(n,e){return{splice(t,i,r){e.splice(t,i,r.map(s=>n.map(s)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function $3e(n,e){return Object.assign(Object.assign({},e),{identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(n(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(n(t),i)}}})}class z3e{constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||V3e;const r=s=>this.elementMapper(s.elements);this.nodeMapper=new sB(s=>new cB(r,s)),this.model=new B3e(e,W3e(this.nodeMapper,t),$3e(r,i))}get onDidSplice(){return Re.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return Re.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return Re.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}setChildren(e,t=vt.empty(),i={}){this.model.setChildren(e,t,i)}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var H3e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s};class hB extends zte{constructor(e,t,i,r,s={}){super(e,t,i,r,s)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(e,t=vt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new lB(e,t,i)}}class Ute{constructor(e,t){this._compressedTreeNodeProvider=e,this.renderer=t,this.templateId=t.templateId,t.onDidChangeTwistieState&&(this.onDidChangeTwistieState=t.onDidChangeTwistieState)}get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,r){const s=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element);s.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,r)):(i.compressedTreeNode=s,this.renderer.renderCompressedElements(s,t,i.data,r))}disposeElement(e,t,i,r){i.compressedTreeNode?this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(i.compressedTreeNode,t,i.data,r):this.renderer.disposeElement&&this.renderer.disposeElement(e,t,i.data,r)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}H3e([an],Ute.prototype,"compressedTreeNodeProvider",null);function U3e(n,e){return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=n().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}})}class jte extends hB{constructor(e,t,i,r,s={}){const o=()=>this,a=r.map(l=>new Ute(o,l));super(e,t,i,a,U3e(o,s))}setChildren(e,t=vt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new z3e(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}var Wh=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function mA(n){return Object.assign(Object.assign({},n),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function jF(n,e){return e.parent?e.parent===n?!0:jF(n,e.parent):!1}function j3e(n,e){return n===e||jF(n,e)||jF(e,n)}class uB{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new uB(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class q3e{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,r){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,r)}renderTwistie(e,t){return e.slow?(t.classList.add(...ED.classNamesArray),!0):(t.classList.remove(...ED.classNamesArray),!1)}disposeElement(e,t,i,r){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,i.templateData,r)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function Oz(n){return{browserEvent:n.browserEvent,elements:n.elements.map(e=>e.element)}}function Pz(n){return{browserEvent:n.browserEvent,element:n.element&&n.element.element,target:n.target}}class G3e extends xy{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function _A(n){return n instanceof xy?new G3e(n):n}class K3e{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(_A(e),t)}onDragOver(e,t,i,r,s=!0){return this.dnd.onDragOver(_A(e),t&&t.element,i,r)}drop(e,t,i,r){this.dnd.drop(_A(e),t&&t.element,i,r)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}function qte(n){return n&&Object.assign(Object.assign({},n),{collapseByDefault:!0,identityProvider:n.identityProvider&&{getId(e){return n.identityProvider.getId(e.element)}},dnd:n.dnd&&new K3e(n.dnd),multipleSelectionController:n.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return n.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},isSelectionRangeChangeEvent(e){return n.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))}},accessibilityProvider:n.accessibilityProvider&&Object.assign(Object.assign({},n.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:n.accessibilityProvider.getRole?e=>n.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:n.accessibilityProvider.isChecked?e=>{var t;return!!(!((t=n.accessibilityProvider)===null||t===void 0)&&t.isChecked(e.element))}:void 0,getAriaLabel(e){return n.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return n.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:n.accessibilityProvider.getWidgetRole?()=>n.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:n.accessibilityProvider.getAriaLevel&&(e=>n.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:n.accessibilityProvider.getActiveDescendantId&&(e=>n.accessibilityProvider.getActiveDescendantId(e.element))}),filter:n.filter&&{filter(e,t){return n.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:n.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},n.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel(e){return n.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}),sorter:void 0,expandOnlyOnTwistieClick:typeof n.expandOnlyOnTwistieClick>"u"?void 0:typeof n.expandOnlyOnTwistieClick!="function"?n.expandOnlyOnTwistieClick:e=>n.expandOnlyOnTwistieClick(e.element),additionalScrollHeight:n.additionalScrollHeight})}function qF(n,e){e(n),n.children.forEach(t=>qF(t,e))}class Gte{constructor(e,t,i,r,s,o={}){this.user=e,this.dataSource=s,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new H,this._onDidChangeNodeSlowState=new H,this.nodeMapper=new sB(a=>new uB(a)),this.disposables=new ve,this.identityProvider=o.identityProvider,this.autoExpandSingleChildren=typeof o.autoExpandSingleChildren>"u"?!1:o.autoExpandSingleChildren,this.sorter=o.sorter,this.collapseByDefault=o.collapseByDefault,this.tree=this.createTree(e,t,i,r,o),this.root=mA({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}get onDidChangeFocus(){return Re.map(this.tree.onDidChangeFocus,Oz)}get onDidChangeSelection(){return Re.map(this.tree.onDidChangeSelection,Oz)}get onMouseDblClick(){return Re.map(this.tree.onMouseDblClick,Pz)}get onPointer(){return Re.map(this.tree.onPointer,Pz)}get onDidFocus(){return this.tree.onDidFocus}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,i,r,s){const o=new aB(i),a=r.map(c=>new q3e(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=qte(s)||{};return new hB(e,t,o,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}setInput(e,t){return Wh(this,void 0,void 0,function*(){this.refreshPromises.forEach(r=>r.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};yield this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)})}_updateChildren(e=this.root.element,t=!0,i=!1,r,s){return Wh(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new to(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Re.toPromise(this._onDidRender.event));const o=this.getDataNode(e);if(yield this.refreshAndRenderNode(o,t,r,s),i)try{this.tree.rerender(o)}catch{}})}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}expand(e,t=!1){return Wh(this,void 0,void 0,function*(){if(typeof this.root.element>"u")throw new to(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Re.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(yield this.root.refreshPromise,yield Re.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const r=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(yield this.root.refreshPromise,yield Re.toPromise(this._onDidRender.event)),r})}setSelection(e,t){const i=e.map(r=>this.getDataNode(r));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(r=>this.getDataNode(r));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new to(this.user,`Data tree node not found: ${e}`);return t}refreshAndRenderNode(e,t,i,r){return Wh(this,void 0,void 0,function*(){yield this.refreshNode(e,t,i),this.render(e,i,r)})}refreshNode(e,t,i){return Wh(this,void 0,void 0,function*(){let r;return this.subTreeRefreshPromises.forEach((s,o)=>{!r&&j3e(o,e)&&(r=s.then(()=>this.refreshNode(e,t,i)))}),r||this.doRefreshSubTree(e,t,i)})}doRefreshSubTree(e,t,i){return Wh(this,void 0,void 0,function*(){let r;e.refreshPromise=new Promise(s=>r=s),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const s=yield this.doRefreshNode(e,t,i);e.stale=!1,yield DM.settled(s.map(o=>this.doRefreshSubTree(o,t,i)))}finally{r()}})}doRefreshNode(e,t,i){return Wh(this,void 0,void 0,function*(){e.hasChildren=!!this.dataSource.hasChildren(e.element);let r;if(!e.hasChildren)r=Promise.resolve(vt.empty());else{const s=dw(800);s.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},o=>null),r=this.doGetChildren(e).finally(()=>s.cancel())}try{const s=yield r;return this.setChildren(e,s,t,i)}catch(s){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),gd(s))return[];throw s}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}})}doGetChildren(e){let t=this.refreshPromises.get(e);return t||(t=Hs(()=>Wh(this,void 0,void 0,function*(){const i=yield this.dataSource.getChildren(e.element);return this.processChildren(i)})),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(it))}setChildren(e,t,i,r){const s=[...t];if(e.children.length===0&&s.length===0)return[];const o=new Map,a=new Map;for(const h of e.children)if(o.set(h.element,h),this.identityProvider){const u=this.tree.isCollapsed(h);a.set(h.id,{node:h,collapsed:u})}const l=[],c=s.map(h=>{const u=!!this.dataSource.hasChildren(h);if(!this.identityProvider){const p=mA({element:h,parent:e,hasChildren:u});return u&&this.collapseByDefault&&!this.collapseByDefault(h)&&(p.collapsedByDefault=!1,l.push(p)),p}const d=this.identityProvider.getId(h).toString(),f=a.get(d);if(f){const p=f.node;return o.delete(p.element),this.nodes.delete(p.element),this.nodes.set(h,p),p.element=h,p.hasChildren=u,i?f.collapsed?(p.children.forEach(m=>qF(m,b=>this.nodes.delete(b.element))),p.children.splice(0,p.children.length),p.stale=!0):l.push(p):u&&this.collapseByDefault&&!this.collapseByDefault(h)&&(p.collapsedByDefault=!1,l.push(p)),p}const g=mA({element:h,parent:e,id:d,hasChildren:u});return r&&r.viewState.focus&&r.viewState.focus.indexOf(d)>-1&&r.focus.push(g),r&&r.viewState.selection&&r.viewState.selection.indexOf(d)>-1&&r.selection.push(g),r&&r.viewState.expanded&&r.viewState.expanded.indexOf(d)>-1?l.push(g):u&&this.collapseByDefault&&!this.collapseByDefault(h)&&(g.collapsedByDefault=!1,l.push(g)),g});for(const h of o.values())qF(h,u=>this.nodes.delete(u.element));for(const h of c)this.nodes.set(h.element,h);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].collapsedByDefault=!1,l.push(c[0])),l}render(e,t,i){const r=e.children.map(o=>this.asTreeElement(o,t)),s=i&&Object.assign(Object.assign({},i),{diffIdentityProvider:i.diffIdentityProvider&&{getId(o){return i.diffIdentityProvider.getId(o.element)}}});this.tree.setChildren(e===this.root?null:e,r,s),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:i=e.collapsedByDefault,e.collapsedByDefault=void 0,{element:e,children:e.hasChildren?vt.map(e.children,r=>this.asTreeElement(r,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose()}}class dB{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new dB(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class Z3e{constructor(e,t,i,r){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=r,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,r){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,r)}renderCompressedElements(e,t,i,r){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,r)}renderTwistie(e,t){return e.slow?(t.classList.add(...ED.classNamesArray),!0):(t.classList.remove(...ED.classNamesArray),!1)}disposeElement(e,t,i,r){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,i.templateData,r)}disposeCompressedElements(e,t,i,r){this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,r)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=mt(this.disposables)}}function Y3e(n){const e=n&&qte(n);return e&&Object.assign(Object.assign({},e),{keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel(t){return n.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}})})}class X3e extends Gte{constructor(e,t,i,r,s,o,a={}){super(e,t,i,s,o,a),this.compressionDelegate=r,this.compressibleNodeMapper=new sB(l=>new dB(l)),this.filter=a.filter}createTree(e,t,i,r,s){const o=new aB(i),a=r.map(c=>new Z3e(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=Y3e(s)||{};return new jte(e,t,o,a,l)}asTreeElement(e,t){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(e.element)},super.asTreeElement(e,t))}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t){if(!this.identityProvider)return super.render(e,t);const i=d=>this.identityProvider.getId(d).toString(),r=d=>{const f=new Set;for(const g of d){const p=this.tree.getCompressedTreeNode(g===this.root?null:g);if(p.element)for(const m of p.element.elements)f.add(i(m.element))}return f},s=r(this.tree.getSelection()),o=r(this.tree.getFocus());super.render(e,t);const a=this.getSelection();let l=!1;const c=this.getFocus();let h=!1;const u=d=>{const f=d.element;if(f)for(let g=0;g<f.elements.length;g++){const p=i(f.elements[g].element),m=f.elements[f.elements.length-1].element;s.has(p)&&a.indexOf(m)===-1&&(a.push(m),l=!0),o.has(p)&&c.indexOf(m)===-1&&(c.push(m),h=!0)}d.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),l&&this.setSelection(a),h&&this.setFocus(c)}processChildren(e){return this.filter&&(e=vt.filter(e,t=>{const i=this.filter.filter(t,1),r=Q3e(i);if(r===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return r===1})),super.processChildren(e)}}function Q3e(n){return typeof n=="boolean"?n?1:0:oB(n)?Kw(n.visibility):Kw(n)}class J3e extends zte{constructor(e,t,i,r,s,o={}){super(e,t,i,r,o),this.user=e,this.dataSource=s,this.identityProvider=o.identityProvider}createModel(e,t,i){return new lB(e,t,i)}}new Te("isWindows",Kn,v("isWindows","Whether the operating system is Windows"));const e5e="inputFocus";var mc=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},ot=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const vo=Dt("listService");let GF=class{constructor(e){this._themeService=e,this.disposables=new ve,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}get lastFocusedList(){return this._lastFocusedWidget}register(e,t){if(!this._hasCreatedStyleController){this._hasCreatedStyleController=!0;const r=new Vte(ho(),"");this.disposables.add(pg(r,this._themeService))}if(this.lists.some(r=>r.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),e.getHTMLElement()===document.activeElement&&(this._lastFocusedWidget=e),Cu(e.onDidFocus(()=>this._lastFocusedWidget=e),Et(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(r=>r!==i),this._lastFocusedWidget===e&&(this._lastFocusedWidget=void 0)}))}dispose(){this.disposables.dispose()}};GF=mc([ot(0,fi)],GF);const Kte=new Te("listFocus",!0),BL=new Te("listSupportsMultiselect",!0),Zte=Ie.and(Kte,Ie.not(e5e)),fB=new Te("listHasSelectionOrFocus",!1),gB=new Te("listDoubleSelection",!1),pB=new Te("listMultiSelection",!1),VL=new Te("listSelectionNavigation",!1),Yte="listAutomaticKeyboardNavigation";function WL(n,e){const t=n.createScoped(e.getHTMLElement());return Kte.bindTo(t),t}const Xg="workbench.list.multiSelectModifier",KF="workbench.list.openMode",co="workbench.list.horizontalScrolling",DD="workbench.list.keyboardNavigation",mB="workbench.list.automaticKeyboardNavigation",Xw="workbench.tree.indent",kD="workbench.tree.renderIndentGuides",Ya="workbench.list.smoothScrolling",lc="workbench.list.mouseWheelScrollSensitivity",cc="workbench.list.fastScrollSensitivity",LD="workbench.tree.expandMode";function hc(n){return n.getValue(Xg)==="alt"}class t5e extends re{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=hc(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Xg)&&(this.useAltAsMultipleSelectionModifier=hc(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:Ote(e)}isSelectionRangeChangeEvent(e){return Pte(e)}}function $L(n,e,t){var i;const r=new ve;return[Object.assign(Object.assign({},n),{keyboardNavigationDelegate:{mightProducePrintableCharacter(o){return t.mightProducePrintableCharacter(o)}},smoothScrolling:!!e.getValue(Ya),mouseWheelScrollSensitivity:e.getValue(lc),fastScrollSensitivity:e.getValue(cc),multipleSelectionController:(i=n.multipleSelectionController)!==null&&i!==void 0?i:r.add(new t5e(e))}),r]}let ZF=class extends pc{constructor(e,t,i,r,s,o,a,l,c,h){const u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!c.getValue(co),[d,f]=$L(s,c,h);super(e,t,i,r,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},wa(l.getColorTheme(),FL)),d),{horizontalScrolling:u})),this.disposables.add(f),this.contextKeyService=WL(o,this),this.themeService=l,this.listSupportsMultiSelect=BL.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),VL.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=fB.bindTo(this.contextKeyService),this.listDoubleSelection=gB.bindTo(this.contextKeyService),this.listMultiSelection=pB.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=hc(c),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),s.overrideStyles&&this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const p=this.getSelection(),m=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(p.length>0||m.length>0),this.listMultiSelection.set(p.length>1),this.listDoubleSelection.set(p.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const p=this.getSelection(),m=this.getFocus();this.listHasSelectionOrFocus.set(p.length>0||m.length>0)})),this.disposables.add(c.onDidChangeConfiguration(p=>{p.affectsConfiguration(Xg)&&(this._useAltAsMultipleSelectionModifier=hc(c));let m={};if(p.affectsConfiguration(co)&&this.horizontalScrolling===void 0){const b=!!c.getValue(co);m=Object.assign(Object.assign({},m),{horizontalScrolling:b})}if(p.affectsConfiguration(Ya)){const b=!!c.getValue(Ya);m=Object.assign(Object.assign({},m),{smoothScrolling:b})}if(p.affectsConfiguration(lc)){const b=c.getValue(lc);m=Object.assign(Object.assign({},m),{mouseWheelScrollSensitivity:b})}if(p.affectsConfiguration(cc)){const b=c.getValue(cc);m=Object.assign(Object.assign({},m),{fastScrollSensitivity:b})}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new Xte(this,Object.assign({configurationService:c},s)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;(t=this._styler)===null||t===void 0||t.dispose(),this._styler=pg(this,this.themeService,e)}dispose(){var e;(e=this._styler)===null||e===void 0||e.dispose(),super.dispose()}};ZF=mc([ot(5,Xe),ot(6,vo),ot(7,fi),ot(8,Zi),ot(9,Yi)],ZF);let Bz=class extends y3e{constructor(e,t,i,r,s,o,a,l,c,h){const u=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!c.getValue(co),[d,f]=$L(s,c,h);super(e,t,i,r,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},wa(l.getColorTheme(),FL)),d),{horizontalScrolling:u})),this.disposables=new ve,this.disposables.add(f),this.contextKeyService=WL(o,this),this.themeService=l,this.horizontalScrolling=s.horizontalScrolling,this.listSupportsMultiSelect=BL.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),VL.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this._useAltAsMultipleSelectionModifier=hc(c),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),s.overrideStyles&&this.updateStyles(s.overrideStyles),s.overrideStyles&&this.disposables.add(pg(this,l,s.overrideStyles)),this.disposables.add(c.onDidChangeConfiguration(p=>{p.affectsConfiguration(Xg)&&(this._useAltAsMultipleSelectionModifier=hc(c));let m={};if(p.affectsConfiguration(co)&&this.horizontalScrolling===void 0){const b=!!c.getValue(co);m=Object.assign(Object.assign({},m),{horizontalScrolling:b})}if(p.affectsConfiguration(Ya)){const b=!!c.getValue(Ya);m=Object.assign(Object.assign({},m),{smoothScrolling:b})}if(p.affectsConfiguration(lc)){const b=c.getValue(lc);m=Object.assign(Object.assign({},m),{mouseWheelScrollSensitivity:b})}if(p.affectsConfiguration(cc)){const b=c.getValue(cc);m=Object.assign(Object.assign({},m),{fastScrollSensitivity:b})}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new Xte(this,Object.assign({configurationService:c},s)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;(t=this._styler)===null||t===void 0||t.dispose(),this._styler=pg(this,this.themeService,e)}dispose(){var e;(e=this._styler)===null||e===void 0||e.dispose(),this.disposables.dispose(),super.dispose()}};Bz=mc([ot(5,Xe),ot(6,vo),ot(7,fi),ot(8,Zi),ot(9,Yi)],Bz);let Vz=class extends PL{constructor(e,t,i,r,s,o,a,l,c,h,u){const d=typeof o.horizontalScrolling<"u"?o.horizontalScrolling:!!h.getValue(co),[f,g]=$L(o,h,u);super(e,t,i,r,s,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},wa(c.getColorTheme(),FL)),f),{horizontalScrolling:d})),this.disposables=new ve,this.disposables.add(g),this.contextKeyService=WL(a,this),this.themeService=c,this.listSupportsMultiSelect=BL.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(o.multipleSelectionSupport!==!1),VL.bindTo(this.contextKeyService).set(!!o.selectionNavigation),this.listHasSelectionOrFocus=fB.bindTo(this.contextKeyService),this.listDoubleSelection=gB.bindTo(this.contextKeyService),this.listMultiSelection=pB.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=hc(h),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),o.overrideStyles&&this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const m=this.getSelection(),b=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(m.length>0||b.length>0),this.listMultiSelection.set(m.length>1),this.listDoubleSelection.set(m.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const m=this.getSelection(),b=this.getFocus();this.listHasSelectionOrFocus.set(m.length>0||b.length>0)})),this.disposables.add(h.onDidChangeConfiguration(m=>{m.affectsConfiguration(Xg)&&(this._useAltAsMultipleSelectionModifier=hc(h));let b={};if(m.affectsConfiguration(co)&&this.horizontalScrolling===void 0){const _=!!h.getValue(co);b=Object.assign(Object.assign({},b),{horizontalScrolling:_})}if(m.affectsConfiguration(Ya)){const _=!!h.getValue(Ya);b=Object.assign(Object.assign({},b),{smoothScrolling:_})}if(m.affectsConfiguration(lc)){const _=h.getValue(lc);b=Object.assign(Object.assign({},b),{mouseWheelScrollSensitivity:_})}if(m.affectsConfiguration(cc)){const _=h.getValue(cc);b=Object.assign(Object.assign({},b),{fastScrollSensitivity:_})}Object.keys(b).length>0&&this.updateOptions(b)})),this.navigator=new i5e(this,Object.assign({configurationService:h},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;(t=this._styler)===null||t===void 0||t.dispose(),this._styler=pg(this,this.themeService,e)}dispose(){var e;(e=this._styler)===null||e===void 0||e.dispose(),this.disposables.dispose(),super.dispose()}};Vz=mc([ot(6,Xe),ot(7,vo),ot(8,fi),ot(9,Zi),ot(10,Yi)],Vz);class _B extends re{constructor(e,t){var i;super(),this.widget=e,this._onDidOpen=this._register(new H),this.onDidOpen=this._onDidOpen.event,this._register(Re.filter(this.widget.onDidChangeSelection,r=>r.browserEvent instanceof KeyboardEvent)(r=>this.onSelectionFromKeyboard(r))),this._register(this.widget.onPointer(r=>this.onPointer(r.element,r.browserEvent))),this._register(this.widget.onMouseDblClick(r=>this.onMouseDblClick(r.element,r.browserEvent))),typeof(t==null?void 0:t.openOnSingleClick)!="boolean"&&(t!=null&&t.configurationService)?(this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(KF))!=="doubleClick",this._register(t==null?void 0:t.configurationService.onDidChangeConfiguration(()=>{this.openOnSingleClick=(t==null?void 0:t.configurationService.getValue(KF))!=="doubleClick"}))):this.openOnSingleClick=(i=t==null?void 0:t.openOnSingleClick)!==null&&i!==void 0?i:!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,r=typeof t.pinned=="boolean"?t.pinned:!i,s=!1;this._open(this.getSelectedElement(),i,r,s,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const r=t.button===1,s=!0,o=r,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,s,o,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const s=!1,o=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,s,o,a,t)}_open(e,t,i,r,s){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:r,element:e,browserEvent:s})}}class Xte extends _B{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class i5e extends _B{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class n5e extends _B{constructor(e,t){super(e,t)}getSelectedElement(){var e;return(e=this.widget.getSelection()[0])!==null&&e!==void 0?e:void 0}}function r5e(n,e){let t=!1;return i=>{if(t)return t=!1,!1;const r=e.softDispatch(i,n);return r&&r.enterChord?(t=!0,!1):(t=!1,!0)}}let Wz=class extends hB{constructor(e,t,i,r,s,o,a,l,c,h,u){const{options:d,getAutomaticKeyboardNavigation:f,disposable:g}=Dy(t,s,o,c,h,u);super(e,t,i,r,d),this.disposables.add(g),this.internals=new mg(this,s,f,s.overrideStyles,o,a,l,c,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};Wz=mc([ot(5,Xe),ot(6,vo),ot(7,fi),ot(8,Zi),ot(9,Yi),ot(10,ps)],Wz);let $z=class extends jte{constructor(e,t,i,r,s,o,a,l,c,h,u){const{options:d,getAutomaticKeyboardNavigation:f,disposable:g}=Dy(t,s,o,c,h,u);super(e,t,i,r,d),this.disposables.add(g),this.internals=new mg(this,s,f,s.overrideStyles,o,a,l,c,u),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};$z=mc([ot(5,Xe),ot(6,vo),ot(7,fi),ot(8,Zi),ot(9,Yi),ot(10,ps)],$z);let zz=class extends J3e{constructor(e,t,i,r,s,o,a,l,c,h,u,d){const{options:f,getAutomaticKeyboardNavigation:g,disposable:p}=Dy(t,o,a,h,u,d);super(e,t,i,r,s,f),this.disposables.add(p),this.internals=new mg(this,o,g,o.overrideStyles,a,l,c,h,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};zz=mc([ot(6,Xe),ot(7,vo),ot(8,fi),ot(9,Zi),ot(10,Yi),ot(11,ps)],zz);let YF=class extends Gte{constructor(e,t,i,r,s,o,a,l,c,h,u,d){const{options:f,getAutomaticKeyboardNavigation:g,disposable:p}=Dy(t,o,a,h,u,d);super(e,t,i,r,s,f),this.disposables.add(p),this.internals=new mg(this,o,g,o.overrideStyles,a,l,c,h,d),this.disposables.add(this.internals)}get onDidOpen(){return this.internals.onDidOpen}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};YF=mc([ot(6,Xe),ot(7,vo),ot(8,fi),ot(9,Zi),ot(10,Yi),ot(11,ps)],YF);let Hz=class extends X3e{constructor(e,t,i,r,s,o,a,l,c,h,u,d,f){const{options:g,getAutomaticKeyboardNavigation:p,disposable:m}=Dy(t,a,l,u,d,f);super(e,t,i,r,s,o,g),this.disposables.add(m),this.internals=new mg(this,a,p,a.overrideStyles,l,c,h,u,f),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};Hz=mc([ot(7,Xe),ot(8,vo),ot(9,fi),ot(10,Zi),ot(11,Yi),ot(12,ps)],Hz);function Dy(n,e,t,i,r,s){var o;const a=()=>{let g=!!t.getContextKeyValue(Yte);return g&&(g=!!i.getValue(mB)),g},l=s.isScreenReaderOptimized(),c=e.simpleKeyboardNavigation||l?"simple":i.getValue(DD),h=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!i.getValue(co),[u,d]=$L(e,i,r),f=e.additionalScrollHeight;return{getAutomaticKeyboardNavigation:a,disposable:d,options:Object.assign(Object.assign({keyboardSupport:!1},u),{indent:typeof i.getValue(Xw)=="number"?i.getValue(Xw):void 0,renderIndentGuides:i.getValue(kD),smoothScrolling:!!i.getValue(Ya),automaticKeyboardNavigation:a(),simpleKeyboardNavigation:c==="simple",filterOnType:c==="filter",horizontalScrolling:h,keyboardNavigationEventFilter:r5e(n,r),additionalScrollHeight:f,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:(o=e.expandOnlyOnTwistieClick)!==null&&o!==void 0?o:i.getValue(LD)==="doubleClick"})}}let mg=class{constructor(e,t,i,r,s,o,a,l,c){this.tree=e,this.themeService=a,this.disposables=[],this.contextKeyService=WL(s,e),this.listSupportsMultiSelect=BL.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),VL.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.hasSelectionOrFocus=fB.bindTo(this.contextKeyService),this.hasDoubleSelection=gB.bindTo(this.contextKeyService),this.hasMultiSelection=pB.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=hc(l);const u=new Set;u.add(Yte);const d=()=>{const g=c.isScreenReaderOptimized()?"simple":l.getValue(DD);e.updateOptions({simpleKeyboardNavigation:g==="simple",filterOnType:g==="filter"})};this.updateStyleOverrides(r),this.disposables.push(this.contextKeyService,o.register(e),e.onDidChangeSelection(()=>{const f=e.getSelection(),g=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(f.length>0||g.length>0),this.hasMultiSelection.set(f.length>1),this.hasDoubleSelection.set(f.length===2)})}),e.onDidChangeFocus(()=>{const f=e.getSelection(),g=e.getFocus();this.hasSelectionOrFocus.set(f.length>0||g.length>0)}),l.onDidChangeConfiguration(f=>{let g={};if(f.affectsConfiguration(Xg)&&(this._useAltAsMultipleSelectionModifier=hc(l)),f.affectsConfiguration(Xw)){const p=l.getValue(Xw);g=Object.assign(Object.assign({},g),{indent:p})}if(f.affectsConfiguration(kD)){const p=l.getValue(kD);g=Object.assign(Object.assign({},g),{renderIndentGuides:p})}if(f.affectsConfiguration(Ya)){const p=!!l.getValue(Ya);g=Object.assign(Object.assign({},g),{smoothScrolling:p})}if(f.affectsConfiguration(DD)&&d(),f.affectsConfiguration(mB)&&(g=Object.assign(Object.assign({},g),{automaticKeyboardNavigation:i()})),f.affectsConfiguration(co)&&t.horizontalScrolling===void 0){const p=!!l.getValue(co);g=Object.assign(Object.assign({},g),{horizontalScrolling:p})}if(f.affectsConfiguration(LD)&&t.expandOnlyOnTwistieClick===void 0&&(g=Object.assign(Object.assign({},g),{expandOnlyOnTwistieClick:l.getValue(LD)==="doubleClick"})),f.affectsConfiguration(lc)){const p=l.getValue(lc);g=Object.assign(Object.assign({},g),{mouseWheelScrollSensitivity:p})}if(f.affectsConfiguration(cc)){const p=l.getValue(cc);g=Object.assign(Object.assign({},g),{fastScrollSensitivity:p})}Object.keys(g).length>0&&e.updateOptions(g)}),this.contextKeyService.onDidChangeContext(f=>{f.affectsSome(u)&&e.updateOptions({automaticKeyboardNavigation:i()})}),c.onDidChangeScreenReaderOptimized(()=>d())),this.navigator=new n5e(e,Object.assign({configurationService:l},t)),this.disposables.push(this.navigator)}get onDidOpen(){return this.navigator.onDidOpen}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){mt(this.styler),this.styler=e?pg(this.tree,this.themeService,e):re.None}dispose(){this.disposables=mt(this.disposables),mt(this.styler),this.styler=void 0}};mg=mc([ot(4,Xe),ot(5,vo),ot(6,fi),ot(7,Zi),ot(8,ps)],mg);const s5e=Bn.as(b0.Configuration);s5e.registerConfiguration({id:"workbench",order:7,title:v("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Xg]:{type:"string",enum:["ctrlCmd","alt"],enumDescriptions:[v("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),v("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:v({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[KF]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:v({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[co]:{type:"boolean",default:!1,description:v("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Xw]:{type:"number",default:8,minimum:0,maximum:40,description:v("tree indent setting","Controls tree indentation in pixels.")},[kD]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:v("render tree indent guides","Controls whether the tree should render indent guides.")},[Ya]:{type:"boolean",default:!1,description:v("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[lc]:{type:"number",default:1,description:v("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[cc]:{type:"number",default:5,description:v("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[DD]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[v("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),v("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),v("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:v("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter.")},[mB]:{type:"boolean",default:!0,markdownDescription:v("automatic keyboard navigation setting","Controls whether keyboard navigation in lists and trees is automatically triggered simply by typing. If set to `false`, keyboard navigation is only triggered when executing the `list.toggleKeyboardNavigation` command, for which you can assign a keyboard shortcut.")},[LD]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:v("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")}}});var _i;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(_i||(_i={}));(function(n){function e(o,a){return a-o}n.compare=e;const t=Object.create(null);t[n.Error]=v("sev.error","Error"),t[n.Warning]=v("sev.warning","Warning"),t[n.Info]=v("sev.info","Info");function i(o){return t[o]||""}n.toString=i;function r(o){switch(o){case Li.Error:return n.Error;case Li.Warning:return n.Warning;case Li.Info:return n.Info;case Li.Ignore:return n.Hint}}n.fromSeverity=r;function s(o){switch(o){case n.Error:return Li.Error;case n.Warning:return Li.Warning;case n.Info:return Li.Info;case n.Hint:return Li.Ignore}}n.toSeverity=s})(_i||(_i={}));var ID;(function(n){const e="";function t(r){return i(r,!0)}n.makeKey=t;function i(r,s){let o=[e];return r.source?o.push(r.source.replace("","\\")):o.push(e),r.code?typeof r.code=="string"?o.push(r.code.replace("","\\")):o.push(r.code.value.replace("","\\")):o.push(e),r.severity!==void 0&&r.severity!==null?o.push(_i.toString(r.severity)):o.push(e),r.message&&s?o.push(r.message.replace("","\\")):o.push(e),r.startLineNumber!==void 0&&r.startLineNumber!==null?o.push(r.startLineNumber.toString()):o.push(e),r.startColumn!==void 0&&r.startColumn!==null?o.push(r.startColumn.toString()):o.push(e),r.endLineNumber!==void 0&&r.endLineNumber!==null?o.push(r.endLineNumber.toString()):o.push(e),r.endColumn!==void 0&&r.endColumn!==null?o.push(r.endColumn.toString()):o.push(e),o.push(e),o.join("")}n.makeKeyOptionalMessage=i})(ID||(ID={}));const ky=Dt("markerService");class o5e{constructor(){this._byResource=new _r,this._byOwner=new Map}set(e,t,i){let r=this._byResource.get(e);r||(r=new Map,this._byResource.set(e,r)),r.set(t,i);let s=this._byOwner.get(t);s||(s=new _r,this._byOwner.set(t,s)),s.set(e,i)}get(e,t){let i=this._byResource.get(e);return i==null?void 0:i.get(t)}delete(e,t){let i=!1,r=!1,s=this._byResource.get(e);s&&(i=s.delete(t));let o=this._byOwner.get(t);if(o&&(r=o.delete(e)),i!==r)throw new Error("illegal state");return i&&r}values(e){var t,i,r,s;return typeof e=="string"?(i=(t=this._byOwner.get(e))===null||t===void 0?void 0:t.values())!==null&&i!==void 0?i:vt.empty():qe.isUri(e)?(s=(r=this._byResource.get(e))===null||r===void 0?void 0:r.values())!==null&&s!==void 0?s:vt.empty():vt.map(vt.concat(...this._byOwner.values()),o=>o[1])}}class a5e{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new _r,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const r=this._resourceStats(t);this._add(r),this._data.set(t,r)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(e.scheme===ft.inMemory||e.scheme===ft.walkThrough||e.scheme===ft.walkThroughSnippet)return t;for(const{severity:i}of this._service.read({resource:e}))i===_i.Error?t.errors+=1:i===_i.Warning?t.warnings+=1:i===_i.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class Ud{constructor(){this._onMarkerChanged=new DDe({delay:0,merge:Ud._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new o5e,this._stats=new a5e(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(bJ(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const r=[];for(const s of i){const o=Ud._toMarker(e,t,s);o&&r.push(o)}this._data.set(t,e,r),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:r,severity:s,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:h,endColumn:u,relatedInformation:d,tags:f}=i;if(o)return l=l>0?l:1,c=c>0?c:1,h=h>=l?h:l,u=u>0?u:c,{resource:t,owner:e,code:r,severity:s,message:o,source:a,startLineNumber:l,startColumn:c,endLineNumber:h,endColumn:u,relatedInformation:d,tags:f}}read(e=Object.create(null)){let{owner:t,resource:i,severities:r,take:s}=e;if((!s||s<0)&&(s=-1),t&&i){const o=this._data.get(i,t);if(o){const a=[];for(const l of o)if(Ud._accept(l,r)){const c=a.push(l);if(s>0&&c===s)break}return a}else return[]}else if(!t&&!i){const o=[];for(let a of this._data.values())for(let l of a)if(Ud._accept(l,r)){const c=o.push(l);if(s>0&&c===s)return o}return o}else{const o=this._data.values(i??t),a=[];for(const l of o)for(const c of l)if(Ud._accept(c,r)){const h=a.push(c);if(s>0&&h===s)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new _r;for(let i of e)for(let r of i)t.set(r,!0);return Array.from(t.keys())}}var tx=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},om;(function(n){n[n.None=0]="None",n[n.Initialized=1]="Initialized",n[n.Closed=2]="Closed"})(om||(om={}));class Qw extends re{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new H),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=om.None,this.cache=new Map,this.flushDelayer=new ske(Qw.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;(t=e.changed)===null||t===void 0||t.forEach((r,s)=>this.accept(s,r)),(i=e.deleted)===null||i===void 0||i.forEach(r=>this.accept(r,void 0))}accept(e,t){if(this.state===om.Closed)return;let i=!1;Xs(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire(e)}get(e,t){const i=this.cache.get(e);return Xs(i)?t:i}getBoolean(e,t){const i=this.get(e);return Xs(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return Xs(i)?t:parseInt(i,10)}set(e,t){return tx(this,void 0,void 0,function*(){if(this.state===om.Closed)return;if(Xs(t))return this.delete(e);const i=String(t);if(this.cache.get(e)!==i)return this.cache.set(e,i),this.pendingInserts.set(e,i),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire(e),this.flushDelayer.trigger(()=>this.flushPending())})}delete(e){return tx(this,void 0,void 0,function*(){if(!(this.state===om.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire(e),this.flushDelayer.trigger(()=>this.flushPending())})}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return tx(this,void 0,void 0,function*(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())===null||t===void 0||t()})})}dispose(){this.flushDelayer.dispose(),super.dispose()}}Qw.DEFAULT_FLUSH_DELAY=100;class Uz{constructor(){this.onDidChangeItemsExternal=Re.None,this.items=new Map}updateItems(e){return tx(this,void 0,void 0,function*(){e.insert&&e.insert.forEach((t,i)=>this.items.set(i,t)),e.delete&&e.delete.forEach(t=>this.items.delete(t))})}}const VC="__$__targetStorageMarker",Qg=Dt("storageService");var XF;(function(n){n[n.NONE=0]="NONE",n[n.SHUTDOWN=1]="SHUTDOWN"})(XF||(XF={}));class zL extends re{constructor(e={flushInterval:zL.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new fE),this._onDidChangeTarget=this._register(new fE),this._onWillSaveState=this._register(new H),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}emitDidChangeValue(e,t){t===VC?(e===0?this._globalKeyTargets=void 0:e===1&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope:e})):this._onDidChangeValue.fire({scope:e,key:t,target:this.getKeyTargets(e)[t]})}get(e,t,i){var r;return(r=this.getStorage(t))===null||r===void 0?void 0:r.get(e,i)}getBoolean(e,t,i){var r;return(r=this.getStorage(t))===null||r===void 0?void 0:r.getBoolean(e,i)}getNumber(e,t,i){var r;return(r=this.getStorage(t))===null||r===void 0?void 0:r.getNumber(e,i)}store(e,t,i,r){if(Xs(t)){this.remove(e,i);return}this.withPausedEmitters(()=>{var s;this.updateKeyTarget(e,i,r),(s=this.getStorage(i))===null||s===void 0||s.set(e,t)})}remove(e,t){this.withPausedEmitters(()=>{var i;this.updateKeyTarget(e,t,void 0),(i=this.getStorage(t))===null||i===void 0||i.delete(e)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i){var r,s;const o=this.getKeyTargets(t);typeof i=="number"?o[e]!==i&&(o[e]=i,(r=this.getStorage(t))===null||r===void 0||r.set(VC,JSON.stringify(o))):typeof o[e]=="number"&&(delete o[e],(s=this.getStorage(t))===null||s===void 0||s.set(VC,JSON.stringify(o)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(e){return e===0?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(e){const t=this.get(VC,e);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}}zL.DEFAULT_FLUSH_INTERVAL=60*1e3;class l5e extends zL{constructor(){super(),this.globalStorage=this._register(new Qw(new Uz)),this.workspaceStorage=this._register(new Qw(new Uz)),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.globalStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e)))}getStorage(e){return e===0?this.globalStorage:this.workspaceStorage}}var Qte=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},ix=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let QF=class{constructor(e){this._commandService=e}createMenu(e,t,i){return new JF(e,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},i),this._commandService,t,this)}};QF=Qte([ix(0,An)],QF);let JF=class Wp{constructor(e,t,i,r,s){this._id=e,this._options=t,this._commandService=i,this._contextKeyService=r,this._menuService=s,this._disposables=new ve,this._menuGroups=[],this._contextKeys=new Set,this._build();const o=new yi(()=>{this._build(),this._onDidChange.fire(this)},t.eventDebounceDelay);this._disposables.add(o),this._disposables.add(Pa.onDidChangeMenu(c=>{c.has(e)&&o.schedule()}));const a=this._disposables.add(new ve),l=()=>{const c=new yi(()=>this._onDidChange.fire(this),t.eventDebounceDelay);a.add(c),a.add(r.onDidChangeContext(h=>{h.affectsSome(this._contextKeys)&&c.schedule()}))};this._onDidChange=new H({onFirstListenerAdd:l,onLastListenerRemove:a.clear.bind(a)}),this.onDidChange=this._onDidChange.event}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}_build(){this._menuGroups.length=0,this._contextKeys.clear();const e=Pa.getMenuItems(this._id);let t;e.sort(Wp._compareMenuItems);for(const i of e){const r=i.group||"";(!t||t[0]!==r)&&(t=[r,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeys(i)}}_collectContextKeys(e){if(Wp._fillInKbExprKeys(e.when,this._contextKeys),yb(e)){if(e.command.precondition&&Wp._fillInKbExprKeys(e.command.precondition,this._contextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;Wp._fillInKbExprKeys(t,this._contextKeys)}}else this._options.emitEventsForSubmenuChanges&&Pa.getMenuItems(e.submenu).forEach(this._collectContextKeys,this)}getActions(e){const t=[];for(let i of this._menuGroups){const[r,s]=i,o=[];for(const a of s)if(this._contextKeyService.contextMatchesRules(a.when)){const l=yb(a)?new Ku(a.command,a.alt,e,this._contextKeyService,this._commandService):new jJ(a,this._menuService,this._contextKeyService,e);o.push(l)}o.length>0&&t.push([r,o])}return t}static _fillInKbExprKeys(e,t){if(e)for(let i of e.keys())t.add(i)}static _compareMenuItems(e,t){let i=e.group,r=t.group;if(i!==r){if(i){if(!r)return-1}else return 1;if(i==="navigation")return-1;if(r==="navigation")return 1;let a=i.localeCompare(r);if(a!==0)return a}let s=e.order||0,o=t.order||0;return s<o?-1:s>o?1:Wp._compareTitles(yb(e)?e.command.title:e.title,yb(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,r=typeof t=="string"?t:t.original;return i.localeCompare(r)}};JF=Qte([ix(2,An),ix(3,Xe),ix(4,w0)],JF);var c5e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},jz=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class h5e extends re{constructor(e){super(),this.model=e,this._markersData=new Map,this._register(Et(()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()}))}update(e,t){const i=[...this._markersData.keys()];this._markersData.clear();const r=this.model.deltaDecorations(i,t);for(let s=0;s<r.length;s++)this._markersData.set(r[s],e[s]);return i.length!==0||r.length!==0}getMarker(e){return this._markersData.get(e.id)}}let eO=class extends re{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new H),this._markerDecorations=new _r,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new h5e(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===ft.inMemory||e.uri.scheme===ft.internal||e.uri.scheme===ft.vscode)&&this._markerService&&this._markerService.read({resource:e.uri}).map(i=>i.owner).forEach(i=>this._markerService.remove(i,[e.uri]))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});let i=t.map(r=>({range:this._createDecorationRange(e.model,r),options:this._createDecorationOption(r)}));e.update(t,i)&&this._onDidChangeMarker.fire(e.model)}_createDecorationRange(e,t){let i=V.lift(t);return t.severity===_i.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),e.validateRange(i)}_createDecorationOption(e){let t,i,r,s,o;switch(e.severity){case _i.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",r=0;break;case _i.Warning:t="squiggly-warning",i=xs(HRe),r=20,o={color:xs(mRe),position:Xl.Inline};break;case _i.Info:t="squiggly-info",i=xs(URe),r=10;break;case _i.Error:default:t="squiggly-error",i=xs(zRe),r=30,o={color:xs(pRe),position:Xl.Inline};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(s="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(s="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:rc.Right},minimap:o,zIndex:r,inlineClassName:s}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}};eO=c5e([jz(0,Kr),jz(1,ky)],eO);var u5e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},qz=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let tO=class extends re{constructor(e,t){super(),this._contextKeyService=e,this._configurationService=t,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new H,this._accessibilityModeEnabledContext=SOe.bindTo(this._contextKeyService);const i=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("editor.accessibilitySupport")&&(i(),this._onDidChangeScreenReaderOptimized.fire())})),i(),this.onDidChangeScreenReaderOptimized(()=>i())}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}getAccessibilitySupport(){return this._accessibilitySupport}};tO=u5e([qz(0,Xe),qz(1,Zi)],tO);var WC=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class d5e{constructor(){this.mapTextToType=new Map,this.findText=""}writeText(e,t){return WC(this,void 0,void 0,function*(){if(t){this.mapTextToType.set(t,e);return}try{return yield navigator.clipboard.writeText(e)}catch(s){console.error(s)}const i=document.activeElement,r=document.body.appendChild(me("textarea",{"aria-hidden":!0}));r.style.height="1px",r.style.width="1px",r.style.position="absolute",r.value=e,r.focus(),r.select(),document.execCommand("copy"),i instanceof HTMLElement&&i.focus(),document.body.removeChild(r)})}readText(e){return WC(this,void 0,void 0,function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return console.error(t),""}})}readFindText(){return WC(this,void 0,void 0,function*(){return this.findText})}writeFindText(e){return WC(this,void 0,void 0,function*(){this.findText=e})}}var f5e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Gz=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},$C=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function zC(n){return n.scheme===ft.file?n.fsPath:n.path}let Jte=0;class HC{constructor(e,t,i,r,s,o,a){this.id=++Jte,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=r,this.groupOrder=s,this.sourceId=o,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class Kz{constructor(e,t){this.resourceLabel=e,this.reason=t}}class Zz{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,r]of this.elements)(r.reason===0?e:t).push(r.resourceLabel);let i=[];return e.length>0&&i.push(v({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(v({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class g5e{constructor(e,t,i,r,s,o,a){this.id=++Jte,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=r,this.groupOrder=s,this.sourceId=o,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new Zz),this.removedResources.has(t)||this.removedResources.set(t,new Kz(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new Zz),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new Kz(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class eie{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){let e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,r=this._past.length;i<r;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new hee(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,r=0,s=-1;for(let a=0,l=this._past.length;a<l;a++,r++){const c=this._past[a];i&&(r>=t||c.id!==e.elements[r])&&(i=!1,s=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let o=-1;for(let a=this._future.length-1;a>=0;a--,r++){const l=this._future[a];i&&(r>=t||l.id!==e.elements[r])&&(i=!1,o=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}s!==-1&&(this._past=this._past.slice(0,s)),o!==-1&&(this._future=this._future.slice(o+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class bA{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const tie=new eie("","");tie.locked=!0;let TD=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);let t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=I_.None,i=Pl.None){if(e.type===0){const r=zC(e.resource),s=this.getUriComparisonKey(e.resource);this._pushElement(new HC(e,r,s,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const r=new Set,s=[],o=[];for(const a of e.resources){const l=zC(a),c=this.getUriComparisonKey(a);r.has(c)||(r.add(c),s.push(l),o.push(c))}s.length===1?this._pushElement(new HC(e,s[0],o[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new g5e(e,s,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const r=e.resourceLabels[t],s=e.strResources[t];let o;this._editStacks.has(s)?o=this._editStacks.get(s):(o=new eie(r,s),this._editStacks.set(s,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const r=i.getClosestPastElement();return r?r.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),r=new Map;for(const s of i){const o=zC(s.resource),a=this.getUriComparisonKey(s.resource),l=new HC(s,o,a,0,0,0,0);r.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitPastWorkspaceElement(e,r)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),r=new Map;for(const s of i){const o=zC(s.resource),a=this.getUriComparisonKey(s.resource),l=new HC(s,o,a,0,0,0,0);r.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitFutureWorkspaceElement(e,r)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const r=this.getUriComparisonKey(e);this._editStacks.has(r)&&this._editStacks.get(r).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new hee(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[r,s]of this._editStacks){const o=s.getClosestPastElement();o&&o.sourceId===e&&(!t||o.sourceOrder>t.sourceOrder)&&(t=o,i=r)}return[t,i]}canUndo(e){if(e instanceof Pl){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){it(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,r,s){const o=this._acquireLocks(i);let a;try{a=t()}catch(l){return o(),r.dispose(),this._onError(l,e)}return a?a.then(()=>(o(),r.dispose(),s()),l=>(o(),r.dispose(),this._onError(l,e))):(o(),r.dispose(),s())}_invokeWorkspacePrepare(e){return $C(this,void 0,void 0,function*(){if(typeof e.actual.prepareUndoRedo>"u")return re.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?re.None:t})}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(re.None);const i=e.actual.prepareUndoRedo();return i?sQ(i)?t(i):i.then(r=>t(r)):t(re.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||tie);return new bA(t)}_tryToSplitAndUndo(e,t,i,r){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(r),new UC(this._undo(e,0,!0));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(r),new UC}_checkWorkspaceUndo(e,t,i,r){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,v({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(r&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,v({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndUndo(e,t,null,v({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndUndo(e,t,null,v({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,v({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const r=this._getAffectedEditStacks(t),s=this._checkWorkspaceUndo(e,t,r,!1);return s?s.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,r,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const r=t.getSecondClosestPastElement();if(r&&r.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,i,r){return $C(this,void 0,void 0,function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){const a=yield this._dialogService.show(Li.Info,v("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),[v({key:"ok",comment:["{0} denotes a number that is > 1"]},"Undo in {0} Files",i.editStacks.length),v("nok","Undo this File"),v("cancel","Cancel")],{cancelId:2});if(a.choice===2)return;if(a.choice===1)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const l=this._checkWorkspaceUndo(e,t,i,!1);if(l)return l.returnValue;r=!0}let s;try{s=yield this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const o=this._checkWorkspaceUndo(e,t,i,!0);if(o)return s.dispose(),o.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,s,()=>this._continueUndoInGroup(t.groupId,r))})}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const r=v({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(r);return}return this._invokeResourcePrepare(t,r=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new bA([e]),r,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[r,s]of this._editStacks){const o=s.getClosestPastElement();o&&o.groupId===e&&(!t||o.groupOrder>t.groupOrder)&&(t=o,i=r)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof Pl){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const r=this._editStacks.get(e),s=r.getClosestPastElement();if(!s)return;if(s.groupId){const[a,l]=this._findClosestUndoElementInGroup(s.groupId);if(s!==a&&l)return this._undo(l,t,i)}if((s.sourceId!==t||s.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,s);try{return s.type===1?this._workspaceUndo(e,s,i):this._resourceUndo(r,s,i)}finally{}}_confirmAndContinueUndo(e,t,i){return $C(this,void 0,void 0,function*(){if((yield this._dialogService.show(Li.Info,v("confirmDifferentSource","Would you like to undo '{0}'?",i.label),[v("confirmDifferentSource.yes","Yes"),v("cancel","Cancel")],{cancelId:1})).choice!==1)return this._undo(e,t,!0)})}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[r,s]of this._editStacks){const o=s.getClosestFutureElement();o&&o.sourceId===e&&(!t||o.sourceOrder<t.sourceOrder)&&(t=o,i=r)}return[t,i]}canRedo(e){if(e instanceof Pl){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,r){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(r),new UC(this._redo(e));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(r),new UC}_checkWorkspaceRedo(e,t,i,r){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,v({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(r&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,v({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndRedo(e,t,null,v({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const o=[];for(const a of i.editStacks)a.locked&&o.push(a.resourceLabel);return o.length>0?this._tryToSplitAndRedo(e,t,null,v({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,o.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,v({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),r=this._checkWorkspaceRedo(e,t,i,!1);return r?r.returnValue:this._executeWorkspaceRedo(e,t,i)}_executeWorkspaceRedo(e,t,i){return $C(this,void 0,void 0,function*(){let r;try{r=yield this._invokeWorkspacePrepare(t)}catch(o){return this._onError(o,t)}const s=this._checkWorkspaceRedo(e,t,i,!0);if(s)return r.dispose(),s.returnValue;for(const o of i.editStacks)o.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,r,()=>this._continueRedoInGroup(t.groupId))})}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=v({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new bA([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[r,s]of this._editStacks){const o=s.getClosestFutureElement();o&&o.groupId===e&&(!t||o.groupOrder<t.groupOrder)&&(t=o,i=r)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof Pl){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[r,s]=this._findClosestRedoElementInGroup(i.groupId);if(i!==r&&s)return this._redo(s)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};TD=f5e([Gz(0,Rte),Gz(1,Qn)],TD);class UC{constructor(e){this.returnValue=e}}Wg(vy,TD);const p5e=new RegExp(`(\\\\)?\\$\\((${ss.iconNameExpression}(?:${ss.iconModifierExpression})?)\\)`,"g");function Wm(n){const e=new Array;let t,i=0,r=0;for(;(t=p5e.exec(n))!==null;){r=t.index||0,e.push(n.substring(i,r)),i=(t.index||0)+t[0].length;const[,s,o]=t;e.push(s?`$(${o})`:m5e({id:o}))}return i<n.length&&e.push(n.substring(i)),e}function m5e(n){const e=me("span");return e.classList.add(...ss.asClassNameArray(n)),e}const _5e={buttonBackground:X.fromHex("#0E639C"),buttonHoverBackground:X.fromHex("#006BB3"),buttonForeground:X.white};class Yz extends re{constructor(e,t){super(),this._onDidClick=this._register(new H),this.options=t||Object.create(null),sl(this.options,_5e,!1),this.buttonForeground=this.options.buttonForeground,this.buttonBackground=this.options.buttonBackground,this.buttonHoverBackground=this.options.buttonHoverBackground,this.buttonSecondaryForeground=this.options.buttonSecondaryForeground,this.buttonSecondaryBackground=this.options.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=this.options.buttonSecondaryHoverBackground,this.buttonBorder=this.options.buttonBorder,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),e.appendChild(this._element),this._register(Rt.addTarget(this._element)),[Me.CLICK,Qt.Tap].forEach(i=>{this._register(ae(this._element,i,r=>{if(!this.enabled){Ft.stop(r);return}this._onDidClick.fire(r)}))}),this._register(ae(this._element,Me.KEY_DOWN,i=>{const r=new bi(i);let s=!1;this.enabled&&(r.equals(3)||r.equals(10))?(this._onDidClick.fire(i),s=!0):r.equals(9)&&(this._element.blur(),s=!0),s&&Ft.stop(r,!0)})),this._register(ae(this._element,Me.MOUSE_OVER,i=>{this._element.classList.contains("disabled")||this.setHoverBackground()})),this._register(ae(this._element,Me.MOUSE_OUT,i=>{this.applyStyles()})),this.focusTracker=this._register(v_(this._element)),this._register(this.focusTracker.onDidFocus(()=>this.setHoverBackground())),this._register(this.focusTracker.onDidBlur(()=>this.applyStyles())),this.applyStyles()}get onDidClick(){return this._onDidClick.event}setHoverBackground(){let e;this.options.secondary?e=this.buttonSecondaryHoverBackground?this.buttonSecondaryHoverBackground.toString():null:e=this.buttonHoverBackground?this.buttonHoverBackground.toString():null,e&&(this._element.style.backgroundColor=e)}style(e){this.buttonForeground=e.buttonForeground,this.buttonBackground=e.buttonBackground,this.buttonHoverBackground=e.buttonHoverBackground,this.buttonSecondaryForeground=e.buttonSecondaryForeground,this.buttonSecondaryBackground=e.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=e.buttonSecondaryHoverBackground,this.buttonBorder=e.buttonBorder,this.applyStyles()}applyStyles(){if(this._element){let e,t;this.options.secondary?(t=this.buttonSecondaryForeground?this.buttonSecondaryForeground.toString():"",e=this.buttonSecondaryBackground?this.buttonSecondaryBackground.toString():""):(t=this.buttonForeground?this.buttonForeground.toString():"",e=this.buttonBackground?this.buttonBackground.toString():"");const i=this.buttonBorder?this.buttonBorder.toString():"";this._element.style.color=t,this._element.style.backgroundColor=e,this._element.style.borderWidth=i?"1px":"",this._element.style.borderStyle=i?"solid":"",this._element.style.borderColor=i}}get element(){return this._element}set label(e){this._element.classList.add("monaco-text-button"),this.options.supportIcons?gy(this._element,...Wm(e)):this._element.textContent=e,typeof this.options.title=="string"?this._element.title=this.options.title:this.options.title&&(this._element.title=e)}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}const b5e={badgeBackground:X.fromHex("#4D4D4D"),badgeForeground:X.fromHex("#FFFFFF")};class iO{constructor(e,t){this.count=0,this.options=t||Object.create(null),sl(this.options,b5e,!1),this.badgeBackground=this.options.badgeBackground,this.badgeForeground=this.options.badgeForeground,this.badgeBorder=this.options.badgeBorder,this.element=le(e,me(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=No(this.countFormat,this.count),this.element.title=No(this.titleFormat,this.count),this.applyStyles()}style(e){this.badgeBackground=e.badgeBackground,this.badgeForeground=e.badgeForeground,this.badgeBorder=e.badgeBorder,this.applyStyles()}applyStyles(){if(this.element){const e=this.badgeBackground?this.badgeBackground.toString():"",t=this.badgeForeground?this.badgeForeground.toString():"",i=this.badgeBorder?this.badgeBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.element.style.borderWidth=i?"1px":"",this.element.style.borderStyle=i?"solid":"",this.element.style.borderColor=i}}}const Xz="done",Qz="active",vA="infinite",Jz="discrete",v5e={progressBarBackground:X.fromHex("#0E70C0")};class w5e extends re{constructor(e,t){super(),this.options=t||Object.create(null),sl(this.options,v5e,!1),this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this._register(this.showDelayedScheduler=new yi(()=>Ss(this.element),0)),this.create(e)}create(e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.element.appendChild(this.bit),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(Qz,vA,Jz),this.workedVal=0,this.totalWork=void 0}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(Xz),this.element.classList.contains(vA)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(Jz,Xz),this.element.classList.add(Qz,vA),this}getContainer(){return this.element}style(e){this.progressBarBackground=e.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const e=this.progressBarBackground?this.progressBarBackground.toString():"";this.bit.style.backgroundColor=e}}}class bB{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const iie=new bB("id#");const wA={},y5e=new bB("quick-input-button-icon-");function nO(n){if(!n)return;let e;const t=n.dark.toString();return wA[t]?e=wA[t]:(e=y5e.nextId(),LM(`.${e}`,`background-image: ${Ch(n.light||n.dark)}`),LM(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${Ch(n.dark)}`),wA[t]=e),e}const C5e={ctrlCmd:!1,alt:!1};var Jw;(function(n){n[n.Blur=1]="Blur",n[n.Gesture=2]="Gesture",n[n.Other=3]="Other"})(Jw||(Jw={}));var ba;(function(n){n[n.NONE=0]="NONE",n[n.FIRST=1]="FIRST",n[n.SECOND=2]="SECOND",n[n.LAST=3]="LAST"})(ba||(ba={}));function S5e(n,e={}){const t=vB(e);return t.textContent=n,t}function x5e(n,e={}){const t=vB(e);return nie(t,D5e(n,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function vB(n){const e=n.inline?"span":"div",t=document.createElement(e);return n.className&&(t.className=n.className),t}class E5e{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function nie(n,e,t,i){let r;if(e.type===2)r=document.createTextNode(e.content||"");else if(e.type===3)r=document.createElement("b");else if(e.type===4)r=document.createElement("i");else if(e.type===7&&i)r=document.createElement("code");else if(e.type===5&&t){const s=document.createElement("a");s.href="#",t.disposables.add(dn(s,"click",o=>{t.callback(String(e.index),o)})),r=s}else e.type===8?r=document.createElement("br"):e.type===1&&(r=n);r&&n!==r&&n.appendChild(r),r&&Array.isArray(e.children)&&e.children.forEach(s=>{nie(r,s,t,i)})}function D5e(n,e){const t={type:1,children:[]};let i=0,r=t;const s=[],o=new E5e(n);for(;!o.eos();){let a=o.next();const l=a==="\\"&&rO(o.peek(),e)!==0;if(l&&(a=o.next()),!l&&k5e(a,e)&&a===o.peek()){o.advance(),r.type===2&&(r=s.pop());const c=rO(a,e);if(r.type===c||r.type===5&&c===6)r=s.pop();else{const h={type:c,children:[]};c===5&&(h.index=i,i++),r.children.push(h),s.push(r),r=h}}else if(a===`
`)r.type===2&&(r=s.pop()),r.children.push({type:8});else if(r.type!==2){const c={type:2,content:a};r.children.push(c),s.push(r),r=c}else r.content+=a}return r.type===2&&(r=s.pop()),t}function k5e(n,e){return rO(n,e)!==0}function rO(n,e){switch(n){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}class L5e{constructor(e,t=0,i=e.length,r=t-1){this.items=e,this.start=t,this.end=i,this.index=r}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class I5e{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._currentPosition()!==this._elements.length-1?this._navigator.next():null}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new L5e(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const rb=me,T5e={inputBackground:X.fromHex("#3C3C3C"),inputForeground:X.fromHex("#CCCCCC"),inputValidationInfoBorder:X.fromHex("#55AAFF"),inputValidationInfoBackground:X.fromHex("#063B49"),inputValidationWarningBorder:X.fromHex("#B89500"),inputValidationWarningBackground:X.fromHex("#352A05"),inputValidationErrorBorder:X.fromHex("#BE1100"),inputValidationErrorBackground:X.fromHex("#5A1D1D")};class rie extends bo{constructor(e,t,i){var r;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new H),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i||Object.create(null),sl(this.options,T5e,!1),this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=(r=this.options.tooltip)!==null&&r!==void 0?r:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.inputBackground=this.options.inputBackground,this.inputForeground=this.options.inputForeground,this.inputBorder=this.options.inputBorder,this.inputValidationInfoBorder=this.options.inputValidationInfoBorder,this.inputValidationInfoBackground=this.options.inputValidationInfoBackground,this.inputValidationInfoForeground=this.options.inputValidationInfoForeground,this.inputValidationWarningBorder=this.options.inputValidationWarningBorder,this.inputValidationWarningBackground=this.options.inputValidationWarningBackground,this.inputValidationWarningForeground=this.options.inputValidationWarningForeground,this.inputValidationErrorBorder=this.options.inputValidationErrorBorder,this.inputValidationErrorBackground=this.options.inputValidationErrorBackground,this.inputValidationErrorForeground=this.options.inputValidationErrorForeground,this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=le(e,rb(".monaco-inputbox.idle"));let s=this.options.flexibleHeight?"textarea":"input",o=le(this.element,rb(".ibwrapper"));if(this.input=le(o,rb(s+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=le(o,rb("div.mirror")),this.mirror.innerText="",this.scrollableElement=new F5(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),le(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(c=>this.input.scrollTop=c.scrollTop));const a=this._register(new qt(document,"selectionchange")),l=Re.filter(a.event,()=>{const c=document.getSelection();return(c==null?void 0:c.anchorNode)===o});this._register(l(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this.ignoreGesture(this.input),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new xh(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.input.title=e}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:kM(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}get width(){return Lo(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){const i=parseFloat(this.mirror.style.paddingLeft||"")||0,r=parseFloat(this.mirror.style.paddingRight||"")||0;t=i+r}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.options.flexibleHeight&&this.options.flexibleWidth?this.input.style.width=`calc(100% - ${e}px)`:this.input.style.paddingRight=e+"px",this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=i.border?`1px solid ${i.border}`:"",(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e==null?void 0:e.type}stylesForType(e){switch(e){case 1:return{border:this.inputValidationInfoBorder,background:this.inputValidationInfoBackground,foreground:this.inputValidationInfoForeground};case 2:return{border:this.inputValidationWarningBorder,background:this.inputValidationWarningBackground,foreground:this.inputValidationWarningForeground};default:return{border:this.inputValidationErrorBorder,background:this.inputValidationErrorBackground,foreground:this.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t=()=>e.style.width=Lo(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:r=>{if(!this.message)return null;e=le(r,rb(".monaco-inputbox-container")),t();const s={inline:!0,className:"monaco-inputbox-message"},o=this.message.formatContent?x5e(this.message.content,s):S5e(this.message.content,s);o.classList.add(this.classForType(this.message.type));const a=this.stylesForType(this.message.type);return o.style.backgroundColor=a.background?a.background.toString():"",o.style.color=a.foreground?a.foreground.toString():"",o.style.border=a.border?`1px solid ${a.border}`:"",le(e,o),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=v("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=v("alertWarningMessage","Warning: {0}",this.message.content):i=v("alertInfoMessage","Info: {0}",this.message.content),Hg(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText="",this.layout()}style(e){this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){const e=this.inputBackground?this.inputBackground.toString():"",t=this.inputForeground?this.inputForeground.toString():"",i=this.inputBorder?this.inputBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.input.style.backgroundColor="inherit",this.input.style.color=t,this.element.style.borderWidth=i?"1px":"",this.element.style.borderStyle=i?"solid":"",this.element.style.borderColor=i}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=kM(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,r=t.selectionEnd,s=t.value;i!==null&&r!==null&&(this.value=s.substr(0,i)+e+s.substr(r),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar&&this.actionbar.dispose(),super.dispose()}}class sie extends rie{constructor(e,t,i){const r=v({key:"history.inputbox.hint",comment:["Text will be prefixed with  plus a single space, then used as a hint where input field keeps history"]},"for history"),s=` or  ${r}`,o=` ( ${r})`;super(e,t,i),this.history=new I5e(i.history,100);const a=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(s)&&!this.placeholder.endsWith(o)&&this.history.getHistory().length){const l=this.placeholder.endsWith(")")?s:o,c=this.placeholder+l;i.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=c:this.setPlaceHolder(c)}};this.observer=new MutationObserver((l,c)=>{l.forEach(h=>{h.target.textContent||a()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>a()),this.onblur(this.input,()=>{const l=c=>{if(this.placeholder.endsWith(c)){const h=this.placeholder.slice(0,this.placeholder.length-c.length);return i.showPlaceholderOnFocus?this.placeholder=h:this.setPlaceHolder(h),!0}else return!1};l(o)||l(s)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(){this.value&&this.value!==this.getCurrentValue()&&this.history.add(this.value)}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),e&&(this.value=e,UE(this.value))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,UE(this.value))}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()||this.history.last()}}const A5e=me;class N5e extends re{constructor(e){super(),this.parent=e,this.onKeyDown=t=>ae(this.inputBox.inputElement,Me.KEY_DOWN,i=>{t(new bi(i))}),this.onMouseDown=t=>ae(this.inputBox.inputElement,Me.MOUSE_DOWN,i=>{t(new oo(i))}),this.onDidChange=t=>this.inputBox.onDidChange(t),this.container=le(this.parent,A5e(".quick-input-box")),this.inputBox=this._register(new rie(this.container,void 0))}get value(){return this.inputBox.value}set value(e){this.inputBox.value=e}select(e=null){this.inputBox.select(e)}isSelectionAtEnd(){return this.inputBox.isSelectionAtEnd()}get placeholder(){return this.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.inputBox.setPlaceHolder(e)}get ariaLabel(){return this.inputBox.getAriaLabel()}set ariaLabel(e){this.inputBox.setAriaLabel(e)}get password(){return this.inputBox.inputElement.type==="password"}set password(e){this.inputBox.inputElement.type=e?"password":"text"}setAttribute(e,t){this.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===Li.Ignore?this.inputBox.hideMessage():this.inputBox.showMessage({type:e===Li.Info?1:e===Li.Warning?2:3,content:""})}stylesForType(e){return this.inputBox.stylesForType(e===Li.Info?1:e===Li.Warning?2:3)}setFocus(){this.inputBox.focus()}layout(){this.inputBox.layout()}style(e){this.inputBox.style(e)}}class ed{constructor(e,t){this.supportIcons=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.domNode=document.createElement("span"),this.domNode.className="monaco-highlighted-label",e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t=[],i="",r){e||(e=""),r&&(e=ed.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&Ma(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const o=this.text.substring(t,i.start);e.push(me("span",void 0,...this.supportIcons?Wm(o):[o])),t=i.end}const r=this.text.substring(i.start,i.end),s=me("span.highlight",void 0,...this.supportIcons?Wm(r):[r]);i.extraClasses&&s.classList.add(i.extraClasses),e.push(s),t=i.end}if(t<this.text.length){const i=this.text.substring(t);e.push(me("span",void 0,...this.supportIcons?Wm(i):[i]))}gy(this.domNode,...e),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(e,t){let i=0,r=0;return e.replace(/\r\n|\r|\n/g,(s,o)=>{r=s===`\r
`?-1:0,o+=i;for(const a of t)a.end<=o||(a.start>=o&&(a.start+=r),a.end>=o&&(a.end+=r));return i+=r,""})}}class B_{constructor(e="",t=!1){var i,r,s;if(this.value=e,typeof this.value!="string")throw Zl("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=(i=t.isTrusted)!==null&&i!==void 0?i:void 0,this.supportThemeIcons=(r=t.supportThemeIcons)!==null&&r!==void 0?r:!1,this.supportHtml=(s=t.supportHtml)!==null&&s!==void 0?s:!1)}appendText(e,t=0){return this.value+=R5e(this.supportThemeIcons?F4e(e):e).replace(/([ \t]+)/g,(i,r)=>"&nbsp;".repeat(r.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+=`
`,this.value+=t,this.value+="\n```\n",this}}function xv(n){return oie(n)?!n.value:Array.isArray(n)?n.every(xv):!0}function oie(n){return n instanceof B_?!0:n&&typeof n=="object"?typeof n.value=="string"&&(typeof n.isTrusted=="boolean"||n.isTrusted===void 0)&&(typeof n.supportThemeIcons=="boolean"||n.supportThemeIcons===void 0):!1}function R5e(n){return n.replace(/[\\`*_{}[\]()#+\-!]/g,"\\$&")}function yA(n){return n&&n.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1")}function M5e(n){const e=[],t=n.split("|").map(r=>r.trim());n=t[0];const i=t[1];if(i){const r=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),o=r?r[1]:"",a=s?s[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:n,dimensions:e}}var sO=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function F5e(n,e){Ga(e)?n.title=e:e!=null&&e.markdownNotSupportedFallback?n.title=e.markdownNotSupportedFallback:n.removeAttribute("title")}class O5e{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}update(e,t){var i;return sO(this,void 0,void 0,function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let r;if(e===void 0||Ga(e)||e instanceof HTMLElement)r=e;else if(!Qb(e.markdown))r=(i=e.markdown)!==null&&i!==void 0?i:e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(v("iconLabel.loading","Loading..."),t),this._cancellationTokenSource=new rl;const s=this._cancellationTokenSource.token;if(r=yield e.markdown(s),this.isDisposed||s.isCancellationRequested)return}this.show(r,t)})}show(e,t){const i=this._hoverWidget;if(this.hasContent(e)){const r={content:e,target:this.target,showPointer:this.hoverDelegate.placement==="element",hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!i};this._hoverWidget=this.hoverDelegate.showHover(r,t)}i==null||i.dispose()}hasContent(e){return e?oie(e)?!!e.value:!0:!1}get isDisposed(){var e;return(e=this._hoverWidget)===null||e===void 0?void 0:e.isDisposed}dispose(){var e,t;(e=this._hoverWidget)===null||e===void 0||e.dispose(),(t=this._cancellationTokenSource)===null||t===void 0||t.dispose(!0),this._cancellationTokenSource=void 0}}function P5e(n,e,t){let i,r;const s=(h,u)=>{var d;h&&(r==null||r.dispose(),r=void 0),u&&(i==null||i.dispose(),i=void 0),(d=n.onDidHideHover)===null||d===void 0||d.call(n)},o=(h,u,d)=>new Gr(()=>sO(this,void 0,void 0,function*(){(!r||r.isDisposed)&&(r=new O5e(n,d||e,h>0),yield r.update(t,u))}),h),a=()=>{if(i)return;const h=new ve,u=g=>s(!1,g.fromElement===e);h.add(ae(e,Me.MOUSE_LEAVE,u,!0));const d=()=>s(!0,!0);h.add(ae(e,Me.MOUSE_DOWN,d,!0));const f={targetElements:[e],dispose:()=>{}};if(n.placement===void 0||n.placement==="mouse"){const g=p=>f.x=p.x+10;h.add(ae(e,Me.MOUSE_MOVE,g,!0))}h.add(o(n.delay,!1,f)),i=h},l=ae(e,Me.MOUSE_OVER,a,!0);return{show:h=>{s(!1,!0),o(0,h)},hide:()=>{s(!0,!0)},update:h=>sO(this,void 0,void 0,function*(){t=h,yield r==null?void 0:r.update(t)}),dispose:()=>{l.dispose(),s(!0,!0)}}}class CA{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class wB extends re{constructor(e,t){super(),this.customHovers=new Map,this.domNode=this._register(new CA(le(e,me(".monaco-icon-label")))),this.labelContainer=le(this.domNode.element,me(".monaco-icon-label-container"));const i=le(this.labelContainer,me("span.monaco-icon-name-container"));this.descriptionContainer=this._register(new CA(le(this.labelContainer,me("span.monaco-icon-description-container")))),t!=null&&t.supportHighlights||t!=null&&t.supportIcons?this.nameNode=new W5e(i,!!t.supportIcons):this.nameNode=new B5e(i),t!=null&&t.supportDescriptionHighlights?this.descriptionNodeFactory=()=>new ed(le(this.descriptionContainer.element,me("span.label-description")),!!t.supportIcons):this.descriptionNodeFactory=()=>this._register(new CA(le(this.descriptionContainer.element,me("span.label-description")))),this.hoverDelegate=t==null?void 0:t.hoverDelegate}get element(){return this.domNode.element}setLabel(e,t,i){const r=["monaco-icon-label"];i&&(i.extraClasses&&r.push(...i.extraClasses),i.italic&&r.push("italic"),i.strikethrough&&r.push("strikethrough")),this.domNode.className=r.join(" "),this.setupHover(i!=null&&i.descriptionTitle?this.labelContainer:this.element,i==null?void 0:i.title),this.nameNode.setLabel(e,i),(t||this.descriptionNode)&&(this.descriptionNode||(this.descriptionNode=this.descriptionNodeFactory()),this.descriptionNode instanceof ed?(this.descriptionNode.set(t||"",i?i.descriptionMatches:void 0),this.setupHover(this.descriptionNode.element,i==null?void 0:i.descriptionTitle)):(this.descriptionNode.textContent=t||"",this.setupHover(this.descriptionNode.element,(i==null?void 0:i.descriptionTitle)||""),this.descriptionNode.empty=!t))}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(!this.hoverDelegate)F5e(e,t);else{const r=P5e(this.hoverDelegate,e,t);r&&this.customHovers.set(e,r)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}}class B5e{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&Ma(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=le(this.container,me("a.label-name",{id:t==null?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const r=e[i],s=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${i}`;le(this.container,me("a.label-name",{id:s,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},r)),i<e.length-1&&le(this.container,me("span.label-separator",void 0,(t==null?void 0:t.separator)||"/"))}}}}function V5e(n,e,t){if(!t)return;let i=0;return n.map(r=>{const s={start:i,end:i+r.length},o=t.map(a=>zn.intersect(s,a)).filter(a=>!zn.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=s.end+e.length,o})}class W5e{constructor(e,t){this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&Ma(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new ed(le(this.container,me("a.label-name",{id:t==null?void 0:t.domId})),this.supportIcons)),this.singleLabel.set(e,t==null?void 0:t.matches,void 0,t==null?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=(t==null?void 0:t.separator)||"/",r=V5e(e,i,t==null?void 0:t.matches);for(let s=0;s<e.length;s++){const o=e[s],a=r?r[s]:void 0,l=(t==null?void 0:t.domId)&&`${t==null?void 0:t.domId}_${s}`,c=me("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":s,role:"treeitem"});new ed(le(this.container,c),this.supportIcons).set(o,a,void 0,t==null?void 0:t.labelEscapeNewLines),s<e.length-1&&le(c,me("span.label-separator",void 0,i))}}}}const jC=me;class yB{constructor(e,t,i){this.os=t,this.keyElements=new Set,this.options=i||Object.create(null),this.labelBackground=this.options.keybindingLabelBackground,this.labelForeground=this.options.keybindingLabelForeground,this.labelBorder=this.options.keybindingLabelBorder,this.labelBottomBorder=this.options.keybindingLabelBottomBorder,this.labelShadow=this.options.keybindingLabelShadow,this.domNode=le(e,jC(".monaco-keybinding")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&yB.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){let[e,t]=this.keybinding.getParts();e&&this.renderPart(this.domNode,e,this.matches?this.matches.firstPart:null),t&&(le(this.domNode,jC("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderPart(this.domNode,t,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()||""}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.applyStyles(),this.didEverRender=!0}clear(){Gn(this.domNode),this.keyElements.clear()}renderPart(e,t,i){const r=c5.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,r.ctrlKey,!!(i!=null&&i.ctrlKey),r.separator),t.shiftKey&&this.renderKey(e,r.shiftKey,!!(i!=null&&i.shiftKey),r.separator),t.altKey&&this.renderKey(e,r.altKey,!!(i!=null&&i.altKey),r.separator),t.metaKey&&this.renderKey(e,r.metaKey,!!(i!=null&&i.metaKey),r.separator);const s=t.keyLabel;s&&this.renderKey(e,s,!!(i!=null&&i.keyCode),"")}renderKey(e,t,i,r){le(e,this.createKeyElement(t,i?".highlight":"")),r&&le(e,jC("span.monaco-keybinding-key-separator",void 0,r))}renderUnbound(e){le(e,this.createKeyElement(v("unbound","Unbound")))}createKeyElement(e,t=""){const i=jC("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),i}style(e){this.labelBackground=e.keybindingLabelBackground,this.labelForeground=e.keybindingLabelForeground,this.labelBorder=e.keybindingLabelBorder,this.labelBottomBorder=e.keybindingLabelBottomBorder,this.labelShadow=e.keybindingLabelShadow,this.applyStyles()}applyStyles(){var e;if(this.element){for(const t of this.keyElements)this.labelBackground&&(t.style.backgroundColor=(e=this.labelBackground)===null||e===void 0?void 0:e.toString()),this.labelBorder&&(t.style.borderColor=this.labelBorder.toString()),this.labelBottomBorder&&(t.style.borderBottomColor=this.labelBottomBorder.toString()),this.labelShadow&&(t.style.boxShadow=`inset 0 -1px 0 ${this.labelShadow}`);this.labelForeground&&(this.element.style.color=this.labelForeground.toString())}}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&Ma(e.firstPart,t.firstPart)&&Ma(e.chordPart,t.chordPart)}}const eH=new Zb(()=>{const n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}});function $5e(n,e,t=!1){const i=n||"",r=e||"",s=eH.value.collator.compare(i,r);return eH.value.collatorIsNumeric&&s===0&&i!==r?i<r?-1:1:s}function z5e(n,e,t){const i=n.toLowerCase(),r=e.toLowerCase(),s=H5e(n,e,t);if(s)return s;const o=i.endsWith(t),a=r.endsWith(t);if(o!==a)return o?-1:1;const l=$5e(i,r);return l!==0?l:i.localeCompare(r)}function H5e(n,e,t){const i=n.toLowerCase(),r=e.toLowerCase(),s=i.startsWith(t),o=r.startsWith(t);if(s!==o)return s?-1:1;if(s&&o){if(i.length<r.length)return-1;if(i.length>r.length)return 1}return 0}var aie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},U5e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const Cl=me;class j5e{constructor(e){this.hidden=!1,this._onChecked=new H,this.onChecked=this._onChecked.event,Object.assign(this,e)}get checked(){return!!this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire(e))}dispose(){this._onChecked.dispose()}}class Ly{get templateId(){return Ly.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=le(e,Cl(".quick-input-list-entry"));const i=le(t.entry,Cl("label.quick-input-list-label"));t.toDisposeTemplate.push(dn(i,Me.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=le(i,Cl("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(dn(t.checkbox,Me.CHANGE,c=>{t.element.checked=t.checkbox.checked}));const r=le(i,Cl(".quick-input-list-rows")),s=le(r,Cl(".quick-input-list-row")),o=le(r,Cl(".quick-input-list-row"));t.label=new wB(s,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const a=le(s,Cl(".quick-input-list-entry-keybinding"));t.keybinding=new yB(a,Fo);const l=le(o,Cl(".quick-input-list-label-meta"));return t.detail=new ed(l,!0),t.separator=le(t.entry,Cl(".quick-input-list-separator")),t.actionBar=new xh(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,i){i.toDisposeElement=mt(i.toDisposeElement),i.element=e,i.checkbox.checked=e.checked,i.toDisposeElement.push(e.onChecked(c=>i.checkbox.checked=c));const{labelHighlights:r,descriptionHighlights:s,detailHighlights:o}=e,a=Object.create(null);a.matches=r||[],a.descriptionTitle=e.saneDescription,a.descriptionMatches=s||[],a.extraClasses=e.item.iconClasses,a.italic=e.item.italic,a.strikethrough=e.item.strikethrough,i.label.setLabel(e.saneLabel,e.saneDescription,a),i.keybinding.set(e.item.keybinding),i.detail.set(e.saneDetail,o),e.separator&&e.separator.label?(i.separator.textContent=e.separator.label,i.separator.style.display=""):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!e.separator),i.actionBar.clear();const l=e.item.buttons;l&&l.length?(i.actionBar.push(l.map((c,h)=>{let u=c.iconClass||(c.iconPath?nO(c.iconPath):void 0);c.alwaysVisible&&(u=u?`${u} always-visible`:"always-visible");const d=new ea(`id-${h}`,"",u,!0,()=>U5e(this,void 0,void 0,function*(){e.fireButtonTriggered({button:c,item:e.item})}));return d.tooltip=c.tooltip||"",d}),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){i.toDisposeElement=mt(i.toDisposeElement)}disposeTemplate(e){e.toDisposeElement=mt(e.toDisposeElement),e.toDisposeTemplate=mt(e.toDisposeTemplate)}}Ly.ID="listelement";class q5e{getHeight(e){return e.saneDetail?44:22}getTemplateId(e){return Ly.ID}}var Mi;(function(n){n[n.First=1]="First",n[n.Second=2]="Second",n[n.Last=3]="Last",n[n.Next=4]="Next",n[n.Previous=5]="Previous",n[n.NextPage=6]="NextPage",n[n.PreviousPage=7]="PreviousPage"})(Mi||(Mi={}));class CB{constructor(e,t,i){this.parent=e,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new H,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new H,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new H,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new H,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new H,this.onButtonTriggered=this._onButtonTriggered.event,this._onKeyDown=new H,this.onKeyDown=this._onKeyDown.event,this._onLeave=new H,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=le(this.parent,Cl(".quick-input-list"));const r=new q5e,s=new K5e;this.list=i.createList("QuickInput",this.container,r,[new Ly],{identityProvider:{getId:o=>o.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:s}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown(o=>{const a=new bi(o);switch(a.keyCode){case 10:this.toggleCheckbox();break;case 31:(wt?o.metaKey:o.ctrlKey)&&this.list.setFocus(mr(this.list.length));break;case 16:const l=this.list.getFocus();l.length===1&&l[0]===0&&this._onLeave.fire();break;case 18:const c=this.list.getFocus();c.length===1&&c[0]===this.list.length-1&&this._onLeave.fire();break}this._onKeyDown.fire(a)})),this.disposables.push(this.list.onMouseDown(o=>{o.browserEvent.button!==2&&o.browserEvent.preventDefault()})),this.disposables.push(ae(this.container,Me.CLICK,o=>{(o.x||o.y)&&this._onLeave.fire()})),this.disposables.push(this.list.onMouseMiddleClick(o=>{this._onLeave.fire()})),this.disposables.push(this.list.onContextMenu(o=>{typeof o.index=="number"&&(o.browserEvent.preventDefault(),this.list.setSelection([o.index]))})),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return Re.map(this.list.onDidChangeFocus,e=>e.elements.map(t=>t.item))}get onDidChangeSelection(){return Re.map(this.list.onDidChangeSelection,e=>({items:e.elements.map(t=>t.item),event:e.browserEvent}))}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let i=0,r=e.length;i<r;i++){const s=e[i];if(!s.hidden)if(s.checked)t=!0;else return!1}return t}getCheckedCount(){let e=0;const t=this.elements;for(let i=0,r=t.length;i<r;i++)t[i].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let i=0,r=t.length;i<r;i++)t[i].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach(t=>{t.hidden||(t.checked=e)})}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=mt(this.elementDisposables);const t=i=>this.fireButtonTriggered(i);this.inputElements=e,this.elements=e.reduce((i,r,s)=>{var o,a,l;if(r.type!=="separator"){const c=s&&e[s-1],h=r.label&&r.label.replace(/\r?\n/g," "),u=r.meta&&r.meta.replace(/\r?\n/g," "),d=r.description&&r.description.replace(/\r?\n/g," "),f=r.detail&&r.detail.replace(/\r?\n/g," "),g=r.ariaLabel||[h,d,f].map(p=>WLe(p)).filter(p=>!!p).join(", ");i.push(new j5e({index:s,item:r,saneLabel:h,saneMeta:u,saneAriaLabel:g,saneDescription:d,saneDetail:f,labelHighlights:(o=r.highlights)===null||o===void 0?void 0:o.label,descriptionHighlights:(a=r.highlights)===null||a===void 0?void 0:a.description,detailHighlights:(l=r.highlights)===null||l===void 0?void 0:l.detail,checked:!1,separator:c&&c.type==="separator"?c:void 0,fireButtonTriggered:t}))}return i},[]),this.elementDisposables.push(...this.elements),this.elementDisposables.push(...this.elements.map(i=>i.onChecked(()=>this.fireCheckedEvents()))),this.elementsToIndexes=this.elements.reduce((i,r,s)=>(i.set(r.item,s),i),new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map(e=>e.item)}setFocusedElements(e){if(this.list.setFocus(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t))),e.length>0){const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter(t=>this.elementsToIndexes.has(t)).map(t=>this.elementsToIndexes.get(t)))}getCheckedElements(){return this.elements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const i of e)t.add(i);for(const i of this.elements)i.checked=t.has(i.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===Mi.Next&&this.list.getFocus()[0]===this.list.length-1&&(e=Mi.First),e===Mi.Previous&&this.list.getFocus()[0]===0&&(e=Mi.Last),e===Mi.Second&&this.list.length<2&&(e=Mi.First),e){case Mi.First:this.list.focusFirst();break;case Mi.Second:this.list.focusNth(1);break;case Mi.Last:this.list.focusLast();break;case Mi.Next:this.list.focusNext();break;case Mi.Previous:this.list.focusPrevious();break;case Mi.NextPage:this.list.focusNextPage();break;case Mi.PreviousPage:this.list.focusPreviousPage();break}const t=this.list.getFocus()[0];typeof t=="number"&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}layout(e){this.list.getHTMLElement().style.maxHeight=e?`calc(${Math.floor(e/44)*44}px)`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this.elements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const r=i.index&&this.inputElements[i.index-1];i.separator=r&&r.type==="separator"?r:void 0});else{let i;this.elements.forEach(r=>{const s=this.matchOnLabel?hf(BC(e,PC(r.saneLabel))):void 0,o=this.matchOnDescription?hf(BC(e,PC(r.saneDescription||""))):void 0,a=this.matchOnDetail?hf(BC(e,PC(r.saneDetail||""))):void 0,l=this.matchOnMeta?hf(BC(e,PC(r.saneMeta||""))):void 0;if(s||o||a||l?(r.labelHighlights=s,r.descriptionHighlights=o,r.detailHighlights=a,r.hidden=!1):(r.labelHighlights=void 0,r.descriptionHighlights=void 0,r.detailHighlights=void 0,r.hidden=!r.item.alwaysShow),r.separator=void 0,!this.sortByLabel){const c=r.index&&this.inputElements[r.index-1];i=c&&c.type==="separator"?c:i,i&&!r.hidden&&(r.separator=i,i=void 0)}})}const t=this.elements.filter(i=>!i.hidden);if(this.sortByLabel&&e){const i=e.toLowerCase();t.sort((r,s)=>G5e(r,s,i))}return this.elementsToIndexes=t.reduce((i,r,s)=>(i.set(r.item,s),i),new Map),this.list.splice(0,this.list.length,t),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(t.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const i of e)i.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return this.container.style.display!=="none"}dispose(){this.elementDisposables=mt(this.elementDisposables),this.disposables=mt(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}style(e){this.list.style(e)}}aie([an],CB.prototype,"onDidChangeFocus",null);aie([an],CB.prototype,"onDidChangeSelection",null);function G5e(n,e,t){const i=n.labelHighlights||[],r=e.labelHighlights||[];return i.length&&!r.length?-1:!i.length&&r.length?1:i.length===0&&r.length===0?0:z5e(n.saneLabel,e.saneLabel,t)}class K5e{getWidgetAriaLabel(){return v("quickInput","Quick Input")}getAriaLabel(e){return e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(){return"option"}}var tH=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const _s=me,Z5e=ha("quick-input-back",Ce.arrowLeft),oO={iconClass:Z5e.classNames,tooltip:v("quickInput.back","Back"),handle:-1};class HL extends re{constructor(e){super(),this.ui=e,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.noValidationMessage=HL.noPromptMessage,this._severity=Li.Ignore,this.buttonsUpdated=!1,this.onDidTriggerButtonEmitter=this._register(new H),this.onDidHideEmitter=this._register(new H),this.onDisposeEmitter=this._register(new H),this.visibleDisposables=this._register(new ve),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Hu;this._ignoreFocusOut=e&&!Hu,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=Jw.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText="");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this.busy&&!this.busyDelay&&(this.busyDelay=new Gr,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const r=this.buttons.filter(o=>o===oO);this.ui.leftActionBar.push(r.map((o,a)=>{const l=new ea(`id-${a}`,"",o.iconClass||nO(o.iconPath),!0,()=>tH(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(o)}));return l.tooltip=o.tooltip||"",l}),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const s=this.buttons.filter(o=>o!==oO);this.ui.rightActionBar.push(s.map((o,a)=>{const l=new ea(`id-${a}`,"",o.iconClass||nO(o.iconPath),!0,()=>tH(this,void 0,void 0,function*(){this.onDidTriggerButtonEmitter.fire(o)}));return l.tooltip=o.tooltip||"",l}),{icon:!0,label:!1})}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,gy(this.ui.message,...Wm(i))),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?v("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Li.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.paddingBottom="4px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.paddingBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}HL.noPromptMessage=v("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class e1 extends HL{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new H),this.onWillAcceptEmitter=this._register(new H),this.onDidAcceptEmitter=this._register(new H),this.onDidCustomEmitter=this._register(new H),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=this.ui.isScreenReaderOptimized()?ba.NONE:ba.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new H),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new H),this.onDidTriggerItemButtonEmitter=this._register(new H),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e||"",this.update(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?C5e:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(Mi.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{if(e===this.value)return;this._value=e,this.ui.list.filter(this.filterValue(this.ui.inputBox.value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(e)})),this.visibleDisposables.add(this.ui.inputBox.onMouseDown(e=>{this.autoFocusOnList||this.ui.list.clearFocus()})),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown(e=>{switch(e.keyCode){case 18:this.ui.list.focus(Mi.Next),this.canSelectMany&&this.ui.list.domFocus(),Ft.stop(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(Mi.Previous):this.ui.list.focus(Mi.Last),this.canSelectMany&&this.ui.list.domFocus(),Ft.stop(e,!0);break;case 12:this.ui.list.focus(Mi.NextPage),this.canSelectMany&&this.ui.list.domFocus(),Ft.stop(e,!0);break;case 11:this.ui.list.focus(Mi.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),Ft.stop(e,!0);break;case 17:if(!this._canAcceptInBackground||!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Mi.First),Ft.stop(e,!0));break;case 13:(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!e.altKey&&(this.ui.list.focus(Mi.Last),Ft.stop(e,!0));break}})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this.ui.list.onDidChangeFocus(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&ec(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&ec(e,this._selectedItems,(i,r)=>i===r)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&ec(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return ae(this.ui.container,Me.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new bi(e),i=t.keyCode;this._quickNavigate.keybindings.some(o=>{const[a,l]=o.getParts();return l?!1:a.shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a.altKey&&i===6||a.ctrlKey&&i===5||a.metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this._hideInput&&this._items.length>0;this.ui.container.classList.toggle("hidden-input",t&&!this.description);const i={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!t,progressBar:!t,visibleCount:!0,count:this.canSelectMany,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");const r=this.ariaLabel||this.placeholder||e1.DEFAULT_ARIA_LABEL;if(this.ui.inputBox.ariaLabel!==r&&(this.ui.inputBox.ariaLabel=r),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case ba.NONE:this._itemActivation=ba.FIRST;break;case ba.SECOND:this.ui.list.focus(Mi.Second),this._itemActivation=ba.FIRST;break;case ba.LAST:this.ui.list.focus(Mi.Last),this._itemActivation=ba.FIRST;break;default:this.trySelectFirst();break}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",this.ui.setComboboxAccessibility(!0),i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Mi.First)),this.keepScrollPosition&&(this.scrollTop=e)}}e1.DEFAULT_ARIA_LABEL=v("quickInputBox.ariaLabel","Type to narrow down results.");class UL extends re{constructor(e){super(),this.options=e,this.comboboxAccessibility=!1,this.enabled=!0,this.onDidAcceptEmitter=this._register(new H),this.onDidCustomEmitter=this._register(new H),this.onDidTriggerButtonEmitter=this._register(new H),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new H),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new H),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=t=>{this.keyMods.ctrlCmd=t.ctrlKey||t.metaKey,this.keyMods.alt=t.altKey};this._register(ae(window,Me.KEY_DOWN,e,!0)),this._register(ae(window,Me.KEY_UP,e,!0)),this._register(ae(window,Me.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=le(this.parentElement,_s(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=ho(e),i=le(e,_s(".quick-input-titlebar")),r=this._register(new xh(i));r.domNode.classList.add("quick-input-left-action-bar");const s=le(i,_s(".quick-input-title")),o=this._register(new xh(i));o.domNode.classList.add("quick-input-right-action-bar");const a=le(e,_s(".quick-input-description")),l=le(e,_s(".quick-input-header")),c=le(l,_s("input.quick-input-check-all"));c.type="checkbox",this._register(dn(c,Me.CHANGE,N=>{const T=c.checked;C.setAllVisibleChecked(T)})),this._register(ae(c,Me.CLICK,N=>{(N.x||N.y)&&f.setFocus()}));const h=le(l,_s(".quick-input-description")),u=le(l,_s(".quick-input-and-message")),d=le(u,_s(".quick-input-filter")),f=this._register(new N5e(d));f.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=le(d,_s(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new iO(g,{countFormat:v({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")}),m=le(d,_s(".quick-input-count"));m.setAttribute("aria-live","polite");const b=new iO(m,{countFormat:v({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")}),_=le(l,_s(".quick-input-action")),w=new Yz(_);w.label=v("ok","OK"),this._register(w.onDidClick(N=>{this.onDidAcceptEmitter.fire()}));const y=le(l,_s(".quick-input-action")),S=new Yz(y);S.label=v("custom","Custom"),this._register(S.onDidClick(N=>{this.onDidCustomEmitter.fire()}));const k=le(u,_s(`#${this.idPrefix}message.quick-input-message`)),C=this._register(new CB(e,this.idPrefix+"list",this.options));this._register(C.onChangedAllVisibleChecked(N=>{c.checked=N})),this._register(C.onChangedVisibleCount(N=>{p.setCount(N)})),this._register(C.onChangedCheckedCount(N=>{b.setCount(N)})),this._register(C.onLeave(()=>{setTimeout(()=>{f.setFocus(),this.controller instanceof e1&&this.controller.canSelectMany&&C.clearFocus()},0)})),this._register(C.onDidChangeFocus(()=>{this.comboboxAccessibility&&this.getUI().inputBox.setAttribute("aria-activedescendant",this.getUI().list.getActiveDescendant()||"")}));const D=new w5e(e);D.getContainer().classList.add("quick-input-progress");const E=v_(e);return this._register(E),this._register(ae(e,Me.FOCUS,N=>{this.previousFocusElement=N.relatedTarget instanceof HTMLElement?N.relatedTarget:void 0},!0)),this._register(E.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(Jw.Blur),this.previousFocusElement=void 0})),this._register(ae(e,Me.FOCUS,N=>{f.setFocus()})),this._register(ae(e,Me.KEY_DOWN,N=>{const T=new bi(N);switch(T.keyCode){case 3:Ft.stop(N,!0),this.onDidAcceptEmitter.fire();break;case 9:Ft.stop(N,!0),this.hide(Jw.Gesture);break;case 2:if(!T.altKey&&!T.ctrlKey&&!T.metaKey){const j=[".action-label.codicon"];e.classList.contains("show-checkboxes")?j.push("input"):j.push("input[type=text]"),this.getUI().list.isDisplayed()&&j.push(".monaco-list");const q=e.querySelectorAll(j.join(", "));T.shiftKey&&T.target===q[0]?(Ft.stop(N,!0),q[q.length-1].focus()):!T.shiftKey&&T.target===q[q.length-1]&&(Ft.stop(N,!0),q[0].focus())}break}})),this.ui={container:e,styleSheet:t,leftActionBar:r,titleBar:i,title:s,description1:a,description2:h,rightActionBar:o,checkAll:c,filterContainer:d,inputBox:f,visibleCountContainer:g,visibleCount:p,countContainer:m,count:b,okContainer:_,ok:w,message:k,customButtonContainer:y,customButton:S,list:C,progressBar:D,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,isScreenReaderOptimized:()=>this.options.isScreenReaderOptimized(),show:N=>this.show(N),hide:()=>this.hide(),setVisibilities:N=>this.setVisibilities(N),setComboboxAccessibility:N=>this.setComboboxAccessibility(N),setEnabled:N=>this.setEnabled(N),setContextKey:N=>this.options.setContextKey(N)},this.updateStyles(),this.ui}pick(e,t={},i=ai.None){return new Promise((r,s)=>{let o=h=>{o=r,t.onKeyMods&&t.onKeyMods(a.keyMods),r(h)};if(i.isCancellationRequested){o(void 0);return}const a=this.createQuickPick();let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)o(a.selectedItems.slice()),a.hide();else{const h=a.activeItems[0];h&&(o(h),a.hide())}}),a.onDidChangeActive(h=>{const u=h[0];u&&t.onDidFocus&&t.onDidFocus(u)}),a.onDidChangeSelection(h=>{if(!a.canSelectMany){const u=h[0];u&&(o(u),a.hide())}}),a.onDidTriggerItemButton(h=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},h),{removeItem:()=>{const u=a.items.indexOf(h.item);if(u!==-1){const d=a.items.slice(),f=d.splice(u,1),g=a.activeItems.filter(m=>m!==f[0]),p=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=d,g&&(a.activeItems=g),a.keepScrollPosition=p}}}))),a.onDidChangeValue(h=>{l&&!h&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{mt(c),o(void 0)})];a.title=t.title,a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.autoFocusOnList=t.autoFocusOnList===void 0||t.autoFocusOnList,a.quickNavigate=t.quickNavigate,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([h,u])=>{l=u,a.busy=!1,a.items=h,a.canSelectMany&&(a.selectedItems=h.filter(d=>d.type!=="separator"&&d.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,h=>{s(h),a.hide()})})}createQuickPick(){const e=this.getUI();return new e1(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const i=this.controller;this.controller=e,i&&i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Li.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),gy(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,this.setComboboxAccessibility(!1),t.inputBox.ariaLabel="";const r=this.options.backKeybindingLabel();oO.tooltip=r?v("quickInput.backWithKeybinding","Back ({0})",r):v("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList[e.checkBox?"add":"remove"]("show-checkboxes"),this.updateLayout()}setComboboxAccessibility(e){if(e!==this.comboboxAccessibility){const t=this.getUI();this.comboboxAccessibility=e,this.comboboxAccessibility?(t.inputBox.setAttribute("role","combobox"),t.inputBox.setAttribute("aria-haspopup","true"),t.inputBox.setAttribute("aria-autocomplete","list"),t.inputBox.setAttribute("aria-activedescendant",t.list.getActiveDescendant()||"")):(t.inputBox.removeAttribute("role"),t.inputBox.removeAttribute("aria-haspopup"),t.inputBox.removeAttribute("aria-autocomplete"),t.inputBox.removeAttribute("aria-activedescendant"))}}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.getAction().enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.getAction().enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t;const i=this.controller;if(i){const r=!(!((t=this.ui)===null||t===void 0)&&t.container.contains(document.activeElement));this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",r||(this.previousFocusElement&&this.previousFocusElement.offsetParent?(this.previousFocusElement.focus(),this.previousFocusElement=void 0):this.options.returnFocus()),i.didHide(e)}}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,UL.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,contrastBorder:r,widgetShadow:s}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e?e.toString():"",this.ui.container.style.backgroundColor=t?t.toString():"",this.ui.container.style.color=i?i.toString():"",this.ui.container.style.border=r?`1px solid ${r}`:"",this.ui.container.style.boxShadow=s?`0 0 8px 2px ${s}`:"",this.ui.inputBox.style(this.styles.inputBox),this.ui.count.style(this.styles.countBadge),this.ui.ok.style(this.styles.button),this.ui.customButton.style(this.styles.button),this.ui.progressBar.style(this.styles.progressBar),this.ui.list.style(this.styles.list);const o=[];this.styles.list.pickerGroupBorder&&o.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`),this.styles.list.pickerGroupForeground&&o.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(o.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&o.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&o.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&o.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&o.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&o.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),o.push("}"));const a=o.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}}UL.MAX_WIDTH=600;var aO;(function(n){n[n.PRESERVE=0]="PRESERVE",n[n.LAST=1]="LAST"})(aO||(aO={}));const lie={Quickaccess:"workbench.contributions.quickaccess"};class Y5e{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),Et(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return rL([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}Bn.add(lie.Quickaccess,new Y5e);const cie=Dt("quickInputService");var X5e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},iH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let lO=class extends re{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=Bn.as(lie.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var r;const[s,o]=this.getOrInstantiateProvider(e),a=this.visibleQuickAccess,l=a==null?void 0:a.descriptor;if(a&&o&&l===o){e!==o.prefix&&!(i!=null&&i.preserveValue)&&(a.picker.value=e),this.adjustValueSelection(a.picker,o,i);return}if(o&&!(i!=null&&i.preserveValue)){let g;if(a&&l&&l!==o){const p=a.value.substr(l.prefix.length);p&&(g=`${o.prefix}${p}`)}if(!g){const p=s==null?void 0:s.defaultFilterValue;p===aO.LAST?g=this.lastAcceptedPickerValues.get(o):typeof p=="string"&&(g=`${o.prefix}${p}`)}typeof g=="string"&&(e=g)}const c=new ve,h=c.add(this.quickInputService.createQuickPick());h.value=e,this.adjustValueSelection(h,o,i),h.placeholder=o==null?void 0:o.placeholder,h.quickNavigate=i==null?void 0:i.quickNavigateConfiguration,h.hideInput=!!h.quickNavigate&&!a,(typeof(i==null?void 0:i.itemActivation)=="number"||i!=null&&i.quickNavigateConfiguration)&&(h.itemActivation=(r=i==null?void 0:i.itemActivation)!==null&&r!==void 0?r:ba.SECOND),h.contextKey=o==null?void 0:o.contextKey,h.filterValue=g=>g.substring(o?o.prefix.length:0),o!=null&&o.placeholder&&(h.ariaLabel=o==null?void 0:o.placeholder);let u,d;t&&(u=new Promise(g=>d=g),c.add(ig(h.onWillAccept)(g=>{g.veto(),h.hide()}))),c.add(this.registerPickerListeners(h,s,o,e));const f=c.add(new rl);if(s&&c.add(s.provide(h,f.token)),ig(h.onDidHide)(()=>{h.selectedItems.length===0&&f.cancel(),c.dispose(),d==null||d(h.selectedItems)}),h.show(),t)return u}adjustValueSelection(e,t,i){var r;let s;i!=null&&i.preserveValue?s=[e.value.length,e.value.length]:s=[(r=t==null?void 0:t.prefix.length)!==null&&r!==void 0?r:0,e.value.length],e.valueSelection=s}registerPickerListeners(e,t,i,r){const s=new ve,o=this.visibleQuickAccess={picker:e,descriptor:i,value:r};return s.add(Et(()=>{o===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),s.add(e.onDidChangeValue(a=>{const[l]=this.getOrInstantiateProvider(a);l!==t?this.show(a,{preserveValue:!0}):o.value=a})),i&&s.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),s}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let i=this.mapProviderToDescriptor.get(t);return i||(i=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,i)),[i,t]}};lO=X5e([iH(0,cie),iH(1,Kt)],lO);var Q5e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},sb=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let cO=class extends yTe{constructor(e,t,i,r,s){super(i),this.instantiationService=e,this.contextKeyService=t,this.accessibilityService=r,this.layoutService=s,this.contexts=new Map}get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(lO))),this._quickAccess}createController(e=this.layoutService,t){var i,r;const s={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,isScreenReaderOptimized:()=>this.accessibilityService.isScreenReaderOptimized(),backKeybindingLabel:()=>{},setContextKey:a=>this.setContextKey(a),returnFocus:()=>e.focus(),createList:(a,l,c,h,u)=>this.instantiationService.createInstance(ZF,a,l,c,h,u),styles:this.computeStyles()},o=this._register(new UL(Object.assign(Object.assign({},s),t)));return o.layout(e.dimension,(r=(i=e.offset)===null||i===void 0?void 0:i.top)!==null&&r!==void 0?r:0),this._register(e.onDidLayout(a=>{var l,c;return o.layout(a,(c=(l=e.offset)===null||l===void 0?void 0:l.top)!==null&&c!==void 0?c:0)})),this._register(o.onShow(()=>this.resetContextKeys())),this._register(o.onHide(()=>this.resetContextKeys())),o}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new Te(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t&&t.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t={},i=ai.None){return this.controller.pick(e,t,i)}createQuickPick(){return this.controller.createQuickPick()}updateStyles(){this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:Object.assign({},wa(this.theme,{quickInputBackground:y$,quickInputForeground:gNe,quickInputTitleBackground:pNe,contrastBorder:Ki,widgetShadow:T_})),inputBox:wa(this.theme,{inputForeground:mee,inputBackground:pee,inputBorder:_ee,inputValidationInfoBackground:D5,inputValidationInfoForeground:k5,inputValidationInfoBorder:L5,inputValidationWarningBackground:bee,inputValidationWarningForeground:vee,inputValidationWarningBorder:wee,inputValidationErrorBackground:yee,inputValidationErrorForeground:Cee,inputValidationErrorBorder:See}),countBadge:wa(this.theme,{badgeBackground:uv,badgeForeground:dv,badgeBorder:Ki}),button:wa(this.theme,{buttonForeground:sNe,buttonBackground:gF,buttonHoverBackground:oNe,buttonBorder:Ki}),progressBar:wa(this.theme,{progressBarBackground:aNe}),keybindingLabel:wa(this.theme,{keybindingLabelBackground:bNe,keybindingLabelForeground:vNe,keybindingLabelBorder:wNe,keybindingLabelBottomBorder:yNe,keybindingLabelShadow:T_}),list:wa(this.theme,{listBackground:y$,listInactiveFocusForeground:US,listInactiveSelectionIconForeground:jS,listInactiveFocusBackground:qS,listFocusOutline:Ur,listInactiveFocusOutline:Ur,pickerGroupBorder:_Ne,pickerGroupForeground:mNe})}}};cO=Q5e([sb(0,Kt),sb(1,Xe),sb(2,fi),sb(3,ps),sb(4,OL)],cO);var hie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},jd=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let hO=class extends cO{constructor(e,t,i,r,s,o){super(t,i,r,s,o),this.host=void 0;const a=V_.get(e);this.host={_serviceBrand:void 0,get container(){return a.widget.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus()}}createController(){return super.createController(this.host)}};hO=hie([jd(1,Kt),jd(2,Xe),jd(3,fi),jd(4,ps),jd(5,OL)],hO);let uO=class{constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(hO,e);this.mapEditorToService.set(e,t),ig(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get quickAccess(){return this.activeService.quickAccess}pick(e,t={},i=ai.None){return this.activeService.pick(e,t,i)}createQuickPick(){return this.activeService.createQuickPick()}};uO=hie([jd(0,Kt),jd(1,ui)],uO);class V_{constructor(e){this.editor=e,this.widget=new jL(this.editor)}static get(e){return e.getContribution(V_.ID)}dispose(){this.widget.dispose()}}V_.ID="editor.controller.quickInput";class jL{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return jL.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}jL.ID="editor.contrib.quickInputWidget";Yr(V_.ID,V_);var At;(function(n){const e=new $w;class t{constructor(l,c){this._serviceId=l,this._factory=c,this._value=null}get id(){return this._serviceId}get(l){if(!this._value){if(l&&(this._value=l[this._serviceId.toString()]),this._value||(this._value=this._factory(l)),!this._value)throw new Error("Service "+this._serviceId+" is missing!");e.set(this._serviceId,this._value)}return this._value}}n.LazyStaticService=t;let i=[];function r(a,l){let c=new t(a,l);return i.push(c),c}function s(a){let l=new $w;for(const[h,u]of R2e())l.set(h,u);for(let h in a)a.hasOwnProperty(h)&&l.set(Dt(h),a[h]);i.forEach(h=>l.set(h.id,h.get(a)));let c=new CD(l,!0);return l.set(Kt,c),[l,c]}n.init=s,n.instantiationService=r(Kt,()=>new CD(e,!0));const o=new zJ;n.configurationService=r(Zi,()=>o),n.resourceConfigurationService=r(pJ,()=>new gTe(o)),n.resourcePropertiesService=r(mJ,()=>new sF(o)),n.contextService=r(PJ,()=>new _L),n.labelService=r(Sy,()=>new _Te),n.telemetryService=r(y0,()=>new pTe),n.dialogService=r(Rte,()=>new dTe),n.notificationService=r(Qn,()=>new mL),n.markerService=r(ky,()=>new Ud),n.modeService=r(Zr,a=>new jw),n.standaloneThemeService=r(Cy,()=>new l4e),n.logService=r(Ih,()=>new sIe(new rIe)),n.undoRedoService=r(vy,a=>new TD(n.dialogService.get(a),n.notificationService.get(a))),n.languageConfigurationService=r(my,a=>new AE(n.configurationService.get(a),n.modeService.get(a))),n.modelService=r(Kr,a=>new vD(n.configurationService.get(a),n.resourcePropertiesService.get(a),n.standaloneThemeService.get(a),n.logService.get(a),n.undoRedoService.get(a),n.modeService.get(a),n.languageConfigurationService.get(a))),n.markerDecorationsService=r(h5,a=>new eO(n.modelService.get(a),n.markerService.get(a))),n.contextKeyService=r(Xe,a=>new MF(n.configurationService.get(a))),n.codeEditorService=r(ui,a=>new _D(null,n.contextKeyService.get(a),n.standaloneThemeService.get(a))),n.editorProgressService=r(L0,()=>new pL),n.storageService=r(Qg,()=>new l5e),n.editorWorkerService=r(pd,a=>new eF(n.modelService.get(a),n.resourceConfigurationService.get(a),n.logService.get(a)))})(At||(At={}));class J5e extends re{constructor(e,t){super();const[i,r]=At.init(t);this._serviceCollection=i,this._instantiationService=r;const s=this.get(Zi),o=this.get(Qn),a=this.get(y0),l=this.get(fi),c=this.get(Ih),h=this.get(Xe);let u=(m,b)=>{let _=null;return t&&(_=t[m.toString()]),_||(_=b()),this._serviceCollection.set(m,_),_};u(ps,()=>new tO(h,s)),u(vo,()=>new GF(l));let d=u(An,()=>new fTe(this._instantiationService)),f=u(Yi,()=>this._register(new $J(h,d,a,o,c,e))),g=u(OL,()=>new bTe(At.codeEditorService.get(ui),e));u(cie,()=>new uO(r,At.codeEditorService.get(ui)));let p=u(qg,()=>this._register(new $F(g)));u(Kg,()=>new d5e),u(Gg,()=>{const m=new WF(a,o,p,f,l);return m.configure({blockMouse:!1}),this._register(m)}),u(w0,()=>new QF(d)),u(LJ,()=>new mTe(At.modelService.get(Kr)))}get(e){let t=this._serviceCollection.get(e);if(!t)throw new Error("Missing service "+e);return t}set(e,t){this._serviceCollection.set(e,t)}has(e){return this._serviceCollection.has(e)}}function uie(n,e,t){let i=new J5e(n,e),r=null;i.has(sc)||(r=new rF(At.modelService.get()),i.set(sc,r)),i.has(ju)||i.set(ju,new FM(i.get(ui),i.get(An)));let s=t(i);return r&&r.setEditor(s),s}function eBe(n,e,t){return uie(n,t||{},i=>new TF(n,e,i,i.get(Kt),i.get(ui),i.get(An),i.get(Xe),i.get(Yi),i.get(qg),i.get(Cy),i.get(Qn),i.get(Zi),i.get(ps),i.get(Kr),i.get(Zr)))}function tBe(n){return At.codeEditorService.get().onCodeEditorAdd(e=>{n(e)})}function iBe(n,e,t){return uie(n,t||{},i=>new AF(n,e,i,i.get(Kt),i.get(Xe),i.get(Yi),i.get(qg),i.get(pd),i.get(ui),i.get(Cy),i.get(Qn),i.get(Zi),i.get(Gg),i.get(L0),i.get(Kg)))}function nBe(n,e){return new fLe(n,e)}function rBe(n,e,t){return dte(At.modelService.get(),At.modeService.get(),n,e,t)}function sBe(n,e){At.modelService.get().setMode(n,At.modeService.get().create(e))}function oBe(n,e,t){n&&At.markerService.get().changeOne(e,n.uri,t)}function aBe(n){return At.markerService.get().read(n)}function lBe(n){return At.markerService.get().onMarkerChanged(n)}function cBe(n){return At.modelService.get().getModel(n)}function hBe(){return At.modelService.get().getModels()}function uBe(n){return At.modelService.get().onModelAdded(n)}function dBe(n){return At.modelService.get().onModelRemoved(n)}function fBe(n){return At.modelService.get().onModelModeChanged(e=>{n({model:e.model,oldLanguage:e.oldModeId})})}function gBe(n){return hIe(At.modelService.get(),n)}function pBe(n,e){const t=At.standaloneThemeService.get();return t.registerEditorContainer(n),i5.colorizeElement(t,At.modeService.get(),n,e)}function mBe(n,e,t){return At.standaloneThemeService.get().registerEditorContainer(document.body),i5.colorize(At.modeService.get(),n,e,t)}function _Be(n,e,t=4){return At.standaloneThemeService.get().registerEditorContainer(document.body),i5.colorizeModelLine(n,e,t)}function bBe(n){let e=Fi.get(n);return e||{getInitialState:()=>Jk,tokenize:(t,i,r,s)=>qLe(n,t,r,s)}}function vBe(n,e){At.modeService.get().triggerMode(e);let i=bBe(e),r=nc(n),s=[],o=i.getInitialState();for(let a=0,l=r.length;a<l;a++){let c=r[a],h=i.tokenize(c,!0,o,0);s[a]=h.tokens,o=h.endState}return s}function wBe(n,e){At.standaloneThemeService.get().defineTheme(n,e)}function yBe(n){At.standaloneThemeService.get().setTheme(n)}function CBe(){ITe()}function SBe(n,e){return Pt.registerCommand({id:n,handler:e})}function xBe(){return{create:eBe,onDidCreateEditor:tBe,createDiffEditor:iBe,createDiffNavigator:nBe,createModel:rBe,setModelLanguage:sBe,setModelMarkers:oBe,getModelMarkers:aBe,onDidChangeMarkers:lBe,getModels:hBe,getModel:cBe,onDidCreateModel:uBe,onWillDisposeModel:dBe,onDidChangeModelLanguage:fBe,createWebWorker:gBe,colorizeElement:pBe,colorize:mBe,colorizeModelLine:_Be,tokenize:vBe,defineTheme:wBe,setTheme:yBe,remeasureFonts:CBe,registerCommand:SBe,AccessibilitySupport:WR,ContentWidgetPositionPreference:jR,CursorChangeReason:qR,DefaultEndOfLine:GR,EditorAutoIndentStrategy:ZR,EditorOption:YR,EndOfLinePreference:XR,EndOfLineSequence:QR,MinimapPosition:sM,MouseTargetType:oM,OverlayWidgetPositionPreference:aM,OverviewRulerLane:lM,RenderLineNumbersType:cM,RenderMinimap:hM,ScrollbarVisibility:dM,ScrollType:uM,TextEditorCursorBlinkingStyle:_M,TextEditorCursorStyle:bM,TrackedRangeStickiness:vM,WrappingIndent:wM,ConfigurationChangedEvent:iQ,BareFontInfo:kf,FontInfo:PM,TextModelResolvedOptions:OS,FindMatch:_w,EditorType:Xk,EditorOptions:Bg}}function EBe(n,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!n(t))return!1;return!0}function qC(n,e){return typeof n=="boolean"?n:e}function nH(n,e){return typeof n=="string"?n:e}function DBe(n){const e={};for(const t of n)e[t]=!0;return e}function rH(n,e=!1){e&&(n=n.map(function(i){return i.toLowerCase()}));const t=DBe(n);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function dO(n,e){e=e.replace(/@@/g,"");let t=0,i;do i=!1,e=e.replace(/@(\w+)/g,function(s,o){i=!0;let a="";if(typeof n[o]=="string")a=n[o];else if(n[o]&&n[o]instanceof RegExp)a=n[o].source;else throw n[o]===void 0?jt(n,"language definition does not contain attribute '"+o+"', used at: "+e):jt(n,"attribute reference '"+o+"' must be a string, used at: "+e);return Pp(a)?"":"(?:"+a+")"}),t++;while(i&&t<5);e=e.replace(/\x01/g,"@");let r=(n.ignoreCase?"i":"")+(n.unicode?"u":"");return new RegExp(e,r)}function kBe(n,e,t,i){if(i<0)return n;if(i<e.length)return e[i];if(i>=100){i=i-100;let r=t.split(".");if(r.unshift(t),i<r.length)return r[i]}return null}function LBe(n,e,t,i){let r=-1,s=t,o=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);o&&(o[3]&&(r=parseInt(o[3]),o[2]&&(r=r+100)),s=o[4]);let a="~",l=s;!s||s.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(o=s.match(/^(@|!@|~|!~|==|!=)(.*)$/),o&&(a=o[1],l=o[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){let h=rH(l.split("|"),n.ignoreCase);c=function(u){return a==="~"?h(u):!h(u)}}else if(a==="@"||a==="!@"){let h=n[l];if(!h)throw jt(n,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!EBe(function(d){return typeof d=="string"},h))throw jt(n,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);let u=rH(h,n.ignoreCase);c=function(d){return a==="@"?u(d):!u(d)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){let h=dO(n,"^"+l+"$");c=function(u){return a==="~"?h.test(u):!h.test(u)}}else c=function(h,u,d,f){return dO(n,"^"+ru(n,l,u,d,f)+"$").test(h)};else if(l.indexOf("$")<0){let h=xu(n,l);c=function(u){return a==="=="?u===h:u!==h}}else{let h=xu(n,l);c=function(u,d,f,g,p){let m=ru(n,h,d,f,g);return a==="=="?u===m:u!==m}}return r===-1?{name:t,value:i,test:function(h,u,d,f){return c(h,h,u,d,f)}}:{name:t,value:i,test:function(h,u,d,f){let g=kBe(h,u,d,r);return c(g||"",h,u,d,f)}}}function fO(n,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw jt(n,"a 'token' attribute must be of type string, in rule: "+e);{let i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw jt(n,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw jt(n,"the next state must be a string value in rule: "+e);{let r=t.next;if(!/^(@pop|@push|@popall)$/.test(r)&&(r[0]==="@"&&(r=r.substr(1)),r.indexOf("$")<0&&!TIe(n,ru(n,r,"",[],""))))throw jt(n,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=r}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,n.usesEmbedded=!0),i}}else if(Array.isArray(t)){let i=[];for(let r=0,s=t.length;r<s;r++)i[r]=fO(n,e,t[r]);return{group:i}}else if(t.cases){let i=[];for(let s in t.cases)if(t.cases.hasOwnProperty(s)){const o=fO(n,e,t.cases[s]);s==="@default"||s==="@"||s===""?i.push({test:void 0,value:o,name:s}):s==="@eos"?i.push({test:function(a,l,c,h){return h},value:o,name:s}):i.push(LBe(n,e,s,o))}const r=n.defaultToken;return{test:function(s,o,a,l){for(const c of i)if(!c.test||c.test(s,o,a,l))return c.value;return r}}}else throw jt(n,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class IBe{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw jt(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=dO(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=fO(e,this.name,t)}}function TBe(n,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");let t={};t.languageId=n,t.includeLF=qC(e.includeLF,!1),t.noThrow=!1,t.maxStack=100,t.start=typeof e.start=="string"?e.start:null,t.ignoreCase=qC(e.ignoreCase,!1),t.unicode=qC(e.unicode,!1),t.tokenPostfix=nH(e.tokenPostfix,"."+t.languageId),t.defaultToken=nH(e.defaultToken,"source"),t.usesEmbedded=!1;let i=e;i.languageId=n,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function r(o,a,l){for(const c of l){let h=c.include;if(h){if(typeof h!="string")throw jt(t,"an 'include' attribute must be a string at: "+o);if(h[0]==="@"&&(h=h.substr(1)),!e.tokenizer[h])throw jt(t,"include target '"+h+"' is not defined at: "+o);r(o+"."+h,a,e.tokenizer[h])}else{const u=new IBe(o);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(u.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")u.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const d=c[1];d.next=c[2],u.setAction(i,d)}else throw jt(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+o);else u.setAction(i,c[1]);else{if(!c.regex)throw jt(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+o);c.name&&typeof c.name=="string"&&(u.name=c.name),c.matchOnlyAtStart&&(u.matchOnlyAtLineStart=qC(c.matchOnlyAtLineStart,!1)),u.setRegex(i,c.regex),u.setAction(i,c.action)}a.push(u)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw jt(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(let o in e.tokenizer)if(e.tokenizer.hasOwnProperty(o)){t.start||(t.start=o);const a=e.tokenizer[o];t.tokenizer[o]=new Array,r("tokenizer."+o,t.tokenizer[o],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw jt(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];let s=[];for(let o of e.brackets){let a=o;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw jt(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")s.push({token:a.token+t.tokenPostfix,open:xu(t,a.open),close:xu(t,a.close)});else throw jt(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=s,t.noThrow=!0,t}function ABe(n){Ff.registerLanguage(n)}function NBe(){let n=[];return n=n.concat(Ff.getLanguages()),n}function RBe(n){return At.modeService.get().languageIdCodec.encodeLanguageId(n)}function MBe(n,e){let t=At.modeService.get().onDidEncounterLanguage(i=>{i===n&&(t.dispose(),e())});return t}function FBe(n,e){const t=At.modeService.get().validateLanguageId(n);if(!t)throw new Error(`Cannot set configuration for unknown language ${n}`);return zi.register(t,e,100)}class OBe{constructor(e,t){this._languageId=e,this._actual=t}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i,r){if(typeof this._actual.tokenize=="function")return t1.adaptTokenize(this._languageId,this._actual,e,i,r);throw new Error("Not supported!")}tokenize2(e,t,i){let r=this._actual.tokenizeEncoded(e,i);return new qk(r.tokens,r.endState)}}class t1{constructor(e,t,i,r){this._languageId=e,this._actual=t,this._modeService=i,this._standaloneThemeService=r}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t,i){let r=[],s=0;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c=l.startIndex;o===0?c=0:c<s&&(c=s),r[o]=new jk(c+i,l.scopes,t),s=c}return r}static adaptTokenize(e,t,i,r,s){let o=t.tokenize(i,r),a=t1._toClassicTokens(o.tokens,e,s),l;return o.endState.equals(r)?l=r:l=o.endState,new k3(a,l)}tokenize(e,t,i,r){return t1.adaptTokenize(this._languageId,this._actual,e,i,r)}_toBinaryTokens(e,t,i){const r=e.encodeLanguageId(this._languageId),s=this._standaloneThemeService.getColorTheme().tokenTheme;let o=[],a=0,l=0;for(let h=0,u=t.length;h<u;h++){const d=t[h],f=s.match(r,d.scopes);if(a>0&&o[a-1]===f)continue;let g=d.startIndex;h===0?g=0:g<l&&(g=l),o[a++]=g+i,o[a++]=f,l=g}let c=new Uint32Array(a);for(let h=0;h<a;h++)c[h]=o[h];return c}tokenize2(e,t,i,r){let s=this._actual.tokenize(e,i),o=this._toBinaryTokens(this._modeService.languageIdCodec,s.tokens,r),a;return s.endState.equals(i)?a=i:a=s.endState,new qk(o,a)}}function PBe(n){return"tokenizeEncoded"in n}function die(n){return n&&typeof n.then=="function"}function BBe(n){if(n){const e=[null];for(let t=1,i=n.length;t<i;t++)e[t]=X.fromHex(n[t]);At.standaloneThemeService.get().setColorMapOverride(e)}else At.standaloneThemeService.get().setColorMapOverride(null)}function VBe(n,e){const t=At.modeService.get().validateLanguageId(n);if(!t)throw new Error(`Cannot set tokens provider for unknown language ${n}`);const i=r=>PBe(r)?new OBe(t,r):new t1(t,r,At.modeService.get(),At.standaloneThemeService.get());return die(e)?Fi.registerPromise(n,e.then(r=>i(r))):Fi.register(n,i(e))}function WBe(n,e){const t=i=>RIe(At.modeService.get(),At.standaloneThemeService.get(),n,TBe(n,i));return die(e)?Fi.registerPromise(n,e.then(i=>t(i))):Fi.register(n,t(e))}function $Be(n,e){return EE.register(n,e)}function zBe(n,e){return VM.register(n,e)}function HBe(n,e){return WM.register(n,e)}function UBe(n,e){return bw.register(n,{provideHover:(t,i,r)=>{let s=t.getWordAtPosition(i);return Promise.resolve(e.provideHover(t,i,r)).then(o=>{if(o)return!o.range&&s&&(o.range=new V(i.lineNumber,s.startColumn,i.lineNumber,s.endColumn)),o.range||(o.range=new V(i.lineNumber,i.column,i.lineNumber,i.column)),o})}})}function jBe(n,e){return $M.register(n,e)}function qBe(n,e){return DE.register(n,e)}function GBe(n,e){return HLe.register(n,e)}function KBe(n,e){return vw.register(n,e)}function ZBe(n,e){return LE.register(n,e)}function YBe(n,e){return IE.register(n,e)}function XBe(n,e){return zM.register(n,e)}function QBe(n,e,t){return Jl.register(n,{providedCodeActionKinds:t==null?void 0:t.providedCodeActionKinds,provideCodeActions:(i,r,s,o)=>{let a=At.markerService.get().read({resource:i.uri}).filter(l=>V.areIntersectingOrTouching(l,r));return e.provideCodeActions(i,r,{markers:a,only:s.only},o)},resolveCodeAction:e.resolveCodeAction})}function JBe(n,e){return Jb.register(n,e)}function e6e(n,e){return nu.register(n,e)}function t6e(n,e){return YQ.register(n,e)}function i6e(n,e){return XQ.register(n,e)}function n6e(n,e){return Da.register(n,e)}function r6e(n,e){return y_.register(n,e)}function s6e(n,e){return UM.register(n,e)}function o6e(n,e){return kE.register(n,e)}function a6e(n,e){return ULe.register(n,e)}function l6e(n,e){return C_.register(n,e)}function c6e(n,e){return QQ.register(n,e)}function h6e(n,e){return G3.register(n,e)}function u6e(n,e){return HM.register(n,e)}function d6e(){return{register:ABe,getLanguages:NBe,onLanguage:MBe,getEncodedLanguageId:RBe,setLanguageConfiguration:FBe,setColorMap:BBe,setTokensProvider:VBe,setMonarchTokensProvider:WBe,registerReferenceProvider:$Be,registerRenameProvider:zBe,registerCompletionItemProvider:n6e,registerSignatureHelpProvider:HBe,registerHoverProvider:UBe,registerDocumentSymbolProvider:jBe,registerDocumentHighlightProvider:qBe,registerLinkedEditingRangeProvider:GBe,registerDefinitionProvider:KBe,registerImplementationProvider:ZBe,registerTypeDefinitionProvider:YBe,registerCodeLensProvider:XBe,registerCodeActionProvider:QBe,registerDocumentFormattingEditProvider:JBe,registerDocumentRangeFormattingEditProvider:e6e,registerOnTypeFormattingEditProvider:t6e,registerLinkProvider:i6e,registerColorProvider:r6e,registerFoldingRangeProvider:s6e,registerDeclarationProvider:o6e,registerSelectionRangeProvider:a6e,registerDocumentSemanticTokensProvider:l6e,registerDocumentRangeSemanticTokensProvider:c6e,registerInlineCompletionsProvider:h6e,registerInlayHintsProvider:u6e,DocumentHighlightKind:KR,CompletionItemKind:zR,CompletionItemTag:HR,CompletionItemInsertTextRule:$R,SymbolKind:pM,SymbolTag:mM,IndentAction:JR,CompletionTriggerKind:UR,SignatureHelpTriggerKind:gM,InlayHintKind:eM,InlineCompletionTriggerKind:tM,FoldingRangeKind:Ka}}class SA{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}var I0=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function f6e(n){const e=[],t=new Set,i=Jb.ordered(n);for(const s of i)e.push(s),s.extensionId&&t.add(SA.toKey(s.extensionId));const r=nu.ordered(n);for(const s of r){if(s.extensionId){if(t.has(SA.toKey(s.extensionId)))continue;t.add(SA.toKey(s.extensionId))}e.push({displayName:s.displayName,extensionId:s.extensionId,provideDocumentFormattingEdits(o,a,l){return s.provideDocumentRangeFormattingEdits(o,o.getFullModelRange(),a,l)}})}return e}class i1{static setFormatterSelector(e){return{dispose:i1._selectors.unshift(e)}}static select(e,t,i){return I0(this,void 0,void 0,function*(){if(e.length===0)return;const r=vt.first(i1._selectors);if(r)return yield r(e,t,i)})}}i1._selectors=new As;function g6e(n,e,t,i,r){return I0(this,void 0,void 0,function*(){const s=nu.ordered(e);for(const o of s){let a=yield Promise.resolve(o.provideDocumentRangeFormattingEdits(e,t,i,r)).catch(ca);if(tc(a))return yield n.computeMoreMinimalEdits(e.uri,a)}})}function p6e(n,e,t,i){return I0(this,void 0,void 0,function*(){const r=f6e(e);for(const s of r){let o=yield Promise.resolve(s.provideDocumentFormattingEdits(e,t,i)).catch(ca);if(tc(o))return yield n.computeMoreMinimalEdits(e.uri,o)}})}function m6e(n,e,t,i,r){const s=YQ.ordered(e);return s.length===0||s[0].autoFormatTriggerCharacters.indexOf(i)<0?Promise.resolve(void 0):Promise.resolve(s[0].provideOnTypeFormattingEdits(e,t,i,r,ai.None)).catch(ca).then(o=>n.computeMoreMinimalEdits(e.uri,o))}Pt.registerCommand("_executeFormatRangeProvider",function(n,...e){return I0(this,void 0,void 0,function*(){const[t,i,r]=e;ji(qe.isUri(t)),ji(V.isIRange(i));const s=n.get(sc),o=n.get(pd),a=yield s.createModelReference(t);try{return g6e(o,a.object.textEditorModel,V.lift(i),r,ai.None)}finally{a.dispose()}})});Pt.registerCommand("_executeFormatDocumentProvider",function(n,...e){return I0(this,void 0,void 0,function*(){const[t,i]=e;ji(qe.isUri(t));const r=n.get(sc),s=n.get(pd),o=yield r.createModelReference(t);try{return p6e(s,o.object.textEditorModel,i,ai.None)}finally{o.dispose()}})});Pt.registerCommand("_executeFormatOnTypeProvider",function(n,...e){return I0(this,void 0,void 0,function*(){const[t,i,r,s]=e;ji(qe.isUri(t)),ji(G.isIPosition(i)),ji(typeof r=="string");const o=n.get(sc),a=n.get(pd),l=yield o.createModelReference(t);try{return m6e(a,l.object.textEditorModel,G.lift(i),r,s)}finally{l.dispose()}})});var xA;Bg.wrappingIndent.defaultValue=0;Bg.glyphMargin.defaultValue=!1;Bg.autoIndent.defaultValue=3;Bg.overviewRulerLanes.defaultValue=2;i1.setFormatterSelector((n,e,t)=>Promise.resolve(n[0]));const Er=gQ();Er.editor=xBe();Er.languages=d6e();Er.CancellationTokenSource;const _6e=Er.Emitter;Er.KeyCode;Er.KeyMod;Er.Position;const FHe=Er.Range;Er.Selection;Er.SelectionDirection;const OHe=Er.MarkerSeverity;Er.MarkerTag;Er.Uri;Er.Token;const b6e=Er.editor,qL=Er.languages;(!((xA=hi.MonacoEnvironment)===null||xA===void 0)&&xA.globalAPI||typeof define=="function"&&define.amd)&&(self.monaco=Er);typeof self.require<"u"&&typeof self.require.config=="function"&&self.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const v6e="#/definitions/RootSpec",w6e="http://json-schema.org/draft-07/schema#",y6e={AggregateParams:{additionalProperties:!1,properties:{groupby:{description:"Which fields to use for grouping. Missing `groupby` results in a single group that includes all the data items.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"aggregate",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},Align:{enum:["left","center","right"],type:"string"},Axis:{additionalProperties:!1,properties:{domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},AxisGenomeData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to use"},type:{const:"axisGenome",type:"string"}},required:["type","channel"],type:"object"},AxisOrient:{enum:["top","bottom","left","right"],type:"string"},AxisTicksData:{additionalProperties:!1,properties:{axis:{$ref:"#/definitions/Axis",description:"Optional axis properties"},channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:"Which channel's scale domain to listen to"},type:{const:"axisTicks",type:"string"}},required:["type","channel"],type:"object"},BamData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".bai"`.',type:"string"},type:{const:"bam",type:"string"},url:{description:"URL of the BigBed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `10000`",type:"number"}},required:["type","url"],type:"object"},Baseline:{enum:["top","middle","bottom","alphabetic"],type:"string"},BigBedData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},type:{const:"bigbed",type:"string"},url:{description:"URL of the BigBed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the BigBed file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `1000000`",type:"number"}},required:["type","url"],type:"object"},BigWigData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},pixelsPerBin:{description:"The approximate minimum width of each data bin, in pixels.\n\n__Default value:__ `2`",type:"number"},type:{const:"bigwig",type:"string"},url:{description:"URL of the BigWig file.",type:"string"}},required:["type","url"],type:"object"},ChannelWithScale:{anyOf:[{$ref:"#/definitions/PositionalChannel"},{const:"color",type:"string"},{const:"fill",type:"string"},{const:"stroke",type:"string"},{const:"opacity",type:"string"},{const:"fillOpacity",type:"string"},{const:"strokeOpacity",type:"string"},{const:"strokeWidth",type:"string"},{const:"size",type:"string"},{const:"shape",type:"string"},{const:"angle",type:"string"},{const:"dx",type:"string"},{const:"dy",type:"string"},{const:"sample",type:"string"}]},ChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{const:"locus",type:"string"}},required:["chrom","type"],type:"object"},ChromosomalLocus:{additionalProperties:!1,properties:{chrom:{description:'The name of the chromosome. For example: `"chr1"`, `"CHR1"`, or `"1"`.',type:"string"},pos:{description:"The zero-based position inside the chromosome or contig.",type:"number"}},required:["chrom"],type:"object"},CollectParams:{additionalProperties:!1,properties:{groupby:{description:"Arranges the data into consecutive batches based on the groups. This is mainly intended for internal use so that faceted data can be handled as batches.",items:{$ref:"#/definitions/Field"},type:"array"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order."},type:{const:"collect",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},"ColorDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2C(string%7Cnull)%3E"},CompareParams:{additionalProperties:!1,properties:{field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to sort by"},order:{anyOf:[{items:{$ref:"#/definitions/SortOrder"},type:"array"},{$ref:"#/definitions/SortOrder"}],description:'The order(s) to use: `"ascending"` (default), `"descending"`.'}},required:["field"],type:"object"},ComplexDomain:{description:"A complex domain that needs to be converted into a scalar domain before it is assigned to a scale.",items:{$ref:"#/definitions/ChromosomalLocus"},type:"array"},ConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},columns:{type:"number"},concat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["concat","columns"],type:"object"},Contig:{additionalProperties:!1,properties:{name:{type:"string"},size:{type:"number"}},required:["name","size"],type:"object"},CoverageParams:{additionalProperties:!1,properties:{as:{description:"The output field for the computed coverage.",type:"string"},asChrom:{description:"The output field for the chromosome.\n\n**Default:** Same as `chrom`",type:"string"},asEnd:{description:"The output field for the end coordinate.\n\n**Default:** Same as `end`",type:"string"},asStart:{description:"The output field for the start coordinate.\n\n**Default:** Same as `start`",type:"string"},chrom:{$ref:"#/definitions/Field",description:"An optional chromosome field that is passed through. TODO: groupby"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"coverage",description:"The type of the transform to be applied",type:"string"},weight:{$ref:"#/definitions/Field",description:"A field representing an optional weight for the segment. Can be used with copy ratios, for example."}},required:["end","start","type"],type:"object"},CsvDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',enum:["csv","tsv"],type:"string"}},type:"object"},Data:{anyOf:[{$ref:"#/definitions/DataSource"},{$ref:"#/definitions/Generator"}]},DataFormat:{anyOf:[{$ref:"#/definitions/CsvDataFormat"},{$ref:"#/definitions/DsvDataFormat"},{$ref:"#/definitions/JsonDataFormat"},{$ref:"#/definitions/OtherDataFormat"}]},DataSource:{anyOf:[{$ref:"#/definitions/UrlData"},{$ref:"#/definitions/InlineData"},{$ref:"#/definitions/NamedData"},{$ref:"#/definitions/DynamicCallbackData"},{$ref:"#/definitions/LazyData"}]},DsvDataFormat:{additionalProperties:!1,properties:{delimiter:{description:"The delimiter between records. The delimiter must be a single character (i.e., a single 16-bit code unit); so, ASCII delimiters are fine, but emoji delimiters are not.",maxLength:1,minLength:1,type:"string"},parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},type:{const:"dsv",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},required:["delimiter"],type:"object"},DynamicCallbackData:{additionalProperties:!1,properties:{dynamicCallbackSource:{description:"The View class has `getDynamicData()` methods that provides the data. This is intended for internal use.",type:"boolean"},format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["dynamicCallbackSource"],type:"object"},DynamicOpacity:{additionalProperties:!1,description:"DynamicOpacity specifies a zoom-dependent behavior for view opacity. The opacity is interpolated between the specified stops.",properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel"},unitsPerPixel:{description:"Stops expressed as units (base pairs, for example) per pixel.",items:{type:"number"},type:"array"},values:{description:"Opacity values that match the given stops.",items:{type:"number"},type:"array"}},required:["unitsPerPixel","values"],type:"object"},Encoding:{additionalProperties:!1,properties:{angle:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Rotation angle of point and text marks."},color:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Color of the marks  either fill or stroke color based on  the `filled` property of mark definition.\n\n_Note:_ 1) For fine-grained control over both fill and stroke colors of the marks, please use the `fill` and `stroke` channels. The `fill` or `stroke` encodings have higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified. 2) See the scale documentation for more information about customizing [color scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme)."},dx:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E"},dy:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E"},facetIndex:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"For internal use"},fill:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Fill color of the marks.\n\n_Note:_ The `fill` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},fillOpacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Fill opacity of the marks."},opacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Opacity of the marks."},sample:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"Facet identifier for interactive filtering, sorting, and grouping in the App."},search:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E"},semanticScore:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E"},shape:{$ref:"#/definitions/ShapeDef%3Cstring%3E",description:'Shape of the mark.\n\nFor `point` marks the supported values include:\n- plotting shapes: `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, or `"triangle-left"`.\n- centered directional shape `"triangle"`'},size:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:'Size of the mark.\n- For `"point"`  the symbol size, or pixel area of the mark.\n- For `"text"`  the text\'s font size.'},stroke:{$ref:"#/definitions/ColorDef%3Cstring%3E",description:"Stroke color of the marks.\n\n_Note:_ The `stroke` encoding has higher precedence than `color`, thus may override the `color` encoding if conflicting encodings are specified."},strokeOpacity:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Stroke opacity of the marks."},strokeWidth:{$ref:"#/definitions/NumericMarkPropDef%3Cstring%3E",description:"Stroke width of the marks."},text:{$ref:"#/definitions/TextDef%3Cstring%3E",description:"Text of the `text` mark."},uniqueId:{$ref:"#/definitions/FieldDefWithoutScale%3Cstring%3E",description:"For internal use"},x:{$ref:"#/definitions/PositionDef%3Cstring%3E",description:"X coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},x2:{$ref:"#/definitions/Position2Def%3Cstring%3E",description:"X2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y:{$ref:"#/definitions/PositionDef%3Cstring%3E",description:"Y coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."},y2:{$ref:"#/definitions/Position2Def%3Cstring%3E",description:"Y2 coordinates of the marks.\n\nThe `value` of this channel can be a number between zero and one."}},type:"object"},ExprDef:{additionalProperties:!1,properties:{expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"}},required:["expr"],type:"object"},Field:{description:"The name of the field or a JavaScript expression for accessing nested properties. Dots and brackets in the field name must be escaped.",type:"string"},"FieldDefWithoutScale<string>":{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},FieldName:{type:"string"},FilterParams:{additionalProperties:!1,properties:{expr:{description:"An expression string. The data object is removed if the expression evaluates to false.",type:"string"},type:{const:"filter",description:"The type of the transform to be applied",type:"string"}},required:["expr","type"],type:"object"},FilterScoredLabelsParams:{additionalProperties:!1,properties:{channel:{description:'**Default:** `"x"`',enum:["x","y"],type:"string"},lane:{$ref:"#/definitions/Field",description:"An optional field representing element's lane, e.g., if transcripts are shown using a piled up layout."},padding:{description:"Padding (in pixels) around the element.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/Field",description:"The field representing element's position on the domain."},score:{$ref:"#/definitions/Field",description:"The field representing the score used for prioritization."},type:{const:"filterScoredLabels",description:"The type of the transform to be applied",type:"string"},width:{$ref:"#/definitions/Field",description:"The field representing element's width in pixels"}},required:["pos","score","type","width"],type:"object"},FlattenCompressedExonsParams:{additionalProperties:!1,properties:{as:{description:'Field names for the flattened exons.\n\n**Default:** `["exonStart", "exonEnd"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},exons:{$ref:"#/definitions/Field",description:'The field containing the exons.\n\n**Default:** `"exons"`'},start:{$ref:"#/definitions/Field",description:'Start coordinate of the gene body.\n\n**Default:** `"start"`'},type:{const:"flattenCompressedExons",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenDelimitedParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},field:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to split and flatten"},separator:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"Separator(s) used on the field(s) TODO: Rename to delimiter"},type:{const:"flattenDelimited",description:"The type of the transform to be applied",type:"string"}},required:["field","separator","type"],type:"object"},FlattenParams:{additionalProperties:!1,properties:{as:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:`The output field name(s) for the flattened field.

**Default:** the input fields.`},fields:{anyOf:[{items:{$ref:"#/definitions/Field"},type:"array"},{$ref:"#/definitions/Field"}],description:"The field(s) to flatten. If no field is defined, the data object itself is treated as an array to be flattened."},index:{description:"The output field name for the zero-based index of the array values. If unspecified, an index field is not added.",type:"string"},type:{const:"flatten",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FlattenSequenceParams:{additionalProperties:!1,properties:{as:{description:'Name of the fields where the zero-based index number and flattened sequence letter are written to.\n\n**Default:** `["pos", "sequence"]`',items:{type:"string"},maxItems:2,minItems:2,type:"array"},field:{$ref:"#/definitions/Field",description:'The field to flatten.\n\n**Default:** `"sequence"`'},type:{const:"flattenSequence",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},FontStyle:{enum:["normal","italic"],type:"string"},FontWeight:{anyOf:[{type:"number"},{const:"thin",type:"string"},{const:"light",type:"string"},{const:"regular",type:"string"},{const:"normal",type:"string"},{const:"medium",type:"string"},{const:"bold",type:"string"},{const:"black",type:"string"}]},FormulaParams:{additionalProperties:!1,properties:{as:{description:"The (new) field where the computed value is written to",type:"string"},expr:{description:"An expression string",type:"string"},type:{const:"formula",description:"The type of the transform to be applied",type:"string"}},required:["as","expr","type"],type:"object"},Generator:{$ref:"#/definitions/SequenceGenerator"},GenomeAxis:{additionalProperties:!1,properties:{chromGrid:{description:"A boolean flag indicating if chromosome grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},chromGridCap:{description:'The stroke cap for the chromosome grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},chromGridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},chromGridDash:{description:"An array of alternating [stroke, space] lengths for dashed chromosome grid mark lines.",items:{type:"number"},type:"array"},chromGridDashOffset:{description:"The pixel offset at which to start drawing with the chromosome grid mark dash array.",type:"number"},chromGridFillEven:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridFillOdd:{description:`Fill color of odd chromosomes.

__Default value:__ (none)`,type:"string"},chromGridOpacity:{description:"The opacity of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromGridWidth:{description:"Width of the chromosome grid lines.\n\n__Default value:__ `1`",type:"number"},chromLabelAlign:{$ref:"#/definitions/Align"},chromLabelColor:{type:"string"},chromLabelFont:{type:"string"},chromLabelFontSize:{type:"number"},chromLabelFontStyle:{$ref:"#/definitions/FontStyle"},chromLabelFontWeight:{$ref:"#/definitions/FontWeight"},chromLabelPadding:{type:"number"},chromLabels:{type:"boolean"},chromTickColor:{type:"string"},chromTickDash:{items:{type:"number"},type:"array"},chromTickDashOffset:{type:"number"},chromTickSize:{type:"number"},chromTickWidth:{type:"number"},chromTicks:{type:"boolean"},domain:{description:"A boolean flag indicating if the domain (the axis baseline) should be included as part of the axis.\n\n__Default value:__ `true`",type:"boolean"},domainCap:{description:'The stroke cap for the domain line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},domainColor:{description:'Color of axis domain line.\n\n__Default value:__ `"gray"`.',type:"string"},domainDash:{description:"An array of alternating [stroke, space] lengths for dashed domain lines.",items:{type:"number"},type:"array"},domainDashOffset:{description:"The pixel offset at which to start drawing with the domain dash array.",type:"number"},domainWidth:{description:"Stroke width of axis domain line\n\n__Default value:__ `1`",type:"number"},format:{description:"The format specifier pattern for axis labels. Must be a legal [d3-format](https://github.com/d3/d3-format#locale_format) specifier.",type:"string"},grid:{description:"A boolean flag indicating if grid lines should be included as part of the axis.\n\n__Default value:__ `false`",type:"boolean"},gridCap:{description:'The stroke cap for the grid line\'s ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},gridColor:{description:"Color of grid lines.\n\n__Default value:__ `lightgray`",type:"string"},gridDash:{description:"An array of alternating [stroke, space] lengths for dashed grid mark lines.",items:{type:"number"},type:"array"},gridDashOffset:{description:"The pixel offset at which to start drawing with the grid mark dash array.",type:"number"},gridOpacity:{description:"The opacity of the grid lines.\n\n__Default value:__ `1`",type:"number"},gridWidth:{description:"Width of the grid lines.\n\n__Default value:__ `1`",type:"number"},labelAlign:{$ref:"#/definitions/Align",description:"Horizontal text alignment of axis tick labels, overriding the default setting for the current axis orientation."},labelAngle:{description:"The rotation angle of the axis labels.\n\n__Default value:__ `-90` for nominal and ordinal fields; `0` otherwise.",maximum:360,minimum:-360,type:"number"},labelBaseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline of axis tick labels, overriding the default setting for the current axis orientation. One of `"alphabetic"` (default), `"top"`, `"middle"`, `"bottom"`.'},labelColor:{description:"The color of the tick label, can be in hex color code or regular color name.",type:"string"},labelFont:{description:"The font of the tick label.",type:"string"},labelFontSize:{description:"The font size of the label, in pixels.",minimum:0,type:"number"},labelFontStyle:{description:"Font style of the title.",type:"string"},labelFontWeight:{description:"Font weight of axis tick labels.",type:"string"},labelLimit:{description:"Maximum allowed pixel width of axis tick labels.\n\n__Default value:__ `180`",type:"number"},labelPadding:{description:"The padding, in pixels, between axis and text labels.\n\n__Default value:__ `2`",type:"number"},labels:{description:"A boolean flag indicating if labels should be included as part of the axis.\n\n__Default value:__ `true`.",type:"boolean"},maxExtent:{description:"The maximum extent in pixels that axis ticks and labels should use. This determines a maximum offset value for axis titles.\n\n__Default value:__ `undefined`.",type:"number"},minExtent:{description:"The minimum extent in pixels that axis ticks and labels should use. This determines a minimum offset value for axis titles.\n\n__Default value:__ `30` for y-axis; `undefined` for x-axis.",type:"number"},offset:{description:"The orthogonal offset in pixels by which to displace the axis from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/AxisOrient",description:'The orientation of the axis. One of `"top"`, `"bottom"`, `"left"` or `"right"`. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart).\n\n__Default value:__ `"bottom"` for x-axes and `"left"` for y-axes.'},tickCap:{description:'The stroke cap for the tick lines\' ending style. One of `"butt"`, `"round"` or `"square"`.\n\n__Default value:__ `"butt"`',enum:["butt","round","square"],type:"string"},tickColor:{description:`The color of the axis's tick.

__Default value:__ \`"gray"\``,type:"string"},tickCount:{description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of `2`, `5`, `10`) and lie within the underlying scale\'s range.',minimum:0,type:"number"},tickDash:{description:"An array of alternating [stroke, space] lengths for dashed tick mark lines.",items:{type:"number"},type:"array"},tickDashOffset:{description:"The pixel offset at which to start drawing with the tick mark dash array.",type:"number"},tickMinStep:{description:"The minimum desired step between axis ticks, in terms of scale domain values. For example, a value of `1` indicates that ticks should not be less than 1 unit apart. If `tickMinStep` is specified, the `tickCount` value will be adjusted, if necessary, to enforce the minimum step value.",type:"number"},tickSize:{description:"The size in pixels of axis ticks.\n\n__Default value:__ `5`",minimum:0,type:"number"},tickWidth:{description:"The width, in pixels, of ticks.\n\n__Default value:__ `1`",minimum:0,type:"number"},ticks:{description:"Boolean value that determines whether the axis should include ticks.\n\n__Default value:__ `true`",type:"boolean"},title:{description:"A title for the axis (none by default).",type:"string"},titleColor:{description:"Color of the title, can be in hex color code or regular color name.",type:"string"},titleFont:{description:'Font of the title. (e.g., `"Helvetica Neue"`).',type:"string"},titleFontSize:{description:"Font size of the title.",minimum:0,type:"number"},titleFontStyle:{description:"Font style of the title.",type:"string"},titleFontWeight:{description:'Font weight of the title. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).',type:"string"},titleOpacity:{description:"Opacity of the axis title.",type:"number"},titlePadding:{description:"The padding, in pixels, between title and axis.",type:"number"},values:{description:"Explicitly set the visible axis tick and label values.",items:{},type:"array"}},type:"object"},GenomeConfig:{additionalProperties:!1,properties:{baseUrl:{description:'Base url of data files: chromsizes, cytobands, and gene annotations.\n\n**Default:** `"https://genomespy.app/data/genomes/"`',type:"string"},contigs:{description:"As an alternative for chromSizes, the contigs can be provided inline.",items:{$ref:"#/definitions/Contig"},type:"array"},name:{description:"Name of the genome assembly, e.g., `hg19` or `hg38`.",type:"string"}},required:["name"],type:"object"},Gff3Data:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},debounceDomainChange:{description:"The debounce time for domain changes, in milliseconds. Debouncing prevents data fetches while the user is still panning around.\n\n__Default value:__ `200`",type:"number"},indexUrl:{description:'Url of the tabix index file.\n\n__Default value:__ `url` + `".tbi"`.',type:"string"},type:{const:"gff3",type:"string"},url:{description:"Url of the bgzip compressed file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the Tabix file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `30000000`",type:"number"}},required:["type","url"],type:"object"},HConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},hconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["hconcat"],type:"object"},HandledTooltip:{additionalProperties:!1,properties:{handler:{type:"string"},params:{type:"object"}},required:["handler"],type:"object"},IdentifierParams:{additionalProperties:!1,properties:{as:{description:'**Default:** `"_uniqueId"`',type:"string"},type:{const:"identifier",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},ImportConfig:{additionalProperties:!1,properties:{name:{type:"string"},params:{type:"object"},url:{type:"string"}},type:"object"},ImportSpec:{additionalProperties:!1,properties:{import:{$ref:"#/definitions/ImportConfig"}},required:["import"],type:"object"},IndexedFastaData:{additionalProperties:!1,properties:{channel:{$ref:"#/definitions/PrimaryPositionalChannel",description:`Which channel's scale domain to monitor.

__Default value:__ \`"x"\``},indexUrl:{description:'URL of the index file.\n\n__Default value:__ `url` + `".fai"`.',type:"string"},type:{const:"indexedFasta",type:"string"},url:{description:"URL of the fasta file.",type:"string"},windowSize:{description:"Size of each chunk when fetching the fasta file. Data is only fetched when the length of the visible domain smaller than the window size.\n\n__Default value:__ `7000`",type:"number"}},required:["type","url"],type:"object"},InlineData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},values:{$ref:"#/definitions/InlineDataset",description:"The full data set, included inline. This can be an array of objects or primitive values, an object, or a string. Arrays of primitive values are ingested as objects with a `data` property. Strings are parsed according to the specified format type."}},required:["values"],type:"object"},InlineDataset:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"},{items:{type:"object"},type:"array"},{type:"string"},{type:"object"}]},JsonDataFormat:{additionalProperties:!1,properties:{parse:{anyOf:[{$ref:"#/definitions/Parse"},{type:"null"}],description:'If set to `null`, disable type inference based on the spec and only use type inference based on the data. Alternatively, a parsing directive object can be provided for explicit data types. Each property of the object corresponds to a field name, and the value to the desired data type (one of `"number"`, `"boolean"`, `"date"`, or null (do not parse the field)). For example, `"parse": {"modified_on": "date"}` parses the `modified_on` field in each input record a Date value.\n\nFor `"date"`, we parse data based using Javascript\'s [`Date.parse()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse). For Specific date formats can be provided (e.g., `{foo: "date:\'%m%d%Y\'"}`), using the [d3-time-format syntax](https://github.com/d3/d3-time-format#locale_format). UTC date format parsing is supported similarly (e.g., `{foo: "utc:\'%m%d%Y\'"}`). See more about [UTC time](https://vega.github.io/vega-lite/docs/timeunit.html#utc)'},property:{description:'The JSON property containing the desired data. This parameter can be used when the loaded JSON file may have surrounding structure or meta-data. For example `"property": "values.features"` is equivalent to retrieving `json.values.features` from the loaded JSON object.',type:"string"},type:{const:"json",description:'Type of input data: `"json"`, `"csv"`, `"tsv"`, `"dsv"`.\n\n__Default value:__  The default format type is determined by the extension of the file URL. If no extension is detected, `"json"` will be used by default.',type:"string"}},type:"object"},LayerSpec:{additionalProperties:!1,properties:{aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}]},type:"array"},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["layer"],type:"object"},LazyData:{additionalProperties:!1,properties:{lazy:{$ref:"#/definitions/LazyDataParams"}},required:["lazy"],type:"object"},LazyDataParams:{anyOf:[{$ref:"#/definitions/AxisTicksData"},{$ref:"#/definitions/AxisGenomeData"},{$ref:"#/definitions/IndexedFastaData"},{$ref:"#/definitions/BigWigData"},{$ref:"#/definitions/BigBedData"},{$ref:"#/definitions/BamData"},{$ref:"#/definitions/Gff3Data"}]},LinearizeGenomicCoordinateParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The output field or fields for linearized coordinates."},channel:{description:'Get the genome assembly from the scale of the channel.\n\n**Default:** `"x"`',enum:["x","y"],type:"string"},chrom:{$ref:"#/definitions/Field",description:"The chromosome/contig field"},offset:{anyOf:[{type:"number"},{items:{type:"number"},type:"array"}],description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`"},pos:{anyOf:[{$ref:"#/definitions/Field"},{items:{$ref:"#/definitions/Field"},type:"array"}],description:"The field or fields that contain intra-chromosomal positions"},type:{const:"linearizeGenomicCoordinate",description:"The type of the transform to be applied",type:"string"}},required:["as","chrom","pos","type"],type:"object"},MarkConfigAndType:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},angle:{description:"The rotation angle in degrees.\n\n**Default value:** `0`",type:"number"},baseline:{$ref:"#/definitions/Baseline",description:'The vertical alignment of the text.  One of `"top"`, `"middle"`, `"bottom"`.\n\n**Default value:** `"bottom"`'},buildIndex:{description:`Builds and index for efficient rendering of subsets of the data. The data must be sorted by the x coordinate.

TODO: This should be enabled automatically if the data are sorted.`,type:"boolean"},clip:{anyOf:[{type:"boolean"},{const:"never",type:"string"}],description:"If true, the mark is clipped to the UnitView's rectangle. By default, clipping is enabled for marks that have zoomable positional scales."},color:{type:"string"},color2:{description:"TODO",type:"string"},cornerRadius:{description:"Radius of the rounded corners.\n\n**Default value:** `0`",type:"number"},cornerRadiusBottomLeft:{description:"Radius of the bottom left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusBottomRight:{description:"Radius of the bottom right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusTopLeft:{description:"Radius of the top left rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},cornerRadiusTopRight:{description:"Radius of the top right rounded corner. Has higher precedence than `cornerRadius`.\n\n**Default value:** (None)",type:"number"},dx:{description:"The horizontal offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},dy:{description:"The vertical offset between the text and its anchor point, in pixels. Applied after the rotation by `angle`.",type:"number"},fill:{description:"The fill color",type:"string"},fillGradientStrength:{description:"Gradient strength controls the amount of the gradient eye-candy effect in the fill color. Valid values are between 0 and 1.\n\n**Default value:** `0`",type:"number"},fillOpacity:{description:"The fill opacity. Value between [0, 1].",type:"number"},filled:{description:"Whether the `color` represents the `fill` color (`true`) or the `stroke` color (`false`).",type:"boolean"},fitToBand:{description:'If true, sets the secondary positional channel that allows the text to be squeezed (see the `squeeze` property). Can be used when: 1) `"band"`, `"index"`, or `"locus"` scale is being used and 2) only the primary positional channel is specified.\n\n**Default value:** `false`',type:"boolean"},flushX:{description:"If true, the text is kept inside the viewport when the range of `x` and `x2` intersect the viewport.",type:"boolean"},flushY:{description:"If true, the text is kept inside the viewport when the range of `y` and `y2` intersect the viewport.",type:"boolean"},font:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},fontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},fontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},geometricZoomBound:{description:"Enables geometric zooming. The value is the base two logarithmic zoom level where the maximum point size is reached.\n\n**Default value:** `0`",type:"number"},inwardStroke:{description:"Should the stroke only grow inwards, e.g, the diameter/outline is not affected by the stroke width. Thus, a point that has a zero size has no visible stroke. This allows strokes to be used with geometric zoom, etc.\n\n**Default value:** `false`",type:"boolean"},logoLetters:{description:"Stretch letters so that they can be used with [sequence logos](https://en.wikipedia.org/wiki/Sequence_logo), etc...",type:"boolean"},minBufferSize:{description:"Minimum size for WebGL buffers (number of data items). Allows for using `bufferSubData()` to update graphics.\n\nThis property is intended for internal use.",type:"number"},minHeight:{description:"The minimum height of a rectangle in pixels. The property clamps rectangles' heights.\n\n**Default value:** `0`",type:"number"},minLength:{description:"The minimum length of the rule in pixels. Use this property to ensure that very short ranged rules remain visible even when the user zooms out.\n\n**Default value:** `0`",type:"number"},minOpacity:{description:"Clamps the minimum size-dependent opacity. The property does not affect the `opacity` channel. Valid values are between `0` and `1`.\n\nWhen a rectangle would be smaller than what is specified in `minHeight` and `minWidth`, it is faded out proportionally. Example: a rectangle would be rendered as one pixel wide, but `minWidth` clamps it to five pixels. The rectangle is actually rendered as five pixels wide, but its opacity is multiplied by 0.2. With this setting, you can limit the factor to, for example, 0.5 to keep the rectangles more clearly visible.\n\n**Default value:** `0`",type:"number"},minSagittaLength:{description:"Minimum length of the arc's sagitta. Makes very short links more clearly visible.\n\n**Default value:** `1.5`",type:"number"},minWidth:{description:`The minimum width of a rectangle in pixels. The property clamps rectangles' widths when the viewport is zoomed out.

This property also reduces flickering of very narrow rectangles when zooming. The value should generally be at least one.

**Default value:** \`1\``,type:"number"},opacity:{type:"number"},paddingX:{description:"The horizontal padding, in pixels, when the `x2` channel is used for ranged text.\n\n**Default value:** `0`",type:"number"},paddingY:{description:"The vertical padding, in pixels, when the `y2` channel is used for ranged text.\n\n**Default value:** `0`",type:"number"},sagittaScaleFactor:{description:"Scaling factor of the arc's sagitta. The default value `1.0` produces roughly circular arcs.\n\n**Default value:** `1.0`",type:"number"},sampleFacetPadding:{description:"Padding between sample facet's upper/lower edge and the maximum point size. This property controls how tightly points are squeezed when facet's height is smaller than the maximum point size. The unit is a proportion of facet's height. The value must be between `0` and `0.5`. This property has no effect when sample faceting is not used.\n\n**Default value:** `0.1`",type:"number"},segments:{description:"The number of segments in the bzier curve. Affects the rendering quality and performance. Use a higher value for a smoother curve.\n\n**Default value:* `101`",type:"number"},semanticZoomFraction:{description:"TODO\n\n**Default value:** `0.02`",type:"number"},shape:{description:'One of `"circle"`, `"square"`, `"cross"`, `"diamond"`, `"triangle-up"`, `"triangle-down"`, `"triangle-right"`, or `"triangle-left"`.\n\n**Default value:** `"circle"`',type:"string"},size:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},size2:{description:"TODO",type:"number"},squeeze:{description:"If the `squeeze` property is true and secondary positional channels (`x2` and/or `y2`) are used, the text is scaled to fit mark's width and/or height.\n\n**Default value:** `true`",type:"boolean"},stroke:{description:"The stroke color",type:"string"},strokeCap:{description:'The style of stroke ends. Available choices: `"butt"`, `"round`", and `"square"`.\n\n**Default value:** `"butt"`',enum:["butt","square","round"],type:"string"},strokeDash:{description:"An array of of alternating stroke and gap lengths or `null` for solid strokes.\n\n**Default value:** `null`",items:{type:"number"},type:"array"},strokeDashOffset:{description:"An offset for the stroke dash pattern.\n\n**Default value:** `0`",type:"number"},strokeOpacity:{description:"The stroke opacity. Value between [0, 1].",type:"number"},strokeWidth:{description:"The stroke width in pixels.",type:"number"},text:{$ref:"#/definitions/Scalar",description:'The text to display. The format of numeric data can be customized by setting a [format specifier](https://github.com/d3/d3-format#locale_format) to channel definition\'s `format` property.\n\n**Default value:** `""`'},tooltip:{$ref:"#/definitions/Tooltip",description:"TODO"},type:{$ref:"#/definitions/MarkType"},viewportEdgeFadeDistanceBottom:{type:"number"},viewportEdgeFadeDistanceLeft:{type:"number"},viewportEdgeFadeDistanceRight:{type:"number"},viewportEdgeFadeDistanceTop:{type:"number"},viewportEdgeFadeWidthBottom:{type:"number"},viewportEdgeFadeWidthLeft:{type:"number"},viewportEdgeFadeWidthRight:{type:"number"},viewportEdgeFadeWidthTop:{type:"number"},x:{type:"number"},x2:{type:"number"},xOffset:{description:"Offsets of the `x` and `x2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"},y:{type:"number"},y2:{type:"number"},yOffset:{description:"Offsets of the `y` and `y2` coordinates in pixels. The offset is applied after the viewport scaling and translation.\n\n**Default value:** `0`",type:"number"}},required:["type"],type:"object"},"MarkPropDatumDef<Type>":{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"MarkPropDatumDef<TypeForShape>":{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/TypeForShape"}},required:["type"],type:"object"},"MarkPropDef<string,(string|null),TypeForShape>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CTypeForShape%3E"},{$ref:"#/definitions/ValueDef%3C(string%7Cnull)%3E"}]},"MarkPropDef<string,(string|null)>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CType%3E"},{$ref:"#/definitions/ValueDef%3C(string%7Cnull)%3E"}]},"MarkPropDef<string,number>":{anyOf:[{$ref:"#/definitions/MarkPropFieldOrDatumOrExprDef%3Cstring%2CType%3E"},{$ref:"#/definitions/ValueDef%3Cnumber%3E"}]},MarkPropExprDef:{additionalProperties:!1,properties:{expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},"MarkPropFieldDef<string,Type>":{additionalProperties:!1,description:"Field definition of a mark property, which can contain a legend.",properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"MarkPropFieldDef<string,TypeForShape>":{additionalProperties:!1,description:"Field definition of a mark property, which can contain a legend.",properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/TypeForShape"}},required:["type"],type:"object"},"MarkPropFieldOrDatumOrExprDef<string,Type>":{anyOf:[{$ref:"#/definitions/MarkPropFieldDef%3Cstring%2CType%3E"},{$ref:"#/definitions/MarkPropDatumDef%3CType%3E"},{$ref:"#/definitions/MarkPropExprDef"}]},"MarkPropFieldOrDatumOrExprDef<string,TypeForShape>":{anyOf:[{$ref:"#/definitions/MarkPropFieldDef%3Cstring%2CTypeForShape%3E"},{$ref:"#/definitions/MarkPropDatumDef%3CTypeForShape%3E"},{$ref:"#/definitions/MarkPropExprDef"}]},MarkType:{enum:["rect","point","rule","text","link"],type:"string"},MeasureTextParams:{additionalProperties:!1,properties:{as:{type:"string"},field:{$ref:"#/definitions/Field"},fontSize:{type:"number"},type:{const:"measureText",description:"The type of the transform to be applied",type:"string"}},required:["as","field","fontSize","type"],type:"object"},MergeFacetsParams:{additionalProperties:!1,properties:{type:{const:"mergeFacets",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},NamedData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"}},required:["name"],type:"object"},NumericDomain:{items:{type:"number"},type:"array"},"NumericMarkPropDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2Cnumber%3E"},NumericValueDef:{$ref:"#/definitions/ValueDef%3Cnumber%3E"},OtherDataFormat:{additionalProperties:!1,description:'Other data format, such as `"fasta"`',properties:{type:{type:"string"}},required:["type"],type:"object"},PaddingConfig:{anyOf:[{$ref:"#/definitions/Paddings"},{type:"number"}]},Paddings:{additionalProperties:!1,properties:{bottom:{type:"number"},left:{type:"number"},right:{type:"number"},top:{type:"number"}},type:"object"},Parse:{additionalProperties:{$ref:"#/definitions/ParseValue"},type:"object"},ParseValue:{anyOf:[{type:"null"},{type:"string"},{const:"string",type:"string"},{const:"boolean",type:"string"},{const:"date",type:"string"},{const:"number",type:"string"}]},PileupParams:{additionalProperties:!1,properties:{as:{description:'The output field name for the computed lane.\n\n**Default:** `"lane"`.',type:"string"},end:{$ref:"#/definitions/Field",description:"The field representing the end coordinate of the segment (exclusive)."},preference:{$ref:"#/definitions/Field",description:"An optional field indicating the preferred lane. Use together with the `preferredOrder` property."},preferredOrder:{anyOf:[{items:{type:"string"},type:"array"},{items:{type:"number"},type:"array"},{items:{type:"boolean"},type:"array"}],description:"The order of the lane preferences. The first element contains the value that should place the segment on the first lane and so forth. If the preferred lane is occupied, the first available lane is taken."},spacing:{description:"The spacing between adjacent segments on the same lane in coordinate units.\n\n**Default:** `1`.",type:"number"},start:{$ref:"#/definitions/Field",description:"The field representing the start coordinate of the segment (inclusive)."},type:{const:"pileup",description:"The type of the transform to be applied",type:"string"}},required:["end","start","type"],type:"object"},"Position2Def<string>":{anyOf:[{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},{$ref:"#/definitions/SecondaryChromPosDef"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},{additionalProperties:!1,properties:{band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"}},required:["expr"],type:"object"},{$ref:"#/definitions/PositionValueDef"}]},PositionDatumDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},"PositionDef<string>":{anyOf:[{$ref:"#/definitions/PositionFieldDef%3Cstring%3E"},{$ref:"#/definitions/ChromPosDef"},{$ref:"#/definitions/PositionDatumDef"},{$ref:"#/definitions/PositionExprDef"},{$ref:"#/definitions/PositionValueDef"}]},PositionExprDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},expr:{description:"An expression. Properties of the data can be accessed through the `datum` object.",type:"string"},type:{$ref:"#/definitions/Type"}},required:["expr","type"],type:"object"},"PositionFieldDef<string>":{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},resolutionChannel:{$ref:"#/definitions/ChannelWithScale",description:"An alternative channel for scale resolution.\n\nThis is mainly for internal use and allows using `color` channel to resolve `fill` and `stroke` channels under certain circumstances."},scale:{anyOf:[{$ref:"#/definitions/Scale"},{type:"null"}],description:`An object defining properties of the channel's scale, which is the function that transforms values in the data domain (numbers, dates, strings, etc) to visual values (pixels, colors, sizes) of the encoding channels.

If \`null\`, the scale will be [disabled and the data value will be directly encoded](https://vega.github.io/vega-lite/docs/scale.html#disable).

__Default value:__ If undefined, default [scale properties](https://vega.github.io/vega-lite/docs/scale.html) are applied.

__See also:__ [\`scale\`](https://vega.github.io/vega-lite/docs/scale.html) documentation.`},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},type:{$ref:"#/definitions/Type"}},required:["type"],type:"object"},PositionValueDef:{$ref:"#/definitions/NumericValueDef"},PositionalChannel:{anyOf:[{$ref:"#/definitions/PrimaryPositionalChannel"},{$ref:"#/definitions/SecondaryPositionalChannel"}]},PrimaryPositionalChannel:{enum:["x","y"],type:"string"},ProjectParams:{additionalProperties:!1,properties:{as:{description:"New names for the projected fields. If omitted, the names of the source fields are used.",items:{type:"string"},type:"array"},fields:{description:"The fields to be projected.",items:{$ref:"#/definitions/Field"},type:"array"},type:{const:"project",description:"The type of the transform to be applied",type:"string"}},required:["fields","type"],type:"object"},RegexExtractParams:{additionalProperties:!1,properties:{as:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"The new field or an array of fields where the extracted values are written."},field:{$ref:"#/definitions/Field",description:"The source field"},regex:{description:'A valid JavaScript regular expression with at least one group. For example: `"^Sample(\\\\d+)$"`.\n\nRead more at: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions',type:"string"},skipInvalidInput:{description:"Do not complain about invalid input. Just skip it and leave the new fields undefined on the affected datum.\n\n**Default:** `false`",type:"boolean"},type:{const:"regexExtract",description:"The type of the transform to be applied",type:"string"}},required:["as","field","regex","type"],type:"object"},RegexFoldParams:{additionalProperties:!1,properties:{asKey:{description:'**Default:** `"sample"`',type:"string"},asValue:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A new column name for the extracted values."},columnRegex:{anyOf:[{items:{type:"string"},type:"array"},{type:"string"}],description:"A regular expression that matches to column names. The regex must have one capturing group that is used for extracting the key (e.g., a sample id) from the column name."},skipRegex:{description:"An optional regex that matches to fields that should not be included in the new folded data objects.",type:"string"},type:{const:"regexFold",description:"The type of the transform to be applied",type:"string"}},required:["asValue","columnRegex","type"],type:"object"},ResolutionBehavior:{description:'`"independent"` and `"shared"` behave similarly to Vega-Lite. `"excluded"` behaves like `"shared"`, but is not pulled towards the root. `"forced"` behaves like `"shared"`, but is forced towards the root even if the parent has `"independent"` behavior.',enum:["independent","shared","excluded","forced"],type:"string"},RootSpec:{anyOf:[{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkConfigAndType"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["mark"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},layer:{items:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}]},type:"array"},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["layer"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["samples","spec"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["vconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},hconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["hconcat"],type:"object"},{additionalProperties:!1,properties:{$schema:{type:"string"},background:{description:"Background color of the canvas.",type:"string"},baseUrl:{type:"string"},columns:{type:"number"},concat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},datasets:{additionalProperties:{items:{},type:"array"},description:"https://vega.github.io/vega-lite/docs/data.html#datasets",type:"object"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},genome:{$ref:"#/definitions/GenomeConfig"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["columns","concat"],type:"object"}]},SampleAttributeDef:{additionalProperties:!1,properties:{barScale:{$ref:"#/definitions/Scale",description:"An optional scale definition for mapping the attribute to the width of a metadata rectangle."},scale:{$ref:"#/definitions/Scale",description:"Scale definition for the (default) color channel"},type:{$ref:"#/definitions/Type",description:'The attribute type. One of `"nominal"`, `"ordinal"`, or `"quantitative"`.'},visible:{description:"Whether the attribute is visible by default.",type:"boolean"},width:{description:"Width of the column in pixels.",type:"number"}},required:["type"],type:"object"},SampleDef:{additionalProperties:!1,properties:{attributeLabelAngle:{description:"Angle to be added to the default label angle (-90).\n\n**Default value:** `0`",type:"number"},attributeLabelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},attributeLabelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},attributeLabelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},attributeLabelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},attributeSize:{description:"Default size (width) of the metadata attribute columns. Can be configured per attribute using the `attributes` property.\n\n**Default value:** `10`",type:"number"},attributeSpacing:{description:"Spacing between attribute columns in pixels.\n\n**Default value:** `1`",type:"number"},attributes:{additionalProperties:{$ref:"#/definitions/SampleAttributeDef"},description:"Explicitly specify the sample attributes.",type:"object"},data:{$ref:"#/definitions/Data",description:"Optional metadata about the samples."},labelAlign:{$ref:"#/definitions/Align",description:'The horizontal alignment of the text. One of `"left"`, `"center"`, or `"right"`.\n\n**Default value:** `"left"`'},labelFont:{description:'The font typeface. GenomeSpy uses [SDF](https://github.com/Chlumsky/msdfgen) versions of [Google Fonts](https://fonts.google.com/). Check their availability at the [A-Frame Fonts](https://github.com/etiennepinchon/aframe-fonts/tree/master/fonts) repository. System fonts are **not** supported.\n\n**Default value:** `"Lato"`',type:"string"},labelFontSize:{description:"The font size in pixels.\n\n**Default value:** `11`",type:"number"},labelFontStyle:{$ref:"#/definitions/FontStyle",description:'The font style. Valid values: `"normal"` and `"italic"`.\n\n**Default value:** `"normal"`'},labelFontWeight:{$ref:"#/definitions/FontWeight",description:'The font weight. The following strings and numbers are valid values: `"thin"` (`100`), `"light"` (`300`), `"regular"` (`400`), `"normal"` (`400`), `"medium"` (`500`), `"bold"` (`700`), `"black"` (`900`)\n\n**Default value:** `"regular"`'},labelLength:{description:"How much space in pixels to reserve for the labels.\n\n**Default:** `140`",type:"number"},labelTitleText:{description:'Text in the label title\n\n**Default:** `"Sample name"`',type:"string"}},type:"object"},SampleParams:{additionalProperties:!1,properties:{size:{description:"The maximum sample size.\n\n**Default:** `500`",type:"number"},type:{const:"sample",description:"The type of the transform to be applied",type:"string"}},required:["type"],type:"object"},SampleSpec:{additionalProperties:!1,description:"A view specification for a SampleView. This is only functional in the GenomeSpy app.",properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},samples:{$ref:"#/definitions/SampleDef",description:"Sample metadata definition. If the object is empty, the sample identifiers will be inferred from the data."},spec:{anyOf:[{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/UnitSpec"}],description:"The view specification to be repeated for each sample."},stickySummaries:{type:"boolean"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground",description:"An object defining the view background and outline. The background is repeated for each group."},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["samples","spec"],type:"object"},Scalar:{type:["string","number","boolean"]},ScalarDomain:{anyOf:[{$ref:"#/definitions/NumericDomain"},{items:{type:"string"},type:"array"},{items:{type:"boolean"},type:"array"}]},Scale:{additionalProperties:!1,properties:{align:{description:"The alignment of the steps within the scale range.\n\nThis value must lie in the range `[0,1]`. A value of `0.5` indicates that the steps should be centered within the range. A value of `0` or `1` may be used to shift the bands to one side, say to position them adjacent to an axis.\n\n__Default value:__ `0.5`",type:"number"},base:{description:"The logarithm base of the `log` scale (default `10`).",type:"number"},bins:{description:"An array of bin boundaries over the scale domain. If provided, axes and legends will use the bin boundaries to inform the choice of tick marks and text labels.",items:{type:"number"},type:"array"},clamp:{description:"If `true`, values that exceed the data domain are clamped to either the minimum or maximum range value\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/config.html#scale-config)'s `clamp` (`true` by default).",type:"boolean"},constant:{description:"A constant determining the slope of the symlog function around zero. Only used for `symlog` scales.\n\n__Default value:__ `1`",type:"number"},domain:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"Customized domain values.\n\nFor _quantitative_ fields, `domain` can take the form of a two-element array with minimum and maximum values.  [Piecewise scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise) can be created by providing a `domain` with more than two entries.\n\nFor _temporal_ fields, `domain` can be a two-element array minimum and maximum values, in the form of either timestamps or the [DateTime definition objects](https://vega.github.io/vega-lite/docs/types.html#datetime).\n\nFor _ordinal_ and _nominal_ fields, `domain` can be an array that lists valid input values."},domainMax:{description:"Sets the maximum value in the scale domain, overriding the `domain` property. This property is only intended for use with scales having continuous domains.",type:"number"},domainMid:{description:"Inserts a single mid-point value into a two-element domain. The mid-point value must lie between the domain minimum and maximum values. This property can be useful for setting a midpoint for [diverging color scales](https://vega.github.io/vega-lite/docs/scale.html#piecewise). The domainMid property is only intended for use with scales supporting continuous, piecewise domains.",type:"number"},domainMin:{description:"Sets the minimum value in the scale domain, overriding the domain property. This property is only intended for use with scales having continuous domains.",type:"number"},exponent:{description:"The exponent of the `pow` scale.",type:"number"},interpolate:{anyOf:[{$ref:"#/definitions/ScaleInterpolate"},{$ref:"#/definitions/ScaleInterpolateParams"}],description:"The interpolation method for range values. By default, a general interpolator for numbers, dates, strings and colors (in HCL space) is used. For color ranges, this property allows interpolation in alternative color spaces. Legal values include `rgb`, `hsl`, `hsl-long`, `lab`, `hcl`, `hcl-long`, `cubehelix` and `cubehelix-long` ('-long' variants use longer paths in polar coordinate spaces). If object-valued, this property accepts an object with a string-valued _type_ property and an optional numeric _gamma_ property applicable to rgb and cubehelix interpolators. For more, see the [d3-interpolate documentation](https://github.com/d3/d3-interpolate).\n\n__Default value:__ `hcl`"},name:{description:"The name of the scale. Names are optional but allow the scales to be referenced and found with the API.",type:"string"},nice:{anyOf:[{type:"boolean"},{type:"number"},{additionalProperties:!1,properties:{interval:{type:"string"},step:{type:"number"}},required:["interval","step"],type:"object"}],description:"Extending the domain so that it starts and ends on nice round values. This method typically modifies the scales domain, and may only extend the bounds to the nearest round value. Nicing is useful if the domain is computed from data and may be irregular. For example, for a domain of _[0.201479, 0.996679]_, a nice domain might be _[0.2, 1.0]_.\n\nFor quantitative scales such as linear, `nice` can be either a boolean flag or a number. If `nice` is a number, it will represent a desired tick count. This allows greater control over the step size used to extend the bounds, guaranteeing that the returned ticks will exactly cover the domain.\n\n__Default value:__ `true` for unbinned _quantitative_ fields; `false` otherwise."},padding:{description:"For _[continuous](https://vega.github.io/vega-lite/docs/scale.html#continuous)_ scales, expands the scale domain to accommodate the specified number of pixels on each of the scale range. The scale range must represent pixels for this parameter to function as intended. Padding adjustment is performedpriorto all other adjustments, including the effects of the`zero`,`nice`,`domainMin`, and`domainMax`properties.\n\nFor _[band](https://vega.github.io/vega-lite/docs/scale.html#band)_ scales, shortcut for setting `paddingInner` and `paddingOuter` to the same value.\n\nFor _[point](https://vega.github.io/vega-lite/docs/scale.html#point)_ scales, alias for `paddingOuter`.\n\n__Default value:__ For _continuous_ scales, derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `continuousPadding`. For _band and point_ scales, see `paddingInner` and `paddingOuter`.  By default, Vega-Lite sets padding such that _width/height = number of unique values * step_.",minimum:0,type:"number"},paddingInner:{description:`The inner padding (spacing) within each band step of band scales, as a fraction of the step size. This value must lie in the range [0,1].

For point scale, this property is invalid as point scales do not have internal band widths (only step sizes between bands).

__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s \`bandPaddingInner\`.`,maximum:1,minimum:0,type:"number"},paddingOuter:{description:"The outer padding (spacing) at the ends of the range of band and point scales, as a fraction of the step size. This value must lie in the range [0,1].\n\n__Default value:__ derived from the [scale config](https://vega.github.io/vega-lite/docs/scale.html#config)'s `bandPaddingOuter` for band scales and `pointPadding` for point scales. By default, Vega-Lite sets outer padding such that _width/height = number of unique values * step_.",maximum:1,minimum:0,type:"number"},range:{anyOf:[{items:{type:"number"},type:"array"},{items:{type:"string"},type:"array"},{type:"string"}],description:'The range of the scale. One of:\n\n- A string indicating a [pre-defined named scale range](https://vega.github.io/vega-lite/docs/scale.html#range-config) (e.g., example, `"symbol"`, or `"diverging"`).\n\n- For [continuous scales](https://vega.github.io/vega-lite/docs/scale.html#continuous), two-element array indicating  minimum and maximum values, or an array with more than two entries for specifying a [piecewise scale](https://vega.github.io/vega-lite/docs/scale.html#piecewise).\n\n- For [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) and [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales, an array of desired output values.\n\n__Notes:__\n\n1) For color scales you can also specify a color [`scheme`](https://vega.github.io/vega-lite/docs/scale.html#scheme) instead of `range`.\n\n2) Any directly specified `range` for `x` and `y` channels will be ignored. Range can be customized via the view\'s corresponding [size](https://vega.github.io/vega-lite/docs/size.html) (`width` and `height`).'},reverse:{description:"If true, reverses the order of the scale range.\n\n__Default value:__ `false`.",type:"boolean"},round:{description:"If `true`, rounds numeric output values to integers. This can be helpful for snapping to the pixel grid.\n\n__Default value:__ `false`.",type:"boolean"},scheme:{anyOf:[{type:"string"},{$ref:"#/definitions/SchemeParams"}],description:'A string indicating a color [scheme](https://vega.github.io/vega-lite/docs/scale.html#scheme) name (e.g., `"category10"` or `"blues"`) or a [scheme parameter object](https://vega.github.io/vega-lite/docs/scale.html#scheme-params).\n\nDiscrete color schemes may be used with [discrete](https://vega.github.io/vega-lite/docs/scale.html#discrete) or [discretizing](https://vega.github.io/vega-lite/docs/scale.html#discretizing) scales. Continuous color schemes are intended for use with color scales.\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.'},type:{$ref:"#/definitions/ScaleType",description:'The type of scale.  Vega-Lite supports the following categories of scale types:\n\n1) [**Continuous Scales**](https://vega.github.io/vega-lite/docs/scale.html#continuous) -- mapping continuous domains to continuous output ranges ([`"linear"`](https://vega.github.io/vega-lite/docs/scale.html#linear), [`"pow"`](https://vega.github.io/vega-lite/docs/scale.html#pow), [`"sqrt"`](https://vega.github.io/vega-lite/docs/scale.html#sqrt), [`"symlog"`](https://vega.github.io/vega-lite/docs/scale.html#symlog), [`"log"`](https://vega.github.io/vega-lite/docs/scale.html#log), [`"time"`](https://vega.github.io/vega-lite/docs/scale.html#time), [`"utc"`](https://vega.github.io/vega-lite/docs/scale.html#utc).\n\n2) [**Discrete Scales**](https://vega.github.io/vega-lite/docs/scale.html#discrete) -- mapping discrete domains to discrete ([`"ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#ordinal)) or continuous ([`"band"`](https://vega.github.io/vega-lite/docs/scale.html#band) and [`"point"`](https://vega.github.io/vega-lite/docs/scale.html#point)) output ranges.\n\n3) [**Discretizing Scales**](https://vega.github.io/vega-lite/docs/scale.html#discretizing) -- mapping continuous domains to discrete output ranges [`"bin-ordinal"`](https://vega.github.io/vega-lite/docs/scale.html#bin-ordinal), [`"quantile"`](https://vega.github.io/vega-lite/docs/scale.html#quantile), [`"quantize"`](https://vega.github.io/vega-lite/docs/scale.html#quantize) and [`"threshold"`](https://vega.github.io/vega-lite/docs/scale.html#threshold).\n\n__Default value:__ please see the [scale type table](https://vega.github.io/vega-lite/docs/scale.html#type).'},zero:{description:"If `true`, ensures that a zero baseline value is included in the scale domain.\n\n__Default value:__ `true` for x and y channels if the quantitative field is not binned and no custom `domain` is provided; `false` otherwise.\n\n__Note:__ Log, time, and utc scales do not support `zero`.",type:"boolean"},zoom:{anyOf:[{type:"boolean"},{$ref:"#/definitions/ZoomParams"}],description:"If `true` and the scale is used on a positional channel, it can bee zoomed and translated interactively."}},type:"object"},ScaleInterpolate:{enum:["rgb","lab","hcl","hsl","hsl-long","hcl-long","cubehelix","cubehelix-long"],type:"string"},ScaleInterpolateParams:{additionalProperties:!1,properties:{gamma:{type:"number"},type:{enum:["rgb","cubehelix","cubehelix-long"],type:"string"}},required:["type"],type:"object"},ScaleType:{enum:["null","linear","log","pow","sqrt","symlog","identity","sequential","quantize","threshold","ordinal","point","band","index","locus"],type:"string"},SchemeParams:{additionalProperties:!1,properties:{count:{description:'The number of colors to use in the scheme. This can be useful for scale types such as `"quantize"`, which use the length of the scale range to determine the number of discrete bins for the scale domain.',type:"number"},extent:{description:"The extent of the color range to use. For example `[0.2, 1]` will rescale the color scheme such that color values in the range _[0, 0.2)_ are excluded from the scheme.",items:{type:"number"},type:"array"},name:{description:'A color scheme name for ordinal scales (e.g., `"category10"` or `"blues"`).\n\nFor the full list of supported schemes, please refer to the [Vega Scheme](https://vega.github.io/vega/docs/schemes/#reference) reference.',type:"string"}},required:["name"],type:"object"},SecondaryChromPosDef:{additionalProperties:!1,properties:{axis:{anyOf:[{$ref:"#/definitions/GenomeAxis"},{type:"null"}],description:"An object defining properties of axis's gridlines, ticks and labels. If `null`, the axis for the encoding channel will be removed.\n\n__Default value:__ If undefined, default [axis properties](https://vega.github.io/vega-lite/docs/axis.html) are applied.\n\n__See also:__ [`axis`](https://vega.github.io/vega-lite/docs/axis.html) documentation."},band:{description:"Relative position on band scale. For example, the marks will be positioned at the beginning of the band if set to `0`, and at the middle of the band if set to `0.5`.",maximum:1,minimum:0,type:"number"},chrom:{$ref:"#/definitions/FieldName",description:"The field having the chromosome or contig."},offset:{description:"An offset or offsets that allow for adjusting the numbering base. The offset is subtracted from the positions.\n\nGenomeSpy uses internally zero-based indexing with half-open intervals. UCSC-based formats (BED, etc.) generally use this scheme. However, for example, VCF files use one-based indexing and must be adjusted by setting the offset to `1`.\n\n**Default:** `0`",type:"number"},pos:{$ref:"#/definitions/FieldName",description:"The field having an intra-chromosomal position."},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},required:["chrom"],type:"object"},SecondaryPositionalChannel:{enum:["x2","y2"],type:"string"},SequenceGenerator:{additionalProperties:!1,properties:{name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},sequence:{$ref:"#/definitions/SequenceParams",description:"Generate a sequence of numbers."}},required:["sequence"],type:"object"},SequenceParams:{additionalProperties:!1,properties:{as:{$ref:"#/definitions/FieldName",description:'The name of the generated sequence field.\n\n__Default value:__ `"data"`'},start:{description:"The starting value of the sequence (inclusive).",type:"number"},step:{description:"The step value between sequence entries.\n\n__Default value:__ `1`",type:"number"},stop:{description:"The ending value of the sequence (exclusive).",type:"number"}},required:["start","stop"],type:"object"},"ShapeDef<string>":{$ref:"#/definitions/MarkPropDef%3Cstring%2C(string%7Cnull)%2CTypeForShape%3E"},SizeDef:{additionalProperties:!1,properties:{grow:{description:"Share of the remaining space",type:"number"},px:{description:"Size in pixels",type:"number"}},type:"object"},SortOrder:{enum:["ascending","descending"],type:"string"},StackParams:{additionalProperties:!1,properties:{as:{description:'Fields to write the stacked values.\n\n**Default:** `["y0", "y1"]`',items:{type:"string"},type:"array"},baseField:{$ref:"#/definitions/Field",description:'The field that contains the base or amino acid. Used for information content calculation when the offset is `"information"`. The data objects that have `null` in the baseField are considered gaps and they are taken into account when scaling the the locus\' information content.'},cardinality:{description:'Cardinality, e.g., the number if distinct bases or amino acids. Used for information content calculation when the offset is `"information"`.\n\n**Default:** `4`',type:"number"},field:{$ref:"#/definitions/Field",description:"The field to stack. If no field is defined, a constant value of one is assumed."},groupby:{description:"The fields to be used for forming groups for different stacks.",items:{$ref:"#/definitions/Field"},type:"array"},offset:{description:'How to offset the values in a stack. `"zero"` (default) starts stacking at 0. `"center"` centers the values around zero. `"normalize"` computes intra-stack percentages and normalizes the values to the range of `[0, 1]`. `"information"` computes a layout for a sequence logo. The total height of the stack reflects the group\'s information content.',enum:["zero","center","normalize","information"],type:"string"},sort:{$ref:"#/definitions/CompareParams",description:"The sort order of data in each stack."},type:{const:"stack",description:"The type of the transform to be applied",type:"string"}},required:["as","groupby","type"],type:"object"},Step:{additionalProperties:!1,properties:{step:{type:"number"}},required:["step"],type:"object"},StringDatumDef:{additionalProperties:!1,properties:{datum:{$ref:"#/definitions/Scalar",description:"A constant value in data domain."},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},"StringFieldDef<string>":{additionalProperties:!1,properties:{field:{description:'__Required.__ A string defining the name of the field from which to pull a data value or an object defining iterated values from the [`repeat`](https://vega.github.io/vega-lite/docs/repeat.html) operator.\n\n__See also:__ [`field`](https://vega.github.io/vega-lite/docs/field.html) documentation.\n\n__Notes:__ 1)  Dots (`.`) and brackets (`[` and `]`) can be used to access nested objects (e.g., `"field": "foo.bar"` and `"field": "foo[\'bar\']"`). If field names contain dots or brackets but are not nested, you can use `\\\\` to escape dots and brackets (e.g., `"a\\\\.b"` and `"a\\\\[0\\\\]"`). See more details about escaping in the [field documentation](https://vega.github.io/vega-lite/docs/field.html). 2) `field` is not required if `aggregate` is `count`.',type:"string"},format:{description:`When used with the default \`"number"\` format type, the text formatting pattern for labels of guides (axes, legends, headers) and text marks.

- If the format type is \`"number"\` (e.g., for quantitative fields), this is D3's [number format pattern](https://github.com/d3/d3-format#locale_format).

See the [format documentation](https://vega.github.io/vega-lite/docs/format.html) for more examples.`,type:"string"},title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]}},type:"object"},"TextDef<string>":{anyOf:[{$ref:"#/definitions/StringFieldDef%3Cstring%3E"},{$ref:"#/definitions/StringDatumDef"},{$ref:"#/definitions/ExprDef"}]},Title:{additionalProperties:!1,properties:{align:{$ref:"#/definitions/Align",description:'Horizontal text alignment for title text. One of `"left"`, `"center"`, or `"right"`.'},anchor:{$ref:"#/definitions/TitleAnchor",description:'The anchor position for placing the title and subtitle text. One of `"start"`, `"middle"`, or `"end"`. For example, with an orientation of top these anchor positions map to a left-, center-, or right-aligned title.'},angle:{description:"Angle in degrees of title and subtitle text.",type:"number"},baseline:{$ref:"#/definitions/Baseline",description:'Vertical text baseline for title and subtitle text. One of `"alphabetic"` (default), `"top"`, `"middle"`, or `"bottom"`.'},color:{description:"Text color for title text.",type:"string"},dx:{description:"Delta offset for title and subtitle text x-coordinate.",type:"number"},dy:{description:"Delta offset for title and subtitle text y-coordinate.",type:"number"},font:{description:"Font name for title text.",type:"string"},fontSize:{description:"Font size in pixels for title text.",minimum:0,type:"number"},fontStyle:{$ref:"#/definitions/FontStyle",description:"Font style for title text."},fontWeight:{$ref:"#/definitions/FontWeight",description:'Font weight for title text. This can be either a string (e.g `"bold"`, `"normal"`) or a number (`100`, `200`, `300`, ..., `900` where `"normal"` = `400` and `"bold"` = `700`).'},frame:{$ref:"#/definitions/TitleFrame",description:'The reference frame for the anchor position, one of `"bounds"` (to anchor relative to the full bounding box) or `"group"` (to anchor relative to the group width or height).'},offset:{description:"The orthogonal offset in pixels by which to displace the title group from its position along the edge of the chart.",type:"number"},orient:{$ref:"#/definitions/TitleOrient",description:'Default title orientation (`"top"`, `"bottom"`, `"left"`, or `"right"`)'},style:{description:'A mark style property to apply to the title text mark. If not specified, a default style of `"group-title"` is applied.',type:"string"},text:{description:"The title text.",type:"string"}},required:["text"],type:"object"},TitleAnchor:{enum:[null,"start","middle","end"],type:["null","string"]},TitleFrame:{enum:["bounds","group"],type:"string"},TitleOrient:{enum:["none","left","right","top","bottom"],type:"string"},Tooltip:{anyOf:[{$ref:"#/definitions/HandledTooltip"},{type:"null"}]},TransformParams:{anyOf:[{$ref:"#/definitions/AggregateParams"},{$ref:"#/definitions/CollectParams"},{$ref:"#/definitions/CoverageParams"},{$ref:"#/definitions/FlattenDelimitedParams"},{$ref:"#/definitions/FormulaParams"},{$ref:"#/definitions/FilterParams"},{$ref:"#/definitions/FilterScoredLabelsParams"},{$ref:"#/definitions/FlattenParams"},{$ref:"#/definitions/FlattenCompressedExonsParams"},{$ref:"#/definitions/FlattenSequenceParams"},{$ref:"#/definitions/IdentifierParams"},{$ref:"#/definitions/LinearizeGenomicCoordinateParams"},{$ref:"#/definitions/MeasureTextParams"},{$ref:"#/definitions/MergeFacetsParams"},{$ref:"#/definitions/PileupParams"},{$ref:"#/definitions/ProjectParams"},{$ref:"#/definitions/RegexExtractParams"},{$ref:"#/definitions/RegexFoldParams"},{$ref:"#/definitions/SampleParams"},{$ref:"#/definitions/StackParams"}]},Type:{enum:["quantitative","ordinal","nominal","index","locus"],type:"string"},TypeForShape:{enum:["ordinal","nominal"],type:"string"},UnitSpec:{additionalProperties:!1,properties:{aggregateSamples:{items:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"}]},type:"array"},baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},mark:{anyOf:[{$ref:"#/definitions/MarkType"},{$ref:"#/definitions/MarkConfigAndType"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},view:{$ref:"#/definitions/ViewBackground"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["mark"],type:"object"},UrlData:{additionalProperties:!1,properties:{format:{$ref:"#/definitions/DataFormat",description:"An object that specifies the format for parsing the data."},name:{description:"Provide a placeholder name and bind data at runtime.",type:"string"},url:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"An URL or an array of URLs from which to load the data set. Use the `format.type` property to ensure the loaded data is correctly parsed."}},required:["url"],type:"object"},VConcatSpec:{additionalProperties:!1,properties:{baseUrl:{type:"string"},configurableVisibility:{description:"Is the visibility configurable interactively from the App. Configurability requires that the view has an explicitly specified name that is *unique* in within the view specification.\n\n**Default:** `false` for children of `layer`, `true` for others.",type:"boolean"},data:{$ref:"#/definitions/Data"},description:{anyOf:[{type:"string"},{items:{type:"string"},type:"array"}],description:"A description of the view. Multiple lines can be provided as an array."},encoding:{$ref:"#/definitions/Encoding"},height:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]},name:{type:"string"},opacity:{$ref:"#/definitions/ViewOpacityDef",description:"Opacity of the view and all its children.\n\n**Default:* `1.0`"},padding:{$ref:"#/definitions/PaddingConfig",description:"Padding in pixels.\n\n**Default:* `0`"},resolve:{additionalProperties:!1,properties:{axis:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"},scale:{additionalProperties:{$ref:"#/definitions/ResolutionBehavior"},properties:{default:{$ref:"#/definitions/ResolutionBehavior"}},type:"object"}},type:"object"},spacing:{type:"number"},title:{anyOf:[{type:"string"},{$ref:"#/definitions/Title"}]},transform:{items:{$ref:"#/definitions/TransformParams"},type:"array"},vconcat:{items:{anyOf:[{$ref:"#/definitions/ViewSpec"},{$ref:"#/definitions/ImportSpec"}]},type:"array"},visible:{description:"Visibility of the view. An invisible view is removed from the layout and not rendered.\n\n**Default:** `true`",type:"boolean"},width:{anyOf:[{$ref:"#/definitions/SizeDef"},{type:"number"},{$ref:"#/definitions/Step"},{const:"container",type:"string"}]}},required:["vconcat"],type:"object"},"ValueDef<(string|null)>":{additionalProperties:!1,properties:{title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).',type:["string","null"]}},required:["value"],type:"object"},"ValueDef<number>":{additionalProperties:!1,properties:{title:{description:"A title for the field. If `null`, the title will be removed.",type:["string","null"]},value:{description:'A constant value in visual domain (e.g., `"red"` / `"#0099ff"`, values between `0` to `1` for opacity).',type:"number"}},required:["value"],type:"object"},ViewBackground:{additionalProperties:!1,properties:{fill:{description:"The fill color",type:"string"},fillOpacity:{description:"The fill opacity. Value between [0, 1].",type:"number"},stroke:{description:"The stroke color",type:"string"},strokeOpacity:{description:"The stroke opacity. Value between [0, 1].",type:"number"},strokeWidth:{type:"number"}},type:"object"},ViewOpacityDef:{anyOf:[{type:"number"},{$ref:"#/definitions/DynamicOpacity"}]},ViewSpec:{anyOf:[{$ref:"#/definitions/UnitSpec"},{$ref:"#/definitions/LayerSpec"},{$ref:"#/definitions/SampleSpec"},{$ref:"#/definitions/VConcatSpec"},{$ref:"#/definitions/HConcatSpec"},{$ref:"#/definitions/ConcatSpec"}]},ZoomParams:{additionalProperties:!1,properties:{extent:{anyOf:[{$ref:"#/definitions/ScalarDomain"},{$ref:"#/definitions/ComplexDomain"}],description:"The boundaries that limit the zoom and pan interactions."}},type:"object"}},sH={$ref:v6e,$schema:w6e,definitions:y6e},C6e="@genome-spy/playground",S6e="0.37.0",x6e="A playground for testing GenomeSpy visualizations",E6e={dev:"vite",build:"vite build",serve:"vite preview"},D6e="Kari Lavikka",k6e="MIT",L6e={"@fortawesome/fontawesome-free":"^6.1.1","@fortawesome/fontawesome-svg-core":"^6.1.1","@fortawesome/free-solid-svg-icons":"^6.1.1","@genome-spy/core":"^0.37.0",lit:"^2.0.2","lit-html":"^2.4.0","monaco-editor":"^0.30.1","vega-loader":"^4.4.0"},oH={name:C6e,private:!0,version:S6e,description:x6e,scripts:E6e,author:D6e,license:k6e,dependencies:L6e},I6e="modulepreload",T6e=function(n,e){return new URL(n,e).href},aH={},A6e=function(e,t,i){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=T6e(s,i),s in aH)return;aH[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":I6e,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};var N6e=function(){function n(e,t,i){this._onDidChange=new _6e,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}return Object.defineProperty(n.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"modeConfiguration",{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"diagnosticsOptions",{get:function(){return this._diagnosticsOptions},enumerable:!1,configurable:!0}),n.prototype.setDiagnosticsOptions=function(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)},n.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},n}(),R6e={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},M6e={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},fie=new N6e("json",R6e,M6e);qL.json={jsonDefaults:fie};function F6e(){return A6e(()=>import("./jsonMode-f30d9c04.js"),[],import.meta.url)}qL.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});qL.onLanguage("json",function(){F6e().then(function(n){return n.setupMode(fie)})});const lH=65535,rh=16777215,cH=4278190080;class n1{constructor(e,t,i){if(e.length!==t.length||e.length>lH)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new Uint32Array(Math.ceil(e.length/32)),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(i,r)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=i&&this.getEndLineNumber(s)>=r};for(let i=0,r=this._startIndexes.length;i<r;i++){let s=this._startIndexes[i],o=this._endIndexes[i];if(s>rh||o>rh)throw new Error("startLineNumber or endLineNumber must not exceed "+rh);for(;e.length>0&&!t(s,o);)e.pop();let a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=s+((a&255)<<24),this._endIndexes[i]=o+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&rh}getEndLineNumber(e){return this._endIndexes[e]&rh}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){let t=e/32|0,i=e%32;return(this._collapseStates[t]&1<<i)!==0}setCollapsed(e,t){let i=e/32|0,r=e%32,s=this._collapseStates[i];t?this._collapseStates[i]=s|1<<r:this._collapseStates[i]=s&~(1<<r)}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let r=0;r<this._types.length;r++)this._types[r]===e&&(this.setCollapsed(r,t),i=!0);return i}toRegion(e){return new O6e(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&cH)>>>24)+((this._endIndexes[e]&cH)>>>16);return t===lH?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){let r=Math.floor((t+i)/2);e<this.getStartLineNumber(r)?i=r:t=r+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}}class O6e{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class P6e{constructor(e,t){this._updateEventEmitter=new H,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new n1(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,r)=>i.regionIndex-r.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let r=0,s=-1,o=-1;const a=l=>{for(;r<l;){const c=this._regions.getEndLineNumber(r),h=this._regions.isCollapsed(r);c<=s&&i.changeDecorationOptions(this._editorDecorationIds[r],this._decorationProvider.getDecorationOption(h,c<=o)),h&&c>o&&(o=c),r++}};for(let l of e){let c=l.regionIndex,h=this._editorDecorationIds[c];if(h&&!t[h]){t[h]=!0,a(c);let u=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,u),s=Math.max(s,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}update(e,t=[]){let i=[],r=(u,d)=>{for(let f of t)if(u<f&&f<=d)return!0;return!1},s=-1,o=(u,d)=>{const f=e.getStartLineNumber(u),g=e.getEndLineNumber(u);d||(d=e.isCollapsed(u)),d&&r(f,g)&&(d=!1),e.setCollapsed(u,d);const p=this._textModel.getLineMaxColumn(f),m={startLineNumber:f,startColumn:Math.max(p-1,1),endLineNumber:f,endColumn:p};i.push({range:m,options:this._decorationProvider.getDecorationOption(d,g<=s)}),d&&g>s&&(s=g)},a=0,l=()=>{for(;a<this._regions.length;){let u=this._regions.isCollapsed(a);if(a++,u)return a-1}return-1},c=0,h=l();for(;h!==-1&&c<e.length;){let u=this._textModel.getDecorationRange(this._editorDecorationIds[h]);if(u){let d=u.startLineNumber;if(u.startColumn===Math.max(u.endColumn-1,1)&&this._textModel.getLineMaxColumn(d)===u.endColumn)for(;c<e.length;){let f=e.getStartLineNumber(c);if(d>=f)o(c,d===f),c++;else break}}h=l()}for(;c<e.length;)o(c,!1),c++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,i),this._regions=e,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let e=[];for(let t=0;t<this._regions.length;t++)if(this._regions.isCollapsed(t)){let i=this._textModel.getDecorationRange(this._editorDecorationIds[t]);if(i){let r=i.startLineNumber,s=i.endLineNumber+this._regions.getEndLineNumber(t)-this._regions.getStartLineNumber(t);e.push({startLineNumber:r,endLineNumber:s})}}if(e.length>0)return e}applyMemento(e){if(!Array.isArray(e))return;let t=[];for(let i of e){let r=this.getRegionAtLine(i.startLineNumber);r&&!r.isCollapsed&&t.push(r)}this.toggleCollapseState(t)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(e,t){let i=[];if(this._regions){let r=this._regions.findRange(e),s=1;for(;r>=0;){let o=this._regions.toRegion(r);(!t||t(o,s))&&i.push(o),s++,r=o.parentIndex}}return i}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let i=[],r=e?e.regionIndex+1:0,s=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const o=[];for(let a=r,l=this._regions.length;a<l;a++){let c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<s){for(;o.length>0&&!c.containedBy(o[o.length-1]);)o.pop();o.push(c),t(c,o.length)&&i.push(c)}else break}}else for(let o=r,a=this._regions.length;o<a;o++){let l=this._regions.toRegion(o);if(this._regions.getStartLineNumber(o)<s)(!t||t(l))&&i.push(l);else break}return i}}function B6e(n,e,t){let i=[];for(let r of t){let s=n.getRegionAtLine(r);if(s){const o=!s.isCollapsed;if(i.push(s),e>1){let a=n.getRegionsInside(s,(l,c)=>l.isCollapsed!==o&&c<e);i.push(...a)}}}n.toggleCollapseState(i)}function T0(n,e,t=Number.MAX_VALUE,i){let r=[];if(i&&i.length>0)for(let s of i){let o=n.getRegionAtLine(s);if(o&&(o.isCollapsed!==e&&r.push(o),t>1)){let a=n.getRegionsInside(o,(l,c)=>l.isCollapsed!==e&&c<t);r.push(...a)}}else{let s=n.getRegionsInside(null,(o,a)=>o.isCollapsed!==e&&a<t);r.push(...s)}n.toggleCollapseState(r)}function gie(n,e,t,i){let r=[];for(let s of i){let o=n.getAllRegionsAtLine(s,(a,l)=>a.isCollapsed!==e&&l<=t);r.push(...o)}n.toggleCollapseState(r)}function V6e(n,e,t){let i=[];for(let r of t){let s=n.getAllRegionsAtLine(r,o=>o.isCollapsed!==e);s.length>0&&i.push(s[0])}n.toggleCollapseState(i)}function W6e(n,e,t,i){let r=(o,a)=>a===e&&o.isCollapsed!==t&&!i.some(l=>o.containsLine(l)),s=n.getRegionsInside(null,r);n.toggleCollapseState(s)}function pie(n,e,t){let i=[];for(let o of t)i.push(n.getAllRegionsAtLine(o,void 0)[0]);let r=o=>i.every(a=>!a.containedBy(o)&&!o.containedBy(a))&&o.isCollapsed!==e,s=n.getRegionsInside(null,r);n.toggleCollapseState(s)}function SB(n,e,t){let i=n.textModel,r=n.regions,s=[];for(let o=r.length-1;o>=0;o--)if(t!==r.isCollapsed(o)){let a=r.getStartLineNumber(o);e.test(i.getLineContent(a))&&s.push(r.toRegion(o))}n.toggleCollapseState(s)}function xB(n,e,t){let i=n.regions,r=[];for(let s=i.length-1;s>=0;s--)t!==i.isCollapsed(s)&&e===i.getType(s)&&r.push(i.toRegion(s));n.toggleCollapseState(r)}function $6e(n,e){let t=null,i=e.getRegionAtLine(n);if(i!==null&&(t=i.startLineNumber,n===t)){let r=i.parentIndex;r!==-1?t=e.regions.getStartLineNumber(r):t=null}return t}function z6e(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){if(n!==t.startLineNumber)return t.startLineNumber;{let i=t.parentIndex,r=0;for(i!==-1&&(r=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=r)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<n)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function H6e(n,e){let t=e.getRegionAtLine(n);if(t!==null&&t.startLineNumber===n){let i=t.parentIndex,r=0;if(i!==-1)r=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;r=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=r)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>n)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class U6e{constructor(e){this._updateEventEmitter=new H,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}updateHiddenRanges(){let e=!1,t=[],i=0,r=0,s=Number.MAX_VALUE,o=-1,a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;let l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);s<=l&&c<=o||(!e&&r<this._hiddenRanges.length&&this._hiddenRanges[r].startLineNumber===l&&this._hiddenRanges[r].endLineNumber===c?(t.push(this._hiddenRanges[r]),r++):(e=!0,t.push(new V(l,1,c,1))),s=l,o=c)}(e||r<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyMemento(e){if(!Array.isArray(e)||e.length===0)return!1;let t=[];for(let i of e){if(!i.startLineNumber||!i.endLineNumber)return!1;t.push(new V(i.startLineNumber+1,1,i.endLineNumber,1))}return this.applyHiddenRanges(t),!0}getMemento(){return this._hiddenRanges.map(e=>({startLineNumber:e.startLineNumber-1,endLineNumber:e.endLineNumber}))}applyHiddenRanges(e){this._hiddenRanges=e,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return hH(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1,i=this._foldingModel.textModel,r=null,s=o=>((!r||!j6e(o,r))&&(r=hH(this._hiddenRanges,o)),r?r.startLineNumber-1:null);for(let o=0,a=e.length;o<a;o++){let l=e[o],c=s(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);let h=s(l.endLineNumber);h&&(l=l.setEndPosition(h,i.getLineMaxColumn(h)),t=!0),e[o]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function j6e(n,e){return n>=e.startLineNumber&&n<=e.endLineNumber}function hH(n,e){let t=_J(n,i=>e<i.startLineNumber)-1;return t>=0&&n[t].endLineNumber>=e?n[t]:null}const q6e=5e3,G6e="indent";class K6e{constructor(e){this.editorModel=e,this.id=G6e}dispose(){}compute(e){let t=zi.getFoldingRules(this.editorModel.getLanguageId()),i=t&&!!t.offSide,r=t&&t.markers;return Promise.resolve(Y6e(this.editorModel,i,r))}}let Z6e=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>rh||t>rh)return;let r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRangesLimit){let t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let r=this._length-1,s=0;r>=0;r--,s++)t[s]=this._startIndexes[r],i[s]=this._endIndexes[r];return new n1(t,i)}else{let t=0,i=this._indentOccurrences.length;for(let a=0;a<this._indentOccurrences.length;a++){let l=this._indentOccurrences[a];if(l){if(l+t>this._foldingRangesLimit){i=a;break}t+=l}}const r=e.getOptions().tabSize;let s=new Uint32Array(this._foldingRangesLimit),o=new Uint32Array(this._foldingRangesLimit);for(let a=this._length-1,l=0;a>=0;a--){let c=this._startIndexes[a],h=e.getLineContent(c),u=fo.computeIndentLevel(h,r);(u<i||u===i&&t++<this._foldingRangesLimit)&&(s[l]=c,o[l]=this._endIndexes[a],l++)}return new n1(s,o)}}};function Y6e(n,e,t,i=q6e){const r=n.getOptions().tabSize;let s=new Z6e(i),o;t&&(o=new RegExp(`(${t.start.source})|(?:${t.end.source})`));let a=[],l=n.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=n.getLineCount();c>0;c--){let h=n.getLineContent(c),u=fo.computeIndentLevel(h,r),d=a[a.length-1];if(u===-1){e&&(d.endAbove=c);continue}let f;if(o&&(f=h.match(o)))if(f[1]){let g=a.length-1;for(;g>0&&a[g].indent!==-2;)g--;if(g>0){a.length=g+1,d=a[g],s.insertFirst(c,d.line,u),d.line=c,d.indent=u,d.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(d.indent>u){do a.pop(),d=a[a.length-1];while(d.indent>u);let g=d.endAbove-1;g-c>=1&&s.insertFirst(c,g,u)}d.indent===u?d.endAbove=c:a.push({indent:u,endAbove:c,line:c})}return s.toIndentRanges(n)}const X6e=5e3,Q6e={},mie="syntax";class J6e{constructor(e,t,i,r=X6e){this.editorModel=e,this.providers=t,this.limit=r,this.id=mie;for(const s of t)typeof s.onDidChange=="function"&&(this.disposables||(this.disposables=new ve),this.disposables.add(s.onDidChange(i)))}compute(e){return e8e(this.providers,this.editorModel,e).then(t=>t?_ie(t,this.limit):null)}dispose(){var e;(e=this.disposables)===null||e===void 0||e.dispose()}}function e8e(n,e,t){let i=null,r=n.map((s,o)=>Promise.resolve(s.provideFoldingRanges(e,Q6e,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);let l=e.getLineCount();for(let c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:o,kind:c.kind})}},ca));return Promise.all(r).then(s=>i)}class t8e{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,r){if(e>rh||t>rh)return;let s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._nestingLevels[s]=r,this._types[s]=i,this._length++,r<30&&(this._nestingLevelCounts[r]=(this._nestingLevelCounts[r]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=0;i<this._length;i++)e[i]=this._startIndexes[i],t[i]=this._endIndexes[i];return new n1(e,t,this._types)}else{let e=0,t=this._nestingLevelCounts.length;for(let o=0;o<this._nestingLevelCounts.length;o++){let a=this._nestingLevelCounts[o];if(a){if(a+e>this._foldingRangesLimit){t=o;break}e+=a}}let i=new Uint32Array(this._foldingRangesLimit),r=new Uint32Array(this._foldingRangesLimit),s=[];for(let o=0,a=0;o<this._length;o++){let l=this._nestingLevels[o];(l<t||l===t&&e++<this._foldingRangesLimit)&&(i[a]=this._startIndexes[o],r[a]=this._endIndexes[o],s[a]=this._types[o],a++)}return new n1(i,r,s)}}}function _ie(n,e){let t=n.sort((o,a)=>{let l=o.start-a.start;return l===0&&(l=o.rank-a.rank),l}),i=new t8e(e),r,s=[];for(let o of t)if(!r)r=o,i.add(o.start,o.end,o.kind&&o.kind.value,s.length);else if(o.start>r.start)if(o.end<=r.end)s.push(r),r=o,i.add(o.start,o.end,o.kind&&o.kind.value,s.length);else{if(o.start>r.end){do r=s.pop();while(r&&o.start>r.end);r&&s.push(r),r=o}i.add(o.start,o.end,o.kind&&o.kind.value,s.length)}return i.toIndentRanges()}const bie="init";class i8e{constructor(e,t,i,r){if(this.editorModel=e,this.id=bie,t.length){let s=o=>({range:{startLineNumber:o.startLineNumber,startColumn:0,endLineNumber:o.endLineNumber,endColumn:e.getLineLength(o.endLineNumber)},options:{description:"folding-initializing-range-provider",stickiness:1}});this.decorationIds=e.deltaDecorations([],t.map(s)),this.timeout=setTimeout(i,r)}}dispose(){this.decorationIds&&(this.editorModel.deltaDecorations(this.decorationIds,[]),this.decorationIds=void 0),typeof this.timeout=="number"&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(e){let t=[];if(this.decorationIds)for(let i of this.decorationIds){let r=this.editorModel.getDecorationRange(i);r&&t.push({start:r.startLineNumber,end:r.endLineNumber,rank:1})}return Promise.resolve(_ie(t,Number.MAX_VALUE))}}const EB=ur("folding-expanded",Ce.chevronDown,v("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),DB=ur("folding-collapsed",Ce.chevronRight,v("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin."));class Bo{constructor(e){this.editor=e,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(e,t){return t?Bo.HIDDEN_RANGE_DECORATION:e?this.showFoldingHighlights?Bo.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Bo.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?Bo.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:Bo.EXPANDED_VISUAL_DECORATION}deltaDecorations(e,t){return this.editor.deltaDecorations(e,t)}changeDecorations(e){return this.editor.changeDecorations(e)}}Bo.COLLAPSED_VISUAL_DECORATION=bt.register({description:"folding-collapsed-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:mi.asClassName(DB)});Bo.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=bt.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",className:"folded-background",isWholeLine:!0,firstLineDecorationClassName:mi.asClassName(DB)});Bo.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=bt.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:mi.asClassName(EB)});Bo.EXPANDED_VISUAL_DECORATION=bt.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+mi.asClassName(EB)});Bo.HIDDEN_RANGE_DECORATION=bt.register({description:"folding-hidden-range-decoration",stickiness:1});var n8e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},r8e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const Dr=new Te("foldingEnabled",!1);let W_=class vie extends re{constructor(e,t){super(),this.contextKeyService=t,this.localToDispose=this._register(new ve),this.editor=e;const i=this.editor.getOptions();this._isEnabled=i.get(37),this._useFoldingProviders=i.get(38)!=="indentation",this._unfoldOnClickAfterEndOfLine=i.get(41),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=i.get(40),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new Bo(e),this.foldingDecorationProvider.autoHideFoldingControls=i.get(98)==="mouseover",this.foldingDecorationProvider.showFoldingHighlights=i.get(39),this.foldingEnabled=Dr.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(r=>{if(r.hasChanged(37)&&(this._isEnabled=this.editor.getOptions().get(37),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),r.hasChanged(98)||r.hasChanged(39)){const s=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls=s.get(98)==="mouseover",this.foldingDecorationProvider.showFoldingHighlights=s.get(39),this.onModelContentChanged()}r.hasChanged(38)&&(this._useFoldingProviders=this.editor.getOptions().get(38)!=="indentation",this.onFoldingStrategyChanged()),r.hasChanged(41)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(41)),r.hasChanged(40)&&(this._foldingImportsByDefault=this.editor.getOptions().get(40))})),this.onModelChanged()}static get(e){return e.getContribution(vie.ID)}saveViewState(){let e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){let t=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel||!e||e.lineCount!==t.getLineCount()||(this._currentModelHasFoldedImports=!!e.foldedImports,!e.collapsedRegions))return;(e.provider===mie||e.provider===bie)&&(this.foldingStateMemento=e);const i=e.collapsedRegions;if(this.hiddenRangeModel.applyMemento(i)){const r=this.getFoldingModel();r&&r.then(s=>{if(s){this._restoringViewState=!0;try{s.applyMemento(i)}finally{this._restoringViewState=!1}}}).then(void 0,it)}}onModelChanged(){this.localToDispose.clear();let e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new P6e(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new U6e(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new p0(200),this.cursorChangedScheduler=new yi(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(UM.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(()=>this.onModelContentChanged())),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.onModelContentChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.onModelContentChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new K6e(e),this._useFoldingProviders&&this.foldingModel){let t=UM.ordered(this.foldingModel.textModel);if(t.length===0&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions)return this.rangeProvider=new i8e(e,this.foldingStateMemento.collapsedRegions,()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()},3e4);t.length>0&&(this.rangeProvider=new J6e(e,t,()=>this.onModelContentChanged()))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onModelContentChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=this.getRangeProvider(e.textModel);let i=this.foldingRegionPromise=Hs(r=>t.compute(r));return i.then(r=>{if(r&&i===this.foldingRegionPromise){let s;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const l=r.setCollapsedAllOfType(Ka.Imports.value,!0);l&&(s=F_.capture(this.editor),this._currentModelHasFoldedImports=l)}let o=this.editor.getSelections(),a=o?o.map(l=>l.startLineNumber):[];e.update(r,a),s&&s.restore(this.editor)}return e})}).then(void 0,e=>(it(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){let t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){let i=this.editor.getSelections();if(i&&i.length>0){let r=[];for(let s of i){let o=s.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(o)&&r.push(...t.getAllRegionsAtLine(o,a=>a.isCollapsed&&o>a.startLineNumber))}r.length&&(t.toggleCollapseState(r),this.reveal(i[0].getPosition()))}}}).then(void 0,it)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:const r=e.target.detail,s=e.target.element.offsetLeft;if(r.offsetX-s<5)return;i=!0;break;case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){let a=this.editor.getModel();if(a&&t.startColumn===a.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.getFoldingModel();if(!t||!this.mouseDownInfo||!e.target)return;let i=this.mouseDownInfo.lineNumber,r=this.mouseDownInfo.iconClicked,s=e.target.range;if(!(!s||s.startLineNumber!==i)){if(r){if(e.target.type!==4)return}else{let o=this.editor.getModel();if(!o||s.startColumn!==o.getLineMaxColumn(i))return}t.then(o=>{if(o){let a=o.getRegionAtLine(i);if(a&&a.startLineNumber===i){let l=a.isCollapsed;if(r||l){let c=e.event.altKey,h=[];if(c){let u=f=>!f.containedBy(a)&&!a.containedBy(f),d=o.getRegionsInside(null,u);for(const f of d)f.isCollapsed&&h.push(f);h.length===0&&(h=d)}else{let u=e.event.middleButton||e.event.shiftKey;if(u)for(const d of o.getRegionsInside(a))d.isCollapsed===l&&h.push(d);(l||!u||h.length===0)&&h.push(a)}o.toggleCollapseState(h),this.reveal({lineNumber:i,column:1})}}}}).then(void 0,it)}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};W_.ID="editor.contrib.folding";W_=n8e([r8e(1,Xe)],W_);class Xr extends Si{runEditorCommand(e,t,i){let r=W_.get(t);if(!r)return;let s=r.getFoldingModel();if(s)return this.reportTelemetry(e,t),s.then(o=>{if(o){this.invoke(r,o,t,i);const a=t.getSelection();a&&r.reveal(a.getStartPosition())}})}getSelectedLines(e){let t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function wie(n){if(!yr(n)){if(!Br(n))return!1;const e=n;if(!yr(e.levels)&&!sg(e.levels)||!yr(e.direction)&&!Ga(e.direction)||!yr(e.selectionLines)&&(!WQ(e.selectionLines)||!e.selectionLines.every(sg)))return!1}return!0}class s8e extends Xr{constructor(){super({id:"editor.unfold",label:v("unfoldAction.label","Unfold"),alias:"Unfold",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:wie,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,r){let s=r&&r.levels||1,o=this.getLineNumbers(r,i);r&&r.direction==="up"?gie(t,!1,s,o):T0(t,!1,s,o)}}class o8e extends Xr{constructor(){super({id:"editor.unfoldRecursively",label:v("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2137),weight:100}})}invoke(e,t,i,r){T0(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class a8e extends Xr{constructor(){super({id:"editor.fold",label:v("foldAction.label","Fold"),alias:"Fold",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:wie,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,r){let s=this.getLineNumbers(r,i);const o=r&&r.levels,a=r&&r.direction;typeof o!="number"&&typeof a!="string"?V6e(t,!0,s):a==="up"?gie(t,!0,o||1,s):T0(t,!0,o||1,s)}}class l8e extends Xr{constructor(){super({id:"editor.toggleFold",label:v("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2090),weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);B6e(t,1,r)}}class c8e extends Xr{constructor(){super({id:"editor.foldRecursively",label:v("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2135),weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);T0(t,!0,Number.MAX_VALUE,r)}}class h8e extends Xr{constructor(){super({id:"editor.foldAllBlockComments",label:v("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2133),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())xB(t,Ka.Comment.value,!0);else{const r=i.getModel();if(!r)return;const s=zi.getComments(r.getLanguageId());if(s&&s.blockCommentStartToken){let o=new RegExp("^\\s*"+ja(s.blockCommentStartToken));SB(t,o,!0)}}}}class u8e extends Xr{constructor(){super({id:"editor.foldAllMarkerRegions",label:v("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2077),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())xB(t,Ka.Region.value,!0);else{const r=i.getModel();if(!r)return;const s=zi.getFoldingRules(r.getLanguageId());if(s&&s.markers&&s.markers.start){let o=new RegExp(s.markers.start);SB(t,o,!0)}}}}class d8e extends Xr{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:v("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2078),weight:100}})}invoke(e,t,i){if(t.regions.hasTypes())xB(t,Ka.Region.value,!1);else{const r=i.getModel();if(!r)return;const s=zi.getFoldingRules(r.getLanguageId());if(s&&s.markers&&s.markers.start){let o=new RegExp(s.markers.start);SB(t,o,!1)}}}}class f8e extends Xr{constructor(){super({id:"editor.foldAllExcept",label:v("foldAllExcept.label","Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2131),weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);pie(t,!0,r)}}class g8e extends Xr{constructor(){super({id:"editor.unfoldAllExcept",label:v("unfoldAllExcept.label","Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2129),weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);pie(t,!1,r)}}class p8e extends Xr{constructor(){super({id:"editor.foldAll",label:v("foldAllAction.label","Fold All"),alias:"Fold All",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2069),weight:100}})}invoke(e,t,i){T0(t,!0)}}class m8e extends Xr{constructor(){super({id:"editor.unfoldAll",label:v("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2088),weight:100}})}invoke(e,t,i){T0(t,!1)}}class _g extends Xr{getFoldingLevel(){return parseInt(this.id.substr(_g.ID_PREFIX.length))}invoke(e,t,i){W6e(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}_g.ID_PREFIX="editor.foldLevel";_g.ID=n=>_g.ID_PREFIX+n;class _8e extends Xr{constructor(){super({id:"editor.gotoParentFold",label:v("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);if(r.length>0){let s=$6e(r[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}class b8e extends Xr{constructor(){super({id:"editor.gotoPreviousFold",label:v("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);if(r.length>0){let s=z6e(r[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}class v8e extends Xr{constructor(){super({id:"editor.gotoNextFold",label:v("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,weight:100}})}invoke(e,t,i){let r=this.getSelectedLines(i);if(r.length>0){let s=H6e(r[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}Yr(W_.ID,W_);pt(s8e);pt(o8e);pt(a8e);pt(c8e);pt(p8e);pt(m8e);pt(h8e);pt(u8e);pt(d8e);pt(f8e);pt(g8e);pt(l8e);pt(_8e);pt(b8e);pt(v8e);for(let n=1;n<=7;n++)YJ(new _g({id:_g.ID(n),label:v("foldLevelAction.label","Fold Level {0}",n),alias:`Fold Level ${n}`,precondition:Dr,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2048|21+n),weight:100}}));const w8e=z("editor.foldBackground",{light:Jt(Iu,.3),dark:Jt(Iu,.3),hc:null},v("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0),y8e=z("editorGutter.foldingControlForeground",{dark:MT,light:MT,hc:MT},v("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));li((n,e)=>{const t=n.getColor(w8e);t&&e.addRule(`.monaco-editor .folded-background { background-color: ${t}; }`);const i=n.getColor(y8e);i&&e.addRule(`
		.monaco-editor .cldr${mi.asCSSSelector(EB)},
		.monaco-editor .cldr${mi.asCSSSelector(DB)} {
			color: ${i} !important;
		}
		`)});class nr{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(e){let t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const r=i.options;if(r===nr._FIND_MATCH_DECORATION||r===nr._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let r=0,s=this._decorations.length;r<s;r++){let o=this._editor.getModel().getDecorationRange(this._decorations[r]);if(e.equalsRange(o)){t=this._decorations[r],i=r+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(r=>{if(this._highlightedDecorationId!==null&&(r.changeDecorationOptions(this._highlightedDecorationId,nr._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,r.changeDecorationOptions(this._highlightedDecorationId,nr._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(r.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let s=this._editor.getModel().getDecorationRange(t);if(s.startLineNumber!==s.endLineNumber&&s.endColumn===1){let o=s.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(o);s=new V(s.startLineNumber,s.startColumn,o,a)}this._rangeHighlightDecorationId=r.addDecoration(s,nr._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let r=nr._FIND_MATCH_DECORATION,s=[];if(e.length>1e3){r=nr._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,h=Math.max(2,Math.ceil(3/c));let u=e[0].range.startLineNumber,d=e[0].range.endLineNumber;for(let f=1,g=e.length;f<g;f++){const p=e[f].range;d+h>=p.startLineNumber?p.endLineNumber>d&&(d=p.endLineNumber):(s.push({range:new V(u,1,d,1),options:nr._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),u=p.startLineNumber,d=p.endLineNumber)}s.push({range:new V(u,1,d,1),options:nr._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let o=new Array(e.length);for(let a=0,l=e.length;a<l;a++)o[a]={range:e[a].range,options:r};this._decorations=i.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,s),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t!=null&&t.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,nr._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){let i=this._decorations[t],r=this._editor.getModel().getDecorationRange(i);if(!(!r||r.endLineNumber>e.lineNumber)){if(r.endLineNumber<e.lineNumber)return r;if(!(r.endColumn>e.column))return r}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){let r=this._decorations[t],s=this._editor.getModel().getDecorationRange(r);if(!(!s||s.startLineNumber<e.lineNumber)){if(s.startLineNumber>e.lineNumber)return s;if(!(s.startColumn<e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}nr._CURRENT_FIND_MATCH_DECORATION=bt.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:xs(A5),position:rc.Center},minimap:{color:xs(Lee),position:Xl.Inline}});nr._FIND_MATCH_DECORATION=bt.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:xs(A5),position:rc.Center},minimap:{color:xs(Lee),position:Xl.Inline}});nr._FIND_MATCH_NO_OVERVIEW_DECORATION=bt.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0});nr._FIND_MATCH_ONLY_OVERVIEW_DECORATION=bt.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:xs(A5),position:rc.Center}});nr._RANGE_HIGHLIGHT_DECORATION=bt.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0});nr._FIND_SCOPE_DECORATION=bt.register({description:"find-scope",className:"findScope",isWholeLine:!0});class C8e{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){let i=[];for(let o=0;o<this._ranges.length;o++)i.push({range:this._ranges[o],text:this._replaceStrings[o]});i.sort((o,a)=>V.compareRangesUsingStarts(o.range,a.range));let r=[],s=i[0];for(let o=1;o<i.length;o++)s.range.endLineNumber===i[o].range.startLineNumber&&s.range.endColumn===i[o].range.startColumn?(s.range=s.range.plusRange(i[o].range),s.text=s.text+i[o].text):(r.push(s),s=i[o]);r.push(s);for(const o of r)t.addEditOperation(o.range,o.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function yie(n,e){if(n&&n[0]!==""){const t=uH(n,e,"-"),i=uH(n,e,"_");return t&&!i?dH(n,e,"-"):!t&&i?dH(n,e,"_"):n[0].toUpperCase()===n[0]?e.toUpperCase():n[0].toLowerCase()===n[0]?e.toLowerCase():Pke(n[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):n[0][0].toUpperCase()!==n[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function uH(n,e,t){return n[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&n[0].split(t).length===e.split(t).length}function dH(n,e,t){const i=e.split(t),r=n[0].split(t);let s="";return i.forEach((o,a)=>{s+=yie([r[a]],o)+t}),s.slice(0,-1)}class fH{constructor(e){this.staticValue=e,this.kind=0}}class S8e{constructor(e){this.pieces=e,this.kind=1}}class $_{constructor(e){!e||e.length===0?this._state=new fH(""):e.length===1&&e[0].staticValue!==null?this._state=new fH(e[0].staticValue):this._state=new S8e(e)}static fromStaticValue(e){return new $_([Pf.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}buildReplaceString(e,t){if(this._state.kind===0)return t?yie(e,this._state.staticValue):this._state.staticValue;let i="";for(let r=0,s=this._state.pieces.length;r<s;r++){let o=this._state.pieces[r];if(o.staticValue!==null){i+=o.staticValue;continue}let a=$_._substitute(o.matchIndex,e);if(o.caseOps!==null&&o.caseOps.length>0){let l=[],c=o.caseOps.length,h=0;for(let u=0,d=a.length;u<d;u++){if(h>=c){l.push(a.slice(u));break}switch(o.caseOps[h]){case"U":l.push(a[u].toUpperCase());break;case"u":l.push(a[u].toUpperCase()),h++;break;case"L":l.push(a[u].toLowerCase());break;case"l":l.push(a[u].toLowerCase()),h++;break;default:l.push(a[u])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class Pf{constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}static staticValue(e){return new Pf(e,-1,null)}static caseOps(e,t){return new Pf(null,e,t)}}class x8e{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Pf.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=Pf.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=Pf.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new $_(this._result)}}function E8e(n){if(!n||n.length===0)return new $_(null);let e=[],t=new x8e(n);for(let i=0,r=n.length;i<r;i++){let s=n.charCodeAt(i);if(s===92){if(i++,i>=r)break;let o=n.charCodeAt(i);switch(o){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(o));break}continue}if(s===36){if(i++,i>=r)break;let o=n.charCodeAt(i);if(o===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(o===48||o===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=o&&o<=57){let a=o-48;if(i+1<r){let l=n.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const Jg=new Te("findWidgetVisible",!1),GL=new Te("findInputFocussed",!1),kB=new Te("replaceInputFocussed",!1),GC={primary:545,mac:{primary:2593}},KC={primary:565,mac:{primary:2613}},ZC={primary:560,mac:{primary:2608}},YC={primary:554,mac:{primary:2602}},XC={primary:558,mac:{primary:2606}},Xt={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},pu=19999,D8e=240;class Ev{constructor(e,t){this._toDispose=new ve,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new Gr,this._decorations=new nr(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new yi(()=>this.research(!1),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,mt(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},D8e)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new V(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));let r=this._findMatches(i,!1,pu);this._decorations.set(r,i);const s=this._editor.getSelection();let o=this._decorations.getCurrentMatchesPosition(s);if(o===0&&r.length>0){const a=_J(r.map(l=>l.range),l=>V.compareRangesUsingStarts(l,s)>=0);o=a>0?a-1+1:o}this._state.changeMatchInfo(o,this._decorations.getCount(),void 0),e&&this._editor.getOption(35).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:r}=e,s=this._editor.getModel();return t||r===1?(i===1?i=s.getLineCount():i--,r=s.getLineMaxColumn(i)):r--,new G(i,r)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const h=this._decorations.matchAfterPosition(e);h&&this._setCurrentFindMatch(h);return}if(this._decorations.getCount()<pu){let h=this._decorations.matchBeforePosition(e);h&&h.isEmpty()&&h.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),h=this._decorations.matchBeforePosition(e)),h&&this._setCurrentFindMatch(h);return}if(this._cannotFind())return;let i=this._decorations.getFindScope(),r=Ev._getSearchRange(this._editor.getModel(),i);r.getEndPosition().isBefore(e)&&(e=r.getEndPosition()),e.isBefore(r.getStartPosition())&&(e=r.getEndPosition());let{lineNumber:s,column:o}=e,a=this._editor.getModel(),l=new G(s,o),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1)),!!c){if(!t&&!r.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:r}=e,s=this._editor.getModel();return t||r===s.getLineMaxColumn(i)?(i===s.getLineCount()?i=1:i++,r=1):r++,new G(i,r)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<pu){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}let t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,r=!1){if(this._cannotFind())return null;let s=this._decorations.getFindScope(),o=Ev._getSearchRange(this._editor.getModel(),s);o.getEndPosition().isBefore(e)&&(e=o.getStartPosition()),e.isBefore(o.getStartPosition())&&(e=o.getStartPosition());let{lineNumber:a,column:l}=e,c=this._editor.getModel(),h=new G(a,l),u=c.findNextMatch(this._state.searchString,h,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t);return i&&u&&u.range.isEmpty()&&u.range.getStartPosition().equals(h)&&(h=this._nextSearchPosition(h),u=c.findNextMatch(this._state.searchString,h,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t)),u?!r&&!o.containsRange(u.range)?this._getNextMatch(u.range.getEndPosition(),t,i,!0):u:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?E8e(this._state.replaceString):$_.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){let r=e.buildReplaceString(i.matches,this._state.preserveCase),s=new Nr(t,r);this._executeEditorCommand("replace",s),this._decorations.setStartPosition(new G(t.startLineNumber,t.startColumn+r.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const r=(e||[null]).map(s=>Ev._getSearchRange(this._editor.getModel(),s));return this._editor.getModel().findMatches(this._state.searchString,r,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=pu?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new Fd(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let u="mu";i.ignoreCase&&(u+="i"),i.global&&(u+="g"),i=new RegExp(i.source,u)}const r=this._editor.getModel(),s=r.getValue(1),o=r.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=s.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=s.replace(i,a.buildReplaceString(null,c));let h=new qee(o,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",h)}_regularReplaceAll(e){const t=this._getReplacePattern();let i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),r=[];for(let o=0,a=i.length;o<a;o++)r[o]=t.buildReplaceString(i[o].matches,this._state.preserveCase);let s=new C8e(this._editor.getSelection(),i.map(o=>o.range),r);this._executeEditorCommand("replaceAll",s)}selectAllMatches(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes(),i=this._findMatches(e,!1,1073741824).map(s=>new je(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn)),r=this._editor.getSelection();for(let s=0,o=i.length;s<o;s++)if(i[s].equalsRange(r)){i=[r].concat(i.slice(0,s)).concat(i.slice(s+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const k8e={inputActiveOptionBorder:X.fromHex("#007ACC00"),inputActiveOptionForeground:X.fromHex("#FFFFFF"),inputActiveOptionBackground:X.fromHex("#0E639C50")};class Iy extends bo{constructor(e){super(),this._onChange=this._register(new H),this.onChange=this._onChange.event,this._onKeyDown=this._register(new H),this.onKeyDown=this._onKeyDown.event,this._opts=Object.assign(Object.assign({},k8e),e),this._checked=this._opts.isChecked;const t=["monaco-custom-checkbox"];this._opts.icon&&t.push(...ss.asClassNameArray(this._opts.icon)),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault()}),this.ignoreGesture(this.domNode),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 2+2+2+16}style(e){e.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=e.inputActiveOptionBorder),e.inputActiveOptionForeground&&(this._opts.inputActiveOptionForeground=e.inputActiveOptionForeground),e.inputActiveOptionBackground&&(this._opts.inputActiveOptionBackground=e.inputActiveOptionBackground),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():"transparent",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground?this._opts.inputActiveOptionForeground.toString():"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground?this._opts.inputActiveOptionBackground.toString():"transparent")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const L8e=v("caseDescription","Match Case"),I8e=v("wordsDescription","Match Whole Word"),T8e=v("regexDescription","Use Regular Expression");class Cie extends Iy{constructor(e){super({icon:Ce.caseSensitive,title:L8e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class Sie extends Iy{constructor(e){super({icon:Ce.wholeWord,title:I8e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class xie extends Iy{constructor(e){super({icon:Ce.regex,title:T8e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class KL extends bo{constructor(e,t,i,r){super(),this._hideSoon=this._register(new yi(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const s=r.getColorTheme().getColor(uF),o=r.getColorTheme().getColor(fF),a=r.getColorTheme().getColor(dF);this.caseSensitive=this._register(new Cie({appendTitle:this._keybindingLabelFor(Xt.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,inputActiveOptionBorder:s,inputActiveOptionForeground:o,inputActiveOptionBackground:a})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new Sie({appendTitle:this._keybindingLabelFor(Xt.ToggleWholeWordCommand),isChecked:this._state.wholeWord,inputActiveOptionBorder:s,inputActiveOptionForeground:o,inputActiveOptionBackground:a})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new xie({appendTitle:this._keybindingLabelFor(Xt.ToggleRegexCommand),isChecked:this._state.isRegex,inputActiveOptionBorder:s,inputActiveOptionForeground:o,inputActiveOptionBackground:a})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(l=>{let c=!1;l.isRegex&&(this.regex.checked=this._state.isRegex,c=!0),l.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,c=!0),l.matchCase&&(this.caseSensitive.checked=this._state.matchCase,c=!0),!this._state.isRevealed&&c&&this._revealTemporarily()})),this._register(T3(this._domNode,l=>this._onMouseOut())),this._register(ae(this._domNode,"mouseover",l=>this._onMouseOver())),this._applyTheme(r.getColorTheme()),this._register(r.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return KL.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(uF),inputActiveOptionForeground:e.getColor(fF),inputActiveOptionBackground:e.getColor(dF)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}KL.ID="editor.contrib.findOptionsWidget";li((n,e)=>{const t=n.getColor(ta);t&&e.addRule(`.monaco-editor .findOptionsWidget { background-color: ${t}; }`);const i=n.getColor(Lu);i&&e.addRule(`.monaco-editor .findOptionsWidget { color: ${i}; }`);const r=n.getColor(T_);r&&e.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${r}; }`);const s=n.getColor(Ki);s&&e.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${s}; }`)});function QC(n,e){return n===1?!0:n===2?!1:e}class A8e extends re{constructor(){super(),this._onFindReplaceStateChange=this._register(new H),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return QC(this._isRegexOverride,this._isRegex)}get wholeWord(){return QC(this._wholeWordOverride,this._wholeWord)}get matchCase(){return QC(this._matchCaseOverride,this._matchCase)}get preserveCase(){return QC(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,i){let r={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},s=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,r.matchesPosition=!0,s=!0),this._matchesCount!==t&&(this._matchesCount=t,r.matchesCount=!0,s=!0),typeof i<"u"&&(V.equalsRange(this._currentMatch,i)||(this._currentMatch=i,r.currentMatch=!0,s=!0)),s&&this._onFindReplaceStateChange.fire(r)}change(e,t,i=!0){var r;let s={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},o=!1;const a=this.isRegex,l=this.wholeWord,c=this.matchCase,h=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,s.searchString=!0,o=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,s.replaceString=!0,o=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,s.isRevealed=!0,o=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,s.isReplaceRevealed=!0,o=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&(!((r=e.searchScope)===null||r===void 0)&&r.every(u=>{var d;return(d=this._searchScope)===null||d===void 0?void 0:d.some(f=>!V.equalsRange(f,u))})||(this._searchScope=e.searchScope,s.searchScope=!0,o=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,s.loop=!0,o=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,a!==this.isRegex&&(o=!0,s.isRegex=!0),l!==this.wholeWord&&(o=!0,s.wholeWord=!0),c!==this.matchCase&&(o=!0,s.matchCase=!0),h!==this.preserveCase&&(o=!0,s.preserveCase=!0),o&&this._onFindReplaceStateChange.fire(s)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=pu}}const N8e=v("defaultLabel","input");class R8e extends bo{constructor(e,t,i,r){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this._onDidOptionChange=this._register(new H),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new H),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new H),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new H),this._onKeyUp=this._register(new H),this._onCaseSensitiveKeyDown=this._register(new H),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new H),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=t,this.placeholder=r.placeholder||"",this.validation=r.validation,this.label=r.label||N8e,this.inputActiveOptionBorder=r.inputActiveOptionBorder,this.inputActiveOptionForeground=r.inputActiveOptionForeground,this.inputActiveOptionBackground=r.inputActiveOptionBackground,this.inputBackground=r.inputBackground,this.inputForeground=r.inputForeground,this.inputBorder=r.inputBorder,this.inputValidationInfoBorder=r.inputValidationInfoBorder,this.inputValidationInfoBackground=r.inputValidationInfoBackground,this.inputValidationInfoForeground=r.inputValidationInfoForeground,this.inputValidationWarningBorder=r.inputValidationWarningBorder,this.inputValidationWarningBackground=r.inputValidationWarningBackground,this.inputValidationWarningForeground=r.inputValidationWarningForeground,this.inputValidationErrorBorder=r.inputValidationErrorBorder,this.inputValidationErrorBackground=r.inputValidationErrorBackground,this.inputValidationErrorForeground=r.inputValidationErrorForeground;const s=r.appendCaseSensitiveLabel||"",o=r.appendWholeWordsLabel||"",a=r.appendRegexLabel||"",l=r.history||[],c=!!r.flexibleHeight,h=!!r.flexibleWidth,u=r.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new sie(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:l,showHistoryHint:r.showHistoryHint,flexibleHeight:c,flexibleWidth:h,flexibleMaxHeight:u})),this.regex=this._register(new xie({appendTitle:a,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new Sie({appendTitle:o,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new Cie({appendTitle:s,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)})),this._showOptionButtons&&(this.inputBox.paddingRight=this.caseSensitive.width()+this.wholeWords.width()+this.regex.width());let d=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){let p=d.indexOf(document.activeElement);if(p>=0){let m=-1;g.equals(17)?m=(p+1)%d.length:g.equals(15)&&(p===0?m=d.length-1:m=p-1),g.equals(9)?(d[p].blur(),this.inputBox.focus()):m>=0&&d[m].focus(),Ft.stop(g,!0)}}});let f=document.createElement("div");f.className="controls",f.style.display=this._showOptionButtons?"block":"none",f.appendChild(this.caseSensitive.domNode),f.appendChild(this.wholeWords.domNode),f.appendChild(this.regex.domNode),this.domNode.appendChild(f),e&&e.appendChild(this.domNode),this._register(ae(this.inputBox.inputElement,"compositionstart",g=>{this.imeSessionInProgress=!0})),this._register(ae(this.inputBox.inputElement,"compositionend",g=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,g=>this._onKeyDown.fire(g)),this.onkeyup(this.inputBox.inputElement,g=>this._onKeyUp.fire(g)),this.oninput(this.inputBox.inputElement,g=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,g=>this._onMouseDown.fire(g))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.regex.style(e),this.wholeWords.style(e),this.caseSensitive.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(e){this.caseSensitive.checked=e}getWholeWords(){return this.wholeWords.checked}setWholeWords(e){this.wholeWords.checked=e}getRegex(){return this.regex.checked}setRegex(e){this.regex.checked=e,this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}clearMessage(){this.inputBox.hideMessage()}}const M8e=v("defaultLabel","input"),F8e=v("label.preserveCaseCheckbox","Preserve Case");class O8e extends Iy{constructor(e){super({icon:Ce.preserveCase,title:F8e+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class P8e extends bo{constructor(e,t,i,r){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new H),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new H),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new H),this._onInput=this._register(new H),this._onKeyUp=this._register(new H),this._onPreserveCaseKeyDown=this._register(new H),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=r.placeholder||"",this.validation=r.validation,this.label=r.label||M8e,this.inputActiveOptionBorder=r.inputActiveOptionBorder,this.inputActiveOptionForeground=r.inputActiveOptionForeground,this.inputActiveOptionBackground=r.inputActiveOptionBackground,this.inputBackground=r.inputBackground,this.inputForeground=r.inputForeground,this.inputBorder=r.inputBorder,this.inputValidationInfoBorder=r.inputValidationInfoBorder,this.inputValidationInfoBackground=r.inputValidationInfoBackground,this.inputValidationInfoForeground=r.inputValidationInfoForeground,this.inputValidationWarningBorder=r.inputValidationWarningBorder,this.inputValidationWarningBackground=r.inputValidationWarningBackground,this.inputValidationWarningForeground=r.inputValidationWarningForeground,this.inputValidationErrorBorder=r.inputValidationErrorBorder,this.inputValidationErrorBackground=r.inputValidationErrorBackground,this.inputValidationErrorForeground=r.inputValidationErrorForeground;const s=r.appendPreserveCaseLabel||"",o=r.history||[],a=!!r.flexibleHeight,l=!!r.flexibleWidth,c=r.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new sie(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:o,showHistoryHint:r.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c})),this.preserveCase=this._register(new O8e({appendTitle:s,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange(d=>{this._onDidOptionChange.fire(d),!d&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(d=>{this._onPreserveCaseKeyDown.fire(d)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let h=[this.preserveCase.domNode];this.onkeydown(this.domNode,d=>{if(d.equals(15)||d.equals(17)||d.equals(9)){let f=h.indexOf(document.activeElement);if(f>=0){let g=-1;d.equals(17)?g=(f+1)%h.length:d.equals(15)&&(f===0?g=h.length-1:g=f-1),d.equals(9)?(h[f].blur(),this.inputBox.focus()):g>=0&&h[g].focus(),Ft.stop(d,!0)}}});let u=document.createElement("div");u.className="controls",u.style.display=this._showOptionButtons?"block":"none",u.appendChild(this.preserveCase.domNode),this.domNode.appendChild(u),e&&e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,d=>this._onKeyDown.fire(d)),this.onkeyup(this.inputBox.inputElement,d=>this._onKeyUp.fire(d)),this.oninput(this.inputBox.inputElement,d=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,d=>this._onMouseDown.fire(d))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=e,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}class Io{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e=this.pos,t=0,i=this.value.charCodeAt(e),r;if(r=Io._table[i],typeof r=="number")return this.pos+=1,{type:r,pos:e,len:1};if(Io.isDigitCharacter(i)){r=8;do t+=1,i=this.value.charCodeAt(e+t);while(Io.isDigitCharacter(i));return this.pos+=t,{type:r,pos:e,len:t}}if(Io.isVariableCharacter(i)){r=9;do i=this.value.charCodeAt(e+ ++t);while(Io.isVariableCharacter(i)||Io.isDigitCharacter(i));return this.pos+=t,{type:r,pos:e,len:t}}r=10;do t+=1,i=this.value.charCodeAt(e+t);while(!isNaN(i)&&typeof Io._table[i]>"u"&&!Io.isDigitCharacter(i)&&!Io.isVariableCharacter(i));return this.pos+=t,{type:r,pos:e,len:t}}}Io._table={[36]:0,[58]:1,[44]:2,[123]:3,[125]:4,[92]:5,[47]:6,[124]:7,[43]:11,[45]:12,[63]:13};class A0{constructor(){this._children=[]}appendChild(e){return e instanceof rs&&this._children[this._children.length-1]instanceof rs?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,r=i.children.indexOf(e),s=i.children.slice(0);s.splice(r,1,...t),i._children=s,function o(a,l){for(const c of a)c.parent=l,o(c.children,c)}(t,i)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof ZL)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class rs extends A0{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new rs(this.value)}}class Eie extends A0{}class Vo extends Eie{constructor(e){super(),this.index=e}static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Ty?this._children[0]:void 0}clone(){let e=new Vo(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}class Ty extends A0{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof rs&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){let e=new Ty;return this.options.forEach(e.appendChild,e),e}}class LB extends A0{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,r=e.replace(this.regexp,function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(s=>s instanceof ya&&!!s.elseValue)&&(r=this._replace([])),r}_replace(e){let t="";for(const i of this._children)if(i instanceof ya){let r=e[i.index]||"";r=i.resolve(r),t+=r}else t+=i.toString();return t}toString(){return""}clone(){let e=new LB;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}}class ya extends A0{constructor(e,t,i,r){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=r}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(i=>i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((i,r)=>r===0?i.toLowerCase():i.charAt(0).toUpperCase()+i.substr(1).toLowerCase()).join(""):e}clone(){return new ya(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class r1 extends Eie{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),t!==void 0?(this._children=[new rs(t)],!0):!1}clone(){const e=new r1(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}function gH(n,e){const t=[...n];for(;t.length>0;){const i=t.shift();if(!e(i))break;t.unshift(...i.children)}}class ZL extends A0{get placeholderInfo(){if(!this._placeholders){let e=[],t;this.walk(function(i){return i instanceof Vo&&(e.push(i),t=!t||t.index<i.index?i:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk(r=>r===e?(i=!0,!1):(t+=r.len(),!0)),i?t:-1}fullLen(e){let t=0;return gH([e],i=>(t+=i.len(),!0)),t}enclosingPlaceholders(e){let t=[],{parent:i}=e;for(;i;)i instanceof Vo&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof r1&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){let e=new ZL;return this._children=this.children.map(t=>t.clone()),e}walk(e){gH(this.children,e)}}class YL{constructor(){this._scanner=new Io,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){this._scanner.text(e),this._token=this._scanner.next();const r=new ZL;for(;this._parse(r););const s=new Map,o=[];let a=0;r.walk(l=>(l instanceof Vo&&(a+=1,l.isFinalTabstop?s.set(0,void 0):!s.has(l.index)&&l.children.length>0?s.set(l.index,l.children):o.push(l)),!0));for(const l of o){const c=s.get(l.index);if(c){const h=new Vo(l.index);h.transform=l.transform;for(const u of c)h.appendChild(u.clone());r.replace(l,[h])}}return i||(i=a>0&&t),!s.has(0)&&i&&r.appendChild(new Vo(0)),r}_accept(e,t){if(e===void 0||this._token.type===e){let i=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){const r=this._scanner.next();if(r.type!==0&&r.type!==4&&r.type!==5)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new rs(t)),!0):!1}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new Vo(Number(t)):new r1(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const s=new Vo(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(s),!0;if(!this._parse(s))return e.appendChild(new rs("${"+t+":")),s.children.forEach(e.appendChild,e),!0}else if(s.index>0&&this._accept(7)){const o=new Ty;for(;;){if(this._parseChoiceElement(o)){if(this._accept(2))continue;if(this._accept(7)&&(s.appendChild(o),this._accept(4)))return e.appendChild(s),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(s)?(e.appendChild(s),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(s),!0):this._backTo(i)}_parseChoiceElement(e){const t=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let r;if((r=this._accept(5,!0))?r=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:r=this._accept(void 0,!0),!r)return this._backTo(t),!1;i.push(r)}return i.length===0?(this._backTo(t),!1):(e.appendChild(new rs(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const s=new r1(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(s),!0;if(!this._parse(s))return e.appendChild(new rs("${"+t+":")),s.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(s)?(e.appendChild(s),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(s),!0):this._backTo(i)}_parseTransform(e){let t=new LB,i="",r="";for(;!this._accept(6);){let s;if(s=this._accept(5,!0)){s=this._accept(6,!0)||s,i+=s;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let s;if(s=this._accept(5,!0)){s=this._accept(5,!0)||this._accept(6,!0)||s,t.appendChild(new rs(s));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(i,r)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);let r=this._accept(8,!0);if(r)if(i){if(this._accept(4))return e.appendChild(new ya(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new ya(Number(r))),!0;else return this._backTo(t),!1;if(this._accept(6)){let s=this._accept(9,!0);return!s||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new ya(Number(r),s)),!0)}else if(this._accept(11)){let s=this._until(4);if(s)return e.appendChild(new ya(Number(r),void 0,s,void 0)),!0}else if(this._accept(12)){let s=this._until(4);if(s)return e.appendChild(new ya(Number(r),void 0,void 0,s)),!0}else if(this._accept(13)){let s=this._until(1);if(s){let o=this._until(4);if(o)return e.appendChild(new ya(Number(r),void 0,s,o)),!0}}else{let s=this._until(4);if(s)return e.appendChild(new ya(Number(r),void 0,void 0,s)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new rs(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}var Dv=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const ct={Visible:new Te("suggestWidgetVisible",!1,v("suggestWidgetVisible","Whether suggestion are visible")),DetailsVisible:new Te("suggestWidgetDetailsVisible",!1,v("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new Te("suggestWidgetMultipleSuggestions",!1,v("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new Te("suggestionMakesTextEdit",!0,v("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new Te("acceptSuggestionOnEnter",!0,v("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new Te("suggestionHasInsertAndReplaceRange",!1,v("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new Te("suggestionInsertMode",void 0,{type:"string",description:v("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new Te("suggestionCanResolve",!1,v("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},td=new Ye("suggestWidgetStatusBar");class B8e{constructor(e,t,i,r){this.position=e,this.completion=t,this.container=i,this.provider=r,this.isInvalid=!1,this.score=Va.Default,this.distance=0,this.textLabel=typeof t.label=="string"?t.label:t.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),V.isIRange(t.range)?(this.editStart=new G(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new G(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new G(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||V.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new G(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new G(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new G(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||V.spansMultipleLines(t.range.insert)||V.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof r.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(e){return Dv(this,void 0,void 0,function*(){if(!this._resolveCache){const t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._isResolved=!1});this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(i=>{Object.assign(this.completion,i),this._isResolved=!0,t.dispose()},i=>{gd(i)&&(this._resolveCache=void 0,this._isResolved=!1)})}return this._resolveCache})}}class AD{constructor(e=2,t=new Set,i=new Set,r=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.showDeprecated=r}}AD.default=new AD;let V8e;function W8e(){return V8e}class $8e{constructor(e,t,i,r){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=r}}function Die(n,e,t=AD.default,i={triggerKind:0},r=ai.None){return Dv(this,void 0,void 0,function*(){const s=new yh(!0);e=e.clone();const o=n.getWordAtPosition(e),a=o?new V(e.lineNumber,o.startColumn,e.lineNumber,o.endColumn):V.fromPositions(e),l={replace:a,insert:a.setEndPosition(e.lineNumber,e.column)},c=[],h=new ve,u=[];let d=!1;const f=(p,m,b)=>{var _,w,y;if(m){for(let S of m.suggestions)if(!t.kindFilter.has(S.kind)){if(!t.showDeprecated&&(!((_=S==null?void 0:S.tags)===null||_===void 0)&&_.includes(1)))continue;S.range||(S.range=l),S.sortText||(S.sortText=typeof S.label=="string"?S.label:S.label.label),!d&&S.insertTextRules&&S.insertTextRules&4&&(d=YL.guessNeedsClipboard(S.insertText)),c.push(new B8e(e,S,m,p))}sQ(m)&&h.add(m),u.push({providerName:(w=p._debugDisplayName)!==null&&w!==void 0?w:"unkown_provider",elapsedProvider:(y=m.duration)!==null&&y!==void 0?y:-1,elapsedOverall:b.elapsed()})}},g=(()=>Dv(this,void 0,void 0,function*(){}))();for(let p of Da.orderedGroups(n)){let m=c.length;if(yield Promise.all(p.map(b=>Dv(this,void 0,void 0,function*(){if(!(t.providerFilter.size>0&&!t.providerFilter.has(b)))try{const _=new yh(!0),w=yield b.provideCompletionItems(n,e,i,r);f(b,w,_)}catch(_){ca(_)}}))),m!==c.length||r.isCancellationRequested)break}return yield g,r.isCancellationRequested?(h.dispose(),Promise.reject(g0())):new $8e(c.sort(kie(t.snippetSortOrder)),d,{entries:u,elapsed:s.elapsed()},h)})}function IB(n,e){if(n.sortTextLow&&e.sortTextLow){if(n.sortTextLow<e.sortTextLow)return-1;if(n.sortTextLow>e.sortTextLow)return 1}return n.completion.label<e.completion.label?-1:n.completion.label>e.completion.label?1:n.completion.kind-e.completion.kind}function z8e(n,e){if(n.completion.kind!==e.completion.kind){if(n.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return IB(n,e)}function H8e(n,e){if(n.completion.kind!==e.completion.kind){if(n.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return IB(n,e)}const XL=new Map;XL.set(0,z8e);XL.set(2,H8e);XL.set(1,IB);function kie(n){return XL.get(n)}Pt.registerCommand("_executeCompletionItemProvider",(n,...e)=>Dv(void 0,void 0,void 0,function*(){const[t,i,r,s]=e;ji(qe.isUri(t)),ji(G.isIPosition(i)),ji(typeof r=="string"||!r),ji(typeof s=="number"||!s);const o=yield n.get(sc).createModelReference(t);try{const a={incomplete:!1,suggestions:[]},l=[],c=yield Die(o.object.textEditorModel,G.lift(i),void 0,{triggerCharacter:r,triggerKind:r?1:0});for(const h of c.items)l.length<(s??0)&&l.push(h.resolve(ai.None)),a.incomplete=a.incomplete||h.container.incomplete,a.suggestions.push(h.completion);try{return yield Promise.all(l),a}finally{setTimeout(()=>c.disposable.dispose(),100)}}finally{o.dispose()}}));const gO=new class{constructor(){this.onlyOnceSuggestions=[]}provideCompletionItems(){let e={suggestions:this.onlyOnceSuggestions.slice(0)};return this.onlyOnceSuggestions.length=0,e}};Da.register("*",gO);function U8e(n,e){setTimeout(()=>{gO.onlyOnceSuggestions.push(...e),n.getContribution("editor.contrib.suggestController").triggerSuggest(new Set().add(gO))},0)}var Lie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Iie=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const s1="historyNavigationWidget",Tie="historyNavigationForwardsEnabled",Aie="historyNavigationBackwardsEnabled";function j8e(n,e,t){new Te(t,e).bindTo(n)}function q8e(n,e){return n.createScoped(e.target)}function Nie(n,e){return n.getContext(document.activeElement).getValue(e)}function Rie(n,e){const t=q8e(n,e);j8e(t,e,s1);const i=new Te(Tie,!0).bindTo(t),r=new Te(Aie,!0).bindTo(t);return{scopedContextKeyService:t,historyNavigationForwardsEnablement:i,historyNavigationBackwardsEnablement:r}}let pO=class extends R8e{constructor(e,t,i,r,s=!1){super(e,t,s,i),this._register(Rie(r,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};pO=Lie([Iie(3,Xe)],pO);let mO=class extends P8e{constructor(e,t,i,r,s=!1){super(e,t,s,i),this._register(Rie(r,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};mO=Lie([Iie(3,Xe)],mO);xr.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:Ie.and(Ie.has(s1),Ie.equals(Aie,!0),ct.Visible.isEqualTo(!1)),primary:16,secondary:[528],handler:n=>{const e=Nie(n.get(Xe),s1);e&&e.historyNavigator.showPreviousValue()}});xr.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:Ie.and(Ie.has(s1),Ie.equals(Tie,!0),ct.Visible.isEqualTo(!1)),primary:18,secondary:[530],handler:n=>{const e=Nie(n.get(Xe),s1);e&&e.historyNavigator.showNextValue()}});function pH(n){var e,t;return((e=n.lookupKeybinding("history.showPrevious"))===null||e===void 0?void 0:e.getElectronAccelerator())==="Up"&&((t=n.lookupKeybinding("history.showNext"))===null||t===void 0?void 0:t.getElectronAccelerator())==="Down"}var G8e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const K8e=ur("find-selection",Ce.selection,v("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),mH=ur("find-collapsed",Ce.chevronRight,v("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),_H=ur("find-expanded",Ce.chevronDown,v("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),Z8e=ur("find-replace",Ce.replace,v("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),Y8e=ur("find-replace-all",Ce.replaceAll,v("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),X8e=ur("find-previous-match",Ce.arrowUp,v("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),Q8e=ur("find-next-match",Ce.arrowDown,v("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),J8e=v("label.find","Find"),e7e=v("placeholder.find","Find"),t7e=v("label.previousMatchButton","Previous Match"),i7e=v("label.nextMatchButton","Next Match"),n7e=v("label.toggleSelectionFind","Find in Selection"),r7e=v("label.closeButton","Close"),s7e=v("label.replace","Replace"),o7e=v("placeholder.replace","Replace"),a7e=v("label.replaceButton","Replace"),l7e=v("label.replaceAllButton","Replace All"),c7e=v("label.toggleReplaceButton","Toggle Replace"),h7e=v("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",pu),u7e=v("label.matchesLocation","{0} of {1}"),bH=v("label.noResults","No results"),_l=419,d7e=275,f7e=d7e-54;let ob=69;const g7e=33,vH="ctrlEnterReplaceAll.windows.donotask",wH=wt?256:2048;class EA{constructor(e){this.afterLineNumber=e,this.heightInPx=g7e,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function yH(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){n.stopPropagation();return}}function CH(n,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){n.stopPropagation();return}}class QL extends bo{constructor(e,t,i,r,s,o,a,l,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=r,this._keybindingService=s,this._contextKeyService=o,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(vH,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new p0(500),this._register(Et(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(h=>this._onStateChanged(h))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(h=>{if(h.hasChanged(80)&&(this._codeEditor.getOption(80)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),h.hasChanged(129)&&this._tryUpdateWidgetWidth(),h.hasChanged(2)&&this.updateAccessibilitySupport(),h.hasChanged(35)){const u=this._codeEditor.getOption(35).addExtraSpaceOnTop;u&&!this._viewZone&&(this._viewZone=new EA(0),this._showViewZone()),!u&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(()=>G8e(this,void 0,void 0,function*(){if(this._isVisible){let h=yield this._controller.getGlobalBufferTerm();h&&h!==this._state.searchString&&(this._state.change({searchString:h},!1),this._findInput.select())}}))),this._findInputFocused=GL.bindTo(o),this._findFocusTracker=this._register(v_(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=kB.bindTo(o),this._replaceFocusTracker=this._register(v_(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(35).addExtraSpaceOnTop&&(this._viewZone=new EA(0)),this._applyTheme(a.getColorTheme()),this._register(a.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(h=>{if(h.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return QL.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(80)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=Lo(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,it)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=ob+"px",this._state.matchesCount>=pu?this._matchesCount.title=h7e:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild);let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=pu&&(t+="+");let i=String(this._state.matchesPosition);i==="0"&&(i="?"),e=No(u7e,i,t)}else e=bH;this._matchesCount.appendChild(document.createTextNode(e)),Hg(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),ob=Math.max(ob,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===bH)return i===""?v("ariaSearchNoResultEmpty","{0} found",e):v("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const r=v("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),s=this._codeEditor.getModel();return s&&t.startLineNumber<=s.getLineCount()&&t.startLineNumber>=1?`${s.getLineContent(t.startLineNumber)}, ${r}`:r}return v("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let i=!this._codeEditor.getOption(80);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(35).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(35).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const r=jn(i),s=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),o=r.left+(s?s.left:0),a=s?s.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=xQ(this._domNode).left;o>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());r.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(35).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(r=>{i.heightInPx=this._getHeight(),this._viewZoneId=r.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(35).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new EA(0));const i=this._viewZone;this._codeEditor.changeViewZones(r=>{if(this._viewZoneId!==void 0){const s=this._getHeight();if(s===i.heightInPx)return;let o=s-i.heightInPx;i.heightInPx=s,r.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o);return}else{let s=this._getHeight();if(s-=this._codeEditor.getOption(74).top,s<=0)return;i.heightInPx=s,this._viewZoneId=r.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(uF),inputActiveOptionBackground:e.getColor(dF),inputActiveOptionForeground:e.getColor(fF),inputBackground:e.getColor(pee),inputForeground:e.getColor(mee),inputBorder:e.getColor(_ee),inputValidationInfoBackground:e.getColor(D5),inputValidationInfoForeground:e.getColor(k5),inputValidationInfoBorder:e.getColor(L5),inputValidationWarningBackground:e.getColor(bee),inputValidationWarningForeground:e.getColor(vee),inputValidationWarningBorder:e.getColor(wee),inputValidationErrorBackground:e.getColor(yee),inputValidationErrorForeground:e.getColor(Cee),inputValidationErrorBorder:e.getColor(See)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible||!L3(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,r=e.minimap.minimapWidth;let s=!1,o=!1,a=!1;if(this._resized&&Lo(this._domNode)>_l){this._domNode.style.maxWidth=`${i-28-r-15}px`,this._replaceInput.width=Lo(this._findInput.domNode);return}if(_l+28+r>=i&&(o=!0),_l+28+r-ob>=i&&(a=!0),_l+28+r-ob>=i+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",o),!a&&!s&&(this._domNode.style.maxWidth=`${i-28-r-15}px`),this._resized){this._findInput.inputBox.layout();let l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=Lo(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!V.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(wH|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return yH(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return CH(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(wH|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{Kn&&ym&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(v("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(vH,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return yH(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return CH(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new pO(null,this._contextViewProvider,{width:f7e,label:J8e,placeholder:e7e,appendCaseSensitiveLabel:this._keybindingLabelFor(Xt.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Xt.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Xt.ToggleRegexCommand),validation:l=>{if(l.length===0||!this._findInput.getRegex())return null;try{return new RegExp(l,"gu"),null}catch(c){return{content:c.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>pH(this._keybindingService)},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(l=>this._onFindInputKeyDown(l))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(l=>{l.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),l.preventDefault())})),this._register(this._findInput.onRegexKeyDown(l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),l.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(l=>{this._tryUpdateHeight()&&this._showViewZone()})),zr&&this._register(this._findInput.onMouseDown(l=>this._onFindInputMouseDown(l))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new kp({label:t7e+this._keybindingLabelFor(Xt.PreviousMatchFindAction),icon:X8e,onTrigger:()=>{this._codeEditor.getAction(Xt.PreviousMatchFindAction).run().then(void 0,it)}})),this._nextBtn=this._register(new kp({label:i7e+this._keybindingLabelFor(Xt.NextMatchFindAction),icon:Q8e,onTrigger:()=>{this._codeEditor.getAction(Xt.NextMatchFindAction).run().then(void 0,it)}}));let i=document.createElement("div");i.className="find-part",i.appendChild(this._findInput.domNode);const r=document.createElement("div");r.className="find-actions",i.appendChild(r),r.appendChild(this._matchesCount),r.appendChild(this._prevBtn.domNode),r.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Iy({icon:K8e,title:n7e+this._keybindingLabelFor(Xt.ToggleSearchScopeCommand),isChecked:!1})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let l=this._codeEditor.getSelections();l.map(c=>(c.endColumn===1&&c.endLineNumber>c.startLineNumber&&(c=c.setEndPosition(c.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(c.endLineNumber-1))),c.isEmpty()?null:c)).filter(c=>!!c),l.length&&this._state.change({searchScope:l},!0)}}else this._state.change({searchScope:null},!0)})),r.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new kp({label:r7e+this._keybindingLabelFor(Xt.CloseFindWidgetCommand),icon:iPe,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:l=>{l.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),l.preventDefault())}})),r.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new mO(null,void 0,{label:s7e,placeholder:o7e,appendPreserveCaseLabel:this._keybindingLabelFor(Xt.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>pH(this._keybindingService)},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(l=>this._onReplaceInputKeyDown(l))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(l=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(l=>{l.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),l.preventDefault())})),this._replaceBtn=this._register(new kp({label:a7e+this._keybindingLabelFor(Xt.ReplaceOneAction),icon:Z8e,onTrigger:()=>{this._controller.replace()},onKeyDown:l=>{l.equals(1026)&&(this._closeBtn.focus(),l.preventDefault())}})),this._replaceAllBtn=this._register(new kp({label:l7e+this._keybindingLabelFor(Xt.ReplaceAllAction),icon:Y8e,onTrigger:()=>{this._controller.replaceAll()}}));let s=document.createElement("div");s.className="replace-part",s.appendChild(this._replaceInput.domNode);const o=document.createElement("div");o.className="replace-actions",s.appendChild(o),o.appendChild(this._replaceBtn.domNode),o.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new kp({label:c7e,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=Lo(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width=`${_l}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(i),this._domNode.appendChild(s),this._resizeSash=new Hn(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let a=_l;this._register(this._resizeSash.onDidStart(()=>{a=Lo(this._domNode)})),this._register(this._resizeSash.onDidChange(l=>{this._resized=!0;let c=a+l.startX-l.currentX;if(c<_l)return;const h=parseFloat(N3(this._domNode).maxWidth)||0;c>h||(this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=Lo(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const l=Lo(this._domNode);if(l<_l)return;let c=_l;if(!this._resized||l===_l){const h=this._codeEditor.getLayoutInfo();c=h.width-28-h.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${c}px`,this._isReplaceVisible&&(this._replaceInput.width=Lo(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}}QL.ID="editor.contrib.findWidget";class kp extends bo{constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+mi.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,i=>{this._opts.onTrigger(),i.preventDefault()}),this.onkeydown(this._domNode,i=>{if(i.equals(10)||i.equals(3)){this._opts.onTrigger(),i.preventDefault();return}this._opts.onKeyDown&&this._opts.onKeyDown(i)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...mi.asClassNameArray(mH)),this._domNode.classList.add(...mi.asClassNameArray(_H))):(this._domNode.classList.remove(...mi.asClassNameArray(_H)),this._domNode.classList.add(...mi.asClassNameArray(mH)))}}li((n,e)=>{const t=(g,p)=>{p&&e.addRule(`.monaco-editor ${g} { background-color: ${p}; }`)};t(".findMatch",n.getColor(pF)),t(".currentFindMatch",n.getColor(SNe)),t(".findScope",n.getColor(xNe));const i=n.getColor(ta);t(".find-widget",i);const r=n.getColor(T_);r&&e.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${r}; }`);const s=n.getColor(DNe);s&&e.addRule(`.monaco-editor .findMatch { border: 1px ${n.type==="hc"?"dotted":"solid"} ${s}; box-sizing: border-box; }`);const o=n.getColor(ENe);o&&e.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${o}; padding: 1px; box-sizing: border-box; }`);const a=n.getColor(kNe);a&&e.addRule(`.monaco-editor .findScope { border: 1px ${n.type==="hc"?"dashed":"solid"} ${a}; }`);const l=n.getColor(Ki);l&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${l}; }`);const c=n.getColor(Lu);c&&e.addRule(`.monaco-editor .find-widget { color: ${c}; }`);const h=n.getColor(rNe);h&&e.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${h}; }`);const u=n.getColor(fNe);if(u)e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${u}; }`);else{const g=n.getColor(Af);g&&e.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${g}; }`)}const d=n.getColor(lRe);d&&e.addRule(`
		.monaco-editor .find-widget .button:not(.disabled):hover,
		.monaco-editor .find-widget .codicon-find-selection:hover {
			background-color: ${d} !important;
		}
	`);const f=n.getColor(Yu);f&&e.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${f}; }`)});var Mie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},xl=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},z_=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const p7e=524288;function _O(n,e="single",t=!1){if(!n.hasModel())return null;const i=n.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const r=n.getConfiguredWordAtPosition(i.getStartPosition());if(r&&t===!1)return r.word}else if(n.getModel().getValueLengthInRange(i)<p7e)return n.getModel().getValueInRange(i)}return null}let Vs=class Fie extends re{constructor(e,t,i,r){super(),this._editor=e,this._findWidgetVisible=Jg.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=r,this._updateHistoryDelayer=new p0(500),this._state=this._register(new A8e),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(s=>this._onStateChanged(s))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{let s=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),s&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(35).loop})}))}get editor(){return this._editor}static get(e){return e.getContribution(Fie.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!GL.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=ja(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e){return z_(this,void 0,void 0,function*(){if(this.disposeModel(),!this._editor.hasModel())return;let t={isRevealed:!0};if(e.seedSearchStringFromSelection==="single"){let i=_O(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);i&&(this._state.isRegex?t.searchString=ja(i):t.searchString=i)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){let i=_O(this._editor,e.seedSearchStringFromSelection);i&&(t.searchString=i)}if(!t.searchString&&e.seedSearchStringFromGlobalClipboard){let i=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;i&&(t.searchString=i)}if(e.forceRevealReplace?t.isReplaceRevealed=!0:this._findWidgetVisible.get()||(t.isReplaceRevealed=!1),e.updateSearchScope){let i=this._editor.getSelections();i.some(r=>!r.isEmpty())&&(t.searchScope=i)}t.loop=e.loop,this._state.change(t,!1),this._model||(this._model=new Ev(this._editor,this._state))})}start(e){return this._start(e)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){return this._model?(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}getGlobalBufferTerm(){return z_(this,void 0,void 0,function*(){return this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""})}setGlobalBufferTerm(e){this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};Vs.ID="editor.contrib.findController";Vs=Mie([xl(1,Xe),xl(2,Qg),xl(3,Kg)],Vs);let bO=class extends Vs{constructor(e,t,i,r,s,o,a,l){super(e,i,a,l),this._contextViewService=t,this._keybindingService=r,this._themeService=s,this._notificationService=o,this._widget=null,this._findOptionsWidget=null}_start(e){const t=Object.create(null,{_start:{get:()=>super._start}});return z_(this,void 0,void 0,function*(){this._widget||this._createFindWidget();const i=this._editor.getSelection();let r=!1;switch(this._editor.getOption(35).autoFindInSelection){case"always":r=!0;break;case"never":r=!1;break;case"multiline":r=!!i&&i.startLineNumber!==i.endLineNumber;break}e.updateSearchScope=r,yield t._start.call(this,e),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())})}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new QL(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new KL(this._editor,this._state,this._keybindingService,this._themeService))}};bO=Mie([xl(1,qg),xl(2,Xe),xl(3,Yi),xl(4,fi),xl(5,Qn),xl(6,Qg),xl(7,Kg)],bO);const m7e=ZJ(new KJ({id:Xt.StartFindAction,label:v("startFindAction","Find"),alias:"Find",precondition:Ie.or(Z.focus,Ie.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:Ye.MenubarEditMenu,group:"3_find",title:v({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));m7e.addImplementation(0,(n,e,t)=>{const i=Vs.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(35).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(35).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(35).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(35).loop}):!1});class _7e extends Si{constructor(){super({id:Xt.StartFindWithSelection,label:v("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return z_(this,void 0,void 0,function*(){let i=Vs.get(t);i&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),i.setGlobalBufferTerm(i.getState().searchString))})}}class Oie extends Si{run(e,t){return z_(this,void 0,void 0,function*(){let i=Vs.get(t);i&&!this._run(i)&&(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(35).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(35).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(i))})}}class b7e extends Oie{constructor(){super({id:Xt.NextMatchFindAction,label:v("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:Z.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:Ie.and(Z.focus,GL),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class v7e extends Oie{constructor(){super({id:Xt.PreviousMatchFindAction,label:v("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:Z.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:Ie.and(Z.focus,GL),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class Pie extends Si{run(e,t){return z_(this,void 0,void 0,function*(){let i=Vs.get(t);if(!i)return;const r=t.getOption(35).seedSearchStringFromSelection==="selection";let s=null;t.getOption(35).seedSearchStringFromSelection!=="never"&&(s=_O(t,"single",r)),s&&i.setSearchString(s),this._run(i)||(yield i.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getOption(35).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:r,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(i))})}}class w7e extends Pie{constructor(){super({id:Xt.NextSelectionMatchFindAction,label:v("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class y7e extends Pie{constructor(){super({id:Xt.PreviousSelectionMatchFindAction,label:v("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const C7e=ZJ(new KJ({id:Xt.StartFindReplaceAction,label:v("startReplace","Replace"),alias:"Replace",precondition:Ie.or(Z.focus,Ie.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:Ye.MenubarEditMenu,group:"3_find",title:v({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));C7e.addImplementation(0,(n,e,t)=>{if(!e.hasModel()||e.getOption(80))return!1;const i=Vs.get(e);if(!i)return!1;const r=e.getSelection(),s=i.isFindInputFocused(),o=!r.isEmpty()&&r.startLineNumber===r.endLineNumber&&e.getOption(35).seedSearchStringFromSelection!=="never"&&!s,a=s||o?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:o?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(35).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(35).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(35).loop})});Yr(Vs.ID,bO);pt(_7e);pt(b7e);pt(v7e);pt(w7e);pt(y7e);const al=mo.bindToContribution(Vs.get);ye(new al({id:Xt.CloseFindWidgetCommand,precondition:Jg,handler:n=>n.closeFindWidget(),kbOpts:{weight:100+5,kbExpr:Ie.and(Z.focus,Ie.not("isComposing")),primary:9,secondary:[1033]}}));ye(new al({id:Xt.ToggleCaseSensitiveCommand,precondition:void 0,handler:n=>n.toggleCaseSensitive(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:GC.primary,mac:GC.mac,win:GC.win,linux:GC.linux}}));ye(new al({id:Xt.ToggleWholeWordCommand,precondition:void 0,handler:n=>n.toggleWholeWords(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:KC.primary,mac:KC.mac,win:KC.win,linux:KC.linux}}));ye(new al({id:Xt.ToggleRegexCommand,precondition:void 0,handler:n=>n.toggleRegex(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:ZC.primary,mac:ZC.mac,win:ZC.win,linux:ZC.linux}}));ye(new al({id:Xt.ToggleSearchScopeCommand,precondition:void 0,handler:n=>n.toggleSearchScope(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:YC.primary,mac:YC.mac,win:YC.win,linux:YC.linux}}));ye(new al({id:Xt.TogglePreserveCaseCommand,precondition:void 0,handler:n=>n.togglePreserveCase(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:XC.primary,mac:XC.mac,win:XC.win,linux:XC.linux}}));ye(new al({id:Xt.ReplaceOneAction,precondition:Jg,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:3094}}));ye(new al({id:Xt.ReplaceOneAction,precondition:Jg,handler:n=>n.replace(),kbOpts:{weight:100+5,kbExpr:Ie.and(Z.focus,kB),primary:3}}));ye(new al({id:Xt.ReplaceAllAction,precondition:Jg,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:2563}}));ye(new al({id:Xt.ReplaceAllAction,precondition:Jg,handler:n=>n.replaceAll(),kbOpts:{weight:100+5,kbExpr:Ie.and(Z.focus,kB),primary:void 0,mac:{primary:2051}}}));ye(new al({id:Xt.SelectAllMatchesAction,precondition:Jg,handler:n=>n.selectAllMatches(),kbOpts:{weight:100+5,kbExpr:Z.focus,primary:515}}));function N0(n,e){const t=e.filter(i=>!n.find(r=>r.equals(i)));if(t.length>=1){const i=t.map(s=>`line ${s.viewState.position.lineNumber} column ${s.viewState.position.column}`).join(", "),r=t.length===1?v("cursorAdded","Cursor added: {0}",i):v("cursorsAdded","Cursors added: {0}",i);UE(r)}}class S7e extends Si{constructor(){super({id:"editor.action.insertCursorAbove",label:v("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:Z.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let r=!0;i&&i.logicalLine===!1&&(r=!1);const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.pushStackElement();const o=s.getCursorStates();s.setCursorStates(i.source,3,xn.addCursorUp(s,o,r)),s.revealTopMostCursor(i.source),N0(o,s.getCursorStates())}}class x7e extends Si{constructor(){super({id:"editor.action.insertCursorBelow",label:v("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:Z.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let r=!0;i&&i.logicalLine===!1&&(r=!1);const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.pushStackElement();const o=s.getCursorStates();s.setCursorStates(i.source,3,xn.addCursorDown(s,o,r)),s.revealBottomMostCursor(i.source),N0(o,s.getCursorStates())}}class E7e extends Si{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:v("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:Z.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let r=e.startLineNumber;r<e.endLineNumber;r++){let s=t.getLineMaxColumn(r);i.push(new je(r,s,r,s))}e.endColumn>1&&i.push(new je(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),r=t.getSelections(),s=t._getViewModel(),o=s.getCursorStates();let a=[];r.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),N0(o,s.getCursorStates())}}class D7e extends Si{constructor(){super({id:"editor.action.addCursorsToBottom",label:v("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),r=t.getModel().getLineCount();let s=[];for(let l=i[0].startLineNumber;l<=r;l++)s.push(new je(l,i[0].startColumn,l,i[0].endColumn));const o=t._getViewModel(),a=o.getCursorStates();s.length>0&&t.setSelections(s),N0(a,o.getCursorStates())}}class k7e extends Si{constructor(){super({id:"editor.action.addCursorsToTop",label:v("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections();let r=[];for(let a=i[0].startLineNumber;a>=1;a--)r.push(new je(a,i[0].startColumn,a,i[0].endColumn));const s=t._getViewModel(),o=s.getCursorStates();r.length>0&&t.setSelections(r),N0(o,s.getCursorStates())}}class JC{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class o1{constructor(e,t,i,r,s,o,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=r,this.wholeWord=s,this.matchCase=o,this.currentMatch=a}static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new o1(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let r=!1,s,o;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(r=!0,s=!0,o=!0):(s=i.wholeWord,o=i.matchCase);const l=e.getSelection();let c,h=null;if(l.isEmpty()){const u=e.getConfiguredWordAtPosition(l.getStartPosition());if(!u)return null;c=u.word,h=new je(l.startLineNumber,u.startColumn,l.startLineNumber,u.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new o1(e,t,r,c,s,o,h)}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new JC(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new JC(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const r=this.currentMatch;return this.currentMatch=null,r}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1);return i?new je(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new JC(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new JC(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const r=this.currentMatch;return this.currentMatch=null,r}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1);return i?new je(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(){return this._editor.hasModel()?(this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1,1073741824)):[]}}class bg extends re{constructor(e){super(),this._sessionDispose=this._register(new ve),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}static get(e){return e.getContribution(bg.ID)}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=o1.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(r=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(r=>{(r.matchCase||r.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new je(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const r=e.getState().matchCase;if(!Bie(this._editor.getModel(),t,r)){const o=this._editor.getModel();let a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(o,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex)t=this._editor.getModel().findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(115):null,!1,1073741824);else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll()}if(i.searchScope){const r=i.searchScope;let s=[];t.forEach(o=>{r.forEach(a=>{o.range.endLineNumber<=a.endLineNumber&&o.range.startLineNumber>=a.startLineNumber&&s.push(o)})}),t=s}if(t.length>0){const r=this._editor.getSelection();for(let s=0,o=t.length;s<o;s++){const a=t[s];if(a.range.intersectRanges(r)){t[s]=t[0],t[0]=a;break}}this._setSelections(t.map(s=>new je(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn)))}}}bg.ID="editor.contrib.multiCursorController";class R0 extends Si{run(e,t){const i=bg.get(t);if(!i)return;const r=Vs.get(t);if(!r)return;const s=t._getViewModel();if(s){const o=s.getCursorStates();this._run(i,r),N0(o,s.getCursorStates())}}}class L7e extends R0{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:v("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:2082,weight:100},menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class I7e extends R0{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:v("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class T7e extends R0{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:v("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:qr(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class A7e extends R0{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:v("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class N7e extends R0{constructor(){super({id:"editor.action.selectHighlights",label:v("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:3114,weight:100},menuOpts:{menuId:Ye.MenubarSelectionMenu,group:"3_multi",title:v({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class R7e extends R0{constructor(){super({id:"editor.action.changeAll",label:v("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:Ie.and(Z.writable,Z.editorTextFocus),kbOpts:{kbExpr:Z.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class SH{constructor(e,t,i,r){this.searchText=e,this.matchCase=t,this.wordSeparators=i,this.modelVersionId=r}static softEquals(e,t){return!e&&!t?!0:!e||!t?!1:e.searchText===t.searchText&&e.matchCase===t.matchCase&&e.wordSeparators===t.wordSeparators&&e.modelVersionId===t.modelVersionId}}class ph extends re{constructor(e){super(),this.editor=e,this._isEnabled=e.getOption(96),this.decorations=[],this.updateSoon=this._register(new yi(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(t=>{this._isEnabled=e.getOption(96)})),this._register(e.onDidChangeCursorSelection(t=>{this._isEnabled&&(t.selection.isEmpty()?t.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(t=>{this._setState(null)})),this._register(e.onDidChangeModelContent(t=>{this._isEnabled&&this.updateSoon.schedule()})),this._register(Vs.get(e).getState().onFindReplaceStateChange(t=>{this._update()}))}_update(){this._setState(ph._createState(this._isEnabled,this.editor))}static _createState(e,t){if(!e||!t.hasModel())return null;const i=t.getSelection();if(i.startLineNumber!==i.endLineNumber)return null;const r=bg.get(t);if(!r)return null;const s=Vs.get(t);if(!s)return null;let o=r.getSession(s);if(!o){const c=t.getSelections();if(c.length>1){const u=s.getState().matchCase;if(!Bie(t.getModel(),c,u))return null}o=o1.create(t,s)}if(!o||o.currentMatch||/^[ \t]+$/.test(o.searchText)||o.searchText.length>200)return null;const a=s.getState(),l=a.matchCase;if(a.isRevealed){let c=a.searchString;l||(c=c.toLowerCase());let h=o.searchText;if(l||(h=h.toLowerCase()),c===h&&o.matchCase===a.matchCase&&o.wholeWord===a.wholeWord&&!a.isRegex)return null}return new SH(o.searchText,o.matchCase,o.wholeWord?t.getOption(115):null,t.getModel().getVersionId())}_setState(e){if(SH.softEquals(this.state,e)){this.state=e;return}if(this.state=e,!this.state){this.decorations=this.editor.deltaDecorations(this.decorations,[]);return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=DE.has(t)&&this.editor.getOption(71);let r=t.findMatches(this.state.searchText,!0,!1,this.state.matchCase,this.state.wordSeparators,!1).map(l=>l.range);r.sort(V.compareRangesUsingStarts);let s=this.editor.getSelections();s.sort(V.compareRangesUsingStarts);let o=[];for(let l=0,c=0,h=r.length,u=s.length;l<h;){const d=r[l];if(c>=u)o.push(d),l++;else{const f=V.compareRangesUsingStarts(d,s[c]);f<0?((s[c].isEmpty()||!V.areIntersecting(d,s[c]))&&o.push(d),l++):(f>0||l++,c++)}}const a=o.map(l=>({range:l,options:i?ph._SELECTION_HIGHLIGHT:ph._SELECTION_HIGHLIGHT_OVERVIEW}));this.decorations=this.editor.deltaDecorations(this.decorations,a)}dispose(){this._setState(null),super.dispose()}}ph.ID="editor.contrib.selectionHighlighter";ph._SELECTION_HIGHLIGHT_OVERVIEW=bt.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",minimap:{color:xs(gRe),position:Xl.Inline},overviewRuler:{color:xs(fRe),position:rc.Center}});ph._SELECTION_HIGHLIGHT=bt.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"});function Bie(n,e,t){const i=xH(n,e[0],!t);for(let r=1,s=e.length;r<s;r++){const o=e[r];if(o.isEmpty())return!1;const a=xH(n,o,!t);if(i!==a)return!1}return!0}function xH(n,e,t){const i=n.getValueInRange(e);return t?i.toLowerCase():i}Yr(bg.ID,bg);Yr(ph.ID,ph);pt(S7e);pt(x7e);pt(E7e);pt(L7e);pt(I7e);pt(T7e);pt(A7e);pt(N7e);pt(R7e);pt(D7e);pt(k7e);const M7e=z("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},v("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class F7e extends Si{constructor(){super({id:"editor.action.jumpToBracket",label:v("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:Z.editorTextFocus,primary:3160,weight:100}})}run(e,t){let i=Wa.get(t);i&&i.jumpToBracket()}}class O7e extends Si{constructor(){super({id:"editor.action.selectToBracket",label:v("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){const r=Wa.get(t);if(!r)return;let s=!0;i&&i.selectBrackets===!1&&(s=!1),r.selectToBracket(s)}}class P7e{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}class Wa extends re{constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new yi(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(63),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._decorations=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(63)&&(this._matchBrackets=this._editor.getOption(63),this._decorations=this._editor.deltaDecorations(this._decorations,[]),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}static get(e){return e.getContribution(Wa.ID)}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const r=i.getStartPosition(),s=e.matchBracket(r);let o=null;if(s)s[0].containsPosition(r)?o=s[1].getStartPosition():s[1].containsPosition(r)&&(o=s[0].getStartPosition());else{const a=e.findEnclosingBrackets(r);if(a)o=a[0].getStartPosition();else{const l=e.findNextBracket(r);l&&l.range&&(o=l.range.getStartPosition())}}return o?new je(o.lineNumber,o.column,o.lineNumber,o.column):new je(r.lineNumber,r.column,r.lineNumber,r.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(r=>{const s=r.getStartPosition();let o=t.matchBracket(s);if(!o&&(o=t.findEnclosingBrackets(s),!o)){const c=t.findNextBracket(s);c&&c.range&&(o=t.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(o){o.sort(V.compareRangesUsingStarts);const[c,h]=o;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?h.getEndPosition():h.getStartPosition(),h.containsPosition(s)){const u=a;a=l,l=u}}a&&l&&i.push(new je(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();let e=[],t=0;for(const i of this._lastBracketsData){let r=i.brackets;r&&(e[t++]={range:r[0],options:i.options},e[t++]={range:r[1],options:i.options})}this._decorations=this._editor.deltaDecorations(this._decorations,e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let r=[];this._lastVersionId===i&&(r=this._lastBracketsData);let s=[],o=0;for(let u=0,d=e.length;u<d;u++){let f=e[u];f.isEmpty()&&(s[o++]=f.getStartPosition())}s.length>1&&s.sort(G.compare);let a=[],l=0,c=0,h=r.length;for(let u=0,d=s.length;u<d;u++){let f=s[u];for(;c<h&&r[c].position.isBefore(f);)c++;if(c<h&&r[c].position.equals(f))a[l++]=r[c];else{let g=t.matchBracket(f),p=Wa._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!g&&this._matchBrackets==="always"&&(g=t.findEnclosingBrackets(f,20),p=Wa._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new P7e(f,g,p)}}this._lastBracketsData=a,this._lastVersionId=i}}Wa.ID="editor.contrib.bracketMatchingController";Wa._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=bt.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:xs(M7e),position:rc.Center}});Wa._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=bt.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});Yr(Wa.ID,Wa);pt(O7e);pt(F7e);li((n,e)=>{const t=n.getColor(FRe);t&&e.addRule(`.monaco-editor .bracket-match { background-color: ${t}; }`);const i=n.getColor(ORe);i&&e.addRule(`.monaco-editor .bracket-match { border: 1px solid ${i}; }`)});Pa.appendMenuItem(Ye.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:v({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});function vO(n,e){return!!n[e]}class DA{constructor(e,t){this.target=e.target,this.hasTriggerModifier=vO(e.event,t.triggerModifier),this.hasSideBySideModifier=vO(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class EH{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=vO(e,t.triggerModifier)}}class eS{constructor(e,t,i,r){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=r}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function DH(n){return n==="altKey"?wt?new eS(57,"metaKey",6,"altKey"):new eS(5,"ctrlKey",6,"altKey"):wt?new eS(6,"altKey",57,"metaKey"):new eS(6,"altKey",5,"ctrlKey")}class B7e extends re{constructor(e){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new H),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new H),this.onExecute=this._onExecute.event,this._onCancel=this._register(new H),this.onCancel=this._onCancel.event,this._editor=e,this._opts=DH(this._editor.getOption(69)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(t=>{if(t.hasChanged(69)){const i=DH(this._editor.getOption(69));if(this._opts.equals(i))return;this._opts=i,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(t=>this._onEditorMouseMove(new DA(t,this._opts)))),this._register(this._editor.onMouseDown(t=>this._onEditorMouseDown(new DA(t,this._opts)))),this._register(this._editor.onMouseUp(t=>this._onEditorMouseUp(new DA(t,this._opts)))),this._register(this._editor.onKeyDown(t=>this._onEditorKeyDown(new EH(t,this._opts)))),this._register(this._editor.onKeyUp(t=>this._onEditorKeyUp(new EH(t,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(t=>this._onDidChangeCursorSelection(t))),this._register(this._editor.onDidChangeModel(t=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(t=>{(t.scrollTopChanged||t.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}_onEditorMouseUp(e){const t=e.target.position?e.target.position.lineNumber:0;this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var V7e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Td=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let vg=class extends zw{constructor(e,t,i,r,s,o,a,l,c,h){super(e,Object.assign(Object.assign({},i.getRawOptions()),{overflowWidgetsDomNode:i.getOverflowWidgetsDomNode()}),{},r,s,o,a,l,c,h),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration(u=>this._onParentConfigurationChanged(u)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){sl(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};vg=V7e([Td(3,Kt),Td(4,ui),Td(5,An),Td(6,Xe),Td(7,fi),Td(8,Qn),Td(9,ps)],vg);const kH=new X(new ht(0,122,204)),W7e={showArrow:!0,showFrame:!0,className:"",frameColor:kH,arrowColor:kH,keepEditorSelection:!1},$7e="vs.editor.contrib.zoneWidget";class z7e{constructor(e,t,i,r,s,o){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=r,this._onDomNodeTop=s,this._onComputedHeight=o}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class H7e{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class JL{constructor(e){this._editor=e,this._ruleName=JL._IdGenerator.nextId(),this._decorations=[],this._color=null,this._height=-1}dispose(){this.hide(),vE(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){vE(this._ruleName),LM(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){this._decorations=this._editor.deltaDecorations(this._decorations,[{range:V.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}}JL._IdGenerator=new bB(".arrow-decoration-");class U7e{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._positionMarkerId=[],this._viewZone=null,this._disposables=new ve,this.container=null,this._isShowing=!1,this.editor=e,this.options=iu(t),sl(this.options,W7e,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const r=this._getWidth(i);this.domNode.style.width=r+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(r)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this.editor.deltaDecorations(this._positionMarkerId,[]),this._positionMarkerId=[],this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new JL(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){let e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){let t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;const i=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(i))}this._resizeSash&&this._resizeSash.layout()}get position(){const[e]=this._positionMarkerId;if(!e)return;const t=this.editor.getModel();if(!t)return;const i=t.getDecorationRange(e);if(i)return i.getStartPosition()}show(e,t){const i=V.isIRange(e)?V.lift(e):V.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range:i,options:bt.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let e=this.editor.getOption(58),t=0;if(this.options.showArrow){let i=Math.round(e/3);t+=2*i}if(this.options.showFrame){let i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),r=this.editor.getLayoutInfo(),s=this._getWidth(r);this.domNode.style.width=`${s}px`,this.domNode.style.left=this._getLeft(r)+"px";const o=document.createElement("div");o.style.overflow="hidden";const a=this.editor.getOption(58),l=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,l);let c=0,h=0;if(this._arrow&&this.options.showArrow&&(c=Math.round(a/3),this._arrow.height=c,this._arrow.show(i)),this.options.showFrame&&(h=Math.round(a/9)),this.editor.changeViewZones(f=>{this._viewZone&&f.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new z7e(o,i.lineNumber,i.column,t,g=>this._onViewZoneTop(g),g=>this._onViewZoneHeight(g)),this._viewZone.id=f.addZone(this._viewZone),this._overlayWidget=new H7e($7e+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const f=this.options.frameWidth?this.options.frameWidth:h;this.container.style.borderTopWidth=f+"px",this.container.style.borderBottomWidth=f+"px"}let u=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=c+"px",this.container.style.height=u+"px",this.container.style.overflow="hidden"),this._doLayout(u,s),this.options.keepEditorSelection||this.editor.setSelection(e);const d=this.editor.getModel();if(d){const f=e.endLineNumber+1;f<=d.getLineCount()?this.revealLine(f,!1):this.revealLine(d.getLineCount(),!0)}}revealLine(e,t){t?this.editor.revealLineInCenter(e,0):this.editor.revealLine(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Hn(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.hide(),this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){let i=(t.currentY-e.startY)/this.editor.getOption(58),r=i<0?Math.ceil(i):Math.floor(i),s=e.heightInLines+r;s>5&&s<35&&this._relayout(s)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}class j7e extends D_{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new H),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=le(e,me(".monaco-dropdown")),this._label=le(this._element,me(".dropdown-label"));let i=t.labelRenderer;i||(i=s=>(s.textContent=t.label||"",null));for(const s of[Me.CLICK,Me.MOUSE_DOWN,Qt.Tap])this._register(ae(this.element,s,o=>Ft.stop(o,!0)));for(const s of[Me.MOUSE_DOWN,Qt.Tap])this._register(ae(this._label,s,o=>{o instanceof MouseEvent&&o.detail>1||(this.visible?this.hide():this.show())}));this._register(ae(this._label,Me.KEY_UP,s=>{const o=new bi(s);(o.equals(3)||o.equals(10))&&(Ft.stop(s,!0),this.visible?this.hide():this.show())}));const r=i(this._label);r&&this._register(r),this._register(Rt.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class q7e extends j7e{constructor(e,t){super(e,t),this._actions=[],this._contextMenuProvider=t.contextMenuProvider,this.actions=t.actions||[],this.actionProvider=t.actionProvider,this.menuClassName=t.menuClassName||"",this.menuAsChild=!!t.menuAsChild}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:e=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class Vie extends Of{constructor(e,t,i,r=Object.create(null)){super(null,e,r),this.actionItem=null,this._onDidChangeVisibility=this._register(new H),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=r,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=s=>{this.element=le(s,me("a.action-label"));let o=[];return typeof this.options.classNames=="string"?o=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(o=this.options.classNames),o.find(a=>a==="icon")||o.push("codicon"),this.element.classList.add(...o),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),r={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new q7e(e,r)),this._register(this.dropdownMenu.onDidChangeVisibility(s=>{var o;(o=this.element)===null||o===void 0||o.setAttribute("aria-expanded",`${s}`),this._onDidChangeVisibility.fire(s)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const s=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return s.options.anchorAlignmentProvider()}})}this.updateEnabled()}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}updateEnabled(){var e,t;const i=!this.getAction().enabled;(e=this.actionItem)===null||e===void 0||e.classList.toggle("disabled",i),(t=this.element)===null||t===void 0||t.classList.toggle("disabled",i)}}var TB=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Ll=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Wie=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function G7e(n,e,t,i,r,s,o){const a=n.getActions(e);return Z7e(a,t,!1,typeof i=="string"?c=>c===i:i,r,s,o),K7e(a)}function K7e(n){const e=new ve;for(const[,t]of n)for(const i of t)e.add(i);return e}function Z7e(n,e,t,i=a=>a==="navigation",r=Number.MAX_SAFE_INTEGER,s=()=>!1,o=!1){let a,l;Array.isArray(e)?(a=e,l=e):(a=e.primary,l=e.secondary);const c=new Set;for(const[h,u]of n){let d;i(h)?(d=a,d.length>0&&o&&d.push(new Fa)):(d=l,d.length>0&&d.push(new Fa));for(let f of u){t&&(f=f instanceof Ku&&f.alt?f.alt:f);const g=d.push(f);f instanceof u5&&c.add({group:h,action:f,index:g-1})}}for(const{group:h,action:u,index:d}of c){const f=i(h)?a:l,g=u.actions;(g.length<=1||f.length+g.length-2<=r)&&s(u,h,f.length)&&f.splice(d,1,...g)}if(a!==l&&a.length>r){const h=a.splice(r,a.length-r);l.unshift(...h,new Fa)}}let H_=class extends G5{constructor(e,t,i,r,s){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t==null?void 0:t.draggable}),this._keybindingService=i,this._notificationService=r,this._contextKeyService=s,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new zs),this._altKey=cf.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return Wie(this,void 0,void 0,function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}})}render(e){super.render(e),e.classList.add("menu-entry"),this._updateItemClass(this._menuItemAction.item);let t=!1,i=this._altKey.keyStatus.altKey||(Kn||zr)&&this._altKey.keyStatus.shiftKey;const r=()=>{const s=t&&i;s!==this._wantsAltCommand&&(this._wantsAltCommand=s,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event(s=>{i=s.altKey||(Kn||zr)&&s.shiftKey,r()})),this._register(ae(e,"mouseleave",s=>{t=!1,r()})),this._register(ae(e,"mouseenter",s=>{t=!0,r()}))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}updateTooltip(){if(this.label){const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let r=t?v("titleAndKb","{0} ({1})",i,t):i;if(!this._wantsAltCommand&&this._menuItemAction.alt){const s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,o=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),a=o&&o.getLabel(),l=a?v("titleAndKb","{0} ({1})",s,a):s;r+=`
[${c5.modifierLabels[Fo].altKey}] ${l}`}this.label.title=r}}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){var t;this._itemClassDispose.value=void 0;const{element:i,label:r}=this;if(!i||!r)return;const s=this._commandAction.checked&&(!((t=e.toggled)===null||t===void 0)&&t.icon)?e.toggled.icon:e.icon;if(s)if(mi.isThemeIcon(s)){const o=mi.asClassNameArray(s);r.classList.add(...o),this._itemClassDispose.value=Et(()=>{r.classList.remove(...o)})}else s.light&&r.style.setProperty("--menu-entry-icon-light",Ch(s.light)),s.dark&&r.style.setProperty("--menu-entry-icon-dark",Ch(s.dark)),r.classList.add("icon"),this._itemClassDispose.value=Et(()=>{r.classList.remove("icon"),r.style.removeProperty("--menu-entry-icon-light"),r.style.removeProperty("--menu-entry-icon-dark")})}};H_=TB([Ll(2,Yi),Ll(3,Qn),Ll(4,Xe)],H_);let wO=class extends Vie{constructor(e,t,i){var r,s;const o=Object.assign({},t??Object.create(null),{menuAsChild:(r=t==null?void 0:t.menuAsChild)!==null&&r!==void 0?r:!1,classNames:(s=t==null?void 0:t.classNames)!==null&&s!==void 0?s:mi.isThemeIcon(e.item.icon)?mi.asClassName(e.item.icon):void 0});super(e,{getActions:()=>e.actions},i,o)}render(e){if(super.render(e),this.element){e.classList.add("menu-entry");const{icon:t}=this._action.item;t&&!mi.isThemeIcon(t)&&(this.element.classList.add("icon"),t.light&&this.element.style.setProperty("--menu-entry-icon-light",Ch(t.light)),t.dark&&this.element.style.setProperty("--menu-entry-icon-dark",Ch(t.dark)))}}};wO=TB([Ll(2,Gg)],wO);let yO=class extends Of{constructor(e,t,i,r,s,o,a,l){var c,h,u;super(null,e),this._keybindingService=i,this._notificationService=r,this._contextMenuService=s,this._menuService=o,this._instaService=a,this._storageService=l,this._container=null,this._storageKey=`${e.item.submenu._debugName}_lastActionId`;let d,f=l.get(this._storageKey,1);f&&(d=e.actions.find(p=>f===p.id)),d||(d=e.actions[0]),this._defaultAction=this._instaService.createInstance(H_,d,void 0);const g=Object.assign({},t??Object.create(null),{menuAsChild:(c=t==null?void 0:t.menuAsChild)!==null&&c!==void 0?c:!0,classNames:(h=t==null?void 0:t.classNames)!==null&&h!==void 0?h:["codicon","codicon-chevron-down"],actionRunner:(u=t==null?void 0:t.actionRunner)!==null&&u!==void 0?u:new D_});this._dropdown=new Vie(e,e.actions,this._contextMenuService,g),this._dropdown.actionRunner.onDidRun(p=>{p.action instanceof Ku&&this.update(p.action)})}update(e){this._storageService.store(this._storageKey,e.id,1,0),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(H_,e,void 0),this._defaultAction.actionRunner=new class extends D_{runAction(t,i){return Wie(this,void 0,void 0,function*(){yield t.run(void 0)})}},this._container&&this._defaultAction.render(yke(this._container,me(".action-container")))}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=me(".action-container");this._defaultAction.render(le(this._container,t)),this._register(ae(t,Me.KEY_DOWN,r=>{const s=new bi(r);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));const i=me(".dropdown-action-container");this._dropdown.render(le(this._container,i)),this._register(ae(i,Me.KEY_DOWN,r=>{var s;const o=new bi(r);o.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(s=this._defaultAction.element)===null||s===void 0||s.focus(),o.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};yO=TB([Ll(2,Yi),Ll(3,Qn),Ll(4,Gg),Ll(5,w0),Ll(6,Kt),Ll(7,Qg)],yO);function Y7e(n,e,t){return e instanceof Ku?n.createInstance(H_,e,void 0):e instanceof jJ?e.item.rememberDefaultAction?n.createInstance(yO,e,t):n.createInstance(wO,e,t):void 0}var $ie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},zie=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const Hie=Dt("IPeekViewService");Wg(Hie,class{constructor(){this._widgets=new Map}addExclusiveWidget(n,e){const t=this._widgets.get(n);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const r=this._widgets.get(n);r&&r.widget===e&&(r.listener.dispose(),this._widgets.delete(n))};this._widgets.set(n,{widget:e,listener:e.onDidClose(i)})}});var us;(function(n){n.inPeekEditor=new Te("inReferenceSearchEditor",!0,v("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),n.notInPeekEditor=n.inPeekEditor.toNegated()})(us||(us={}));let a1=class{constructor(e,t){e instanceof vg&&us.inPeekEditor.bindTo(t)}dispose(){}};a1.ID="editor.contrib.referenceController";a1=$ie([zie(1,Xe)],a1);Yr(a1.ID,a1);function X7e(n){let e=n.get(ui).getFocusedCodeEditor();return e instanceof vg?e.getParentEditor():e}const Q7e={headerBackgroundColor:X.white,primaryHeadingColor:X.fromHex("#333333"),secondaryHeadingColor:X.fromHex("#6c6c6cb3")};let ND=class extends U7e{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new H,this.onDidClose=this._onDidClose.event,sl(this.options,Q7e,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){let t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();let e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=me(".head"),this._bodyElement=me(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){const i=me(".peekview-title");this.options.supportOnTitleClick&&(i.classList.add("clickable"),dn(i,"click",o=>this._onTitleClick(o))),le(this._headElement,i),this._fillTitleIcon(i),this._primaryHeading=me("span.filename"),this._secondaryHeading=me("span.dirname"),this._metaHeading=me("span.meta"),le(i,this._primaryHeading,this._secondaryHeading,this._metaHeading);const r=me(".peekview-actions");le(this._headElement,r);const s=this._getActionBarOptions();this._actionbarWidget=new xh(r,s),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new ea("peekview.close",v("label.close","Close"),Ce.close.classNames,!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:Y7e.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:Gn(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,Ss(this._metaHeading)):Or(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(58)*1.2),r=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(r,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};ND=$ie([zie(2,Kt)],ND);const J7e=z("peekViewTitle.background",{dark:Jt(Ba,.1),light:Jt(Ba,.1),hc:null},v("peekViewTitleBackground","Background color of the peek view title area.")),Uie=z("peekViewTitleLabel.foreground",{dark:X.white,light:X.black,hc:X.white},v("peekViewTitleForeground","Color of the peek view title.")),jie=z("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hc:"#FFFFFF99"},v("peekViewTitleInfoForeground","Color of the peek view title info.")),e9e=z("peekView.border",{dark:Ba,light:Ba,hc:Ki},v("peekViewBorder","Color of the peek view borders and arrow.")),qie=z("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hc:X.black},v("peekViewResultsBackground","Background color of the peek view result list.")),t9e=z("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hc:X.white},v("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list.")),i9e=z("peekViewResult.fileForeground",{dark:X.white,light:"#1E1E1E",hc:X.white},v("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list.")),n9e=z("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hc:null},v("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list.")),r9e=z("peekViewResult.selectionForeground",{dark:X.white,light:"#6C6C6C",hc:X.white},v("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list.")),nx=z("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hc:X.black},v("peekViewEditorBackground","Background color of the peek view editor.")),s9e=z("peekViewEditorGutter.background",{dark:nx,light:nx,hc:nx},v("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor.")),o9e=z("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hc:null},v("peekViewResultsMatchHighlight","Match highlight color in the peek view result list.")),a9e=z("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hc:null},v("peekViewEditorMatchHighlight","Match highlight color in the peek view editor.")),l9e=z("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hc:Ur},v("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var c9e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class id{constructor(e,t,i,r){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=r,this.id=iie.nextId()}get uri(){return this.link.uri}get range(){var e,t;return(t=(e=this._range)!==null&&e!==void 0?e:this.link.targetSelectionRange)!==null&&t!==void 0?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=(e=this.parent.getPreview(this))===null||e===void 0?void 0:e.preview(this.range);return t?v({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"symbol in {0} on line {1} at column {2}, {3}",qa(this.uri),this.range.startLineNumber,this.range.startColumn,t.value):v("aria.oneReference","symbol in {0} on line {1} at column {2}",qa(this.uri),this.range.startLineNumber,this.range.startColumn)}}class h9e{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:r,startColumn:s,endLineNumber:o,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:r,column:s-t}),c=new V(r,l.startColumn,r,s),h=new V(o,a,o,1073741824),u=i.getValueInRange(c).replace(/^\s+/,""),d=i.getValueInRange(e),f=i.getValueInRange(h).replace(/\s+$/,"");return{value:u+d+f,highlight:{start:u.length,end:u.length+d.length}}}}class l1{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new _r}dispose(){mt(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?v("aria.fileReferences.1","1 symbol in {0}, full path {1}",qa(this.uri),this.uri.fsPath):v("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,qa(this.uri),this.uri.fsPath)}resolve(e){return c9e(this,void 0,void 0,function*(){if(this._previews.size!==0)return this;for(let t of this.children)if(!this._previews.has(t.uri))try{const i=yield e.createModelReference(t.uri);this._previews.set(t.uri,new h9e(i))}catch(i){it(i)}return this})}}class hs{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new H,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(hs._compareReferences);let r;for(let s of e)if((!r||!Hr.isEqual(r.uri,s.uri,!0))&&(r=new l1(this,s.uri),this.groups.push(r)),r.children.length===0||hs._compareReferences(s,r.children[r.children.length-1])!==0){const o=new id(i===s,r,s,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(o),r.children.push(o)}}dispose(){mt(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new hs(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?v("aria.result.0","No results found"):this.references.length===1?v("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?v("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):v("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){let{parent:i}=e,r=i.children.indexOf(e),s=i.children.length,o=i.parent.groups.length;return o===1||t&&r+1<s||!t&&r>0?(t?r=(r+1)%s:r=(r+s-1)%s,i.children[r]):(r=i.parent.groups.indexOf(i),t?(r=(r+1)%o,i.parent.groups[r].children[0]):(r=(r+o-1)%o,i.parent.groups[r].children[i.parent.groups[r].children.length-1]))}nearestReference(e,t){const i=this.references.map((r,s)=>({idx:s,prefixLen:mw(r.uri.toString(),e.toString()),offsetDist:Math.abs(r.range.startLineNumber-t.lineNumber)*100+Math.abs(r.range.startColumn-t.column)})).sort((r,s)=>r.prefixLen>s.prefixLen?-1:r.prefixLen<s.prefixLen?1:r.offsetDist<s.offsetDist?-1:r.offsetDist>s.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&V.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return Hr.compare(e.uri,t.uri)||V.compareRangesUsingStarts(e.range,t.range)}}function Gie(n){if(!n)return;typeof n=="string"&&(n=qe.file(n));const e=qa(n)||(n.scheme===ft.file?n.fsPath:n.path);return Kn&&eLe(e)?CO(e):e}function CO(n){return PQ(n)?n.charAt(0).toUpperCase()+n.slice(1):n}var e2=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},c1=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let SO=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof hs||e instanceof l1}getChildren(e){if(e instanceof hs)return e.groups;if(e instanceof l1)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};SO=e2([c1(0,sc)],SO);class u9e{getHeight(){return 23}getTemplateId(e){return e instanceof l1?h1.id:Ay.id}}let xO=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof id){const i=(t=e.parent.getPreview(e))===null||t===void 0?void 0:t.preview(e.range);if(i)return i.value}return qa(e.uri)}};xO=e2([c1(0,Yi)],xO);class d9e{getId(e){return e instanceof id?e.id:e.uri}}let EO=class extends re{constructor(e,t,i){super(),this._uriLabel=t;const r=document.createElement("div");r.classList.add("reference-file"),this.file=this._register(new wB(r,{supportHighlights:!0})),this.badge=new iO(le(r,me(".count"))),this._register(z4e(this.badge,i)),e.appendChild(r)}set(e,t){let i=$3(e.uri);this.file.setLabel(Gie(e.uri),this._uriLabel.getUriLabel(i,{relative:!0}),{title:this._uriLabel.getUriLabel(e.uri),matches:t});const r=e.children.length;this.badge.setCount(r),r>1?this.badge.setTitleFormat(v("referencesCount","{0} references",r)):this.badge.setTitleFormat(v("referenceCount","{0} reference",r))}};EO=e2([c1(1,Sy),c1(2,fi)],EO);let h1=class Kie{constructor(e){this._instantiationService=e,this.templateId=Kie.id}renderTemplate(e){return this._instantiationService.createInstance(EO,e)}renderElement(e,t,i){i.set(e.element,tB(e.filterData))}disposeTemplate(e){e.dispose()}};h1.id="FileReferencesRenderer";h1=e2([c1(0,Kt)],h1);class f9e{constructor(e){this.label=new ed(e,!1)}set(e,t){var i;const r=(i=e.parent.getPreview(e))===null||i===void 0?void 0:i.preview(e.range);if(!r||!r.value)this.label.set(`${qa(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:s,highlight:o}=r;t&&!Va.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(s,tB(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(s,[o]))}}}class Ay{constructor(){this.templateId=Ay.id}renderTemplate(e){return new f9e(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}Ay.id="OneReferenceRenderer";class g9e{getWidgetAriaLabel(){return v("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var p9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Nc=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},LH=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class t2{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new ve,this._callOnModelChange=new ve,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(let t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let s=0,o=e.children.length;s<o;s++){let a=e.children[s];this._decorationIgnoreSet.has(a.id)||a.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:a.range,options:t2.DecorationOptions}),i.push(s))}const r=this._editor.deltaDecorations([],t);for(let s=0;s<r.length;s++)this._decorations.set(r[s],e.children[i[s]])}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(let[i,r]of this._decorations){const s=t.getDecorationRange(i);if(!s)continue;let o=!1;if(!V.equalsRange(s,r.range)){if(V.spansMultipleLines(s))o=!0;else{const a=r.range.endColumn-r.range.startColumn,l=s.endColumn-s.startColumn;a!==l&&(o=!0)}o?(this._decorationIgnoreSet.add(r.id),e.push(i)):r.range=s}}for(let i=0,r=e.length;i<r;i++)this._decorations.delete(e[i]);this._editor.deltaDecorations(e,[])}}removeDecorations(){this._editor.deltaDecorations([...this._decorations.keys()],[]),this._decorations.clear()}}t2.DecorationOptions=bt.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class m9e{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const r=JSON.parse(e);t=r.ratio,i=r.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class _9e extends YF{}let DO=class extends ND{constructor(e,t,i,r,s,o,a,l,c,h,u,d){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},o),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=s,this._instantiationService=o,this._peekViewService=a,this._uriLabel=l,this._undoRedoService=c,this._keybindingService=h,this._modeService=u,this._languageConfigurationService=d,this._disposeOnNewModel=new ve,this._callOnDispose=new ve,this._onDidSelectReference=new H,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new Gt(0,0),this._applyTheme(r.getColorTheme()),this._callOnDispose.add(r.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),mt(this._preview),mt(this._previewNotAvailableMessage),mt(this._tree),mt(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(e9e)||X.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(J7e)||X.transparent,primaryHeadingColor:e.getColor(Uie),secondaryHeadingColor:e.getColor(jie)})}show(e){this.editor.revealRangeInCenterIfOutsideViewport(e,0),super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=le(e,me("div.messages")),Or(this._messageContainer),this._splitView=new $te(e,{orientation:1}),this._previewContainer=le(e,me("div.preview.inline"));let t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(vg,this._previewContainer,t,this.editor),Or(this._previewContainer),this._previewNotAvailableMessage=new fo(v("missingPreviewMessage","no preview available"),fo.DEFAULT_CREATION_OPTIONS,null,null,this._undoRedoService,this._modeService,this._languageConfigurationService),this._treeContainer=le(e,me("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new g9e,keyboardNavigationLabelProvider:this._instantiationService.createInstance(xO),identityProvider:new d9e,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:qie}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(dn(this._treeContainer,"keydown",s=>{s.equals(9)&&(this._keybindingService.dispatchEvent(s,s.target),s.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(_9e,"ReferencesWidget",this._treeContainer,new u9e,[this._instantiationService.createInstance(h1),this._instantiationService.createInstance(Ay)],this._instantiationService.createInstance(SO),i),this._splitView.addView({onDidChange:Re.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:s=>{this._preview.layout({height:this._dim.height,width:s})}},xD.Distribute),this._splitView.addView({onDidChange:Re.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:s=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${s}px`,this._tree.layout(this._dim.height,s)}},xD.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));let r=(s,o)=>{s instanceof id&&(o==="show"&&this._revealReference(s,!1),this._onDidSelectReference.fire({element:s,kind:o,source:"tree"}))};this._tree.onDidOpen(s=>{s.sideBySide?r(s.element,"side"):s.editorOptions.pinned?r(s.element,"goto"):r(s.element,"show")}),Or(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new Gt(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=v("noResults","No results"),Ss(this._messageContainer),Promise.resolve(void 0)):(Or(this._messageContainer),this._decorationsManager=new t2(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const r=this._getFocusedReference();r&&this._onDidSelectReference.fire({element:{uri:r.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),Ss(this._treeContainer),Ss(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof id)return e;if(e instanceof l1&&e.children.length>0)return e.children[0]}revealReference(e){return LH(this,void 0,void 0,function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})})}_revealReference(e,t){return LH(this,void 0,void 0,function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==ft.inMemory?this.setTitle(VQ(e.uri),this._uriLabel.getUriLabel($3(e.uri))):this.setTitle(v("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent),this._tree.reveal(e));const r=yield i;if(!this._model){r.dispose();return}mt(this._previewModelReference);const s=r.object;if(s){const o=this._preview.getModel()===s.textEditorModel?0:1,a=V.lift(e.range).collapseToStart();this._previewModelReference=r,this._preview.setModel(s.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,o)}else this._preview.setModel(this._previewNotAvailableMessage),r.dispose()})}};DO=p9e([Nc(3,fi),Nc(4,sc),Nc(5,Kt),Nc(6,Hie),Nc(7,Sy),Nc(8,vy),Nc(9,Yi),Nc(10,Zr),Nc(11,my)],DO);li((n,e)=>{const t=n.getColor(o9e);t&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${t}; }`);const i=n.getColor(a9e);i&&e.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${i}; }`);const r=n.getColor(l9e);r&&e.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${r}; box-sizing: border-box; }`);const s=n.getColor(Ur);s&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${s}; box-sizing: border-box; }`);const o=n.getColor(qie);o&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${o}; }`);const a=n.getColor(t9e);a&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${a}; }`);const l=n.getColor(i9e);l&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${l}; }`);const c=n.getColor(n9e);c&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${c}; }`);const h=n.getColor(r9e);h&&e.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${h} !important; }`);const u=n.getColor(nx);u&&e.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {	background-color: ${u};}`);const d=n.getColor(s9e);d&&e.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {	background-color: ${d};}`)});var b9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Lp=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},IH=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const ep=new Te("referenceSearchVisible",!1,v("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let U_=class kO{constructor(e,t,i,r,s,o,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=r,this._notificationService=s,this._instantiationService=o,this._storageService=a,this._configurationService=l,this._disposables=new ve,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=ep.bindTo(i)}static get(e){return e.getContribution(kO.ID)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)===null||e===void 0||e.dispose(),(t=this._model)===null||t===void 0||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let r;if(this._widget&&(r=this._widget.position),this.closeWidget(),r&&e.containsPosition(r))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const s="peekViewLayout",o=m9e.fromJSON(this._storageService.get(s,0,"{}"));this._widget=this._instantiationService.createInstance(DO,this._editor,this._defaultTreeKeyboardSupport,o),this._widget.setTitle(v("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget&&(this._storageService.store(s,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{let{element:c,kind:h}=l;if(c)switch(h){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{var c;if(a!==this._requestIdPool||!this._widget){l.dispose();return}return(c=this._model)===null||c===void 0||c.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(v("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));let h=this._editor.getModel().uri,u=new G(e.startLineNumber,e.startColumn),d=this._model.nearestReference(h,u);if(d)return this._widget.setSelection(d).then(()=>{this._widget&&this._editor.getOption(76)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return IH(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const r=this._model.nextOrPreviousReference(i,e),s=this._editor.hasTextFocus(),o=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(r),yield this._gotoReference(r),s?this._editor.focus():this._widget&&o&&this._widget.focusOnPreviewEditor()})}revealReference(e){return IH(this,void 0,void 0,function*(){!this._editor.hasModel()||!this._model||!this._widget||(yield this._widget.revealReference(e))})}closeWidget(e=!0){var t,i;(t=this._widget)===null||t===void 0||t.dispose(),(i=this._model)===null||i===void 0||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e){this._widget&&this._widget.hide(),this._ignoreModelChangeEvent=!0;const t=V.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:t}},this._editor).then(i=>{var r;if(this._ignoreModelChangeEvent=!1,!i||!this._widget){this.closeWidget();return}if(this._editor===i)this._widget.show(t),this._widget.focusOnReferenceTree();else{const s=kO.get(i),o=this._model.clone();this.closeWidget(),i.focus(),s.toggleWidget(t,Hs(a=>Promise.resolve(o)),(r=this._peekMode)!==null&&r!==void 0?r:!1)}},i=>{this._ignoreModelChangeEvent=!1,it(i)})}openReference(e,t,i){t||this.closeWidget();const{uri:r,range:s}=e;this._editorService.openCodeEditor({resource:r,options:{selection:s,pinned:i}},this._editor,t)}};U_.ID="editor.contrib.referencesController";U_=b9e([Lp(2,Xe),Lp(3,ui),Lp(4,Qn),Lp(5,Kt),Lp(6,Qg),Lp(7,Zi)],U_);function tp(n,e){const t=X7e(n);if(!t)return;let i=U_.get(t);i&&e(i)}xr.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:qr(2089,60),when:Ie.or(ep,us.inPeekEditor),handler(n){tp(n,e=>{e.changeFocusBetweenPreviewAndReferences()})}});xr.registerCommandAndKeybindingRule({id:"goToNextReference",weight:100-10,primary:62,secondary:[70],when:Ie.or(ep,us.inPeekEditor),handler(n){tp(n,e=>{e.goToNextOrPreviousReference(!0)})}});xr.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:100-10,primary:1086,secondary:[1094],when:Ie.or(ep,us.inPeekEditor),handler(n){tp(n,e=>{e.goToNextOrPreviousReference(!1)})}});Pt.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");Pt.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");Pt.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");Pt.registerCommand("closeReferenceSearch",n=>tp(n,e=>e.closeWidget()));xr.registerKeybindingRule({id:"closeReferenceSearch",weight:100-101,primary:9,secondary:[1033],when:Ie.and(us.inPeekEditor,Ie.not("config.editor.stablePeek"))});xr.registerKeybindingRule({id:"closeReferenceSearch",weight:200+50,primary:9,secondary:[1033],when:Ie.and(ep,Ie.not("config.editor.stablePeek"))});xr.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:Ie.and(ep,Zte),handler(n){var e;const i=(e=n.get(vo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof id&&tp(n,r=>r.revealReference(i[0]))}});xr.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:Ie.and(ep,Zte),handler(n){var e;const i=(e=n.get(vo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof id&&tp(n,r=>r.openReference(i[0],!0,!0))}});Pt.registerCommand("openReference",n=>{var e;const i=(e=n.get(vo).lastFocusedList)===null||e===void 0?void 0:e.getFocus();Array.isArray(i)&&i[0]instanceof id&&tp(n,r=>r.openReference(i[0],!1,!0))});var Zie=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Lb=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const AB=new Te("hasSymbols",!1,v("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),i2=Dt("ISymbolNavigationService");let LO=class{constructor(e,t,i,r){this._editorService=t,this._notificationService=i,this._keybindingService=r,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=AB.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)===null||e===void 0||e.dispose(),(t=this._currentMessage)===null||t===void 0||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new IO(this._editorService),r=i.onDidChange(s=>{if(this._ignoreEditorChange)return;const o=this._editorService.getActiveCodeEditor();if(!o)return;const a=o.getModel(),l=o.getPosition();if(!a||!l)return;let c=!1,h=!1;for(const u of t.references)if(BQ(u.uri,a.uri))c=!0,h=h||V.containsPosition(u.range,l);else if(c)break;(!c||!h)&&this.reset()});this._currentState=Cu(i,r)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:V.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var e;(e=this._currentMessage)===null||e===void 0||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?v("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):v("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};LO=Zie([Lb(0,Xe),Lb(1,ui),Lb(2,Qn),Lb(3,Yi)],LO);Wg(i2,LO,!0);ye(new class extends mo{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:AB,kbOpts:{weight:100,primary:70}})}runEditorCommand(n,e){return n.get(i2).revealNext(e)}});xr.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:AB,primary:9,handler(n){n.get(i2).reset()}});let IO=class{constructor(e){this._listener=new Map,this._disposables=new ve,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),mt(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,Cu(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))===null||t===void 0||t.dispose(),this._listener.delete(e)}};IO=Zie([Lb(0,ui)],IO);var v9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},w9e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let oa=class TO{constructor(e,t){this._messageWidget=new zs,this._messageListeners=new ve,this._editor=e,this._visible=TO.MESSAGE_VISIBLE.bindTo(t),this._editorListener=this._editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit())}static get(e){return e.getContribution(TO.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){Hg(e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new TH(this._editor,t,e),this._messageListeners.add(this._editor.onDidBlurEditorText(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(new Gr(()=>this.closeMessage(),3e3));let i;this._messageListeners.add(this._editor.onMouseMove(r=>{r.target.position&&(i?i.containsPosition(r.target.position)||this.closeMessage():i=new V(t.lineNumber-3,1,r.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(TH.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(v("editor.readonly","Cannot edit in read-only editor"),this._editor.getPosition())}};oa.ID="editor.contrib.messageController";oa.MESSAGE_VISIBLE=new Te("messageVisible",!1,v("messageVisible","Whether the editor is currently showing an inline message"));oa=v9e([w9e(1,Xe)],oa);const y9e=mo.bindToContribution(oa.get);ye(new y9e({id:"leaveEditorMessage",precondition:oa.MESSAGE_VISIBLE,handler:n=>n.closeMessage(),kbOpts:{weight:100+30,primary:9}}));let TH=class{constructor(e,{lineNumber:t,column:i},r){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i-1},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage");const s=document.createElement("div");s.classList.add("anchor","top"),this._domNode.appendChild(s);const o=document.createElement("div");o.classList.add("message"),o.textContent=r,this._domNode.appendChild(o);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(e){let t;const i=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener("animationend",i)};return t=setTimeout(i,110),e.getDomNode().addEventListener("animationend",i),e.getDomNode().classList.add("fadeOut"),{dispose:i}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};Yr(oa.ID,oa);li((n,e)=>{const t=n.getColor(L5);if(t){let s=n.type===Oa.HIGH_CONTRAST?2:1;e.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.below { border-top-color: ${t}; }`),e.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.top { border-bottom-color: ${t}; }`),e.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${s}px solid ${t}; }`)}const i=n.getColor(D5);i&&e.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${i}; }`);const r=n.getColor(k5);r&&e.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { color: ${r}; }`)});var Yie=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function Ny(n,e,t,i){const s=t.ordered(n).map(o=>Promise.resolve(i(o,n,e)).then(void 0,a=>{ca(a)}));return Promise.all(s).then(o=>{const a=[];for(let l of o)Array.isArray(l)?a.push(...l):l&&a.push(l);return a})}function NB(n,e,t){return Ny(n,e,vw,(i,r,s)=>i.provideDefinition(r,s,t))}function Xie(n,e,t){return Ny(n,e,kE,(i,r,s)=>i.provideDeclaration(r,s,t))}function Qie(n,e,t){return Ny(n,e,LE,(i,r,s)=>i.provideImplementation(r,s,t))}function Jie(n,e,t){return Ny(n,e,IE,(i,r,s)=>i.provideTypeDefinition(r,s,t))}function n2(n,e,t,i){return Ny(n,e,EE,(r,s,o)=>Yie(this,void 0,void 0,function*(){const a=yield r.provideReferences(s,o,{includeDeclaration:!0},i);if(!t||!a||a.length!==2)return a;const l=yield r.provideReferences(s,o,{includeDeclaration:!1},i);return l&&l.length===1?l:a}))}function Ry(n){return Yie(this,void 0,void 0,function*(){const e=yield n(),t=new hs(e,""),i=t.references.map(r=>r.link);return t.dispose(),i})}C0("_executeDefinitionProvider",(n,e)=>Ry(()=>NB(n,e,ai.None)));C0("_executeDeclarationProvider",(n,e)=>Ry(()=>Xie(n,e,ai.None)));C0("_executeImplementationProvider",(n,e)=>Ry(()=>Qie(n,e,ai.None)));C0("_executeTypeDefinitionProvider",(n,e)=>Ry(()=>Jie(n,e,ai.None)));C0("_executeReferenceProvider",(n,e)=>Ry(()=>n2(n,e,!1,ai.None)));var ia=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},kA,LA,IA,TA,AA,NA,RA,MA;Pa.appendMenuItem(Ye.EditorContext,{submenu:Ye.EditorContextPeek,title:v("peek.submenu","Peek"),group:"navigation",order:100});const ene=new Set;function ll(n){const e=new n;return YJ(e),ene.add(e.id),e}class M0 extends Si{constructor(e,t){super(t),this._configuration=e}run(e,t){if(!t.hasModel())return Promise.resolve(void 0);const i=e.get(Qn),r=e.get(ui),s=e.get(L0),o=e.get(i2),a=t.getModel(),l=t.getPosition(),c=new KOe(t,5),h=bQ(this._getLocationModel(a,l,c.token),c.token).then(u=>ia(this,void 0,void 0,function*(){if(!u||c.token.isCancellationRequested)return;Hg(u.ariaMessage);let d;if(u.referenceAt(a.uri,l)){const g=this._getAlternativeCommand(t);g!==this.id&&ene.has(g)&&(d=t.getAction(g))}const f=u.references.length;if(f===0){if(!this._configuration.muteMessage){const g=a.getWordAtPosition(l);oa.get(t).showMessage(this._getNoResultFoundMessage(g),l)}}else if(f===1&&d)d.run();else return this._onResult(r,o,t,u)}),u=>{i.error(u)}).finally(()=>{c.dispose()});return s.showWhile(h,250),h}_onResult(e,t,i,r){return ia(this,void 0,void 0,function*(){const s=this._getGoToPreference(i);if(!(i instanceof vg)&&(this._configuration.openInPeek||s==="peek"&&r.references.length>1))this._openInPeek(i,r);else{const o=r.firstReference(),a=r.references.length>1&&s==="gotoAndPeek",l=yield this._openReference(i,e,o,this._configuration.openToSide,!a);a&&l?this._openInPeek(l,r):r.dispose(),s==="goto"&&t.put(o)}})}_openReference(e,t,i,r,s){return ia(this,void 0,void 0,function*(){let o;if(zLe(i)&&(o=i.targetSelectionRange),o||(o=i.range),!o)return;const a=yield t.openCodeEditor({resource:i.uri,options:{selection:V.collapseToStart(o),selectionRevealType:3}},e,r);if(a){if(s){const l=a.getModel(),c=a.deltaDecorations([],[{range:o,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&a.deltaDecorations(c,[])},350)}return a}})}_openInPeek(e,t){let i=U_.get(e);i&&e.hasModel()?i.toggleWidget(e.getSelection(),Hs(r=>Promise.resolve(t)),this._configuration.openInPeek):t.dispose()}}class r2 extends M0{_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield NB(e,t,i),v("def.title","Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?v("noResultWord","No definition found for '{0}'",e.word):v("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(50).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(50).multipleDefinitions}}const tne=hy&&!_Q?2118:70;ll((kA=class AO extends r2{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:AO.id,label:v("actions.goToDecl.label","Go to Definition"),alias:"Go to Definition",precondition:Ie.and(Z.hasDefinitionProvider,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:tne,weight:100},contextMenuOpts:{group:"navigation",order:1.1}}),Pt.registerCommandAlias("editor.action.goToDeclaration",AO.id)}},kA.id="editor.action.revealDefinition",kA));ll((LA=class NO extends r2{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:NO.id,label:v("actions.goToDeclToSide.label","Open Definition to the Side"),alias:"Open Definition to the Side",precondition:Ie.and(Z.hasDefinitionProvider,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,tne),weight:100}}),Pt.registerCommandAlias("editor.action.openDeclarationToTheSide",NO.id)}},LA.id="editor.action.revealDefinitionAside",LA));ll((IA=class RO extends r2{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:RO.id,label:v("actions.previewDecl.label","Peek Definition"),alias:"Peek Definition",precondition:Ie.and(Z.hasDefinitionProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:582,linux:{primary:3140},weight:100},contextMenuOpts:{menuId:Ye.EditorContextPeek,group:"peek",order:2}}),Pt.registerCommandAlias("editor.action.previewDeclaration",RO.id)}},IA.id="editor.action.peekDefinition",IA));class ine extends M0{_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield Xie(e,t,i),v("decl.title","Declarations"))})}_getNoResultFoundMessage(e){return e&&e.word?v("decl.noResultWord","No declaration found for '{0}'",e.word):v("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(50).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(50).multipleDeclarations}}ll((TA=class nne extends ine{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:nne.id,label:v("actions.goToDeclaration.label","Go to Declaration"),alias:"Go to Declaration",precondition:Ie.and(Z.hasDeclarationProvider,Z.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{group:"navigation",order:1.3}})}_getNoResultFoundMessage(e){return e&&e.word?v("decl.noResultWord","No declaration found for '{0}'",e.word):v("decl.generic.noResults","No declaration found")}},TA.id="editor.action.revealDeclaration",TA));ll(class extends ine{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",label:v("actions.peekDecl.label","Peek Declaration"),alias:"Peek Declaration",precondition:Ie.and(Z.hasDeclarationProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Ye.EditorContextPeek,group:"peek",order:3}})}});class rne extends M0{_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield Jie(e,t,i),v("typedef.title","Type Definitions"))})}_getNoResultFoundMessage(e){return e&&e.word?v("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):v("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(50).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(50).multipleTypeDefinitions}}ll((AA=class sne extends rne{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:sne.ID,label:v("actions.goToTypeDefinition.label","Go to Type Definition"),alias:"Go to Type Definition",precondition:Ie.and(Z.hasTypeDefinitionProvider,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:0,weight:100},contextMenuOpts:{group:"navigation",order:1.4}})}},AA.ID="editor.action.goToTypeDefinition",AA));ll((NA=class one extends rne{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:one.ID,label:v("actions.peekTypeDefinition.label","Peek Type Definition"),alias:"Peek Type Definition",precondition:Ie.and(Z.hasTypeDefinitionProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Ye.EditorContextPeek,group:"peek",order:4}})}},NA.ID="editor.action.peekTypeDefinition",NA));class ane extends M0{_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield Qie(e,t,i),v("impl.title","Implementations"))})}_getNoResultFoundMessage(e){return e&&e.word?v("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):v("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(50).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(50).multipleImplementations}}ll((RA=class lne extends ane{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:lne.ID,label:v("actions.goToImplementation.label","Go to Implementations"),alias:"Go to Implementations",precondition:Ie.and(Z.hasImplementationProvider,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:2118,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}},RA.ID="editor.action.goToImplementation",RA));ll((MA=class cne extends ane{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:cne.ID,label:v("actions.peekImplementation.label","Peek Implementations"),alias:"Peek Implementations",precondition:Ie.and(Z.hasImplementationProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:3142,weight:100},contextMenuOpts:{menuId:Ye.EditorContextPeek,group:"peek",order:5}})}},MA.ID="editor.action.peekImplementation",MA));class hne extends M0{_getNoResultFoundMessage(e){return e?v("references.no","No references found for '{0}'",e.word):v("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(50).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(50).multipleReferences}}ll(class extends hne{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",label:v("goToReferences.label","Go to References"),alias:"Go to References",precondition:Ie.and(Z.hasReferenceProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:Z.editorTextFocus,primary:1094,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield n2(e,t,!0,i),v("ref.title","References"))})}});ll(class extends hne{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",label:v("references.action.label","Peek References"),alias:"Peek References",precondition:Ie.and(Z.hasReferenceProvider,us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:Ye.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(yield n2(e,t,!1,i),v("ref.title","References"))})}});class C9e extends M0{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",label:v("label.generic","Go to Any Symbol"),alias:"Go to Any Symbol",precondition:Ie.and(us.notInPeekEditor,Z.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i){return ia(this,void 0,void 0,function*(){return new hs(this._references,v("generic.title","Locations"))})}_getNoResultFoundMessage(e){return e&&v("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return(t=this._gotoMultipleBehaviour)!==null&&t!==void 0?t:e.getOption(50).multipleReferences}_getAlternativeCommand(){return""}}Pt.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:qe},{name:"position",description:"The position at which to start",constraint:G.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(n,e,t,i,r,s,o)=>ia(void 0,void 0,void 0,function*(){ji(qe.isUri(e)),ji(G.isIPosition(t)),ji(Array.isArray(i)),ji(typeof r>"u"||typeof r=="string"),ji(typeof o>"u"||typeof o=="boolean");const a=n.get(ui),l=yield a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(n5(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const h=new class extends C9e{_getNoResultFoundMessage(u){return s||super._getNoResultFoundMessage(u)}}({muteMessage:!s,openInPeek:!!o,openToSide:!1},i,r);c.get(Kt).invokeFunction(h.run.bind(h),l)})})});Pt.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:qe},{name:"position",description:"The position at which to start",constraint:G.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(n,e,t,i,r)=>ia(void 0,void 0,void 0,function*(){n.get(An).executeCommand("editor.action.goToLocations",e,t,i,r,void 0,!0)})});Pt.registerCommand({id:"editor.action.findReferences",handler:(n,e,t)=>{ji(qe.isUri(e)),ji(G.isIPosition(t));const i=n.get(ui);return i.openCodeEditor({resource:e},i.getFocusedCodeEditor()).then(r=>{if(!n5(r)||!r.hasModel())return;const s=U_.get(r);if(!s)return;const o=Hs(l=>n2(r.getModel(),G.lift(t),!1,l).then(c=>new hs(c,v("ref.title","References")))),a=new V(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(s.toggleWidget(a,o,!1))})}});Pt.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");Pa.appendMenuItems([{id:Ye.MenubarGoMenu,item:{command:{id:"editor.action.revealDefinition",title:v({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},group:"4_symbol_nav",order:2}},{id:Ye.MenubarGoMenu,item:{command:{id:"editor.action.revealDeclaration",title:v({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},group:"4_symbol_nav",order:3}},{id:Ye.MenubarGoMenu,item:{command:{id:"editor.action.goToTypeDefinition",title:v({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},group:"4_symbol_nav",order:3}},{id:Ye.MenubarGoMenu,item:{command:{id:"editor.action.goToImplementation",title:v({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},group:"4_symbol_nav",order:4}},{id:Ye.MenubarGoMenu,item:{command:{id:"editor.action.goToReferences",title:v({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},group:"4_symbol_nav",order:5}}]);var S9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},AH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let wg=class Ib{constructor(e,t,i){this.textModelResolverService=t,this.modeService=i,this.toUnhook=new ve,this.toUnhookForKeyboard=new ve,this.linkDecorations=[],this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e;let r=new B7e(e);this.toUnhook.add(r),this.toUnhook.add(r.onMouseMoveOrRelevantKeyDown(([s,o])=>{this.startFindDefinitionFromMouse(s,hf(o))})),this.toUnhook.add(r.onExecute(s=>{this.isEnabled(s)&&this.gotoDefinition(s.target.position,s.hasSideBySideModifier).then(()=>{this.removeLinkDecorations()},o=>{this.removeLinkDecorations(),it(o)})})),this.toUnhook.add(r.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(Ib.ID)}startFindDefinitionFromCursor(e){return this.startFindDefinition(e).then(()=>{this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))})}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;this.toUnhookForKeyboard.clear();const i=e?(t=this.editor.getModel())===null||t===void 0?void 0:t.getWordAtPosition(e):null;if(!i)return this.currentWordAtPosition=null,this.removeLinkDecorations(),Promise.resolve(0);if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return Promise.resolve(0);this.currentWordAtPosition=i;let r=new GOe(this.editor,15);return this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=Hs(s=>this.findDefinition(e,s)),this.previousPromise.then(s=>{if(!s||!s.length||!r.validate(this.editor)){this.removeLinkDecorations();return}if(s.length>1)this.addDecoration(new V(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn),new B_().appendText(v("multipleResults","Click to show {0} definitions.",s.length)));else{let o=s[0];if(!o.uri)return;this.textModelResolverService.createModelReference(o.uri).then(a=>{if(!a.object||!a.object.textEditorModel){a.dispose();return}const{object:{textEditorModel:l}}=a,{startLineNumber:c}=o.range;if(c<1||c>l.getLineCount()){a.dispose();return}const h=this.getPreviewValue(l,c,o);let u;o.originSelectionRange?u=V.lift(o.originSelectionRange):u=new V(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);const d=this.modeService.getModeIdByFilepathOrFirstLine(l.uri);this.addDecoration(u,new B_().appendCodeblock(d||"",h)),a.dispose()})}}).then(void 0,it)}getPreviewValue(e,t,i){let r=i.targetSelectionRange?i.range:this.getPreviewRangeBasedOnBrackets(e,t);return r.endLineNumber-r.startLineNumber>=Ib.MAX_SOURCE_PREVIEW_LINES&&(r=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,r)}stripIndentationFromPreviewRange(e,t,i){let s=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);s=Math.min(s,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${s-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),r=Math.min(e.getLineCount(),t+Ib.MAX_SOURCE_PREVIEW_LINES);let s=t+1;for(;s<r;s++){let o=e.getLineFirstNonWhitespaceColumn(s);if(i===o)break}return new V(t,1,s+1,1)}getPreviewRangeBasedOnBrackets(e,t){const i=Math.min(e.getLineCount(),t+Ib.MAX_SOURCE_PREVIEW_LINES),r=[];let s=!0,o=e.findNextBracket(new G(t,1));for(;o!==null;){if(r.length===0)r.push(o);else{const h=r[r.length-1];if(h.open[0]===o.open[0]&&h.isOpen&&!o.isOpen?r.pop():r.push(o),r.length===0)if(s)s=!1;else return new V(t,1,o.range.endLineNumber+1,1)}const a=e.getLineMaxColumn(t);let l=o.range.endLineNumber,c=o.range.endColumn;if(a===o.range.endColumn&&(l++,c=1),l>i)return new V(t,1,i+1,1);o=e.findNextBracket(new G(l,c))}return new V(t,1,i+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[i])}removeLinkDecorations(){this.linkDecorations.length>0&&(this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[]))}isEnabled(e,t){return this.editor.hasModel()&&e.isNoneOrSingleMouseDown&&e.target.type===6&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&vw.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?NB(i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const r=!t&&this.editor.getOption(77)&&!this.isInPeekEditor(i);return new r2({openToSide:t,openInPeek:r,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(i,this.editor)})}isInPeekEditor(e){const t=e.get(Xe);return us.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose()}};wg.ID="editor.contrib.gotodefinitionatposition";wg.MAX_SOURCE_PREVIEW_LINES=8;wg=S9e([AH(1,sc),AH(2,Zr)],wg);Yr(wg.ID,wg);li((n,e)=>{const t=n.getColor(NNe);t&&e.addRule(`.monaco-editor .goto-definition-link { color: ${t} !important; }`)});const tS=me;class une extends re{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this._scrollbar=this._register(new TL(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this._scrollbar.getDomNode())}onContentsChanged(){this._scrollbar.scanDomNode()}}class RB extends re{constructor(e,t,i){super(),this.actionContainer=le(e,tS("div.action-container")),this.action=le(this.actionContainer,tS("a.action")),this.action.setAttribute("href","#"),this.action.setAttribute("role","button"),t.iconClass&&le(this.action,tS(`span.icon.${t.iconClass}`));const r=le(this.action,tS("span"));r.textContent=i?`${t.label} (${i})`:t.label,this._register(ae(this.actionContainer,Me.MOUSE_DOWN,s=>{s.stopPropagation(),s.preventDefault(),t.run(this.actionContainer)})),this.setEnabled(!0)}static render(e,t,i){return new RB(e,t,i)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function x9e(n,e){const t=[],r=y_.ordered(n).reverse().map(s=>Promise.resolve(s.provideDocumentColors(n,e)).then(o=>{if(Array.isArray(o))for(let a of o)t.push({colorInfo:a,provider:s})}));return Promise.all(r).then(()=>t)}function NH(n,e,t,i){return Promise.resolve(t.provideColorPresentations(n,e,i))}Pt.registerCommand("_executeDocumentColorProvider",function(n,...e){const[t]=e;if(!(t instanceof qe))throw Zl();const i=n.get(Kr).getModel(t);if(!i)throw Zl();const r=[],o=y_.ordered(i).reverse().map(a=>Promise.resolve(a.provideDocumentColors(i,ai.None)).then(l=>{if(Array.isArray(l))for(let c of l)r.push({range:c.range,color:[c.color.red,c.color.green,c.color.blue,c.color.alpha]})}));return Promise.all(o).then(()=>r)});Pt.registerCommand("_executeColorPresentationProvider",function(n,...e){const[t,i]=e,{uri:r,range:s}=i;if(!(r instanceof qe)||!Array.isArray(t)||t.length!==4||!V.isIRange(s))throw Zl();const[o,a,l,c]=t,h=n.get(Kr).getModel(r);if(!h)throw Zl();const u={range:s,color:{red:o,green:a,blue:l,alpha:c}},d=[],g=y_.ordered(h).reverse().map(p=>Promise.resolve(p.provideColorPresentations(h,u,ai.None)).then(m=>{Array.isArray(m)&&d.push(...m)}));return Promise.all(g).then(()=>d)});var E9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},RH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const D9e=500;let yg=class dne extends re{constructor(e,t,i){super(),this._editor=e,this._codeEditorService=t,this._configurationService=i,this._localToDispose=this._register(new ve),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=[],this._decorationsTypes=new Set,this._register(e.onDidChangeModel(()=>{this._isEnabled=this.isEnabled(),this.onModelChanged()})),this._register(e.onDidChangeModelLanguage(()=>this.onModelChanged())),this._register(y_.onDidChange(()=>this.onModelChanged())),this._register(e.onDidChangeConfiguration(()=>{let r=this._isEnabled;this._isEnabled=this.isEnabled(),r!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&typeof i=="object"){const r=i.colorDecorators;if(r&&r.enable!==void 0&&!r.enable)return r.enable}return this._editor.getOption(17)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}onModelChanged(){if(this.stop(),!this._isEnabled)return;const e=this._editor.getModel();!e||!y_.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new Gr,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},dne.RECOMPUTE_TIME))})),this.beginCompute())}beginCompute(){this._computePromise=Hs(e=>{const t=this._editor.getModel();return t?x9e(t,e):Promise.resolve([])}),this._computePromise.then(e=>{this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null},it)}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map(i=>({range:{startLineNumber:i.colorInfo.range.startLineNumber,startColumn:i.colorInfo.range.startColumn,endLineNumber:i.colorInfo.range.endLineNumber,endColumn:i.colorInfo.range.endColumn},options:bt.EMPTY}));this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((i,r)=>this._colorDatas.set(i,e[r]))}updateColorDecorators(e){let t=[],i={};for(let r=0;r<e.length&&t.length<D9e;r++){const{red:s,green:o,blue:a,alpha:l}=e[r].colorInfo.color,c=new ht(Math.round(s*255),Math.round(o*255),Math.round(a*255),l);let h=bLe(`rgba(${c.r},${c.g},${c.b},${c.a})`).toString(16),u=`rgba(${c.r}, ${c.g}, ${c.b}, ${c.a})`,d="colorBox-"+h;!this._decorationsTypes.has(d)&&!i[d]&&this._codeEditorService.registerDecorationType("color-detector-color",d,{before:{contentText:" ",border:"solid 0.1em #000",margin:"0.1em 0.2em 0 0.2em",width:"0.8em",height:"0.8em",backgroundColor:u},dark:{before:{border:"solid 0.1em #eee"}}},void 0,this._editor),i[d]=!0,t.push({range:{startLineNumber:e[r].colorInfo.range.startLineNumber,startColumn:e[r].colorInfo.range.startColumn,endLineNumber:e[r].colorInfo.range.endLineNumber,endColumn:e[r].colorInfo.range.endColumn},options:this._codeEditorService.resolveDecorationOptions(d,!0)})}this._decorationsTypes.forEach(r=>{i[r]||this._codeEditorService.removeDecorationType(r)}),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,t)}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,[]),this._decorationsTypes.forEach(e=>{this._codeEditorService.removeDecorationType(e)})}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(V.fromPositions(e,e)).filter(r=>this._colorDatas.has(r.id));return i.length===0?null:this._colorDatas.get(i[0].id)}};yg.ID="editor.contrib.colorDetector";yg.RECOMPUTE_TIME=1e3;yg=E9e([RH(1,ui),RH(2,Zi)],yg);Yr(yg.ID,yg);class k9e{constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new H,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new H,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new H,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){for(let i=0;i<this.colorPresentations.length;i++)if(t.toLowerCase()===this.colorPresentations[i].label){this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation);break}}flushColor(){this._onColorFlushed.fire(this._color)}}const Aa=me;class L9e extends re{constructor(e,t,i){super(),this.model=t,this.domNode=Aa(".colorpicker-header"),le(e,this.domNode),this.pickedColorNode=le(this.domNode,Aa(".picked-color"));const r=v("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this.pickedColorNode.setAttribute("title",r);const s=le(this.domNode,Aa(".original-color"));s.style.backgroundColor=X.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(Iw)||X.white,this._register(li((o,a)=>{this.backgroundColor=o.getColor(Iw)||X.white})),this._register(ae(this.pickedColorNode,Me.CLICK,()=>this.model.selectNextColorPresentation())),this._register(ae(s,Me.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=X.Format.CSS.format(t.color)||"",this.pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter())}onDidChangeColor(e){this.pickedColorNode.style.backgroundColor=X.Format.CSS.format(e)||"",this.pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:"",this.pickedColorNode.prepend(Aa(".codicon.codicon-color-mode"))}}class I9e extends re{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this.domNode=Aa(".colorpicker-body"),le(e,this.domNode),this.saturationBox=new T9e(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new A9e(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new N9e(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new X(new $l(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new X(new $l(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=(1-e)*360;this.model.color=new X(new $l(i===360?0:i,t.s,t.v,t.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}}class T9e extends re{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new H,this.onColorFlushed=this._onColorFlushed.event,this.domNode=Aa(".saturation-wrap"),le(e,this.domNode),this.canvas=document.createElement("canvas"),this.canvas.className="saturation-box",le(this.domNode,this.canvas),this.selection=Aa(".saturation-selection"),le(this.domNode,this.selection),this.layout(),this._register(I3(this.domNode,r=>this.onMouseDown(r))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new Ug);const t=jn(this.domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.buttons,S0,r=>this.onDidChangePosition(r.posx-t.left,r.posy-t.top),()=>null);const i=CQ(document,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),r=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,r),this._onDidChange.fire({s:i,v:r})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new X(new $l(e.h,1,1,1)),i=this.canvas.getContext("2d"),r=i.createLinearGradient(0,0,this.canvas.width,0);r.addColorStop(0,"rgba(255, 255, 255, 1)"),r.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),r.addColorStop(1,"rgba(255, 255, 255, 0)");const s=i.createLinearGradient(0,0,0,this.canvas.height);s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this.canvas.width,this.canvas.height),i.fillStyle=X.Format.CSS.format(t),i.fill(),i.fillStyle=r,i.fill(),i.fillStyle=s,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class fne extends re{constructor(e,t){super(),this.model=t,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new H,this.onColorFlushed=this._onColorFlushed.event,this.domNode=le(e,Aa(".strip")),this.overlay=le(this.domNode,Aa(".overlay")),this.slider=le(this.domNode,Aa(".slider")),this.slider.style.top="0px",this._register(I3(this.domNode,i=>this.onMouseDown(i))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onMouseDown(e){const t=this._register(new Ug),i=jn(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.buttons,S0,s=>this.onDidChangeTop(s.posy-i.top),()=>null);const r=CQ(document,()=>{this._onColorFlushed.fire(),r.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class A9e extends fne{constructor(e,t){super(e,t),this.domNode.classList.add("opacity-strip"),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){const{r:t,g:i,b:r}=e.rgba,s=new X(new ht(t,i,r,1)),o=new X(new ht(t,i,r,0));this.overlay.style.background=`linear-gradient(to bottom, ${s} 0%, ${o} 100%)`}getValue(e){return e.hsva.a}}class N9e extends fne{constructor(e,t){super(e,t),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class R9e extends bo{constructor(e,t,i,r){super(),this.model=t,this.pixelRatio=i,this._register(mQ(()=>this.layout()));const s=Aa(".colorpicker-widget");e.appendChild(s);const o=new L9e(s,this.model,r);this.body=new I9e(s,this.model,this.pixelRatio),this._register(o),this._register(this.body)}layout(){this.body.layout()}}var M9e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},F9e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},MH=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class O9e{constructor(e,t,i,r){this.owner=e,this.range=t,this.model=i,this.provider=r,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let MO=class{constructor(e,t,i){this._editor=e,this._hover=t,this._themeService=i}computeSync(e,t){return[]}computeAsync(e,t,i){return MH(this,void 0,void 0,function*(){if(!this._editor.hasModel())return[];const r=yg.get(this._editor);for(const s of t){if(s.options.description!=="color-detector-color")continue;const o=r.getColorData(s.range.getStartPosition());if(o)return[yield this._createColorHover(this._editor.getModel(),o.colorInfo,o.provider)]}return[]})}_createColorHover(e,t,i){return MH(this,void 0,void 0,function*(){const r=e.getValueInRange(t.range),{red:s,green:o,blue:a,alpha:l}=t.color,c=new ht(Math.round(s*255),Math.round(o*255),Math.round(a*255),l),h=new X(c),u=yield NH(e,t,i,ai.None),d=new k9e(h,[],0);return d.colorPresentations=u||[],d.guessColorPresentation(h,r),new O9e(this,V.lift(t.range),d,i)})}renderHoverParts(e,t,i){if(e.length===0||!this._editor.hasModel())return re.None;const r=new ve,s=e[0],o=this._editor.getModel(),a=s.model,l=r.add(new R9e(t,a,this._editor.getOption(127),this._themeService));let c=new V(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn);const h=()=>{let d,f;if(a.presentation.textEdit){d=[a.presentation.textEdit],f=new V(a.presentation.textEdit.range.startLineNumber,a.presentation.textEdit.range.startColumn,a.presentation.textEdit.range.endLineNumber,a.presentation.textEdit.range.endColumn);const g=this._editor.getModel()._setTrackedRange(null,f,3);this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",d),f=this._editor.getModel()._getTrackedRange(g)||f}else d=[{identifier:null,range:c,text:a.presentation.label,forceMoveMarkers:!1}],f=c.setEndPosition(c.endLineNumber,c.startColumn+a.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",d);a.presentation.additionalTextEdits&&(d=[...a.presentation.additionalTextEdits],this._editor.executeEdits("colorpicker",d),this._hover.hide()),this._editor.pushUndoStop(),c=f},u=d=>NH(o,{range:c,color:{red:d.rgba.r/255,green:d.rgba.g/255,blue:d.rgba.b/255,alpha:d.rgba.a}},s.provider,ai.None).then(f=>{a.colorPresentations=f||[]});return r.add(a.onColorFlushed(d=>{u(d).then(h)})),r.add(a.onDidChangeColor(u)),this._hover.setColorPicker(l),r}};MO=M9e([F9e(2,fi)],MO);class gne{constructor(e,t,i,r,s){this._computer=e,this._state=0,this._hoverTime=s,this._firstWaitScheduler=new yi(()=>this._triggerAsyncComputation(),0),this._secondWaitScheduler=new yi(()=>this._triggerSyncComputation(),0),this._loadingMessageScheduler=new yi(()=>this._showLoadingMessage(),0),this._asyncComputationPromise=null,this._asyncComputationPromiseDone=!1,this._completeCallback=t,this._errorCallback=i,this._progressCallback=r}setHoverTime(e){this._hoverTime=e}_firstWaitTime(){return this._hoverTime/2}_secondWaitTime(){return this._hoverTime/2}_loadingMessageTime(){return 3*this._hoverTime}_triggerAsyncComputation(){this._state=2,this._secondWaitScheduler.schedule(this._secondWaitTime()),this._computer.computeAsync?(this._asyncComputationPromiseDone=!1,this._asyncComputationPromise=Hs(e=>this._computer.computeAsync(e)),this._asyncComputationPromise.then(e=>{this._asyncComputationPromiseDone=!0,this._withAsyncResult(e)},e=>this._onError(e))):this._asyncComputationPromiseDone=!0}_triggerSyncComputation(){this._computer.computeSync&&this._computer.onResult(this._computer.computeSync(),!0),this._asyncComputationPromiseDone?(this._state=0,this._onComplete(this._computer.getResult())):(this._state=3,this._onProgress(this._computer.getResult()))}_showLoadingMessage(){this._state===3&&this._onProgress(this._computer.getResultWithLoadingMessage())}_withAsyncResult(e){e&&this._computer.onResult(e,!1),this._state===3&&(this._state=0,this._onComplete(this._computer.getResult()))}_onComplete(e){this._completeCallback(e)}_onError(e){this._errorCallback?this._errorCallback(e):it(e)}_onProgress(e){this._progressCallback(e)}start(e){if(e===0)this._state===0&&(this._state=1,this._firstWaitScheduler.schedule(this._firstWaitTime()),this._loadingMessageScheduler.schedule(this._loadingMessageTime()));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._loadingMessageScheduler.cancel(),this._state===1&&this._firstWaitScheduler.cancel(),this._state===2&&(this._secondWaitScheduler.cancel(),this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null)),this._state===3&&this._asyncComputationPromise&&(this._asyncComputationPromise.cancel(),this._asyncComputationPromise=null),this._state=0}}class FH{constructor(e,t){this.priority=e,this.range=t,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}class FA{constructor(e,t,i){this.priority=e,this.owner=t,this.range=i,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}}/*! @license DOMPurify 2.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.1/LICENSE */function P9e(n){if(Array.isArray(n)){for(var e=0,t=Array(n.length);e<n.length;e++)t[e]=n[e];return t}else return Array.from(n)}var B9e=Object.hasOwnProperty,OH=Object.setPrototypeOf,V9e=Object.isFrozen,W9e=Object.getPrototypeOf,$9e=Object.getOwnPropertyDescriptor,ds=Object.freeze,Eh=Object.seal,z9e=Object.create,pne=typeof Reflect<"u"&&Reflect,RD=pne.apply,FO=pne.construct;RD||(RD=function(e,t,i){return e.apply(t,i)});ds||(ds=function(e){return e});Eh||(Eh=function(e){return e});FO||(FO=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(P9e(t))))});var H9e=Xa(Array.prototype.forEach),PH=Xa(Array.prototype.pop),ab=Xa(Array.prototype.push),Pd=Xa(String.prototype.toLowerCase),BH=Xa(String.prototype.match),$h=Xa(String.prototype.replace),U9e=Xa(String.prototype.indexOf),j9e=Xa(String.prototype.trim),Rc=Xa(RegExp.prototype.test),VH=q9e(TypeError);function Xa(n){return function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return RD(n,e,i)}}function q9e(n){return function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return FO(n,t)}}function Nt(n,e){OH&&OH(n,null);for(var t=e.length;t--;){var i=e[t];if(typeof i=="string"){var r=Pd(i);r!==i&&(V9e(e)||(e[t]=r),i=r)}n[i]=!0}return n}function Ad(n){var e=z9e(null),t=void 0;for(t in n)RD(B9e,n,[t])&&(e[t]=n[t]);return e}function iS(n,e){for(;n!==null;){var t=$9e(n,e);if(t){if(t.get)return Xa(t.get);if(typeof t.value=="function")return Xa(t.value)}n=W9e(n)}function i(r){return console.warn("fallback value for",r),null}return i}var WH=ds(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),OA=ds(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),PA=ds(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),G9e=ds(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),BA=ds(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),K9e=ds(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$H=ds(["#text"]),zH=ds(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),VA=ds(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),HH=ds(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),nS=ds(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Z9e=Eh(/\{\{[\s\S]*|[\s\S]*\}\}/gm),Y9e=Eh(/<%[\s\S]*|[\s\S]*%>/gm),X9e=Eh(/^data-[\-\w.\u00B7-\uFFFF]/),Q9e=Eh(/^aria-[\-\w]+$/),J9e=Eh(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eVe=Eh(/^(?:\w+script|data):/i),tVe=Eh(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function bl(n){if(Array.isArray(n)){for(var e=0,t=Array(n.length);e<n.length;e++)t[e]=n[e];return t}else return Array.from(n)}var iVe=function(){return typeof window>"u"?null:window},nVe=function(e,t){if((typeof e>"u"?"undefined":Tb(e))!=="object"||typeof e.createPolicy!="function")return null;var i=null,r="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(r)&&(i=t.currentScript.getAttribute(r));var s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function mne(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iVe(),e=function(A){return mne(A)};if(e.version="2.3.1",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,i=n.document,r=n.DocumentFragment,s=n.HTMLTemplateElement,o=n.Node,a=n.Element,l=n.NodeFilter,c=n.NamedNodeMap,h=c===void 0?n.NamedNodeMap||n.MozNamedAttrMap:c,u=n.Text,d=n.Comment,f=n.DOMParser,g=n.trustedTypes,p=a.prototype,m=iS(p,"cloneNode"),b=iS(p,"nextSibling"),_=iS(p,"childNodes"),w=iS(p,"parentNode");if(typeof s=="function"){var y=i.createElement("template");y.content&&y.content.ownerDocument&&(i=y.content.ownerDocument)}var S=nVe(g,t),k=S&&fn?S.createHTML(""):"",C=i,D=C.implementation,E=C.createNodeIterator,N=C.createDocumentFragment,T=C.getElementsByTagName,j=t.importNode,q={};try{q=Ad(i).documentMode?i.documentMode:{}}catch{}var ie={};e.isSupported=typeof w=="function"&&D&&typeof D.createHTMLDocument<"u"&&q!==9;var ge=Z9e,be=Y9e,Se=X9e,Le=Q9e,ke=eVe,Lt=tVe,Ge=J9e,Je=null,Ct=Nt({},[].concat(bl(WH),bl(OA),bl(PA),bl(BA),bl($H))),ut=null,Ai=Nt({},[].concat(bl(zH),bl(VA),bl(HH),bl(nS))),te=null,ee=null,pe=!0,se=!0,De=!1,O=!1,I=!1,ue=!1,_e=!1,at=!1,ze=!1,lt=!0,fn=!1,Us=!0,Qr=!0,kr=!1,Wi={},Vn=null,Lr=Nt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Nn=null,Ir=Nt({},["audio","video","img","source","image","track"]),R=null,x=Nt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),L="http://www.w3.org/1998/Math/MathML",$="http://www.w3.org/2000/svg",K="http://www.w3.org/1999/xhtml",ne=K,fe=!1,tt=null,Zt=i.createElement("form"),Ht=function(A){tt&&tt===A||((!A||(typeof A>"u"?"undefined":Tb(A))!=="object")&&(A={}),A=Ad(A),Je="ALLOWED_TAGS"in A?Nt({},A.ALLOWED_TAGS):Ct,ut="ALLOWED_ATTR"in A?Nt({},A.ALLOWED_ATTR):Ai,R="ADD_URI_SAFE_ATTR"in A?Nt(Ad(x),A.ADD_URI_SAFE_ATTR):x,Nn="ADD_DATA_URI_TAGS"in A?Nt(Ad(Ir),A.ADD_DATA_URI_TAGS):Ir,Vn="FORBID_CONTENTS"in A?Nt({},A.FORBID_CONTENTS):Lr,te="FORBID_TAGS"in A?Nt({},A.FORBID_TAGS):{},ee="FORBID_ATTR"in A?Nt({},A.FORBID_ATTR):{},Wi="USE_PROFILES"in A?A.USE_PROFILES:!1,pe=A.ALLOW_ARIA_ATTR!==!1,se=A.ALLOW_DATA_ATTR!==!1,De=A.ALLOW_UNKNOWN_PROTOCOLS||!1,O=A.SAFE_FOR_TEMPLATES||!1,I=A.WHOLE_DOCUMENT||!1,at=A.RETURN_DOM||!1,ze=A.RETURN_DOM_FRAGMENT||!1,lt=A.RETURN_DOM_IMPORT!==!1,fn=A.RETURN_TRUSTED_TYPE||!1,_e=A.FORCE_BODY||!1,Us=A.SANITIZE_DOM!==!1,Qr=A.KEEP_CONTENT!==!1,kr=A.IN_PLACE||!1,Ge=A.ALLOWED_URI_REGEXP||Ge,ne=A.NAMESPACE||K,O&&(se=!1),ze&&(at=!0),Wi&&(Je=Nt({},[].concat(bl($H))),ut=[],Wi.html===!0&&(Nt(Je,WH),Nt(ut,zH)),Wi.svg===!0&&(Nt(Je,OA),Nt(ut,VA),Nt(ut,nS)),Wi.svgFilters===!0&&(Nt(Je,PA),Nt(ut,VA),Nt(ut,nS)),Wi.mathMl===!0&&(Nt(Je,BA),Nt(ut,HH),Nt(ut,nS))),A.ADD_TAGS&&(Je===Ct&&(Je=Ad(Je)),Nt(Je,A.ADD_TAGS)),A.ADD_ATTR&&(ut===Ai&&(ut=Ad(ut)),Nt(ut,A.ADD_ATTR)),A.ADD_URI_SAFE_ATTR&&Nt(R,A.ADD_URI_SAFE_ATTR),A.FORBID_CONTENTS&&(Vn===Lr&&(Vn=Ad(Vn)),Nt(Vn,A.FORBID_CONTENTS)),Qr&&(Je["#text"]=!0),I&&Nt(Je,["html","head","body"]),Je.table&&(Nt(Je,["tbody"]),delete te.tbody),ds&&ds(A),tt=A)},ci=Nt({},["mi","mo","mn","ms","mtext"]),Bt=Nt({},["foreignobject","desc","title","annotation-xml"]),vc=Nt({},OA);Nt(vc,PA),Nt(vc,G9e);var cl=Nt({},BA);Nt(cl,K9e);var ip=function(A){var U=w(A);(!U||!U.tagName)&&(U={namespaceURI:K,tagName:"template"});var J=Pd(A.tagName),oe=Pd(U.tagName);if(A.namespaceURI===$)return U.namespaceURI===K?J==="svg":U.namespaceURI===L?J==="svg"&&(oe==="annotation-xml"||ci[oe]):!!vc[J];if(A.namespaceURI===L)return U.namespaceURI===K?J==="math":U.namespaceURI===$?J==="math"&&Bt[oe]:!!cl[J];if(A.namespaceURI===K){if(U.namespaceURI===$&&!Bt[oe]||U.namespaceURI===L&&!ci[oe])return!1;var Ee=Nt({},["title","style","font","a","script"]);return!cl[J]&&(Ee[J]||!vc[J])}return!1},Jr=function(A){ab(e.removed,{element:A});try{A.parentNode.removeChild(A)}catch{try{A.outerHTML=k}catch{A.remove()}}},md=function(A,U){try{ab(e.removed,{attribute:U.getAttributeNode(A),from:U})}catch{ab(e.removed,{attribute:null,from:U})}if(U.removeAttribute(A),A==="is"&&!ut[A])if(at||ze)try{Jr(U)}catch{}else try{U.setAttribute(A,"")}catch{}},np=function(A){var U=void 0,J=void 0;if(_e)A="<remove></remove>"+A;else{var oe=BH(A,/^[\r\n\t ]+/);J=oe&&oe[0]}var Ee=S?S.createHTML(A):A;if(ne===K)try{U=new f().parseFromString(Ee,"text/html")}catch{}if(!U||!U.documentElement){U=D.createDocument(ne,"template",null);try{U.documentElement.innerHTML=fe?"":Ee}catch{}}var He=U.body||U.documentElement;return A&&J&&He.insertBefore(i.createTextNode(J),He.childNodes[0]||null),ne===K?T.call(U,I?"html":"body")[0]:I?U.documentElement:He},rp=function(A){return E.call(A.ownerDocument||A,A,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},gt=function(A){return A instanceof u||A instanceof d?!1:typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof h)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"},hl=function(A){return(typeof o>"u"?"undefined":Tb(o))==="object"?A instanceof o:A&&(typeof A>"u"?"undefined":Tb(A))==="object"&&typeof A.nodeType=="number"&&typeof A.nodeName=="string"},M=function(A,U,J){ie[A]&&H9e(ie[A],function(oe){oe.call(e,U,J,tt)})},Y=function(A){var U=void 0;if(M("beforeSanitizeElements",A,null),gt(A)||BH(A.nodeName,/[\u0080-\uFFFF]/))return Jr(A),!0;var J=Pd(A.nodeName);if(M("uponSanitizeElement",A,{tagName:J,allowedTags:Je}),!hl(A.firstElementChild)&&(!hl(A.content)||!hl(A.content.firstElementChild))&&Rc(/<[/\w]/g,A.innerHTML)&&Rc(/<[/\w]/g,A.textContent)||J==="select"&&Rc(/<template/i,A.innerHTML))return Jr(A),!0;if(!Je[J]||te[J]){if(Qr&&!Vn[J]){var oe=w(A)||A.parentNode,Ee=_(A)||A.childNodes;if(Ee&&oe)for(var He=Ee.length,Ke=He-1;Ke>=0;--Ke)oe.insertBefore(m(Ee[Ke],!0),b(A))}return Jr(A),!0}return A instanceof a&&!ip(A)||(J==="noscript"||J==="noembed")&&Rc(/<\/no(script|embed)/i,A.innerHTML)?(Jr(A),!0):(O&&A.nodeType===3&&(U=A.textContent,U=$h(U,ge," "),U=$h(U,be," "),A.textContent!==U&&(ab(e.removed,{element:A.cloneNode()}),A.textContent=U)),M("afterSanitizeElements",A,null),!1)},Q=function(A,U,J){if(Us&&(U==="id"||U==="name")&&(J in i||J in Zt))return!1;if(!(se&&!ee[U]&&Rc(Se,U))){if(!(pe&&Rc(Le,U))){if(!ut[U]||ee[U])return!1;if(!R[U]){if(!Rc(Ge,$h(J,Lt,""))){if(!((U==="src"||U==="xlink:href"||U==="href")&&A!=="script"&&U9e(J,"data:")===0&&Nn[A])){if(!(De&&!Rc(ke,$h(J,Lt,"")))){if(J)return!1}}}}}}return!0},F=function(A){var U=void 0,J=void 0,oe=void 0,Ee=void 0;M("beforeSanitizeAttributes",A,null);var He=A.attributes;if(He){var Ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ut};for(Ee=He.length;Ee--;){U=He[Ee];var et=U,we=et.name,Ve=et.namespaceURI;if(J=j9e(U.value),oe=Pd(we),Ke.attrName=oe,Ke.attrValue=J,Ke.keepAttr=!0,Ke.forceKeepAttr=void 0,M("uponSanitizeAttribute",A,Ke),J=Ke.attrValue,!Ke.forceKeepAttr&&(md(we,A),!!Ke.keepAttr)){if(Rc(/\/>/i,J)){md(we,A);continue}O&&(J=$h(J,ge," "),J=$h(J,be," "));var Xi=A.nodeName.toLowerCase();if(Q(Xi,oe,J))try{Ve?A.setAttributeNS(Ve,we,J):A.setAttribute(we,J),PH(e.removed)}catch{}}}M("afterSanitizeAttributes",A,null)}},W=function P(A){var U=void 0,J=rp(A);for(M("beforeSanitizeShadowDOM",A,null);U=J.nextNode();)M("uponSanitizeShadowNode",U,null),!Y(U)&&(U.content instanceof r&&P(U.content),F(U));M("afterSanitizeShadowDOM",A,null)};return e.sanitize=function(P,A){var U=void 0,J=void 0,oe=void 0,Ee=void 0,He=void 0;if(fe=!P,fe&&(P="<!-->"),typeof P!="string"&&!hl(P)){if(typeof P.toString!="function")throw VH("toString is not a function");if(P=P.toString(),typeof P!="string")throw VH("dirty is not a string, aborting")}if(!e.isSupported){if(Tb(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof P=="string")return n.toStaticHTML(P);if(hl(P))return n.toStaticHTML(P.outerHTML)}return P}if(ue||Ht(A),e.removed=[],typeof P=="string"&&(kr=!1),!kr)if(P instanceof o)U=np("<!---->"),J=U.ownerDocument.importNode(P,!0),J.nodeType===1&&J.nodeName==="BODY"||J.nodeName==="HTML"?U=J:U.appendChild(J);else{if(!at&&!O&&!I&&P.indexOf("<")===-1)return S&&fn?S.createHTML(P):P;if(U=np(P),!U)return at?null:k}U&&_e&&Jr(U.firstChild);for(var Ke=rp(kr?P:U);oe=Ke.nextNode();)oe.nodeType===3&&oe===Ee||Y(oe)||(oe.content instanceof r&&W(oe.content),F(oe),Ee=oe);if(Ee=null,kr)return P;if(at){if(ze)for(He=N.call(U.ownerDocument);U.firstChild;)He.appendChild(U.firstChild);else He=U;return lt&&(He=j.call(t,He,!0)),He}var et=I?U.outerHTML:U.innerHTML;return O&&(et=$h(et,ge," "),et=$h(et,be," ")),S&&fn?S.createHTML(et):et},e.setConfig=function(P){Ht(P),ue=!0},e.clearConfig=function(){tt=null,ue=!1},e.isValidAttribute=function(P,A,U){tt||Ht({});var J=Pd(P),oe=Pd(A);return Q(J,oe,U)},e.addHook=function(P,A){typeof A=="function"&&(ie[P]=ie[P]||[],ab(ie[P],A))},e.removeHook=function(P){ie[P]&&PH(ie[P])},e.removeHooks=function(P){ie[P]&&(ie[P]=[])},e.removeAllHooks=function(){ie={}},e}var _c=mne();_c.version;_c.isSupported;const rVe=_c.sanitize;_c.setConfig;_c.clearConfig;_c.isValidAttribute;const UH=_c.addHook,jH=_c.removeHook;_c.removeHooks;_c.removeAllHooks;let bc;(function(){function n(e){bc=e()}n.amd=!0,function(e,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof n=="function"&&n.amd?n(t):(e=typeof globalThis<"u"?globalThis:e||self,e.marked=t())}(this,function(){function e(M,Y){for(var Q=0;Q<Y.length;Q++){var F=Y[Q];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(M,F.key,F)}}function t(M,Y,Q){return Y&&e(M.prototype,Y),Q&&e(M,Q),M}function i(M,Y){if(M){if(typeof M=="string")return r(M,Y);var Q=Object.prototype.toString.call(M).slice(8,-1);if(Q==="Object"&&M.constructor&&(Q=M.constructor.name),Q==="Map"||Q==="Set")return Array.from(M);if(Q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q))return r(M,Y)}}function r(M,Y){(Y==null||Y>M.length)&&(Y=M.length);for(var Q=0,F=new Array(Y);Q<Y;Q++)F[Q]=M[Q];return F}function s(M,Y){var Q=typeof Symbol<"u"&&M[Symbol.iterator]||M["@@iterator"];if(Q)return(Q=Q.call(M)).next.bind(Q);if(Array.isArray(M)||(Q=i(M))||Y&&M&&typeof M.length=="number"){Q&&(M=Q);var F=0;return function(){return F>=M.length?{done:!0}:{done:!1,value:M[F++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o={exports:{}};function a(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function l(M){o.exports.defaults=M}o.exports={defaults:a(),getDefaults:a,changeDefaults:l};var c=/[&<>"']/,h=/[&<>"']/g,u=/[<>"']|&(?!#?\w+;)/,d=/[<>"']|&(?!#?\w+;)/g,f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},g=function(Y){return f[Y]};function p(M,Y){if(Y){if(c.test(M))return M.replace(h,g)}else if(u.test(M))return M.replace(d,g);return M}var m=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function b(M){return M.replace(m,function(Y,Q){return Q=Q.toLowerCase(),Q==="colon"?":":Q.charAt(0)==="#"?Q.charAt(1)==="x"?String.fromCharCode(parseInt(Q.substring(2),16)):String.fromCharCode(+Q.substring(1)):""})}var _=/(^|[^\[])\^/g;function w(M,Y){M=M.source||M,Y=Y||"";var Q={replace:function(W,P){return P=P.source||P,P=P.replace(_,"$1"),M=M.replace(W,P),Q},getRegex:function(){return new RegExp(M,Y)}};return Q}var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function k(M,Y,Q){if(M){var F;try{F=decodeURIComponent(b(Q)).replace(y,"").toLowerCase()}catch{return null}if(F.indexOf("javascript:")===0||F.indexOf("vbscript:")===0||F.indexOf("data:")===0)return null}Y&&!S.test(Q)&&(Q=T(Y,Q));try{Q=encodeURI(Q).replace(/%25/g,"%")}catch{return null}return Q}var C={},D=/^[^:]+:\/*[^/]*$/,E=/^([^:]+:)[\s\S]*$/,N=/^([^:]+:\/*[^/]*)[\s\S]*$/;function T(M,Y){C[" "+M]||(D.test(M)?C[" "+M]=M+"/":C[" "+M]=ge(M,"/",!0)),M=C[" "+M];var Q=M.indexOf(":")===-1;return Y.substring(0,2)==="//"?Q?Y:M.replace(E,"$1")+Y:Y.charAt(0)==="/"?Q?Y:M.replace(N,"$1")+Y:M+Y}var j={exec:function(){}};function q(M){for(var Y=1,Q,F;Y<arguments.length;Y++){Q=arguments[Y];for(F in Q)Object.prototype.hasOwnProperty.call(Q,F)&&(M[F]=Q[F])}return M}function ie(M,Y){var Q=M.replace(/\|/g,function(P,A,U){for(var J=!1,oe=A;--oe>=0&&U[oe]==="\\";)J=!J;return J?"|":" |"}),F=Q.split(/ \|/),W=0;if(F[0].trim()||F.shift(),F[F.length-1].trim()||F.pop(),F.length>Y)F.splice(Y);else for(;F.length<Y;)F.push("");for(;W<F.length;W++)F[W]=F[W].trim().replace(/\\\|/g,"|");return F}function ge(M,Y,Q){var F=M.length;if(F===0)return"";for(var W=0;W<F;){var P=M.charAt(F-W-1);if(P===Y&&!Q)W++;else if(P!==Y&&Q)W++;else break}return M.substr(0,F-W)}function be(M,Y){if(M.indexOf(Y[1])===-1)return-1;for(var Q=M.length,F=0,W=0;W<Q;W++)if(M[W]==="\\")W++;else if(M[W]===Y[0])F++;else if(M[W]===Y[1]&&(F--,F<0))return W;return-1}function Se(M){M&&M.sanitize&&!M.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function Le(M,Y){if(Y<1)return"";for(var Q="";Y>1;)Y&1&&(Q+=M),Y>>=1,M+=M;return Q+M}var ke={escape:p,unescape:b,edit:w,cleanUrl:k,resolveUrl:T,noopTest:j,merge:q,splitCells:ie,rtrim:ge,findClosingBracket:be,checkSanitizeDeprecation:Se,repeatString:Le},Lt=o.exports.defaults,Ge=ke.rtrim,Je=ke.splitCells,Ct=ke.escape,ut=ke.findClosingBracket;function Ai(M,Y,Q,F){var W=Y.href,P=Y.title?Ct(Y.title):null,A=M[1].replace(/\\([\[\]])/g,"$1");if(M[0].charAt(0)!=="!"){F.state.inLink=!0;var U={type:"link",raw:Q,href:W,title:P,text:A,tokens:F.inlineTokens(A,[])};return F.state.inLink=!1,U}else return{type:"image",raw:Q,href:W,title:P,text:Ct(A)}}function te(M,Y){var Q=M.match(/^(\s+)(?:```)/);if(Q===null)return Y;var F=Q[1];return Y.split(`
`).map(function(W){var P=W.match(/^\s+/);if(P===null)return W;var A=P[0];return A.length>=F.length?W.slice(F.length):W}).join(`
`)}var ee=function(){function M(Q){this.options=Q||Lt}var Y=M.prototype;return Y.space=function(F){var W=this.rules.block.newline.exec(F);if(W)return W[0].length>1?{type:"space",raw:W[0]}:{raw:`
`}},Y.code=function(F){var W=this.rules.block.code.exec(F);if(W){var P=W[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:W[0],codeBlockStyle:"indented",text:this.options.pedantic?P:Ge(P,`
`)}}},Y.fences=function(F){var W=this.rules.block.fences.exec(F);if(W){var P=W[0],A=te(P,W[3]||"");return{type:"code",raw:P,lang:W[2]?W[2].trim():W[2],text:A}}},Y.heading=function(F){var W=this.rules.block.heading.exec(F);if(W){var P=W[2].trim();if(/#$/.test(P)){var A=Ge(P,"#");(this.options.pedantic||!A||/ $/.test(A))&&(P=A.trim())}var U={type:"heading",raw:W[0],depth:W[1].length,text:P,tokens:[]};return this.lexer.inline(U.text,U.tokens),U}},Y.hr=function(F){var W=this.rules.block.hr.exec(F);if(W)return{type:"hr",raw:W[0]}},Y.blockquote=function(F){var W=this.rules.block.blockquote.exec(F);if(W){var P=W[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:W[0],tokens:this.lexer.blockTokens(P,[]),text:P}}},Y.list=function(F){var W=this.rules.block.list.exec(F);if(W){var P,A,U,J,oe,Ee,He,Ke,et,we,Ve=W[1].trim(),Xi=Ve.length>1,It={type:"list",raw:"",ordered:Xi,start:Xi?+Ve.slice(0,-1):"",loose:!1,items:[]};Ve=Xi?"\\d{1,9}\\"+Ve.slice(-1):"\\"+Ve,this.options.pedantic&&(Ve=Xi?Ve:"[*+-]");for(var Jn=new RegExp("^( {0,3}"+Ve+")((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))");F&&!(this.rules.block.hr.test(F)||!(W=Jn.exec(F)));){et=W[2].split(`
`),this.options.pedantic?(J=2,we=et[0].trimLeft()):(J=W[2].search(/[^ ]/),J=W[1].length+(J>4?1:J),we=et[0].slice(J-W[1].length)),Ee=!1,P=W[0],!et[0]&&/^ *$/.test(et[1])&&(P=W[1]+et.slice(0,2).join(`
`)+`
`,It.loose=!0,et=[]);var wc=new RegExp("^ {0,"+Math.min(3,J-1)+"}(?:[*+-]|\\d{1,9}[.)])");for(oe=1;oe<et.length;oe++){if(Ke=et[oe],this.options.pedantic&&(Ke=Ke.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),wc.test(Ke)){P=W[1]+et.slice(0,oe).join(`
`)+`
`;break}if(!Ee){Ke.trim()||(Ee=!0),Ke.search(/[^ ]/)>=J?we+=`
`+Ke.slice(J):we+=`
`+Ke;continue}if(Ke.search(/[^ ]/)>=J||!Ke.trim()){we+=`
`+Ke.slice(J);continue}else{P=W[1]+et.slice(0,oe).join(`
`)+`
`;break}}It.loose||(He?It.loose=!0:/\n *\n *$/.test(P)&&(He=!0)),this.options.gfm&&(A=/^\[[ xX]\] /.exec(we),A&&(U=A[0]!=="[ ] ",we=we.replace(/^\[[ xX]\] +/,""))),It.items.push({type:"list_item",raw:P,task:!!A,checked:U,loose:!1,text:we}),It.raw+=P,F=F.slice(P.length)}It.items[It.items.length-1].raw=P.trimRight(),It.items[It.items.length-1].text=we.trimRight(),It.raw=It.raw.trimRight();var gn=It.items.length;for(oe=0;oe<gn;oe++)this.lexer.state.top=!1,It.items[oe].tokens=this.lexer.blockTokens(It.items[oe].text,[]),It.items[oe].tokens.some(function(_d){return _d.type==="space"})&&(It.loose=!0,It.items[oe].loose=!0);return It}},Y.html=function(F){var W=this.rules.block.html.exec(F);if(W){var P={type:"html",raw:W[0],pre:!this.options.sanitizer&&(W[1]==="pre"||W[1]==="script"||W[1]==="style"),text:W[0]};return this.options.sanitize&&(P.type="paragraph",P.text=this.options.sanitizer?this.options.sanitizer(W[0]):Ct(W[0]),P.tokens=[],this.lexer.inline(P.text,P.tokens)),P}},Y.def=function(F){var W=this.rules.block.def.exec(F);if(W){W[3]&&(W[3]=W[3].substring(1,W[3].length-1));var P=W[1].toLowerCase().replace(/\s+/g," ");return{type:"def",tag:P,raw:W[0],href:W[2],title:W[3]}}},Y.table=function(F){var W=this.rules.block.table.exec(F);if(W){var P={type:"table",header:Je(W[1]).map(function(He){return{text:He}}),align:W[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:W[3]?W[3].replace(/\n$/,"").split(`
`):[]};if(P.header.length===P.align.length){P.raw=W[0];var A=P.align.length,U,J,oe,Ee;for(U=0;U<A;U++)/^ *-+: *$/.test(P.align[U])?P.align[U]="right":/^ *:-+: *$/.test(P.align[U])?P.align[U]="center":/^ *:-+ *$/.test(P.align[U])?P.align[U]="left":P.align[U]=null;for(A=P.rows.length,U=0;U<A;U++)P.rows[U]=Je(P.rows[U],P.header.length).map(function(He){return{text:He}});for(A=P.header.length,J=0;J<A;J++)P.header[J].tokens=[],this.lexer.inlineTokens(P.header[J].text,P.header[J].tokens);for(A=P.rows.length,J=0;J<A;J++)for(Ee=P.rows[J],oe=0;oe<Ee.length;oe++)Ee[oe].tokens=[],this.lexer.inlineTokens(Ee[oe].text,Ee[oe].tokens);return P}}},Y.lheading=function(F){var W=this.rules.block.lheading.exec(F);if(W){var P={type:"heading",raw:W[0],depth:W[2].charAt(0)==="="?1:2,text:W[1],tokens:[]};return this.lexer.inline(P.text,P.tokens),P}},Y.paragraph=function(F){var W=this.rules.block.paragraph.exec(F);if(W){var P={type:"paragraph",raw:W[0],text:W[1].charAt(W[1].length-1)===`
`?W[1].slice(0,-1):W[1],tokens:[]};return this.lexer.inline(P.text,P.tokens),P}},Y.text=function(F){var W=this.rules.block.text.exec(F);if(W){var P={type:"text",raw:W[0],text:W[0],tokens:[]};return this.lexer.inline(P.text,P.tokens),P}},Y.escape=function(F){var W=this.rules.inline.escape.exec(F);if(W)return{type:"escape",raw:W[0],text:Ct(W[1])}},Y.tag=function(F){var W=this.rules.inline.tag.exec(F);if(W)return!this.lexer.state.inLink&&/^<a /i.test(W[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(W[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(W[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(W[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:W[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(W[0]):Ct(W[0]):W[0]}},Y.link=function(F){var W=this.rules.inline.link.exec(F);if(W){var P=W[2].trim();if(!this.options.pedantic&&/^</.test(P)){if(!/>$/.test(P))return;var A=Ge(P.slice(0,-1),"\\");if((P.length-A.length)%2===0)return}else{var U=ut(W[2],"()");if(U>-1){var J=W[0].indexOf("!")===0?5:4,oe=J+W[1].length+U;W[2]=W[2].substring(0,U),W[0]=W[0].substring(0,oe).trim(),W[3]=""}}var Ee=W[2],He="";if(this.options.pedantic){var Ke=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Ee);Ke&&(Ee=Ke[1],He=Ke[3])}else He=W[3]?W[3].slice(1,-1):"";return Ee=Ee.trim(),/^</.test(Ee)&&(this.options.pedantic&&!/>$/.test(P)?Ee=Ee.slice(1):Ee=Ee.slice(1,-1)),Ai(W,{href:Ee&&Ee.replace(this.rules.inline._escapes,"$1"),title:He&&He.replace(this.rules.inline._escapes,"$1")},W[0],this.lexer)}},Y.reflink=function(F,W){var P;if((P=this.rules.inline.reflink.exec(F))||(P=this.rules.inline.nolink.exec(F))){var A=(P[2]||P[1]).replace(/\s+/g," ");if(A=W[A.toLowerCase()],!A||!A.href){var U=P[0].charAt(0);return{type:"text",raw:U,text:U}}return Ai(P,A,P[0],this.lexer)}},Y.emStrong=function(F,W,P){P===void 0&&(P="");var A=this.rules.inline.emStrong.lDelim.exec(F);if(A&&!(A[3]&&P.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var U=A[1]||A[2]||"";if(!U||U&&(P===""||this.rules.inline.punctuation.exec(P))){var J=A[0].length-1,oe,Ee,He=J,Ke=0,et=A[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(et.lastIndex=0,W=W.slice(-1*F.length+J);(A=et.exec(W))!=null;)if(oe=A[1]||A[2]||A[3]||A[4]||A[5]||A[6],!!oe){if(Ee=oe.length,A[3]||A[4]){He+=Ee;continue}else if((A[5]||A[6])&&J%3&&!((J+Ee)%3)){Ke+=Ee;continue}if(He-=Ee,!(He>0)){if(Ee=Math.min(Ee,Ee+He+Ke),Math.min(J,Ee)%2){var we=F.slice(1,J+A.index+Ee);return{type:"em",raw:F.slice(0,J+A.index+Ee+1),text:we,tokens:this.lexer.inlineTokens(we,[])}}var Ve=F.slice(2,J+A.index+Ee-1);return{type:"strong",raw:F.slice(0,J+A.index+Ee+1),text:Ve,tokens:this.lexer.inlineTokens(Ve,[])}}}}}},Y.codespan=function(F){var W=this.rules.inline.code.exec(F);if(W){var P=W[2].replace(/\n/g," "),A=/[^ ]/.test(P),U=/^ /.test(P)&&/ $/.test(P);return A&&U&&(P=P.substring(1,P.length-1)),P=Ct(P,!0),{type:"codespan",raw:W[0],text:P}}},Y.br=function(F){var W=this.rules.inline.br.exec(F);if(W)return{type:"br",raw:W[0]}},Y.del=function(F){var W=this.rules.inline.del.exec(F);if(W)return{type:"del",raw:W[0],text:W[2],tokens:this.lexer.inlineTokens(W[2],[])}},Y.autolink=function(F,W){var P=this.rules.inline.autolink.exec(F);if(P){var A,U;return P[2]==="@"?(A=Ct(this.options.mangle?W(P[1]):P[1]),U="mailto:"+A):(A=Ct(P[1]),U=A),{type:"link",raw:P[0],text:A,href:U,tokens:[{type:"text",raw:A,text:A}]}}},Y.url=function(F,W){var P;if(P=this.rules.inline.url.exec(F)){var A,U;if(P[2]==="@")A=Ct(this.options.mangle?W(P[0]):P[0]),U="mailto:"+A;else{var J;do J=P[0],P[0]=this.rules.inline._backpedal.exec(P[0])[0];while(J!==P[0]);A=Ct(P[0]),P[1]==="www."?U="http://"+A:U=A}return{type:"link",raw:P[0],text:A,href:U,tokens:[{type:"text",raw:A,text:A}]}}},Y.inlineText=function(F,W){var P=this.rules.inline.text.exec(F);if(P){var A;return this.lexer.state.inRawBlock?A=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(P[0]):Ct(P[0]):P[0]:A=Ct(this.options.smartypants?W(P[0]):P[0]),{type:"text",raw:P[0],text:A}}},M}(),pe=ke.noopTest,se=ke.edit,De=ke.merge,O={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:pe,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};O._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,O._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,O.def=se(O.def).replace("label",O._label).replace("title",O._title).getRegex(),O.bullet=/(?:[*+-]|\d{1,9}[.)])/,O.listItemStart=se(/^( *)(bull) */).replace("bull",O.bullet).getRegex(),O.list=se(O.list).replace(/bull/g,O.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+O.def.source+")").getRegex(),O._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",O._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,O.html=se(O.html,"i").replace("comment",O._comment).replace("tag",O._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),O.paragraph=se(O._paragraph).replace("hr",O.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",O._tag).getRegex(),O.blockquote=se(O.blockquote).replace("paragraph",O.paragraph).getRegex(),O.normal=De({},O),O.gfm=De({},O.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),O.gfm.table=se(O.gfm.table).replace("hr",O.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",O._tag).getRegex(),O.pedantic=De({},O.normal,{html:se(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",O._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:pe,paragraph:se(O.normal._paragraph).replace("hr",O.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",O.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var I={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:pe,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:pe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};I._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",I.punctuation=se(I.punctuation).replace(/punctuation/g,I._punctuation).getRegex(),I.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,I.escapedEmSt=/\\\*|\\_/g,I._comment=se(O._comment).replace("(?:-->|$)","-->").getRegex(),I.emStrong.lDelim=se(I.emStrong.lDelim).replace(/punct/g,I._punctuation).getRegex(),I.emStrong.rDelimAst=se(I.emStrong.rDelimAst,"g").replace(/punct/g,I._punctuation).getRegex(),I.emStrong.rDelimUnd=se(I.emStrong.rDelimUnd,"g").replace(/punct/g,I._punctuation).getRegex(),I._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,I._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,I._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,I.autolink=se(I.autolink).replace("scheme",I._scheme).replace("email",I._email).getRegex(),I._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,I.tag=se(I.tag).replace("comment",I._comment).replace("attribute",I._attribute).getRegex(),I._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,I._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,I._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,I.link=se(I.link).replace("label",I._label).replace("href",I._href).replace("title",I._title).getRegex(),I.reflink=se(I.reflink).replace("label",I._label).getRegex(),I.reflinkSearch=se(I.reflinkSearch,"g").replace("reflink",I.reflink).replace("nolink",I.nolink).getRegex(),I.normal=De({},I),I.pedantic=De({},I.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:se(/^!?\[(label)\]\((.*?)\)/).replace("label",I._label).getRegex(),reflink:se(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",I._label).getRegex()}),I.gfm=De({},I.normal,{escape:se(I.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),I.gfm.url=se(I.gfm.url,"i").replace("email",I.gfm._extended_email).getRegex(),I.breaks=De({},I.gfm,{br:se(I.br).replace("{2,}","*").getRegex(),text:se(I.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var ue={block:O,inline:I},_e=ee,at=o.exports.defaults,ze=ue.block,lt=ue.inline,fn=ke.repeatString;function Us(M){return M.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,"")}function Qr(M){var Y="",Q,F,W=M.length;for(Q=0;Q<W;Q++)F=M.charCodeAt(Q),Math.random()>.5&&(F="x"+F.toString(16)),Y+="&#"+F+";";return Y}var kr=function(){function M(Q){this.tokens=[],this.tokens.links=Object.create(null),this.options=Q||at,this.options.tokenizer=this.options.tokenizer||new _e,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var F={block:ze.normal,inline:lt.normal};this.options.pedantic?(F.block=ze.pedantic,F.inline=lt.pedantic):this.options.gfm&&(F.block=ze.gfm,this.options.breaks?F.inline=lt.breaks:F.inline=lt.gfm),this.tokenizer.rules=F}M.lex=function(F,W){var P=new M(W);return P.lex(F)},M.lexInline=function(F,W){var P=new M(W);return P.inlineTokens(F)};var Y=M.prototype;return Y.lex=function(F){F=F.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(F,this.tokens);for(var W;W=this.inlineQueue.shift();)this.inlineTokens(W.src,W.tokens);return this.tokens},Y.blockTokens=function(F,W){var P=this;W===void 0&&(W=[]),this.options.pedantic&&(F=F.replace(/^ +$/gm,""));for(var A,U,J,oe;F;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(He){return(A=He.call({lexer:P},F,W))?(F=F.substring(A.raw.length),W.push(A),!0):!1}))){if(A=this.tokenizer.space(F)){F=F.substring(A.raw.length),A.type&&W.push(A);continue}if(A=this.tokenizer.code(F)){F=F.substring(A.raw.length),U=W[W.length-1],U&&(U.type==="paragraph"||U.type==="text")?(U.raw+=`
`+A.raw,U.text+=`
`+A.text,this.inlineQueue[this.inlineQueue.length-1].src=U.text):W.push(A);continue}if(A=this.tokenizer.fences(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.heading(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.hr(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.blockquote(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.list(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.html(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.def(F)){F=F.substring(A.raw.length),U=W[W.length-1],U&&(U.type==="paragraph"||U.type==="text")?(U.raw+=`
`+A.raw,U.text+=`
`+A.raw,this.inlineQueue[this.inlineQueue.length-1].src=U.text):this.tokens.links[A.tag]||(this.tokens.links[A.tag]={href:A.href,title:A.title});continue}if(A=this.tokenizer.table(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.lheading(F)){F=F.substring(A.raw.length),W.push(A);continue}if(J=F,this.options.extensions&&this.options.extensions.startBlock&&function(){var He=1/0,Ke=F.slice(1),et=void 0;P.options.extensions.startBlock.forEach(function(we){et=we.call({lexer:this},Ke),typeof et=="number"&&et>=0&&(He=Math.min(He,et))}),He<1/0&&He>=0&&(J=F.substring(0,He+1))}(),this.state.top&&(A=this.tokenizer.paragraph(J))){U=W[W.length-1],oe&&U.type==="paragraph"?(U.raw+=`
`+A.raw,U.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=U.text):W.push(A),oe=J.length!==F.length,F=F.substring(A.raw.length);continue}if(A=this.tokenizer.text(F)){F=F.substring(A.raw.length),U=W[W.length-1],U&&U.type==="text"?(U.raw+=`
`+A.raw,U.text+=`
`+A.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=U.text):W.push(A);continue}if(F){var Ee="Infinite loop on byte: "+F.charCodeAt(0);if(this.options.silent){console.error(Ee);break}else throw new Error(Ee)}}return this.state.top=!0,W},Y.inline=function(F,W){this.inlineQueue.push({src:F,tokens:W})},Y.inlineTokens=function(F,W){var P=this;W===void 0&&(W=[]);var A,U,J,oe=F,Ee,He,Ke;if(this.tokens.links){var et=Object.keys(this.tokens.links);if(et.length>0)for(;(Ee=this.tokenizer.rules.inline.reflinkSearch.exec(oe))!=null;)et.includes(Ee[0].slice(Ee[0].lastIndexOf("[")+1,-1))&&(oe=oe.slice(0,Ee.index)+"["+fn("a",Ee[0].length-2)+"]"+oe.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(Ee=this.tokenizer.rules.inline.blockSkip.exec(oe))!=null;)oe=oe.slice(0,Ee.index)+"["+fn("a",Ee[0].length-2)+"]"+oe.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(Ee=this.tokenizer.rules.inline.escapedEmSt.exec(oe))!=null;)oe=oe.slice(0,Ee.index)+"++"+oe.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;F;)if(He||(Ke=""),He=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Ve){return(A=Ve.call({lexer:P},F,W))?(F=F.substring(A.raw.length),W.push(A),!0):!1}))){if(A=this.tokenizer.escape(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.tag(F)){F=F.substring(A.raw.length),U=W[W.length-1],U&&A.type==="text"&&U.type==="text"?(U.raw+=A.raw,U.text+=A.text):W.push(A);continue}if(A=this.tokenizer.link(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.reflink(F,this.tokens.links)){F=F.substring(A.raw.length),U=W[W.length-1],U&&A.type==="text"&&U.type==="text"?(U.raw+=A.raw,U.text+=A.text):W.push(A);continue}if(A=this.tokenizer.emStrong(F,oe,Ke)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.codespan(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.br(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.del(F)){F=F.substring(A.raw.length),W.push(A);continue}if(A=this.tokenizer.autolink(F,Qr)){F=F.substring(A.raw.length),W.push(A);continue}if(!this.state.inLink&&(A=this.tokenizer.url(F,Qr))){F=F.substring(A.raw.length),W.push(A);continue}if(J=F,this.options.extensions&&this.options.extensions.startInline&&function(){var Ve=1/0,Xi=F.slice(1),It=void 0;P.options.extensions.startInline.forEach(function(Jn){It=Jn.call({lexer:this},Xi),typeof It=="number"&&It>=0&&(Ve=Math.min(Ve,It))}),Ve<1/0&&Ve>=0&&(J=F.substring(0,Ve+1))}(),A=this.tokenizer.inlineText(J,Us)){F=F.substring(A.raw.length),A.raw.slice(-1)!=="_"&&(Ke=A.raw.slice(-1)),He=!0,U=W[W.length-1],U&&U.type==="text"?(U.raw+=A.raw,U.text+=A.text):W.push(A);continue}if(F){var we="Infinite loop on byte: "+F.charCodeAt(0);if(this.options.silent){console.error(we);break}else throw new Error(we)}}return W},t(M,null,[{key:"rules",get:function(){return{block:ze,inline:lt}}}]),M}(),Wi=o.exports.defaults,Vn=ke.cleanUrl,Lr=ke.escape,Nn=function(){function M(Q){this.options=Q||Wi}var Y=M.prototype;return Y.code=function(F,W,P){var A=(W||"").match(/\S*/)[0];if(this.options.highlight){var U=this.options.highlight(F,A);U!=null&&U!==F&&(P=!0,F=U)}return F=F.replace(/\n$/,"")+`
`,A?'<pre><code class="'+this.options.langPrefix+Lr(A,!0)+'">'+(P?F:Lr(F,!0))+`</code></pre>
`:"<pre><code>"+(P?F:Lr(F,!0))+`</code></pre>
`},Y.blockquote=function(F){return`<blockquote>
`+F+`</blockquote>
`},Y.html=function(F){return F},Y.heading=function(F,W,P,A){return this.options.headerIds?"<h"+W+' id="'+this.options.headerPrefix+A.slug(P)+'">'+F+"</h"+W+`>
`:"<h"+W+">"+F+"</h"+W+`>
`},Y.hr=function(){return this.options.xhtml?`<hr/>
`:`<hr>
`},Y.list=function(F,W,P){var A=W?"ol":"ul",U=W&&P!==1?' start="'+P+'"':"";return"<"+A+U+`>
`+F+"</"+A+`>
`},Y.listitem=function(F){return"<li>"+F+`</li>
`},Y.checkbox=function(F){return"<input "+(F?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},Y.paragraph=function(F){return"<p>"+F+`</p>
`},Y.table=function(F,W){return W&&(W="<tbody>"+W+"</tbody>"),`<table>
<thead>
`+F+`</thead>
`+W+`</table>
`},Y.tablerow=function(F){return`<tr>
`+F+`</tr>
`},Y.tablecell=function(F,W){var P=W.header?"th":"td",A=W.align?"<"+P+' align="'+W.align+'">':"<"+P+">";return A+F+"</"+P+`>
`},Y.strong=function(F){return"<strong>"+F+"</strong>"},Y.em=function(F){return"<em>"+F+"</em>"},Y.codespan=function(F){return"<code>"+F+"</code>"},Y.br=function(){return this.options.xhtml?"<br/>":"<br>"},Y.del=function(F){return"<del>"+F+"</del>"},Y.link=function(F,W,P){if(F=Vn(this.options.sanitize,this.options.baseUrl,F),F===null)return P;var A='<a href="'+Lr(F)+'"';return W&&(A+=' title="'+W+'"'),A+=">"+P+"</a>",A},Y.image=function(F,W,P){if(F=Vn(this.options.sanitize,this.options.baseUrl,F),F===null)return P;var A='<img src="'+F+'" alt="'+P+'"';return W&&(A+=' title="'+W+'"'),A+=this.options.xhtml?"/>":">",A},Y.text=function(F){return F},M}(),Ir=function(){function M(){}var Y=M.prototype;return Y.strong=function(F){return F},Y.em=function(F){return F},Y.codespan=function(F){return F},Y.del=function(F){return F},Y.html=function(F){return F},Y.text=function(F){return F},Y.link=function(F,W,P){return""+P},Y.image=function(F,W,P){return""+P},Y.br=function(){return""},M}(),R=function(){function M(){this.seen={}}var Y=M.prototype;return Y.serialize=function(F){return F.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},Y.getNextSafeSlug=function(F,W){var P=F,A=0;if(this.seen.hasOwnProperty(P)){A=this.seen[F];do A++,P=F+"-"+A;while(this.seen.hasOwnProperty(P))}return W||(this.seen[F]=A,this.seen[P]=0),P},Y.slug=function(F,W){W===void 0&&(W={});var P=this.serialize(F);return this.getNextSafeSlug(P,W.dryrun)},M}(),x=Nn,L=Ir,$=R,K=o.exports.defaults,ne=ke.unescape,fe=function(){function M(Q){this.options=Q||K,this.options.renderer=this.options.renderer||new x,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new L,this.slugger=new $}M.parse=function(F,W){var P=new M(W);return P.parse(F)},M.parseInline=function(F,W){var P=new M(W);return P.parseInline(F)};var Y=M.prototype;return Y.parse=function(F,W){W===void 0&&(W=!0);var P="",A,U,J,oe,Ee,He,Ke,et,we,Ve,Xi,It,Jn,wc,gn,_d,Oy,bd,vd,Py=F.length;for(A=0;A<Py;A++){if(Ve=F[A],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ve.type]&&(vd=this.options.extensions.renderers[Ve.type].call({parser:this},Ve),vd!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(Ve.type))){P+=vd||"";continue}switch(Ve.type){case"space":continue;case"hr":{P+=this.renderer.hr();continue}case"heading":{P+=this.renderer.heading(this.parseInline(Ve.tokens),Ve.depth,ne(this.parseInline(Ve.tokens,this.textRenderer)),this.slugger);continue}case"code":{P+=this.renderer.code(Ve.text,Ve.lang,Ve.escaped);continue}case"table":{for(et="",Ke="",oe=Ve.header.length,U=0;U<oe;U++)Ke+=this.renderer.tablecell(this.parseInline(Ve.header[U].tokens),{header:!0,align:Ve.align[U]});for(et+=this.renderer.tablerow(Ke),we="",oe=Ve.rows.length,U=0;U<oe;U++){for(He=Ve.rows[U],Ke="",Ee=He.length,J=0;J<Ee;J++)Ke+=this.renderer.tablecell(this.parseInline(He[J].tokens),{header:!1,align:Ve.align[J]});we+=this.renderer.tablerow(Ke)}P+=this.renderer.table(et,we);continue}case"blockquote":{we=this.parse(Ve.tokens),P+=this.renderer.blockquote(we);continue}case"list":{for(Xi=Ve.ordered,It=Ve.start,Jn=Ve.loose,oe=Ve.items.length,we="",U=0;U<oe;U++)gn=Ve.items[U],_d=gn.checked,Oy=gn.task,wc="",gn.task&&(bd=this.renderer.checkbox(_d),Jn?gn.tokens.length>0&&gn.tokens[0].type==="paragraph"?(gn.tokens[0].text=bd+" "+gn.tokens[0].text,gn.tokens[0].tokens&&gn.tokens[0].tokens.length>0&&gn.tokens[0].tokens[0].type==="text"&&(gn.tokens[0].tokens[0].text=bd+" "+gn.tokens[0].tokens[0].text)):gn.tokens.unshift({type:"text",text:bd}):wc+=bd),wc+=this.parse(gn.tokens,Jn),we+=this.renderer.listitem(wc,Oy,_d);P+=this.renderer.list(we,Xi,It);continue}case"html":{P+=this.renderer.html(Ve.text);continue}case"paragraph":{P+=this.renderer.paragraph(this.parseInline(Ve.tokens));continue}case"text":{for(we=Ve.tokens?this.parseInline(Ve.tokens):Ve.text;A+1<Py&&F[A+1].type==="text";)Ve=F[++A],we+=`
`+(Ve.tokens?this.parseInline(Ve.tokens):Ve.text);P+=W?this.renderer.paragraph(we):we;continue}default:{var sp='Token with "'+Ve.type+'" type was not found.';if(this.options.silent){console.error(sp);return}else throw new Error(sp)}}}return P},Y.parseInline=function(F,W){W=W||this.renderer;var P="",A,U,J,oe=F.length;for(A=0;A<oe;A++){if(U=F[A],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[U.type]&&(J=this.options.extensions.renderers[U.type].call({parser:this},U),J!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(U.type))){P+=J||"";continue}switch(U.type){case"escape":{P+=W.text(U.text);break}case"html":{P+=W.html(U.text);break}case"link":{P+=W.link(U.href,U.title,this.parseInline(U.tokens,W));break}case"image":{P+=W.image(U.href,U.title,U.text);break}case"strong":{P+=W.strong(this.parseInline(U.tokens,W));break}case"em":{P+=W.em(this.parseInline(U.tokens,W));break}case"codespan":{P+=W.codespan(U.text);break}case"br":{P+=W.br();break}case"del":{P+=W.del(this.parseInline(U.tokens,W));break}case"text":{P+=W.text(U.text);break}default:{var Ee='Token with "'+U.type+'" type was not found.';if(this.options.silent){console.error(Ee);return}else throw new Error(Ee)}}}return P},M}(),tt=kr,Zt=fe,Ht=ee,ci=Nn,Bt=Ir,vc=R,cl=ke.merge,ip=ke.checkSanitizeDeprecation,Jr=ke.escape,md=o.exports.getDefaults,np=o.exports.changeDefaults,rp=o.exports.defaults;function gt(M,Y,Q){if(typeof M>"u"||M===null)throw new Error("marked(): input parameter is undefined or null");if(typeof M!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(M)+", string expected");if(typeof Y=="function"&&(Q=Y,Y=null),Y=cl({},gt.defaults,Y||{}),ip(Y),Q){var F=Y.highlight,W;try{W=tt.lex(M,Y)}catch(J){return Q(J)}var P=function(oe){var Ee;if(!oe)try{Y.walkTokens&&gt.walkTokens(W,Y.walkTokens),Ee=Zt.parse(W,Y)}catch(He){oe=He}return Y.highlight=F,oe?Q(oe):Q(null,Ee)};if(!F||F.length<3||(delete Y.highlight,!W.length))return P();var A=0;gt.walkTokens(W,function(J){J.type==="code"&&(A++,setTimeout(function(){F(J.text,J.lang,function(oe,Ee){if(oe)return P(oe);Ee!=null&&Ee!==J.text&&(J.text=Ee,J.escaped=!0),A--,A===0&&P()})},0))}),A===0&&P();return}try{var U=tt.lex(M,Y);return Y.walkTokens&&gt.walkTokens(U,Y.walkTokens),Zt.parse(U,Y)}catch(J){if(J.message+=`
Please report this to https://github.com/markedjs/marked.`,Y.silent)return"<p>An error occurred:</p><pre>"+Jr(J.message+"",!0)+"</pre>";throw J}}gt.options=gt.setOptions=function(M){return cl(gt.defaults,M),np(gt.defaults),gt},gt.getDefaults=md,gt.defaults=rp,gt.use=function(){for(var M=this,Y=arguments.length,Q=new Array(Y),F=0;F<Y;F++)Q[F]=arguments[F];var W=cl.apply(void 0,[{}].concat(Q)),P=gt.defaults.extensions||{renderers:{},childTokens:{}},A;Q.forEach(function(U){if(U.extensions&&(A=!0,U.extensions.forEach(function(oe){if(!oe.name)throw new Error("extension name required");if(oe.renderer){var Ee=P.renderers?P.renderers[oe.name]:null;Ee?P.renderers[oe.name]=function(){for(var He=arguments.length,Ke=new Array(He),et=0;et<He;et++)Ke[et]=arguments[et];var we=oe.renderer.apply(this,Ke);return we===!1&&(we=Ee.apply(this,Ke)),we}:P.renderers[oe.name]=oe.renderer}if(oe.tokenizer){if(!oe.level||oe.level!=="block"&&oe.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");P[oe.level]?P[oe.level].unshift(oe.tokenizer):P[oe.level]=[oe.tokenizer],oe.start&&(oe.level==="block"?P.startBlock?P.startBlock.push(oe.start):P.startBlock=[oe.start]:oe.level==="inline"&&(P.startInline?P.startInline.push(oe.start):P.startInline=[oe.start]))}oe.childTokens&&(P.childTokens[oe.name]=oe.childTokens)})),U.renderer&&function(){var oe=gt.defaults.renderer||new ci,Ee=function(et){var we=oe[et];oe[et]=function(){for(var Ve=arguments.length,Xi=new Array(Ve),It=0;It<Ve;It++)Xi[It]=arguments[It];var Jn=U.renderer[et].apply(oe,Xi);return Jn===!1&&(Jn=we.apply(oe,Xi)),Jn}};for(var He in U.renderer)Ee(He);W.renderer=oe}(),U.tokenizer&&function(){var oe=gt.defaults.tokenizer||new Ht,Ee=function(et){var we=oe[et];oe[et]=function(){for(var Ve=arguments.length,Xi=new Array(Ve),It=0;It<Ve;It++)Xi[It]=arguments[It];var Jn=U.tokenizer[et].apply(oe,Xi);return Jn===!1&&(Jn=we.apply(oe,Xi)),Jn}};for(var He in U.tokenizer)Ee(He);W.tokenizer=oe}(),U.walkTokens){var J=gt.defaults.walkTokens;W.walkTokens=function(oe){U.walkTokens.call(M,oe),J&&J(oe)}}A&&(W.extensions=P),gt.setOptions(W)})},gt.walkTokens=function(M,Y){for(var Q=function(){var A=W.value;switch(Y(A),A.type){case"table":{for(var U=s(A.header),J;!(J=U()).done;){var oe=J.value;gt.walkTokens(oe.tokens,Y)}for(var Ee=s(A.rows),He;!(He=Ee()).done;)for(var Ke=He.value,et=s(Ke),we;!(we=et()).done;){var Ve=we.value;gt.walkTokens(Ve.tokens,Y)}break}case"list":{gt.walkTokens(A.items,Y);break}default:gt.defaults.extensions&&gt.defaults.extensions.childTokens&&gt.defaults.extensions.childTokens[A.type]?gt.defaults.extensions.childTokens[A.type].forEach(function(Xi){gt.walkTokens(A[Xi],Y)}):A.tokens&&gt.walkTokens(A.tokens,Y)}},F=s(M),W;!(W=F()).done;)Q()},gt.parseInline=function(M,Y){if(typeof M>"u"||M===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof M!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(M)+", string expected");Y=cl({},gt.defaults,Y||{}),ip(Y);try{var Q=tt.lexInline(M,Y);return Y.walkTokens&&gt.walkTokens(Q,Y.walkTokens),Zt.parseInline(Q,Y)}catch(F){if(F.message+=`
Please report this to https://github.com/markedjs/marked.`,Y.silent)return"<p>An error occurred:</p><pre>"+Jr(F.message+"",!0)+"</pre>";throw F}},gt.Parser=Zt,gt.parser=Zt.parse,gt.Renderer=ci,gt.TextRenderer=Bt,gt.Lexer=tt,gt.lexer=tt.lex,gt.Tokenizer=Ht,gt.Slugger=vc,gt.parse=gt;var hl=gt;return hl})})();bc.Parser;bc.parser;var sVe=bc.Renderer;bc.TextRenderer;bc.Lexer;bc.lexer;bc.Tokenizer;bc.Slugger;var oVe=bc.parse;function aVe(n,e={},t={}){var i;const r=new ve;let s=!1;const o=r.add(new rl),a=vB(e),l=function(p){let m;try{m=AM(decodeURIComponent(p))}catch{}return m?(m=uLe(m,b=>{if(n.uris&&n.uris[b])return qe.revive(n.uris[b])}),encodeURIComponent(JSON.stringify(m))):p},c=function(p,m){const b=n.uris&&n.uris[p];if(!b)return p;let _=qe.revive(b);return m?p.startsWith(ft.data+":")?p:wQ.asBrowserUri(_).toString(!0):qe.parse(p).toString()===_.toString()?p:(_.query&&(_=_.with({query:l(_.query)})),_.toString())};let h;const u=new Promise(p=>h=p),d=new sVe;if(d.image=(p,m,b)=>{let _=[],w=[];if(p){({href:p,dimensions:_}=M5e(p)),p=c(p,!0);try{const y=qe.parse(p);e.baseUrl&&y.scheme===ft.file&&(p=nW(e.baseUrl,p).toString())}catch{}w.push(`src="${p}"`)}return b&&w.push(`alt="${b}"`),m&&w.push(`title="${m}"`),_.length&&(w=w.concat(_)),"<img "+w.join(" ")+">"},d.link=(p,m,b)=>(p===b&&(b=yA(b)),p=c(p,!1),e.baseUrl&&(/^\w[\w\d+.-]*:/.test(p)||(p=nW(e.baseUrl,p).toString())),m=yA(m),p=yA(p),!p||p.match(/^data:|javascript:/i)||p.match(/^command:/i)&&!n.isTrusted||p.match(/^command:(\/\/\/)?_workbench\.downloadResource/i)?b:(p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="#" data-href="${p}" title="${m||p}">${b}</a>`)),d.paragraph=p=>`<p>${p}</p>`,e.codeBlockRenderer&&(d.code=(p,m)=>{const b=e.codeBlockRenderer(m,p),_=iie.nextId();return bQ(Promise.all([b,u]),o.token).then(w=>{var y;if(!s&&w){const S=a.querySelector(`div[data-code="${_}"]`);S&&gy(S,w[0]),(y=e.asyncRenderCallback)===null||y===void 0||y.call(e)}}).catch(()=>{}),`<div class="code" data-code="${_}">${M3(p)}</div>`}),e.actionHandler){const p=e.actionHandler.disposables.add(new qt(a,"click")),m=e.actionHandler.disposables.add(new qt(a,"auxclick"));e.actionHandler.disposables.add(Re.any(p.event,m.event)(b=>{const _=new oo(b);if(!_.leftButton&&!_.middleButton)return;let w=_.target;if(!(w.tagName!=="A"&&(w=w.parentElement,!w||w.tagName!=="A")))try{const y=w.dataset.href;y&&e.actionHandler.callback(y,_)}catch(y){it(y)}finally{_.preventDefault()}}))}n.supportHtml||(t.sanitizer=p=>(n.isTrusted?p.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?p:"",t.sanitize=!0,t.silent=!0),t.renderer=d;let f=(i=n.value)!==null&&i!==void 0?i:"";f.length>1e5&&(f=`${f.substr(0,1e5)}`),n.supportThemeIcons&&(f=P4e(f));let g=oVe(f,t);if(n.supportThemeIcons&&(g=Wm(g).map(m=>typeof m=="string"?m:m.outerHTML).join("")),a.innerHTML=lVe(n,g),h(),e.asyncRenderCallback)for(const p of a.getElementsByTagName("img")){const m=r.add(ae(p,"load",()=>{m.dispose(),e.asyncRenderCallback()}))}return{element:a,dispose:()=>{s=!0,o.cancel(),r.dispose()}}}function lVe(n,e){const{config:t,allowedSchemes:i}=cVe(n);UH("uponSanitizeAttribute",(s,o)=>{if(o.attrName==="style"||o.attrName==="class"){if(s.tagName==="SPAN"){if(o.attrName==="style"){o.keepAttr=/^(color\:#[0-9a-fA-F]+;)?(background-color\:#[0-9a-fA-F]+;)?$/.test(o.attrValue);return}else if(o.attrName==="class"){o.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(o.attrValue);return}}o.keepAttr=!1;return}});const r=document.createElement("a");UH("afterSanitizeAttributes",s=>{for(const o of["href","src"])s.hasAttribute(o)&&(r.href=s.getAttribute(o),i.includes(r.protocol.replace(/:$/,""))||s.removeAttribute(o))});try{return rVe(e,Object.assign(Object.assign({},t),{RETURN_TRUSTED_TYPE:!0}))}finally{jH("uponSanitizeAttribute"),jH("afterSanitizeAttributes")}}function cVe(n){const e=[ft.http,ft.https,ft.mailto,ft.data,ft.file,ft.vscodeFileResource,ft.vscodeRemote,ft.vscodeRemoteResource];return n.isTrusted&&e.push(ft.command),{config:{ALLOWED_TAGS:["ul","li","p","b","i","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"],ALLOWED_ATTR:["href","data-href","target","title","src","alt","class","style","data-code","width","height","align"],ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}var hVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},qH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},uVe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},WA;let Cg=class _ne{constructor(e,t,i){this._options=e,this._modeService=t,this._openerService=i,this._onDidRenderAsync=new H,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const r=new ve;return{element:r.add(aVe(e,Object.assign(Object.assign({},this._getRenderOptions(e,r)),t),i)).element,dispose:()=>r.dispose()}}_getRenderOptions(e,t){return{baseUrl:this._options.baseUrl,codeBlockRenderer:(i,r)=>uVe(this,void 0,void 0,function*(){var s,o,a,l;let c;i?c=this._modeService.getModeIdForLanguageName(i):this._options.editor&&(c=(s=this._options.editor.getModel())===null||s===void 0?void 0:s.getLanguageId()),c||(c="plaintext"),this._modeService.triggerMode(c);const h=(o=yield Fi.getPromise(c))!==null&&o!==void 0?o:void 0,u=document.createElement("span");if(u.innerHTML=(l=(a=_ne._ttpTokenizer)===null||a===void 0?void 0:a.createHTML(r,this._modeService.languageIdCodec,h))!==null&&l!==void 0?l:ite(r,this._modeService.languageIdCodec,h),this._options.editor){const d=this._options.editor.getOption(43);Yn.applyFontInfoSlow(u,d)}else this._options.codeBlockFontFamily&&(u.style.fontFamily=this._options.codeBlockFontFamily);return u}),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>this._openerService.open(i,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:e.isTrusted}).catch(it),disposables:t}}}};Cg._ttpTokenizer=(WA=window.trustedTypes)===null||WA===void 0?void 0:WA.createPolicy("tokenizeToString",{createHTML(n,e,t){return ite(n,e,t)}});Cg=hVe([qH(1,Zr),qH(2,ju)],Cg);function bne(n,e,t){const r=bw.ordered(n).map(s=>Promise.resolve(s.provideHover(n,e,t)).then(o=>o&&dVe(o)?o:void 0,o=>{ca(o)}));return Promise.all(r).then(rL)}C0("_executeHoverProvider",(n,e)=>bne(n,e,ai.None));function dVe(n){const e=typeof n.range<"u",t=typeof n.contents<"u"&&n.contents&&n.contents.length>0;return e&&t}var fVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},$A=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},gVe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const GH=me;class rS{constructor(e,t,i){this.owner=e,this.range=t,this.contents=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let OO=class{constructor(e,t,i,r,s){this._editor=e,this._hover=t,this._modeService=i,this._openerService=r,this._configurationService=s}createLoadingMessage(e){return new rS(this,e.range,[new B_().appendText(v("modesContentHover.loading","Loading..."))])}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),r=e.range.startLineNumber,s=i.getLineMaxColumn(r),o=[];for(const h of t){const u=h.range.startLineNumber===r?h.range.startColumn:1,d=h.range.endLineNumber===r?h.range.endColumn:s,f=h.options.hoverMessage;if(!f||xv(f))continue;const g=new V(e.range.startLineNumber,u,e.range.startLineNumber,d);o.push(new rS(this,g,vJ(f)))}const a=i.getLineLength(r),l=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),c=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:l});return typeof c=="number"&&a>=c&&o.push(new rS(this,e.range,[{value:v("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}])),o}computeAsync(e,t,i){return gVe(this,void 0,void 0,function*(){if(!this._editor.hasModel()||e.type!==1)return Promise.resolve([]);const r=this._editor.getModel();if(!bw.has(r))return Promise.resolve([]);const s=yield bne(r,new G(e.range.startLineNumber,e.range.startColumn),i),o=[];for(const a of s){if(xv(a.contents))continue;const l=a.range?V.lift(a.range):e.range;o.push(new rS(this,l,a.contents))}return o})}renderHoverParts(e,t,i){const r=new ve;for(const s of e)for(const o of s.contents){if(xv(o))continue;const a=GH("div.hover-row.markdown-hover"),l=le(a,GH("div.hover-contents")),c=r.add(new Cg({editor:this._editor},this._modeService,this._openerService));r.add(c.onDidRenderAsync(()=>{l.className="hover-contents code-hover-contents",this._hover.onContentsChanged()}));const h=r.add(c.render(o));l.appendChild(h.element),t.appendChild(a)}return r}};OO=fVe([$A(2,Zr),$A(3,ju),$A(4,Zi)],OO);class Ot{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+Ot.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(e){return new Ot(this.value+Ot.sep+e)}}Ot.sep=".";Ot.None=new Ot("@@none@@");Ot.Empty=new Ot("");Ot.QuickFix=new Ot("quickfix");Ot.Refactor=new Ot("refactor");Ot.Source=new Ot("source");Ot.SourceOrganizeImports=Ot.Source.append("organizeImports");Ot.SourceFixAll=Ot.Source.append("fixAll");function pVe(n,e){return!(n.include&&!n.include.intersects(e)||n.excludes&&n.excludes.some(t=>vne(e,t,n.include))||!n.includeSourceActions&&Ot.Source.contains(e))}function mVe(n,e){const t=e.kind?new Ot(e.kind):void 0;return!(n.include&&(!t||!n.include.contains(t))||n.excludes&&t&&n.excludes.some(i=>vne(t,i,n.include))||!n.includeSourceActions&&t&&Ot.Source.contains(t)||n.onlyIncludePreferredActions&&!e.isPreferred)}function vne(n,e,t){return!(!e.contains(n)||t&&e.contains(t))}class qd{constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}static fromUser(e,t){return!e||typeof e!="object"?new qd(t.kind,t.apply,!1):new qd(qd.getKindFromUser(e,t.kind),qd.getApplyFromUser(e,t.apply),qd.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new Ot(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}}var MB=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const _Ve="editor.action.codeAction",bVe="editor.action.refactor",vVe="editor.action.sourceAction",wne="editor.action.organizeImports",yne="editor.action.fixAll";class Cne{constructor(e,t){this.action=e,this.provider=t}resolve(e){var t;return MB(this,void 0,void 0,function*(){if(!((t=this.provider)===null||t===void 0)&&t.resolveCodeAction&&!this.action.edit){let i;try{i=yield this.provider.resolveCodeAction(this.action,e)}catch(r){ca(r)}i&&(this.action.edit=i.edit)}return this})}}class FB extends re{constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(FB.codeActionsComparator),this.validActions=this.allActions.filter(({action:r})=>!r.disabled)}static codeActionsComparator({action:e},{action:t}){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:tc(e.diagnostics)?tc(t.diagnostics)?e.diagnostics[0].message.localeCompare(t.diagnostics[0].message):-1:tc(t.diagnostics)?1:0}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&Ot.QuickFix.contains(new Ot(e.kind))&&!!e.isPreferred)}}const KH={actions:[],documentation:void 0};function OB(n,e,t,i,r){var s;const o=t.filter||{},a={only:(s=o.include)===null||s===void 0?void 0:s.value,trigger:t.type},l=new ZOe(n,r),c=wVe(n,o),h=new ve,u=c.map(f=>MB(this,void 0,void 0,function*(){try{i.report(f);const g=yield f.provideCodeActions(n,e,a,l.token);if(g&&h.add(g),l.token.isCancellationRequested)return KH;const p=((g==null?void 0:g.actions)||[]).filter(b=>b&&mVe(o,b)),m=yVe(f,p,o.include);return{actions:p.map(b=>new Cne(b,f)),documentation:m}}catch(g){if(gd(g))throw g;return ca(g),KH}})),d=Jl.onDidChange(()=>{const f=Jl.all(n);ec(f,c)||l.cancel()});return Promise.all(u).then(f=>{const g=Q3(f.map(m=>m.actions)),p=rL(f.map(m=>m.documentation));return new FB(g,p,h)}).finally(()=>{d.dispose(),l.dispose()})}function wVe(n,e){return Jl.all(n).filter(t=>t.providedCodeActionKinds?t.providedCodeActionKinds.some(i=>pVe(e,new Ot(i))):!0)}function yVe(n,e,t){if(!n.documentation)return;const i=n.documentation.map(r=>({kind:new Ot(r.kind),command:r.command}));if(t){let r;for(const s of i)s.kind.contains(t)&&(r?r.kind.contains(s.kind)&&(r=s):r=s);if(r)return r==null?void 0:r.command}for(const r of e)if(r.kind){for(const s of i)if(s.kind.contains(new Ot(r.kind)))return s.command}}Pt.registerCommand("_executeCodeActionProvider",function(n,e,t,i,r){return MB(this,void 0,void 0,function*(){if(!(e instanceof qe))throw Zl();const s=n.get(Kr).getModel(e);if(!s)throw Zl();const o=je.isISelection(t)?je.liftSelection(t):V.isIRange(t)?s.validateRange(t):void 0;if(!o)throw Zl();const a=typeof i=="string"?new Ot(i):void 0,l=yield OB(s,o,{type:1,filter:{includeSourceActions:!0,include:a}},NL.None,ai.None),c=[],h=Math.min(l.validActions.length,typeof r=="number"?r:0);for(let u=0;u<h;u++)c.push(l.validActions[u].resolve(ai.None));try{return yield Promise.all(c),l.validActions.map(u=>u.action)}finally{setTimeout(()=>l.dispose(),100)}})});class MD{constructor(e){this.executor=e,this._didRun=!1}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var CVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},ZH=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},SVe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class YH extends ea{constructor(e,t){super(e.command?e.command.id:e.title,xVe(e.title),void 0,!e.disabled,t),this.action=e}}function xVe(n){return n.replace(/\r\n|\r|\n/g," ")}let PO=class extends re{constructor(e,t,i,r){super(),this._editor=e,this._delegate=t,this._contextMenuService=i,this._visible=!1,this._showingActions=this._register(new zs),this._keybindingResolver=new s2({getKeybindings:()=>r.getKeybindings()})}get isVisible(){return this._visible}show(e,t,i,r){return SVe(this,void 0,void 0,function*(){const s=r.includeDisabledActions?t.allActions:t.validActions;if(!s.length){this._visible=!1;return}if(!this._editor.getDomNode())throw this._visible=!1,g0();this._visible=!0,this._showingActions.value=t;const o=this.getMenuActions(e,s,t.documentation),a=G.isIPosition(i)?this._toCoords(i):i||{x:0,y:0},l=this._keybindingResolver.getResolver(),c=this._editor.getOption(113);this._contextMenuService.showContextMenu({domForShadowRoot:c?this._editor.getDomNode():void 0,getAnchor:()=>a,getActions:()=>o,onHide:()=>{this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:h=>h instanceof YH?l(h.action):void 0})})}getMenuActions(e,t,i){var r,s;const o=h=>new YH(h.action,()=>this._delegate.onSelectCodeAction(h)),a=t.map(o),l=[...i],c=this._editor.getModel();if(c&&a.length)for(const h of Jl.all(c))h._getAdditionalMenuItems&&l.push(...h._getAdditionalMenuItems({trigger:e.type,only:(s=(r=e.filter)===null||r===void 0?void 0:r.include)===null||s===void 0?void 0:s.value},t.map(u=>u.action)));return l.length&&a.push(new Fa,...l.map(h=>o(new Cne({title:h.title,command:h},void 0)))),a}_toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=jn(this._editor.getDomNode()),r=i.left+t.left,s=i.top+t.top+t.height;return{x:r,y:s}}};PO=CVe([ZH(2,Gg),ZH(3,Yi)],PO);class s2{constructor(e){this._keybindingProvider=e}getResolver(){const e=new MD(()=>this._keybindingProvider.getKeybindings().filter(t=>s2.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===wne?i={kind:Ot.SourceOrganizeImports.value}:t.command===yne&&(i={kind:Ot.SourceFixAll.value}),Object.assign({resolvedKeybinding:t.resolvedKeybinding},qd.fromUser(i,{kind:Ot.None,apply:"never"}))}));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.getValue());return i==null?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new Ot(e.kind);return t.filter(r=>r.kind.contains(i)).filter(r=>r.preferred?e.isPreferred:!0).reduceRight((r,s)=>r?r.kind.contains(s.kind)?s:r:s,void 0)}}s2.codeActionCommands=[bVe,_Ve,vVe,wne,yne];var EVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},DVe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},kv;(function(n){n.Hidden={type:0};class e{constructor(i,r,s,o){this.actions=i,this.trigger=r,this.editorPosition=s,this.widgetPosition=o,this.type=1}}n.Showing=e})(kv||(kv={}));let FD=class Sne extends re{constructor(e,t,i,r){super(),this._editor=e,this._quickFixActionId=t,this._preferredFixActionId=i,this._keybindingService=r,this._onClick=this._register(new H),this.onClick=this._onClick.event,this._state=kv.Hidden,this._domNode=document.createElement("div"),this._domNode.className=Ce.lightBulb.classNames,this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(s=>{const o=this._editor.getModel();(this.state.type!==1||!o||this.state.editorPosition.lineNumber>=o.getLineCount())&&this.hide()})),Rt.ignoreTarget(this._domNode),this._register(cke(this._domNode,s=>{if(this.state.type!==1)return;this._editor.focus(),s.preventDefault();const{top:o,height:a}=jn(this._domNode),l=this._editor.getOption(58);let c=Math.floor(l/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(c+=l),this._onClick.fire({x:s.posx,y:o+a+c,actions:this.state.actions,trigger:this.state.trigger})})),this._register(ae(this._domNode,"mouseenter",s=>{if((s.buttons&1)!==1)return;this.hide();const o=new Ug;o.startMonitoring(s.target,s.buttons,S0,()=>{},()=>{o.dispose()})})),this._register(this._editor.onDidChangeConfiguration(s=>{s.hasChanged(56)&&!this._editor.getOption(56).enabled&&this.hide()})),this._updateLightBulbTitleAndIcon(),this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon,this))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.hide();const r=this._editor.getOptions();if(!r.get(56).enabled)return this.hide();const s=this._editor.getModel();if(!s)return this.hide();const{lineNumber:o,column:a}=s.validatePosition(i),l=s.getOptions().tabSize,c=r.get(43),h=s.getLineContent(o),u=fo.computeIndentLevel(h,l),d=c.spaceWidth*u>22,f=p=>p>2&&this._editor.getTopForLineNumber(p)===this._editor.getTopForLineNumber(p-1);let g=o;if(!d){if(o>1&&!f(o-1))g-=1;else if(!f(o+1))g+=1;else if(a*c.spaceWidth<22)return this.hide()}this.state=new kv.Showing(e,t,i,{position:{lineNumber:g,column:1},preference:Sne._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state=kv.Hidden,this._editor.layoutContentWidget(this)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this.state.type===1&&this.state.actions.hasAutoFix){this._domNode.classList.remove(...Ce.lightBulb.classNamesArray),this._domNode.classList.add(...Ce.lightbulbAutofix.classNamesArray);const t=this._keybindingService.lookupKeybinding(this._preferredFixActionId);if(t){this.title=v("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",t.getLabel());return}}this._domNode.classList.remove(...Ce.lightbulbAutofix.classNamesArray),this._domNode.classList.add(...Ce.lightBulb.classNamesArray);const e=this._keybindingService.lookupKeybinding(this._quickFixActionId);e?this.title=v("codeActionWithKb","Show Code Actions ({0})",e.getLabel()):this.title=v("codeAction","Show Code Actions")}set title(e){this._domNode.title=e}};FD._posPref=[0];FD=EVe([DVe(3,Yi)],FD);li((n,e)=>{var t;const i=(t=n.getColor(lo))===null||t===void 0?void 0:t.transparent(.7),r=n.getColor(RNe);r&&e.addRule(`
		.monaco-editor .contentWidgets ${Ce.lightBulb.cssSelector} {
			color: ${r};
			background-color: ${i};
		}`);const s=n.getColor(MNe);s&&e.addRule(`
		.monaco-editor .contentWidgets ${Ce.lightbulbAutofix.cssSelector} {
			color: ${s};
			background-color: ${i};
		}`)});var kVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},LVe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},zA=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},IVe=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(n,t):r?r.value=t:e.set(n,t),t},TVe=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},rx;let BO=class extends re{constructor(e,t,i,r,s){super(),this._editor=e,this.delegate=r,this._activeCodeActions=this._register(new zs),rx.set(this,!1),this._codeActionWidget=new MD(()=>this._register(s.createInstance(PO,this._editor,{onSelectCodeAction:o=>zA(this,void 0,void 0,function*(){this.delegate.applyCodeAction(o,!0)})}))),this._lightBulbWidget=new MD(()=>{const o=this._register(s.createInstance(FD,this._editor,t,i));return this._register(o.onClick(a=>this.showCodeActionList(a.trigger,a.actions,a,{includeDisabledActions:!1}))),o})}dispose(){IVe(this,rx,!0,"f"),super.dispose()}update(e){var t,i,r;return zA(this,void 0,void 0,function*(){if(e.type!==1){(t=this._lightBulbWidget.rawValue)===null||t===void 0||t.hide();return}let s;try{s=yield e.actions}catch(o){it(o);return}if(!TVe(this,rx,"f"))if(this._lightBulbWidget.getValue().update(s,e.trigger,e.position),e.trigger.type===1){if(!((i=e.trigger.filter)===null||i===void 0)&&i.include){const a=this.tryGetValidActionToApply(e.trigger,s);if(a){try{this._lightBulbWidget.getValue().hide(),yield this.delegate.applyCodeAction(a,!1)}finally{s.dispose()}return}if(e.trigger.context){const l=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,s);if(l&&l.action.disabled){oa.get(this._editor).showMessage(l.action.disabled,e.trigger.context.position),s.dispose();return}}}const o=!!(!((r=e.trigger.filter)===null||r===void 0)&&r.include);if(e.trigger.context&&(!s.allActions.length||!o&&!s.validActions.length)){oa.get(this._editor).showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=s,s.dispose();return}this._activeCodeActions.value=s,this._codeActionWidget.getValue().show(e.trigger,s,e.position,{includeDisabledActions:o})}else this._codeActionWidget.getValue().isVisible?s.dispose():this._activeCodeActions.value=s})}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}showCodeActionList(e,t,i,r){return zA(this,void 0,void 0,function*(){this._codeActionWidget.getValue().show(e,t,i,r)})}};rx=new WeakMap;BO=kVe([LVe(4,Kt)],BO);var HA=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},AVe=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(n,t):r?r.value=t:e.set(n,t),t},$p;const xne=new Te("supportedCodeAction","");class NVe extends re{constructor(e,t,i,r=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=r,this._autoTriggerTimer=this._register(new Gr),this._register(this._markerService.onMarkerChanged(s=>this._onMarkerChanges(s))),this._register(this._editor.onDidChangeCursorPosition(()=>this._onCursorChange()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);return this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>BQ(i,t.uri))&&this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2})},this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2})},this._delay)}_getRangeOfMarker(e){const t=this._editor.getModel();if(t)for(const i of this._markerService.read({resource:t.uri})){const r=t.validateRange(i);if(V.intersectRanges(r,e))return V.lift(r)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelection();if(i.isEmpty()&&e.type===2){const{lineNumber:r,column:s}=i.getPosition(),o=t.getLineContent(r);if(o.length===0)return;if(s===1){if(/\s/.test(o[0]))return}else if(s===t.getLineMaxColumn(r)){if(/\s/.test(o[o.length-1]))return}else if(/\s/.test(o[s-2])&&/\s/.test(o[s-1]))return}return i}_createEventAndSignalChange(e,t){const i=this._editor.getModel();if(!t||!i){this._signalChange(void 0);return}const r=this._getRangeOfMarker(t),s=r?r.getStartPosition():t.getStartPosition(),o={trigger:e,selection:t,position:s};return this._signalChange(o),o}}var Gd;(function(n){n.Empty={type:0};class e{constructor(i,r,s,o){this.trigger=i,this.rangeOrSelection=r,this.position=s,this._cancellablePromise=o,this.type=1,this.actions=o.catch(a=>{if(gd(a))return RVe;throw a})}cancel(){this._cancellablePromise.cancel()}}n.Triggered=e})(Gd||(Gd={}));const RVe={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1};class MVe extends re{constructor(e,t,i,r){super(),this._editor=e,this._markerService=t,this._progressService=r,this._codeActionOracle=this._register(new zs),this._state=Gd.Empty,this._onDidChangeState=this._register(new H),this.onDidChangeState=this._onDidChangeState.event,$p.set(this,!1),this._supportedCodeActions=xne.bindTo(i),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(Jl.onDidChange(()=>this._update())),this._update()}dispose(){HA(this,$p,"f")||(AVe(this,$p,!0,"f"),super.dispose(),this.setState(Gd.Empty,!0))}_update(){if(HA(this,$p,"f"))return;this._codeActionOracle.value=void 0,this.setState(Gd.Empty);const e=this._editor.getModel();if(e&&Jl.has(e)&&!this._editor.getOption(80)){const t=[];for(const i of Jl.all(e))Array.isArray(i.providedCodeActionKinds)&&t.push(...i.providedCodeActionKinds);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new NVe(this._editor,this._markerService,i=>{var r;if(!i){this.setState(Gd.Empty);return}const s=Hs(o=>OB(e,i.selection,i.trigger,NL.None,o));i.trigger.type===1&&((r=this._progressService)===null||r===void 0||r.showWhile(s,250)),this.setState(new Gd.Triggered(i.trigger,i.selection,i.position,s))},void 0),this._codeActionOracle.value.trigger({type:2})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value&&this._codeActionOracle.value.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!HA(this,$p,"f")&&this._onDidChangeState.fire(e))}}$p=new WeakMap;var FVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},sS=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Ene=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};function OVe(n){return Ie.regex(xne.keys()[0],new RegExp("(\\s|^)"+ja(n.value)+"\\b"))}v("args.schema.kind","Kind of the code action to run."),v("args.schema.apply","Controls when the returned actions are applied."),v("args.schema.apply.first","Always apply the first returned code action."),v("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),v("args.schema.apply.never","Do not apply the returned code actions."),v("args.schema.preferred","Controls if only preferred code actions should be returned.");let u1=class Dne extends re{constructor(e,t,i,r,s){super(),this._instantiationService=s,this._editor=e,this._model=this._register(new MVe(this._editor,t,i,r)),this._register(this._model.onDidChangeState(o=>this.update(o))),this._ui=new MD(()=>this._register(new BO(e,My.Id,o2.Id,{applyCodeAction:(o,a)=>Ene(this,void 0,void 0,function*(){try{yield this._applyCodeAction(o)}finally{a&&this._trigger({type:2,filter:{}})}})},this._instantiationService)))}static get(e){return e.getContribution(Dne.ID)}update(e){this._ui.getValue().update(e)}showCodeActions(e,t,i){return this._ui.getValue().showCodeActionList(e,t,i,{includeDisabledActions:!1})}manualTriggerAtCurrentPosition(e,t,i){if(!this._editor.hasModel())return;oa.get(this._editor).closeMessage();const r=this._editor.getPosition();this._trigger({type:1,filter:t,autoApply:i,context:{notAvailableMessage:e,position:r}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e){return this._instantiationService.invokeFunction(PVe,e,this._editor)}};u1.ID="editor.contrib.quickFixController";u1=FVe([sS(1,ky),sS(2,Xe),sS(3,L0),sS(4,Kt)],u1);function PVe(n,e,t){return Ene(this,void 0,void 0,function*(){const i=n.get(LJ),r=n.get(An),s=n.get(y0),o=n.get(Qn);if(s.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred}),yield e.resolve(ai.None),e.action.edit&&(yield i.apply(r5.convert(e.action.edit),{editor:t,label:e.action.title})),e.action.command)try{yield r.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(a){const l=BVe(a);o.error(typeof l=="string"?l:v("applyCodeActionFailed","An unknown error occurred while applying the code action"))}})}function BVe(n){return typeof n=="string"?n:n instanceof Error&&typeof n.message=="string"?n.message:void 0}function kne(n,e,t,i){if(n.hasModel()){const r=u1.get(n);r&&r.manualTriggerAtCurrentPosition(e,t,i)}}class My extends Si{constructor(){super({id:My.Id,label:v("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:Ie.and(Z.writable,Z.hasCodeActionsProvider),kbOpts:{kbExpr:Z.editorTextFocus,primary:2132,weight:100}})}run(e,t){return kne(t,v("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0)}}My.Id="editor.action.quickFix";class o2 extends Si{constructor(){super({id:o2.Id,label:v("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:Ie.and(Z.writable,OVe(Ot.QuickFix)),kbOpts:{kbExpr:Z.editorTextFocus,primary:1620,mac:{primary:2644},weight:100}})}run(e,t){return kne(t,v("editor.action.autoFix.noneMessage","No auto fixes available"),{include:Ot.QuickFix,onlyIncludePreferredActions:!0},"ifSingle")}}o2.Id="editor.action.autoFix";var Lne=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Ine=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class XH{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let VO=class Tne{constructor(e,t){this._markerService=t,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._dispoables=new ve,this._markers=[],this._nextIdx=-1,qe.isUri(e)?this._resourceFilter=r=>r.toString()===e.toString():e&&(this._resourceFilter=e);const i=()=>{this._markers=this._markerService.read({resource:qe.isUri(e)?e:void 0,severities:_i.Error|_i.Warning|_i.Info}),typeof e=="function"&&(this._markers=this._markers.filter(r=>this._resourceFilter(r.resource))),this._markers.sort(Tne._compareMarker)};i(),this._dispoables.add(t.onMarkerChanged(r=>{(!this._resourceFilter||r.some(s=>this._resourceFilter(s)))&&(i(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new XH(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let r=!1,s=this._markers.findIndex(o=>o.resource.toString()===e.uri.toString());s<0&&(s=X3(this._markers,{resource:e.uri},(o,a)=>pw(o.resource.toString(),a.resource.toString())),s<0&&(s=~s));for(let o=s;o<this._markers.length;o++){let a=V.lift(this._markers[o]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new V(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=o,r=!0;break}if(this._markers[o].resource.toString()!==e.uri.toString())break}r||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;let r=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),r!==this._nextIdx}find(e,t){let i=this._markers.findIndex(r=>r.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(V.containsPosition(this._markers[i],t))return new XH(this._markers[i],i+1,this._markers.length)}}static _compareMarker(e,t){let i=pw(e.resource.toString(),t.resource.toString());return i===0&&(i=_i.compare(e.severity,t.severity)),i===0&&(i=V.compareRangesUsingStarts(e,t)),i}};VO=Lne([Ine(1,ky)],VO);const Ane=Dt("IMarkerNavigationService");let WO=class{constructor(e){this._markerService=e,this._provider=new As}getMarkerList(e){for(let t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new VO(e,this._markerService)}};WO=Lne([Ine(0,ky)],WO);Wg(Ane,WO,!0);var $O;(function(n){function e(t){switch(t){case Li.Ignore:return"severity-ignore "+Ce.info.classNames;case Li.Info:return Ce.info.classNames;case Li.Warning:return Ce.warning.classNames;case Li.Error:return Ce.error.classNames;default:return""}}n.className=e})($O||($O={}));li((n,e)=>{const t=n.getColor(CRe);if(t){const s=Ce.error.cssSelector;e.addRule(`
			.monaco-editor .zone-widget ${s},
			.markers-panel .marker-icon${s},
			.text-search-provider-messages .providerMessage ${s},
			.extensions-viewlet > .extensions ${s} {
				color: ${t};
			}
		`)}const i=n.getColor(SRe);if(i){const s=Ce.warning.cssSelector;e.addRule(`
			.monaco-editor .zone-widget ${s},
			.markers-panel .marker-icon${s},
			.extensions-viewlet > .extensions ${s},
			.extension-editor ${s},
			.text-search-provider-messages .providerMessage ${s},
			.preferences-editor ${s} {
				color: ${i};
			}
		`)}const r=n.getColor(xRe);if(r){const s=Ce.info.cssSelector;e.addRule(`
			.monaco-editor .zone-widget ${s},
			.markers-panel .marker-icon${s},
			.extensions-viewlet > .extensions ${s},
			.text-search-provider-messages .providerMessage ${s},
			.extension-editor ${s} {
				color: ${r};
			}
		`)}});var VVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Ip=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class WVe{constructor(e,t,i,r,s){this._openerService=r,this._labelService=s,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new ve,this._editor=t;const o=document.createElement("div");o.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),o.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),o.appendChild(this._relatedBlock),this._disposables.add(dn(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new F5(o,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:3,verticalScrollbarSize:3}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{o.style.left=`-${a.scrollLeft}px`,o.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){mt(this._disposables)}update(e){const{source:t,message:i,relatedInformation:r,code:s}=e;let o=((t==null?void 0:t.length)||0)+2;s&&(typeof s=="string"?o+=s.length:o+=s.value.length);const a=nc(i);this._lines=a.length,this._longestLineLength=0;for(const d of a)this._longestLineLength=Math.max(d.length+o,this._longestLineLength);Gn(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const d of a)l=document.createElement("div"),l.innerText=d,d===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||s){const d=document.createElement("span");if(d.classList.add("details"),l.appendChild(d),t){const f=document.createElement("span");f.innerText=t,f.classList.add("source"),d.appendChild(f)}if(s)if(typeof s=="string"){const f=document.createElement("span");f.innerText=`(${s})`,f.classList.add("code"),d.appendChild(f)}else{this._codeLink=me("a.code-link"),this._codeLink.setAttribute("href",`${s.target.toString()}`),this._codeLink.onclick=g=>{this._openerService.open(s.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()};const f=le(this._codeLink,me("span"));f.innerText=s.value,d.appendChild(this._codeLink)}}if(Gn(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),tc(r)){const d=this._relatedBlock.appendChild(document.createElement("div"));d.style.paddingTop=`${Math.floor(this._editor.getOption(58)*.66)}px`,this._lines+=1;for(const f of r){let g=document.createElement("div"),p=document.createElement("a");p.classList.add("filename"),p.innerText=`${Gie(f.resource)}(${f.startLineNumber}, ${f.startColumn}): `,p.title=this._labelService.getUriLabel(f.resource),this._relatedDiagnostics.set(p,f);let m=document.createElement("span");m.innerText=f.message,g.appendChild(p),g.appendChild(m),this._lines+=1,d.appendChild(g)}}const c=this._editor.getOption(43),h=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),u=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:h,scrollHeight:u})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case _i.Error:t=v("Error","Error");break;case _i.Warning:t=v("Warning","Warning");break;case _i.Info:t=v("Info","Info");break;case _i.Hint:t=v("Hint","Hint");break}let i=v("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const r=this._editor.getModel();return r&&e.startLineNumber<=r.getLineCount()&&e.startLineNumber>=1&&(i=`${r.getLineContent(e.startLineNumber)}, ${i}`),i}}let j_=class Nne extends ND{constructor(e,t,i,r,s,o,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},s),this._themeService=t,this._openerService=i,this._menuService=r,this._contextKeyService=o,this._labelService=a,this._callOnDispose=new ve,this._onDidSelectRelatedInformation=new H,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=_i.Warning,this._backgroundColor=X.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(UVe);let t=zO,i=$Ve;this._severity===_i.Warning?(t=HO,i=zVe):this._severity===_i.Info&&(t=UO,i=HVe);const r=e.getColor(t),s=e.getColor(i);this.style({arrowColor:r,frameColor:r,headerBackgroundColor:s,primaryHeadingColor:e.getColor(Uie),secondaryHeadingColor:e.getColor(jie)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun(r=>this.editor.focus()));const t=[],i=this._menuService.createMenu(Nne.TitleMenu,this._contextKeyService);G7e(i,void 0,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0}),i.dispose()}_fillTitleIcon(e){this._icon=le(e,me(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new WVe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());let r=V.lift(e);const s=this.editor.getPosition();let o=s&&r.containsPosition(s)?s:r.getStartPosition();super.show(o,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?v("problems","{0} of {1} problems",t,i):v("change","{0} of {1} problem",t,i);this.setTitle(qa(a.uri),l)}this._icon.className=`codicon ${$O.className(_i.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(o,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};j_.TitleMenu=new Ye("gotoErrorTitleMenu");j_=VVe([Ip(1,fi),Ip(2,ju),Ip(3,w0),Ip(4,Kt),Ip(5,Xe),Ip(6,Sy)],j_);let QH=Tw(mv,xee),JH=Tw(gh,xL),eU=Tw(Ba,I5);const zO=z("editorMarkerNavigationError.background",{dark:QH,light:QH,hc:Ki},v("editorMarkerNavigationError","Editor marker navigation widget error color.")),$Ve=z("editorMarkerNavigationError.headerBackground",{dark:Jt(zO,.1),light:Jt(zO,.1),hc:null},v("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),HO=z("editorMarkerNavigationWarning.background",{dark:JH,light:JH,hc:Ki},v("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),zVe=z("editorMarkerNavigationWarning.headerBackground",{dark:Jt(HO,.1),light:Jt(HO,.1),hc:"#0C141F"},v("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),UO=z("editorMarkerNavigationInfo.background",{dark:eU,light:eU,hc:Ki},v("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),HVe=z("editorMarkerNavigationInfo.headerBackground",{dark:Jt(UO,.1),light:Jt(UO,.1),hc:null},v("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),UVe=z("editorMarkerNavigation.background",{dark:lo,light:lo,hc:lo},v("editorMarkerNavigationBackground","Editor marker navigation widget background."));li((n,e)=>{const t=n.getColor(CL);t&&e.addRule(`.monaco-editor .marker-widget a.code-link span { color: ${t}; }`);const i=n.getColor(SL);i&&e.addRule(`.monaco-editor .marker-widget a.code-link span:hover { color: ${i}; }`)});var jVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},oS=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Rne=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let nd=class sx{constructor(e,t,i,r,s){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=r,this._instantiationService=s,this._sessionDispoables=new ve,this._editor=e,this._widgetVisible=Mne.bindTo(this._contextKeyService)}static get(e){return e.getContribution(sx.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(j_,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{var r,s,o;(!(!((r=this._model)===null||r===void 0)&&r.selected)||!V.containsPosition((s=this._model)===null||s===void 0?void 0:s.selected.marker,i.position))&&((o=this._model)===null||o===void 0||o.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:V.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new G(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(e,t){return Rne(this,void 0,void 0,function*(){if(this._editor.hasModel()){const i=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(i.move(e,this._editor.getModel(),this._editor.getPosition()),!i.selected)return;if(i.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const r=yield this._editorService.openCodeEditor({resource:i.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:i.selected.marker}},this._editor);r&&(sx.get(r).close(),sx.get(r).nagivate(e,t))}else this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}})}};nd.ID="editor.contrib.markerController";nd=jVe([oS(1,Ane),oS(2,Xe),oS(3,ui),oS(4,Kt)],nd);class a2 extends Si{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){return Rne(this,void 0,void 0,function*(){t.hasModel()&&nd.get(t).nagivate(this._next,this._multiFile)})}}class mh extends a2{constructor(){super(!0,!1,{id:mh.ID,label:mh.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:578,weight:100},menuOpts:{menuId:j_.TitleMenu,title:mh.LABEL,icon:ur("marker-navigation-next",Ce.arrowDown,v("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}mh.ID="editor.action.marker.next";mh.LABEL=v("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class q_ extends a2{constructor(){super(!1,!1,{id:q_.ID,label:q_.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:1602,weight:100},menuOpts:{menuId:j_.TitleMenu,title:mh.LABEL,icon:ur("marker-navigation-previous",Ce.arrowUp,v("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}q_.ID="editor.action.marker.prev";q_.LABEL=v("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class qVe extends a2{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:v("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:66,weight:100},menuOpts:{menuId:Ye.MenubarGoMenu,title:v({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class GVe extends a2{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:v("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:Z.focus,primary:1090,weight:100},menuOpts:{menuId:Ye.MenubarGoMenu,title:v({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}Yr(nd.ID,nd);pt(mh);pt(q_);pt(qVe);pt(GVe);const Mne=new Te("markersNavigationVisible",!1),KVe=mo.bindToContribution(nd.get);ye(new KVe({id:"closeMarkersNavigation",precondition:Mne,handler:n=>n.close(),kbOpts:{weight:100+50,kbExpr:Z.focus,primary:9,secondary:[1033]}}));var ZVe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},tU=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const Eo=me;class YVe{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const iU={type:1,filter:{include:Ot.QuickFix}};let jO=class{constructor(e,t,i,r){this._editor=e,this._hover=t,this._markerDecorationsService=i,this._openerService=r,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),r=e.range.startLineNumber,s=i.getLineMaxColumn(r),o=[];for(const a of t){const l=a.range.startLineNumber===r?a.range.startColumn:1,c=a.range.endLineNumber===r?a.range.endColumn:s,h=this._markerDecorationsService.getMarker(i.uri,a);if(!h)continue;const u=new V(e.range.startLineNumber,l,e.range.startLineNumber,c);o.push(new YVe(this,u,h))}return o}renderHoverParts(e,t,i){if(!e.length)return re.None;const r=new ve;e.forEach(o=>t.appendChild(this.renderMarkerHover(o,r)));const s=e.length===1?e[0]:e.sort((o,a)=>_i.compare(o.marker.severity,a.marker.severity))[0];return this.renderMarkerStatusbar(s,i,r),r}renderMarkerHover(e,t){const i=Eo("div.hover-row"),r=le(i,Eo("div.marker.hover-contents")),{source:s,message:o,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(r);const c=le(r,Eo("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=o,s||a)if(a&&typeof a!="string"){const h=Eo("span");if(s){const g=le(h,Eo("span"));g.innerText=s}const u=le(h,Eo("a.code-link"));u.setAttribute("href",a.target.toString()),t.add(ae(u,"click",g=>{this._openerService.open(a.target,{allowCommands:!0}),g.preventDefault(),g.stopPropagation()}));const d=le(u,Eo("span"));d.innerText=a.value;const f=le(r,h);f.style.opacity="0.6",f.style.paddingLeft="6px"}else{const h=le(r,Eo("span"));h.style.opacity="0.6",h.style.paddingLeft="6px",h.innerText=s&&a?`${s}(${a})`:s||`(${a})`}if(tc(l))for(const{message:h,resource:u,startLineNumber:d,startColumn:f}of l){const g=le(r,Eo("div"));g.style.marginTop="8px";const p=le(g,Eo("a"));p.innerText=`${qa(u)}(${d}, ${f}): `,p.style.cursor="pointer",t.add(ae(p,"click",b=>{b.stopPropagation(),b.preventDefault(),this._openerService&&this._openerService.open(u,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:d,startColumn:f}}}).catch(it)}));const m=le(g,Eo("span"));m.innerText=h,this._editor.applyFontInfo(m)}return i}renderMarkerStatusbar(e,t,i){if((e.marker.severity===_i.Error||e.marker.severity===_i.Warning||e.marker.severity===_i.Info)&&t.addAction({label:v("view problem","View Problem"),commandId:mh.ID,run:()=>{this._hover.hide(),nd.get(this._editor).showAtMarker(e.marker),this._editor.focus()}}),!this._editor.getOption(80)){const r=t.append(Eo("div"));this.recentMarkerCodeActionsInfo&&(ID.makeKey(this.recentMarkerCodeActionsInfo.marker)===ID.makeKey(e.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(r.textContent=v("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const s=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?re.None:i.add(b_(()=>r.textContent=v("checkingForQuickFixes","Checking for quick fixes..."),200));r.textContent||(r.textContent=String.fromCharCode(160));const o=this.getCodeActions(e.marker);i.add(Et(()=>o.cancel())),o.then(a=>{if(s.dispose(),this.recentMarkerCodeActionsInfo={marker:e.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),r.textContent=v("noQuickFixes","No quick fixes available");return}r.style.display="none";let l=!1;i.add(Et(()=>{l||a.dispose()})),t.addAction({label:v("quick fixes","Quick Fix..."),commandId:My.Id,run:c=>{l=!0;const h=u1.get(this._editor),u=jn(c);this._hover.hide(),h.showCodeActions(iU,a,{x:u.left+6,y:u.top+u.height+6})}})},it)}}getCodeActions(e){return Hs(t=>OB(this._editor.getModel(),new V(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),iU,NL.None,t))}};jO=ZVe([tU(2,h5),tU(3,ju)],jO);li((n,e)=>{const t=n.getColor(CL);t&&e.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${t}; }`);const i=n.getColor(SL);i&&e.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${i}; }`)});const Fne="editor.action.inlineSuggest.commit";class One{constructor(e,t,i=0){this.lineNumber=e,this.parts=t,this.additionalReservedLineCount=i}renderForScreenReader(e){if(this.parts.length===0)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return QVe(i,this.parts.map(s=>({range:{startLineNumber:1,endLineNumber:1,startColumn:s.column,endColumn:s.column},text:s.lines.join(`
`)}))).substring(this.parts[0].column-1)}}class XVe{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}function QVe(n,e){const t=new XVe(n),i=e.map(r=>{const s=V.lift(r.range);return{startOffset:t.getOffset(s.getStartPosition()),endOffset:t.getOffset(s.getEndPosition()),text:r.text}});i.sort((r,s)=>s.startOffset-r.startOffset);for(const r of i)n=n.substring(0,r.startOffset)+r.text+n.substring(r.endOffset);return n}class nU{constructor(e,t,i){this.column=e,this.lines=t,this.preview=i}}class Pne extends re{constructor(e){super(),this.editor=e,this._expanded=void 0,this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(105)&&this._expanded===void 0&&this.onDidChangeEmitter.fire()}))}setExpanded(e){this._expanded=!0,this.onDidChangeEmitter.fire()}}function JVe(n,e){return n===e?!0:!n||!e?!1:n.range.equalsRange(e.range)&&n.text===e.text&&n.command===e.command}function Bne(n,e,t,i,r=0){if(n.range.startLineNumber!==n.range.endLineNumber)return;const s=e.getLineContent(n.range.startLineNumber),o=rn(s).length;if(n.range.startColumn-1<=o){const f=rn(n.text).length,g=s.substring(n.range.startColumn-1,o),p=V.fromPositions(n.range.getStartPosition().delta(0,g.length),n.range.getEndPosition()),m=n.text.startsWith(g)?n.text.substring(g.length):n.text.substring(f);n={range:p,text:m,command:n.command}}const l=e.getValueInRange(n.range),c=eWe(l,n.text);if(!c)return;const h=n.range.startLineNumber,u=new Array;if(t==="prefix"){const f=c.filter(g=>g.originalLength===0);if(f.length>1||f.length===1&&f[0].originalStart!==l.length)return}const d=n.text.length-r;for(const f of c){const g=n.range.startColumn+f.originalStart+f.originalLength;if(t==="subwordSmart"&&i&&i.lineNumber===n.range.startLineNumber&&g<i.column||f.originalLength>0)return;if(f.modifiedLength===0)continue;const p=f.modifiedStart+f.modifiedLength,m=Math.max(f.modifiedStart,Math.min(p,d)),b=n.text.substring(f.modifiedStart,m),_=n.text.substring(m,Math.max(f.modifiedStart,p));if(b.length>0){const w=nc(b);u.push(new nU(g,w,!1))}if(_.length>0){const w=nc(_);u.push(new nU(g,w,!0))}}return new One(h,u,0)}let vl;function eWe(n,e){if((vl==null?void 0:vl.originalValue)===n&&(vl==null?void 0:vl.newValue)===e)return vl==null?void 0:vl.changes;{const t=tWe(n,e);return vl={originalValue:n,newValue:e,changes:t},t}}function tWe(n,e){if(n.length>5e3||e.length>5e3)return;function t(l){let c=0;for(let h=0,u=l.length;h<u;h++){const d=l.charCodeAt(h);d>c&&(c=d)}return c}const i=Math.max(t(n),t(e));function r(l){if(l<0)throw new Error("unexpected");return i+l+1}function s(l){let c=0,h=0;const u=new Int32Array(l.length);for(let d=0,f=l.length;d<f;d++){const g=h*100+c;l[d]==="("?(u[d]=r(2*g),c++):l[d]===")"?(u[d]=r(2*g+1),c===1&&h++,c=Math.max(c-1,0)):u[d]=l.charCodeAt(d)}return u}const o=s(n),a=s(e);return new Fl({getElements:()=>o},{getElements:()=>a}).ComputeDiff(!1).changes}var iWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},nWe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},Xc=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let qO=class extends re{constructor(e,t,i){super(),this.editor=e,this.cache=t,this.commandService=i,this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new zs),this.active=!1,this.disposed=!1,this._register(i.onDidExecuteCommand(r=>{new Set([f5.id,g5.id,_v.Tab.id,_v.DeleteLeft.id,_v.DeleteRight.id,Fne,"acceptSelectedSuggestion"]).has(r.commandId)&&e.hasTextFocus()&&this.handleUserInput()})),this._register(this.editor.onDidType(r=>{this.handleUserInput()})),this._register(this.editor.onDidChangeCursorPosition(r=>{this.session&&!this.session.isValid&&this.hide()})),this._register(Et(()=>{this.disposed=!0})),this._register(this.editor.onDidBlurEditorWidget(()=>{this.hide()}))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout(()=>{this.disposed||this.startSessionIfTriggered()},0)}get session(){return this.completionSession.value}get ghostText(){var e;return(e=this.session)===null||e===void 0?void 0:e.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(e){var t;(t=this.session)===null||t===void 0||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&((t=this.session)===null||t===void 0||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(54).enabled&&(this.session&&this.session.isValid||this.trigger(Js.Automatic))}trigger(e){if(this.completionSession.value){e===Js.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext();return}this.completionSession.value=new rWe(this.editor,this.editor.getPosition(),()=>this.active,this.commandService,this.cache,e),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange(()=>{this.onDidChangeEmitter.fire()}))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;(e=this.session)===null||e===void 0||e.commitCurrentCompletion()}showNext(){var e;(e=this.session)===null||e===void 0||e.showNextInlineCompletion()}showPrevious(){var e;(e=this.session)===null||e===void 0||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return Xc(this,void 0,void 0,function*(){const t=yield(e=this.session)===null||e===void 0?void 0:e.hasMultipleInlineCompletions();return t!==void 0?t:!1})}};qO=iWe([nWe(2,An)],qO);class rWe extends Pne{constructor(e,t,i,r,s,o){super(e),this.triggerPosition=t,this.shouldUpdate=i,this.commandService=r,this.cache=s,this.initialTriggerKind=o,this.minReservedLineCount=0,this.updateOperation=this._register(new zs),this.updateSoon=this._register(new yi(()=>{let l=this.initialTriggerKind;return this.initialTriggerKind=Js.Automatic,this.update(l)},50)),this.currentlySelectedCompletionId=void 0;let a;this._register(this.onDidChange(()=>{const l=this.currentCompletion;if(l&&l.sourceInlineCompletion!==a){a=l.sourceInlineCompletion;const c=l.sourceProvider;c.handleItemDidShow&&c.handleItemDidShow(l.sourceInlineCompletions,a)}})),this._register(Et(()=>{this.cache.clear()})),this._register(this.editor.onDidChangeCursorPosition(l=>{this.cache.value&&this.onDidChangeEmitter.fire()})),this._register(this.editor.onDidChangeModelContent(l=>{this.scheduleAutomaticUpdate()})),this._register(G3.onDidChange(()=>{this.updateSoon.schedule()})),this.scheduleAutomaticUpdate()}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value||this.cache.value.completions.length===0)return 0;const e=this.cache.value.completions.findIndex(t=>t.semanticId===this.currentlySelectedCompletionId);return e===-1?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){var e;return Xc(this,void 0,void 0,function*(){yield this.ensureUpdateWithExplicitContext();const t=((e=this.cache.value)===null||e===void 0?void 0:e.completions)||[];if(t.length>0){const i=(this.fixAndGetIndexOfCurrentSelection()+1)%t.length;this.currentlySelectedCompletionId=t[i].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()})}showPreviousInlineCompletion(){var e;return Xc(this,void 0,void 0,function*(){yield this.ensureUpdateWithExplicitContext();const t=((e=this.cache.value)===null||e===void 0?void 0:e.completions)||[];if(t.length>0){const i=(this.fixAndGetIndexOfCurrentSelection()+t.length-1)%t.length;this.currentlySelectedCompletionId=t[i].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()})}ensureUpdateWithExplicitContext(){var e;return Xc(this,void 0,void 0,function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===Js.Explicit?yield this.updateOperation.value.promise:yield this.update(Js.Explicit):((e=this.cache.value)===null||e===void 0?void 0:e.triggerKind)!==Js.Explicit&&(yield this.update(Js.Explicit))})}hasMultipleInlineCompletions(){var e;return Xc(this,void 0,void 0,function*(){return yield this.ensureUpdateWithExplicitContext(),(((e=this.cache.value)===null||e===void 0?void 0:e.completions.length)||0)>1})}get ghostText(){const e=this.currentCompletion,t=this.editor.getOptions().get(54).mode;return e?Bne(e,this.editor.getModel(),t,this.editor.getPosition()):void 0}get currentCompletion(){const e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule()}update(e){return Xc(this,void 0,void 0,function*(){if(!this.shouldUpdate())return;const t=this.editor.getPosition(),i=Hs(s=>Xc(this,void 0,void 0,function*(){let o;try{o=yield Wne(t,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},s)}catch(a){it(a);return}s.isCancellationRequested||(this.cache.setValue(this.editor,o,e),this.onDidChangeEmitter.fire())})),r=new Vne(i,e);this.updateOperation.value=r,yield i,this.updateOperation.value===r&&this.updateOperation.clear()})}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;const e=this.currentCompletion;e&&this.commit(e)}commit(e){const t=this.cache.clearAndLeak();this.editor.executeEdits("inlineSuggestion.accept",[x_.replaceMove(e.range,e.text)]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally(()=>{t==null||t.dispose()}).then(void 0,ca):t==null||t.dispose(),this.onDidChangeEmitter.fire()}}class Vne{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}}class sWe extends re{constructor(e,t,i,r){super(),this.triggerKind=r;const s=e.deltaDecorations([],t.items.map(o=>({range:o.range,options:{description:"inline-completion-tracking-range"}})));this._register(Et(()=>{e.deltaDecorations(s,[])})),this.completions=t.items.map((o,a)=>new oWe(o,s[a])),this._register(e.onDidChangeModelContent(()=>{let o=!1;const a=e.getModel();for(const l of this.completions){const c=a.getDecorationRange(l.decorationId);if(!c){it(new Error("Decoration has no range"));continue}l.synchronizedRange.equalsRange(c)||(o=!0,l.synchronizedRange=c)}o&&i()})),this._register(t)}}class oWe{constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}toLiveInlineCompletion(){return{text:this.inlineCompletion.text,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion}}}function aWe(n,e){const t=e.getWordAtPosition(n),i=e.getLineMaxColumn(n.lineNumber);return t?new V(n.lineNumber,t.startColumn,n.lineNumber,i):V.fromPositions(n,n.with(void 0,i))}function Wne(n,e,t,i=ai.None){return Xc(this,void 0,void 0,function*(){const r=aWe(n,e),s=G3.all(e),o=yield Promise.all(s.map(l=>Xc(this,void 0,void 0,function*(){const c=yield l.provideInlineCompletions(e,n,t,i);return{completions:c,provider:l,dispose:()=>{c&&l.freeInlineCompletions(c)}}}))),a=new Map;for(const l of o){const c=l.completions;if(c)for(const h of c.items.map(u=>({text:u.text,range:u.range?V.lift(u.range):r,command:u.command,sourceProvider:l.provider,sourceInlineCompletions:c,sourceInlineCompletion:u})))h.range.startLineNumber===h.range.endLineNumber&&a.set(JSON.stringify({text:h.text,range:h.range}),h)}return{items:[...a.values()],dispose:()=>{for(const l of o)l.dispose()}}})}function OD(n,e){if(!e)return e;const t=n.getValueInRange(e.range),i=mw(t,e.text),r=n.getOffsetAt(e.range.getStartPosition())+i,s=n.getPositionAt(r),o=t.substr(i),a=TM(o,e.text),l=n.getPositionAt(Math.max(r,n.getOffsetAt(e.range.getEndPosition())-a));return{range:V.fromPositions(s,l),text:e.text.substr(i,e.text.length-i-a)}}const Sn=new Uint8Array(16),fr=[];for(let n=0;n<256;n++)fr.push(n.toString(16).padStart(2,"0"));let GO;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?GO=crypto.getRandomValues.bind(crypto):GO=function(n){for(let e=0;e<n.length;e++)n[e]=Math.floor(Math.random()*256);return n};function lWe(){GO(Sn),Sn[6]=Sn[6]&15|64,Sn[8]=Sn[8]&63|128;let n=0,e="";return e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+="-",e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+="-",e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+="-",e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+="-",e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e+=fr[Sn[n++]],e}const rU="code-workspace";function sU(n){const e=n;return typeof(e==null?void 0:e.id)=="string"&&qe.isUri(e.uri)}function cWe(n){if(n.configuration)return{id:n.id,configPath:n.configuration};if(n.folders.length===1)return{id:n.id,uri:n.folders[0].uri}}class hWe{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){let i=t.resolve(e);if(i!==void 0)return i}}}class uWe{constructor(e,t,i,r){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=r}resolve(e){const{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,r=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const s=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);s&&(i=s.value,r=s.multiline)}if(i&&r&&e.snippet){const s=this._model.getLineContent(this._selection.startLineNumber),o=rn(s,0,this._selection.startColumn-1);let a=o;e.snippet.walk(c=>c===e?!1:(c instanceof rs&&(a=rn(nc(c.value).pop())),!0));const l=mw(a,o);i=i.replace(/(\r\n|\r|\n)(.*)/g,(c,h,u)=>`${h}${a.substr(l)}${u}`)}return i}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){const i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber)}}}}class dWe{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if(t==="TM_FILENAME")return Ef(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){const i=Ef(this._model.uri.fsPath),r=i.lastIndexOf(".");return r<=0?i:i.slice(0,r)}else{if(t==="TM_DIRECTORY")return hQ(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel($3(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class fWe{constructor(e,t,i,r){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=r}resolve(e){if(e.name!=="CLIPBOARD")return;const t=this._readClipboardText();if(t){if(this._spread){const i=t.split(/\r\n|\n|\r/).filter(r=>!AQ(r));if(i.length===this._selectionCount)return i[this._selectionIdx]}return t}}}class gWe{constructor(e,t){this._model=e,this._selection=t}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),r=zi.getComments(i);if(r){if(t==="LINE_COMMENT")return r.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return r.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return r.blockCommentEndToken||void 0}}}class zl{constructor(){this._date=new Date}resolve(e){const{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return zl.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return zl.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return zl.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return zl.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3))}}zl.dayNames=[v("Sunday","Sunday"),v("Monday","Monday"),v("Tuesday","Tuesday"),v("Wednesday","Wednesday"),v("Thursday","Thursday"),v("Friday","Friday"),v("Saturday","Saturday")];zl.dayNamesShort=[v("SundayShort","Sun"),v("MondayShort","Mon"),v("TuesdayShort","Tue"),v("WednesdayShort","Wed"),v("ThursdayShort","Thu"),v("FridayShort","Fri"),v("SaturdayShort","Sat")];zl.monthNames=[v("January","January"),v("February","February"),v("March","March"),v("April","April"),v("May","May"),v("June","June"),v("July","July"),v("August","August"),v("September","September"),v("October","October"),v("November","November"),v("December","December")];zl.monthNamesShort=[v("JanuaryShort","Jan"),v("FebruaryShort","Feb"),v("MarchShort","Mar"),v("AprilShort","Apr"),v("MayShort","May"),v("JuneShort","Jun"),v("JulyShort","Jul"),v("AugustShort","Aug"),v("SeptemberShort","Sep"),v("OctoberShort","Oct"),v("NovemberShort","Nov"),v("DecemberShort","Dec")];class pWe{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=cWe(this._workspaceService.getWorkspace());if(t){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(sU(e))return Ef(e.uri.path);let t=Ef(e.configPath.path);return t.endsWith(rU)&&(t=t.substr(0,t.length-rU.length-1)),t}_resoveWorkspacePath(e){if(sU(e))return CO(e.uri.fsPath);let t=Ef(e.configPath.path),i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?CO(i):"/"}}class mWe{resolve(e){const{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return lWe()}}li((n,e)=>{function t(i){const r=n.getColor(i);return r?r.toString():"transparent"}e.addRule(`.monaco-editor .snippet-placeholder { background-color: ${t(cRe)}; outline-color: ${t(hRe)}; }`),e.addRule(`.monaco-editor .finish-snippet-placeholder { background-color: ${t(uRe)}; outline-color: ${t(dRe)}; }`)});class To{constructor(e,t,i,r){this._editor=e,this._snippet=t,this._offset=i,this._snippetLineLeadingWhitespace=r,this._nestingLevel=1,this._placeholderGroups=TW(t.placeholders,Vo.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.deltaDecorations([...this._placeholderDecorations.values()],[]),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations(t=>{for(const i of this._snippet.placeholders){const r=this._snippet.offset(i),s=this._snippet.fullLen(i),o=V.fromPositions(e.getPositionAt(this._offset+r),e.getPositionAt(this._offset+r+s)),a=i.isFinalTabstop?To._decor.inactiveFinal:To._decor.inactive,l=t.addDecoration(o,a);this._placeholderDecorations.set(i,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let r=[];for(const s of this._placeholderGroups[this._placeholderGroupsIdx])if(s.transform){const o=this._placeholderDecorations.get(s),a=this._editor.getModel().getDecorationRange(o),l=this._editor.getModel().getValueInRange(a),c=s.transform.resolve(l).split(/\r\n|\r|\n/);for(let h=1;h<c.length;h++)c[h]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+c[h]);r.push(x_.replace(a,c.join(this._editor.getModel().getEOL())))}r.length>0&&this._editor.executeEdits("snippet.placeholderTransform",r)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations(r=>{const s=new Set,o=[];for(const a of this._placeholderGroups[this._placeholderGroupsIdx]){const l=this._placeholderDecorations.get(a),c=this._editor.getModel().getDecorationRange(l);o.push(new je(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),r.changeDecorationOptions(l,a.isFinalTabstop?To._decor.activeFinal:To._decor.active),s.add(a);for(const h of this._snippet.enclosingPlaceholders(a)){const u=this._placeholderDecorations.get(h);r.changeDecorationOptions(u,h.isFinalTabstop?To._decor.activeFinal:To._decor.active),s.add(h)}}for(const[a,l]of this._placeholderDecorations)s.has(a)||r.changeDecorationOptions(l,a.isFinalTabstop?To._decor.inactiveFinal:To._decor.inactive);return o});return t?this.move(e):i??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof Vo){const i=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const r of t){if(r.isFinalTabstop)break;i||(i=[],e.set(r.index,i));const s=this._placeholderDecorations.get(r),o=this._editor.getModel().getDecorationRange(s);if(!o){e.delete(r.index);break}i.push(o)}}return e}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(const r of this._placeholderGroups[this._placeholderGroupsIdx]){const s=e.shift();console.assert(!s._placeholderDecorations);const o=s._snippet.placeholderInfo.last.index;for(const l of s._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=r.index+(o+1)/this._nestingLevel:l.index=r.index+l.index/this._nestingLevel;this._snippet.replace(r,s._snippet.children);const a=this._placeholderDecorations.get(r);i.removeDecoration(a),this._placeholderDecorations.delete(r);for(const l of s._snippet.placeholders){const c=s._snippet.offset(l),h=s._snippet.fullLen(l),u=V.fromPositions(t.getPositionAt(s._offset+c),t.getPositionAt(s._offset+c+h)),d=i.addDecoration(u,To._decor.inactive);this._placeholderDecorations.set(l,d)}}this._placeholderGroups=TW(this._snippet.placeholders,Vo.compareByIndex)})}}To._decor={active:bt.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:bt.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:bt.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:bt.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const oU={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};class El{constructor(e,t,i=oU){this._templateMerges=[],this._snippets=[],this._editor=e,this._template=t,this._options=i}static adjustWhitespace(e,t,i,r,s){const o=e.getLineContent(t.lineNumber),a=rn(o,0,t.column-1);let l;return i.walk(c=>{if(!(c instanceof rs)||c.parent instanceof Ty)return!0;const h=c.value.split(/\r\n|\r|\n/);if(r){const d=i.offset(c);if(d===0)h[0]=e.normalizeIndentation(h[0]);else{l=l??i.toString();let f=l.charCodeAt(d-1);(f===10||f===13)&&(h[0]=e.normalizeIndentation(a+h[0]))}for(let f=1;f<h.length;f++)h[f]=e.normalizeIndentation(a+h[f])}const u=h.join(e.getEOL());return u!==c.value&&(c.parent.replace(c,[new rs(u)]),l=void 0),!0}),a}static adjustSelection(e,t,i,r){if(i!==0||r!==0){const{positionLineNumber:s,positionColumn:o}=t,a=o-i,l=o+r,c=e.validateRange({startLineNumber:s,startColumn:a,endLineNumber:s,endColumn:l});t=je.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippets(e,t,i,r,s,o,a,l){const c=[],h=[];if(!e.hasModel())return{edits:c,snippets:h};const u=e.getModel(),d=e.invokeWithinContext(y=>y.get(PJ)),f=e.invokeWithinContext(y=>new dWe(y.get(Sy),u)),g=()=>a;let p=0,m=u.getValueInRange(El.adjustSelection(u,e.getSelection(),i,0)),b=u.getValueInRange(El.adjustSelection(u,e.getSelection(),0,r)),_=u.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber);const w=e.getSelections().map((y,S)=>({selection:y,idx:S})).sort((y,S)=>V.compareRangesUsingStarts(y.selection,S.selection));for(const{selection:y,idx:S}of w){let k=El.adjustSelection(u,y,i,0),C=El.adjustSelection(u,y,0,r);m!==u.getValueInRange(k)&&(k=y),b!==u.getValueInRange(C)&&(C=y);const D=y.setStartPosition(k.startLineNumber,k.startColumn).setEndPosition(C.endLineNumber,C.endColumn),E=new YL().parse(t,!0,s),N=D.getStartPosition(),T=El.adjustWhitespace(u,N,E,o||S>0&&_!==u.getLineFirstNonWhitespaceColumn(y.positionLineNumber),!0);E.resolveVariables(new hWe([f,new fWe(g,S,w.length,e.getOption(70)==="spread"),new uWe(u,y,S,l),new gWe(u,y),new zl,new pWe(d),new mWe]));const j=u.getOffsetAt(N)+p;p+=E.toString().length-u.getValueLengthInRange(D),c[S]=x_.replace(D,E.toString()),c[S].identifier={major:S,minor:0},h[S]=new To(e,E,j,T)}return{edits:c,snippets:h}}dispose(){mt(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=El.createEditsAndSnippets(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer);this._snippets=t,this._editor.executeEdits("snippet",e,i=>this._snippets[0].hasPlaceholder?this._move(!0):i.filter(r=>!!r.identifier).map(r=>je.fromPositions(r.range.getEndPosition()))),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=oU){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:r}=El.createEditsAndSnippets(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer);this._editor.executeEdits("snippet",i,s=>{for(const o of this._snippets)o.merge(r);return console.assert(r.length===0),this._snippets[0].hasPlaceholder?this._move(void 0):s.filter(o=>!!o.identifier).map(o=>je.fromPositions(o.range.getEndPosition()))})}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const r=i.move(e);t.push(...r)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(const i of this._snippets){const r=i.computePossibleSelections();if(t.size===0)for(const[s,o]of r){o.sort(V.compareRangesUsingStarts);for(const a of e)if(o[0].containsRange(a)){t.set(s,[]);break}}if(t.size===0)return!1;t.forEach((s,o)=>{s.push(...r.get(o))})}e.sort(V.compareRangesUsingStarts);for(let[i,r]of t){if(r.length!==e.length){t.delete(i);continue}r.sort(V.compareRangesUsingStarts);for(let s=0;s<r.length;s++)if(!r[s].containsRange(e[s])){t.delete(i);continue}}return t.size>0}}var _We=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},aU=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};const lU={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let On=class Ab{constructor(e,t,i){this._editor=e,this._logService=t,this._snippetListener=new ve,this._modelVersionId=-1,this._inSnippet=Ab.InSnippetMode.bindTo(i),this._hasNextTabstop=Ab.HasNextTabstop.bindTo(i),this._hasPrevTabstop=Ab.HasPrevTabstop.bindTo(i)}static get(e){return e.getContribution(Ab.ID)}dispose(){var e;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(e=this._session)===null||e===void 0||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,typeof t>"u"?lU:Object.assign(Object.assign({},lU),t))}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){this._editor.hasModel()&&(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(e,t):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new El(this._editor,e,t),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(i=>i.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState())))}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{choice:e}=this._session;if(!e){this._currentChoice=void 0;return}if(this._currentChoice!==e){this._currentChoice=e,this._editor.setSelections(this._editor.getSelections().map(i=>je.fromPositions(i.getStartPosition())));const[t]=e.options;U8e(this._editor,e.options.map((i,r)=>({kind:13,label:i.value,insertText:i.value,sortText:"a".repeat(r+1),range:V.fromPositions(this._editor.getPosition(),this._editor.getPosition().delta(0,t.value.length))})))}}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),(t=this._session)===null||t===void 0||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session&&this._session.prev(),this._updateState()}next(){this._session&&this._session.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};On.ID="snippetController2";On.InSnippetMode=new Te("inSnippetMode",!1,v("inSnippetMode","Whether the editor in current in snippet mode"));On.HasNextTabstop=new Te("hasNextTabstop",!1,v("hasNextTabstop","Whether there is a next tab stop when in snippet mode"));On.HasPrevTabstop=new Te("hasPrevTabstop",!1,v("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode"));On=_We([aU(1,Ih),aU(2,Xe)],On);Yr(On.ID,On);const l2=mo.bindToContribution(On.get);ye(new l2({id:"jumpToNextSnippetPlaceholder",precondition:Ie.and(On.InSnippetMode,On.HasNextTabstop),handler:n=>n.next(),kbOpts:{weight:100+30,kbExpr:Z.editorTextFocus,primary:2}}));ye(new l2({id:"jumpToPrevSnippetPlaceholder",precondition:Ie.and(On.InSnippetMode,On.HasPrevTabstop),handler:n=>n.prev(),kbOpts:{weight:100+30,kbExpr:Z.editorTextFocus,primary:1026}}));ye(new l2({id:"leaveSnippet",precondition:On.InSnippetMode,handler:n=>n.cancel(!0),kbOpts:{weight:100+30,kbExpr:Z.editorTextFocus,primary:9,secondary:[1033]}}));ye(new l2({id:"acceptSnippet",precondition:On.InSnippetMode,handler:n=>n.finish()}));var bWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},cU=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class PB{constructor(e){this.name=e}select(e,t,i){if(i.length===0)return 0;let r=i[0].score[0];for(let s=0;s<i.length;s++){const{score:o,completion:a}=i[s];if(o[0]!==r)break;if(a.preselect)return s}return 0}}class $ne extends PB{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class vWe extends PB{constructor(){super("recentlyUsed"),this._cache=new W3(300,.66),this._seq=0}memorize(e,t,i){const r=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(r,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(i.length===0)return 0;const r=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(r))return super.select(e,t,i);let s=i[0].score[0],o=-1,a=-1,l=-1;for(let c=0;c<i.length&&i[c].score[0]===s;c++){const h=`${e.getLanguageId()}/${i[c].textLabel}`,u=this._cache.peek(h);if(u&&u.touch>l&&u.type===i[c].completion.kind&&u.insertText===i[c].completion.insertText&&(l=u.touch,a=c),i[c].completion.preselect&&o===-1)return o=c}return a!==-1?a:o!==-1?o:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();let t=0;for(const[i,r]of e)r.touch=t,r.type=typeof r.type=="number"?r.type:ZQ(r.type),this._cache.set(i,r);this._seq=this._cache.size}}class wWe extends PB{constructor(){super("recentlyUsedByPrefix"),this._trie=Dm.forStrings(),this._seq=0}memorize(e,t,i){const{word:r}=e.getWordUntilPosition(t),s=`${e.getLanguageId()}/${r}`;this._trie.set(s,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){let{word:r}=e.getWordUntilPosition(t);if(!r)return super.select(e,t,i);let s=`${e.getLanguageId()}/${r}`,o=this._trie.get(s);if(o||(o=this._trie.findSubstr(s)),o)for(let a=0;a<i.length;a++){let{kind:l,insertText:c}=i[a].completion;if(l===o.type&&c===o.insertText)return a}return super.select(e,t,i)}toJSON(){let e=[];return this._trie.forEach((t,i)=>e.push([i,t])),e.sort((t,i)=>-(t[1].touch-i[1].touch)).forEach((t,i)=>t[1].touch=i),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type=typeof i.type=="number"?i.type:ZQ(i.type),this._trie.set(t,i)}}}let d1=class ox{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new ve,this._persistSoon=new yi(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(i=>{i.reason===XF.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(e,t){var i;const r=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(((i=this._strategy)===null||i===void 0?void 0:i.name)!==r){this._saveState();const s=ox._strategyCtors.get(r)||$ne;this._strategy=new s;try{const a=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,l=this._storageService.get(`${ox._storagePrefix}/${r}`,a);l&&this._strategy.fromJSON(JSON.parse(l))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${ox._storagePrefix}/${this._strategy.name}`,i,t,1)}}};d1._strategyCtors=new Map([["recentlyUsedByPrefix",wWe],["recentlyUsed",vWe],["first",$ne]]);d1._storagePrefix="suggest/memories";d1=bWe([cU(0,Qg),cU(1,Zi)],d1);const zne=Dt("ISuggestMemories");Wg(zne,d1,!0);var yWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},CWe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let f1=class Hne{constructor(e,t){this._editor=e,this._enabled=!1,this._ckAtEnd=Hne.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(110)&&this._update()),this._update()}dispose(){var e;this._configListener.dispose(),(e=this._selectionListener)===null||e===void 0||e.dispose(),this._ckAtEnd.reset()}_update(){const e=this._editor.getOption(110)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){const t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const i=this._editor.getModel(),r=this._editor.getSelection(),s=i.getWordAtPosition(r.getStartPosition());if(!s){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(s.endColumn===r.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};f1.AtEnd=new Te("atEndOfWord",!1);f1=yWe([CWe(1,Xe)],f1);var SWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},xWe=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let Sg=class ax{constructor(e,t){this._editor=e,this._index=0,this._ckOtherSuggestions=ax.OtherSuggestions.bindTo(t)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),(e=this._listener)===null||e===void 0||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},i){if(e.items.length===0){this.reset();return}if(ax._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=i,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,i){let r=i;for(;r=(r+t.items.length+(e?1:-1))%t.items.length,!(r===i||!t.items[r].completion.additionalTextEdits););return r}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=ax._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};Sg.OtherSuggestions=new Te("hasOtherSuggestions",!1);Sg=SWe([xWe(1,Xe)],Sg);class EWe{constructor(e,t,i){this._disposables=new ve,this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(r=>{if(this._active&&!t.isFrozen()){const s=r.charCodeAt(r.length-1);this._active.acceptCharacters.has(s)&&e.getOption(0)&&i(this._active.item)}}))}_onItem(e){if(!e||!tc(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;const t=new q2e;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}var DWe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class Zs{provideSelectionRanges(e,t){return DWe(this,void 0,void 0,function*(){const i=[];for(const r of t){const s=[];i.push(s);const o=new Map;yield new Promise(a=>Zs._bracketsRightYield(a,0,e,r,o)),yield new Promise(a=>Zs._bracketsLeftYield(a,0,e,r,o,s))}return i})}static _bracketsRightYield(e,t,i,r,s){const o=new Map,a=Date.now();for(;;){if(t>=Zs._maxRounds){e();break}if(!r){e();break}let l=i.findNextBracket(r);if(!l){e();break}if(Date.now()-a>Zs._maxDuration){setTimeout(()=>Zs._bracketsRightYield(e,t+1,i,r,s));break}const h=l.close[0];if(l.isOpen){let u=o.has(h)?o.get(h):0;o.set(h,u+1)}else{let u=o.has(h)?o.get(h):0;if(u-=1,o.set(h,Math.max(0,u)),u<0){let d=s.get(h);d||(d=new As,s.set(h,d)),d.push(l.range)}}r=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,r,s,o){const a=new Map,l=Date.now();for(;;){if(t>=Zs._maxRounds&&s.size===0){e();break}if(!r){e();break}let c=i.findPrevBracket(r);if(!c){e();break}if(Date.now()-l>Zs._maxDuration){setTimeout(()=>Zs._bracketsLeftYield(e,t+1,i,r,s,o));break}const u=c.close[0];if(c.isOpen){let d=a.has(u)?a.get(u):0;if(d-=1,a.set(u,Math.max(0,d)),d<0){let f=s.get(u);if(f){let g=f.shift();f.size===0&&s.delete(u);const p=V.fromPositions(c.range.getEndPosition(),g.getStartPosition()),m=V.fromPositions(c.range.getStartPosition(),g.getEndPosition());o.push({range:p}),o.push({range:m}),Zs._addBracketLeading(i,m,o)}}}else{let d=a.has(u)?a.get(u):0;a.set(u,d+1)}r=c.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const r=t.startLineNumber,s=e.getLineFirstNonWhitespaceColumn(r);s!==0&&s!==t.startColumn&&(i.push({range:V.fromPositions(new G(r,s),t.getEndPosition())}),i.push({range:V.fromPositions(new G(r,1),t.getEndPosition())}));const o=r-1;if(o>0){const a=e.getLineFirstNonWhitespaceColumn(o);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(o)&&(i.push({range:V.fromPositions(new G(o,a),t.getEndPosition())}),i.push({range:V.fromPositions(new G(o,1),t.getEndPosition())}))}}}Zs._maxDuration=30;Zs._maxRounds=2;var kWe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class Il{static create(e,t){return kWe(this,void 0,void 0,function*(){if(!t.getOption(105).localityBonus||!t.hasModel())return Il.None;const i=t.getModel(),r=t.getPosition();if(!e.canComputeWordRanges(i.uri))return Il.None;const[s]=yield new Zs().provideSelectionRanges(i,[r]);if(s.length===0)return Il.None;const o=yield e.computeWordRanges(i.uri,s[0].range);if(!o)return Il.None;const a=i.getWordUntilPosition(r);return delete o[a.word],new class extends Il{distance(l,c){if(!r.equals(t.getPosition()))return 0;if(c.kind===17)return 2<<20;let h=typeof c.label=="string"?c.label:c.label.label,u=o[h];if(bJ(u))return 2<<20;let d=X3(u,V.fromPositions(l),V.compareRangesUsingStarts),f=d>=0?u[d]:u[Math.max(0,~d-1)],g=s.length;for(const p of s){if(!V.containsRange(p.range,f))break;g-=1}return g}}})}}Il.None=new class extends Il{distance(){return 0}};class Kd{constructor(e,t,i,r,s,o,a){this.clipboardText=a,this._snippetCompareFn=Kd._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=r,this._options=s,this._refilterKind=1,this._lineContext=i,o==="top"?this._snippetCompareFn=Kd._compareCompletionItemsSnippetsUp:o==="bottom"&&(this._snippetCompareFn=Kd._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}get allProvider(){return this._ensureCachedState(),this._providerInfo.keys()}get incomplete(){this._ensureCachedState();const e=new Set;for(let[t,i]of this._providerInfo)i&&e.add(t);return e}adopt(e){let t=[];for(let i=0;i<this._items.length;)e.has(this._items[i].provider)?i++:(t.push(this._items[i]),this._items[i]=this._items[this._items.length-1],this._items.pop());return this._refilterKind=1,t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._providerInfo=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let r="",s="";const o=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||o.length>2e3?Gw:A4e;for(let c=0;c<o.length;c++){const h=o[c];if(h.isInvalid)continue;this._providerInfo.set(h.provider,!!h.container.incomplete);const u=h.position.column-h.editStart.column,d=u+i-(h.position.column-this._column);if(r.length!==d&&(r=d===0?"":t.slice(-d),s=r.toLowerCase()),h.word=r,d===0)h.score=Va.Default;else{let f=0;for(;f<u;){const g=r.charCodeAt(f);if(g===32||g===9)f+=1;else break}if(f>=d)h.score=Va.Default;else if(typeof h.completion.filterText=="string"){let g=l(r,s,f,h.completion.filterText,h.filterTextLow,0,!1);if(!g)continue;IM(h.completion.filterText,h.textLabel)===0?h.score=g:(h.score=k4e(r,s,f,h.textLabel,h.labelLow,0),h.score[0]=g[0])}else{let g=l(r,s,f,h.textLabel,h.labelLow,0,!1);if(!g)continue;h.score=g}}h.idx=c,h.distance=this._wordDistance.distance(h.position,h.completion),a.push(h),e.push(h.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?XM(e.length-.85,e,(c,h)=>c-h):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return Kd._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return Kd._compareCompletionItems(e,t)}}var LWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Tp=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},IWe=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class Ap{constructor(e,t,i,r){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.auto=i,this.shy=r}static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenizeIfCheap(i.lineNumber);const r=t.getWordAtPosition(i);return!(!r||r.endColumn!==i.column||!isNaN(Number(r.word)))}}function TWe(n,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=t.getValue("editor.inlineSuggest.allowQuickSuggestions");return i!==void 0?!!i:!1}function AWe(n,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=t.getValue("editor.inlineSuggest.allowSuggestOnTriggerCharacters");return i!==void 0?!!i:!1}let KO=class Une{constructor(e,t,i,r,s,o,a){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=r,this._logService=s,this._contextKeyService=o,this._configurationService=a,this._toDispose=new ve,this._quickSuggestDelay=10,this._triggerCharacterListener=new ve,this._triggerQuickSuggest=new Gr,this._state=0,this._completionDisposables=new ve,this._onDidCancel=new H,this._onDidTrigger=new H,this._onDidSuggest=new H,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new je(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()})),this._toDispose.add(Da.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(c=>{this._onCursorChange(c)}));let l=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{l=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{l=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{l||this._refilterCompletionItems()})),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){mt(this._triggerCharacterListener),mt([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getOption(79),(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&this._quickSuggestDelay!==0||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(80)||!this._editor.hasModel()||!this._editor.getOption(108))return;const e=new Map;for(const i of Da.all(this._editor.getModel()))for(const r of i.triggerCharacters||[]){let s=e.get(r);s||(s=new Set,s.add(W8e()),e.set(r,s)),s.add(i)}const t=i=>{if(!AWe(this._editor,this._contextKeyService,this._configurationService)||Ap.shouldAutoTrigger(this._editor))return;if(!i){const o=this._editor.getPosition();i=this._editor.getModel().getLineContent(o.lineNumber).substr(0,o.column-1)}let r="";w_(i.charCodeAt(i.length-1))?Ln(i.charCodeAt(i.length-2))&&(r=i.substr(i.length-2)):r=i.charAt(i.length-1);const s=e.get(r);if(s){const o=this._completionModel?{items:this._completionModel.adopt(s),clipboardText:this._completionModel.clipboardText}:void 0;this.trigger({auto:!0,shy:!1,triggerCharacter:r},!!this._completionModel,s,o)}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(t))}get state(){return this._state}cancel(e=!1){var t;this._state!==0&&(this._triggerQuickSuggest.cancel(),(t=this._requestToken)===null||t===void 0||t.cancel(),this._requestToken=void 0,this._state=0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._state!==0&&(!this._editor.hasModel()||!Da.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._state===2,shy:!1},!0))}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._state===0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._state!==0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._state===0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){this._editor.getOption(78)!==!1&&(this._editor.getOption(105).snippetsPreventQuickSuggestions&&On.get(this._editor).isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._state!==0||!Ap.shouldAutoTrigger(this._editor)||!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=this._editor.getOption(78);if(i!==!1){if(i!==!0){e.tokenizeIfCheap(t.lineNumber);const r=e.getLineTokens(t.lineNumber),s=r.getStandardTokenType(r.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(!(i.other&&s===0||i.comments&&s===1||i.strings&&s===2))return}TWe(this._editor,this._contextKeyService,this._configurationService)&&Da.has(e)&&this.trigger({auto:!0,shy:!1})}},this._quickSuggestDelay)))}_refilterCompletionItems(){Promise.resolve().then(()=>{if(this._state===0||!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=new Ap(e,t,this._state===2,!1);this._onNewContext(i)})}trigger(e,t=!1,i,r){var s;if(!this._editor.hasModel())return;const o=this._editor.getModel(),a=e.auto,l=new Ap(o,this._editor.getPosition(),a,e.shy);this.cancel(t),this._state=a?2:1,this._onDidTrigger.fire({auto:a,shy:e.shy,position:this._editor.getPosition()}),this._context=l;let c={triggerKind:(s=e.triggerKind)!==null&&s!==void 0?s:0};e.triggerCharacter&&(c={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new rl;const h=this._editor.getOption(100);let u=1;switch(h){case"top":u=0;break;case"bottom":u=2;break}const{itemKind:d,showDeprecated:f}=Une._createSuggestFilter(this._editor),g=Il.create(this._editorWorkerService,this._editor),p=Die(o,this._editor.getPosition(),new AD(u,d,i,f),c,this._requestToken.token);Promise.all([p,g]).then(([m,b])=>IWe(this,void 0,void 0,function*(){var _;if((_=this._requestToken)===null||_===void 0||_.dispose(),!this._editor.hasModel())return;let w=r==null?void 0:r.clipboardText;if(!w&&m.needsClipboard&&(w=yield this._clipboardService.readText()),this._state===0)return;const y=this._editor.getModel();let S=m.items;if(r){const C=kie(u);S=S.concat(r.items).sort(C)}const k=new Ap(y,this._editor.getPosition(),a,e.shy);this._completionModel=new Kd(S,this._context.column,{leadingLineContent:k.leadingLineContent,characterCountDelta:k.column-this._context.column},b,this._editor.getOption(105),this._editor.getOption(100),w),this._completionDisposables.add(m.disposable),this._onNewContext(k),this._reportDurationsTelemetry(m.durations)})).catch(it)}_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static _createSuggestFilter(e){const t=new Set;e.getOption(100)==="none"&&t.add(27);const r=e.getOption(105);return r.showMethods||t.add(0),r.showFunctions||t.add(1),r.showConstructors||t.add(2),r.showFields||t.add(3),r.showVariables||t.add(4),r.showClasses||t.add(5),r.showStructs||t.add(6),r.showInterfaces||t.add(7),r.showModules||t.add(8),r.showProperties||t.add(9),r.showEvents||t.add(10),r.showOperators||t.add(11),r.showUnits||t.add(12),r.showValues||t.add(13),r.showConstants||t.add(14),r.showEnums||t.add(15),r.showEnumMembers||t.add(16),r.showKeywords||t.add(17),r.showWords||t.add(18),r.showColors||t.add(19),r.showFiles||t.add(20),r.showReferences||t.add(21),r.showColors||t.add(22),r.showFolders||t.add(23),r.showTypeParameters||t.add(24),r.showSnippets||t.add(27),r.showUsers||t.add(25),r.showIssues||t.add(26),{itemKind:t,showDeprecated:r.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(rn(e.leadingLineContent)!==rn(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.auto,shy:!1},!0):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){const t=new Set(Da.all(this._editor.getModel()));for(let r of this._completionModel.allProvider)t.delete(r);const i=this._completionModel.adopt(new Set);this.trigger({auto:this._context.auto,shy:!1},!0,t,{items:i,clipboardText:this._completionModel.clipboardText});return}if(e.column>this._context.column&&this._completionModel.incomplete.size>0&&e.leadingWord.word.length!==0){const{incomplete:t}=this._completionModel,i=this._completionModel.adopt(t);this.trigger({auto:this._state===2,shy:!1,triggerKind:2},!0,t,{items:i,clipboardText:this._completionModel.clipboardText})}else{let t=this._completionModel.lineContext,i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){if(Ap.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.auto,shy:!1},!0);return}if(this._context.auto){this.cancel();return}else if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,shy:this._context.shy,isFrozen:i})}}}}};KO=LWe([Tp(1,pd),Tp(2,Kg),Tp(3,y0),Tp(4,Ih),Tp(5,Xe),Tp(6,Zi)],KO);class c2{constructor(e,t){this._disposables=new ve,this._lastOvertyped=[],this._empty=!0,this._disposables.add(e.onWillType(()=>{if(!this._empty||!e.hasModel())return;const i=e.getSelections(),r=i.length;let s=!1;for(let a=0;a<r;a++)if(!i[a].isEmpty()){s=!0;break}if(!s)return;this._lastOvertyped=[];const o=e.getModel();for(let a=0;a<r;a++){const l=i[a];if(o.getValueLengthInRange(l)>c2._maxSelectionLength)return;this._lastOvertyped[a]={value:o.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}this._empty=!1})),this._disposables.add(t.onDidCancel(i=>{!this._empty&&!i.retrigger&&(this._empty=!0)}))}getLastOvertypedInfo(e){if(!this._empty&&e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}c2._maxSelectionLength=51200;var NWe=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},UA=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class BB extends H_{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();this.label&&(this.label.textContent=v("ddd","{0} ({1})",this._action.label,BB.symbolPrintEnter(e)))}static symbolPrintEnter(e){var t;return(t=e.getLabel())===null||t===void 0?void 0:t.replace(/\benter\b/gi,"")}}let ZO=class{constructor(e,t,i,r){this._menuService=i,this._contextKeyService=r,this._menuDisposables=new ve,this.element=le(e,me(".suggest-status-bar"));const s=o=>o instanceof Ku?t.createInstance(BB,o,void 0):void 0;this._leftActions=new xh(this.element,{actionViewItemProvider:s}),this._rightActions=new xh(this.element,{actionViewItemProvider:s}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(td,this._contextKeyService),t=()=>{const i=[],r=[];for(let[s,o]of e.getActions())s==="left"?i.push(...o):r.push(...o);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(r)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};ZO=NWe([UA(1,Kt),UA(2,w0),UA(3,Xe)],ZO);const RWe=z("symbolIcon.arrayForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),MWe=z("symbolIcon.booleanForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),FWe=z("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},v("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),OWe=z("symbolIcon.colorForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),PWe=z("symbolIcon.constantForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),BWe=z("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},v("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),VWe=z("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},v("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),WWe=z("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},v("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),$We=z("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},v("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),zWe=z("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},v("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),HWe=z("symbolIcon.fileForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),UWe=z("symbolIcon.folderForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),jWe=z("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},v("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),qWe=z("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},v("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),GWe=z("symbolIcon.keyForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),KWe=z("symbolIcon.keywordForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),ZWe=z("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},v("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),YWe=z("symbolIcon.moduleForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),XWe=z("symbolIcon.namespaceForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),QWe=z("symbolIcon.nullForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),JWe=z("symbolIcon.numberForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),e$e=z("symbolIcon.objectForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),t$e=z("symbolIcon.operatorForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),i$e=z("symbolIcon.packageForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),n$e=z("symbolIcon.propertyForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),r$e=z("symbolIcon.referenceForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),s$e=z("symbolIcon.snippetForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),o$e=z("symbolIcon.stringForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),a$e=z("symbolIcon.structForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),l$e=z("symbolIcon.textForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),c$e=z("symbolIcon.typeParameterForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),h$e=z("symbolIcon.unitForeground",{dark:Oe,light:Oe,hc:Oe},v("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),u$e=z("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},v("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));li((n,e)=>{const t=n.getColor(RWe);t&&e.addRule(`${Ce.symbolArray.cssSelector} { color: ${t}; }`);const i=n.getColor(MWe);i&&e.addRule(`${Ce.symbolBoolean.cssSelector} { color: ${i}; }`);const r=n.getColor(FWe);r&&e.addRule(`${Ce.symbolClass.cssSelector} { color: ${r}; }`);const s=n.getColor(ZWe);s&&e.addRule(`${Ce.symbolMethod.cssSelector} { color: ${s}; }`);const o=n.getColor(OWe);o&&e.addRule(`${Ce.symbolColor.cssSelector} { color: ${o}; }`);const a=n.getColor(PWe);a&&e.addRule(`${Ce.symbolConstant.cssSelector} { color: ${a}; }`);const l=n.getColor(BWe);l&&e.addRule(`${Ce.symbolConstructor.cssSelector} { color: ${l}; }`);const c=n.getColor(VWe);c&&e.addRule(`
			${Ce.symbolValue.cssSelector},${Ce.symbolEnum.cssSelector} { color: ${c}; }`);const h=n.getColor(WWe);h&&e.addRule(`${Ce.symbolEnumMember.cssSelector} { color: ${h}; }`);const u=n.getColor($We);u&&e.addRule(`${Ce.symbolEvent.cssSelector} { color: ${u}; }`);const d=n.getColor(zWe);d&&e.addRule(`${Ce.symbolField.cssSelector} { color: ${d}; }`);const f=n.getColor(HWe);f&&e.addRule(`${Ce.symbolFile.cssSelector} { color: ${f}; }`);const g=n.getColor(UWe);g&&e.addRule(`${Ce.symbolFolder.cssSelector} { color: ${g}; }`);const p=n.getColor(jWe);p&&e.addRule(`${Ce.symbolFunction.cssSelector} { color: ${p}; }`);const m=n.getColor(qWe);m&&e.addRule(`${Ce.symbolInterface.cssSelector} { color: ${m}; }`);const b=n.getColor(GWe);b&&e.addRule(`${Ce.symbolKey.cssSelector} { color: ${b}; }`);const _=n.getColor(KWe);_&&e.addRule(`${Ce.symbolKeyword.cssSelector} { color: ${_}; }`);const w=n.getColor(YWe);w&&e.addRule(`${Ce.symbolModule.cssSelector} { color: ${w}; }`);const y=n.getColor(XWe);y&&e.addRule(`${Ce.symbolNamespace.cssSelector} { color: ${y}; }`);const S=n.getColor(QWe);S&&e.addRule(`${Ce.symbolNull.cssSelector} { color: ${S}; }`);const k=n.getColor(JWe);k&&e.addRule(`${Ce.symbolNumber.cssSelector} { color: ${k}; }`);const C=n.getColor(e$e);C&&e.addRule(`${Ce.symbolObject.cssSelector} { color: ${C}; }`);const D=n.getColor(t$e);D&&e.addRule(`${Ce.symbolOperator.cssSelector} { color: ${D}; }`);const E=n.getColor(i$e);E&&e.addRule(`${Ce.symbolPackage.cssSelector} { color: ${E}; }`);const N=n.getColor(n$e);N&&e.addRule(`${Ce.symbolProperty.cssSelector} { color: ${N}; }`);const T=n.getColor(r$e);T&&e.addRule(`${Ce.symbolReference.cssSelector} { color: ${T}; }`);const j=n.getColor(s$e);j&&e.addRule(`${Ce.symbolSnippet.cssSelector} { color: ${j}; }`);const q=n.getColor(o$e);q&&e.addRule(`${Ce.symbolString.cssSelector} { color: ${q}; }`);const ie=n.getColor(a$e);ie&&e.addRule(`${Ce.symbolStruct.cssSelector} { color: ${ie}; }`);const ge=n.getColor(l$e);ge&&e.addRule(`${Ce.symbolText.cssSelector} { color: ${ge}; }`);const be=n.getColor(c$e);be&&e.addRule(`${Ce.symbolTypeParameter.cssSelector} { color: ${be}; }`);const Se=n.getColor(h$e);Se&&e.addRule(`${Ce.symbolUnit.cssSelector} { color: ${Se}; }`);const Le=n.getColor(u$e);Le&&e.addRule(`${Ce.symbolVariable.cssSelector} { color: ${Le}; }`)});class jne{constructor(){this._onDidWillResize=new H,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new H,this.onDidResize=this._onDidResize.event,this._sashListener=new ve,this._size=new Gt(0,0),this._minSize=new Gt(0,0),this._maxSize=new Gt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Hn(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Hn(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Hn(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:fD.North}),this._southSash=new Hn(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:fD.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(Re.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(Re.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(r=>{e&&(i=r.currentX-r.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(r=>{e&&(i=-(r.currentX-r.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(r=>{e&&(t=-(r.currentY-r.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(r=>{e&&(t=r.currentY-r.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(Re.any(this._eastSash.onDidReset,this._westSash.onDidReset)(r=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(Re.any(this._northSash.onDidReset,this._southSash.onDidReset)(r=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,r){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=r?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:r}=this._minSize,{height:s,width:o}=this._maxSize;e=Math.max(i,Math.min(s,e)),t=Math.max(r,Math.min(o,t));const a=new Gt(t,e);Gt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}var d$e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},f$e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};function VB(n){return!!n&&!!(n.completion.documentation||n.completion.detail&&n.completion.detail!==n.completion.label)}let YO=class{constructor(e,t){this._editor=e,this._onDidClose=new H,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new H,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new ve,this._renderDisposeable=new ve,this._borderWidth=1,this._size=new Gt(330,0),this.domNode=me(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(Cg,{editor:e}),this._body=me(".body"),this._scrollbar=new TL(this._body,{}),le(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=le(this._body,me(".header")),this._close=le(this._header,me("span"+Ce.close.cssSelector)),this._close.title=v("details.close","Close"),this._type=le(this._header,me("p.type")),this._docs=le(this._body,me("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(43)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(43),i=t.getMassagedFontFamily(Yo?Sr.fontFamily:null),r=e.get(106)||t.fontSize,s=e.get(107)||t.lineHeight,o=t.fontWeight,a=`${r}px`,l=`${s}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${s/r}`,this.domNode.style.fontWeight=o,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){const e=this._editor.getOption(107)||this._editor.getOption(43).lineHeight,t=this._borderWidth,i=t*2;return{lineHeight:e,borderWidth:t,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=v("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){var i,r;this._renderDisposeable.clear();let{detail:s,documentation:o}=e.completion;if(t){let a="";a+=`score: ${e.score[0]}
`,a+=`prefix: ${(i=e.word)!==null&&i!==void 0?i:"(no prefix)"}
`,a+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,a+=`distance: ${e.distance} (localityBonus-setting)
`,a+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,a+=`commit_chars: ${(r=e.completion.commitCharacters)===null||r===void 0?void 0:r.join("")}
`,o=new B_().appendCodeblock("empty",a),s=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!VB(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),s){const a=s.length>1e5?`${s.substr(0,1e5)}`:s;this._type.textContent=a,this._type.title=a,Ss(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(a))}else Gn(this._type),this._type.title="",Or(this._type),this.domNode.classList.add("no-type");if(Gn(this._docs),typeof o=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=o;else if(o){this._docs.classList.add("markdown-docs"),Gn(this._docs);const a=this._markdownRenderer.render(o);this._docs.appendChild(a.element),this._renderDisposeable.add(a),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=a=>{a.preventDefault(),a.stopPropagation()},this._close.onclick=a=>{a.preventDefault(),a.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get size(){return this._size}layout(e,t){const i=new Gt(e,t);Gt.equals(i,this._size)||(this._size=i,pke(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};YO=d$e([f$e(1,Kt)],YO);class g$e{constructor(e,t){this.widget=e,this._editor=t,this._disposables=new ve,this._added=!1,this._resizable=new jne,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,r,s=0,o=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,r=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&r){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(o=r.width-a.dimension.width,l=!0),a.north&&(s=r.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+s,left:i.left+o})}a.done&&(i=void 0,r=void 0,s=0,o=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{var a;this._anchorBox&&this._placeAtAnchor(this._anchorBox,(a=this._userSize)!==null&&a!==void 0?a:this.widget.size)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e){var t;const i=jn(e);this._anchorBox=i,this._placeAtAnchor(this._anchorBox,(t=this._userSize)!==null&&t!==void 0?t:this.widget.size)}_placeAtAnchor(e,t){var i;const r=Kk(document.body),s=this.widget.getLayoutInfo(),o=new Gt(220,2*s.lineHeight),a=e.top,l=function(){const _=r.width-(e.left+e.width+s.borderWidth+s.horizontalPadding),w=-s.borderWidth+e.left+e.width,y=new Gt(_,r.height-e.top-s.borderHeight-s.verticalPadding),S=y.with(void 0,e.top+e.height-s.borderHeight-s.verticalPadding);return{top:a,left:w,fit:_-t.width,maxSizeTop:y,maxSizeBottom:S,minSize:o.with(Math.min(_,o.width))}}(),c=function(){const _=e.left-s.borderWidth-s.horizontalPadding,w=Math.max(s.horizontalPadding,e.left-t.width-s.borderWidth),y=new Gt(_,r.height-e.top-s.borderHeight-s.verticalPadding),S=y.with(void 0,e.top+e.height-s.borderHeight-s.verticalPadding);return{top:a,left:w,fit:_-t.width,maxSizeTop:y,maxSizeBottom:S,minSize:o.with(Math.min(_,o.width))}}(),h=function(){const _=e.left,w=-s.borderWidth+e.top+e.height,y=new Gt(e.width-s.borderHeight,r.height-e.top-e.height-s.verticalPadding);return{top:w,left:_,fit:y.height-t.height,maxSizeBottom:y,maxSizeTop:y,minSize:o.with(y.width)}}(),u=[l,c,h],d=(i=u.find(_=>_.fit>=0))!==null&&i!==void 0?i:u.sort((_,w)=>w.fit-_.fit)[0],f=e.top+e.height-s.borderHeight;let g,p=t.height;const m=Math.max(d.maxSizeTop.height,d.maxSizeBottom.height);p>m&&(p=m);let b;p<=d.maxSizeTop.height?(g=!0,b=d.maxSizeTop):(g=!1,b=d.maxSizeBottom),this._applyTopLeft({left:d.left,top:g?d.top:f-p}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!g,d===l,g,d!==l),this._resizable.minSize=d.minSize,this._resizable.maxSize=b,this._resizable.layout(p,Math.min(b.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}}var dh;(function(n){n[n.FILE=0]="FILE",n[n.FOLDER=1]="FOLDER",n[n.ROOT_FOLDER=2]="ROOT_FOLDER"})(dh||(dh={}));function aS(n,e,t,i){const r=i===dh.ROOT_FOLDER?["rootfolder-icon"]:i===dh.FOLDER?["folder-icon"]:["file-icon"];if(t){let s;if(t.scheme===ft.data?s=Uu.parseMetaData(t).get(Uu.META_DATA_LABEL):s=hU(VQ(t).toLowerCase()),i===dh.FOLDER)r.push(`${s}-name-folder-icon`);else{if(s){if(r.push(`${s}-name-file-icon`),s.length<=255){const a=s.split(".");for(let l=1;l<a.length;l++)r.push(`${a.slice(l).join(".")}-ext-file-icon`)}r.push("ext-file-icon")}const o=p$e(n,e,t);o&&r.push(`${hU(o)}-lang-file-icon`)}}return r}function p$e(n,e,t){if(!t)return null;let i=null;if(t.scheme===ft.data){const s=Uu.parseMetaData(t).get(Uu.META_DATA_MIME);s&&(i=e.getModeId(s))}else{const r=n.getModel(t);r&&(i=r.getLanguageId())}return i&&i!==D0?i:e.getModeIdByFilepathOrFirstLine(t)}function hU(n){return n.replace(/[\11\12\14\15\40]/g,"/")}var m$e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},jA=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},lb;function qne(n){return`suggest-aria-id:${n}`}const _$e=ur("suggest-more-info",Ce.chevronRight,v("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),b$e=new(lb=class lx{extract(e,t){if(e.textLabel.match(lx._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(lx._regexStrict))return t[0]=e.completion.detail,!0;if(typeof e.completion.documentation=="string"){const i=lx._regexRelaxed.exec(e.completion.documentation);if(i&&(i.index===0||i.index+i[0].length===e.completion.documentation.length))return t[0]=i[0],!0}return!1}},lb._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,lb._regexStrict=new RegExp(`^${lb._regexRelaxed.source}$`,"i"),lb);let XO=class{constructor(e,t,i,r){this._editor=e,this._modelService=t,this._modeService=i,this._themeService=r,this._onDidToggleDetails=new H,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=Object.create(null);t.disposables=new ve,t.root=e,t.root.classList.add("show-file-icons"),t.icon=le(e,me(".icon")),t.colorspan=le(t.icon,me("span.colorspan"));const i=le(e,me(".contents")),r=le(i,me(".main"));t.iconContainer=le(r,me(".icon-label.codicon")),t.left=le(r,me("span.left")),t.right=le(r,me("span.right")),t.iconLabel=new wB(t.left,{supportHighlights:!0,supportIcons:!0}),t.disposables.add(t.iconLabel),t.parametersLabel=le(t.left,me("span.signature-label")),t.qualifierLabel=le(t.left,me("span.qualifier-label")),t.detailsLabel=le(t.right,me("span.details-label")),t.readMore=le(t.right,me("span.readMore"+mi.asCSSSelector(_$e))),t.readMore.title=v("readMore","Read More");const s=()=>{const o=this._editor.getOptions(),a=o.get(43),l=a.getMassagedFontFamily(Yo?Sr.fontFamily:null),c=a.fontFeatureSettings,h=o.get(106)||a.fontSize,u=o.get(107)||a.lineHeight,d=a.fontWeight,f=`${h}px`,g=`${u}px`;t.root.style.fontSize=f,t.root.style.fontWeight=d,r.style.fontFamily=l,r.style.fontFeatureSettings=c,r.style.lineHeight=g,t.icon.style.height=g,t.icon.style.width=g,t.readMore.style.height=g,t.readMore.style.width=g};return s(),t.disposables.add(this._editor.onDidChangeConfiguration(o=>{(o.hasChanged(43)||o.hasChanged(106)||o.hasChanged(107))&&s()})),t}renderElement(e,t,i){const{completion:r}=e;i.root.id=qne(t),i.colorspan.style.backgroundColor="";const s={labelEscapeNewLines:!0,matches:tB(e.score)};let o=[];if(r.kind===19&&b$e.extract(e,o))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=o[0];else if(r.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const a=aS(this._modelService,this._modeService,qe.from({scheme:"fake",path:e.textLabel}),dh.FILE),l=aS(this._modelService,this._modeService,qe.from({scheme:"fake",path:r.detail}),dh.FILE);s.extraClasses=a.length>l.length?a:l}else r.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",s.extraClasses=Q3([aS(this._modelService,this._modeService,qe.from({scheme:"fake",path:e.textLabel}),dh.FOLDER),aS(this._modelService,this._modeService,qe.from({scheme:"fake",path:r.detail}),dh.FOLDER)])):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...$Le(r.kind).split(" ")));r.tags&&r.tags.indexOf(1)>=0&&(s.extraClasses=(s.extraClasses||[]).concat(["deprecated"]),s.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,s),typeof r.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=qA(r.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=qA(r.label.detail||""),i.detailsLabel.textContent=qA(r.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(105).showInlineDetails?Ss(i.detailsLabel):Or(i.detailsLabel),VB(e)?(i.right.classList.add("can-expand-details"),Ss(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),Or(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};XO=m$e([jA(1,Kr),jA(2,Zr),jA(3,fi)],XO);function qA(n){return n.replace(/\r\n|\r|\n/g,"")}var v$e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},lS=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},w$e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const y$e=z("editorSuggestWidget.background",{dark:ta,light:ta,hc:ta},v("editorSuggestWidgetBackground","Background color of the suggest widget.")),C$e=z("editorSuggestWidget.border",{dark:Af,light:Af,hc:Af},v("editorSuggestWidgetBorder","Border color of the suggest widget.")),S$e=z("editorSuggestWidget.foreground",{dark:ku,light:ku,hc:ku},v("editorSuggestWidgetForeground","Foreground color of the suggest widget.")),x$e=z("editorSuggestWidget.selectedForeground",{dark:US,light:US,hc:US},v("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget.")),E$e=z("editorSuggestWidget.selectedIconForeground",{dark:jS,light:jS,hc:jS},v("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget.")),D$e=z("editorSuggestWidget.selectedBackground",{dark:qS,light:qS,hc:qS},v("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget.")),k$e=z("editorSuggestWidget.highlightForeground",{dark:Om,light:Om,hc:Om},v("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget.")),L$e=z("editorSuggestWidget.focusHighlightForeground",{dark:OT,light:OT,hc:OT},v("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));class I$e{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof vg}`}restore(){var e;const t=(e=this._service.get(this._key,0))!==null&&e!==void 0?e:"";try{const i=JSON.parse(t);if(Gt.is(i))return Gt.lift(i)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}let g1=class QO{constructor(e,t,i,r,s){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new Gr,this._disposables=new ve,this._onDidSelect=new H,this._onDidFocus=new H,this._onDidHide=new H,this._onDidShow=new H,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new H,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new jne,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new T$e(this,e),this._persistedSize=new I$e(t,e);class o{constructor(f,g,p=!1,m=!1){this.persistedSize=f,this.currentSize=g,this.persistHeight=p,this.persistWidth=m}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new o(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(d=>{var f,g,p,m;if(this._resize(d.dimension.width,d.dimension.height),a&&(a.persistHeight=a.persistHeight||!!d.north||!!d.south,a.persistWidth=a.persistWidth||!!d.east||!!d.west),!!d.done){if(a){const{itemHeight:b,defaultSize:_}=this.getLayoutInfo(),w=Math.round(b/2);let{width:y,height:S}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-S)<=w)&&(S=(g=(f=a.persistedSize)===null||f===void 0?void 0:f.height)!==null&&g!==void 0?g:_.height),(!a.persistWidth||Math.abs(a.currentSize.width-y)<=w)&&(y=(m=(p=a.persistedSize)===null||p===void 0?void 0:p.width)!==null&&m!==void 0?m:_.width),this._persistedSize.store(new Gt(y,S))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=le(this.element.domNode,me(".message")),this._listElement=le(this.element.domNode,me(".tree"));const l=s.createInstance(YO,this.editor);l.onDidClose(this.toggleDetails,this,this._disposables),this._details=new g$e(l,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(105).showIcons);c();const h=s.createInstance(XO,this.editor);this._disposables.add(h),this._disposables.add(h.onDidToggleDetails(()=>this.toggleDetails())),this._list=new pc("SuggestWidget",this._listElement,{getHeight:d=>this.getLayoutInfo().itemHeight,getTemplateId:d=>"suggestion"},[h],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,accessibilityProvider:{getRole:()=>"option",getAriaLabel:d=>{if(d.isResolved&&this._isDetailsVisible()){const{documentation:f,detail:g}=d.completion,p=No("{0}{1}",g||"",f?typeof f=="string"?f:f.value:"");return v("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",d.textLabel,p)}else return d.textLabel},getWidgetAriaLabel:()=>v("suggest","Suggest"),getWidgetRole:()=>"listbox"}}),this._status=s.createInstance(ZO,this.element.domNode);const u=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(105).showStatusBar);u(),this._disposables.add(pg(this._list,r,{listInactiveFocusBackground:D$e,listInactiveFocusOutline:Ur})),this._disposables.add(r.onDidColorThemeChange(d=>this._onThemeChange(d))),this._onThemeChange(r.getColorTheme()),this._disposables.add(this._list.onMouseDown(d=>this._onListMouseDownOrTap(d))),this._disposables.add(this._list.onTap(d=>this._onListMouseDownOrTap(d))),this._disposables.add(this._list.onDidChangeSelection(d=>this._onListSelection(d))),this._disposables.add(this._list.onDidChangeFocus(d=>this._onListFocus(d))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(d=>{d.hasChanged(105)&&(u(),c())})),this._ctxSuggestWidgetVisible=ct.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=ct.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=ct.MultipleSuggestions.bindTo(i),this._disposables.add(dn(this._details.widget.domNode,"keydown",d=>{this._onDetailsKeydown.fire(d)})),this._disposables.add(this.editor.onMouseDown(d=>this._onEditorMouseDown(d)))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(e=this._loadingTimeout)===null||e===void 0||e.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onThemeChange(e){const t=e.getColor(y$e);t&&(this.element.domNode.style.backgroundColor=t.toString(),this._messageElement.style.backgroundColor=t.toString(),this._details.widget.domNode.style.backgroundColor=t.toString());const i=e.getColor(C$e);i&&(this.element.domNode.style.borderColor=i.toString(),this._messageElement.style.borderColor=i.toString(),this._status.element.style.borderTopColor=i.toString(),this._details.widget.domNode.style.borderColor=i.toString(),this._detailsBorderColor=i.toString());const r=e.getColor(Yu);r&&(this._detailsFocusBorderColor=r.toString()),this._details.widget.borderWidth=e.type==="hc"?2:1}_onListFocus(e){var t;if(this._ignoreFocusEvents)return;if(!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0});return}if(!this._completionModel)return;const i=e.elements[0],r=e.indexes[0];i!==this._focusedItem&&((t=this._currentSuggestionDetails)===null||t===void 0||t.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=i,this._list.reveal(r),this._currentSuggestionDetails=Hs(s=>w$e(this,void 0,void 0,function*(){const o=b_(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250);s.onCancellationRequested(()=>o.dispose());const a=yield i.resolve(s);return o.dispose(),a})),this._currentSuggestionDetails.then(()=>{r>=this._list.length||i!==this._list.element(r)||(this._ignoreFocusEvents=!0,this._list.splice(r,1,[i]),this._list.setFocus([r]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:qne(r)}))}).catch(it)),this._onDidFocus.fire({item:i,index:r,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:Or(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=QO.LOADING_MESSAGE,Or(this._listElement,this._status.element),Ss(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=QO.NO_SUGGESTIONS_MESSAGE,Or(this._listElement,this._status.element),Ss(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:Or(this._messageElement),Ss(this._listElement,this._status.element),this._show();break;case 4:Or(this._messageElement),Ss(this._listElement,this._status.element),this._show();break;case 5:Or(this._messageElement),Ss(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=b_(()=>this._setState(1),t)))}showSuggestions(e,t,i,r){var s,o;if(this._contentWidget.setPosition(this.editor.getPosition()),(s=this._loadingTimeout)===null||s===void 0||s.dispose(),(o=this._currentSuggestionDetails)===null||o===void 0||o.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&this._state!==2&&this._state!==0){this._setState(4);return}const a=this._completionModel.items.length,l=a===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(a>1),l){this._setState(r?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus([t]),this._layout(this.element.size),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._detailsFocusBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsFocusBorderColor))}toggleDetails(){this._isDetailsVisible()?(this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(VB(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add("shows-details")}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var e;(e=this._loadingTimeout)===null||e===void 0||e.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const t=this._persistedSize.restore(),i=Math.ceil(this.getLayoutInfo().itemHeight*4.3);t&&t.height<i&&this._persistedSize.store(t.with(void 0,i))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&this._details.show(),this._positionDetails())}_layout(e){var t,i,r;if(!this.editor.hasModel()||!this.editor.getDomNode())return;const s=Kk(document.body),o=this.getLayoutInfo();e||(e=o.defaultSize);let a=e.height,l=e.width;if(this._status.element.style.lineHeight=`${o.itemHeight}px`,this._state===2||this._state===1)a=o.itemHeight+o.borderHeight,l=o.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Gt(l,a),this._contentWidget.setPreference(2);else{const c=s.width-o.borderHeight-2*o.horizontalPadding;l>c&&(l=c);const h=this._completionModel?this._completionModel.stats.pLabelLen*o.typicalHalfwidthCharacterWidth:l,u=o.statusBarHeight+this._list.contentHeight+o.borderHeight,d=o.itemHeight+o.statusBarHeight,f=jn(this.editor.getDomNode()),g=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),p=f.top+g.top+g.height,m=Math.min(s.height-p-o.verticalPadding,u),b=f.top+g.top-o.verticalPadding,_=Math.min(b,u);let w=Math.min(Math.max(_,m)+o.borderHeight,u);a===((t=this._cappedHeight)===null||t===void 0?void 0:t.capped)&&(a=this._cappedHeight.wanted),a<d&&(a=d),a>w&&(a=w);const y=150;a>m||this._forceRenderingAbove&&b>y?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),w=_):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),w=m),this.element.preferredSize=new Gt(h,o.defaultSize.height),this.element.maxSize=new Gt(c,w),this.element.minSize=new Gt(220,d),this._cappedHeight=a===u?{wanted:(r=(i=this._cappedHeight)===null||i===void 0?void 0:i.wanted)!==null&&r!==void 0?r:e.height,capped:a}:void 0}this._resize(l,a)}_resize(e,t){const{width:i,height:r}=this.element.maxSize;e=Math.min(i,e),t=Math.min(r,t);const{statusBarHeight:s}=this.getLayoutInfo();this._list.layout(t-s,e),this._listElement.style.height=`${t-s}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode)}getLayoutInfo(){const e=this.editor.getOption(43),t=Ao(this.editor.getOption(107)||e.lineHeight,8,1e3),i=!this.editor.getOption(105).showStatusBar||this._state===2||this._state===1?0:t,r=this._details.widget.borderWidth,s=2*r;return{itemHeight:t,statusBarHeight:i,borderWidth:r,borderHeight:s,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Gt(430,i+12*t+s)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};g1.LOADING_MESSAGE=v("suggestWidget.loading","Loading...");g1.NO_SUGGESTIONS_MESSAGE=v("suggestWidget.noSuggestions","No suggestions.");g1=v$e([lS(1,Qg),lS(2,Xe),lS(3,fi),lS(4,Kt)],g1);class T$e{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:r}=this._widget.getLayoutInfo();return new Gt(t+2*i+r,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}li((n,e)=>{const t=n.getColor(k$e);t&&e.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${t}; }`);const i=n.getColor(L$e);t&&e.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .monaco-highlighted-label .highlight { color: ${i}; }`);const r=n.getColor(S$e);r&&e.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${r}; }`);const s=n.getColor(x$e);s&&e.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused { color: ${s}; }`);const o=n.getColor(E$e);o&&e.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .codicon { color: ${o}; }`);const a=n.getColor(CL);a&&e.addRule(`.monaco-editor .suggest-details a { color: ${a}; }`);const l=n.getColor(SL);l&&e.addRule(`.monaco-editor .suggest-details a:hover { color: ${l}; }`);const c=n.getColor(gee);c&&e.addRule(`.monaco-editor .suggest-details code { background-color: ${c}; }`)});var A$e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},cb=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class N$e{constructor(e,t){if(this._model=e,this._position=t,e.getLineMaxColumn(t.lineNumber)!==t.column){const r=e.getOffsetAt(t),s=e.getPositionAt(r+1);this._marker=e.deltaDecorations([],[{range:V.fromPositions(t,s),options:{description:"suggest-line-suffix",stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}}let Xo=class Gne{constructor(e,t,i,r,s,o){this._memoryService=t,this._commandService=i,this._contextKeyService=r,this._instantiationService=s,this._logService=o,this._lineSuffix=new zs,this._toDispose=new ve,this._selectors=new R$e(h=>h.priority),this.editor=e,this.model=s.createInstance(KO,this.editor);const a=ct.InsertMode.bindTo(r);a.set(e.getOption(105).insertMode),this.model.onDidTrigger(()=>a.set(e.getOption(105).insertMode)),this.widget=this._toDispose.add(new Zb(()=>{const h=this._instantiationService.createInstance(g1,this.editor);this._toDispose.add(h),this._toDispose.add(h.onDidSelect(p=>this._insertSuggestion(p,0),this));const u=new EWe(this.editor,h,p=>this._insertSuggestion(p,2));this._toDispose.add(u),this._toDispose.add(this.model.onDidSuggest(p=>{p.completionModel.items.length===0&&u.reset()}));const d=ct.MakesTextEdit.bindTo(this._contextKeyService),f=ct.HasInsertAndReplaceRange.bindTo(this._contextKeyService),g=ct.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(Et(()=>{d.reset(),f.reset(),g.reset()})),this._toDispose.add(h.onDidFocus(({item:p})=>{const m=this.editor.getPosition(),b=p.editStart.column,_=m.column;let w=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!p.completion.additionalTextEdits&&!(p.completion.insertTextRules&4)&&_-b===p.completion.insertText.length&&(w=this.editor.getModel().getValueInRange({startLineNumber:m.lineNumber,startColumn:b,endLineNumber:m.lineNumber,endColumn:_})!==p.completion.insertText),d.set(w),f.set(!G.equals(p.editInsertEnd,p.editReplaceEnd)),g.set(!!p.provider.resolveCompletionItem||!!p.completion.documentation||p.completion.detail!==p.completion.label)})),this._toDispose.add(h.onDetailsKeyDown(p=>{if(p.toKeybinding().equals(new rg(!0,!1,!1,!1,33))||wt&&p.toKeybinding().equals(new rg(!1,!1,!1,!0,33))){p.stopPropagation();return}p.toKeybinding().isModifierKey()||this.editor.focus()})),h})),this._overtypingCapturer=this._toDispose.add(new Zb(()=>this._toDispose.add(new c2(this.editor,this.model)))),this._alternatives=this._toDispose.add(new Zb(()=>this._toDispose.add(new Sg(this.editor,this._contextKeyService)))),this._toDispose.add(s.createInstance(f1,e)),this._toDispose.add(this.model.onDidTrigger(h=>{this.widget.value.showTriggered(h.auto,h.shy?250:50),this._lineSuffix.value=new N$e(this.editor.getModel(),h.position)})),this._toDispose.add(this.model.onDidSuggest(h=>{if(!h.shy){let u=-1;for(const d of this._selectors.itemsOrderedByPriorityDesc)if(u=d.select(this.editor.getModel(),this.editor.getPosition(),h.completionModel.items),u!==-1)break;u===-1&&(u=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),h.completionModel.items)),this.widget.value.showSuggestions(h.completionModel,u,h.isFrozen,h.auto)}})),this._toDispose.add(this.model.onDidCancel(h=>{h.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));let l=ct.AcceptSuggestionsOnEnter.bindTo(r),c=()=>{const h=this.editor.getOption(1);l.set(h==="on"||h==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>c())),c()}static get(e){return e.getContribution(Gne.ID)}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const i=this.editor.getModel(),r=i.getAlternativeVersionId(),{item:s}=e,o=[],a=new rl;t&1||this.editor.pushUndoStop();const l=this.getOverwriteInfo(s,!!(t&8));if(this._memoryService.memorize(i,this.editor.getPosition(),s),Array.isArray(s.completion.additionalTextEdits)){const h=F_.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",s.completion.additionalTextEdits.map(u=>x_.replace(V.lift(u.range),u.text))),h.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!s.isResolved){const h=new yh(!0);let u;const d=i.onDidChangeContent(m=>{if(m.isFlush){a.cancel(),d.dispose();return}for(let b of m.changes){const _=V.getEndPosition(b.range);(!u||G.isBefore(_,u))&&(u=_)}});let f=t;t|=2;let g=!1,p=this.editor.onWillType(()=>{p.dispose(),g=!0,f&2||this.editor.pushUndoStop()});o.push(s.resolve(a.token).then(()=>{if(!s.completion.additionalTextEdits||a.token.isCancellationRequested||u&&s.completion.additionalTextEdits.some(b=>G.isBefore(u,V.getStartPosition(b.range))))return!1;g&&this.editor.pushUndoStop();const m=F_.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",s.completion.additionalTextEdits.map(b=>x_.replace(V.lift(b.range),b.text))),m.restoreRelativeVerticalPositionOfCursor(this.editor),(g||!(f&2))&&this.editor.pushUndoStop(),!0}).then(m=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",h.elapsed(),m),d.dispose(),p.dispose()}))}let{insertText:c}=s.completion;s.completion.insertTextRules&4||(c=YL.escape(c)),On.get(this.editor).insert(c,{overwriteBefore:l.overwriteBefore,overwriteAfter:l.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(s.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),s.completion.command?s.completion.command.id===Fy.id?this.model.trigger({auto:!0,shy:!1},!0):(o.push(this._commandService.executeCommand(s.completion.command.id,...s.completion.command.arguments?[...s.completion.command.arguments]:[]).catch(it)),this.model.cancel()):this.model.cancel(),t&4&&this._alternatives.value.set(e,h=>{for(a.cancel();i.canUndo();){r!==i.getAlternativeVersionId()&&i.undo(),this._insertSuggestion(h,3|(t&8?8:0));break}}),this._alertCompletionItem(s),Promise.all(o).finally(()=>{this.model.clear(),a.dispose()})}getOverwriteInfo(e,t){ji(this.editor.hasModel());let i=this.editor.getOption(105).insertMode==="replace";t&&(i=!i);const r=e.position.column-e.editStart.column,s=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,o=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:r+o,overwriteAfter:s+a}}_alertCompletionItem(e){if(tc(e.completion.additionalTextEdits)){let t=v("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);Hg(t)}}triggerSuggest(e){this.editor.hasModel()&&(this.model.trigger({auto:!1,shy:!1},!1,e),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},r=s=>{if(s.completion.insertTextRules&4||s.completion.additionalTextEdits)return!0;const o=this.editor.getPosition(),a=s.editStart.column,l=o.column;return l-a!==s.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:o.lineNumber,startColumn:a,endLineNumber:o.lineNumber,endColumn:l})!==s.completion.insertText};Re.once(this.model.onDidTrigger)(s=>{let o=[];Re.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{mt(o),i()},void 0,o),this.model.onDidSuggest(({completionModel:a})=>{if(mt(o),a.items.length===0){i();return}const l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),c=a.items[l];if(!r(c)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:c,model:a},7)},void 0,o)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let r=0;e&&(r|=4),t&&(r|=8),this._insertSuggestion(i,r)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};Xo.ID="editor.contrib.suggestController";Xo=A$e([cb(1,zne),cb(2,An),cb(3,Xe),cb(4,Kt),cb(5,Ih)],Xo);class R$e{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,i)=>this.prioritySelector(i)-this.prioritySelector(t)),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class Fy extends Si{constructor(){super({id:Fy.id,label:v("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:Ie.and(Z.writable,Z.hasCompletionItemProvider),kbOpts:{kbExpr:Z.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t){const i=Xo.get(t);i&&i.triggerSuggest()}}Fy.id="editor.action.triggerSuggest";Yr(Xo.ID,Xo);pt(Fy);const wo=100+90,ms=mo.bindToContribution(Xo.get);ye(new ms({id:"acceptSelectedSuggestion",precondition:ct.Visible,handler(n){n.acceptSelectedSuggestion(!0,!1)}}));xr.registerKeybindingRule({id:"acceptSelectedSuggestion",when:Ie.and(ct.Visible,Z.textInputFocus),primary:2,weight:wo});xr.registerKeybindingRule({id:"acceptSelectedSuggestion",when:Ie.and(ct.Visible,Z.textInputFocus,ct.AcceptSuggestionsOnEnter,ct.MakesTextEdit),primary:3,weight:wo});Pa.appendMenuItem(td,{command:{id:"acceptSelectedSuggestion",title:v("accept.insert","Insert")},group:"left",order:1,when:ct.HasInsertAndReplaceRange.toNegated()});Pa.appendMenuItem(td,{command:{id:"acceptSelectedSuggestion",title:v("accept.insert","Insert")},group:"left",order:1,when:Ie.and(ct.HasInsertAndReplaceRange,ct.InsertMode.isEqualTo("insert"))});Pa.appendMenuItem(td,{command:{id:"acceptSelectedSuggestion",title:v("accept.replace","Replace")},group:"left",order:1,when:Ie.and(ct.HasInsertAndReplaceRange,ct.InsertMode.isEqualTo("replace"))});ye(new ms({id:"acceptAlternativeSelectedSuggestion",precondition:Ie.and(ct.Visible,Z.textInputFocus),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:1027,secondary:[1026]},handler(n){n.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:td,group:"left",order:2,when:Ie.and(ct.HasInsertAndReplaceRange,ct.InsertMode.isEqualTo("insert")),title:v("accept.replace","Replace")},{menuId:td,group:"left",order:2,when:Ie.and(ct.HasInsertAndReplaceRange,ct.InsertMode.isEqualTo("replace")),title:v("accept.insert","Insert")}]}));Pt.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");ye(new ms({id:"hideSuggestWidget",precondition:ct.Visible,handler:n=>n.cancelSuggestWidget(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:9,secondary:[1033]}}));ye(new ms({id:"selectNextSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectNextSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));ye(new ms({id:"selectNextPageSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectNextPageSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:12,secondary:[2060]}}));ye(new ms({id:"selectLastSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectLastSuggestion()}));ye(new ms({id:"selectPrevSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectPrevSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));ye(new ms({id:"selectPrevPageSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectPrevPageSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:11,secondary:[2059]}}));ye(new ms({id:"selectFirstSuggestion",precondition:Ie.and(ct.Visible,ct.MultipleSuggestions),handler:n=>n.selectFirstSuggestion()}));ye(new ms({id:"toggleSuggestionDetails",precondition:ct.Visible,handler:n=>n.toggleSuggestionDetails(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:td,group:"right",order:1,when:Ie.and(ct.DetailsVisible,ct.CanResolve),title:v("detail.more","show less")},{menuId:td,group:"right",order:1,when:Ie.and(ct.DetailsVisible.toNegated(),ct.CanResolve),title:v("detail.less","show more")}]}));ye(new ms({id:"toggleExplainMode",precondition:ct.Visible,handler:n=>n.toggleExplainMode(),kbOpts:{weight:100,primary:2133}}));ye(new ms({id:"toggleSuggestionFocus",precondition:ct.Visible,handler:n=>n.toggleSuggestionFocus(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:2570,mac:{primary:778}}}));ye(new ms({id:"insertBestCompletion",precondition:Ie.and(Z.textInputFocus,Ie.equals("config.editor.tabCompletion","on"),f1.AtEnd,ct.Visible.toNegated(),Sg.OtherSuggestions.toNegated(),On.InSnippetMode.toNegated()),handler:(n,e)=>{n.triggerSuggestAndAcceptBest(Br(e)?Object.assign({fallback:"tab"},e):{fallback:"tab"})},kbOpts:{weight:wo,primary:2}}));ye(new ms({id:"insertNextSuggestion",precondition:Ie.and(Z.textInputFocus,Ie.equals("config.editor.tabCompletion","on"),Sg.OtherSuggestions,ct.Visible.toNegated(),On.InSnippetMode.toNegated()),handler:n=>n.acceptNextSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:2}}));ye(new ms({id:"insertPrevSuggestion",precondition:Ie.and(Z.textInputFocus,Ie.equals("config.editor.tabCompletion","on"),Sg.OtherSuggestions,ct.Visible.toNegated(),On.InSnippetMode.toNegated()),handler:n=>n.acceptPrevSuggestion(),kbOpts:{weight:wo,kbExpr:Z.textInputFocus,primary:1026}}));pt(class extends Si{constructor(){super({id:"editor.action.resetSuggestSize",label:v("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(n,e){Xo.get(e).resetWidgetSize()}});function M$e(n,e){return{object:n,dispose:()=>e==null?void 0:e.dispose()}}function F$e(n,e){return(t,i)=>e(n(t),n(i))}function O$e(){return(n,e)=>n-e}function P$e(n,e){let t;for(const i of n)(t===void 0||e(i,t)>0)&&(t=i);return t}class B$e extends re{constructor(e,t){super(),this.editor=e,this.suggestControllerPreselector=t,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentInlineCompletion=void 0,this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new yi(()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())},100)),this._register(e.onKeyDown(r=>{r.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(r=>{r.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const i=Xo.get(this.editor);if(i){this._register(i.registerSelector({priority:100,select:(o,a,l)=>{const c=this.editor.getModel(),h=OD(c,this.suggestControllerPreselector());if(!h)return-1;const u=G.lift(a),d=l.map((g,p)=>{const m=uU(i,u,g,this.isShiftKeyPressed),b=OD(c,m);if(!b)return;const _=V$e(h.range,b.range)&&h.text.startsWith(b.text);return{index:p,valid:_,prefixLength:b.text.length,suggestItem:g}}).filter(g=>g&&g.valid),f=P$e(d,F$e(g=>g.prefixLength,O$e()));return f?f.index:-1}}));let r=!1;const s=()=>{r||(r=!0,this._register(i.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(i.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)})),this._register(i.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(Re.once(i.model.onDidTrigger)(o=>{s()}))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItemAsInlineCompletion:this._currentInlineCompletion}}update(e){const t=this.getInlineCompletion();let i=!1;JVe(this._currentInlineCompletion,t)||(this._currentInlineCompletion=t,i=!0),this._isActive!==e&&(this._isActive=e,i=!0),i&&this.onDidChangeEmitter.fire()}getInlineCompletion(){const e=Xo.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem();if(t)return uU(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){const e=Xo.get(this.editor);e&&e.stopForceRenderingAbove()}forceRenderingAbove(){const e=Xo.get(this.editor);e&&e.forceRenderingAbove()}}function V$e(n,e){return n.startLineNumber===e.startLineNumber&&n.startColumn===e.startColumn&&(n.endLineNumber<e.endLineNumber||n.endLineNumber===e.endLineNumber&&n.endColumn<=e.endColumn)}function uU(n,e,t,i){if(Array.isArray(t.completion.additionalTextEdits)&&t.completion.additionalTextEdits.length>0)return{text:"",range:V.fromPositions(e,e)};let{insertText:r}=t.completion;if(t.completion.insertTextRules&4){const o=new YL().parse(r),a=n.editor.getModel();if(o.children.length>100)return;El.adjustWhitespace(a,e,o,!0,!0),r=o.toString()}const s=n.getOverwriteInfo(t,i);return{text:r,range:V.fromPositions(e.delta(0,-s.overwriteBefore),e.delta(0,Math.max(s.overwriteAfter,0)))}}var dU=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class W$e extends Pne{constructor(e,t){super(e),this.cache=t,this.suggestionInlineCompletionSource=this._register(new B$e(this.editor,()=>{var i,r;return(r=(i=this.cache.value)===null||i===void 0?void 0:i.completions[0])===null||r===void 0?void 0:r.toLiveInlineCompletion()})),this.updateOperation=this._register(new zs),this.updateCacheSoon=this._register(new yi(()=>this.updateCache(),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange(()=>{this.updateCacheSoon.schedule(),this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);const r=this.ghostText;r&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,$$e(r.parts.map(s=>s.lines.length-1)))),this.minReservedLineCount>=1&&this.isSuggestionPreviewEnabled()?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()})),this._register(this.cache.onDidChange(()=>{this.onDidChangeEmitter.fire()})),this._register(this.editor.onDidChangeCursorPosition(i=>{this.isSuggestionPreviewEnabled()&&(this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire())})),this._register(Et(()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove()))}get isActive(){return this.suggestionInlineCompletionSource.state!==void 0}isSuggestionPreviewEnabled(){return this.editor.getOption(105).preview}updateCache(){return dU(this,void 0,void 0,function*(){const e=this.suggestionInlineCompletionSource.state;if(!e||!e.selectedItemAsInlineCompletion)return;const t={text:e.selectedItemAsInlineCompletion.text,range:e.selectedItemAsInlineCompletion.range},i=this.editor.getPosition(),r=Hs(o=>dU(this,void 0,void 0,function*(){let a;try{a=yield Wne(i,this.editor.getModel(),{triggerKind:Js.Automatic,selectedSuggestionInfo:t},o)}catch(l){it(l);return}o.isCancellationRequested||(this.cache.setValue(this.editor,a,Js.Automatic),this.onDidChangeEmitter.fire())})),s=new Vne(r,Js.Automatic);this.updateOperation.value=s,yield r,this.updateOperation.value===s&&this.updateOperation.clear()})}get ghostText(){var e,t;if(!this.isSuggestionPreviewEnabled())return;const i=this.suggestionInlineCompletionSource.state,r=OD(this.editor.getModel(),i==null?void 0:i.selectedItemAsInlineCompletion),s=OD(this.editor.getModel(),(t=(e=this.cache.value)===null||e===void 0?void 0:e.completions[0])===null||t===void 0?void 0:t.toLiveInlineCompletion()),o=s&&r&&s.text.startsWith(r.text)&&s.range.equalsRange(r.range)?s:r||s,a=r?((o==null?void 0:o.text.length)||0)-r.text.length:0;return(h=>{const u=this.editor.getOptions().get(105).previewMode;return h?Bne(h,this.editor.getModel(),u,this.editor.getPosition(),a)||new One(h.range.endLineNumber,[],this.minReservedLineCount):void 0})(o)}}function $$e(n){return n.reduce((e,t)=>e+t,0)}var z$e=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},H$e=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},U$e=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};class j$e extends re{constructor(){super(...arguments),this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new zs)}get targetModel(){var e;return(e=this.currentModelRef.value)===null||e===void 0?void 0:e.object}setTargetModel(e){var t;((t=this.currentModelRef.value)===null||t===void 0?void 0:t.object)!==e&&(this.currentModelRef.clear(),this.currentModelRef.value=e?M$e(e,e.onDidChange(()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()})):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}get ghostText(){var e,t;return this.hasCachedGhostText||(this.cachedGhostText=(t=(e=this.currentModelRef.value)===null||e===void 0?void 0:e.object)===null||t===void 0?void 0:t.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}setExpanded(e){var t;(t=this.targetModel)===null||t===void 0||t.setExpanded(e)}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}}let JO=class extends j$e{constructor(e,t){super(),this.editor=e,this.commandService=t,this.sharedCache=this._register(new q$e),this.suggestWidgetAdapterModel=this._register(new W$e(this.editor,this.sharedCache)),this.inlineCompletionsModel=this._register(new qO(this.editor,this.sharedCache,this.commandService)),this._register(this.suggestWidgetAdapterModel.onDidChange(()=>{this.updateModel()})),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(e){var t;const i=(t=this.activeInlineCompletionsModel)===null||t===void 0?void 0:t.ghostText;return i?i.parts.some(r=>e.containsPosition(new G(i.lineNumber,r.column))):!1}triggerInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)===null||e===void 0||e.trigger(Js.Explicit)}commitInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)===null||e===void 0||e.commitCurrentSuggestion()}hideInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)===null||e===void 0||e.hide()}showNextInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)===null||e===void 0||e.showNext()}showPreviousInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)===null||e===void 0||e.showPrevious()}hasMultipleInlineCompletions(){var e;return U$e(this,void 0,void 0,function*(){const t=yield(e=this.activeInlineCompletionsModel)===null||e===void 0?void 0:e.hasMultipleInlineCompletions();return t!==void 0?t:!1})}};JO=z$e([H$e(1,An)],JO);class q$e extends re{constructor(){super(...arguments),this.onDidChangeEmitter=new H,this.onDidChange=this.onDidChangeEmitter.event,this.cache=this._register(new zs)}get value(){return this.cache.value}setValue(e,t,i){this.cache.value=new sWe(e,t,()=>this.onDidChangeEmitter.fire(),i)}clearAndLeak(){return this.cache.clearAndLeak()}clear(){this.cache.clear()}}var Kne=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Lv=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},GA;const fU=(GA=window.trustedTypes)===null||GA===void 0?void 0:GA.createPolicy("editorGhostText",{createHTML:n=>n});let eP=class extends re{constructor(e,t,i,r){super(),this.editor=e,this.model=t,this.instantiationService=i,this.modeService=r,this.disposed=!1,this.partsWidget=this._register(this.instantiationService.createInstance(tP,this.editor)),this.additionalLinesWidget=this._register(new G$e(this.editor,this.modeService.languageIdCodec)),this.viewMoreContentWidget=void 0,this._register(this.editor.onDidChangeConfiguration(s=>{(s.hasChanged(29)||s.hasChanged(104)||s.hasChanged(87)||s.hasChanged(82)||s.hasChanged(44)||s.hasChanged(43)||s.hasChanged(58))&&this.update()})),this._register(Et(()=>{var s;this.disposed=!0,this.update(),(s=this.viewMoreContentWidget)===null||s===void 0||s.dispose(),this.viewMoreContentWidget=void 0})),this._register(t.onDidChange(()=>{this.update()})),this.update()}shouldShowHoverAtViewZone(e){return this.additionalLinesWidget.viewZoneId===e}update(){var e;const t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed){this.partsWidget.clear(),this.additionalLinesWidget.clear();return}const i=new Array,r=new Array;function s(c,h){if(r.length>0){const u=r[r.length-1];h&&u.decorations.push(new Ns(u.content.length+1,u.content.length+1+c[0].length,h,0)),u.content+=c[0],c=c.slice(1)}for(const u of c)r.push({content:u,decorations:h?[new Ns(1,u.length+1,h,0)]:[]})}const o=this.editor.getModel().getLineContent(t.lineNumber);this.editor.getModel().getLineTokens(t.lineNumber);let a,l=0;for(const c of t.parts){let h=c.lines;a===void 0?(i.push({column:c.column,text:h[0],preview:c.preview}),h=h.slice(1)):s([o.substring(l,c.column-1)],void 0),h.length>0&&(s(h,"ghost-text"),a===void 0&&c.column<=o.length&&(a=c.column)),l=c.column-1}a!==void 0&&s([o.substring(l)],void 0),this.partsWidget.setParts(t.lineNumber,i,a!==void 0?{column:a,length:o.length+1-a}:void 0),this.additionalLinesWidget.updateLines(t.lineNumber,r,t.additionalReservedLineCount),t.parts.some(c=>c.lines.length<0)?this.viewMoreContentWidget=this.renderViewMoreLines(new G(t.lineNumber,this.editor.getModel().getLineMaxColumn(t.lineNumber)),"",0):((e=this.viewMoreContentWidget)===null||e===void 0||e.dispose(),this.viewMoreContentWidget=void 0)}renderViewMoreLines(e,t,i){const r=this.editor.getOption(43),s=document.createElement("div");s.className="suggest-preview-additional-widget",Yn.applyFontInfoSlow(s,r);const o=document.createElement("span");o.className="content-spacer",o.append(t),s.append(o);const a=document.createElement("span");a.className="content-newline suggest-preview-text",a.append("  "),s.append(a);const l=new ve,c=document.createElement("div");return c.className="button suggest-preview-text",c.append(`+${i} lines`),l.add(dn(c,"mousedown",h=>{var u;(u=this.model)===null||u===void 0||u.setExpanded(!0),h.preventDefault(),this.editor.focus()})),s.append(c),new X$e(this.editor,e,s,l)}};eP=Kne([Lv(2,Kt),Lv(3,Zr)],eP);let tP=class{constructor(e,t,i,r){this.editor=e,this.codeEditorService=t,this.themeService=i,this.contextKeyService=r,this.decorationIds=[],this.disposableStore=new ve}dispose(){this.clear(),this.disposableStore.dispose()}clear(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}setParts(e,t,i){this.disposableStore.clear();const r=this.themeService.getColorTheme(),s=r.getColor(Oee);let o,a;s&&(o=String(s.rgba.a),a=X.Format.CSS.format(Zne(s)));const l=r.getColor(Fee);let c;l&&(c=`2px dashed ${l}`);const h=this.editor.getModel();if(!h)return;const{tabSize:u}=h.getOptions(),d=h.getLineContent(e)||"";let f=0,g="";const p=new Array;i&&p.push({range:V.fromPositions(new G(e,i.column),new G(e,i.column+i.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});const m=this.contextKeyService.getContextKeyValue("config.editor.useInjectedText"),b=m===void 0?!0:!!m;this.decorationIds=this.editor.deltaDecorations(this.decorationIds,t.map(_=>{g+=d.substring(f,_.column-1),f=_.column-1;const w=b?_.text:this.renderSingleLineText(_.text,g,u,!1),y=this.disposableStore.add(Y$e(this.codeEditorService,"ghost-text","0-ghost-text-",{after:{contentText:w,opacity:o,color:a,border:c,fontWeight:_.preview?"bold":"normal"}}));return{range:V.fromPositions(new G(e,_.column)),options:b?{description:"ghost-text",after:{content:w,inlineClassName:_.preview?"ghost-text-decoration-preview":"ghost-text-decoration"},showIfCollapsed:!0}:Object.assign({},y.resolve())}}).concat(p))}renderSingleLineText(e,t,i,r){const s=t+e,o=Mt.visibleColumnsByColumns(s,i);let a="",l=t.length+1;for(const c of e){if(c==="	"){const h=o[l+1]-o[l];if(r){a+="";for(let u=1;u<h;u++)a+=""}else for(let u=0;u<h;u++)a+=""}else c===" "?r?a+="":a+="":a+=c;l+=1}return a}};tP=Kne([Lv(1,ui),Lv(2,fi),Lv(3,Xe)],tP);function Zne(n){const{r:e,b:t,g:i}=n.rgba;return new X(new ht(e,i,t,255))}class G$e{constructor(e,t){this.editor=e,this.languageIdCodec=t,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones(e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(e,t,i){const r=this.editor.getModel();if(!r)return;const{tabSize:s}=r.getOptions();this.editor.changeViewZones(o=>{this._viewZoneId&&(o.removeZone(this._viewZoneId),this._viewZoneId=void 0);const a=Math.max(t.length,i);if(a>0){const l=document.createElement("div");K$e(l,s,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=o.addZone({afterLineNumber:e,heightInLines:a,domNode:l})}})}}function K$e(n,e,t,i,r){const s=i.get(29),o=i.get(104),a="none",l=i.get(82),c=i.get(44),h=i.get(43),u=i.get(58),d=og(1e4);d.appendASCIIString('<div class="suggest-preview-text">');for(let p=0,m=t.length;p<m;p++){const b=t[p],_=b.content;d.appendASCIIString('<div class="view-line'),d.appendASCIIString('" style="top:'),d.appendASCIIString(String(p*u)),d.appendASCIIString('px;width:1000000px;">');const w=B3(_),y=Zk(_),S=In.createEmpty(_,r);sL(new $g(h.isMonospace&&!s,h.canUseHalfwidthRightwardsArrow,_,!1,w,y,0,S,b.decorations,e,0,h.spaceWidth,h.middotWidth,h.wsmiddotWidth,o,a,l,c!==Cs.OFF,null),d),d.appendASCIIString("</div>")}d.appendASCIIString("</div>"),Yn.applyFontInfoSlow(n,h);const f=d.build(),g=fU?fU.createHTML(f):f;n.innerHTML=g}let Z$e=0;function Y$e(n,e,t,i){const r=t+Z$e++;return n.registerDecorationType(e,r,i),{dispose(){n.removeDecorationType(r)},resolve(){return n.resolveDecorationOptions(r,!0)}}}class X$e extends re{constructor(e,t,i,r){super(),this.editor=e,this.position=t,this.domNode=i,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(r),this._register(Et(()=>{this.editor.removeContentWidget(this)})),this.editor.addContentWidget(this)}getId(){return"editor.widget.viewMoreLinesWidget"}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}}li((n,e)=>{const t=n.getColor(Oee);if(t){const r=String(t.rgba.a),s=X.Format.CSS.format(Zne(t));e.addRule(`.monaco-editor .ghost-text-decoration { opacity: ${r} !important; color: ${s} !important; }`),e.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${t.toString()} !important; }`),e.addRule(`.monaco-editor .suggest-preview-text .ghost-text { opacity: ${r} !important; color: ${s} !important; }`)}const i=n.getColor(Fee);i&&(e.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${i}; }`),e.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${i}; }`),e.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${i}; }`))});var Yne=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},iP=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},h2=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};let yn=class Xne extends re{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.triggeredExplicitly=!1,this.activeController=this._register(new zs),this._register(this.editor.onDidChangeModel(()=>{this.updateModelController()})),this._register(this.editor.onDidChangeConfiguration(i=>{i.hasChanged(105)&&this.updateModelController(),i.hasChanged(54)&&this.updateModelController()})),this.updateModelController()}static get(e){return e.getContribution(Xne.ID)}get activeModel(){var e;return(e=this.activeController.value)===null||e===void 0?void 0:e.model}updateModelController(){const e=this.editor.getOption(105),t=this.editor.getOption(54);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(nP,this.editor):void 0}shouldShowHoverAt(e){var t;return((t=this.activeModel)===null||t===void 0?void 0:t.shouldShowHoverAt(e))||!1}shouldShowHoverAtViewZone(e){var t,i;return((i=(t=this.activeController.value)===null||t===void 0?void 0:t.widget)===null||i===void 0?void 0:i.shouldShowHoverAtViewZone(e))||!1}trigger(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),(e=this.activeModel)===null||e===void 0||e.triggerInlineCompletion()}commit(){var e;(e=this.activeModel)===null||e===void 0||e.commitInlineCompletion()}hide(){var e;(e=this.activeModel)===null||e===void 0||e.hideInlineCompletion()}showNextInlineCompletion(){var e;(e=this.activeModel)===null||e===void 0||e.showNextInlineCompletion()}showPreviousInlineCompletion(){var e;(e=this.activeModel)===null||e===void 0||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return h2(this,void 0,void 0,function*(){const t=yield(e=this.activeModel)===null||e===void 0?void 0:e.hasMultipleInlineCompletions();return t!==void 0?t:!1})}};yn.inlineSuggestionVisible=new Te("inlineSuggestionVisible",!1,v("inlineSuggestionVisible","Whether an inline suggestion is visible"));yn.inlineSuggestionHasIndentation=new Te("inlineSuggestionHasIndentation",!1,v("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace"));yn.inlineSuggestionHasIndentationLessThanTabSize=new Te("inlineSuggestionHasIndentationLessThanTabSize",!0,v("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab"));yn.ID="editor.contrib.ghostTextController";yn=Yne([iP(1,Kt)],yn);class Q$e{constructor(e){this.contextKeyService=e,this.inlineCompletionVisible=yn.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=yn.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=yn.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)}}let nP=class extends re{constructor(e,t,i){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.contextKeys=new Q$e(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(JO,this.editor)),this.widget=this._register(this.instantiationService.createInstance(eP,this.editor,this.model)),this._register(Et(()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)})),this._register(this.model.onDidChange(()=>{this.updateContextKeys()})),this.updateContextKeys()}updateContextKeys(){var e;this.contextKeys.inlineCompletionVisible.set(((e=this.model.activeInlineCompletionsModel)===null||e===void 0?void 0:e.ghostText)!==void 0);let t=!1,i=!0;const r=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&r&&r.parts.length>0){const{column:s,lines:o}=r.parts[0],a=o[0],l=this.editor.getModel().getLineIndentColumn(r.lineNumber);if(s<=l){let h=cs(a);h===-1&&(h=a.length-1),t=h>0;const u=this.editor.getModel().getOptions().tabSize;i=Mt.visibleColumnFromColumn(a,h+1,u)<u}}this.contextKeys.inlineCompletionSuggestsIndentation.set(t),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(i)}};nP=Yne([iP(1,Kt),iP(2,Xe)],nP);const Qne=mo.bindToContribution(yn.get),p1=new Qne({id:Fne,precondition:yn.inlineSuggestionVisible,handler(n){n.commit(),n.editor.focus()}});ye(p1);xr.registerKeybindingRule({primary:2,weight:200,id:p1.id,when:Ie.and(p1.precondition,Z.tabMovesFocus.toNegated(),yn.inlineSuggestionHasIndentationLessThanTabSize)});ye(new Qne({id:"editor.action.inlineSuggest.hide",precondition:yn.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler(n){n.hide()}}));class G_ extends Si{constructor(){super({id:G_.ID,label:v("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:Ie.and(Z.writable,yn.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(e,t){return h2(this,void 0,void 0,function*(){const i=yn.get(t);i&&(i.showNextInlineCompletion(),t.focus())})}}G_.ID="editor.action.inlineSuggest.showNext";class K_ extends Si{constructor(){super({id:K_.ID,label:v("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:Ie.and(Z.writable,yn.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(e,t){return h2(this,void 0,void 0,function*(){const i=yn.get(t);i&&(i.showPreviousInlineCompletion(),t.focus())})}}K_.ID="editor.action.inlineSuggest.showPrevious";class J$e extends Si{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:v("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:Z.writable})}run(e,t){return h2(this,void 0,void 0,function*(){const i=yn.get(t);i&&i.trigger()})}}Yr(yn.ID,yn);pt(J$e);pt(G_);pt(K_);var eze=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},Np=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};class tze{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}}let rP=class{constructor(e,t,i,r,s,o,a,l){this._editor=e,this._hover=t,this._commandService=i,this._menuService=r,this._contextKeyService=s,this._modeService=o,this._openerService=a,this.accessibilityService=l}suggestHoverAnchor(e){const t=yn.get(this._editor);if(!t)return null;if(e.target.type===8){const i=e.target.detail;if(t.shouldShowHoverAtViewZone(i.viewZoneId))return new FA(1e3,this,V.fromPositions(i.positionBefore||i.position,i.positionBefore||i.position))}return e.target.type===7&&e.target.range&&t.shouldShowHoverAt(e.target.range)?new FA(1e3,this,e.target.range):e.target.type===6&&e.target.range&&e.target.detail&&e.target.detail.mightBeForeignElement&&t.shouldShowHoverAt(e.target.range)?new FA(1e3,this,e.target.range):null}computeSync(e,t){const i=yn.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new tze(this,e.range,i)]:[]}renderHoverParts(e,t,i){const r=new ve,s=e[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(s,t,r);const o=r.add(this._menuService.createMenu(Ye.InlineCompletionsActions,this._contextKeyService)),a=i.addAction({label:v("showNextInlineSuggestion","Next"),commandId:G_.ID,run:()=>this._commandService.executeCommand(G_.ID)}),l=i.addAction({label:v("showPreviousInlineSuggestion","Previous"),commandId:K_.ID,run:()=>this._commandService.executeCommand(K_.ID)});i.addAction({label:v("acceptInlineSuggestion","Accept"),commandId:p1.id,run:()=>this._commandService.executeCommand(p1.id)});const c=[a,l];for(const h of c)h.setEnabled(!1);s.hasMultipleSuggestions().then(h=>{for(const u of c)u.setEnabled(h)});for(const[h,u]of o.getActions())for(const d of u)d instanceof Ku&&i.addAction({label:d.label,commandId:d.item.id,run:()=>this._commandService.executeCommand(d.item.id)});return r}renderScreenReaderText(e,t,i){var r,s;const o=me,a=o("div.hover-row.markdown-hover"),l=le(a,o("div.hover-contents")),c=i.add(new Cg({editor:this._editor},this._modeService,this._openerService)),h=d=>{i.add(c.onDidRenderAsync(()=>{l.className="hover-contents code-hover-contents",this._hover.onContentsChanged()}));const f=v("inlineSuggestionFollows","Suggestion:"),g=i.add(c.render(new B_().appendText(f).appendCodeblock("text",d)));l.replaceChildren(g.element)},u=(s=(r=e.controller.activeModel)===null||r===void 0?void 0:r.inlineCompletionsModel)===null||s===void 0?void 0:s.ghostText;if(u){const d=this._editor.getModel().getLineContent(u.lineNumber);h(u.renderForScreenReader(d))}t.appendChild(a)}};rP=eze([Np(2,An),Np(3,w0),Np(4,Xe),Np(5,Zr),Np(6,ju),Np(7,ps)],rP);var Jne=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},cx=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}},gU=globalThis&&globalThis.__awaiter||function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})};const pU=me;let sP=class extends re{constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=pU("div.hover-row.status-bar"),this.actionsElement=le(this.hoverElement,pU("div.actions"))}get hasContent(){return this._hasContent}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(RB.render(this.actionsElement,e,i))}append(e){const t=le(this.actionsElement,e);return this._hasContent=!0,t}};sP=Jne([cx(0,Yi)],sP);class PD{constructor(e,t){this._participants=t,this._editor=e,this._result=[],this._anchor=null}setAnchor(e){this._anchor=e,this._result=[]}clearResult(){this._result=[]}static _getLineDecorations(e,t){if(t.type!==1)return[];const i=e.getModel(),r=t.range.startLineNumber,s=i.getLineMaxColumn(r);return e.getLineDecorations(r).filter(o=>{if(o.options.isWholeLine)return!0;const a=o.range.startLineNumber===r?o.range.startColumn:1,l=o.range.endLineNumber===r?o.range.endColumn:s;return!(a>t.range.startColumn||t.range.endColumn>l)})}computeAsync(e){return gU(this,void 0,void 0,function*(){const t=this._anchor;if(!this._editor.hasModel()||!t)return Promise.resolve([]);const i=PD._getLineDecorations(this._editor,t),r=yield Promise.all(this._participants.map(s=>this._computeAsync(s,i,t,e)));return Q3(r)})}_computeAsync(e,t,i,r){return gU(this,void 0,void 0,function*(){return e.computeAsync?e.computeAsync(i,t,r):[]})}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=PD._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return rL(t)}onResult(e,t){t?this._result=e.concat(this._result):this._result=this._result.concat(e)}getResult(){return this._result.slice(0)}getResultWithLoadingMessage(){if(this._anchor){for(const e of this._participants)if(e.createLoadingMessage){const t=e.createLoadingMessage(this._anchor);if(t)return this._result.slice(0).concat([t])}}return this._result.slice(0)}}let mu=class oP extends bo{constructor(e,t,i,r,s){super(),this._hoverVisibleKey=t,this._keybindingService=r,this._contextKeyService=s,this.allowEditorOverflow=!0,this._participants=[i.createInstance(MO,e,this),i.createInstance(OO,e,this),i.createInstance(rP,e,this),i.createInstance(jO,e,this)],this._editor=e,this._isVisible=!1,this._stoleFocus=!1,this._renderDisposable=null,this._hover=this._register(new une),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this.onkeydown(this._hover.containerDomNode,o=>{o.equals(9)&&this.hide()}),this._register(this._editor.onDidChangeConfiguration(o=>{o.hasChanged(43)&&this._updateFont()})),this._editor.onDidLayoutChange(()=>this.layout()),this.layout(),this._editor.addContentWidget(this),this._showAtPosition=null,this._showAtRange=null,this._stoleFocus=!1,this._messages=[],this._lastAnchor=null,this._computer=new PD(this._editor,this._participants),this._highlightDecorations=[],this._isChangingDecorations=!1,this._shouldFocus=!1,this._colorPicker=null,this._preferAbove=this._editor.getOption(52).above,this._hoverOperation=new gne(this._computer,o=>this._withResult(o,!0),null,o=>this._withResult(o,!1),this._editor.getOption(52).delay),this._register(dn(this.getDomNode(),Me.FOCUS,()=>{this._colorPicker&&this.getDomNode().classList.add("colorpicker-hover")})),this._register(dn(this.getDomNode(),Me.BLUR,()=>{this.getDomNode().classList.remove("colorpicker-hover")})),this._register(e.onDidChangeConfiguration(()=>{this._hoverOperation.setHoverTime(this._editor.getOption(52).delay),this._preferAbove=this._editor.getOption(52).above})),this._register(Fi.onDidChange(()=>{this._isVisible&&this._lastAnchor&&this._messages.length>0&&(this._hover.contentsDomNode.textContent="",this._renderMessages(this._lastAnchor,this._messages))}))}dispose(){this._hoverOperation.cancel(),this._editor.removeContentWidget(this),super.dispose()}getId(){return oP.ID}getDomNode(){return this._hover.containerDomNode}_shouldShowAt(e){const t=e.target.type;if(t===6)return!0;if(t===7){const i=this._editor.getOption(43).typicalHalfwidthCharacterWidth/2,r=e.target.detail;if(r&&!r.isAfterLines&&typeof r.horizontalDistanceToText=="number"&&r.horizontalDistanceToText<i)return!0}return!1}maybeShowAt(e){var t;const i=[];for(const r of this._participants)if(typeof r.suggestHoverAnchor=="function"){const s=r.suggestHoverAnchor(e);s&&i.push(s)}if(this._shouldShowAt(e)&&e.target.range){const s=[...((t=e.target.element)===null||t===void 0?void 0:t.classList.values())||[]].find(o=>o.startsWith("ced-colorBox"))&&e.target.range.endColumn-e.target.range.startColumn===1?new V(e.target.range.startLineNumber,e.target.range.startColumn+1,e.target.range.endLineNumber,e.target.range.endColumn+1):e.target.range;i.push(new FH(0,s))}return i.length===0?!1:(i.sort((r,s)=>s.priority-r.priority),this._startShowingAt(i[0],0,!1),!0)}_showAt(e,t,i){this._showAtPosition=e,this._showAtRange=t,this._hoverVisibleKey.set(!0),this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._editor.layoutContentWidget(this),this._editor.render(),this._stoleFocus=i,i&&this._hover.containerDomNode.focus()}getPosition(){if(this._isVisible){let e=this._preferAbove;return!e&&this._contextKeyService.getContextKeyValue(ct.Visible.key)&&(e=!0),{position:this._showAtPosition,range:this._showAtRange,preference:e?[1,2]:[2,1]}}return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont(),this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}layout(){const e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:i}=this._editor.getOption(43);this._hover.contentsDomNode.style.fontSize=`${t}px`,this._hover.contentsDomNode.style.lineHeight=`${i/t}`,this._hover.contentsDomNode.style.maxHeight=`${e}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(this._editor.getLayoutInfo().width*.66,500)}px`}onModelDecorationsChanged(){this._isChangingDecorations||this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._colorPicker||this._hoverOperation.start(0))}startShowingAtRange(e,t,i){this._startShowingAt(new FH(0,e),t,i)}_startShowingAt(e,t,i){if(!(this._lastAnchor&&this._lastAnchor.equals(e))){if(this._hoverOperation.cancel(),this._isVisible)if(!this._showAtPosition||!this._lastAnchor||!e.canAdoptVisibleHover(this._lastAnchor,this._showAtPosition))this.hide();else{const r=this._messages.filter(s=>s.isValidForHoverAnchor(e));if(r.length===0)this.hide();else{if(r.length===this._messages.length)return;this._renderMessages(e,r)}}this._lastAnchor=e,this._computer.setAnchor(e),this._shouldFocus=i,this._hoverOperation.start(t)}}hide(){this._lastAnchor=null,this._hoverOperation.cancel(),this._isVisible&&(setTimeout(()=>{this._isVisible||this._hoverVisibleKey.set(!1)},0),this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._editor.layoutContentWidget(this),this._stoleFocus&&this._editor.focus()),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,[]),this._isChangingDecorations=!1,this._renderDisposable&&(this._renderDisposable.dispose(),this._renderDisposable=null),this._colorPicker=null}isColorPickerVisible(){return!!this._colorPicker}setColorPicker(e){this._colorPicker=e}onContentsChanged(){this._hover.onContentsChanged()}_withResult(e,t){this._messages=e,this._lastAnchor&&this._messages.length>0?this._renderMessages(this._lastAnchor,this._messages):t&&this.hide()}_renderMessages(e,t){this._renderDisposable&&(this._renderDisposable.dispose(),this._renderDisposable=null),this._colorPicker=null;let i=1073741824,r=t[0].range,s=null,o=document.createDocumentFragment();const a=new ve,l=new Map;for(const h of t)i=Math.min(i,h.range.startColumn),r=V.plusRange(r,h.range),h.forceShowAtRange&&(s=h.range),l.has(h.owner)||l.set(h.owner,[]),l.get(h.owner).push(h);const c=a.add(new sP(this._keybindingService));for(const[h,u]of l)a.add(h.renderHoverParts(u,o,c));c.hasContent&&o.appendChild(c.hoverElement),this._renderDisposable=a,o.hasChildNodes()&&(s?this._showAt(s.getStartPosition(),s,this._shouldFocus):this._showAt(new G(e.range.startLineNumber,i),r,this._shouldFocus),this._updateContents(o)),this._colorPicker&&this._colorPicker.layout(),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,r?[{range:r,options:oP._DECORATION_OPTIONS}]:[]),this._isChangingDecorations=!1}};mu.ID="editor.contrib.modesContentHoverWidget";mu._DECORATION_OPTIONS=bt.register({description:"content-hover-highlight",className:"hoverHighlight"});mu=Jne([cx(2,Kt),cx(3,Yi),cx(4,Xe)],mu);const mU=me;class ize{constructor(e){this._editor=e,this._lineNumber=-1,this._result=[]}setLineNumber(e){this._lineNumber=e,this._result=[]}clearResult(){this._result=[]}computeSync(){const e=r=>({value:r}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const r of t){if(!r.options.glyphMarginClassName)continue;const s=r.options.glyphMarginHoverMessage;!s||xv(s)||i.push(...vJ(s).map(e))}return i}onResult(e,t){this._result=this._result.concat(e)}getResult(){return this._result}getResultWithLoadingMessage(){return this.getResult()}}class mf extends bo{constructor(e,t,i=cLe){super(),this._renderDisposeables=this._register(new ve),this._editor=e,this._isVisible=!1,this._messages=[],this._lastLineNumber=-1,this._hover=this._register(new une),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new Cg({editor:this._editor},t,i)),this._computer=new ize(this._editor),this._hoverOperation=new gne(this._computer,r=>this._withResult(r),void 0,r=>this._withResult(r),300),this._register(this._editor.onDidChangeConfiguration(r=>{r.hasChanged(43)&&this._updateFont()})),this._editor.addOverlayWidget(this)}dispose(){this._hoverOperation.cancel(),this._editor.removeOverlayWidget(this),super.dispose()}getId(){return mf.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),r=this._editor.getScrollTop(),s=this._editor.getOption(58),o=this._hover.containerDomNode.clientHeight,a=i-r-(o-s)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start(0))}startShowingAt(e){this._lastLineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=e,this._computer.setLineNumber(e),this._hoverOperation.start(0))}hide(){this._lastLineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const r of t){const s=mU("div.hover-row.markdown-hover"),o=le(s,mU("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(r.value));o.appendChild(a.element),i.appendChild(s)}this._updateContents(i),this._showAt(e)}}mf.ID="editor.contrib.modesGlyphHoverWidget";var nze=globalThis&&globalThis.__decorate||function(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s},cS=globalThis&&globalThis.__param||function(n,e){return function(t,i){e(t,i,n)}};let xg=class ere{constructor(e,t,i,r,s){this._editor=e,this._instantiationService=t,this._openerService=i,this._modeService=r,this._toUnhook=new ve,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration(o=>{o.hasChanged(52)&&(this._unhookEvents(),this._hookEvents())}),this._hoverVisibleKey=Z.hoverVisible.bindTo(s)}static get(e){return e.getContribution(ere.ID)}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(52);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown(i=>this._onEditorMouseDown(i))),this._toUnhook.add(this._editor.onMouseUp(i=>this._onEditorMouseUp(i))),this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i))),this._toUnhook.add(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged()))):(this._toUnhook.add(this._editor.onMouseMove(i=>this._onEditorMouseMove(i))),this._toUnhook.add(this._editor.onKeyDown(i=>this._onKeyDown(i)))),this._toUnhook.add(this._editor.onMouseLeave(e)),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange(i=>this._onEditorScrollChanged(i)))}_unhookEvents(){this._toUnhook.clear()}_onModelDecorationsChanged(){var e,t;(e=this._contentWidget)===null||e===void 0||e.onModelDecorationsChanged(),(t=this._glyphWidget)===null||t===void 0||t.onModelDecorationsChanged()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._isMouseDown=!0;const t=e.target.type;if(t===9&&e.target.detail===mu.ID){this._hoverClicked=!0;return}t===12&&e.target.detail===mf.ID||(t!==12&&e.target.detail!==mf.ID&&(this._hoverClicked=!1),this._hideWidgets())}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseMove(e){var t,i,r,s,o;let a=e.target.type;if(this._isMouseDown&&this._hoverClicked||this._isHoverSticky&&a===9&&e.target.detail===mu.ID||this._isHoverSticky&&!(!((i=(t=e.event.browserEvent.view)===null||t===void 0?void 0:t.getSelection())===null||i===void 0)&&i.isCollapsed)||!this._isHoverSticky&&a===9&&e.target.detail===mu.ID&&(!((r=this._contentWidget)===null||r===void 0)&&r.isColorPickerVisible())||this._isHoverSticky&&a===12&&e.target.detail===mf.ID)return;if(!this._isHoverEnabled){this._hideWidgets();return}if(this._getOrCreateContentWidget().maybeShowAt(e)){(s=this._glyphWidget)===null||s===void 0||s.hide();return}if(a===2&&e.target.position){(o=this._contentWidget)===null||o===void 0||o.hide(),this._glyphWidget||(this._glyphWidget=new mf(this._editor,this._modeService,this._openerService)),this._glyphWidget.startShowingAt(e.target.position.lineNumber);return}this._hideWidgets()}_onKeyDown(e){e.keyCode!==5&&e.keyCode!==6&&e.keyCode!==57&&e.keyCode!==4&&this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(!((e=this._contentWidget)===null||e===void 0)&&e.isColorPickerVisible())||(this._hoverClicked=!1,(t=this._glyphWidget)===null||t===void 0||t.hide(),(i=this._contentWidget)===null||i===void 0||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(mu,this._editor,this._hoverVisibleKey)),this._contentWidget}isColorPickerVisible(){var e;return((e=this._contentWidget)===null||e===void 0?void 0:e.isColorPickerVisible())||!1}showContentHover(e,t,i){this._getOrCreateContentWidget().startShowingAtRange(e,t,i)}dispose(){var e,t;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),(e=this._glyphWidget)===null||e===void 0||e.dispose(),(t=this._contentWidget)===null||t===void 0||t.dispose()}};xg.ID="editor.contrib.hover";xg=nze([cS(1,Kt),cS(2,ju),cS(3,Zr),cS(4,Xe)],xg);class rze extends Si{constructor(){super({id:"editor.action.showHover",label:v({key:"showHover",comment:["Label for action that will trigger the showing of a hover in the editor.","This allows for users to show the hover without using the mouse."]},"Show Hover"),alias:"Show Hover",precondition:void 0,kbOpts:{kbExpr:Z.editorTextFocus,primary:qr(2089,2087),weight:100}})}run(e,t){if(!t.hasModel())return;let i=xg.get(t);if(!i)return;const r=t.getPosition(),s=new V(r.lineNumber,r.column,r.lineNumber,r.column),o=t.getOption(2)===2;i.showContentHover(s,1,o)}}class sze extends Si{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:v({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){let i=xg.get(t);if(!i)return;const r=t.getPosition();if(!r)return;const s=new V(r.lineNumber,r.column,r.lineNumber,r.column);wg.get(t).startFindDefinitionFromCursor(r).then(()=>{i.showContentHover(s,1,!0)})}}Yr(xg.ID,xg);pt(rze);pt(sze);li((n,e)=>{const t=n.getColor(LNe);t&&e.addRule(`.monaco-editor .hoverHighlight { background-color: ${t}; }`);const i=n.getColor(Iw);i&&e.addRule(`.monaco-editor .monaco-hover { background-color: ${i}; }`);const r=n.getColor(TNe);r&&(e.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${r}; }`),e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${r.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${r.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${r.transparent(.5)}; }`));const s=n.getColor(CL);s&&e.addRule(`.monaco-editor .monaco-hover a { color: ${s}; }`);const o=n.getColor(SL);o&&e.addRule(`.monaco-editor .monaco-hover a:hover { color: ${o}; }`);const a=n.getColor(INe);a&&e.addRule(`.monaco-editor .monaco-hover { color: ${a}; }`);const l=n.getColor(ANe);l&&e.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${l}; }`);const c=n.getColor(gee);c&&e.addRule(`.monaco-editor .monaco-hover code { background-color: ${c}; }`)});function oze(){return new Worker(""+new URL("json.worker-5aea2fd8.js",import.meta.url).href)}self.MonacoEnvironment={getWorker(n,e){if(e==="json")return new oze;throw new Error("Unsupported language: "+e)}};class aze extends lm{constructor(){super();dr(this,"_editor");dr(this,"_initialValue")}set value(t){this._editor?this._editor.setValue(t):this._initialValue=t}get value(){var t;return((t=this._editor)==null?void 0:t.getValue())??this._initialValue}createRenderRoot(){return this}disconnectedCallback(){var t,i,r;(t=this._editor)==null||t.dispose(),(r=(i=this._editor)==null?void 0:i.getModel())==null||r.dispose()}render(){return ln}firstUpdated(){this._editor=b6e.create(this,{value:this._initialValue,language:"json",minimap:{enabled:!1},fontFamily:"'Source Code Pro', monospace",fontSize:12}),this._editor.getModel().onDidChangeContent(()=>{this.dispatchEvent(new CustomEvent("change",{detail:{}}))}),new ResizeObserver(i=>{this._editor.layout()}).observe(this)}}customElements.define("code-editor",aze);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function*lze(n,e){if(n!==void 0){let t=0;for(const i of n)yield e(i,t++)}}var th;class tre extends lm{constructor(){super();Vt(this,th,void 0);dr(this,"files");this.missingFiles=new Set}createRenderRoot(){return this}render(){return on`
            <ul class="tabs">
                ${Object.keys(this.files).map(t=>on`
                            <li
                                data-name=${t}
                                class=${t==Ze(this,th)?"selected":""}
                            >
                                <a
                                    href="#"
                                    @click=${i=>this._changeTab(i)}
                                    >${t}</a
                                >
                            </li>
                        `)}
                <li class=${Ze(this,th)===void 0?"selected":""}>
                    <a
                        href="#"
                        @click=${t=>this._changeTab(t)}
                        >Add new files</a
                    >
                </li>
                <li style="flex-grow: 1"></li>
            </ul>

            <div class="tab-pages">
                ${Object.keys(this.files).map(t=>on`
                        <div
                            class=${t==Ze(this,th)?"selected":""}
                        >
                            ${hze(this.files[t].data)}
                        </div>
                    `)}

                <div class=${Ze(this,th)===void 0?"selected":""}>
                    ${this.missingFiles.size?on`<div class="missing-files">
                              <p>Please add the following files:</p>
                              <ul>
                                  ${lze(this.missingFiles,t=>on`<li>${t}</li>`)}
                              </ul>
                          </div>`:ln}
                    ${cze(t=>this._handleFiles(t))}
                </div>
            </div>
        `}async _handleFiles(t){const r=t.target.files;for(const s of r){const o=await uze(s),a=WP(o,{type:dze(o,s.name),parse:"auto"});this.files[s.name]={metadata:s,data:a},Co(this,th,s.name)}this.requestUpdate(),this.dispatchEvent(new CustomEvent("upload",{detail:{}}))}_changeTab(t){const r=t.target.parentElement.dataset.name;Co(this,th,r),t.preventDefault(),this.requestUpdate()}}th=new WeakMap,dr(tre,"properties",{missingFiles:{type:Set,attribute:!1}});customElements.define("file-pane",tre);function cze(n){return on` <form class="upload-form">
        <input
            type="file"
            multiple
            accept=".csv,.tsv,.txt,.json"
            id="fileInput"
            @change=${n}
            style="display:none"
        />
        <div id="upload-button-wrapper">
            <button
                class="btn"
                @click=${e=>{document.getElementById("fileInput").click(),e.preventDefault(),e.stopPropagation()}}
            >
                Choose files
            </button>
        </div>

        <p>
            The added file becomes a named datasource, which can be accessed as
            follows:
        </p>

        <pre>
"data": {
    "name": "filename.csv"
}
</pre
        >

        <p>
            N.B. All data processing takes place in your web browser. Nothing is
            uploaded anywhere.
        </p>
    </form>`}function hze(n){const e=Object.keys(n[0]),t=n.slice(0,30),i=e.map(a=>"text-align: "+(typeof n[0][a]=="number"?"right":"left")),r=a=>on`
        <tr>
            ${e.map((l,c)=>on`<td style=${i[c]}>${a[l]}</td> `)}
        </tr>
    `,s=()=>on`
        <tr>
            ${e.map((a,l)=>on`<td style=${i[l]}>...</td> `)}
        </tr>
    `;return on`
        <table class="data-sample-table">
            <thead>
                ${(()=>on`
        <tr>
            ${e.map((a,l)=>on`<th style=${i[l]}>${a}</th> `)}
        </tr>
    `)()}
            </thead>
            <tbody>
                ${t.map(r)}
                ${t.length<n.length?s():""}
            </tbody>
        </table>
    `}function uze(n){return new Promise((e,t)=>{let i=new FileReader;i.onload=()=>e(i.result),i.onerror=t,i.readAsText(n)})}function dze(n,e){return/\.json$/.test(e)?"json":n.indexOf("	")>=0?"tsv":"csv"}function ire(n){if(typeof n=="object"&&n!==null){n.description&&(n.markdownDescription=n.description);for(const e in n)n.hasOwnProperty(e)&&(n[e]=ire(n[e]))}return n}pze();const nre="playgroundSpec",rre=DU(),WB=DU(),sre={};let $B=new Set,KA,_U="";const hx=["stacked","parallel","full"];let aP=hx[0],ux,ore="";async function fze(){const e=new URLSearchParams(window.location.search).get("spec");if(e){const r=await fetch(e);return ux=e.match(/.*\//)[0],r.text()}const t=window.localStorage.getItem(nre),i=(t==null?void 0:t.length)>0?t:TEe;return console.log("Jeejee",i),i}function gze(){aP=hx[(hx.indexOf(aP)+1)%hx.length],zB(),window.dispatchEvent(new Event("resize"))}function pze(){ire(sH),qL.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"https://unpkg.com/@genome-spy/core/dist/schema.json",fileMatch:["*"],schema:sH}]})}function mze(n){let e=sre[n];return e||$B.add(n),e==null?void 0:e.data}async function are(n=!1){var t,i;$B=new Set,ux&&window.location.search&&window.history.replaceState(null,"",window.location.pathname);const e=(t=WB.value)==null?void 0:t.value;e&&window.localStorage.setItem(nre,e);try{const r=JSON.parse(e),s=JSON.stringify(r);if(s===_U&&!n)return;_U=s,KA&&KA.finalize(),ux&&!r.baseUrl&&(r.baseUrl=ux),ore=(i=Fs(r.description))==null?void 0:i[0],KA=await kEe(rre.value,r,{namedDataProvider:mze}),zB()}catch(r){console.log(r)}}const _ze=()=>on`
    <div class="toolbar">
        <a
            href="https://genomespy.app/"
            target="_blank"
            class="genome-spy-icon"
        >
            <img title="GenomeSpy" alt="GenomeSpy" src="${DEe}" />
        </a>
        <span class="title">
            <span>GenomeSpy Playground</span>
        </span>
        <button @click=${gze} class="tool-button hide-mobile">
            ${I6(boe).node[0]}
            <span>Toggle layout</span>
        </button>
        <span class="vis-title">
            <span class="hide-mobile">${ore}</span>
        </span>
        <a
            class="version tool-button"
            href="https://github.com/genome-spy/genome-spy/releases/tag/v${oH.version}"
            >v${oH.version}</a
        >
        <a
            href="https://genomespy.app/docs/"
            target="_blank"
            class="tool-button hide-mobile"
            >${I6(moe).node[0]} <span>Docs</span></a
        >
    </div>
`,bze=ay(()=>are(),500,!1),vze=()=>on`
    <section id="playground-layout" class="${aP}">
        ${_ze()}
        <section id="editor-pane">
            <code-editor
                ${r6(WB)}
                @change=${bze}
            ></code-editor>
        </section>
        <section id="genome-spy-pane">
            <div ${r6(rre)}></div>
        </section>
        <section id="file-pane">
            <file-pane
                @upload=${are}
                .files=${sre}
                .missingFiles=${$B}
            ></file-pane>
        </section>
    </section>
`;function zB(){gx(vze(),document.body)}zB();fze().then(n=>{WB.value.value=n});export{OHe as M,FHe as R,b6e as e,qL as l};
